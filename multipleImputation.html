<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Isaac T. Petersen">
<meta name="dcterms.date" content="today">
<title>Multiple Imputation – Data Analysis Guides for the Developmental Psychopathology Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-b754b9fd3853d7e56faef54c29c5d52b.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9278de052701f0b3f1191ef96b26c196.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-TYR0QMREEW', { 'anonymize_ip': true});
</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><link rel="stylesheet" href="styles.css">
<link rel="stylesheet" href="includes/custom.css">
<link rel="stylesheet" href="font/css/roboto.css">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/labLogo.png" alt="" class="navbar-logo light-content"><img src="./images/labLogo.png" alt="" class="navbar-logo dark-content"></a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Data Analysis Guides for the Developmental Psychopathology Lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-datasets" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Datasets</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-datasets">
<li>
    <a class="dropdown-item" href="./abcdData.html">
 <span class="dropdown-text">ABCD Study Data</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analysis-techniques" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Analysis Techniques</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analysis-techniques">
<li>
    <a class="dropdown-item" href="./bayesian.html">
 <span class="dropdown-text">Bayesian Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dataManagement.html">
 <span class="dropdown-text">Data Management</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dags.html">
 <span class="dropdown-text">Directed Acyclic Graphs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eegERP.html">
 <span class="dropdown-text">Electroencephalography/Event-Related Potentials</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eda.html">
 <span class="dropdown-text">Exploratory Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./factorAnalysis.html">
 <span class="dropdown-text">Factor Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./figures.html">
 <span class="dropdown-text">Figures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./hlm.html">
 <span class="dropdown-text">Hierarchical Linear Modeling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./irt.html">
 <span class="dropdown-text">Item Response Theory</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lda.html">
 <span class="dropdown-text">Longitudinal Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sem.html#mediation">
 <span class="dropdown-text">Mediation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regression.html#moderation">
 <span class="dropdown-text">Moderation/Interaction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./multipleImputation.html">
 <span class="dropdown-text">Multiple Imputation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./pca.html">
 <span class="dropdown-text">Principal Component Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regression.html">
 <span class="dropdown-text">Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./statistics.html">
 <span class="dropdown-text">Statistics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sem.html">
 <span class="dropdown-text">Structural Equation Modeling</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-softwareframeworks" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Software/Frameworks</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-softwareframeworks">
<li>
    <a class="dropdown-item" href="./git.html">
 <span class="dropdown-text">Git, GitLab, and GitHub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./hpc.html">
 <span class="dropdown-text">High-Performance Computing Cluster</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jamovi.html">
 <span class="dropdown-text">jamovi</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jatos.html">
 <span class="dropdown-text">JATOS (Just Another Tool for Online Studies)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jsPsych.html">
 <span class="dropdown-text">jsPsych</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lamp.html">
 <span class="dropdown-text">LAMP (Linux, Apache, MySQL, PHP) Server</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./markdown.html">
 <span class="dropdown-text">Markdown</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mplus.html">
 <span class="dropdown-text">Mplus</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./osf.html">
 <span class="dropdown-text">Open Science Framework</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://devpsylab.github.io/pythonDataAnalysisGuides">
 <span class="dropdown-text">Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./R.html">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SPSS.html">
 <span class="dropdown-text">SPSS</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="https://devpsylab.github.io/LabWiki"> 
<span class="menu-text">Lab Wiki</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://developmental-psychopathology.lab.uiowa.edu"> 
<span class="menu-text">Lab Website</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/DevPsyLab/DataAnalysis">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/DevPsyLab/DataAnalysis/issues/new">
            Report a Bug
            </a>
          </li>
      </ul>
</div>
    <a href="https://twitter.com/devpsylab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="https://www.facebook.com/DevPsyLab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-facebook"></i></a>
    <a href="https://www.instagram.com/devpsylab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-instagram"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./multipleImputation.html">Multiple Imputation</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abcdData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ABCD Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataManagement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Management</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dags.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Directed Acyclic Graphs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eegERP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Electroencephalography/Event-Related Potentials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factorAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Factor Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./figures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Git, GitLab, and GitHub</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hlm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hierarchical Linear Modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">High-Performance Computing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./irt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Item Response Theory</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jamovi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">jamovi</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jatos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">JATOS (Just Another Tool for Online Studies)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jsPsych.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">jsPsych</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lamp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LAMP (Linux, Apache, MySQL, PHP) Server</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Longitudinal Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markdown</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html#mediation" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mediation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html#moderation" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Moderation/Interaction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mplus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multipleImputation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Multiple Imputation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./osf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Open Science Framework</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principal Component Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://devpsylab.github.io/pythonDataAnalysisGuides" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SPSS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SPSS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structural Equation Modeling</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li>
<a href="#preamble" id="toc-preamble" class="nav-link active" data-scroll-target="#preamble"><span class="header-section-number">1</span> Preamble</a>
  <ul>
<li><a href="#install-libraries" id="toc-install-libraries" class="nav-link" data-scroll-target="#install-libraries"><span class="header-section-number">1.1</span> Install Libraries</a></li>
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries"><span class="header-section-number">1.2</span> Load Libraries</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">1.3</span> Data</a></li>
  </ul>
</li>
  <li><a href="#types-of-missingness" id="toc-types-of-missingness" class="nav-link" data-scroll-target="#types-of-missingness"><span class="header-section-number">2</span> Types of Missingness</a></li>
  <li>
<a href="#approaches-to-handle-missing-data" id="toc-approaches-to-handle-missing-data" class="nav-link" data-scroll-target="#approaches-to-handle-missing-data"><span class="header-section-number">3</span> Approaches to Handle Missing Data</a>
  <ul>
<li><a href="#for-mcarmar-missingness" id="toc-for-mcarmar-missingness" class="nav-link" data-scroll-target="#for-mcarmar-missingness"><span class="header-section-number">3.1</span> For MCAR/MAR Missingness</a></li>
  <li><a href="#for-mnar-missingness" id="toc-for-mnar-missingness" class="nav-link" data-scroll-target="#for-mnar-missingness"><span class="header-section-number">3.2</span> For MNAR Missingness</a></li>
  </ul>
</li>
  <li><a href="#approaches-to-multiple-imputation" id="toc-approaches-to-multiple-imputation" class="nav-link" data-scroll-target="#approaches-to-multiple-imputation"><span class="header-section-number">4</span> Approaches to Multiple Imputation</a></li>
  <li><a href="#describe-missing-data" id="toc-describe-missing-data" class="nav-link" data-scroll-target="#describe-missing-data"><span class="header-section-number">5</span> Describe Missing Data</a></li>
  <li>
<a href="#pre-imputation-setup" id="toc-pre-imputation-setup" class="nav-link" data-scroll-target="#pre-imputation-setup"><span class="header-section-number">6</span> Pre-Imputation Setup</a>
  <ul>
<li><a href="#specify-variables-to-impute" id="toc-specify-variables-to-impute" class="nav-link" data-scroll-target="#specify-variables-to-impute"><span class="header-section-number">6.1</span> Specify Variables to Impute</a></li>
  <li><a href="#specify-number-of-imputations" id="toc-specify-number-of-imputations" class="nav-link" data-scroll-target="#specify-number-of-imputations"><span class="header-section-number">6.2</span> Specify Number of Imputations</a></li>
  <li><a href="#detect-cores" id="toc-detect-cores" class="nav-link" data-scroll-target="#detect-cores"><span class="header-section-number">6.3</span> Detect Cores</a></li>
  </ul>
</li>
  <li>
<a href="#multilevel-multiple-imputation" id="toc-multilevel-multiple-imputation" class="nav-link" data-scroll-target="#multilevel-multiple-imputation"><span class="header-section-number">7</span> Multilevel Multiple Imputation</a>
  <ul>
<li><a href="#three-level-and-cross-classified-data" id="toc-three-level-and-cross-classified-data" class="nav-link" data-scroll-target="#three-level-and-cross-classified-data"><span class="header-section-number">7.1</span> Three-Level and Cross-Classified Data</a></li>
  <li>
<a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"><span class="header-section-number">7.2</span> Methods</a>
  <ul>
<li>
<a href="#sec-mice" id="toc-sec-mice" class="nav-link" data-scroll-target="#sec-mice"><span class="header-section-number">7.2.1</span> <code>mice</code></a>
  <ul class="collapse">
<li>
<a href="#types" id="toc-types" class="nav-link" data-scroll-target="#types"><span class="header-section-number">7.2.1.1</span> Types</a>
  <ul class="collapse">
<li><a href="#continuous-outcomes" id="toc-continuous-outcomes" class="nav-link" data-scroll-target="#continuous-outcomes"><span class="header-section-number">7.2.1.1.1</span> Continuous Outcomes</a></li>
  <li><a href="#binary-outcomes" id="toc-binary-outcomes" class="nav-link" data-scroll-target="#binary-outcomes"><span class="header-section-number">7.2.1.1.2</span> Binary Outcomes</a></li>
  <li><a href="#ordinal-outcomes" id="toc-ordinal-outcomes" class="nav-link" data-scroll-target="#ordinal-outcomes"><span class="header-section-number">7.2.1.1.3</span> Ordinal Outcomes</a></li>
  <li><a href="#count-outcomes" id="toc-count-outcomes" class="nav-link" data-scroll-target="#count-outcomes"><span class="header-section-number">7.2.1.1.4</span> Count Outcomes</a></li>
  </ul>
</li>
  <li><a href="#specifying-the-imputation-method" id="toc-specifying-the-imputation-method" class="nav-link" data-scroll-target="#specifying-the-imputation-method"><span class="header-section-number">7.2.1.2</span> Specifying the Imputation Method</a></li>
  <li><a href="#specifying-the-predictor-matrix" id="toc-specifying-the-predictor-matrix" class="nav-link" data-scroll-target="#specifying-the-predictor-matrix"><span class="header-section-number">7.2.1.3</span> Specifying the Predictor Matrix</a></li>
  <li><a href="#syntax" id="toc-syntax" class="nav-link" data-scroll-target="#syntax"><span class="header-section-number">7.2.1.4</span> Syntax</a></li>
  </ul>
</li>
  <li><a href="#sec-jomo" id="toc-sec-jomo" class="nav-link" data-scroll-target="#sec-jomo"><span class="header-section-number">7.2.2</span> <code>jomo</code></a></li>
  <li><a href="#sec-amelia" id="toc-sec-amelia" class="nav-link" data-scroll-target="#sec-amelia"><span class="header-section-number">7.2.3</span> <code>Amelia</code></a></li>
  <li>
<a href="#sec-mplus" id="toc-sec-mplus" class="nav-link" data-scroll-target="#sec-mplus"><span class="header-section-number">7.2.4</span> <code>Mplus</code></a>
  <ul class="collapse">
<li><a href="#save-mplus-data-file" id="toc-save-mplus-data-file" class="nav-link" data-scroll-target="#save-mplus-data-file"><span class="header-section-number">7.2.4.1</span> Save <code>Mplus</code> Data File</a></li>
  <li><a href="#mplus-syntax-for-multilevel-imputation" id="toc-mplus-syntax-for-multilevel-imputation" class="nav-link" data-scroll-target="#mplus-syntax-for-multilevel-imputation"><span class="header-section-number">7.2.4.2</span> <code>Mplus</code> Syntax for Multilevel Imputation</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#parallel-processing" id="toc-parallel-processing" class="nav-link" data-scroll-target="#parallel-processing"><span class="header-section-number">8</span> Parallel Processing</a></li>
  <li>
<a href="#imputation-diagnostics" id="toc-imputation-diagnostics" class="nav-link" data-scroll-target="#imputation-diagnostics"><span class="header-section-number">9</span> Imputation Diagnostics</a>
  <ul>
<li><a href="#logged-events" id="toc-logged-events" class="nav-link" data-scroll-target="#logged-events"><span class="header-section-number">9.1</span> Logged Events</a></li>
  <li><a href="#trace-plots" id="toc-trace-plots" class="nav-link" data-scroll-target="#trace-plots"><span class="header-section-number">9.2</span> Trace Plots</a></li>
  <li><a href="#density-plots" id="toc-density-plots" class="nav-link" data-scroll-target="#density-plots"><span class="header-section-number">9.3</span> Density Plots</a></li>
  <li><a href="#strip-plots" id="toc-strip-plots" class="nav-link" data-scroll-target="#strip-plots"><span class="header-section-number">9.4</span> Strip Plots</a></li>
  </ul>
</li>
  <li>
<a href="#post-processing" id="toc-post-processing" class="nav-link" data-scroll-target="#post-processing"><span class="header-section-number">10</span> Post-Processing</a>
  <ul>
<li>
<a href="#modifycreate-new-variables" id="toc-modifycreate-new-variables" class="nav-link" data-scroll-target="#modifycreate-new-variables"><span class="header-section-number">10.1</span> Modify/Create New Variables</a>
  <ul>
<li><a href="#mice" id="toc-mice" class="nav-link" data-scroll-target="#mice"><span class="header-section-number">10.1.1</span> <code>mice</code></a></li>
  <li><a href="#jomo" id="toc-jomo" class="nav-link" data-scroll-target="#jomo"><span class="header-section-number">10.1.2</span> <code>jomo</code></a></li>
  <li><a href="#amelia" id="toc-amelia" class="nav-link" data-scroll-target="#amelia"><span class="header-section-number">10.1.3</span> <code>Amelia</code></a></li>
  </ul>
</li>
  <li>
<a href="#convert-to-mids-object" id="toc-convert-to-mids-object" class="nav-link" data-scroll-target="#convert-to-mids-object"><span class="header-section-number">10.2</span> Convert to <code>mids</code> object</a>
  <ul>
<li><a href="#mice-1" id="toc-mice-1" class="nav-link" data-scroll-target="#mice-1"><span class="header-section-number">10.2.1</span> <code>mice</code></a></li>
  <li><a href="#jomo-1" id="toc-jomo-1" class="nav-link" data-scroll-target="#jomo-1"><span class="header-section-number">10.2.2</span> <code>jomo</code></a></li>
  <li><a href="#amelia-1" id="toc-amelia-1" class="nav-link" data-scroll-target="#amelia-1"><span class="header-section-number">10.2.3</span> <code>Amelia</code></a></li>
  </ul>
</li>
  <li><a href="#export-for-mplus" id="toc-export-for-mplus" class="nav-link" data-scroll-target="#export-for-mplus"><span class="header-section-number">10.3</span> Export for <code>Mplus</code></a></li>
  </ul>
</li>
  <li>
<a href="#fit-model-to-multiply-imputed-data" id="toc-fit-model-to-multiply-imputed-data" class="nav-link" data-scroll-target="#fit-model-to-multiply-imputed-data"><span class="header-section-number">11</span> Fit Model to Multiply Imputed Data</a>
  <ul>
<li>
<a href="#sec-multiple-regression" id="toc-sec-multiple-regression" class="nav-link" data-scroll-target="#sec-multiple-regression"><span class="header-section-number">11.1</span> Multiple Regression</a>
  <ul>
<li><a href="#pool-results-across-models" id="toc-pool-results-across-models" class="nav-link" data-scroll-target="#pool-results-across-models"><span class="header-section-number">11.1.1</span> Pool Results Across Models</a></li>
  </ul>
</li>
  <li>
<a href="#sec-mixed-model" id="toc-sec-mixed-model" class="nav-link" data-scroll-target="#sec-mixed-model"><span class="header-section-number">11.2</span> Mixed Model</a>
  <ul>
<li><a href="#pool-results-across-models-1" id="toc-pool-results-across-models-1" class="nav-link" data-scroll-target="#pool-results-across-models-1"><span class="header-section-number">11.2.1</span> Pool Results Across Models</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#model-implied-predictions" id="toc-model-implied-predictions" class="nav-link" data-scroll-target="#model-implied-predictions"><span class="header-section-number">12</span> Model-Implied Predictions</a></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources"><span class="header-section-number">13</span> Resources</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">14</span> Session Info</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/DevPsyLab/DataAnalysis/edit/main/multipleImputation.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/blob/main/multipleImputation.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Multiple Imputation</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="preamble" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Preamble</h1>
<section id="install-libraries" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="install-libraries">
<span class="header-section-number">1.1</span> Install Libraries</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#install.packages("remotes")</span></span>
<span><span class="co">#remotes::install_github("DevPsyLab/petersenlab")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="load-libraries" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="load-libraries">
<span class="header-section-number">1.2</span> Load Libraries</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://personality-project.org/r/psych/">"psych"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/amices/mice">"mice"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"micemd"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/alexanderrobitzsch/miceadds">"miceadds"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"mitml"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://gking.harvard.edu/amelia">"Amelia"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"jomo"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://parallelly.futureverse.org">"parallelly"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://future.futureverse.org">"future"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/DavisVaughan/furrr">"furrr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">"nlme"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/lme4/lme4/">"lme4"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/bbolker/broom.mixed">"broom.mixed"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://michaelhallquist.github.io/MplusAutomation/">"MplusAutomation"</a></span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="data" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="data">
<span class="header-section-number">1.3</span> Data</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Oxboys</span>, package <span class="op">=</span> <span class="st">"nlme"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Oxboys_addNA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">Oxboys</span><span class="op">)</span></span>
<span><span class="va">Oxboys_addNA</span> <span class="op">&lt;-</span> <span class="va">Oxboys_addNA</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">Subject</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Oxboys_addNA</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">Oxboys_addNA</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="va">Oxboys_addNA</span><span class="op">$</span><span class="va">Occasion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">Oxboys_addNA</span><span class="op">$</span><span class="va">Occasion</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">52242</span><span class="op">)</span></span>
<span><span class="va">Oxboys_addNA</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">Oxboys_addNA</span><span class="op">)</span>, <span class="fl">25</span><span class="op">)</span>, <span class="st">"height"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">dataToImpute</span> <span class="op">&lt;-</span> <span class="va">Oxboys_addNA</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section><section id="types-of-missingness" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Types of Missingness</h1>
<ol type="1">
<li>Missing Completely at Random (MCAR)
<ul>
<li>the probability of being missing is the same for all cases</li>
<li>missingness is not related to variables in the model</li>
</ul>
</li>
<li>(Conditionally) Missing at Random (MAR)
<ul>
<li>missingness is related to variables in the model, but once we condition on the variables in the model, the missingness is haphazard</li>
<li>the unobserved values do not play a role</li>
</ul>
</li>
<li>Missing Not at Random (MNAR)
<ul>
<li>missingness is related to variables that are not in the model (i.e., for reasons that are unknown)</li>
<li>unobserved variables carry information about whether a case will have missing data</li>
</ul>
</li>
</ol></section><section id="approaches-to-handle-missing-data" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Approaches to Handle Missing Data</h1>
<section id="for-mcarmar-missingness" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="for-mcarmar-missingness">
<span class="header-section-number">3.1</span> For MCAR/MAR Missingness</h2>
<ol type="1">
<li>Full Information Maximum Likelihood (FIML)</li>
<li>Multiple Imputation</li>
</ol></section><section id="for-mnar-missingness" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="for-mnar-missingness">
<span class="header-section-number">3.2</span> For MNAR Missingness</h2>
<p><a href="https://stefvanbuuren.name/fimd/sec-nonignorable.html" class="uri">https://stefvanbuuren.name/fimd/sec-nonignorable.html</a> (archived at <a href="https://perma.cc/N7WW-HDZF" class="uri">https://perma.cc/N7WW-HDZF</a>)</p>
<p><a href="https://cran.r-project.org/web/packages/missingHE/vignettes/Fitting_MNAR_models_in_missingHE.html" class="uri">https://cran.r-project.org/web/packages/missingHE/vignettes/Fitting_MNAR_models_in_missingHE.html</a> (archived at <a href="https://perma.cc/9X25-5D8G" class="uri">https://perma.cc/9X25-5D8G</a>)</p>
<ol type="1">
<li>find more data about the causes for the missingness</li>
<li>sensitivity analyses (what-if analyses) to see how sensitive the results are under various scenarios
<ul>
<li>
<a href="https://stefvanbuuren.name/fimd/sec-MCAR.html" class="uri">https://stefvanbuuren.name/fimd/sec-MCAR.html</a> (archived at <a href="https://perma.cc/9KM9-3NX3" class="uri">https://perma.cc/9KM9-3NX3</a>)</li>
</ul>
</li>
<li>selection models
<ul>
<li>simultaneously estimate the focal model and a missingness model, where the missingness model has the missing data indicator as a dependent variable, as predicted by the original dependent variable, the original predictors, and any additional covariates etc.</li>
<li>if the missingness model is approximately correct, the focal model adjusts in way that removes nonresponse bias</li>
<li>similar to a mediation process
<ul>
<li>X → Y</li>
<li>Y → missingness</li>
<li>X → missingness</li>
</ul>
</li>
<li>
<a href="https://quantitudepod.org/s4e08-craig-enders/" class="uri">https://quantitudepod.org/s4e08-craig-enders/</a> (archived at <a href="https://perma.cc/FY9L-L3F7" class="uri">https://perma.cc/FY9L-L3F7</a>)</li>
</ul>
</li>
<li>pattern-mixture models
<ul>
<li>missing data indicator is a predictor variable</li>
<li>similar to a moderation process; subgroups of cases have different parameter estimates</li>
</ul>
</li>
</ol></section></section><section id="approaches-to-multiple-imputation" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Approaches to Multiple Imputation</h1>
<ul>
<li>multiple imputation by joint modeling
<ul>
<li>assumes that the variables in follow a joint distribution, e.g.:
<ul>
<li>multivariate normal (i.e., multivariate normal imputation)</li>
</ul>
</li>
<li>
<code>R</code> packages:
<ul>
<li><code>jomo</code></li>
<li><code>pan</code></li>
<li><code>Amelia</code></li>
<li><code>Mplus</code></li>
</ul>
</li>
</ul>
</li>
<li>multiple imputation by chained equations
<ul>
<li>aka:
<ul>
<li>fully conditional specification multiple imputation</li>
<li>sequential regression multiple imputation</li>
</ul>
</li>
<li>
<code>R</code> packages:
<ul>
<li>
<code>mice</code>
<ul>
<li>predictive mean matching (<code><a href="https://amices.org/mice/reference/mice.impute.pmm.html">?mice::mice.impute.pmm</a></code>) can be useful to obtain bounded imputations for non-normally distributed variables</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul></section><section id="describe-missing-data" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Describe Missing Data</h1>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/describe.html">describe</a></span><span class="op">(</span><span class="va">dataToImpute</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["vars"],"name":[1],"type":["int"],"align":["right"]},{"label":["n"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["trimmed"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mad"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["min"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["range"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["skew"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["kurtosis"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["se"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"234","3":"13.50000000","4":"7.5160772","5":"13.5000","6":"13.50000000","7":"9.6369000","8":"1.0","9":"26.0000","10":"25.0000","11":"0.00000000","12":"-1.21887697","13":"0.49134134","_rn_":"id"},{"1":"2","2":"234","3":"0.02263462","4":"0.6479585","5":"-0.0027","6":"0.02871383","7":"0.8286251","8":"-1.0","9":"1.0055","10":"2.0055","11":"-0.05158503","12":"-1.22960788","13":"0.04235837","_rn_":"age"},{"1":"3","2":"209","3":"149.69014354","4":"9.2886034","5":"149.7800","6":"149.59437870","7":"8.7176880","8":"126.2","9":"174.8000","10":"48.6000","11":"0.11228667","12":"0.02860264","13":"0.64250613","_rn_":"height"},{"1":"4","2":"234","3":"5.00000000","4":"2.5875237","5":"5.0000","6":"5.00000000","7":"2.9652000","8":"1.0","9":"9.0000","10":"8.0000","11":"0.00000000","12":"-1.24509588","13":"0.16915172","_rn_":"Occasion"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/md.pattern.html">md.pattern</a></span><span class="op">(</span><span class="va">dataToImpute</span>, rotate.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="multipleImputation_files/figure-html/unnamed-chunk-6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="multipleImputation_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    id age Occasion height   
209  1   1        1      1  0
25   1   1        1      0  1
     0   0        0     25 25</code></pre>
</div>
</div>
</section><section id="pre-imputation-setup" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Pre-Imputation Setup</h1>
<section id="specify-variables-to-impute" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="specify-variables-to-impute">
<span class="header-section-number">6.1</span> Specify Variables to Impute</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">varsToImpute</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"height"</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">varsToImpute</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="specify-number-of-imputations" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="specify-number-of-imputations">
<span class="header-section-number">6.2</span> Specify Number of Imputations</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">numImputations</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="co"># generally use 100 imputations; this example uses 5 for speed</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="detect-cores" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="detect-cores">
<span class="header-section-number">6.3</span> Detect Cores</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">numCores</span> <span class="op">&lt;-</span> <span class="fu">parallelly</span><span class="fu">::</span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableCores.html">availableCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section><section id="multilevel-multiple-imputation" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> Multilevel Multiple Imputation</h1>
<section id="three-level-and-cross-classified-data" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="three-level-and-cross-classified-data">
<span class="header-section-number">7.1</span> Three-Level and Cross-Classified Data</h2>
<p><a href="https://simongrund1.github.io/posts/multiple-imputation-for-three-level-and-cross-classified-data/" class="uri">https://simongrund1.github.io/posts/multiple-imputation-for-three-level-and-cross-classified-data/</a> (archived at <a href="https://perma.cc/N4PP-A3V6" class="uri">https://perma.cc/N4PP-A3V6</a>)</p>
</section><section id="methods" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="methods">
<span class="header-section-number">7.2</span> Methods</h2>
<section id="sec-mice" class="level3" data-number="7.2.1"><h3 data-number="7.2.1" class="anchored" data-anchor-id="sec-mice">
<span class="header-section-number">7.2.1</span> <code>mice</code>
</h3>
<section id="types" class="level4" data-number="7.2.1.1"><h4 data-number="7.2.1.1" class="anchored" data-anchor-id="types">
<span class="header-section-number">7.2.1.1</span> Types</h4>
<section id="continuous-outcomes" class="level5" data-number="7.2.1.1.1"><h5 data-number="7.2.1.1.1" class="anchored" data-anchor-id="continuous-outcomes">
<span class="header-section-number">7.2.1.1.1</span> Continuous Outcomes</h5>
<p><a href="https://stefvanbuuren.name/fimd/sec-multioutcome.html#methods" class="uri">https://stefvanbuuren.name/fimd/sec-multioutcome.html#methods</a> (archived at <a href="https://perma.cc/8CDA-TS3K" class="uri">https://perma.cc/8CDA-TS3K</a>)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">?</span><span class="fu">mice</span><span class="fu">::</span><span class="va"><a href="https://amices.org/mice/reference/mice.impute.2l.norm.html">mice.impute.2l.norm</a></span></span>
<span><span class="op">?</span><span class="fu">mice</span><span class="fu">::</span><span class="va"><a href="https://amices.org/mice/reference/mice.impute.2l.pan.html">mice.impute.2l.pan</a></span></span>
<span><span class="op">?</span><span class="fu">mice</span><span class="fu">::</span><span class="va"><a href="https://amices.org/mice/reference/mice.impute.2l.lmer.html">mice.impute.2l.lmer</a></span></span>
<span><span class="op">?</span><span class="fu">miceadds</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/miceadds/man/mice_imputation_2l_lmer.html">mice.impute.2l.pmm</a></span></span>
<span><span class="op">?</span><span class="fu">miceadds</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/miceadds/man/mice.impute.2l.contextual.pmm.html">mice.impute.2l.contextual.pmm</a></span></span>
<span><span class="op">?</span><span class="fu">miceadds</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/miceadds/man/mice_imputation_2l_lmer.html">mice.impute.2l.continuous</a></span></span>
<span><span class="op">?</span><span class="fu">micemd</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/micemd/man/mice.impute.2l.2stage.norm.html">mice.impute.2l.2stage.norm</a></span></span>
<span><span class="op">?</span><span class="fu">micemd</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/micemd/man/mice.impute.2l.2stage.pmm.html">mice.impute.2l.2stage.pmm</a></span></span>
<span><span class="op">?</span><span class="fu">micemd</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/micemd/man/mice.impute.2l.glm.norm.html">mice.impute.2l.glm.norm</a></span></span>
<span><span class="op">?</span><span class="fu">micemd</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/micemd/man/mice.impute.2l.jomo.html">mice.impute.2l.jomo</a></span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="binary-outcomes" class="level5" data-number="7.2.1.1.2"><h5 data-number="7.2.1.1.2" class="anchored" data-anchor-id="binary-outcomes">
<span class="header-section-number">7.2.1.1.2</span> Binary Outcomes</h5>
<p><a href="https://stefvanbuuren.name/fimd/sec-catoutcome.html#methods-1" class="uri">https://stefvanbuuren.name/fimd/sec-catoutcome.html#methods-1</a> (archived at <a href="https://perma.cc/5QHF-YRP6" class="uri">https://perma.cc/5QHF-YRP6</a>)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">?</span><span class="fu">mice</span><span class="fu">::</span><span class="va"><a href="https://amices.org/mice/reference/mice.impute.2l.bin.html">mice.impute.2l.bin</a></span></span>
<span><span class="op">?</span><span class="fu">miceadds</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/miceadds/man/mice_imputation_2l_lmer.html">mice.impute.2l.binary</a></span></span>
<span><span class="op">?</span><span class="fu">miceadds</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/miceadds/man/mice_imputation_2l_lmer.html">mice.impute.2l.pmm</a></span></span>
<span><span class="op">?</span><span class="fu">miceadds</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/miceadds/man/mice.impute.2l.contextual.pmm.html">mice.impute.2l.contextual.pmm</a></span></span>
<span><span class="op">?</span><span class="fu">micemd</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/micemd/man/mice.impute.2l.2stage.bin.html">mice.impute.2l.2stage.bin</a></span></span>
<span><span class="op">?</span><span class="fu">micemd</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/micemd/man/mice.impute.2l.glm.bin.html">mice.impute.2l.glm.bin</a></span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="ordinal-outcomes" class="level5" data-number="7.2.1.1.3"><h5 data-number="7.2.1.1.3" class="anchored" data-anchor-id="ordinal-outcomes">
<span class="header-section-number">7.2.1.1.3</span> Ordinal Outcomes</h5>
<p><a href="https://stefvanbuuren.name/fimd/sec-multioutcome.html#methods" class="uri">https://stefvanbuuren.name/fimd/sec-multioutcome.html#methods</a> (archived at <a href="https://perma.cc/8CDA-TS3K" class="uri">https://perma.cc/8CDA-TS3K</a>)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">?</span><span class="fu">miceadds</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/miceadds/man/mice_imputation_2l_lmer.html">mice.impute.2l.pmm</a></span></span>
<span><span class="op">?</span><span class="fu">miceadds</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/miceadds/man/mice.impute.2l.contextual.pmm.html">mice.impute.2l.contextual.pmm</a></span></span>
<span><span class="op">?</span><span class="fu">micemd</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/micemd/man/mice.impute.2l.2stage.pmm.html">mice.impute.2l.2stage.pmm</a></span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="count-outcomes" class="level5" data-number="7.2.1.1.4"><h5 data-number="7.2.1.1.4" class="anchored" data-anchor-id="count-outcomes">
<span class="header-section-number">7.2.1.1.4</span> Count Outcomes</h5>
<p><a href="https://stefvanbuuren.name/fimd/sec-catoutcome.html#methods-1" class="uri">https://stefvanbuuren.name/fimd/sec-catoutcome.html#methods-1</a> (archived at <a href="https://perma.cc/5QHF-YRP6" class="uri">https://perma.cc/5QHF-YRP6</a>)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">?</span><span class="fu">micemd</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/micemd/man/mice.impute.2l.2stage.pois.html">mice.impute.2l.2stage.pois</a></span></span>
<span><span class="op">?</span><span class="fu">micemd</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/micemd/man/mice.impute.2l.glm.pois.html">mice.impute.2l.glm.pois</a></span></span>
<span><span class="op">?</span><span class="fu">countimp</span><span class="fu">::</span><span class="va">mice.impute.2l.poisson</span></span>
<span><span class="op">?</span><span class="fu">countimp</span><span class="fu">::</span><span class="va">mice.impute.2l.nb2</span></span>
<span><span class="op">?</span><span class="fu">countimp</span><span class="fu">::</span><span class="va">mice.impute.2l.zihnb</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section><section id="specifying-the-imputation-method" class="level4" data-number="7.2.1.2"><h4 data-number="7.2.1.2" class="anchored" data-anchor-id="specifying-the-imputation-method">
<span class="header-section-number">7.2.1.2</span> Specifying the Imputation Method</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">meth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/make.method.html">make.method</a></span><span class="op">(</span><span class="va">dataToImpute</span><span class="op">)</span></span>
<span><span class="va">meth</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">meth</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span><span class="va">meth</span><span class="op">[</span><span class="va">Y</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"2l.pmm"</span> <span class="co"># specify the imputation method here; this can differ by outcome variable</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="specifying-the-predictor-matrix" class="level4" data-number="7.2.1.3"><h4 data-number="7.2.1.3" class="anchored" data-anchor-id="specifying-the-predictor-matrix">
<span class="header-section-number">7.2.1.3</span> Specifying the Predictor Matrix</h4>
<p>A predictor matrix is a matrix of values, where:</p>
<ul>
<li>columns with non-zero values are predictors of the variable specified in the given row</li>
<li>the diagonal of the predictor matrix should be zero because a variable cannot predict itself</li>
</ul>
<p>The values are:</p>
<ul>
<li>NOT a predictor of the outcome: <code>0</code>
</li>
<li>cluster variable: <code>-2</code>
</li>
<li>fixed effect of predictor: <code>1</code>
</li>
<li>fixed effect and random effect of predictor: <code>2</code>
</li>
<li>include cluster mean of predictor in addition to fixed effect of predictor: <code>3</code>
</li>
<li>include cluster mean of predictor in addition to fixed effect and random effect of predictor: <code>4</code>
</li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/make.predictorMatrix.html">make.predictorMatrix</a></span><span class="op">(</span><span class="va">dataToImpute</span><span class="op">)</span></span>
<span><span class="va">pred</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pred</span><span class="op">[</span><span class="va">Y</span>, <span class="st">"id"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span> <span class="co"># cluster variable</span></span>
<span><span class="va">pred</span><span class="op">[</span><span class="va">Y</span>, <span class="st">"Occasion"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># fixed effect predictor</span></span>
<span><span class="va">pred</span><span class="op">[</span><span class="va">Y</span>, <span class="st">"age"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># random effect predictor</span></span>
<span><span class="va">pred</span><span class="op">[</span><span class="va">Y</span>, <span class="va">Y</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># fixed effect predictor</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pred</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         id age height Occasion
id        0   0      0        0
age       0   0      0        0
height   -2   2      0        1
Occasion  0   0      0        0</code></pre>
</div>
</div>
</section><section id="syntax" class="level4" data-number="7.2.1.4"><h4 data-number="7.2.1.4" class="anchored" data-anchor-id="syntax">
<span class="header-section-number">7.2.1.4</span> Syntax</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mi_mice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/mice.html">mice</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">dataToImpute</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="va">meth</span>,</span>
<span>  predictorMatrix <span class="op">=</span> <span class="va">pred</span>,</span>
<span>  m <span class="op">=</span> <span class="va">numImputations</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">5</span>, <span class="co"># generally use 100 maximum iterations; this example uses 5 for speed</span></span>
<span>  seed <span class="op">=</span> <span class="fl">52242</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  height
  1   2  height
  1   3  height
  1   4  height
  1   5  height
  2   1  height
  2   2  height
  2   3  height
  2   4  height
  2   5  height
  3   1  height
  3   2  height
  3   3  height
  3   4  height
  3   5  height
  4   1  height
  4   2  height
  4   3  height
  4   4  height
  4   5  height
  5   1  height
  5   2  height
  5   3  height
  5   4  height
  5   5  height</code></pre>
</div>
</div>
</section></section><section id="sec-jomo" class="level3" data-number="7.2.2"><h3 data-number="7.2.2" class="anchored" data-anchor-id="sec-jomo">
<span class="header-section-number">7.2.2</span> <code>jomo</code>
</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">level1Vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"height"</span><span class="op">)</span></span>
<span><span class="va">level2Vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"v3"</span>,<span class="st">"v4"</span><span class="op">)</span></span>
<span><span class="va">clusterVars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span><span class="op">)</span></span>
<span><span class="va">fullyObservedCovariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>,<span class="st">"Occasion"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">52242</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mi_jomo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/jomo/man/jomo.html">jomo</a></span><span class="op">(</span></span>
<span>  Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">dataToImpute</span><span class="op">[</span>, <span class="va">level1Vars</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  <span class="co">#Y2 = data.frame(dataToImpute[, level2Vars]),</span></span>
<span>  X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">dataToImpute</span><span class="op">[</span>, <span class="va">fullyObservedCovariates</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  clus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">dataToImpute</span><span class="op">[</span>, <span class="va">clusterVars</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  nimp <span class="op">=</span> <span class="va">numImputations</span>,</span>
<span>  meth <span class="op">=</span> <span class="st">"random"</span></span>
<span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="sec-amelia" class="level3" data-number="7.2.3"><h3 data-number="7.2.3" class="anchored" data-anchor-id="sec-amelia">
<span class="header-section-number">7.2.3</span> <code>Amelia</code>
</h3>
<ul>
<li>
<code>!</code> in the console output indicates that the current estimated complete data covariance matrix is not invertible</li>
<li>
<code>*</code> in the console output indicates that the likelihood has not monotonically increased in that step</li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">boundVars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"height"</span><span class="op">)</span></span>
<span><span class="va">boundCols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dataToImpute</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">boundVars</span><span class="op">)</span></span>
<span><span class="va">boundLower</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">boundUpper</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="va">varBounds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html">cbind</a></span><span class="op">(</span><span class="va">boundCols</span>, <span class="va">boundLower</span>, <span class="va">boundUpper</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">52242</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mi_amelia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Amelia/man/amelia.html">amelia</a></span><span class="op">(</span></span>
<span>  <span class="va">dataToImpute</span>,</span>
<span>  m <span class="op">=</span> <span class="va">numImputations</span>,</span>
<span>  ts <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>  cs <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  polytime <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  intercs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="co">#ords = ordinalVars,</span></span>
<span>  <span class="co">#bounds = varBounds,</span></span>
<span>  parallel <span class="op">=</span> <span class="st">"snow"</span>,</span>
<span>  <span class="co">#ncpus = numCores,</span></span>
<span>  empri <span class="op">=</span> <span class="fl">.01</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dataToImpute</span><span class="op">)</span><span class="op">)</span> <span class="co"># ridge prior for numerical stability</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>-- Imputation 1 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21

-- Imputation 2 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18

-- Imputation 3 --

  1  2  3  4  5  6  7  8

-- Imputation 4 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80
 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100
 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120
 121 122 123

-- Imputation 5 --

  1  2  3  4  5  6  7  8  9 10 11 12</code></pre>
</div>
</div>
</section><section id="sec-mplus" class="level3" data-number="7.2.4"><h3 data-number="7.2.4" class="anchored" data-anchor-id="sec-mplus">
<span class="header-section-number">7.2.4</span> <code>Mplus</code>
</h3>
<section id="save-mplus-data-file" class="level4" data-number="7.2.4.1"><h4 data-number="7.2.4.1" class="anchored" data-anchor-id="save-mplus-data-file">
<span class="header-section-number">7.2.4.1</span> Save <code>Mplus</code> Data File</h4>
<p>Save <code>R</code> object as <code>Mplus</code> data file:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://michaelhallquist.github.io/MplusAutomation/reference/prepareMplusData.html">prepareMplusData</a></span><span class="op">(</span><span class="va">dataToImpute</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"dataToImpute.dat"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="mplus-syntax-for-multilevel-imputation" class="level4" data-number="7.2.4.2"><h4 data-number="7.2.4.2" class="anchored" data-anchor-id="mplus-syntax-for-multilevel-imputation">
<span class="header-section-number">7.2.4.2</span> <code>Mplus</code> Syntax for Multilevel Imputation</h4>
<p><code>Mplus</code> syntax for multilevel imputation:</p>
<pre class="mplus"><code>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!  MPLUS SYNTAX LINES CANNOT EXCEED 90 CHARACTERS;
!!!!!  VARIABLE NAMES AND PARAMETER LABELS CANNOT EXCEED 8 CHARACTERS EACH;
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

TITLE: Model Title

DATA: FILE = "dataToImpute.dat";

VARIABLE:
  NAMES = id age height Occasion;
  MISSING = .;
  USEVARIABLES ARE age height Occasion;
  !CATEGORICAL ARE INSERT_NAMES_OF_CATEGORICAL_VARIABLES_HERE;
  CLUSTER = id;

ANALYSIS:
  TYPE = twolevel basic;
  bseed = 52242;
  PROCESSORS = 2;
    
DATA IMPUTATION:
  IMPUTE = age(0-100) height Occasion; !put ' (c)' after categorical vars
  NDATASETS = 100;
  SAVE = imp*.dat</code></pre>
<p>Putting a range of values after a variable (e.g., <code>0-100</code>) sets the lower and upper bounds of the imputed values. This would save a <code>implist.dat</code> file that can be used to run the model on the multiply imputed data, as shown <a href="./mplus.html#sec-multipleImputation">here</a>.</p>
</section></section></section></section><section id="parallel-processing" class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> Parallel Processing</h1>
<p><a href="https://www.gerkovink.com/miceVignettes/futuremice/Vignette_futuremice.html" class="uri">https://www.gerkovink.com/miceVignettes/futuremice/Vignette_futuremice.html</a> (archived at <a href="https://perma.cc/4SNE-RCSR" class="uri">https://perma.cc/4SNE-RCSR</a>)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mi_parallel_mice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/futuremice.html">futuremice</a></span><span class="op">(</span></span>
<span>  <span class="va">dataToImpute</span>,</span>
<span>  method <span class="op">=</span> <span class="va">meth</span>,</span>
<span>  predictorMatrix <span class="op">=</span> <span class="va">pred</span>,</span>
<span>  m <span class="op">=</span> <span class="va">numImputations</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">5</span>, <span class="co"># generally use 100 maximum iterations; this example uses 5 for speed</span></span>
<span>  parallelseed <span class="op">=</span> <span class="fl">52242</span>,</span>
<span>  n.core <span class="op">=</span> <span class="va">numCores</span>,</span>
<span>  packages <span class="op">=</span> <span class="st">"miceadds"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="imputation-diagnostics" class="level1" data-number="9"><h1 data-number="9">
<span class="header-section-number">9</span> Imputation Diagnostics</h1>
<section id="logged-events" class="level2" data-number="9.1"><h2 data-number="9.1" class="anchored" data-anchor-id="logged-events">
<span class="header-section-number">9.1</span> Logged Events</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mi_mice</span><span class="op">$</span><span class="va">loggedEvents</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
</section><section id="trace-plots" class="level2" data-number="9.2"><h2 data-number="9.2" class="anchored" data-anchor-id="trace-plots">
<span class="header-section-number">9.2</span> Trace Plots</h2>
<p>On convergence, the streams of the trace plots should intermingle and be free of any trend (at the later iterations). Convergence is diagnosed when the variance between different sequences is no larger than the variance within each individual sequence.</p>
<ul>
<li>
<a href="https://stefvanbuuren.name/fimd/sec-algoptions.html" class="uri">https://stefvanbuuren.name/fimd/sec-algoptions.html</a> (archived at <a href="https://perma.cc/4S54-465R" class="uri">https://perma.cc/4S54-465R</a>)</li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mi_mice</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"height"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="multipleImputation_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="multipleImputation_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="density-plots" class="level2" data-number="9.3"><h2 data-number="9.3" class="anchored" data-anchor-id="density-plots">
<span class="header-section-number">9.3</span> Density Plots</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/histogram.html">densityplot</a></span><span class="op">(</span><span class="va">mi_mice</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="multipleImputation_files/figure-html/unnamed-chunk-23-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="multipleImputation_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/histogram.html">densityplot</a></span><span class="op">(</span><span class="va">mi_mice</span>, <span class="op">~</span> <span class="va">height</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="multipleImputation_files/figure-html/unnamed-chunk-23-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="multipleImputation_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="strip-plots" class="level2" data-number="9.4"><h2 data-number="9.4" class="anchored" data-anchor-id="strip-plots">
<span class="header-section-number">9.4</span> Strip Plots</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html">stripplot</a></span><span class="op">(</span><span class="va">mi_mice</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="multipleImputation_files/figure-html/unnamed-chunk-24-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="multipleImputation_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html">stripplot</a></span><span class="op">(</span><span class="va">mi_mice</span>, <span class="va">height</span> <span class="op">~</span> <span class="va">.imp</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="multipleImputation_files/figure-html/unnamed-chunk-24-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="multipleImputation_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section></section><section id="post-processing" class="level1" data-number="10"><h1 data-number="10">
<span class="header-section-number">10</span> Post-Processing</h1>
<section id="modifycreate-new-variables" class="level2" data-number="10.1"><h2 data-number="10.1" class="anchored" data-anchor-id="modifycreate-new-variables">
<span class="header-section-number">10.1</span> Modify/Create New Variables</h2>
<section id="mice" class="level3" data-number="10.1.1"><h3 data-number="10.1.1" class="anchored" data-anchor-id="mice">
<span class="header-section-number">10.1.1</span> <code>mice</code>
</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mi_mice_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/complete.html">complete</a></span><span class="op">(</span></span>
<span>  <span class="va">mi_mice</span>,</span>
<span>  action <span class="op">=</span> <span class="st">"long"</span>,</span>
<span>  include <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mi_mice_long</span><span class="op">$</span><span class="va">newVar</span> <span class="op">&lt;-</span> <span class="va">mi_mice_long</span><span class="op">$</span><span class="va">age</span> <span class="op">*</span> <span class="va">mi_mice_long</span><span class="op">$</span><span class="va">height</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="jomo" class="level3" data-number="10.1.2"><h3 data-number="10.1.2" class="anchored" data-anchor-id="jomo">
<span class="header-section-number">10.1.2</span> <code>jomo</code>
</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mi_jomo</span> <span class="op">&lt;-</span> <span class="va">mi_jomo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>height <span class="op">=</span> <span class="va">dataToImpute...level1Vars.</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mi_jomo</span><span class="op">$</span><span class="va">newVar</span> <span class="op">&lt;-</span> <span class="va">mi_jomo</span><span class="op">$</span><span class="va">age</span> <span class="op">*</span> <span class="va">mi_jomo</span><span class="op">$</span><span class="va">height</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="amelia" class="level3" data-number="10.1.3"><h3 data-number="10.1.3" class="anchored" data-anchor-id="amelia">
<span class="header-section-number">10.1.3</span> <code>Amelia</code>
</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">mi_amelia</span><span class="op">$</span><span class="va">imputations</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">mi_amelia</span><span class="op">$</span><span class="va">imputations</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">newVar</span> <span class="op">&lt;-</span> <span class="va">mi_amelia</span><span class="op">$</span><span class="va">imputations</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">age</span> <span class="op">*</span> <span class="va">mi_amelia</span><span class="op">$</span><span class="va">imputations</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">height</span></span>
<span><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section><section id="convert-to-mids-object" class="level2" data-number="10.2"><h2 data-number="10.2" class="anchored" data-anchor-id="convert-to-mids-object">
<span class="header-section-number">10.2</span> Convert to <code>mids</code> object</h2>
<section id="mice-1" class="level3" data-number="10.2.1"><h3 data-number="10.2.1" class="anchored" data-anchor-id="mice-1">
<span class="header-section-number">10.2.1</span> <code>mice</code>
</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mi_mice_mids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/as.mids.html">as.mids</a></span><span class="op">(</span><span class="va">mi_mice_long</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="jomo-1" class="level3" data-number="10.2.2"><h3 data-number="10.2.2" class="anchored" data-anchor-id="jomo-1">
<span class="header-section-number">10.2.2</span> <code>jomo</code>
</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mi_jomo_mids</span> <span class="op">&lt;-</span> <span class="fu">miceadds</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/miceadds/man/jomo2datlist.html">jomo2mids</a></span><span class="op">(</span><span class="va">mi_jomo</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="amelia-1" class="level3" data-number="10.2.3"><h3 data-number="10.2.3" class="anchored" data-anchor-id="amelia-1">
<span class="header-section-number">10.2.3</span> <code>Amelia</code>
</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mi_amelia_mids</span> <span class="op">&lt;-</span> <span class="fu">miceadds</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/miceadds/man/datalist2mids.html">datlist2mids</a></span><span class="op">(</span><span class="va">mi_amelia</span><span class="op">$</span><span class="va">imputations</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section><section id="export-for-mplus" class="level2" data-number="10.3"><h2 data-number="10.3" class="anchored" data-anchor-id="export-for-mplus">
<span class="header-section-number">10.3</span> Export for <code>Mplus</code>
</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://amices.org/mice/reference/mids2mplus.html">mids2mplus</a></span><span class="op">(</span><span class="va">mi_mice_mids</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"InsertFilePathHere"</span>, fsep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://amices.org/mice/reference/mids2mplus.html">mids2mplus</a></span><span class="op">(</span><span class="va">mi_jomo_mids</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"InsertFilePathHere"</span>, fsep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://amices.org/mice/reference/mids2mplus.html">mids2mplus</a></span><span class="op">(</span><span class="va">mi_amelia_mids</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"InsertFilePathHere"</span>, fsep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section><section id="fit-model-to-multiply-imputed-data" class="level1" data-number="11"><h1 data-number="11">
<span class="header-section-number">11</span> Fit Model to Multiply Imputed Data</h1>
<section id="sec-multiple-regression" class="level2" data-number="11.1"><h2 data-number="11.1" class="anchored" data-anchor-id="sec-multiple-regression">
<span class="header-section-number">11.1</span> Multiple Regression</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mi_mice</span>,</span>
<span>  expr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">Occasion</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="pool-results-across-models" class="level3" data-number="11.1.1"><h3 data-number="11.1.1" class="anchored" data-anchor-id="pool-results-across-models">
<span class="header-section-number">11.1.1</span> Pool Results Across Models</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_lm_pooled</span> <span class="op">&lt;-</span> <span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/pool.html">pool</a></span><span class="op">(</span><span class="va">fit_lm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_lm_pooled</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Class: mipo    m = 5 
         term m   estimate      ubar          b         t dfcom       df
1 (Intercept) 5 129.438605 474.39271 16.2213875 493.85838   231 202.6802
2         age 5  -9.578321 313.63940 10.4968785 326.23565   231 203.4844
3    Occasion 5   4.074297  19.66783  0.6460228  20.44305   231 204.1678
         riv     lambda        fmi
1 0.04103281 0.03941548 0.04875604
2 0.04016158 0.03861091 0.04792289
3 0.03941602 0.03792131 0.04720923</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_lm_pooled</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["fct"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"129.438605","3":"22.22292","4":"5.8245531","5":"202.6802","6":"2.220406e-08"},{"1":"age","2":"-9.578321","3":"18.06199","4":"-0.5303025","5":"203.4844","6":"5.964804e-01"},{"1":"Occasion","2":"4.074297","3":"4.52140","4":"0.9011142","5":"204.1678","6":"3.685893e-01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="sec-mixed-model" class="level2" data-number="11.2"><h2 data-number="11.2" class="anchored" data-anchor-id="sec-mixed-model">
<span class="header-section-number">11.2</span> Mixed Model</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_lmer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mi_mice</span>,</span>
<span>  expr <span class="op">=</span> <span class="fu">lme4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">Occasion</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="pool-results-across-models-1" class="level3" data-number="11.2.1"><h3 data-number="11.2.1" class="anchored" data-anchor-id="pool-results-across-models-1">
<span class="header-section-number">11.2.1</span> Pool Results Across Models</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_lmer_pooled</span> <span class="op">&lt;-</span> <span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/pool.html">pool</a></span><span class="op">(</span><span class="va">fit_lmer</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_lmer_pooled</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Class: mipo    m = 5 
         term m  estimate       ubar          b          t dfcom       df
1 (Intercept) 5 130.90722 115.993407 17.2741850 136.722429   229 91.41894
2         age 5  -8.38242  75.323709 11.3734859  88.971892   229 90.20628
3    Occasion 5   3.77516   4.723413  0.6938743   5.556062   229 92.62682
        riv    lambda       fmi
1 0.1787086 0.1516139 0.1695846
2 0.1811937 0.1533988 0.1715650
3 0.1762813 0.1498632 0.1676435</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_lmer_pooled</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["fct"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"130.90722","3":"11.692837","4":"11.1955061","5":"91.41894","6":"7.898809e-19"},{"1":"age","2":"-8.38242","3":"9.432491","4":"-0.8886751","5":"90.20628","6":"3.765413e-01"},{"1":"Occasion","2":"3.77516","3":"2.357130","4":"1.6015917","5":"92.62682","6":"1.126510e-01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section></section><section id="model-implied-predictions" class="level1" data-number="12"><h1 data-number="12">
<span class="header-section-number">12</span> Model-Implied Predictions</h1>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/predict_mi.html">predict_mi</a></span><span class="op">(</span></span>
<span>  <span class="va">fit_lm</span>,</span>
<span>  <span class="co">#newdata = # can include if want to make predictions based on another (i.e., "new") data object</span></span>
<span>  se.fit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$fit
       fit      lwr      upr
1 143.0912 126.6977 159.4847
2 144.7508 128.3986 161.1030
3 146.0963 129.7770 162.4156
4 147.3095 130.8591 163.7599
5 149.8360 133.5256 166.1463
6 151.5224 135.2058 167.8390

$se.fit
[1] 1.1025053 0.9291539 0.7638337 1.3045752 0.7125974 0.7486208

$df
[1]  1460.8931  1415.7428   637.8606   935.7190  6385.4620 20758.0027

$residual.scale
[1] 8.290191</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/predict_mi.html">predict_mi</a></span><span class="op">(</span></span>
<span>  <span class="va">fit_lmer</span>,</span>
<span>  <span class="co">#newdata = # can include if want to make predictions based on another (i.e., "new") data object</span></span>
<span>  se.fit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `predict_mi.mira()`:
! `predict_mi()` currently only works with the linear model.</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-error">
<pre><code>Error in `predict_mi.mira()`:
! `predict_mi()` currently only works with the linear model.</code></pre>
</div>
</div>
</section><section id="resources" class="level1" data-number="13"><h1 data-number="13">
<span class="header-section-number">13</span> Resources</h1>
<p><a href="https://stefvanbuuren.name/fimd" class="uri">https://stefvanbuuren.name/fimd</a> (archived at <a href="https://perma.cc/46U2-QTM6" class="uri">https://perma.cc/46U2-QTM6</a>)</p>
<p><a href="https://www.gerkovink.com/miceVignettes/Multi_level/Multi_level_data.html" class="uri">https://www.gerkovink.com/miceVignettes/Multi_level/Multi_level_data.html</a> (archived at <a href="https://perma.cc/SF32-D7ZF" class="uri">https://perma.cc/SF32-D7ZF</a>)</p>
</section><section id="session-info" class="level1" data-number="14"><h1 data-number="14">
<span class="header-section-number">14</span> Session Info</h1>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.2 (2025-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] MplusAutomation_1.2 broom.mixed_0.2.9.6 lme4_1.1-38        
 [4] Matrix_1.7-4        nlme_3.1-168        furrr_0.3.1        
 [7] future_1.69.0       parallelly_1.46.1   jomo_2.7-6         
[10] Amelia_1.8.3        Rcpp_1.1.1          mitml_0.4-5        
[13] miceadds_3.18-36    micemd_1.10.1       mice_3.19.0        
[16] psych_2.5.6         lubridate_1.9.4     forcats_1.0.1      
[19] stringr_1.6.0       dplyr_1.1.4         purrr_1.2.1        
[22] readr_2.1.6         tidyr_1.3.2         tibble_3.3.1       
[25] ggplot2_4.0.1       tidyverse_2.0.0    

loaded via a namespace (and not attached):
  [1] RColorBrewer_1.1-3  jsonlite_2.0.0      GJRM_0.2-6.8       
  [4] shape_1.4.6.1       magrittr_2.0.4      farver_2.1.2       
  [7] nloptr_2.2.1        rmarkdown_2.30      vctrs_0.7.1        
 [10] minqa_1.2.8         htmltools_0.5.9     survey_4.4-8       
 [13] broom_1.0.12        htmlwidgets_1.6.4   gsubfn_0.7         
 [16] plyr_1.8.9          copula_1.1-6        sfsmisc_1.1-23     
 [19] lifecycle_1.0.5     startupmsg_1.0.0    iterators_1.0.14   
 [22] pkgconfig_2.0.3     R6_2.6.1            fastmap_1.2.0      
 [25] rbibutils_2.4.1     magic_1.6-1         digest_0.6.39      
 [28] numDeriv_2016.8-1.1 ismev_1.43          timechange_0.3.0   
 [31] pspline_1.0-21      httr_1.4.7          abind_1.4-8        
 [34] mgcv_1.9-3          compiler_4.5.2      mvmeta_1.0.3       
 [37] pander_0.6.6        withr_3.0.2         gsl_2.1-9          
 [40] S7_0.2.1            backports_1.5.0     DBI_1.2.3          
 [43] fastDummies_1.7.5   pan_1.9             MASS_7.3-65        
 [46] distr_2.9.7         VineCopula_2.6.1    tools_4.5.2        
 [49] pbivnorm_0.6.0      foreign_0.8-90      trust_0.1-8        
 [52] otel_0.2.0          nnet_7.3-20         glue_1.8.0         
 [55] stabledist_0.7-2    grid_4.5.2          checkmate_2.3.3    
 [58] generics_0.1.4      gtable_0.3.6        tzdb_0.5.0         
 [61] data.table_1.18.2.1 hms_1.1.4           foreach_1.5.2      
 [64] pillar_1.11.1       mitools_2.4         splines_4.5.2      
 [67] lattice_0.22-7      survival_3.8-3      gmp_0.7-5          
 [70] tidyselect_1.2.1    ADGofTest_0.3       knitr_1.51         
 [73] reformulas_0.4.3.1  stats4_4.5.2        xfun_0.56          
 [76] mixmeta_1.2.2       texreg_1.39.5       matrixStats_1.5.0  
 [79] proto_1.0.0         scam_1.2-21         stringi_1.8.7      
 [82] VGAM_1.1-14         yaml_2.3.12         boot_1.3-32        
 [85] evaluate_1.0.5      codetools_0.2-20    evd_2.3-7.1        
 [88] cli_3.6.5           rpart_4.1.24        xtable_1.8-4       
 [91] Rdpack_2.6.5        distrEx_2.9.6       globals_0.18.0     
 [94] coda_0.19-4.1       parallel_4.5.2      listenv_0.10.0     
 [97] gamlss.dist_6.1-1   Rmpfr_1.1-2         glmnet_4.1-10      
[100] mvtnorm_1.3-3       scales_1.4.0        pcaPP_2.0-5        
[103] rlang_1.1.7         mnormt_2.1.2       </code></pre>
</div>
</div>


<!-- -->

</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section></div></main><!-- /main --><!-- Add lab logo --><p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%"></a>
</p>

<br><hr>
<br><!-- Add icon library --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!-- Add font awesome icons --><p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/devpsylab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/DevPsyLab\.github\.io\/DataAnalysis\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Multiple Imputation"</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">   html:</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co">     df-print: default</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="fu"># Preamble</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## Install Libraries</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("remotes")</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github("DevPsyLab/petersenlab")</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load Libraries</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"psych"</span>)</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mice"</span>)</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"micemd"</span>)</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"miceadds"</span>)</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mitml"</span>)</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"Amelia"</span>)</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"jomo"</span>)</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"parallelly"</span>)</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"future"</span>)</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"furrr"</span>)</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"nlme"</span>)</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"lme4"</span>)</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"broom.mixed"</span>)</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"MplusAutomation"</span>)</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Oxboys, <span class="at">package =</span> <span class="st">"nlme"</span>)</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>Oxboys_addNA <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Oxboys)</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>Oxboys_addNA <span class="ot">&lt;-</span> Oxboys_addNA <span class="sc">%&gt;%</span> </span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> Subject)</span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>Oxboys_addNA<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(Oxboys_addNA<span class="sc">$</span>id)</span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>Oxboys_addNA<span class="sc">$</span>Occasion <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(Oxboys_addNA<span class="sc">$</span>Occasion)</span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a>Oxboys_addNA[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Oxboys_addNA), <span class="dv">25</span>), <span class="st">"height"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a>dataToImpute <span class="ot">&lt;-</span> Oxboys_addNA</span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a><span class="fu"># Types of Missingness</span></span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Missing Completely at Random (MCAR)</span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>the probability of being missing is the same for all cases</span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>missingness is not related to variables in the model</span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>(Conditionally) Missing at Random (MAR)</span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>missingness is related to variables in the model, but once we condition on the variables in the model, the missingness is haphazard</span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>the unobserved values do not play a role</span>
<span id="cb54-69"><a href="#cb54-69" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Missing Not at Random (MNAR)</span>
<span id="cb54-70"><a href="#cb54-70" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>missingness is related to variables that are not in the model (i.e., for reasons that are unknown)</span>
<span id="cb54-71"><a href="#cb54-71" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>unobserved variables carry information about whether a case will have missing data</span>
<span id="cb54-72"><a href="#cb54-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-73"><a href="#cb54-73" aria-hidden="true" tabindex="-1"></a><span class="fu"># Approaches to Handle Missing Data</span></span>
<span id="cb54-74"><a href="#cb54-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-75"><a href="#cb54-75" aria-hidden="true" tabindex="-1"></a><span class="fu">## For MCAR/MAR Missingness</span></span>
<span id="cb54-76"><a href="#cb54-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-77"><a href="#cb54-77" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Full Information Maximum Likelihood (FIML)</span>
<span id="cb54-78"><a href="#cb54-78" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Multiple Imputation</span>
<span id="cb54-79"><a href="#cb54-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-80"><a href="#cb54-80" aria-hidden="true" tabindex="-1"></a><span class="fu">## For MNAR Missingness</span></span>
<span id="cb54-81"><a href="#cb54-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-82"><a href="#cb54-82" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stefvanbuuren.name/fimd/sec-nonignorable.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/N7WW-HDZF&gt;</span>)</span>
<span id="cb54-83"><a href="#cb54-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-84"><a href="#cb54-84" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://cran.r-project.org/web/packages/missingHE/vignettes/Fitting_MNAR_models_in_missingHE.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/9X25-5D8G&gt;</span>)</span>
<span id="cb54-85"><a href="#cb54-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-86"><a href="#cb54-86" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>find more data about the causes for the missingness</span>
<span id="cb54-87"><a href="#cb54-87" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>sensitivity analyses (what-if analyses) to see how sensitive the results are under various scenarios</span>
<span id="cb54-88"><a href="#cb54-88" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="ot">&lt;https://stefvanbuuren.name/fimd/sec-MCAR.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/9KM9-3NX3&gt;</span>)</span>
<span id="cb54-89"><a href="#cb54-89" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>selection models</span>
<span id="cb54-90"><a href="#cb54-90" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>simultaneously estimate the focal model and a missingness model, where the missingness model has the missing data indicator as a dependent variable, as predicted by the original dependent variable, the original predictors, and any additional covariates etc.</span>
<span id="cb54-91"><a href="#cb54-91" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>if the missingness model is approximately correct, the focal model adjusts in way that removes nonresponse bias</span>
<span id="cb54-92"><a href="#cb54-92" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>similar to a mediation process</span>
<span id="cb54-93"><a href="#cb54-93" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>X → Y</span>
<span id="cb54-94"><a href="#cb54-94" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Y → missingness</span>
<span id="cb54-95"><a href="#cb54-95" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>X → missingness</span>
<span id="cb54-96"><a href="#cb54-96" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="ot">&lt;https://quantitudepod.org/s4e08-craig-enders/&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/FY9L-L3F7&gt;</span>)</span>
<span id="cb54-97"><a href="#cb54-97" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>pattern-mixture models</span>
<span id="cb54-98"><a href="#cb54-98" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>missing data indicator is a predictor variable</span>
<span id="cb54-99"><a href="#cb54-99" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>similar to a moderation process; subgroups of cases have different parameter estimates</span>
<span id="cb54-100"><a href="#cb54-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-101"><a href="#cb54-101" aria-hidden="true" tabindex="-1"></a><span class="fu"># Approaches to Multiple Imputation</span></span>
<span id="cb54-102"><a href="#cb54-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-103"><a href="#cb54-103" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>multiple imputation by joint modeling</span>
<span id="cb54-104"><a href="#cb54-104" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>assumes that the variables in follow a joint distribution, e.g.:</span>
<span id="cb54-105"><a href="#cb54-105" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>multivariate normal (i.e., multivariate normal imputation)</span>
<span id="cb54-106"><a href="#cb54-106" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="in">`R`</span> packages:</span>
<span id="cb54-107"><a href="#cb54-107" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`jomo`</span></span>
<span id="cb54-108"><a href="#cb54-108" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`pan`</span></span>
<span id="cb54-109"><a href="#cb54-109" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`Amelia`</span></span>
<span id="cb54-110"><a href="#cb54-110" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`Mplus`</span></span>
<span id="cb54-111"><a href="#cb54-111" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>multiple imputation by chained equations</span>
<span id="cb54-112"><a href="#cb54-112" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>aka:</span>
<span id="cb54-113"><a href="#cb54-113" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>fully conditional specification multiple imputation</span>
<span id="cb54-114"><a href="#cb54-114" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>sequential regression multiple imputation</span>
<span id="cb54-115"><a href="#cb54-115" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="in">`R`</span> packages:</span>
<span id="cb54-116"><a href="#cb54-116" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`mice`</span></span>
<span id="cb54-117"><a href="#cb54-117" aria-hidden="true" tabindex="-1"></a><span class="ss">            - </span>predictive mean matching (<span class="in">`?mice::mice.impute.pmm`</span>) can be useful to obtain bounded imputations for non-normally distributed variables</span>
<span id="cb54-118"><a href="#cb54-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-119"><a href="#cb54-119" aria-hidden="true" tabindex="-1"></a><span class="fu"># Describe Missing Data</span></span>
<span id="cb54-120"><a href="#cb54-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-123"><a href="#cb54-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-124"><a href="#cb54-124" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb54-125"><a href="#cb54-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-126"><a href="#cb54-126" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(dataToImpute)</span>
<span id="cb54-127"><a href="#cb54-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-128"><a href="#cb54-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-131"><a href="#cb54-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-132"><a href="#cb54-132" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb54-133"><a href="#cb54-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-134"><a href="#cb54-134" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(psych<span class="sc">::</span><span class="fu">describe</span>(dataToImpute))</span>
<span id="cb54-135"><a href="#cb54-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-136"><a href="#cb54-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-139"><a href="#cb54-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-140"><a href="#cb54-140" aria-hidden="true" tabindex="-1"></a>mice<span class="sc">::</span><span class="fu">md.pattern</span>(dataToImpute, <span class="at">rotate.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-141"><a href="#cb54-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-142"><a href="#cb54-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-143"><a href="#cb54-143" aria-hidden="true" tabindex="-1"></a><span class="fu"># Pre-Imputation Setup</span></span>
<span id="cb54-144"><a href="#cb54-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-145"><a href="#cb54-145" aria-hidden="true" tabindex="-1"></a><span class="fu">## Specify Variables to Impute</span></span>
<span id="cb54-146"><a href="#cb54-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-149"><a href="#cb54-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-150"><a href="#cb54-150" aria-hidden="true" tabindex="-1"></a>varsToImpute <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"height"</span>)</span>
<span id="cb54-151"><a href="#cb54-151" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> varsToImpute</span>
<span id="cb54-152"><a href="#cb54-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-153"><a href="#cb54-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-154"><a href="#cb54-154" aria-hidden="true" tabindex="-1"></a><span class="fu">## Specify Number of Imputations</span></span>
<span id="cb54-155"><a href="#cb54-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-158"><a href="#cb54-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-159"><a href="#cb54-159" aria-hidden="true" tabindex="-1"></a>numImputations <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># generally use 100 imputations; this example uses 5 for speed</span></span>
<span id="cb54-160"><a href="#cb54-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-161"><a href="#cb54-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-162"><a href="#cb54-162" aria-hidden="true" tabindex="-1"></a><span class="fu">## Detect Cores</span></span>
<span id="cb54-163"><a href="#cb54-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-166"><a href="#cb54-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-167"><a href="#cb54-167" aria-hidden="true" tabindex="-1"></a>numCores <span class="ot">&lt;-</span> parallelly<span class="sc">::</span><span class="fu">availableCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb54-168"><a href="#cb54-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-169"><a href="#cb54-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-170"><a href="#cb54-170" aria-hidden="true" tabindex="-1"></a><span class="fu"># Multilevel Multiple Imputation</span></span>
<span id="cb54-171"><a href="#cb54-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-172"><a href="#cb54-172" aria-hidden="true" tabindex="-1"></a><span class="fu">## Three-Level and Cross-Classified Data</span></span>
<span id="cb54-173"><a href="#cb54-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-174"><a href="#cb54-174" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://simongrund1.github.io/posts/multiple-imputation-for-three-level-and-cross-classified-data/&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/N4PP-A3V6&gt;</span>)</span>
<span id="cb54-175"><a href="#cb54-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-176"><a href="#cb54-176" aria-hidden="true" tabindex="-1"></a><span class="fu">## Methods</span></span>
<span id="cb54-177"><a href="#cb54-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-178"><a href="#cb54-178" aria-hidden="true" tabindex="-1"></a><span class="fu">### `mice` {#sec-mice}</span></span>
<span id="cb54-179"><a href="#cb54-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-180"><a href="#cb54-180" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Types</span></span>
<span id="cb54-181"><a href="#cb54-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-182"><a href="#cb54-182" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Continuous Outcomes</span></span>
<span id="cb54-183"><a href="#cb54-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-184"><a href="#cb54-184" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stefvanbuuren.name/fimd/sec-multioutcome.html#methods&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/8CDA-TS3K&gt;</span>)</span>
<span id="cb54-185"><a href="#cb54-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-188"><a href="#cb54-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-189"><a href="#cb54-189" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb54-190"><a href="#cb54-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-191"><a href="#cb54-191" aria-hidden="true" tabindex="-1"></a>?mice<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.norm</span>
<span id="cb54-192"><a href="#cb54-192" aria-hidden="true" tabindex="-1"></a>?mice<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.pan</span>
<span id="cb54-193"><a href="#cb54-193" aria-hidden="true" tabindex="-1"></a>?mice<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.lmer</span>
<span id="cb54-194"><a href="#cb54-194" aria-hidden="true" tabindex="-1"></a>?miceadds<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.pmm</span>
<span id="cb54-195"><a href="#cb54-195" aria-hidden="true" tabindex="-1"></a>?miceadds<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.contextual.pmm</span>
<span id="cb54-196"><a href="#cb54-196" aria-hidden="true" tabindex="-1"></a>?miceadds<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.continuous</span>
<span id="cb54-197"><a href="#cb54-197" aria-hidden="true" tabindex="-1"></a>?micemd<span class="sc">::</span>mice.impute<span class="fl">.2</span>l<span class="fl">.2</span>stage.norm</span>
<span id="cb54-198"><a href="#cb54-198" aria-hidden="true" tabindex="-1"></a>?micemd<span class="sc">::</span>mice.impute<span class="fl">.2</span>l<span class="fl">.2</span>stage.pmm</span>
<span id="cb54-199"><a href="#cb54-199" aria-hidden="true" tabindex="-1"></a>?micemd<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.glm.norm</span>
<span id="cb54-200"><a href="#cb54-200" aria-hidden="true" tabindex="-1"></a>?micemd<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.jomo</span>
<span id="cb54-201"><a href="#cb54-201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-202"><a href="#cb54-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-203"><a href="#cb54-203" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Binary Outcomes</span></span>
<span id="cb54-204"><a href="#cb54-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-205"><a href="#cb54-205" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stefvanbuuren.name/fimd/sec-catoutcome.html#methods-1&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/5QHF-YRP6&gt;</span>)</span>
<span id="cb54-206"><a href="#cb54-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-209"><a href="#cb54-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-210"><a href="#cb54-210" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb54-211"><a href="#cb54-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-212"><a href="#cb54-212" aria-hidden="true" tabindex="-1"></a>?mice<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.bin</span>
<span id="cb54-213"><a href="#cb54-213" aria-hidden="true" tabindex="-1"></a>?miceadds<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.binary</span>
<span id="cb54-214"><a href="#cb54-214" aria-hidden="true" tabindex="-1"></a>?miceadds<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.pmm</span>
<span id="cb54-215"><a href="#cb54-215" aria-hidden="true" tabindex="-1"></a>?miceadds<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.contextual.pmm</span>
<span id="cb54-216"><a href="#cb54-216" aria-hidden="true" tabindex="-1"></a>?micemd<span class="sc">::</span>mice.impute<span class="fl">.2</span>l<span class="fl">.2</span>stage.bin</span>
<span id="cb54-217"><a href="#cb54-217" aria-hidden="true" tabindex="-1"></a>?micemd<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.glm.bin</span>
<span id="cb54-218"><a href="#cb54-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-219"><a href="#cb54-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-220"><a href="#cb54-220" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Ordinal Outcomes</span></span>
<span id="cb54-221"><a href="#cb54-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-222"><a href="#cb54-222" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stefvanbuuren.name/fimd/sec-multioutcome.html#methods&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/8CDA-TS3K&gt;</span>)</span>
<span id="cb54-223"><a href="#cb54-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-226"><a href="#cb54-226" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-227"><a href="#cb54-227" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb54-228"><a href="#cb54-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-229"><a href="#cb54-229" aria-hidden="true" tabindex="-1"></a>?miceadds<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.pmm</span>
<span id="cb54-230"><a href="#cb54-230" aria-hidden="true" tabindex="-1"></a>?miceadds<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.contextual.pmm</span>
<span id="cb54-231"><a href="#cb54-231" aria-hidden="true" tabindex="-1"></a>?micemd<span class="sc">::</span>mice.impute<span class="fl">.2</span>l<span class="fl">.2</span>stage.pmm</span>
<span id="cb54-232"><a href="#cb54-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-233"><a href="#cb54-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-234"><a href="#cb54-234" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Count Outcomes</span></span>
<span id="cb54-235"><a href="#cb54-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-236"><a href="#cb54-236" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stefvanbuuren.name/fimd/sec-catoutcome.html#methods-1&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/5QHF-YRP6&gt;</span>)</span>
<span id="cb54-237"><a href="#cb54-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-240"><a href="#cb54-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-241"><a href="#cb54-241" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb54-242"><a href="#cb54-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-243"><a href="#cb54-243" aria-hidden="true" tabindex="-1"></a>?micemd<span class="sc">::</span>mice.impute<span class="fl">.2</span>l<span class="fl">.2</span>stage.pois</span>
<span id="cb54-244"><a href="#cb54-244" aria-hidden="true" tabindex="-1"></a>?micemd<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.glm.pois</span>
<span id="cb54-245"><a href="#cb54-245" aria-hidden="true" tabindex="-1"></a>?countimp<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.poisson</span>
<span id="cb54-246"><a href="#cb54-246" aria-hidden="true" tabindex="-1"></a>?countimp<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.nb2</span>
<span id="cb54-247"><a href="#cb54-247" aria-hidden="true" tabindex="-1"></a>?countimp<span class="sc">::</span>mice.impute<span class="fl">.2</span>l.zihnb</span>
<span id="cb54-248"><a href="#cb54-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-249"><a href="#cb54-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-250"><a href="#cb54-250" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Specifying the Imputation Method</span></span>
<span id="cb54-251"><a href="#cb54-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-254"><a href="#cb54-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-255"><a href="#cb54-255" aria-hidden="true" tabindex="-1"></a>meth <span class="ot">&lt;-</span> <span class="fu">make.method</span>(dataToImpute)</span>
<span id="cb54-256"><a href="#cb54-256" aria-hidden="true" tabindex="-1"></a>meth[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(meth)] <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb54-257"><a href="#cb54-257" aria-hidden="true" tabindex="-1"></a>meth[Y] <span class="ot">&lt;-</span> <span class="st">"2l.pmm"</span> <span class="co"># specify the imputation method here; this can differ by outcome variable</span></span>
<span id="cb54-258"><a href="#cb54-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-259"><a href="#cb54-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-260"><a href="#cb54-260" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Specifying the Predictor Matrix</span></span>
<span id="cb54-261"><a href="#cb54-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-262"><a href="#cb54-262" aria-hidden="true" tabindex="-1"></a>A predictor matrix is a matrix of values, where:</span>
<span id="cb54-263"><a href="#cb54-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-264"><a href="#cb54-264" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>columns with non-zero values are predictors of the variable specified in the given row</span>
<span id="cb54-265"><a href="#cb54-265" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the diagonal of the predictor matrix should be zero because a variable cannot predict itself</span>
<span id="cb54-266"><a href="#cb54-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-267"><a href="#cb54-267" aria-hidden="true" tabindex="-1"></a>The values are:</span>
<span id="cb54-268"><a href="#cb54-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-269"><a href="#cb54-269" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>NOT a predictor of the outcome: <span class="in">`0`</span></span>
<span id="cb54-270"><a href="#cb54-270" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>cluster variable: <span class="in">`-2`</span></span>
<span id="cb54-271"><a href="#cb54-271" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>fixed effect of predictor: <span class="in">`1`</span></span>
<span id="cb54-272"><a href="#cb54-272" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>fixed effect and random effect of predictor: <span class="in">`2`</span></span>
<span id="cb54-273"><a href="#cb54-273" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>include cluster mean of predictor in addition to fixed effect of predictor: <span class="in">`3`</span></span>
<span id="cb54-274"><a href="#cb54-274" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>include cluster mean of predictor in addition to fixed effect and random effect of predictor: <span class="in">`4`</span></span>
<span id="cb54-275"><a href="#cb54-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-278"><a href="#cb54-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-279"><a href="#cb54-279" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">make.predictorMatrix</span>(dataToImpute)</span>
<span id="cb54-280"><a href="#cb54-280" aria-hidden="true" tabindex="-1"></a>pred[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pred), <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(pred)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb54-281"><a href="#cb54-281" aria-hidden="true" tabindex="-1"></a>pred[Y, <span class="st">"id"</span>] <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">2</span>) <span class="co"># cluster variable</span></span>
<span id="cb54-282"><a href="#cb54-282" aria-hidden="true" tabindex="-1"></a>pred[Y, <span class="st">"Occasion"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># fixed effect predictor</span></span>
<span id="cb54-283"><a href="#cb54-283" aria-hidden="true" tabindex="-1"></a>pred[Y, <span class="st">"age"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># random effect predictor</span></span>
<span id="cb54-284"><a href="#cb54-284" aria-hidden="true" tabindex="-1"></a>pred[Y, Y] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># fixed effect predictor</span></span>
<span id="cb54-285"><a href="#cb54-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-286"><a href="#cb54-286" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(pred) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb54-287"><a href="#cb54-287" aria-hidden="true" tabindex="-1"></a>pred</span>
<span id="cb54-288"><a href="#cb54-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-289"><a href="#cb54-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-290"><a href="#cb54-290" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Syntax</span></span>
<span id="cb54-291"><a href="#cb54-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-294"><a href="#cb54-294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-295"><a href="#cb54-295" aria-hidden="true" tabindex="-1"></a>mi_mice <span class="ot">&lt;-</span> <span class="fu">mice</span>(</span>
<span id="cb54-296"><a href="#cb54-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(dataToImpute),</span>
<span id="cb54-297"><a href="#cb54-297" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> meth,</span>
<span id="cb54-298"><a href="#cb54-298" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictorMatrix =</span> pred,</span>
<span id="cb54-299"><a href="#cb54-299" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> numImputations,</span>
<span id="cb54-300"><a href="#cb54-300" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxit =</span> <span class="dv">5</span>, <span class="co"># generally use 100 maximum iterations; this example uses 5 for speed</span></span>
<span id="cb54-301"><a href="#cb54-301" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">52242</span>)</span>
<span id="cb54-302"><a href="#cb54-302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-303"><a href="#cb54-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-304"><a href="#cb54-304" aria-hidden="true" tabindex="-1"></a><span class="fu">### `jomo` {#sec-jomo}</span></span>
<span id="cb54-305"><a href="#cb54-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-308"><a href="#cb54-308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-309"><a href="#cb54-309" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb54-310"><a href="#cb54-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-311"><a href="#cb54-311" aria-hidden="true" tabindex="-1"></a>level1Vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"height"</span>)</span>
<span id="cb54-312"><a href="#cb54-312" aria-hidden="true" tabindex="-1"></a>level2Vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"v3"</span>,<span class="st">"v4"</span>)</span>
<span id="cb54-313"><a href="#cb54-313" aria-hidden="true" tabindex="-1"></a>clusterVars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"id"</span>)</span>
<span id="cb54-314"><a href="#cb54-314" aria-hidden="true" tabindex="-1"></a>fullyObservedCovariates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age"</span>,<span class="st">"Occasion"</span>)</span>
<span id="cb54-315"><a href="#cb54-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-316"><a href="#cb54-316" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb54-317"><a href="#cb54-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-318"><a href="#cb54-318" aria-hidden="true" tabindex="-1"></a>mi_jomo <span class="ot">&lt;-</span> <span class="fu">jomo</span>(</span>
<span id="cb54-319"><a href="#cb54-319" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">data.frame</span>(dataToImpute[, level1Vars]),</span>
<span id="cb54-320"><a href="#cb54-320" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Y2 = data.frame(dataToImpute[, level2Vars]),</span></span>
<span id="cb54-321"><a href="#cb54-321" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">data.frame</span>(dataToImpute[, fullyObservedCovariates]),</span>
<span id="cb54-322"><a href="#cb54-322" aria-hidden="true" tabindex="-1"></a>  <span class="at">clus =</span> <span class="fu">data.frame</span>(dataToImpute[, clusterVars]),</span>
<span id="cb54-323"><a href="#cb54-323" aria-hidden="true" tabindex="-1"></a>  <span class="at">nimp =</span> numImputations,</span>
<span id="cb54-324"><a href="#cb54-324" aria-hidden="true" tabindex="-1"></a>  <span class="at">meth =</span> <span class="st">"random"</span></span>
<span id="cb54-325"><a href="#cb54-325" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-326"><a href="#cb54-326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-327"><a href="#cb54-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-328"><a href="#cb54-328" aria-hidden="true" tabindex="-1"></a><span class="fu">### `Amelia` {#sec-amelia}</span></span>
<span id="cb54-329"><a href="#cb54-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-330"><a href="#cb54-330" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`!`</span> in the console output indicates that the current estimated complete data covariance matrix is not invertible</span>
<span id="cb54-331"><a href="#cb54-331" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`*`</span> in the console output indicates that the likelihood has not monotonically increased in that step</span>
<span id="cb54-332"><a href="#cb54-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-335"><a href="#cb54-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-336"><a href="#cb54-336" aria-hidden="true" tabindex="-1"></a>boundVars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"height"</span>)</span>
<span id="cb54-337"><a href="#cb54-337" aria-hidden="true" tabindex="-1"></a>boundCols <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">names</span>(dataToImpute) <span class="sc">%in%</span> boundVars)</span>
<span id="cb54-338"><a href="#cb54-338" aria-hidden="true" tabindex="-1"></a>boundLower <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb54-339"><a href="#cb54-339" aria-hidden="true" tabindex="-1"></a>boundUpper <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb54-340"><a href="#cb54-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-341"><a href="#cb54-341" aria-hidden="true" tabindex="-1"></a>varBounds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(boundCols, boundLower, boundUpper)</span>
<span id="cb54-342"><a href="#cb54-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-343"><a href="#cb54-343" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb54-344"><a href="#cb54-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-345"><a href="#cb54-345" aria-hidden="true" tabindex="-1"></a>mi_amelia <span class="ot">&lt;-</span> <span class="fu">amelia</span>(</span>
<span id="cb54-346"><a href="#cb54-346" aria-hidden="true" tabindex="-1"></a>  dataToImpute,</span>
<span id="cb54-347"><a href="#cb54-347" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> numImputations,</span>
<span id="cb54-348"><a href="#cb54-348" aria-hidden="true" tabindex="-1"></a>  <span class="at">ts =</span> <span class="st">"age"</span>,</span>
<span id="cb54-349"><a href="#cb54-349" aria-hidden="true" tabindex="-1"></a>  <span class="at">cs =</span> <span class="st">"id"</span>,</span>
<span id="cb54-350"><a href="#cb54-350" aria-hidden="true" tabindex="-1"></a>  <span class="at">polytime =</span> <span class="dv">1</span>,</span>
<span id="cb54-351"><a href="#cb54-351" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-352"><a href="#cb54-352" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ords = ordinalVars,</span></span>
<span id="cb54-353"><a href="#cb54-353" aria-hidden="true" tabindex="-1"></a>  <span class="co">#bounds = varBounds,</span></span>
<span id="cb54-354"><a href="#cb54-354" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel =</span> <span class="st">"snow"</span>,</span>
<span id="cb54-355"><a href="#cb54-355" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ncpus = numCores,</span></span>
<span id="cb54-356"><a href="#cb54-356" aria-hidden="true" tabindex="-1"></a>  <span class="at">empri =</span> .<span class="dv">01</span><span class="sc">*</span><span class="fu">nrow</span>(dataToImpute)) <span class="co"># ridge prior for numerical stability</span></span>
<span id="cb54-357"><a href="#cb54-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-358"><a href="#cb54-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-359"><a href="#cb54-359" aria-hidden="true" tabindex="-1"></a><span class="fu">### `Mplus` {#sec-mplus}</span></span>
<span id="cb54-360"><a href="#cb54-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-361"><a href="#cb54-361" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Save `Mplus` Data File</span></span>
<span id="cb54-362"><a href="#cb54-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-363"><a href="#cb54-363" aria-hidden="true" tabindex="-1"></a>Save <span class="in">`R`</span> object as <span class="in">`Mplus`</span> data file:</span>
<span id="cb54-364"><a href="#cb54-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-367"><a href="#cb54-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-368"><a href="#cb54-368" aria-hidden="true" tabindex="-1"></a><span class="fu">prepareMplusData</span>(dataToImpute, <span class="fu">file.path</span>(<span class="st">"dataToImpute.dat"</span>))</span>
<span id="cb54-369"><a href="#cb54-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-370"><a href="#cb54-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-371"><a href="#cb54-371" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `Mplus` Syntax for Multilevel Imputation</span></span>
<span id="cb54-372"><a href="#cb54-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-373"><a href="#cb54-373" aria-hidden="true" tabindex="-1"></a><span class="in">`Mplus`</span> syntax for multilevel imputation:</span>
<span id="cb54-374"><a href="#cb54-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-375"><a href="#cb54-375" aria-hidden="true" tabindex="-1"></a><span class="in">```Mplus</span></span>
<span id="cb54-376"><a href="#cb54-376" aria-hidden="true" tabindex="-1"></a><span class="in">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></span>
<span id="cb54-377"><a href="#cb54-377" aria-hidden="true" tabindex="-1"></a><span class="in">!!!!!  MPLUS SYNTAX LINES CANNOT EXCEED 90 CHARACTERS;</span></span>
<span id="cb54-378"><a href="#cb54-378" aria-hidden="true" tabindex="-1"></a><span class="in">!!!!!  VARIABLE NAMES AND PARAMETER LABELS CANNOT EXCEED 8 CHARACTERS EACH;</span></span>
<span id="cb54-379"><a href="#cb54-379" aria-hidden="true" tabindex="-1"></a><span class="in">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></span>
<span id="cb54-380"><a href="#cb54-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-381"><a href="#cb54-381" aria-hidden="true" tabindex="-1"></a><span class="in">TITLE: Model Title</span></span>
<span id="cb54-382"><a href="#cb54-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-383"><a href="#cb54-383" aria-hidden="true" tabindex="-1"></a><span class="in">DATA: FILE = "dataToImpute.dat";</span></span>
<span id="cb54-384"><a href="#cb54-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-385"><a href="#cb54-385" aria-hidden="true" tabindex="-1"></a><span class="in">VARIABLE:</span></span>
<span id="cb54-386"><a href="#cb54-386" aria-hidden="true" tabindex="-1"></a><span class="in">  NAMES = id age height Occasion;</span></span>
<span id="cb54-387"><a href="#cb54-387" aria-hidden="true" tabindex="-1"></a><span class="in">  MISSING = .;</span></span>
<span id="cb54-388"><a href="#cb54-388" aria-hidden="true" tabindex="-1"></a><span class="in">  USEVARIABLES ARE age height Occasion;</span></span>
<span id="cb54-389"><a href="#cb54-389" aria-hidden="true" tabindex="-1"></a><span class="in">  !CATEGORICAL ARE INSERT_NAMES_OF_CATEGORICAL_VARIABLES_HERE;</span></span>
<span id="cb54-390"><a href="#cb54-390" aria-hidden="true" tabindex="-1"></a><span class="in">  CLUSTER = id;</span></span>
<span id="cb54-391"><a href="#cb54-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-392"><a href="#cb54-392" aria-hidden="true" tabindex="-1"></a><span class="in">ANALYSIS:</span></span>
<span id="cb54-393"><a href="#cb54-393" aria-hidden="true" tabindex="-1"></a><span class="in">  TYPE = twolevel basic;</span></span>
<span id="cb54-394"><a href="#cb54-394" aria-hidden="true" tabindex="-1"></a><span class="in">  bseed = 52242;</span></span>
<span id="cb54-395"><a href="#cb54-395" aria-hidden="true" tabindex="-1"></a><span class="in">  PROCESSORS = 2;</span></span>
<span id="cb54-396"><a href="#cb54-396" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb54-397"><a href="#cb54-397" aria-hidden="true" tabindex="-1"></a><span class="in">DATA IMPUTATION:</span></span>
<span id="cb54-398"><a href="#cb54-398" aria-hidden="true" tabindex="-1"></a><span class="in">  IMPUTE = age(0-100) height Occasion; !put ' (c)' after categorical vars</span></span>
<span id="cb54-399"><a href="#cb54-399" aria-hidden="true" tabindex="-1"></a><span class="in">  NDATASETS = 100;</span></span>
<span id="cb54-400"><a href="#cb54-400" aria-hidden="true" tabindex="-1"></a><span class="in">  SAVE = imp*.dat</span></span>
<span id="cb54-401"><a href="#cb54-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-402"><a href="#cb54-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-403"><a href="#cb54-403" aria-hidden="true" tabindex="-1"></a>Putting a range of values after a variable (e.g., <span class="in">`0-100`</span>) sets the lower and upper bounds of the imputed values.</span>
<span id="cb54-404"><a href="#cb54-404" aria-hidden="true" tabindex="-1"></a>This would save a <span class="in">`implist.dat`</span> file that can be used to run the model on the multiply imputed data, as shown <span class="co">[</span><span class="ot">here</span><span class="co">](mplus.qmd#sec-multipleImputation)</span>.</span>
<span id="cb54-405"><a href="#cb54-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-406"><a href="#cb54-406" aria-hidden="true" tabindex="-1"></a><span class="fu"># Parallel Processing</span></span>
<span id="cb54-407"><a href="#cb54-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-408"><a href="#cb54-408" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://www.gerkovink.com/miceVignettes/futuremice/Vignette_futuremice.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/4SNE-RCSR&gt;</span>)</span>
<span id="cb54-409"><a href="#cb54-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-412"><a href="#cb54-412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-413"><a href="#cb54-413" aria-hidden="true" tabindex="-1"></a>mi_parallel_mice <span class="ot">&lt;-</span> <span class="fu">futuremice</span>(</span>
<span id="cb54-414"><a href="#cb54-414" aria-hidden="true" tabindex="-1"></a>  dataToImpute,</span>
<span id="cb54-415"><a href="#cb54-415" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> meth,</span>
<span id="cb54-416"><a href="#cb54-416" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictorMatrix =</span> pred,</span>
<span id="cb54-417"><a href="#cb54-417" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> numImputations,</span>
<span id="cb54-418"><a href="#cb54-418" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxit =</span> <span class="dv">5</span>, <span class="co"># generally use 100 maximum iterations; this example uses 5 for speed</span></span>
<span id="cb54-419"><a href="#cb54-419" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallelseed =</span> <span class="dv">52242</span>,</span>
<span id="cb54-420"><a href="#cb54-420" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.core =</span> numCores,</span>
<span id="cb54-421"><a href="#cb54-421" aria-hidden="true" tabindex="-1"></a>  <span class="at">packages =</span> <span class="st">"miceadds"</span>)</span>
<span id="cb54-422"><a href="#cb54-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-423"><a href="#cb54-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-424"><a href="#cb54-424" aria-hidden="true" tabindex="-1"></a><span class="fu"># Imputation Diagnostics</span></span>
<span id="cb54-425"><a href="#cb54-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-426"><a href="#cb54-426" aria-hidden="true" tabindex="-1"></a><span class="fu">## Logged Events</span></span>
<span id="cb54-427"><a href="#cb54-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-430"><a href="#cb54-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-431"><a href="#cb54-431" aria-hidden="true" tabindex="-1"></a>mi_mice<span class="sc">$</span>loggedEvents</span>
<span id="cb54-432"><a href="#cb54-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-433"><a href="#cb54-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-434"><a href="#cb54-434" aria-hidden="true" tabindex="-1"></a><span class="fu">## Trace Plots</span></span>
<span id="cb54-435"><a href="#cb54-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-436"><a href="#cb54-436" aria-hidden="true" tabindex="-1"></a>On convergence, the streams of the trace plots should intermingle and be free of any trend (at the later iterations).</span>
<span id="cb54-437"><a href="#cb54-437" aria-hidden="true" tabindex="-1"></a>Convergence is diagnosed when the variance between different sequences is no larger than the variance within each individual sequence.</span>
<span id="cb54-438"><a href="#cb54-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-439"><a href="#cb54-439" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://stefvanbuuren.name/fimd/sec-algoptions.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/4S54-465R&gt;</span>)</span>
<span id="cb54-440"><a href="#cb54-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-443"><a href="#cb54-443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-444"><a href="#cb54-444" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mi_mice, <span class="fu">c</span>(<span class="st">"height"</span>))</span>
<span id="cb54-445"><a href="#cb54-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-446"><a href="#cb54-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-447"><a href="#cb54-447" aria-hidden="true" tabindex="-1"></a><span class="fu">## Density Plots</span></span>
<span id="cb54-448"><a href="#cb54-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-451"><a href="#cb54-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-452"><a href="#cb54-452" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(mi_mice)</span>
<span id="cb54-453"><a href="#cb54-453" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(mi_mice, <span class="sc">~</span> height)</span>
<span id="cb54-454"><a href="#cb54-454" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-455"><a href="#cb54-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-456"><a href="#cb54-456" aria-hidden="true" tabindex="-1"></a><span class="fu">## Strip Plots</span></span>
<span id="cb54-457"><a href="#cb54-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-460"><a href="#cb54-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-461"><a href="#cb54-461" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(mi_mice)</span>
<span id="cb54-462"><a href="#cb54-462" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(mi_mice, height <span class="sc">~</span> .imp)</span>
<span id="cb54-463"><a href="#cb54-463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-464"><a href="#cb54-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-465"><a href="#cb54-465" aria-hidden="true" tabindex="-1"></a><span class="fu"># Post-Processing</span></span>
<span id="cb54-466"><a href="#cb54-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-467"><a href="#cb54-467" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modify/Create New Variables</span></span>
<span id="cb54-468"><a href="#cb54-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-469"><a href="#cb54-469" aria-hidden="true" tabindex="-1"></a><span class="fu">### `mice`</span></span>
<span id="cb54-470"><a href="#cb54-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-473"><a href="#cb54-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-474"><a href="#cb54-474" aria-hidden="true" tabindex="-1"></a>mi_mice_long <span class="ot">&lt;-</span> <span class="fu">complete</span>(</span>
<span id="cb54-475"><a href="#cb54-475" aria-hidden="true" tabindex="-1"></a>  mi_mice,</span>
<span id="cb54-476"><a href="#cb54-476" aria-hidden="true" tabindex="-1"></a>  <span class="at">action =</span> <span class="st">"long"</span>,</span>
<span id="cb54-477"><a href="#cb54-477" aria-hidden="true" tabindex="-1"></a>  <span class="at">include =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-478"><a href="#cb54-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-479"><a href="#cb54-479" aria-hidden="true" tabindex="-1"></a>mi_mice_long<span class="sc">$</span>newVar <span class="ot">&lt;-</span> mi_mice_long<span class="sc">$</span>age <span class="sc">*</span> mi_mice_long<span class="sc">$</span>height</span>
<span id="cb54-480"><a href="#cb54-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-481"><a href="#cb54-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-482"><a href="#cb54-482" aria-hidden="true" tabindex="-1"></a><span class="fu">### `jomo`</span></span>
<span id="cb54-483"><a href="#cb54-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-486"><a href="#cb54-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-487"><a href="#cb54-487" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb54-488"><a href="#cb54-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-489"><a href="#cb54-489" aria-hidden="true" tabindex="-1"></a>mi_jomo <span class="ot">&lt;-</span> mi_jomo <span class="sc">%&gt;%</span> </span>
<span id="cb54-490"><a href="#cb54-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">height =</span> dataToImpute...level1Vars.)</span>
<span id="cb54-491"><a href="#cb54-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-492"><a href="#cb54-492" aria-hidden="true" tabindex="-1"></a>mi_jomo<span class="sc">$</span>newVar <span class="ot">&lt;-</span> mi_jomo<span class="sc">$</span>age <span class="sc">*</span> mi_jomo<span class="sc">$</span>height</span>
<span id="cb54-493"><a href="#cb54-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-494"><a href="#cb54-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-495"><a href="#cb54-495" aria-hidden="true" tabindex="-1"></a><span class="fu">### `Amelia`</span></span>
<span id="cb54-496"><a href="#cb54-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-499"><a href="#cb54-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-500"><a href="#cb54-500" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mi_amelia<span class="sc">$</span>imputations)){</span>
<span id="cb54-501"><a href="#cb54-501" aria-hidden="true" tabindex="-1"></a>  mi_amelia<span class="sc">$</span>imputations[[i]]<span class="sc">$</span>newVar <span class="ot">&lt;-</span> mi_amelia<span class="sc">$</span>imputations[[i]]<span class="sc">$</span>age <span class="sc">*</span> mi_amelia<span class="sc">$</span>imputations[[i]]<span class="sc">$</span>height</span>
<span id="cb54-502"><a href="#cb54-502" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-503"><a href="#cb54-503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-504"><a href="#cb54-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-505"><a href="#cb54-505" aria-hidden="true" tabindex="-1"></a><span class="fu">## Convert to `mids` object</span></span>
<span id="cb54-506"><a href="#cb54-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-507"><a href="#cb54-507" aria-hidden="true" tabindex="-1"></a><span class="fu">### `mice`</span></span>
<span id="cb54-508"><a href="#cb54-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-511"><a href="#cb54-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-512"><a href="#cb54-512" aria-hidden="true" tabindex="-1"></a>mi_mice_mids <span class="ot">&lt;-</span> <span class="fu">as.mids</span>(mi_mice_long)</span>
<span id="cb54-513"><a href="#cb54-513" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-514"><a href="#cb54-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-515"><a href="#cb54-515" aria-hidden="true" tabindex="-1"></a><span class="fu">### `jomo`</span></span>
<span id="cb54-516"><a href="#cb54-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-519"><a href="#cb54-519" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-520"><a href="#cb54-520" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb54-521"><a href="#cb54-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-522"><a href="#cb54-522" aria-hidden="true" tabindex="-1"></a>mi_jomo_mids <span class="ot">&lt;-</span> miceadds<span class="sc">::</span><span class="fu">jomo2mids</span>(mi_jomo)</span>
<span id="cb54-523"><a href="#cb54-523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-524"><a href="#cb54-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-525"><a href="#cb54-525" aria-hidden="true" tabindex="-1"></a><span class="fu">### `Amelia`</span></span>
<span id="cb54-526"><a href="#cb54-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-529"><a href="#cb54-529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-530"><a href="#cb54-530" aria-hidden="true" tabindex="-1"></a>mi_amelia_mids <span class="ot">&lt;-</span> miceadds<span class="sc">::</span><span class="fu">datlist2mids</span>(mi_amelia<span class="sc">$</span>imputations)</span>
<span id="cb54-531"><a href="#cb54-531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-532"><a href="#cb54-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-533"><a href="#cb54-533" aria-hidden="true" tabindex="-1"></a><span class="fu">## Export for `Mplus`</span></span>
<span id="cb54-534"><a href="#cb54-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-537"><a href="#cb54-537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-538"><a href="#cb54-538" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb54-539"><a href="#cb54-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-540"><a href="#cb54-540" aria-hidden="true" tabindex="-1"></a><span class="fu">mids2mplus</span>(mi_mice_mids, <span class="at">path =</span> <span class="fu">file.path</span>(<span class="st">"InsertFilePathHere"</span>, <span class="at">fsep =</span> <span class="st">""</span>))</span>
<span id="cb54-541"><a href="#cb54-541" aria-hidden="true" tabindex="-1"></a><span class="fu">mids2mplus</span>(mi_jomo_mids, <span class="at">path =</span> <span class="fu">file.path</span>(<span class="st">"InsertFilePathHere"</span>, <span class="at">fsep =</span> <span class="st">""</span>))</span>
<span id="cb54-542"><a href="#cb54-542" aria-hidden="true" tabindex="-1"></a><span class="fu">mids2mplus</span>(mi_amelia_mids, <span class="at">path =</span> <span class="fu">file.path</span>(<span class="st">"InsertFilePathHere"</span>, <span class="at">fsep =</span> <span class="st">""</span>))</span>
<span id="cb54-543"><a href="#cb54-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-544"><a href="#cb54-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-545"><a href="#cb54-545" aria-hidden="true" tabindex="-1"></a><span class="fu"># Fit Model to Multiply Imputed Data</span></span>
<span id="cb54-546"><a href="#cb54-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-547"><a href="#cb54-547" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multiple Regression {#sec-multiple-regression}</span></span>
<span id="cb54-548"><a href="#cb54-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-551"><a href="#cb54-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-552"><a href="#cb54-552" aria-hidden="true" tabindex="-1"></a>fit_lm <span class="ot">&lt;-</span> <span class="fu">with</span>(</span>
<span id="cb54-553"><a href="#cb54-553" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mi_mice,</span>
<span id="cb54-554"><a href="#cb54-554" aria-hidden="true" tabindex="-1"></a>  <span class="at">expr =</span> <span class="fu">lm</span>(height <span class="sc">~</span> age <span class="sc">+</span> Occasion))</span>
<span id="cb54-555"><a href="#cb54-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-556"><a href="#cb54-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-557"><a href="#cb54-557" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pool Results Across Models</span></span>
<span id="cb54-558"><a href="#cb54-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-561"><a href="#cb54-561" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-562"><a href="#cb54-562" aria-hidden="true" tabindex="-1"></a>fit_lm_pooled <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">pool</span>(fit_lm)</span>
<span id="cb54-563"><a href="#cb54-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-564"><a href="#cb54-564" aria-hidden="true" tabindex="-1"></a>fit_lm_pooled</span>
<span id="cb54-565"><a href="#cb54-565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-566"><a href="#cb54-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-569"><a href="#cb54-569" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-570"><a href="#cb54-570" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb54-571"><a href="#cb54-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-572"><a href="#cb54-572" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_lm_pooled)</span>
<span id="cb54-573"><a href="#cb54-573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-574"><a href="#cb54-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-577"><a href="#cb54-577" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-578"><a href="#cb54-578" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb54-579"><a href="#cb54-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-580"><a href="#cb54-580" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(<span class="fu">summary</span>(fit_lm_pooled))</span>
<span id="cb54-581"><a href="#cb54-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-582"><a href="#cb54-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-583"><a href="#cb54-583" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mixed Model {#sec-mixed-model}</span></span>
<span id="cb54-584"><a href="#cb54-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-587"><a href="#cb54-587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-588"><a href="#cb54-588" aria-hidden="true" tabindex="-1"></a>fit_lmer <span class="ot">&lt;-</span> <span class="fu">with</span>(</span>
<span id="cb54-589"><a href="#cb54-589" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mi_mice,</span>
<span id="cb54-590"><a href="#cb54-590" aria-hidden="true" tabindex="-1"></a>  <span class="at">expr =</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(height <span class="sc">~</span> age <span class="sc">+</span> Occasion <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id)))</span>
<span id="cb54-591"><a href="#cb54-591" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-592"><a href="#cb54-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-593"><a href="#cb54-593" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pool Results Across Models</span></span>
<span id="cb54-594"><a href="#cb54-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-597"><a href="#cb54-597" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-598"><a href="#cb54-598" aria-hidden="true" tabindex="-1"></a>fit_lmer_pooled <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">pool</span>(fit_lmer)</span>
<span id="cb54-599"><a href="#cb54-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-600"><a href="#cb54-600" aria-hidden="true" tabindex="-1"></a>fit_lmer_pooled</span>
<span id="cb54-601"><a href="#cb54-601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-602"><a href="#cb54-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-605"><a href="#cb54-605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-606"><a href="#cb54-606" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb54-607"><a href="#cb54-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-608"><a href="#cb54-608" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_lmer_pooled)</span>
<span id="cb54-609"><a href="#cb54-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-610"><a href="#cb54-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-613"><a href="#cb54-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-614"><a href="#cb54-614" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb54-615"><a href="#cb54-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-616"><a href="#cb54-616" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(<span class="fu">summary</span>(fit_lmer_pooled))</span>
<span id="cb54-617"><a href="#cb54-617" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-618"><a href="#cb54-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-619"><a href="#cb54-619" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model-Implied Predictions</span></span>
<span id="cb54-620"><a href="#cb54-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-623"><a href="#cb54-623" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-624"><a href="#cb54-624" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb54-625"><a href="#cb54-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-626"><a href="#cb54-626" aria-hidden="true" tabindex="-1"></a>mice<span class="sc">::</span><span class="fu">predict_mi</span>(</span>
<span id="cb54-627"><a href="#cb54-627" aria-hidden="true" tabindex="-1"></a>  fit_lm,</span>
<span id="cb54-628"><a href="#cb54-628" aria-hidden="true" tabindex="-1"></a>  <span class="co">#newdata = # can include if want to make predictions based on another (i.e., "new") data object</span></span>
<span id="cb54-629"><a href="#cb54-629" aria-hidden="true" tabindex="-1"></a>  <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-630"><a href="#cb54-630" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="fu">c</span>(<span class="st">"prediction"</span>)</span>
<span id="cb54-631"><a href="#cb54-631" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-632"><a href="#cb54-632" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-633"><a href="#cb54-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-636"><a href="#cb54-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-637"><a href="#cb54-637" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb54-638"><a href="#cb54-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-639"><a href="#cb54-639" aria-hidden="true" tabindex="-1"></a>fit_lm_fitted <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">predict_mi</span>(</span>
<span id="cb54-640"><a href="#cb54-640" aria-hidden="true" tabindex="-1"></a>  fit_lm,</span>
<span id="cb54-641"><a href="#cb54-641" aria-hidden="true" tabindex="-1"></a>  <span class="co">#newdata = # can include if want to make predictions based on another (i.e., "new") data object</span></span>
<span id="cb54-642"><a href="#cb54-642" aria-hidden="true" tabindex="-1"></a>  <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-643"><a href="#cb54-643" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="fu">c</span>(<span class="st">"prediction"</span>)</span>
<span id="cb54-644"><a href="#cb54-644" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-645"><a href="#cb54-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-646"><a href="#cb54-646" aria-hidden="true" tabindex="-1"></a>fit_lm_fitted<span class="sc">$</span>fit <span class="ot">&lt;-</span> <span class="fu">head</span>(fit_lm_fitted<span class="sc">$</span>fit)</span>
<span id="cb54-647"><a href="#cb54-647" aria-hidden="true" tabindex="-1"></a>fit_lm_fitted<span class="sc">$</span>se.fit <span class="ot">&lt;-</span> <span class="fu">head</span>(fit_lm_fitted<span class="sc">$</span>se.fit)</span>
<span id="cb54-648"><a href="#cb54-648" aria-hidden="true" tabindex="-1"></a>fit_lm_fitted<span class="sc">$</span>df <span class="ot">&lt;-</span> <span class="fu">head</span>(fit_lm_fitted<span class="sc">$</span>df)</span>
<span id="cb54-649"><a href="#cb54-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-650"><a href="#cb54-650" aria-hidden="true" tabindex="-1"></a>fit_lm_fitted</span>
<span id="cb54-651"><a href="#cb54-651" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-652"><a href="#cb54-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-655"><a href="#cb54-655" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-656"><a href="#cb54-656" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb54-657"><a href="#cb54-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-658"><a href="#cb54-658" aria-hidden="true" tabindex="-1"></a>mice<span class="sc">::</span><span class="fu">predict_mi</span>(</span>
<span id="cb54-659"><a href="#cb54-659" aria-hidden="true" tabindex="-1"></a>  fit_lmer,</span>
<span id="cb54-660"><a href="#cb54-660" aria-hidden="true" tabindex="-1"></a>  <span class="co">#newdata = # can include if want to make predictions based on another (i.e., "new") data object</span></span>
<span id="cb54-661"><a href="#cb54-661" aria-hidden="true" tabindex="-1"></a>  <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-662"><a href="#cb54-662" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="fu">c</span>(<span class="st">"prediction"</span>)</span>
<span id="cb54-663"><a href="#cb54-663" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-664"><a href="#cb54-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-665"><a href="#cb54-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-668"><a href="#cb54-668" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-669"><a href="#cb54-669" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb54-670"><a href="#cb54-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-671"><a href="#cb54-671" aria-hidden="true" tabindex="-1"></a>fit_lmer_fitted <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">predict_mi</span>(</span>
<span id="cb54-672"><a href="#cb54-672" aria-hidden="true" tabindex="-1"></a>  fit_lmer,</span>
<span id="cb54-673"><a href="#cb54-673" aria-hidden="true" tabindex="-1"></a>  <span class="co">#newdata = # can include if want to make predictions based on another (i.e., "new") data object</span></span>
<span id="cb54-674"><a href="#cb54-674" aria-hidden="true" tabindex="-1"></a>  <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-675"><a href="#cb54-675" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="fu">c</span>(<span class="st">"prediction"</span>)</span>
<span id="cb54-676"><a href="#cb54-676" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-677"><a href="#cb54-677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-678"><a href="#cb54-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-681"><a href="#cb54-681" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-682"><a href="#cb54-682" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb54-683"><a href="#cb54-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb54-684"><a href="#cb54-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-685"><a href="#cb54-685" aria-hidden="true" tabindex="-1"></a>fit_lmer_fitted <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">predict_mi</span>(</span>
<span id="cb54-686"><a href="#cb54-686" aria-hidden="true" tabindex="-1"></a>  fit_lmer,</span>
<span id="cb54-687"><a href="#cb54-687" aria-hidden="true" tabindex="-1"></a>  <span class="co">#newdata = # can include if want to make predictions based on another (i.e., "new") data object</span></span>
<span id="cb54-688"><a href="#cb54-688" aria-hidden="true" tabindex="-1"></a>  <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-689"><a href="#cb54-689" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="fu">c</span>(<span class="st">"prediction"</span>)</span>
<span id="cb54-690"><a href="#cb54-690" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-691"><a href="#cb54-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-692"><a href="#cb54-692" aria-hidden="true" tabindex="-1"></a>fit_lmer_fitted<span class="sc">$</span>fit <span class="ot">&lt;-</span> <span class="fu">head</span>(fit_lmer_fitted<span class="sc">$</span>fit)</span>
<span id="cb54-693"><a href="#cb54-693" aria-hidden="true" tabindex="-1"></a>fit_lmer_fitted<span class="sc">$</span>se.fit <span class="ot">&lt;-</span> <span class="fu">head</span>(fit_lmer_fitted<span class="sc">$</span>se.fit)</span>
<span id="cb54-694"><a href="#cb54-694" aria-hidden="true" tabindex="-1"></a>fit_lmer_fitted<span class="sc">$</span>df <span class="ot">&lt;-</span> <span class="fu">head</span>(fit_lmer_fitted<span class="sc">$</span>df)</span>
<span id="cb54-695"><a href="#cb54-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-696"><a href="#cb54-696" aria-hidden="true" tabindex="-1"></a>fit_lmer_fitted</span>
<span id="cb54-697"><a href="#cb54-697" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-698"><a href="#cb54-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-699"><a href="#cb54-699" aria-hidden="true" tabindex="-1"></a><span class="fu"># Resources</span></span>
<span id="cb54-700"><a href="#cb54-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-701"><a href="#cb54-701" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stefvanbuuren.name/fimd&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/46U2-QTM6&gt;</span>)</span>
<span id="cb54-702"><a href="#cb54-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-703"><a href="#cb54-703" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://www.gerkovink.com/miceVignettes/Multi_level/Multi_level_data.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/SF32-D7ZF&gt;</span>)</span>
<span id="cb54-704"><a href="#cb54-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-705"><a href="#cb54-705" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session Info</span></span>
<span id="cb54-706"><a href="#cb54-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-709"><a href="#cb54-709" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-710"><a href="#cb54-710" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb54-711"><a href="#cb54-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-712"><a href="#cb54-712" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb54-713"><a href="#cb54-713" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/DevPsyLab/DataAnalysis/edit/main/multipleImputation.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/blob/main/multipleImputation.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>