[
  {
    "objectID": "SPSS.html",
    "href": "SPSS.html",
    "title": "SPSS",
    "section": "",
    "text": "We use R for almost all data analysis. However, R is code-based and has a steep learning curve. As a result, undergraduate students in the lab most often use SPSS or jamovi for their research projects (e.g., Honors projects and SROP projects), because SPSS and jamovi have a point-and-click interface.",
    "crumbs": [
      "About",
      "SPSS"
    ]
  },
  {
    "objectID": "SPSS.html#sec-averageVars",
    "href": "SPSS.html#sec-averageVars",
    "title": "SPSS",
    "section": "4.1 Average Across Variables",
    "text": "4.1 Average Across Variables\nCOMPUTE cbcl_externalizingPOM_Average = MEAN(cbcl_externalizingPOM_Father,cbcl_externalizingPOM_Mother,cbcl_externalizingPOM_Secondary).\nCOMPUTE cbq_inhibitoryControl_Average = MEAN(cbq_inhibitoryControl_Father,cbq_inhibitoryControl_Mother,cbq_inhibitoryControl_Secondary).\nEXECUTE.",
    "crumbs": [
      "About",
      "SPSS"
    ]
  },
  {
    "objectID": "SPSS.html#sec-renameVars",
    "href": "SPSS.html#sec-renameVars",
    "title": "SPSS",
    "section": "4.2 Rename Variables",
    "text": "4.2 Rename Variables\nRENAME VARIABLES (ses_hollingsheadSES = SES).",
    "crumbs": [
      "About",
      "SPSS"
    ]
  },
  {
    "objectID": "SPSS.html#sec-meanCenter",
    "href": "SPSS.html#sec-meanCenter",
    "title": "SPSS",
    "section": "4.3 Mean-Center Variables",
    "text": "4.3 Mean-Center Variables\nCOMPUTE ses_hollingsheadSES_mc = ses_hollingsheadSES - mean_ses.\nCOMPUTE adi_nationalRank_mc = adi_nationalRank - mean_adiN.\nEXECUTE.",
    "crumbs": [
      "About",
      "SPSS"
    ]
  },
  {
    "objectID": "SPSS.html#sec-interaction",
    "href": "SPSS.html#sec-interaction",
    "title": "SPSS",
    "section": "4.4 Compute Interaction Terms",
    "text": "4.4 Compute Interaction Terms\nCOMPUTE ses_adi_interaction = ses_hollingsheadSES_mc * adi_nationalRank_mc.\nEXECUTE.",
    "crumbs": [
      "About",
      "SPSS"
    ]
  },
  {
    "objectID": "SPSS.html#sec-saveData",
    "href": "SPSS.html#sec-saveData",
    "title": "SPSS",
    "section": "4.5 Save Data File",
    "text": "4.5 Save Data File\nSAVE OUTFILE='\\\\lc-rs-store24.hpc.uiowa.edu\\lss_itpetersen\\Lab\\Members\\HAWKID\\Thesis\\Data\\srs_idWave.sav'\n  /COMPRESSED.",
    "crumbs": [
      "About",
      "SPSS"
    ]
  },
  {
    "objectID": "SPSS.html#sec-frequencies",
    "href": "SPSS.html#sec-frequencies",
    "title": "SPSS",
    "section": "5.1 Frequencies",
    "text": "5.1 Frequencies\nFREQUENCIES VARIABLES=tc_sex tc_hispanic tc_race tc_ethnicity \n  /ORDER=ANALYSIS.",
    "crumbs": [
      "About",
      "SPSS"
    ]
  },
  {
    "objectID": "SPSS.html#sec-descriptives",
    "href": "SPSS.html#sec-descriptives",
    "title": "SPSS",
    "section": "5.2 Descriptives",
    "text": "5.2 Descriptives\nDESCRIPTIVES VARIABLES=ICsim IClim IChg ICcbq ses_hollingsheadSES ADINat EXTBx \n  /STATISTICS=MEAN STDDEV MIN MAX KURTOSIS SKEWNESS.",
    "crumbs": [
      "About",
      "SPSS"
    ]
  },
  {
    "objectID": "SPSS.html#sec-histograms",
    "href": "SPSS.html#sec-histograms",
    "title": "SPSS",
    "section": "5.3 Histograms",
    "text": "5.3 Histograms\nGRAPH\n  /HISTOGRAM=ses_hollingsheadSES.",
    "crumbs": [
      "About",
      "SPSS"
    ]
  },
  {
    "objectID": "SPSS.html#sec-correlations",
    "href": "SPSS.html#sec-correlations",
    "title": "SPSS",
    "section": "5.4 Correlations",
    "text": "5.4 Correlations\nCORRELATIONS\n  /VARIABLES=tc_ageLV1 ses_hollingsheadParent cbq_inhibitoryControl_Average \n    lim_scoreExcludingPreferencePOM hg_scorePOM sim_goXnoGoPOM cbcl_externalizingPOM_Average\n  /PRINT=TWOTAIL NOSIG FULL\n  /MISSING=PAIRWISE.",
    "crumbs": [
      "About",
      "SPSS"
    ]
  },
  {
    "objectID": "SPSS.html#sec-multipleRegression",
    "href": "SPSS.html#sec-multipleRegression",
    "title": "SPSS",
    "section": "5.5 Multiple Regression",
    "text": "5.5 Multiple Regression\nREGRESSION\n/MISSING PAIRWISE\n/STATISTICS COEFF OUTS R ANOVA\n/CRITERIA=PIN(.05) POUT(.10)\n/NOORIGIN \n/DEPENDENT outcome\n/METHOD=ENTER predictor1 predictor2 predictor3.",
    "crumbs": [
      "About",
      "SPSS"
    ]
  },
  {
    "objectID": "SPSS.html#sec-mediation",
    "href": "SPSS.html#sec-mediation",
    "title": "SPSS",
    "section": "5.6 Mediation",
    "text": "5.6 Mediation\nFirst, download and run the PROCESS macro.\nBelow is the syntax for a model without covariates—replace outcome with name of outcome variable, predictor with name of predictor variable, and mediator with name of mediating variable:\nPROCESS \n  y=outcome\n  /x=predictor\n  /m=mediator1 mediator2 mediator3\n  /model=4\n  /total=1\n  /effsize=1\n  /stand=1\n  /boot=10000\n  .\nModel with covariates (p. 126):\nPROCESS \n  y=outcome\n  /x=predictor\n  /m=mediator1 mediator2 mediator3\n  /cov=covariate1 covariate2 covariate3\n  /model=4\n  /total=1\n  /effsize=1\n  /stand=1\n  /boot=10000\n  .",
    "crumbs": [
      "About",
      "SPSS"
    ]
  },
  {
    "objectID": "SPSS.html#sec-moderation",
    "href": "SPSS.html#sec-moderation",
    "title": "SPSS",
    "section": "5.7 Moderation",
    "text": "5.7 Moderation\n\nCalculate means of the predictor and moderator\naggregate outfile * mode addvariables\n/predictor_mean = mean(predictor).\n\naggregate outfile * mode addvariables\n/moderator_mean = mean(moderator).\nMean-center the predictor and moderator\ncompute predictor_MC = predictor - predictor_mean.\ncompute moderator_MC = moderator - moderator_mean.\nexecute.\nVerify that predictor and moderator are mean-centered (i.e., have a mean of zero)\nDESCRIPTIVES VARIABLES=predictor moderator predictor_MC moderator_MC\n/STATISTICS=MEAN STDDEV MIN MAX.\nCreate the interaction terms\ncompute predictorXmoderator = predictor_MC * moderator_MC.\nexecute.\nRun moderated multiple regression model\nREGRESSION\n/MISSING PAIRWISE\n/STATISTICS COEFF OUTS R ANOVA\n/CRITERIA=PIN(.05) POUT(.10)\n/NOORIGIN \n/DEPENDENT outcome\n/METHOD=ENTER predictor_MC moderator_MC predictorXmoderator covariate1 covariate2.\nCreate plot of interaction\n\nsee McCabe et al. (2018) and following links:\n\nhttps://github.com/connorjmccabe/InterActive\nhttps://connorjmccabe.shinyapps.io/interactive/ (archived at https://perma.cc/93G6-ALDP)",
    "crumbs": [
      "About",
      "SPSS"
    ]
  },
  {
    "objectID": "eda.html",
    "href": "eda.html",
    "title": "Exploratory Data Analysis",
    "section": "",
    "text": "Exploratory data analysis is important for understanding your data, checking for data issues/errors, and checking assumptions for different statistical models.\nLOOK AT YOUR DATA—this is one of the most overlooked steps in data analysis!",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#install-libraries",
    "href": "eda.html#install-libraries",
    "title": "Exploratory Data Analysis",
    "section": "\n2.1 Install Libraries",
    "text": "2.1 Install Libraries\n\nCode#install.packages(\"remotes\")\n#remotes::install_github(\"DevPsyLab/petersenlab\")",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#load-libraries",
    "href": "eda.html#load-libraries",
    "title": "Exploratory Data Analysis",
    "section": "\n2.2 Load Libraries",
    "text": "2.2 Load Libraries\n\nCodelibrary(\"petersenlab\")\nlibrary(\"car\")\nlibrary(\"vioplot\")\nlibrary(\"ellipse\")\nlibrary(\"nlme\")\nlibrary(\"effects\")\nlibrary(\"corrplot\")\nlibrary(\"ggplot2\")\nlibrary(\"psych\")\nlibrary(\"tidyverse\")\nlibrary(\"purrr\")\nlibrary(\"naniar\")\nlibrary(\"mvnormtest\")\nlibrary(\"ggExtra\")\nlibrary(\"XICOR\")",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#sample",
    "href": "eda.html#sample",
    "title": "Exploratory Data Analysis",
    "section": "\n4.1 Sample",
    "text": "4.1 Sample\n\nCheck the sample size (N)\n\nIs the sample size in the data the expected sample size? Are there cases (participants) that are missing? Are there cases that should not be there?\nHere is the sample size:\n\n\n\n\nCodelength(unique(mydata$ID))\n\n[1] 100\n\n\n\nCheck the extent of missingness\n\nHow much data are missing in the model variables—including the predictor, outcome, and covariates?\nHere are the proportion of missing data in each variable:\n\n\n\n\nCodemap(mydata, ~mean(is.na(.))) %&gt;% t %&gt;% t\n\n                  [,1]\nID                0   \npredictor         0.01\noutcome           0.01\npredictorOverplot 0.01\noutcomeOverplot   0.01\ncategorical1      0.03\ncategorical2      0.07",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#distribution",
    "href": "eda.html#distribution",
    "title": "Exploratory Data Analysis",
    "section": "\n4.2 Distribution",
    "text": "4.2 Distribution\n\nFrequencies\n\nExamine the frequencies of categorical variables:\n\n\n\n\nCodemydata %&gt;% \n  select(categorical1, categorical2) %&gt;%\n  sapply(function(x) table(x, useNA = \"always\")) %&gt;% \n  t()\n\n               1   2   3   4   5 &lt;NA&gt;\ncategorical1 196 204 191 199 180   30\ncategorical2 195 179 193 202 161   70",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#central-tendency",
    "href": "eda.html#central-tendency",
    "title": "Exploratory Data Analysis",
    "section": "\n4.3 Central Tendency",
    "text": "4.3 Central Tendency\n\nMean\n\n\nCoderound(colMeans(mydata, na.rm = TRUE), 2)\n\n               ID         predictor           outcome predictorOverplot \n            50.50             22.64             73.36             25.54 \n  outcomeOverplot      categorical1      categorical2 \n            63.53              2.96              2.95 \n\nCoderound(apply(mydata, 2, function(x) mean(x, na.rm = TRUE)), 2)\n\n               ID         predictor           outcome predictorOverplot \n            50.50             22.64             73.36             25.54 \n  outcomeOverplot      categorical1      categorical2 \n            63.53              2.96              2.95 \n\nCodemydata %&gt;% \n  summarise(across(everything(),\n                   .fns = list(mean = ~ mean(., na.rm = TRUE)))) %&gt;% \n  round(., 2)\n\n\n  \n\n\n\n\nMedian\n\n\nCoderound(apply(mydata, 2, function(x) median(x, na.rm = TRUE)), 2)\n\n               ID         predictor           outcome predictorOverplot \n            50.50             19.61             73.17             26.00 \n  outcomeOverplot      categorical1      categorical2 \n            63.00              3.00              3.00 \n\nCodemydata %&gt;% \n  summarise(across(everything(),\n                   .fns = list(median = ~ median(., na.rm = TRUE)))) %&gt;% \n  round(., 2)\n\n\n  \n\n\n\n\nMode\n\n\nCoderound(apply(mydata, 2, function(x) Mode(x, multipleModes = \"mean\")), 2)\n\n               ID         predictor           outcome predictorOverplot \n            50.50             22.64             73.36             35.00 \n  outcomeOverplot      categorical1      categorical2 \n            63.33              2.00              4.00 \n\nCodemydata %&gt;% \n  summarise(across(everything(),\n                   .fns = list(mode = ~ Mode(., multipleModes = \"mean\")))) %&gt;% \n  round(., 2)\n\n\n  \n\n\n\nCompute all of these measures of central tendency:\n\nCodemydata %&gt;% \n  summarise(across(everything(),\n                   .fns = list(mean = ~ mean(., na.rm = TRUE),\n                               median = ~ median(., na.rm = TRUE),\n                               mode = ~ Mode(., multipleModes = \"mean\")),\n                   .names = \"{.col}.{.fn}\")) %&gt;% \n  round(., 2) %&gt;% \n  pivot_longer(cols = everything(),\n               names_to = c(\"variable\",\"index\"),\n               names_sep = \"\\\\.\") %&gt;% \n  pivot_wider(names_from = index,\n              values_from = value)",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#dispersion",
    "href": "eda.html#dispersion",
    "title": "Exploratory Data Analysis",
    "section": "\n4.4 Dispersion",
    "text": "4.4 Dispersion\n\nStandard deviation\nObserved minimum and maximum (vis-à-vis possible minimum and maximum)\nSkewness\nKurtosis\n\nCompute all of these measures of dispersion:\n\nCodemydata %&gt;% \n  summarise(across(everything(),\n                   .fns = list(SD = ~ sd(., na.rm = TRUE),\n                               min = ~ min(., na.rm = TRUE),\n                               max = ~ max(., na.rm = TRUE),\n                               skewness = ~ skew(., na.rm = TRUE),\n                               kurtosis = ~ kurtosi(., na.rm = TRUE)),\n                   .names = \"{.col}.{.fn}\")) %&gt;% \n  round(., 2) %&gt;% \n  pivot_longer(cols = everything(),\n               names_to = c(\"variable\",\"index\"),\n               names_sep = \"\\\\.\") %&gt;% \n  pivot_wider(names_from = index,\n              values_from = value)\n\n\n  \n\n\n\nConsider transforming data if skewness &gt; |0.8| or if kurtosis &gt; |3.0|.",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#sec-summaryStats",
    "href": "eda.html#sec-summaryStats",
    "title": "Exploratory Data Analysis",
    "section": "\n4.5 Summary Statistics",
    "text": "4.5 Summary Statistics\nAdd summary statistics to the bottom of correlation matrices in papers:\n\nCodecor.table(mydata, type = \"manuscript\")\n\n\n  \n\n\nCodesummaryTable &lt;- mydata %&gt;% \n  summarise(across(everything(),\n                   .fns = list(n = ~ length(na.omit(.)),\n                               missingness = ~ mean(is.na(.)) * 100,\n                               M = ~ mean(., na.rm = TRUE),\n                               SD = ~ sd(., na.rm = TRUE),\n                               min = ~ min(., na.rm = TRUE),\n                               max = ~ max(., na.rm = TRUE),\n                               skewness = ~ skew(., na.rm = TRUE),\n                               kurtosis = ~ kurtosi(., na.rm = TRUE)),\n                   .names = \"{.col}.{.fn}\")) %&gt;%  \n  pivot_longer(cols = everything(),\n               names_to = c(\"variable\",\"index\"),\n               names_sep = \"\\\\.\") %&gt;% \n  pivot_wider(names_from = index,\n              values_from = value)\n\nsummaryTableTransposed &lt;- summaryTable[-1] %&gt;% \n  t() %&gt;% \n  as.data.frame() %&gt;% \n  setNames(summaryTable$variable) %&gt;% \n  round(., digits = 2)\n\nsummaryTableTransposed",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#distribution-plots",
    "href": "eda.html#distribution-plots",
    "title": "Exploratory Data Analysis",
    "section": "\n4.6 Distribution Plots",
    "text": "4.6 Distribution Plots\nSee here for resources for creating figures in R.\n\n4.6.1 Histogram\n\n4.6.1.1 Base R\n\nCodehist(mydata$outcome)\n\n\n\n\n\n\n\n\n4.6.1.2 ggplot2\n\n\nCodeggplot(mydata, aes(x = outcome)) +\n  geom_histogram(color = 1)\n\n\n\n\n\n\n\n\n4.6.2 Histogram overlaid with density plot and rug plot\n\n4.6.2.1 Base R\n\nCodehist(mydata$outcome, prob = TRUE)\nlines(density(mydata$outcome, na.rm = TRUE))\nrug(mydata$outcome)\n\n\n\n\n\n\n\n\n4.6.2.2 ggplot2\n\n\nCodeggplot(mydata, aes(x = outcome)) +\n  geom_histogram(aes(y = after_stat(density)), color = 1) +\n  geom_density() +\n  geom_rug()\n\n\n\n\n\n\n\n\n4.6.3 Density Plot\n\n4.6.3.1 Base R\n\nCodeplot(density(mydata$outcome, na.rm = TRUE))\n\n\n\n\n\n\n\n\n4.6.3.2 ggplot2\n\n\nCodeggplot(mydata, aes(x = outcome)) +\n  geom_density()\n\n\n\n\n\n\n\n\n4.6.4 Box and whisker plot (boxplot)\n\n4.6.4.1 Base R\n\nCodeboxplot(mydata$outcome, horizontal = TRUE)\n\n\n\n\n\n\n\n\n4.6.4.2 ggplot2\n\n\nCodeggplot(mydata, aes(x = outcome)) +\n  geom_boxplot()\n\n\n\n\n\n\n\n\n4.6.5 Violin plot\n\n4.6.5.1 Base R\n\nCodevioplot(na.omit(mydata$outcome), horizontal = TRUE)\n\n\n\n\n\n\n\n\n4.6.5.2 ggplot2\n\n\nCodeggplot(mydata, aes(x = \"\", y = outcome)) +\n  geom_violin()",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#correlation-coefficients",
    "href": "eda.html#correlation-coefficients",
    "title": "Exploratory Data Analysis",
    "section": "\n5.1 Correlation Coefficients",
    "text": "5.1 Correlation Coefficients\n\n5.1.1 Pearson Correlation\n\nCodecor(mydata, use = \"pairwise.complete.obs\")\n\n                            ID    predictor     outcome predictorOverplot\nID                 1.000000000 -0.019094589 -0.02501796        0.02984671\npredictor         -0.019094589  1.000000000  0.63517610        0.04350431\noutcome           -0.025017962  0.635176098  1.00000000        0.02976820\npredictorOverplot  0.029846711  0.043504314  0.02976820        1.00000000\noutcomeOverplot    0.003150872  0.043344473  0.06289224        0.56564445\ncategorical1       0.040442534 -0.002422711 -0.01532232        0.02498938\ncategorical2       0.008920415 -0.046927177 -0.01868628        0.03880135\n                  outcomeOverplot categorical1 categorical2\nID                    0.003150872  0.040442534  0.008920415\npredictor             0.043344473 -0.002422711 -0.046927177\noutcome               0.062892238 -0.015322318 -0.018686282\npredictorOverplot     0.565644447  0.024989385  0.038801346\noutcomeOverplot       1.000000000  0.011871644  0.043682632\ncategorical1          0.011871644  1.000000000 -0.086310192\ncategorical2          0.043682632 -0.086310192  1.000000000\n\nCodecor.test( ~ predictor + outcome, data = mydata)\n\n\n    Pearson's product-moment correlation\n\ndata:  predictor and outcome\nt = 25.718, df = 978, p-value &lt; 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.5962709 0.6711047\nsample estimates:\n      cor \n0.6351761 \n\nCodecor.table(mydata)\n\n\n  \n\n\n\n\n5.1.2 Spearman Correlation\n\nCodecor(mydata, use = \"pairwise.complete.obs\", method = \"spearman\")\n\n                            ID   predictor     outcome predictorOverplot\nID                 1.000000000 -0.01181085 -0.02805450        0.02925155\npredictor         -0.011810853  1.00000000  0.60003760        0.02672008\noutcome           -0.028054497  0.60003760  1.00000000        0.02460831\npredictorOverplot  0.029251546  0.02672008  0.02460831        1.00000000\noutcomeOverplot    0.001416626  0.03278463  0.07073642        0.54841297\ncategorical1       0.040888369 -0.01162260 -0.01906631        0.02350886\ncategorical2       0.009137467 -0.03763251 -0.02273699        0.04062487\n                  outcomeOverplot categorical1 categorical2\nID                    0.001416626   0.04088837  0.009137467\npredictor             0.032784628  -0.01162260 -0.037632515\noutcome               0.070736421  -0.01906631 -0.022736992\npredictorOverplot     0.548412967   0.02350886  0.040624873\noutcomeOverplot       1.000000000   0.01505255  0.044184959\ncategorical1          0.015052553   1.00000000 -0.086290083\ncategorical2          0.044184959  -0.08629008  1.000000000\n\nCodecor.test( ~ predictor + outcome, data = mydata, method = \"spearman\")\n\n\n    Spearman's rank correlation rho\n\ndata:  predictor and outcome\nS = 62740170, p-value &lt; 2.2e-16\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n      rho \n0.6000376 \n\nCodecor.table(mydata, correlation = \"spearman\")\n\n\n  \n\n\n\n\n5.1.3 Xi (\\(\\xi\\))\nXi (\\(\\xi\\)) is an index of the degree of dependence between two variables, which is useful as an index of nonlinear correlation.\nChatterjee, S. (2021). A new coefficient of correlation. Journal of the American Statistical Association, 116(536), 2009-2022. https://doi.org/10.1080/01621459.2020.1758115\n\nCodecalculateXI(\n  mydata$predictor,\n  mydata$outcome)\n\n[1] 0.2319062",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#scatterplot",
    "href": "eda.html#scatterplot",
    "title": "Exploratory Data Analysis",
    "section": "\n5.2 Scatterplot",
    "text": "5.2 Scatterplot\n\n5.2.1 Base R\n\nCodeplot(\n  mydata$predictor,\n  mydata$outcome)\nabline(lm(\n  outcomeOverplot ~ predictorOverplot,\n  data = mydata,\n  na.action = \"na.exclude\"))\n\n\n\n\n\n\n\n\n5.2.2 ggplot2\n\n\nCodeggplot(mydata, aes(x = predictor, y = outcome)) + \n  geom_point() +\n  geom_smooth(method = \"lm\", se = TRUE)",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#scatterplot-with-marginal-density-plot",
    "href": "eda.html#scatterplot-with-marginal-density-plot",
    "title": "Exploratory Data Analysis",
    "section": "\n5.3 Scatterplot with Marginal Density Plot",
    "text": "5.3 Scatterplot with Marginal Density Plot\n\nCodescatterplot &lt;- \n  ggplot(mydata, aes(x = predictor, y = outcome)) + \n  geom_point() +\n  geom_smooth(method = \"lm\", se = TRUE)\n\n\n\nCodedensityMarginal &lt;- ggMarginal(\n  scatterplot,\n  type = \"density\",\n  xparams = list(fill = \"gray\"),\n  yparams = list(fill = \"gray\"))\n\n\n\nCodeprint(densityMarginal, newpage = TRUE)",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#high-density-scatterplot",
    "href": "eda.html#high-density-scatterplot",
    "title": "Exploratory Data Analysis",
    "section": "\n5.4 High Density Scatterplot",
    "text": "5.4 High Density Scatterplot\n\nCodeggplot(mydata, aes(x = predictorOverplot, y = outcomeOverplot)) + \n  geom_point(position = \"jitter\", alpha = 0.3) + \n  geom_density2d()\n\n\n\n\n\n\nCodesmoothScatter(mydata$predictorOverplot, mydata$outcomeOverplot)",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#data-ellipse",
    "href": "eda.html#data-ellipse",
    "title": "Exploratory Data Analysis",
    "section": "\n5.5 Data Ellipse",
    "text": "5.5 Data Ellipse\n\nCodemydata_nomissing &lt;- na.omit(mydata[,c(\"predictor\",\"outcome\")])\ndataEllipse(mydata_nomissing$predictor, mydata_nomissing$outcome, levels = c(0.5, .95))",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#visually-weighted-regression",
    "href": "eda.html#visually-weighted-regression",
    "title": "Exploratory Data Analysis",
    "section": "\n5.6 Visually Weighted Regression",
    "text": "5.6 Visually Weighted Regression\n\nCodevwReg(outcome ~ predictor, data = mydata)",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#tests-of-normality",
    "href": "eda.html#tests-of-normality",
    "title": "Exploratory Data Analysis",
    "section": "\n6.1 Tests of Normality",
    "text": "6.1 Tests of Normality\n\n6.1.1 Shapiro-Wilk test of normality\nThe Shapiro-Wilk test of normality does not accept more than 5000 cases because it will reject the hypothesis that data come from a normal distribution with even slight deviations from normality.\n\nCodeshapiro.test(na.omit(mydata$outcome)) #subset to keep only the first 5000 rows: mydata$outcome[1:5000]\n\n\n    Shapiro-Wilk normality test\n\ndata:  na.omit(mydata$outcome)\nW = 0.9971, p-value = 0.06998\n\n\n\n6.1.2 Test of multivariate normality\n\nCodemydata %&gt;% \n  na.omit %&gt;% \n  t %&gt;% \n  mshapiro.test\n\n\n    Shapiro-Wilk normality test\n\ndata:  Z\nW = 0.98542, p-value = 1.339e-07",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#tests-of-systematic-missingness-i.e.-whether-missingness-on-a-variable-depends-on-other-variables",
    "href": "eda.html#tests-of-systematic-missingness-i.e.-whether-missingness-on-a-variable-depends-on-other-variables",
    "title": "Exploratory Data Analysis",
    "section": "\n6.2 Tests of systematic missingness (i.e., whether missingness on a variable depends on other variables)",
    "text": "6.2 Tests of systematic missingness (i.e., whether missingness on a variable depends on other variables)\n\nGenerally test:\n\nWhether data are consistent with a missing completely at random (MCAR) pattern—Little’s MCAR Test\nWhether outcome variable(s) differ as a function of any model variables (predictors and covariates) and as a function of any key demographic characteristics (e.g., sex, ethnicity, socioeconomic status)\nWhether focal predictor variable(s) differ as a function of any model variables (including outcome variable) and as a function of any key demographic characteristics\n\n\nFor instance:\n\nWhether males are more likely than girls to be missing scores on the dependent variable\nWhether longitudinal attrition is greater in lower socioeconomic status families\n\n\nIf missingness differs systematically as a function of other variables, you can include that variable as a control variable in models, and/or can include that variable in multiple imputation to inform imputed scores for missing values\n\n\n6.2.1 Little’s MCAR Test\n\nCodemcar_test(mydata)",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#multivariate-associations",
    "href": "eda.html#multivariate-associations",
    "title": "Exploratory Data Analysis",
    "section": "\n6.3 Multivariate Associations",
    "text": "6.3 Multivariate Associations\n\n6.3.1 Correlation Matrix\n\n6.3.1.1 Pearson Correlations\n\nCodecor.table(mydata[,c(\"predictor\",\"outcome\",\"predictorOverplot\",\"outcomeOverplot\")])\n\n\n  \n\n\nCodecor.table(mydata[,c(\"predictor\",\"outcome\",\"predictorOverplot\",\"outcomeOverplot\")], type = \"manuscript\")\n\n\n  \n\n\nCodecor.table(mydata[,c(\"predictor\",\"outcome\",\"predictorOverplot\",\"outcomeOverplot\")], type = \"manuscriptBig\")\n\n\n  \n\n\n\n\n6.3.1.2 Spearman Correlations\n\nCodecor.table(mydata[,c(\"predictor\",\"outcome\",\"predictorOverplot\",\"outcomeOverplot\")], correlation = \"spearman\")\n\n\n  \n\n\nCodecor.table(mydata[,c(\"predictor\",\"outcome\",\"predictorOverplot\",\"outcomeOverplot\")], type = \"manuscript\", correlation = \"spearman\")\n\n\n  \n\n\nCodecor.table(mydata[,c(\"predictor\",\"outcome\",\"predictorOverplot\",\"outcomeOverplot\")], type = \"manuscriptBig\", correlation = \"spearman\")\n\n\n  \n\n\n\n\n6.3.1.3 Partial Correlations\nExamine the associations among variables controlling for a covariate (outcomeOverplot).\n\nCodepartialcor.table(mydata[,c(\"predictor\",\"outcome\",\"predictorOverplot\")], z = mydata[,c(\"outcomeOverplot\")])\n\n\n  \n\n\nCodepartialcor.table(mydata[,c(\"predictor\",\"outcome\",\"predictorOverplot\")], z = mydata[,c(\"outcomeOverplot\")], type = \"manuscript\")\n\n\n  \n\n\nCodepartialcor.table(mydata[,c(\"predictor\",\"outcome\",\"predictorOverplot\")], z = mydata[,c(\"outcomeOverplot\")], type = \"manuscriptBig\")\n\n\n  \n\n\n\n\n6.3.2 Correlogram\n\nCodecorrplot(cor(mydata[,c(\"predictor\",\"outcome\",\"predictorOverplot\",\"outcomeOverplot\")], use = \"pairwise.complete.obs\"))\n\n\n\n\n\n\n\n\n6.3.3 Scatterplot matrix\n\nCodescatterplotMatrix(~ predictor + outcome + predictorOverplot + outcomeOverplot, data = mydata, use = \"pairwise.complete.obs\")\n\n\n\n\n\n\n\n\n6.3.4 Pairs panels\n\nCodepairs.panels(mydata[,c(\"predictor\",\"outcome\",\"predictorOverplot\",\"outcomeOverplot\")])",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "eda.html#effect-plots",
    "href": "eda.html#effect-plots",
    "title": "Exploratory Data Analysis",
    "section": "\n6.4 Effect Plots",
    "text": "6.4 Effect Plots\n\n6.4.1 Multiple Regression Model\n\nCodemultipleRegressionModel &lt;- lm(outcome ~ predictor + predictorOverplot,\n                              data = mydata,\n                              na.action = \"na.exclude\")\n\nallEffects(multipleRegressionModel)\n\n model: outcome ~ predictor + predictorOverplot\n\n predictor effect\npredictor\n      0.1        20        40        60        80 \n 49.23335  70.37778  91.62847 112.87915 134.12983 \n\n predictorOverplot effect\npredictorOverplot\n       1       10       30       40       50 \n73.13937 73.15070 73.17586 73.18845 73.20103 \n\nCodeplot(allEffects(multipleRegressionModel))\n\n\n\n\n\n\n\n\n6.4.2 Multilevel Regression Model\n\nCodemultilevelRegressionModel &lt;- lme(outcome ~ predictor + predictorOverplot, random = ~ 1|ID,\n                                 method = \"ML\",\n                                 data = mydata,\n                                 na.action = \"na.exclude\")\n\nallEffects(multilevelRegressionModel)\n\n model: outcome ~ predictor + predictorOverplot\n\n predictor effect\npredictor\n      0.1        20        40        60        80 \n 49.23335  70.37778  91.62847 112.87915 134.12983 \n\n predictorOverplot effect\npredictorOverplot\n       1       10       30       40       50 \n73.13937 73.15070 73.17586 73.18845 73.20103 \n\nCodeplot(allEffects(multilevelRegressionModel))",
    "crumbs": [
      "About",
      "Exploratory Data Analysis"
    ]
  },
  {
    "objectID": "bayesian.html",
    "href": "bayesian.html",
    "title": "Bayesian Analysis",
    "section": "",
    "text": "Adapted from brms workshop by Paul-Christian Bürkner",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#install-libraries",
    "href": "bayesian.html#install-libraries",
    "title": "Bayesian Analysis",
    "section": "\n1.1 Install Libraries",
    "text": "1.1 Install Libraries\n\nCode#install.packages(\"remotes\")\n#remotes::install_github(\"DevPsyLab/petersenlab\")",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#load-libraries",
    "href": "bayesian.html#load-libraries",
    "title": "Bayesian Analysis",
    "section": "\n1.2 Load Libraries",
    "text": "1.2 Load Libraries\n\nCodelibrary(\"lme4\")\nlibrary(\"rstan\")\nlibrary(\"brms\")\nlibrary(\"bayestestR\")\nlibrary(\"mice\")",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#simulate-data",
    "href": "bayesian.html#simulate-data",
    "title": "Bayesian Analysis",
    "section": "\n1.3 Simulate Data",
    "text": "1.3 Simulate Data\n\nCodeset.seed(52242)\n\nsampleSize &lt;- 1000\n\nid &lt;- rep(1:100, each = 10)\nX &lt;- rnorm(sampleSize)\nM &lt;- 0.5*X + rnorm(sampleSize)\nY &lt;- 0.7*M + rnorm(sampleSize)\n\nX[sample(1:length(X), size = 10)] &lt;- NA\nM[sample(1:length(M), size = 10)] &lt;- NA\nY[sample(1:length(Y), size = 10)] &lt;- NA\n\nmydata &lt;- data.frame(\n  id = id,\n  X = X,\n  Y = Y,\n  M = M)",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#load-data",
    "href": "bayesian.html#load-data",
    "title": "Bayesian Analysis",
    "section": "\n1.4 Load Data",
    "text": "1.4 Load Data\n\nCodedata(\"sleepstudy\", package = \"lme4\")",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#prepare-data",
    "href": "bayesian.html#prepare-data",
    "title": "Bayesian Analysis",
    "section": "\n1.5 Prepare Data",
    "text": "1.5 Prepare Data\n\nCodeconditions &lt;- make_conditions(sleepstudy, \"Subject\")",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#post-processing-methods",
    "href": "bayesian.html#post-processing-methods",
    "title": "Bayesian Analysis",
    "section": "\n2.1 Post-Processing Methods",
    "text": "2.1 Post-Processing Methods\n\nCodemethods(class = \"brmsfit\")\n\n  [1] add_criterion           add_ic                  as_draws_array         \n  [4] as_draws_df             as_draws_list           as_draws_matrix        \n  [7] as_draws_rvars          as_draws                as.array               \n [10] as.data.frame           as.matrix               as.mcmc                \n [13] autocor                 bayes_factor            bayes_R2               \n [16] bayesfactor_models      bayesfactor_parameters  bayesfactor_restricted \n [19] bci                     bridge_sampler          check_prior            \n [22] ci                      coef                    conditional_effects    \n [25] conditional_smooths     control_params          default_prior          \n [28] describe_posterior      describe_prior          diagnostic_draws       \n [31] diagnostic_posterior    effective_sample        equivalence_test       \n [34] estimate_density        eti                     expose_functions       \n [37] family                  fitted                  fixef                  \n [40] formula                 getCall                 hdi                    \n [43] hypothesis              inits                   kfold                  \n [46] log_lik                 log_posterior           logLik                 \n [49] loo_compare             loo_epred               loo_linpred            \n [52] loo_model_weights       loo_moment_match        loo_predict            \n [55] loo_predictive_interval loo_R2                  loo_subsample          \n [58] loo                     LOO                     map_estimate           \n [61] marginal_effects        marginal_smooths        mcmc_plot              \n [64] mcse                    mediation               model_to_priors        \n [67] model_weights           model.frame             nchains                \n [70] ndraws                  neff_ratio              ngrps                  \n [73] niterations             nobs                    nsamples               \n [76] nuts_params             nvariables              p_direction            \n [79] p_map                   p_rope                  p_significance         \n [82] pairs                   parnames                plot                   \n [85] point_estimate          post_prob               posterior_average      \n [88] posterior_epred         posterior_interval      posterior_linpred      \n [91] posterior_predict       posterior_samples       posterior_smooths      \n [94] posterior_summary       pp_average              pp_check               \n [97] pp_mixture              predict                 predictive_error       \n[100] predictive_interval     prepare_predictions     print                  \n[103] prior_draws             prior_summary           psis                   \n[106] ranef                   reloo                   residuals              \n[109] restructure             rhat                    rope                   \n[112] sexit_thresholds        si                      simulate_prior         \n[115] spi                     stancode                standata               \n[118] stanplot                summary                 unupdate               \n[121] update                  VarCorr                 variables              \n[124] vcov                    waic                    WAIC                   \n[127] weighted_posteriors    \nsee '?methods' for accessing help and source code",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#fit-the-models",
    "href": "bayesian.html#fit-the-models",
    "title": "Bayesian Analysis",
    "section": "\n3.1 Fit the Models",
    "text": "3.1 Fit the Models\n\n3.1.1 Complete Pooling\n\nCodefit_sleep1 &lt;- brm(\n  Reaction ~ 1 + Days,\n  data = sleepstudy,\n  seed  = 52242)\n\n\n\n3.1.2 Random Intercepts\n\nCodefit_sleep2 &lt;- brm(\n  Reaction ~ 1 + Days + (1 | Subject), \n  data = sleepstudy,\n  seed  = 52242)\n\n\n\n3.1.3 Random Intercepts and Slopes\n\nCodefit_sleep3 &lt;- brm(\n  Reaction ~ 1 + Days + (1 + Days | Subject), \n  data = sleepstudy,\n  seed  = 52242\n)",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#summarize-results",
    "href": "bayesian.html#summarize-results",
    "title": "Bayesian Analysis",
    "section": "\n3.2 Summarize Results",
    "text": "3.2 Summarize Results\nFor convergence, Rhat values should not be above 1.00.\n\nCodesummary(fit_sleep3)\n\n Family: gaussian \n  Links: mu = identity \nFormula: Reaction ~ 1 + Days + (1 + Days | Subject) \n   Data: sleepstudy (Number of observations: 180) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nMultilevel Hyperparameters:\n~Subject (Number of levels: 18) \n                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsd(Intercept)          26.76      6.70    15.60    41.96 1.00     1836     2290\nsd(Days)                6.58      1.55     4.17    10.23 1.00     1265     1938\ncor(Intercept,Days)     0.08      0.30    -0.49     0.66 1.00     1041     1736\n\nRegression Coefficients:\n          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nIntercept   251.38      7.39   236.80   266.10 1.00     1912     2086\nDays         10.43      1.76     7.03    13.97 1.00     1294     1865\n\nFurther Distributional Parameters:\n      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma    25.96      1.55    23.13    29.23 1.00     3535     2807\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#model-priors",
    "href": "bayesian.html#model-priors",
    "title": "Bayesian Analysis",
    "section": "\n3.3 Model Priors",
    "text": "3.3 Model Priors\n\nCodeprior_summary(fit_sleep3)",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#model-parameters",
    "href": "bayesian.html#model-parameters",
    "title": "Bayesian Analysis",
    "section": "\n3.4 Model Parameters",
    "text": "3.4 Model Parameters\n\nCodevariables(fit_sleep3)\n\n [1] \"b_Intercept\"                  \"b_Days\"                      \n [3] \"sd_Subject__Intercept\"        \"sd_Subject__Days\"            \n [5] \"cor_Subject__Intercept__Days\" \"sigma\"                       \n [7] \"Intercept\"                    \"r_Subject[308,Intercept]\"    \n [9] \"r_Subject[309,Intercept]\"     \"r_Subject[310,Intercept]\"    \n[11] \"r_Subject[330,Intercept]\"     \"r_Subject[331,Intercept]\"    \n[13] \"r_Subject[332,Intercept]\"     \"r_Subject[333,Intercept]\"    \n[15] \"r_Subject[334,Intercept]\"     \"r_Subject[335,Intercept]\"    \n[17] \"r_Subject[337,Intercept]\"     \"r_Subject[349,Intercept]\"    \n[19] \"r_Subject[350,Intercept]\"     \"r_Subject[351,Intercept]\"    \n[21] \"r_Subject[352,Intercept]\"     \"r_Subject[369,Intercept]\"    \n[23] \"r_Subject[370,Intercept]\"     \"r_Subject[371,Intercept]\"    \n[25] \"r_Subject[372,Intercept]\"     \"r_Subject[308,Days]\"         \n[27] \"r_Subject[309,Days]\"          \"r_Subject[310,Days]\"         \n[29] \"r_Subject[330,Days]\"          \"r_Subject[331,Days]\"         \n[31] \"r_Subject[332,Days]\"          \"r_Subject[333,Days]\"         \n[33] \"r_Subject[334,Days]\"          \"r_Subject[335,Days]\"         \n[35] \"r_Subject[337,Days]\"          \"r_Subject[349,Days]\"         \n[37] \"r_Subject[350,Days]\"          \"r_Subject[351,Days]\"         \n[39] \"r_Subject[352,Days]\"          \"r_Subject[369,Days]\"         \n[41] \"r_Subject[370,Days]\"          \"r_Subject[371,Days]\"         \n[43] \"r_Subject[372,Days]\"          \"lprior\"                      \n[45] \"lp__\"",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#model-coefficients",
    "href": "bayesian.html#model-coefficients",
    "title": "Bayesian Analysis",
    "section": "\n3.5 Model Coefficients",
    "text": "3.5 Model Coefficients\n\nCodecoef(fit_sleep3)\n\n$Subject\n, , Intercept\n\n    Estimate Est.Error     Q2.5    Q97.5\n308 253.8036  13.42340 227.2528 279.4458\n309 211.5798  13.53907 184.5701 237.5476\n310 212.9776  13.44786 186.3989 238.6100\n330 274.5239  13.43628 248.1815 301.9403\n331 273.0398  13.23918 248.1694 299.4477\n332 260.2840  12.23798 236.3152 284.9809\n333 267.8093  12.62690 244.2342 293.6989\n334 244.3311  12.62822 219.1096 269.0711\n335 250.7611  13.16495 224.1951 276.3869\n337 286.1682  13.38914 259.9519 312.2581\n349 226.5570  12.82480 200.4294 251.4542\n350 238.6786  13.13686 212.3307 263.6997\n351 255.7790  12.53802 230.2905 280.3204\n352 272.2132  12.54778 247.9377 297.7906\n369 254.4293  12.50311 230.2014 278.3378\n370 226.7179  13.30644 200.0374 251.3793\n371 252.3647  12.07777 229.1029 275.8134\n372 263.5458  12.38755 239.3714 287.7161\n\n, , Days\n\n      Estimate Est.Error        Q2.5     Q97.5\n308 19.6319154  2.542400 14.91127989 24.921229\n309  1.7458810  2.561539 -3.16997162  6.728358\n310  4.9887767  2.536991  0.03313305 10.034349\n330  5.7537881  2.555568  0.62257977 10.503648\n331  7.5170261  2.469967  2.42232385 12.196072\n332 10.2271380  2.325028  5.69008473 14.750818\n333 10.2869556  2.337880  5.51782984 14.730549\n334 11.5339766  2.405073  6.85791261 16.290102\n335 -0.2252846  2.582433 -5.24670583  4.873086\n337 19.1100826  2.537751 14.24044379 24.060945\n349 11.5705306  2.403886  7.01645714 16.487190\n350 17.0331885  2.543700 12.24508630 22.034614\n351  7.4875668  2.395344  2.89592486 12.176265\n352 14.0213129  2.421787  9.20693205 18.780621\n369 11.3270352  2.379922  6.54155107 15.929727\n370 15.1243321  2.534860 10.24501333 20.291155\n371  9.4030963  2.306262  4.87040862 14.017797\n372 11.7617904  2.361364  7.07438198 16.475036",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#plots",
    "href": "bayesian.html#plots",
    "title": "Bayesian Analysis",
    "section": "\n3.6 Plots",
    "text": "3.6 Plots\n\n3.6.1 Trace Plots\n\nCodeplot(fit_sleep3, ask = FALSE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n3.6.2 Visualize Predictions\n\n3.6.2.1 Sample-Level\n\nCodeplot(conditional_effects(fit_sleep1), points = TRUE)\n\n\n\n\n\n\n\n\n3.6.2.2 Person-Level\n\nCode# re_formula = NULL ensures that group-level effects are included\nce2 &lt;- conditional_effects(\n  fit_sleep3,\n  conditions = conditions,\n  re_formula = NULL)\n\nplot(ce2, ncol = 6, points = TRUE)\n\n\n\n\n\n\n\n\n3.6.3 Check Model Fit\n\n3.6.3.1 Posterior Predictive Check\nEvaluate how closely the posterior predictions match the observed values. If they do not match the general pattern of the observed values, a different response distribution may be necessary.\n\nCodepp_check(fit_sleep3)\n\n\n\n\n\n\nCodepp_check(fit_sleep3, type = \"dens_overlay\")\n\n\n\n\n\n\nCodepp_check(fit_sleep3, \"error_scatter_avg\")",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#fitted-values",
    "href": "bayesian.html#fitted-values",
    "title": "Bayesian Analysis",
    "section": "\n3.7 Fitted Values",
    "text": "3.7 Fitted Values\n\nCodefitted(fit_sleep3)\n\n\n\n\n     Estimate Est.Error     Q2.5    Q97.5\n[1,] 253.8036 13.423405 227.2528 279.4458\n[2,] 273.4355 11.520427 251.1066 295.5886\n[3,] 293.0674  9.908596 273.5416 312.1998\n[4,] 312.6994  8.750308 295.6254 329.6635\n[5,] 332.3313  8.239121 316.1146 348.5817\n[6,] 351.9632  8.492698 335.3675 368.3632",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#residuals",
    "href": "bayesian.html#residuals",
    "title": "Bayesian Analysis",
    "section": "\n3.8 Residuals",
    "text": "3.8 Residuals\n\nCoderesiduals(fit_sleep3)\n\n\n\n\n       Estimate Est.Error       Q2.5     Q97.5\n[1,]  -4.359981  29.46692 -61.815395  53.49204\n[2,] -14.933307  27.93148 -69.475757  40.72256\n[3,] -42.789309  27.97917 -98.036432  11.56407\n[4,]   8.919060  26.99970 -44.082283  62.02641\n[5,]  24.730870  26.95023 -28.225305  78.96176\n[6,]  62.923941  27.86174   8.663845 117.81347",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#compare-models",
    "href": "bayesian.html#compare-models",
    "title": "Bayesian Analysis",
    "section": "\n3.9 Compare Models",
    "text": "3.9 Compare Models\nelpd values: higher is better looic values: lower is better\nelpd_diff values that are greater than ~2 standard errors of the elpd_diff values indicate a significantly better model (i.e., if elpd_diff value is greater than 2 times the se_diff value).\n\nCodeloo(fit_sleep1, fit_sleep2, fit_sleep3)\n\nOutput of model 'fit_sleep1':\n\nComputed from 4000 by 180 log-likelihood matrix.\n\n         Estimate   SE\nelpd_loo   -953.1 10.5\np_loo         3.0  0.5\nlooic      1906.3 21.0\n------\nMCSE of elpd_loo is 0.0.\nMCSE and ESS estimates assume MCMC draws (r_eff in [0.9, 1.2]).\n\nAll Pareto k estimates are good (k &lt; 0.7).\nSee help('pareto-k-diagnostic') for details.\n\nOutput of model 'fit_sleep2':\n\nComputed from 4000 by 180 log-likelihood matrix.\n\n         Estimate   SE\nelpd_loo   -884.7 14.3\np_loo        19.2  3.3\nlooic      1769.4 28.7\n------\nMCSE of elpd_loo is 0.1.\nMCSE and ESS estimates assume MCMC draws (r_eff in [0.4, 1.8]).\n\nAll Pareto k estimates are good (k &lt; 0.7).\nSee help('pareto-k-diagnostic') for details.\n\nOutput of model 'fit_sleep3':\n\nComputed from 4000 by 180 log-likelihood matrix.\n\n         Estimate   SE\nelpd_loo   -861.2 22.1\np_loo        34.0  8.2\nlooic      1722.4 44.1\n------\nMCSE of elpd_loo is NA.\nMCSE and ESS estimates assume MCMC draws (r_eff in [0.5, 1.2]).\n\nPareto k diagnostic values:\n                         Count Pct.    Min. ESS\n(-Inf, 0.7]   (good)     177   98.3%   49      \n   (0.7, 1]   (bad)        3    1.7%   &lt;NA&gt;    \n   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;    \nSee help('pareto-k-diagnostic') for details.\n\nModel comparisons:\n           elpd_diff se_diff\nfit_sleep3   0.0       0.0  \nfit_sleep2 -23.5      11.4  \nfit_sleep1 -91.9      20.7  \n\nCodeprint(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)\n\nOutput of model 'fit_sleep1':\n\nComputed from 4000 by 180 log-likelihood matrix.\n\n         Estimate   SE\nelpd_loo   -953.1 10.5\np_loo         3.0  0.5\nlooic      1906.3 21.0\n------\nMCSE of elpd_loo is 0.0.\nMCSE and ESS estimates assume MCMC draws (r_eff in [0.9, 1.2]).\n\nAll Pareto k estimates are good (k &lt; 0.7).\nSee help('pareto-k-diagnostic') for details.\n\nOutput of model 'fit_sleep2':\n\nComputed from 4000 by 180 log-likelihood matrix.\n\n         Estimate   SE\nelpd_loo   -884.7 14.3\np_loo        19.2  3.3\nlooic      1769.4 28.7\n------\nMCSE of elpd_loo is 0.1.\nMCSE and ESS estimates assume MCMC draws (r_eff in [0.4, 1.8]).\n\nAll Pareto k estimates are good (k &lt; 0.7).\nSee help('pareto-k-diagnostic') for details.\n\nOutput of model 'fit_sleep3':\n\nComputed from 4000 by 180 log-likelihood matrix.\n\n         Estimate   SE\nelpd_loo   -861.2 22.1\np_loo        34.0  8.2\nlooic      1722.4 44.1\n------\nMCSE of elpd_loo is NA.\nMCSE and ESS estimates assume MCMC draws (r_eff in [0.5, 1.2]).\n\nPareto k diagnostic values:\n                         Count Pct.    Min. ESS\n(-Inf, 0.7]   (good)     177   98.3%   49      \n   (0.7, 1]   (bad)        3    1.7%   &lt;NA&gt;    \n   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;    \nSee help('pareto-k-diagnostic') for details.\n\nModel comparisons:\n           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic \nfit_sleep3    0.0       0.0  -861.2     22.1        34.0    8.2   1722.4\nfit_sleep2  -23.5      11.4  -884.7     14.3        19.2    3.3   1769.4\nfit_sleep1  -91.9      20.7  -953.1     10.5         3.0    0.5   1906.3\n           se_looic\nfit_sleep3   44.1  \nfit_sleep2   28.7  \nfit_sleep1   21.0  \n\n\n\n3.9.1 Compute Model Weights\n\nCodemodel_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = \"loo\")\n\n  fit_sleep1   fit_sleep2   fit_sleep3 \n1.192945e-40 6.120337e-11 1.000000e+00 \n\nCoderound(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = \"loo\"))\n\nfit_sleep1 fit_sleep2 fit_sleep3 \n         0          0          1",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#parameters-for-which-to-set-priors",
    "href": "bayesian.html#parameters-for-which-to-set-priors",
    "title": "Bayesian Analysis",
    "section": "\n5.1 Parameters for Which to Set Priors",
    "text": "5.1 Parameters for Which to Set Priors\n\nCodeget_prior(\n  Reaction ~ 1 + Days + (1 + Days | Subject), \n  data = sleepstudy)",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#define-priors",
    "href": "bayesian.html#define-priors",
    "title": "Bayesian Analysis",
    "section": "\n5.2 Define Priors",
    "text": "5.2 Define Priors\n\nCodebprior &lt;- c(\n  set_prior(\"normal(5, 5)\", coef = \"Days\"),\n  set_prior(\"cauchy(0, 10)\", class = \"sd\"),\n  set_prior(\"lkj(2)\", class = \"cor\"))\n\nbprior",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#fit-the-model",
    "href": "bayesian.html#fit-the-model",
    "title": "Bayesian Analysis",
    "section": "\n5.3 Fit the Model",
    "text": "5.3 Fit the Model\nFit the model with these priors, and sample from these priors:\n\nCodefit_sleep4 &lt;- brm(\n  Reaction ~ 1 + Days + (1 + Days | Subject), \n  data = sleepstudy,\n  prior = bprior, \n  sample_prior = TRUE,\n  seed  = 52242\n)",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#between-chain-parallelization",
    "href": "bayesian.html#between-chain-parallelization",
    "title": "Bayesian Analysis",
    "section": "\n7.1 Between-Chain Parallelization",
    "text": "7.1 Between-Chain Parallelization\n\nCodefit_sleep4 &lt;- brm(\n  Reaction ~ 1 + Days + (1 + Days | Subject), \n  data = sleepstudy,\n  prior = bprior, \n  sample_prior = TRUE,\n  cores = 4,\n  seed  = 52242\n)",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#within-chain-parallelization",
    "href": "bayesian.html#within-chain-parallelization",
    "title": "Bayesian Analysis",
    "section": "\n7.2 Within-Chain Parallelization",
    "text": "7.2 Within-Chain Parallelization\nhttps://paul-buerkner.github.io/brms/articles/brms_threading.html (archived at https://perma.cc/NCG3-KV4G)",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#multiply-imputed-datasets-from-mice",
    "href": "bayesian.html#multiply-imputed-datasets-from-mice",
    "title": "Bayesian Analysis",
    "section": "\n8.1 Multiply Imputed Datasets from mice\n",
    "text": "8.1 Multiply Imputed Datasets from mice\n\n\nCode?brm_multiple\n\n\n\nCodeimp &lt;- mice::mice(\n  mydata,\n  m = 5,\n  print = FALSE)\n\nfit_imp &lt;- brm_multiple(\n  bayesianMediationSyntax,\n  data = imp,\n  chains = 2)\n\n\nSAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).\nChain 1: \nChain 1: Gradient evaluation took 0.00026 seconds\nChain 1: 1000 transitions using 10 leapfrog steps per transition would take 2.6 seconds.\nChain 1: Adjust your expectations accordingly!\nChain 1: \nChain 1: \nChain 1: Iteration:    1 / 2000 [  0%]  (Warmup)\nChain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)\nChain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)\nChain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)\nChain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)\nChain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)\nChain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)\nChain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)\nChain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)\nChain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)\nChain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)\nChain 1: Iteration: 2000 / 2000 [100%]  (Sampling)\nChain 1: \nChain 1:  Elapsed Time: 4.772 seconds (Warm-up)\nChain 1:                2.487 seconds (Sampling)\nChain 1:                7.259 seconds (Total)\nChain 1: \n\nSAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).\nChain 2: \nChain 2: Gradient evaluation took 0.000116 seconds\nChain 2: 1000 transitions using 10 leapfrog steps per transition would take 1.16 seconds.\nChain 2: Adjust your expectations accordingly!\nChain 2: \nChain 2: \nChain 2: Iteration:    1 / 2000 [  0%]  (Warmup)\nChain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)\nChain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)\nChain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)\nChain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)\nChain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)\nChain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)\nChain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)\nChain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)\nChain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)\nChain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)\nChain 2: Iteration: 2000 / 2000 [100%]  (Sampling)\nChain 2: \nChain 2:  Elapsed Time: 5.28 seconds (Warm-up)\nChain 2:                2.48 seconds (Sampling)\nChain 2:                7.76 seconds (Total)\nChain 2: \n\nSAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).\nChain 1: \nChain 1: Gradient evaluation took 0.000147 seconds\nChain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.47 seconds.\nChain 1: Adjust your expectations accordingly!\nChain 1: \nChain 1: \nChain 1: Iteration:    1 / 2000 [  0%]  (Warmup)\nChain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)\nChain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)\nChain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)\nChain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)\nChain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)\nChain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)\nChain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)\nChain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)\nChain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)\nChain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)\nChain 1: Iteration: 2000 / 2000 [100%]  (Sampling)\nChain 1: \nChain 1:  Elapsed Time: 5.358 seconds (Warm-up)\nChain 1:                3.656 seconds (Sampling)\nChain 1:                9.014 seconds (Total)\nChain 1: \n\nSAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).\nChain 2: \nChain 2: Gradient evaluation took 0.000115 seconds\nChain 2: 1000 transitions using 10 leapfrog steps per transition would take 1.15 seconds.\nChain 2: Adjust your expectations accordingly!\nChain 2: \nChain 2: \nChain 2: Iteration:    1 / 2000 [  0%]  (Warmup)\nChain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)\nChain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)\nChain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)\nChain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)\nChain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)\nChain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)\nChain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)\nChain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)\nChain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)\nChain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)\nChain 2: Iteration: 2000 / 2000 [100%]  (Sampling)\nChain 2: \nChain 2:  Elapsed Time: 5.605 seconds (Warm-up)\nChain 2:                1.838 seconds (Sampling)\nChain 2:                7.443 seconds (Total)\nChain 2: \n\nSAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).\nChain 1: \nChain 1: Gradient evaluation took 0.000124 seconds\nChain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.24 seconds.\nChain 1: Adjust your expectations accordingly!\nChain 1: \nChain 1: \nChain 1: Iteration:    1 / 2000 [  0%]  (Warmup)\nChain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)\nChain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)\nChain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)\nChain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)\nChain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)\nChain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)\nChain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)\nChain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)\nChain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)\nChain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)\nChain 1: Iteration: 2000 / 2000 [100%]  (Sampling)\nChain 1: \nChain 1:  Elapsed Time: 5 seconds (Warm-up)\nChain 1:                3.577 seconds (Sampling)\nChain 1:                8.577 seconds (Total)\nChain 1: \n\nSAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).\nChain 2: \nChain 2: Gradient evaluation took 0.000114 seconds\nChain 2: 1000 transitions using 10 leapfrog steps per transition would take 1.14 seconds.\nChain 2: Adjust your expectations accordingly!\nChain 2: \nChain 2: \nChain 2: Iteration:    1 / 2000 [  0%]  (Warmup)\nChain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)\nChain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)\nChain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)\nChain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)\nChain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)\nChain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)\nChain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)\nChain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)\nChain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)\nChain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)\nChain 2: Iteration: 2000 / 2000 [100%]  (Sampling)\nChain 2: \nChain 2:  Elapsed Time: 5.114 seconds (Warm-up)\nChain 2:                3.623 seconds (Sampling)\nChain 2:                8.737 seconds (Total)\nChain 2: \n\nSAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).\nChain 1: \nChain 1: Gradient evaluation took 0.000125 seconds\nChain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.25 seconds.\nChain 1: Adjust your expectations accordingly!\nChain 1: \nChain 1: \nChain 1: Iteration:    1 / 2000 [  0%]  (Warmup)\nChain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)\nChain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)\nChain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)\nChain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)\nChain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)\nChain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)\nChain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)\nChain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)\nChain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)\nChain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)\nChain 1: Iteration: 2000 / 2000 [100%]  (Sampling)\nChain 1: \nChain 1:  Elapsed Time: 5.049 seconds (Warm-up)\nChain 1:                3.564 seconds (Sampling)\nChain 1:                8.613 seconds (Total)\nChain 1: \n\nSAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).\nChain 2: \nChain 2: Gradient evaluation took 0.000126 seconds\nChain 2: 1000 transitions using 10 leapfrog steps per transition would take 1.26 seconds.\nChain 2: Adjust your expectations accordingly!\nChain 2: \nChain 2: \nChain 2: Iteration:    1 / 2000 [  0%]  (Warmup)\nChain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)\nChain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)\nChain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)\nChain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)\nChain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)\nChain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)\nChain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)\nChain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)\nChain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)\nChain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)\nChain 2: Iteration: 2000 / 2000 [100%]  (Sampling)\nChain 2: \nChain 2:  Elapsed Time: 4.678 seconds (Warm-up)\nChain 2:                2.187 seconds (Sampling)\nChain 2:                6.865 seconds (Total)\nChain 2: \n\nSAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).\nChain 1: \nChain 1: Gradient evaluation took 0.000126 seconds\nChain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.26 seconds.\nChain 1: Adjust your expectations accordingly!\nChain 1: \nChain 1: \nChain 1: Iteration:    1 / 2000 [  0%]  (Warmup)\nChain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)\nChain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)\nChain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)\nChain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)\nChain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)\nChain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)\nChain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)\nChain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)\nChain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)\nChain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)\nChain 1: Iteration: 2000 / 2000 [100%]  (Sampling)\nChain 1: \nChain 1:  Elapsed Time: 4.775 seconds (Warm-up)\nChain 1:                3.658 seconds (Sampling)\nChain 1:                8.433 seconds (Total)\nChain 1: \n\nSAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).\nChain 2: \nChain 2: Gradient evaluation took 0.000115 seconds\nChain 2: 1000 transitions using 10 leapfrog steps per transition would take 1.15 seconds.\nChain 2: Adjust your expectations accordingly!\nChain 2: \nChain 2: \nChain 2: Iteration:    1 / 2000 [  0%]  (Warmup)\nChain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)\nChain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)\nChain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)\nChain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)\nChain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)\nChain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)\nChain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)\nChain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)\nChain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)\nChain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)\nChain 2: Iteration: 2000 / 2000 [100%]  (Sampling)\nChain 2: \nChain 2:  Elapsed Time: 4.802 seconds (Warm-up)\nChain 2:                3.656 seconds (Sampling)\nChain 2:                8.458 seconds (Total)\nChain 2:",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "bayesian.html#imputation-on-the-fly-during-model-fitting",
    "href": "bayesian.html#imputation-on-the-fly-during-model-fitting",
    "title": "Bayesian Analysis",
    "section": "\n8.2 Imputation on the Fly During Model Fitting",
    "text": "8.2 Imputation on the Fly During Model Fitting\nhttps://paul-buerkner.github.io/brms/articles/brms_missings.html (archived at https://perma.cc/4Y9L-USQR)\n\nCode?mi\n\n\n\nCodebayesianRegressionImputationSyntax &lt;-\n  bf(X | mi() ~ (1 |i| id)) +\n  bf(M | mi() ~ mi(X) + (1 |i| id)) +\n  bf(Y | mi() ~ mi(X) + mi(M) + (1 |i| id)) +\n  set_rescor(FALSE) # don't add a residual correlation between X, M, and Y\n\nbayesianRegressionModel &lt;- brm(\n  bayesianRegressionImputationSyntax,\n  data = mydata,\n  seed = 52242\n)\n\n\nSAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).\nChain 1: \nChain 1: Gradient evaluation took 0.000528 seconds\nChain 1: 1000 transitions using 10 leapfrog steps per transition would take 5.28 seconds.\nChain 1: Adjust your expectations accordingly!\nChain 1: \nChain 1: \nChain 1: Iteration:    1 / 2000 [  0%]  (Warmup)\nChain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)\nChain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)\nChain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)\nChain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)\nChain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)\nChain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)\nChain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)\nChain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)\nChain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)\nChain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)\nChain 1: Iteration: 2000 / 2000 [100%]  (Sampling)\nChain 1: \nChain 1:  Elapsed Time: 21.261 seconds (Warm-up)\nChain 1:                13.428 seconds (Sampling)\nChain 1:                34.689 seconds (Total)\nChain 1: \n\nSAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).\nChain 2: \nChain 2: Gradient evaluation took 0.000419 seconds\nChain 2: 1000 transitions using 10 leapfrog steps per transition would take 4.19 seconds.\nChain 2: Adjust your expectations accordingly!\nChain 2: \nChain 2: \nChain 2: Iteration:    1 / 2000 [  0%]  (Warmup)\nChain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)\nChain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)\nChain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)\nChain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)\nChain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)\nChain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)\nChain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)\nChain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)\nChain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)\nChain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)\nChain 2: Iteration: 2000 / 2000 [100%]  (Sampling)\nChain 2: \nChain 2:  Elapsed Time: 20.113 seconds (Warm-up)\nChain 2:                13.423 seconds (Sampling)\nChain 2:                33.536 seconds (Total)\nChain 2: \n\nSAMPLING FOR MODEL 'anon_model' NOW (CHAIN 3).\nChain 3: \nChain 3: Gradient evaluation took 0.00043 seconds\nChain 3: 1000 transitions using 10 leapfrog steps per transition would take 4.3 seconds.\nChain 3: Adjust your expectations accordingly!\nChain 3: \nChain 3: \nChain 3: Iteration:    1 / 2000 [  0%]  (Warmup)\nChain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)\nChain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)\nChain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)\nChain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)\nChain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)\nChain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)\nChain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)\nChain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)\nChain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)\nChain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)\nChain 3: Iteration: 2000 / 2000 [100%]  (Sampling)\nChain 3: \nChain 3:  Elapsed Time: 19.261 seconds (Warm-up)\nChain 3:                13.415 seconds (Sampling)\nChain 3:                32.676 seconds (Total)\nChain 3: \n\nSAMPLING FOR MODEL 'anon_model' NOW (CHAIN 4).\nChain 4: \nChain 4: Gradient evaluation took 0.000416 seconds\nChain 4: 1000 transitions using 10 leapfrog steps per transition would take 4.16 seconds.\nChain 4: Adjust your expectations accordingly!\nChain 4: \nChain 4: \nChain 4: Iteration:    1 / 2000 [  0%]  (Warmup)\nChain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)\nChain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)\nChain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)\nChain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)\nChain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)\nChain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)\nChain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)\nChain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)\nChain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)\nChain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)\nChain 4: Iteration: 2000 / 2000 [100%]  (Sampling)\nChain 4: \nChain 4:  Elapsed Time: 18.718 seconds (Warm-up)\nChain 4:                12.384 seconds (Sampling)\nChain 4:                31.102 seconds (Total)\nChain 4: \n\nCodesummary(bayesianRegressionModel)\n\n Family: MV(gaussian, gaussian, gaussian) \n  Links: mu = identity\n         mu = identity\n         mu = identity \nFormula: X | mi() ~ (1 | i | id) \n         M | mi() ~ mi(X) + (1 | i | id) \n         Y | mi() ~ mi(X) + mi(M) + (1 | i | id) \n   Data: mydata (Number of observations: 1000) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nMultilevel Hyperparameters:\n~id (Number of levels: 100) \n                             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS\nsd(X_Intercept)                  0.09      0.06     0.00     0.21 1.00     1007\nsd(M_Intercept)                  0.07      0.05     0.00     0.18 1.00     1534\nsd(Y_Intercept)                  0.10      0.06     0.01     0.22 1.00     1310\ncor(X_Intercept,M_Intercept)     0.08      0.49    -0.84     0.90 1.00     3556\ncor(X_Intercept,Y_Intercept)     0.06      0.47    -0.82     0.88 1.00     2320\ncor(M_Intercept,Y_Intercept)     0.00      0.48    -0.88     0.86 1.00     2474\n                             Tail_ESS\nsd(X_Intercept)                  1428\nsd(M_Intercept)                  2177\nsd(Y_Intercept)                  2087\ncor(X_Intercept,M_Intercept)     2922\ncor(X_Intercept,Y_Intercept)     2480\ncor(M_Intercept,Y_Intercept)     2693\n\nRegression Coefficients:\n            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nX_Intercept    -0.02      0.03    -0.08     0.05 1.00     7564     3001\nM_Intercept     0.01      0.03    -0.06     0.07 1.00     7728     3049\nY_Intercept     0.06      0.03    -0.01     0.12 1.00     6781     2915\nM_miX           0.51      0.03     0.45     0.58 1.00     8400     2801\nY_miX           0.04      0.04    -0.04     0.11 1.00     5567     2993\nY_miM           0.68      0.03     0.62     0.74 1.00     5954     3270\n\nFurther Distributional Parameters:\n        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma_X     0.98      0.02     0.94     1.03 1.00     6184     2817\nsigma_M     1.01      0.02     0.96     1.05 1.00     6661     2907\nsigma_Y     1.01      0.02     0.96     1.05 1.00     5554     2605\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n\nCodehypothesis(\n  bayesianRegressionModel,\n  \"bsp_M_miX * bsp_Y_miM = 0\", # indirect effect = a path * b path\n  class = NULL,\n  seed = 52242\n)\n\nHypothesis Tests for class :\n                Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio\n1 (bsp_M_miX*bsp_Y_... = 0     0.35      0.03      0.3      0.4         NA\n  Post.Prob Star\n1        NA    *\n---\n'CI': 90%-CI for one-sided and 95%-CI for two-sided hypotheses.\n'*': For one-sided hypotheses, the posterior probability exceeds 95%;\nfor two-sided hypotheses, the value tested against lies outside the 95%-CI.\nPosterior probabilities of point hypotheses assume equal prior probabilities.",
    "crumbs": [
      "About",
      "Bayesian Analysis"
    ]
  },
  {
    "objectID": "lda.html",
    "href": "lda.html",
    "title": "Longitudinal Data Analysis",
    "section": "",
    "text": "1 Approaches for Modeling Longitudinal Data\n\nGrowth curve model\nLatent growth curve model\nLatent change score model\nCross-lagged panel model\nLatent curve model with structured residuals\n\n\n\n2 Longitudinal Scores are on the Same Statistical Scale Across Time\n\nTests of longitudinal measurement invariance\n\n\n\n3 Estimating Nonlinear Growth\nThere are a variety of ways to estimate nonlinear growth in a growth curve model using a mixed-effects or structural equation model:\n\npolynomial growth model\n\nfractional polynomial model (more parsimonious than traditional polynomials because can capture nonlinear growth with fewer parameters, thus reducing overfitting)\n\npiecewise/spline model\n\ncan have fixed or random knots\nlocation of knots can be estimated for the data\neach individual can have a different numbers of knots and different location for the knots\n\nlatent basis growth model\n\ncan specify the rate of change between T1 and T2 to be one; can allow the rate of change to freely vary between remaining timepoints\n\nexponential growth model\nlogistic growth model\nlogarithmic growth model\ngeneralized additive model\nnonparametric growth model (e.g., kernel smoothing)\nGompertz growth model\nRichards growth model\nTaylor series approximation model\nlatent change score model\n\n\n\n\n\n\n\nReuseCC BY 4.0",
    "crumbs": [
      "About",
      "Longitudinal Data Analysis"
    ]
  },
  {
    "objectID": "markdown.html",
    "href": "markdown.html",
    "title": "Markdown",
    "section": "",
    "text": "This is an Quarto document that is written using Markdown. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see https://rmarkdown.rstudio.com (archived at https://perma.cc/4MP3-5RT8). For more details on using Quarto, see https://quarto.org.\nYou can embed an R code chunk like this:\n```{r}\nsummary(cars)\n```\n\nCodesummary(cars)\n\n     speed           dist       \n Min.   : 4.0   Min.   :  2.00  \n 1st Qu.:12.0   1st Qu.: 26.00  \n Median :15.0   Median : 36.00  \n Mean   :15.4   Mean   : 42.98  \n 3rd Qu.:19.0   3rd Qu.: 56.00  \n Max.   :25.0   Max.   :120.00  \n\n\n\nhttps://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf (archived at https://perma.cc/8P7X-9XPV)",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-overview",
    "href": "markdown.html#sec-overview",
    "title": "Markdown",
    "section": "",
    "text": "This is an Quarto document that is written using Markdown. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see https://rmarkdown.rstudio.com (archived at https://perma.cc/4MP3-5RT8). For more details on using Quarto, see https://quarto.org.\nYou can embed an R code chunk like this:\n```{r}\nsummary(cars)\n```\n\nCodesummary(cars)\n\n     speed           dist       \n Min.   : 4.0   Min.   :  2.00  \n 1st Qu.:12.0   1st Qu.: 26.00  \n Median :15.0   Median : 36.00  \n Mean   :15.4   Mean   : 42.98  \n 3rd Qu.:19.0   3rd Qu.: 56.00  \n Max.   :25.0   Max.   :120.00",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-referenceGuide",
    "href": "markdown.html#sec-referenceGuide",
    "title": "Markdown",
    "section": "",
    "text": "https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf (archived at https://perma.cc/8P7X-9XPV)",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-bestPractices",
    "href": "markdown.html#sec-bestPractices",
    "title": "Markdown",
    "section": "\n2.1 Best Practices",
    "text": "2.1 Best Practices\nAdapted from here (archived at https://perma.cc/P75L-3UM9):\n\n\nUse a new line for every sentence. This helps with version control—individually changed sentences will be highlighted upon commits (which are easy to parse to identify the specific changes) rather than whole paragraphs (which are a nightmare to parse to identify the specific changes).\n\nThis formatting is incompatible with a double space after a period. Instead, use a single space after a period. To replace all double spaces with single spaces, do a find and replace for \".  \" → \". \" Be careful not to blanket remove all double spaces because tabbed bullets have 3 spaces.\n\n\nAdd protocol entries as links to the parent .Rmd file (or to README.md)\nAdd linked content (e.g., images) to sub-directories\nUse no spaces in file or folder names. Use a dash (-) instead of a space.\nIf you use Visual Studio Code to edit the Lab Wiki, you can view the source code side-by-side with the markdown Preview (after selecting the code type as markdown): \n\nWhen making numbered (ordered) lists, just use 1. for all numbers. Markdown will make them sequential automatically. This is helpful if you go back and add additional entries later.\nFor all quotation marks, use straight quotes (', \") rather than curly quotes (‘, ’, “, ”).\nUse \"[XXX]\" to indicate an area that needs editing. This will allow the lab to CTRL+F for \"[XXX]\" and find areas that need editing.\nTo update the list of R packages that are installed for running the .Rmd files, update the DESCRIPTION file.\nWhen adding a link to an external (non-lab) URL, add both the original link and the perma.cc link to prevent link rot (websites will go offline and disappear over time). For example: http://www.cookbook-r.com/Graphs/Scatterplots_(ggplot2)/ (archived at https://perma.cc/N4TL-JQS4) You can get a perma.cc account through the UI Libraries.\nAs noted in the links section, link to the heading label, and do not use the website-derived link for a given heading because it is not a stable link; the heading path can change if other headings are added.",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-updateWiki",
    "href": "markdown.html#sec-updateWiki",
    "title": "Markdown",
    "section": "\n2.2 Updating",
    "text": "2.2 Updating\nTo update the lab wiki, perform the following steps:\n\n(Perform this step if you do not already have the the LabWiki GitHub repo on your local machine:) Clone the GitHub repo to your local machine.\nFetch the latest version of the repo. It is important to do this to make sure you have the latest version locally before making any changes.\nEdit the relevant .Rmd files using RStudio or Visual Studio Code.\nPreview the wiki before you commit changes to the site; create the .html files locally (in a folder called _site) by running the following command:\n\nrmarkdown::render_site()\n\n\nIf the .html files look correct, commit the changes.\nPush the changes to the GitHub repo. After pushing the changes to the GitHub repo, GitHub Actions will automatically re-run the code and deploy the updated website, assuming there were no errors. You can track the workflow for errors here: https://github.com/DevPsyLab/LabWiki/actions.\n\nFor more information about Quarto and rmarkdown that were used to generate the site, see the following links:\n\nhttps://quarto.org\n\nhttps://bookdown.org/yihui/rmarkdown/rmarkdown-site.html (archived at https://perma.cc/5C4T-SY9V)\n\nhttps://bookdown.org/yihui/rmarkdown/html-document.html (archived at https://perma.cc/WQS5-KH4S)",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-vsCode",
    "href": "markdown.html#sec-vsCode",
    "title": "Markdown",
    "section": "\n3.1 Microsoft Visual Studio Code",
    "text": "3.1 Microsoft Visual Studio Code\nIf you use Visual Studio Code to create/edit .Rmd documents, you can view the source code side-by-side with the markdown Preview (after selecting the code type as markdown):",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-rstudio",
    "href": "markdown.html#sec-rstudio",
    "title": "Markdown",
    "section": "\n3.2 RStudio",
    "text": "3.2 RStudio\n\n3.2.1 Creating a Code Chunk\nAdd a new chunk by clicking the Insert Chunk button on the toolbar or by pressing Ctrl+Alt+I.\n\n3.2.2 Running a Code Chunk\nYou can execute a code chunk in an R Markdown Notebook by clicking the Run button within the chunk or by placing your cursor inside it and pressing Ctrl+Shift+Enter. To run more than one code chunk, you have several options:\n\nclick the Run button within the chunks you want to run\nselect “Run All Chunks Above”\nselect “Run All Chunks Below”\nselect “Run All”\n\n3.2.3 Creating the HTML Output\nWhen you click the Knit button, a document will be generated that includes both content as well as the output of any embedded Rcode chunks within the document.\nWhen you save the computational notebook (.Rmd), an HTML (.html) file containing the code and output will be saved alongside it (click the Preview button or press Ctrl+Shift+K to preview the HTML file).\nThe preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike Knit, Preview does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-general",
    "href": "markdown.html#sec-general",
    "title": "Markdown",
    "section": "\n4.1 General Info",
    "text": "4.1 General Info\nYou can use an R Markdown Notebook to create a computational notebook. For more information on the value of computational notebooks, see the article titled “The Scientific Paper Is Obsolete” (https://www.theatlantic.com/science/archive/2018/04/the-scientific-paper-is-obsolete/556676/; archived at https://perma.cc/XHW4-K89V)“. For more information about how to create R Notebooks, see here:\nhttps://garrettgman.github.io/rmarkdown/r_notebooks (archived at https://perma.cc/L78P-G73Z)\nhttps://bookdown.org/yihui/rmarkdown/notebook.html (archived at https://perma.cc/P5YT-395F)",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-files",
    "href": "markdown.html#sec-files",
    "title": "Markdown",
    "section": "\n4.2 Files",
    "text": "4.2 Files\nConsistent with the Petersen Lab template for how to structure your repo, you should have two computational notebooks: 1) a “Prepare Data” script (prepareData.Rmd) and 2) a “Computational Notebook” script (computationalNotebook.Rmd). The “Prepare Data” script is used to update the data file by re-exporting, merging, re-running calculations, etc. This script should be separate from the “Computational Notebook” file that is used for running analyses on the data. Every time you run the “Computational Notebook” file with the exact same data, you should get the exact same findings (i.e., reproducibility). Thus, we keep the “Prepare Data script” separate from the “Computational Notebook” file so that you update the data only when you intend to.",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-structure",
    "href": "markdown.html#sec-structure",
    "title": "Markdown",
    "section": "\n4.3 Structure",
    "text": "4.3 Structure\nWhen creating a computational notebook, follow the structure of the computational notebooks in the Petersen Lab template.\nTo use the lab templates for the “Prepare Data” and “Computational Notebook” scripts, first install the petersenlab package. Then, in RStudio, select “File” &gt; “New File” &gt; “R Markdown”. Then, select “From Template”, and select either the “prepareData” or “computationalNotebook” template.\nIf you want to create a computational notebook manually (instead of using the lab template), create a .Rmd file with the following YAML header at the top of the file:\n---\ntitle: \"INSERT TITLE\"\nauthor: \"INSERT AUTHOR NAME(S)\"\ndate: \"`r format(Sys.time(), '%d %B, %Y')`\"\noutput: \n  html_document:\n    toc: true\n    toc_depth: 4\n    toc_float: true\n    number_sections: true\n    code_folding: show\n    df_print: paged\n---\nIf this is your “Computational Notebook” script, include the following as the first code chunk:\n```{r setup, include = FALSE}\nknitr::opts_chunk$set(\n  echo = TRUE, # print code\n  error = TRUE # do not interrupt in case of errors\n)\n\n# Use for higher quality figures on Windows devices\ntrace(grDevices::png, quote({\n  if (missing(type) && missing(antialias)) {\n    type &lt;- \"cairo-png\"\n    antialias &lt;- \"subpixel\"\n  }\n}), print = FALSE)\n```\nIf this is your “Prepare Data” script, include the following as the first code chunk:\n```{r setup, include = FALSE}\nknitr::opts_chunk$set(\n  echo = TRUE # print code\n)\n```\nThen, include whatever text and/or code chunks.",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-css",
    "href": "markdown.html#sec-css",
    "title": "Markdown",
    "section": "\n4.4 Creating CSS Commands",
    "text": "4.4 Creating CSS Commands\nPersonalized commands can be created in Visual Code through the CSS file within the Wiki folder. To create a new CSS command:\n\nIn Visual Studio Code, open the css tab within the Wiki Folder\nOpen the # srs.css file under the css tab\nEnter in your personalized command according to the following structure:\n\nCOMMAND_NAME {\n  command-specification1: value1;\n  command-specification2: value2;\n  command-specification3: value3;\n  quotes: \"\"\" \"\"\" \"‘\" \"'\";\n}\n\nThe following specifications may be added to your command:\n\n\nfont-size: Value = percentage\n\ne.g., font-size: 150%\n\n\n\n\nfont-style: Value = bold, italic, underline\n\ne.g., font-style: bold, font-style: italic\n\n\n\n\ncolor: Value = color name or color code\n\ne.g., color: green, color: #0e6b1c\n\n\n\nTo edit the command to add quotations, include the following after the end bracket of the command: COMMAND_NAME:before { content: open-quote; }  COMMAND_NAME:after  { content: close-quote; }\n\n\n\nAn example of a command is presented here:\n\nexample {\n  font-size: 150%;\n  font-style: italic;\n  color:#C800FC;\n  quotes: \"\"\" \"\"\" \"‘\" \"'\";\n}\nexample:before { content: open-quote; }\nexample:after  { content: close-quote; }",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-websiteSteps",
    "href": "markdown.html#sec-websiteSteps",
    "title": "Markdown",
    "section": "\n5.1 Steps to Create",
    "text": "5.1 Steps to Create\n\nCreate a new GitHub repo under the DevPsyLab organization in GitHub\nCreate the repository using one of the following templates (and select “Include all branches”):\n\n\nrmarkdown: https://github.com/DevPsyLab/MarkdownWebsite\n\nfor local rendering: https://github.com/DevPsyLab/MarkdownWebsite-RenderLocal\n\n\n\n\nQuarto: https://github.com/DevPsyLab/QuartoWebsite\n\nfor local rendering: https://github.com/DevPsyLab/QuartoWebsite-RenderLocal\n\n\n\n\n\n\nIf you do not create the repository from a template, the steps for creating the repo manually are below:\n\nCreate a README.md file\n\nthis is the file that people see when navigating to the repo\n\n\nAdd a .gitignore file\n\nthis file says what file types to ignore and not add to the repo\n\n\nCreate a new branch called gh-pages\n\nDelete all files in the gh-pages branch\nSwitch back the main branch of the repo, and add the following contents (to the main branch, not to the gh-pages branch):\n\n\n/.github/workflows/deploy_markdown.yml file\n\nthis file tells GitHub Actions was steps to run\nadd the following contents to the file:\n\nif using rmarkdown:\n\nif the website is intended to be public: https://github.com/DevPsyLab/LabWiki/blob/main/.github/workflows/deploy_rmarkdown.yml\n\nif the website is intended to be private: https://github.com/DevPsyLab/SchoolReadinessStudy/blob/main/.github/workflows/deploy_rmarkdown.yml\n\n\n\nif using Quarto:\n\nif the website is intended to be public: https://github.com/DevPsyLab/QuartoWebsite/blob/main/.github/workflows/publish.yml\n\nif the website is intended to be private: https://github.com/DevPsyLab/QuartoWebsite-RenderLocal/blob/main/.github/workflows/publish.yml\n\n\n\n\n\n\n\n\nYAML file—this file creates the navbar:\n\nif using rmarkdown:\n\n\n_site.yml file\n\n\nif using Quarto:\n\n\n_quarto.yml file\n\n\n\n\n\nLICENSE file\n\nthis file is the license\n\n\n\nDESCRIPTION file\n\nthis file tells GitHub Actions what R packages to install\n\n\n\n\nAdd each .Rmd file (for rmarkdown) or .qmd file (for Quarto)\nAdd folders for the font, images, and includes\n\n\nincludes contains css files, javascript files, footers, and Google Analytics\n\n\nIf the rmarkdown website is intended to be public, create a new Google Analytics property, and replace the URL and gtag in the google_analytics.html file\nCommit the repo to GitHub\n\nTo deploy the website on GitHub Pages:\n\nMake the repo public (Settings &gt; General &gt; Change Visibility)\nActivate GitHub Pages (Settings &gt; Pages)\n\nSource: “Deploy from a Branch”\nBranch: gh-pages/root\n\nClick “Save”\n\n\nMake sure “Read and write permissions” are enabled in Settings -&gt; Actions -&gt; General -&gt; Workflow permissions",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#quarto-manuscripts",
    "href": "markdown.html#quarto-manuscripts",
    "title": "Markdown",
    "section": "\n5.2 Quarto Manuscripts",
    "text": "5.2 Quarto Manuscripts\n\nQuarto Journal Templates: https://github.com/quarto-journals\n\nSample Manuscripts: https://quarto.org/docs/manuscripts\n\n\nExample:\n\n\nhttps://github.com/mine-cetinkaya-rundel/indo-rct\n\nhttps://mine-cetinkaya-rundel.github.io/indo-rct/\n\n\n\nTo prevent code from re-running unless code is altered:\nexecute:\n    freeze: auto",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-troubleshootingMarkdown",
    "href": "markdown.html#sec-troubleshootingMarkdown",
    "title": "Markdown",
    "section": "\n5.3 Troubleshooting",
    "text": "5.3 Troubleshooting\nIf you get the following error in GitHub Actions:\nremote: Permission to GITHUB_USERNAME/REPO_NAME.git denied to github-actions[bot].\nfatal: unable to access 'https://github.com/GITHUB_USERNAME/REPO_NAME.git/': The requested URL returned error: 403\nCheck if “Read and write permissions” are enabled in Settings -&gt; Actions -&gt; General -&gt; Workflow permissions: https://stackoverflow.com/a/75308228/2029527 (archived at https://perma.cc/R57Z-9JUS)",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-subheading",
    "href": "markdown.html#sec-subheading",
    "title": "Markdown",
    "section": "\n7.1 Subheading",
    "text": "7.1 Subheading\n\n7.1.1 Subsubheading\n\n7.1.1.1 Subsubsubheading\n# Headings {#sec-heading-label1}\n\n## Subheading {#sec-heading-label2}\n\n### Subsubheading {#sec-heading-label3}\n\n#### Subsubsubheading {#sec-heading-label4}",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-unorderedLists",
    "href": "markdown.html#sec-unorderedLists",
    "title": "Markdown",
    "section": "\n8.1 Unordered Lists",
    "text": "8.1 Unordered Lists\nTo create an unordered list, add a dash (-) in front of line items. Adding an asterisk (*) or plus sign (+) in front of line items will also create an unordered list; however, the lab convention is to use dashes for unordered lists. We use asterisks for adding emphasis to text.\n- one item\n- one item\n- one item\n    - one more item\n    - one more item\n    - one more item\n        - lower level\n            - sub-item 1\n            - sub-item 2\n\none item\none item\none item\n\none more item\none more item\none more item\n\nlower level\n\nsub-item 1\nsub-item 2\n\n\n\n\n\n\n\n\n8.1.1 Checkboxes\n- &lt;input type=\"checkbox\" unchecked&gt; Box 1&lt;/input&gt;\n- &lt;input type=\"checkbox\" checked&gt; Box 2&lt;/input&gt;\n\n\n Box 1\n\n Box 2",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-orderedLists",
    "href": "markdown.html#sec-orderedLists",
    "title": "Markdown",
    "section": "\n8.2 Ordered Lists",
    "text": "8.2 Ordered Lists\n1. the first item\n    1. test\n    1. test\n        1. new test\n        1. new test\n1. the second item\n    1. test\n    1. test\n1. the third item\n    - one unordered item\n        - subitem\n    - one unordered item\n1. fourth item\n    1. test\n    1. test\n    1. test\n\nthe first item\n\ntest\ntest\n\nnew test\nnew test\n\n\n\n\nthe second item\n\ntest\ntest\n\n\nthe third item\n\none unordered item\n\nsubitem\n\n\none unordered item\n\n\nfourth item\n\ntest\ntest\ntest",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-markdownComments",
    "href": "markdown.html#sec-markdownComments",
    "title": "Markdown",
    "section": "\n10.1 Markdown",
    "text": "10.1 Markdown\n```markdown\n[This is how to write a hidden comment in Markdown.]: # \n```\n\n[This comment will be hidden.]: # \n[This is how to write a hidden comment in Markdown.]: #",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-htmlComments",
    "href": "markdown.html#sec-htmlComments",
    "title": "Markdown",
    "section": "\n10.2 HTML",
    "text": "10.2 HTML\n&lt;!-- This text will be hidden --&gt;\n\n&lt;!--\nThis multiline\ntext comment will be\nhidden\n--&gt;",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-arrows",
    "href": "markdown.html#sec-arrows",
    "title": "Markdown",
    "section": "\n17.1 Arrows",
    "text": "17.1 Arrows\n- left arrow: ← &#8592;\n- upward arrow: ↑ &#8593;\n- right arrow: → &#8594;\n- downward arrow: ↓ &#8595;\n\nleft arrow: ← ←\nupward arrow: ↑ ↑\nright arrow: → →\ndownward arrow: ↓ ↓",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-dashes",
    "href": "markdown.html#sec-dashes",
    "title": "Markdown",
    "section": "\n17.2 Dashes and Hyphens",
    "text": "17.2 Dashes and Hyphens\n- hyphen: -\n- en dash: –\n- em dash: —\n\nhyphen: -\nen dash: –\nem dash: —",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-subSuperscript",
    "href": "markdown.html#sec-subSuperscript",
    "title": "Markdown",
    "section": "\n17.3 Subscript/Superscript",
    "text": "17.3 Subscript/Superscript\n\n17.3.1 Markdown\nH~2O\nX^2\nH~2O\nX^2\n\n17.3.2 HTML\nH&lt;sub&gt;2&lt;/sub&gt;O\nX&lt;sup&gt;2&lt;/sup&gt;\nH2O\nX2",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-definitions",
    "href": "markdown.html#sec-definitions",
    "title": "Markdown",
    "section": "\n17.4 Definition List",
    "text": "17.4 Definition List\nterm\n: definition\n\nterm\n\ndefinition",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-taskList",
    "href": "markdown.html#sec-taskList",
    "title": "Markdown",
    "section": "\n17.5 Task list",
    "text": "17.5 Task list\n- [x] Create the website\n- [ ] Conduct the study\n- [ ] Write it up\n\nCreate the website\nConduct the study\nWrite it up",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#sec-lowerFileSize",
    "href": "markdown.html#sec-lowerFileSize",
    "title": "Markdown",
    "section": "\n25.1 Lowering File Size",
    "text": "25.1 Lowering File Size\n\nOpen Handbrake and drag and drop the video that you would like to lower the file size of.\nSelect the video tab and lower the Constant Quality to 30, and the Framerate (FPS): to 20\n\nWe have found this lowers file size, but saves video quality",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "markdown.html#footnotes",
    "href": "markdown.html#footnotes",
    "title": "Markdown",
    "section": "Footnotes",
    "text": "Footnotes\n\nMy reference.↩︎\nEvery new line should be prefixed with 2 spaces.\nThis allows you to have a footnote with multiple lines.↩︎\nNamed footnotes will still render with numbers instead of the text but allow easier identification and linking.\nThis footnote also has been made with a different syntax using 4 spaces for new lines.↩︎",
    "crumbs": [
      "About",
      "Markdown"
    ]
  },
  {
    "objectID": "lamp.html",
    "href": "lamp.html",
    "title": "LAMP (Linux, Apache, MySQL, PHP) Server",
    "section": "",
    "text": "1 Logging In\nTo log in to the lab’s LAMP server, use WinSCP.\nOur LAMP domain is: pbslamp.divms.uiowa.edu\nOur credentials are in our LastPass account.\n\n\n2 LAMP Server\nHere are access instructions for the Shared LAMP service: https://iowa.sharepoint.com/sites/sharedlamp/SitePages/User-Access.aspx (archived at https://perma.cc/QN98-PDVT)\nFor making URLs/online tasks available to the public, put your files in the /data/www/devpsylab.psychology.uiowa.edu/ folder.\nFor saving results, save your files to the /data/apache-rw/devpsylab.psychology.uiowa.edu/ folder.\n\n\n3 MariaDB\nHere are instructions for MariaDB: https://iowa.sharepoint.com/sites/sharedlamp/SitePages/MariaDB.aspx (archived at https://perma.cc/BS2Q-HQ4W)\n\n\n\n\n\n\nReuseCC BY 4.0",
    "crumbs": [
      "About",
      "LAMP (Linux, Apache, MySQL, PHP) Server"
    ]
  },
  {
    "objectID": "statistics.html",
    "href": "statistics.html",
    "title": "Statistics",
    "section": "",
    "text": "1 Learning Statistics\nHere are resources for learning statistics:\n\nOpenIntro Statistics: https://www.openintro.org/book/os/\nIntroductory Statistics: https://openstax.org/details/books/introductory-statistics-2e\n\n\n\n2 Workshops\nHere are potential sources for workshops on various statistical topics:\n\nhttps://centerstat.org\nhttps://smart-workshops.com\nhttps://www.statscamp.org\nhttps://statisticalhorizons.com\nhttps://stats.oarc.ucla.edu/other/mult-pkg/seminars/\nhttps://datascience-workshop.uiowa.edu/resources\n\n\n\n3 Statistical Decision Tree\n\n\n\nA Statistical Decision Tree For Choosing an Appropriate Statistical Procedure. Adapted from: https://commons.wikimedia.org/wiki/File:InferentialStatisticalDecisionMakingTrees.pdf (archived at https://perma.cc/L2QR-ALFA). The original source is: Corston, R., & Colman, A. M. (2000). A crash course in SPSS for Windows. Wiley-Blackwell. Changes were made to the original, including the addition of several statistical tests.\n\n\n\n\n\nA Statistical Decision Tree For Choosing an Appropriate Statistical Procedure, Re-Formulated in a Regression Framework. Adapted from: https://commons.wikimedia.org/wiki/File:InferentialStatisticalDecisionMakingTrees.pdf (archived at https://perma.cc/L2QR-ALFA). The original source is: Corston, R. & Colman, A. M. (2000). A crash course in SPSS for Windows. Wiley-Blackwell. Changes were made to the original, including re-formulating the tests in a regression framework.\n\n\n\n\n\n\n\n\nReuseCC BY 4.0",
    "crumbs": [
      "About",
      "Statistics"
    ]
  },
  {
    "objectID": "jatos.html",
    "href": "jatos.html",
    "title": "JATOS (Just Another Tool for Online Studies)",
    "section": "",
    "text": "1 Logging In\nAfter creating a JATOS account with the help of the department IT (pbs-help@uiowa.edu), log in here:\nhttps://jatos.psychology.uiowa.edu\n\n\n2 jsPsych\nTo convert jsPsych tasks to JATOS, see here: https://www.jatos.org/3.6.x/jsPsych-and-JATOS.html (archived at https://perma.cc/W82S-6FU9)\n\n\n3 SONA\n\nhttps://osdoc.cogsci.nl/4.0/manual/osweb/sonasystems/\nhttps://www.andywills.info/jatos-sona-notes/\n\n\n\n4 Parse JSON Data in R\nhttps://github.com/becky-gilbert/r-jatos-json-parser/blob/master/parse_JSON_data_examples.R\n\n\n\n\n\n\nReuseCC BY 4.0",
    "crumbs": [
      "About",
      "JATOS (Just Another Tool for Online Studies)"
    ]
  },
  {
    "objectID": "developmentalScaling.html",
    "href": "developmentalScaling.html",
    "title": "Developmental Scaling",
    "section": "",
    "text": "To be added…\n\n\n\n\n\nReuseCC BY 4.0"
  },
  {
    "objectID": "figures.html",
    "href": "figures.html",
    "title": "Figures in R",
    "section": "",
    "text": "https://www.data-to-viz.com",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#preamble",
    "href": "figures.html#preamble",
    "title": "Figures in R",
    "section": "\n5.1 Preamble",
    "text": "5.1 Preamble\n\n5.1.1 Install Libraries\n\nCode#install.packages(\"remotes\")\n#remotes::install_github(\"DevPsyLab/petersenlab\")\n\n\n\n5.1.2 Load Libraries\n\nCodelibrary(\"petersenlab\")\nlibrary(\"ellipse\")\nlibrary(\"ggplot2\")\nlibrary(\"grid\")\nlibrary(\"reshape\")\nlibrary(\"plyr\")\nlibrary(\"RColorBrewer\")\nlibrary(\"reshape2\")\nlibrary(\"ggExtra\")\nlibrary(\"viridis\")\nlibrary(\"ggthemes\")\nlibrary(\"ggpubr\")",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#simulate-data",
    "href": "figures.html#simulate-data",
    "title": "Figures in R",
    "section": "\n5.2 Simulate Data",
    "text": "5.2 Simulate Data\n\nCodeset.seed(52242)\n\nn &lt;- 1000\n\npredictor &lt;- rbeta(n, 1.5, 5) * 100\noutcome &lt;- predictor + rnorm(n, mean = 0, sd = 20) + 50\nnumber &lt;- sample(1:1000, replace = TRUE)\n\npredictorOverplot &lt;- sample(1:50, n, replace = TRUE)\noutcomeOverplot &lt;- predictorOverplot + sample(1:75, n, replace = TRUE)\n\ndf &lt;- data.frame(predictor = predictor,\n                 outcome = outcome,\n                 predictorOverplot = predictorOverplot,\n                 outcomeOverplot = outcomeOverplot)\n\ndf[sample(1:n, size = 10), \"predictor\"] &lt;- NA\ndf[sample(1:n, size = 10), \"outcome\"] &lt;- NA\ndf[sample(1:n, size = 10), \"predictorOverplot\"] &lt;- NA\ndf[sample(1:n, size = 10), \"outcomeOverplot\"] &lt;- NA",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#line",
    "href": "figures.html#line",
    "title": "Figures in R",
    "section": "\n5.3 Line",
    "text": "5.3 Line\n\nCodeplot.new()\nlines(\n  x = seq(from = -10, to = 10, length.out = 100),\n  y = seq(from = -25, to = 25, length.out = 100))",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#curve",
    "href": "figures.html#curve",
    "title": "Figures in R",
    "section": "\n5.4 Curve",
    "text": "5.4 Curve\n\nCodecurve(x^3 - 3*x, from = -2, to = 2)\ncurve(x^2 - 2, add = TRUE, col = \"violet\")",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#basic-scatterplot",
    "href": "figures.html#basic-scatterplot",
    "title": "Figures in R",
    "section": "\n5.5 Basic Scatterplot",
    "text": "5.5 Basic Scatterplot\n\n5.5.1 Base R\n\nCodeplot(outcome ~ predictor, data = df)\n\n\n\n\n\n\nCodeplot(df$predictor, df$outcome)\n\n\n\n\n\n\n\n\n5.5.1.1 Best-fit line\n\nCodeplot(outcome ~ predictor, data = df)\nabline(lm(outcome ~ predictor, data = df), col = \"red\") #regression line (y~x)\n\n\n\n\n\n\n\n\n5.5.1.2 Best-fit line with correlation coefficient\n\nCodeplot(outcome ~ predictor, data = df)\nabline(lm(outcome ~ predictor, data = df), col = \"red\") #regression line (y~x)\naddText(x = df$predictor, y = df$outcome)\n\n\n\n\n\n\n\n\n5.5.1.3 Loess line\n\nCodeplot(outcome ~ predictor, data = df)\nlines(loess.smooth(df$predictor, df$outcome)) #loess line (x,y)\n\n\n\n\n\n\n\n\n5.5.2 ggplot2\n\n\nCodeggplot(df, aes(x = predictor, y = outcome)) +\n  geom_point() +\n  theme_classic()\n\n\n\n\n\n\n\n\n5.5.2.1 Best-fit line\n\nCodeggplot(df, aes(x = predictor, y = outcome)) +\n  geom_point() +\n  stat_smooth(method = \"lm\", formula = y ~ x) +\n  theme_classic()\n\n\n\n\n\n\n\n\n5.5.2.2 Best-fit line with correlation coefficient\n\nCodeggplot(df, aes(x = predictor, y = outcome)) +\n  geom_point() +\n  stat_smooth(method = \"lm\", formula = y ~ x) +\n  stat_cor(\n    cor.coef.name = \"r\",\n    p.accuracy = 0.001,\n    r.accuracy = 0.01) +\n  theme_classic()\n\n\n\n\n\n\n\n\n5.5.2.3 Loess line\n\nCodeggplot(df, aes(x = predictor, y = outcome)) +\n  geom_point() +\n  stat_smooth(method = \"loess\", formula = y ~ x) +\n  theme_classic()",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#change-plot-style",
    "href": "figures.html#change-plot-style",
    "title": "Figures in R",
    "section": "\n5.6 Change Plot Style",
    "text": "5.6 Change Plot Style\n\n5.6.1 Change Theme\n\nCodebasePlot &lt;- ggplot(df, aes(x = predictor, y = outcome)) +\n  geom_point()\n\n\n\n5.6.1.1 Default Theme\n\nCodebasePlot\n\n\n\n\n\n\n\n\n5.6.1.2 Grayscale: theme_gray()\n\n\nCodebasePlot + theme_gray() + theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\n\n\n5.6.1.3 Black-and-White: theme_bw()\n\n\nCodebasePlot + theme_bw() + theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\n\n\n5.6.1.4 Line Drawing: theme_linedraw()\n\nA theme with only black lines of various widths on white backgrounds, reminiscent of a line drawing. Note that this theme has some very thin lines (&lt;&lt; 1 pt) which some journals may refuse.\n\nCodebasePlot + theme_linedraw() + theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\n\n\n5.6.1.5 Light: theme_light()\n\n\nCodebasePlot + theme_light() + theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\n\n\n5.6.1.6 Dark: theme_dark()\n\n\nCodebasePlot + theme_dark() + theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\n\n\n5.6.1.7 Minimal: theme_minimal()\n\n\nCodebasePlot + theme_minimal() + theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\n\n\n5.6.1.8 Classic: theme_classic()\n\n\nCodebasePlot + theme_classic() + theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\n\n\n5.6.1.9 A Completely Empty Theme: theme_void()\n\n\nCodebasePlot + theme_void() + theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\n\n\n5.6.1.10 Visual Unit Tests: theme_test()\n\n\nCodebasePlot + theme_test() + theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\n\n\n5.6.1.11 Edward Tufte: theme_tufte()\n\nTheme based on Edward Tufte.\n\nCodebasePlot + theme_tufte()\n\n\n\n\n\n\n\n\n5.6.1.12 Wall Street Journal: theme_wsj()\n\nTheme based on the publication, the Wall Street Journal.\n\nCodebasePlot + theme_wsj()\n\n\n\n\n\n\n\n\n5.6.1.13 FiveThirtyEight: theme_fivethirtyeight()\n\nTheme based on the publication, FiveThirtyEight.\n\nCodebasePlot + theme_fivethirtyeight()\n\n\n\n\n\n\n\n\n5.6.1.14 The Economist: theme_economist()\n\nTheme based on the publication, The Economist.\n\nCodebasePlot + theme_economist()\n\n\n\n\n\n\n\n\n5.6.1.15 Stephen Few: theme_few()\n\nTheme based on the rules and examples from Stephen Few’s Show Me the Numbers and “Practical Rules for Using Color in Charts”.\n\nCodebasePlot + theme_few()",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#sec-marginalDistributions",
    "href": "figures.html#sec-marginalDistributions",
    "title": "Figures in R",
    "section": "\n5.7 Add Marginal Distributions",
    "text": "5.7 Add Marginal Distributions\n\nCodescatterplot &lt;- ggplot(df, aes(x = predictor, y = outcome)) +\n  geom_point() +\n  theme_classic() +\n  theme(text = element_text(family = \"Gotham\"))\n\n\n\n5.7.1 Density Plot\n\nCodedensityMarginal &lt;- ggMarginal(scatterplot, type = \"density\", xparams = list(fill = \"gray\"), yparams = list(fill = \"gray\"))\n\n\n\nCodeprint(densityMarginal, newpage = TRUE)\n\n\n\n\n\n\n\n\n5.7.2 Histogram\n\nCodehistogramMarginal &lt;- ggMarginal(scatterplot, type = \"histogram\", xparams = list(fill = \"gray\"), yparams = list(fill = \"gray\"))\n\n\n\nCodeprint(histogramMarginal, newpage = TRUE)\n\n\n\n\n\n\n\n\n5.7.3 Boxplot\n\nCodeboxplotMarginal &lt;- ggMarginal(scatterplot, type = \"boxplot\", xparams = list(fill = \"gray\"), yparams = list(fill = \"gray\"))\n\n\n\nCodeprint(boxplotMarginal, newpage = TRUE)\n\n\n\n\n\n\n\n\n5.7.4 Violin Plot\n\nCodeviolinMarginal &lt;- ggMarginal(scatterplot, type = \"violin\", xparams = list(fill = \"gray\"), yparams = list(fill = \"gray\"))\n\n\n\nCodeprint(violinMarginal, newpage = TRUE)\n\n\n\n\n\n\n\n\n5.7.5 Density Plot and Histogram\n\nCodedensigramMarginal &lt;- ggMarginal(scatterplot, type = \"densigram\", xparams = list(fill = \"gray\"), yparams = list(fill = \"gray\"))\n\n\n\nCodeprint(densigramMarginal, newpage = TRUE)",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#ellipse",
    "href": "figures.html#ellipse",
    "title": "Figures in R",
    "section": "\n5.8 Ellipse",
    "text": "5.8 Ellipse\n\n5.8.1 Basic Ellipse\n\nCodeggplot(df, aes(x = predictor, y = outcome)) +\n  geom_point() +\n  stat_ellipse(alpha = 0.4, level = 0.95, geom = \"polygon\", fill = \"red\", color = \"red\") +\n  theme_classic() +\n  theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\n\n\n5.8.2 Align Coordinates\n\nCodeggplot(df, aes(x = predictor, y = outcome)) +\n  geom_point() +\n  stat_ellipse(alpha = 0.4, level = 0.95, geom = \"polygon\", fill = \"red\", color = \"red\") +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0)) +\n  coord_fixed(ratio = (max(predictor, na.rm = TRUE) - min(predictor, na.rm = TRUE))/(max(outcome, na.rm = TRUE) - min(outcome, na.rm = TRUE)),\n              xlim = c(0, max(predictor, na.rm = TRUE)), \n              ylim = c(0, max(outcome, na.rm = TRUE))) +\n  theme_classic() +\n  theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\n\n\n5.8.3 Reduce Dot Size\n\nCodeggplot(df, aes(x = predictor, y = outcome)) +\n  geom_point(size = 0.5) +\n  stat_ellipse(alpha = 0.4, level = 0.95, geom = \"polygon\", fill = \"red\", color = \"red\") +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0)) +\n  coord_fixed(ratio = (max(predictor, na.rm = TRUE) - min(predictor, na.rm = TRUE))/(max(outcome, na.rm = TRUE) - min(outcome, na.rm = TRUE)),\n              xlim = c(0, max(predictor, na.rm = TRUE)), \n              ylim = c(0, max(outcome, na.rm = TRUE))) +\n  theme_classic() +\n  theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\n\n\n5.8.4 Transparency\n\nCodeggplot(df, aes(x = predictor, y = outcome)) +\n  geom_point(alpha = 0.3) +\n  stat_ellipse(alpha = 0.4, level = 0.95, geom = \"polygon\", fill = \"red\", color = \"red\") +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0)) +\n  coord_fixed(ratio = (max(predictor, na.rm = TRUE) - min(predictor, na.rm = TRUE))/(max(outcome, na.rm = TRUE) - min(outcome, na.rm = TRUE)),\n              xlim = c(0, max(predictor, na.rm = TRUE)), \n              ylim = c(0, max(outcome, na.rm = TRUE))) +\n  theme_classic() +\n  theme(text = element_text(family = \"Gotham\"))",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#bubble-chart",
    "href": "figures.html#bubble-chart",
    "title": "Figures in R",
    "section": "\n5.9 Bubble Chart",
    "text": "5.9 Bubble Chart\n\n5.9.1 Basic Bubble Chart\n\nCodeggplot(df, aes(x = predictorOverplot, y = outcomeOverplot)) +\n  geom_count(aes(size = ..n..)) +\n  scale_size_area() +\n  theme_classic() +\n  theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\n\n\n5.9.2 Specify Sizes\n\nCodeggplot(df, aes(x = predictorOverplot, y = outcomeOverplot)) +\n  geom_count(aes(size = ..n..)) +\n  scale_size_continuous(breaks = c(1, 2, 3, 4), range = c(1, 7)) +\n  theme_classic() +\n  theme(text = element_text(family = \"Gotham\"))",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#dimensional-density",
    "href": "figures.html#dimensional-density",
    "title": "Figures in R",
    "section": "\n5.10 2-Dimensional Density",
    "text": "5.10 2-Dimensional Density\n\nCodeggplot(df, aes(x = predictor, y = outcome)) +\n  stat_density_2d(aes(fill = ..density..), geom = \"raster\", contour = FALSE) +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0)) +\n  scale_fill_viridis() +\n  theme(\n    legend.position = \"none\",\n    text = element_text(family = \"Gotham\")\n  )",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#combined-ellipse-and-bubble-chart",
    "href": "figures.html#combined-ellipse-and-bubble-chart",
    "title": "Figures in R",
    "section": "\n5.11 Combined Ellipse and Bubble Chart",
    "text": "5.11 Combined Ellipse and Bubble Chart\n\n5.11.1 ggplot2\n\n\nCodeggplot(df, aes(x = predictorOverplot, y = outcomeOverplot)) +\n  geom_count(alpha = .6, color = rgb(0,0,.7,.5)) +\n  scale_size_continuous(breaks = c(1, 2, 3, 4), range = c(1, 7)) +\n  stat_smooth(method = \"loess\", se = TRUE, color = \"green\") + \n  stat_smooth(method = \"lm\") +\n  stat_ellipse(alpha = 0.4, level = 0.95, geom = \"polygon\", fill = \"red\", color = \"red\") +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0)) +\n  coord_fixed(ratio = (max(predictorOverplot, na.rm = TRUE) - min(predictorOverplot, na.rm = TRUE))/(max(outcomeOverplot, na.rm = TRUE) - min(outcomeOverplot, na.rm = TRUE)),\n              xlim = c(0, max(predictorOverplot, na.rm = TRUE)), \n              ylim = c(0, max(outcomeOverplot, na.rm = TRUE))) +\n  theme_classic() +\n  theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\nCodeggplot(df, aes(x = predictorOverplot, y = outcomeOverplot)) +\n  geom_count(alpha = .6, color = rgb(0,0,.7,.5)) +\n  scale_size_continuous(breaks = c(1, 2, 3, 4), range = c(1, 7)) +\n  stat_smooth(method = \"loess\", se = TRUE, color = \"green\") + \n  stat_smooth(method = \"lm\") +\n  stat_ellipse(color = \"red\", size = 1.5) +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0)) +\n  coord_fixed(ratio = (max(predictorOverplot, na.rm = TRUE) - min(predictorOverplot, na.rm = TRUE))/(max(outcomeOverplot, na.rm = TRUE) - min(outcomeOverplot, na.rm = TRUE)),\n              xlim = c(0, max(predictorOverplot, na.rm = TRUE)), \n              ylim = c(0, max(outcomeOverplot, na.rm = TRUE))) +\n  theme_classic() +\n  theme(text = element_text(family = \"Gotham\"))\n\n\n\n\n\n\n\n\n5.11.2 Other implementation\nFrom: https://stats.stackexchange.com/questions/7899/complex-regression-plot-in-r\n\n5.11.2.1 ggplot2\n\n\nCodedf$x &lt;- df$predictorOverplot\ndf$y &lt;- df$outcomeOverplot\n\nxc &lt;- with(df, xyTable(x, y))\ndf2 &lt;- cbind.data.frame(x = xc$x, y = xc$y, number = xc$number)\ndf2$n &lt;- cut(df2$number, c(0,1.5,2.5,Inf), labels = c(1,2,4))\ndf.ell &lt;- as.data.frame(with(df, ellipse(cor(df$x, df$y, use = \"pairwise.complete.obs\"),\n                                         scale = c(sd(df$x, na.rm = TRUE), sd(df$y, na.rm = TRUE)),\n                                         centre = c(mean(df$x, na.rm = TRUE), mean(df$y, na.rm = TRUE)),\n                                         level = .95)))\n\nggplot(data = na.omit(df2), aes(x = x, y = y)) + \n  geom_point(aes(size = n), alpha = .6, color = rgb(0,0,.7,.5)) + \n  stat_smooth(data = df, method = \"loess\", se = FALSE, color = \"green\") + \n  stat_smooth(data = df, method = \"lm\", col = \"red\") +\n  geom_path(data = df.ell, colour = \"green\", size = 1) +\n  coord_cartesian(xlim = c(-1,60), ylim = c(-1,130))\n\n\n\n\n\n\n\n\n5.11.2.2 Base R\n\n\nCodedo.it &lt;- function(df, type=\"confidence\", ...) {\n  require(ellipse)\n  lm0 &lt;- lm(y ~ x, data=df)\n  xc &lt;- with(df, xyTable(x, y))\n  df.new &lt;- data.frame(x = seq(min(df$x), max(df$x), 0.1))\n  pred.ulb &lt;- predict(lm0, df.new, interval = type)\n  pred.lo &lt;- predict(loess(y ~ x, data = df), df.new)\n  plot(xc$x, xc$y, cex = xc$number*1/4, xlab = \"x\", ylab = \"y\", ...) #change number*X to change dot size\n  abline(lm0, col = \"red\")\n  lines(df.new$x, pred.lo, col=\"green\", lwd = 2)\n  lines(df.new$x, pred.ulb[,\"lwr\"], lty = 2, col = \"red\")\n  lines(df.new$x, pred.ulb[,\"upr\"], lty = 2, col = \"red\")    \n  lines(ellipse(cor(df$x, df$y), scale=c(sd(df$x),sd(df$y)), \n                centre = c(mean(df$x), mean(df$y)), level = .95), lwd = 2, col = \"green\")\n  invisible(lm0)\n}\n\ndf3 &lt;- na.omit(df[sample(nrow(df), nrow(df), rep = TRUE),])\ndf3$x &lt;- df3$predictorOverplot\ndf3$y &lt;- df3$outcomeOverplot\n\ndo.it(df3, pch = 19, col = rgb(0,0,.7,.5))",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#visually-weighted-regression",
    "href": "figures.html#visually-weighted-regression",
    "title": "Figures in R",
    "section": "\n5.12 Visually-Weighted Regression",
    "text": "5.12 Visually-Weighted Regression\n\n5.12.1 Default\n\nCodevwReg(outcome ~ predictor, data = df)\n\n\n\n\n\n\n\n\n5.12.2 Shade\n\nCodevwReg(outcome ~ predictor, data = df, shade = TRUE, spag = FALSE, show.lm = TRUE, show.CI = TRUE, bw = FALSE, B = 1000, quantize = \"continuous\")\n\n\n\n\n\n\nCodevwReg(outcome ~ predictor, data = df, shade = TRUE, spag = FALSE, show.lm = TRUE, show.CI = TRUE, bw = FALSE, B = 1000, quantize = \"SD\")\n\n\n\n\n\n\n\n\n5.12.3 Spaghetti\n\nCodevwReg(outcome ~ predictor, data = df, shade = FALSE, spag = TRUE, show.lm = TRUE, show.CI = TRUE, bw = FALSE, B = 1000)\n\n\n\n\n\n\nCodevwReg(outcome ~ predictor, data = df, shade = FALSE, spag = TRUE, show.lm = FALSE, show.CI = FALSE, bw = FALSE, B = 1000)\n\n\n\n\n\n\n\n\n5.12.4 Black/white\n\nCodevwReg(outcome ~ predictor, data = df, shade = TRUE, spag = FALSE, show.lm = TRUE, show.CI = TRUE, bw = TRUE, B = 1000, quantize = \"continuous\")\n\n\n\n\n\n\nCodevwReg(outcome ~ predictor, data = df, shade = TRUE, spag = FALSE, show.lm = TRUE, show.CI = TRUE, bw = TRUE, B = 1000, quantize = \"SD\")\n\n\n\n\n\n\nCodevwReg(outcome ~ predictor, data = df, shade = FALSE, spag = TRUE, show.lm = TRUE, show.CI = TRUE, bw = TRUE, B = 1000, quantize = \"SD\")",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#univariate-distribution",
    "href": "figures.html#univariate-distribution",
    "title": "Figures in R",
    "section": "\n7.1 Univariate Distribution",
    "text": "7.1 Univariate Distribution\nUsed for: distribution of one numeric variable\n\n7.1.1 Gallery\n\nViolin chart: https://r-graph-gallery.com/violin.html\n\nDensity chart: https://r-graph-gallery.com/density-plot.html\n\nHistogram: https://r-graph-gallery.com/histogram.html\n\nBoxplot: https://r-graph-gallery.com/boxplot.html\n\nRidgeline chart: https://r-graph-gallery.com/ridgeline-plot.html",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#bivariate-scatterplots",
    "href": "figures.html#bivariate-scatterplots",
    "title": "Figures in R",
    "section": "\n7.2 Bivariate Scatterplots",
    "text": "7.2 Bivariate Scatterplots\nUsed for: association between two numeric variables\n\n7.2.1 Base R\n\nplot(x, y)\n\n7.2.2 ggplot2 package\nhttp://www.cookbook-r.com/Graphs/Scatterplots_(ggplot2)/\nggplot(data, aes(x, y)) +\n    geom_point()\n\n7.2.3 Gallery\n\nScatterplot: https://r-graph-gallery.com/scatterplot.html\n\nBubble plot: https://r-graph-gallery.com/bubble-chart.html\n\n2D density chart: https://r-graph-gallery.com/2d-density-chart.html\n\nHeatmap: https://r-graph-gallery.com/heatmap.html\n\n\n7.2.4 Add lines\n\nLine chart: https://r-graph-gallery.com/line-plot.html\n\nConnected scatterplot: https://r-graph-gallery.com/connected-scatterplot.html\n\nVisually-weighted regression: https://www.nicebread.de/visually-weighted-watercolor-plots-new-variants-please-vote/\n\nUse the vwReg() function from the petersenlab package: https://github.com/DevPsyLab/petersenlab/blob/main/R/vwReg.R\n\n\n7.2.5 Area\n\nArea chart: https://r-graph-gallery.com/area-chart.html\n\nStacked area chart: https://r-graph-gallery.com/stacked-area-graph.html\n\nStreamgraph: https://r-graph-gallery.com/streamgraph.html",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#bivariate-barplots",
    "href": "figures.html#bivariate-barplots",
    "title": "Figures in R",
    "section": "\n7.3 Bivariate Barplots",
    "text": "7.3 Bivariate Barplots\nUsed for: association between one categorical variable and one numeric variable (or for depicting the frequency of categories of a categorical variable)\n\n7.3.1 Gallery\n\nBarplot: https://r-graph-gallery.com/barplot.html\n\nLollipop plot: https://r-graph-gallery.com/lollipop-plot.html",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#multivariate-correlation-matrices",
    "href": "figures.html#multivariate-correlation-matrices",
    "title": "Figures in R",
    "section": "\n7.4 Multivariate Correlation Matrices",
    "text": "7.4 Multivariate Correlation Matrices\nUsed for: association between multiple numeric variables\nFor correlation matrices, I do the following:\n\nI use the lab’s cor.table() function (with type = \"manuscript\") from the petersenlab package to create a correlation matrix.\nI save the correlation matrix to a .csv file.\n\nFor example: https://research-git.uiowa.edu/PetersenLab/SRS/SRS-SelfRegulationDevelopment/-/blob/master/Analyses/selfRegulationDevelopment.Rmd#self-regulation-measures\n\n\n\nI open the .csv file in Excel and create the table in Excel that can be copied and pasted to Word/Powerpoint/etc.\n\n\n7.4.1 Correlograms\n\n\ncorrplot package: https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html\n\n\ncorrgram package: https://cran.r-project.org/web/packages/corrgram/vignettes/corrgram_examples.html\n\n\n\n7.4.1.1 Gallery\nhttps://r-graph-gallery.com/correlogram.html\n\n7.4.2 Pairs panels\npsych package: https://personality-project.org/r/psych/help/pairs.panels.html\nI depict examples of correlograms and pairs panels here: https://isaactpetersen.github.io/Principles-Psychological-Assessment/factor-analysis-pca.html#sec-correlations-factorAnalysis",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#sec-pathDiagrams",
    "href": "figures.html#sec-pathDiagrams",
    "title": "Figures in R",
    "section": "\n7.5 Path Diagrams",
    "text": "7.5 Path Diagrams\nUsed for: SEM/CFA/path analysis\nIf you are just trying to visualize the results of a SEM model fitted using the lavaan package, I recommend the semPlot, lavaanPlot, or lavaangui packages in R. You can access a web application version of lavaangui here: https://lavaangui.org. You can see examples of semPlot here: http://sachaepskamp.com/semPlot/examples (archived at: https://perma.cc/W2V4-C9C8). You can see examples of lavaanPlot here: https://lavaanplot.alexlishinski.com/articles/intro_to_lavaanplot (archived at: https://perma.cc/ARZ7-MV24). You can see examples of lavaangui here: https://doi.org/10.1080/10705511.2024.2420678. You can see examples of my implementation here: https://isaactpetersen.github.io/Principles-Psychological-Assessment/structural-equation-modeling.html#sec-semModelPathDiagram-sem\nIf you are trying to create a figure for a paper or poster, you might want something that you can draw and customize yourself. I use Adobe Illustrator for hand-drawn figures.\nYou can look at various options below:\n\n\nsemPlot package: https://doi.org/10.32614/CRAN.package.semPlot\n\n\nlavaanPlot package: https://doi.org/10.32614/CRAN.package.lavaanPlot\n\n\nlavaangui package: https://doi.org/10.32614/CRAN.package.lavaangui\n\nAdobe Illustrator\n\nDraw.io: https://www.drawio.com (formerly https://www.diagrams.net)\n\nOnyx: https://onyx-sem.com\n\n\nyworks: https://www.yworks.com\n\n\nMicrosoft Visio: https://www.microsoft.com/en-us/microsoft-365/visio/flowchart-software\n\nMicrosoft Powerpoint\nAMOS\nWarppls\n\nGraphviz: https://graphviz.org\n\nhas an R port—this is what we use for our study flowchart via the DiagrammeR package: https://rich-iannone.github.io/DiagrammeR/index.html\n\n\n\nhttps://app.diagrams.net\nhttps://github.com/jgraph/drawio-desktop/releases",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#interactive",
    "href": "figures.html#interactive",
    "title": "Figures in R",
    "section": "\n7.6 Interactive",
    "text": "7.6 Interactive\nGallery: https://r-graph-gallery.com/interactive-charts.html",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#animation",
    "href": "figures.html#animation",
    "title": "Figures in R",
    "section": "\n7.7 Animation",
    "text": "7.7 Animation\nGallery: https://r-graph-gallery.com/animation.html",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#d",
    "href": "figures.html#d",
    "title": "Figures in R",
    "section": "\n7.8 3D",
    "text": "7.8 3D\nGallery: https://r-graph-gallery.com/3d.html",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#sequential",
    "href": "figures.html#sequential",
    "title": "Figures in R",
    "section": "\n8.1 Sequential",
    "text": "8.1 Sequential\n\nhttps://colorbrewer2.org/#type=sequential&scheme=BuGn&n=3\nviridis, cividis, etc.: https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#diverging",
    "href": "figures.html#diverging",
    "title": "Figures in R",
    "section": "\n8.2 Diverging",
    "text": "8.2 Diverging\n\nhttps://colorbrewer2.org/#type=diverging&scheme=BrBG&n=3",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#qualitativecategorical",
    "href": "figures.html#qualitativecategorical",
    "title": "Figures in R",
    "section": "\n8.3 Qualitative/Categorical",
    "text": "8.3 Qualitative/Categorical\n\nhttps://colorbrewer2.org/#type=qualitative&scheme=Accent&n=3\n\nPolychrome package: https://stackoverflow.com/a/62939405 (archived at https://perma.cc/3HWM-MMFS)\n\npals package: https://stackoverflow.com/a/41230685 (archived at https://perma.cc/WH56-HMVD)\n\nColor palettes for color-blindness:\n\n\nSafe palette from the rcartocolor package: https://stackoverflow.com/a/56066712 (archived at https://perma.cc/WUH5-F4Z7)\nOkabe Ito scale: https://stackoverflow.com/a/56066712 (archived at https://perma.cc/WUH5-F4Z7)\n\n\n8.3.1 8 Colors\n\nCode# From here: https://github.com/clauswilke/colorblindr/blob/master/R/palettes.R\n# Two color palettes taken from the article [\"Color Universal Design\" by Okabe and Ito](https://web.archive.org/web/20210108233739/http://jfly.iam.u-tokyo.ac.jp/color/)\n# The variant `palette_OkabeIto` contains a gray color, while `palette_OkabeIto_black` contains black instead\n\npalette_OkabeIto &lt;- c(\"#E69F00\", \"#56B4E9\", \"#009E73\", \"#F0E442\", \"#0072B2\", \"#D55E00\", \"#CC79A7\", \"#999999\")\n\npie(rep(1, 8), col = palette_OkabeIto)\n\n\n\n\n\n\nCodepalette_OkabeIto_black &lt;- c(\"#E69F00\", \"#56B4E9\", \"#009E73\", \"#F0E442\", \"#0072B2\", \"#D55E00\", \"#CC79A7\", \"#000000\")\n\npie(rep(1, 8), col = palette_OkabeIto_black)\n\n\n\n\n\n\n\n\n8.3.2 12 Colors\nSafe palette from the rcartocolor package: https://stackoverflow.com/a/56066712 (archived at https://perma.cc/WUH5-F4Z7)\n\nCode#from: scales::show_col(carto_pal(12, \"Safe\"))\n\nc12 &lt;- c(\n  \"#88CCEE\",\n  \"#CC6677\",\n  \"#DDCC77\",\n  \"#117733\",\n  \"#332288\",\n  \"#AA4499\",\n  \"#44AA99\",\n  \"#999933\",\n  \"#882255\",\n  \"#661100\",\n  \"#6699CC\",\n  \"#888888\"\n)\n\npie(rep(1, 12), col = c12)\n\n\n\n\n\n\n\n\n8.3.3 25 Colors\nhttps://stackoverflow.com/a/9568659 (archived at https://perma.cc/5ALZ-3AQD)\n\nCodec25 &lt;- c(\n  \"dodgerblue2\", \"#E31A1C\", # red\n  \"green4\",\n  \"#6A3D9A\", # purple\n  \"#FF7F00\", # orange\n  \"black\", \"gold1\",\n  \"skyblue2\", \"#FB9A99\", # lt pink\n  \"palegreen2\",\n  \"#CAB2D6\", # lt purple\n  \"#FDBF6F\", # lt orange\n  \"gray70\", \"khaki2\",\n  \"maroon\", \"orchid1\", \"deeppink1\", \"blue1\", \"steelblue4\",\n  \"darkturquoise\", \"green1\", \"yellow4\", \"yellow3\",\n  \"darkorange4\", \"brown\"\n)\n\npie(rep(1, 25), col = c25)\n\n\n\n\n\n\n\n\n8.3.4 36 Colors\n\nCode# from: Polychrome::palette36.colors(36)\n\nc36 &lt;- c(\"#5A5156\",\"#E4E1E3\",\"#F6222E\",\"#FE00FA\",\"#16FF32\",\"#3283FE\",\"#FEAF16\",\"#B00068\",\"#1CFFCE\",\"#90AD1C\",\"#2ED9FF\",\"#DEA0FD\",\"#AA0DFE\",\"#F8A19F\",\"#325A9B\",\"#C4451C\",\"#1C8356\",\"#85660D\",\"#B10DA1\",\"#FBE426\",\"#1CBE4F\",\"#FA0087\",\n\"#FC1CBF\",\"#F7E1A0\",\"#C075A6\",\"#782AB6\",\"#AAF400\",\"#BDCDFF\",\"#822E1C\",\"#B5EFB5\",\"#7ED7D1\",\"#1C7F93\",\"#D85FF7\",\"#683B79\",\"#66B0FF\",\"#3B00FB\")\n\npie(rep(1, 36), col = c36)",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#maps",
    "href": "figures.html#maps",
    "title": "Figures in R",
    "section": "\n8.4 Maps",
    "text": "8.4 Maps\n\nhttps://github.com/thomasp85/scico",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "figures.html#footnotes",
    "href": "figures.html#footnotes",
    "title": "Figures in R",
    "section": "Footnotes",
    "text": "Footnotes\n\nAsk me to give you access.↩︎",
    "crumbs": [
      "About",
      "Figures"
    ]
  },
  {
    "objectID": "eegERP.html",
    "href": "eegERP.html",
    "title": "EEG and ERP Processing and Analysis",
    "section": "",
    "text": "Download MATLAB: https://its.uiowa.edu/matlab\n\nClick How to Install MatLab and follow the relevant instructions\nCreate a MatLab folder in your local directory. You will keep all of your MatLab related files in this folder.\n\n\nInstall the HAPPE pipeline: https://github.com/PINE-Lab/HAPPE\n\nClone the HAPPE repository to your GitHub account\nOpen the HAPPE folder\nOpen the HAPPE User Guide document\nRead through the HAPPE User Guide\n\nNavigate to the Setting up HAPPE section in the user guide and follow the instructions for setting up the HAPPE pipeline, including installation of add-ons and eeglab\nNote: This version of the HAPPE pipeline includes functionality from the HAPPE 2.0, HAPPE+ER, and HAPPILEE pipelines, so it is suitable for standard EEG processing as well as ERP and low-density EEG/ERP processing.\n\n\nInstall EP Toolkit: https://sourceforge.net/projects/erppcatoolkit/\n\nAfter downloading, copy the EP_Toolkit folder to your Matlab folder (in your local directory)\nIn the EP_toolkit folder:\n\nOpen EP_Toolkit\n\nOpen Documentation\n\nOpen tutorial\n\n\n\nIn the tutorial document, navigate to the Set Up section and follow the instructions for installing and setting up EP Toolkit and FieldTrip. Do NOT follow instructions for setting up EEGLAB. You have already set up your path to EEGLAB when you set up the HAPPE pipeline.\nYou should have the following subfolders in your MatLab folder:\n\nEP_Toolkit\nFieldtrip-[version number]\n\n\n\n\n\nWe have scripts for each task that can prepare files for the HAPPE Pipeline and/or manage the files outputted from HAPPE. These actions can be done manually as well, but the MATLAB scripts make the process more efficient. The scripts will also generate a “log” of all of the files processed through HAPPE to facilitate tracking of EEG data processing. The sections below detail the code used to perform these actions as well as the instructions for using the current scripts.\nNote: Before using the scripts/code detailed below, ensure that all filepaths used are in your MATLAB path collection. These may include:\n\nThe location where the automatic scripts are stored (for our lab, this is under /Data Processing/6. MATLAB EEG Pipeline)\nThe location where the HAPPE pre-processing script is stored\nThe location of the raw data (to be processed)\nThe location(s) of any intermediate files for processing (e.g., the updated .mff files that contain accuracy information in FishShark)\nThe location(s) for any files outputted by HAPPE and/or places you wish to use the script to move them to\n\nTo add a file path, click on Home/Set Path/Add Folder in MATLAB. You don’t need to specify the file name, just its containing folder.\n\n\n\n1a - Files for HAPPE\n1b - Manual Processing\n2 - Processed Files\n3 - Files for PCA\n4 - EPT Averages\n5 - PCA\n6 - PCA Components\n\nThe following section describes the MATLAB scripts used to manage HAPPE output files for the Oddball task data. If you are running HAPPE manually (i.e., without integrating these scripts), skip to the Oddball HAPPE inputs section.\n\nOpen the eegProccessingOddball.m file (accessible via Git here) in MATLAB\nUpdate all thresholds and filepaths in script file (must be done BEFORE running the script)\n\nIn the second section of our script file, we set our “threshold” for the minimum number of trials that need to be retained after pre-processing for a subject’s data to be eligible for PCA. Additional thresholds can also be set for things like number of channels retained, but these are not currently in use.\n\n% Set quality threshold parameters\ntrialCutoff = 10;\n\nWe also set environment variables with all of the filepaths that are relevant for managing HAPPE output files and tracking processed data. The following paths should be checked and updated as necessary to reflect the organization of processing on your computer.\n\n\npassPath is the location you wish to have files that meet or exceed the above-defined thresholds to be saved\n\nallPath is the location you wish to have ALL files outputted from HAPPE saved to (regardless of whether threshold is met or not)\n\nfailPath is the location you wish to have files that do not meet the above-defined thresholds to be copied to\n\n.mff files that do not meet threshold will be copied here as an indication that they should be processed manually to see if they meet threshold afterward\n\n\n\nsummPath is the location you wish to save the file that lists all files processed through HAPPE in the current batch\n\nWe currently use this to save the “processing log” to a location that all team members/computers have access to so it is easier to determine which files require processing when EEG data are not stored on a shared server\n\n\n\nmanPath is the location you wish to save the file that lists all files that do not meet the above-defined thresholds\n\nWe currently use this to save the “to process manually” list to a location that all team members/computers have access to so it is easier to determine which files require manual processing because the copied .mff file would not be acessible via our shared server\n\n\n\n\n\n% Set paths for file sorting\npassPath = 'V:\\Processing-Repo\\Folder Structure\\3 - Files for PCA'; %location for .txt output files\nallPath = 'V:\\Processing-Repo\\Folder Structure\\2 - Processed Files'; %location for all processed files to end up\nfailPath = 'V:\\Processing-Repo\\Folder Structure\\1b - Manual Processing'; %location to copy unsuccessful .mff to for manual process\n\n% Set path for processing summary\nsummPath = 'Z:\\Shared Server\\Study Folder\\Data Processing\\6. MATLAB EEG Pipeline\\Processed Data Logs';\n\n% Set path for summary of files to process manually \nmanPath = 'Z:\\Shared Server\\Study Folder\\Data Processing\\6. MATLAB EEG Pipeline\\Processing To Do\\Cases to Process Manually\\Lists of Cases by Batch';\n\nRun the HAPPE Pipeline\n\nThis first section is designed to rely on user input. Click “Run” on the MATLAB editor window with the file open to begin the process.\nA message will appear in the console prompting you to enter the filepath to the location of the HAPPE pre-processing file you wish to run\nOnce the path is entered, MATLAB will run the file\nNote: the filepath inputted should NOT be in quotes\n\n% Set path to HAPPE pre-processing script\nhappeRun = input('Enter the full path to the HAPPE pre-processing file:\\n&gt; ','s') ;\n\n% Call and run HAPPE pre-processing script\nrun(happeRun);\n\nEnter HAPPE inputs\n\nSee the following section for HAPPE user inputs for Oddball\n\n\n\nAfter the HAPPE inputs are entered, no more user interaction is required for the script to do its job. The HAPPE pipeline will run, and the remaining MATLAB code in the script file will evaluate the files outputted by HAPPE and move them to the appropriate locations based on this evaluation. See Oddball Post-HAPPE Steps for a detailed explanation of the code used to accomplish this.\n\n\nIf you are not using the MATLAB scripts described above, you must first open the HAPPE pipeline V4 script in MATLAB and click “Run”\n\nThis will be stored in the location to which you mapped the HAPPE Git repo (e.g. Documents/GitHub/HAPPE/1. pre-process/HAPPE_v4.m)\n\n\nUser Inputs\n\nEnter the path to the folder containing the dataset.\nSelect raw\n\nLoad pre-existing set of input parameter:\n\n\nN if this is your first time running data through the pipeline.\n\nY if you have decided on a set of parameters. Enter the path to the folder containing the input parameters.\n\n\nLow density data: N\n\nData type: task\n\nPerforming event-related potential (ERP) analysis: Y\n\nEnter the task onset tags\n\nTarget: tgt+\n\nFrequent: frq+\n\ndone\n\n\nDo multiple onset tags belong to a single condition? N\n\nFile format: 5\n\nAcquisition layout type: 2\n\nNumber of channels: 128\n\nDo you have additional type fields besides “code”? N\n\nSelect channels of interest: all\n\nFrequency of electrical noise in Hz: 60\n\nAre there any additional frequencies, (e.g., harmonics) to reduce? N\n\nLine Noise reduction method: notch\n\nLow cutoff: 59\n\nhigh cutoff: 61\n\n\n\nResample: N\n\nFilter\n\nLow Pass Cutoff: 30\n\nHigh Pass Cutoff: .1\n\n\n\nChoose a filter: fir\n\nBad Channel Detection: Y\n\n\nafter wavelet thresholding\n\n\nECGone: N\n\nWavelet Thresholding\n\ndefault\nThreshold rule: hard\n\n\n\nMuscIL: N\n\nSegmentation: Y\n\nStarting parameter for stimulus: -200\n\nEnding parameter for stimulus: 1000\n\nTask offset: 2\n\n\n\nBaseline Correction: Y\n\nBaseline Correction start: -200\n\nBaseline Correction end: 0\n\n\n\nInterpolation: Y\n\nSegment Rejection: Y\n\nSegment Rejection Method: amplitude\n\nminimum segment rejection threshold: -150\n\nmaximum segment rejection threshold: 150\n\nsegment rejection based on all channels or ROI: all\n\n\n\n\n\nRe-referencing: Y\n\nDoes your data contain a flatline or all zero reference channel? N\n\nre-referencing method: average\n\n\n\nSave format: 1\n\nVisualizations: N\n\nParameter file save name: default\n\n\n\n\nThis section details the actions performed by the MATLAB scripts once HAPPE is completed. These actions will take place automatically upon completion of the HAPPE pipeline. No user inputs or actions are necessary at this stage.\n\n\nExclude files that don’t have any output data from the dataset (containing filename and quality reports from HAPPE pipeline) that will be used to assess file quality\n\nThis step is important because “empty” files don’t play nicely with the code used to evaluate files that have some data in them (even if the data do not meet threshold)\nThis code relies on HAPPE’s quality data that remains in the MATLAB environment after the pipeline has finished.\n\n% Create a list of files that received some kind of error message\nnoTags = any(strcmp(dataQC, 'NO_TAGS'), 2);\noneRej = any(strcmp(dataQC, 'REJ_ONE_SEG'), 2);\nallRej = any(strcmp(dataQC, 'ALL_SEG_REJ'), 2);\nerror = any(strcmp(dataQC, 'ERROR'), 2);\nloadFail = any(strcmp(dataQC, 'LOAD_FAIL'), 2);\n\n% Combine filenames with quality data (for some reason, they are not automatically connected by HAPPE)\ndataQCNew = [FileNames', dataQC];\n\n% Remove all files in the above lists (those receiving errors) from the quality data\ndataQCNew(noTags | allRej | error | loadFail | oneRej, :) = [];\n\n% Create list of variable names for quality data\ndataQCnamesNew = [\"File\", dataQCnames];\n\n% Save the data as a table for ease of use in subsequent steps\nqcTable = cell2table(dataQCNew, 'VariableNames', dataQCnamesNew);\n\n\nIdentify the files that meet (or don’t meet) the threshold\n% Create a list of files (i.e., rows in the table) that meet threshold\nthresholdTest = qcTable.(\"Number_tgt+_Segs_Post-Seg_Rej\") &gt;= trialCutoff & qcTable.(\"Number_frq+_Segs_Post-Seg_Rej\") &gt;= trialCutoff;\n\n% Add a variable to the quality data table that include whether or not the file meet threshold\nqcTable.Test = thresholdTest;\n\n\nAdd an identifying variable to be used for data joining down the line\n\nThis variable is generated using its expected location in the file name (i.e., how many text characters “in” it is)\n\n% Generate IDs based on File variable\nidWaveQC = extractBefore(qcTable.File, 8);\n\n% Append ID variable to quality data\nqcTable.idWave = idWaveQC;\n\n\nCreate a subsetted dataset conataining only the idWave, file name, and “test results” (i.e., whether a given file meets the specified cutoff threshold for inclusion) variables\n% Subset to ID and threshold information\ntestInfo = qcTable(:, [\"idWave\", \"File\", \"Test\"]);\n\nfprintf('Assessment Complete \\n');\n\n\nGenerate a list of files outputted by HAPPE\n% Generate path for HAPPE pre-processing output (using the HAPPE environment variable from user's input of location of raw data for processing)\ninputPath = strcat(srcDir, \"\\5 - processed\");\n\n% Read in list of files outputted from HAPPE \npreprocessingOutput = dir(inputPath);\n\n% Remove \"empty\" rows \npreprocessingOutput = preprocessingOutput(~ismember({preprocessingOutput.name}, {'.', '..'}));\n\n% Save data as a table for ease of later use\npreprocessingOutput = struct2table(preprocessingOutput);\n\n% Subset to file info\nfileInfo = preprocessingOutput(:, [\"name\", \"folder\"]);\n\n\nSelect only desired files to be moved/copied\n\nCurrently, we don’t do anything with the “Individual Trial” files outputted by HAPPE. These files are quite large and take a long time to move, so it is more efficient to just remove them from the list of filenames and not worry about moving them anywhere.\n\n% Subset to desired files (AveOverTrial)\nfileSubset = fileInfo(contains(fileInfo.name, \"AveOverTrials\"), :);\n\n\nAdd condition, ID, and threshold-related variables to the file data\n\nNOTE: The value for Condition variable (i.e., “Target” or “Frequent”) should match the name of the condition-specific folders you wish the files to save to within the processing repo.\n\n% Generate list of IDs based on file name variable\nidWaveFS = extractBefore(fileSubset.name, 8);\n\n% Add ID list to file data\nfileSubset.idWave = idWaveFS;\n\n% Generate list of files belonging to each condition based on file name variable\ntarget = contains(fileSubset.name, \"tgt+\");\nfrequent = contains(fileSubset.name, \"frq+\");\n\n% Create empty variable for condition\nfileSubset.cond = cell(size(fileSubset, 1), 1);\n\n% Fill in condition variable based on the lists generated above\nfileSubset.cond(target) = {'Target'};\nfileSubset.cond(frequent) = {'Frequent'};\nfileSubset.cond(~target & ~frequent) = {'All'};\n\n% Join threshold test information\nfileTest = join(fileSubset, testInfo);\n\n\nPrepare data table with information about files that met the threshold\n\nThe data generated here are preparing to copy the .txt files outputted by HAPPE into a folder containing all files that are suitable for PCA\n\n% Create a separate table for only files that meet threshold\nmovingInfo = fileTest(fileTest.Test, :);\n\n% Create empty columns for filepath variables\nmovingInfo.destination = cell(size(movingInfo, 1), 1);\nmovingInfo.origin = cell(size(movingInfo, 1), 1);\nmovingInfo.processedTo = cell(size(movingInfo, 1), 1);\nmovingInfo.processedFrom = cell(size(movingInfo, 1), 1);\n\n% Generate file paths based on condition \nmovingInfo.destination = strcat({passPath}, \"\\\", movingInfo.cond, \"\\\", movingInfo.name);\nmovingInfo.origin = strcat(movingInfo.folder, \"\\\", movingInfo.name);\nmovingInfo.processedTo = strcat({allPath}, \"\\\", movingInfo.name);\nmovingInfo.processedFrom = strcat(movingInfo.folder, \"\\\", movingInfo.name);\n\n\nPrepare data table with information about files that do NOT meet the threshold\n\nThe data generated here are preparing to copy .mff files from the location of the raw files into a folder indicating the need for manual processing\n\n% Create a separate table for only files that did not meet threshold\nfailFiles = fileTest(~fileTest.Test, [\"File\", \"folder\", \"name\"]);\n\n% Create empty columns for filepath variables\nfailFiles.destination = cell(size(failFiles, 1), 1);\nfailFiles.origin = cell(size(failFiles, 1), 1);\nfailFiles.processedTo = cell(size(failFiles, 1), 1);\nfailFiles.processedFrom = cell(size(failFiles, 1), 1);\n\n% Generate filepaths based on ID and task\nfailFiles.destination = strcat({failPath}, \"\\\", failFiles.File);\nfailFiles.origin = strcat({srcDir}, \"\\\", failFiles.File);\nfailFiles.processedFrom = strcat(failFiles.folder, \"\\\", failFiles.name);\nfailFiles.processedTo = strcat({allPath}, \"\\\", failFiles.name);\n\n\n\nGenerate environment variables that correspond to the column index of relevant variables for file sorting\n\nNote that the very last line of this code defines the varaible(s) to exclude from the HAPPE outputted files. This variable must be stripped from the data before saving them, because the presence of the extra variable makes the file incompatible with EP Toolkit’s PCA process.\n\n% Define column locations for each filepath variable\n\n% For files that meet threshold:\ntoCol = find(strcmp(movingInfo.Properties.VariableNames, \"destination\"));\nfromCol = find(strcmp(movingInfo.Properties.VariableNames, \"origin\"));\nprocColto = find(strcmp(movingInfo.Properties.VariableNames, \"processedTo\"));\nprocColfrom = find(strcmp(movingInfo.Properties.VariableNames, \"processedFrom\"));\n\n% For files that do not meet threshold\nrawCol = find(strcmp(failFiles.Properties.VariableNames, \"origin\"));\nmanCol = find(strcmp(failFiles.Properties.VariableNames, \"destination\"));\nfailProcColto = find(strcmp(failFiles.Properties.VariableNames, \"processedTo\"));\nfailProcColFrom = find(strcmp(failFiles.Properties.VariableNames, \"processedFrom\"));\n\n% Define variable to exclude\nextraVar = 'Time';\n\n\nUse a loop to process all files that met threshold\n\nFor each row in the “movingInfo” dataset, the loop will:\n\nIdentify the origin and destination paths\nRead in the HAPPE output file\nRemove the extra variable\nSave the “cleaned” data in the appropriate folder (without variable names, as required by EP Toolkit)\n\n\n\nfor row = 1:height(movingInfo)\n    % Specify path info\n    pathFrom = movingInfo{row, fromCol};\n    pathTo = movingInfo{row, toCol};\n    % Read in the data\n    rawTable = readtable(pathFrom);\n    % Remove extra column (Time)\n    cleanTable = rawTable{:, ~strcmp(rawTable.Properties.VariableNames, extraVar)};\n    % Save without headers\n    writematrix(cleanTable, pathTo, 'Delimiter', '\\t')\nend\n\n\n\nUse a loop to copy raw (.mff) files into a location that stores files requiring manual processing\nfor row = 1:height(failFiles)\n    % Specify path info\n    pathFrom = failFiles{row, rawCol};\n    pathTo = failFiles{row, manCol};\n    % Copy file \n    copyfile(pathFrom, pathTo)\nend\n\n\nUse a set of loops to copy all HAPPE output files into a folder intended to house all output (whether threshold is met or not)\nfor row = 1:height(movingInfo)\n    % Specify path info\n    pathFrom = movingInfo{row, procColfrom};\n    pathTo = movingInfo{row, procColto};\n    % Copy file\n    copyfile(pathFrom, pathTo);\nend\n\nfor row = 1:height(failFiles)\n    % Specify path info\n    pathFrom = failFiles{row, failProcColFrom};\n    pathTo = failFiles{row, failProcColto};\n    % Copy file\n    copyfile(pathFrom, pathTo);\nend\n\n\nGenerate a .txt file listing all processed .mff files\n\nThis file will contain a list of all raw files (e.g., 1111_22_oddball.mff) and save the list to the specified location (summPath)\nThe file will have the current date and time appended to the end so that it will be distinguishable from past logs\nThe list of processed files is generated using an environment object (FileNames) that the HAPPE pipeline creates that lists all files inputted to the pipeline\n\n% Create a table from HAPPE FileNames cell array\nprocessedList = cell2table(FileNames(:));\n\n% Rename file variable from default\nprocessedList = renamevars(processedList, {'Var1'}, {'File'});\n\n% Save current date as a string variable \ntoday = string(date());\n\n% Save time as a string variable, replacing \":\" with \"_\" so that file can be written \ntime = strrep(datestr(now, 'HH:MM:SS:FFF'), ':', \"_\");\n\n% Generate file name to include current date and time \nlistFile = strcat(\"\\oddballProcessed_\", today, \"_\", time);\n\n% Generate full path including file name\nsummPathFull = strcat(summPath, listFile);\n\n% Write table to specified location\nwritetable(processedList, summPathFull);\n\n\nGenerate a .txt file listing all of the files that did not meet threshold to go through subsequent processing\n\nThis file will contain a list of all raw files (e.g., 1111_22_oddball.mff) that did not meet threshold and save the list to the specified location (manPath)\nThe file will have the current date and time appended to the end so that it will be distinguishable from past lists\nThis list of file to process manually is generated using the environment object FileNames that HAPPE creates; any files listed in FileNames but not in the dataset of files that pass threshold make up the manualList\n\n\n% Compare movingInfo with FileNames to isolate files that don't meet threshold\nmanualList = cell2table(FileNames(~ismember(FileNames', movingInfo.File)));\nmanualList = renamevars(manualList, {'Var1'}, {'File'});\n\n% Generate file name to include current date\nmanFile = strcat(\"\\oddballManual_\", today, \"_\", time);\n\n% Generate full path including filename\nmanPathFull = strcat(manPath, manFile);\n\n% Write table to specified location\nwritetable(manualList, manPathFull);\n\n\n\n\n0 - Raw\n1a - Files for HAPPE\n1b - Manual Processing\n2 - Processed Files\n3 - Files for PCA\n4 - EPT Averages\n5 - PCA\n6 - PCA Components\n\nThe following section describes the MATLAB scripts used to manage HAPPE input and output files for the FishShark task data. If you are running HAPPE manually (i.e., without integrating these scripts), skip to the FishShark HAPPE inputs section.\nThe first two steps described in this section are the same as those described for Oddball processing. Processing actions specific to FishSharks task begin in Step 3.\n\nOpen the eegProccessingFishshark.m file (accessible via Git here) in MATLAB\nUpdate all thresholds and filepaths in script file (must be done BEFORE running the script)\n\nIn the fifth section of our script file, we set our “threshold” for the minimum number of trials that need to be retained after pre-processing for a subject’s data to be eligible for PCA. Additional thresholds can also be set for things like number of channels retained, but these are not currently in use.\nNote that setting these parameters occurs later in the FishSharks script than the one for Oddball; this is because FishSharks files require additional processing before they are ready for HAPPE (see step 3 for details)\n\n% Set quality threshold parameters\ntrialCutoff = 10;\n\nWe also set environment variables with all of the filepaths that are relevant for managing HAPPE output files and tracking processed data. The following paths should be checked and updated as necessary to reflect the organization of processing on your computer.\n\n\npassPath is the location you wish to have files that meet or exceed the above-defined thresholds to be saved\n\nallPath is the location you wish to have ALL files outputted from HAPPE saved to (regardless of whether threshold is met or not)\n\nfailPath is the location you wish to have files that do not meet the above-defined thresholds to be copied to\n\n.mff files that do not meet threshold will be copied here as an indication that they should be processed manually to see if they meet threshold afterward\n\n\n\nsummPath is the location you wish to save the file that lists all files processed through HAPPE in the current batch\n\nWe currently use this to save the “processing log” to a location that all team members/computers have access to so it is easier to determine which files require processing when EEG data are not stored on a shared server\n\n\n\nmanPath is the location you wish to save the file that lists all files that do not meet the above-defined thresholds\n\nWe currently use this to save the “to process manually” list to a location that all team members/computers have access to so it is easier to determine which files require manual processing because the copied .mff file would not be acessible via our shared server\n\n\n\n\n\n% Set paths for file sorting\npassPath = 'V:\\Processing-Repo\\Folder Structure\\3 - Files for PCA'; %location for .txt output files\nallPath = 'V:\\Processing-Repo\\Folder Structure\\2 - Processed Files'; %location for all processed files to end up\nfailPath = 'V:\\Processing-Repo\\Folder Structure\\1b - Manual Processing'; %location to copy unsuccessful .mff to for manual process\n\n% Set path for processing summary\nsummPath = 'Z:\\Shared Server\\Study Folder\\Data Processing\\6. MATLAB EEG Pipeline\\Processed Data Logs';\n\n% Set path for summary of files to process manually \nmanPath = 'Z:\\Shared Server\\Study Folder\\Data Processing\\6. MATLAB EEG Pipeline\\Processing To Do\\Cases to Process Manually\\Lists of Cases by Batch';\n\nUpdate raw (.mff) files’ condition tags with accuracy information\n\nUnlike the Passive Oddball task, FishSharks trials can be either correct or incorrect. Whether or not a trial was “responded to” correctly is relevant to the nature of the extracted ERP. Because the event tags in our .mff files do not inherently contain information about whether each trial was responded to correctly, we need to add it ourselves. This process can be done manually in NetStation, but it can also be automated using the MATLAB code detailed below.\nNOTE: This code requires eeglab. Before running the code, open eeglab in your MATLAB session by typing eeglab into the console. You can close it as soon as it opens, but this step ensures that eeglab is loaded into your current session and helps prevent the subsequent code from erroring out.\n\n\n\nSet the filepaths for raw and updated .mff files\n\nThis section is set to rely on user inputs. Click “Run” in the MATLAB editor to start the processing.\nA message will appear in the console prompting you to enter two filepaths: the first is the location of the raw .mff files, and the second is the location you would like the updated files to save in.\nNote: the filepaths inputted should NOT be in quotes\n\n% User input for location of raw files\npathRaw = input('Enter the full path to the folder containing the raw files:\\n&gt; ','s');\n\n% User input for destination of subsetted files\npathSub = input('Enter the full path to the folder in which to save the updated files:\\n&gt; ','s');\nAt this point, there will be no user input/actions necessary until all of the .mff files in the pathRaw directory have been updated and saved into the pathSub directory. The code that asks the user for the path to HAPPE will run when that process has finished. The following section will describe the code used to automate the process of updating .mff event tags to include accuracy information at the trial level. Move on to Step 4 (Run the HAPPE Pipeline) when the process has completed.\n\n\nGather and manage information from the directory housing the raw (.mff) files\n% Have MATLAB gather a list of raw files housed in specified location (pathRaw)\ndirInfo = struct2table(dir(pathRaw));\n\n% Remove blank rows\nnoName = strcmp(dirInfo.name, '.') | strcmp(dirInfo.name, '..');\ndirInfo(noName, :) = [];\n\n\nGenerate variables necessary for managing raw and updated files\n\nThis code will generate the full filepaths (including file name) necessary for reading in each .mff file and saving its updated counterpart\nIt will also generate an ID variable for joining purposes based on the expected location of the subject name in the name of each file\n\n% Generate ID variable\ndataFiles = dirInfo(:, \"name\");\n\n% Add ID variable to file data\ndataFiles.ID = extractBefore(dataFiles.name, 8);\n\n% Generate path to read raw data\nrawPaths = dataFiles;\nrawPaths.path = strcat({pathRaw}, \"/\", dirInfo.name);\nrawPaths = rawPaths(:, [\"ID\", \"path\"]);\n\n% Generate path to save updated versions of the data (containing accuracy info at trial level)\nsubPaths = dataFiles;\nsubPaths.path = strcat({pathSub}, \"/\", subPaths.ID, \"_sub_fishshark.mff\");\nsubPaths = subPaths(:, [\"ID\", \"path\"]);\n\n% Join filepath datatables\nmergePaths = join(rawPaths, subPaths, 'Keys', {'ID'})\n\n\nUse a loop to update the event tags in each .mff file to reflect accuracy of response\n\nFor every file included in the mergePaths dataset, MATLAB will perform the following actions:\n\nSet environment variables representing the path to read in the original .mff file and save its updated counterpart (updates with each iteration of the loop)\nRead in the .mff file\nExtract the “event” information from the .mff file\nEvaluate whether there is usable data in the file\n\nThis step prevents the code from erroring out if a subject did not make it past the practice trials\nIf the evaluation determines that there is NOT usable data in the present file, the loop will jump to the next file\n\n\nCreate a table containing response information (response vs no response and reaction time) and condition information (go vs no-go) at the trial level\nEvaluate each trial to determine whether the response was correct or incorrect\n\nFor No-Go trials, responses are CORRECT if there was no response (incorrect if subject did respond)\nFor Go trials, responses are CORRECT if there was a response AND subject’s reaction time was at least 200 ms (incorrect if subject did not respond OR if subject responded too quickly for response to be considered “valid”)\n\n\nUpdate the event tags in the .mff file to contain a “c” for correct trials and an “x” for incorrect trials\n\nThe c/x indicator will be appended to the front of the existing event tag (e.g., Go++ will become cGo++)\n\n\nExport an updated version of the .mff file with accuracy information to the specified location (pathSub)\n\nNOTE: When exporting EEG data from MATLAB, it is absolutely necessary for the data to be organized in order of event latency. If the rows are out of order, latency errors may be introduced.\n\nCorrect row order can be achieved in .mff filetypes by sorting according to either the latency column or the urevent column (as shown below)\n\n\n\nfor row = 1:height(mergePaths)\n    % Specify paths\n    rawFolder = mergePaths{row, \"path_rawPaths\"}\n    subFolder = mergePaths{row, \"path_subPaths\"}\n\n    % Read in EEG data\n    EEGraw = pop_mffimport(char(rawFolder), 'code')\n\n    % Create table from \"event\" field of raw data\n    EEGevent = struct2table(EEGraw.event)\n\n    % Check for the existence of usable rows\n    checkVars = strcmp(EEGevent.Properties.VariableNames, 'mffkey_cel')\n\n    % Skip files without necessary variables\n    if max(checkVars) == 0\n        continue\n    end\n\n    % Create table without practice/training trials\n    keepRows = strcmp(EEGevent.mffkey_cel, '4')\n    EEGsub  = EEGevent(keepRows, :)\n\n    % Check for the existence of usable rows\n    checkRows = max(keepRows)\n\n    % Skip files with no usable rows\n    if checkRows == 0\n        continue\n    end\n\n    % Get response info at trial level\n    EEGresp = table(EEGsub.mffkey_obs, EEGsub.mffkey_eval, EEGsub.mffkey_rtim)\n    EEGresp = rmmissing(EEGresp)\n    EEGresp = renamevars(EEGresp, [\"Var1\", \"Var2\", \"Var3\"], [\"Trial\", \"Eval\", \"RTime\"])\n\n    % Get condition info at trial level\n    EEGconds = table(EEGsub.mffkey_obs, EEGsub.type)\n    EEGconds = renamevars(EEGconds, [\"Var1\", \"Var2\"], [\"Trial\", \"Cond\"])\n    keepConds = strcmp(EEGconds.Cond, 'Go++') | strcmp(EEGconds.Cond, 'NG++')\n    EEGcond = EEGconds(keepConds, :)\n\n    % Merge datasets\n    EEGtrials = join(EEGcond, EEGresp)\n\n    EEGtrials.RTime = cellfun(@str2num, EEGtrials.RTime)\n    % Evaluate trials for correct-ness of response\n    correct = strcmp(EEGtrials.Cond, 'Go++') & strcmp(EEGtrials.Eval, '1') & EEGtrials.RTime &gt; 200 | strcmp(EEGtrials.Cond, 'NG++') & strcmp(EEGtrials.Eval, '0')\n    EEGtrials.Acc = correct\n\n\n    % Create new code tags including accuracy information\n    EEGtrials.newCode(EEGtrials.Acc & strcmp(EEGtrials.Cond, 'Go++')) = {'cGo++'}\n    EEGtrials.newCode(~EEGtrials.Acc & strcmp(EEGtrials.Cond, 'Go++')) = {'xGo++'}\n    EEGtrials.newCode(EEGtrials.Acc & strcmp(EEGtrials.Cond, 'NG++')) = {'cNG++'}\n    EEGtrials.newCode(~EEGtrials.Acc & strcmp(EEGtrials.Cond, 'NG++')) = {'xNG++'}\n\n    % Subset information for merge\n    EEGmerge = EEGtrials(:, {'Trial', 'Cond', 'newCode'})\n\n    % Prep key in original data\n    EEGevent.key = strcat(EEGevent.mffkey_obs, EEGevent.type)\n\n    % Prep key in merge data\n    EEGmerge.key = strcat(EEGmerge.Trial, EEGmerge.Cond)\n    EEGmerge = EEGmerge(:, {'key', 'newCode'})\n\n    % Merge new codes with event table\n    EEGnew = outerjoin(EEGevent, EEGmerge)\n\n    % Replace codes where new code is needed\n    EEGnew.code(~strcmp(EEGnew.newCode, '')) = EEGnew.newCode(~strcmp(EEGnew.newCode, ''))\n    EEGnew.type(~strcmp(EEGnew.newCode, '')) = EEGnew.newCode(~strcmp(EEGnew.newCode, ''))\n\n    % Arrange table in order of event (CRUCIAL for correct export)\n    EEGnew = sortrows(EEGnew, 'urevent')\n\n    % Convert table back to struct and restore original dimensions\n    EEGnew = table2struct(EEGnew(:, 1:29))\n    EEGnew = reshape(EEGnew, [1, height(EEGnew)])\n\n    % Replace event table(s) in original struct\n    EEGraw.event = EEGnew\n    EEGraw.urevent = table2struct(struct2table(EEGnew(:, 1:28)))\n\n    % Export updated file\n    pop_mffexport(EEGraw, char(subFolder))\nend \n\n\n\nRun the HAPPE Pipeline\n\nThis section is designed to rely on user input.\nWhen the prior steps have finsihed, a message will appear in the console prompting you to enter the filepath to the location of the HAPPE pre-processing file you wish to run\nOnce the path is entered, MATLAB will run the file\nNote: the filepath inputted should NOT be in quotes\n\n% Set path to HAPPE pre-processing script\nhappeRun = input('Enter the full path to the HAPPE pre-processing file:\\n&gt; ','s') ;\n\n% Call and run HAPPE pre-processing script\nrun(happeRun);\n\nEnter HAPPE inputs\n\nSee the following section for HAPPE inputs for the Fish/Shark task\n\n\n\nAfter the HAPPE inputs are entered, no more user interaction is required for the script to do its job. The HAPPE pipeline will run, and the remaining MATLAB code in the script file will evaluate the files outputted by HAPPE and move them to the appropriate locations based on this evaluation. See FishShark Post-HAPPE Steps for a detailed explanation of the code used to accomplish this.\n\n\nIf you are not using the MATLAB scripts described above, you must first open the HAPPE pipeline V4 script in MATLAB and click “Run”\n\nThis will be stored in the location to which you mapped the HAPPE Git repo (e.g. Documents/GitHub/HAPPE/1. pre-process/HAPPE_v4.m)\n\n\nUser Inputs\n\nEnter the path to the folder containing the dataset.\nSelect raw\n\nLoad pre-existing set of input parameter:\n\n\nN if this is your first time running data through the pipeline.\n\nY if you have decided on a set of parameters. Enter the path to the folder containing the input parameters.\n\n\nLow density data: N\n\nData type: task\n\nPerforming event-related potential (ERP) analysis: Y\n\nEnter the task onset tags\n\nCorrect Go: cGo++\n\nIncorrect Go: xGo++\n\nCorrect NoGo: cNG++\n\nIncorrect NoGo: xNG++\n\ndone\n\n\nDo multiple onset tags belong to a single condition? N\n\nFile format: 5\n\nAcquisition layout type: 2\n\nNumber of channels: 128\n\nDo you have additional type fields besides “code”? N\n\nSelect channels of interest: all\n\nFrequency of electrical noice in Hz: 60\n\nAre there any additional frequencies, (e.g., harmonics) to reduce? N\n\nLine Noise reduction method: notch\n\nLow cutoff: 59\n\nhigh cutoff: 61\n\n\n\nResample: N\n\nFilter\n\nLow Pass Cutoff: 30\n\nHigh Pass Cutoff: .1\n\n\n\nChoose a filter: fir\n\nBad Channel Detection: Y\n\n\nafter wavelet thresholding\n\n\nECGone: N\n\nWavelet Thresholding\n\ndefault\nThreshold rule: hard\n\n\n\nMuscIL: N\n\nSegmentation: Y\n\nStarting parameter for stimulus: -200\n\nEnding parameter for stimulus: 1000\n\nTask offset: 17\n\n\n\nBaseline Correction: Y\n\nBaseline Correction start: -200\n\nBaseline Correction end: 0\n\n\n\nInterpolation: Y\n\nSegment Rejection: Y\n\nSegment Rejection Method: amplitude\n\nminimum segment rejection threshold: -150\n\nmaximum segment rejection threshold: 150\n\nsegment rejection based on all channels or ROI: all\n\n\n\n\n\nRe-referencing: Y\n\nDoes your data contain a flatline or all zero reference channel? N\n\nre-referencing method: average\n\n\n\nSave format: 1\n\nVisualizations: N\n\nParameter file save name: default\n\n\n\n\nThis section details the actions performed by the MATLAB scripts once HAPPE is completed. These actions will take place automatically upon completion of the HAPPE pipeline. No user inputs or actions are necessary at this stage.\n\n\nExclude files that don’t have any output data from the dataset (containing filename and quality reports from HAPPE pipeline) that will be used to assess file quality\n\nThis step is important because “empty” files don’t play nicely with the code used to evaluate files that have some data in them (even if the data do not meet threshold)\nThis code relies on HAPPE’s quality data that remains in the MATLAB environment after the pipeline has finished.\n\n% Create a list of files that received some kind of error message\nnoTags = any(strcmp(dataQC, 'NO_TAGS'), 2);\nallRej = any(strcmp(dataQC, 'ALL_SEG_REJ'), 2);\noneRej = any(strcmp(dataQC, 'REJ_ONE_SEG'), 2);\nerror = any(strcmp(dataQC, 'ERROR'), 2);\nloadFail = any(strcmp(dataQC, 'LOAD_FAIL'), 2);\n\n% Combine filenames with quality data (for some reason, they are not automatically connected by HAPPE)\ndataQCNew = [FileNames', dataQC];\n\n% Remove all files in the above lists (those receiving errors) from the quality data\ndataQCNew(noTags | allRej | error | loadFail | oneRej, :) = [];\n\n% Create list of variable names for quality data\ndataQCnamesNew = [\"File\", dataQCnames];\n\n% Save the data as a table for ease of use in subsequent steps\nqcTable = cell2table(dataQCNew, 'VariableNames', dataQCnamesNew);\n\n% Subset to ID and threshold information\ntestInfo = qcTable(:, [\"idWave\", \"File\", \"Test\"]);\n\n\nIdentify the files that meet (or don’t meet) the threshold\n% Create a list of files (i.e., rows in the table) that meet threshold\nthresholdTest = qcTable.(\"Number_cNG++_Segs_Post-Seg_Rej\") &gt;= trialCutoff & qcTable.(\"Number_cGo++_Segs_Post-Seg_Rej\") &gt;= trialCutoff;\n\n% Add a variable to the quality data table that include whether or not the file meet threshold\nqcTable.Test = thresholdTest;\n\n\nAdd an identifying variable to be used for data joining down the line\n\nThis variable is generated using its expected location in the file name (i.e., how many text characters “in” it is)\n\n% Generate IDs based on File variable\nidWaveQC = extractBefore(qcTable.File, 8);\n\n% Append ID variable to quality data\nqcTable.idWave = idWaveQC;\n\n\nCreate a subsetted dataset conataining only the idWave, file name, and “test” results (i.e., whether a given file meets the specified cutoff threshold for inclusion)\n% Subset to ID and threshold information\ntestInfo = qcTable(:, [\"idWave\", \"File\", \"Test\"]);\n\nfprintf('Assessment Complete \\n');\n\n\nGenerate a list of files outputted by HAPPE\n% Generate path for HAPPE pre-processing output (using the HAPPE environment variable from user's input of location of raw data for processing)\ninputPath = strcat(srcDir, \"\\5 - processed\");\n\n% Read in list of files outputted from HAPPE \npreprocessingOutput = dir(inputPath);\n\n% Remove \"empty\" rows \npreprocessingOutput = preprocessingOutput(~ismember({preprocessingOutput.name}, {'.', '..'}));\n\n% Save data as a table for ease of later use\npreprocessingOutput = struct2table(preprocessingOutput);\n\n% Subset to file info\nfileInfo = preprocessingOutput(:, [\"name\", \"folder\"]);\n\n\nSelect only desired files to be moved/copied\n\nCurrently, we don’t do anything with the “Individual Trial” files outputted by HAPPE. These files are quite large and take a long time to move, so it is more efficient to just remove them from the list of filenames and not worry about moving them anywhere.\n\n% Subset to desired files (AveOverTrial)\nfileSubset = fileInfo(contains(fileInfo.name, \"AveOverTrials\"), :);\n\n\nAdd condition, ID, and threshold-related variables to the file data\n\nNOTE: The value for Condition variable (i.e., “cGo” or “cNoGo”) should match the name of the condition-specific folders you wish the files to save to within the processing repo.\n\n% Generate list of IDs based on file name variable\nidWaveFS = extractBefore(fileSubset.name, 8);\n\n% Add ID list to file data\nfileSubset.idWave = idWaveFS;\n\n% Generate list of files belonging to each condition based on file name variable\ncGo = contains(fileSubset.name, \"cGo++\");\ncNoGo = contains(fileSubset.name, \"cNG++\");\nxGo = contains(fileSubset.name, \"xGo++\");\nxNoGo = contains(fileSubset.name, \"xNG++\");\n\n% Create empty variable for condition\nfileSubset.cond = cell(size(fileSubset, 1), 1);\n\n% Fill in condition variable based on the lists generated above\nfileSubset.cond(cGo) = {'cGo'};\nfileSubset.cond(cNoGo) = {'cNoGo'};\nfileSubset.cond(xGo) = {'xGo'};\nfileSubset.cond(xNoGo) = {'xNoGo'};\nfileSubset.cond(~cGo & ~cNoGo & ~xGo & ~xNoGo) = {'All'};\n\n% Join threshold test information\nfileTest = join(fileSubset, testInfo);\n\n\nPrepare data table with information about files that met the threshold\n\nThe data generated here are preparing to copy the .txt files outputted by HAPPE into a folder containing all files that are suitable for PCA\n\n% Create a separate table for only files that meet threshold\nmovingInfo = fileTest(fileTest.Test, :);\n\n% Create empty columns for filepath variables\nmovingInfo.destination = cell(size(movingInfo, 1), 1);\nmovingInfo.origin = cell(size(movingInfo, 1), 1);\nmovingInfo.processedTo = cell(size(movingInfo, 1), 1);\nmovingInfo.processedFrom = cell(size(movingInfo, 1), 1);\n\n% Generate file paths based on condition \nmovingInfo.destination = strcat({passPath}, \"\\\", movingInfo.cond, \"\\\", movingInfo.name);\nmovingInfo.origin = strcat(movingInfo.folder, \"\\\", movingInfo.name);\nmovingInfo.processedTo = strcat({allPath}, \"\\\", movingInfo.name);\nmovingInfo.processedFrom = strcat(movingInfo.folder, \"\\\", movingInfo.name);\n\n\nPrepare data table with information about files that do NOT meet the threshold\n\nThe data generated here are preparing to copy .mff files from the location of the raw files into a folder indicating the need for manual processing\n\n% Create a separate table for only files that did not meet threshold\nfailFiles = fileTest(~fileTest.Test, [\"File\", \"folder\", \"name\"]);\n\n% Create empty columns for filepath variables\nfailFiles.destination = cell(size(failFiles, 1), 1);\nfailFiles.origin = cell(size(failFiles, 1), 1);\nfailFiles.processedTo = cell(size(failFiles, 1), 1);\nfailFiles.processedFrom = cell(size(failFiles, 1), 1);\n\n% Generate filepaths based on ID and task\nfailFiles.destination = strcat({failPath}, \"\\\", failFiles.File);\nfailFiles.origin = strcat({srcDir}, \"\\\", failFiles.File);\nfailFiles.processedFrom = strcat(failFiles.folder, \"\\\", failFiles.name);\nfailFiles.processedTo = strcat({allPath}, \"\\\", failFiles.name);\n\n\n\nGenerate environment variables that correspond to the column index of relevant variables for file sorting\n\nNote that the very last line of this code defines the varaible(s) to exclude from the HAPPE outputted files. This variable must be stripped from the data before saving them, because the presence of the extra variable makes the file incompatible with EP Toolkit’s PCA process.\n\n% Define column locations for each filepath variable\n\n% For files that meet threshold:\ntoCol = find(strcmp(movingInfo.Properties.VariableNames, \"destination\"));\nfromCol = find(strcmp(movingInfo.Properties.VariableNames, \"origin\"));\nprocColto = find(strcmp(movingInfo.Properties.VariableNames, \"processedTo\"));\nprocColfrom = find(strcmp(movingInfo.Properties.VariableNames, \"processedFrom\"));\n\n% For files that do not meet threshold\nrawCol = find(strcmp(failFiles.Properties.VariableNames, \"origin\"));\nmanCol = find(strcmp(failFiles.Properties.VariableNames, \"destination\"));\nfailProcColto = find(strcmp(failFiles.Properties.VariableNames, \"processedTo\"));\nfailProcColFrom = find(strcmp(failFiles.Properties.VariableNames, \"processedFrom\"));\n\n% Define variable to exclude\nextraVar = 'Time';\n\n\nUse a loop to process all files that met threshold\n\nFor each row in the “movingInfo” dataset, the loop will:\n\nIdentify the origin and destination paths\nRead in the HAPPE output file\nRemove the extra variable\nSave the “cleaned” data in the appropriate folder (without variable names, as required by EP Toolkit)\n\n\n\nfor row = 1:height(movingInfo)\n    % Specify path info\n    pathFrom = movingInfo{row, fromCol};\n    pathTo = movingInfo{row, toCol};\n    % Read in the data\n    rawTable = readtable(pathFrom);\n    % Remove extra column (Time)\n    cleanTable = rawTable{:, ~strcmp(rawTable.Properties.VariableNames, extraVar)};\n    % Save without headers\n    writematrix(cleanTable, pathTo, 'Delimiter', '\\t')\nend\n\n\n\nUse a loop to copy raw (.mff) files into a location that stores files requiring manual processing\nfor row = 1:height(failFiles)\n    % Specify path info\n    pathFrom = failFiles{row, rawCol};\n    pathTo = failFiles{row, manCol};\n    % Copy file \n    copyfile(pathFrom, pathTo)\nend\n\n\nUse a set of loops to copy all HAPPE output files into a folder intended to house all output (whether threshold is met or not)\nfor row = 1:height(movingInfo)\n    % Specify path info\n    pathFrom = movingInfo{row, procColfrom};\n    pathTo = movingInfo{row, procColto};\n    % Copy file\n    copyfile(pathFrom, pathTo);\nend\n\nfor row = 1:height(failFiles)\n    % Specify path info\n    pathFrom = failFiles{row, failProcColFrom};\n    pathTo = failFiles{row, failProcColto};\n    % Copy file\n    copyfile(pathFrom, pathTo);\nend\n\n\nGenerate a .txt file listing all processed .mff files\n\nThis file will contain a list of all raw files (e.g., 1111_22_fishshark.mff) and save the list to the specified location (summPath)\nThe file will have the current date and time appended to the end so that it will be distinguishable from past logs\nThe list of processed files is generated using an environment variable that the HAPPE pipeline creates that lists all files inputted to the pipeline\n\n% Create a table from HAPPE FileNames cell array\nprocessedList = cell2table(FileNames(:));\n\n% Rename file variable from default\nprocessedList = renamevars(processedList, {'Var1'}, {'File'});\n\n% Save current date as a string variable \ntoday = string(date());\n\n% Save time as a string variable, replacing \":\" with \"_\" so that file can be written \ntime = strrep(datestr(now, 'HH:MM:SS:FFF'), ':', \"_\");\n\n% Generate file name to include current date and time \nlistFile = strcat(\"\\oddballProcessed_\", today, \"_\", time);\n\n% Generate full path including file name\nsummPathFull = strcat(summPath, listFile);\n\n% Write table to specified location\nwritetable(processedList, summPathFull);\n\n\nGenerate a .txt file listing all of the files that did not meet threshold to go through subsequent processing\n\nThis file will contain a list of all raw files (e.g., 1111_22_fishshark.mff) that did not meet threshold and save the list to the specified location (manPath)\nThe file will have the current date and time appended to the end so that it will be distinguishable from past lists\nThis list of file to process manually is generated using the environment object FileNames that HAPPE creates; any files listed in FileNames but not in the dataset of files that pass threshold make up the manualList\n\n\n% Compare movingInfo with FileNames to isolate files that don't meet threshold\nmanualList = cell2table(FileNames(~ismember(FileNames', movingInfo.File)));\nmanualList = renamevars(manualList, {'Var1'}, {'File'});\n\n% Generate file name to include current date\nmanFile = strcat(\"\\fishSharkManual_\", today, \"_\", time);\n\n% Generate full path including filename\nmanPathFull = strcat(manPath, manFile);\n\n% Write table to specified location\nwritetable(manualList, manPathFull);",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#sec-initial",
    "href": "eegERP.html#sec-initial",
    "title": "EEG and ERP Processing and Analysis",
    "section": "",
    "text": "Download MATLAB: https://its.uiowa.edu/matlab\n\nClick How to Install MatLab and follow the relevant instructions\nCreate a MatLab folder in your local directory. You will keep all of your MatLab related files in this folder.\n\n\nInstall the HAPPE pipeline: https://github.com/PINE-Lab/HAPPE\n\nClone the HAPPE repository to your GitHub account\nOpen the HAPPE folder\nOpen the HAPPE User Guide document\nRead through the HAPPE User Guide\n\nNavigate to the Setting up HAPPE section in the user guide and follow the instructions for setting up the HAPPE pipeline, including installation of add-ons and eeglab\nNote: This version of the HAPPE pipeline includes functionality from the HAPPE 2.0, HAPPE+ER, and HAPPILEE pipelines, so it is suitable for standard EEG processing as well as ERP and low-density EEG/ERP processing.\n\n\nInstall EP Toolkit: https://sourceforge.net/projects/erppcatoolkit/\n\nAfter downloading, copy the EP_Toolkit folder to your Matlab folder (in your local directory)\nIn the EP_toolkit folder:\n\nOpen EP_Toolkit\n\nOpen Documentation\n\nOpen tutorial\n\n\n\nIn the tutorial document, navigate to the Set Up section and follow the instructions for installing and setting up EP Toolkit and FieldTrip. Do NOT follow instructions for setting up EEGLAB. You have already set up your path to EEGLAB when you set up the HAPPE pipeline.\nYou should have the following subfolders in your MatLab folder:\n\nEP_Toolkit\nFieldtrip-[version number]",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#sec-matlabScripts",
    "href": "eegERP.html#sec-matlabScripts",
    "title": "EEG and ERP Processing and Analysis",
    "section": "",
    "text": "We have scripts for each task that can prepare files for the HAPPE Pipeline and/or manage the files outputted from HAPPE. These actions can be done manually as well, but the MATLAB scripts make the process more efficient. The scripts will also generate a “log” of all of the files processed through HAPPE to facilitate tracking of EEG data processing. The sections below detail the code used to perform these actions as well as the instructions for using the current scripts.\nNote: Before using the scripts/code detailed below, ensure that all filepaths used are in your MATLAB path collection. These may include:\n\nThe location where the automatic scripts are stored (for our lab, this is under /Data Processing/6. MATLAB EEG Pipeline)\nThe location where the HAPPE pre-processing script is stored\nThe location of the raw data (to be processed)\nThe location(s) of any intermediate files for processing (e.g., the updated .mff files that contain accuracy information in FishShark)\nThe location(s) for any files outputted by HAPPE and/or places you wish to use the script to move them to\n\nTo add a file path, click on Home/Set Path/Add Folder in MATLAB. You don’t need to specify the file name, just its containing folder.",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#oddball-processing-pipeline",
    "href": "eegERP.html#oddball-processing-pipeline",
    "title": "EEG and ERP Processing and Analysis",
    "section": "",
    "text": "1a - Files for HAPPE\n1b - Manual Processing\n2 - Processed Files\n3 - Files for PCA\n4 - EPT Averages\n5 - PCA\n6 - PCA Components\n\nThe following section describes the MATLAB scripts used to manage HAPPE output files for the Oddball task data. If you are running HAPPE manually (i.e., without integrating these scripts), skip to the Oddball HAPPE inputs section.\n\nOpen the eegProccessingOddball.m file (accessible via Git here) in MATLAB\nUpdate all thresholds and filepaths in script file (must be done BEFORE running the script)\n\nIn the second section of our script file, we set our “threshold” for the minimum number of trials that need to be retained after pre-processing for a subject’s data to be eligible for PCA. Additional thresholds can also be set for things like number of channels retained, but these are not currently in use.\n\n% Set quality threshold parameters\ntrialCutoff = 10;\n\nWe also set environment variables with all of the filepaths that are relevant for managing HAPPE output files and tracking processed data. The following paths should be checked and updated as necessary to reflect the organization of processing on your computer.\n\n\npassPath is the location you wish to have files that meet or exceed the above-defined thresholds to be saved\n\nallPath is the location you wish to have ALL files outputted from HAPPE saved to (regardless of whether threshold is met or not)\n\nfailPath is the location you wish to have files that do not meet the above-defined thresholds to be copied to\n\n.mff files that do not meet threshold will be copied here as an indication that they should be processed manually to see if they meet threshold afterward\n\n\n\nsummPath is the location you wish to save the file that lists all files processed through HAPPE in the current batch\n\nWe currently use this to save the “processing log” to a location that all team members/computers have access to so it is easier to determine which files require processing when EEG data are not stored on a shared server\n\n\n\nmanPath is the location you wish to save the file that lists all files that do not meet the above-defined thresholds\n\nWe currently use this to save the “to process manually” list to a location that all team members/computers have access to so it is easier to determine which files require manual processing because the copied .mff file would not be acessible via our shared server\n\n\n\n\n\n% Set paths for file sorting\npassPath = 'V:\\Processing-Repo\\Folder Structure\\3 - Files for PCA'; %location for .txt output files\nallPath = 'V:\\Processing-Repo\\Folder Structure\\2 - Processed Files'; %location for all processed files to end up\nfailPath = 'V:\\Processing-Repo\\Folder Structure\\1b - Manual Processing'; %location to copy unsuccessful .mff to for manual process\n\n% Set path for processing summary\nsummPath = 'Z:\\Shared Server\\Study Folder\\Data Processing\\6. MATLAB EEG Pipeline\\Processed Data Logs';\n\n% Set path for summary of files to process manually \nmanPath = 'Z:\\Shared Server\\Study Folder\\Data Processing\\6. MATLAB EEG Pipeline\\Processing To Do\\Cases to Process Manually\\Lists of Cases by Batch';\n\nRun the HAPPE Pipeline\n\nThis first section is designed to rely on user input. Click “Run” on the MATLAB editor window with the file open to begin the process.\nA message will appear in the console prompting you to enter the filepath to the location of the HAPPE pre-processing file you wish to run\nOnce the path is entered, MATLAB will run the file\nNote: the filepath inputted should NOT be in quotes\n\n% Set path to HAPPE pre-processing script\nhappeRun = input('Enter the full path to the HAPPE pre-processing file:\\n&gt; ','s') ;\n\n% Call and run HAPPE pre-processing script\nrun(happeRun);\n\nEnter HAPPE inputs\n\nSee the following section for HAPPE user inputs for Oddball\n\n\n\nAfter the HAPPE inputs are entered, no more user interaction is required for the script to do its job. The HAPPE pipeline will run, and the remaining MATLAB code in the script file will evaluate the files outputted by HAPPE and move them to the appropriate locations based on this evaluation. See Oddball Post-HAPPE Steps for a detailed explanation of the code used to accomplish this.\n\n\nIf you are not using the MATLAB scripts described above, you must first open the HAPPE pipeline V4 script in MATLAB and click “Run”\n\nThis will be stored in the location to which you mapped the HAPPE Git repo (e.g. Documents/GitHub/HAPPE/1. pre-process/HAPPE_v4.m)\n\n\nUser Inputs\n\nEnter the path to the folder containing the dataset.\nSelect raw\n\nLoad pre-existing set of input parameter:\n\n\nN if this is your first time running data through the pipeline.\n\nY if you have decided on a set of parameters. Enter the path to the folder containing the input parameters.\n\n\nLow density data: N\n\nData type: task\n\nPerforming event-related potential (ERP) analysis: Y\n\nEnter the task onset tags\n\nTarget: tgt+\n\nFrequent: frq+\n\ndone\n\n\nDo multiple onset tags belong to a single condition? N\n\nFile format: 5\n\nAcquisition layout type: 2\n\nNumber of channels: 128\n\nDo you have additional type fields besides “code”? N\n\nSelect channels of interest: all\n\nFrequency of electrical noise in Hz: 60\n\nAre there any additional frequencies, (e.g., harmonics) to reduce? N\n\nLine Noise reduction method: notch\n\nLow cutoff: 59\n\nhigh cutoff: 61\n\n\n\nResample: N\n\nFilter\n\nLow Pass Cutoff: 30\n\nHigh Pass Cutoff: .1\n\n\n\nChoose a filter: fir\n\nBad Channel Detection: Y\n\n\nafter wavelet thresholding\n\n\nECGone: N\n\nWavelet Thresholding\n\ndefault\nThreshold rule: hard\n\n\n\nMuscIL: N\n\nSegmentation: Y\n\nStarting parameter for stimulus: -200\n\nEnding parameter for stimulus: 1000\n\nTask offset: 2\n\n\n\nBaseline Correction: Y\n\nBaseline Correction start: -200\n\nBaseline Correction end: 0\n\n\n\nInterpolation: Y\n\nSegment Rejection: Y\n\nSegment Rejection Method: amplitude\n\nminimum segment rejection threshold: -150\n\nmaximum segment rejection threshold: 150\n\nsegment rejection based on all channels or ROI: all\n\n\n\n\n\nRe-referencing: Y\n\nDoes your data contain a flatline or all zero reference channel? N\n\nre-referencing method: average\n\n\n\nSave format: 1\n\nVisualizations: N\n\nParameter file save name: default\n\n\n\n\nThis section details the actions performed by the MATLAB scripts once HAPPE is completed. These actions will take place automatically upon completion of the HAPPE pipeline. No user inputs or actions are necessary at this stage.\n\n\nExclude files that don’t have any output data from the dataset (containing filename and quality reports from HAPPE pipeline) that will be used to assess file quality\n\nThis step is important because “empty” files don’t play nicely with the code used to evaluate files that have some data in them (even if the data do not meet threshold)\nThis code relies on HAPPE’s quality data that remains in the MATLAB environment after the pipeline has finished.\n\n% Create a list of files that received some kind of error message\nnoTags = any(strcmp(dataQC, 'NO_TAGS'), 2);\noneRej = any(strcmp(dataQC, 'REJ_ONE_SEG'), 2);\nallRej = any(strcmp(dataQC, 'ALL_SEG_REJ'), 2);\nerror = any(strcmp(dataQC, 'ERROR'), 2);\nloadFail = any(strcmp(dataQC, 'LOAD_FAIL'), 2);\n\n% Combine filenames with quality data (for some reason, they are not automatically connected by HAPPE)\ndataQCNew = [FileNames', dataQC];\n\n% Remove all files in the above lists (those receiving errors) from the quality data\ndataQCNew(noTags | allRej | error | loadFail | oneRej, :) = [];\n\n% Create list of variable names for quality data\ndataQCnamesNew = [\"File\", dataQCnames];\n\n% Save the data as a table for ease of use in subsequent steps\nqcTable = cell2table(dataQCNew, 'VariableNames', dataQCnamesNew);\n\n\nIdentify the files that meet (or don’t meet) the threshold\n% Create a list of files (i.e., rows in the table) that meet threshold\nthresholdTest = qcTable.(\"Number_tgt+_Segs_Post-Seg_Rej\") &gt;= trialCutoff & qcTable.(\"Number_frq+_Segs_Post-Seg_Rej\") &gt;= trialCutoff;\n\n% Add a variable to the quality data table that include whether or not the file meet threshold\nqcTable.Test = thresholdTest;\n\n\nAdd an identifying variable to be used for data joining down the line\n\nThis variable is generated using its expected location in the file name (i.e., how many text characters “in” it is)\n\n% Generate IDs based on File variable\nidWaveQC = extractBefore(qcTable.File, 8);\n\n% Append ID variable to quality data\nqcTable.idWave = idWaveQC;\n\n\nCreate a subsetted dataset conataining only the idWave, file name, and “test results” (i.e., whether a given file meets the specified cutoff threshold for inclusion) variables\n% Subset to ID and threshold information\ntestInfo = qcTable(:, [\"idWave\", \"File\", \"Test\"]);\n\nfprintf('Assessment Complete \\n');\n\n\nGenerate a list of files outputted by HAPPE\n% Generate path for HAPPE pre-processing output (using the HAPPE environment variable from user's input of location of raw data for processing)\ninputPath = strcat(srcDir, \"\\5 - processed\");\n\n% Read in list of files outputted from HAPPE \npreprocessingOutput = dir(inputPath);\n\n% Remove \"empty\" rows \npreprocessingOutput = preprocessingOutput(~ismember({preprocessingOutput.name}, {'.', '..'}));\n\n% Save data as a table for ease of later use\npreprocessingOutput = struct2table(preprocessingOutput);\n\n% Subset to file info\nfileInfo = preprocessingOutput(:, [\"name\", \"folder\"]);\n\n\nSelect only desired files to be moved/copied\n\nCurrently, we don’t do anything with the “Individual Trial” files outputted by HAPPE. These files are quite large and take a long time to move, so it is more efficient to just remove them from the list of filenames and not worry about moving them anywhere.\n\n% Subset to desired files (AveOverTrial)\nfileSubset = fileInfo(contains(fileInfo.name, \"AveOverTrials\"), :);\n\n\nAdd condition, ID, and threshold-related variables to the file data\n\nNOTE: The value for Condition variable (i.e., “Target” or “Frequent”) should match the name of the condition-specific folders you wish the files to save to within the processing repo.\n\n% Generate list of IDs based on file name variable\nidWaveFS = extractBefore(fileSubset.name, 8);\n\n% Add ID list to file data\nfileSubset.idWave = idWaveFS;\n\n% Generate list of files belonging to each condition based on file name variable\ntarget = contains(fileSubset.name, \"tgt+\");\nfrequent = contains(fileSubset.name, \"frq+\");\n\n% Create empty variable for condition\nfileSubset.cond = cell(size(fileSubset, 1), 1);\n\n% Fill in condition variable based on the lists generated above\nfileSubset.cond(target) = {'Target'};\nfileSubset.cond(frequent) = {'Frequent'};\nfileSubset.cond(~target & ~frequent) = {'All'};\n\n% Join threshold test information\nfileTest = join(fileSubset, testInfo);\n\n\nPrepare data table with information about files that met the threshold\n\nThe data generated here are preparing to copy the .txt files outputted by HAPPE into a folder containing all files that are suitable for PCA\n\n% Create a separate table for only files that meet threshold\nmovingInfo = fileTest(fileTest.Test, :);\n\n% Create empty columns for filepath variables\nmovingInfo.destination = cell(size(movingInfo, 1), 1);\nmovingInfo.origin = cell(size(movingInfo, 1), 1);\nmovingInfo.processedTo = cell(size(movingInfo, 1), 1);\nmovingInfo.processedFrom = cell(size(movingInfo, 1), 1);\n\n% Generate file paths based on condition \nmovingInfo.destination = strcat({passPath}, \"\\\", movingInfo.cond, \"\\\", movingInfo.name);\nmovingInfo.origin = strcat(movingInfo.folder, \"\\\", movingInfo.name);\nmovingInfo.processedTo = strcat({allPath}, \"\\\", movingInfo.name);\nmovingInfo.processedFrom = strcat(movingInfo.folder, \"\\\", movingInfo.name);\n\n\nPrepare data table with information about files that do NOT meet the threshold\n\nThe data generated here are preparing to copy .mff files from the location of the raw files into a folder indicating the need for manual processing\n\n% Create a separate table for only files that did not meet threshold\nfailFiles = fileTest(~fileTest.Test, [\"File\", \"folder\", \"name\"]);\n\n% Create empty columns for filepath variables\nfailFiles.destination = cell(size(failFiles, 1), 1);\nfailFiles.origin = cell(size(failFiles, 1), 1);\nfailFiles.processedTo = cell(size(failFiles, 1), 1);\nfailFiles.processedFrom = cell(size(failFiles, 1), 1);\n\n% Generate filepaths based on ID and task\nfailFiles.destination = strcat({failPath}, \"\\\", failFiles.File);\nfailFiles.origin = strcat({srcDir}, \"\\\", failFiles.File);\nfailFiles.processedFrom = strcat(failFiles.folder, \"\\\", failFiles.name);\nfailFiles.processedTo = strcat({allPath}, \"\\\", failFiles.name);\n\n\n\nGenerate environment variables that correspond to the column index of relevant variables for file sorting\n\nNote that the very last line of this code defines the varaible(s) to exclude from the HAPPE outputted files. This variable must be stripped from the data before saving them, because the presence of the extra variable makes the file incompatible with EP Toolkit’s PCA process.\n\n% Define column locations for each filepath variable\n\n% For files that meet threshold:\ntoCol = find(strcmp(movingInfo.Properties.VariableNames, \"destination\"));\nfromCol = find(strcmp(movingInfo.Properties.VariableNames, \"origin\"));\nprocColto = find(strcmp(movingInfo.Properties.VariableNames, \"processedTo\"));\nprocColfrom = find(strcmp(movingInfo.Properties.VariableNames, \"processedFrom\"));\n\n% For files that do not meet threshold\nrawCol = find(strcmp(failFiles.Properties.VariableNames, \"origin\"));\nmanCol = find(strcmp(failFiles.Properties.VariableNames, \"destination\"));\nfailProcColto = find(strcmp(failFiles.Properties.VariableNames, \"processedTo\"));\nfailProcColFrom = find(strcmp(failFiles.Properties.VariableNames, \"processedFrom\"));\n\n% Define variable to exclude\nextraVar = 'Time';\n\n\nUse a loop to process all files that met threshold\n\nFor each row in the “movingInfo” dataset, the loop will:\n\nIdentify the origin and destination paths\nRead in the HAPPE output file\nRemove the extra variable\nSave the “cleaned” data in the appropriate folder (without variable names, as required by EP Toolkit)\n\n\n\nfor row = 1:height(movingInfo)\n    % Specify path info\n    pathFrom = movingInfo{row, fromCol};\n    pathTo = movingInfo{row, toCol};\n    % Read in the data\n    rawTable = readtable(pathFrom);\n    % Remove extra column (Time)\n    cleanTable = rawTable{:, ~strcmp(rawTable.Properties.VariableNames, extraVar)};\n    % Save without headers\n    writematrix(cleanTable, pathTo, 'Delimiter', '\\t')\nend\n\n\n\nUse a loop to copy raw (.mff) files into a location that stores files requiring manual processing\nfor row = 1:height(failFiles)\n    % Specify path info\n    pathFrom = failFiles{row, rawCol};\n    pathTo = failFiles{row, manCol};\n    % Copy file \n    copyfile(pathFrom, pathTo)\nend\n\n\nUse a set of loops to copy all HAPPE output files into a folder intended to house all output (whether threshold is met or not)\nfor row = 1:height(movingInfo)\n    % Specify path info\n    pathFrom = movingInfo{row, procColfrom};\n    pathTo = movingInfo{row, procColto};\n    % Copy file\n    copyfile(pathFrom, pathTo);\nend\n\nfor row = 1:height(failFiles)\n    % Specify path info\n    pathFrom = failFiles{row, failProcColFrom};\n    pathTo = failFiles{row, failProcColto};\n    % Copy file\n    copyfile(pathFrom, pathTo);\nend\n\n\nGenerate a .txt file listing all processed .mff files\n\nThis file will contain a list of all raw files (e.g., 1111_22_oddball.mff) and save the list to the specified location (summPath)\nThe file will have the current date and time appended to the end so that it will be distinguishable from past logs\nThe list of processed files is generated using an environment object (FileNames) that the HAPPE pipeline creates that lists all files inputted to the pipeline\n\n% Create a table from HAPPE FileNames cell array\nprocessedList = cell2table(FileNames(:));\n\n% Rename file variable from default\nprocessedList = renamevars(processedList, {'Var1'}, {'File'});\n\n% Save current date as a string variable \ntoday = string(date());\n\n% Save time as a string variable, replacing \":\" with \"_\" so that file can be written \ntime = strrep(datestr(now, 'HH:MM:SS:FFF'), ':', \"_\");\n\n% Generate file name to include current date and time \nlistFile = strcat(\"\\oddballProcessed_\", today, \"_\", time);\n\n% Generate full path including file name\nsummPathFull = strcat(summPath, listFile);\n\n% Write table to specified location\nwritetable(processedList, summPathFull);\n\n\nGenerate a .txt file listing all of the files that did not meet threshold to go through subsequent processing\n\nThis file will contain a list of all raw files (e.g., 1111_22_oddball.mff) that did not meet threshold and save the list to the specified location (manPath)\nThe file will have the current date and time appended to the end so that it will be distinguishable from past lists\nThis list of file to process manually is generated using the environment object FileNames that HAPPE creates; any files listed in FileNames but not in the dataset of files that pass threshold make up the manualList\n\n\n% Compare movingInfo with FileNames to isolate files that don't meet threshold\nmanualList = cell2table(FileNames(~ismember(FileNames', movingInfo.File)));\nmanualList = renamevars(manualList, {'Var1'}, {'File'});\n\n% Generate file name to include current date\nmanFile = strcat(\"\\oddballManual_\", today, \"_\", time);\n\n% Generate full path including filename\nmanPathFull = strcat(manPath, manFile);\n\n% Write table to specified location\nwritetable(manualList, manPathFull);",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#fishshark-processing-pipeline",
    "href": "eegERP.html#fishshark-processing-pipeline",
    "title": "EEG and ERP Processing and Analysis",
    "section": "",
    "text": "0 - Raw\n1a - Files for HAPPE\n1b - Manual Processing\n2 - Processed Files\n3 - Files for PCA\n4 - EPT Averages\n5 - PCA\n6 - PCA Components\n\nThe following section describes the MATLAB scripts used to manage HAPPE input and output files for the FishShark task data. If you are running HAPPE manually (i.e., without integrating these scripts), skip to the FishShark HAPPE inputs section.\nThe first two steps described in this section are the same as those described for Oddball processing. Processing actions specific to FishSharks task begin in Step 3.\n\nOpen the eegProccessingFishshark.m file (accessible via Git here) in MATLAB\nUpdate all thresholds and filepaths in script file (must be done BEFORE running the script)\n\nIn the fifth section of our script file, we set our “threshold” for the minimum number of trials that need to be retained after pre-processing for a subject’s data to be eligible for PCA. Additional thresholds can also be set for things like number of channels retained, but these are not currently in use.\nNote that setting these parameters occurs later in the FishSharks script than the one for Oddball; this is because FishSharks files require additional processing before they are ready for HAPPE (see step 3 for details)\n\n% Set quality threshold parameters\ntrialCutoff = 10;\n\nWe also set environment variables with all of the filepaths that are relevant for managing HAPPE output files and tracking processed data. The following paths should be checked and updated as necessary to reflect the organization of processing on your computer.\n\n\npassPath is the location you wish to have files that meet or exceed the above-defined thresholds to be saved\n\nallPath is the location you wish to have ALL files outputted from HAPPE saved to (regardless of whether threshold is met or not)\n\nfailPath is the location you wish to have files that do not meet the above-defined thresholds to be copied to\n\n.mff files that do not meet threshold will be copied here as an indication that they should be processed manually to see if they meet threshold afterward\n\n\n\nsummPath is the location you wish to save the file that lists all files processed through HAPPE in the current batch\n\nWe currently use this to save the “processing log” to a location that all team members/computers have access to so it is easier to determine which files require processing when EEG data are not stored on a shared server\n\n\n\nmanPath is the location you wish to save the file that lists all files that do not meet the above-defined thresholds\n\nWe currently use this to save the “to process manually” list to a location that all team members/computers have access to so it is easier to determine which files require manual processing because the copied .mff file would not be acessible via our shared server\n\n\n\n\n\n% Set paths for file sorting\npassPath = 'V:\\Processing-Repo\\Folder Structure\\3 - Files for PCA'; %location for .txt output files\nallPath = 'V:\\Processing-Repo\\Folder Structure\\2 - Processed Files'; %location for all processed files to end up\nfailPath = 'V:\\Processing-Repo\\Folder Structure\\1b - Manual Processing'; %location to copy unsuccessful .mff to for manual process\n\n% Set path for processing summary\nsummPath = 'Z:\\Shared Server\\Study Folder\\Data Processing\\6. MATLAB EEG Pipeline\\Processed Data Logs';\n\n% Set path for summary of files to process manually \nmanPath = 'Z:\\Shared Server\\Study Folder\\Data Processing\\6. MATLAB EEG Pipeline\\Processing To Do\\Cases to Process Manually\\Lists of Cases by Batch';\n\nUpdate raw (.mff) files’ condition tags with accuracy information\n\nUnlike the Passive Oddball task, FishSharks trials can be either correct or incorrect. Whether or not a trial was “responded to” correctly is relevant to the nature of the extracted ERP. Because the event tags in our .mff files do not inherently contain information about whether each trial was responded to correctly, we need to add it ourselves. This process can be done manually in NetStation, but it can also be automated using the MATLAB code detailed below.\nNOTE: This code requires eeglab. Before running the code, open eeglab in your MATLAB session by typing eeglab into the console. You can close it as soon as it opens, but this step ensures that eeglab is loaded into your current session and helps prevent the subsequent code from erroring out.\n\n\n\nSet the filepaths for raw and updated .mff files\n\nThis section is set to rely on user inputs. Click “Run” in the MATLAB editor to start the processing.\nA message will appear in the console prompting you to enter two filepaths: the first is the location of the raw .mff files, and the second is the location you would like the updated files to save in.\nNote: the filepaths inputted should NOT be in quotes\n\n% User input for location of raw files\npathRaw = input('Enter the full path to the folder containing the raw files:\\n&gt; ','s');\n\n% User input for destination of subsetted files\npathSub = input('Enter the full path to the folder in which to save the updated files:\\n&gt; ','s');\nAt this point, there will be no user input/actions necessary until all of the .mff files in the pathRaw directory have been updated and saved into the pathSub directory. The code that asks the user for the path to HAPPE will run when that process has finished. The following section will describe the code used to automate the process of updating .mff event tags to include accuracy information at the trial level. Move on to Step 4 (Run the HAPPE Pipeline) when the process has completed.\n\n\nGather and manage information from the directory housing the raw (.mff) files\n% Have MATLAB gather a list of raw files housed in specified location (pathRaw)\ndirInfo = struct2table(dir(pathRaw));\n\n% Remove blank rows\nnoName = strcmp(dirInfo.name, '.') | strcmp(dirInfo.name, '..');\ndirInfo(noName, :) = [];\n\n\nGenerate variables necessary for managing raw and updated files\n\nThis code will generate the full filepaths (including file name) necessary for reading in each .mff file and saving its updated counterpart\nIt will also generate an ID variable for joining purposes based on the expected location of the subject name in the name of each file\n\n% Generate ID variable\ndataFiles = dirInfo(:, \"name\");\n\n% Add ID variable to file data\ndataFiles.ID = extractBefore(dataFiles.name, 8);\n\n% Generate path to read raw data\nrawPaths = dataFiles;\nrawPaths.path = strcat({pathRaw}, \"/\", dirInfo.name);\nrawPaths = rawPaths(:, [\"ID\", \"path\"]);\n\n% Generate path to save updated versions of the data (containing accuracy info at trial level)\nsubPaths = dataFiles;\nsubPaths.path = strcat({pathSub}, \"/\", subPaths.ID, \"_sub_fishshark.mff\");\nsubPaths = subPaths(:, [\"ID\", \"path\"]);\n\n% Join filepath datatables\nmergePaths = join(rawPaths, subPaths, 'Keys', {'ID'})\n\n\nUse a loop to update the event tags in each .mff file to reflect accuracy of response\n\nFor every file included in the mergePaths dataset, MATLAB will perform the following actions:\n\nSet environment variables representing the path to read in the original .mff file and save its updated counterpart (updates with each iteration of the loop)\nRead in the .mff file\nExtract the “event” information from the .mff file\nEvaluate whether there is usable data in the file\n\nThis step prevents the code from erroring out if a subject did not make it past the practice trials\nIf the evaluation determines that there is NOT usable data in the present file, the loop will jump to the next file\n\n\nCreate a table containing response information (response vs no response and reaction time) and condition information (go vs no-go) at the trial level\nEvaluate each trial to determine whether the response was correct or incorrect\n\nFor No-Go trials, responses are CORRECT if there was no response (incorrect if subject did respond)\nFor Go trials, responses are CORRECT if there was a response AND subject’s reaction time was at least 200 ms (incorrect if subject did not respond OR if subject responded too quickly for response to be considered “valid”)\n\n\nUpdate the event tags in the .mff file to contain a “c” for correct trials and an “x” for incorrect trials\n\nThe c/x indicator will be appended to the front of the existing event tag (e.g., Go++ will become cGo++)\n\n\nExport an updated version of the .mff file with accuracy information to the specified location (pathSub)\n\nNOTE: When exporting EEG data from MATLAB, it is absolutely necessary for the data to be organized in order of event latency. If the rows are out of order, latency errors may be introduced.\n\nCorrect row order can be achieved in .mff filetypes by sorting according to either the latency column or the urevent column (as shown below)\n\n\n\nfor row = 1:height(mergePaths)\n    % Specify paths\n    rawFolder = mergePaths{row, \"path_rawPaths\"}\n    subFolder = mergePaths{row, \"path_subPaths\"}\n\n    % Read in EEG data\n    EEGraw = pop_mffimport(char(rawFolder), 'code')\n\n    % Create table from \"event\" field of raw data\n    EEGevent = struct2table(EEGraw.event)\n\n    % Check for the existence of usable rows\n    checkVars = strcmp(EEGevent.Properties.VariableNames, 'mffkey_cel')\n\n    % Skip files without necessary variables\n    if max(checkVars) == 0\n        continue\n    end\n\n    % Create table without practice/training trials\n    keepRows = strcmp(EEGevent.mffkey_cel, '4')\n    EEGsub  = EEGevent(keepRows, :)\n\n    % Check for the existence of usable rows\n    checkRows = max(keepRows)\n\n    % Skip files with no usable rows\n    if checkRows == 0\n        continue\n    end\n\n    % Get response info at trial level\n    EEGresp = table(EEGsub.mffkey_obs, EEGsub.mffkey_eval, EEGsub.mffkey_rtim)\n    EEGresp = rmmissing(EEGresp)\n    EEGresp = renamevars(EEGresp, [\"Var1\", \"Var2\", \"Var3\"], [\"Trial\", \"Eval\", \"RTime\"])\n\n    % Get condition info at trial level\n    EEGconds = table(EEGsub.mffkey_obs, EEGsub.type)\n    EEGconds = renamevars(EEGconds, [\"Var1\", \"Var2\"], [\"Trial\", \"Cond\"])\n    keepConds = strcmp(EEGconds.Cond, 'Go++') | strcmp(EEGconds.Cond, 'NG++')\n    EEGcond = EEGconds(keepConds, :)\n\n    % Merge datasets\n    EEGtrials = join(EEGcond, EEGresp)\n\n    EEGtrials.RTime = cellfun(@str2num, EEGtrials.RTime)\n    % Evaluate trials for correct-ness of response\n    correct = strcmp(EEGtrials.Cond, 'Go++') & strcmp(EEGtrials.Eval, '1') & EEGtrials.RTime &gt; 200 | strcmp(EEGtrials.Cond, 'NG++') & strcmp(EEGtrials.Eval, '0')\n    EEGtrials.Acc = correct\n\n\n    % Create new code tags including accuracy information\n    EEGtrials.newCode(EEGtrials.Acc & strcmp(EEGtrials.Cond, 'Go++')) = {'cGo++'}\n    EEGtrials.newCode(~EEGtrials.Acc & strcmp(EEGtrials.Cond, 'Go++')) = {'xGo++'}\n    EEGtrials.newCode(EEGtrials.Acc & strcmp(EEGtrials.Cond, 'NG++')) = {'cNG++'}\n    EEGtrials.newCode(~EEGtrials.Acc & strcmp(EEGtrials.Cond, 'NG++')) = {'xNG++'}\n\n    % Subset information for merge\n    EEGmerge = EEGtrials(:, {'Trial', 'Cond', 'newCode'})\n\n    % Prep key in original data\n    EEGevent.key = strcat(EEGevent.mffkey_obs, EEGevent.type)\n\n    % Prep key in merge data\n    EEGmerge.key = strcat(EEGmerge.Trial, EEGmerge.Cond)\n    EEGmerge = EEGmerge(:, {'key', 'newCode'})\n\n    % Merge new codes with event table\n    EEGnew = outerjoin(EEGevent, EEGmerge)\n\n    % Replace codes where new code is needed\n    EEGnew.code(~strcmp(EEGnew.newCode, '')) = EEGnew.newCode(~strcmp(EEGnew.newCode, ''))\n    EEGnew.type(~strcmp(EEGnew.newCode, '')) = EEGnew.newCode(~strcmp(EEGnew.newCode, ''))\n\n    % Arrange table in order of event (CRUCIAL for correct export)\n    EEGnew = sortrows(EEGnew, 'urevent')\n\n    % Convert table back to struct and restore original dimensions\n    EEGnew = table2struct(EEGnew(:, 1:29))\n    EEGnew = reshape(EEGnew, [1, height(EEGnew)])\n\n    % Replace event table(s) in original struct\n    EEGraw.event = EEGnew\n    EEGraw.urevent = table2struct(struct2table(EEGnew(:, 1:28)))\n\n    % Export updated file\n    pop_mffexport(EEGraw, char(subFolder))\nend \n\n\n\nRun the HAPPE Pipeline\n\nThis section is designed to rely on user input.\nWhen the prior steps have finsihed, a message will appear in the console prompting you to enter the filepath to the location of the HAPPE pre-processing file you wish to run\nOnce the path is entered, MATLAB will run the file\nNote: the filepath inputted should NOT be in quotes\n\n% Set path to HAPPE pre-processing script\nhappeRun = input('Enter the full path to the HAPPE pre-processing file:\\n&gt; ','s') ;\n\n% Call and run HAPPE pre-processing script\nrun(happeRun);\n\nEnter HAPPE inputs\n\nSee the following section for HAPPE inputs for the Fish/Shark task\n\n\n\nAfter the HAPPE inputs are entered, no more user interaction is required for the script to do its job. The HAPPE pipeline will run, and the remaining MATLAB code in the script file will evaluate the files outputted by HAPPE and move them to the appropriate locations based on this evaluation. See FishShark Post-HAPPE Steps for a detailed explanation of the code used to accomplish this.\n\n\nIf you are not using the MATLAB scripts described above, you must first open the HAPPE pipeline V4 script in MATLAB and click “Run”\n\nThis will be stored in the location to which you mapped the HAPPE Git repo (e.g. Documents/GitHub/HAPPE/1. pre-process/HAPPE_v4.m)\n\n\nUser Inputs\n\nEnter the path to the folder containing the dataset.\nSelect raw\n\nLoad pre-existing set of input parameter:\n\n\nN if this is your first time running data through the pipeline.\n\nY if you have decided on a set of parameters. Enter the path to the folder containing the input parameters.\n\n\nLow density data: N\n\nData type: task\n\nPerforming event-related potential (ERP) analysis: Y\n\nEnter the task onset tags\n\nCorrect Go: cGo++\n\nIncorrect Go: xGo++\n\nCorrect NoGo: cNG++\n\nIncorrect NoGo: xNG++\n\ndone\n\n\nDo multiple onset tags belong to a single condition? N\n\nFile format: 5\n\nAcquisition layout type: 2\n\nNumber of channels: 128\n\nDo you have additional type fields besides “code”? N\n\nSelect channels of interest: all\n\nFrequency of electrical noice in Hz: 60\n\nAre there any additional frequencies, (e.g., harmonics) to reduce? N\n\nLine Noise reduction method: notch\n\nLow cutoff: 59\n\nhigh cutoff: 61\n\n\n\nResample: N\n\nFilter\n\nLow Pass Cutoff: 30\n\nHigh Pass Cutoff: .1\n\n\n\nChoose a filter: fir\n\nBad Channel Detection: Y\n\n\nafter wavelet thresholding\n\n\nECGone: N\n\nWavelet Thresholding\n\ndefault\nThreshold rule: hard\n\n\n\nMuscIL: N\n\nSegmentation: Y\n\nStarting parameter for stimulus: -200\n\nEnding parameter for stimulus: 1000\n\nTask offset: 17\n\n\n\nBaseline Correction: Y\n\nBaseline Correction start: -200\n\nBaseline Correction end: 0\n\n\n\nInterpolation: Y\n\nSegment Rejection: Y\n\nSegment Rejection Method: amplitude\n\nminimum segment rejection threshold: -150\n\nmaximum segment rejection threshold: 150\n\nsegment rejection based on all channels or ROI: all\n\n\n\n\n\nRe-referencing: Y\n\nDoes your data contain a flatline or all zero reference channel? N\n\nre-referencing method: average\n\n\n\nSave format: 1\n\nVisualizations: N\n\nParameter file save name: default\n\n\n\n\nThis section details the actions performed by the MATLAB scripts once HAPPE is completed. These actions will take place automatically upon completion of the HAPPE pipeline. No user inputs or actions are necessary at this stage.\n\n\nExclude files that don’t have any output data from the dataset (containing filename and quality reports from HAPPE pipeline) that will be used to assess file quality\n\nThis step is important because “empty” files don’t play nicely with the code used to evaluate files that have some data in them (even if the data do not meet threshold)\nThis code relies on HAPPE’s quality data that remains in the MATLAB environment after the pipeline has finished.\n\n% Create a list of files that received some kind of error message\nnoTags = any(strcmp(dataQC, 'NO_TAGS'), 2);\nallRej = any(strcmp(dataQC, 'ALL_SEG_REJ'), 2);\noneRej = any(strcmp(dataQC, 'REJ_ONE_SEG'), 2);\nerror = any(strcmp(dataQC, 'ERROR'), 2);\nloadFail = any(strcmp(dataQC, 'LOAD_FAIL'), 2);\n\n% Combine filenames with quality data (for some reason, they are not automatically connected by HAPPE)\ndataQCNew = [FileNames', dataQC];\n\n% Remove all files in the above lists (those receiving errors) from the quality data\ndataQCNew(noTags | allRej | error | loadFail | oneRej, :) = [];\n\n% Create list of variable names for quality data\ndataQCnamesNew = [\"File\", dataQCnames];\n\n% Save the data as a table for ease of use in subsequent steps\nqcTable = cell2table(dataQCNew, 'VariableNames', dataQCnamesNew);\n\n% Subset to ID and threshold information\ntestInfo = qcTable(:, [\"idWave\", \"File\", \"Test\"]);\n\n\nIdentify the files that meet (or don’t meet) the threshold\n% Create a list of files (i.e., rows in the table) that meet threshold\nthresholdTest = qcTable.(\"Number_cNG++_Segs_Post-Seg_Rej\") &gt;= trialCutoff & qcTable.(\"Number_cGo++_Segs_Post-Seg_Rej\") &gt;= trialCutoff;\n\n% Add a variable to the quality data table that include whether or not the file meet threshold\nqcTable.Test = thresholdTest;\n\n\nAdd an identifying variable to be used for data joining down the line\n\nThis variable is generated using its expected location in the file name (i.e., how many text characters “in” it is)\n\n% Generate IDs based on File variable\nidWaveQC = extractBefore(qcTable.File, 8);\n\n% Append ID variable to quality data\nqcTable.idWave = idWaveQC;\n\n\nCreate a subsetted dataset conataining only the idWave, file name, and “test” results (i.e., whether a given file meets the specified cutoff threshold for inclusion)\n% Subset to ID and threshold information\ntestInfo = qcTable(:, [\"idWave\", \"File\", \"Test\"]);\n\nfprintf('Assessment Complete \\n');\n\n\nGenerate a list of files outputted by HAPPE\n% Generate path for HAPPE pre-processing output (using the HAPPE environment variable from user's input of location of raw data for processing)\ninputPath = strcat(srcDir, \"\\5 - processed\");\n\n% Read in list of files outputted from HAPPE \npreprocessingOutput = dir(inputPath);\n\n% Remove \"empty\" rows \npreprocessingOutput = preprocessingOutput(~ismember({preprocessingOutput.name}, {'.', '..'}));\n\n% Save data as a table for ease of later use\npreprocessingOutput = struct2table(preprocessingOutput);\n\n% Subset to file info\nfileInfo = preprocessingOutput(:, [\"name\", \"folder\"]);\n\n\nSelect only desired files to be moved/copied\n\nCurrently, we don’t do anything with the “Individual Trial” files outputted by HAPPE. These files are quite large and take a long time to move, so it is more efficient to just remove them from the list of filenames and not worry about moving them anywhere.\n\n% Subset to desired files (AveOverTrial)\nfileSubset = fileInfo(contains(fileInfo.name, \"AveOverTrials\"), :);\n\n\nAdd condition, ID, and threshold-related variables to the file data\n\nNOTE: The value for Condition variable (i.e., “cGo” or “cNoGo”) should match the name of the condition-specific folders you wish the files to save to within the processing repo.\n\n% Generate list of IDs based on file name variable\nidWaveFS = extractBefore(fileSubset.name, 8);\n\n% Add ID list to file data\nfileSubset.idWave = idWaveFS;\n\n% Generate list of files belonging to each condition based on file name variable\ncGo = contains(fileSubset.name, \"cGo++\");\ncNoGo = contains(fileSubset.name, \"cNG++\");\nxGo = contains(fileSubset.name, \"xGo++\");\nxNoGo = contains(fileSubset.name, \"xNG++\");\n\n% Create empty variable for condition\nfileSubset.cond = cell(size(fileSubset, 1), 1);\n\n% Fill in condition variable based on the lists generated above\nfileSubset.cond(cGo) = {'cGo'};\nfileSubset.cond(cNoGo) = {'cNoGo'};\nfileSubset.cond(xGo) = {'xGo'};\nfileSubset.cond(xNoGo) = {'xNoGo'};\nfileSubset.cond(~cGo & ~cNoGo & ~xGo & ~xNoGo) = {'All'};\n\n% Join threshold test information\nfileTest = join(fileSubset, testInfo);\n\n\nPrepare data table with information about files that met the threshold\n\nThe data generated here are preparing to copy the .txt files outputted by HAPPE into a folder containing all files that are suitable for PCA\n\n% Create a separate table for only files that meet threshold\nmovingInfo = fileTest(fileTest.Test, :);\n\n% Create empty columns for filepath variables\nmovingInfo.destination = cell(size(movingInfo, 1), 1);\nmovingInfo.origin = cell(size(movingInfo, 1), 1);\nmovingInfo.processedTo = cell(size(movingInfo, 1), 1);\nmovingInfo.processedFrom = cell(size(movingInfo, 1), 1);\n\n% Generate file paths based on condition \nmovingInfo.destination = strcat({passPath}, \"\\\", movingInfo.cond, \"\\\", movingInfo.name);\nmovingInfo.origin = strcat(movingInfo.folder, \"\\\", movingInfo.name);\nmovingInfo.processedTo = strcat({allPath}, \"\\\", movingInfo.name);\nmovingInfo.processedFrom = strcat(movingInfo.folder, \"\\\", movingInfo.name);\n\n\nPrepare data table with information about files that do NOT meet the threshold\n\nThe data generated here are preparing to copy .mff files from the location of the raw files into a folder indicating the need for manual processing\n\n% Create a separate table for only files that did not meet threshold\nfailFiles = fileTest(~fileTest.Test, [\"File\", \"folder\", \"name\"]);\n\n% Create empty columns for filepath variables\nfailFiles.destination = cell(size(failFiles, 1), 1);\nfailFiles.origin = cell(size(failFiles, 1), 1);\nfailFiles.processedTo = cell(size(failFiles, 1), 1);\nfailFiles.processedFrom = cell(size(failFiles, 1), 1);\n\n% Generate filepaths based on ID and task\nfailFiles.destination = strcat({failPath}, \"\\\", failFiles.File);\nfailFiles.origin = strcat({srcDir}, \"\\\", failFiles.File);\nfailFiles.processedFrom = strcat(failFiles.folder, \"\\\", failFiles.name);\nfailFiles.processedTo = strcat({allPath}, \"\\\", failFiles.name);\n\n\n\nGenerate environment variables that correspond to the column index of relevant variables for file sorting\n\nNote that the very last line of this code defines the varaible(s) to exclude from the HAPPE outputted files. This variable must be stripped from the data before saving them, because the presence of the extra variable makes the file incompatible with EP Toolkit’s PCA process.\n\n% Define column locations for each filepath variable\n\n% For files that meet threshold:\ntoCol = find(strcmp(movingInfo.Properties.VariableNames, \"destination\"));\nfromCol = find(strcmp(movingInfo.Properties.VariableNames, \"origin\"));\nprocColto = find(strcmp(movingInfo.Properties.VariableNames, \"processedTo\"));\nprocColfrom = find(strcmp(movingInfo.Properties.VariableNames, \"processedFrom\"));\n\n% For files that do not meet threshold\nrawCol = find(strcmp(failFiles.Properties.VariableNames, \"origin\"));\nmanCol = find(strcmp(failFiles.Properties.VariableNames, \"destination\"));\nfailProcColto = find(strcmp(failFiles.Properties.VariableNames, \"processedTo\"));\nfailProcColFrom = find(strcmp(failFiles.Properties.VariableNames, \"processedFrom\"));\n\n% Define variable to exclude\nextraVar = 'Time';\n\n\nUse a loop to process all files that met threshold\n\nFor each row in the “movingInfo” dataset, the loop will:\n\nIdentify the origin and destination paths\nRead in the HAPPE output file\nRemove the extra variable\nSave the “cleaned” data in the appropriate folder (without variable names, as required by EP Toolkit)\n\n\n\nfor row = 1:height(movingInfo)\n    % Specify path info\n    pathFrom = movingInfo{row, fromCol};\n    pathTo = movingInfo{row, toCol};\n    % Read in the data\n    rawTable = readtable(pathFrom);\n    % Remove extra column (Time)\n    cleanTable = rawTable{:, ~strcmp(rawTable.Properties.VariableNames, extraVar)};\n    % Save without headers\n    writematrix(cleanTable, pathTo, 'Delimiter', '\\t')\nend\n\n\n\nUse a loop to copy raw (.mff) files into a location that stores files requiring manual processing\nfor row = 1:height(failFiles)\n    % Specify path info\n    pathFrom = failFiles{row, rawCol};\n    pathTo = failFiles{row, manCol};\n    % Copy file \n    copyfile(pathFrom, pathTo)\nend\n\n\nUse a set of loops to copy all HAPPE output files into a folder intended to house all output (whether threshold is met or not)\nfor row = 1:height(movingInfo)\n    % Specify path info\n    pathFrom = movingInfo{row, procColfrom};\n    pathTo = movingInfo{row, procColto};\n    % Copy file\n    copyfile(pathFrom, pathTo);\nend\n\nfor row = 1:height(failFiles)\n    % Specify path info\n    pathFrom = failFiles{row, failProcColFrom};\n    pathTo = failFiles{row, failProcColto};\n    % Copy file\n    copyfile(pathFrom, pathTo);\nend\n\n\nGenerate a .txt file listing all processed .mff files\n\nThis file will contain a list of all raw files (e.g., 1111_22_fishshark.mff) and save the list to the specified location (summPath)\nThe file will have the current date and time appended to the end so that it will be distinguishable from past logs\nThe list of processed files is generated using an environment variable that the HAPPE pipeline creates that lists all files inputted to the pipeline\n\n% Create a table from HAPPE FileNames cell array\nprocessedList = cell2table(FileNames(:));\n\n% Rename file variable from default\nprocessedList = renamevars(processedList, {'Var1'}, {'File'});\n\n% Save current date as a string variable \ntoday = string(date());\n\n% Save time as a string variable, replacing \":\" with \"_\" so that file can be written \ntime = strrep(datestr(now, 'HH:MM:SS:FFF'), ':', \"_\");\n\n% Generate file name to include current date and time \nlistFile = strcat(\"\\oddballProcessed_\", today, \"_\", time);\n\n% Generate full path including file name\nsummPathFull = strcat(summPath, listFile);\n\n% Write table to specified location\nwritetable(processedList, summPathFull);\n\n\nGenerate a .txt file listing all of the files that did not meet threshold to go through subsequent processing\n\nThis file will contain a list of all raw files (e.g., 1111_22_fishshark.mff) that did not meet threshold and save the list to the specified location (manPath)\nThe file will have the current date and time appended to the end so that it will be distinguishable from past lists\nThis list of file to process manually is generated using the environment object FileNames that HAPPE creates; any files listed in FileNames but not in the dataset of files that pass threshold make up the manualList\n\n\n% Compare movingInfo with FileNames to isolate files that don't meet threshold\nmanualList = cell2table(FileNames(~ismember(FileNames', movingInfo.File)));\nmanualList = renamevars(manualList, {'Var1'}, {'File'});\n\n% Generate file name to include current date\nmanFile = strcat(\"\\fishSharkManual_\", today, \"_\", time);\n\n% Generate full path including filename\nmanPathFull = strcat(manPath, manFile);\n\n% Write table to specified location\nwritetable(manualList, manPathFull);",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#sec-average",
    "href": "eegERP.html#sec-average",
    "title": "EEG and ERP Processing and Analysis",
    "section": "\n2.1 Reading Text Files into EP Toolkit",
    "text": "2.1 Reading Text Files into EP Toolkit\n\nOpen MATLAB with “Run as Administrator”\nOpen ERP PCA Toolkit in MATLAB\n\nType ep in command prompt\n\n\nClick Read to import files\nUse the following options\n\nFormat = text (.txt)\n\nType = average\n\nMont = Adult Hydrocel 128-channel 1.0\n\n\n\nSelect Single File Mode.\n\nSingle file mode will use the filename to assign the task condition and participant ID for each file. Thus, it is critical to use a standard naming convention to name the files.\n\nFor example, an oddball file could be named: 1001_36_oddball_processed_AveOverTrials_tgt+.txt\n\nA FishSharks file meanwhile could be named: 1004_36_oddball_processed_AveOverTrials_cGo++.txt\n\n\nNote: The filename examples above reflect the automated naming convention of the files outputted by the HAPPE pipeline. If another processing pipeline is used or if the naming conventions become unstandardized, it is crucial that standardization of filenames is implemented\n\n\n\n\n\nIn the Single File Mode menu use the Subject field to denote which characters in the filename name will determine the participant ID.\n\nFor the above example 1:7 would correspond to 1001_36 in a file called 1001_36_oddball_processed_AveOverTrials_tgt+.txt (outputted by HAPPE)\n\n\nNext, In the Single File Mode menu use the Cell field to denote which characters in the file name will determine the task condition.\n\nFor the below example 41:43 would correspond to frq or tgt in a file called 1001_36_oddball_processed_AveOverTrials_tgt+.txt\n\nFor FishSharks files, it might be 47:49 that correspond to cgo or cng.\n\n\n\nSelect Read. You will be asked to name the aggregate file created by importing and combining the single files. Use the convention “task_condition_age” to name the file (e.g., ob_tgt_54)\nA new window will open prompting you to select the files you wish to import. Navigate to the folder housing the data to be imported (e.g., 3 - Files for PCA\\Target) and use Ctrl + A to select all files in that folder. Click Open once all desired files are selected\nSelect the 2_9AverageNet128.ced file when prompted by another popup. This file corresponds to the electrode template associated with the participant age range and type of net represented in the data\n\nFor our study using a 128-channel net on children aged 3-7, the 2_9AverageNet128.ced template is most appropriate \n\n\n\nThe new file will have the participant ID and will combine the conditions for each participant.\n\nSubject Names: \n\nTask Conditions",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#update-file-with-experiment-information",
    "href": "eegERP.html#update-file-with-experiment-information",
    "title": "EEG and ERP Processing and Analysis",
    "section": "\n2.2 Update File with Experiment Information",
    "text": "2.2 Update File with Experiment Information\n\nGo to Main and click Edit\n\nClick on the file you imported\nIn Overview, add the following information:\n\nExperiment Name: Oddball, FishShark, or StopSignal\n\nReference Type: change to average reference\n\nPrestimulus period: change to 200\n\nNominal sampling rate: change to 1000\n\n\n\nClick Done\n\nGo to Main and click Save\n\nSave the combined file as an .ept file in the 4-EPT Averages folder using the following naming convention: “task_condition_age”. For example, if you were working on the target condition of oddball for all age groups, you would save the file as ob_tgt_all",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#generating-grand-average-waveforms",
    "href": "eegERP.html#generating-grand-average-waveforms",
    "title": "EEG and ERP Processing and Analysis",
    "section": "\n2.3 Generating Grand Average Waveforms",
    "text": "2.3 Generating Grand Average Waveforms\n\nIf the EPT average file (e.g., ob_tgt_all) is not already in the working environment, read it in using the steps below\n\nGo to Read\n\nFormat = EP (.ept)\n\nClick Read\n\nNavigate to the 4 - EPT Averages folder and select desired file(s)\nClick Open in the browser window to read the file(s)\nClick Main to return to main menu\n\n\nSelect Edit\n\nWhen the editor window opens, navigate to the Subjects pane\nSelect All from among the many options along the lefthand pane of the editor\n\nThis will select all of the subjects included in the file and assign them a weight of 1\n\n\nConfirm that all subjects have been selected (look for a checked box in the subject row) and that all weights have been set to 1\nClick Add\n\nA new “subject” should have now been added to the bottom of the subjects list\n\nThis subject is called gave and represents the grand average across all subjects\n\n\nClick Done to exit the editor window, then Main to return to the EP Toolkit home",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#sec-tPCA",
    "href": "eegERP.html#sec-tPCA",
    "title": "EEG and ERP Processing and Analysis",
    "section": "\n2.4 Temporal PCA",
    "text": "2.4 Temporal PCA\n\nGo to Main and click PCA\n\nInput the following:\n\nMode: temporal\n\nRotation: promax\n\nFactors: 0\n\nTitle: tPCA_experimentname (example: tPCA_ob_tgt_all)\n\n\nClick the appropriate file (e.g., ob_tgt_all)\nDetermine how many factors to retain using the scree plot (keep the number of factors where the blue line is above the red line)\nDetermine the percent variance accounted for by the number of factors retained by changing the “minimum % age accounted for criterion”. Record the number of factors retained and % variance accounted for by that number of factors.\nRe-run the temporal PCA using the above inputs, but change the number of factors to the number of factors retained from the above step\n\nReturn to Main and click Save. Save the tPCA file in the 5-PCA folder",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#spatial-pca",
    "href": "eegERP.html#spatial-pca",
    "title": "EEG and ERP Processing and Analysis",
    "section": "\n2.5 Spatial PCA",
    "text": "2.5 Spatial PCA\n\nGo to Main and click PCA\n\nChange the PCA type, using the following inputs:\n\nMode: spatial\n\nRotation: infomax\n\nFactors: 0\n\nTitle: sPCA_experimentname (e.g., sPCA_ob_tgt_all)\n\n\nClick the appropriate file (e.g., ob_tgt_all)\nDetermine how many factors to retain using the scree plot (keep the number of factors where the blue line is above the red line)\nDetermine the percent variance accounted for by the number of factors retained by changing the “minimum % age accounted for criterion”. Record the number of factors retained and % variance accounted for by that number of factors.\nRe-run the spatial PCA using the above inputs, but change the number of factors to the number of factors retained from the above step\n\nReturn to Main and click Save. Save the sPCA file in the 5-PCA folder",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#temporospatial-pca",
    "href": "eegERP.html#temporospatial-pca",
    "title": "EEG and ERP Processing and Analysis",
    "section": "\n2.6 Temporospatial PCA",
    "text": "2.6 Temporospatial PCA\n\nGo to Main and click PCA\n\nChange the PCA type, using the following inputs:\n\nMode: spatial\n\nRotation: infomax\n\nFactors: 0\n\nTitle: tsPCA_experimentname (e.g., tsPCA_ob_tgt_all)\n\n\nClick the tPCA file (created in the previous step)\nDetermine how many factors to retain using the scree plot (keep the number of factors where the blue line is above the red line)\nDetermine the percent variance accounted for by the number of factors retained by changing the “minimum % age accounted for criterion”. Record the number of factors retained and % variance accounted for by that number of factors.\nRe-run the spatial PCA using the above inputs, but change the number of factors to the number of factors retained from the above step\n\nReturn to Main and click Save. Save the tsPCA file in the 5-PCA folder.",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#sec-extract",
    "href": "eegERP.html#sec-extract",
    "title": "EEG and ERP Processing and Analysis",
    "section": "\n2.7 PCA Component Selection and Extraction",
    "text": "2.7 PCA Component Selection and Extraction\nHere, the goal is to select the PCA component that corresponds to the ERP component of interest, and the extraction that supports the intended interpretability of the component.\n\nGo to View to begin the process of selecting the PCA component that corresponds to the ERP of interest.\n\nIteratively select and view each temporospatial PCA component to identify the PCA component (“factor”) that corresponds to the ERP of interest (e.g., N2 or P3). Select the temporospatial PCA component that corresponds to the ERP of interest based on the timing, spatial location, morphology, and (as relevant) any condition- or age-related differences of the component based on prior work.\n\n\nGenerate tsPCA components. Go to Window and input the following:\n\nselect the tsPCA file\nselect among mean, maxPeak, or other options. (According to Joe Dien), when using amplitudes from PCA components, it does not matter which option you select—all the different methods result in comparable p-values when dealing with PCA components. So, select a method that makes sense for the story you want to tell. The methods will yield different results when dealing with the raw waveforms.\nselect AutoPCA or Window to select channels. If the peak amplitude is where you expect temporally and spatially, then use the autoPCA function, and if it is not, then window to where you expect it to be. This will allow you to report results that are more interpretable. As Joe Dien described, the way that PCA data are stored internally in the toolkit are as factor scores (i.e., component scores). When you extract amplitudes from a PCA component, you are extracting the factor scores multiplied by a constant (some scaling factor, representing the electrode where you extract it from). Thus, according to Joe Dien, the p-values should be the same regardless of whether you use AutoPCA, or extract from a single electrode or multiple electrodes (it would be good to verify this). What is changing is merely the scaling factor (i.e., the constant that is multiplied by all factor scores). When you select multiple electrodes, it is computing the PCA-estimated amplitude at each electrode and performing a simple average across those electrodes. The AutoPCA extracts the PCA-estimated amplitude at the peak channel and the peak timepoint. If the waveform is negative-going at the peak channel, and you are interested in the positive-going dipole, you would select the peak positive channel to identify the PCA-estimated amplitude of the positive-going waveform on that PCA component. Nevertheless, even though you are selecting the PCA-estimated amplitude for a given channel at a given electrode, there are now “virtual channels”; the estimates include the contributions of all channels and all timepoints to the extent that they load onto the PCA component of interest. Thus, even if you select to window a PCA component from only 1 channel at 1 timepoint, it is using ALL channels and timepoints in the estimation—this is not the case if windowing the raw ERP waveforms.\nSave the files generated from the AutoPCA in the 6 - PCA Components folder using the following naming convention: “erp_task_condition_age_component” (e.g.,erp_ob_tgt_all_P3).\n\n\nTo view all of the tsPCA components, click View and input the following\n\nselect the appropriate file (e.g., ob_tgt_all)\nselect gave\n\nselect none\n\nclick Waves\n\n\n\nIt is good practice to check to make sure that components are comparable across different age ranges\n\nYou can check this in one of two ways:\n\nVisually examine grand averages between age ranges\nApply the PCA from one age group and apply it to another age group and examine whether the results hold up using cross-validation in EPToolkit\n\n\n\n\nIt is generally useful to keep track of the extraction process for each PCA component. Our current procedure for doing so is keeping a PCA_ComponentInfo.txt file in the 6-PCA Components folder.\n\nRelevant information may include the timing used to window a component and the electrodes that load onto the component of interest at a given threshold",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#sec-channels",
    "href": "eegERP.html#sec-channels",
    "title": "EEG and ERP Processing and Analysis",
    "section": "\n2.8 Identifying Electrodes that Load Onto PCA Component",
    "text": "2.8 Identifying Electrodes that Load Onto PCA Component\n\nGo to Window\n\nSelect the PCA file of interest (e.g., tsPCA_ob_tgt_all)\nClick the Channels button (about halfway down the Window window)\nClick Factor\n\nFrom the dropdown, select the PCA file of interest (e.g., tsPCA_ob_tgt_all)\nEnter the threshold in the space below (e.g., 0.5)\n\nThis sets the minumum factor loading value for an electrode to be “included” in the component-related cluster\n\n\nDepending on whenther you are interested in positive or negative factor loadings, select the appropriate sign (+, -, or +/-)\nA popup window with PCA factors will appear. Select the component(s) you wish to identify spatially (e.g., TF01SF01)\n\n\nWhen prompted, give the electrode cluster a name\nThe channels that change color are those which load onto the selected component at or above the threshold value\nIf you plan to use this cluster in extracting a PCA component, you’ll need save the cluster\n\nClick Save in the Window window\nSave the cluster to 6-PCA Components",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#exporting-grand-average-data",
    "href": "eegERP.html#exporting-grand-average-data",
    "title": "EEG and ERP Processing and Analysis",
    "section": "\n2.9 Exporting Grand Average Data",
    "text": "2.9 Exporting Grand Average Data\nIf you are only interested in the grand average data and not individual subjects, these instructions will allow you to export a .txt file containing only the grand average data.\n\nFrom EP Toolkit home (Main screen), select Edit\n\nSelect the .ept averages file (e.g., ob_tgt_all) that contains a “subject” representing the grand average\n\nIf the file does NOT contain a grand average subject, follow the steps in the above section to generate it\n\n\nRename the file\n\nFor example, ob_tgt_all could be renamed to ob_tgt_gav\n\nRenaming the file will prompt EP Toolkit to ask whether you want to generate a new file with this new name, or overwrite the existing datafile once your changes are complete\n\n\nSelect Subjects from the options at the top of the editor window\nClick All from among the options on the lefthand side of the Subjects window\n\nThis will select all of the subjects\n\n\nScroll to the bottom of the list of subjects and deselect the subject labeled grand average\n\nEssentially, the goal here is to create a dataset that includes ONLY the grand average information, rather than each individual subject\n\n\nOnce everything EXCEPT for the grand average subject is selected, click Delete on the lefthand side of the editor window\n\nThis will remove the individual subject data from the dataset and leave the grand average information\n\n\nClick Done\n\nIf you renamed the datafile, EP Toolkit should generate a popup message asking whether you would like to rename your dataset OR generate a new dataset using the new name (leaving the original dataset untouched). From the options presented, click New to generate a new file and preserve the original\nThe editor window should close, returning you to the EP Toolkit pane that asks you to select a dataset to edit. From here, click Main to return to EP Toolkit “home”\nOnce in the main window, click Save\n\nSet the save format to Text (.txt)\n\nClick the grand average data (e.g., ob_tgt_gav) to save it\nA file explorer window should open, prompting you to select the appropriate save location and give your file a name",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#r-code-for-grand-average-waveform-plot",
    "href": "eegERP.html#r-code-for-grand-average-waveform-plot",
    "title": "EEG and ERP Processing and Analysis",
    "section": "\n4.1 R Code for Grand Average Waveform Plot",
    "text": "4.1 R Code for Grand Average Waveform Plot\n\n\nRead in the grand average waveform data exported from EP Toolkit.\n\nWe currently process the conditions within a given task separately, so each condition should have its own grand average file.\n\n\nCodeobTgt &lt;- read.table(\"V:/SRS-ERP-Oddball/Hard/All/4 - EPT Averages/2024-11-05/gave/ob_tgt_gav.txt\")\nobFrq &lt;- read.table(\"V:/SRS-ERP-Oddball/Hard/All/4 - EPT Averages/2024-11-05/gave/ob_frq_gav.txt\")\n\n\n\n\nCreate a subset of data that only includes those electrodes that are part of the clusters identified in EP Toolkit.\n\nThe grand average data does not have row or column labels, but the columns represent the EEG net channels in numerical order (1-129). We can therefore use their column index values to select the desired electrodes; so, the list containing the channel numbers should include ONLY numbers. The code that selects these channels out of the full dataset will rely on numerical input.\n\n\nCode# Set electrode clusters\nobElectrodes &lt;- c(58, 59, 64, 65, 66, 67, 69, 70, 71, 72, 73, 74, 75, 76, 77, 81, 82, 83, 84, 89, 80, 91, 95, 96, 101)\n\n# Subset to desired electrodes\nobTgt_sub &lt;- obTgt[, obElectrodes]\nobFrq_sub &lt;- obFrq[, obElectrodes]\n\n\n\n\nCompute averages and create labels for conditions\n\nOnce the data have been subsetted down to include only the electrode channels of interest, all that remains is to compute the average amplitude across all of those channels\nAdding a condition label will allow us to combine the two condition-specific datasets into one that can be used for visualizations\n\nFor ease of plotting, name the conditions the way that you would like them to appear on the figure (i.e., “Target” instead of “tgt”)\n\n\n\n\nCode# Compute averages \nobTgt_sub$amplitude &lt;- rowMeans(obTgt_sub)\nobFrq_sub$amplitude &lt;- rowMeans(obFrq_sub)\n\n# Remove raw values and add condition labels\nobTgt_amps &lt;- obTgt_sub %&gt;% select(amplitude) %&gt;% mutate(condition = \"Target\")\nobFrq_amps &lt;- obFrq_sub %&gt;% select(amplitude) %&gt;% mutate(condition = \"Frequent\")\n\n\n\n\nAdd timing-related information to the data\n\nEP Toolkit exports ERP data without timestamps, but arranges it in order of timing\nWe can create a template with the appropriate timestamps and append this column to the amplitude data\n\n\nCode# Create template\nerpTemplate &lt;- data.frame(\n  time = -199:1000\n)\n\n# Merge template with amplitude data\nobTgtTimes &lt;- cbind(erpTemplate, obTgt_amps)\nobFrqTimes &lt;- cbind(erpTemplate, obFrq_amps)\n\n\n\n\nCombine all conditions into a single data object to be used for plotting\n\nCodeoddball &lt;- rbind(obTgtTimes, obFrqTimes) %&gt;% \n           select(time, condition, amplitude) %&gt;% \n           arrange(time)\n\n\n\n\nGenerate the waveform figures\n\nCodeggplot(\n  data = oddball,\n  aes(\n    x = time,\n    y = amplitude,\n    group = condition,\n    color = condition\n  )\n) +\n  geom_line(linewidth = 1.5) +\n  scale_x_continuous(\n    name = \"Time Relative to Stimulus Onset (ms)\",\n    limits = c(-200, 1000),\n    breaks = seq(from = -200, to = 1000, by = 200)) +\n  scale_y_continuous(\n    name = \"Voltage (microvolts)\",\n    limits = c(-4, 10),\n    breaks = seq(from = -10, to = 15, by = 2)) +\n  scale_color_viridis_d()+\n  theme_classic(base_size = 18) +\n  theme(\n    legend.position = c(.7, .9),\n    legend.title = element_blank())",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#troubleshooting",
    "href": "eegERP.html#troubleshooting",
    "title": "EEG and ERP Processing and Analysis",
    "section": "\n5.1 Troubleshooting",
    "text": "5.1 Troubleshooting\n\nRunning out of space on EP Toolkit? You can navigate to your folder (maybe under Documents/MATLAB/EPwork) and delete everything except for EPprefs to refresh your workspace. NOTE: This will delete everything stored in EP Toolkit, so remember to back up files that you need to save.\nIf you get an error or a warning from Git when trying to commit and/or push ERP files up to the repo, you may need to initialize Git LFS. The instructions for initializing Git LFS can be found here.\n\nThe filetypes that commonly cause such errors in our current ERP processing pipeline are:\n\n\n.txt files\n\n.ept files\n\n.set files",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#to-do",
    "href": "eegERP.html#to-do",
    "title": "EEG and ERP Processing and Analysis",
    "section": "\n5.2 To-do",
    "text": "5.2 To-do\n\nBetter describe the missingness for files\n\nWe need a systematic way to identify new ways to process the missingness\nFind a way to best describe and report the ways of missingness\n\n\nGo through the maxmem edits on the clean_rawData question. We want a standardized value on the machines\nLook at the warning messages for the automatic script updates\n\nautomatic cleaning of files problems\n\n\nIntegrate ERPLAB with our existing EEGLab Functions including:\n\nAdding an event list:\n\nCurrently, some code for this is updated in the script on the lab drive\nDocumentation is here\n\n\n\nFigure out how to average epochs and export to the EP Toolkit\n\n\nEvaluate the semi-automated pipelines from:\n\nDebnath et al. (2020)\nDesjardins et al. (2021)\nFlo et al. (2022)\nGabar-Durnam et al. (2018)\nHaresign et al. (2021)\nKumaravel et al. (2022)",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#eeglab",
    "href": "eegERP.html#eeglab",
    "title": "EEG and ERP Processing and Analysis",
    "section": "\n5.3 EEGLAB",
    "text": "5.3 EEGLAB\n\n5.3.1 EEGLab Processing Steps\nhttps://eeglab.org/tutorials/\n\nFiltering\nAverage Referencing\nArtifact Rejection\n\nAutomated artifact rejection (save intermediate file)\nManual selection of bad channels\nManual selection of bad time periods (save intermediate file)\nRemoval of manually selected bad channels\nRemoval of manually selected bad time periods (save intermediate file)\n\nIndependent Component Analysis (ICA)\n\nRun ICA\nAutomated removal of bad ICA components\nRe-run ICA (save intermediate file)\nManual selection of bad ICA components (save intermediate file)\nRemoval of manually selected bad ICA components\n\n\n\n\nInterpolation of Bad Channels\nAverage Referencing\nSegmentation\nBaseline Correction (save final file)\n\n5.3.2 Install Plugins\nMFFMatlabIO plugin\n\n5.3.3 Import Data\nFile → Import Data → Using EEGLAB functions and plugins → Import Magstim/EGI .mff file\nEEG = pop_mffimport({'\\\\\\\\lc-rs-store24.hpc.uiowa.edu\\\\lss_itpetersen\\\\Lab\\\\Studies\\\\School Readiness Study\\\\Data\\\\LV2\\\\ERP\\\\Oddball\\\\0-Raw Data (mff)\\\\1613_90_oddball.mff'},{'code'},0,0);\n\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 1,'overwrite','on','gui','off');\nSelect .mff file(s)\nEvent type field (may select multiple): code\n\n5.3.4 Filter Data\nFilter → Basic FIR Filter\n0.1 – 30 Hz\nsave as new name\nEEG = pop_eegfiltnew(EEG, 'locutoff',0.1,'hicutoff',30,'plotfreqz',1);\n\n5.3.5 Average Referencing\nTools → Re-reference the data → Compute average reference\nEEG = eeg_checkset( EEG );\nEEG = pop_reref( EEG, []);\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 1,'setname','1613_90_oddball_fil_ref','overwrite','on','gui','off'); \neeglab redraw;\n\n5.3.6 Artifact Rejection\n\n5.3.6.1 Automated Artifact Rejection\nTools → Reject data using Clean Rawdata and ASR\nEEG = eeg_checkset( EEG );\nEEG = pop_clean_rawdata(EEG, 'FlatlineCriterion',5,'ChannelCriterion',0.8,'LineNoiseCriterion',4,'Highpass','off','BurstCriterion',20,'WindowCriterion',0.25,'BurstRejection','on','Distance','Euclidian','WindowCriterionTolerances',[-Inf 7] );\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 1,'gui','off'); \neeglab redraw;\nCurrently, we run into a bug that yields the following error:\nNot enough memory, This is not a bug (Error occurred in function asr_process() at line 132)\nAs a workaround, type the following code in MATLAB to edit the function:\nedit clean_artifacts\nThen, change the number in the following line to a larger number (e.g., 256) and click save:\n{'max_mem','MaxMem'}, 256, ...\n\n5.3.6.2 Selection of Bad Channels\nView data to identify bad channels to reject.\nEdit → Select data\nSpecify channels to reject\nSpecify “on -&gt; remove these”\nEEG = eeg_checkset( EEG );\nEEG = pop_select( EEG, 'nochannel',{'E44','E56','E57','E113'});\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 1,'setname','1613_90_oddball_fil_ref_chn','overwrite','on','gui','off'); \neeglab redraw;\n\n5.3.6.3 Selection of Bad Time Periods\nPlot → Channel data (scroll)\nChange voltage scale to 50\nSettings → Time range to display\nChange to 10 seconds\nSettings → Number of channels to display\nChange to number of channels to view at one time (e.g., 64)\nTo erase a selected portion of the data, first drag the mouse (holding down the left mouse button) horizontally across the time region of interest to mark it for rejection. To deselect a portion of the data, simply click on the selected region.\nAfter marking some portions of the data for rejection, press REJECT and a new data set will be created with the rejected data omitted. A new dataset will be created with the marked regions removed. Your goal is to reject non-stereotypic artifacts. Do not reject blinks/saccades, because independent component analysis will remove those.\nClicking “Stack” stacks all electrodes on top of each other to more easily identify noisy data.\nClick “REJECT” to remove the bad time periods from the data file.\n\n5.3.6.4 Independent Component Analysis\nhttps://eeglab.org/tutorials/06_RejectArtifacts/RunICA.html (archived at https://perma.cc/AEU9-GB3B)\nhttps://socialsci.libretexts.org/Bookshelves/Psychology/Book%3A_Applied_Event-Related_Potential_Data_Analysis_(Luck)/14%3A_Appendix_3%3A_Example_Processing_Pipeline (archived at https://perma.cc/9QYQ-BNFE)\nThe component order returned by runica.m is in decreasing order of the EEG variance accounted for by each component.\nTools → Decompose data by ICA\nEEG = eeg_checkset( EEG );\nEEG = pop_runica(EEG, 'icatype', 'runica', 'extended',1,'interrupt','on');\n[ALLEEG EEG] = eeg_store(ALLEEG, EEG, CURRENTSET);\neeglab redraw;\nPlot → Component maps → 2D\nVisually identify independent components to remove\nTools → Inspect/label components by map\nExample ICA Artifact Components\n\nExample ICA Brain Components \nOverview of ICA Components \nToggle the “Accept” button to reject an independent component, press “OK” to specify it for rejection\nAutomated detection of artifactual ICA components:\nhttps://eeglab.org/tutorials/06_RejectArtifacts/RunICA.html#automated-detection-of-artifactual-ica-components (archived at https://perma.cc/5RQ7-9WBT)\nEEG = eeg_checkset( EEG );\nEEG = pop_iclabel(EEG, 'default');\n[ALLEEG EEG] = eeg_store(ALLEEG, EEG, CURRENTSET);\nEEG = eeg_checkset( EEG );\nEEG = pop_icflag(EEG, [NaN NaN;0.9 1;0.9 1;NaN NaN;NaN NaN;NaN NaN;NaN NaN]);\n[ALLEEG EEG] = eeg_store(ALLEEG, EEG, CURRENTSET);\neeglab redraw;\nThere are six categories of components: Brain, Muscle, Eye, Heart, Line Noise, Channel Noise, and Other\nOur goal is to keep the brain components and to remove everything else (i.e., artifacts).\nTools → Classify components using ICLabel → Label components\nTools → Classify components using ICLabel → Flag components as artifacts\nSubstracting rejected ICA components:\nhttps://eeglab.org/tutorials/06_RejectArtifacts/RunICA.html#subtracting-ica-components-from-data (archived at https://perma.cc/HVH4-Z4SA)\nTools → Remove components\nEEG = pop_subcomp( EEG, [1    2    6    7   10   13   21   24   26   31   32   33   36   43   44   51   54   55   59   61   67   68   74   83   90   91   93   99  103  112  113  116  118  121], 0);\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 6,'gui','off'); \neeglab redraw;\n\n5.3.7 Interpolate Bad Channels\nhttps://sccn.ucsd.edu/pipermail/eeglablist/2016/011199.html (archived at https://perma.cc/97NH-8LAR)\nTo interpolate channels you would load up one file that has only the good channels, then load up a second file that has the full channel list, and then run the channel interpolation function from the eeglab gui.\nTools → Interpolate Electrodes → Use all channels (or specific channels?) of other dataset\nUsing all channels of other dataset:\nImportant Note: Interpolating files will re-reference the data. Average reference the data after interpolating channels.\nEEG = eeg_checkset( EEG );\nEEG = pop_interp(EEG, ALLEEG(3).chanlocs, 'spherical');\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 4,'gui','off'); \neeglab redraw;\nUsing specific channels of other dataset:\nEEG = eeg_checkset( EEG );\nEEG = pop_interp(EEG, ALLEEG(3).chanlocs([44   56   57  113]), 'spherical');\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 1,'gui','off'); \neeglab redraw;\nRemoved channels:\nEEG = eeg_checkset( EEG );\nEEG = pop_interp(EEG, EEG.chaninfo.nodatchans([44  56  57  113]), 'spherical');\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 3,'gui','off'); \nEEG = eeg_checkset( EEG );\neeglab redraw;\nData channels:\nEEG = eeg_checkset( EEG );\nEEG = pop_interp(EEG, [44  56  57  113], 'spherical');\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 1,'gui','off'); \neeglab redraw;\n\n5.3.8 Average Referencing\nTools → Re-reference the data → Compute average reference\nEEG = eeg_checkset( EEG );\nEEG = pop_reref( EEG, []);\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 1,'setname','1613_90_oddball_fil_ref','overwrite','on','gui','off'); \neeglab redraw;\n\n5.3.9 Segmentation\nTools → Extract Epochs\nEEG = eeg_checkset( EEG );\nEEG = pop_epoch( EEG, {  'frq+'  'tgt+'  }, [-0.2           1], 'newname', '1613_90_oddball_fil_ref epochs', 'epochinfo', 'yes');\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 1,'overwrite','on','gui','off'); \n\n5.3.10 Baseline Correction\nEEG = eeg_checkset( EEG );\nEEG = pop_rmbase( EEG, [-200 0] ,[]);\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 1,'overwrite','on','gui','off'); \neeglab redraw;\n\n5.3.11 Automatic Script example\n% Starting EEG Lab \n[ALLEEG EEG CURRENTSET ALLCOM] = eeglab;\n\n%% Helpful documentation is located here\n% https://eeglab.org/tutorials/11_Scripting/Using_EEGLAB_history.html (archived at https://perma.cc/Y687-5GKE)\n% https://eeglab.org/tutorials/ConceptsGuide/Data_Structures.html (archived at https://perma.cc/5F39-5S32)\n\n%Loading in the Dataset\nEEG = pop_mffimport({'R:\\\\Lab\\\\Studies\\\\School Readiness Study\\\\Data\\\\LV2\\\\ERP\\\\Oddball\\\\0-Raw Data (mff)\\\\1613_90_oddball.mff'},{'code'},0,0);\nEEG.setname='raw';\nEEG = eeg_checkset( EEG );\n%Storing the current dataset\n[ALLEEG, EEG] = eeg_store( ALLEEG, EEG, 1);\n% refreshing the graphical interface\neeglab redraw;\n\n%Filter the data\nEEG = pop_eegfiltnew(ALLEEG(1), 'locutoff',0.1,'hicutoff',30,'plotfreqz',1);\n%Save the Filtered dataset \n%ALLEEG EEG CURRENTSET seems to just be a name for all of the current data\n%sets \n%pop_newset seems to save the dataset in both memory and in the toolkit\n[ALLEEG, EEG, CURRENTSET] = pop_newset(ALLEEG, EEG, 2,'setname','fil','savenew','R:\\\\Lab\\\\Studies\\\\School Readiness Study\\\\Data\\\\LV2\\\\ERP\\\\Oddball\\\\MATLAB\\\\1-Filtering (fil)\\\\tcid_wave.set','gui','off'); \neeglab redraw;\n\n% Average referencing\n%EEG = eeg_checkset( EEG );\nEEG = pop_reref( ALLEEG(2), []);\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 3,'setname','Avg Ref','savenew','R:\\\\Lab\\\\Studies\\\\School Readiness Study\\\\Data\\\\LV2\\\\ERP\\\\Oddball\\\\MATLAB\\\\9-Average Reference (ref)\\\\tcid_wave_avg.set','gui','off');\neeglab redraw;\n\n% Rejecting the artifacts\n% testing bumping the \nEEG = pop_clean_rawdata(ALLEEG(3), 'FlatlineCriterion',5,'ChannelCriterion',0.8,'LineNoiseCriterion',4,'Highpass','off','BurstCriterion',30,'WindowCriterion',0.25,'BurstRejection','on','Distance','Euclidian','WindowCriterionTolerances',[-Inf 7] );\n%Saving cleaned dataset\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 4,'setname','clean data','savenew','R:\\\\Lab\\\\Studies\\\\School Readiness Study\\\\Data\\\\LV2\\\\ERP\\\\Oddball\\\\MATLAB\\\\10-Clean Artificats (clean)\\\\tcid_wave_clean.set','gui','off'); \neeglab redraw;\n\n% Placeholder to manually remove bad channels\n\n\n% ICA components\nEEG = pop_runica(ALLEEG(4), 'icatype', 'runica', 'extended', 1,'interrupt','on');\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 5,'setname','ICA test','savenew','R:\\\\Lab\\\\Studies\\\\School Readiness Study\\\\Data\\\\LV2\\\\ERP\\\\Oddball\\\\MATLAB\\\\11-ICA\\\\tcid_wave_ICA.set','gui','off'); \neeglab redraw;\n\n%Manually reject ICA components\nEEG = pop_subcomp( EEG, [1    2    6    7   10   13   21   24   26   31   32   33   36   43   44   51   54   55   59   61   67   68   74   83   90   91   93   99  103  112  113  116  118  121], 0);\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 6,'gui','off'); \neeglab redraw;\n\n% Place holder to remind to manually remove the channels that we would\n% like to reject\n% taking the EEG channel lock of the first (raw) dataset\nEEG = eeg_checkset( EEG );\nEEG = pop_interp(ALLEEG(5), ALLEEG(1).chanlocs, 'spherical');\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 6,'setname','Interpolated','savenew','R:\\\\Lab\\\\Studies\\\\School Readiness Study\\\\Data\\\\LV2\\\\ERP\\\\Oddball\\\\MATLAB\\\\12-Interpolate\\\\tcid_wave_Interpolate.set','gui','off'); \neeglab redraw;\n\n% Segmenting the Data\nEEG = eeg_checkset( EEG );\nEEG = pop_epoch( ALLEEG(6), {  'frq+'  'tgt+'  }, [-0.2 1], 'newname', 'tcid_wave_segmented', 'epochinfo', 'yes');\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 7,'setname','Segmented','savenew','R:\\\\Lab\\\\Studies\\\\School Readiness Study\\\\Data\\\\LV2\\\\ERP\\\\Oddball\\\\MATLAB\\\\13-Segment\\\\tcid_wave_Segment.set','gui','off'); \neeglab redraw;\n\n% Baseline Correcting the Data\nEEG = eeg_checkset( EEG );\nEEG = pop_rmbase( ALLEEG(7), [-200 0] ,[]);\n[ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, 8,'setname','Baseline Correct','savenew','R:\\\\Lab\\\\Studies\\\\School Readiness Study\\\\Data\\\\LV2\\\\ERP\\\\Oddball\\\\MATLAB\\\\14-Baseline-Correct\\\\tcid_wave_baseline-correct.set','gui','off'); \neeglab redraw;\n\n5.3.12 Automatic script that loops files\n\n5.3.12.1 Warning messages with script\nWarning messages appeared when using the automatic cleaning of data. We may have to send a dataset to someone so they can check on it. Some documentation is found here:\n\n\nhttps://sccn.ucsd.edu/pipermail/eeglablist/2021/016222.html (archived at https://perma.cc/9SDG-NGXD)\n\nhttps://sccn.ucsd.edu/wiki/EEGLAB_bug1971 (archived at https://perma.cc/H7PA-TPTZ)\n\n5.3.12.2 Filtering, average referencing, and automatically cleaning the data.\nThis script batch reads in files, filters them, average references, and automatically cleans them. After that, this script reads in the cleaned files for manually processing to remove bad time periods and bad channels\n%10/20/22 Working script that reads everything into matlab\n\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%Location of Raw oddball files\nrawOddballFiles = '\\\\lc-rs-store24.hpc.uiowa.edu\\lss_itpetersen\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\0-Raw\\';\n%Location of path to save cleaned files\ncleanAutoPath = '\\\\lc-rs-store24.hpc.uiowa.edu\\lss_itpetersen\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\10-Clean Artificats (clean)\\';\n\n%all oddball files in the directory to be processed\nfilesInDirectory = dir(fullfile(rawOddballFiles, '*.mff')); %Reading the files in the directory\n\n%Listing the number of subjects for the number of times to loop\nnumberOfSubject = height(filesInDirectory);\n\n%Names of all the files in the directory\nlistOfSubjects={filesInDirectory.name}; \n\n%splitting the filename up\nfilenameSplit = regexp(listOfSubjects, '_', 'split');  \nid = cellfun(@(x) x{1},filenameSplit,'un',0);  %getting the id's\nwave = cellfun(@(x) x{2},filenameSplit,'un',0); %getting the waves\n\n\n\n[ALLEEG EEG CURRENTSET ALLCOM] = eeglab;\n\nfor i=1:numberOfSubject\n\n    %%%% Importing Data\n    path = [rawOddballFiles,filesInDirectory(i).name];\n    tcid = char(strcat(id(i),'_', wave(i))); %combining the TCID and wave\n\n    EEG = pop_mffimport({path},{'code'},0,0);\n    % Saving the data in memory\n   [ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, i,'setname', tcid,'gui','off');\n\n    % Filtering the data\n    EEG = pop_eegfiltnew(ALLEEG(i), 'locutoff',0.1,'hicutoff',30,'plotfreqz',1);\n    [ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, i,'overwrite','on','gui','off');\n    \n    % Average Referencing\n    EEG = pop_reref( ALLEEG(i), []);\n    [ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, i,'overwrite','on','gui','off');\n\n    % They strongly advise importing channel locations before using this\n    % function.\n    %Cleaning the Data\n    EEG = pop_clean_rawdata(ALLEEG(i), 'FlatlineCriterion',5,'ChannelCriterion',0.8,'LineNoiseCriterion',4,'Highpass','off','BurstCriterion',30,'WindowCriterion',0.25,'BurstRejection','on','Distance','Euclidian','WindowCriterionTolerances',[-Inf 7]);\n    nameClean = [tcid,'_autoClean.set'];\n    savePathClean = [cleanAutoPath,nameClean];\n    [ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, i,'setname', nameClean, 'savenew', savePathClean, 'gui','off', 'overwrite', 'on');\n\n\nend\neeglab redraw:\n\n%% Reading in automatically cleaned datasets\n\n%%%%%%%%%%%%%%\n% Clear Data becasue to overwrite anything in memory\n%%%%%%%%%%%%%%\nALLEEG = [];\nEEG = [];\n\n% Adding the path for cleaned files\ncleanAutoPath = '\\\\lc-rs-store24.hpc.uiowa.edu\\lss_itpetersen\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\10-Clean Artificats (clean)\\';\n\n%Starting EEGLAB\n[ALLEEG EEG CURRENTSET ALLCOM] = eeglab;\n\n\n%Location of cleaned oddball data\nfilesInDirectoryClean = dir(fullfile(cleanAutoPath, '*.set')); %Reading the files in the directory\n\n\n%Listing the number of subjects for the number of times to loop\nnumberOfSubjectClean = height(filesInDirectoryClean);\n\n%Names of all the files in the directory\nlistOfSubjectsClean = {filesInDirectoryClean.name}; \n\n%splitting the filename up\nfilenameSplitClean = regexp(listOfSubjectsClean, '_', 'split');  \nid = cellfun(@(x) x{1},filenameSplitClean,'un',0);  %getting the id's\nwave = cellfun(@(x) x{2},filenameSplitClean,'un',0); %getting the waves\n\n\nfor i=1:numberOfSubjectClean\n\n    %%%% Importing Data\n    tcidClean = char(strcat(id(i),'_', wave(i), '_autoClean.set')); %combining the TCID and wave to name the file\n    EEG = pop_loadset('filename', tcidClean, 'filepath', cleanAutoPath); \n    [ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, i,'setname', tcidClean,'gui','off');\n\nend\neeglab redraw;\n\n5.3.13 Removing bad time periods and channels\n\nIn the now open EEGLAB interface, select a dataset. Go to Tools &gt; Inspect/reject data by eye\n\n\n\n\nvisually reject artifacts\n\n\nGo through the raw signal and manually reject bad time periods\n\n\n\nvisually reject artifacts\n\n\nSelect REJECT and overwrite the file in memory\n\nselect Overwrite it in memory (set=yes; unset=create a new dataset)\n\n\n\nVisually inspect the data and select any bad channels, and write them down\nNext, manually reject the channels by selecting Edit then Select Data\n\n\n\n\nvisually reject artifacts\n\n\nManually enter the channels to be removed in the Channel range field and select the checkbox under on-&gt;remove these and select Ok\n\nSave the file as tcid_wave_manualClean.set in the following drive path\n\n\\\\lc-rs-store24.hpc.uiowa.edu\\lss_itpetersen\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\11-Manually Cleaned\nThis screenshot represents removing channels 23 56 57 97 \n\n\n\nRepeat step for each cleaned dataset\n\n5.3.14 Running the ICA\nThis script runs the ICA. We’ll want to think about how to automatically reject the components here. Once this runs, see the ICA section to reject components. Tools → Inspect/label components by map is how to reject components.\n% Running the ICA\n\n%% Reading in the manually cleaned datasets\n\n%%%%%%%%%%%%%%\n% Clear Data becasue to overwrite anything in memory\n%%%%%%%%%%%%%%\nALLEEG = [];\nEEG = [];\n\n% Adding the path for cleaned files\nmanualCleanPath = '\\\\lc-rs-store24.hpc.uiowa.edu\\lss_itpetersen\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\11-Manually Cleaned\\';\n\n%Starting EEGLAB\n[ALLEEG EEG CURRENTSET ALLCOM] = eeglab;\n\n\n%Location of cleaned oddball data\nfilesInDirectoryManualClean = dir(fullfile(manualCleanPath, '*.set')); %Reading the files in the directory\n\n\n%Listing the number of subjects for the number of times to loop\nnumberOfSubjectManualClean = height(filesInDirectoryManualClean);\n\n%Names of all the files in the directory\nlistOfSubjectsManualClean = {filesInDirectoryManualClean.name}; \n\n%splitting the filename up\nfilenameSplitManualClean = regexp(listOfSubjectsManualClean, '_', 'split');  \nid = cellfun(@(x) x{1},filenameSplitManualClean,'un',0);  %getting the id's\nwave = cellfun(@(x) x{2},filenameSplitManualClean,'un',0); %getting the waves\n\n\nfor i=1:numberOfSubjectManualClean\n\n    %%%% Importing Data\n    tcidClean = char(strcat(id(i),'_', wave(i), '_manualClean.set')); %combining the TCID and wave to name the file\n    EEG = pop_loadset('filename', tcidClean, 'filepath', manualCleanPath); \n    [ALLEEG EEG CURRENTSET] = pop_newset(ALLEEG, EEG, i,'setname', tcidClean,'gui','off');\n\n    %%% Running the ICA\n    EEG = eeg_checkset( EEG );\n    EEG = pop_runica(EEG, 'icatype', 'runica', 'extended',1,'interrupt','on');\n    [ALLEEG EEG] = eeg_store(ALLEEG, EEG, CURRENTSET);\n    eeglab redraw;\n\nend\neeglab redraw;",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "eegERP.html#netstation",
    "href": "eegERP.html#netstation",
    "title": "EEG and ERP Processing and Analysis",
    "section": "\n5.4 NetStation",
    "text": "5.4 NetStation\n\n5.4.1 Processing Order\n\nFiltering (fil)\nSegmentation (seg)\nManually selected bad channels (seg)\nBad Channel Replacement (bcr)\nArtifact Detection (art)\nBad Channel Replacement (bcr)\nArtifact Detection (art)\nAveraging (ave)\nAverage Reference (ref)\nBaseline Correction (blc)\nGrand-Averaging\n2-step PCA: Temporal PCA then Spatial PCA\n\n5.4.2 Folder Structure\n\n\nRaw Data (mff)\n\n\nFiltering (fil)\n\n\nSegmentation (seg)\n\n\nManually Selected Bad Channels\n\n\nBad Channel Replacement_m (bcr)\n\n\nArtifact Detection (art)\n\n\nBad Channel Replacement (bcr)\n\n\nArtifact Detection (art)\n\n\nAveraging (ave)\n\nSkip if doing PCA on individual trial-level data\n\n\n\n\nAverage Reference (ref)\n\n\nBaseline Correction (blc)\n\n\nFiles for PCA – drop files that have fewer than 10 artifact-free (and correct?) trials per condition\n\n\nSimple Binary\n\n\nIndividual Trials\n\n\nEPT Averages\n\n\nPCA\n\n\nPCA Components\n\n\n\n\n5.4.3 Data Processing\n\nOpen NetStation Tools and select Automated Processing Script 1: Run on raw data files (mff)\n\nFiltering\nSegmentation\n\n\nOpen segmented (seg) files in NetStation Review and select bad channels manually\n\nTo mark channels as bad across all segments:\n\nPut Ø next to bad channels, these changes will automatically be saved when you close the file\n\n\nTo mark channels as bad in individual segments:\n\nWhen in topoplot mode, make sure to have the “Click to Change Channel Status” checked, then click on the channel.\n\n\n\n\nOpen NetStation Tools and Manual Script 2: Run on segmented files (seg)\n\nBad Channel Replacement (bcr)\nArtifact Detection (art)\nBad Channel Replacement (bcr)\nArtifact Detection (art)\nAveraging (ave)\nAverage Reference (ref)\nBaseline Correction (blc)\n\n\nIn NetStation Review, open each file after the second Bad Channel Replacement\n\nDetermine how many trials are marked as good in each condition\n\nThis is found in the Segment panel on the bottom left when you have your file open. If you open that view, you can use the diverging arrows (those may be hard to see depending on your screen size) in the upper right corner of the “Bad Channels” button in the Segment panel to open in a new window for more screen real estate. The categories will be listed on the left, with the number of good trials noted over the total number of trials in that category.\n\n\nIf the file has 10 or more good trials in each condition:\n\nMake note of the bad channels (that are marked as bad across all segments) for each subject on “EEG Behavior and Bad Channels Sheet”\nThen, proceed with the next step\n\n\nIf the file does not have 10 more good trials in each condition:\n\nGo back to Step 2 and proceed from there\nSelect additional bad channels manually so that they aren’t included in later processing steps, which might increase the number of trials kept\nIt can be helpful to take a look, in the file after the second Bad Channel Replacement file, at each trial that was marked as bad.\n\nIf a trial was clearly bad (many artifacts across many channels) and correctly marked as bad, leave it alone.\nIf a trial was marked as bad but appeared to have only a few bad channels (i.e., only a few bad channels led it to be marked as bad), then it can be helpful to mark those channels as bad for that individual segment (rather than marking the channel as bad across all segments—unless the channel is bad across many segments)\n\n\n\n\n\n\nIn NetStation Review, open each file after the Averaging step\n\nIf there are continue to be channels that look bad, go back to Step 2 and proceed from there\nIn Step 2, mark those channel(s) as bad across all segments\nRepeat process until there are no more bad channels after Script 2\n\n\nFor files that have at least 10 good trials in each condition, copy and paste (don’t cut/move!) their file from the “10-Baseline Correction (blc)” folder into the “11-Files for PCA” folder\nRun the temporo-spatial PCA on those files for data reduction\n\n5.4.4 Notes\nOptions for removing bad segments: - The combine files tool has an exclude bad trials checkbox. If you run this tool on only one file, it is considered a no-op, the intended operation is not done, but it does appear to remove the bad segments. You would have to do this one run per file, if there are multiple files in the input subpane, they will be combined. - In the Net Station File Export Tool, there is a checkbox option to “Export only good segments” when exporting to both the MAT format, and also when exporting to Simple Binary (RAW) format. - In Net Station 5.3, EGI introduced the workflow concept into Net Station Review. The first workflow is combine segment/categories. This workflow allows for shuffling segments around between categories. It is quite a flexible tool, but importantly it includes a “Remove Bad Segments” button. So, you could do a no-op as far as changing categories but write out a MFF with the bad segments excluded.\nOptions for data processing: - Data processing in Net Station → file export to simple binary → PCA in ERP PCA Toolkit - Data processing and PCA in ERP PCA Toolkit - Data processing in EEGLab → PCA in ERP PCA Toolkit - Data processing in MATLAB using scripts → PCA in ERP PCA Toolkit - Ryan Priefer’s approach: - Filter in EEGLab → data processing and PCA in ERP PCA Toolkit: segment, artifact detection/bad channel replacement, montage re-reference/baseline correct, average, then export to .txt file and PCA\n\n5.4.5 Waveform Tools\n\n\nFiltering\n\nHighpass: 0.1 Hz\nLowpass: 30.0 Hz\n\n\n\n\nSegmentation\n\n\nOddball\n\nFrequent:\n\nCode is frq+\n\n\n\nTarget:\n\nCode is tgt+\n\n\n\n\nOptions:\n\nSegment length before: 200ms (baseline length)\nSegment length after: 1000ms (post-stimulus length)\nOffset: 2ms\nCheck “Copy specs to Segment”\n\n\n\n\n\n\nFishsharks\n\nCorrect go:\n\nCode is Go++\n\nTrial Spec eval is 1\nTrial Spec rtim is greater than or equal to 200\n\n\n\n\n\nCorrect no-go:\n\nCode is NG++\n\nTrial Spec eval is 0\n\n\n\n\n\nIncorrect go:\n\nCode is Go++\n\nTrial Spec eval is 0 or Trial Spec rtim is less than 200\n\n\n\n\n\nIncorrect no-go:\n\nCode is NG++\n\nTrial Spec eval is 1\n\n\n\n\n\nAll go:\n\nCode is Go++\n\n\n\n\n\n\nAll no-go:\n\nCode is NG++\n\n\n\n\n\n\n\nOptions:\n\nSegment length before: 200ms\nSegment length after: 1000ms\nOffset: 17ms\n\n\n\n\n\nStop-signal\n\nGo - correct response\n\nCode is GoCR or NGGC\n\nTrial Spec rtim is greater than or equal to 200\n\n\n\n\n\nGo - incorrect response\n\nCode is GoIn or NGGI\n\n\n\n\n\n\nGo - omission error\n\nCode is GoOm\n\n\n\n\n\n\nNoGo - correct\n\nCode is NNCR\n\n\n\n\n\n\nNoGo - incorrect\n\nCode is NNCC or NNCI\n\n\n\n\n\n\nNoGo - incorrect: correct E\n\nCode is NNCC\n\n\n\n\n\n\nNoGo - incorrect: incorrect E\n\nCode is NNCI\n\n\n\n\n\n\nAll go:\n\nCode is CoGR or GoOm or GoIn or NGGC\n\n\n\n\n\n\nAll no-go:\n\nCode is NNCR or NNCC or NNCI\n\n\n\n\n\n\nResponse-locked correct go\n\nCode is rcor\n\nKey code cel# is 3\n\n\n\n\n\nResponse-locked incorrect stop\n\nCode is resp\n\nKey Code cel# is 4\n\n\n\n\n\nResponse-locked incorrect go\n\nCode is rinc\n\nKey Code cel# is 3\n\n\n\n\n\n\nOptions:\n\nSegment length before: 200ms\nSegment length after: 1000ms\nOffset: 16ms\n\nNote: for “response locked”, offset is 0ms\n\n\n\n\n\n\n\n\nManually prcoess data\n\nBad channel replacement\n\nPrior to running, select bad channels manually\n\n\n\n\nArtifact detection\n\nBad channels:\n\nMax - min &gt; 200.00 uv\nEntire segment\nMoving average: 80ms\n\n\nEye blink:\n\nMax - min &gt; 175.00 uv\nWindow size: 640ms\nMoving average: 80ms\n\n\nEye movement:\n\nMax - min &gt; 200.00 uv\nWindow size: 640ms\nMoving average: 80ms\n\n\nMark channel bad for all sefments if bad for greater than: 20% of segments\nMark segment bad if it:\n\nContains more than 20 bad channels\nContains an eyeblink (remove if doing ocular artifact removal)\nContains an eye movement (remove if doing ocular artifact removal)\n\n\nOverwrite all previous bad Segment information\nOverwrite all previous bad Channel information\n\n\n\n\nBad channel replacement\n\nSame as step 4\nSpecification name: Oddball 06. Bad Channel Replacement\n\n\n\nArtifact detection\n\nSame as step 5\n\n\n\nAveraging\n\nHandle source files: Separately\nHandle subjects: Separately\n\nTo create final merge file for one ERP for whole sample (i.e., grand average – for graphing purposes only, not analysis – select “Together” for each)\n\n\nDo not compute noise estimate\n\n\n\n\nMontage options\n\nAverage reference\n\n\n\n\nBaseline correction\n\nSample baseline with respect to: segment time = 0\nBaseline begins: 200ms (length of baseline) before sample and is 200ms (length of baseline) long\n\n\n\n\nCombine files (using the Averaging Tool)\n\nHandle source files: Together\nHandle subjects: Separately\nDo not compute noise estimate\n\n\n\n\nFile Export\n\nSimple binary\nCalibrate data\nExport calibration information\nExport history information\nExport reference channel\nExport only good segments (if not doing data processing in othe software)\n\n\n\n\nGrand averaging\n\nHandle source files: Together\nHandle subjects: together\nCopy events from first file\n\n\n\n\nFile export\n\nFormat: Tab-delimited text (.txt)\nExport only good segments\n\n\n\n\n5.4.6 EEG Behaviors and Bad Channels Form\n\nIndicate which channels were badd across all trials in the last “bad channel replacement” (bcr) step (Step 6)\n\nInclude tirals that were marked bad (across all trials) either manually or automatically\n\n\nIndicate which channels were manually marked bad on each trial for those that were marked bad on a trial by trial basis (step 3)\n\n5.4.7 Troubleshooting and Q&A\nQ: How do I mark a channel as bad for an individual trial/segment?\nA: To mark an individual trial bad when in topoplot mode, make sure to have the “Click to Change Channel Status” checked and then click on the channel. Click again to make it good. Hold down the Command key to make it good or bad for the whole experiment.\nQ: When trying to do some batch data processing in NetStation Tools, I received an error when trying to add a group of .mff files to the “Input Files” box. The error says “Blue files are open in review. In order to process these files, they need to be closed in Review fist” What can I do?\nA: If you run files through the FileValidator found in the Utilities (Application&gt;EGI&gt;Utilities) folder, this will fix the error. If you don’t have that, you can right-click on the files, choose “Show package contents” and deleted the lock.txt or aquiriring.xml file if found\nQ: When trying to import files to NetStation Tools from an external hard drive, they do not show up in the “Input Files” box but no error is given. How can I resolve this?\nA: Copy the files to a local directory (e.g., a folder on the Desktop) before importing to NetStation Tools.",
    "crumbs": [
      "About",
      "Electroencephalography/Event-Related Potentials"
    ]
  },
  {
    "objectID": "git.html",
    "href": "git.html",
    "title": "Git, GitLab, and GitHub",
    "section": "",
    "text": "For code below, Open Git (or Powershell, Terminal, Command Prompt, etc.) in directory of repository and use the relevant code.",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#sec-toBegin",
    "href": "git.html#sec-toBegin",
    "title": "Git, GitLab, and GitHub",
    "section": "3.1 To begin",
    "text": "3.1 To begin\n\nInstall git (https://git-scm.com/downloads)\nInstall GitHub Desktop app (https://desktop.github.com)\nCreate a Personal Access Token (https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html, archived at https://perma.cc/6ZH8-JNZC; or https://research-git.uiowa.edu/-/profile/personal_access_tokens, archived at https://perma.cc/7JPU-WDBS) on the UI GitLab instance (https://research-git.uiowa.edu) to access UI GitLab repositories from GitHub Desktop.\n\nFor application name, put “GitHub”\nFor expiration date, leave it blank (or set it for as late an expiration date as possible)\nFor scopes, select everything\n\nWhen cloning a repository from UI’s GitLab instance using GitHub Desktop, GitHub Desktop will ask for your username and password. Enter your HawkID as your username (or your GitHub.com username if different) and your UI GitLab Personal Access Token as your password.",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#sec-bestPractices",
    "href": "git.html#sec-bestPractices",
    "title": "Git, GitLab, and GitHub",
    "section": "3.2 Best practices working with version control",
    "text": "3.2 Best practices working with version control\n\nCreate a new repository (repo) whenever you start a new project\nFollow the Petersen Lab template for how to structure your repo (folder structure, .gitignore file, etc.):\n\nhttps://research-git.uiowa.edu/PetersenLab/Template\n\nTo collaborate with others:\n\nNavigate to the repo on the UI GitLab website\nWhen in the repo, click “Members”\nAdd the Collaborator\n\nEach time you want to work on the files in the repo, follow this cycle:\n\nUsing the GitHub Desktop app, sync the repo files from the cloud to the repo on your local computer (i.e., fetch any repo updates to your local machine from the cloud)\n\nMake sure to do this before many code changes so you are working with the latest version of files\n\nDo your work on the repo: make any code/file/folder additions, changes, or deletions\nUsing the GitHub Desktop app, commit the changes\n\nCommit changes to the cloud early and often; when deciding what to commit and when, try to group “similar changes” into the same commit (“like goes with like”)\nUse a separate “commit” for each separable “functional unit” changed\n\nUsing the GitHub Desktop app, sync the repo files from your local computer to the repo on the cloud (i.e., push all of your committed changes to the cloud)\n\nNever leave file changes uncommitted or unsynced when you stop working on the repo for the day!",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#instructions-for-using-github-desktop-app-with-gitlab",
    "href": "git.html#instructions-for-using-github-desktop-app-with-gitlab",
    "title": "Git, GitLab, and GitHub",
    "section": "3.3 Instructions for using GitHub Desktop app with GitLab",
    "text": "3.3 Instructions for using GitHub Desktop app with GitLab\n\nhttps://itnext.io/how-to-use-github-desktop-with-gitlab-cd4d2de3d104 (archived at https://perma.cc/S59R-3YT7)\nhttps://community.reclaimhosting.com/t/using-github-desktop-with-gitlab/876 (archived at https://perma.cc/ZPT9-KEQL)\nhttps://stackoverflow.com/questions/22639815/does-github-for-windows-work-with-gitlab (archived at https://perma.cc/99RR-6KLE)\nhttps://github.com/desktop/desktop/issues/852#issuecomment-402546848 (archived at https://perma.cc/3GCU-GTPU)\nhttps://github.com/desktop/desktop/issues/3816#issuecomment-421060974 (archived at https://perma.cc/N8RS-BFWR)",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#how-to-create-a-repo-on-local-computer",
    "href": "git.html#how-to-create-a-repo-on-local-computer",
    "title": "Git, GitLab, and GitHub",
    "section": "3.4 How to create a repo on local computer",
    "text": "3.4 How to create a repo on local computer\n\nCreate repository on UI GitLab website (https://research-git.uiowa.edu)\nOpen GitHub Desktop app\nClone repository\nAdd .gitignore file (from Template project: https://research-git.uiowa.edu/petersenlab/Template/blob/master/.gitignore) to the root of the cloned project folder\nFollow the Petersen Lab template for how to structure your repo (folder structure, .gitignore file, etc.): https://research-git.uiowa.edu/PetersenLab/Template\n\nNote that a folder will not be synced if there are no files in them (i.e., if the folder is empty)\n\nSync file changes using GitHub Desktop (“Fetch origin”, “Push origin”)",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#sec-preExistingRepoLabDrive",
    "href": "git.html#sec-preExistingRepoLabDrive",
    "title": "Git, GitLab, and GitHub",
    "section": "3.5 How to add a pre-existing repo from the lab drive (LSS/RDSS/network share) to your computer",
    "text": "3.5 How to add a pre-existing repo from the lab drive (LSS/RDSS/network share) to your computer\nFor example, the SRS-DataProcessing repo lives on the lab drive.\n\nMake sure Dr. Petersen has given you collaborator access to the repo\nOpen GitHub Desktop app\nNavigate to the folder location of the repo on the lab drive\nDrag the .git folder within the repo to the GitHub Desktop app",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#how-to-clone-a-repo-from-gitlab-to-local",
    "href": "git.html#how-to-clone-a-repo-from-gitlab-to-local",
    "title": "Git, GitLab, and GitHub",
    "section": "3.6 How to clone a repo from GitLab to local",
    "text": "3.6 How to clone a repo from GitLab to local\n\nNavigate to relevant repo on GitLab (https://research-git.uiowa.edu)\nClick Clone in right-hand corner, select Clone with HTTPS\nOpen GitHub Desktop App and click File, Clone Repository\nClick the URL tab\nPaste in the URL\nNavigate to where you want to save it\n\nThe recommended location for your repos is to create a folder titled GitHub in your Documents folder, and to put repos in the GitHub folder (by default: PC: C:/Users/[USERNAME]/Documents/GitHub/; Mac: /Users/[user]/Documents/GitHub/) because various lab scripts try to read the lab functions from this location; it is NOT recommended to put git repos in a OneDrive folder because [git files tend not to play nice with syncing services](https://stackoverflow.com/questions/19305033/why-is-putting-git-repositories-inside-of-a-dropbox-folder-not-recommended; archived at https://perma.cc/UTX8-KVL9) (e.g., OneDrive, Dropbox)\n\nClick Clone\nEnter your GitLab username as your username and your Personal Access Token as your password",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#how-to-add-modify-or-delete-files-in-a-repo",
    "href": "git.html#how-to-add-modify-or-delete-files-in-a-repo",
    "title": "Git, GitLab, and GitHub",
    "section": "3.7 How to add, modify, or delete files in a repo",
    "text": "3.7 How to add, modify, or delete files in a repo\n\nOpen relevant repo in GitHub Desktop app\nPull any repo updates from the server to the local files (“Fetch origin”, “Pull origin”)\nMake necessary additions, modifications, and deletions to the files\nCreate commits for all changes in GitHub Desktop app (one commit per substantive change): Enter “Summary” and “Commit to master”\nAfter making all changes and commits, push local file changes to the server using GitHub Desktop (“Fetch origin”, “Push origin”)",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#how-to-collaborate-with-others",
    "href": "git.html#how-to-collaborate-with-others",
    "title": "Git, GitLab, and GitHub",
    "section": "3.8 How to collaborate with others",
    "text": "3.8 How to collaborate with others\n\nNavigate to the repo on the UI GitLab website\nWhen in the repo, click “Settings”\nClick “Members”\nAdd the Collaborator",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#sec-pull-request",
    "href": "git.html#sec-pull-request",
    "title": "Git, GitLab, and GitHub",
    "section": "3.9 How to create a pull request",
    "text": "3.9 How to create a pull request\nTo make/propose changes to a repo that you do not have write permissions for, you need to create a pull request.\n\nTo create a pull request to a repo that you do not have write permissions for, first create a fork of the repo. To fork the repo, see here: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/working-with-forks/fork-a-repo#forking-a-repository (archived at https://perma.cc/33P6-Y4BR)\nAfter forking the repo, sync the repo with the latest version from the cloud so you know you are editing the latest version of the files. When asked by GitHub Desktop how you plan to use the fork, select “To contribute to the parent project”, as in the image below. \nMake any changes to the files in the repo that you’d like to incorporate into the repo.\nOpen a pull request with your changes: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/creating-a-pull-request-from-a-fork (archived at https://perma.cc/KAP3-L5L7)\nThe owner of the repo will review your changes and decide whether to accept them or whether additional changes are needed.\n\nYou can also create a pull request if you have write permissions to the repo. This can be useful when collaborating on code with multiple people. To do this, first, create a new branch. Then, make your changes in the new branch. After making your changes, create a pull request to merge the changes in the new branch into the main branch.\nNote: If your pull request is showing up in your local repo but not in the original repo (for the repo owner), you might need to delete your forked repo and re-fork the original repo.",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#how-to-clone-a-repo-into-local-directory-with-a-different-folder-name-directory-must-be-empty",
    "href": "git.html#how-to-clone-a-repo-into-local-directory-with-a-different-folder-name-directory-must-be-empty",
    "title": "Git, GitLab, and GitHub",
    "section": "3.10 How to clone a repo into local directory with a different folder name (directory must be empty)",
    "text": "3.10 How to clone a repo into local directory with a different folder name (directory must be empty)\n\nGit Bash into directory\n\ngit clone https://research-git.uiowa.edu/petersenlab/srs/SRS-DataProcessing.git .\ngit remote set-url --add origin https://research-git.uiowa.edu/petersenlab/srs/SRS-DataProcessing.git\ngit remote -v",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#how-to-transfer-a-repo-to-a-new-locationgroupsubgroup",
    "href": "git.html#how-to-transfer-a-repo-to-a-new-locationgroupsubgroup",
    "title": "Git, GitLab, and GitHub",
    "section": "3.11 How to transfer a repo to a new location/group/subgroup",
    "text": "3.11 How to transfer a repo to a new location/group/subgroup\n\nCreate location/group/subgroup (e.g., PetersenLab/School Readiness Study)\nWhen in the repo, click “Settings”\nGo to “Advanced”, and click “Expand”\nGo to “Transfer project”, and select the location/group/subgroup you want to transfer the repo to under “Select a new namespace”\nIn the local repo, edit the repo URL in the .git/config file\nWhen asked for your password, enter your username (HawkID) and GitLab Personal Access Token",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#sec-gitLfs",
    "href": "git.html#sec-gitLfs",
    "title": "Git, GitLab, and GitHub",
    "section": "3.12 How to use large file storage (LFS)",
    "text": "3.12 How to use large file storage (LFS)\nIn GitLab, we use large file storage (LFS) to store large files. In GitHub, we do not use LSS to store large files, because the University does not have an Enterprise agreement with GitHub (thus, we would have to pay to use it). As a consequence, individual files hosted in a GitHub repo must be less than 50 MB in size. By contrast, individual files hosted in a GitLab repo may be larger than 50 MB.\nTo set up LFS in for a GitLab repo, follow these steps:\n\nMake sure the large files are not in the repo yet.\nIn GitHub Desktop, open the repo you want to use LFS for\nIn GitHub Desktop, select the Repository tab, then select Command Prompt or similar\nIn the command prompt, type (based on instructions from: https://docs.gitlab.com/ee/topics/git/lfs/; archived at https://perma.cc/6WMC-GTKN):\n\ngit lfs install          # initialize the Git LFS project\ngit lfs track \"*.Rdata\"  # select the file extensions that you want to treat as large files\n\nThis should have created a .gitattributes file in the repo. In GitHub Desktop, commit and push the .gitattributes file to the cloud version of the repo.\nCopy the large files into the repo.\nIn GitHub Desktop, commit and push the large file to the cloud version of the repo.\n(Or, if not using GitHub Desktop, can commit in the command prompt (https://docs.gitlab.com/ee/topics/git/lfs/)):\n\ngit add .                                            # add the large file to the project\ngit commit -am \"insert name of commit message here\"  # commit the file meta data\ngit push origin master                               # sync the git repo and large file to the GitLab server\n\nWhen asked for credentials, use your HawkID as your username and your personal access token as your password",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#how-to-create-a-new-repository-on-a-shared-network-drive-e.g.-lab-drive",
    "href": "git.html#how-to-create-a-new-repository-on-a-shared-network-drive-e.g.-lab-drive",
    "title": "Git, GitLab, and GitHub",
    "section": "3.13 How to create a new repository on a shared network drive (e.g., Lab Drive)",
    "text": "3.13 How to create a new repository on a shared network drive (e.g., Lab Drive)\n\nCreate a repo on GitHub or GitLab online\nOpen Git Bash on the desktop\nUsing Git Bash, set the current directory to the path where the new repo will be. For example, use the following command to clone to the School Readiness Study\n\ncd \"R:\\Lab\\Studies\\School Readiness Study\"\n\nNext, go to GitLab or GitHub online and obtain the HTTPS URL to the new repository that was created. Clone the repository with the HTTPS link using Git Bash with the following command\n\ngit clone (HTTPS Link)",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#sec-revertCommit",
    "href": "git.html#sec-revertCommit",
    "title": "Git, GitLab, and GitHub",
    "section": "3.14 How to revert changes to a previous commit",
    "text": "3.14 How to revert changes to a previous commit\n\nOpen the Github Desktop and navigate to the repository you would like to revert changes for\nNext, click the history tab\nRight click the commit you would like to revert back to, and select revert changes\nPush the changes to the repo to complete the revision\n\n\n\n\nrevert changes",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#sec-partialCommit",
    "href": "git.html#sec-partialCommit",
    "title": "Git, GitLab, and GitHub",
    "section": "3.15 How to perform a partial commit",
    "text": "3.15 How to perform a partial commit\n\nIn GitHub Desktop, click the desired lines in the gutter\nCreate the commit, and leave the other changes for you to continue working on.\n\nhttps://github.blog/2015-01-14-partial-commits-in-github-for-windows (archived at https://perma.cc/5U3V-YWRF)",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#sec-copyRepo",
    "href": "git.html#sec-copyRepo",
    "title": "Git, GitLab, and GitHub",
    "section": "3.16 How to copy a repo to a new repo",
    "text": "3.16 How to copy a repo to a new repo\nhttps://github.com/new/import",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#sec-templateRepo",
    "href": "git.html#sec-templateRepo",
    "title": "Git, GitLab, and GitHub",
    "section": "3.17 How to make a repository a template repository",
    "text": "3.17 How to make a repository a template repository\nhttps://docs.github.com/en/repositories/creating-and-managing-repositories/creating-a-template-repository (archived at https://perma.cc/PYW5-KAP5)",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#sec-repoFromTemplate",
    "href": "git.html#sec-repoFromTemplate",
    "title": "Git, GitLab, and GitHub",
    "section": "3.18 How to create a respository from a template",
    "text": "3.18 How to create a respository from a template\nhttps://docs.github.com/en/repositories/creating-and-managing-repositories/creating-a-repository-from-a-template (archived at https://perma.cc/9E2C-MUCK)",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#sec-authenticationFailed",
    "href": "git.html#sec-authenticationFailed",
    "title": "Git, GitLab, and GitHub",
    "section": "4.1 Error: Authentication Failed",
    "text": "4.1 Error: Authentication Failed\n\n\n\nauthentication failed\n\n\nThis error can occur for a variety of reasons. One possibility is that your GitLab Personal Access Token (PAT) has expired. To fix this:\n\nCreate a Personal Access Token (https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html, archived at https://perma.cc/6ZH8-JNZC; or https://research-git.uiowa.edu/-/profile/personal_access_tokens, archived at https://perma.cc/7JPU-WDBS) on the UI GitLab instance (https://research-git.uiowa.edu) to access UI GitLab repositories from GitHub Desktop.\n\nFor application name, put “GitHub”\nFor expiration date, leave it blank (or set it for as late an expiration date as possible)\nFor scopes, select everything\n\nWhen cloning a repository from UI’s GitLab instance using GitHub Desktop, GitHub Desktop will ask for your username and password. Enter your HawkID as your username and your UI GitLab Personal Access Token as your password.\n\nIf you do not receive a prompt to enter your username and password, try removing the saved GitHubcredentials from Windows Credential Manager: https://github.com/desktop/desktop/issues/8860#issuecomment-2211812646",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#github-trying-to-connect-to-git-config-in-another-users-user-folder",
    "href": "git.html#github-trying-to-connect-to-git-config-in-another-users-user-folder",
    "title": "Git, GitLab, and GitHub",
    "section": "4.2 GitHub trying to connect to git config in another user’s User folder",
    "text": "4.2 GitHub trying to connect to git config in another user’s User folder\nTo resolve, ensure that the HOME environment variable is set to your user folder (assuming that it is not a shared computer)\nTo do so: - Type “Environment Variables” into the search bar of your Windows task bar - Click “Open” under the result of “Edit the system environment variables” - Enter an admin user/password when prompted - Click “Environment Variables” at the bottom right corner of the popup window that should open after entering admin credentials - Find the HOME environment variable and click it to select (highlighted blue) - Click “Edit” and update the path to match your Users folder",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#github-shows-all-files-as-being-changed-even-though-the-files-havent-changed",
    "href": "git.html#github-shows-all-files-as-being-changed-even-though-the-files-havent-changed",
    "title": "Git, GitLab, and GitHub",
    "section": "4.3 GitHub shows all files as being changed even though the files haven’t changed",
    "text": "4.3 GitHub shows all files as being changed even though the files haven’t changed\nWindows and Mac use different line endings (https://github.com/Microsoft/WSL/issues/184; archived at https://perma.cc/F8UX-YJP3):\ngit config --global core.autocrlf true",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#error-you-are-not-allowed-to-push-code-to-protected-branches-on-this-project",
    "href": "git.html#error-you-are-not-allowed-to-push-code-to-protected-branches-on-this-project",
    "title": "Git, GitLab, and GitHub",
    "section": "4.4 Error: You are not allowed to push code to protected branches on this project",
    "text": "4.4 Error: You are not allowed to push code to protected branches on this project\n\nMake sure the owner of the repo unprotects the branch (https://stackoverflow.com/questions/32246503/fix-gitlab-error-you-are-not-allowed-to-push-code-to-protected-branches-on-thi; archived at https://perma.cc/98AF-N6BY)\nOpen the repo, click “Settings”, “Repository”, “Protected Branches”\nChange “Allowed to merge” and “Allowed to push” to “Developers and Maintainers”, and click “Unprotect”",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#error-creating-commit",
    "href": "git.html#error-creating-commit",
    "title": "Git, GitLab, and GitHub",
    "section": "4.5 Error creating commit",
    "text": "4.5 Error creating commit\ngit add -A\ngit status\ngit commit -m \"Message\"` (where \"Message\" is the summary message of the commit)\ngit push\ngit status",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#undo-commit-but-retain-file-changes",
    "href": "git.html#undo-commit-but-retain-file-changes",
    "title": "Git, GitLab, and GitHub",
    "section": "4.6 Undo commit (but retain file changes)",
    "text": "4.6 Undo commit (but retain file changes)\ngit reset --soft HEAD^",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#error-sync-failed",
    "href": "git.html#error-sync-failed",
    "title": "Git, GitLab, and GitHub",
    "section": "4.7 Error: Sync failed",
    "text": "4.7 Error: Sync failed\ngit status\ngit push",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#error-sync-failed----syncing-would-overwrite-your-uncommitted-changes",
    "href": "git.html#error-sync-failed----syncing-would-overwrite-your-uncommitted-changes",
    "title": "Git, GitLab, and GitHub",
    "section": "4.8 Error: Sync failed -- Syncing would overwrite your uncommitted changes",
    "text": "4.8 Error: Sync failed -- Syncing would overwrite your uncommitted changes\nhttps://stackoverflow.com/questions/23084822/github-some-uncommited-changes-would-be-over-written-by-syncing (archived at https://perma.cc/AP5S-G38B):\n\ngit stash -u\n(perform manual sync in GitHub Desktop)\ngit stash pop",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#error-pipeline-has-failed-for-master",
    "href": "git.html#error-pipeline-has-failed-for-master",
    "title": "Git, GitLab, and GitHub",
    "section": "4.9 Error: Pipeline has failed for master",
    "text": "4.9 Error: Pipeline has failed for master\nhttps://docs.gitlab.com/ee/topics/autodevops/#at-the-project-level (archived at https://perma.cc/3MAQ-ZBFF)\n\nOpen the repo in GitLab\nGo to your project’s “Settings” &gt; “CI/CD” &gt; “Auto DevOps”\nDisable (uncheck) the “Default to Auto DevOps pipeline”\nClick “Save changes”",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#creating-repo-on-local-directory-if-directory-is-empty",
    "href": "git.html#creating-repo-on-local-directory-if-directory-is-empty",
    "title": "Git, GitLab, and GitHub",
    "section": "5.1 Creating Repo on Local Directory (if Directory is empty)",
    "text": "5.1 Creating Repo on Local Directory (if Directory is empty)\n\nCreate Repo on GitHub\nDon’t add README yet\nOpen Git Shell, navigate to directory, and type:\n\ngit init\ngit remote add origin https://github.com/DevPsyLab/petersenlab.git\ngit remote -v\n\nDrag and drop the folder with the repository into the GUI app\nAdd .gitignore file with .Rhistory",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#creating-repo-on-local-directory-if-directory-is-not-empty",
    "href": "git.html#creating-repo-on-local-directory-if-directory-is-not-empty",
    "title": "Git, GitLab, and GitHub",
    "section": "5.2 Creating Repo on Local Directory (if Directory is not empty)",
    "text": "5.2 Creating Repo on Local Directory (if Directory is not empty)\n\nCreate Repo on GitHub\nDon’t add README yet\nOpen Git Shell, navigate to directory, and type:\n\ngit init\ngit add .\ngit commit -m 'First commit'\ngit remote add origin https://research-git.uiowa.edu/itpetersen/PetersenLab.git\ngit remote -v\ngit push -u origin master\n\nDrag and drop the folder with the repository into the GUI app\nAdd .gitignore file with .Rhistory",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "git.html#creating-r-scripts-repo-on-lab-server",
    "href": "git.html#creating-r-scripts-repo-on-lab-server",
    "title": "Git, GitLab, and GitHub",
    "section": "5.3 Creating R Scripts Repo on Lab Server",
    "text": "5.3 Creating R Scripts Repo on Lab Server\n\nCreate R Scripts Repo\nOpen R Scripts folder and delete .git folder\nOpen Git Shell and type:\n\ngit init\ngit add .\ngit commit -m 'First commit'\ngit remote add origin https://research-git.uiowa.edu/PetersenLab/R-Scripts.git\ngit remote -v\ngit push -u origin master\n\nMove R Scripts folder to another location\nClone repo into folder:\n\nopen Git Shell\nnavigate to Z:\\TDS II\\Data\\R Scripts\\\n\ngit clone https://research-git.uiowa.edu/PetersenLab/R-Scripts.git .\nThe dot on the end of the git clone command means “the current directory”\nDrag and drop the folder with the repository into the GUI app\nAdd .gitignore file with .Rhistory",
    "crumbs": [
      "About",
      "Git, GitLab, and GitHub"
    ]
  },
  {
    "objectID": "hlm.html",
    "href": "hlm.html",
    "title": "Hierarchical Linear Modeling",
    "section": "",
    "text": "Code#install.packages(\"remotes\")\n#remotes::install_github(\"DevPsyLab/petersenlab\")\n\n\n\n\nCodelibrary(\"petersenlab\")\nlibrary(\"lme4\")\nlibrary(\"nlme\")\nlibrary(\"lmerTest\")\nlibrary(\"MASS\")\nlibrary(\"MCMCglmm\")\nlibrary(\"mgcv\")\nlibrary(\"parallelly\")\nlibrary(\"performance\")\nlibrary(\"ggplot2\")\n\n\n\n\nCodemydata &lt;- read.csv(\"https://osf.io/cqn3d/download\")\n\n\n\n\nCodeset.seed(52242)\n\nmydata$outcome &lt;- rpois(nrow(mydata), 4)",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#install-libraries",
    "href": "hlm.html#install-libraries",
    "title": "Hierarchical Linear Modeling",
    "section": "",
    "text": "Code#install.packages(\"remotes\")\n#remotes::install_github(\"DevPsyLab/petersenlab\")",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#load-libraries",
    "href": "hlm.html#load-libraries",
    "title": "Hierarchical Linear Modeling",
    "section": "",
    "text": "Codelibrary(\"petersenlab\")\nlibrary(\"lme4\")\nlibrary(\"nlme\")\nlibrary(\"lmerTest\")\nlibrary(\"MASS\")\nlibrary(\"MCMCglmm\")\nlibrary(\"mgcv\")\nlibrary(\"parallelly\")\nlibrary(\"performance\")\nlibrary(\"ggplot2\")",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#import-data",
    "href": "hlm.html#import-data",
    "title": "Hierarchical Linear Modeling",
    "section": "",
    "text": "Codemydata &lt;- read.csv(\"https://osf.io/cqn3d/download\")",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#simulate-data",
    "href": "hlm.html#simulate-data",
    "title": "Hierarchical Linear Modeling",
    "section": "",
    "text": "Codeset.seed(52242)\n\nmydata$outcome &lt;- rpois(nrow(mydata), 4)",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#sec-gcm",
    "href": "hlm.html#sec-gcm",
    "title": "Hierarchical Linear Modeling",
    "section": "\n6.1 Growth Curve Models",
    "text": "6.1 Growth Curve Models\n\n6.1.1 Linear Growth Curve Model\n\n6.1.1.1 Plot Observed Growth Curves\n\nCodeggplot(\n  data = mydata,\n  mapping = aes(\n    x = ageYears,\n    y = math,\n    group = id)) +\n  geom_line() +\n  labs(\n    x = \"Age (years)\",\n    y = \"Math Score\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n6.1.1.2 lme4\n\n\nCodelinearMixedModel &lt;- lmer(\n  math ~ sex + ageYearsCentered + sex:ageYearsCentered + (1 + ageYearsCentered | id), # random intercepts and slopes; sex as a fixed-effect predictor of the intercepts and slopes\n  data = mydata,\n  REML = FALSE, #for ML\n  na.action = na.exclude,\n  control = lmerControl(optimizer = \"bobyqa\"))\n\nsummary(linearMixedModel)\n\nLinear mixed model fit by maximum likelihood . t-tests use Satterthwaite's\n  method [lmerModLmerTest]\nFormula: \nmath ~ sex + ageYearsCentered + sex:ageYearsCentered + (1 + ageYearsCentered |  \n    id)\n   Data: mydata\nControl: lmerControl(optimizer = \"bobyqa\")\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n  15857.9   15903.5   -7920.9   15841.9      2213 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.3750 -0.5174  0.0051  0.5239  2.6396 \n\nRandom effects:\n Groups   Name             Variance Std.Dev. Corr\n id       (Intercept)      62.5365  7.9080       \n          ageYearsCentered  0.6767  0.8226   0.08\n Residual                  32.1505  5.6701       \nNumber of obs: 2221, groups:  id, 932\n\nFixed effects:\n                            Estimate Std. Error        df t value Pr(&gt;|t|)    \n(Intercept)                 30.51401    0.56142 752.48747  54.352   &lt;2e-16 ***\nsexfemale                   -0.61290    0.79482 736.39886  -0.771    0.441    \nageYearsCentered             4.26792    0.11253 610.09410  37.925   &lt;2e-16 ***\nsexfemale:ageYearsCentered  -0.02558    0.16092 598.89155  -0.159    0.874    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) sexfml agYrsC\nsexfemale   -0.706              \nageYrsCntrd -0.635  0.448       \nsxfml:gYrsC  0.444 -0.631 -0.699\n\nCodeprint(effectsize::standardize_parameters(\n  linearMixedModel,\n  method = \"refit\"),\n  digits = 2)\n\n# Standardization method: refit\n\nParameter                       | Std. Coef. |        95% CI\n------------------------------------------------------------\n(Intercept)                     |       0.03 | [-0.04, 0.10]\nsex [female]                    |      -0.06 | [-0.15, 0.04]\nageYearsCentered                |       0.61 | [ 0.58, 0.64]\nsex [female] × ageYearsCentered |  -3.67e-03 | [-0.05, 0.04]\n\n\n\n6.1.1.2.1 Prototypical Growth Curve\n\nCodenewData &lt;- expand.grid(\n  female = c(0, 1),\n  ageYears = c(\n    min(mydata$ageYears, na.rm = TRUE),\n    max(mydata$ageYears, na.rm = TRUE))\n)\n\nnewData$ageYearsCentered &lt;- newData$ageYears - min(newData$ageYears)\n\nnewData$sex &lt;- NA\nnewData$sex[which(newData$female == 0)] &lt;- \"male\"\nnewData$sex[which(newData$female == 1)] &lt;- \"female\"\nnewData$sex &lt;- as.factor(newData$sex)\n\nnewData$predictedValue &lt;- predict( # predict.merMod\n  linearMixedModel,\n  newdata = newData,\n  re.form = NA\n)\n\nggplot(\n  data = newData,\n  mapping = aes(\n    x = ageYears,\n    y = predictedValue,\n    color = sex)) +\n  geom_line() +\n  labs(\n    x = \"Age (years)\",\n    y = \"Math Score\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n6.1.1.2.2 Individuals’ Growth Curves\n\nCodemydata$predictedValue &lt;- predict(\n  linearMixedModel,\n  newdata = mydata,\n  re.form = NULL\n)\n\nggplot(\n  data = mydata,\n  mapping = aes(\n    x = ageYears,\n    y = predictedValue,\n    group = id,\n    color = sex)) +\n  geom_line(\n    alpha = 0.4\n  ) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Math Score\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n6.1.1.2.3 Individuals’ Trajectories Overlaid with Prototypical Trajectory\n\nCodeggplot(\n  data = mydata,\n  mapping = aes(\n    x = ageYears,\n    y = predictedValue,\n    group = id)) +\n  geom_line( # individuals' trajectories\n    color = \"gray\",\n    alpha = 0.5\n  ) +\n  geom_line( # prototypical trajectory\n    data = newData,\n    mapping = aes(\n      x = ageYears,\n      y = predictedValue,\n      group = sex,\n      color = sex),\n    linewidth = 2) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Math Score\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n6.1.1.2.4 Extract Random Effects\n\nCoderanef(linearMixedModel)\n\n\n\n\n$id\n     (Intercept) ageYearsCentered\n201     1.125314        0.2140257\n303   -12.515509       -0.6614897\n2702   12.257492        0.4307630\n4303    2.727958        0.2850021\n5002    1.943701        0.1707896\n5005    4.045983        0.1202867\n\nwith conditional variances for \"id\" \n\n\n\n6.1.1.3 nlme\n\n\nCodelinearMixedModel_nlme &lt;- lme(\n  math ~ sex + ageYearsCentered + sex:ageYearsCentered, # sex as a fixed-effect predictor of the intercepts and slopes\n  random = ~ 1 + ageYearsCentered|id, # random intercepts and slopes\n  data = mydata,\n  method = \"ML\",\n  na.action = na.exclude)\n\nsummary(linearMixedModel_nlme)\n\nLinear mixed-effects model fit by maximum likelihood\n  Data: mydata \n       AIC     BIC    logLik\n  15857.85 15903.5 -7920.926\n\nRandom effects:\n Formula: ~1 + ageYearsCentered | id\n Structure: General positive-definite, Log-Cholesky parametrization\n                 StdDev    Corr  \n(Intercept)      7.9079987 (Intr)\nageYearsCentered 0.8225933 0.082 \nResidual         5.6701380       \n\nFixed effects:  math ~ sex + ageYearsCentered + sex:ageYearsCentered \n                               Value Std.Error   DF  t-value p-value\n(Intercept)                30.514011 0.5619217 1287 54.30296  0.0000\nsexfemale                  -0.612896 0.7955333  930 -0.77042  0.4412\nageYearsCentered            4.267923 0.1126360 1287 37.89130  0.0000\nsexfemale:ageYearsCentered -0.025585 0.1610671 1287 -0.15885  0.8738\n Correlation: \n                           (Intr) sexfml agYrsC\nsexfemale                  -0.706              \nageYearsCentered           -0.635  0.448       \nsexfemale:ageYearsCentered  0.444 -0.631 -0.699\n\nStandardized Within-Group Residuals:\n         Min           Q1          Med           Q3          Max \n-3.375034869 -0.517409797  0.005105047  0.523910718  2.639557775 \n\nNumber of Observations: 2221\nNumber of Groups: 932 \n\nCodeprint(effectsize::standardize_parameters(\n  linearMixedModel_nlme,\n  method = \"refit\"),\n  digits = 2)\n\n# Standardization method: refit\n\nParameter                       | Std. Coef. |        95% CI\n------------------------------------------------------------\n(Intercept)                     |       0.03 | [-0.04, 0.10]\nsex [female]                    |      -0.06 | [-0.15, 0.04]\nageYearsCentered                |       0.61 | [ 0.58, 0.64]\nsex [female] × ageYearsCentered |  -3.67e-03 | [-0.05, 0.04]\n\n\n\n6.1.1.4 Intraclass Correlation Coefficent\n\nCodeicc(linearMixedModel)\n\n\n  \n\n\nCodeicc(linearMixedModel_nlme)\n\n\n  \n\n\n\n\n6.1.2 Growth Curve Model with Timepoint-Specific Errors\nAdapted from Usami & Murayama (2018):\n\nCodetimepointSpecificErrorsMixedModel &lt;- lmer(\n  math ~ sex + ageYearsCentered + sex:ageYearsCentered + (1 | id) + (1 | ageYearsCentered), # timepoint-specific errors: observations are cross-classified with person and timepoint; sex as a fixed-effect predictor of the intercepts and slopes\n  data = mydata,\n  REML = FALSE, #for ML\n  na.action = na.exclude,\n  control = lmerControl(optimizer = \"bobyqa\"))\n\nsummary(timepointSpecificErrorsMixedModel)\n\nLinear mixed model fit by maximum likelihood . t-tests use Satterthwaite's\n  method [lmerModLmerTest]\nFormula: math ~ sex + ageYearsCentered + sex:ageYearsCentered + (1 | id) +  \n    (1 | ageYearsCentered)\n   Data: mydata\nControl: lmerControl(optimizer = \"bobyqa\")\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n  15808.6   15848.5   -7897.3   15794.6      2214 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.5409 -0.5191  0.0051  0.5093  2.7345 \n\nRandom effects:\n Groups           Name        Variance Std.Dev.\n id               (Intercept) 76.219   8.730   \n ageYearsCentered (Intercept)  4.503   2.122   \n Residual                     30.842   5.554   \nNumber of obs: 2221, groups:  id, 932; ageYearsCentered, 94\n\nFixed effects:\n                             Estimate Std. Error         df t value Pr(&gt;|t|)\n(Intercept)                  29.87438    0.75758  211.81838  39.434   &lt;2e-16\nsexfemale                    -0.38123    0.82243 1960.43213  -0.464    0.643\nageYearsCentered              4.26419    0.14813  132.95739  28.786   &lt;2e-16\nsexfemale:ageYearsCentered   -0.08143    0.14596 1364.56012  -0.558    0.577\n                              \n(Intercept)                ***\nsexfemale                     \nageYearsCentered           ***\nsexfemale:ageYearsCentered    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) sexfml agYrsC\nsexfemale   -0.545              \nageYrsCntrd -0.758  0.321       \nsxfml:gYrsC  0.356 -0.652 -0.482\n\nCodeprint(effectsize::standardize_parameters(\n  timepointSpecificErrorsMixedModel,\n  method = \"refit\"),\n  digits = 2)\n\n# Standardization method: refit\n\nParameter                       | Std. Coef. |         95% CI\n-------------------------------------------------------------\n(Intercept)                     |      -1.27 | [-1.39, -1.15]\nsex [female]                    |      -0.03 | [-0.16,  0.10]\nageYearsCentered                |       0.33 | [ 0.31,  0.36]\nsex [female] × ageYearsCentered |  -6.36e-03 | [-0.03,  0.02]\n\n\n\n6.1.3 Quadratic Growth Curve Model\nWhen using higher-order polynomials, we could specify contrast codes for time to reduce multicollinearity between the linear and quadratic growth factors: https://tdjorgensen.github.io/SEM-in-Ed-compendium/ch27.html#saturated-growth-model\n\nCodefactorLoadings &lt;- poly(\n  x = c(0,1,2,3), # times (can allow unequal spacing)\n  degree = 2)\n\nfactorLoadings\n\n              1    2\n[1,] -0.6708204  0.5\n[2,] -0.2236068 -0.5\n[3,]  0.2236068 -0.5\n[4,]  0.6708204  0.5\nattr(,\"coefs\")\nattr(,\"coefs\")$alpha\n[1] 1.5 1.5\n\nattr(,\"coefs\")$norm2\n[1] 1 4 5 4\n\nattr(,\"degree\")\n[1] 1 2\nattr(,\"class\")\n[1] \"poly\"   \"matrix\"\n\nCodelinearLoadings &lt;- factorLoadings[,1]\nquadraticLoadings &lt;- factorLoadings[,2]\n\nlinearLoadings\n\n[1] -0.6708204 -0.2236068  0.2236068  0.6708204\n\nCodequadraticLoadings\n\n[1]  0.5 -0.5 -0.5  0.5\n\n\n\n6.1.3.1 Fit Model\n\nCodequadraticGCM &lt;- lmer(\n  math ~ sex + ageYearsCentered + ageYearsCenteredSquared + sex:ageYearsCentered + sex:ageYearsCenteredSquared + (1 + ageYearsCentered | id), # random intercepts and linear slopes; fixed quadratic slopes; sex as a fixed-effect predictor of the intercepts and slopes\n  data = mydata,\n  REML = FALSE, #for ML\n  na.action = na.exclude,\n  control = lmerControl(optimizer = \"bobyqa\"))\n\nsummary(quadraticGCM)\n\nLinear mixed model fit by maximum likelihood . t-tests use Satterthwaite's\n  method [lmerModLmerTest]\nFormula: \nmath ~ sex + ageYearsCentered + ageYearsCenteredSquared + sex:ageYearsCentered +  \n    sex:ageYearsCenteredSquared + (1 + ageYearsCentered | id)\n   Data: mydata\nControl: lmerControl(optimizer = \"bobyqa\")\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n  15666.9   15724.0   -7823.5   15646.9      2211 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.3660 -0.4945  0.0048  0.5085  2.4377 \n\nRandom effects:\n Groups   Name             Variance Std.Dev. Corr \n id       (Intercept)      69.8860  8.3598        \n          ageYearsCentered  0.7099  0.8426   -0.05\n Residual                  27.1959  5.2150        \nNumber of obs: 2221, groups:  id, 932\n\nFixed effects:\n                                    Estimate Std. Error         df t value\n(Intercept)                         23.43112    0.84914 1380.85816  27.594\nsexfemale                            0.61167    1.18734 1370.91791   0.515\nageYearsCentered                     8.79334    0.42555 1381.21301  20.664\nageYearsCenteredSquared             -0.57623    0.05255 1382.10819 -10.966\nsexfemale:ageYearsCentered          -0.62379    0.60301 1386.34429  -1.034\nsexfemale:ageYearsCenteredSquared    0.05700    0.07582 1393.17373   0.752\n                                  Pr(&gt;|t|)    \n(Intercept)                         &lt;2e-16 ***\nsexfemale                            0.607    \nageYearsCentered                    &lt;2e-16 ***\nageYearsCenteredSquared             &lt;2e-16 ***\nsexfemale:ageYearsCentered           0.301    \nsexfemale:ageYearsCenteredSquared    0.452    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) sexfml agYrsC agYrCS sxf:YC\nsexfemale   -0.715                            \nageYrsCntrd -0.836  0.598                     \nagYrsCntrdS  0.759 -0.543 -0.969              \nsxfml:gYrsC  0.590 -0.829 -0.706  0.683       \nsxfml:gYrCS -0.526  0.751  0.671 -0.693 -0.968\n\nCodeprint(effectsize::standardize_parameters(\n  quadraticGCM,\n  method = \"refit\"),\n  digits = 2)\n\n# Standardization method: refit\n\nParameter                              | Std. Coef. |         95% CI\n--------------------------------------------------------------------\n(Intercept)                            |       0.02 | [-0.05,  0.08]\nsex [female]                           |      -0.06 | [-0.15,  0.04]\nageYearsCentered                       |       1.26 | [ 1.14,  1.38]\nageYearsCenteredSquared                |      -0.67 | [-0.79, -0.55]\nsex [female] × ageYearsCentered        |      -0.09 | [-0.26,  0.08]\nsex [female] × ageYearsCenteredSquared |       0.07 | [-0.11,  0.24]\n\n\nThis is equivalent to:\n\nCodequadraticGCM &lt;- lmer(\n  math ~ sex + ageYearsCentered + I(ageYearsCentered^2) + sex:ageYearsCentered + sex:I(ageYearsCentered^2) + (1 + ageYearsCentered | id), # random intercepts and slopes; sex as a fixed-effect predictor of the intercepts and slopes\n  data = mydata,\n  REML = FALSE, #for ML\n  na.action = na.exclude,\n  control = lmerControl(optimizer = \"bobyqa\"))\n\nsummary(quadraticGCM)\n\nLinear mixed model fit by maximum likelihood . t-tests use Satterthwaite's\n  method [lmerModLmerTest]\nFormula: \nmath ~ sex + ageYearsCentered + I(ageYearsCentered^2) + sex:ageYearsCentered +  \n    sex:I(ageYearsCentered^2) + (1 + ageYearsCentered | id)\n   Data: mydata\nControl: lmerControl(optimizer = \"bobyqa\")\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n  15666.9   15724.0   -7823.5   15646.9      2211 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.3660 -0.4945  0.0048  0.5085  2.4377 \n\nRandom effects:\n Groups   Name             Variance Std.Dev. Corr \n id       (Intercept)      69.8860  8.3598        \n          ageYearsCentered  0.7099  0.8426   -0.05\n Residual                  27.1959  5.2150        \nNumber of obs: 2221, groups:  id, 932\n\nFixed effects:\n                                  Estimate Std. Error         df t value\n(Intercept)                       23.43112    0.84914 1380.85816  27.594\nsexfemale                          0.61167    1.18734 1370.91791   0.515\nageYearsCentered                   8.79334    0.42555 1381.21301  20.664\nI(ageYearsCentered^2)             -0.57623    0.05255 1382.10819 -10.966\nsexfemale:ageYearsCentered        -0.62379    0.60301 1386.34429  -1.034\nsexfemale:I(ageYearsCentered^2)    0.05700    0.07582 1393.17373   0.752\n                                Pr(&gt;|t|)    \n(Intercept)                       &lt;2e-16 ***\nsexfemale                          0.607    \nageYearsCentered                  &lt;2e-16 ***\nI(ageYearsCentered^2)             &lt;2e-16 ***\nsexfemale:ageYearsCentered         0.301    \nsexfemale:I(ageYearsCentered^2)    0.452    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) sexfml agYrsC I(YC^2 sxf:YC\nsexfemale   -0.715                            \nageYrsCntrd -0.836  0.598                     \nI(gYrsCn^2)  0.759 -0.543 -0.969              \nsxfml:gYrsC  0.590 -0.829 -0.706  0.683       \nsxf:I(YC^2) -0.526  0.751  0.671 -0.693 -0.968\n\nCodeprint(effectsize::standardize_parameters(\n  quadraticGCM,\n  method = \"refit\"),\n  digits = 2)\n\n# Standardization method: refit\n\nParameter                         | Std. Coef. |         95% CI\n---------------------------------------------------------------\n(Intercept)                       |       0.17 | [ 0.10,  0.24]\nsex [female]                      |      -0.07 | [-0.17,  0.03]\nageYearsCentered                  |       0.64 | [ 0.61,  0.67]\nageYearsCentered^2                |      -0.15 | [-0.18, -0.12]\nsex [female] × ageYearsCentered   |      -0.03 | [-0.07,  0.01]\nsex [female] × ageYearsCentered^2 |       0.02 | [-0.02,  0.05]\n\n\n\n6.1.3.2 Prototypical Growth Curve\n\nCodenewData &lt;- expand.grid(\n  female = c(0, 1),\n  ageYears = seq(from = min(mydata$ageYears, na.rm = TRUE), to = max(mydata$ageYears, na.rm = TRUE), length.out = 10000))\n\nnewData$ageYearsCentered &lt;- newData$ageYears - min(newData$ageYears)\nnewData$ageYearsCenteredSquared &lt;- newData$ageYearsCentered ^ 2\n\nnewData$sex &lt;- NA\nnewData$sex[which(newData$female == 0)] &lt;- \"male\"\nnewData$sex[which(newData$female == 1)] &lt;- \"female\"\nnewData$sex &lt;- as.factor(newData$sex)\n\nnewData$predictedValue &lt;- predict( # predict.merMod\n  quadraticGCM,\n  newdata = newData,\n  re.form = NA\n)\n\nggplot(\n  data = newData,\n  mapping = aes(\n    x = ageYears,\n    y = predictedValue,\n    color = sex)) +\n  geom_line() +\n  labs(\n    x = \"Age (years)\",\n    y = \"Math Score\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n6.1.3.3 Individuals’ Growth Curves\n\nCodemydata$predictedValue &lt;- predict(\n  quadraticGCM,\n  newdata = mydata,\n  re.form = NULL\n)\n\nggplot(\n  data = mydata,\n  mapping = aes(\n    x = ageYears,\n    y = predictedValue,\n    group = id,\n    color = sex)) +\n  geom_line(\n    stat = \"smooth\",\n    method = \"lm\",\n    formula = y ~ x + I(x^2),\n    se = FALSE,\n    linewidth = 0.5,\n    alpha = 0.4\n  ) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Math Score\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n6.1.3.4 Individuals’ Trajectories Overlaid with Prototypical Trajectory\n\nCodeggplot(\n  data = mydata,\n  mapping = aes(\n    x = ageYears,\n    y = predictedValue,\n    group = id)) +\n  geom_line( # individuals' trajectories\n    stat = \"smooth\",\n    method = \"lm\",\n    formula = y ~ x + I(x^2),\n    se = FALSE,\n    linewidth = 0.5,\n    color = \"gray\",\n    alpha = 0.4\n  ) +\n  geom_line( # prototypical trajectory\n    data = newData,\n    mapping = aes(\n      x = ageYears,\n      y = predictedValue,\n      group = sex,\n      color = sex),\n    linewidth = 2) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Math Score\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n6.1.3.5 Extract Random Effects\n\nCoderanef(quadraticGCM)\n\n\n\n\n$id\n     (Intercept) ageYearsCentered\n201    0.3392871        0.2048916\n303  -14.2395541       -0.5404362\n2702  13.6789236        0.6053891\n4303   1.8792650        0.2622509\n5002   1.6186752        0.3766872\n5005   5.0034217        0.1103062\n\nwith conditional variances for \"id\" \n\n\n\n6.1.4 Spline Growth Curve Model\n\n6.1.4.1 Create Knot\n\nCodemydata$knot &lt;- NA\nmydata$knot[which(mydata$ageYears &lt;= 11)] &lt;- 0\nmydata$knot[which(mydata$ageYears &gt; 11)] &lt;- 1\n\n\n\n6.1.4.2 Fit Model\n\nCodesplineGCM &lt;- lmer(\n  math ~ sex + ageYearsCentered + sex:ageYearsCentered + knot + knot:ageYearsCentered + sex:knot + sex:knot:ageYearsCentered + (1 + ageYearsCentered | id), # random intercepts and linear slopes; fixed quadratic slopes; sex as a fixed-effect predictor of the intercepts and slopes\n  data = mydata,\n  REML = FALSE, #for ML\n  na.action = na.exclude,\n  control = lmerControl(optimizer = \"bobyqa\"))\n\nsummary(splineGCM)\n\nLinear mixed model fit by maximum likelihood . t-tests use Satterthwaite's\n  method [lmerModLmerTest]\nFormula: math ~ sex + ageYearsCentered + sex:ageYearsCentered + knot +  \n    knot:ageYearsCentered + sex:knot + sex:knot:ageYearsCentered +  \n    (1 + ageYearsCentered | id)\n   Data: mydata\nControl: lmerControl(optimizer = \"bobyqa\")\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n  15691.2   15759.6   -7833.6   15667.2      2209 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.3041 -0.5021 -0.0075  0.5034  2.4850 \n\nRandom effects:\n Groups   Name             Variance Std.Dev. Corr \n id       (Intercept)      68.3568  8.2678        \n          ageYearsCentered  0.7018  0.8377   -0.03\n Residual                  27.7772  5.2704        \nNumber of obs: 2221, groups:  id, 932\n\nFixed effects:\n                                 Estimate Std. Error        df t value Pr(&gt;|t|)\n(Intercept)                       25.9318     0.7222 1223.0139  35.909  &lt; 2e-16\nsexfemale                          0.3473     1.0060 1208.6807   0.345    0.730\nageYearsCentered                   6.2092     0.2328 1374.3269  26.674  &lt; 2e-16\nknot                              12.6515     1.8238 1241.0685   6.937 6.43e-12\nsexfemale:ageYearsCentered        -0.3785     0.3240 1373.1043  -1.168    0.243\nageYearsCentered:knot             -3.4908     0.3746 1283.6771  -9.318  &lt; 2e-16\nsexfemale:knot                    -1.2105     2.6098 1234.2550  -0.464    0.643\nsexfemale:ageYearsCentered:knot    0.3530     0.5383 1279.7386   0.656    0.512\n                                   \n(Intercept)                     ***\nsexfemale                          \nageYearsCentered                ***\nknot                            ***\nsexfemale:ageYearsCentered         \nageYearsCentered:knot           ***\nsexfemale:knot                     \nsexfemale:ageYearsCentered:knot    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) sexfml agYrsC knot   sxf:YC agYrC: sxfml:\nsexfemale   -0.718                                          \nageYrsCntrd -0.786  0.564                                   \nknot        -0.267  0.192  0.266                            \nsxfml:gYrsC  0.565 -0.776 -0.718 -0.191                     \nagYrsCntrd:  0.470 -0.337 -0.568 -0.925  0.408              \nsexfeml:knt  0.187 -0.259 -0.186 -0.699  0.262  0.646       \nsxfml:gYrC: -0.327  0.455  0.395  0.644 -0.559 -0.696 -0.927\n\nCodeprint(effectsize::standardize_parameters(\n  splineGCM,\n  method = \"refit\"),\n  digits = 2)\n\n# Standardization method: refit\n\nParameter                                | Std. Coef. |         95% CI\n----------------------------------------------------------------------\n(Intercept)                              |       0.23 | [ 0.15,  0.30]\nsex [female]                             |      -0.08 | [-0.19,  0.03]\nageYearsCentered                         |       0.69 | [ 0.63,  0.74]\nknot                                     |      -0.02 | [-0.07,  0.04]\nsex [female] × ageYearsCentered          |      -0.03 | [-0.11,  0.04]\nageYearsCentered × knot                  |      -0.25 | [-0.30, -0.19]\nsex [female] × knot                      |   4.24e-03 | [-0.08,  0.08]\n(sex [female] × ageYearsCentered) × knot |       0.02 | [-0.05,  0.10]\n\n\n\n6.1.4.3 Prototypical Growth Curve\n\nCodenewData &lt;- expand.grid(\n  female = c(0, 1),\n  ageYears = seq(from = min(mydata$ageYears, na.rm = TRUE), to = max(mydata$ageYears, na.rm = TRUE), length.out = 10000))\n\nnewData$ageYearsCentered &lt;- newData$ageYears - min(newData$ageYears)\n\nnewData$knot &lt;- NA\nnewData$knot[which(newData$ageYears &lt;= 11)] &lt;- 0\nnewData$knot[which(newData$ageYears &gt; 11)] &lt;- 1\n\nnewData$sex &lt;- NA\nnewData$sex[which(newData$female == 0)] &lt;- \"male\"\nnewData$sex[which(newData$female == 1)] &lt;- \"female\"\nnewData$sex &lt;- as.factor(newData$sex)\n\nnewData$predictedValue &lt;- predict( # predict.merMod\n  splineGCM,\n  newdata = newData,\n  re.form = NA\n)\n\nggplot(\n  data = newData,\n  mapping = aes(\n    x = ageYears,\n    y = predictedValue,\n    color = sex)) +\n  geom_line() +\n  labs(\n    x = \"Age (years)\",\n    y = \"Math Score\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n6.1.4.4 Individuals’ Growth Curves\n\nCodemydata$predictedValue &lt;- predict(\n  splineGCM,\n  newdata = mydata,\n  re.form = NULL\n)\n\nggplot(\n  data = mydata,\n  mapping = aes(\n    x = ageYears,\n    y = predictedValue,\n    group = id,\n    color = sex)) +\n  geom_line(\n    alpha = 0.4\n  ) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Math Score\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n6.1.4.5 Individuals’ Trajectories Overlaid with Prototypical Trajectory\n\nCodeggplot(\n  data = mydata,\n  mapping = aes(\n    x = ageYears,\n    y = predictedValue,\n    group = id)) +\n  geom_line( # individuals' trajectories\n    color = \"gray\",\n    alpha = 0.5\n  ) +\n  geom_line( # prototypical trajectory\n    data = newData,\n    mapping = aes(\n      x = ageYears,\n      y = predictedValue,\n      group = sex,\n      color = sex),\n    linewidth = 2) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Math Score\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n6.1.4.6 Extract Random Effects\n\nCoderanef(splineGCM)\n\n\n\n\n$id\n     (Intercept) ageYearsCentered\n201     0.652145        0.2083235\n303   -13.900383       -0.5384101\n2702   13.248702        0.4885446\n4303    2.123618        0.2695865\n5002    1.813505        0.3311535\n5005    4.914571        0.1306295\n\nwith conditional variances for \"id\"",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#lmer",
    "href": "hlm.html#lmer",
    "title": "Hierarchical Linear Modeling",
    "section": "\n7.1 lmer\n",
    "text": "7.1 lmer\n\n\nCodegeneralizedLinearMixedModel &lt;- glmer(\n  outcome ~ female + ageYearsCentered + (ageYearsCentered | id),\n  family = poisson(link = \"log\"),\n  data = mydata,\n  na.action = na.exclude)\n\nsummary(generalizedLinearMixedModel)\n\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: poisson  ( log )\nFormula: outcome ~ female + ageYearsCentered + (ageYearsCentered | id)\n   Data: mydata\n\n      AIC       BIC    logLik -2*log(L)  df.resid \n   9329.7    9363.9   -4658.8    9317.7      2215 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.0331 -0.5546 -0.0205  0.5350  5.0222 \n\nRandom effects:\n Groups Name             Variance  Std.Dev. Corr \n id     (Intercept)      0.0058309 0.07636       \n        ageYearsCentered 0.0002845 0.01687  -1.00\nNumber of obs: 2221, groups:  id, 932\n\nFixed effects:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)      1.343986   0.026879  50.001   &lt;2e-16 ***\nfemale           0.007439   0.021268   0.350   0.7265    \nageYearsCentered 0.010279   0.005804   1.771   0.0766 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) female\nfemale      -0.421       \nageYrsCntrd -0.831  0.036\noptimizer (Nelder_Mead) convergence code: 0 (OK)\nboundary (singular) fit: see help('isSingular')\n\nCodeprint(effectsize::standardize_parameters(\n  generalizedLinearMixedModel,\n  method = \"refit\"),\n  digits = 2)\n\n# Standardization method: refit\n\nParameter        | Std. Coef. |        95% CI\n---------------------------------------------\n(Intercept)      |       1.39 | [ 1.37, 1.41]\nfemale           |   3.72e-03 | [-0.02, 0.02]\nageYearsCentered |       0.02 | [ 0.00, 0.04]\n\n- Response is unstandardized.",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#mass",
    "href": "hlm.html#mass",
    "title": "Hierarchical Linear Modeling",
    "section": "\n7.2 MASS\n",
    "text": "7.2 MASS\n\n\nCodeglmmPQLmodel &lt;- glmmPQL(\n  outcome ~ female + ageYearsCentered,\n  random = ~ 1 + ageYearsCentered|id,\n  family = poisson(link = \"log\"),\n  data = mydata)\n\nsummary(glmmPQLmodel)\n\nLinear mixed-effects model fit by maximum likelihood\n  Data: mydata \n  AIC BIC logLik\n   NA  NA     NA\n\nRandom effects:\n Formula: ~1 + ageYearsCentered | id\n Structure: General positive-definite, Log-Cholesky parametrization\n                 StdDev       Corr  \n(Intercept)      5.533290e-05 (Intr)\nageYearsCentered 9.320922e-08 0     \nResidual         1.014184e+00       \n\nVariance function:\n Structure: fixed weights\n Formula: ~invwt \nFixed effects:  outcome ~ female + ageYearsCentered \n                     Value   Std.Error   DF  t-value p-value\n(Intercept)      1.3453017 0.027100741 1288 49.64077  0.0000\nfemale           0.0074130 0.021543030  930  0.34410  0.7308\nageYearsCentered 0.0100806 0.005850753 1288  1.72296  0.0851\n Correlation: \n                 (Intr) female\nfemale           -0.423       \nageYearsCentered -0.829  0.036\n\nStandardized Within-Group Residuals:\n        Min          Q1         Med          Q3         Max \n-2.00970268 -0.55110605 -0.02158036  0.53179575  4.98914420 \n\nNumber of Observations: 2221\nNumber of Groups: 932 \n\nCodeprint(effectsize::standardize_parameters(\n  glmmPQLmodel,\n  method = \"refit\"),\n  digits = 2)\n\n# Standardization method: refit\n\nParameter        | Std. Coef. |        95% CI\n---------------------------------------------\n(Intercept)      |       1.39 | [ 1.37, 1.41]\nfemale           |   3.71e-03 | [-0.02, 0.02]\nageYearsCentered |       0.02 | [ 0.00, 0.04]\n\n- Response is unstandardized.",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#mcmcglmm",
    "href": "hlm.html#mcmcglmm",
    "title": "Hierarchical Linear Modeling",
    "section": "\n7.3 MCMCglmm\n",
    "text": "7.3 MCMCglmm\n\n\nCodeMCMCglmmModel &lt;- MCMCglmm(\n  outcome ~ female + ageYearsCentered,\n  random = ~ us(ageYearsCentered):id,\n  family = \"poisson\",\n  data = na.omit(mydata[,c(\"id\",\"outcome\",\"female\",\"ageYearsCentered\")]))\n\n\n                       MCMC iteration = 0\n\n Acceptance ratio for liability set 1 = 0.000410\n\n                       MCMC iteration = 1000\n\n Acceptance ratio for liability set 1 = 0.439819\n\n                       MCMC iteration = 2000\n\n Acceptance ratio for liability set 1 = 0.439977\n\n                       MCMC iteration = 3000\n\n Acceptance ratio for liability set 1 = 0.444608\n\n                       MCMC iteration = 4000\n\n Acceptance ratio for liability set 1 = 0.496749\n\n                       MCMC iteration = 5000\n\n Acceptance ratio for liability set 1 = 0.490778\n\n                       MCMC iteration = 6000\n\n Acceptance ratio for liability set 1 = 0.512362\n\n                       MCMC iteration = 7000\n\n Acceptance ratio for liability set 1 = 0.428231\n\n                       MCMC iteration = 8000\n\n Acceptance ratio for liability set 1 = 0.412336\n\n                       MCMC iteration = 9000\n\n Acceptance ratio for liability set 1 = 0.471726\n\n                       MCMC iteration = 10000\n\n Acceptance ratio for liability set 1 = 0.428491\n\n                       MCMC iteration = 11000\n\n Acceptance ratio for liability set 1 = 0.400078\n\n                       MCMC iteration = 12000\n\n Acceptance ratio for liability set 1 = 0.346435\n\n                       MCMC iteration = 13000\n\n Acceptance ratio for liability set 1 = 0.276170\n\nCodesummary(MCMCglmmModel)\n\n\n Iterations = 3001:12991\n Thinning interval  = 10\n Sample size  = 1000 \n\n DIC: 9323.524 \n\n G-structure:  ~us(ageYearsCentered):id\n\n                                     post.mean  l-95% CI  u-95% CI eff.samp\nageYearsCentered:ageYearsCentered.id 6.754e-06 1.087e-08 4.053e-05    7.788\n\n R-structure:  ~units\n\n      post.mean l-95% CI u-95% CI eff.samp\nunits   0.00877 0.001634  0.01728    7.797\n\n Location effects: outcome ~ female + ageYearsCentered \n\n                 post.mean  l-95% CI  u-95% CI eff.samp  pMCMC    \n(Intercept)       1.338707  1.281096  1.387614    55.58 &lt;0.001 ***\nfemale            0.007688 -0.031193  0.052271    58.65  0.706    \nageYearsCentered  0.010561  0.000813  0.021420    57.32  0.046 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#sec-gamm",
    "href": "hlm.html#sec-gamm",
    "title": "Hierarchical Linear Modeling",
    "section": "\n8.1 Generalized Additive Mixed Model",
    "text": "8.1 Generalized Additive Mixed Model\n\n8.1.1 Fit Model\n\nCodenum_cores &lt;- parallelly::availableCores() - 1\nnum_true_cores &lt;- parallelly::availableCores(logical = FALSE) - 1\n\n\n\nCodegamModel &lt;- mgcv::gam(\n  math ~ s(ageYearsCentered, by = sex) + s(id, ageYearsCentered, bs = \"re\"),\n  data = mydata,\n  nthreads = num_cores\n)\n\nsummary(gamModel)\n\n\nFamily: gaussian \nLink function: identity \n\nFormula:\nmath ~ s(ageYearsCentered, by = sex) + s(id, ageYearsCentered, \n    bs = \"re\")\n\nParametric coefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  49.9227     0.3718   134.3   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nApproximate significance of smooth terms:\n                                 edf Ref.df     F p-value    \ns(ageYearsCentered):sexmale   2.8831  3.613 219.7  &lt;2e-16 ***\ns(ageYearsCentered):sexfemale 6.2237  6.805 120.3  &lt;2e-16 ***\ns(id,ageYearsCentered)        0.9932  1.000 155.5  &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nRank: 18/20\nR-sq.(adj) =  0.396   Deviance explained = 39.9%\nGCV = 99.429  Scale est. = 98.933    n = 2221\n\nCodeprint(effectsize::standardize_parameters(\n  gamModel,\n  method = \"refit\"),\n  digits = 2)\n\n# Standardization method: refit\n\nComponent    |                                  Parameter | Std. Coef. |        95% CI\n--------------------------------------------------------------------------------------\nconditional  |                                (Intercept) |  -1.80e-03 | [-0.04, 0.03]\nsmooth_terms |   Smooth term (ageYearsCentered) × sexmale |            |              \nsmooth_terms | Smooth term (ageYearsCentered) × sexfemale |            |              \nsmooth_terms |          Smooth term (id,ageYearsCentered) |            |              \n\n\n\n8.1.2 Prototypical Growth Curve\n\nCodenewData &lt;- expand.grid(\n  female = c(0, 1),\n  ageYears = seq(from = min(mydata$ageYears, na.rm = TRUE), to = max(mydata$ageYears, na.rm = TRUE), length.out = 10000))\n\nnewData$ageYearsCentered &lt;- newData$ageYears - min(newData$ageYears)\nnewData$ageYearsCenteredSquared &lt;- newData$ageYearsCentered ^ 2\n\nnewData$sex &lt;- NA\nnewData$sex[which(newData$female == 0)] &lt;- \"male\"\nnewData$sex[which(newData$female == 1)] &lt;- \"female\"\nnewData$sex &lt;- as.factor(newData$sex)\n\n# add a dummy id\nnewData$id &lt;- mydata$id[1]\n\nnewData$predictedValue &lt;- predict(\n  gamModel,\n  newdata = newData,\n  exclude = \"s(ageYearsCentered,id)\"\n)\n\nggplot(\n  data = newData,\n  mapping = aes(\n    x = ageYears,\n    y = predictedValue,\n    color = sex)) +\n  geom_line() +\n  labs(\n    x = \"Age (years)\",\n    y = \"Math Score\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n8.1.3 Individuals’ Growth Curves\n\nCodemydata$predictedValue &lt;- predict(\n  gamModel,\n  newdata = mydata\n)\n\ngamMethod &lt;- function(formula, data, weights, ...) { # from here: https://stackoverflow.com/a/76762792/2029527\n  if(nrow(data) &lt; 4) return(lm(y ~ x, data = data, ...))\n  else  mgcv::gam(y ~ s(x, bs = \"cs\", k = 3), data = data, ...)\n}\n\nggplot(\n  data = mydata,\n  mapping = aes(\n    x = ageYears,\n    y = predictedValue,\n    group = id,\n    color = sex)) +\n  geom_line(\n    stat = \"smooth\",\n    method = gamMethod,\n    se = FALSE,\n    linewidth = 0.5,\n    alpha = 0.4\n  ) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Math Score\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n8.1.4 Individuals’ Trajectories Overlaid with Prototypical Trajectory\n\nCodeggplot(\n  data = mydata,\n  mapping = aes(\n    x = ageYears,\n    y = predictedValue,\n    group = id)) +\n  geom_line( # individuals' trajectories\n    stat = \"smooth\",\n    method = gamMethod,\n    se = FALSE,\n    linewidth = 0.5,\n    color = \"gray\",\n    alpha = 0.4\n  ) +\n  geom_line( # prototypical trajectory\n    data = newData,\n    mapping = aes(\n      x = ageYears,\n      y = predictedValue,\n      group = sex,\n      color = sex),\n    linewidth = 2) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Math Score\",\n    color = \"Sex\"\n  ) +\n  theme_classic()",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#sec-nonlinearAsymptotic",
    "href": "hlm.html#sec-nonlinearAsymptotic",
    "title": "Hierarchical Linear Modeling",
    "section": "\n8.2 Asymptotic Growth",
    "text": "8.2 Asymptotic Growth\n\nCodenonlinearModel &lt;- nlme(\n  height ~ SSasymp(age, Asym, R0, lrc),\n  data = Loblolly,\n  fixed = Asym + R0 + lrc ~ 1,\n  random = Asym ~ 1)\n\nsummary(nonlinearModel)\n\nNonlinear mixed-effects model fit by maximum likelihood\n  Model: height ~ SSasymp(age, Asym, R0, lrc) \n  Data: Loblolly \n      AIC      BIC   logLik\n  239.486 251.6401 -114.743\n\nRandom effects:\n Formula: Asym ~ 1 | Seed\n            Asym  Residual\nStdDev: 3.650645 0.7188624\n\nFixed effects:  list(Asym ~ 1, R0 ~ 1, lrc ~ 1) \n         Value Std.Error DF   t-value p-value\nAsym 101.44830 2.4616151 68  41.21209       0\nR0    -8.62749 0.3179519 68 -27.13459       0\nlrc   -3.23373 0.0342695 68 -94.36168       0\n Correlation: \n    Asym   R0    \nR0   0.704       \nlrc -0.908 -0.827\n\nStandardized Within-Group Residuals:\n        Min          Q1         Med          Q3         Max \n-2.23604174 -0.62389999  0.05912777  0.65724316  1.95790785 \n\nNumber of Observations: 84\nNumber of Groups: 14",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#resources",
    "href": "hlm.html#resources",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.1 Resources",
    "text": "11.1 Resources\nPinheiro and Bates (2000) book (p. 174, section 4.3.1)\nhttps://stats.stackexchange.com/questions/77891/checking-assumptions-lmer-lme-mixed-models-in-r (archived at https://perma.cc/J5GC-PCUT)",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#qq-plots",
    "href": "hlm.html#qq-plots",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.2 QQ Plots",
    "text": "11.2 QQ Plots\nMake QQ plots for each level of the random effects. Vary the level from 0, 1, to 2 so that you can check the between- and within-subject residuals.\n\nCodeqqnorm(\n  linearMixedModel_nlme,\n  ~ ranef(., level = 1))",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#pp-plots",
    "href": "hlm.html#pp-plots",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.3 PP Plots",
    "text": "11.3 PP Plots\n\nCodeppPlot(linearMixedModel)",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#qq-plot-of-residuals",
    "href": "hlm.html#qq-plot-of-residuals",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.4 QQ Plot of residuals",
    "text": "11.4 QQ Plot of residuals\n\nCodeqqnorm(resid(linearMixedModel))\nqqline(resid(linearMixedModel))",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#plot-residuals",
    "href": "hlm.html#plot-residuals",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.5 Plot residuals",
    "text": "11.5 Plot residuals\n\nCodeplot(linearMixedModel)",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#plot-residuals-by-group-in-the-example-below-level-2-represents-the-individual",
    "href": "hlm.html#plot-residuals-by-group-in-the-example-below-level-2-represents-the-individual",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.6 Plot residuals by group (in the example below, level 2 represents the individual)",
    "text": "11.6 Plot residuals by group (in the example below, level 2 represents the individual)\n\nCodeplot(\n  linearMixedModel,\n  as.factor(id) ~ resid(.),\n  abline = 0,\n  xlab = \"Residuals\")",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#plot-residuals-by-levels-of-a-predictor",
    "href": "hlm.html#plot-residuals-by-levels-of-a-predictor",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.7 Plot residuals by levels of a predictor",
    "text": "11.7 Plot residuals by levels of a predictor\n\nCodeplot(\n  linearMixedModel_nlme,\n  resid(., type = \"p\") ~ fitted(.) | female) #type = \"p\" specifies standardized residuals",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#can-model-heteroscedasticity-of-the-within-group-error-with-the-weights-argument",
    "href": "hlm.html#can-model-heteroscedasticity-of-the-within-group-error-with-the-weights-argument",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.8 Can model heteroscedasticity of the within-group error with the weights argument",
    "text": "11.8 Can model heteroscedasticity of the within-group error with the weights argument\n\nCodelinearMixedModel_nlmeVarStructure &lt;- lme(\n  math ~ female + ageYearsCentered,\n  random = ~ 1 + ageYearsCentered|id,\n  weights = varIdent(form = ~ 1 | female),\n  method = \"ML\",\n  data = mydata,\n  na.action = na.exclude)\n\nsummary(linearMixedModel_nlmeVarStructure)\n\nLinear mixed-effects model fit by maximum likelihood\n  Data: mydata \n       AIC      BIC    logLik\n  15857.83 15903.48 -7920.915\n\nRandom effects:\n Formula: ~1 + ageYearsCentered | id\n Structure: General positive-definite, Log-Cholesky parametrization\n                 StdDev    Corr  \n(Intercept)      7.9177716 (Intr)\nageYearsCentered 0.8278343 0.076 \nResidual         5.6410162       \n\nVariance function:\n Structure: Different standard deviations per stratum\n Formula: ~1 | female \n Parameter estimates:\n       1        0 \n1.000000 1.009161 \nFixed effects:  math ~ female + ageYearsCentered \n                     Value Std.Error   DF  t-value p-value\n(Intercept)      30.554856 0.5040373 1288 60.62022  0.0000\nfemale           -0.692653 0.6172485  930 -1.12216  0.2621\nageYearsCentered  4.255258 0.0805531 1288 52.82553  0.0000\n Correlation: \n                 (Intr) female\nfemale           -0.614       \nageYearsCentered -0.507  0.014\n\nStandardized Within-Group Residuals:\n        Min          Q1         Med          Q3         Max \n-3.37982974 -0.51663213  0.00445497  0.52228733  2.63205084 \n\nNumber of Observations: 2221\nNumber of Groups: 932",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#plot-observed-and-fitted-values",
    "href": "hlm.html#plot-observed-and-fitted-values",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.9 Plot observed and fitted values",
    "text": "11.9 Plot observed and fitted values\n\nCodeplot(\n  linearMixedModel,\n  math ~ fitted(.))",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#plot-qq-plot-of-residuals-by-levels-of-a-predictor",
    "href": "hlm.html#plot-qq-plot-of-residuals-by-levels-of-a-predictor",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.10 Plot QQ plot of residuals by levels of a predictor",
    "text": "11.10 Plot QQ plot of residuals by levels of a predictor\n\nCodeqqnorm(linearMixedModel_nlme, ~ resid(.) | female)\n\n\n\n\n\n\nCodeqqnorm(linearMixedModel_nlme, ~ resid(.))",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#qq-plot-of-random-effects",
    "href": "hlm.html#qq-plot-of-random-effects",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.11 QQ plot of random effects",
    "text": "11.11 QQ plot of random effects\nMake QQ plots for each level of the random effects. Vary the level from 0, 1, to 2 so that you can check the between- and within-subject residuals.\n\nCodeqqnorm(\n  linearMixedModel_nlme,\n  ~ ranef(., level = 0))\n\nError in `effects[[1L]]`:\n! subscript out of bounds\n\nCodeqqnorm(\n  linearMixedModel_nlme,\n  ~ ranef(., level = 1))\n\n\n\n\n\n\nCodeqqnorm(\n  linearMixedModel_nlme,\n  ~ ranef(., level = 2))\n\nError:\n! object '.y' not found",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#qq-plot-of-random-effects-by-levels-of-a-predictor",
    "href": "hlm.html#qq-plot-of-random-effects-by-levels-of-a-predictor",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.12 QQ plot of random effects by levels of a predictor",
    "text": "11.12 QQ plot of random effects by levels of a predictor\n\nCodeqqnorm(\n  linearMixedModel_nlme,\n  ~ ranef(., level = 1) | female)",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#pairs-plot",
    "href": "hlm.html#pairs-plot",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.13 Pairs plot",
    "text": "11.13 Pairs plot\n\nCodepairs(linearMixedModel_nlme)\n\n\n\n\n\n\nCodepairs(\n  linearMixedModel_nlme,\n  ~ ranef(., level = 1) | female)",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#variance-functions-for-modeling-heteroscedasticity",
    "href": "hlm.html#variance-functions-for-modeling-heteroscedasticity",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.14 Variance functions for modeling heteroscedasticity",
    "text": "11.14 Variance functions for modeling heteroscedasticity\n\n\nvarFixed: fixed variance\n\nvarIdent: different variances per stratum\n\nvarPower: power of covariate\n\nvarExp: exponential of covariate\n\nvarConstPower: constant plus power of covariate\n\nvarComb: combination of variance functions",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "hlm.html#correlation-structures-for-modeling-dependence",
    "href": "hlm.html#correlation-structures-for-modeling-dependence",
    "title": "Hierarchical Linear Modeling",
    "section": "\n11.15 Correlation structures for modeling dependence",
    "text": "11.15 Correlation structures for modeling dependence\n\n\ncorCompSymm: compound symmetry\n\ncorSymm: general\n\ncorAR1: autoregressive of order 1\n\ncorCAR1: continuous-time AR(1)\n\ncorARMA: autoregressive-moving average\n\ncorExp: exponential\n\ncorGaus: Gaussian\n\ncorLin: linear\n\ncorRatio: rational quadratic\n\ncorSpher: spherical",
    "crumbs": [
      "About",
      "Hierarchical Linear Modeling"
    ]
  },
  {
    "objectID": "sem.html",
    "href": "sem.html",
    "title": "Structural Equation Modeling",
    "section": "",
    "text": "For a resource on using lavaan in R for structural equation modeling, see the following e-book: https://tdjorgensen.github.io/SEM-in-Ed-compendium\n\n\nCode#install.packages(\"remotes\")\n#remotes::install_github(\"DevPsyLab/petersenlab\")\n\n\n\n\nCodelibrary(\"lavaan\")\nlibrary(\"semTools\")\nlibrary(\"semPlot\")\nlibrary(\"lavaanPlot\")\nlibrary(\"lavaangui\")\nlibrary(\"lcsm\")\nlibrary(\"MBESS\")\nlibrary(\"tidyverse\")\n\n\n\n\nCodeoptions(scipen = 999)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#install-libraries",
    "href": "sem.html#install-libraries",
    "title": "Structural Equation Modeling",
    "section": "",
    "text": "Code#install.packages(\"remotes\")\n#remotes::install_github(\"DevPsyLab/petersenlab\")",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#load-libraries",
    "href": "sem.html#load-libraries",
    "title": "Structural Equation Modeling",
    "section": "",
    "text": "Codelibrary(\"lavaan\")\nlibrary(\"semTools\")\nlibrary(\"semPlot\")\nlibrary(\"lavaanPlot\")\nlibrary(\"lavaangui\")\nlibrary(\"lcsm\")\nlibrary(\"MBESS\")\nlibrary(\"tidyverse\")",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#options",
    "href": "sem.html#options",
    "title": "Structural Equation Modeling",
    "section": "",
    "text": "Codeoptions(scipen = 999)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#sec-linearLGCM",
    "href": "sem.html#sec-linearLGCM",
    "title": "Structural Equation Modeling",
    "section": "\n7.1 Linear Growth Curve Model",
    "text": "7.1 Linear Growth Curve Model\n\n7.1.1 Model Syntax\n\n7.1.1.1 Abbreviated\n\nCodelgcm1_syntax &lt;- '\n  # Intercept and slope\n  intercept =~ 1*t1 + 1*t2 + 1*t3 + 1*t4\n  slope =~ 0*t1 + 1*t2 + 2*t3 + 3*t4\n\n  # Regression paths\n  intercept ~ x1 + x2\n  slope ~ x1 + x2\n  \n  # Time-varying covariates\n  t1 ~ c1\n  t2 ~ c2\n  t3 ~ c3\n  t4 ~ c4\n'\n\n\n\n7.1.1.2 Full\n\nCodelgcm2_syntax &lt;- '\n  # Intercept and slope\n  intercept =~ 1*t1 + 1*t2 + 1*t3 + 1*t4\n  slope =~ 0*t1 + 1*t2 + 2*t3 + 3*t4\n\n  # Regression paths\n  intercept ~ x1 + x2\n  slope ~ x1 + x2\n  \n  # Time-varying covariates\n  t1 ~ c1\n  t2 ~ c2\n  t3 ~ c3\n  t4 ~ c4\n  \n  # Constrain observed intercepts to zero\n  t1 ~ 0*1\n  t2 ~ 0*1\n  t3 ~ 0*1\n  t4 ~ 0*1\n  \n  # Estimate mean of intercept and slope\n  intercept ~ 1\n  slope ~ 1\n'\n\n\n\n7.1.2 Fit the Model\n\n7.1.2.1 Abbreviated\n\nCodelgcm1_fit &lt;- growth(\n  lgcm1_syntax,\n  data = Demo.growth,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  int.ov.free = FALSE,\n  int.lv.free = TRUE,\n  fixed.x = FALSE,\n  em.h1.iter.max = 100000)\n\n\n\n7.1.2.2 Full\n\nCodelgcm2_fit &lt;- sem(\n  lgcm2_syntax,\n  data = Demo.growth,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  fixed.x = FALSE,\n  em.h1.iter.max = 100000)\n\n\n\n7.1.3 Summary Output\n\n7.1.3.1 Abbreviated\n\nCodesummary(\n  lgcm1_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 32 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        38\n\n  Number of observations                           400\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                40.774      40.982\n  Degrees of freedom                                27          27\n  P-value (Chi-square)                           0.043       0.041\n  Scaling correction factor                                  0.995\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              2345.885    2414.540\n  Degrees of freedom                                30          30\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.972\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.994       0.994\n  Tucker-Lewis Index (TLI)                       0.993       0.993\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.992\n  Robust Tucker-Lewis Index (TLI)                            0.992\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -5782.507   -5782.507\n  Scaling correction factor                                  0.991\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -5762.120   -5762.120\n  Scaling correction factor                                  0.993\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               11641.014   11641.014\n  Bayesian (BIC)                             11792.690   11792.690\n  Sample-size adjusted Bayesian (SABIC)      11672.114   11672.114\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.036       0.036\n  90 Percent confidence interval - lower         0.006       0.007\n  90 Percent confidence interval - upper         0.057       0.057\n  P-value H_0: RMSEA &lt;= 0.050                    0.854       0.849\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.040\n  90 Percent confidence interval - lower                     0.019\n  90 Percent confidence interval - upper                     0.059\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.793\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.030       0.030\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept =~                                                          \n    t1                1.000                               1.386    0.875\n    t2                1.000                               1.386    0.660\n    t3                1.000                               1.386    0.507\n    t4                1.000                               1.386    0.411\n  slope =~                                                              \n    t1                0.000                               0.000    0.000\n    t2                1.000                               0.769    0.366\n    t3                2.000                               1.539    0.562\n    t4                3.000                               2.308    0.685\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept ~                                                           \n    x1                0.608    0.059   10.275    0.000    0.439    0.453\n    x2                0.604    0.062    9.776    0.000    0.436    0.423\n  slope ~                                                               \n    x1                0.262    0.029    8.968    0.000    0.341    0.352\n    x2                0.522    0.032   16.302    0.000    0.678    0.658\n  t1 ~                                                                  \n    c1                0.143    0.045    3.198    0.001    0.143    0.089\n  t2 ~                                                                  \n    c2                0.289    0.047    6.215    0.000    0.289    0.131\n  t3 ~                                                                  \n    c3                0.328    0.047    7.011    0.000    0.328    0.112\n  t4 ~                                                                  \n    c4                0.330    0.057    5.814    0.000    0.330    0.090\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .intercept ~~                                                          \n   .slope             0.075    0.040    1.890    0.059    0.152    0.152\n  x1 ~~                                                                 \n    x2                0.141    0.050    2.798    0.005    0.141    0.140\n    c1               -0.039    0.051   -0.762    0.446   -0.039   -0.038\n    c2                0.023    0.048    0.493    0.622    0.023    0.024\n    c3                0.027    0.050    0.544    0.586    0.027    0.028\n    c4               -0.023    0.045   -0.519    0.604   -0.023   -0.024\n  x2 ~~                                                                 \n    c1               -0.018    0.050   -0.358    0.721   -0.018   -0.019\n    c2               -0.003    0.044   -0.075    0.940   -0.003   -0.004\n    c3                0.155    0.048    3.239    0.001    0.155    0.170\n    c4               -0.104    0.043   -2.421    0.015   -0.104   -0.116\n  c1 ~~                                                                 \n    c2                0.080    0.045    1.793    0.073    0.080    0.086\n    c3               -0.030    0.050   -0.585    0.559   -0.030   -0.032\n    c4                0.127    0.048    2.668    0.008    0.127    0.140\n  c2 ~~                                                                 \n    c3                0.003    0.041    0.078    0.938    0.003    0.004\n    c4                0.031    0.044    0.715    0.475    0.031    0.036\n  c3 ~~                                                                 \n    c4                0.034    0.044    0.767    0.443    0.034    0.039\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .intercept         0.580    0.061    9.501    0.000    0.419    0.419\n   .slope             0.958    0.030   32.177    0.000    1.244    1.244\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t1                0.580    0.091    6.386    0.000    0.580    0.231\n   .t2                0.596    0.056   10.627    0.000    0.596    0.135\n   .t3                0.481    0.051    9.434    0.000    0.481    0.064\n   .t4                0.535    0.094    5.709    0.000    0.535    0.047\n   .intercept         1.079    0.108    9.996    0.000    0.562    0.562\n   .slope             0.224    0.027    8.373    0.000    0.378    0.378\n    x1                1.064    0.068   15.614    0.000    1.064    1.000\n    x2                0.943    0.065   14.401    0.000    0.943    1.000\n    c1                0.972    0.064   15.306    0.000    0.972    1.000\n    c2                0.900    0.063   14.372    0.000    0.900    1.000\n    c3                0.876    0.067   13.041    0.000    0.876    1.000\n    c4                0.852    0.057   15.005    0.000    0.852    1.000\n\nR-Square:\n                   Estimate\n    t1                0.769\n    t2                0.865\n    t3                0.936\n    t4                0.953\n    intercept         0.438\n    slope             0.622\n\n\n\n7.1.3.2 Full\n\nCodesummary(\n  lgcm2_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 31 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        44\n\n  Number of observations                           400\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                26.059      26.344\n  Degrees of freedom                                21          21\n  P-value (Chi-square)                           0.204       0.194\n  Scaling correction factor                                  0.989\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              2345.885    2414.540\n  Degrees of freedom                                30          30\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.972\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.998       0.998\n  Tucker-Lewis Index (TLI)                       0.997       0.997\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.998\n  Robust Tucker-Lewis Index (TLI)                            0.997\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -5775.149   -5775.149\n  Scaling correction factor                                  0.994\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -5762.120   -5762.120\n  Scaling correction factor                                  0.993\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               11638.299   11638.299\n  Bayesian (BIC)                             11813.923   11813.923\n  Sample-size adjusted Bayesian (SABIC)      11674.308   11674.308\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.025       0.025\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.051       0.052\n  P-value H_0: RMSEA &lt;= 0.050                    0.938       0.933\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.024\n  90 Percent confidence interval - lower                     0.000\n  90 Percent confidence interval - upper                     0.051\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.940\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.014       0.014\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept =~                                                          \n    t1                1.000                               1.386    0.875\n    t2                1.000                               1.386    0.660\n    t3                1.000                               1.386    0.507\n    t4                1.000                               1.386    0.412\n  slope =~                                                              \n    t1                0.000                               0.000    0.000\n    t2                1.000                               0.768    0.366\n    t3                2.000                               1.536    0.562\n    t4                3.000                               2.304    0.684\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept ~                                                           \n    x1                0.608    0.059   10.275    0.000    0.439    0.451\n    x2                0.604    0.062    9.776    0.000    0.436    0.419\n  slope ~                                                               \n    x1                0.262    0.029    8.968    0.000    0.341    0.351\n    x2                0.522    0.032   16.301    0.000    0.679    0.653\n  t1 ~                                                                  \n    c1                0.143    0.045    3.198    0.001    0.143    0.089\n  t2 ~                                                                  \n    c2                0.289    0.047    6.215    0.000    0.289    0.131\n  t3 ~                                                                  \n    c3                0.328    0.047    7.011    0.000    0.328    0.112\n  t4 ~                                                                  \n    c4                0.330    0.057    5.814    0.000    0.330    0.091\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .intercept ~~                                                          \n   .slope             0.075    0.040    1.890    0.059    0.152    0.152\n  x1 ~~                                                                 \n    x2                0.153    0.049    3.129    0.002    0.153    0.155\n    c1               -0.038    0.050   -0.760    0.447   -0.038   -0.037\n    c2                0.026    0.048    0.547    0.585    0.026    0.027\n    c3                0.033    0.049    0.674    0.501    0.033    0.035\n    c4               -0.025    0.044   -0.560    0.575   -0.025   -0.026\n  x2 ~~                                                                 \n    c1               -0.019    0.050   -0.377    0.706   -0.019   -0.020\n    c2               -0.007    0.044   -0.167    0.867   -0.007   -0.008\n    c3                0.145    0.048    3.055    0.002    0.145    0.162\n    c4               -0.102    0.043   -2.371    0.018   -0.102   -0.115\n  c1 ~~                                                                 \n    c2                0.080    0.045    1.789    0.074    0.080    0.085\n    c3               -0.030    0.050   -0.596    0.551   -0.030   -0.033\n    c4                0.128    0.048    2.669    0.008    0.128    0.140\n  c2 ~~                                                                 \n    c3                0.001    0.042    0.030    0.976    0.001    0.001\n    c4                0.032    0.044    0.729    0.466    0.032    0.036\n  c3 ~~                                                                 \n    c4                0.035    0.044    0.796    0.426    0.035    0.041\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t1                0.000                               0.000    0.000\n   .t2                0.000                               0.000    0.000\n   .t3                0.000                               0.000    0.000\n   .t4                0.000                               0.000    0.000\n   .intercept         0.580    0.061    9.501    0.000    0.419    0.419\n   .slope             0.958    0.030   32.177    0.000    1.247    1.247\n    x1               -0.092    0.051   -1.793    0.073   -0.092   -0.090\n    x2                0.138    0.048    2.878    0.004    0.138    0.144\n    c1                0.008    0.049    0.158    0.874    0.008    0.008\n    c2                0.029    0.047    0.610    0.542    0.029    0.031\n    c3                0.068    0.047    1.449    0.147    0.068    0.072\n    c4               -0.018    0.046   -0.390    0.696   -0.018   -0.020\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t1                0.580    0.091    6.386    0.000    0.580    0.231\n   .t2                0.596    0.056   10.627    0.000    0.596    0.135\n   .t3                0.481    0.051    9.434    0.000    0.481    0.064\n   .t4                0.535    0.094    5.709    0.000    0.535    0.047\n   .intercept         1.079    0.108    9.996    0.000    0.562    0.562\n   .slope             0.224    0.027    8.373    0.000    0.379    0.379\n    x1                1.056    0.068   15.511    0.000    1.056    1.000\n    x2                0.924    0.065   14.153    0.000    0.924    1.000\n    c1                0.972    0.063   15.321    0.000    0.972    1.000\n    c2                0.899    0.062   14.432    0.000    0.899    1.000\n    c3                0.872    0.067   13.018    0.000    0.872    1.000\n    c4                0.851    0.057   15.001    0.000    0.851    1.000\n\nR-Square:\n                   Estimate\n    t1                0.769\n    t2                0.865\n    t3                0.936\n    t4                0.953\n    intercept         0.438\n    slope             0.621\n\n\n\n7.1.4 Estimates of Model Fit\n\nCodefitMeasures(\n  lgcm1_fit,\n  fit.measures = c(\n    \"chisq\", \"df\", \"pvalue\",\n    \"chisq.scaled\", \"df.scaled\", \"pvalue.scaled\",\n    \"chisq.scaling.factor\",\n    \"baseline.chisq\",\"baseline.df\",\"baseline.pvalue\",\n    \"rmsea\", \"cfi\", \"tli\", \"srmr\",\n    \"rmsea.robust\", \"cfi.robust\", \"tli.robust\"))\n\n               chisq                   df               pvalue \n              40.774               27.000                0.043 \n        chisq.scaled            df.scaled        pvalue.scaled \n              40.982               27.000                0.041 \nchisq.scaling.factor       baseline.chisq          baseline.df \n               0.995             2345.885               30.000 \n     baseline.pvalue                rmsea                  cfi \n               0.000                0.036                0.994 \n                 tli                 srmr         rmsea.robust \n               0.993                0.030                0.040 \n          cfi.robust           tli.robust \n               0.992                0.992 \n\n\n\n7.1.5 Residuals of Observed vs. Model-Implied Correlation Matrix\n\nCoderesiduals(\n  lgcm1_fit,\n  type = \"cor\")\n\n$type\n[1] \"cor.bollen\"\n\n$cov\n       t1     t2     t3     t4     x1     x2     c1     c2     c3     c4\nt1  0.000                                                               \nt2  0.010  0.000                                                        \nt3 -0.013 -0.001  0.000                                                 \nt4  0.012  0.002  0.002  0.000                                          \nx1  0.007  0.004  0.002  0.010  0.000                                   \nx2 -0.006  0.005  0.002 -0.002  0.015  0.000                            \nc1  0.006  0.018  0.001  0.056  0.001 -0.001  0.000                     \nc2  0.006 -0.005 -0.007 -0.005  0.003 -0.004  0.000  0.000              \nc3  0.046  0.018  0.030  0.030  0.007 -0.008 -0.001 -0.002  0.000       \nc4  0.038  0.027  0.001  0.006 -0.002  0.002  0.000  0.001  0.002  0.000\n\n$mean\n    t1     t2     t3     t4     x1     x2     c1     c2     c3     c4 \n 0.009  0.064  0.036  0.055 -0.090  0.144  0.008  0.031  0.072 -0.020 \n\n\n\n7.1.6 Modification Indices\n\nCodemodificationindices(\n  lgcm1_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n7.1.7 Internal Consistency Reliability\n\nCodecompRelSEM(lgcm1_fit)\n\nnamed numeric(0)\n\n\n\n7.1.8 Path Diagram\n\nCodesemPlot::semPaths(\n  lgcm1_fit,\n  what = \"Std.all\",\n  layout = \"tree2\",\n  edge.label.cex = 1.5)\n\n\n\n\n\n\nCodelavaanPlot::lavaanPlot(\n  lgcm1_fit,\n  coefs = TRUE,\n  #covs = TRUE,\n  stand = TRUE)\n\n\n\n\nCodelavaanPlot::lavaanPlot2(\n  lgcm1_fit,\n  #stand = TRUE, # currently throws error; uncomment out when fixed: https://github.com/alishinski/lavaanPlot/issues/52\n  coef_labels = TRUE)\n\n\n\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(lgcm1_fit)\n\n\n\n7.1.9 Plot Trajectories\n\n7.1.9.1 Prototypical Growth Curve\n\nCodelgcm1_intercept &lt;- coef(lgcm1_fit)[\"intercept~1\"]\nlgcm1_slope &lt;- coef(lgcm1_fit)[\"slope~1\"]\n\ntimepoints &lt;- 4\n\nnewData &lt;- expand.grid(\n  time = c(1, 4)\n)\n\nnewData$predictedValue &lt;- NA\nnewData$predictedValue[which(newData$time == 1)] &lt;- lgcm1_intercept\nnewData$predictedValue[which(newData$time == 4)] &lt;- lgcm1_intercept + (timepoints - 1)*lgcm1_slope\n\nggplot(\n  data = newData,\n  mapping = aes(\n    x = time,\n    y = predictedValue)) +\n  geom_line(\n    linewidth = 1\n  ) +\n  coord_cartesian(\n    ylim = c(0, 5)) +\n  labs(\n    x = \"Timepoint\",\n    y = \"Score\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n7.1.9.2 Individuals’ Growth Curves\n\nCodenewData1 &lt;- as.data.frame(predict(lgcm1_fit))\nnewData1$id &lt;- row.names(newData1)\n\nnewData1$t1 &lt;- newData1$intercept\nnewData1$t4 &lt;- newData1$intercept + (timepoints - 1)*newData1$slope\n\nnewData2 &lt;- pivot_longer(\n  newData1,\n  cols = c(t1, t4)) %&gt;% \n  select(-intercept, -slope)\n\nnewData2$time &lt;- NA\nnewData2$time[which(newData2$name == \"t1\")] &lt;- 1\nnewData2$time[which(newData2$name == \"t4\")] &lt;- 4\n\nggplot(\n  data = newData2,\n  mapping = aes(\n    x = time,\n    y = value,\n    group = factor(id))) +\n  geom_line() +\n  labs(\n    x = \"Timepoint\",\n    y = \"Score\"\n  ) +\n   theme_classic()\n\n\n\n\n\n\n\n\n7.1.9.3 Individuals’ Trajectories Overlaid with Prototypical Trajectory\n\nCodeggplot() +\n  geom_line( # individuals' trajectories\n    data = newData2,\n    mapping = aes(\n      x = time,\n      y = value,\n    group = factor(id)),\n    color = \"gray\",\n    alpha = 0.5\n  ) +\n  geom_line( # prototypical trajectory\n    data = newData,\n    mapping = aes(\n      x = time,\n      y = predictedValue\n    ),\n    linewidth = 2\n  ) +\n  labs(\n    x = \"Timepoint\",\n    y = \"Score\"\n  ) +\n   theme_classic()",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#sec-latentBasisLGCM",
    "href": "sem.html#sec-latentBasisLGCM",
    "title": "Structural Equation Modeling",
    "section": "\n7.2 Latent Basis Growth Curve Model",
    "text": "7.2 Latent Basis Growth Curve Model\n\n7.2.1 Model Syntax\n\n7.2.1.1 Abbreviated\n\nCodelbgcm1_syntax &lt;- '\n  # Intercept and slope\n  intercept =~ 1*t1 + 1*t2 + 1*t3 + 1*t4\n  slope =~ 0*t1 + a*t2 + b*t3 + 1*t4 # freely estimate the loadings for t2 and t3\n\n  # Regression paths\n  intercept ~ x1 + x2\n  slope ~ x1 + x2\n  \n  # Time-varying covariates\n  t1 ~ c1\n  t2 ~ c2\n  t3 ~ c3\n  t4 ~ c4\n'\n\n\n\n7.2.1.2 Full\n\nCodelbgcm2_syntax &lt;- '\n  # Intercept and slope\n  intercept =~ 1*t1 + 1*t2 + 1*t3 + 1*t4\n  slope =~ 0*t1 + a*t2 + b*t3 + 1*t4 # freely estimate the loadings for t2 and t3\n\n  # Regression paths\n  intercept ~ x1 + x2\n  slope ~ x1 + x2\n  \n  # Time-varying covariates\n  t1 ~ c1\n  t2 ~ c2\n  t3 ~ c3\n  t4 ~ c4\n  \n  # Constrain observed intercepts to zero\n  t1 ~ 0*1\n  t2 ~ 0*1\n  t3 ~ 0*1\n  t4 ~ 0*1\n  \n  # Estimate mean of intercept and slope\n  intercept ~ 1\n  slope ~ 1\n'\n\n\n\n7.2.2 Fit the Model\n\n7.2.2.1 Abbreviated\n\nCodelbgcm1_fit &lt;- growth(\n  lbgcm1_syntax,\n  data = Demo.growth,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  int.ov.free = FALSE,\n  int.lv.free = TRUE,\n  fixed.x = FALSE,\n  em.h1.iter.max = 100000)\n\n\n\n7.2.2.2 Full\n\nCodelbgcm2_fit &lt;- sem(\n  lbgcm2_syntax,\n  data = Demo.growth,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  fixed.x = FALSE,\n  em.h1.iter.max = 100000)\n\n\n\n7.2.3 Summary Output\n\n7.2.3.1 Abbreviated\n\nCodesummary(\n  lbgcm1_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 42 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        40\n\n  Number of observations                           400\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                37.229      37.400\n  Degrees of freedom                                25          25\n  P-value (Chi-square)                           0.055       0.053\n  Scaling correction factor                                  0.995\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              2345.885    2414.540\n  Degrees of freedom                                30          30\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.972\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.995       0.995\n  Tucker-Lewis Index (TLI)                       0.994       0.994\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.993\n  Robust Tucker-Lewis Index (TLI)                            0.992\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -5780.735   -5780.735\n  Scaling correction factor                                  0.991\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -5762.120   -5762.120\n  Scaling correction factor                                  0.993\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               11641.470   11641.470\n  Bayesian (BIC)                             11801.128   11801.128\n  Sample-size adjusted Bayesian (SABIC)      11674.206   11674.206\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.035       0.035\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.057       0.057\n  P-value H_0: RMSEA &lt;= 0.050                    0.855       0.851\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.040\n  90 Percent confidence interval - lower                     0.018\n  90 Percent confidence interval - upper                     0.059\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.793\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.029       0.029\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept =~                                                          \n    t1                1.000                               1.381    0.875\n    t2                1.000                               1.381    0.650\n    t3                1.000                               1.381    0.508\n    t4                1.000                               1.381    0.409\n  slope =~                                                              \n    t1                0.000                               0.000    0.000\n    t2         (a)    0.348    0.013   26.867    0.000    0.811    0.382\n    t3         (b)    0.653    0.012   53.301    0.000    1.523    0.561\n    t4                1.000                               2.330    0.690\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept ~                                                           \n    x1                0.605    0.059   10.192    0.000    0.438    0.452\n    x2                0.598    0.062    9.619    0.000    0.433    0.420\n  slope ~                                                               \n    x1                0.794    0.089    8.969    0.000    0.341    0.351\n    x2                1.578    0.097   16.223    0.000    0.677    0.657\n  t1 ~                                                                  \n    c1                0.145    0.045    3.226    0.001    0.145    0.090\n  t2 ~                                                                  \n    c2                0.287    0.047    6.157    0.000    0.287    0.128\n  t3 ~                                                                  \n    c3                0.337    0.047    7.111    0.000    0.337    0.116\n  t4 ~                                                                  \n    c4                0.333    0.057    5.836    0.000    0.333    0.091\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .intercept ~~                                                          \n   .slope             0.215    0.120    1.790    0.074    0.144    0.144\n  x1 ~~                                                                 \n    x2                0.141    0.050    2.798    0.005    0.141    0.140\n    c1               -0.039    0.051   -0.762    0.446   -0.039   -0.038\n    c2                0.023    0.048    0.493    0.622    0.023    0.024\n    c3                0.027    0.050    0.544    0.586    0.027    0.028\n    c4               -0.023    0.045   -0.519    0.604   -0.023   -0.024\n  x2 ~~                                                                 \n    c1               -0.018    0.050   -0.358    0.721   -0.018   -0.019\n    c2               -0.003    0.044   -0.075    0.940   -0.003   -0.004\n    c3                0.155    0.048    3.239    0.001    0.155    0.170\n    c4               -0.104    0.043   -2.421    0.015   -0.104   -0.116\n  c1 ~~                                                                 \n    c2                0.080    0.045    1.793    0.073    0.080    0.086\n    c3               -0.030    0.050   -0.585    0.559   -0.030   -0.032\n    c4                0.127    0.048    2.668    0.008    0.127    0.140\n  c2 ~~                                                                 \n    c3                0.003    0.041    0.078    0.938    0.003    0.004\n    c4                0.031    0.044    0.715    0.475    0.031    0.036\n  c3 ~~                                                                 \n    c4                0.034    0.044    0.767    0.443    0.034    0.039\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .intercept         0.568    0.063    8.966    0.000    0.411    0.411\n   .slope             2.899    0.091   31.916    0.000    1.244    1.244\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t1                0.574    0.092    6.211    0.000    0.574    0.230\n   .t2                0.595    0.055   10.741    0.000    0.595    0.132\n   .t3                0.487    0.051    9.602    0.000    0.487    0.066\n   .t4                0.518    0.097    5.338    0.000    0.518    0.045\n   .intercept         1.079    0.109    9.932    0.000    0.566    0.566\n   .slope             2.060    0.246    8.388    0.000    0.379    0.379\n    x1                1.064    0.068   15.614    0.000    1.064    1.000\n    x2                0.943    0.065   14.401    0.000    0.943    1.000\n    c1                0.972    0.064   15.306    0.000    0.972    1.000\n    c2                0.900    0.063   14.372    0.000    0.900    1.000\n    c3                0.876    0.067   13.041    0.000    0.876    1.000\n    c4                0.852    0.057   15.005    0.000    0.852    1.000\n\nR-Square:\n                   Estimate\n    t1                0.770\n    t2                0.868\n    t3                0.934\n    t4                0.955\n    intercept         0.434\n    slope             0.621\n\n\n\n7.2.3.2 Full\n\nCodesummary(\n  lbgcm2_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 43 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        46\n\n  Number of observations                           400\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                22.514      22.759\n  Degrees of freedom                                19          19\n  P-value (Chi-square)                           0.259       0.248\n  Scaling correction factor                                  0.989\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              2345.885    2414.540\n  Degrees of freedom                                30          30\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.972\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.998       0.998\n  Tucker-Lewis Index (TLI)                       0.998       0.998\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.999\n  Robust Tucker-Lewis Index (TLI)                            0.998\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -5773.377   -5773.377\n  Scaling correction factor                                  0.994\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -5762.120   -5762.120\n  Scaling correction factor                                  0.993\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               11638.754   11638.754\n  Bayesian (BIC)                             11822.361   11822.361\n  Sample-size adjusted Bayesian (SABIC)      11676.400   11676.400\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.022       0.022\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.051       0.051\n  P-value H_0: RMSEA &lt;= 0.050                    0.944       0.939\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.021\n  90 Percent confidence interval - lower                     0.000\n  90 Percent confidence interval - upper                     0.051\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.945\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.013       0.013\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept =~                                                          \n    t1                1.000                               1.381    0.875\n    t2                1.000                               1.381    0.651\n    t3                1.000                               1.381    0.509\n    t4                1.000                               1.381    0.409\n  slope =~                                                              \n    t1                0.000                               0.000    0.000\n    t2         (a)    0.348    0.013   26.867    0.000    0.809    0.381\n    t3         (b)    0.653    0.012   53.301    0.000    1.520    0.560\n    t4                1.000                               2.326    0.689\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept ~                                                           \n    x1                0.605    0.059   10.192    0.000    0.438    0.450\n    x2                0.598    0.062    9.619    0.000    0.433    0.416\n  slope ~                                                               \n    x1                0.794    0.089    8.969    0.000    0.341    0.351\n    x2                1.578    0.097   16.223    0.000    0.678    0.652\n  t1 ~                                                                  \n    c1                0.145    0.045    3.226    0.001    0.145    0.090\n  t2 ~                                                                  \n    c2                0.287    0.047    6.157    0.000    0.287    0.128\n  t3 ~                                                                  \n    c3                0.337    0.047    7.111    0.000    0.337    0.116\n  t4 ~                                                                  \n    c4                0.333    0.057    5.836    0.000    0.333    0.091\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .intercept ~~                                                          \n   .slope             0.215    0.120    1.790    0.074    0.144    0.144\n  x1 ~~                                                                 \n    x2                0.153    0.049    3.129    0.002    0.153    0.155\n    c1               -0.038    0.050   -0.760    0.447   -0.038   -0.037\n    c2                0.026    0.048    0.547    0.585    0.026    0.027\n    c3                0.033    0.049    0.674    0.501    0.033    0.035\n    c4               -0.025    0.044   -0.560    0.575   -0.025   -0.026\n  x2 ~~                                                                 \n    c1               -0.019    0.050   -0.377    0.706   -0.019   -0.020\n    c2               -0.007    0.044   -0.167    0.867   -0.007   -0.008\n    c3                0.145    0.048    3.055    0.002    0.145    0.162\n    c4               -0.102    0.043   -2.371    0.018   -0.102   -0.115\n  c1 ~~                                                                 \n    c2                0.080    0.045    1.789    0.074    0.080    0.085\n    c3               -0.030    0.050   -0.596    0.551   -0.030   -0.033\n    c4                0.128    0.048    2.669    0.008    0.128    0.140\n  c2 ~~                                                                 \n    c3                0.001    0.042    0.030    0.976    0.001    0.001\n    c4                0.032    0.044    0.729    0.466    0.032    0.036\n  c3 ~~                                                                 \n    c4                0.035    0.044    0.796    0.426    0.035    0.041\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t1                0.000                               0.000    0.000\n   .t2                0.000                               0.000    0.000\n   .t3                0.000                               0.000    0.000\n   .t4                0.000                               0.000    0.000\n   .intercept         0.568    0.063    8.966    0.000    0.411    0.411\n   .slope             2.899    0.091   31.916    0.000    1.246    1.246\n    x1               -0.092    0.051   -1.793    0.073   -0.092   -0.090\n    x2                0.138    0.048    2.878    0.004    0.138    0.144\n    c1                0.008    0.049    0.158    0.874    0.008    0.008\n    c2                0.029    0.047    0.610    0.542    0.029    0.031\n    c3                0.068    0.047    1.449    0.147    0.068    0.072\n    c4               -0.018    0.046   -0.390    0.696   -0.018   -0.020\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t1                0.574    0.092    6.211    0.000    0.574    0.230\n   .t2                0.595    0.055   10.741    0.000    0.595    0.132\n   .t3                0.487    0.051    9.602    0.000    0.487    0.066\n   .t4                0.518    0.097    5.338    0.000    0.518    0.046\n   .intercept         1.079    0.109    9.932    0.000    0.566    0.566\n   .slope             2.060    0.246    8.388    0.000    0.381    0.381\n    x1                1.056    0.068   15.511    0.000    1.056    1.000\n    x2                0.924    0.065   14.153    0.000    0.924    1.000\n    c1                0.972    0.063   15.321    0.000    0.972    1.000\n    c2                0.899    0.062   14.432    0.000    0.899    1.000\n    c3                0.872    0.067   13.018    0.000    0.872    1.000\n    c4                0.851    0.057   15.001    0.000    0.851    1.000\n\nR-Square:\n                   Estimate\n    t1                0.770\n    t2                0.868\n    t3                0.934\n    t4                0.954\n    intercept         0.434\n    slope             0.619\n\n\n\n7.2.4 Estimates of Model Fit\n\nCodefitMeasures(\n  lbgcm1_fit,\n  fit.measures = c(\n    \"chisq\", \"df\", \"pvalue\",\n    \"chisq.scaled\", \"df.scaled\", \"pvalue.scaled\",\n    \"chisq.scaling.factor\",\n    \"baseline.chisq\",\"baseline.df\",\"baseline.pvalue\",\n    \"rmsea\", \"cfi\", \"tli\", \"srmr\",\n    \"rmsea.robust\", \"cfi.robust\", \"tli.robust\"))\n\n               chisq                   df               pvalue \n              37.229               25.000                0.055 \n        chisq.scaled            df.scaled        pvalue.scaled \n              37.400               25.000                0.053 \nchisq.scaling.factor       baseline.chisq          baseline.df \n               0.995             2345.885               30.000 \n     baseline.pvalue                rmsea                  cfi \n               0.000                0.035                0.995 \n                 tli                 srmr         rmsea.robust \n               0.994                0.029                0.040 \n          cfi.robust           tli.robust \n               0.993                0.992 \n\n\n\n7.2.5 Residuals of Observed vs. Model-Implied Correlation Matrix\n\nCoderesiduals(\n  lbgcm1_fit,\n  type = \"cor\")\n\n$type\n[1] \"cor.bollen\"\n\n$cov\n       t1     t2     t3     t4     x1     x2     c1     c2     c3     c4\nt1  0.000                                                               \nt2  0.012  0.000                                                        \nt3 -0.011 -0.003  0.000                                                 \nt4  0.016 -0.003  0.003  0.000                                          \nx1  0.008  0.003  0.003  0.009  0.000                                   \nx2 -0.003  0.001  0.004 -0.003  0.015  0.000                            \nc1  0.004  0.018  0.001  0.056  0.001 -0.001  0.000                     \nc2  0.006 -0.003 -0.007 -0.005  0.003 -0.004  0.000  0.000              \nc3  0.046  0.018  0.026  0.030  0.007 -0.008 -0.001 -0.002  0.000       \nc4  0.038  0.027  0.001  0.005 -0.002  0.002  0.000  0.001  0.002  0.000\n\n$mean\n    t1     t2     t3     t4     x1     x2     c1     c2     c3     c4 \n 0.017  0.046  0.048  0.051 -0.090  0.144  0.008  0.031  0.072 -0.020 \n\n\n\n7.2.6 Modification Indices\n\nCodemodificationindices(\n  lbgcm1_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n7.2.7 Internal Consistency Reliability\n\nCodecompRelSEM(lbgcm1_fit)\n\nnamed numeric(0)\n\n\n\n7.2.8 Path Diagram\n\nCodesemPaths(\n  lbgcm1_fit,\n  what = \"Std.all\",\n  layout = \"tree2\",\n  edge.label.cex = 1.5)\n\n\n\n\n\n\nCodelavaanPlot::lavaanPlot(\n  lbgcm1_fit,\n  coefs = TRUE,\n  #covs = TRUE,\n  stand = TRUE)\n\n\n\n\nCodelavaanPlot::lavaanPlot2(\n  lbgcm1_fit,\n  stand = TRUE,\n  coef_labels = TRUE)\n\n\n\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(lbgcm1_fit)\n\n\n\n7.2.9 Plot Trajectories\n\n7.2.9.1 Prototypical Growth Curve\n\nCodelbgcm1_intercept &lt;- coef(lbgcm1_fit)[\"intercept~1\"]\nlbgcm1_slope &lt;- coef(lbgcm1_fit)[\"slope~1\"]\nlbgcm1_slopeloadingt2 &lt;- coef(lbgcm1_fit)[\"a\"]\nlbgcm1_slopeloadingt3 &lt;- coef(lbgcm1_fit)[\"b\"]\n\ntimepoints &lt;- 4\n\nnewData &lt;- data.frame(\n  time = 1:4,\n  slopeloading = c(0, lbgcm1_slopeloadingt2, lbgcm1_slopeloadingt3, 1)\n)\n\nnewData$predictedValue &lt;- NA\nnewData$predictedValue &lt;- lbgcm1_intercept + lbgcm1_slope * newData$slopeloading\n\nggplot(\n  data = newData,\n  mapping = aes(\n    x = time,\n    y = predictedValue)) +\n  geom_line(\n    linewidth = 1\n  ) +\n  coord_cartesian(\n    ylim = c(0, 5)) +\n  labs(\n    x = \"Timepoint\",\n    y = \"Score\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n7.2.9.2 Individuals’ Growth Curves\n\nCodeperson_factors &lt;- as.data.frame(predict(lbgcm1_fit))\nperson_factors$id &lt;- rownames(person_factors)\n\nslope_loadings &lt;- c(0, lbgcm1_slopeloadingt2, lbgcm1_slopeloadingt3, 1)\n\n# Compute model-implied values for each person at each time point\nindividual_trajectories &lt;- person_factors %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    t1 = intercept + slope * slope_loadings[1],\n    t2 = intercept + slope * slope_loadings[2],\n    t3 = intercept + slope * slope_loadings[3],\n    t4 = intercept + slope * slope_loadings[4]\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(id, t1, t2, t3, t4) %&gt;%\n  pivot_longer(\n    cols = t1:t4,\n    names_to = \"timepoint\",\n    values_to = \"value\") %&gt;%\n  mutate(\n    time = as.integer(substr(timepoint, 2, 2)) # extract number from \"t1\", \"t2\", etc.\n  )\n\nggplot(\n  data = individual_trajectories,\n  mapping = aes(\n    x = time,\n    y = value,\n    group = factor(id))) +\n  geom_line() +\n  labs(\n    x = \"Timepoint\",\n    y = \"Score\"\n  ) +\n   theme_classic()\n\n\n\n\n\n\n\n\n7.2.9.3 Individuals’ Trajectories Overlaid with Prototypical Trajectory\n\nCodeggplot() +\n  geom_line( # individuals' model-implied trajectories\n    data = individual_trajectories,\n    aes(\n      x = time,\n      y = value,\n      group = id),\n    color = \"gray\",\n    alpha = 0.5\n  ) +\n  geom_line( # prototypical trajectory\n    data = newData,\n    aes(\n      x = time,\n      y = predictedValue),\n    color = \"blue\",\n    linewidth = 2\n  ) +\n  labs(\n    x = \"Timepoint\",\n    y = \"Score\"\n  ) +\n   theme_classic()",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#sec-quadraticLGCM",
    "href": "sem.html#sec-quadraticLGCM",
    "title": "Structural Equation Modeling",
    "section": "\n7.3 Quadratic Growth Curve Model",
    "text": "7.3 Quadratic Growth Curve Model\nWhen using higher-order polynomials, we could specify contrast codes for time to reduce multicollinearity between the linear and quadratic growth factors: https://tdjorgensen.github.io/SEM-in-Ed-compendium/ch27.html#saturated-growth-model\n\nCodefactorLoadings &lt;- poly(\n  x = c(0,1,2,3), # times (can allow unequal spacing)\n  degree = 2)\n\nfactorLoadings\n\n              1    2\n[1,] -0.6708204  0.5\n[2,] -0.2236068 -0.5\n[3,]  0.2236068 -0.5\n[4,]  0.6708204  0.5\nattr(,\"coefs\")\nattr(,\"coefs\")$alpha\n[1] 1.5 1.5\n\nattr(,\"coefs\")$norm2\n[1] 1 4 5 4\n\nattr(,\"degree\")\n[1] 1 2\nattr(,\"class\")\n[1] \"poly\"   \"matrix\"\n\nCodelinearLoadings &lt;- factorLoadings[,1]\nquadraticLoadings &lt;- factorLoadings[,2]\n\nlinearLoadings\n\n[1] -0.6708204 -0.2236068  0.2236068  0.6708204\n\nCodequadraticLoadings\n\n[1]  0.5 -0.5 -0.5  0.5\n\n\n\n7.3.1 Model Syntax\n\n7.3.1.1 Abbreviated\n\nCodequadraticGCM1_syntax &lt;- '\n  # Intercept and slope\n  intercept =~ 1*t1 + 1*t2 + 1*t3 + 1*t4\n  linear =~ 0*t1 + 1*t2 + 2*t3 + 3*t4\n  quadratic =~ 0*t1 + 1*t2 + 4*t3 + 9*t4\n\n  # Regression paths\n  intercept ~ x1 + x2\n  linear ~ x1 + x2\n  quadratic ~ x1 + x2\n  \n  # Time-varying covariates\n  t1 ~ c1\n  t2 ~ c2\n  t3 ~ c3\n  t4 ~ c4\n'\n\n\n\n7.3.1.2 Full\n\nCodequadraticGCM2_syntax &lt;- '\n  # Intercept and slope\n  intercept =~ 1*t1 + 1*t2 + 1*t3 + 1*t4\n  linear =~ 0*t1 + 1*t2 + 2*t3 + 3*t4\n  quadratic =~ 0*t1 + 1*t2 + 4*t3 + 9*t4\n\n  # Regression paths\n  intercept ~ x1 + x2\n  linear ~ x1 + x2\n  quadratic ~ x1 + x2\n  \n  # Time-varying covariates\n  t1 ~ c1\n  t2 ~ c2\n  t3 ~ c3\n  t4 ~ c4\n  \n  # Constrain observed intercepts to zero\n  t1 ~ 0*1\n  t2 ~ 0*1\n  t3 ~ 0*1\n  t4 ~ 0*1\n  \n  # Estimate mean of intercept and slope\n  intercept ~ 1\n  linear ~ 1\n  quadratic ~ 1\n'\n\n\n\n7.3.2 Fit the Model\n\n7.3.2.1 Abbreviated\n\nCodequadraticGCM1_fit &lt;- growth(\n  quadraticGCM1_syntax,\n  data = Demo.growth,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  int.ov.free = FALSE,\n  int.lv.free = TRUE,\n  fixed.x = FALSE,\n  em.h1.iter.max = 100000)\n\n\n\n7.3.2.2 Full\n\nCodequadraticGCM2_fit &lt;- sem(\n  quadraticGCM2_syntax,\n  data = Demo.growth,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  fixed.x = FALSE,\n  em.h1.iter.max = 100000)\n\n\n\n7.3.3 Summary Output\n\n7.3.3.1 Abbreviated\n\nCodesummary(\n  quadraticGCM1_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 56 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        44\n\n  Number of observations                           400\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                35.756      35.604\n  Degrees of freedom                                21          21\n  P-value (Chi-square)                           0.023       0.024\n  Scaling correction factor                                  1.004\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              2345.885    2414.540\n  Degrees of freedom                                30          30\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.972\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.994       0.994\n  Tucker-Lewis Index (TLI)                       0.991       0.991\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.992\n  Robust Tucker-Lewis Index (TLI)                            0.989\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -5779.998   -5779.998\n  Scaling correction factor                                  0.987\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -5762.120   -5762.120\n  Scaling correction factor                                  0.993\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               11647.996   11647.996\n  Bayesian (BIC)                             11823.621   11823.621\n  Sample-size adjusted Bayesian (SABIC)      11684.006   11684.006\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.042       0.042\n  90 Percent confidence interval - lower         0.016       0.015\n  90 Percent confidence interval - upper         0.065       0.065\n  P-value H_0: RMSEA &lt;= 0.050                    0.692       0.698\n  P-value H_0: RMSEA &gt;= 0.080                    0.002       0.002\n                                                                  \n  Robust RMSEA                                               0.047\n  90 Percent confidence interval - lower                     0.026\n  90 Percent confidence interval - upper                     0.067\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.584\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.002\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.030       0.030\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept =~                                                          \n    t1                1.000                               1.509    0.956\n    t2                1.000                               1.509    0.715\n    t3                1.000                               1.509    0.553\n    t4                1.000                               1.509    0.448\n  linear =~                                                             \n    t1                0.000                               0.000    0.000\n    t2                1.000                               1.054    0.499\n    t3                2.000                               2.108    0.773\n    t4                3.000                               3.163    0.938\n  quadratic =~                                                          \n    t1                0.000                               0.000    0.000\n    t2                1.000                               0.164    0.078\n    t3                4.000                               0.655    0.240\n    t4                9.000                               1.474    0.437\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept ~                                                           \n    x1                0.615    0.063    9.801    0.000    0.407    0.420\n    x2                0.590    0.066    8.878    0.000    0.391    0.380\n  linear ~                                                              \n    x1                0.236    0.063    3.737    0.000    0.224    0.231\n    x2                0.557    0.073    7.595    0.000    0.528    0.513\n  quadratic ~                                                           \n    x1                0.009    0.020    0.456    0.649    0.055    0.056\n    x2               -0.012    0.021   -0.549    0.583   -0.070   -0.068\n  t1 ~                                                                  \n    c1                0.130    0.045    2.864    0.004    0.130    0.081\n  t2 ~                                                                  \n    c2                0.289    0.047    6.207    0.000    0.289    0.130\n  t3 ~                                                                  \n    c3                0.330    0.047    7.030    0.000    0.330    0.113\n  t4 ~                                                                  \n    c4                0.326    0.057    5.726    0.000    0.326    0.089\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .intercept ~~                                                          \n   .linear           -0.359    0.216   -1.658    0.097   -0.351   -0.351\n   .quadratic         0.108    0.053    2.025    0.043    0.552    0.552\n .linear ~~                                                             \n   .quadratic        -0.119    0.056   -2.121    0.034   -0.857   -0.857\n  x1 ~~                                                                 \n    x2                0.141    0.050    2.798    0.005    0.141    0.140\n    c1               -0.039    0.051   -0.762    0.446   -0.039   -0.038\n    c2                0.023    0.048    0.493    0.622    0.023    0.024\n    c3                0.027    0.050    0.544    0.586    0.027    0.028\n    c4               -0.023    0.045   -0.519    0.604   -0.023   -0.024\n  x2 ~~                                                                 \n    c1               -0.018    0.050   -0.358    0.721   -0.018   -0.019\n    c2               -0.003    0.044   -0.075    0.940   -0.003   -0.004\n    c3                0.155    0.048    3.239    0.001    0.155    0.170\n    c4               -0.104    0.043   -2.421    0.015   -0.104   -0.116\n  c1 ~~                                                                 \n    c2                0.080    0.045    1.793    0.073    0.080    0.086\n    c3               -0.030    0.050   -0.585    0.559   -0.030   -0.032\n    c4                0.127    0.048    2.668    0.008    0.127    0.140\n  c2 ~~                                                                 \n    c3                0.003    0.041    0.078    0.938    0.003    0.004\n    c4                0.031    0.044    0.715    0.475    0.031    0.036\n  c3 ~~                                                                 \n    c4                0.034    0.044    0.767    0.443    0.034    0.039\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .intercept         0.575    0.065    8.793    0.000    0.381    0.381\n   .linear            0.944    0.066   14.331    0.000    0.895    0.895\n   .quadratic         0.005    0.020    0.276    0.783    0.033    0.033\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t1                0.208    0.187    1.111    0.267    0.208    0.084\n   .t2                0.640    0.079    8.106    0.000    0.640    0.144\n   .t3                0.404    0.085    4.747    0.000    0.404    0.054\n   .t4                0.623    0.307    2.027    0.043    0.623    0.055\n   .intercept         1.445    0.208    6.939    0.000    0.635    0.635\n   .linear            0.723    0.229    3.160    0.002    0.650    0.650\n   .quadratic         0.027    0.020    1.353    0.176    0.993    0.993\n    x1                1.064    0.068   15.614    0.000    1.064    1.000\n    x2                0.943    0.065   14.401    0.000    0.943    1.000\n    c1                0.972    0.064   15.306    0.000    0.972    1.000\n    c2                0.900    0.063   14.372    0.000    0.900    1.000\n    c3                0.876    0.067   13.041    0.000    0.876    1.000\n    c4                0.852    0.057   15.005    0.000    0.852    1.000\n\nR-Square:\n                   Estimate\n    t1                0.916\n    t2                0.856\n    t3                0.946\n    t4                0.945\n    intercept         0.365\n    linear            0.350\n    quadratic         0.007\n\n\n\n7.3.3.2 Full\n\nCodesummary(\n  quadraticGCM2_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 56 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        50\n\n  Number of observations                           400\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                21.040      21.042\n  Degrees of freedom                                15          15\n  P-value (Chi-square)                           0.136       0.136\n  Scaling correction factor                                  1.000\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              2345.885    2414.540\n  Degrees of freedom                                30          30\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.972\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.997       0.997\n  Tucker-Lewis Index (TLI)                       0.995       0.995\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.998\n  Robust Tucker-Lewis Index (TLI)                            0.995\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -5772.640   -5772.640\n  Scaling correction factor                                  0.990\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -5762.120   -5762.120\n  Scaling correction factor                                  0.993\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               11645.281   11645.281\n  Bayesian (BIC)                             11844.854   11844.854\n  Sample-size adjusted Bayesian (SABIC)      11686.201   11686.201\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.032       0.032\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.061       0.061\n  P-value H_0: RMSEA &lt;= 0.050                    0.828       0.828\n  P-value H_0: RMSEA &gt;= 0.080                    0.002       0.002\n                                                                  \n  Robust RMSEA                                               0.031\n  90 Percent confidence interval - lower                     0.000\n  90 Percent confidence interval - upper                     0.061\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.834\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.002\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.014       0.014\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept =~                                                          \n    t1                1.000                               1.509    0.956\n    t2                1.000                               1.509    0.715\n    t3                1.000                               1.509    0.554\n    t4                1.000                               1.509    0.448\n  linear =~                                                             \n    t1                0.000                               0.000    0.000\n    t2                1.000                               1.053    0.499\n    t3                2.000                               2.106    0.773\n    t4                3.000                               3.158    0.938\n  quadratic =~                                                          \n    t1                0.000                               0.000    0.000\n    t2                1.000                               0.164    0.078\n    t3                4.000                               0.655    0.241\n    t4                9.000                               1.474    0.438\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept ~                                                           \n    x1                0.615    0.063    9.801    0.000    0.407    0.419\n    x2                0.590    0.066    8.878    0.000    0.391    0.376\n  linear ~                                                              \n    x1                0.236    0.063    3.737    0.000    0.224    0.230\n    x2                0.557    0.073    7.595    0.000    0.529    0.508\n  quadratic ~                                                           \n    x1                0.009    0.020    0.456    0.649    0.055    0.056\n    x2               -0.012    0.021   -0.549    0.583   -0.070   -0.068\n  t1 ~                                                                  \n    c1                0.130    0.045    2.864    0.004    0.130    0.081\n  t2 ~                                                                  \n    c2                0.289    0.047    6.207    0.000    0.289    0.130\n  t3 ~                                                                  \n    c3                0.330    0.047    7.030    0.000    0.330    0.113\n  t4 ~                                                                  \n    c4                0.326    0.057    5.726    0.000    0.326    0.089\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .intercept ~~                                                          \n   .linear           -0.359    0.216   -1.658    0.097   -0.351   -0.351\n   .quadratic         0.108    0.053    2.025    0.043    0.552    0.552\n .linear ~~                                                             \n   .quadratic        -0.119    0.056   -2.121    0.034   -0.857   -0.857\n  x1 ~~                                                                 \n    x2                0.153    0.049    3.129    0.002    0.153    0.155\n    c1               -0.038    0.050   -0.760    0.447   -0.038   -0.037\n    c2                0.026    0.048    0.547    0.585    0.026    0.027\n    c3                0.033    0.049    0.674    0.501    0.033    0.035\n    c4               -0.025    0.044   -0.560    0.575   -0.025   -0.026\n  x2 ~~                                                                 \n    c1               -0.019    0.050   -0.377    0.706   -0.019   -0.020\n    c2               -0.007    0.044   -0.167    0.867   -0.007   -0.008\n    c3                0.145    0.048    3.055    0.002    0.145    0.162\n    c4               -0.102    0.043   -2.371    0.018   -0.102   -0.115\n  c1 ~~                                                                 \n    c2                0.080    0.045    1.789    0.074    0.080    0.085\n    c3               -0.030    0.050   -0.596    0.551   -0.030   -0.033\n    c4                0.128    0.048    2.669    0.008    0.128    0.140\n  c2 ~~                                                                 \n    c3                0.001    0.042    0.030    0.976    0.001    0.001\n    c4                0.032    0.044    0.729    0.466    0.032    0.036\n  c3 ~~                                                                 \n    c4                0.035    0.044    0.796    0.426    0.035    0.041\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t1                0.000                               0.000    0.000\n   .t2                0.000                               0.000    0.000\n   .t3                0.000                               0.000    0.000\n   .t4                0.000                               0.000    0.000\n   .intercept         0.575    0.065    8.793    0.000    0.381    0.381\n   .linear            0.944    0.066   14.331    0.000    0.896    0.896\n   .quadratic         0.005    0.020    0.276    0.783    0.033    0.033\n    x1               -0.092    0.051   -1.793    0.073   -0.092   -0.090\n    x2                0.138    0.048    2.878    0.004    0.138    0.144\n    c1                0.008    0.049    0.158    0.874    0.008    0.008\n    c2                0.029    0.047    0.610    0.542    0.029    0.031\n    c3                0.068    0.047    1.449    0.147    0.068    0.072\n    c4               -0.018    0.046   -0.390    0.696   -0.018   -0.020\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t1                0.208    0.187    1.111    0.267    0.208    0.084\n   .t2                0.640    0.079    8.106    0.000    0.640    0.144\n   .t3                0.404    0.085    4.747    0.000    0.404    0.055\n   .t4                0.623    0.307    2.027    0.043    0.623    0.055\n   .intercept         1.445    0.208    6.939    0.000    0.635    0.635\n   .linear            0.723    0.229    3.160    0.002    0.652    0.652\n   .quadratic         0.027    0.020    1.353    0.176    0.993    0.993\n    x1                1.056    0.068   15.511    0.000    1.056    1.000\n    x2                0.924    0.065   14.153    0.000    0.924    1.000\n    c1                0.972    0.063   15.321    0.000    0.972    1.000\n    c2                0.899    0.062   14.432    0.000    0.899    1.000\n    c3                0.872    0.067   13.018    0.000    0.872    1.000\n    c4                0.851    0.057   15.001    0.000    0.851    1.000\n\nR-Square:\n                   Estimate\n    t1                0.916\n    t2                0.856\n    t3                0.945\n    t4                0.945\n    intercept         0.365\n    linear            0.348\n    quadratic         0.007\n\n\n\n7.3.4 Estimates of Model Fit\n\nCodefitMeasures(\n  quadraticGCM1_fit,\n  fit.measures = c(\n    \"chisq\", \"df\", \"pvalue\",\n    \"chisq.scaled\", \"df.scaled\", \"pvalue.scaled\",\n    \"chisq.scaling.factor\",\n    \"baseline.chisq\",\"baseline.df\",\"baseline.pvalue\",\n    \"rmsea\", \"cfi\", \"tli\", \"srmr\",\n    \"rmsea.robust\", \"cfi.robust\", \"tli.robust\"))\n\n               chisq                   df               pvalue \n              35.756               21.000                0.023 \n        chisq.scaled            df.scaled        pvalue.scaled \n              35.604               21.000                0.024 \nchisq.scaling.factor       baseline.chisq          baseline.df \n               1.004             2345.885               30.000 \n     baseline.pvalue                rmsea                  cfi \n               0.000                0.042                0.994 \n                 tli                 srmr         rmsea.robust \n               0.991                0.030                0.047 \n          cfi.robust           tli.robust \n               0.992                0.989 \n\n\n\n7.3.5 Residuals of Observed vs. Model-Implied Correlation Matrix\n\nCoderesiduals(\n  quadraticGCM1_fit,\n  type = \"cor\")\n\n$type\n[1] \"cor.bollen\"\n\n$cov\n       t1     t2     t3     t4     x1     x2     c1     c2     c3     c4\nt1  0.000                                                               \nt2  0.002  0.000                                                        \nt3  0.002  0.001  0.000                                                 \nt4  0.007  0.003  0.000  0.000                                          \nx1  0.002  0.011  0.004  0.008  0.000                                   \nx2  0.001  0.004 -0.003  0.001  0.015  0.000                            \nc1  0.014  0.018  0.001  0.056  0.001 -0.001  0.000                     \nc2  0.006 -0.004 -0.007 -0.005  0.003 -0.004  0.000  0.000              \nc3  0.047  0.018  0.028  0.031  0.007 -0.008 -0.001 -0.002  0.000       \nc4  0.038  0.027  0.002  0.006 -0.002  0.002  0.000  0.001  0.002  0.000\n\n$mean\n    t1     t2     t3     t4     x1     x2     c1     c2     c3     c4 \n 0.012  0.070  0.040  0.054 -0.090  0.144  0.008  0.031  0.072 -0.020 \n\n\n\n7.3.6 Modification Indices\n\nCodemodificationindices(\n  quadraticGCM1_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n7.3.7 Internal Consistency Reliability\n\nCodecompRelSEM(quadraticGCM1_fit)\n\nnamed numeric(0)\n\n\n\n7.3.8 Path Diagram\n\nCodesemPlot::semPaths(\n  quadraticGCM1_fit,\n  what = \"Std.all\",\n  layout = \"tree2\",\n  edge.label.cex = 1.5)\n\n\n\n\n\n\nCodelavaanPlot::lavaanPlot(\n  quadraticGCM1_fit,\n  coefs = TRUE,\n  #covs = TRUE,\n  stand = TRUE)\n\n\n\n\nCodelavaanPlot::lavaanPlot2(\n  quadraticGCM1_fit,\n  #stand = TRUE, # currently throws error; uncomment out when fixed: https://github.com/alishinski/lavaanPlot/issues/52\n  coef_labels = TRUE)\n\n\n\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(quadraticGCM1_fit)\n\n\n\n7.3.9 Plot Trajectories\n\n7.3.9.1 Prototypical Growth Curve\nCalculated from intercept and slope parameters:\n\nCodequadraticGCM1_intercept &lt;- coef(quadraticGCM1_fit)[\"intercept~1\"]\nquadraticGCM1_linear &lt;- coef(quadraticGCM1_fit)[\"linear~1\"]\nquadraticGCM1_quadratic &lt;- coef(quadraticGCM1_fit)[\"quadratic~1\"]\n\ntimepoints &lt;- 4\n\nnewData &lt;- data.frame(\n  time = 1:4,\n  linearLoading = c(0, 1, 2, 3),\n  quadraticLoading = c(0, 1, 4, 9)\n)\n\nnewData$predictedValue &lt;- NA\nnewData$predictedValue &lt;- quadraticGCM1_intercept + (quadraticGCM1_linear * newData$linearLoading) + (quadraticGCM1_quadratic * newData$quadraticLoading)\n\nggplot(\n  data = newData,\n  mapping = aes(\n    x = time,\n    y = predictedValue)) +\n  geom_smooth(\n    method = \"lm\",\n    formula = y ~ x + I(x^2),\n    se = FALSE,\n    linewidth = 1\n  ) +\n  coord_cartesian(\n    ylim = c(0, 5)) +\n  labs(\n    x = \"Timepoint\",\n    y = \"Score\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n7.3.9.2 Individuals’ Growth Curves\n\nCodeperson_factors &lt;- as.data.frame(predict(quadraticGCM1_fit))\nperson_factors$id &lt;- rownames(person_factors)\n\nlinear_loadings &lt;- c(0, 1, 2, 3)\nquadratic_loadings &lt;- c(0, 1, 4, 9)\n\n# Compute model-implied values for each person at each time point\nindividual_trajectories &lt;- person_factors %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    t1 = intercept + (linear * linear_loadings[1]) + (quadratic * quadratic_loadings[1]),\n    t2 = intercept + (linear * linear_loadings[2]) + (quadratic * quadratic_loadings[2]),\n    t3 = intercept + (linear * linear_loadings[3]) + (quadratic * quadratic_loadings[3]),\n    t4 = intercept + (linear * linear_loadings[4]) + (quadratic * quadratic_loadings[4])\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(id, t1, t2, t3, t4) %&gt;%\n  pivot_longer(\n    cols = t1:t4,\n    names_to = \"timepoint\",\n    values_to = \"value\") %&gt;%\n  mutate(\n    time = as.integer(substr(timepoint, 2, 2)) # extract number from \"t1\", \"t2\", etc.\n  )\n\nggplot(\n  data = individual_trajectories,\n  mapping = aes(\n    x = time,\n    y = value,\n    group = factor(id))) +\n  geom_smooth(\n    method = \"lm\",\n    formula = y ~ x + I(x^2),\n    se = FALSE,\n    linewidth = 0.5\n  ) +\n  labs(\n    x = \"Timepoint\",\n    y = \"Score\"\n  ) +\n   theme_classic()\n\n\n\n\n\n\n\n\n7.3.9.3 Individuals’ Trajectories Overlaid with Prototypical Trajectory\n\nCodeggplot() +\n  geom_smooth( # individuals' model-implied trajectories\n    data = individual_trajectories,\n    mapping = aes(\n      x = time,\n      y = value,\n      group = id),\n    method = \"lm\",\n    formula = y ~ x + I(x^2),\n    se = FALSE,\n    linewidth = 0.5,\n    color = \"gray\",\n    alpha = 0.30\n  ) +\n  geom_smooth( # prototypical trajectory\n    data = newData,\n    mapping = aes(\n      x = time,\n      y = predictedValue),\n    inherit.aes = FALSE,\n    method = \"lm\",\n    formula = y ~ x + I(x^2),\n    se = FALSE,\n    linewidth = 2\n  ) +\n  labs(\n    x = \"Timepoint\",\n    y = \"Score\"\n  ) +\n   theme_classic()",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#sec-splineLGCM",
    "href": "sem.html#sec-splineLGCM",
    "title": "Structural Equation Modeling",
    "section": "\n7.4 Spline (Piecewise) Growth Curve Model",
    "text": "7.4 Spline (Piecewise) Growth Curve Model\n\n7.4.1 Model Syntax\n\n7.4.1.1 Abbreviated\n\nCodesplineGCM1_syntax &lt;- '\n  # Intercept and slope\n  intercept =~ 1*t1 + 1*t2 + 1*t3 + 1*t4\n  slope =~ 0*t1 + 1*t2 + 2*t3 + 3*t4\n  knot =~ 0*t1 + 0*t2 + 1*t3 + 1*t4\n\n  # Regression paths\n  intercept ~ x1 + x2\n  slope ~ x1 + x2\n  knot ~ x1 + x2\n  \n  # Spline has no variance\n  knot ~~ 0*knot\n\n  # Spline does not covary with intercept and slope\n  knot ~~ 0*intercept\n  knot ~~ 0*slope\n  \n  # Time-varying covariates\n  t1 ~ c1\n  t2 ~ c2\n  t3 ~ c3\n  t4 ~ c4\n'\n\n\n\n7.4.1.2 Full\n\nCodesplineGCM2_syntax &lt;- '\n  # Intercept and slope\n  intercept =~ 1*t1 + 1*t2 + 1*t3 + 1*t4\n  slope =~ 0*t1 + 1*t2 + 2*t3 + 3*t4\n  knot =~ 0*t1 + 0*t2 + 1*t3 + 1*t4\n\n  # Regression paths\n  intercept ~ x1 + x2\n  slope ~ x1 + x2\n  knot ~ x1 + x2\n  \n  # Spline has no variance\n  knot ~~ 0*knot\n  \n  # Spline does not covary with intercept and slope\n  knot ~~ 0*intercept\n  knot ~~ 0*slope\n  \n  # Time-varying covariates\n  t1 ~ c1\n  t2 ~ c2\n  t3 ~ c3\n  t4 ~ c4\n  \n  # Constrain observed intercepts to zero\n  t1 ~ 0*1\n  t2 ~ 0*1\n  t3 ~ 0*1\n  t4 ~ 0*1\n  \n  # Estimate mean of intercept and slope\n  intercept ~ 1\n  slope ~ 1\n  knot ~ 1\n'\n\n\n\n7.4.2 Fit the Model\n\n7.4.2.1 Abbreviated\n\nCodesplineGCM1_fit &lt;- growth(\n  splineGCM1_syntax,\n  data = Demo.growth,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  int.ov.free = FALSE,\n  int.lv.free = TRUE,\n  fixed.x = FALSE,\n  em.h1.iter.max = 100000)\n\n\n\n7.4.2.2 Full\n\nCodesplineGCM2_fit &lt;- sem(\n  splineGCM2_syntax,\n  data = Demo.growth,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  fixed.x = FALSE,\n  em.h1.iter.max = 100000)\n\n\n\n7.4.3 Summary Output\n\n7.4.3.1 Abbreviated\n\nCodesummary(\n  splineGCM1_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 35 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        41\n\n  Number of observations                           400\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                36.091      36.117\n  Degrees of freedom                                24          24\n  P-value (Chi-square)                           0.054       0.053\n  Scaling correction factor                                  0.999\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              2345.885    2414.540\n  Degrees of freedom                                30          30\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.972\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.995       0.995\n  Tucker-Lewis Index (TLI)                       0.993       0.994\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.993\n  Robust Tucker-Lewis Index (TLI)                            0.991\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -5780.166   -5780.166\n  Scaling correction factor                                  0.989\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -5762.120   -5762.120\n  Scaling correction factor                                  0.993\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               11642.331   11642.331\n  Bayesian (BIC)                             11805.981   11805.981\n  Sample-size adjusted Bayesian (SABIC)      11675.885   11675.885\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.035       0.036\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.058       0.058\n  P-value H_0: RMSEA &lt;= 0.050                    0.841       0.840\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.041\n  90 Percent confidence interval - lower                     0.019\n  90 Percent confidence interval - upper                     0.060\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.768\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.029       0.029\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept =~                                                          \n    t1                1.000                               1.383    0.874\n    t2                1.000                               1.383    0.655\n    t3                1.000                               1.383    0.508\n    t4                1.000                               1.383    0.410\n  slope =~                                                              \n    t1                0.000                               0.000    0.000\n    t2                1.000                               0.787    0.373\n    t3                2.000                               1.573    0.578\n    t4                3.000                               2.360    0.699\n  knot =~                                                               \n    t1                0.000                               0.000    0.000\n    t2                0.000                               0.000    0.000\n    t3                1.000                               0.059    0.022\n    t4                1.000                               0.059    0.017\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept ~                                                           \n    x1                0.604    0.059   10.254    0.000    0.437    0.451\n    x2                0.601    0.061    9.824    0.000    0.435    0.422\n  slope ~                                                               \n    x1                0.280    0.042    6.705    0.000    0.356    0.367\n    x2                0.535    0.043   12.349    0.000    0.680    0.660\n  knot ~                                                                \n    x1               -0.044    0.077   -0.572    0.568   -0.746   -0.770\n    x2               -0.033    0.088   -0.372    0.710   -0.555   -0.539\n  t1 ~                                                                  \n    c1                0.143    0.045    3.194    0.001    0.143    0.089\n  t2 ~                                                                  \n    c2                0.287    0.047    6.129    0.000    0.287    0.129\n  t3 ~                                                                  \n    c3                0.336    0.047    7.074    0.000    0.336    0.115\n  t4 ~                                                                  \n    c4                0.333    0.057    5.871    0.000    0.333    0.091\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .intercept ~~                                                          \n   .knot              0.000                                 NaN      NaN\n .slope ~~                                                              \n   .knot              0.000                                 NaN      NaN\n .intercept ~~                                                          \n   .slope             0.075    0.039    1.892    0.059    0.152    0.152\n  x1 ~~                                                                 \n    x2                0.141    0.050    2.798    0.005    0.141    0.140\n    c1               -0.039    0.051   -0.762    0.446   -0.039   -0.038\n    c2                0.023    0.048    0.493    0.622    0.023    0.024\n    c3                0.027    0.050    0.544    0.586    0.027    0.028\n    c4               -0.023    0.045   -0.519    0.604   -0.023   -0.024\n  x2 ~~                                                                 \n    c1               -0.018    0.050   -0.358    0.721   -0.018   -0.019\n    c2               -0.003    0.044   -0.075    0.940   -0.003   -0.004\n    c3                0.155    0.048    3.239    0.001    0.155    0.170\n    c4               -0.104    0.043   -2.421    0.015   -0.104   -0.116\n  c1 ~~                                                                 \n    c2                0.080    0.045    1.793    0.073    0.080    0.086\n    c3               -0.030    0.050   -0.585    0.559   -0.030   -0.032\n    c4                0.127    0.048    2.668    0.008    0.127    0.140\n  c2 ~~                                                                 \n    c3                0.003    0.041    0.078    0.938    0.003    0.004\n    c4                0.031    0.044    0.715    0.475    0.031    0.036\n  c3 ~~                                                                 \n    c4                0.034    0.044    0.767    0.443    0.034    0.039\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .intercept         0.565    0.061    9.265    0.000    0.409    0.409\n   .slope             1.025    0.042   24.178    0.000    1.303    1.303\n   .knot             -0.167    0.081   -2.058    0.040   -2.839   -2.839\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .knot              0.000                               0.000    0.000\n   .t1                0.581    0.091    6.403    0.000    0.581    0.232\n   .t2                0.591    0.055   10.763    0.000    0.591    0.133\n   .t3                0.475    0.051    9.390    0.000    0.475    0.064\n   .t4                0.538    0.093    5.768    0.000    0.538    0.047\n   .intercept         1.080    0.108   10.010    0.000    0.565    0.565\n   .slope             0.224    0.027    8.392    0.000    0.361    0.361\n    x1                1.064    0.068   15.614    0.000    1.064    1.000\n    x2                0.943    0.065   14.401    0.000    0.943    1.000\n    c1                0.972    0.064   15.306    0.000    0.972    1.000\n    c2                0.900    0.063   14.372    0.000    0.900    1.000\n    c3                0.876    0.067   13.041    0.000    0.876    1.000\n    c4                0.852    0.057   15.005    0.000    0.852    1.000\n\nR-Square:\n                   Estimate\n    knot              1.000\n    t1                0.768\n    t2                0.867\n    t3                0.936\n    t4                0.953\n    intercept         0.435\n    slope             0.639\n\n\n\n7.4.3.2 Full\n\nCodesummary(\n  splineGCM2_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 39 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        47\n\n  Number of observations                           400\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                21.375      21.504\n  Degrees of freedom                                18          18\n  P-value (Chi-square)                           0.261       0.255\n  Scaling correction factor                                  0.994\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              2345.885    2414.540\n  Degrees of freedom                                30          30\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.972\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.999       0.999\n  Tucker-Lewis Index (TLI)                       0.998       0.998\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.999\n  Robust Tucker-Lewis Index (TLI)                            0.998\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -5772.808   -5772.808\n  Scaling correction factor                                  0.992\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -5762.120   -5762.120\n  Scaling correction factor                                  0.993\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               11639.615   11639.615\n  Bayesian (BIC)                             11827.214   11827.214\n  Sample-size adjusted Bayesian (SABIC)      11678.080   11678.080\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.022       0.022\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.052       0.052\n  P-value H_0: RMSEA &lt;= 0.050                    0.938       0.935\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.022\n  90 Percent confidence interval - lower                     0.000\n  90 Percent confidence interval - upper                     0.052\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.938\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.013       0.013\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept =~                                                          \n    t1                1.000                               1.382    0.874\n    t2                1.000                               1.382    0.655\n    t3                1.000                               1.382    0.508\n    t4                1.000                               1.382    0.410\n  slope =~                                                              \n    t1                0.000                               0.000    0.000\n    t2                1.000                               0.785    0.372\n    t3                2.000                               1.570    0.577\n    t4                3.000                               2.355    0.699\n  knot =~                                                               \n    t1                0.000                               0.000    0.000\n    t2                0.000                               0.000    0.000\n    t3                1.000                               0.059    0.022\n    t4                1.000                               0.059    0.017\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept ~                                                           \n    x1                0.604    0.059   10.254    0.000    0.437    0.449\n    x2                0.601    0.061    9.824    0.000    0.435    0.418\n  slope ~                                                               \n    x1                0.280    0.042    6.705    0.000    0.356    0.366\n    x2                0.535    0.043   12.349    0.000    0.681    0.655\n  knot ~                                                                \n    x1               -0.044    0.077   -0.572    0.568   -0.746   -0.767\n    x2               -0.033    0.088   -0.372    0.710   -0.555   -0.534\n  t1 ~                                                                  \n    c1                0.143    0.045    3.194    0.001    0.143    0.089\n  t2 ~                                                                  \n    c2                0.287    0.047    6.129    0.000    0.287    0.129\n  t3 ~                                                                  \n    c3                0.336    0.047    7.074    0.000    0.336    0.115\n  t4 ~                                                                  \n    c4                0.333    0.057    5.871    0.000    0.333    0.091\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .intercept ~~                                                          \n   .knot              0.000                                 NaN      NaN\n .slope ~~                                                              \n   .knot              0.000                                 NaN      NaN\n .intercept ~~                                                          \n   .slope             0.075    0.039    1.892    0.059    0.152    0.152\n  x1 ~~                                                                 \n    x2                0.153    0.049    3.129    0.002    0.153    0.155\n    c1               -0.038    0.050   -0.760    0.447   -0.038   -0.037\n    c2                0.026    0.048    0.547    0.585    0.026    0.027\n    c3                0.033    0.049    0.674    0.501    0.033    0.035\n    c4               -0.025    0.044   -0.560    0.575   -0.025   -0.026\n  x2 ~~                                                                 \n    c1               -0.019    0.050   -0.377    0.706   -0.019   -0.020\n    c2               -0.007    0.044   -0.167    0.867   -0.007   -0.008\n    c3                0.145    0.048    3.055    0.002    0.145    0.162\n    c4               -0.102    0.043   -2.371    0.018   -0.102   -0.115\n  c1 ~~                                                                 \n    c2                0.080    0.045    1.789    0.074    0.080    0.085\n    c3               -0.030    0.050   -0.596    0.551   -0.030   -0.033\n    c4                0.128    0.048    2.669    0.008    0.128    0.140\n  c2 ~~                                                                 \n    c3                0.001    0.042    0.030    0.976    0.001    0.001\n    c4                0.032    0.044    0.729    0.466    0.032    0.036\n  c3 ~~                                                                 \n    c4                0.035    0.044    0.796    0.426    0.035    0.041\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t1                0.000                               0.000    0.000\n   .t2                0.000                               0.000    0.000\n   .t3                0.000                               0.000    0.000\n   .t4                0.000                               0.000    0.000\n   .intercept         0.565    0.061    9.265    0.000    0.409    0.409\n   .slope             1.025    0.042   24.178    0.000    1.305    1.305\n   .knot             -0.167    0.081   -2.058    0.040   -2.839   -2.839\n    x1               -0.092    0.051   -1.793    0.073   -0.092   -0.090\n    x2                0.138    0.048    2.878    0.004    0.138    0.144\n    c1                0.008    0.049    0.158    0.874    0.008    0.008\n    c2                0.029    0.047    0.610    0.542    0.029    0.031\n    c3                0.068    0.047    1.449    0.147    0.068    0.072\n    c4               -0.018    0.046   -0.390    0.696   -0.018   -0.020\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .knot              0.000                               0.000    0.000\n   .t1                0.581    0.091    6.403    0.000    0.581    0.232\n   .t2                0.591    0.055   10.763    0.000    0.591    0.133\n   .t3                0.475    0.051    9.390    0.000    0.475    0.064\n   .t4                0.538    0.093    5.768    0.000    0.538    0.047\n   .intercept         1.080    0.108   10.010    0.000    0.565    0.565\n   .slope             0.224    0.027    8.392    0.000    0.363    0.363\n    x1                1.056    0.068   15.511    0.000    1.056    1.000\n    x2                0.924    0.065   14.153    0.000    0.924    1.000\n    c1                0.972    0.063   15.321    0.000    0.972    1.000\n    c2                0.899    0.062   14.432    0.000    0.899    1.000\n    c3                0.872    0.067   13.018    0.000    0.872    1.000\n    c4                0.851    0.057   15.001    0.000    0.851    1.000\n\nR-Square:\n                   Estimate\n    knot              1.000\n    t1                0.768\n    t2                0.867\n    t3                0.936\n    t4                0.953\n    intercept         0.435\n    slope             0.637\n\n\n\n7.4.4 Estimates of Model Fit\n\nCodefitMeasures(\n  splineGCM1_fit,\n  fit.measures = c(\n    \"chisq\", \"df\", \"pvalue\",\n    \"chisq.scaled\", \"df.scaled\", \"pvalue.scaled\",\n    \"chisq.scaling.factor\",\n    \"baseline.chisq\",\"baseline.df\",\"baseline.pvalue\",\n    \"rmsea\", \"cfi\", \"tli\", \"srmr\",\n    \"rmsea.robust\", \"cfi.robust\", \"tli.robust\"))\n\n               chisq                   df               pvalue \n              36.091               24.000                0.054 \n        chisq.scaled            df.scaled        pvalue.scaled \n              36.117               24.000                0.053 \nchisq.scaling.factor       baseline.chisq          baseline.df \n               0.999             2345.885               30.000 \n     baseline.pvalue                rmsea                  cfi \n               0.000                0.035                0.995 \n                 tli                 srmr         rmsea.robust \n               0.993                0.029                0.041 \n          cfi.robust           tli.robust \n               0.993                0.991 \n\n\n\n7.4.5 Residuals of Observed vs. Model-Implied Correlation Matrix\n\nCoderesiduals(\n  splineGCM1_fit,\n  type = \"cor\")\n\n$type\n[1] \"cor.bollen\"\n\n$cov\n       t1     t2     t3     t4     x1     x2     c1     c2     c3     c4\nt1  0.000                                                               \nt2  0.010  0.000                                                        \nt3 -0.011 -0.002  0.000                                                 \nt4  0.014  0.000  0.002  0.000                                          \nx1  0.009 -0.001  0.005  0.009  0.000                                   \nx2 -0.004  0.002  0.003 -0.003  0.015  0.000                            \nc1  0.005  0.018  0.001  0.056  0.001 -0.001  0.000                     \nc2  0.006 -0.004 -0.007 -0.005  0.003 -0.004  0.000  0.000              \nc3  0.046  0.018  0.027  0.030  0.007 -0.008 -0.001 -0.002  0.000       \nc4  0.038  0.027  0.001  0.005 -0.002  0.002  0.000  0.001  0.002  0.000\n\n$mean\n    t1     t2     t3     t4     x1     x2     c1     c2     c3     c4 \n 0.019  0.039  0.053  0.049 -0.090  0.144  0.008  0.031  0.072 -0.020 \n\n\n\n7.4.6 Modification Indices\n\nCodemodificationindices(\n  splineGCM1_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n7.4.7 Internal Consistency Reliability\n\nCodecompRelSEM(splineGCM1_fit)\n\nnamed numeric(0)\n\n\n\n7.4.8 Path Diagram\n\nCodesemPlot::semPaths(\n  splineGCM1_fit,\n  what = \"Std.all\",\n  layout = \"tree2\",\n  edge.label.cex = 1.5)\n\n\n\n\n\n\nCodelavaanPlot::lavaanPlot(\n  splineGCM1_fit,\n  coefs = TRUE,\n  #covs = TRUE,\n  stand = TRUE)\n\n\n\n\nCodelavaanPlot::lavaanPlot2(\n  splineGCM1_fit,\n  #stand = TRUE, # currently throws error; uncomment out when fixed: https://github.com/alishinski/lavaanPlot/issues/52\n  coef_labels = TRUE)\n\n\n\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(splineGCM1_fit)\n\n\n\n7.4.9 Plot Trajectories\n\n7.4.9.1 Prototypical Growth Curve\nCalculated from intercept and slope parameters:\n\nCodesplineGCM1_intercept &lt;- coef(splineGCM1_fit)[\"intercept~1\"]\nsplineGCM1_slope &lt;- coef(splineGCM1_fit)[\"slope~1\"]\nsplineGCM1_knot &lt;- coef(splineGCM1_fit)[\"knot~1\"]\n\ntimepoints &lt;- 4\n\nnewData &lt;- data.frame(\n  time = 1:4,\n  linearLoading = c(0, 1, 2, 3),\n  knotLoading = c(0, 0, 1, 1)\n)\n\nnewData$predictedValue &lt;- NA\nnewData$predictedValue &lt;- splineGCM1_intercept + (splineGCM1_slope * newData$linearLoading) + (splineGCM1_knot * newData$knotLoading)\n\nggplot(\n  data = newData,\n  mapping = aes(\n    x = time,\n    y = predictedValue)) +\n  geom_line(\n    linewidth = 1\n  ) +\n  coord_cartesian(\n    ylim = c(0, 5)) +\n  labs(\n    x = \"Timepoint\",\n    y = \"Score\"\n  ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n7.4.9.2 Individuals’ Growth Curves\n\nCodeperson_factors &lt;- as.data.frame(predict(splineGCM1_fit))\nperson_factors$id &lt;- rownames(person_factors)\n\nslope_loadings &lt;- c(0, 1, 2, 3)\nknot_loadings &lt;- c(0, 0, 1, 1)\n\n# Compute model-implied values for each person at each time point\nindividual_trajectories &lt;- person_factors %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    t1 = intercept + (slope * slope_loadings[1]) + (knot * knot_loadings[1]),\n    t2 = intercept + (slope * slope_loadings[2]) + (knot * knot_loadings[2]),\n    t3 = intercept + (slope * slope_loadings[3]) + (knot * knot_loadings[3]),\n    t4 = intercept + (slope * slope_loadings[4]) + (knot * knot_loadings[4])\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(id, t1, t2, t3, t4) %&gt;%\n  pivot_longer(\n    cols = t1:t4,\n    names_to = \"timepoint\",\n    values_to = \"value\") %&gt;%\n  mutate(\n    time = as.integer(substr(timepoint, 2, 2)) # extract number from \"t1\", \"t2\", etc.\n  )\n\nggplot(\n  data = individual_trajectories,\n  mapping = aes(\n    x = time,\n    y = value,\n    group = factor(id))) +\n  geom_line() +\n  labs(\n    x = \"Timepoint\",\n    y = \"Score\"\n  ) +\n   theme_classic()\n\n\n\n\n\n\n\n\n7.4.9.3 Individuals’ Trajectories Overlaid with Prototypical Trajectory\n\nCodeggplot() +\n  geom_line( # individuals' model-implied trajectories\n    data = individual_trajectories,\n    aes(\n      x = time,\n      y = value,\n      group = id),\n    linewidth = 0.5,\n    color = \"gray\",\n    alpha = 0.30\n  ) +\n  geom_line( # prototypical trajectory\n    data = newData,\n    aes(\n      x = time,\n      y = predictedValue),\n    color = \"blue\",\n    linewidth = 2\n  ) +\n  labs(\n    x = \"Timepoint\",\n    y = \"Score\"\n  ) +\n   theme_classic()",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#sec-saturatedGCM",
    "href": "sem.html#sec-saturatedGCM",
    "title": "Structural Equation Modeling",
    "section": "\n7.5 Saturated Growth Curve Model",
    "text": "7.5 Saturated Growth Curve Model\nhttps://tdjorgensen.github.io/SEM-in-Ed-compendium/ch27.html#saturated-growth-model",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#model-syntax-4",
    "href": "sem.html#model-syntax-4",
    "title": "Structural Equation Modeling",
    "section": "\n8.1 Model Syntax",
    "text": "8.1 Model Syntax\n\nCodebivariateLCSM_syntax &lt;- specify_bi_lcsm(\n  timepoints = 3,\n  var_x = \"x\",\n  model_x = list(\n    alpha_constant = TRUE, # alpha = intercept (constant change factor)\n    beta = TRUE, # beta = proportional change factor (latent true score predicting its change score)\n    phi = TRUE), # phi = autoregression of change scores\n  var_y = \"y\",\n  model_y = list(\n    alpha_constant = TRUE, # alpha = intercept (constant change factor)\n    beta = TRUE, # beta = proportional change factor (latent true score predicting its change score)\n    phi = TRUE), # phi = autoregression of change scores\n  coupling = list(\n    delta_lag_xy = TRUE,\n    delta_lag_yx = TRUE),\n  change_letter_x = \"g\",\n  change_letter_y = \"j\")\n\ncat(bivariateLCSM_syntax)\n\n# # # # # # # # # # # # # # # # # # # # #\n# Specify parameters for construct x ----\n# # # # # # # # # # # # # # # # # # # # #\n# Specify latent true scores \nlx1 =~ 1 * x1 \nlx2 =~ 1 * x2 \nlx3 =~ 1 * x3 \n# Specify mean of latent true scores \nlx1 ~ gamma_lx1 * 1 \nlx2 ~ 0 * 1 \nlx3 ~ 0 * 1 \n# Specify variance of latent true scores \nlx1 ~~ sigma2_lx1 * lx1 \nlx2 ~~ 0 * lx2 \nlx3 ~~ 0 * lx3 \n# Specify intercept of obseved scores \nx1 ~ 0 * 1 \nx2 ~ 0 * 1 \nx3 ~ 0 * 1 \n# Specify variance of observed scores \nx1 ~~ sigma2_ux * x1 \nx2 ~~ sigma2_ux * x2 \nx3 ~~ sigma2_ux * x3 \n# Specify autoregressions of latent variables \nlx2 ~ 1 * lx1 \nlx3 ~ 1 * lx2 \n# Specify latent change scores \ndx2 =~ 1 * lx2 \ndx3 =~ 1 * lx3 \n# Specify latent change scores means \ndx2 ~ 0 * 1 \ndx3 ~ 0 * 1 \n# Specify latent change scores variances \ndx2 ~~ 0 * dx2 \ndx3 ~~ 0 * dx3 \n# Specify constant change factor \ng2 =~ 1 * dx2 + 1 * dx3 \n# Specify constant change factor mean \ng2 ~ alpha_g2 * 1 \n# Specify constant change factor variance \ng2 ~~ sigma2_g2 * g2 \n# Specify constant change factor covariance with the initial true score \ng2 ~~ sigma_g2lx1 * lx1\n# Specify proportional change component \ndx2 ~ beta_x * lx1 \ndx3 ~ beta_x * lx2 \n# Specify autoregression of change score \ndx3 ~ phi_x * dx2 \n# # # # # # # # # # # # # # # # # # # # #\n# Specify parameters for construct y ----\n# # # # # # # # # # # # # # # # # # # # #\n# Specify latent true scores \nly1 =~ 1 * y1 \nly2 =~ 1 * y2 \nly3 =~ 1 * y3 \n# Specify mean of latent true scores \nly1 ~ gamma_ly1 * 1 \nly2 ~ 0 * 1 \nly3 ~ 0 * 1 \n# Specify variance of latent true scores \nly1 ~~ sigma2_ly1 * ly1 \nly2 ~~ 0 * ly2 \nly3 ~~ 0 * ly3 \n# Specify intercept of obseved scores \ny1 ~ 0 * 1 \ny2 ~ 0 * 1 \ny3 ~ 0 * 1 \n# Specify variance of observed scores \ny1 ~~ sigma2_uy * y1 \ny2 ~~ sigma2_uy * y2 \ny3 ~~ sigma2_uy * y3 \n# Specify autoregressions of latent variables \nly2 ~ 1 * ly1 \nly3 ~ 1 * ly2 \n# Specify latent change scores \ndy2 =~ 1 * ly2 \ndy3 =~ 1 * ly3 \n# Specify latent change scores means \ndy2 ~ 0 * 1 \ndy3 ~ 0 * 1 \n# Specify latent change scores variances \ndy2 ~~ 0 * dy2 \ndy3 ~~ 0 * dy3 \n# Specify constant change factor \nj2 =~ 1 * dy2 + 1 * dy3 \n# Specify constant change factor mean \nj2 ~ alpha_j2 * 1 \n# Specify constant change factor variance \nj2 ~~ sigma2_j2 * j2 \n# Specify constant change factor covariance with the initial true score \nj2 ~~ sigma_j2ly1 * ly1\n# Specify proportional change component \ndy2 ~ beta_y * ly1 \ndy3 ~ beta_y * ly2 \n# Specify autoregression of change score \ndy3 ~ phi_y * dy2 \n# Specify residual covariances \nx1 ~~ sigma_su * y1 \nx2 ~~ sigma_su * y2 \nx3 ~~ sigma_su * y3 \n# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #\n# Specify covariances betweeen specified change components (alpha) and intercepts (initial latent true scores lx1 and ly1) ----\n# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #\n# Specify covariance of intercepts \nlx1 ~~ sigma_ly1lx1 * ly1 \n# Specify covariance of constant change and intercept between constructs \nly1 ~~ sigma_g2ly1 * g2 \n# Specify covariance of constant change and intercept between constructs \nlx1 ~~ sigma_j2lx1 * j2 \n# Specify covariance of constant change factors between constructs \ng2 ~~ sigma_j2g2 * j2 \n# # # # # # # # # # # # # # # # # # # # # # # # # # #\n# Specify between-construct coupling parameters ----\n# # # # # # # # # # # # # # # # # # # # # # # # # # #\n# Change score x (t) is determined by true score y (t-1)  \ndx2 ~ delta_lag_xy * ly1 \ndx3 ~ delta_lag_xy * ly2 \n# Change score y (t) is determined by true score x (t-1)  \ndy2 ~ delta_lag_yx * lx1 \ndy3 ~ delta_lag_yx * lx2",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#fit-the-model-4",
    "href": "sem.html#fit-the-model-4",
    "title": "Structural Equation Modeling",
    "section": "\n8.2 Fit the Model",
    "text": "8.2 Fit the Model\n\nCodebivariateLCSM_fit &lt;- fit_bi_lcsm(\n  data = data_bi_lcsm,\n  var_x = names(data_bi_lcsm)[2:4],\n  var_y = names(data_bi_lcsm)[12:14],\n  model_x = list(\n    alpha_constant = TRUE, # alpha = intercept (constant change factor)\n    beta = TRUE, # beta = proportional change factor (latent true score predicting its change score)\n    phi = TRUE), # phi = autoregression of change scores\n  model_y = list(\n    alpha_constant = TRUE, # alpha = intercept (constant change factor)\n    beta = TRUE, # beta = proportional change factor (latent true score predicting its change score)\n    phi = TRUE), # phi = autoregression of change scores\n  coupling = list(\n    delta_lag_xy = TRUE,\n    xi_lag_yx = TRUE),\n  fixed.x = FALSE\n  )",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#summary-output-4",
    "href": "sem.html#summary-output-4",
    "title": "Structural Equation Modeling",
    "section": "\n8.3 Summary Output",
    "text": "8.3 Summary Output\n\nCodesummary(\n  bivariateLCSM_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 151 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        32\n  Number of equality constraints                     9\n\n  Number of observations                           500\n  Number of missing patterns                        23\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                 6.870       4.777\n  Degrees of freedom                                 4           4\n  P-value (Chi-square)                           0.143       0.311\n  Scaling correction factor                                  1.438\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              1435.712    1483.655\n  Degrees of freedom                                15          15\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.968\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.998       0.999\n  Tucker-Lewis Index (TLI)                       0.992       0.998\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.999\n  Robust Tucker-Lewis Index (TLI)                            0.997\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -2973.817   -2973.817\n  Scaling correction factor                                  0.639\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -2970.382   -2970.382\n  Scaling correction factor                                  0.971\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                                5993.634    5993.634\n  Bayesian (BIC)                              6090.570    6090.570\n  Sample-size adjusted Bayesian (SABIC)       6017.567    6017.567\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.038       0.020\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.085       0.065\n  P-value H_0: RMSEA &lt;= 0.050                    0.599       0.835\n  P-value H_0: RMSEA &gt;= 0.080                    0.073       0.009\n                                                                  \n  Robust RMSEA                                               0.024\n  90 Percent confidence interval - lower                     0.000\n  90 Percent confidence interval - upper                     0.094\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.637\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.114\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.031       0.031\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  lx1 =~                                                                \n    x1                1.000                               0.719    0.867\n  lx2 =~                                                                \n    x2                1.000                               1.069    0.933\n  lx3 =~                                                                \n    x3                1.000                               1.559    0.967\n  dx2 =~                                                                \n    lx2               1.000                               0.600    0.600\n  dx3 =~                                                                \n    lx3               1.000                               0.374    0.374\n  g2 =~                                                                 \n    dx2               1.000                               1.027    1.027\n    dx3               1.000                               1.128    1.128\n  ly1 =~                                                                \n    y1                1.000                               0.485    0.755\n  ly2 =~                                                                \n    y2                1.000                               0.506    0.769\n  ly3 =~                                                                \n    y3                1.000                               0.756    0.874\n  dy2 =~                                                                \n    ly2               1.000                               0.619    0.619\n  dy3 =~                                                                \n    ly3               1.000                               0.510    0.510\n  j2 =~                                                                 \n    dy2               1.000                               1.037    1.037\n    dy3               1.000                               0.844    0.844\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  lx2 ~                                                                 \n    lx1               1.000                               0.673    0.673\n  lx3 ~                                                                 \n    lx2               1.000                               0.685    0.685\n  dx2 ~                                                                 \n    lx1     (bt_x)   -0.115    0.026   -4.469    0.000   -0.129   -0.129\n  dx3 ~                                                                 \n    lx2     (bt_x)   -0.115    0.026   -4.469    0.000   -0.211   -0.211\n    dx2     (ph_x)    0.025    0.041    0.613    0.540    0.027    0.027\n  ly2 ~                                                                 \n    ly1               1.000                               0.958    0.958\n  ly3 ~                                                                 \n    ly2               1.000                               0.669    0.669\n  dy2 ~                                                                 \n    ly1     (bt_y)   -0.406    0.070   -5.778    0.000   -0.628   -0.628\n  dy3 ~                                                                 \n    ly2     (bt_y)   -0.406    0.069   -5.900    0.000   -0.533   -0.533\n    dy2     (ph_y)    0.501    0.115    4.371    0.000    0.407    0.407\n  dx2 ~                                                                 \n    ly1     (dl__)    0.055    0.109    0.506    0.613    0.042    0.042\n  dx3 ~                                                                 \n    ly2     (dl__)    0.055    0.109    0.506    0.613    0.048    0.048\n  dy3 ~                                                                 \n    dx2     (x_l_)    0.269    0.080    3.370    0.001    0.448    0.448\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  lx1 ~~                                                                \n    g2 (sgm_g2lx1)    0.156    0.030    5.149    0.000    0.328    0.328\n  ly1 ~~                                                                \n    j2 (sgm_j2ly1)    0.057    0.011    4.989    0.000    0.361    0.361\n .x1 ~~                                                                 \n   .y1      (sgm_)    0.011    0.009    1.275    0.202    0.011    0.063\n .x2 ~~                                                                 \n   .y2      (sgm_)    0.011    0.009    1.275    0.202    0.011    0.063\n .x3 ~~                                                                 \n   .y3      (sgm_)    0.011    0.009    1.275    0.202    0.011    0.063\n  lx1 ~~                                                                \n    l1      (s_11)    0.196    0.026    7.639    0.000    0.562    0.562\n  g2 ~~                                                                 \n    l1 (sgm_g2ly1)    0.075    0.029    2.569    0.010    0.235    0.235\n  lx1 ~~                                                                \n    j2 (sgm_j2lx1)    0.128    0.017    7.455    0.000    0.549    0.549\n  g2 ~~                                                                 \n    j2      (s_22)    0.040    0.019    2.132    0.033    0.187    0.187\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    lx1  (gmm_lx1)   21.079    0.038  559.652    0.000   29.307   29.307\n   .lx2               0.000                               0.000    0.000\n   .lx3               0.000                               0.000    0.000\n   .x1                0.000                               0.000    0.000\n   .x2                0.000                               0.000    0.000\n   .x3                0.000                               0.000    0.000\n   .dx2               0.000                               0.000    0.000\n   .dx3               0.000                               0.000    0.000\n    g2   (alph_g2)    0.273    0.008   35.188    0.000    0.415    0.415\n    ly1  (gmm_ly1)    5.027    0.030  167.731    0.000   10.373   10.373\n   .ly2               0.000                               0.000    0.000\n   .ly3               0.000                               0.000    0.000\n   .y1                0.000                               0.000    0.000\n   .y2                0.000                               0.000    0.000\n   .y3                0.000                               0.000    0.000\n   .dy2               0.000                               0.000    0.000\n   .dy3               0.000                               0.000    0.000\n    j2   (alph_j2)    0.848    0.376    2.256    0.024    2.609    2.609\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    lx1 (sgm2_lx1)    0.517    0.042   12.414    0.000    1.000    1.000\n   .lx2               0.000                               0.000    0.000\n   .lx3               0.000                               0.000    0.000\n   .x1    (sgm2_x)    0.171    0.011   15.607    0.000    0.171    0.248\n   .x2    (sgm2_x)    0.171    0.011   15.607    0.000    0.171    0.130\n   .x3    (sgm2_x)    0.171    0.011   15.607    0.000    0.171    0.066\n   .dx2               0.000                               0.000    0.000\n   .dx3               0.000                               0.000    0.000\n    g2   (sgm2_g2)    0.434    0.038   11.298    0.000    1.000    1.000\n    ly1 (sgm2_ly1)    0.235    0.028    8.532    0.000    1.000    1.000\n   .ly2               0.000                               0.000    0.000\n   .ly3               0.000                               0.000    0.000\n   .y1    (sgm2_y)    0.177    0.012   14.979    0.000    0.177    0.429\n   .y2    (sgm2_y)    0.177    0.012   14.979    0.000    0.177    0.408\n   .y3    (sgm2_y)    0.177    0.012   14.979    0.000    0.177    0.236\n   .dy2               0.000                               0.000    0.000\n   .dy3               0.000                               0.000    0.000\n    j2   (sgm2_j2)    0.106    0.016    6.759    0.000    1.000    1.000\n\nR-Square:\n                   Estimate\n    lx2               1.000\n    lx3               1.000\n    x1                0.752\n    x2                0.870\n    x3                0.934\n    dx2               1.000\n    dx3               1.000\n    ly2               1.000\n    ly3               1.000\n    y1                0.571\n    y2                0.592\n    y3                0.764\n    dy2               1.000\n    dy3               1.000",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#estimates-of-model-fit-4",
    "href": "sem.html#estimates-of-model-fit-4",
    "title": "Structural Equation Modeling",
    "section": "\n8.4 Estimates of Model Fit",
    "text": "8.4 Estimates of Model Fit\n\nCodefitMeasures(\n  bivariateLCSM_fit,\n  fit.measures = c(\n    \"chisq\", \"df\", \"pvalue\",\n    \"chisq.scaled\", \"df.scaled\", \"pvalue.scaled\",\n    \"chisq.scaling.factor\",\n    \"baseline.chisq\",\"baseline.df\",\"baseline.pvalue\",\n    \"rmsea\", \"cfi\", \"tli\", \"srmr\",\n    \"rmsea.robust\", \"cfi.robust\", \"tli.robust\"))\n\n               chisq                   df               pvalue \n               6.870                4.000                0.143 \n        chisq.scaled            df.scaled        pvalue.scaled \n               4.777                4.000                0.311 \nchisq.scaling.factor       baseline.chisq          baseline.df \n               1.438             1435.712               15.000 \n     baseline.pvalue                rmsea                  cfi \n               0.000                0.038                0.998 \n                 tli                 srmr         rmsea.robust \n               0.992                0.031                0.024 \n          cfi.robust           tli.robust \n               0.999                0.997",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#residuals-of-observed-vs.-model-implied-correlation-matrix-4",
    "href": "sem.html#residuals-of-observed-vs.-model-implied-correlation-matrix-4",
    "title": "Structural Equation Modeling",
    "section": "\n8.5 Residuals of Observed vs. Model-Implied Correlation Matrix",
    "text": "8.5 Residuals of Observed vs. Model-Implied Correlation Matrix\n\nCoderesiduals(\n  bivariateLCSM_fit,\n  type = \"cor\")\n\n$type\n[1] \"cor.bollen\"\n\n$cov\n       x1     x2     x3     y1     y2     y3\nx1  0.000                                   \nx2 -0.002  0.000                            \nx3 -0.002  0.001  0.000                     \ny1  0.031 -0.017  0.018  0.000              \ny2 -0.013 -0.035 -0.004 -0.001  0.000       \ny3  0.013  0.000  0.006  0.010 -0.006  0.000\n\n$mean\n    x1     x2     x3     y1     y2     y3 \n-0.001  0.001  0.000  0.000 -0.004  0.001",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#modification-indices-4",
    "href": "sem.html#modification-indices-4",
    "title": "Structural Equation Modeling",
    "section": "\n8.6 Modification Indices",
    "text": "8.6 Modification Indices\n\nCodemodificationindices(\n  bivariateLCSM_fit,\n  sort. = TRUE)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#path-diagram-4",
    "href": "sem.html#path-diagram-4",
    "title": "Structural Equation Modeling",
    "section": "\n8.7 Path Diagram",
    "text": "8.7 Path Diagram\n\nCodesemPaths(\n  bivariateLCSM_fit,\n  what = \"Std.all\",\n  layout = \"tree2\",\n  edge.label.cex = 1.5)\n\n\n\n\n\n\nCodeplot_lcsm(\n  lavaan_object = bivariateLCSM_fit,\n  lcsm = \"bivariate\",\n  lavaan_syntax = bivariateLCSM_syntax,\n  edge.label.cex = .9,\n  lcsm_colours = TRUE)\n\n\n\n\n\n\nCode#lavaanPlot::lavaanPlot( # throws error\n#  bivariateLCSM_fit,\n#  coefs = TRUE,\n#  #covs = TRUE,\n#  stand = TRUE)\n\nlavaanPlot::lavaanPlot2(\n  bivariateLCSM_fit,\n  stand = TRUE,\n  coef_labels = TRUE)\n\n\n\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(bivariateLCSM_fit)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#plot-trajectories-4",
    "href": "sem.html#plot-trajectories-4",
    "title": "Structural Equation Modeling",
    "section": "\n8.8 Plot Trajectories",
    "text": "8.8 Plot Trajectories\n\nCodeplot_trajectories(\n  data_bi_lcsm,\n  id_var = \"id\",\n  var_list = c(\n    \"x1\", \"x2\", \"x3\", \"x4\", \"x5\", \n    \"x6\", \"x7\", \"x8\", \"x9\", \"x10\"),\n  xlab = \"Time\",\n  ylab = \"X Score\",\n  connect_missing = FALSE)\n\n\n\n\n\n\nCode  plot_trajectories(\n  data_bi_lcsm,\n  id_var = \"id\",\n  var_list = c(\n    \"y1\", \"y2\", \"y3\", \"y4\", \"y5\",\n    \"y6\", \"y7\", \"y8\", \"y9\", \"y10\"),\n  xlab = \"Time\",\n  ylab = \"Y Score\",\n  connect_missing = FALSE)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#model-syntax-5",
    "href": "sem.html#model-syntax-5",
    "title": "Structural Equation Modeling",
    "section": "\n9.1 Model Syntax",
    "text": "9.1 Model Syntax\n\nCodeclpm_syntax &lt;- '\n  # Autoregressive Paths\n  t4 ~ t3\n  t3 ~ t2\n  t2 ~ t1\n  \n  c4 ~ c3\n  c3 ~ c2\n  c2 ~ c1\n  \n  # Concurrent Covariances\n  t1 ~~ c1\n  t2 ~~ c2\n  t3 ~~ c3\n  t4 ~~ c4\n  \n  # Cross-Lagged Paths\n  t4 ~ c3\n  t3 ~ c2\n  t2 ~ c1\n  \n  c4 ~ t3\n  c3 ~ t2\n  c2 ~ t1\n'",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#fit-the-model-5",
    "href": "sem.html#fit-the-model-5",
    "title": "Structural Equation Modeling",
    "section": "\n9.2 Fit the Model",
    "text": "9.2 Fit the Model\n\nCodeclpm_fit &lt;- sem(\n  clpm_syntax,\n  data = Demo.growth,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  std.lv = TRUE,\n  fixed.x = FALSE,\n  em.h1.iter.max = 100000)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#summary-output-5",
    "href": "sem.html#summary-output-5",
    "title": "Structural Equation Modeling",
    "section": "\n9.3 Summary Output",
    "text": "9.3 Summary Output\n\nCodesummary(\n  clpm_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 25 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        32\n\n  Number of observations                           400\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                55.624      54.099\n  Degrees of freedom                                12          12\n  P-value (Chi-square)                           0.000       0.000\n  Scaling correction factor                                  1.028\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              1933.670    1953.262\n  Degrees of freedom                                28          28\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.990\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.977       0.978\n  Tucker-Lewis Index (TLI)                       0.947       0.949\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.977\n  Robust Tucker-Lewis Index (TLI)                            0.947\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -4885.800   -4885.800\n  Scaling correction factor                                  1.001\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -4857.988   -4857.988\n  Scaling correction factor                                  1.008\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                                9835.601    9835.601\n  Bayesian (BIC)                              9963.328    9963.328\n  Sample-size adjusted Bayesian (SABIC)       9861.790    9861.790\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.095       0.094\n  90 Percent confidence interval - lower         0.071       0.069\n  90 Percent confidence interval - upper         0.121       0.119\n  P-value H_0: RMSEA &lt;= 0.050                    0.002       0.002\n  P-value H_0: RMSEA &gt;= 0.080                    0.856       0.832\n                                                                  \n  Robust RMSEA                                               0.095\n  90 Percent confidence interval - lower                     0.070\n  90 Percent confidence interval - upper                     0.121\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.002\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.849\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.029       0.029\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  t4 ~                                                                  \n    t3                1.183    0.023   51.960    0.000    1.183    0.954\n  t3 ~                                                                  \n    t2                1.135    0.031   36.564    0.000    1.135    0.885\n  t2 ~                                                                  \n    t1                1.040    0.047   21.910    0.000    1.040    0.773\n  c4 ~                                                                  \n    c3                0.063    0.051    1.227    0.220    0.063    0.063\n  c3 ~                                                                  \n    c2               -0.015    0.046   -0.319    0.750   -0.015   -0.015\n  c2 ~                                                                  \n    c1                0.081    0.046    1.761    0.078    0.081    0.084\n  t4 ~                                                                  \n    c3               -0.323    0.065   -4.935    0.000   -0.323   -0.089\n  t3 ~                                                                  \n    c2               -0.336    0.069   -4.838    0.000   -0.336   -0.117\n  t2 ~                                                                  \n    c1               -0.114    0.065   -1.749    0.080   -0.114   -0.053\n  c4 ~                                                                  \n    t3               -0.030    0.018   -1.717    0.086   -0.030   -0.089\n  c3 ~                                                                  \n    t2                0.053    0.022    2.377    0.017    0.053    0.121\n  c2 ~                                                                  \n    t1                0.009    0.029    0.328    0.743    0.009    0.016\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  t1 ~~                                                                 \n    c1                0.114    0.081    1.408    0.159    0.114    0.073\n .t2 ~~                                                                 \n   .c2                0.244    0.064    3.798    0.000    0.244    0.191\n .t3 ~~                                                                 \n   .c3                0.376    0.072    5.224    0.000    0.376    0.310\n .t4 ~~                                                                 \n   .c4                0.268    0.055    4.913    0.000    0.268    0.246\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t4                0.593    0.083    7.110    0.000    0.593    0.176\n   .t3                0.704    0.086    8.145    0.000    0.704    0.259\n   .t2                1.056    0.071   14.794    0.000    1.056    0.497\n   .c4                0.056    0.067    0.835    0.404    0.056    0.061\n   .c3               -0.021    0.060   -0.351    0.725   -0.021   -0.023\n   .c2                0.023    0.049    0.465    0.642    0.023    0.024\n    t1                0.595    0.079    7.531    0.000    0.595    0.377\n    c1                0.008    0.049    0.158    0.874    0.008    0.008\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t4                1.416    0.092   15.404    0.000    1.416    0.124\n   .t3                1.703    0.125   13.598    0.000    1.703    0.230\n   .t2                1.825    0.137   13.275    0.000    1.825    0.405\n   .c4                0.844    0.056   15.195    0.000    0.844    0.991\n   .c3                0.859    0.065   13.252    0.000    0.859    0.986\n   .c2                0.892    0.061   14.608    0.000    0.892    0.992\n    t1                2.494    0.185   13.450    0.000    2.494    1.000\n    c1                0.972    0.063   15.321    0.000    0.972    1.000\n\nR-Square:\n                   Estimate\n    t4                0.876\n    t3                0.770\n    t2                0.595\n    c4                0.009\n    c3                0.014\n    c2                0.008",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#estimates-of-model-fit-5",
    "href": "sem.html#estimates-of-model-fit-5",
    "title": "Structural Equation Modeling",
    "section": "\n9.4 Estimates of Model Fit",
    "text": "9.4 Estimates of Model Fit\n\nCodefitMeasures(\n  clpm_fit,\n  fit.measures = c(\n    \"chisq\", \"df\", \"pvalue\",\n    \"chisq.scaled\", \"df.scaled\", \"pvalue.scaled\",\n    \"chisq.scaling.factor\",\n    \"baseline.chisq\",\"baseline.df\",\"baseline.pvalue\",\n    \"rmsea\", \"cfi\", \"tli\", \"srmr\",\n    \"rmsea.robust\", \"cfi.robust\", \"tli.robust\"))\n\n               chisq                   df               pvalue \n              55.624               12.000                0.000 \n        chisq.scaled            df.scaled        pvalue.scaled \n              54.099               12.000                0.000 \nchisq.scaling.factor       baseline.chisq          baseline.df \n               1.028             1933.670               28.000 \n     baseline.pvalue                rmsea                  cfi \n               0.000                0.095                0.977 \n                 tli                 srmr         rmsea.robust \n               0.947                0.029                0.095 \n          cfi.robust           tli.robust \n               0.977                0.947",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#residuals-of-observed-vs.-model-implied-correlation-matrix-5",
    "href": "sem.html#residuals-of-observed-vs.-model-implied-correlation-matrix-5",
    "title": "Structural Equation Modeling",
    "section": "\n9.5 Residuals of Observed vs. Model-Implied Correlation Matrix",
    "text": "9.5 Residuals of Observed vs. Model-Implied Correlation Matrix\n\nCoderesiduals(\n  clpm_fit,\n  type = \"cor\")\n\n$type\n[1] \"cor.bollen\"\n\n$cov\n       t4     t3     t2     c4     c3     c2     t1     c1\nt4  0.000                                                 \nt3  0.000  0.000                                          \nt2  0.044  0.000  0.000                                   \nc4  0.000  0.000  0.030  0.000                            \nc3  0.000  0.000  0.000  0.000  0.000                     \nc2  0.005  0.000  0.000  0.036  0.000  0.000              \nt1  0.068  0.038  0.000  0.052  0.024  0.000  0.000       \nc1  0.048 -0.022  0.000  0.140 -0.032  0.000  0.000  0.000\n\n$mean\nt4 t3 t2 c4 c3 c2 t1 c1 \n 0  0  0  0  0  0  0  0",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#modification-indices-5",
    "href": "sem.html#modification-indices-5",
    "title": "Structural Equation Modeling",
    "section": "\n9.6 Modification Indices",
    "text": "9.6 Modification Indices\n\nCodemodificationindices(\n  clpm_fit,\n  sort. = TRUE)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#path-diagram-5",
    "href": "sem.html#path-diagram-5",
    "title": "Structural Equation Modeling",
    "section": "\n9.7 Path Diagram",
    "text": "9.7 Path Diagram\n\nCodesemPaths(\n  clpm_fit,\n  what = \"Std.all\",\n  layout = \"tree2\",\n  edge.label.cex = 1.5)\n\n\n\n\n\n\nCodelavaanPlot::lavaanPlot(\n  clpm_fit,\n  coefs = TRUE,\n  #covs = TRUE,\n  stand = TRUE)\n\n\n\n\nCodelavaanPlot::lavaanPlot2(\n  clpm_fit,\n  #stand = TRUE, # currently throws error; uncomment out when fixed: https://github.com/alishinski/lavaanPlot/issues/52\n  coef_labels = TRUE)\n\n\n\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(clpm_fit)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#model-syntax-6",
    "href": "sem.html#model-syntax-6",
    "title": "Structural Equation Modeling",
    "section": "\n10.1 Model Syntax",
    "text": "10.1 Model Syntax\n\n10.1.1 Abbreviated\nAdapted from Mulder & Hamaker (2021): https://doi.org/10.1080/10705511.2020.1784738\nhttps://jeroendmulder.github.io/RI-CLPM/lavaan.html (archived at https://perma.cc/2K6A-WUJQ)\n\nCodericlpm1_syntax &lt;- '\n  # Random Intercepts\n  t =~ 1*t1 + 1*t2 + 1*t3 + 1*t4\n  c =~ 1*c1 + 1*c2 + 1*c3 + 1*c4\n  \n  # Create Within-Person Centered Variables\n  wt1 =~ 1*t1\n  wt2 =~ 1*t2\n  wt3 =~ 1*t3\n  wt4 =~ 1*t4\n  \n  wc1 =~ 1*c1\n  wc2 =~ 1*c2\n  wc3 =~ 1*c3\n  wc4 =~ 1*c4\n  \n  # Autoregressive Paths\n  wt4 ~ wt3\n  wt3 ~ wt2\n  wt2 ~ wt1\n  \n  wc4 ~ wc3\n  wc3 ~ wc2\n  wc2 ~ wc1\n  \n  # Concurrent Covariances\n  wt1 ~~ wc1\n  wt2 ~~ wc2\n  wt3 ~~ wc3\n  wt4 ~~ wc4\n  \n  # Cross-Lagged Paths\n  wt4 ~ wc3\n  wt3 ~ wc2\n  wt2 ~ wc1\n  \n  wc4 ~ wt3\n  wc3 ~ wt2\n  wc2 ~ wt1\n  \n  # Variance and Covariance of Random Intercepts\n  t ~~ t\n  c ~~ c\n  t ~~ c\n  \n  # Variances of Within-Person Centered Variables\n  wt1 ~~ wt1\n  wt2 ~~ wt2\n  wt3 ~~ wt3\n  wt4 ~~ wt4\n  \n  wc1 ~~ wc1\n  wc2 ~~ wc2\n  wc3 ~~ wc3\n  wc4 ~~ wc4\n'\n\n\n\n10.1.2 Full\nAdapted from Mund & Nestler (2017): https://osf.io/a4dhk\n\nCodericlpm2_syntax &lt;- '\n  # Random Intercepts\n  t =~ 1*t1 + 1*t2 + 1*t3 + 1*t4\n  c =~ 1*c1 + 1*c2 + 1*c3 + 1*c4\n  \n  # Create Within-Person Centered Variables\n  wt1 =~ 1*t1\n  wt2 =~ 1*t2\n  wt3 =~ 1*t3\n  wt4 =~ 1*t4\n  \n  wc1 =~ 1*c1\n  wc2 =~ 1*c2\n  wc3 =~ 1*c3\n  wc4 =~ 1*c4\n  \n  # Autoregressive Paths\n  wt4 ~ wt3\n  wt3 ~ wt2\n  wt2 ~ wt1\n  \n  wc4 ~ wc3\n  wc3 ~ wc2\n  wc2 ~ wc1\n  \n  # Concurrent Covariances\n  wt1 ~~ wc1\n  wt2 ~~ wc2\n  wt3 ~~ wc3\n  wt4 ~~ wc4\n  \n  # Cross-Lagged Paths\n  wt4 ~ wc3\n  wt3 ~ wc2\n  wt2 ~ wc1\n  \n  wc4 ~ wt3\n  wc3 ~ wt2\n  wc2 ~ wt1\n  \n  # Variance and Covariance of Random Intercepts\n  t ~~ t\n  c ~~ c\n  t ~~ c\n  \n  # Variances of Within-Person Centered Variables\n  wt1 ~~ wt1\n  wt2 ~~ wt2\n  wt3 ~~ wt3\n  wt4 ~~ wt4\n  \n  wc1 ~~ wc1\n  wc2 ~~ wc2\n  wc3 ~~ wc3\n  wc4 ~~ wc4\n  \n  # Fix Error Variances of Observed Variables to Zero\n  t1 ~~ 0*t1\n  t2 ~~ 0*t2\n  t3 ~~ 0*t3\n  t4 ~~ 0*t4\n  \n  c1 ~~ 0*c1\n  c2 ~~ 0*c2\n  c3 ~~ 0*c3\n  c4 ~~ 0*c4\n  \n  # Fix the Covariances Between the Random Intercepts and the Latents at T1 to Zero\n  wt1 ~~ 0*t\n  wt1 ~~ 0*c\n  \n  wc1 ~~ 0*t\n  wc1 ~~ 0*c\n  \n  # Estimate Observed Intercepts\n  t1 ~ 1\n  t2 ~ 1\n  t3 ~ 1\n  t4 ~ 1\n  \n  c1 ~ 1\n  c2 ~ 1\n  c3 ~ 1\n  c4 ~ 1\n  \n  # Fix the Means of the Latents to Zero\n  wt1 ~ 0*1\n  wt2 ~ 0*1\n  wt3 ~ 0*1\n  wt4 ~ 0*1\n  \n  wc1 ~ 0*1\n  wc2 ~ 0*1\n  wc3 ~ 0*1\n  wc4 ~ 0*1\n  \n  t ~ 0*1\n  c ~ 0*1\n'",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#fit-the-model-6",
    "href": "sem.html#fit-the-model-6",
    "title": "Structural Equation Modeling",
    "section": "\n10.2 Fit the Model",
    "text": "10.2 Fit the Model\n\n10.2.1 Abbreviated\n\nCodericlpm1_fit &lt;- lavaan(\n  riclpm1_syntax,\n  data = Demo.growth,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  int.ov.free = TRUE,\n  fixed.x = FALSE,\n  em.h1.iter.max = 100000)\n\n\n\n10.2.2 Full\n\nCodericlpm2_fit &lt;- sem(\n  riclpm2_syntax,\n  data = Demo.growth,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  fixed.x = FALSE,\n  em.h1.iter.max = 100000)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#summary-output-6",
    "href": "sem.html#summary-output-6",
    "title": "Structural Equation Modeling",
    "section": "\n10.3 Summary Output",
    "text": "10.3 Summary Output\n\n10.3.1 Abbreviated\n\nCodesummary(\n  riclpm1_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 63 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        35\n\n  Number of observations                           400\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                39.156      38.001\n  Degrees of freedom                                 9           9\n  P-value (Chi-square)                           0.000       0.000\n  Scaling correction factor                                  1.030\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              1933.670    1953.262\n  Degrees of freedom                                28          28\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.990\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.984       0.985\n  Tucker-Lewis Index (TLI)                       0.951       0.953\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.984\n  Robust Tucker-Lewis Index (TLI)                            0.951\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -4877.566   -4877.566\n  Scaling correction factor                                  1.003\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -4857.988   -4857.988\n  Scaling correction factor                                  1.008\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                                9825.132    9825.132\n  Bayesian (BIC)                              9964.833    9964.833\n  Sample-size adjusted Bayesian (SABIC)       9853.776    9853.776\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.092       0.090\n  90 Percent confidence interval - lower         0.063       0.062\n  90 Percent confidence interval - upper         0.122       0.120\n  P-value H_0: RMSEA &lt;= 0.050                    0.009       0.011\n  P-value H_0: RMSEA &gt;= 0.080                    0.766       0.737\n                                                                  \n  Robust RMSEA                                               0.091\n  90 Percent confidence interval - lower                     0.062\n  90 Percent confidence interval - upper                     0.122\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.011\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.756\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.023       0.023\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  t =~                                                                  \n    t1                1.000                                  NA       NA\n    t2                1.000                                  NA       NA\n    t3                1.000                                  NA       NA\n    t4                1.000                                  NA       NA\n  c =~                                                                  \n    c1                1.000                               0.206    0.209\n    c2                1.000                               0.206    0.217\n    c3                1.000                               0.206    0.220\n    c4                1.000                               0.206    0.224\n  wt1 =~                                                                \n    t1                1.000                               2.318    1.462\n  wt2 =~                                                                \n    t2                1.000                               2.695    1.284\n  wt3 =~                                                                \n    t3                1.000                               3.219    1.175\n  wt4 =~                                                                \n    t4                1.000                               3.786    1.118\n  wc1 =~                                                                \n    c1                1.000                               0.965    0.978\n  wc2 =~                                                                \n    c2                1.000                               0.927    0.976\n  wc3 =~                                                                \n    c3                1.000                               0.915    0.976\n  wc4 =~                                                                \n    c4                1.000                               0.894    0.975\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  wt4 ~                                                                 \n    wt3               1.126    0.029   38.930    0.000    0.957    0.957\n  wt3 ~                                                                 \n    wt2               1.093    0.025   43.596    0.000    0.915    0.915\n  wt2 ~                                                                 \n    wt1               1.005    0.025   40.746    0.000    0.864    0.864\n  wc4 ~                                                                 \n    wc3               0.004    0.061    0.063    0.950    0.004    0.004\n  wc3 ~                                                                 \n    wc2              -0.047    0.056   -0.839    0.401   -0.048   -0.048\n  wc2 ~                                                                 \n    wc1               0.042    0.051    0.816    0.415    0.043    0.043\n  wt4 ~                                                                 \n    wc3              -0.291    0.076   -3.838    0.000   -0.070   -0.070\n  wt3 ~                                                                 \n    wc2              -0.326    0.074   -4.413    0.000   -0.094   -0.094\n  wt2 ~                                                                 \n    wc1              -0.113    0.068   -1.661    0.097   -0.041   -0.041\n  wc4 ~                                                                 \n    wt3              -0.021    0.020   -1.044    0.296   -0.075   -0.075\n  wc3 ~                                                                 \n    wt2               0.020    0.023    0.881    0.378    0.059    0.059\n  wc2 ~                                                                 \n    wt1              -0.010    0.024   -0.420    0.675   -0.025   -0.025\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  wt1 ~~                                                                \n    wc1              -0.007    0.136   -0.054    0.957   -0.003   -0.003\n .wt2 ~~                                                                \n   .wc2               0.242    0.064    3.775    0.000    0.193    0.193\n .wt3 ~~                                                                \n   .wc3               0.385    0.074    5.191    0.000    0.322    0.322\n .wt4 ~~                                                                \n   .wc4               0.238    0.058    4.071    0.000    0.219    0.219\n  t ~~                                                                  \n    c                 0.082    0.107    0.761    0.447    0.235    0.235\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t1                0.595    0.079    7.531    0.000    0.595    0.375\n   .t2                1.673    0.106   15.763    0.000    1.673    0.797\n   .t3                2.593    0.136   19.058    0.000    2.593    0.947\n   .t4                3.639    0.169   21.572    0.000    3.639    1.074\n   .c1                0.008    0.049    0.158    0.874    0.008    0.008\n   .c2                0.029    0.047    0.610    0.542    0.029    0.030\n   .c3                0.068    0.047    1.449    0.147    0.068    0.072\n   .c4               -0.018    0.046   -0.390    0.696   -0.018   -0.020\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    t                -2.861    1.350   -2.119    0.034       NA       NA\n    c                 0.042    0.026    1.637    0.102    1.000    1.000\n    wt1               5.373    1.412    3.804    0.000    1.000    1.000\n   .wt2               1.829    0.138   13.209    0.000    0.252    0.252\n   .wt3               1.719    0.127   13.564    0.000    0.166    0.166\n   .wt4               1.484    0.097   15.331    0.000    0.103    0.103\n    wc1               0.931    0.067   13.826    0.000    1.000    1.000\n   .wc2               0.856    0.065   13.256    0.000    0.997    0.997\n   .wc3               0.832    0.070   11.817    0.000    0.995    0.995\n   .wc4               0.795    0.061   13.110    0.000    0.994    0.994\n   .t1                0.000                               0.000    0.000\n   .t2                0.000                               0.000    0.000\n   .t3                0.000                               0.000    0.000\n   .t4                0.000                               0.000    0.000\n   .c1                0.000                               0.000    0.000\n   .c2                0.000                               0.000    0.000\n   .c3                0.000                               0.000    0.000\n   .c4                0.000                               0.000    0.000\n\nR-Square:\n                   Estimate\n    wt2               0.748\n    wt3               0.834\n    wt4               0.897\n    wc2               0.003\n    wc3               0.005\n    wc4               0.006\n    t1                1.000\n    t2                1.000\n    t3                1.000\n    t4                1.000\n    c1                1.000\n    c2                1.000\n    c3                1.000\n    c4                1.000\n\n\n\n10.3.2 Full\n\nCodesummary(\n  riclpm2_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 63 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        35\n\n  Number of observations                           400\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                39.156      38.001\n  Degrees of freedom                                 9           9\n  P-value (Chi-square)                           0.000       0.000\n  Scaling correction factor                                  1.030\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              1933.670    1953.262\n  Degrees of freedom                                28          28\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.990\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.984       0.985\n  Tucker-Lewis Index (TLI)                       0.951       0.953\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.984\n  Robust Tucker-Lewis Index (TLI)                            0.951\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -4877.566   -4877.566\n  Scaling correction factor                                  1.003\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -4857.988   -4857.988\n  Scaling correction factor                                  1.008\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                                9825.132    9825.132\n  Bayesian (BIC)                              9964.833    9964.833\n  Sample-size adjusted Bayesian (SABIC)       9853.776    9853.776\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.092       0.090\n  90 Percent confidence interval - lower         0.063       0.062\n  90 Percent confidence interval - upper         0.122       0.120\n  P-value H_0: RMSEA &lt;= 0.050                    0.009       0.011\n  P-value H_0: RMSEA &gt;= 0.080                    0.766       0.737\n                                                                  \n  Robust RMSEA                                               0.091\n  90 Percent confidence interval - lower                     0.062\n  90 Percent confidence interval - upper                     0.122\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.011\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.756\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.023       0.023\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  t =~                                                                  \n    t1                1.000                                  NA       NA\n    t2                1.000                                  NA       NA\n    t3                1.000                                  NA       NA\n    t4                1.000                                  NA       NA\n  c =~                                                                  \n    c1                1.000                               0.206    0.209\n    c2                1.000                               0.206    0.217\n    c3                1.000                               0.206    0.220\n    c4                1.000                               0.206    0.224\n  wt1 =~                                                                \n    t1                1.000                               2.318    1.462\n  wt2 =~                                                                \n    t2                1.000                               2.695    1.284\n  wt3 =~                                                                \n    t3                1.000                               3.219    1.175\n  wt4 =~                                                                \n    t4                1.000                               3.786    1.118\n  wc1 =~                                                                \n    c1                1.000                               0.965    0.978\n  wc2 =~                                                                \n    c2                1.000                               0.927    0.976\n  wc3 =~                                                                \n    c3                1.000                               0.915    0.976\n  wc4 =~                                                                \n    c4                1.000                               0.894    0.975\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  wt4 ~                                                                 \n    wt3               1.126    0.029   38.930    0.000    0.957    0.957\n  wt3 ~                                                                 \n    wt2               1.093    0.025   43.596    0.000    0.915    0.915\n  wt2 ~                                                                 \n    wt1               1.005    0.025   40.746    0.000    0.864    0.864\n  wc4 ~                                                                 \n    wc3               0.004    0.061    0.063    0.950    0.004    0.004\n  wc3 ~                                                                 \n    wc2              -0.047    0.056   -0.839    0.401   -0.048   -0.048\n  wc2 ~                                                                 \n    wc1               0.042    0.051    0.816    0.415    0.043    0.043\n  wt4 ~                                                                 \n    wc3              -0.291    0.076   -3.838    0.000   -0.070   -0.070\n  wt3 ~                                                                 \n    wc2              -0.326    0.074   -4.413    0.000   -0.094   -0.094\n  wt2 ~                                                                 \n    wc1              -0.113    0.068   -1.661    0.097   -0.041   -0.041\n  wc4 ~                                                                 \n    wt3              -0.021    0.020   -1.044    0.296   -0.075   -0.075\n  wc3 ~                                                                 \n    wt2               0.020    0.023    0.881    0.378    0.059    0.059\n  wc2 ~                                                                 \n    wt1              -0.010    0.024   -0.420    0.675   -0.025   -0.025\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  wt1 ~~                                                                \n    wc1              -0.007    0.136   -0.054    0.957   -0.003   -0.003\n .wt2 ~~                                                                \n   .wc2               0.242    0.064    3.775    0.000    0.193    0.193\n .wt3 ~~                                                                \n   .wc3               0.385    0.074    5.191    0.000    0.322    0.322\n .wt4 ~~                                                                \n   .wc4               0.238    0.058    4.071    0.000    0.219    0.219\n  t ~~                                                                  \n    c                 0.082    0.107    0.761    0.447    0.235    0.235\n    wt1               0.000                               0.000    0.000\n  c ~~                                                                  \n    wt1               0.000                               0.000    0.000\n  t ~~                                                                  \n    wc1               0.000                               0.000    0.000\n  c ~~                                                                  \n    wc1               0.000                               0.000    0.000\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t1                0.595    0.079    7.531    0.000    0.595    0.375\n   .t2                1.673    0.106   15.763    0.000    1.673    0.797\n   .t3                2.593    0.136   19.058    0.000    2.593    0.947\n   .t4                3.639    0.169   21.572    0.000    3.639    1.074\n   .c1                0.008    0.049    0.158    0.874    0.008    0.008\n   .c2                0.029    0.047    0.610    0.542    0.029    0.030\n   .c3                0.068    0.047    1.449    0.147    0.068    0.072\n   .c4               -0.018    0.046   -0.390    0.696   -0.018   -0.020\n    wt1               0.000                               0.000    0.000\n   .wt2               0.000                               0.000    0.000\n   .wt3               0.000                               0.000    0.000\n   .wt4               0.000                               0.000    0.000\n    wc1               0.000                               0.000    0.000\n   .wc2               0.000                               0.000    0.000\n   .wc3               0.000                               0.000    0.000\n   .wc4               0.000                               0.000    0.000\n    t                 0.000                                  NA       NA\n    c                 0.000                               0.000    0.000\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    t                -2.861    1.350   -2.119    0.034       NA       NA\n    c                 0.042    0.026    1.637    0.102    1.000    1.000\n    wt1               5.373    1.412    3.804    0.000    1.000    1.000\n   .wt2               1.829    0.138   13.209    0.000    0.252    0.252\n   .wt3               1.719    0.127   13.564    0.000    0.166    0.166\n   .wt4               1.484    0.097   15.331    0.000    0.103    0.103\n    wc1               0.931    0.067   13.826    0.000    1.000    1.000\n   .wc2               0.856    0.065   13.256    0.000    0.997    0.997\n   .wc3               0.832    0.070   11.817    0.000    0.995    0.995\n   .wc4               0.795    0.061   13.110    0.000    0.994    0.994\n   .t1                0.000                               0.000    0.000\n   .t2                0.000                               0.000    0.000\n   .t3                0.000                               0.000    0.000\n   .t4                0.000                               0.000    0.000\n   .c1                0.000                               0.000    0.000\n   .c2                0.000                               0.000    0.000\n   .c3                0.000                               0.000    0.000\n   .c4                0.000                               0.000    0.000\n\nR-Square:\n                   Estimate\n    wt2               0.748\n    wt3               0.834\n    wt4               0.897\n    wc2               0.003\n    wc3               0.005\n    wc4               0.006\n    t1                1.000\n    t2                1.000\n    t3                1.000\n    t4                1.000\n    c1                1.000\n    c2                1.000\n    c3                1.000\n    c4                1.000",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#estimates-of-model-fit-6",
    "href": "sem.html#estimates-of-model-fit-6",
    "title": "Structural Equation Modeling",
    "section": "\n10.4 Estimates of Model Fit",
    "text": "10.4 Estimates of Model Fit\n\nCodefitMeasures(\n  riclpm1_fit,\n  fit.measures = c(\n    \"chisq\", \"df\", \"pvalue\",\n    \"chisq.scaled\", \"df.scaled\", \"pvalue.scaled\",\n    \"chisq.scaling.factor\",\n    \"baseline.chisq\",\"baseline.df\",\"baseline.pvalue\",\n    \"rmsea\", \"cfi\", \"tli\", \"srmr\",\n    \"rmsea.robust\", \"cfi.robust\", \"tli.robust\"))\n\n               chisq                   df               pvalue \n              39.156                9.000                0.000 \n        chisq.scaled            df.scaled        pvalue.scaled \n              38.001                9.000                0.000 \nchisq.scaling.factor       baseline.chisq          baseline.df \n               1.030             1933.670               28.000 \n     baseline.pvalue                rmsea                  cfi \n               0.000                0.092                0.984 \n                 tli                 srmr         rmsea.robust \n               0.951                0.023                0.091 \n          cfi.robust           tli.robust \n               0.984                0.951",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#residuals-of-observed-vs.-model-implied-correlation-matrix-6",
    "href": "sem.html#residuals-of-observed-vs.-model-implied-correlation-matrix-6",
    "title": "Structural Equation Modeling",
    "section": "\n10.5 Residuals of Observed vs. Model-Implied Correlation Matrix",
    "text": "10.5 Residuals of Observed vs. Model-Implied Correlation Matrix\n\nCoderesiduals(\n  riclpm1_fit,\n  type = \"cor\")\n\n$type\n[1] \"cor.bollen\"\n\n$cov\n       t1     t2     t3     t4     c1     c2     c3     c4\nt1  0.000                                                 \nt2  0.007  0.000                                          \nt3  0.012 -0.004  0.000                                   \nt4  0.005  0.023  0.000  0.000                            \nc1  0.025  0.018 -0.009  0.062  0.000                     \nc2  0.003  0.000  0.000  0.005 -0.001  0.000              \nc3 -0.013  0.008  0.008  0.009 -0.074 -0.005  0.000       \nc4  0.026  0.003 -0.020 -0.013  0.090 -0.014  0.001  0.000\n\n$mean\nt1 t2 t3 t4 c1 c2 c3 c4 \n 0  0  0  0  0  0  0  0",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#modification-indices-6",
    "href": "sem.html#modification-indices-6",
    "title": "Structural Equation Modeling",
    "section": "\n10.6 Modification Indices",
    "text": "10.6 Modification Indices\n\nCodemodificationindices(\n  riclpm1_fit,\n  sort. = TRUE)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#internal-consistency-reliability-4",
    "href": "sem.html#internal-consistency-reliability-4",
    "title": "Structural Equation Modeling",
    "section": "\n10.7 Internal Consistency Reliability",
    "text": "10.7 Internal Consistency Reliability\n\nCodecompRelSEM(riclpm1_fit)\n\n     t      c \n-0.544  0.166",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#path-diagram-6",
    "href": "sem.html#path-diagram-6",
    "title": "Structural Equation Modeling",
    "section": "\n10.8 Path Diagram",
    "text": "10.8 Path Diagram\n\nCodesemPaths(\n  riclpm1_fit,\n  what = \"Std.all\",\n  layout = \"tree2\",\n  edge.label.cex = 1.5)\n\n\n\n\n\n\nCodelavaanPlot::lavaanPlot(\n  riclpm1_fit,\n  coefs = TRUE,\n  #covs = TRUE,\n  stand = TRUE)\n\n\n\n\nCodelavaanPlot::lavaanPlot2(\n  riclpm1_fit,\n  #stand = TRUE, # currently throws error; uncomment out when fixed: https://github.com/alishinski/lavaanPlot/issues/52\n  coef_labels = TRUE)\n\n\n\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(riclpm1_fit)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#model-syntax-7",
    "href": "sem.html#model-syntax-7",
    "title": "Structural Equation Modeling",
    "section": "\n11.1 Model Syntax",
    "text": "11.1 Model Syntax\nAdapted from Mund & Nestler (2017): https://osf.io/a4dhk\n\nCodelcmsr_syntax &lt;- '\n  # Define intercept and growth factors\n  intercept.t =~ 1*t1 + 1*t2 + 1*t3 + 1*t4\n  slope.t =~ 0*t1 + 1*t2 + 2*t3 + 3*t4\n  \n  intercept.c =~ 1*c1 + 1*c2 + 1*c3 + 1*c4\n  slope.c =~ 0*c1 + 1*c2 + 2*c3 + 3*c4\n  \n  # Define phantom latent variables\n  e.t1 =~ 1*t1\n  e.t2 =~ 1*t2\n  e.t3 =~ 1*t3\n  e.t4 =~ 1*t4\n  \n  e.c1 =~ 1*c1\n  e.c2 =~ 1*c2\n  e.c3 =~ 1*c3\n  e.c4 =~ 1*c4\n  \n  # Autoregressive paths\n  e.t2 ~ a1*e.t1\n  e.t3 ~ a1*e.t2\n  e.t4 ~ a1*e.t3\n  \n  e.c2 ~ a2*e.c1\n  e.c3 ~ a2*e.c2\n  e.c4 ~ a2*e.c3\n  \n  # Cross-lagged paths\n  e.c2 ~ c1*e.t1\n  e.c3 ~ c1*e.t2\n  e.c4 ~ c1*e.t3\n  \n  e.t2 ~ c2*e.c1\n  e.t3 ~ c2*e.c2\n  e.t4 ~ c2*e.c3\n  \n  # Some further constraints on the variance structure\n  # 1. Set error variances of the observed variables to zero\n  t1 ~~ 0*t1\n  t2 ~~ 0*t2\n  t3 ~~ 0*t3\n  t4 ~~ 0*t4\n  \n  c1 ~~ 0*c1\n  c2 ~~ 0*c2\n  c3 ~~ 0*c3\n  c4 ~~ 0*c4\n  \n  # 2. Let lavaan estimate the variance of the latent variables (residuals)\n  e.t1 ~~ vart1*e.t1\n  e.t2 ~~ vart2*e.t2\n  e.t3 ~~ vart3*e.t3\n  e.t4 ~~ vart4*e.t4\n  \n  e.c1 ~~ varc1*e.c1\n  e.c2 ~~ varc2*e.c2\n  e.c3 ~~ varc3*e.c3\n  e.c4 ~~ varc4*e.c4\n  \n  # 3. We also want estimates of the intercept factor variances, the slope\n  #    variances, and the covariances\n  intercept.t ~~ varintercept.t*intercept.t\n  intercept.c ~~ varintercept.c*intercept.c\n  slope.t ~~ varslope.t*slope.t\n  slope.c ~~ varslope.c*slope.c\n  \n  intercept.t ~~ covintercept*intercept.c\n  slope.t ~~ covslope*slope.c\n  \n  intercept.t ~~ covintercept.tslope.t*slope.t\n  intercept.t ~~ covintercept.tslope.c*slope.c\n  intercept.c ~~ covintercept.cslope.t*slope.t\n  intercept.c ~~ covintercept.cslope.c*slope.c\n  \n  # 4. We have to define that the covariance between the intercepts and\n  #    the slopes and the latents of the first time point are zero\n  e.t1 ~~ 0*intercept.t\n  e.c1 ~~ 0*intercept.t\n  e.t1 ~~ 0*slope.t\n  e.c1 ~~ 0*slope.t\n  e.t1 ~~ 0*intercept.c\n  e.c1 ~~ 0*intercept.c\n  e.t1 ~~ 0*slope.c\n  e.c1 ~~ 0*slope.c\n  \n  # 5. Finally, we estimate the covariance between the latents of x and y\n  #    of the first time point, the second time-point and so on. Note that\n  #    for the second to fourth time point the correlation is constrained to\n  #    the same value\n  e.t1 ~~ cov1*e.c1\n  e.t2 ~~ e1*e.c2\n  e.t3 ~~ e1*e.c3\n  e.t4 ~~ e1*e.c4\n  \n  # The model also contains a mean structure and we have to define some\n  # constraints for this part of the model. The assumption is that we\n  # only want estimates of the mean of the intercept factors. All other means\n  # are defined to be zero:\n  t1 ~ 0*1\n  t2 ~ 0*1\n  t3 ~ 0*1\n  t4 ~ 0*1\n  \n  c1 ~ 0*1\n  c2 ~ 0*1\n  c3 ~ 0*1\n  c4 ~ 0*1\n  \n  e.t1 ~ 0*1\n  e.t2 ~ 0*1\n  e.t3 ~ 0*1\n  e.t4 ~ 0*1\n  \n  e.c1 ~ 0*1\n  e.c2 ~ 0*1\n  e.c3 ~ 0*1\n  e.c4 ~ 0*1\n  \n  intercept.t ~ 1\n  intercept.c ~ 1\n  slope.t ~ 1\n  slope.c ~ 1\n'",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#fit-the-model-7",
    "href": "sem.html#fit-the-model-7",
    "title": "Structural Equation Modeling",
    "section": "\n11.2 Fit the Model",
    "text": "11.2 Fit the Model\n\nCodelcmsr_fit &lt;- sem(\n  lcmsr_syntax,\n  data = Demo.growth,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  fixed.x = FALSE,\n  em.h1.iter.max = 100000)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#summary-output-7",
    "href": "sem.html#summary-output-7",
    "title": "Structural Equation Modeling",
    "section": "\n11.3 Summary Output",
    "text": "11.3 Summary Output\n\nCodesummary(\n  lcmsr_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 68 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        38\n  Number of equality constraints                    10\n\n  Number of observations                           400\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                34.165      34.572\n  Degrees of freedom                                16          16\n  P-value (Chi-square)                           0.005       0.005\n  Scaling correction factor                                  0.988\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              1933.670    1953.262\n  Degrees of freedom                                28          28\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.990\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.990       0.990\n  Tucker-Lewis Index (TLI)                       0.983       0.983\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.990\n  Robust Tucker-Lewis Index (TLI)                            0.983\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -4875.071   -4875.071\n  Scaling correction factor                                  0.751\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -4857.988   -4857.988\n  Scaling correction factor                                  1.008\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                                9806.141    9806.141\n  Bayesian (BIC)                              9917.902    9917.902\n  Sample-size adjusted Bayesian (SABIC)       9829.056    9829.056\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.053       0.054\n  90 Percent confidence interval - lower         0.028       0.029\n  90 Percent confidence interval - upper         0.078       0.079\n  P-value H_0: RMSEA &lt;= 0.050                    0.380       0.365\n  P-value H_0: RMSEA &gt;= 0.080                    0.037       0.041\n                                                                  \n  Robust RMSEA                                               0.053\n  90 Percent confidence interval - lower                     0.028\n  90 Percent confidence interval - upper                     0.078\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.380\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.037\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.047       0.047\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept.t =~                                                        \n    t1                1.000                               1.314    0.827\n    t2                1.000                               1.314    0.623\n    t3                1.000                               1.314    0.483\n    t4                1.000                               1.314    0.389\n  slope.t =~                                                            \n    t1                0.000                               0.000    0.000\n    t2                1.000                               0.740    0.351\n    t3                2.000                               1.480    0.544\n    t4                3.000                               2.220    0.657\n  intercept.c =~                                                        \n    c1                1.000                                  NA       NA\n    c2                1.000                                  NA       NA\n    c3                1.000                                  NA       NA\n    c4                1.000                                  NA       NA\n  slope.c =~                                                            \n    c1                0.000                                  NA       NA\n    c2                1.000                                  NA       NA\n    c3                2.000                                  NA       NA\n    c4                3.000                                  NA       NA\n  e.t1 =~                                                               \n    t1                1.000                               0.894    0.562\n  e.t2 =~                                                               \n    t2                1.000                               0.892    0.423\n  e.t3 =~                                                               \n    t3                1.000                               0.852    0.313\n  e.t4 =~                                                               \n    t4                1.000                               0.794    0.235\n  e.c1 =~                                                               \n    c1                1.000                               1.021    1.041\n  e.c2 =~                                                               \n    c2                1.000                               0.964    1.007\n  e.c3 =~                                                               \n    c3                1.000                               0.943    1.009\n  e.c4 =~                                                               \n    c4                1.000                               0.967    1.052\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  e.t2 ~                                                                \n    e.t1      (a1)    0.145    0.096    1.511    0.131    0.145    0.145\n  e.t3 ~                                                                \n    e.t2      (a1)    0.145    0.096    1.511    0.131    0.152    0.152\n  e.t4 ~                                                                \n    e.t3      (a1)    0.145    0.096    1.511    0.131    0.156    0.156\n  e.c2 ~                                                                \n    e.c1      (a2)    0.056    0.080    0.697    0.486    0.059    0.059\n  e.c3 ~                                                                \n    e.c2      (a2)    0.056    0.080    0.697    0.486    0.057    0.057\n  e.c4 ~                                                                \n    e.c3      (a2)    0.056    0.080    0.697    0.486    0.054    0.054\n  e.c2 ~                                                                \n    e.t1      (c1)    0.027    0.075    0.361    0.718    0.025    0.025\n  e.c3 ~                                                                \n    e.t2      (c1)    0.027    0.075    0.361    0.718    0.026    0.026\n  e.c4 ~                                                                \n    e.t3      (c1)    0.027    0.075    0.361    0.718    0.024    0.024\n  e.t2 ~                                                                \n    e.c1      (c2)    0.023    0.066    0.354    0.723    0.027    0.027\n  e.t3 ~                                                                \n    e.c2      (c2)    0.023    0.066    0.354    0.723    0.026    0.026\n  e.t4 ~                                                                \n    e.c3      (c2)    0.023    0.066    0.354    0.723    0.028    0.028\n\nCovariances:\n                           Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv\n  intercept.t ~~                                                       \n                    (cvnt)   -0.117    0.137   -0.854    0.393   -0.313\n  slope.t ~~                                                           \n                    (cvsl)   -0.049    0.028   -1.743    0.081   -0.348\n  intercept.t ~~                                                       \n         (cvntrcpt.tslp.t)    0.688    0.091    7.525    0.000    0.707\n         (cvntrcpt.tslp.c)    0.068    0.056    1.224    0.221    0.274\n  slope.t ~~                                                           \n         (cvntrcpt.cslp.t)    0.095    0.055    1.728    0.084    0.454\n  intercept.c ~~                                                       \n         (cvntrcpt.cslp.c)    0.052    0.064    0.821    0.412    0.971\n  intercept.t ~~                                                       \n                              0.000                               0.000\n                              0.000                               0.000\n  slope.t ~~                                                           \n                              0.000                               0.000\n                              0.000                               0.000\n  intercept.c ~~                                                       \n                              0.000                               0.000\n                              0.000                               0.000\n  slope.c ~~                                                           \n                              0.000                               0.000\n                              0.000                               0.000\n  e.t1 ~~                                                              \n                    (cov1)    0.275    0.138    1.993    0.046    0.301\n .e.t2 ~~                                                              \n   .                  (e1)    0.317    0.054    5.859    0.000    0.373\n .e.t3 ~~                                                              \n   .                  (e1)    0.317    0.054    5.859    0.000    0.400\n .e.t4 ~~                                                              \n   .                  (e1)    0.317    0.054    5.859    0.000    0.419\n  Std.all\n         \n   -0.313\n         \n   -0.348\n         \n    0.707\n    0.274\n         \n    0.454\n         \n    0.971\n         \n    0.000\n    0.000\n         \n    0.000\n    0.000\n         \n    0.000\n    0.000\n         \n    0.000\n    0.000\n         \n    0.301\n         \n    0.373\n         \n    0.400\n         \n    0.419\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t1                0.000                               0.000    0.000\n   .t2                0.000                               0.000    0.000\n   .t3                0.000                               0.000    0.000\n   .t4                0.000                               0.000    0.000\n   .c1                0.000                               0.000    0.000\n   .c2                0.000                               0.000    0.000\n   .c3                0.000                               0.000    0.000\n   .c4                0.000                               0.000    0.000\n    e.t1              0.000                               0.000    0.000\n   .e.t2              0.000                               0.000    0.000\n   .e.t3              0.000                               0.000    0.000\n   .e.t4              0.000                               0.000    0.000\n    e.c1              0.000                               0.000    0.000\n   .e.c2              0.000                               0.000    0.000\n   .e.c3              0.000                               0.000    0.000\n   .e.c4              0.000                               0.000    0.000\n    intercept.t       0.612    0.077    7.962    0.000    0.465    0.465\n    intercept.c       0.027    0.040    0.661    0.509       NA       NA\n    slope.t           1.008    0.042   24.209    0.000    1.362    1.362\n    slope.c          -0.003    0.020   -0.166    0.868       NA       NA\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .t                 0.000                               0.000    0.000\n   .t                 0.000                               0.000    0.000\n   .t                 0.000                               0.000    0.000\n   .t                 0.000                               0.000    0.000\n   .c                 0.000                               0.000    0.000\n   .c                 0.000                               0.000    0.000\n   .c                 0.000                               0.000    0.000\n   .c                 0.000                               0.000    0.000\n    e       (vrt1)    0.799    0.193    4.137    0.000    1.000    1.000\n   .e       (vrt2)    0.777    0.083    9.416    0.000    0.976    0.976\n   .e       (vrt3)    0.706    0.101    6.979    0.000    0.973    0.973\n   .e       (vrt4)    0.613    0.121    5.054    0.000    0.972    0.972\n    e       (vrc1)    1.043    0.184    5.680    0.000    1.000    1.000\n   .e       (vrc2)    0.925    0.081   11.425    0.000    0.995    0.995\n   .e       (vrc3)    0.885    0.088   10.060    0.000    0.995    0.995\n   .e       (vrc4)    0.931    0.130    7.180    0.000    0.995    0.995\n    i (vrntrcpt.t)    1.727    0.224    7.708    0.000    1.000    1.000\n    i (vrntrcpt.c)   -0.080    0.166   -0.484    0.628       NA       NA\n    s    (vrslp.t)    0.548    0.065    8.464    0.000    1.000    1.000\n    s    (vrslp.c)   -0.036    0.038   -0.956    0.339       NA       NA\n\nR-Square:\n                   Estimate\n    t1                1.000\n    t2                1.000\n    t3                1.000\n    t4                1.000\n    c1                1.000\n    c2                1.000\n    c3                1.000\n    c4                1.000\n    e.t2              0.024\n    e.t3              0.027\n    e.t4              0.028\n    e.c2              0.005\n    e.c3              0.005\n    e.c4              0.005",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#estimates-of-model-fit-7",
    "href": "sem.html#estimates-of-model-fit-7",
    "title": "Structural Equation Modeling",
    "section": "\n11.4 Estimates of Model Fit",
    "text": "11.4 Estimates of Model Fit\n\nCodefitMeasures(\n  lcmsr_fit,\n  fit.measures = c(\n    \"chisq\", \"df\", \"pvalue\",\n    \"chisq.scaled\", \"df.scaled\", \"pvalue.scaled\",\n    \"chisq.scaling.factor\",\n    \"baseline.chisq\",\"baseline.df\",\"baseline.pvalue\",\n    \"rmsea\", \"cfi\", \"tli\", \"srmr\",\n    \"rmsea.robust\", \"cfi.robust\", \"tli.robust\"))\n\n               chisq                   df               pvalue \n              34.165               16.000                0.005 \n        chisq.scaled            df.scaled        pvalue.scaled \n              34.572               16.000                0.005 \nchisq.scaling.factor       baseline.chisq          baseline.df \n               0.988             1933.670               28.000 \n     baseline.pvalue                rmsea                  cfi \n               0.000                0.053                0.990 \n                 tli                 srmr         rmsea.robust \n               0.983                0.047                0.053 \n          cfi.robust           tli.robust \n               0.990                0.983",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#residuals-of-observed-vs.-model-implied-correlation-matrix-7",
    "href": "sem.html#residuals-of-observed-vs.-model-implied-correlation-matrix-7",
    "title": "Structural Equation Modeling",
    "section": "\n11.5 Residuals of Observed vs. Model-Implied Correlation Matrix",
    "text": "11.5 Residuals of Observed vs. Model-Implied Correlation Matrix\n\nCoderesiduals(\n  lcmsr_fit,\n  type = \"cor\")\n\n$type\n[1] \"cor.bollen\"\n\n$cov\n       t1     t2     t3     t4     c1     c2     c3     c4\nt1  0.000                                                 \nt2  0.013  0.000                                          \nt3 -0.005 -0.004  0.000                                   \nt4  0.001  0.001 -0.001  0.000                            \nc1 -0.028 -0.017 -0.061 -0.011  0.000                     \nc2  0.029 -0.026 -0.042 -0.026  0.046  0.000              \nc3  0.100  0.090  0.120  0.127 -0.065 -0.071  0.000       \nc4 -0.063 -0.061 -0.082 -0.070  0.055  0.007  0.014  0.000\n\n$mean\n    t1     t2     t3     t4     c1     c2     c3     c4 \n-0.011  0.025 -0.013  0.001 -0.019  0.006  0.051 -0.038",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#modification-indices-7",
    "href": "sem.html#modification-indices-7",
    "title": "Structural Equation Modeling",
    "section": "\n11.6 Modification Indices",
    "text": "11.6 Modification Indices\n\nCodemodificationindices(\n  lcmsr_fit,\n  sort. = TRUE)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#internal-consistency-reliability-5",
    "href": "sem.html#internal-consistency-reliability-5",
    "title": "Structural Equation Modeling",
    "section": "\n11.7 Internal Consistency Reliability",
    "text": "11.7 Internal Consistency Reliability\n\nCodecompRelSEM(lcmsr_fit)\n\nintercept.t     slope.t intercept.c     slope.c \n      0.328       0.314      -0.315      -0.469",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#path-diagram-7",
    "href": "sem.html#path-diagram-7",
    "title": "Structural Equation Modeling",
    "section": "\n11.8 Path Diagram",
    "text": "11.8 Path Diagram\n\nCodesemPaths(\n  lcmsr_fit,\n  what = \"Std.all\",\n  layout = \"tree2\",\n  edge.label.cex = 1.5)\n\n\n\n\n\n\nCode#lavaanPlot::lavaanPlot( # throws error\n#  lcmsr_fit,\n#  coefs = TRUE,\n#  #covs = TRUE,\n#  stand = TRUE)\n\nlavaanPlot::lavaanPlot2(\n  lcmsr_fit,\n  #stand = TRUE, # currently throws error; uncomment out when fixed: https://github.com/alishinski/lavaanPlot/issues/52\n  coef_labels = TRUE)\n\n\n\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(lcmsr_fit)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#overview-1",
    "href": "sem.html#overview-1",
    "title": "Structural Equation Modeling",
    "section": "\n12.1 Overview",
    "text": "12.1 Overview\nIt is important not to just consider mediation effects where there is a bivariate association between the predictor and the outcome. Sometimes inconsistent mediation occurs where the indirect effect has an opposite sign (i.e., positive or negative) from the direct or total effect. The idea is there there may be multiple mediating mechanisms, and that the predictor/cause may have both beneficial and harmful effects on the outcome, and that the mediating mechanisms can “cancel each other out” in terms of the total effect. For instance, the predictor may help via mechanism A, but may hurt via mechanism B. In this case, the total effect may be weak or small, even though there may be strong mediating effects.",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#model-syntax-8",
    "href": "sem.html#model-syntax-8",
    "title": "Structural Equation Modeling",
    "section": "\n12.2 Model Syntax",
    "text": "12.2 Model Syntax\n\nCodemediationModel &lt;- '\n  # direct effect (cPrime)\n  Y ~ direct*X\n  \n  # mediator\n  M ~ a*X\n  Y ~ b*M\n  \n  # indirect effect = a*b\n  indirect := a*b\n  \n  # total effect (c)\n  total := direct + indirect\n  totalAbs := abs(direct) + abs(indirect)\n  \n  # proportion mediated\n  Pm := abs(indirect) / totalAbs\n'",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#fit-the-model-8",
    "href": "sem.html#fit-the-model-8",
    "title": "Structural Equation Modeling",
    "section": "\n12.3 Fit the Model",
    "text": "12.3 Fit the Model\nTo get a robust estimate of the indirect effect, we obtain bootstrapped estimates from 1,000 bootstrap draws. Typically, we would obtain bootstrapped estimates from 10,000 bootstrap draws, but this example uses only 1,000 bootstrap draws for a shorter runtime.\n\nCodemediationFit &lt;- sem(\n  mediationModel,\n  data = mydata,\n  se = \"bootstrap\",\n  bootstrap = 1000, # generally use 10,000 bootstrap draws; this example uses 1,000 for speed\n  parallel = \"multicore\", # parallelization for speed: use \"multicore\" for Mac/Linux; \"snow\" for PC\n  iseed = 52242, # for reproducibility\n  missing = \"ML\",\n  estimator = \"ML\",\n  # std.lv = TRUE, # for models with latent variables\n  fixed.x = FALSE)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#summary-output-8",
    "href": "sem.html#summary-output-8",
    "title": "Structural Equation Modeling",
    "section": "\n12.4 Summary Output",
    "text": "12.4 Summary Output\n\nCodesummary(\n  mediationFit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 4 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                         9\n\n  Number of observations                           100\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                                      \n  Test statistic                                 0.000\n  Degrees of freedom                                 0\n\nModel Test Baseline Model:\n\n  Test statistic                                79.768\n  Degrees of freedom                                 3\n  P-value                                        0.000\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    1.000\n  Tucker-Lewis Index (TLI)                       1.000\n                                                      \n  Robust Comparative Fit Index (CFI)             1.000\n  Robust Tucker-Lewis Index (TLI)                1.000\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)               -394.296\n  Loglikelihood unrestricted model (H1)       -394.296\n                                                      \n  Akaike (AIC)                                 806.592\n  Bayesian (BIC)                               830.039\n  Sample-size adjusted Bayesian (SABIC)        801.614\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.000\n  90 Percent confidence interval - lower         0.000\n  90 Percent confidence interval - upper         0.000\n  P-value H_0: RMSEA &lt;= 0.050                       NA\n  P-value H_0: RMSEA &gt;= 0.080                       NA\n                                                      \n  Robust RMSEA                                   0.000\n  90 Percent confidence interval - lower         0.000\n  90 Percent confidence interval - upper         0.000\n  P-value H_0: Robust RMSEA &lt;= 0.050                NA\n  P-value H_0: Robust RMSEA &gt;= 0.080                NA\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.000\n\nParameter Estimates:\n\n  Standard errors                            Bootstrap\n  Number of requested bootstrap draws             1000\n  Number of successful bootstrap draws            1000\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  Y ~                                                                   \n    X       (drct)   -0.045    0.107   -0.423    0.672   -0.045   -0.038\n  M ~                                                                   \n    X          (a)    0.568    0.090    6.328    0.000    0.568    0.549\n  Y ~                                                                   \n    M          (b)    0.714    0.118    6.075    0.000    0.714    0.616\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .Y                 0.028    0.098    0.287    0.774    0.028    0.024\n   .M                -0.072    0.084   -0.857    0.392   -0.072   -0.073\n    X                -0.173    0.096   -1.811    0.070   -0.173   -0.181\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .Y                 0.850    0.124    6.841    0.000    0.850    0.644\n   .M                 0.686    0.083    8.262    0.000    0.686    0.699\n    X                 0.916    0.129    7.095    0.000    0.916    1.000\n\nR-Square:\n                   Estimate\n    Y                 0.356\n    M                 0.301\n\nDefined Parameters:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    indirect          0.406    0.094    4.323    0.000    0.406    0.338\n    total             0.361    0.108    3.354    0.001    0.361    0.300\n    totalAbs          0.451    0.130    3.476    0.001    0.451    0.376\n    Pm                0.900    0.104    8.680    0.000    0.900    0.900",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#parameter-estimates",
    "href": "sem.html#parameter-estimates",
    "title": "Structural Equation Modeling",
    "section": "\n12.5 Parameter Estimates",
    "text": "12.5 Parameter Estimates\n\n12.5.1 Bias-Corrected Bootstrap\nAdjusted bootstrap percentile (BCa) method, but with no correction for acceleration (only for bias):\n\nCodemediationFit_estimates_bca &lt;- parameterEstimates(\n  mediationFit,\n  boot.ci.type = \"bca.simple\",\n  standardized = TRUE)\n\nmediationFit_estimates &lt;- mediationFit_estimates_bca\n\nmediationFit_estimates_bca\n\n\n  \n\n\n\n\n12.5.2 Percentile Bootstrap\n\nCodemediationFit_estimates_perc &lt;- parameterEstimates(\n  mediationFit,\n  boot.ci.type = \"perc\",\n  standardized = TRUE)\n\nmediationFit_estimates_perc",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#indirect-effect",
    "href": "sem.html#indirect-effect",
    "title": "Structural Equation Modeling",
    "section": "\n12.6 Indirect Effect",
    "text": "12.6 Indirect Effect\n\n12.6.1 Parameter Estimate\nBias-Corrected Bootstrap:\n\nCodemediationFit_estimates_bca %&gt;% \n  filter(label == \"indirect\")\n\n\n  \n\n\n\nPercentile Bootstrap:\n\nCodemediationFit_estimates_perc %&gt;% \n  filter(label == \"indirect\")\n\n\n  \n\n\n\n\n12.6.2 Effect Size\n\n12.6.2.1 Standardized Estimate (\\(\\beta\\))\n\\[\n\\beta(ab) = ab \\cdot \\frac{SD_\\text{Y}}{SD_\\text{X}}\n\\]\n\nCodemediationFit_indirect &lt;- mediationFit_estimates %&gt;% \n  filter(label == \"indirect\") %&gt;% \n  select(std.all) %&gt;% \n  as.numeric\n\nmediationFit_indirect\n\n[1] 0.3380996\n\n\n\n12.6.2.2 Proportion Mediated (PM)\n\\[\nP_M = \\frac{|ab|}{|c|} = \\frac{|ab|}{|c'| + |ab|}\n\\]\nEffect size: Proportion mediated (PM); i.e., the proportion of the total effect that is mediated; calculated by the magnitude of the indirect effect divided by the magnitude of the total effect:\n\nCodemediationFit_total &lt;- mediationFit_estimates %&gt;% \n  filter(label == \"totalAbs\") %&gt;% \n  select(std.all) %&gt;% \n  as.numeric\n\nmediationFit_pm &lt;- abs(mediationFit_indirect) / abs(mediationFit_total)\nmediationFit_pm\n\n[1] 0.8998773\n\n\nIn this case, the direct effect and indirect effect have opposite signs (negative and positive, respectively). This is called inconsistent mediation, and can render the estimate of proportion mediated not a meaningful estimate of effect size (in this case, the estimate would exceed 1.0; Fairchild & McDaniel, 2017). To address this, we can use the absolute value of the direct and indirect effects (in computation of the total effect), as recommended by MacKinnon et al. (2007). When using the absolute value of the direct and indirect effects, the proportion mediated (PM) is 0.90, indicating that the mediator explained 90% of the total effect.\n\n12.6.2.3 Proportion of Variance in Y That is Explained by the Indirect Effect (R2mediated)\nFormulas from Lachowicz et al. (2018):\n\\[\n\\begin{aligned}\n  R^2_\\text{mediated} &= r^2_{\\text{MY}} - (R^2_{\\text{Y} \\cdot \\text{MX}} - r^2_{\\text{XY}}) \\\\\n  &= (\\beta^2_{\\text{YM} \\cdot \\text{X}} + \\beta_{\\text{YX} \\cdot \\text{M}} \\cdot \\beta_{\\text{MX}}) ^2 - [\\beta^2_{\\text{YX}} + \\beta^2_{\\text{YM} \\cdot \\text{X}}(1 - \\beta^2_{\\text{MX}}) - \\beta^2_{\\text{YX}}]\n\\end{aligned}\n\\]\n\nCoderXY &lt;- as.numeric(cor.test(\n  ~ X + Y,\n  data = mydata\n)$estimate)\n\nrMY &lt;- as.numeric(cor.test(\n  ~ M + Y,\n  data = mydata\n)$estimate)\n\nRsquaredYmx &lt;- summary(lm(\n  Y ~ M + X,\n  data = mydata))$r.squared\n\nRsquaredMed1 &lt;- (rMY^2) - (RsquaredYmx - (rXY^2))\nRsquaredMed1\n\n[1] 0.08930037\n\nCodebetaYMgivenX &lt;- mediationFit_estimates %&gt;% \n  filter(label == \"b\") %&gt;% \n  select(std.all) %&gt;% \n  as.numeric\n\nbetaYXgivenM &lt;- mediationFit_estimates %&gt;% \n  filter(label == \"direct\") %&gt;% \n  select(std.all) %&gt;% \n  as.numeric\n\nbetaMX &lt;- mediationFit_estimates %&gt;% \n  filter(label == \"a\") %&gt;% \n  select(std.all) %&gt;% \n  as.numeric\n\nbetaYX &lt;- as.numeric(cor.test(\n  ~ X + Y,\n  data = mydata\n)$estimate)\n\nRsquaredMed2 &lt;- ((betaYMgivenX + (betaYXgivenM * betaMX))^2) - ((betaYX^2) + (betaYMgivenX^2)*(1 - (betaMX^2)) - (betaYX^2))\nRsquaredMed2\n\n[1] 0.08930037\n\n\n\n12.6.2.4 The Proportion of Variance in Y That is Accounted for Jointly by M and X (upsilon; \\(v\\))\nFormulas from Lachowicz et al. (2018):\n\\[\n\\begin{aligned}\n  v &= (r_{\\text{YM}} - \\beta_{\\text{MX}} \\cdot \\beta^2_{\\text{YX} \\cdot \\text{M}}) ^ 2 - (R^2_{\\text{Y} \\cdot \\text{MX}} - r^2_{\\text{YX}})\\\\\n  &= \\beta^2_a \\cdot \\beta^2_b\n\\end{aligned}\n\\]\nwhere \\(a\\) is the \\(a\\) path (\\(\\beta^2_{\\text{MX}}\\)), and \\(b\\) is the \\(b\\) path (\\(\\beta^2_{\\text{YM} \\cdot \\text{X}}\\)).\nThe estimate corrects for spurious correlation induced by the ordering of variables.\n\nCodeupsilon1 &lt;- ((rMY - (betaMX * (betaYXgivenM^2)))^2) - (RsquaredYmx - (rXY^2))\nupsilon1\n\n[1] 0.08837615\n\nCodeupsilon2 &lt;- (betaYMgivenX^2) - (RsquaredYmx - (rXY^2))\nupsilon2\n\n[1] 0.1143113\n\nCodeupsilon3 &lt;- mediationFit_indirect ^ 2\nupsilon3\n\n[1] 0.1143113\n\nCodeupsilon(\n  x = mydata$X,\n  mediator = mydata$M,\n  dv = mydata$Y,\n  bootstrap = FALSE\n)\n\n\n  \n\n\n\n\n12.6.2.5 Ratio of the Indirect Effect Relative to Its Maximum Possible Value in the Data (\\(\\kappa^2\\))\n\\[\n\\kappa^2 = \\frac{ab}{\\text{MAX}(ab)}\n\\]\nKappa-squared (\\(\\kappa^2\\)) is the ratio of the indirect effect relative to its maximum possible value in the data given the observed variability of X, Y, and M and their intercorrelations in the data. This estimate is no longer recommended (Wen & Fan, 2015).\n\n12.6.2.6 Other Effect Sizes\n\nCodemediation(\n  x = mydata$X,\n  mediator = mydata$M,\n  dv = mydata$Y,\n  bootstrap = FALSE\n)\n\n$Y.on.X\n$Y.on.X$Regression.Table\n                Estimate Std. Error    t value   p(&gt;|t|) Low Conf Limit\nIntercept.Y_X -0.0234265  0.1124386 -0.2083494 0.8353886     -0.2465572\nc (Regressor)  0.3605967  0.1156225  3.1187424 0.0023850      0.1311477\n              Up Conf Limit\nIntercept.Y_X     0.1997041\nc (Regressor)     0.5900458\n\n$Y.on.X$Model.Fit\n       Residual standard error (RMSE) numerator df denomenator df F-Statistic\nValues                        1.10643            1             98    9.726554\n       p-value (F)        R^2    Adj R^2 Low Conf Limit Up Conf Limit\nValues    0.002385 0.09028929 0.08100653     0.01207068     0.2183844\n\n\n$M.on.X\n$M.on.X$Regression.Table\n                 Estimate Std. Error    t value          p(&gt;|t|) Low Conf Limit\nIntercept.M_X -0.07206805 0.08501733 -0.8476865 0.39867814281309     -0.2407822\na (Regressor)  0.56815370 0.08742477  6.4987723 0.00000000339244      0.3946621\n              Up Conf Limit\nIntercept.M_X    0.09664608\na (Regressor)    0.74164532\n\n$M.on.X$Model.Fit\n       Residual standard error (RMSE) numerator df denomenator df F-Statistic\nValues                      0.8365964            1             98    42.23404\n            p-value (F)       R^2   Adj R^2 Low Conf Limit Up Conf Limit\nValues 0.00000000339244 0.3011683 0.2940373      0.1546027     0.4498597\n\n\n$Y.on.X.and.M\n$Y.on.X.and.M$Regression.Table\n                       Estimate Std. Error    t value          p(&gt;|t|)\nIntercept.Y_XM       0.02804007 0.09547198  0.2936994 0.76961507960580\nc.prime (Regressor) -0.04514372 0.11701196 -0.3858043 0.70048641908141\nb (Mediator)         0.71413854 0.11302357  6.3184922 0.00000000802134\n                    Low Conf Limit Up Conf Limit\nIntercept.Y_XM          -0.1614454     0.2175255\nc.prime (Regressor)     -0.2773801     0.1870926\nb (Mediator)             0.4898180     0.9384590\n\n$Y.on.X.and.M$Model.Fit\n       Residual standard error (RMSE) numerator df denomenator df F-Statistic\nValues                      0.9360479            2             97    26.75653\n              p-value (F)       R^2   Adj R^2 Low Conf Limit Up Conf Limit\nValues 0.0000000005572898 0.3555377 0.3422498      0.1958319     0.4955139\n\n\n$Effect.Sizes\n                                              [,1]\nIndirect.Effect                         0.40574046\nIndirect.Effect.Partially.Standardized  0.35154486\nIndex.of.Mediation                      0.33809959\nR2_4.5                                  0.08930037\nR2_4.6                                  0.08781296\nR2_4.7                                  0.24698638\nRatio.of.Indirect.to.Total.Effect       1.12519172\nRatio.of.Indirect.to.Direct.Effect     -8.98774887\nSuccess.of.Surrogate.Endpoint           0.63468166\nResidual.Based_Gamma                    0.08153354\nResidual.Based.Standardized_gamma       0.08679941\nSOS                                     0.98904723",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#estimates-of-model-fit-8",
    "href": "sem.html#estimates-of-model-fit-8",
    "title": "Structural Equation Modeling",
    "section": "\n12.7 Estimates of Model Fit",
    "text": "12.7 Estimates of Model Fit\nThe model is saturated because it has as many estimated parameters as there are data points (i.e., in terms of means, variances, and covariances), so it has zero degrees of freedom. Because the model is saturated, it has “perfect” fit.\n\nCodefitMeasures(\n  mediationFit,\n  fit.measures = c(\n    \"chisq\", \"df\", \"pvalue\",\n    \"baseline.chisq\",\"baseline.df\",\"baseline.pvalue\",\n    \"rmsea\", \"cfi\", \"tli\", \"srmr\"))\n\n          chisq              df          pvalue  baseline.chisq     baseline.df \n          0.000           0.000              NA          79.768           3.000 \nbaseline.pvalue           rmsea             cfi             tli            srmr \n          0.000           0.000           1.000           1.000           0.000",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#residuals-of-observed-vs.-model-implied-correlation-matrix-8",
    "href": "sem.html#residuals-of-observed-vs.-model-implied-correlation-matrix-8",
    "title": "Structural Equation Modeling",
    "section": "\n12.8 Residuals of Observed vs. Model-Implied Correlation Matrix",
    "text": "12.8 Residuals of Observed vs. Model-Implied Correlation Matrix\n\nCoderesiduals(mediationFit, type = \"cor\")\n\n$type\n[1] \"cor.bollen\"\n\n$cov\n  Y M X\nY 0    \nM 0 0  \nX 0 0 0\n\n$mean\nY M X \n0 0 0",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#modification-indices-8",
    "href": "sem.html#modification-indices-8",
    "title": "Structural Equation Modeling",
    "section": "\n12.9 Modification Indices",
    "text": "12.9 Modification Indices\n\nCodemodificationindices(mediationFit, sort. = TRUE)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#internal-consistency-reliability-6",
    "href": "sem.html#internal-consistency-reliability-6",
    "title": "Structural Equation Modeling",
    "section": "\n12.10 Internal Consistency Reliability",
    "text": "12.10 Internal Consistency Reliability\n\nCodecompRelSEM(mediationFit)\n\nnamed numeric(0)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#path-diagram-8",
    "href": "sem.html#path-diagram-8",
    "title": "Structural Equation Modeling",
    "section": "\n12.11 Path Diagram",
    "text": "12.11 Path Diagram\n\nCodesemPaths(\n  mediationFit,\n  what = \"Std.all\",\n  layout = \"tree2\",\n  edge.label.cex = 1.5)\n\n\n\n\n\n\nCodelavaanPlot::lavaanPlot(\n  mediationFit,\n  coefs = TRUE,\n  #covs = TRUE,\n  stand = TRUE)\n\n\n\n\nCodelavaanPlot::lavaanPlot2(\n  mediationFit,\n  #stand = TRUE, # currently throws error; uncomment out when fixed: https://github.com/alishinski/lavaanPlot/issues/52\n  coef_labels = TRUE)\n\n\n\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(mediationFit)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#preparing-the-predictors",
    "href": "sem.html#preparing-the-predictors",
    "title": "Structural Equation Modeling",
    "section": "\n13.1 Preparing the Predictors",
    "text": "13.1 Preparing the Predictors\nMake sure to mean-center or orthogonalize predictors before computing the interaction term.\n\n13.1.1 Mean Center Predictors\n\nCodestates$Illiteracy_centered &lt;- scale(states$Illiteracy, scale = FALSE)\nstates$Murder_centered &lt;- scale(states$Murder, scale = FALSE)\n\n\n\n13.1.2 Orthogonalized Predictors\nOrthogonalizing is residual centering.\n\nCodestates$interaction_notCentered &lt;- states$Illiteracy * states$Murder\n\nstates$Illiteracy_orthogonalized &lt;- resid(lm(\n  data = states,\n  interaction_notCentered ~ Illiteracy\n))\n\nstates$Murder_orthogonalized &lt;- resid(lm(\n  data = states,\n  interaction_notCentered ~ Murder\n))",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#compute-interaction-term",
    "href": "sem.html#compute-interaction-term",
    "title": "Structural Equation Modeling",
    "section": "\n13.2 Compute Interaction Term",
    "text": "13.2 Compute Interaction Term\n\nCodestates$interaction &lt;- states$Illiteracy_centered * states$Murder_centered # or: states$Illiteracy_orthogonalized * states$Murder_orthogonalized",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#model-syntax-9",
    "href": "sem.html#model-syntax-9",
    "title": "Structural Equation Modeling",
    "section": "\n13.3 Model Syntax",
    "text": "13.3 Model Syntax\n\nCodemoderationModel &lt;- '\n  Income_rescaled ~ Illiteracy_centered + Murder_centered + interaction + HS.Grad\n'",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#fit-the-model-9",
    "href": "sem.html#fit-the-model-9",
    "title": "Structural Equation Modeling",
    "section": "\n13.4 Fit the Model",
    "text": "13.4 Fit the Model\n\nCodemoderationFit &lt;- sem(\n  moderationModel,\n  data = states,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  std.lv = TRUE,\n  fixed.x = FALSE)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#summary-output-9",
    "href": "sem.html#summary-output-9",
    "title": "Structural Equation Modeling",
    "section": "\n13.5 Summary Output",
    "text": "13.5 Summary Output\n\nCodesummary(\n  moderationFit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 27 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        20\n\n  Number of observations                            50\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                 0.000       0.000\n  Degrees of freedom                                 0           0\n\nModel Test Baseline Model:\n\n  Test statistic                                33.312      29.838\n  Degrees of freedom                                 4           4\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.116\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    1.000       1.000\n  Tucker-Lewis Index (TLI)                       1.000       1.000\n                                                                  \n  Robust Comparative Fit Index (CFI)                         1.000\n  Robust Tucker-Lewis Index (TLI)                            1.000\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)               -570.333    -570.333\n  Loglikelihood unrestricted model (H1)       -570.333    -570.333\n                                                                  \n  Akaike (AIC)                                1180.666    1180.666\n  Bayesian (BIC)                              1218.907    1218.907\n  Sample-size adjusted Bayesian (SABIC)       1156.130    1156.130\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.000          NA\n  90 Percent confidence interval - lower         0.000          NA\n  90 Percent confidence interval - upper         0.000          NA\n  P-value H_0: RMSEA &lt;= 0.050                       NA          NA\n  P-value H_0: RMSEA &gt;= 0.080                       NA          NA\n                                                                  \n  Robust RMSEA                                               0.000\n  90 Percent confidence interval - lower                     0.000\n  90 Percent confidence interval - upper                     0.000\n  P-value H_0: Robust RMSEA &lt;= 0.050                            NA\n  P-value H_0: Robust RMSEA &gt;= 0.080                            NA\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.000       0.000\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nRegressions:\n                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  Income_rescaled ~                                                      \n    Illitrcy_cntrd     0.371    1.881    0.197    0.844    0.371    0.037\n    Murder_centerd     0.171    0.245    0.696    0.486    0.171    0.103\n    interaction       -0.970    0.254   -3.823    0.000   -0.970   -0.355\n    HS.Grad            0.408    0.149    2.727    0.006    0.408    0.536\n\nCovariances:\n                         Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  Illiteracy_centered ~~                                                      \n    Murder_centerd          1.550    0.315    4.924    0.000    1.550    0.703\n    interaction             0.733    0.323    2.271    0.023    0.733    0.546\n    HS.Grad                -3.171    0.711   -4.459    0.000   -3.171   -0.657\n  Murder_centered ~~                                                          \n    interaction             2.223    1.620    1.372    0.170    2.223    0.273\n    HS.Grad               -14.259    4.049   -3.522    0.000  -14.259   -0.488\n  interaction ~~                                                              \n    HS.Grad                -7.938    2.987   -2.657    0.008   -7.938   -0.446\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .Income_rescald   24.215    7.858    3.081    0.002   24.215    3.981\n    Illitrcy_cntrd   -0.000    0.085   -0.000    1.000   -0.000   -0.000\n    Murder_centerd   -0.000    0.517   -0.000    1.000   -0.000   -0.000\n    interaction       1.550    0.315    4.924    0.000    1.550    0.696\n    HS.Grad          53.108    1.131   46.966    0.000   53.108    6.642\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .Income_rescald   19.006    4.200    4.525    0.000   19.006    0.514\n    Illitrcy_cntrd    0.364    0.066    5.534    0.000    0.364    1.000\n    Murder_centerd   13.355    1.754    7.614    0.000   13.355    1.000\n    interaction       4.956    1.462    3.390    0.001    4.956    1.000\n    HS.Grad          63.933    9.944    6.429    0.000   63.933    1.000\n\nR-Square:\n                   Estimate\n    Income_rescald    0.486",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#estimates-of-model-fit-9",
    "href": "sem.html#estimates-of-model-fit-9",
    "title": "Structural Equation Modeling",
    "section": "\n13.6 Estimates of Model Fit",
    "text": "13.6 Estimates of Model Fit\nThe model is saturated because it has as many estimated parameters as there are data points (i.e., in terms of means, variances, and covariances), so it has zero degrees of freedom. Because the model is saturated, it has “perfect” fit.\n\nCodefitMeasures(\n  moderationFit,\n  fit.measures = c(\n    \"chisq\", \"df\", \"pvalue\",\n    \"baseline.chisq\",\"baseline.df\",\"baseline.pvalue\",\n    \"rmsea\", \"cfi\", \"tli\", \"srmr\"))\n\n          chisq              df          pvalue  baseline.chisq     baseline.df \n          0.000           0.000              NA          33.312           4.000 \nbaseline.pvalue           rmsea             cfi             tli            srmr \n          0.000           0.000           1.000           1.000           0.000",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#residuals-of-observed-vs.-model-implied-correlation-matrix-9",
    "href": "sem.html#residuals-of-observed-vs.-model-implied-correlation-matrix-9",
    "title": "Structural Equation Modeling",
    "section": "\n13.7 Residuals of Observed vs. Model-Implied Correlation Matrix",
    "text": "13.7 Residuals of Observed vs. Model-Implied Correlation Matrix\n\nCoderesiduals(moderationFit, type = \"cor\")\n\n$type\n[1] \"cor.bollen\"\n\n$cov\n                    Incm_r Illtr_ Mrdr_c intrct HS.Grd\nIncome_rescaled          0                            \nIlliteracy_centered      0      0                     \nMurder_centered          0      0      0              \ninteraction              0      0      0      0       \nHS.Grad                  0      0      0      0      0\n\n$mean\n    Income_rescaled Illiteracy_centered     Murder_centered         interaction \n                  0                   0                   0                   0 \n            HS.Grad \n                  0",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#modification-indices-9",
    "href": "sem.html#modification-indices-9",
    "title": "Structural Equation Modeling",
    "section": "\n13.8 Modification Indices",
    "text": "13.8 Modification Indices\n\nCodemodificationindices(moderationFit, sort. = TRUE)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#path-diagram-9",
    "href": "sem.html#path-diagram-9",
    "title": "Structural Equation Modeling",
    "section": "\n13.9 Path Diagram",
    "text": "13.9 Path Diagram\n\nCodesemPaths(\n  moderationFit,\n  what = \"Std.all\",\n  layout = \"tree2\",\n  edge.label.cex = 1.5)\n\n\n\n\n\n\nCodelavaanPlot::lavaanPlot(\n  moderationFit,\n  coefs = TRUE,\n  #covs = TRUE,\n  stand = TRUE)\n\n\n\n\nCodelavaanPlot::lavaanPlot2(\n  moderationFit,\n  #stand = TRUE, # currently throws error; uncomment out when fixed: https://github.com/alishinski/lavaanPlot/issues/52\n  coef_labels = TRUE)\n\n\n\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(moderationFit)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#sec-moderationInteractionPlot",
    "href": "sem.html#sec-moderationInteractionPlot",
    "title": "Structural Equation Modeling",
    "section": "\n13.10 Interaction Plot",
    "text": "13.10 Interaction Plot\n\nCode# Created Model-Implied Predicted Data Object\nmodelImpliedPredictedData &lt;- expand.grid(\n  Illiteracy_factor = c(\"Low\",\"Middle\",\"High\"),\n  Murder_factor = c(\"Low\",\"Middle\",\"High\"))\n\nIlliteracy_mean &lt;- mean(states$Illiteracy, na.rm = TRUE)\nIlliteracy_sd &lt;- sd(states$Illiteracy, na.rm = TRUE)\n\nMurder_mean &lt;- mean(states$Murder, na.rm = TRUE)\nMurder_sd &lt;- sd(states$Murder, na.rm = TRUE)\n\nIlliteracy_centered_mean &lt;- mean(states$Illiteracy_centered, na.rm = TRUE)\nIlliteracy_centered_sd &lt;- sd(states$Illiteracy_centered, na.rm = TRUE)\n\nMurder_centered_mean &lt;- mean(states$Murder_centered, na.rm = TRUE)\nMurder_centered_sd &lt;- sd(states$Murder_centered, na.rm = TRUE)\n\nmodelImpliedPredictedData &lt;- modelImpliedPredictedData %&gt;%\n  mutate(\n    Illiteracy = case_when(\n      Illiteracy_factor == \"Low\" ~ Illiteracy_mean - Illiteracy_sd,\n      Illiteracy_factor == \"Middle\" ~ Illiteracy_mean,\n      Illiteracy_factor == \"High\" ~ Illiteracy_mean + Illiteracy_sd\n    ),\n    Illiteracy_centered = case_when(\n      Illiteracy_factor == \"Low\" ~ Illiteracy_centered_mean - Illiteracy_centered_sd,\n      Illiteracy_factor == \"Middle\" ~ Illiteracy_centered_mean,\n      Illiteracy_factor == \"High\" ~ Illiteracy_centered_mean + Illiteracy_centered_sd\n    ),\n    Murder = case_when(\n      Murder_factor == \"Low\" ~ Murder_mean - Murder_sd,\n      Murder_factor == \"Middle\" ~ Murder_mean,\n      Murder_factor == \"High\" ~ Murder_mean + Murder_sd\n    ),\n    Murder_centered = case_when(\n      Murder_factor == \"Low\" ~ Murder_centered_mean - Murder_centered_sd,\n      Murder_factor == \"Middle\" ~ Murder_centered_mean,\n      Murder_factor == \"High\" ~ Murder_centered_mean + Murder_centered_sd\n    ),\n    interaction = Illiteracy_centered * Murder_centered,\n    HS.Grad = mean(states$HS.Grad, na.rm = TRUE), # mean for covariates\n    Income_rescaled = NA\n  )\n\nMurder_labels &lt;- factor(\n  modelImpliedPredictedData$Murder_factor,\n  levels = c(\"High\", \"Middle\", \"Low\"),\n  labels = c(\"High (+1 SD)\", \"Middle (mean)\", \"Low (−1 SD)\"))\n\nmodelImpliedPredictedData$Income_rescaled &lt;- lavPredictY(\n  moderationFit,\n  newdata = modelImpliedPredictedData,\n  ynames = \"Income_rescaled\"\n) %&gt;% \n  as.vector()\n\n# Verify Computation Manually\nmoderationFit_parameters &lt;- parameterEstimates(moderationFit)\n\nmoderationFit_parameters\n\n\n  \n\n\nCodeintercept &lt;- moderationFit_parameters[which(moderationFit_parameters$lhs == \"Income_rescaled\" & moderationFit_parameters$op == \"~1\"), \"est\"]\nb_Illiteracy_centered &lt;- moderationFit_parameters[which(moderationFit_parameters$lhs == \"Income_rescaled\" & moderationFit_parameters$rhs == \"Illiteracy_centered\"), \"est\"]\nb_Murder_centered &lt;- moderationFit_parameters[which(moderationFit_parameters$lhs == \"Income_rescaled\" & moderationFit_parameters$rhs == \"Murder_centered\"), \"est\"]\nb_interaction &lt;- moderationFit_parameters[which(moderationFit_parameters$lhs == \"Income_rescaled\" & moderationFit_parameters$rhs == \"interaction\"), \"est\"]\nb_HS.Grad &lt;- moderationFit_parameters[which(moderationFit_parameters$lhs == \"Income_rescaled\" & moderationFit_parameters$rhs == \"HS.Grad\"), \"est\"]\n\nmodelImpliedPredictedData &lt;- modelImpliedPredictedData %&gt;%\n  mutate(\n    Income_rescaled_calculatedManually = intercept + (b_Illiteracy_centered * Illiteracy_centered) + (b_Murder_centered * Murder_centered) + (b_interaction * interaction) + (b_HS.Grad * HS.Grad))\n\n# Model-Implied Predicted Data\nmodelImpliedPredictedData\n\n\n  \n\n\nCode# Plot\nggplot(\n  data = modelImpliedPredictedData,\n  mapping = aes(\n    x = Illiteracy,\n    y = Income_rescaled,\n    color = Murder_labels\n  )\n) +\n  geom_line() +\n  labs(color = \"Murder\")",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#sec-moderationRegionsOfSignificance",
    "href": "sem.html#sec-moderationRegionsOfSignificance",
    "title": "Structural Equation Modeling",
    "section": "\n13.11 Simple Slopes and Regions of Significance",
    "text": "13.11 Simple Slopes and Regions of Significance\nhttps://gabriellajg.github.io/EPSY-579-R-Cookbook-for-SEM/week6_1-lavaan-lab-4-mediated-moderation-moderated-mediation.html#step-5-johnson-neyman-interval (archived at https://perma.cc/6XR6-ZPSL)\n\nCode# Find the min and max values of the moderator\nMurder_centered_min &lt;- min(modelImpliedPredictedData$Murder_centered, na.rm = TRUE)\nMurder_centered_max &lt;- max(modelImpliedPredictedData$Murder_centered, na.rm = TRUE)\n\nMurder_centered_cutoff1 &lt;- -1.5 # pick and titrate cutoff to help find the lower bound of the region of significance\nMurder_centered_cutoff2 &lt;- -1 # pick and titrate cutoff to help find the upper bound of the region of significance\n\nMurder_centered_sd &lt;- sd(modelImpliedPredictedData$Murder_centered, na.rm = TRUE)\n\nMurder_centered_low &lt;- mean(modelImpliedPredictedData$Murder_centered, na.rm = TRUE) - sd(modelImpliedPredictedData$Murder_centered, na.rm = TRUE)\nMurder_centered_mean &lt;- mean(modelImpliedPredictedData$Murder_centered, na.rm = TRUE)\nMurder_centered_high &lt;- mean(modelImpliedPredictedData$Murder_centered, na.rm = TRUE) + sd(modelImpliedPredictedData$Murder_centered, na.rm = TRUE)\n\n# Extend the moderation model to compute the simple slopes and conditional effects at specific values of the moderator\nmoderationModelSimpleSlopes &lt;- paste0('\n  # Regression\n  Income_rescaled ~ b1*Illiteracy_centered + b2*Murder_centered + b3*interaction + b4*HS.Grad\n  \n  # Simple Slopes\n  SS_min := b1 + b3 * ', Murder_centered_min, '\n  SS_cutoff1 := b1 + b3 * ', Murder_centered_cutoff1, '\n  SS_cutoff2 := b1 + b3 * ', Murder_centered_cutoff2, '\n  SS_low := b1 + b3 * ', Murder_centered_low, '\n  SS_mean := b1 + b3 * ', Murder_centered_mean, '\n  SS_high := b1 + b3 * ', Murder_centered_high, '\n  SS_max := b1 + b3 * ', Murder_centered_max, '\n')\n\n# Fit the Model\nset.seed(52242) # for reproducibility\n\nmoderationModelSimpleSlopes_fit &lt;- sem(\n  model = moderationModelSimpleSlopes, \n  data = states,\n  missing = \"ML\",\n  estimator = \"ML\",\n  se = \"bootstrap\",\n  bootstrap = 1000,\n  std.lv = TRUE,\n  fixed.x = FALSE)\n\nsummary(\n  moderationModelSimpleSlopes_fit,\n  #fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 27 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        20\n\n  Number of observations                            50\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                                      \n  Test statistic                                 0.000\n  Degrees of freedom                                 0\n\nParameter Estimates:\n\n  Standard errors                            Bootstrap\n  Number of requested bootstrap draws             1000\n  Number of successful bootstrap draws            1000\n\nRegressions:\n                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  Income_rescaled ~                                                      \n    Illtrcy_c (b1)     0.371    2.266    0.164    0.870    0.371    0.037\n    Mrdr_cntr (b2)     0.171    0.271    0.630    0.528    0.171    0.103\n    interactn (b3)    -0.970    0.307   -3.157    0.002   -0.970   -0.355\n    HS.Grad   (b4)     0.408    0.162    2.521    0.012    0.408    0.536\n\nCovariances:\n                         Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  Illiteracy_centered ~~                                                      \n    Murder_centerd          1.550    0.312    4.963    0.000    1.550    0.703\n    interaction             0.733    0.320    2.290    0.022    0.733    0.546\n    HS.Grad                -3.171    0.700   -4.532    0.000   -3.171   -0.657\n  Murder_centered ~~                                                          \n    interaction             2.223    1.596    1.393    0.164    2.223    0.273\n    HS.Grad               -14.259    3.925   -3.633    0.000  -14.259   -0.488\n  interaction ~~                                                              \n    HS.Grad                -7.938    2.988   -2.656    0.008   -7.938   -0.446\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .Income_rescald   24.215    8.505    2.847    0.004   24.215    3.981\n    Illitrcy_cntrd   -0.000    0.087   -0.000    1.000   -0.000   -0.000\n    Murder_centerd   -0.000    0.524   -0.000    1.000   -0.000   -0.000\n    interaction       1.550    0.312    4.969    0.000    1.550    0.696\n    HS.Grad          53.108    1.124   47.235    0.000   53.108    6.642\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .Income_rescald   19.006    3.928    4.838    0.000   19.006    0.514\n    Illitrcy_cntrd    0.364    0.065    5.586    0.000    0.364    1.000\n    Murder_centerd   13.355    1.780    7.501    0.000   13.355    1.000\n    interaction       4.956    1.441    3.439    0.001    4.956    1.000\n    HS.Grad          63.933    9.923    6.443    0.000   63.933    1.000\n\nR-Square:\n                   Estimate\n    Income_rescald    0.486\n\nDefined Parameters:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    SS_min            3.953    2.924    1.352    0.176    3.953    1.348\n    SS_cutoff1        1.827    2.492    0.733    0.464    1.827    0.570\n    SS_cutoff2        1.342    2.409    0.557    0.578    1.342    0.392\n    SS_low            3.473    2.818    1.233    0.218    3.473    1.172\n    SS_mean           0.371    2.266    0.164    0.870    0.371    0.037\n    SS_high          -2.731    2.063   -1.324    0.185   -2.731   -1.099\n    SS_max           -3.211    2.071   -1.550    0.121   -3.211   -1.274\n\nCodemoderationModelSimpleSlopesFit_parameters &lt;- parameterEstimates(\n  moderationModelSimpleSlopes_fit,\n  level = 0.95,\n  boot.ci.type = \"bca.simple\")\n\nmoderationModelSimpleSlopesFit_parameters\n\n\n  \n\n\n\nA simple slope of the predictor on the outcome is considered significant at a given level of the moderator if the 95% confidence interval from the bootstrapped estimates of the simple slopes at that level of the moderator (i.e., [ci.lower,ci.upper]) does not include zero. In this particular model, the predictor (Illiteracy) is not significant at any of the levels of the moderator (Murder), because the 95% confidence intervals of all simple slopes include zero, in this case, likely due to a small sample size (\\(N = 50\\)) and the resulting low power.",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#sec-johnsonNeymanPlot",
    "href": "sem.html#sec-johnsonNeymanPlot",
    "title": "Structural Equation Modeling",
    "section": "\n13.12 Johnson-Neyman Plot",
    "text": "13.12 Johnson-Neyman Plot\nAs I noted above, the predictor is not significant at any levels of the moderator. Nevertheless, I created a made up Johnson-Neyman plot by specifying the (fictitious) range of significance, for purposes of demonstration. The band around the line indicates the 95% confidence interval of the simple slope of the predictor on the outcome as a function of different levels of the moderator. In reality (unlike in this fictitious example), the regions of significance would only be regions where the 95% confidence interval of the simple slope does not include zero.\nThe standard error of the slope is the square root of the variance of the slope. The forumula for computing the standard error of the slope is based on the formula for computing the variance of a weighted sum.\nThe slope of the predictor on the outcome at different levels of the moderator is calculated as (Jaccard & Turisi, 2003):\n\\[\n\\text{slope}_\\text{predictor} = b_1 + b_3 \\cdot Z\n\\]\nThe standard error of the slope of the predictor on the outcome at different levels of the moderator is calculated as (https://stats.stackexchange.com/a/55973/20338; archived at https://perma.cc/V255-853Z; Jaccard & Turisi, 2003):\n\\[\n\\begin{aligned}\nSE(\\text{slope}_\\text{predictor}) &= \\sqrt{Var(b_1) + Var(b_3) \\cdot Z^2 + 2 \\cdot Z \\cdot Cov(b_1, b_3)} \\\\\nSE(b_1 + b_3 \\cdot Z) &=\n\\end{aligned}\n\\]\nwhere:\n\n\n\\(b_1\\) is the slope of the predictor on the outcome\n\n\\(b_3\\) is the slope of the interaction term on the outcome\n\n\\(Z\\) is the moderator\n\nThe variance of a weighted sum is:\n\\[\n\\begin{aligned}\nVar(\\text{slope}_\\text{predictor}) &= Var(b_1) + Var(b_3) \\cdot Z^2 + 2 \\cdot Z \\cdot Cov(b_1, b_3) \\\\\nVar(b_1 + b_3 \\cdot Z) &=\n\\end{aligned}\n\\]\nThe standard error is the square root of the variance. The 95% confidence interval of the slope is \\(\\pm\\) 1.959964 (i.e., qnorm(.975)) standard errors of the slope estimate.\n\nCode# Create a data frame for plotting\nMurder_min &lt;- min(states$Murder, na.rm = TRUE)\nMurder_max &lt;- max(states$Murder, na.rm = TRUE)\n\nplot_data &lt;- data.frame(\n  Murder = seq(Murder_min, Murder_max, length.out = 10000)\n)\n\nplot_data$Murder_centered &lt;- scale(plot_data$Murder, scale = FALSE)\n\n# Calculate predicted slopes and confidence intervals\nb1 &lt;- moderationModelSimpleSlopesFit_parameters[which(moderationModelSimpleSlopesFit_parameters$label == \"b1\"), \"est\"]\nb3 &lt;- moderationModelSimpleSlopesFit_parameters[which(moderationModelSimpleSlopesFit_parameters$label == \"b3\"), \"est\"]\n\nb1_se &lt;- moderationModelSimpleSlopesFit_parameters[which(moderationModelSimpleSlopesFit_parameters$label == \"b1\"), \"se\"]\nb3_se &lt;- moderationModelSimpleSlopesFit_parameters[which(moderationModelSimpleSlopesFit_parameters$label == \"b3\"), \"se\"]\n\nvarianceCovarianceMatrix &lt;- vcov(moderationFit)\n\nb1_var &lt;- varianceCovarianceMatrix[\"Income_rescaled~Illiteracy_centered\",\"Income_rescaled~Illiteracy_centered\"]\nb3_var &lt;- varianceCovarianceMatrix[\"interaction~~interaction\",\"interaction~~interaction\"]\ncov_b1b3 &lt;- varianceCovarianceMatrix[\"Income_rescaled~Illiteracy_centered\",\"interaction~~interaction\"]\n\n#sqrt((b1_se^2) + ((b3_se^2) * plot_data$Murder_centered^2) + (2 * plot_data$Murder_centered * cov_b1b3))\n#sqrt((b1_var) + ((b3_var) * plot_data$Murder_centered^2) + (2 * plot_data$Murder_centered * cov_b1b3))\n\nplot_data$predicted_slopes &lt;- b1 + b3 * plot_data$Murder_centered\nplot_data$slope_se &lt;- sqrt((b1_var) + ((b3_var) * plot_data$Murder_centered^2) + (2 * plot_data$Murder_centered * cov_b1b3))\n\n# Calculated the 95% confidence interval around the simple slope\nplot_data$lower_ci &lt;- plot_data$predicted_slopes - qnorm(.975) * plot_data$slope_se\nplot_data$upper_ci &lt;- plot_data$predicted_slopes + qnorm(.975) * plot_data$slope_se\n\n# Specify the significant range (based on the regions identified in the simple slopes analysis, see \"Simple Slopes and Regions of Significance\" section above)\nplot_data$significant_slope &lt;- FALSE\nplot_data$significant_slope[which(plot_data$Murder_centered &lt; -4.2 | plot_data$Murder_centered &gt; 3.75)] &lt;-TRUE # specify significant range\n\n# Specify the significant region number (there are either 0, 1, or 2 significant regions; in such cases, there would be 1, 0 or 1 or 2, or 1 nonsignificant regions, respectively)--for instance, sig from 0-4, ns from 4-12, and sig from 12-16 would be 2 significant regions and 1 nonsignificant region\nplot_data$significantRegionNumber &lt;- NA\nplot_data$significantRegionNumber[which(plot_data$Murder_centered &lt; -4.2)] &lt;- 1 # specify significant range 1\nplot_data$significantRegionNumber[which(plot_data$Murder_centered &gt; 3.75)] &lt;- 2 # specify significant range 2\n\nmin(plot_data$Murder[which(plot_data$significant_slope == FALSE)])\n\n[1] 4.051215\n\nCodemax(plot_data$Murder[which(plot_data$significant_slope == FALSE)])\n\n[1] 11.99938\n\nCodeggplot(plot_data, aes(x = Murder, y = predicted_slopes)) +\n  geom_ribbon(\n    data = plot_data %&gt;% filter(significant_slope == FALSE),\n    aes(ymin = lower_ci, ymax = upper_ci),\n    fill = \"#F8766D\",\n    alpha = 0.2) + \n  geom_ribbon(\n    data = plot_data %&gt;% filter(significantRegionNumber == 1),\n    aes(ymin = lower_ci, ymax = upper_ci),\n    fill = \"#00BFC4\",\n    alpha = 0.2) + \n  geom_ribbon(\n    data = plot_data %&gt;% filter(significantRegionNumber == 2),\n    aes(ymin = lower_ci, ymax = upper_ci),\n    fill = \"#00BFC4\",\n    alpha = 0.2) +\n  geom_line(\n    data = plot_data %&gt;% filter(significant_slope == FALSE),\n    aes(x = Murder, y = predicted_slopes),\n    color = \"#F8766D\",\n    linewidth = 2) +\n  geom_line(\n    data = plot_data %&gt;% filter(significantRegionNumber == 1),\n    aes(x = Murder, y = predicted_slopes),\n    color = \"#00BFC4\",\n    linewidth = 2) +\n  geom_line(\n    data = plot_data %&gt;% filter(significantRegionNumber == 2),\n    aes(x = Murder, y = predicted_slopes),\n    color = \"#00BFC4\",\n    linewidth = 2) +\n  geom_hline(yintercept = 0, linetype = \"dashed\") +\n  geom_vline(xintercept = c(4.051215, 11.99938), linetype = 2, color = \"#00BFC4\") + # update based on numbers above\n  labs(\n    title = \"Johnson-Neyman Plot\",\n    subtitle = \"(blue = significant slope; pink = nonsignificant slope)\",\n    x = \"Moderator (Murder)\",\n    y = \"Simple Slope of Predictor (Illiteracy)\") +\n  theme_classic()",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#configural-invariance",
    "href": "sem.html#configural-invariance",
    "title": "Structural Equation Modeling",
    "section": "\n14.1 Configural Invariance",
    "text": "14.1 Configural Invariance\nEvaluates whether there are the same number of latent factors across time and whether the indicators load onto the same latent factor(s) across time.\n\nStandardize the latent factor(s) at T1 (i.e., fix the mean to zero and the variance to one)\nFor each latent construct, constrain the first indicator’s factor loading to be the same across time\nFor each latent construct, constrain the first indicator’s intercept to be the same across time\n\n\n14.1.1 Model Syntax\n\nCodeconfiguralInvariance_syntax &lt;- '\n  # Factor Loadings\n  jobsat_1 =~ NA*loadj1*JOBSAT11 + JOBSAT12 + JOBSAT13\n  jobsat_2 =~ NA*loadj1*JOBSAT21 + JOBSAT22 + JOBSAT23\n  jobsat_3 =~ NA*loadj1*JOBSAT31 + JOBSAT32 + JOBSAT33\n  \n  ready_1 =~ NA*loadr1*READY11 + READY12 + READY13\n  ready_2 =~ NA*loadr1*READY21 + READY22 + READY23\n  ready_3 =~ NA*loadr1*READY31 + READY32 + READY33\n  \n  commit_1 =~ NA*loadc1*COMMIT11 + COMMIT12 + COMMIT13\n  commit_2 =~ NA*loadc1*COMMIT21 + COMMIT22 + COMMIT23\n  commit_3 =~ NA*loadc1*COMMIT31 + COMMIT32 + COMMIT33\n  \n  # Factor Identification: Standardize Factors at T1\n  \n  ## Fix Factor Means at T1 to Zero\n  jobsat_1 ~ 0*1\n  ready_1 ~ 0*1\n  commit_1 ~ 0*1\n  \n  ## Fix Factor Variances at T1 to One\n  jobsat_1 ~~ 1*jobsat_1\n  ready_1 ~~ 1*ready_1\n  commit_1 ~~ 1*commit_1\n  \n  # Freely Estimate Factor Means at T2 and T3 (relative to T1)\n  jobsat_2 ~ 1\n  jobsat_3 ~ 1\n  \n  ready_2 ~ 1\n  ready_3 ~ 1\n  \n  commit_2 ~ 1\n  commit_3 ~ 1\n  \n  # Freely Estimate Factor Variances at T2 and T3 (relative to T1)\n  jobsat_2 ~~ jobsat_2\n  jobsat_3 ~~ jobsat_3\n  \n  ready_2 ~~ ready_2\n  ready_3 ~~ ready_3\n  \n  commit_2 ~~ commit_2\n  commit_3 ~~ commit_3\n  \n  # Fix Intercepts of Indicator 1 Across Time\n  JOBSAT11 ~ intj1*1\n  JOBSAT21 ~ intj1*1\n  JOBSAT31 ~ intj1*1\n  \n  READY11 ~ intr1*1\n  READY21 ~ intr1*1\n  READY31 ~ intr1*1\n  \n  COMMIT11 ~ intc1*1\n  COMMIT21 ~ intc1*1\n  COMMIT31 ~ intc1*1\n  \n  # Free Intercepts of Remaining Manifest Variables\n  JOBSAT12 ~ 1\n  JOBSAT13 ~ 1\n  JOBSAT22 ~ 1\n  JOBSAT23 ~ 1\n  JOBSAT32 ~ 1\n  JOBSAT33 ~ 1\n  \n  READY12 ~ 1\n  READY13 ~ 1\n  READY22 ~ 1\n  READY23 ~ 1\n  READY32 ~ 1\n  READY33 ~ 1\n  \n  COMMIT12 ~ 1\n  COMMIT13 ~ 1\n  COMMIT22 ~ 1\n  COMMIT23 ~ 1\n  COMMIT32 ~ 1\n  COMMIT33 ~ 1\n  \n  # Estimate Residual Variances of Manifest Variables\n  JOBSAT11 ~~ JOBSAT11\n  JOBSAT12 ~~ JOBSAT12\n  JOBSAT13 ~~ JOBSAT13\n  JOBSAT21 ~~ JOBSAT21\n  JOBSAT22 ~~ JOBSAT22\n  JOBSAT23 ~~ JOBSAT23\n  JOBSAT31 ~~ JOBSAT31\n  JOBSAT32 ~~ JOBSAT32\n  JOBSAT33 ~~ JOBSAT33\n  \n  READY11 ~~ READY11\n  READY12 ~~ READY12\n  READY13 ~~ READY13\n  READY21 ~~ READY21\n  READY22 ~~ READY22\n  READY23 ~~ READY23\n  READY31 ~~ READY31\n  READY32 ~~ READY32\n  READY33 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT11\n  COMMIT12 ~~ COMMIT12\n  COMMIT13 ~~ COMMIT13\n  COMMIT21 ~~ COMMIT21\n  COMMIT22 ~~ COMMIT22\n  COMMIT23 ~~ COMMIT23\n  COMMIT31 ~~ COMMIT31\n  COMMIT32 ~~ COMMIT32\n  COMMIT33 ~~ COMMIT33\n'\n\n\n\n14.1.2 Fit Model\n\nCodeconfiguralInvariance_fit &lt;- cfa(\n  configuralInvariance_syntax,\n  data = longitudinalMI,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  #std.lv = TRUE,\n  fixed.x = FALSE)\n\n\n\n14.1.3 Model Summary\n\nCodesummary(\n  configuralInvariance_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 101 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                       129\n  Number of equality constraints                    12\n\n  Number of observations                           495\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                               770.816     783.291\n  Degrees of freedom                               288         288\n  P-value (Chi-square)                           0.000       0.000\n  Scaling correction factor                                  0.984\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              6697.063    6541.933\n  Degrees of freedom                               351         351\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.024\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.924       0.920\n  Tucker-Lewis Index (TLI)                       0.907       0.902\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.923\n  Robust Tucker-Lewis Index (TLI)                            0.906\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)             -17716.771  -17716.771\n  Scaling correction factor                                  0.935\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)     -17331.363  -17331.363\n  Scaling correction factor                                  0.998\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               35667.543   35667.543\n  Bayesian (BIC)                             36159.476   36159.476\n  Sample-size adjusted Bayesian (SABIC)      35788.115   35788.115\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.058       0.059\n  90 Percent confidence interval - lower         0.053       0.054\n  90 Percent confidence interval - upper         0.063       0.064\n  P-value H_0: RMSEA &lt;= 0.050                    0.003       0.002\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.058\n  90 Percent confidence interval - lower                     0.054\n  90 Percent confidence interval - upper                     0.063\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.002\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.032       0.032\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  jobsat_1 =~                                                           \n    JOBSAT1 (ldj1)    0.996    0.041   24.099    0.000    0.996    0.818\n    JOBSAT1           1.019    0.042   24.487    0.000    1.019    0.814\n    JOBSAT1           0.956    0.040   23.787    0.000    0.956    0.798\n  jobsat_2 =~                                                           \n    JOBSAT2 (ldj1)    0.996    0.041   24.099    0.000    0.961    0.796\n    JOBSAT2           1.001    0.058   17.194    0.000    0.967    0.805\n    JOBSAT2           0.964    0.064   15.021    0.000    0.931    0.785\n  jobsat_3 =~                                                           \n    JOBSAT3 (ldj1)    0.996    0.041   24.099    0.000    0.861    0.776\n    JOBSAT3           0.980    0.066   14.839    0.000    0.848    0.773\n    JOBSAT3           1.070    0.071   15.159    0.000    0.926    0.806\n  ready_1 =~                                                            \n    READY11 (ldr1)    0.900    0.042   21.255    0.000    0.900    0.781\n    READY12           0.882    0.043   20.311    0.000    0.882    0.766\n    READY13           0.905    0.041   21.860    0.000    0.905    0.789\n  ready_2 =~                                                            \n    READY21 (ldr1)    0.900    0.042   21.255    0.000    0.947    0.795\n    READY22           0.785    0.053   14.924    0.000    0.826    0.731\n    READY23           0.821    0.056   14.581    0.000    0.864    0.750\n  ready_3 =~                                                            \n    READY31 (ldr1)    0.900    0.042   21.255    0.000    0.878    0.764\n    READY32           0.847    0.062   13.766    0.000    0.827    0.750\n    READY33           0.888    0.070   12.759    0.000    0.867    0.757\n  commit_1 =~                                                           \n    COMMIT1 (ldc1)    0.809    0.044   18.389    0.000    0.809    0.748\n    COMMIT1           0.825    0.041   19.985    0.000    0.825    0.755\n    COMMIT1           0.815    0.042   19.477    0.000    0.815    0.753\n  commit_2 =~                                                           \n    COMMIT2 (ldc1)    0.809    0.044   18.389    0.000    0.854    0.768\n    COMMIT2           0.818    0.058   14.105    0.000    0.863    0.768\n    COMMIT2           0.866    0.062   13.866    0.000    0.914    0.787\n  commit_3 =~                                                           \n    COMMIT3 (ldc1)    0.809    0.044   18.389    0.000    0.774    0.752\n    COMMIT3           0.771    0.059   13.123    0.000    0.738    0.706\n    COMMIT3           0.812    0.066   12.398    0.000    0.777    0.728\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  jobsat_1 ~~                                                           \n    jobsat_2          0.436    0.058    7.532    0.000    0.451    0.451\n    jobsat_3          0.325    0.052    6.288    0.000    0.375    0.375\n    ready_1           0.542    0.050   10.840    0.000    0.542    0.542\n    ready_2           0.286    0.062    4.611    0.000    0.271    0.271\n    ready_3           0.176    0.057    3.105    0.002    0.181    0.181\n    commit_1          0.581    0.046   12.496    0.000    0.581    0.581\n    commit_2          0.380    0.063    6.086    0.000    0.360    0.360\n    commit_3          0.237    0.056    4.211    0.000    0.248    0.248\n  jobsat_2 ~~                                                           \n    jobsat_3          0.381    0.057    6.665    0.000    0.456    0.456\n    ready_1           0.198    0.057    3.494    0.000    0.205    0.205\n    ready_2           0.508    0.067    7.574    0.000    0.500    0.500\n    ready_3           0.193    0.057    3.405    0.001    0.205    0.205\n    commit_1          0.278    0.055    5.049    0.000    0.288    0.288\n    commit_2          0.584    0.070    8.297    0.000    0.573    0.573\n    commit_3          0.260    0.059    4.431    0.000    0.281    0.281\n  jobsat_3 ~~                                                           \n    ready_1           0.201    0.048    4.224    0.000    0.232    0.232\n    ready_2           0.272    0.054    5.051    0.000    0.298    0.298\n    ready_3           0.451    0.063    7.182    0.000    0.534    0.534\n    commit_1          0.182    0.052    3.489    0.000    0.210    0.210\n    commit_2          0.265    0.059    4.503    0.000    0.290    0.290\n    commit_3          0.480    0.061    7.885    0.000    0.580    0.580\n  ready_1 ~~                                                            \n    ready_2           0.404    0.066    6.073    0.000    0.383    0.383\n    ready_3           0.323    0.059    5.445    0.000    0.331    0.331\n    commit_1          0.452    0.050    9.057    0.000    0.452    0.452\n    commit_2          0.282    0.065    4.332    0.000    0.267    0.267\n    commit_3          0.230    0.058    3.990    0.000    0.240    0.240\n  ready_2 ~~                                                            \n    ready_3           0.515    0.077    6.723    0.000    0.501    0.501\n    commit_1          0.270    0.062    4.373    0.000    0.256    0.256\n    commit_2          0.694    0.086    8.052    0.000    0.625    0.625\n    commit_3          0.309    0.066    4.709    0.000    0.307    0.307\n  ready_3 ~~                                                            \n    commit_1          0.175    0.059    2.981    0.003    0.180    0.180\n    commit_2          0.298    0.067    4.478    0.000    0.289    0.289\n    commit_3          0.452    0.070    6.414    0.000    0.484    0.484\n  commit_1 ~~                                                           \n    commit_2          0.632    0.065    9.669    0.000    0.598    0.598\n    commit_3          0.427    0.059    7.214    0.000    0.447    0.447\n  commit_2 ~~                                                           \n    commit_3          0.583    0.090    6.510    0.000    0.577    0.577\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jbst_1            0.000                               0.000    0.000\n    redy_1            0.000                               0.000    0.000\n    cmmt_1            0.000                               0.000    0.000\n    jbst_2           -0.000    0.062   -0.000    1.000   -0.000   -0.000\n    jbst_3            0.126    0.060    2.099    0.036    0.145    0.145\n    redy_2            0.056    0.070    0.802    0.422    0.053    0.053\n    redy_3            0.204    0.073    2.818    0.005    0.209    0.209\n    cmmt_2           -0.200    0.069   -2.885    0.004   -0.189   -0.189\n    cmmt_3           -0.172    0.071   -2.442    0.015   -0.180   -0.180\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.727\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.749\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.989\n   .READY1 (intr1)    3.176    0.052   61.297    0.000    3.176    2.755\n   .READY2 (intr1)    3.176    0.052   61.297    0.000    3.176    2.665\n   .READY3 (intr1)    3.176    0.052   61.297    0.000    3.176    2.763\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.442\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.345\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.613\n   .JOBSAT            3.311    0.056   58.833    0.000    3.311    2.644\n   .JOBSAT            3.321    0.054   61.701    0.000    3.321    2.773\n   .JOBSAT            3.331    0.067   49.733    0.000    3.331    2.774\n   .JOBSAT            3.329    0.067   49.620    0.000    3.329    2.805\n   .JOBSAT            3.281    0.065   50.616    0.000    3.281    2.992\n   .JOBSAT            3.251    0.070   46.441    0.000    3.251    2.830\n   .READY1            3.198    0.052   61.778    0.000    3.198    2.777\n   .READY1            3.156    0.052   61.219    0.000    3.156    2.752\n   .READY2            3.170    0.061   51.554    0.000    3.170    2.807\n   .READY2            3.211    0.062   51.499    0.000    3.211    2.788\n   .READY3            3.156    0.066   47.871    0.000    3.156    2.864\n   .READY3            3.146    0.070   44.635    0.000    3.146    2.747\n   .COMMIT            3.653    0.049   74.420    0.000    3.653    3.345\n   .COMMIT            3.596    0.049   73.962    0.000    3.596    3.324\n   .COMMIT            3.689    0.064   57.387    0.000    3.689    3.282\n   .COMMIT            3.662    0.066   55.846    0.000    3.662    3.153\n   .COMMIT            3.749    0.061   61.081    0.000    3.749    3.586\n   .COMMIT            3.692    0.064   57.657    0.000    3.692    3.457\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jobsat_1          1.000                               1.000    1.000\n    ready_1           1.000                               1.000    1.000\n    commit_1          1.000                               1.000    1.000\n    jobsat_2          0.933    0.098    9.534    0.000    1.000    1.000\n    jobsat_3          0.748    0.087    8.650    0.000    1.000    1.000\n    ready_2           1.108    0.122    9.097    0.000    1.000    1.000\n    ready_3           0.952    0.122    7.786    0.000    1.000    1.000\n    commit_2          1.114    0.146    7.615    0.000    1.000    1.000\n    commit_3          0.916    0.127    7.204    0.000    1.000    1.000\n   .JOBSAT11          0.491    0.051    9.630    0.000    0.491    0.331\n   .JOBSAT12          0.529    0.049   10.895    0.000    0.529    0.337\n   .JOBSAT13          0.521    0.046   11.315    0.000    0.521    0.363\n   .JOBSAT21          0.533    0.052   10.209    0.000    0.533    0.366\n   .JOBSAT22          0.506    0.047   10.685    0.000    0.506    0.351\n   .JOBSAT23          0.542    0.052   10.394    0.000    0.542    0.384\n   .JOBSAT31          0.491    0.042   11.704    0.000    0.491    0.398\n   .JOBSAT32          0.484    0.043   11.164    0.000    0.484    0.403\n   .JOBSAT33          0.463    0.046   10.128    0.000    0.463    0.350\n   .READY11           0.519    0.051   10.112    0.000    0.519    0.391\n   .READY12           0.548    0.048   11.392    0.000    0.548    0.413\n   .READY13           0.496    0.048   10.318    0.000    0.496    0.377\n   .READY21           0.522    0.054    9.742    0.000    0.522    0.368\n   .READY22           0.593    0.049   12.067    0.000    0.593    0.465\n   .READY23           0.580    0.055   10.611    0.000    0.580    0.437\n   .READY31           0.550    0.054   10.190    0.000    0.550    0.417\n   .READY32           0.531    0.048   11.179    0.000    0.531    0.437\n   .READY33           0.560    0.048   11.585    0.000    0.560    0.427\n   .COMMIT11          0.514    0.050   10.191    0.000    0.514    0.440\n   .COMMIT12          0.512    0.045   11.266    0.000    0.512    0.429\n   .COMMIT13          0.506    0.047   10.756    0.000    0.506    0.432\n   .COMMIT21          0.508    0.046   10.932    0.000    0.508    0.411\n   .COMMIT22          0.518    0.047   11.112    0.000    0.518    0.410\n   .COMMIT23          0.513    0.051   10.121    0.000    0.513    0.380\n   .COMMIT31          0.461    0.043   10.761    0.000    0.461    0.435\n   .COMMIT32          0.548    0.054   10.095    0.000    0.548    0.501\n   .COMMIT33          0.536    0.048   11.080    0.000    0.536    0.470\n\nR-Square:\n                   Estimate\n    JOBSAT11          0.669\n    JOBSAT12          0.663\n    JOBSAT13          0.637\n    JOBSAT21          0.634\n    JOBSAT22          0.649\n    JOBSAT23          0.616\n    JOBSAT31          0.602\n    JOBSAT32          0.597\n    JOBSAT33          0.650\n    READY11           0.609\n    READY12           0.587\n    READY13           0.623\n    READY21           0.632\n    READY22           0.535\n    READY23           0.563\n    READY31           0.583\n    READY32           0.563\n    READY33           0.573\n    COMMIT11          0.560\n    COMMIT12          0.571\n    COMMIT13          0.568\n    COMMIT21          0.589\n    COMMIT22          0.590\n    COMMIT23          0.620\n    COMMIT31          0.565\n    COMMIT32          0.499\n    COMMIT33          0.530\n\n\n\n14.1.4 Modification Indices\n\nCodemodificationindices(\n  configuralInvariance_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n14.1.5 Path Diagram\n\nCodelavaanPlot::lavaanPlot2(\n  configuralInvariance_fit,\n  stand = TRUE,\n  coef_labels = TRUE)\n\n\nPath Diagram\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(configuralInvariance_fit)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#configural-invariance-with-correlated-residuals-within-indicator-across-time",
    "href": "sem.html#configural-invariance-with-correlated-residuals-within-indicator-across-time",
    "title": "Structural Equation Modeling",
    "section": "\n14.2 Configural Invariance With Correlated Residuals Within-Indicator Across Time",
    "text": "14.2 Configural Invariance With Correlated Residuals Within-Indicator Across Time\n\nStandardize the latent factor(s) at T1 (i.e., fix the mean to zero and the variance to one)\nFor each latent construct, constrain the first indicator’s factor loading to be the same across time\nFor each latent construct, constrain the first indicator’s intercept to be the same across time\nAllow within-indicator residuals to covary across time\n\n\n14.2.1 Model Syntax\n\nCodeconfiguralInvarianceCorrelatedResiduals_syntax &lt;- '\n  # Factor Loadings\n  jobsat_1 =~ NA*loadj1*JOBSAT11 + JOBSAT12 + JOBSAT13\n  jobsat_2 =~ NA*loadj1*JOBSAT21 + JOBSAT22 + JOBSAT23\n  jobsat_3 =~ NA*loadj1*JOBSAT31 + JOBSAT32 + JOBSAT33\n  \n  ready_1 =~ NA*loadr1*READY11 + READY12 + READY13\n  ready_2 =~ NA*loadr1*READY21 + READY22 + READY23\n  ready_3 =~ NA*loadr1*READY31 + READY32 + READY33\n  \n  commit_1 =~ NA*loadc1*COMMIT11 + COMMIT12 + COMMIT13\n  commit_2 =~ NA*loadc1*COMMIT21 + COMMIT22 + COMMIT23\n  commit_3 =~ NA*loadc1*COMMIT31 + COMMIT32 + COMMIT33\n  \n  # Factor Identification: Standardize Factors at T1\n  \n  ## Fix Factor Means at T1 to Zero\n  jobsat_1 ~ 0*1\n  ready_1 ~ 0*1\n  commit_1 ~ 0*1\n  \n  ## Fix Factor Variances at T1 to One\n  jobsat_1 ~~ 1*jobsat_1\n  ready_1 ~~ 1*ready_1\n  commit_1 ~~ 1*commit_1\n  \n  # Freely Estimate Factor Means at T2 and T3 (relative to T1)\n  jobsat_2 ~ 1\n  jobsat_3 ~ 1\n  \n  ready_2 ~ 1\n  ready_3 ~ 1\n  \n  commit_2 ~ 1\n  commit_3 ~ 1\n  \n  # Freely Estimate Factor Variances at T2 and T3 (relative to T1)\n  jobsat_2 ~~ jobsat_2\n  jobsat_3 ~~ jobsat_3\n  \n  ready_2 ~~ ready_2\n  ready_3 ~~ ready_3\n  \n  commit_2 ~~ commit_2\n  commit_3 ~~ commit_3\n  \n  # Fix Intercepts of Indicator 1 Across Time\n  JOBSAT11 ~ intj1*1\n  JOBSAT21 ~ intj1*1\n  JOBSAT31 ~ intj1*1\n  \n  READY11 ~ intr1*1\n  READY21 ~ intr1*1\n  READY31 ~ intr1*1\n  \n  COMMIT11 ~ intc1*1\n  COMMIT21 ~ intc1*1\n  COMMIT31 ~ intc1*1\n  \n  # Free Intercepts of Remaining Manifest Variables\n  JOBSAT12 ~ 1\n  JOBSAT13 ~ 1\n  JOBSAT22 ~ 1\n  JOBSAT23 ~ 1\n  JOBSAT32 ~ 1\n  JOBSAT33 ~ 1\n  \n  READY12 ~ 1\n  READY13 ~ 1\n  READY22 ~ 1\n  READY23 ~ 1\n  READY32 ~ 1\n  READY33 ~ 1\n  \n  COMMIT12 ~ 1\n  COMMIT13 ~ 1\n  COMMIT22 ~ 1\n  COMMIT23 ~ 1\n  COMMIT32 ~ 1\n  COMMIT33 ~ 1\n  \n  # Estimate Residual Variances of Manifest Variables\n  JOBSAT11 ~~ JOBSAT11\n  JOBSAT12 ~~ JOBSAT12\n  JOBSAT13 ~~ JOBSAT13\n  JOBSAT21 ~~ JOBSAT21\n  JOBSAT22 ~~ JOBSAT22\n  JOBSAT23 ~~ JOBSAT23\n  JOBSAT31 ~~ JOBSAT31\n  JOBSAT32 ~~ JOBSAT32\n  JOBSAT33 ~~ JOBSAT33\n  \n  READY11 ~~ READY11\n  READY12 ~~ READY12\n  READY13 ~~ READY13\n  READY21 ~~ READY21\n  READY22 ~~ READY22\n  READY23 ~~ READY23\n  READY31 ~~ READY31\n  READY32 ~~ READY32\n  READY33 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT11\n  COMMIT12 ~~ COMMIT12\n  COMMIT13 ~~ COMMIT13\n  COMMIT21 ~~ COMMIT21\n  COMMIT22 ~~ COMMIT22\n  COMMIT23 ~~ COMMIT23\n  COMMIT31 ~~ COMMIT31\n  COMMIT32 ~~ COMMIT32\n  COMMIT33 ~~ COMMIT33\n  \n  # Residual Covariances Within Indicator Across Time\n  JOBSAT11 ~~ JOBSAT21\n  JOBSAT21 ~~ JOBSAT31\n  JOBSAT11 ~~ JOBSAT31\n  \n  JOBSAT12 ~~ JOBSAT22\n  JOBSAT22 ~~ JOBSAT32\n  JOBSAT12 ~~ JOBSAT32\n  \n  JOBSAT13 ~~ JOBSAT23\n  JOBSAT23 ~~ JOBSAT33\n  JOBSAT13 ~~ JOBSAT33\n  \n  READY11 ~~ READY21\n  READY21 ~~ READY31\n  READY11 ~~ READY31\n  \n  READY12 ~~ READY22\n  READY22 ~~ READY32\n  READY12 ~~ READY32\n  \n  READY13 ~~ READY23\n  READY23 ~~ READY33\n  READY13 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT21\n  COMMIT21 ~~ COMMIT31\n  COMMIT11 ~~ COMMIT31\n  \n  COMMIT12 ~~ COMMIT22\n  COMMIT22 ~~ COMMIT32\n  COMMIT12 ~~ COMMIT32\n  \n  COMMIT13 ~~ COMMIT23\n  COMMIT23 ~~ COMMIT33\n  COMMIT13 ~~ COMMIT33\n'\n\n\n\n14.2.2 Fit Model\n\nCodeconfiguralInvarianceCorrelatedResiduals_fit &lt;- cfa(\n  configuralInvarianceCorrelatedResiduals_syntax,\n  data = longitudinalMI,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  #std.lv = TRUE,\n  fixed.x = FALSE)\n\n\n\n14.2.3 Model Summary\n\nCodesummary(\n  configuralInvarianceCorrelatedResiduals_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 105 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                       156\n  Number of equality constraints                    12\n\n  Number of observations                           495\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                               277.582     281.997\n  Degrees of freedom                               261         261\n  P-value (Chi-square)                           0.230       0.178\n  Scaling correction factor                                  0.984\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              6697.063    6541.933\n  Degrees of freedom                               351         351\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.024\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.997       0.997\n  Tucker-Lewis Index (TLI)                       0.996       0.995\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.997\n  Robust Tucker-Lewis Index (TLI)                            0.996\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)             -17470.154  -17470.154\n  Scaling correction factor                                  0.943\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)     -17331.363  -17331.363\n  Scaling correction factor                                  0.998\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               35228.308   35228.308\n  Bayesian (BIC)                             35833.764   35833.764\n  Sample-size adjusted Bayesian (SABIC)      35376.705   35376.705\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.011       0.013\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.022       0.023\n  P-value H_0: RMSEA &lt;= 0.050                    1.000       1.000\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.012\n  90 Percent confidence interval - lower                     0.000\n  90 Percent confidence interval - upper                     0.022\n  P-value H_0: Robust RMSEA &lt;= 0.050                         1.000\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.023       0.023\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  jobsat_1 =~                                                           \n    JOBSAT1 (ldj1)    0.979    0.041   23.788    0.000    0.979    0.810\n    JOBSAT1           1.026    0.041   24.962    0.000    1.026    0.815\n    JOBSAT1           0.965    0.039   24.509    0.000    0.965    0.806\n  jobsat_2 =~                                                           \n    JOBSAT2 (ldj1)    0.979    0.041   23.788    0.000    0.946    0.786\n    JOBSAT2           0.995    0.058   17.082    0.000    0.961    0.805\n    JOBSAT2           0.983    0.065   15.181    0.000    0.949    0.794\n  jobsat_3 =~                                                           \n    JOBSAT3 (ldj1)    0.979    0.041   23.788    0.000    0.853    0.772\n    JOBSAT3           0.976    0.066   14.902    0.000    0.851    0.775\n    JOBSAT3           1.070    0.070   15.313    0.000    0.932    0.807\n  ready_1 =~                                                            \n    READY11 (ldr1)    0.910    0.042   21.715    0.000    0.910    0.787\n    READY12           0.871    0.043   20.162    0.000    0.871    0.760\n    READY13           0.901    0.042   21.676    0.000    0.901    0.786\n  ready_2 =~                                                            \n    READY21 (ldr1)    0.910    0.042   21.715    0.000    0.950    0.797\n    READY22           0.779    0.053   14.602    0.000    0.813    0.723\n    READY23           0.836    0.057   14.618    0.000    0.873    0.756\n  ready_3 =~                                                            \n    READY31 (ldr1)    0.910    0.042   21.715    0.000    0.884    0.768\n    READY32           0.842    0.062   13.664    0.000    0.818    0.744\n    READY33           0.897    0.070   12.814    0.000    0.871    0.760\n  commit_1 =~                                                           \n    COMMIT1 (ldc1)    0.818    0.043   19.142    0.000    0.818    0.756\n    COMMIT1           0.829    0.042   19.691    0.000    0.829    0.757\n    COMMIT1           0.798    0.042   19.211    0.000    0.798    0.742\n  commit_2 =~                                                           \n    COMMIT2 (ldc1)    0.818    0.043   19.142    0.000    0.856    0.771\n    COMMIT2           0.827    0.060   13.839    0.000    0.866    0.770\n    COMMIT2           0.867    0.063   13.794    0.000    0.908    0.782\n  commit_3 =~                                                           \n    COMMIT3 (ldc1)    0.818    0.043   19.142    0.000    0.763    0.745\n    COMMIT3           0.792    0.062   12.811    0.000    0.740    0.708\n    COMMIT3           0.844    0.069   12.227    0.000    0.788    0.734\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .JOBSAT11 ~~                                                           \n   .JOBSAT21          0.114    0.032    3.543    0.000    0.114    0.216\n .JOBSAT21 ~~                                                           \n   .JOBSAT31          0.122    0.032    3.835    0.000    0.122    0.234\n .JOBSAT11 ~~                                                           \n   .JOBSAT31          0.150    0.029    5.113    0.000    0.150    0.301\n .JOBSAT12 ~~                                                           \n   .JOBSAT22          0.151    0.034    4.431    0.000    0.151    0.293\n .JOBSAT22 ~~                                                           \n   .JOBSAT32          0.097    0.030    3.223    0.001    0.097    0.197\n .JOBSAT12 ~~                                                           \n   .JOBSAT32          0.075    0.032    2.389    0.017    0.075    0.149\n .JOBSAT13 ~~                                                           \n   .JOBSAT23          0.093    0.033    2.802    0.005    0.093    0.179\n .JOBSAT23 ~~                                                           \n   .JOBSAT33          0.145    0.034    4.324    0.000    0.145    0.293\n .JOBSAT13 ~~                                                           \n   .JOBSAT33          0.114    0.031    3.627    0.000    0.114    0.236\n .READY11 ~~                                                            \n   .READY21           0.135    0.033    4.052    0.000    0.135    0.264\n .READY21 ~~                                                            \n   .READY31           0.104    0.032    3.259    0.001    0.104    0.197\n .READY11 ~~                                                            \n   .READY31           0.100    0.033    3.043    0.002    0.100    0.190\n .READY12 ~~                                                            \n   .READY22           0.181    0.033    5.443    0.000    0.181    0.313\n .READY22 ~~                                                            \n   .READY32           0.175    0.037    4.681    0.000    0.175    0.306\n .READY12 ~~                                                            \n   .READY32           0.119    0.034    3.482    0.000    0.119    0.217\n .READY13 ~~                                                            \n   .READY23           0.134    0.033    4.036    0.000    0.134    0.250\n .READY23 ~~                                                            \n   .READY33           0.169    0.035    4.859    0.000    0.169    0.300\n .READY13 ~~                                                            \n   .READY33           0.116    0.033    3.566    0.000    0.116    0.220\n .COMMIT11 ~~                                                           \n   .COMMIT21          0.123    0.032    3.839    0.000    0.123    0.245\n .COMMIT21 ~~                                                           \n   .COMMIT31          0.143    0.031    4.553    0.000    0.143    0.295\n .COMMIT11 ~~                                                           \n   .COMMIT31          0.108    0.030    3.641    0.000    0.108    0.223\n .COMMIT12 ~~                                                           \n   .COMMIT22          0.099    0.032    3.047    0.002    0.099    0.193\n .COMMIT22 ~~                                                           \n   .COMMIT32          0.122    0.034    3.634    0.000    0.122    0.231\n .COMMIT12 ~~                                                           \n   .COMMIT32          0.084    0.031    2.711    0.007    0.084    0.159\n .COMMIT13 ~~                                                           \n   .COMMIT23          0.172    0.034    5.097    0.000    0.172    0.330\n .COMMIT23 ~~                                                           \n   .COMMIT33          0.147    0.031    4.725    0.000    0.147    0.278\n .COMMIT13 ~~                                                           \n   .COMMIT33          0.113    0.033    3.424    0.001    0.113    0.214\n  jobsat_1 ~~                                                           \n    jobsat_2          0.394    0.057    6.887    0.000    0.407    0.407\n    jobsat_3          0.288    0.051    5.618    0.000    0.331    0.331\n    ready_1           0.541    0.050   10.755    0.000    0.541    0.541\n    ready_2           0.287    0.062    4.624    0.000    0.274    0.274\n    ready_3           0.176    0.057    3.114    0.002    0.181    0.181\n    commit_1          0.579    0.047   12.433    0.000    0.579    0.579\n    commit_2          0.376    0.062    6.086    0.000    0.359    0.359\n    commit_3          0.229    0.055    4.147    0.000    0.245    0.245\n  jobsat_2 ~~                                                           \n    jobsat_3          0.343    0.057    6.053    0.000    0.408    0.408\n    ready_1           0.201    0.056    3.567    0.000    0.208    0.208\n    ready_2           0.509    0.067    7.634    0.000    0.505    0.505\n    ready_3           0.193    0.057    3.419    0.001    0.206    0.206\n    commit_1          0.279    0.055    5.037    0.000    0.289    0.289\n    commit_2          0.580    0.071    8.184    0.000    0.573    0.573\n    commit_3          0.254    0.058    4.378    0.000    0.282    0.282\n  jobsat_3 ~~                                                           \n    ready_1           0.200    0.048    4.178    0.000    0.230    0.230\n    ready_2           0.269    0.054    4.959    0.000    0.295    0.295\n    ready_3           0.447    0.063    7.045    0.000    0.528    0.528\n    commit_1          0.185    0.053    3.508    0.000    0.213    0.213\n    commit_2          0.264    0.059    4.472    0.000    0.289    0.289\n    commit_3          0.471    0.061    7.760    0.000    0.579    0.579\n  ready_1 ~~                                                            \n    ready_2           0.334    0.066    5.086    0.000    0.320    0.320\n    ready_3           0.274    0.058    4.679    0.000    0.282    0.282\n    commit_1          0.453    0.050    9.111    0.000    0.453    0.453\n    commit_2          0.281    0.065    4.354    0.000    0.268    0.268\n    commit_3          0.223    0.056    3.959    0.000    0.239    0.239\n  ready_2 ~~                                                            \n    ready_3           0.442    0.073    6.032    0.000    0.436    0.436\n    commit_1          0.269    0.062    4.342    0.000    0.257    0.257\n    commit_2          0.681    0.085    8.018    0.000    0.623    0.623\n    commit_3          0.296    0.064    4.659    0.000    0.304    0.304\n  ready_3 ~~                                                            \n    commit_1          0.175    0.059    2.993    0.003    0.181    0.181\n    commit_2          0.296    0.065    4.546    0.000    0.291    0.291\n    commit_3          0.437    0.068    6.450    0.000    0.482    0.482\n  commit_1 ~~                                                           \n    commit_2          0.562    0.062    9.025    0.000    0.537    0.537\n    commit_3          0.368    0.058    6.400    0.000    0.395    0.395\n  commit_2 ~~                                                           \n    commit_3          0.499    0.083    6.043    0.000    0.510    0.510\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jbst_1            0.000                               0.000    0.000\n    redy_1            0.000                               0.000    0.000\n    cmmt_1            0.000                               0.000    0.000\n    jbst_2            0.000    0.063    0.000    1.000    0.000    0.000\n    jbst_3            0.128    0.061    2.103    0.036    0.147    0.147\n    redy_2            0.055    0.069    0.802    0.423    0.053    0.053\n    redy_3            0.202    0.072    2.825    0.005    0.208    0.208\n    cmmt_2           -0.198    0.068   -2.899    0.004   -0.189   -0.189\n    cmmt_3           -0.170    0.070   -2.450    0.014   -0.183   -0.183\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.744\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.756\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    3.004\n   .READY1 (intr1)    3.176    0.052   61.296    0.000    3.176    2.746\n   .READY2 (intr1)    3.176    0.052   61.296    0.000    3.176    2.665\n   .READY3 (intr1)    3.176    0.052   61.296    0.000    3.176    2.758\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.437\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.348\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.630\n   .JOBSAT            3.311    0.056   58.833    0.000    3.311    2.631\n   .JOBSAT            3.321    0.054   61.701    0.000    3.321    2.774\n   .JOBSAT            3.331    0.067   49.453    0.000    3.331    2.791\n   .JOBSAT            3.329    0.068   48.605    0.000    3.329    2.783\n   .JOBSAT            3.279    0.065   50.341    0.000    3.279    2.990\n   .JOBSAT            3.249    0.071   46.030    0.000    3.249    2.814\n   .READY1            3.198    0.052   61.778    0.000    3.198    2.790\n   .READY1            3.156    0.052   61.219    0.000    3.156    2.754\n   .READY2            3.171    0.061   52.068    0.000    3.171    2.819\n   .READY2            3.210    0.063   51.298    0.000    3.210    2.778\n   .READY3            3.159    0.065   48.549    0.000    3.159    2.875\n   .READY3            3.146    0.070   44.824    0.000    3.146    2.744\n   .COMMIT            3.653    0.049   74.419    0.000    3.653    3.335\n   .COMMIT            3.596    0.049   73.962    0.000    3.596    3.345\n   .COMMIT            3.689    0.064   57.549    0.000    3.689    3.282\n   .COMMIT            3.660    0.065   55.988    0.000    3.660    3.152\n   .COMMIT            3.751    0.062   60.799    0.000    3.751    3.591\n   .COMMIT            3.695    0.065   56.956    0.000    3.695    3.443\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jobsat_1          1.000                               1.000    1.000\n    ready_1           1.000                               1.000    1.000\n    commit_1          1.000                               1.000    1.000\n    jobsat_2          0.933    0.101    9.252    0.000    1.000    1.000\n    jobsat_3          0.759    0.089    8.559    0.000    1.000    1.000\n    ready_2           1.090    0.122    8.925    0.000    1.000    1.000\n    ready_3           0.943    0.121    7.772    0.000    1.000    1.000\n    commit_2          1.096    0.145    7.585    0.000    1.000    1.000\n    commit_3          0.871    0.122    7.138    0.000    1.000    1.000\n   .JOBSAT11          0.504    0.051    9.893    0.000    0.504    0.345\n   .JOBSAT12          0.532    0.049   10.784    0.000    0.532    0.336\n   .JOBSAT13          0.503    0.046   11.012    0.000    0.503    0.351\n   .JOBSAT21          0.555    0.052   10.639    0.000    0.555    0.382\n   .JOBSAT22          0.502    0.049   10.149    0.000    0.502    0.352\n   .JOBSAT23          0.530    0.053    9.904    0.000    0.530    0.370\n   .JOBSAT31          0.493    0.043   11.464    0.000    0.493    0.404\n   .JOBSAT32          0.480    0.043   11.113    0.000    0.480    0.399\n   .JOBSAT33          0.464    0.047    9.967    0.000    0.464    0.348\n   .READY11           0.509    0.052    9.752    0.000    0.509    0.381\n   .READY12           0.555    0.049   11.433    0.000    0.555    0.422\n   .READY13           0.502    0.049   10.322    0.000    0.502    0.382\n   .READY21           0.517    0.054    9.531    0.000    0.517    0.364\n   .READY22           0.604    0.051   11.805    0.000    0.604    0.477\n   .READY23           0.573    0.055   10.331    0.000    0.573    0.429\n   .READY31           0.545    0.056    9.740    0.000    0.545    0.411\n   .READY32           0.539    0.049   11.090    0.000    0.539    0.446\n   .READY33           0.555    0.049   11.299    0.000    0.555    0.422\n   .COMMIT11          0.503    0.051    9.807    0.000    0.503    0.429\n   .COMMIT12          0.512    0.048   10.667    0.000    0.512    0.427\n   .COMMIT13          0.519    0.049   10.666    0.000    0.519    0.449\n   .COMMIT21          0.501    0.048   10.519    0.000    0.501    0.406\n   .COMMIT22          0.514    0.050   10.359    0.000    0.514    0.407\n   .COMMIT23          0.524    0.052   10.053    0.000    0.524    0.389\n   .COMMIT31          0.467    0.044   10.613    0.000    0.467    0.445\n   .COMMIT32          0.545    0.057    9.611    0.000    0.545    0.499\n   .COMMIT33          0.532    0.051   10.472    0.000    0.532    0.461\n\nR-Square:\n                   Estimate\n    JOBSAT11          0.655\n    JOBSAT12          0.664\n    JOBSAT13          0.649\n    JOBSAT21          0.618\n    JOBSAT22          0.648\n    JOBSAT23          0.630\n    JOBSAT31          0.596\n    JOBSAT32          0.601\n    JOBSAT33          0.652\n    READY11           0.619\n    READY12           0.578\n    READY13           0.618\n    READY21           0.636\n    READY22           0.523\n    READY23           0.571\n    READY31           0.589\n    READY32           0.554\n    READY33           0.578\n    COMMIT11          0.571\n    COMMIT12          0.573\n    COMMIT13          0.551\n    COMMIT21          0.594\n    COMMIT22          0.593\n    COMMIT23          0.611\n    COMMIT31          0.555\n    COMMIT32          0.501\n    COMMIT33          0.539\n\n\n\n14.2.4 Modification Indices\n\nCodemodificationindices(\n  configuralInvarianceCorrelatedResiduals_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n14.2.5 Path Diagram\n\nCodelavaanPlot::lavaanPlot2(\n  configuralInvarianceCorrelatedResiduals_fit,\n  stand = TRUE,\n  coef_labels = TRUE)\n\n\nPath Diagram\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(configuralInvarianceCorrelatedResiduals_fit)\n\n\n\n14.2.6 Compare Models\n\nCodeanova(\n  configuralInvariance_fit,\n  configuralInvarianceCorrelatedResiduals_fit\n)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#metric-weak-factorial-invariance",
    "href": "sem.html#metric-weak-factorial-invariance",
    "title": "Structural Equation Modeling",
    "section": "\n14.3 Metric (“Weak Factorial”) Invariance",
    "text": "14.3 Metric (“Weak Factorial”) Invariance\nEvaluates whether the items’ factor loadings are the same across time.\n\nStandardize the latent factor(s) at T1 (i.e., fix the mean to zero and the variance to one)\nFor each latent construct, constrain the first indicator’s intercept to be the same across time\nAllow within-indicator residuals to covary across time\nFor each indicator, constrain its factor loading to be the same across time\n\n\n14.3.1 Model Syntax\n\nCodemetricInvariance_syntax &lt;- '\n  # Factor Loadings\n  jobsat_1 =~ NA*loadj1*JOBSAT11 + loadj2*JOBSAT12 + loadj3*JOBSAT13\n  jobsat_2 =~ NA*loadj1*JOBSAT21 + loadj2*JOBSAT22 + loadj3*JOBSAT23\n  jobsat_3 =~ NA*loadj1*JOBSAT31 + loadj2*JOBSAT32 + loadj3*JOBSAT33\n  \n  ready_1 =~ NA*loadr1*READY11 + loadr2*READY12 + loadr3*READY13\n  ready_2 =~ NA*loadr1*READY21 + loadr2*READY22 + loadr3*READY23\n  ready_3 =~ NA*loadr1*READY31 + loadr2*READY32 + loadr3*READY33\n  \n  commit_1 =~ NA*loadc1*COMMIT11 + loadc2*COMMIT12 + loadc3*COMMIT13\n  commit_2 =~ NA*loadc1*COMMIT21 + loadc2*COMMIT22 + loadc3*COMMIT23\n  commit_3 =~ NA*loadc1*COMMIT31 + loadc2*COMMIT32 + loadc3*COMMIT33\n  \n  # Factor Identification: Standardize Factors at T1\n  \n  ## Fix Factor Means at T1 to Zero\n  jobsat_1 ~ 0*1\n  ready_1 ~ 0*1\n  commit_1 ~ 0*1\n  \n  ## Fix Factor Variances at T1 to One\n  jobsat_1 ~~ 1*jobsat_1\n  ready_1 ~~ 1*ready_1\n  commit_1 ~~ 1*commit_1\n  \n  # Freely Estimate Factor Means at T2 and T3 (relative to T1)\n  jobsat_2 ~ 1\n  jobsat_3 ~ 1\n  \n  ready_2 ~ 1\n  ready_3 ~ 1\n  \n  commit_2 ~ 1\n  commit_3 ~ 1\n  \n  # Freely Estimate Factor Variances at T2 and T3 (relative to T1)\n  jobsat_2 ~~ jobsat_2\n  jobsat_3 ~~ jobsat_3\n  \n  ready_2 ~~ ready_2\n  ready_3 ~~ ready_3\n  \n  commit_2 ~~ commit_2\n  commit_3 ~~ commit_3\n  \n  # Fix Intercepts of Indicator 1 Across Time\n  JOBSAT11 ~ intj1*1\n  JOBSAT21 ~ intj1*1\n  JOBSAT31 ~ intj1*1\n  \n  READY11 ~ intr1*1\n  READY21 ~ intr1*1\n  READY31 ~ intr1*1\n  \n  COMMIT11 ~ intc1*1\n  COMMIT21 ~ intc1*1\n  COMMIT31 ~ intc1*1\n  \n  # Free Intercepts of Remaining Manifest Variables\n  JOBSAT12 ~ 1\n  JOBSAT13 ~ 1\n  JOBSAT22 ~ 1\n  JOBSAT23 ~ 1\n  JOBSAT32 ~ 1\n  JOBSAT33 ~ 1\n  \n  READY12 ~ 1\n  READY13 ~ 1\n  READY22 ~ 1\n  READY23 ~ 1\n  READY32 ~ 1\n  READY33 ~ 1\n  \n  COMMIT12 ~ 1\n  COMMIT13 ~ 1\n  COMMIT22 ~ 1\n  COMMIT23 ~ 1\n  COMMIT32 ~ 1\n  COMMIT33 ~ 1\n  \n  # Estimate Residual Variances of Manifest Variables\n  JOBSAT11 ~~ JOBSAT11\n  JOBSAT12 ~~ JOBSAT12\n  JOBSAT13 ~~ JOBSAT13\n  JOBSAT21 ~~ JOBSAT21\n  JOBSAT22 ~~ JOBSAT22\n  JOBSAT23 ~~ JOBSAT23\n  JOBSAT31 ~~ JOBSAT31\n  JOBSAT32 ~~ JOBSAT32\n  JOBSAT33 ~~ JOBSAT33\n  \n  READY11 ~~ READY11\n  READY12 ~~ READY12\n  READY13 ~~ READY13\n  READY21 ~~ READY21\n  READY22 ~~ READY22\n  READY23 ~~ READY23\n  READY31 ~~ READY31\n  READY32 ~~ READY32\n  READY33 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT11\n  COMMIT12 ~~ COMMIT12\n  COMMIT13 ~~ COMMIT13\n  COMMIT21 ~~ COMMIT21\n  COMMIT22 ~~ COMMIT22\n  COMMIT23 ~~ COMMIT23\n  COMMIT31 ~~ COMMIT31\n  COMMIT32 ~~ COMMIT32\n  COMMIT33 ~~ COMMIT33\n  \n  # Residual Covariances Within Indicator Across Time\n  JOBSAT11 ~~ JOBSAT21\n  JOBSAT21 ~~ JOBSAT31\n  JOBSAT11 ~~ JOBSAT31\n  \n  JOBSAT12 ~~ JOBSAT22\n  JOBSAT22 ~~ JOBSAT32\n  JOBSAT12 ~~ JOBSAT32\n  \n  JOBSAT13 ~~ JOBSAT23\n  JOBSAT23 ~~ JOBSAT33\n  JOBSAT13 ~~ JOBSAT33\n  \n  READY11 ~~ READY21\n  READY21 ~~ READY31\n  READY11 ~~ READY31\n  \n  READY12 ~~ READY22\n  READY22 ~~ READY32\n  READY12 ~~ READY32\n  \n  READY13 ~~ READY23\n  READY23 ~~ READY33\n  READY13 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT21\n  COMMIT21 ~~ COMMIT31\n  COMMIT11 ~~ COMMIT31\n  \n  COMMIT12 ~~ COMMIT22\n  COMMIT22 ~~ COMMIT32\n  COMMIT12 ~~ COMMIT32\n  \n  COMMIT13 ~~ COMMIT23\n  COMMIT23 ~~ COMMIT33\n  COMMIT13 ~~ COMMIT33\n'\n\n\n\n14.3.2 Fit Model\n\nCodemetricInvariance_fit &lt;- cfa(\n  metricInvariance_syntax,\n  data = longitudinalMI,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  #std.lv = TRUE,\n  fixed.x = FALSE)\n\n\n\n14.3.3 Model Summary\n\nCodesummary(\n  metricInvariance_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 91 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                       156\n  Number of equality constraints                    24\n\n  Number of observations                           495\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                               286.159     292.814\n  Degrees of freedom                               273         273\n  P-value (Chi-square)                           0.280       0.196\n  Scaling correction factor                                  0.977\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              6697.063    6541.933\n  Degrees of freedom                               351         351\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.024\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.998       0.997\n  Tucker-Lewis Index (TLI)                       0.997       0.996\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.997\n  Robust Tucker-Lewis Index (TLI)                            0.996\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)             -17474.443  -17474.443\n  Scaling correction factor                                  0.880\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)     -17331.363  -17331.363\n  Scaling correction factor                                  0.998\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               35212.885   35212.885\n  Bayesian (BIC)                             35767.887   35767.887\n  Sample-size adjusted Bayesian (SABIC)      35348.916   35348.916\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.010       0.012\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.021       0.022\n  P-value H_0: RMSEA &lt;= 0.050                    1.000       1.000\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.012\n  90 Percent confidence interval - lower                     0.000\n  90 Percent confidence interval - upper                     0.022\n  P-value H_0: Robust RMSEA &lt;= 0.050                         1.000\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.024       0.024\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  jobsat_1 =~                                                           \n    JOBSAT1 (ldj1)    0.974    0.036   26.751    0.000    0.974    0.807\n    JOBSAT1 (ldj2)    0.995    0.035   28.661    0.000    0.995    0.801\n    JOBSAT1 (ldj3)    0.995    0.036   27.941    0.000    0.995    0.819\n  jobsat_2 =~                                                           \n    JOBSAT2 (ldj1)    0.974    0.036   26.751    0.000    0.937    0.781\n    JOBSAT2 (ldj2)    0.995    0.035   28.661    0.000    0.957    0.803\n    JOBSAT2 (ldj3)    0.995    0.036   27.941    0.000    0.957    0.797\n  jobsat_3 =~                                                           \n    JOBSAT3 (ldj1)    0.974    0.036   26.751    0.000    0.866    0.778\n    JOBSAT3 (ldj2)    0.995    0.035   28.661    0.000    0.884    0.793\n    JOBSAT3 (ldj3)    0.995    0.036   27.941    0.000    0.884    0.783\n  ready_1 =~                                                            \n    READY11 (ldr1)    0.930    0.036   25.486    0.000    0.930    0.797\n    READY12 (ldr2)    0.850    0.036   23.877    0.000    0.850    0.748\n    READY13 (ldr3)    0.899    0.036   24.965    0.000    0.899    0.785\n  ready_2 =~                                                            \n    READY21 (ldr1)    0.930    0.036   25.486    0.000    0.916    0.779\n    READY22 (ldr2)    0.850    0.036   23.877    0.000    0.837    0.737\n    READY23 (ldr3)    0.899    0.036   24.965    0.000    0.886    0.763\n  ready_3 =~                                                            \n    READY31 (ldr1)    0.930    0.036   25.486    0.000    0.893    0.773\n    READY32 (ldr2)    0.850    0.036   23.877    0.000    0.816    0.743\n    READY33 (ldr3)    0.899    0.036   24.965    0.000    0.864    0.756\n  commit_1 =~                                                           \n    COMMIT1 (ldc1)    0.807    0.036   22.195    0.000    0.807    0.749\n    COMMIT1 (ldc2)    0.807    0.036   22.194    0.000    0.807    0.744\n    COMMIT1 (ldc3)    0.826    0.036   22.787    0.000    0.826    0.759\n  commit_2 =~                                                           \n    COMMIT2 (ldc1)    0.807    0.036   22.195    0.000    0.870    0.778\n    COMMIT2 (ldc2)    0.807    0.036   22.194    0.000    0.870    0.773\n    COMMIT2 (ldc3)    0.826    0.036   22.787    0.000    0.891    0.773\n  commit_3 =~                                                           \n    COMMIT3 (ldc1)    0.807    0.036   22.195    0.000    0.758    0.741\n    COMMIT3 (ldc2)    0.807    0.036   22.194    0.000    0.758    0.720\n    COMMIT3 (ldc3)    0.826    0.036   22.787    0.000    0.776    0.727\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .JOBSAT11 ~~                                                           \n   .JOBSAT21          0.118    0.032    3.655    0.000    0.118    0.222\n .JOBSAT21 ~~                                                           \n   .JOBSAT31          0.123    0.032    3.905    0.000    0.123    0.235\n .JOBSAT11 ~~                                                           \n   .JOBSAT31          0.151    0.029    5.126    0.000    0.151    0.303\n .JOBSAT12 ~~                                                           \n   .JOBSAT22          0.155    0.034    4.560    0.000    0.155    0.293\n .JOBSAT22 ~~                                                           \n   .JOBSAT32          0.095    0.030    3.160    0.002    0.095    0.196\n .JOBSAT12 ~~                                                           \n   .JOBSAT32          0.075    0.032    2.345    0.019    0.075    0.148\n .JOBSAT13 ~~                                                           \n   .JOBSAT23          0.090    0.033    2.714    0.007    0.090    0.179\n .JOBSAT23 ~~                                                           \n   .JOBSAT33          0.147    0.033    4.402    0.000    0.147    0.290\n .JOBSAT13 ~~                                                           \n   .JOBSAT33          0.114    0.031    3.647    0.000    0.114    0.233\n .READY11 ~~                                                            \n   .READY21           0.136    0.033    4.094    0.000    0.136    0.262\n .READY21 ~~                                                            \n   .READY31           0.107    0.032    3.357    0.001    0.107    0.198\n .READY11 ~~                                                            \n   .READY31           0.099    0.033    2.987    0.003    0.099    0.191\n .READY12 ~~                                                            \n   .READY22           0.181    0.033    5.396    0.000    0.181    0.312\n .READY22 ~~                                                            \n   .READY32           0.173    0.037    4.647    0.000    0.173    0.306\n .READY12 ~~                                                            \n   .READY32           0.120    0.034    3.548    0.000    0.120    0.217\n .READY13 ~~                                                            \n   .READY23           0.133    0.033    4.032    0.000    0.133    0.251\n .READY23 ~~                                                            \n   .READY33           0.168    0.035    4.860    0.000    0.168    0.300\n .READY13 ~~                                                            \n   .READY33           0.117    0.033    3.586    0.000    0.117    0.220\n .COMMIT11 ~~                                                           \n   .COMMIT21          0.122    0.032    3.872    0.000    0.122    0.244\n .COMMIT21 ~~                                                           \n   .COMMIT31          0.142    0.031    4.587    0.000    0.142    0.294\n .COMMIT11 ~~                                                           \n   .COMMIT31          0.110    0.029    3.732    0.000    0.110    0.225\n .COMMIT12 ~~                                                           \n   .COMMIT22          0.101    0.032    3.144    0.002    0.101    0.194\n .COMMIT22 ~~                                                           \n   .COMMIT32          0.119    0.033    3.576    0.000    0.119    0.228\n .COMMIT12 ~~                                                           \n   .COMMIT32          0.084    0.031    2.743    0.006    0.084    0.159\n .COMMIT13 ~~                                                           \n   .COMMIT23          0.171    0.034    5.073    0.000    0.171    0.329\n .COMMIT23 ~~                                                           \n   .COMMIT33          0.150    0.031    4.856    0.000    0.150    0.279\n .COMMIT13 ~~                                                           \n   .COMMIT33          0.111    0.033    3.399    0.001    0.111    0.213\n  jobsat_1 ~~                                                           \n    jobsat_2          0.388    0.054    7.125    0.000    0.403    0.403\n    jobsat_3          0.292    0.050    5.802    0.000    0.328    0.328\n    ready_1           0.541    0.050   10.817    0.000    0.541    0.541\n    ready_2           0.272    0.057    4.748    0.000    0.276    0.276\n    ready_3           0.175    0.055    3.167    0.002    0.182    0.182\n    commit_1          0.580    0.047   12.416    0.000    0.580    0.580\n    commit_2          0.388    0.061    6.394    0.000    0.360    0.360\n    commit_3          0.230    0.054    4.230    0.000    0.245    0.245\n  jobsat_2 ~~                                                           \n    jobsat_3          0.348    0.052    6.634    0.000    0.407    0.407\n    ready_1           0.200    0.056    3.585    0.000    0.208    0.208\n    ready_2           0.480    0.060    8.037    0.000    0.507    0.507\n    ready_3           0.191    0.054    3.512    0.000    0.206    0.206\n    commit_1          0.278    0.055    5.091    0.000    0.289    0.289\n    commit_2          0.595    0.068    8.732    0.000    0.574    0.574\n    commit_3          0.254    0.057    4.415    0.000    0.281    0.281\n  jobsat_3 ~~                                                           \n    ready_1           0.206    0.047    4.372    0.000    0.232    0.232\n    ready_2           0.264    0.051    5.190    0.000    0.302    0.302\n    ready_3           0.454    0.056    8.182    0.000    0.532    0.532\n    commit_1          0.192    0.052    3.674    0.000    0.216    0.216\n    commit_2          0.283    0.058    4.889    0.000    0.295    0.295\n    commit_3          0.486    0.056    8.666    0.000    0.582    0.582\n  ready_1 ~~                                                            \n    ready_2           0.316    0.061    5.203    0.000    0.320    0.320\n    ready_3           0.270    0.056    4.797    0.000    0.281    0.281\n    commit_1          0.455    0.050    9.178    0.000    0.455    0.455\n    commit_2          0.289    0.064    4.502    0.000    0.268    0.268\n    commit_3          0.223    0.056    3.994    0.000    0.237    0.237\n  ready_2 ~~                                                            \n    ready_3           0.413    0.061    6.751    0.000    0.437    0.437\n    commit_1          0.255    0.057    4.444    0.000    0.259    0.259\n    commit_2          0.660    0.071    9.283    0.000    0.622    0.622\n    commit_3          0.282    0.058    4.863    0.000    0.305    0.305\n  ready_3 ~~                                                            \n    commit_1          0.175    0.058    3.031    0.002    0.182    0.182\n    commit_2          0.303    0.063    4.776    0.000    0.293    0.293\n    commit_3          0.435    0.060    7.264    0.000    0.482    0.482\n  commit_1 ~~                                                           \n    commit_2          0.579    0.059    9.790    0.000    0.537    0.537\n    commit_3          0.369    0.056    6.590    0.000    0.393    0.393\n  commit_2 ~~                                                           \n    commit_3          0.518    0.075    6.929    0.000    0.511    0.511\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jbst_1            0.000                               0.000    0.000\n    redy_1            0.000                               0.000    0.000\n    cmmt_1            0.000                               0.000    0.000\n    jbst_2            0.000    0.063    0.000    1.000    0.000    0.000\n    jbst_3            0.129    0.061    2.103    0.035    0.145    0.145\n    redy_2            0.054    0.068    0.801    0.423    0.055    0.055\n    redy_3            0.198    0.070    2.818    0.005    0.206    0.206\n    cmmt_2           -0.200    0.068   -2.937    0.003   -0.186   -0.186\n    cmmt_3           -0.173    0.070   -2.473    0.013   -0.184   -0.184\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.751\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.767\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.984\n   .READY1 (intr1)    3.176    0.052   61.296    0.000    3.176    2.722\n   .READY2 (intr1)    3.176    0.052   61.296    0.000    3.176    2.701\n   .READY3 (intr1)    3.176    0.052   61.296    0.000    3.176    2.747\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.454\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.326\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.639\n   .JOBSAT            3.311    0.056   58.833    0.000    3.311    2.668\n   .JOBSAT            3.321    0.054   61.701    0.000    3.321    2.734\n   .JOBSAT            3.331    0.068   49.283    0.000    3.331    2.796\n   .JOBSAT            3.329    0.069   48.075    0.000    3.329    2.775\n   .JOBSAT            3.276    0.065   50.125    0.000    3.276    2.939\n   .JOBSAT            3.258    0.067   48.848    0.000    3.258    2.885\n   .READY1            3.198    0.052   61.778    0.000    3.198    2.816\n   .READY1            3.156    0.052   61.219    0.000    3.156    2.755\n   .READY2            3.168    0.063   50.350    0.000    3.168    2.787\n   .READY2            3.208    0.064   49.907    0.000    3.208    2.765\n   .READY3            3.161    0.064   49.723    0.000    3.161    2.877\n   .READY3            3.150    0.067   46.681    0.000    3.150    2.756\n   .COMMIT            3.653    0.049   74.419    0.000    3.653    3.368\n   .COMMIT            3.596    0.049   73.962    0.000    3.596    3.302\n   .COMMIT            3.687    0.063   58.086    0.000    3.687    3.273\n   .COMMIT            3.654    0.065   56.470    0.000    3.654    3.171\n   .COMMIT            3.756    0.063   59.858    0.000    3.756    3.565\n   .COMMIT            3.694    0.065   57.102    0.000    3.694    3.458\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jobsat_1          1.000                               1.000    1.000\n    ready_1           1.000                               1.000    1.000\n    commit_1          1.000                               1.000    1.000\n    jobsat_2          0.925    0.070   13.235    0.000    1.000    1.000\n    jobsat_3          0.789    0.068   11.639    0.000    1.000    1.000\n    ready_2           0.971    0.083   11.740    0.000    1.000    1.000\n    ready_3           0.922    0.082   11.302    0.000    1.000    1.000\n    commit_2          1.163    0.113   10.320    0.000    1.000    1.000\n    commit_3          0.882    0.092    9.612    0.000    1.000    1.000\n   .JOBSAT11          0.507    0.048   10.579    0.000    0.507    0.348\n   .JOBSAT12          0.551    0.046   11.972    0.000    0.551    0.358\n   .JOBSAT13          0.486    0.044   10.964    0.000    0.486    0.329\n   .JOBSAT21          0.561    0.049   11.404    0.000    0.561    0.390\n   .JOBSAT22          0.505    0.047   10.776    0.000    0.505    0.355\n   .JOBSAT23          0.524    0.050   10.578    0.000    0.524    0.364\n   .JOBSAT31          0.488    0.040   12.241    0.000    0.488    0.394\n   .JOBSAT32          0.462    0.040   11.493    0.000    0.462    0.371\n   .JOBSAT33          0.494    0.044   11.169    0.000    0.494    0.387\n   .READY11           0.496    0.049   10.188    0.000    0.496    0.364\n   .READY12           0.567    0.045   12.740    0.000    0.567    0.440\n   .READY13           0.504    0.045   11.200    0.000    0.504    0.384\n   .READY21           0.543    0.050   10.947    0.000    0.543    0.393\n   .READY22           0.591    0.049   12.168    0.000    0.591    0.457\n   .READY23           0.561    0.051   10.951    0.000    0.561    0.417\n   .READY31           0.539    0.050   10.779    0.000    0.539    0.403\n   .READY32           0.540    0.046   11.793    0.000    0.540    0.448\n   .READY33           0.560    0.044   12.583    0.000    0.560    0.429\n   .COMMIT11          0.509    0.048   10.659    0.000    0.509    0.439\n   .COMMIT12          0.525    0.044   11.823    0.000    0.525    0.446\n   .COMMIT13          0.503    0.046   10.913    0.000    0.503    0.424\n   .COMMIT21          0.494    0.045   10.965    0.000    0.494    0.395\n   .COMMIT22          0.512    0.047   10.936    0.000    0.512    0.403\n   .COMMIT23          0.535    0.049   10.865    0.000    0.535    0.402\n   .COMMIT31          0.470    0.041   11.504    0.000    0.470    0.450\n   .COMMIT32          0.535    0.052   10.214    0.000    0.535    0.482\n   .COMMIT33          0.539    0.046   11.644    0.000    0.539    0.472\n\nR-Square:\n                   Estimate\n    JOBSAT11          0.652\n    JOBSAT12          0.642\n    JOBSAT13          0.671\n    JOBSAT21          0.610\n    JOBSAT22          0.645\n    JOBSAT23          0.636\n    JOBSAT31          0.606\n    JOBSAT32          0.629\n    JOBSAT33          0.613\n    READY11           0.636\n    READY12           0.560\n    READY13           0.616\n    READY21           0.607\n    READY22           0.543\n    READY23           0.583\n    READY31           0.597\n    READY32           0.552\n    READY33           0.571\n    COMMIT11          0.561\n    COMMIT12          0.554\n    COMMIT13          0.576\n    COMMIT21          0.605\n    COMMIT22          0.597\n    COMMIT23          0.598\n    COMMIT31          0.550\n    COMMIT32          0.518\n    COMMIT33          0.528\n\n\n\n14.3.4 Modification Indices\n\nCodemodificationindices(\n  metricInvariance_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n14.3.5 Path Diagram\n\nCodelavaanPlot::lavaanPlot2(\n  metricInvariance_fit,\n  stand = TRUE,\n  coef_labels = TRUE)\n\n\nPath Diagram\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(metricInvariance_fit)\n\n\n\n14.3.6 Compare Models\n\nCodeanova(\n  configuralInvarianceCorrelatedResiduals_fit,\n  metricInvariance_fit\n)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#scalar-strong-factorial-invariance",
    "href": "sem.html#scalar-strong-factorial-invariance",
    "title": "Structural Equation Modeling",
    "section": "\n14.4 Scalar (“Strong Factorial”) Invariance",
    "text": "14.4 Scalar (“Strong Factorial”) Invariance\nEvaluates whether the items’ intercepts are the same across time.\n\nStandardize the latent factor(s) at T1 (i.e., fix the mean to zero and the variance to one)\nAllow within-indicator residuals to covary across time\nFor each indicator, constrain its factor loading to be the same across time\nFor each indicator, constrain its intercept to be the same across time\n\n\n14.4.1 Model Syntax\n\nCodescalarInvariance_syntax &lt;- '\n  # Factor Loadings\n  jobsat_1 =~ NA*loadj1*JOBSAT11 + loadj2*JOBSAT12 + loadj3*JOBSAT13\n  jobsat_2 =~ NA*loadj1*JOBSAT21 + loadj2*JOBSAT22 + loadj3*JOBSAT23\n  jobsat_3 =~ NA*loadj1*JOBSAT31 + loadj2*JOBSAT32 + loadj3*JOBSAT33\n  \n  ready_1 =~ NA*loadr1*READY11 + loadr2*READY12 + loadr3*READY13\n  ready_2 =~ NA*loadr1*READY21 + loadr2*READY22 + loadr3*READY23\n  ready_3 =~ NA*loadr1*READY31 + loadr2*READY32 + loadr3*READY33\n  \n  commit_1 =~ NA*loadc1*COMMIT11 + loadc2*COMMIT12 + loadc3*COMMIT13\n  commit_2 =~ NA*loadc1*COMMIT21 + loadc2*COMMIT22 + loadc3*COMMIT23\n  commit_3 =~ NA*loadc1*COMMIT31 + loadc2*COMMIT32 + loadc3*COMMIT33\n  \n  # Factor Identification: Standardize Factors at T1\n  \n  ## Fix Factor Means at T1 to Zero\n  jobsat_1 ~ 0*1\n  ready_1 ~ 0*1\n  commit_1 ~ 0*1\n  \n  ## Fix Factor Variances at T1 to One\n  jobsat_1 ~~ 1*jobsat_1\n  ready_1 ~~ 1*ready_1\n  commit_1 ~~ 1*commit_1\n  \n  # Freely Estimate Factor Means at T2 and T3 (relative to T1)\n  jobsat_2 ~ 1\n  jobsat_3 ~ 1\n  \n  ready_2 ~ 1\n  ready_3 ~ 1\n  \n  commit_2 ~ 1\n  commit_3 ~ 1\n  \n  # Freely Estimate Factor Variances at T2 and T3 (relative to T1)\n  jobsat_2 ~~ jobsat_2\n  jobsat_3 ~~ jobsat_3\n  \n  ready_2 ~~ ready_2\n  ready_3 ~~ ready_3\n  \n  commit_2 ~~ commit_2\n  commit_3 ~~ commit_3\n  \n  # Fix Intercepts of Indicators Across Time\n  JOBSAT11 ~ intj1*1\n  JOBSAT21 ~ intj1*1\n  JOBSAT31 ~ intj1*1\n  JOBSAT12 ~ intj2*1\n  JOBSAT22 ~ intj2*1\n  JOBSAT32 ~ intj2*1\n  JOBSAT13 ~ intj3*1\n  JOBSAT23 ~ intj3*1\n  JOBSAT33 ~ intj3*1\n  \n  READY11 ~ intr1*1\n  READY21 ~ intr1*1\n  READY31 ~ intr1*1\n  READY12 ~ intr2*1\n  READY22 ~ intr2*1\n  READY32 ~ intr2*1\n  READY13 ~ intr3*1\n  READY23 ~ intr3*1\n  READY33 ~ intr3*1\n  \n  COMMIT11 ~ intc1*1\n  COMMIT21 ~ intc1*1\n  COMMIT31 ~ intc1*1\n  COMMIT12 ~ intc2*1\n  COMMIT22 ~ intc2*1\n  COMMIT32 ~ intc2*1\n  COMMIT13 ~ intc3*1\n  COMMIT23 ~ intc3*1\n  COMMIT33 ~ intc3*1\n  \n  # Estimate Residual Variances of Manifest Variables\n  JOBSAT11 ~~ JOBSAT11\n  JOBSAT12 ~~ JOBSAT12\n  JOBSAT13 ~~ JOBSAT13\n  JOBSAT21 ~~ JOBSAT21\n  JOBSAT22 ~~ JOBSAT22\n  JOBSAT23 ~~ JOBSAT23\n  JOBSAT31 ~~ JOBSAT31\n  JOBSAT32 ~~ JOBSAT32\n  JOBSAT33 ~~ JOBSAT33\n  \n  READY11 ~~ READY11\n  READY12 ~~ READY12\n  READY13 ~~ READY13\n  READY21 ~~ READY21\n  READY22 ~~ READY22\n  READY23 ~~ READY23\n  READY31 ~~ READY31\n  READY32 ~~ READY32\n  READY33 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT11\n  COMMIT12 ~~ COMMIT12\n  COMMIT13 ~~ COMMIT13\n  COMMIT21 ~~ COMMIT21\n  COMMIT22 ~~ COMMIT22\n  COMMIT23 ~~ COMMIT23\n  COMMIT31 ~~ COMMIT31\n  COMMIT32 ~~ COMMIT32\n  COMMIT33 ~~ COMMIT33\n  \n  # Residual Covariances Within Indicator Across Time\n  JOBSAT11 ~~ JOBSAT21\n  JOBSAT21 ~~ JOBSAT31\n  JOBSAT11 ~~ JOBSAT31\n  \n  JOBSAT12 ~~ JOBSAT22\n  JOBSAT22 ~~ JOBSAT32\n  JOBSAT12 ~~ JOBSAT32\n  \n  JOBSAT13 ~~ JOBSAT23\n  JOBSAT23 ~~ JOBSAT33\n  JOBSAT13 ~~ JOBSAT33\n  \n  READY11 ~~ READY21\n  READY21 ~~ READY31\n  READY11 ~~ READY31\n  \n  READY12 ~~ READY22\n  READY22 ~~ READY32\n  READY12 ~~ READY32\n  \n  READY13 ~~ READY23\n  READY23 ~~ READY33\n  READY13 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT21\n  COMMIT21 ~~ COMMIT31\n  COMMIT11 ~~ COMMIT31\n  \n  COMMIT12 ~~ COMMIT22\n  COMMIT22 ~~ COMMIT32\n  COMMIT12 ~~ COMMIT32\n  \n  COMMIT13 ~~ COMMIT23\n  COMMIT23 ~~ COMMIT33\n  COMMIT13 ~~ COMMIT33\n'\n\n\n\n14.4.2 Fit Model\n\nCodescalarInvariance_fit &lt;- cfa(\n  scalarInvariance_syntax,\n  data = longitudinalMI,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  #std.lv = TRUE,\n  fixed.x = FALSE)\n\n\n\n14.4.3 Model Summary\n\nCodesummary(\n  scalarInvariance_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 82 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                       156\n  Number of equality constraints                    36\n\n  Number of observations                           495\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                               295.447     302.078\n  Degrees of freedom                               285         285\n  P-value (Chi-square)                           0.323       0.233\n  Scaling correction factor                                  0.978\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              6697.063    6541.933\n  Degrees of freedom                               351         351\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.024\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.998       0.997\n  Tucker-Lewis Index (TLI)                       0.998       0.997\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.997\n  Robust Tucker-Lewis Index (TLI)                            0.997\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)             -17479.087  -17479.087\n  Scaling correction factor                                  0.803\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)     -17331.363  -17331.363\n  Scaling correction factor                                  0.998\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               35198.174   35198.174\n  Bayesian (BIC)                             35702.721   35702.721\n  Sample-size adjusted Bayesian (SABIC)      35321.838   35321.838\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.009       0.011\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.020       0.021\n  P-value H_0: RMSEA &lt;= 0.050                    1.000       1.000\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.011\n  90 Percent confidence interval - lower                     0.000\n  90 Percent confidence interval - upper                     0.021\n  P-value H_0: Robust RMSEA &lt;= 0.050                         1.000\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.024       0.024\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  jobsat_1 =~                                                           \n    JOBSAT1 (ldj1)    0.976    0.037   26.623    0.000    0.976    0.808\n    JOBSAT1 (ldj2)    0.995    0.035   28.636    0.000    0.995    0.801\n    JOBSAT1 (ldj3)    0.994    0.036   27.967    0.000    0.994    0.818\n  jobsat_2 =~                                                           \n    JOBSAT2 (ldj1)    0.976    0.037   26.623    0.000    0.938    0.782\n    JOBSAT2 (ldj2)    0.995    0.035   28.636    0.000    0.957    0.803\n    JOBSAT2 (ldj3)    0.994    0.036   27.967    0.000    0.955    0.797\n  jobsat_3 =~                                                           \n    JOBSAT3 (ldj1)    0.976    0.037   26.623    0.000    0.867    0.779\n    JOBSAT3 (ldj2)    0.995    0.035   28.636    0.000    0.884    0.793\n    JOBSAT3 (ldj3)    0.994    0.036   27.967    0.000    0.883    0.782\n  ready_1 =~                                                            \n    READY11 (ldr1)    0.931    0.036   25.577    0.000    0.931    0.798\n    READY12 (ldr2)    0.849    0.035   23.920    0.000    0.849    0.748\n    READY13 (ldr3)    0.899    0.036   24.972    0.000    0.899    0.785\n  ready_2 =~                                                            \n    READY21 (ldr1)    0.931    0.036   25.577    0.000    0.918    0.780\n    READY22 (ldr2)    0.849    0.035   23.920    0.000    0.836    0.736\n    READY23 (ldr3)    0.899    0.036   24.972    0.000    0.885    0.763\n  ready_3 =~                                                            \n    READY31 (ldr1)    0.931    0.036   25.577    0.000    0.895    0.773\n    READY32 (ldr2)    0.849    0.035   23.920    0.000    0.815    0.742\n    READY33 (ldr3)    0.899    0.036   24.972    0.000    0.863    0.756\n  commit_1 =~                                                           \n    COMMIT1 (ldc1)    0.808    0.036   22.359    0.000    0.808    0.750\n    COMMIT1 (ldc2)    0.807    0.036   22.218    0.000    0.807    0.744\n    COMMIT1 (ldc3)    0.824    0.037   22.501    0.000    0.824    0.758\n  commit_2 =~                                                           \n    COMMIT2 (ldc1)    0.808    0.036   22.359    0.000    0.872    0.779\n    COMMIT2 (ldc2)    0.807    0.036   22.218    0.000    0.870    0.772\n    COMMIT2 (ldc3)    0.824    0.037   22.501    0.000    0.889    0.772\n  commit_3 =~                                                           \n    COMMIT3 (ldc1)    0.808    0.036   22.359    0.000    0.759    0.742\n    COMMIT3 (ldc2)    0.807    0.036   22.218    0.000    0.758    0.719\n    COMMIT3 (ldc3)    0.824    0.037   22.501    0.000    0.774    0.725\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .JOBSAT11 ~~                                                           \n   .JOBSAT21          0.118    0.032    3.644    0.000    0.118    0.222\n .JOBSAT21 ~~                                                           \n   .JOBSAT31          0.122    0.031    3.880    0.000    0.122    0.233\n .JOBSAT11 ~~                                                           \n   .JOBSAT31          0.150    0.029    5.127    0.000    0.150    0.302\n .JOBSAT12 ~~                                                           \n   .JOBSAT22          0.154    0.034    4.555    0.000    0.154    0.293\n .JOBSAT22 ~~                                                           \n   .JOBSAT32          0.095    0.030    3.166    0.002    0.095    0.196\n .JOBSAT12 ~~                                                           \n   .JOBSAT32          0.075    0.032    2.348    0.019    0.075    0.148\n .JOBSAT13 ~~                                                           \n   .JOBSAT23          0.090    0.033    2.723    0.006    0.090    0.179\n .JOBSAT23 ~~                                                           \n   .JOBSAT33          0.147    0.033    4.398    0.000    0.147    0.289\n .JOBSAT13 ~~                                                           \n   .JOBSAT33          0.114    0.031    3.637    0.000    0.114    0.232\n .READY11 ~~                                                            \n   .READY21           0.136    0.033    4.092    0.000    0.136    0.263\n .READY21 ~~                                                            \n   .READY31           0.107    0.032    3.338    0.001    0.107    0.198\n .READY11 ~~                                                            \n   .READY31           0.099    0.033    2.988    0.003    0.099    0.191\n .READY12 ~~                                                            \n   .READY22           0.180    0.033    5.381    0.000    0.180    0.311\n .READY22 ~~                                                            \n   .READY32           0.173    0.037    4.660    0.000    0.173    0.306\n .READY12 ~~                                                            \n   .READY32           0.120    0.034    3.545    0.000    0.120    0.217\n .READY13 ~~                                                            \n   .READY23           0.133    0.033    4.024    0.000    0.133    0.249\n .READY23 ~~                                                            \n   .READY33           0.168    0.035    4.859    0.000    0.168    0.299\n .READY13 ~~                                                            \n   .READY33           0.117    0.033    3.590    0.000    0.117    0.221\n .COMMIT11 ~~                                                           \n   .COMMIT21          0.122    0.032    3.852    0.000    0.122    0.243\n .COMMIT21 ~~                                                           \n   .COMMIT31          0.141    0.031    4.556    0.000    0.141    0.293\n .COMMIT11 ~~                                                           \n   .COMMIT31          0.108    0.029    3.659    0.000    0.108    0.220\n .COMMIT12 ~~                                                           \n   .COMMIT22          0.101    0.032    3.152    0.002    0.101    0.195\n .COMMIT22 ~~                                                           \n   .COMMIT32          0.119    0.033    3.561    0.000    0.119    0.227\n .COMMIT12 ~~                                                           \n   .COMMIT32          0.084    0.031    2.723    0.006    0.084    0.158\n .COMMIT13 ~~                                                           \n   .COMMIT23          0.171    0.034    5.070    0.000    0.171    0.329\n .COMMIT23 ~~                                                           \n   .COMMIT33          0.150    0.031    4.877    0.000    0.150    0.279\n .COMMIT13 ~~                                                           \n   .COMMIT33          0.111    0.033    3.391    0.001    0.111    0.212\n  jobsat_1 ~~                                                           \n    jobsat_2          0.388    0.054    7.126    0.000    0.404    0.404\n    jobsat_3          0.292    0.050    5.807    0.000    0.329    0.329\n    ready_1           0.541    0.050   10.820    0.000    0.541    0.541\n    ready_2           0.272    0.057    4.747    0.000    0.276    0.276\n    ready_3           0.175    0.055    3.168    0.002    0.182    0.182\n    commit_1          0.580    0.047   12.420    0.000    0.580    0.580\n    commit_2          0.389    0.061    6.398    0.000    0.360    0.360\n    commit_3          0.230    0.054    4.229    0.000    0.245    0.245\n  jobsat_2 ~~                                                           \n    jobsat_3          0.348    0.052    6.639    0.000    0.408    0.408\n    ready_1           0.200    0.056    3.587    0.000    0.208    0.208\n    ready_2           0.480    0.060    8.036    0.000    0.507    0.507\n    ready_3           0.191    0.054    3.512    0.000    0.206    0.206\n    commit_1          0.278    0.055    5.091    0.000    0.289    0.289\n    commit_2          0.595    0.068    8.731    0.000    0.574    0.574\n    commit_3          0.254    0.058    4.414    0.000    0.281    0.281\n  jobsat_3 ~~                                                           \n    ready_1           0.206    0.047    4.373    0.000    0.232    0.232\n    ready_2           0.264    0.051    5.189    0.000    0.302    0.302\n    ready_3           0.454    0.056    8.183    0.000    0.532    0.532\n    commit_1          0.192    0.052    3.674    0.000    0.216    0.216\n    commit_2          0.283    0.058    4.894    0.000    0.295    0.295\n    commit_3          0.486    0.056    8.665    0.000    0.582    0.582\n  ready_1 ~~                                                            \n    ready_2           0.316    0.061    5.203    0.000    0.320    0.320\n    ready_3           0.270    0.056    4.795    0.000    0.281    0.281\n    commit_1          0.455    0.050    9.179    0.000    0.455    0.455\n    commit_2          0.289    0.064    4.500    0.000    0.268    0.268\n    commit_3          0.223    0.056    3.993    0.000    0.237    0.237\n  ready_2 ~~                                                            \n    ready_3           0.413    0.061    6.751    0.000    0.437    0.437\n    commit_1          0.255    0.057    4.445    0.000    0.259    0.259\n    commit_2          0.661    0.071    9.287    0.000    0.622    0.622\n    commit_3          0.282    0.058    4.864    0.000    0.305    0.305\n  ready_3 ~~                                                            \n    commit_1          0.175    0.058    3.031    0.002    0.182    0.182\n    commit_2          0.303    0.063    4.777    0.000    0.293    0.293\n    commit_3          0.435    0.060    7.265    0.000    0.482    0.482\n  commit_1 ~~                                                           \n    commit_2          0.579    0.059    9.789    0.000    0.537    0.537\n    commit_3          0.370    0.056    6.597    0.000    0.394    0.394\n  commit_2 ~~                                                           \n    commit_3          0.518    0.075    6.928    0.000    0.512    0.512\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jbst_1            0.000                               0.000    0.000\n    redy_1            0.000                               0.000    0.000\n    cmmt_1            0.000                               0.000    0.000\n    jbst_2            0.012    0.053    0.218    0.828    0.012    0.012\n    jbst_3            0.096    0.054    1.786    0.074    0.108    0.108\n    redy_2            0.063    0.058    1.090    0.276    0.064    0.064\n    redy_3            0.182    0.060    3.042    0.002    0.190    0.190\n    cmmt_2           -0.161    0.054   -2.979    0.003   -0.149   -0.149\n    cmmt_3           -0.093    0.057   -1.631    0.103   -0.099   -0.099\n   .JOBSAT (intj1)    3.327    0.052   64.001    0.000    3.327    2.755\n   .JOBSAT (intj1)    3.327    0.052   64.001    0.000    3.327    2.771\n   .JOBSAT (intj1)    3.327    0.052   64.001    0.000    3.327    2.988\n   .JOBSAT (intj2)    3.313    0.051   64.904    0.000    3.313    2.669\n   .JOBSAT (intj2)    3.313    0.051   64.904    0.000    3.313    2.780\n   .JOBSAT (intj2)    3.313    0.051   64.904    0.000    3.313    2.972\n   .JOBSAT (intj3)    3.310    0.051   64.290    0.000    3.310    2.726\n   .JOBSAT (intj3)    3.310    0.051   64.290    0.000    3.310    2.761\n   .JOBSAT (intj3)    3.310    0.051   64.290    0.000    3.310    2.933\n   .READY1 (intr1)    3.178    0.049   64.965    0.000    3.178    2.722\n   .READY2 (intr1)    3.178    0.049   64.965    0.000    3.178    2.702\n   .READY3 (intr1)    3.178    0.049   64.965    0.000    3.178    2.747\n   .READY1 (intr2)    3.179    0.048   66.536    0.000    3.179    2.800\n   .READY2 (intr2)    3.179    0.048   66.536    0.000    3.179    2.797\n   .READY3 (intr2)    3.179    0.048   66.536    0.000    3.179    2.895\n   .READY1 (intr3)    3.171    0.049   65.358    0.000    3.171    2.769\n   .READY2 (intr3)    3.171    0.049   65.358    0.000    3.171    2.732\n   .READY3 (intr3)    3.171    0.049   65.358    0.000    3.171    2.776\n   .COMMIT (intc1)    3.687    0.045   82.680    0.000    3.687    3.419\n   .COMMIT (intc1)    3.687    0.045   82.680    0.000    3.687    3.294\n   .COMMIT (intc1)    3.687    0.045   82.680    0.000    3.687    3.602\n   .COMMIT (intc2)    3.666    0.044   83.307    0.000    3.666    3.381\n   .COMMIT (intc2)    3.666    0.044   83.307    0.000    3.666    3.254\n   .COMMIT (intc2)    3.666    0.044   83.307    0.000    3.666    3.479\n   .COMMIT (intc3)    3.615    0.046   78.049    0.000    3.615    3.321\n   .COMMIT (intc3)    3.615    0.046   78.049    0.000    3.615    3.139\n   .COMMIT (intc3)    3.615    0.046   78.049    0.000    3.615    3.386\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jobsat_1          1.000                               1.000    1.000\n    ready_1           1.000                               1.000    1.000\n    commit_1          1.000                               1.000    1.000\n    jobsat_2          0.925    0.070   13.237    0.000    1.000    1.000\n    jobsat_3          0.789    0.068   11.635    0.000    1.000    1.000\n    ready_2           0.971    0.083   11.743    0.000    1.000    1.000\n    ready_3           0.923    0.082   11.303    0.000    1.000    1.000\n    commit_2          1.163    0.113   10.316    0.000    1.000    1.000\n    commit_3          0.882    0.092    9.608    0.000    1.000    1.000\n   .JOBSAT11          0.506    0.048   10.551    0.000    0.506    0.347\n   .JOBSAT12          0.551    0.046   11.974    0.000    0.551    0.358\n   .JOBSAT13          0.487    0.044   10.988    0.000    0.487    0.330\n   .JOBSAT21          0.560    0.049   11.363    0.000    0.560    0.389\n   .JOBSAT22          0.504    0.047   10.779    0.000    0.504    0.355\n   .JOBSAT23          0.525    0.049   10.634    0.000    0.525    0.365\n   .JOBSAT31          0.488    0.040   12.178    0.000    0.488    0.394\n   .JOBSAT32          0.461    0.040   11.449    0.000    0.461    0.371\n   .JOBSAT33          0.495    0.044   11.158    0.000    0.495    0.389\n   .READY11           0.495    0.049   10.174    0.000    0.495    0.363\n   .READY12           0.568    0.044   12.791    0.000    0.568    0.441\n   .READY13           0.504    0.045   11.208    0.000    0.504    0.384\n   .READY21           0.542    0.049   10.953    0.000    0.542    0.391\n   .READY22           0.592    0.049   12.185    0.000    0.592    0.458\n   .READY23           0.563    0.051   10.953    0.000    0.563    0.418\n   .READY31           0.538    0.050   10.756    0.000    0.538    0.402\n   .READY32           0.541    0.046   11.791    0.000    0.541    0.449\n   .READY33           0.560    0.045   12.558    0.000    0.560    0.429\n   .COMMIT11          0.509    0.048   10.621    0.000    0.509    0.438\n   .COMMIT12          0.525    0.045   11.796    0.000    0.525    0.446\n   .COMMIT13          0.505    0.046   10.855    0.000    0.505    0.426\n   .COMMIT21          0.493    0.045   10.965    0.000    0.493    0.394\n   .COMMIT22          0.512    0.047   10.939    0.000    0.512    0.404\n   .COMMIT23          0.536    0.049   10.875    0.000    0.536    0.404\n   .COMMIT31          0.471    0.041   11.369    0.000    0.471    0.450\n   .COMMIT32          0.536    0.052   10.265    0.000    0.536    0.483\n   .COMMIT33          0.540    0.046   11.675    0.000    0.540    0.474\n\nR-Square:\n                   Estimate\n    JOBSAT11          0.653\n    JOBSAT12          0.642\n    JOBSAT13          0.670\n    JOBSAT21          0.611\n    JOBSAT22          0.645\n    JOBSAT23          0.635\n    JOBSAT31          0.606\n    JOBSAT32          0.629\n    JOBSAT33          0.611\n    READY11           0.637\n    READY12           0.559\n    READY13           0.616\n    READY21           0.609\n    READY22           0.542\n    READY23           0.582\n    READY31           0.598\n    READY32           0.551\n    READY33           0.571\n    COMMIT11          0.562\n    COMMIT12          0.554\n    COMMIT13          0.574\n    COMMIT21          0.606\n    COMMIT22          0.596\n    COMMIT23          0.596\n    COMMIT31          0.550\n    COMMIT32          0.517\n    COMMIT33          0.526\n\n\n\n14.4.4 Modification Indices\n\nCodemodificationindices(\n  scalarInvariance_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n14.4.5 Path Diagram\n\nCodelavaanPlot::lavaanPlot2(\n  scalarInvariance_fit,\n  stand = TRUE,\n  coef_labels = TRUE)\n\n\nPath Diagram\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(scalarInvariance_fit)\n\n\n\n14.4.6 Compare Models\n\nCodeanova(\n  metricInvariance_fit,\n  scalarInvariance_fit\n)",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "sem.html#residual-strict-factorial-invariance",
    "href": "sem.html#residual-strict-factorial-invariance",
    "title": "Structural Equation Modeling",
    "section": "\n14.5 Residual (“Strict Factorial”) Invariance",
    "text": "14.5 Residual (“Strict Factorial”) Invariance\nEvaluates whether the items’ residual variances are the same across time.\n\nStandardize the latent factor(s) at T1 (i.e., fix the mean to zero and the variance to one)\nAllow within-indicator residuals to covary across time\nFor each indicator, constrain its factor loading to be the same across time\nFor each indicator, constrain its intercept to be the same across time\nFor each indicator, constrain its residual variance to be the same across time\n\n\n14.5.1 Model Syntax\n\nCoderesidualInvariance_syntax &lt;- '\n  # Factor Loadings\n  jobsat_1 =~ NA*loadj1*JOBSAT11 + loadj2*JOBSAT12 + loadj3*JOBSAT13\n  jobsat_2 =~ NA*loadj1*JOBSAT21 + loadj2*JOBSAT22 + loadj3*JOBSAT23\n  jobsat_3 =~ NA*loadj1*JOBSAT31 + loadj2*JOBSAT32 + loadj3*JOBSAT33\n  \n  ready_1 =~ NA*loadr1*READY11 + loadr2*READY12 + loadr3*READY13\n  ready_2 =~ NA*loadr1*READY21 + loadr2*READY22 + loadr3*READY23\n  ready_3 =~ NA*loadr1*READY31 + loadr2*READY32 + loadr3*READY33\n  \n  commit_1 =~ NA*loadc1*COMMIT11 + loadc2*COMMIT12 + loadc3*COMMIT13\n  commit_2 =~ NA*loadc1*COMMIT21 + loadc2*COMMIT22 + loadc3*COMMIT23\n  commit_3 =~ NA*loadc1*COMMIT31 + loadc2*COMMIT32 + loadc3*COMMIT33\n  \n  # Factor Identification: Standardize Factors at T1\n  \n  ## Fix Factor Means at T1 to Zero\n  jobsat_1 ~ 0*1\n  ready_1 ~ 0*1\n  commit_1 ~ 0*1\n  \n  ## Fix Factor Variances at T1 to One\n  jobsat_1 ~~ 1*jobsat_1\n  ready_1 ~~ 1*ready_1\n  commit_1 ~~ 1*commit_1\n  \n  # Freely Estimate Factor Means at T2 and T3 (relative to T1)\n  jobsat_2 ~ 1\n  jobsat_3 ~ 1\n  \n  ready_2 ~ 1\n  ready_3 ~ 1\n  \n  commit_2 ~ 1\n  commit_3 ~ 1\n  \n  # Freely Estimate Factor Variances at T2 and T3 (relative to T1)\n  jobsat_2 ~~ jobsat_2\n  jobsat_3 ~~ jobsat_3\n  \n  ready_2 ~~ ready_2\n  ready_3 ~~ ready_3\n  \n  commit_2 ~~ commit_2\n  commit_3 ~~ commit_3\n  \n  # Constrain Intercepts of Indicators Across Time\n  JOBSAT11 ~ intj1*1\n  JOBSAT21 ~ intj1*1\n  JOBSAT31 ~ intj1*1\n  JOBSAT12 ~ intj2*1\n  JOBSAT22 ~ intj2*1\n  JOBSAT32 ~ intj2*1\n  JOBSAT13 ~ intj3*1\n  JOBSAT23 ~ intj3*1\n  JOBSAT33 ~ intj3*1\n  \n  READY11 ~ intr1*1\n  READY21 ~ intr1*1\n  READY31 ~ intr1*1\n  READY12 ~ intr2*1\n  READY22 ~ intr2*1\n  READY32 ~ intr2*1\n  READY13 ~ intr3*1\n  READY23 ~ intr3*1\n  READY33 ~ intr3*1\n  \n  COMMIT11 ~ intc1*1\n  COMMIT21 ~ intc1*1\n  COMMIT31 ~ intc1*1\n  COMMIT12 ~ intc2*1\n  COMMIT22 ~ intc2*1\n  COMMIT32 ~ intc2*1\n  COMMIT13 ~ intc3*1\n  COMMIT23 ~ intc3*1\n  COMMIT33 ~ intc3*1\n  \n  # Constrain Residual Variances of Indicators Across Time\n  JOBSAT11 ~~ resj1*JOBSAT11\n  JOBSAT21 ~~ resj1*JOBSAT21\n  JOBSAT31 ~~ resj1*JOBSAT31\n  JOBSAT12 ~~ resj2*JOBSAT12\n  JOBSAT22 ~~ resj2*JOBSAT22\n  JOBSAT32 ~~ resj2*JOBSAT32\n  JOBSAT13 ~~ resj3*JOBSAT13\n  JOBSAT23 ~~ resj3*JOBSAT23\n  JOBSAT33 ~~ resj3*JOBSAT33\n  \n  READY11 ~~ resr1*READY11\n  READY21 ~~ resr1*READY21\n  READY31 ~~ resr1*READY31\n  READY12 ~~ resr2*READY12\n  READY22 ~~ resr2*READY22\n  READY32 ~~ resr2*READY32\n  READY13 ~~ resr3*READY13\n  READY23 ~~ resr3*READY23\n  READY33 ~~ resr3*READY33\n  \n  COMMIT11 ~~ resc1*COMMIT11\n  COMMIT21 ~~ resc1*COMMIT21\n  COMMIT31 ~~ resc1*COMMIT31\n  COMMIT12 ~~ resc2*COMMIT12\n  COMMIT22 ~~ resc2*COMMIT22\n  COMMIT32 ~~ resc2*COMMIT32\n  COMMIT13 ~~ resc3*COMMIT13\n  COMMIT23 ~~ resc3*COMMIT23\n  COMMIT33 ~~ resc3*COMMIT33\n  \n  # Residual Covariances Within Indicator Across Time\n  JOBSAT11 ~~ JOBSAT21\n  JOBSAT21 ~~ JOBSAT31\n  JOBSAT11 ~~ JOBSAT31\n  \n  JOBSAT12 ~~ JOBSAT22\n  JOBSAT22 ~~ JOBSAT32\n  JOBSAT12 ~~ JOBSAT32\n  \n  JOBSAT13 ~~ JOBSAT23\n  JOBSAT23 ~~ JOBSAT33\n  JOBSAT13 ~~ JOBSAT33\n  \n  READY11 ~~ READY21\n  READY21 ~~ READY31\n  READY11 ~~ READY31\n  \n  READY12 ~~ READY22\n  READY22 ~~ READY32\n  READY12 ~~ READY32\n  \n  READY13 ~~ READY23\n  READY23 ~~ READY33\n  READY13 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT21\n  COMMIT21 ~~ COMMIT31\n  COMMIT11 ~~ COMMIT31\n  \n  COMMIT12 ~~ COMMIT22\n  COMMIT22 ~~ COMMIT32\n  COMMIT12 ~~ COMMIT32\n  \n  COMMIT13 ~~ COMMIT23\n  COMMIT23 ~~ COMMIT33\n  COMMIT13 ~~ COMMIT33\n'\n\n\n\n14.5.2 Fit Model\n\nCoderesidualInvariance_fit &lt;- cfa(\n  residualInvariance_syntax,\n  data = longitudinalMI,\n  missing = \"ML\",\n  estimator = \"MLR\",\n  meanstructure = TRUE,\n  #std.lv = TRUE,\n  fixed.x = FALSE)\n\n\n\n14.5.3 Model Summary\n\nCodesummary(\n  residualInvariance_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 83 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                       156\n  Number of equality constraints                    54\n\n  Number of observations                           495\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                               303.347     310.092\n  Degrees of freedom                               303         303\n  P-value (Chi-square)                           0.484       0.377\n  Scaling correction factor                                  0.978\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              6697.063    6541.933\n  Degrees of freedom                               351         351\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.024\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    1.000       0.999\n  Tucker-Lewis Index (TLI)                       1.000       0.999\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.999\n  Robust Tucker-Lewis Index (TLI)                            0.999\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)             -17483.037  -17483.037\n  Scaling correction factor                                  0.690\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)     -17331.363  -17331.363\n  Scaling correction factor                                  0.998\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               35170.074   35170.074\n  Bayesian (BIC)                             35598.939   35598.939\n  Sample-size adjusted Bayesian (SABIC)      35275.188   35275.188\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.002       0.007\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.017       0.019\n  P-value H_0: RMSEA &lt;= 0.050                    1.000       1.000\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.006\n  90 Percent confidence interval - lower                     0.000\n  90 Percent confidence interval - upper                     0.018\n  P-value H_0: Robust RMSEA &lt;= 0.050                         1.000\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.025       0.025\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  jobsat_1 =~                                                           \n    JOBSAT1 (ldj1)    0.979    0.036   27.307    0.000    0.979    0.806\n    JOBSAT1 (ldj2)    0.999    0.034   29.132    0.000    0.999    0.816\n    JOBSAT1 (ldj3)    0.993    0.035   28.296    0.000    0.993    0.813\n  jobsat_2 =~                                                           \n    JOBSAT2 (ldj1)    0.979    0.036   27.307    0.000    0.943    0.795\n    JOBSAT2 (ldj2)    0.999    0.034   29.132    0.000    0.963    0.805\n    JOBSAT2 (ldj3)    0.993    0.035   28.296    0.000    0.957    0.803\n  jobsat_3 =~                                                           \n    JOBSAT3 (ldj1)    0.979    0.036   27.307    0.000    0.863    0.768\n    JOBSAT3 (ldj2)    0.999    0.034   29.132    0.000    0.882    0.779\n    JOBSAT3 (ldj3)    0.993    0.035   28.296    0.000    0.876    0.777\n  ready_1 =~                                                            \n    READY11 (ldr1)    0.928    0.036   25.841    0.000    0.928    0.789\n    READY12 (ldr2)    0.845    0.035   24.222    0.000    0.845    0.747\n    READY13 (ldr3)    0.894    0.035   25.224    0.000    0.894    0.771\n  ready_2 =~                                                            \n    READY21 (ldr1)    0.928    0.036   25.841    0.000    0.923    0.787\n    READY22 (ldr2)    0.845    0.035   24.222    0.000    0.840    0.745\n    READY23 (ldr3)    0.894    0.035   25.224    0.000    0.889    0.770\n  ready_3 =~                                                            \n    READY31 (ldr1)    0.928    0.036   25.841    0.000    0.896    0.778\n    READY32 (ldr2)    0.845    0.035   24.222    0.000    0.816    0.735\n    READY33 (ldr3)    0.894    0.035   25.224    0.000    0.863    0.760\n  commit_1 =~                                                           \n    COMMIT1 (ldc1)    0.809    0.036   22.780    0.000    0.809    0.756\n    COMMIT1 (ldc2)    0.806    0.035   22.727    0.000    0.806    0.744\n    COMMIT1 (ldc3)    0.824    0.036   22.925    0.000    0.824    0.750\n  commit_2 =~                                                           \n    COMMIT2 (ldc1)    0.809    0.036   22.780    0.000    0.873    0.780\n    COMMIT2 (ldc2)    0.806    0.035   22.727    0.000    0.870    0.768\n    COMMIT2 (ldc3)    0.824    0.036   22.925    0.000    0.889    0.774\n  commit_3 =~                                                           \n    COMMIT3 (ldc1)    0.809    0.036   22.780    0.000    0.760    0.736\n    COMMIT3 (ldc2)    0.806    0.035   22.727    0.000    0.757    0.723\n    COMMIT3 (ldc3)    0.824    0.036   22.925    0.000    0.774    0.729\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .JOBSAT11 ~~                                                           \n   .JOBSAT21          0.111    0.030    3.639    0.000    0.111    0.214\n .JOBSAT21 ~~                                                           \n   .JOBSAT31          0.120    0.030    3.936    0.000    0.120    0.231\n .JOBSAT11 ~~                                                           \n   .JOBSAT31          0.161    0.031    5.208    0.000    0.161    0.310\n .JOBSAT12 ~~                                                           \n   .JOBSAT22          0.141    0.031    4.518    0.000    0.141    0.281\n .JOBSAT22 ~~                                                           \n   .JOBSAT32          0.102    0.031    3.287    0.001    0.102    0.204\n .JOBSAT12 ~~                                                           \n   .JOBSAT32          0.073    0.032    2.292    0.022    0.073    0.146\n .JOBSAT13 ~~                                                           \n   .JOBSAT23          0.091    0.032    2.882    0.004    0.091    0.180\n .JOBSAT23 ~~                                                           \n   .JOBSAT33          0.143    0.032    4.466    0.000    0.143    0.284\n .JOBSAT13 ~~                                                           \n   .JOBSAT33          0.117    0.032    3.662    0.000    0.117    0.232\n .READY11 ~~                                                            \n   .READY21           0.139    0.033    4.266    0.000    0.139    0.265\n .READY21 ~~                                                            \n   .READY31           0.101    0.030    3.320    0.001    0.101    0.192\n .READY11 ~~                                                            \n   .READY31           0.100    0.033    3.010    0.003    0.100    0.190\n .READY12 ~~                                                            \n   .READY22           0.174    0.032    5.389    0.000    0.174    0.307\n .READY22 ~~                                                            \n   .READY32           0.173    0.035    4.941    0.000    0.173    0.306\n .READY12 ~~                                                            \n   .READY32           0.124    0.035    3.580    0.000    0.124    0.219\n .READY13 ~~                                                            \n   .READY23           0.136    0.033    4.125    0.000    0.136    0.250\n .READY23 ~~                                                            \n   .READY33           0.160    0.032    5.019    0.000    0.160    0.294\n .READY13 ~~                                                            \n   .READY33           0.122    0.033    3.689    0.000    0.122    0.225\n .COMMIT11 ~~                                                           \n   .COMMIT21          0.116    0.030    3.869    0.000    0.116    0.238\n .COMMIT21 ~~                                                           \n   .COMMIT31          0.145    0.031    4.699    0.000    0.145    0.296\n .COMMIT11 ~~                                                           \n   .COMMIT31          0.107    0.029    3.655    0.000    0.107    0.219\n .COMMIT12 ~~                                                           \n   .COMMIT22          0.104    0.032    3.294    0.001    0.104    0.198\n .COMMIT22 ~~                                                           \n   .COMMIT32          0.119    0.032    3.735    0.000    0.119    0.227\n .COMMIT12 ~~                                                           \n   .COMMIT32          0.081    0.030    2.717    0.007    0.081    0.155\n .COMMIT13 ~~                                                           \n   .COMMIT23          0.176    0.034    5.229    0.000    0.176    0.333\n .COMMIT23 ~~                                                           \n   .COMMIT33          0.146    0.029    4.985    0.000    0.146    0.277\n .COMMIT13 ~~                                                           \n   .COMMIT33          0.113    0.033    3.462    0.001    0.113    0.214\n  jobsat_1 ~~                                                           \n    jobsat_2          0.392    0.054    7.235    0.000    0.406    0.406\n    jobsat_3          0.292    0.050    5.843    0.000    0.331    0.331\n    ready_1           0.543    0.050   10.795    0.000    0.543    0.543\n    ready_2           0.271    0.057    4.730    0.000    0.273    0.273\n    ready_3           0.175    0.055    3.157    0.002    0.181    0.181\n    commit_1          0.581    0.046   12.487    0.000    0.581    0.581\n    commit_2          0.389    0.060    6.452    0.000    0.361    0.361\n    commit_3          0.230    0.054    4.228    0.000    0.245    0.245\n  jobsat_2 ~~                                                           \n    jobsat_3          0.347    0.052    6.690    0.000    0.409    0.409\n    ready_1           0.200    0.056    3.575    0.000    0.208    0.208\n    ready_2           0.481    0.059    8.088    0.000    0.502    0.502\n    ready_3           0.192    0.054    3.523    0.000    0.206    0.206\n    commit_1          0.277    0.054    5.096    0.000    0.287    0.287\n    commit_2          0.593    0.067    8.869    0.000    0.571    0.571\n    commit_3          0.253    0.057    4.420    0.000    0.280    0.280\n  jobsat_3 ~~                                                           \n    ready_1           0.206    0.047    4.354    0.000    0.234    0.234\n    ready_2           0.264    0.051    5.170    0.000    0.301    0.301\n    ready_3           0.455    0.055    8.240    0.000    0.534    0.534\n    commit_1          0.191    0.052    3.671    0.000    0.217    0.217\n    commit_2          0.281    0.057    4.897    0.000    0.296    0.296\n    commit_3          0.485    0.055    8.772    0.000    0.585    0.585\n  ready_1 ~~                                                            \n    ready_2           0.319    0.061    5.229    0.000    0.321    0.321\n    ready_3           0.271    0.057    4.770    0.000    0.281    0.281\n    commit_1          0.458    0.050    9.214    0.000    0.458    0.458\n    commit_2          0.293    0.064    4.551    0.000    0.271    0.271\n    commit_3          0.225    0.056    4.023    0.000    0.239    0.239\n  ready_2 ~~                                                            \n    ready_3           0.419    0.061    6.875    0.000    0.437    0.437\n    commit_1          0.258    0.057    4.498    0.000    0.259    0.259\n    commit_2          0.664    0.070    9.490    0.000    0.619    0.619\n    commit_3          0.283    0.058    4.875    0.000    0.303    0.303\n  ready_3 ~~                                                            \n    commit_1          0.176    0.058    3.035    0.002    0.182    0.182\n    commit_2          0.305    0.064    4.798    0.000    0.293    0.293\n    commit_3          0.437    0.059    7.338    0.000    0.481    0.481\n  commit_1 ~~                                                           \n    commit_2          0.579    0.058    9.992    0.000    0.537    0.537\n    commit_3          0.371    0.055    6.683    0.000    0.395    0.395\n  commit_2 ~~                                                           \n    commit_3          0.518    0.074    7.024    0.000    0.511    0.511\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jbst_1            0.000                               0.000    0.000\n    redy_1            0.000                               0.000    0.000\n    cmmt_1            0.000                               0.000    0.000\n    jbst_2            0.011    0.053    0.215    0.830    0.012    0.012\n    jbst_3            0.096    0.054    1.788    0.074    0.109    0.109\n    redy_2            0.063    0.058    1.082    0.279    0.064    0.064\n    redy_3            0.183    0.060    3.042    0.002    0.189    0.189\n    cmmt_2           -0.161    0.054   -2.985    0.003   -0.150   -0.150\n    cmmt_3           -0.093    0.057   -1.628    0.103   -0.099   -0.099\n   .JOBSAT (intj1)    3.325    0.052   63.876    0.000    3.325    2.738\n   .JOBSAT (intj1)    3.325    0.052   63.876    0.000    3.325    2.804\n   .JOBSAT (intj1)    3.325    0.052   63.876    0.000    3.325    2.959\n   .JOBSAT (intj2)    3.313    0.051   64.637    0.000    3.313    2.704\n   .JOBSAT (intj2)    3.313    0.051   64.637    0.000    3.313    2.771\n   .JOBSAT (intj2)    3.313    0.051   64.637    0.000    3.313    2.929\n   .JOBSAT (intj3)    3.311    0.051   64.381    0.000    3.311    2.710\n   .JOBSAT (intj3)    3.311    0.051   64.381    0.000    3.311    2.777\n   .JOBSAT (intj3)    3.311    0.051   64.381    0.000    3.311    2.934\n   .READY1 (intr1)    3.178    0.049   64.982    0.000    3.178    2.700\n   .READY2 (intr1)    3.178    0.049   64.982    0.000    3.178    2.710\n   .READY3 (intr1)    3.178    0.049   64.982    0.000    3.178    2.759\n   .READY1 (intr2)    3.179    0.048   66.612    0.000    3.179    2.809\n   .READY2 (intr2)    3.179    0.048   66.612    0.000    3.179    2.818\n   .READY3 (intr2)    3.179    0.048   66.612    0.000    3.179    2.864\n   .READY1 (intr3)    3.173    0.049   65.244    0.000    3.173    2.739\n   .READY2 (intr3)    3.173    0.049   65.244    0.000    3.173    2.748\n   .READY3 (intr3)    3.173    0.049   65.244    0.000    3.173    2.795\n   .COMMIT (intc1)    3.688    0.044   83.049    0.000    3.688    3.448\n   .COMMIT (intc1)    3.688    0.044   83.049    0.000    3.688    3.298\n   .COMMIT (intc1)    3.688    0.044   83.049    0.000    3.688    3.570\n   .COMMIT (intc2)    3.666    0.044   83.392    0.000    3.666    3.382\n   .COMMIT (intc2)    3.666    0.044   83.392    0.000    3.666    3.239\n   .COMMIT (intc2)    3.666    0.044   83.392    0.000    3.666    3.498\n   .COMMIT (intc3)    3.615    0.046   77.903    0.000    3.615    3.290\n   .COMMIT (intc3)    3.615    0.046   77.903    0.000    3.615    3.149\n   .COMMIT (intc3)    3.615    0.046   77.903    0.000    3.615    3.405\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jobst_1           1.000                               1.000    1.000\n    ready_1           1.000                               1.000    1.000\n    commt_1           1.000                               1.000    1.000\n    jobst_2           0.928    0.066   13.967    0.000    1.000    1.000\n    jobst_3           0.778    0.064   12.182    0.000    1.000    1.000\n    ready_2           0.988    0.079   12.549    0.000    1.000    1.000\n    ready_3           0.932    0.078   11.971    0.000    1.000    1.000\n    commt_2           1.163    0.106   10.996    0.000    1.000    1.000\n    commt_3           0.882    0.086   10.237    0.000    1.000    1.000\n   .JOBSAT1 (rsj1)    0.518    0.030   17.508    0.000    0.518    0.351\n   .JOBSAT2 (rsj1)    0.518    0.030   17.508    0.000    0.518    0.368\n   .JOBSAT3 (rsj1)    0.518    0.030   17.508    0.000    0.518    0.410\n   .JOBSAT1 (rsj2)    0.502    0.029   17.126    0.000    0.502    0.335\n   .JOBSAT2 (rsj2)    0.502    0.029   17.126    0.000    0.502    0.351\n   .JOBSAT3 (rsj2)    0.502    0.029   17.126    0.000    0.502    0.392\n   .JOBSAT1 (rsj3)    0.505    0.031   16.313    0.000    0.505    0.339\n   .JOBSAT2 (rsj3)    0.505    0.031   16.313    0.000    0.505    0.355\n   .JOBSAT3 (rsj3)    0.505    0.031   16.313    0.000    0.505    0.397\n   .READY11 (rsr1)    0.524    0.032   16.570    0.000    0.524    0.378\n   .READY21 (rsr1)    0.524    0.032   16.570    0.000    0.524    0.381\n   .READY31 (rsr1)    0.524    0.032   16.570    0.000    0.524    0.395\n   .READY12 (rsr2)    0.567    0.032   17.928    0.000    0.567    0.443\n   .READY22 (rsr2)    0.567    0.032   17.928    0.000    0.567    0.445\n   .READY32 (rsr2)    0.567    0.032   17.928    0.000    0.567    0.460\n   .READY13 (rsr3)    0.543    0.031   17.310    0.000    0.543    0.405\n   .READY23 (rsr3)    0.543    0.031   17.310    0.000    0.543    0.408\n   .READY33 (rsr3)    0.543    0.031   17.310    0.000    0.543    0.422\n   .COMMIT1 (rsc1)    0.490    0.030   16.386    0.000    0.490    0.428\n   .COMMIT2 (rsc1)    0.490    0.030   16.386    0.000    0.490    0.391\n   .COMMIT3 (rsc1)    0.490    0.030   16.386    0.000    0.490    0.459\n   .COMMIT1 (rsc2)    0.525    0.031   16.863    0.000    0.525    0.447\n   .COMMIT2 (rsc2)    0.525    0.031   16.863    0.000    0.525    0.410\n   .COMMIT3 (rsc2)    0.525    0.031   16.863    0.000    0.525    0.478\n   .COMMIT1 (rsc3)    0.528    0.031   16.800    0.000    0.528    0.437\n   .COMMIT2 (rsc3)    0.528    0.031   16.800    0.000    0.528    0.401\n   .COMMIT3 (rsc3)    0.528    0.031   16.800    0.000    0.528    0.468\n\nR-Square:\n                   Estimate\n    JOBSAT11          0.649\n    JOBSAT21          0.632\n    JOBSAT31          0.590\n    JOBSAT12          0.665\n    JOBSAT22          0.649\n    JOBSAT32          0.608\n    JOBSAT13          0.661\n    JOBSAT23          0.645\n    JOBSAT33          0.603\n    READY11           0.622\n    READY21           0.619\n    READY31           0.605\n    READY12           0.557\n    READY22           0.555\n    READY32           0.540\n    READY13           0.595\n    READY23           0.592\n    READY33           0.578\n    COMMIT11          0.572\n    COMMIT21          0.609\n    COMMIT31          0.541\n    COMMIT12          0.553\n    COMMIT22          0.590\n    COMMIT32          0.522\n    COMMIT13          0.563\n    COMMIT23          0.599\n    COMMIT33          0.532\n\n\n\n14.5.4 Modification Indices\n\nCodemodificationindices(\n  residualInvariance_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n14.5.5 Path Diagram\n\nCodelavaanPlot::lavaanPlot2(\n  residualInvariance_fit,\n  stand = TRUE,\n  coef_labels = TRUE)\n\n\nPath Diagram\n\n\nTo generate an interactive/modifiable path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(residualInvariance_fit)\n\n\n\n14.5.6 Compare Models\n\nCodeanova(\n  scalarInvariance_fit,\n  residualInvariance_fit\n)\n\n\n  \n\n\nCoderound(cbind(\n  configural = inspect(configuralInvarianceCorrelatedResiduals_fit, \"fit.measures\"), \n  weak = inspect(metricInvariance_fit, \"fit.measures\"),\n  strong = inspect(scalarInvariance_fit, \"fit.measures\"),\n  strict = inspect(residualInvariance_fit, \"fit.measures\")), 3)\n\n                              configural       weak     strong     strict\nnpar                             144.000    132.000    120.000    102.000\nfmin                               0.280      0.289      0.298      0.306\nchisq                            277.582    286.159    295.447    303.347\ndf                               261.000    273.000    285.000    303.000\npvalue                             0.230      0.280      0.323      0.484\nchisq.scaled                     281.997    292.814    302.078    310.092\ndf.scaled                        261.000    273.000    285.000    303.000\npvalue.scaled                      0.178      0.196      0.233      0.377\nchisq.scaling.factor               0.984      0.977      0.978      0.978\nbaseline.chisq                  6697.063   6697.063   6697.063   6697.063\nbaseline.df                      351.000    351.000    351.000    351.000\nbaseline.pvalue                    0.000      0.000      0.000      0.000\nbaseline.chisq.scaled           6541.933   6541.933   6541.933   6541.933\nbaseline.df.scaled               351.000    351.000    351.000    351.000\nbaseline.pvalue.scaled             0.000      0.000      0.000      0.000\nbaseline.chisq.scaling.factor      1.024      1.024      1.024      1.024\ncfi                                0.997      0.998      0.998      1.000\ntli                                0.996      0.997      0.998      1.000\ncfi.scaled                         0.997      0.997      0.997      0.999\ntli.scaled                         0.995      0.996      0.997      0.999\ncfi.robust                         0.997      0.997      0.997      0.999\ntli.robust                         0.996      0.996      0.997      0.999\nnnfi                               0.996      0.997      0.998      1.000\nrfi                                0.944      0.945      0.946      0.948\nnfi                                0.959      0.957      0.956      0.955\npnfi                               0.713      0.745      0.776      0.824\nifi                                0.997      0.998      0.998      1.000\nrni                                0.997      0.998      0.998      1.000\nnnfi.scaled                        0.995      0.996      0.997      0.999\nrfi.scaled                         0.942      0.942      0.943      0.945\nnfi.scaled                         0.957      0.955      0.954      0.953\npnfi.scaled                        0.712      0.743      0.774      0.822\nifi.scaled                         0.997      0.997      0.997      0.999\nrni.scaled                         0.997      0.997      0.997      0.999\nnnfi.robust                        0.996      0.996      0.997      0.999\nrni.robust                         0.997      0.997      0.997      0.999\nlogl                          -17470.154 -17474.443 -17479.087 -17483.037\nunrestricted.logl             -17331.363 -17331.363 -17331.363 -17331.363\naic                            35228.308  35212.885  35198.174  35170.074\nbic                            35833.764  35767.887  35702.721  35598.939\nntotal                           495.000    495.000    495.000    495.000\nbic2                           35376.705  35348.916  35321.838  35275.188\nscaling.factor.h1                  0.998      0.998      0.998      0.998\nscaling.factor.h0                  0.943      0.880      0.803      0.690\nrmsea                              0.011      0.010      0.009      0.002\nrmsea.ci.lower                     0.000      0.000      0.000      0.000\nrmsea.ci.upper                     0.022      0.021      0.020      0.017\nrmsea.ci.level                     0.900      0.900      0.900      0.900\nrmsea.pvalue                       1.000      1.000      1.000      1.000\nrmsea.close.h0                     0.050      0.050      0.050      0.050\nrmsea.notclose.pvalue              0.000      0.000      0.000      0.000\nrmsea.notclose.h0                  0.080      0.080      0.080      0.080\nrmsea.scaled                       0.013      0.012      0.011      0.007\nrmsea.ci.lower.scaled              0.000      0.000      0.000      0.000\nrmsea.ci.upper.scaled              0.023      0.022      0.021      0.019\nrmsea.pvalue.scaled                1.000      1.000      1.000      1.000\nrmsea.notclose.pvalue.scaled       0.000      0.000      0.000      0.000\nrmsea.robust                       0.012      0.012      0.011      0.006\nrmsea.ci.lower.robust              0.000      0.000      0.000      0.000\nrmsea.ci.upper.robust              0.022      0.022      0.021      0.018\nrmsea.pvalue.robust                1.000      1.000      1.000      1.000\nrmsea.notclose.pvalue.robust       0.000      0.000      0.000      0.000\nrmr                                0.031      0.031      0.032      0.032\nrmr_nomean                         0.032      0.032      0.032      0.033\nsrmr                               0.023      0.024      0.024      0.025\nsrmr_bentler                       0.023      0.024      0.024      0.025\nsrmr_bentler_nomean                0.024      0.025      0.025      0.025\ncrmr                               0.024      0.024      0.024      0.024\ncrmr_nomean                        0.025      0.025      0.025      0.025\nsrmr_mplus                         0.023      0.025      0.025      0.026\nsrmr_mplus_nomean                  0.024      0.024      0.024      0.025\ncn_05                            535.412    541.630    546.140    563.310\ncn_01                            566.422    572.322    576.447    593.652\ngfi                                0.989      0.988      0.988      0.988\nagfi                               0.983      0.983      0.983      0.984\npgfi                               0.637      0.666      0.695      0.739\nmfi                                0.983      0.987      0.990      1.000\necvi                               1.143      1.111      1.082      1.025",
    "crumbs": [
      "About",
      "Structural Equation Modeling"
    ]
  },
  {
    "objectID": "jsPsych.html",
    "href": "jsPsych.html",
    "title": "jsPsych",
    "section": "",
    "text": "1 Documentation\nhttps://www.jspsych.org\n\n\n2 Example Tasks\nhttps://github.com/isaactpetersen/EF-battery\n\n\n3 Troubleshooting\n\nPress F12 to Open Chrome Developer Tools\nSwitch to the Sources tab\nPress F8 when you want to pause execution\nThen, you can run commands in the console\n\n\n\n\n\n\n\nReuseCC BY 4.0",
    "crumbs": [
      "About",
      "jsPsych"
    ]
  },
  {
    "objectID": "pca.html",
    "href": "pca.html",
    "title": "Principal Component Analysis",
    "section": "",
    "text": "1 Overview\nhttps://isaactpetersen.github.io/Principles-Psychological-Assessment/factor-analysis-pca.html#sec-pca\n\n\n2 Analysis example\nhttps://isaactpetersen.github.io/Principles-Psychological-Assessment/factor-analysis-pca.html#sec-pcaAnalysis\n\n\n\n\n\n\nReuseCC BY 4.0",
    "crumbs": [
      "About",
      "Principal Component Analysis"
    ]
  },
  {
    "objectID": "mplus.html",
    "href": "mplus.html",
    "title": "Mplus",
    "section": "",
    "text": "Mplus is software for structural equation modeling. A summary of the Mplus language syntax is here (archived at: https://perma.cc/962G-QUEG). The Mplus User’s Guide is located here (archived at: https://perma.cc/W39W-NRGH).",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-specifyVariables",
    "href": "mplus.html#sec-specifyVariables",
    "title": "Mplus",
    "section": "\n6.1 Specify Variables",
    "text": "6.1 Specify Variables\nVARIABLE:\n    NAMES = ID age x1 x2 x3 y1;\n    MISSING = .;\n    USEVARIABLES = ID age x1 x2 y1;\n    CLUSTER = ID;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-categoricalVariables",
    "href": "mplus.html#sec-categoricalVariables",
    "title": "Mplus",
    "section": "\n6.2 Categorical Variables",
    "text": "6.2 Categorical Variables\nVARIABLE:\n    NAMES = ID age x1 x2 x3 y1;\n    MISSING = .;\n    USEVARIABLES = ID age x1 x2 y1;\n    CATEGORICAL = x1 x2;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-countVariables",
    "href": "mplus.html#sec-countVariables",
    "title": "Mplus",
    "section": "\n6.3 Count Variables",
    "text": "6.3 Count Variables\nVARIABLE:\n    NAMES = ID age x1 x2 x3 y1;\n    MISSING = .;\n    USEVARIABLES = ID age x1 x2 y1;\n    COUNT = x1 x2;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-idVariable",
    "href": "mplus.html#sec-idVariable",
    "title": "Mplus",
    "section": "\n6.4 ID Variable",
    "text": "6.4 ID Variable\nVARIABLE:\n    NAMES = ID age x1 x2 x3 y1;\n    MISSING = .;\n    USEVARIABLES = ID age x1 x2 y1;\n    IDVARIABLE = ID;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-clusterVariable",
    "href": "mplus.html#sec-clusterVariable",
    "title": "Mplus",
    "section": "\n6.5 Cluster Variable",
    "text": "6.5 Cluster Variable\nThere are multiple ways of accounting for nested data in structural equation modeling. One way to account for nested data is to use multilevel structural equation modeling. Another approach is to use a cluster variable to generate cluster-robust standard errors of parameters. To use a cluster variable, specify CLUSTER under the VARIABLE section, and specify TYPE = COMPLEX under the ANALYSIS section:\nVARIABLE:\n    NAMES = ID age x1 x2 x3 y1;\n    MISSING = .;\n    USEVARIABLES = ID age x1 x2 y1;\n    CLUSTER = ID;\n\nANALYSIS:\n    TYPE = COMPLEX;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-auxiliaryVariables",
    "href": "mplus.html#sec-auxiliaryVariables",
    "title": "Mplus",
    "section": "\n6.6 Auxiliary Variables",
    "text": "6.6 Auxiliary Variables\nVARIABLE:\n    NAMES = ID age x1 x2 x3 y1;\n    MISSING = .;\n    USEVARIABLES = ID x1 x2 y1;\n    AUXILIARY = age;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-samplingWeight",
    "href": "mplus.html#sec-samplingWeight",
    "title": "Mplus",
    "section": "\n6.7 Sampling Weight Variable",
    "text": "6.7 Sampling Weight Variable\nVARIABLE:\n    NAMES = ID wt age x1 x2 x3 y1;\n    MISSING = .;\n    USEVARIABLES = ID age x1 x2 y1;\n    WEIGHT = wt;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-multilevelVariables",
    "href": "mplus.html#sec-multilevelVariables",
    "title": "Mplus",
    "section": "\n6.8 Multilevel Variables",
    "text": "6.8 Multilevel Variables\nBetween- and within-cluster variables:\nVARIABLE:\n    NAMES = ID wt age x1 x2 x3 y1;\n    MISSING = .;\n    USEVARIABLES = ID age x1 x2 y1;\n    WITHIN = x1;\n    BETWEEN = x2;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-analysisTypes",
    "href": "mplus.html#sec-analysisTypes",
    "title": "Mplus",
    "section": "\n7.1 Analysis Types",
    "text": "7.1 Analysis Types\n\nTYPE = COMPLEX\nTYPE = TWOLEVEL\nTYPE = EFA\nTYPE = MIXTURE",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-estimators",
    "href": "mplus.html#sec-estimators",
    "title": "Mplus",
    "section": "\n7.2 Model Estimators",
    "text": "7.2 Model Estimators\nANALYSIS:\n    ESTIMATOR = MLR;\n\n\nMLR: for likert/continuous data\n\nWLSMV: for ordinal/categorical data\nBAYES",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-bootstrap",
    "href": "mplus.html#sec-bootstrap",
    "title": "Mplus",
    "section": "\n7.3 Bootstrap Draws",
    "text": "7.3 Bootstrap Draws\nBOOTSTRAP = 2000; ! insert number of bootstrap draws",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-starts",
    "href": "mplus.html#sec-starts",
    "title": "Mplus",
    "section": "\n7.4 Starts",
    "text": "7.4 Starts\nSTARTS = 20; ! insert number of initial stage starts and number of final stage optimizations",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-lowCovarianceCoverage",
    "href": "mplus.html#sec-lowCovarianceCoverage",
    "title": "Mplus",
    "section": "\n7.5 Low Covariance Coverage",
    "text": "7.5 Low Covariance Coverage\nTo estimate a model with low covariance coverage, lower the COVERAGE value under the ANALYSIS section:\nANALYSIS:\n    COVERAGE = 0;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-oblique",
    "href": "mplus.html#sec-oblique",
    "title": "Mplus",
    "section": "\n8.1 Oblique Rotation",
    "text": "8.1 Oblique Rotation\nANALYSIS:\n    TYPE = EFA 1 5; ! extract 1-5 factors\n    ROTATION = GEOMIN;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-orthogonal",
    "href": "mplus.html#sec-orthogonal",
    "title": "Mplus",
    "section": "\n8.2 Orthogonal Rotation",
    "text": "8.2 Orthogonal Rotation\nANALYSIS:\n    TYPE = EFA 1 5; ! extract 1-5 factors\n    ROTATION = VARIMAX;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-latentVariables",
    "href": "mplus.html#sec-latentVariables",
    "title": "Mplus",
    "section": "\n10.1 Define Latent Variables",
    "text": "10.1 Define Latent Variables\nMODEL:\n    latent1 BY x1 x2 x3;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-regressionPaths",
    "href": "mplus.html#sec-regressionPaths",
    "title": "Mplus",
    "section": "\n10.2 Regression Paths",
    "text": "10.2 Regression Paths\nRegress outcome variable on predictor variable(s):\nMODEL:\n    y1 ON x1 x2;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-covariancePaths",
    "href": "mplus.html#sec-covariancePaths",
    "title": "Mplus",
    "section": "\n10.3 Covariance Paths",
    "text": "10.3 Covariance Paths\nMODEL:\n    x1 WITH x2;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-indirectEffects",
    "href": "mplus.html#sec-indirectEffects",
    "title": "Mplus",
    "section": "\n10.4 Indirect Effects",
    "text": "10.4 Indirect Effects\nANALYSIS:\n    TYPE = GENERAL;\n    ESTIMATOR = ML;\n    BOOTSTRAP = 1000;\n\nMODEL:\n    MODEL INDIRECT:\n        y IND x;\n\nOUTPUT:\n    STAND;\n    CINTERVAL (BOOTSTRAP); !percentile boostrap CI\n    CINTERVAL (BCBOOTSTRAP); !bias-corrected boostrap CI",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-means",
    "href": "mplus.html#sec-means",
    "title": "Mplus",
    "section": "\n10.5 Means/Intercepts",
    "text": "10.5 Means/Intercepts\nFreely estimate:\nMODEL:\n    [x1];\nFix to zero:\nMODEL:\n    [x1@0];",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-variances",
    "href": "mplus.html#sec-variances",
    "title": "Mplus",
    "section": "\n10.6 Variances",
    "text": "10.6 Variances\nFreely estimate:\nMODEL:\n    x1;\nFix to one:\nMODEL:\n    x1@1;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-parameterLabel",
    "href": "mplus.html#sec-parameterLabel",
    "title": "Mplus",
    "section": "\n10.7 Parameter Label",
    "text": "10.7 Parameter Label\nTo specify a parameter label, provide the label in parentheses after the parameter:\nMODEL:\n    latent1 BY x1* x2 x3 (load1-3);\n    latent2 BY x4* x5 (load5) x6;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-multigroup",
    "href": "mplus.html#sec-multigroup",
    "title": "Mplus",
    "section": "\n10.8 Multigroup Model",
    "text": "10.8 Multigroup Model\nVARIABLE:\n    NAMES = group x1 x2 x3 y1;\n    GROUPING = group (0=boys, 1=girls);\n    MISSING = .;\n    USEVARIABLES = group x1 x2 x3 y1;\n\nMODEL:\n    Model boys:\n        latent BY x1* x2 x3;\n        [latent@0];\n        latent@1;\n        y ~ latent;\n\n    Model girls:\n        latent BY x1* x2 x3;\n        [latent@0];\n        latent@1;\n        y ~ latent;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-measurementInvariance",
    "href": "mplus.html#sec-measurementInvariance",
    "title": "Mplus",
    "section": "\n10.9 Multigroup Measurement Invariance",
    "text": "10.9 Multigroup Measurement Invariance\n\n10.9.1 Configural Invariance\nVARIABLE:\n    NAMES = group x1 x2 x3 y1;\n    GROUPING = group (0=boys, 1=girls);\n    MISSING = .;\n    USEVARIABLES = group x1 x2 x3;\n\nMODEL:\n    Model boys:\n        latent BY x1* x2 x3;\n        [latent@0];\n        latent@1;\n\n    Model girls:\n        latent BY x1* x2 x3;\n        [latent@0];\n        latent@1;\n\n10.9.2 Metric (Weak Factorial) Invariance\nVARIABLE:\n    NAMES = group x1 x2 x3 y1;\n    GROUPING = group (0=boys, 1=girls);\n    MISSING = .;\n    USEVARIABLES = group x1 x2 x3;\n\nMODEL:\n    Model boys:\n        latent BY x1* (load1); ! constrain factor loading across groups (same parameter label)\n        latent BY x2* (load2); ! constrain factor loading across groups (same parameter label)\n        latent BY x3* (load3); ! constrain factor loading across groups (same parameter label)\n\n        [latent@0];\n        latent@1;\n\n    Model girls:\n        latent BY x1* (load1); ! constrain factor loading across groups (same parameter label)\n        latent BY x2* (load2); ! constrain factor loading across groups (same parameter label)\n        latent BY x3* (load3); ! constrain factor loading across groups (same parameter label)\n\n        [latent@0];\n        latent@1;\n\n10.9.3 Scalar (Strong Factorial) Invariance\nVARIABLE:\n    NAMES = group x1 x2 x3 y1;\n    GROUPING = group (0=boys, 1=girls);\n    MISSING = .;\n    USEVARIABLES = group x1 x2 x3;\n\nMODEL:\n    Model boys:\n        latent BY x1* (load1); ! constrain factor loading across groups (same parameter label)\n        latent BY x2* (load2); ! constrain factor loading across groups (same parameter label)\n        latent BY x3* (load3); ! constrain factor loading across groups (same parameter label)\n\n        [x1] (int1); ! constrain intercept across groups (same parameter label)\n        [x2] (int2); ! constrain intercept across groups (same parameter label)\n        [x3] (int3); ! constrain intercept across groups (same parameter label)\n\n        [latent@0];\n        latent@1;\n\n    Model girls:\n        latent BY x1* (load1); ! constrain factor loading across groups (same parameter label)\n        latent BY x2* (load2); ! constrain factor loading across groups (same parameter label)\n        latent BY x3* (load3); ! constrain factor loading across groups (same parameter label)\n\n        [x1] (int1); ! constrain intercept across groups (same parameter label)\n        [x2] (int2); ! constrain intercept across groups (same parameter label)\n        [x3] (int3); ! constrain intercept across groups (same parameter label)\n\n        [latent@0];\n        latent@1;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-freeParameter",
    "href": "mplus.html#sec-freeParameter",
    "title": "Mplus",
    "section": "\n12.1 Freeing a Parameter",
    "text": "12.1 Freeing a Parameter\nBy default, the first loading on a factor is fixed to zero. You can freely estimate the parameter by adding an asterisk:\nMODEL:\n    latent1 BY x1* x2 x3;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-constrainParameter",
    "href": "mplus.html#sec-constrainParameter",
    "title": "Mplus",
    "section": "\n12.2 Constraing a Parameter",
    "text": "12.2 Constraing a Parameter\nMODEL:\n    latent1 BY x1@1 x2 x3;\n    [latent1@0];\n    latent1@1;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-equalParameters",
    "href": "mplus.html#sec-equalParameters",
    "title": "Mplus",
    "section": "\n12.3 Setting Two Parameters to be Equal",
    "text": "12.3 Setting Two Parameters to be Equal\nTo set two parameters to be equal, provide the same parameter label for each parameter.",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-parameterBounds",
    "href": "mplus.html#sec-parameterBounds",
    "title": "Mplus",
    "section": "\n12.4 Setting Lower and Upper Bounds on a Parameter",
    "text": "12.4 Setting Lower and Upper Bounds on a Parameter\nTo set lower and upper bounds on a parameter, you can assign the parameter a parameter label. Then, you can assign the constraint to the parameter (via the label) under the MODEL CONSTRAINT section. For example, to constrain a parameter between 0–1,\nMODEL:\n    latent1 BY x1* x2 x3 (load3);\n\nMODEL CONSTRAINT:\n    load3 &gt; 0; load3 &lt; 1;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-equallySpaced",
    "href": "mplus.html#sec-equallySpaced",
    "title": "Mplus",
    "section": "\n17.1 Equally Spaced Time Points",
    "text": "17.1 Equally Spaced Time Points\nVARIABLE: \n    NAMES = id y0 y1 y2 y3 y4 x;\n    USEVARIABLES = y0 y1 y2 y3 y4 x;\n\nANALYSIS:\n    TYPE = RANDOM;\n\nMODEL:\n    i s q | y0@0 y1@1 y2@2 y3@3 y4@4; ! intercept, linear slope, quadratic slope\n    ! OR ALTERNATIVELY:\n    !i BY y0@1 y1@1 y2@1 y3@1 y4@1;\n    !s BY y0@0 y1@1 y2@2 y3@3 y4@4;\n    !q BY y0@0 y1@1 y2@4 y3@9 y4@16;\n    i s q ON x;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-tScores",
    "href": "mplus.html#sec-tScores",
    "title": "Mplus",
    "section": "\n17.2 Unequally Spaced Time Points (Individually Varying Times of Observation)",
    "text": "17.2 Unequally Spaced Time Points (Individually Varying Times of Observation)\nUnequally spaced time points can be accounted for using the TSCORES option (i.e., person-specific factor loadings; Sterba, 2014).\nhttps://stats.oarc.ucla.edu/mplus/faq/how-can-i-run-a-growth-model-in-wide-form-with-unequally-spaced-time-points-tscore/ (archived at https://perma.cc/Z7QY-TL6W)\nVARIABLE: \n    NAMES = id t0 t1 t2 t3 t4 y0 y1 y2 y3 y4 x;\n    USEVARIABLES = t0 t1 t2 t3 t4 y0 y1 y2 y3 y4 x;\n    TSCORES = t0 t1 t2 t3 t4;\n\nANALYSIS:\n    TYPE = RANDOM;\n\nMODEL:\n    i s q | y0 y1 y2 y3 y4 AT t0 t1 t2 t3 t4; ! intercept, linear slope, quadratic slopes\n    i s q ON x;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-monteCarloSingleGroup",
    "href": "mplus.html#sec-monteCarloSingleGroup",
    "title": "Mplus",
    "section": "\n20.1 Single Group Model",
    "text": "20.1 Single Group Model\nTITLE: Single-Group Monte Carlo Simulation with Ordinal Items and Common Factor;\n\nMONTECARLO:\n    NAMES = v1-v5; ! variable names\n    NOBSERVATIONS = 500; ! number of participants in each sample\n    NREPS = 100000; ! number of samples to create\n    SEED = 52242; ! random seed\n    GENERATE = v1-v5 (3 p); ! specify the scale of the DVs; number of thresholds; probit (p)\n    CATEGORICAL = v1-v5; ! specify the variables that are (ordered) categorical\n\nANALYSIS:\n    PROCESSORS = 4 1; ! number of processors; number of threads\n    ESTIMATOR = WLSMV;\n    PARAMETERIZATION = THETA;\n\nMODEL POPULATION: ! tell Mplus how to generate the population data; can use asterisks (*) and at symbols (@) interchangeably here, but they differ in the MODEL command (see below); I use the same symbol as in the MODEL command\n    dep BY v1-v5*.7; ! factor loadings\n    [dep@0]; ! set factor mean to 0\n    dep@1; ! set factor variance to 1 (standardize)\n    [v1$1*0.5] (v1t1); [v1$2*1.0] (v1t2); [v1$3*1.5] (v1t3); ! item thresholds for v1\n    [v2$1*0.5] (v2t1); [v2$2*1.0] (v2t2); [v2$3*1.5] (v2t3); ! item thresholds for v2\n    [v3$1*0.5] (v3t1); [v3$2*1.0] (v3t2); [v3$3*1.5] (v3t3); ! item thresholds for v3\n    [v4$1*0.0] (v4t1); [v4$2*0.5] (v4t2); [v4$3*1.0] (v4t3); ! item thresholds for v4\n    [v5$1*0.0] (v5t1); [v5$2*0.5] (v5t2); [v5$3*1.0] (v5t3); ! item thresholds for v5\n    v1-v5@1; ! item residual variances\n\nMODEL: ! tell Mplus to estimate our model; asterisks (*) are free estimates with a starting value; at symbols (@) are fixed estimates\n    dep BY v1-v5*.7; ! factor loadings\n    [dep@0]; ! set factor mean to 0\n    dep@1; ! set factor variance to 1 (standardize)\n    [v1$1*0.5] (v1t1); [v1$2*1.0] (v1t2); [v1$3*1.5] (v1t3); ! item thresholds for v1\n    [v2$1*0.5] (v2t1); [v2$2*1.0] (v2t2); [v2$3*1.5] (v2t3); ! item thresholds for v2\n    [v3$1*0.5] (v3t1); [v3$2*1.0] (v3t2); [v3$3*1.5] (v3t3); ! item thresholds for v3\n    [v4$1*0.0] (v4t1); [v4$2*0.5] (v4t2); [v4$3*1.0] (v4t3); ! item thresholds for v4\n    [v5$1*0.0] (v5t1); [v5$2*0.5] (v5t2); [v5$3*1.0] (v5t3); ! item thresholds for v5\n    v1-v5@1; ! item residual variances\n\nMODEL CONSTRAINT:\n    NEW (stdt stdt1 stdt2 stdt3 noninvt noninvt1 noninvt2 noninvt3 diff);\n    \n    stdt1 = (v1t1 + v2t1 + v3t1) / 3;\n    stdt2 = (v1t2 + v2t2 + v3t2) / 3;\n    stdt3 = (v1t3 + v2t3 + v3t3) / 3;\n    \n    noninvt1 = (v4t1 + v5t1) / 2;\n    noninvt2 = (v4t2 + v5t2) / 2;\n    noninvt3 = (v4t3 + v5t3) / 2;\n    \n    stdt = (stdt1 + stdt2 + stdt3) / 3;\n    noninvt = (noninvt1 + noninvt2 + noninvt3) / 3;\n    \n    diff = noninvt - stdt;\n\nOUTPUT:\n    TECH9;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "mplus.html#sec-monteCarloMultigroup",
    "href": "mplus.html#sec-monteCarloMultigroup",
    "title": "Mplus",
    "section": "\n20.2 Multi-Group Model",
    "text": "20.2 Multi-Group Model\nTITLE: Multi-Group Monte Carlo Simulation with Ordinal Items and Common Factor;\n\nMONTECARLO:\n    NAMES = v1-v5; ! variable names\n    NGROUPS = 2; ! number of groups\n    NOBSERVATIONS = 500 300; ! number of participants in each sample\n    NREPS = 100000; ! number of samples to create\n    SEED = 52242; ! random seed\n    GENERATE = v1-v5 (3 p); ! specify the scale of the DVs; number of thresholds; probit (p)\n    CATEGORICAL = v1-v5; ! specify the variables that are (ordered) categorical\n\nANALYSIS:\n    PROCESSORS = 4 1; ! number of processors; number of threads\n    ESTIMATOR = WLSMV;\n    PARAMETERIZATION = THETA;\n\nMODEL POPULATION: ! tell Mplus how to generate the population data; can use asterisks (*) and at symbols (@) interchangeably here, but they differ in the MODEL command (see below); I use the same symbol as in the MODEL command\n    dep BY v1-v5*.7; ! factor loadings\n    [dep@0]; ! set factor mean to 0\n    dep@1; ! set factor variance to 1 (standardize)\n    [v1$1*0.5] (v1t1g1); [v1$2*1.0] (v1t2g1); [v1$3*1.5] (v1t3g1); ! item thresholds for v1\n    [v2$1*0.5] (v2t1g1); [v2$2*1.0] (v2t2g1); [v2$3*1.5] (v2t3g1); ! item thresholds for v2\n    [v3$1*0.5] (v3t1g1); [v3$2*1.0] (v3t2g1); [v3$3*1.5] (v3t3g1); ! item thresholds for v3\n    [v4$1*0.5] (v4t1g1); [v4$2*1.0] (v4t2g1); [v4$3*1.5] (v4t3g1); ! item thresholds for v4\n    [v5$1*0.5] (v5t1g1); [v5$2*1.0] (v5t2g1); [v5$3*1.5] (v5t3g1); ! item thresholds for v5\n    v1-v5@1; ! item residual variances\n    \nMODEL POPULATION-g2: ! tell Mplus how to generate the population data for group 2; can use asterisks (*) and at symbols (@) interchangeably here, but they differ in the MODEL command (see below); I use the same symbol as in the MODEL command\n    !dep BY v1-v5*.7; ! factor loadings\n    ![dep@0]; ! set factor mean to 0\n    !dep@1; ! set factor variance to 1 (standardize)\n    [v1$1*0.5] (v1t1g2); [v1$2*1.0] (v1t2g2); [v1$3*1.5] (v1t3g2); ! item thresholds for v1\n    [v2$1*0.5] (v2t1g2); [v2$2*1.0] (v2t2g2); [v2$3*1.5] (v2t3g2); ! item thresholds for v2\n    [v3$1*0.5] (v3t1g2); [v3$2*1.0] (v3t2g2); [v3$3*1.5] (v3t3g2); ! item thresholds for v3\n    [v4$1*0.0] (v4t1g2); [v4$2*0.5] (v4t2g2); [v4$3*1.0] (v4t3g2); ! item thresholds for v4\n    [v5$1*0.0] (v5t1g2); [v5$2*0.5] (v5t2g2); [v5$3*1.0] (v5t3g2); ! item thresholds for v5\n    !v1-v5@1; ! item residual variances\n\nMODEL: ! tell Mplus to estimate our model; asterisks (*) are free estimates with a starting value; at symbols (@) are fixed estimates\n    dep BY v1-v5*.7; ! factor loadings\n    [dep@0]; ! set factor mean to 0\n    dep@1; ! set factor variance to 1 (standardize)\n    [v1$1*0.5] (v1t1g1); [v1$2*1.0] (v1t2g1); [v1$3*1.5] (v1t3g1); ! item thresholds for v1\n    [v2$1*0.5] (v2t1g1); [v2$2*1.0] (v2t2g1); [v2$3*1.5] (v2t3g1); ! item thresholds for v2\n    [v3$1*0.5] (v3t1g1); [v3$2*1.0] (v3t2g1); [v3$3*1.5] (v3t3g1); ! item thresholds for v3\n    [v4$1*0.5] (v4t1g1); [v4$2*1.0] (v4t2g1); [v4$3*1.5] (v4t3g1); ! item thresholds for v4\n    [v5$1*0.5] (v5t1g1); [v5$2*1.0] (v5t2g1); [v5$3*1.5] (v5t3g1); ! item thresholds for v5\n    v1-v5@1; ! item residual variances\n   \nMODEL g2: ! tell Mplus to estimate our model in group 2; asterisks (*) are free estimates with a starting value; at symbols (@) are fixed estimates\n    !dep BY v1-v5*.7; ! factor loadings\n    ![dep@0]; ! set factor mean to 0\n    !dep@1; ! set factor variance to 1 (standardize)\n    [v1$1*0.5] (v1t1g2); [v1$2*1.0] (v1t2g2); [v1$3*1.5] (v1t3g2); ! item thresholds for v1\n    [v2$1*0.5] (v2t1g2); [v2$2*1.0] (v2t2g2); [v2$3*1.5] (v2t3g2); ! item thresholds for v2\n    [v3$1*0.5] (v3t1g2); [v3$2*1.0] (v3t2g2); [v3$3*1.5] (v3t3g2); ! item thresholds for v3\n    [v4$1*0.0] (v4t1g2); [v4$2*0.5] (v4t2g2); [v4$3*1.0] (v4t3g2); ! item thresholds for v4\n    [v5$1*0.0] (v5t1g2); [v5$2*0.5] (v5t2g2); [v5$3*1.0] (v5t3g2); ! item thresholds for v5\n    !v1-v5@1; ! item residual variances\n\nMODEL CONSTRAINT:\n    NEW (stdt1g1 stdt2g1 stdt3g1 stdt1g2 stdt2g2 stdt3g2\n    nonit1g1 nonit2g1 nonit3g1 nonit1g2 nonit2g2 nonit3g2\n    stdtg1 stdtg2 nonitg1 nonitg2 diffwg diffbg);\n    \n    stdt1g1 = (v1t1g1 + v2t1g1 + v3t1g1) / 3;\n    stdt2g1 = (v1t2g1 + v2t2g1 + v3t2g1) / 3;\n    stdt3g1 = (v1t3g1 + v2t3g1 + v3t3g1) / 3;\n    \n    stdt1g2 = (v1t1g2 + v2t1g2 + v3t1g2) / 3;\n    stdt2g2 = (v1t2g2 + v2t2g2 + v3t2g2) / 3;\n    stdt3g2 = (v1t3g2 + v2t3g2 + v3t3g2) / 3;\n    \n    nonit1g1 = (v4t1g1 + v5t1g1) / 2;\n    nonit2g1 = (v4t2g1 + v5t2g1) / 2;\n    nonit3g1 = (v4t3g1 + v5t3g1) / 2;\n    \n    nonit1g2 = (v4t1g2 + v5t1g2) / 2;\n    nonit2g2 = (v4t2g2 + v5t2g2) / 2;\n    nonit3g2 = (v4t3g2 + v5t3g2) / 2;\n    \n    stdtg1 = (stdt1g1 + stdt2g1 + stdt3g1) / 3;\n    stdtg2 = (stdt1g2 + stdt2g2 + stdt3g2) / 3;\n    \n    nonitg1 = (nonit1g1 + nonit2g1 + nonit3g1) / 3;\n    nonitg2 = (nonit1g2 + nonit2g2 + nonit3g2) / 3;\n    \n    diffwg = nonitg2 - stdtg2; ! difference within group\n    \n    diffbg = nonitg2 - nonitg1; ! difference between groups\n    \nOUTPUT:\n    TECH9;",
    "crumbs": [
      "About",
      "Mplus"
    ]
  },
  {
    "objectID": "abcdData.html",
    "href": "abcdData.html",
    "title": "ABCD Data",
    "section": "",
    "text": "The Adolescent Brain Cognitive Development (ABCD) Study is the largest long-term study of brain development and child health in the United States. This study explores how childhood experiences (such as sports, videogames, social media, unhealthy sleep patterns, and smoking) interact with each other and with a child’s changing biology to affect brain development and social, behavioral, academic, health, and other outcomes. The ABCD study follows a cohort of over 10,000 children from pre-adolescence into adulthood.",
    "crumbs": [
      "About",
      "ABCD Data"
    ]
  },
  {
    "objectID": "abcdData.html#sec-dataUseCertificate",
    "href": "abcdData.html#sec-dataUseCertificate",
    "title": "ABCD Data",
    "section": "3.1 Step 1: Data Use Certificate",
    "text": "3.1 Step 1: Data Use Certificate\nWork with Dr. Petersen to get added to the Data Use Certificate.",
    "crumbs": [
      "About",
      "ABCD Data"
    ]
  },
  {
    "objectID": "abcdData.html#sec-labProtocols",
    "href": "abcdData.html#sec-labProtocols",
    "title": "ABCD Data",
    "section": "3.2 Step 2: Read (and Follow) the Lab’s Protocols for Handling ABCD Data",
    "text": "3.2 Step 2: Read (and Follow) the Lab’s Protocols for Handling ABCD Data\n\nRead and follow the lab’s Data Security Protocols outlined above for handling ABCD data.\nRead and follow the lab’s Standard Operating Procedures (SOP) for handling ABCD data. The SOP is located at the following location of the lab’s LSS share: \\Lab\\Studies\\ABCD Data\\Security Requirements for Accessing Data\\.",
    "crumbs": [
      "About",
      "ABCD Data"
    ]
  },
  {
    "objectID": "abcdData.html#sec-connectRRDS",
    "href": "abcdData.html#sec-connectRRDS",
    "title": "ABCD Data",
    "section": "3.3 Step 3: Connect to the Research Remote Desktop Service (RRDS)",
    "text": "3.3 Step 3: Connect to the Research Remote Desktop Service (RRDS)\nTo access ABCD data, you need to access the Research Remote Desktop Service (RRDS).\n\nCreate an RRDS Account: https://its.uiowa.edu/services/research-remote-desktop-service\n\nInstructions for Windows: https://its.uiowa.edu/services/research-remote-desktop-service/connecting-rrds-using-windows-pc\nInstructions for Mac: https://its.uiowa.edu/services/research-remote-desktop-service/connecting-rrds-using-mac\n\nLog in to the RRDS using your HawkID and password\n\nIf you run into issues connecting to the RRDS, please reach out to PBS IT Support (PBS-help@uiowa.edu) or Research Computing Support (research-computing@uiowa.edu)",
    "crumbs": [
      "About",
      "ABCD Data"
    ]
  },
  {
    "objectID": "abcdData.html#sec-connectLSS",
    "href": "abcdData.html#sec-connectLSS",
    "title": "ABCD Data",
    "section": "3.4 Step 4: Connect to the ABCD LSS Server",
    "text": "3.4 Step 4: Connect to the ABCD LSS Server\nPlease contact Dr. Petersen to receive the network path for the ABCD Large Scale Storage (LSS) server.\nMapping the Server on Windows: Windows Explorer -&gt; This PC -&gt; Computer Tab -&gt; Map Network Drive button: \\\\server path\nMapping the Server on MacOS: Finder -&gt; Go menu -&gt; Connect to Server: smb://iowa\\hawkid:*@server path",
    "crumbs": [
      "About",
      "ABCD Data"
    ]
  },
  {
    "objectID": "abcdData.html#sec-accessManagement",
    "href": "abcdData.html#sec-accessManagement",
    "title": "ABCD Data",
    "section": "3.5 Access Management",
    "text": "3.5 Access Management\n[XXX]\nDr. Petersen can grant or revoke access to the share, or give other people roles if they are to manage the share using the Access Management tool: https://iam.uiowa.edu/access\n\nInstructions for granting or revoking access: https://its.uiowa.edu/support/article/118771\nDelegate management of share access: https://its.uiowa.edu/support/article/119191\n\nA few notes:\n\nWhen granting someone Read/Write or Read Only permissions and search for their name or ID, you may see both a HealthcareID and HawkID listed, select their HawkID.\nChanges take about an hour to propagate through Argon and will not be reflected in existing sessions.\nChanges are immediately reflected for SMB connections, however, users may have to remap/remount the volume or log out then back in for Windows/MacOS to be happy.",
    "crumbs": [
      "About",
      "ABCD Data"
    ]
  },
  {
    "objectID": "abcdData.html#sec-analysesProjects",
    "href": "abcdData.html#sec-analysesProjects",
    "title": "ABCD Data",
    "section": "4.1 Analyses Projects",
    "text": "4.1 Analyses Projects\nAnalyses Projects &gt; PetersenLab contains user folders for anyone working on projects with the ABCD data.\n\nCreate a folder with your HawkID as the folder name\nCreate a subfolder for your specific project\nFollow Petersen Lab template for structuring your project folder\nFollow the version control instructions below",
    "crumbs": [
      "About",
      "ABCD Data"
    ]
  },
  {
    "objectID": "abcdData.html#sec-data",
    "href": "abcdData.html#sec-data",
    "title": "ABCD Data",
    "section": "4.2 Data",
    "text": "4.2 Data\nThe folder Data &gt; Version 6.0 contains tabulated ABCD data.\nImaging data, wearables data, and concatenated data are available for download here\n\n[XXX] need instructions for accessing this\nNOTE: The file sizes for these data exceed the capacity of our LSS\n\n01-Raw contains the raw ABCD data files that should not be altered.\n02-Processed contains scored measures and other cleaned data for universal use.",
    "crumbs": [
      "About",
      "ABCD Data"
    ]
  },
  {
    "objectID": "abcdData.html#sec-fileTypes",
    "href": "abcdData.html#sec-fileTypes",
    "title": "ABCD Data",
    "section": "4.3 File types",
    "text": "4.3 File types\n\nJSON files: data dictionary/codebook files\nParquet files: columnar structured data (efficient for storage, can be used with the arrow package in R)\nTSV files: tab-separated value data files",
    "crumbs": [
      "About",
      "ABCD Data"
    ]
  },
  {
    "objectID": "abcdData.html#sec-availableMeasures",
    "href": "abcdData.html#sec-availableMeasures",
    "title": "ABCD Data",
    "section": "4.4 Available Measures",
    "text": "4.4 Available Measures\n[XXX] Add measures currently downloaded",
    "crumbs": [
      "About",
      "ABCD Data"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Data Analysis Guides for the Developmental Psychopathology Lab",
    "section": "",
    "text": "ABCD Data\nBayesian Analysis\nData Management\nDevelopmental Scaling\nDirected Acyclic Graphs\nElectroencephalography/Event-Related Potentials\nExploratory Data Analysis\nFactor Analysis\nFigures\nGit, GitLab, and GitHub\nHierarchical Linear Modeling\nHigh-Performance Computing\njamovi\nJATOS (Just Another Tool for Online Studies)\njsPsych\nItem Response Theory\nLAMP (Linux, Apache, MySQL, PHP) Server\nLongitudinal Data Analysis\nMarkdown\nMediation\nModeration/Interaction\nMplus\nMultiple Imputation\nOpen Science Framework\nPrincipal Component Analysis\nPython\nR\nRegression\nSPSS\nStatistics\nStructural Equation Modeling\n\n\n\n\n\n\nReuseCC BY 4.0"
  },
  {
    "objectID": "multipleImputation.html",
    "href": "multipleImputation.html",
    "title": "Multiple Imputation",
    "section": "",
    "text": "Code#install.packages(\"remotes\")\n#remotes::install_github(\"DevPsyLab/petersenlab\")\n\n\n\n\nCodelibrary(\"tidyverse\")\nlibrary(\"psych\")\nlibrary(\"mice\")\nlibrary(\"micemd\")\nlibrary(\"miceadds\")\nlibrary(\"mitml\")\nlibrary(\"Amelia\")\nlibrary(\"jomo\")\nlibrary(\"parallelly\")\nlibrary(\"future\")\nlibrary(\"furrr\")\nlibrary(\"nlme\")\nlibrary(\"lme4\")\nlibrary(\"broom.mixed\")\nlibrary(\"MplusAutomation\")\n\n\n\n\nCodedata(Oxboys, package = \"nlme\")\n\nOxboys_addNA &lt;- data.frame(Oxboys)\nOxboys_addNA &lt;- Oxboys_addNA %&gt;% \n  rename(id = Subject)\n\nOxboys_addNA$id &lt;- as.integer(Oxboys_addNA$id)\nOxboys_addNA$Occasion &lt;- as.integer(Oxboys_addNA$Occasion)\n\nset.seed(52242)\nOxboys_addNA[sample(1:nrow(Oxboys_addNA), 25), \"height\"] &lt;- NA\n\ndataToImpute &lt;- Oxboys_addNA",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#install-libraries",
    "href": "multipleImputation.html#install-libraries",
    "title": "Multiple Imputation",
    "section": "",
    "text": "Code#install.packages(\"remotes\")\n#remotes::install_github(\"DevPsyLab/petersenlab\")",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#load-libraries",
    "href": "multipleImputation.html#load-libraries",
    "title": "Multiple Imputation",
    "section": "",
    "text": "Codelibrary(\"tidyverse\")\nlibrary(\"psych\")\nlibrary(\"mice\")\nlibrary(\"micemd\")\nlibrary(\"miceadds\")\nlibrary(\"mitml\")\nlibrary(\"Amelia\")\nlibrary(\"jomo\")\nlibrary(\"parallelly\")\nlibrary(\"future\")\nlibrary(\"furrr\")\nlibrary(\"nlme\")\nlibrary(\"lme4\")\nlibrary(\"broom.mixed\")\nlibrary(\"MplusAutomation\")",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#data",
    "href": "multipleImputation.html#data",
    "title": "Multiple Imputation",
    "section": "",
    "text": "Codedata(Oxboys, package = \"nlme\")\n\nOxboys_addNA &lt;- data.frame(Oxboys)\nOxboys_addNA &lt;- Oxboys_addNA %&gt;% \n  rename(id = Subject)\n\nOxboys_addNA$id &lt;- as.integer(Oxboys_addNA$id)\nOxboys_addNA$Occasion &lt;- as.integer(Oxboys_addNA$Occasion)\n\nset.seed(52242)\nOxboys_addNA[sample(1:nrow(Oxboys_addNA), 25), \"height\"] &lt;- NA\n\ndataToImpute &lt;- Oxboys_addNA",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#for-mcarmar-missingness",
    "href": "multipleImputation.html#for-mcarmar-missingness",
    "title": "Multiple Imputation",
    "section": "\n3.1 For MCAR/MAR Missingness",
    "text": "3.1 For MCAR/MAR Missingness\n\nFull Information Maximum Likelihood (FIML)\nMultiple Imputation",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#for-mnar-missingness",
    "href": "multipleImputation.html#for-mnar-missingness",
    "title": "Multiple Imputation",
    "section": "\n3.2 For MNAR Missingness",
    "text": "3.2 For MNAR Missingness\nhttps://stefvanbuuren.name/fimd/sec-nonignorable.html (archived at https://perma.cc/N7WW-HDZF)\nhttps://cran.r-project.org/web/packages/missingHE/vignettes/Fitting_MNAR_models_in_missingHE.html (archived at https://perma.cc/9X25-5D8G)\n\nfind more data about the causes for the missingness\nsensitivity analyses (what-if analyses) to see how sensitive the results are under various scenarios\n\n\nhttps://stefvanbuuren.name/fimd/sec-MCAR.html (archived at https://perma.cc/9KM9-3NX3)\n\n\nselection models\n\nsimultaneously estimate the focal model and a missingness model, where the missingness model has the missing data indicator as a dependent variable, as predicted by the original dependent variable, the original predictors, and any additional covariates etc.\nif the missingness model is approximately correct, the focal model adjusts in way that removes nonresponse bias\nsimilar to a mediation process\n\nX → Y\nY → missingness\nX → missingness\n\n\n\nhttps://quantitudepod.org/s4e08-craig-enders/ (archived at https://perma.cc/FY9L-L3F7)\n\n\npattern-mixture models\n\nmissing data indicator is a predictor variable\nsimilar to a moderation process; subgroups of cases have different parameter estimates",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#specify-variables-to-impute",
    "href": "multipleImputation.html#specify-variables-to-impute",
    "title": "Multiple Imputation",
    "section": "\n6.1 Specify Variables to Impute",
    "text": "6.1 Specify Variables to Impute\n\nCodevarsToImpute &lt;- c(\"height\")\nY &lt;- varsToImpute",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#specify-number-of-imputations",
    "href": "multipleImputation.html#specify-number-of-imputations",
    "title": "Multiple Imputation",
    "section": "\n6.2 Specify Number of Imputations",
    "text": "6.2 Specify Number of Imputations\n\nCodenumImputations &lt;- 5 # generally use 100 imputations; this example uses 5 for speed",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#detect-cores",
    "href": "multipleImputation.html#detect-cores",
    "title": "Multiple Imputation",
    "section": "\n6.3 Detect Cores",
    "text": "6.3 Detect Cores\n\nCodenumCores &lt;- parallelly::availableCores() - 1",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#three-level-and-cross-classified-data",
    "href": "multipleImputation.html#three-level-and-cross-classified-data",
    "title": "Multiple Imputation",
    "section": "\n7.1 Three-Level and Cross-Classified Data",
    "text": "7.1 Three-Level and Cross-Classified Data\nhttps://simongrund1.github.io/posts/multiple-imputation-for-three-level-and-cross-classified-data/ (archived at https://perma.cc/N4PP-A3V6)",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#methods",
    "href": "multipleImputation.html#methods",
    "title": "Multiple Imputation",
    "section": "\n7.2 Methods",
    "text": "7.2 Methods\n\n7.2.1 mice\n\n\n7.2.1.1 Types\n\n7.2.1.1.1 Continuous Outcomes\nhttps://stefvanbuuren.name/fimd/sec-multioutcome.html#methods (archived at https://perma.cc/8CDA-TS3K)\n\nCode?mice::mice.impute.2l.norm\n?mice::mice.impute.2l.pan\n?mice::mice.impute.2l.lmer\n?miceadds::mice.impute.2l.pmm\n?miceadds::mice.impute.2l.contextual.pmm\n?miceadds::mice.impute.2l.continuous\n?micemd::mice.impute.2l.2stage.norm\n?micemd::mice.impute.2l.2stage.pmm\n?micemd::mice.impute.2l.glm.norm\n?micemd::mice.impute.2l.jomo\n\n\n\n7.2.1.1.2 Binary Outcomes\nhttps://stefvanbuuren.name/fimd/sec-catoutcome.html#methods-1 (archived at https://perma.cc/5QHF-YRP6)\n\nCode?mice::mice.impute.2l.bin\n?miceadds::mice.impute.2l.binary\n?miceadds::mice.impute.2l.pmm\n?miceadds::mice.impute.2l.contextual.pmm\n?micemd::mice.impute.2l.2stage.bin\n?micemd::mice.impute.2l.glm.bin\n\n\n\n7.2.1.1.3 Ordinal Outcomes\nhttps://stefvanbuuren.name/fimd/sec-multioutcome.html#methods (archived at https://perma.cc/8CDA-TS3K)\n\nCode?miceadds::mice.impute.2l.pmm\n?miceadds::mice.impute.2l.contextual.pmm\n?micemd::mice.impute.2l.2stage.pmm\n\n\n\n7.2.1.1.4 Count Outcomes\nhttps://stefvanbuuren.name/fimd/sec-catoutcome.html#methods-1 (archived at https://perma.cc/5QHF-YRP6)\n\nCode?micemd::mice.impute.2l.2stage.pois\n?micemd::mice.impute.2l.glm.pois\n?countimp::mice.impute.2l.poisson\n?countimp::mice.impute.2l.nb2\n?countimp::mice.impute.2l.zihnb\n\n\n\n7.2.1.2 Specifying the Imputation Method\n\nCodemeth &lt;- make.method(dataToImpute)\nmeth[1:length(meth)] &lt;- \"\"\nmeth[Y] &lt;- \"2l.pmm\" # specify the imputation method here; this can differ by outcome variable\n\n\n\n7.2.1.3 Specifying the Predictor Matrix\nA predictor matrix is a matrix of values, where:\n\ncolumns with non-zero values are predictors of the variable specified in the given row\nthe diagonal of the predictor matrix should be zero because a variable cannot predict itself\n\nThe values are:\n\nNOT a predictor of the outcome: 0\n\ncluster variable: -2\n\nfixed effect of predictor: 1\n\nfixed effect and random effect of predictor: 2\n\ninclude cluster mean of predictor in addition to fixed effect of predictor: 3\n\ninclude cluster mean of predictor in addition to fixed effect and random effect of predictor: 4\n\n\n\nCodepred &lt;- make.predictorMatrix(dataToImpute)\npred[1:nrow(pred), 1:ncol(pred)] &lt;- 0\npred[Y, \"id\"] &lt;- (-2) # cluster variable\npred[Y, \"Occasion\"] &lt;- 1 # fixed effect predictor\npred[Y, \"age\"] &lt;- 2 # random effect predictor\npred[Y, Y] &lt;- 1 # fixed effect predictor\n\ndiag(pred) &lt;- 0\npred\n\n         id age height Occasion\nid        0   0      0        0\nage       0   0      0        0\nheight   -2   2      0        1\nOccasion  0   0      0        0\n\n\n\n7.2.1.4 Syntax\n\nCodemi_mice &lt;- mice(\n  as.data.frame(dataToImpute),\n  method = meth,\n  predictorMatrix = pred,\n  m = numImputations,\n  maxit = 5, # generally use 100 maximum iterations; this example uses 5 for speed\n  seed = 52242)\n\n\n iter imp variable\n  1   1  height\n  1   2  height\n  1   3  height\n  1   4  height\n  1   5  height\n  2   1  height\n  2   2  height\n  2   3  height\n  2   4  height\n  2   5  height\n  3   1  height\n  3   2  height\n  3   3  height\n  3   4  height\n  3   5  height\n  4   1  height\n  4   2  height\n  4   3  height\n  4   4  height\n  4   5  height\n  5   1  height\n  5   2  height\n  5   3  height\n  5   4  height\n  5   5  height\n\n\n\n7.2.2 jomo\n\n\nCodelevel1Vars &lt;- c(\"height\")\nlevel2Vars &lt;- c(\"v3\",\"v4\")\nclusterVars &lt;- c(\"id\")\nfullyObservedCovariates &lt;- c(\"age\",\"Occasion\")\n\nset.seed(52242)\n\nmi_jomo &lt;- jomo(\n  Y = data.frame(dataToImpute[, level1Vars]),\n  #Y2 = data.frame(dataToImpute[, level2Vars]),\n  X = data.frame(dataToImpute[, fullyObservedCovariates]),\n  clus = data.frame(dataToImpute[, clusterVars]),\n  nimp = numImputations,\n  meth = \"random\"\n)\n\n\n\n7.2.3 Amelia\n\n\n\n! in the console output indicates that the current estimated complete data covariance matrix is not invertible\n\n* in the console output indicates that the likelihood has not monotonically increased in that step\n\n\nCodeboundVars &lt;- c(\"height\")\nboundCols &lt;- which(names(dataToImpute) %in% boundVars)\nboundLower &lt;- 100\nboundUpper &lt;- 200\n\nvarBounds &lt;- cbind(boundCols, boundLower, boundUpper)\n\nset.seed(52242)\n\nmi_amelia &lt;- amelia(\n  dataToImpute,\n  m = numImputations,\n  ts = \"age\",\n  cs = \"id\",\n  polytime = 1,\n  intercs = TRUE,\n  #ords = ordinalVars,\n  #bounds = varBounds,\n  parallel = \"snow\",\n  #ncpus = numCores,\n  empri = .01*nrow(dataToImpute)) # ridge prior for numerical stability\n\n-- Imputation 1 --\n\n  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20\n 21\n\n-- Imputation 2 --\n\n  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18\n\n-- Imputation 3 --\n\n  1  2  3  4  5  6  7  8\n\n-- Imputation 4 --\n\n  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20\n 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40\n 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60\n 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80\n 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100\n 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120\n 121 122 123\n\n-- Imputation 5 --\n\n  1  2  3  4  5  6  7  8  9 10 11 12\n\n\n\n7.2.4 Mplus\n\n\n7.2.4.1 Save Mplus Data File\nSave R object as Mplus data file:\n\nCodeprepareMplusData(dataToImpute, file.path(\"dataToImpute.dat\"))\n\n\n\n7.2.4.2 Mplus Syntax for Multilevel Imputation\nMplus syntax for multilevel imputation:\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n!!!!!  MPLUS SYNTAX LINES CANNOT EXCEED 90 CHARACTERS;\n!!!!!  VARIABLE NAMES AND PARAMETER LABELS CANNOT EXCEED 8 CHARACTERS EACH;\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\nTITLE: Model Title\n\nDATA: FILE = \"dataToImpute.dat\";\n\nVARIABLE:\n  NAMES = id age height Occasion;\n  MISSING = .;\n  USEVARIABLES ARE age height Occasion;\n  !CATEGORICAL ARE INSERT_NAMES_OF_CATEGORICAL_VARIABLES_HERE;\n  CLUSTER = id;\n\nANALYSIS:\n  TYPE = twolevel basic;\n  bseed = 52242;\n  PROCESSORS = 2;\n    \nDATA IMPUTATION:\n  IMPUTE = age(0-100) height Occasion; !put ' (c)' after categorical vars\n  NDATASETS = 100;\n  SAVE = imp*.dat\nPutting a range of values after a variable (e.g., 0-100) sets the lower and upper bounds of the imputed values. This would save a implist.dat file that can be used to run the model on the multiply imputed data, as shown here.",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#logged-events",
    "href": "multipleImputation.html#logged-events",
    "title": "Multiple Imputation",
    "section": "\n9.1 Logged Events",
    "text": "9.1 Logged Events\n\nCodemi_mice$loggedEvents\n\nNULL",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#trace-plots",
    "href": "multipleImputation.html#trace-plots",
    "title": "Multiple Imputation",
    "section": "\n9.2 Trace Plots",
    "text": "9.2 Trace Plots\nOn convergence, the streams of the trace plots should intermingle and be free of any trend (at the later iterations). Convergence is diagnosed when the variance between different sequences is no larger than the variance within each individual sequence.\n\n\nhttps://stefvanbuuren.name/fimd/sec-algoptions.html (archived at https://perma.cc/4S54-465R)\n\n\nCodeplot(mi_mice, c(\"height\"))",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#density-plots",
    "href": "multipleImputation.html#density-plots",
    "title": "Multiple Imputation",
    "section": "\n9.3 Density Plots",
    "text": "9.3 Density Plots\n\nCodedensityplot(mi_mice)\n\n\n\n\n\n\nCodedensityplot(mi_mice, ~ height)",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#strip-plots",
    "href": "multipleImputation.html#strip-plots",
    "title": "Multiple Imputation",
    "section": "\n9.4 Strip Plots",
    "text": "9.4 Strip Plots\n\nCodestripplot(mi_mice)\n\n\n\n\n\n\nCodestripplot(mi_mice, height ~ .imp)",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#modifycreate-new-variables",
    "href": "multipleImputation.html#modifycreate-new-variables",
    "title": "Multiple Imputation",
    "section": "\n10.1 Modify/Create New Variables",
    "text": "10.1 Modify/Create New Variables\n\n10.1.1 mice\n\n\nCodemi_mice_long &lt;- complete(\n  mi_mice,\n  action = \"long\",\n  include = TRUE)\n\nmi_mice_long$newVar &lt;- mi_mice_long$age * mi_mice_long$height\n\n\n\n10.1.2 jomo\n\n\nCodemi_jomo &lt;- mi_jomo %&gt;% \n  rename(height = dataToImpute...level1Vars.)\n\nmi_jomo$newVar &lt;- mi_jomo$age * mi_jomo$height\n\n\n\n10.1.3 Amelia\n\n\nCodefor(i in 1:length(mi_amelia$imputations)){\n  mi_amelia$imputations[[i]]$newVar &lt;- mi_amelia$imputations[[i]]$age * mi_amelia$imputations[[i]]$height\n}",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#convert-to-mids-object",
    "href": "multipleImputation.html#convert-to-mids-object",
    "title": "Multiple Imputation",
    "section": "\n10.2 Convert to mids object",
    "text": "10.2 Convert to mids object\n\n10.2.1 mice\n\n\nCodemi_mice_mids &lt;- as.mids(mi_mice_long)\n\n\n\n10.2.2 jomo\n\n\nCodemi_jomo_mids &lt;- miceadds::jomo2mids(mi_jomo)\n\n\n\n10.2.3 Amelia\n\n\nCodemi_amelia_mids &lt;- miceadds::datlist2mids(mi_amelia$imputations)",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#export-for-mplus",
    "href": "multipleImputation.html#export-for-mplus",
    "title": "Multiple Imputation",
    "section": "\n10.3 Export for Mplus\n",
    "text": "10.3 Export for Mplus\n\n\nCodemids2mplus(mi_mice_mids, path = file.path(\"InsertFilePathHere\", fsep = \"\"))\nmids2mplus(mi_jomo_mids, path = file.path(\"InsertFilePathHere\", fsep = \"\"))\nmids2mplus(mi_amelia_mids, path = file.path(\"InsertFilePathHere\", fsep = \"\"))",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#sec-multiple-regression",
    "href": "multipleImputation.html#sec-multiple-regression",
    "title": "Multiple Imputation",
    "section": "\n11.1 Multiple Regression",
    "text": "11.1 Multiple Regression\n\nCodefit_lm &lt;- with(\n  data = mi_mice,\n  expr = lm(height ~ age + Occasion))\n\n\n\n11.1.1 Pool Results Across Models\n\nCodefit_lm_pooled &lt;- mice::pool(fit_lm)\n\nfit_lm_pooled\n\nClass: mipo    m = 5 \n         term m   estimate      ubar          b         t dfcom       df\n1 (Intercept) 5 129.438605 474.39271 16.2213875 493.85838   231 202.6802\n2         age 5  -9.578321 313.63940 10.4968785 326.23565   231 203.4844\n3    Occasion 5   4.074297  19.66783  0.6460228  20.44305   231 204.1678\n         riv     lambda        fmi\n1 0.04103281 0.03941548 0.04875604\n2 0.04016158 0.03861091 0.04792289\n3 0.03941602 0.03792131 0.04720923\n\n\n\nCodesummary(fit_lm_pooled)",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "multipleImputation.html#sec-mixed-model",
    "href": "multipleImputation.html#sec-mixed-model",
    "title": "Multiple Imputation",
    "section": "\n11.2 Mixed Model",
    "text": "11.2 Mixed Model\n\nCodefit_lmer &lt;- with(\n  data = mi_mice,\n  expr = lme4::lmer(height ~ age + Occasion + (1|id)))\n\n\n\n11.2.1 Pool Results Across Models\n\nCodefit_lmer_pooled &lt;- mice::pool(fit_lmer)\n\nfit_lmer_pooled\n\nClass: mipo    m = 5 \n         term m  estimate       ubar          b          t dfcom       df\n1 (Intercept) 5 130.90722 115.993407 17.2741850 136.722429   229 91.41894\n2         age 5  -8.38242  75.323709 11.3734859  88.971892   229 90.20628\n3    Occasion 5   3.77516   4.723413  0.6938743   5.556062   229 92.62682\n        riv    lambda       fmi\n1 0.1787086 0.1516139 0.1695846\n2 0.1811937 0.1533988 0.1715650\n3 0.1762813 0.1498632 0.1676435\n\n\n\nCodesummary(fit_lmer_pooled)",
    "crumbs": [
      "About",
      "Multiple Imputation"
    ]
  },
  {
    "objectID": "irt.html",
    "href": "irt.html",
    "title": "Item Response Theory",
    "section": "",
    "text": "https://isaactpetersen.github.io/Principles-Psychological-Assessment/item-response-theory.html",
    "crumbs": [
      "About",
      "Item Response Theory"
    ]
  },
  {
    "objectID": "irt.html#parameter-logistic-model",
    "href": "irt.html#parameter-logistic-model",
    "title": "Item Response Theory",
    "section": "2.1 1-parameter logistic model",
    "text": "2.1 1-parameter logistic model\nhttps://isaactpetersen.github.io/Principles-Psychological-Assessment/item-response-theory.html#sec-irt-onePL",
    "crumbs": [
      "About",
      "Item Response Theory"
    ]
  },
  {
    "objectID": "irt.html#parameter-logistic-model-1",
    "href": "irt.html#parameter-logistic-model-1",
    "title": "Item Response Theory",
    "section": "2.2 2-parameter logistic model",
    "text": "2.2 2-parameter logistic model\nhttps://isaactpetersen.github.io/Principles-Psychological-Assessment/item-response-theory.html#sec-irt-twoPL",
    "crumbs": [
      "About",
      "Item Response Theory"
    ]
  },
  {
    "objectID": "irt.html#parameter-multi-dimensional-logistic-model",
    "href": "irt.html#parameter-multi-dimensional-logistic-model",
    "title": "Item Response Theory",
    "section": "2.3 2-parameter multi-dimensional logistic model",
    "text": "2.3 2-parameter multi-dimensional logistic model\nhttps://isaactpetersen.github.io/Principles-Psychological-Assessment/item-response-theory.html#sec-irt-twoPLmultidimensional",
    "crumbs": [
      "About",
      "Item Response Theory"
    ]
  },
  {
    "objectID": "irt.html#parameter-logistic-model-2",
    "href": "irt.html#parameter-logistic-model-2",
    "title": "Item Response Theory",
    "section": "2.4 3-parameter logistic model",
    "text": "2.4 3-parameter logistic model\nhttps://isaactpetersen.github.io/Principles-Psychological-Assessment/item-response-theory.html#sec-irt-threePL",
    "crumbs": [
      "About",
      "Item Response Theory"
    ]
  },
  {
    "objectID": "irt.html#parameter-logistic-model-3",
    "href": "irt.html#parameter-logistic-model-3",
    "title": "Item Response Theory",
    "section": "2.5 4-parameter logistic model",
    "text": "2.5 4-parameter logistic model\nhttps://isaactpetersen.github.io/Principles-Psychological-Assessment/item-response-theory.html#sec-irt-fourPL",
    "crumbs": [
      "About",
      "Item Response Theory"
    ]
  },
  {
    "objectID": "irt.html#graded-response-model",
    "href": "irt.html#graded-response-model",
    "title": "Item Response Theory",
    "section": "2.6 Graded response model",
    "text": "2.6 Graded response model\nhttps://isaactpetersen.github.io/Principles-Psychological-Assessment/item-response-theory.html#sec-irt-gradedResponseModel",
    "crumbs": [
      "About",
      "Item Response Theory"
    ]
  },
  {
    "objectID": "factorAnalysis.html",
    "href": "factorAnalysis.html",
    "title": "Factor Analysis",
    "section": "",
    "text": "1 Overview\nhttps://isaactpetersen.github.io/Principles-Psychological-Assessment/factor-analysis-pca.html\n\n\n2 Confirmatory Factor Analysis (CFA)\nOverview: https://isaactpetersen.github.io/Principles-Psychological-Assessment/factor-analysis-pca.html#sec-cfa\nCode examples: https://isaactpetersen.github.io/Principles-Psychological-Assessment/factor-analysis-pca.html#sec-cfaExamples\n\n\n3 Exploratory Factor Analysis (EFA)\nOverview: https://isaactpetersen.github.io/Principles-Psychological-Assessment/factor-analysis-pca.html#sec-efa\nCode examples: https://isaactpetersen.github.io/Principles-Psychological-Assessment/factor-analysis-pca.html#sec-efaExamples\n\n\n\n\n\n\nReuseCC BY 4.0",
    "crumbs": [
      "About",
      "Factor Analysis"
    ]
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About This Website",
    "section": "",
    "text": "The Data Analysis Guides for the Developmental Psychopathology Lab were generated with Quarto. The codebase that was used to generate the Data Analysis Guides is located here.\n\n1 Contact\nIf you have questions about the lab and are not sure who to contact, please contact devpsy-lab@uiowa.edu.\n\n2 License\n\n\nCC BY 4.0\n\nThis work is licensed under a Creative Commons Attribution 4.0 International License.\n\n\nCC BY 4.0\n\n\n3 Session Info\n\nCodesessionInfo()\n\nR version 4.5.2 (2025-10-31)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 24.04.3 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: UTC\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nloaded via a namespace (and not attached):\n [1] htmlwidgets_1.6.4 compiler_4.5.2    fastmap_1.2.0     cli_3.6.5        \n [5] tools_4.5.2       htmltools_0.5.9   otel_0.2.0        yaml_2.3.12      \n [9] rmarkdown_2.30    knitr_1.51        jsonlite_2.0.0    xfun_0.56        \n[13] digest_0.6.39     rlang_1.1.7       evaluate_1.0.5   \n\n\n\n\n\n\nReuseCC BY 4.0"
  },
  {
    "objectID": "dags.html",
    "href": "dags.html",
    "title": "Directed Acyclic Graphs (DAGs)",
    "section": "",
    "text": "When conceptualizing and designing a study, or when developing plans to test a research question, it is important to draw a directed acyclic graph (DAG). DAGs, like path diagrams, are causal diagrams. Causal diagrams depict the hypoothesized causal processes that link two or more variables. Path diagrams are typically used after analysis to describe and report the findings in analysis (when using path analysis, factor analysis, or structural equation modeling). By contrast, DAGs are particularly useful when designing a study or before analysis, because they can help specify which variables it is important to control for and—just as importantly—which variables it is important not to control for.\nWhen drawing a DAG for your study, draw all the variables that link the hypothesized cause to the hypothesized effect, including confounds, mediators, and colliders.\nIn your study, it is important to control for all confounds. In addition, it is okay to control for ancestors of the outcome variable that are not confounds or mediators. That is, it is okay to control for variables that influence Y that do not influence X and that are not influenced by X. When including these variable as control variables in a model, they are called precision variables. You do not need to include precision variables in the model because the estimate of the association is already unbiased if you have controlled for all confounds. However, including precision variables in the model reduces residual variance in the outcome variable and can yield more precise estimates (i.e., smaller standard errors) of the association between the predictor variable and outcome variable.\nIn addition, there are some variables that are important not to control for. It is important not to control for mediators of two variables for which you want to determine the estimate of the causal effect—unless you are interested in the direct causal effect of the predictor variable on the outcome variable above and beyond the mediator. In addition, it is is important not to control for a) ancestors of the predictor variable that are not confounds, b) descendants of the outcome variable, and c) colliders (unless the collider is also a confound).\nFor more information on DAGs, including ancestors, descendants, confounders, and colliders, see here: https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook/causal-inference.html#sec-causalDiagrams.\nAfter determining what variables are confounders and what are important to control for, there are various ways one can control for variables, as described here: https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook/causal-inference.html#sec-causalInferenceControlVariables.\n\n\n\n\n\nReuseCC BY 4.0",
    "crumbs": [
      "About",
      "Directed Acyclic Graphs"
    ]
  },
  {
    "objectID": "dataManagement.html",
    "href": "dataManagement.html",
    "title": "Data Management",
    "section": "",
    "text": "Importing data takes syntax of the following form for .csv files:\n\nCodedata &lt;- read.csv(\"filepath/filename.csv\")\n\n\nNote: it is important to use forward slashes (“/”) rather than backslashes (“\\”) when specifying filepaths in R.\nBelow, I import a .csv file and save it into an object called mydata (you could call this object whatever you want):\n\nCodemydata &lt;- read.csv(\"https://osf.io/s6wrm/download\")\n\n\nImporting data takes syntax of the following form for .RData files:\n\nCodeload(\"filepath/filename.RData\")\n\n\n\n\nCodedataNames &lt;- paste(\"data\", 1:100, sep = \"\")\ndataFilenames &lt;- paste(dataNames, \".csv\", sep = \"\")\ndataFilepaths &lt;- paste(\"C:/users/username/\", dataFilenames, sep = \"\")\n\ndata_list &lt;- lapply(dataFilepaths, read.csv) # lapply(dataFilepaths, data.table::fread) is even faster\nnames(data_list) &lt;- basename(dataFilepaths)\n\n\nAlternatively, if you want to load all .csv files in a directory, you can identify the filenames programmatically:\n\nCodedataFilenames &lt;- list.files(\n  path = \"C:/users/username/\",\n  pattern = \"\\\\.csv$\")\n\ndataFilepaths &lt;- list.files(\n  path = \"C:/users/username/\",\n  pattern = \"\\\\.csv$\",\n  full.names = TRUE)\n\ndata_list &lt;- lapply(dataFilepaths, read.csv) # lapply(dataFilepaths, data.table::fread) is even faster\nnames(data_list) &lt;- basename(dataFilepaths)",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#sec-importMultipleDataFiles",
    "href": "dataManagement.html#sec-importMultipleDataFiles",
    "title": "Data Management",
    "section": "",
    "text": "CodedataNames &lt;- paste(\"data\", 1:100, sep = \"\")\ndataFilenames &lt;- paste(dataNames, \".csv\", sep = \"\")\ndataFilepaths &lt;- paste(\"C:/users/username/\", dataFilenames, sep = \"\")\n\ndata_list &lt;- lapply(dataFilepaths, read.csv) # lapply(dataFilepaths, data.table::fread) is even faster\nnames(data_list) &lt;- basename(dataFilepaths)\n\n\nAlternatively, if you want to load all .csv files in a directory, you can identify the filenames programmatically:\n\nCodedataFilenames &lt;- list.files(\n  path = \"C:/users/username/\",\n  pattern = \"\\\\.csv$\")\n\ndataFilepaths &lt;- list.files(\n  path = \"C:/users/username/\",\n  pattern = \"\\\\.csv$\",\n  full.names = TRUE)\n\ndata_list &lt;- lapply(dataFilepaths, read.csv) # lapply(dataFilepaths, data.table::fread) is even faster\nnames(data_list) &lt;- basename(dataFilepaths)",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#is-equal-to",
    "href": "dataManagement.html#is-equal-to",
    "title": "Data Management",
    "section": "\n9.1 Is Equal To: ==\n",
    "text": "9.1 Is Equal To: ==\n\n\nCodemydata$survived == 1\n\n\n\n\n[1]  TRUE  TRUE FALSE FALSE FALSE  TRUE",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#is-not-equal-to",
    "href": "dataManagement.html#is-not-equal-to",
    "title": "Data Management",
    "section": "\n9.2 Is Not Equal To: !=\n",
    "text": "9.2 Is Not Equal To: !=\n\n\nCodemydata$survived != 1\n\n\n\n\n[1] FALSE FALSE  TRUE  TRUE  TRUE FALSE",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#greater-than",
    "href": "dataManagement.html#greater-than",
    "title": "Data Management",
    "section": "\n9.3 Greater Than: >\n",
    "text": "9.3 Greater Than: &gt;\n\n\nCodemydata$parch &gt; 1\n\n\n\n\n[1] FALSE  TRUE  TRUE  TRUE  TRUE FALSE",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#less-than",
    "href": "dataManagement.html#less-than",
    "title": "Data Management",
    "section": "\n9.4 Less Than: <\n",
    "text": "9.4 Less Than: &lt;\n\n\nCodemydata$parch &lt; 1\n\n\n\n\n[1]  TRUE FALSE FALSE FALSE FALSE  TRUE",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#greater-than-or-equal-to",
    "href": "dataManagement.html#greater-than-or-equal-to",
    "title": "Data Management",
    "section": "\n9.5 Greater Than or Equal To: >=\n",
    "text": "9.5 Greater Than or Equal To: &gt;=\n\n\nCodemydata$parch &gt;= 1\n\n\n\n\n[1] FALSE  TRUE  TRUE  TRUE  TRUE FALSE",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#less-than-or-equal-to",
    "href": "dataManagement.html#less-than-or-equal-to",
    "title": "Data Management",
    "section": "\n9.6 Less Than or Equal To: <=\n",
    "text": "9.6 Less Than or Equal To: &lt;=\n\n\nCodemydata$parch &lt;= 1\n\n\n\n\n[1]  TRUE FALSE FALSE FALSE FALSE  TRUE",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#is-in-a-value-of-another-vector-in",
    "href": "dataManagement.html#is-in-a-value-of-another-vector-in",
    "title": "Data Management",
    "section": "\n9.7 Is in a Value of Another Vector: %in%\n",
    "text": "9.7 Is in a Value of Another Vector: %in%\n\n\nCodeanotherVector &lt;- c(0,1)\nmydata$parch %in% anotherVector\n\n\n\n\n[1]  TRUE FALSE FALSE FALSE FALSE  TRUE",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#is-not-in-a-value-of-another-vector-ni",
    "href": "dataManagement.html#is-not-in-a-value-of-another-vector-ni",
    "title": "Data Management",
    "section": "\n9.8 Is Not in a Value of Another Vector: %ni%\n",
    "text": "9.8 Is Not in a Value of Another Vector: %ni%\n\nNote: this function is part of the petersenlab package and is not available in base R.\n\nCodemydata$parch %ni% anotherVector\n\n\n\n\n[1] FALSE  TRUE  TRUE  TRUE  TRUE FALSE",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#is-missing-is.na",
    "href": "dataManagement.html#is-missing-is.na",
    "title": "Data Management",
    "section": "\n9.9 Is Missing: is.na()\n",
    "text": "9.9 Is Missing: is.na()\n\n\nCodeis.na(mydata$prediction)\n\n\n\n\n[1] FALSE FALSE FALSE FALSE FALSE FALSE",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#is-not-missing-is.na",
    "href": "dataManagement.html#is-not-missing-is.na",
    "title": "Data Management",
    "section": "\n9.10 Is Not Missing: !is.na()\n",
    "text": "9.10 Is Not Missing: !is.na()\n\n\nCode!is.na(mydata$prediction)\n\n\n\n\n[1] TRUE TRUE TRUE TRUE TRUE TRUE",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#and",
    "href": "dataManagement.html#and",
    "title": "Data Management",
    "section": "\n9.11 And: &\n",
    "text": "9.11 And: &\n\n\nCode!is.na(mydata$prediction) & mydata$parch &gt;= 1\n\n\n\n\n[1] FALSE  TRUE  TRUE  TRUE  TRUE FALSE",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#or",
    "href": "dataManagement.html#or",
    "title": "Data Management",
    "section": "\n9.12 Or: |\n",
    "text": "9.12 Or: |\n\n\nCodeis.na(mydata$prediction) | mydata$parch &gt;= 1\n\n\n\n\n[1] FALSE  TRUE  TRUE  TRUE  TRUE FALSE",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#one-variable",
    "href": "dataManagement.html#one-variable",
    "title": "Data Management",
    "section": "\n11.1 One Variable",
    "text": "11.1 One Variable\nTo subset one variable, use the following syntax:\n\nCodemydata$age\n\n\n\n\n[1] 29.00  0.92  2.00 30.00 25.00 48.00\n\n\nor:\n\nCodemydata[,\"age\"]\n\n\n\n\n[1] 29.00  0.92  2.00 30.00 25.00 48.00",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#particular-rows-of-one-variable",
    "href": "dataManagement.html#particular-rows-of-one-variable",
    "title": "Data Management",
    "section": "\n11.2 Particular Rows of One Variable",
    "text": "11.2 Particular Rows of One Variable\nTo subset one variable, use the following syntax:\n\nCodemydata$age[which(mydata$survived == 1)]\n\n\n\n\n[1] 29.00  0.92 48.00 63.00 53.00 18.00\n\n\nor:\n\nCodemydata[which(mydata$survived == 1), \"age\"]\n\n\n\n\n[1] 29.00  0.92 48.00 63.00 53.00 18.00",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#particular-columns-variables",
    "href": "dataManagement.html#particular-columns-variables",
    "title": "Data Management",
    "section": "\n11.3 Particular Columns (Variables)",
    "text": "11.3 Particular Columns (Variables)\nTo subset particular columns/variables, use the following syntax:\n\n11.3.1 Base R\n\n\nCodesubsetVars &lt;- c(\"survived\",\"age\",\"prediction\")\n\nmydata[,c(1,2,3)]\n\n\n  \n\n\nCodemydata[,c(\"survived\",\"age\",\"prediction\")]\n\n\n  \n\n\nCodemydata[,subsetVars]\n\n\n  \n\n\n\nOr, to drop columns:\n\nCodedropVars &lt;- c(\"sibsp\",\"parch\")\n\nmydata[,-c(5,6)]\n\n\n  \n\n\nCodemydata[,names(mydata) %ni% c(\"sibsp\",\"parch\")]\n\n\n  \n\n\nCodemydata[,names(mydata) %ni% dropVars]\n\n\n  \n\n\n\n\n11.3.2 Tidyverse\n\nCodemydata %&gt;%\n  select(survived, age, prediction)\n\n\n  \n\n\nCodemydata %&gt;%\n  select(survived:prediction)\n\n\n  \n\n\nCodemydata %&gt;%\n  select(all_of(subsetVars))\n\n\n  \n\n\n\nOr, to drop columns:\n\nCodemydata %&gt;%\n  select(-sibsp, -parch)\n\n\n  \n\n\nCodemydata %&gt;%\n  select(-c(sibsp:parch))\n\n\n  \n\n\nCodemydata %&gt;%\n  select(-all_of(dropVars))",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#particular-rows",
    "href": "dataManagement.html#particular-rows",
    "title": "Data Management",
    "section": "\n11.4 Particular Rows",
    "text": "11.4 Particular Rows\nTo subset particular rows, use the following syntax:\n\n11.4.1 Base R\n\n\nCodesubsetRows &lt;- c(1,3,5)\n\nmydata[c(1,3,5),]\n\n\n  \n\n\nCodemydata[subsetRows,]\n\n\n  \n\n\nCodemydata[which(mydata$survived == 1),]\n\n\n  \n\n\n\n\n11.4.2 Tidyverse\n\nCodemydata %&gt;%\n  filter(survived == 1)\n\n\n  \n\n\nCodemydata %&gt;%\n  filter(survived == 1, parch &lt;= 1)\n\n\n  \n\n\nCodemydata %&gt;%\n  filter(survived == 1 | parch &lt;= 1)",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#particular-rows-and-columns",
    "href": "dataManagement.html#particular-rows-and-columns",
    "title": "Data Management",
    "section": "\n11.5 Particular Rows and Columns",
    "text": "11.5 Particular Rows and Columns\nTo subset particular rows and columns, use the following syntax:\n\n11.5.1 Base R\n\n\nCodemydata[c(1,3,5), c(1,2,3)]\n\n\n  \n\n\nCodemydata[subsetRows, subsetVars]\n\n\n  \n\n\nCodemydata[which(mydata$survived == 1), subsetVars]\n\n\n  \n\n\n\n\n11.5.2 Tidyverse\n\nCodemydata %&gt;%\n  filter(survived == 1) %&gt;%\n  select(all_of(subsetVars))",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#all-data",
    "href": "dataManagement.html#all-data",
    "title": "Data Management",
    "section": "\n12.1 All Data",
    "text": "12.1 All Data\nTo view data, use the following syntax:\n\nCodeView(mydata)",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#first-6-rowselements",
    "href": "dataManagement.html#first-6-rowselements",
    "title": "Data Management",
    "section": "\n12.2 First 6 Rows/Elements",
    "text": "12.2 First 6 Rows/Elements\nTo view only the first six rows (if a data frame) or elements (if a vector), use the following syntax:\n\nCodehead(mydata)\n\n\n  \n\n\nCodehead(mydata$age)\n\n[1] 29.00  0.92  2.00 30.00 25.00 48.00",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#data-structure",
    "href": "dataManagement.html#data-structure",
    "title": "Data Management",
    "section": "\n14.1 Data Structure",
    "text": "14.1 Data Structure\n\nCodestr(mydata)\n\n'data.frame':   1046 obs. of  7 variables:\n $ survived  : int  1 1 0 0 0 1 1 0 1 0 ...\n $ pclass    : int  1 1 1 1 1 1 1 1 1 1 ...\n $ sex       : chr  \"female\" \"male\" \"female\" \"male\" ...\n $ age       : num  29 0.92 2 30 25 48 63 39 53 71 ...\n $ sibsp     : int  0 1 1 1 1 0 1 0 2 0 ...\n $ parch     : int  0 2 2 2 2 0 0 0 0 0 ...\n $ prediction: num  0.945 0.784 0.979 0.516 0.946 ...",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#data-dimensions",
    "href": "dataManagement.html#data-dimensions",
    "title": "Data Management",
    "section": "\n14.2 Data Dimensions",
    "text": "14.2 Data Dimensions\nNumber of rows and columns:\n\nCodedim(mydata)\n\n[1] 1046    7",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#number-of-elements",
    "href": "dataManagement.html#number-of-elements",
    "title": "Data Management",
    "section": "\n14.3 Number of Elements",
    "text": "14.3 Number of Elements\n\nCodelength(mydata$age)\n\n[1] 1046",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#number-of-missing-elements",
    "href": "dataManagement.html#number-of-missing-elements",
    "title": "Data Management",
    "section": "\n14.4 Number of Missing Elements",
    "text": "14.4 Number of Missing Elements\n\nCodelength(mydata$age[which(is.na(mydata$age))])\n\n[1] 0",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#number-of-non-missing-elements",
    "href": "dataManagement.html#number-of-non-missing-elements",
    "title": "Data Management",
    "section": "\n14.5 Number of Non-Missing Elements",
    "text": "14.5 Number of Non-Missing Elements\n\nCodelength(mydata$age[which(!is.na(mydata$age))])\n\n[1] 1046\n\nCodelength(na.omit(mydata$age))\n\n[1] 1046",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#overview",
    "href": "dataManagement.html#overview",
    "title": "Data Management",
    "section": "\n20.1 Overview",
    "text": "20.1 Overview\nMerging (also called joining) merges two data objects using a shared set of variables called “keys.” The keys are the variable(s) that uniquely identify each row (i.e., they account for the levels of nesting). In some data objects, the key might be the participant’s ID (e.g., participantID). However, some data objects have multiple keys. For instance, in long form data objects, each participant may have multiple rows corresponding to multiple timepoints. In this case, the keys are participantID and timepoint. If a participant has multiple rows corresponding to timepoints and measures, the keys are participantID, timepoint, and measure. In general, each row should have a value on each of the keys; there should be no missingness in the keys.\nTo merge two objects, the keys must be present in both objects. The keys are used to merge the variables in object 1 (x) with the variables in object 2 (y). Different merge types select different rows to merge.\nNote: if the two objects include variables with the same name (apart from the keys), R will not know how you want each to appear in the merged object. So, it will add a suffix (e.g., .x, .y) to each common variable to indicate which object (i.e., object x or object y) the variable came from, where object x is the first object—i.e., the object to which object y (the second object) is merged. In general, apart from the keys, you should not include variables with the same name in two objects to be merged. To prevent this, either remove or rename the shared variable in one of the objects, or include the shared variable as a key. However, as described above, you should include it as a key only if it uniquely identifies each row in terms of levels of nesting.",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#data-before-merging",
    "href": "dataManagement.html#data-before-merging",
    "title": "Data Management",
    "section": "\n20.2 Data Before Merging",
    "text": "20.2 Data Before Merging\nHere are the data in the mydata object:\n\nCodemydata\n\n\n  \n\n\nCodedim(mydata)\n\n[1] 1046   14\n\n\nHere are the data in the mydata2 object:\n\nCodemydata2\n\n\n  \n\n\nCodedim(mydata2)\n\n[1] 10  2",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#sec-mergeTypes",
    "href": "dataManagement.html#sec-mergeTypes",
    "title": "Data Management",
    "section": "\n20.3 Types of Joins",
    "text": "20.3 Types of Joins\n\n20.3.1 Visual Overview of Join Types\nBelow is a visual that depicts various types of merges/joins. Object x is the circle labeled as A. Object y is the circle labeled as B. The area of overlap in the Venn diagram indicates the rows on the keys that are shared between the two objects (e.g., participantID values 1, 2, and 3). The non-overlapping area indicates the rows on the keys that are unique to each object (e.g., participantID values 4, 5, and 6 in Object x and values 7, 8, and 9 in Object y). The shaded yellow area indicates which rows (on the keys) are kept in the merged object from each of the two objects, when using each of the merge types. For instance, a left outer join keeps the shared rows and the rows that are unique to object x, but it drops the rows that are unique to object y.\n\n\nTypes of merges/joins\n\nImage source: Predictive Hacks (archived at: https://perma.cc/WV7U-BS68)\n\n20.3.2 Full Outer Join\nA full outer join includes all rows in \\(x\\) or \\(y\\). It returns columns from \\(x\\) and \\(y\\). Here is how to merge two data frames using a full outer join (i.e., “full join”):\n\nCodefullJoinData &lt;- merge(mydata, mydata2, by = \"ID\", all = TRUE)\n\nfullJoinData\n\n\n  \n\n\nCodedim(fullJoinData)\n\n[1] 1051   15\n\n\nOr, alternatively, using tidyverse:\n\nCodefull_join(mydata, mydata2, by = \"ID\")\n\n\n  \n\n\n\n\n20.3.3 Left Outer Join\nA left outer join includes all rows in \\(x\\). It returns columns from \\(x\\) and \\(y\\). Here is how to merge two data frames using a left outer join (“left join”):\n\nCodeleftJoinData &lt;- merge(mydata, mydata2, by = \"ID\", all.x = TRUE)\n\nleftJoinData\n\n\n  \n\n\nCodedim(leftJoinData)\n\n[1] 1046   15\n\n\nOr, alternatively, using tidyverse:\n\nCodeleft_join(mydata, mydata2, by = \"ID\")\n\n\n  \n\n\n\n\n20.3.4 Right Outer Join\nA right outer join includes all rows in \\(y\\). It returns columns from \\(x\\) and \\(y\\). Here is how to merge two data frames using a right outer join (“right join”):\n\nCoderightJoinData &lt;- merge(mydata, mydata2, by = \"ID\", all.y = TRUE)\n\nrightJoinData\n\n\n  \n\n\nCodedim(rightJoinData)\n\n[1] 10 15\n\n\nOr, alternatively, using tidyverse:\n\nCoderight_join(mydata, mydata2, by = \"ID\")\n\n\n  \n\n\n\n\n20.3.5 Inner Join\nAn inner join includes all rows that are in both \\(x\\) and \\(y\\). An inner join will return one row of \\(x\\) for each matching row of \\(y\\), and can duplicate values of records on either side (left or right) if \\(x\\) and \\(y\\) have more than one matching record. It returns columns from \\(x\\) and \\(y\\). Here is how to merge two data frames using an inner join:\n\nCodeinnerJoinData &lt;- merge(mydata, mydata2, by = \"ID\", all.x = FALSE, all.y = FALSE)\n\ninnerJoinData\n\n\n  \n\n\nCodedim(innerJoinData)\n\n[1]  5 15\n\n\nOr, alternatively, using tidyverse:\n\nCodeinner_join(mydata, mydata2, by = \"ID\")\n\n\n  \n\n\n\n\n20.3.6 Semi Join\nA semi join is a filter. A left semi join returns all rows from \\(x\\) with a match in \\(y\\). That is, it filters out records from \\(x\\) that are not in \\(y\\). Unlike an inner join, a left semi join will never duplicate rows of \\(x\\), and it includes columns from only \\(x\\) (not from \\(y\\)). Here is how to merge two data frames using a left semi join:\n\nCodesemiJoinData &lt;- semi_join(mydata, mydata2, by = \"ID\")\n\nsemiJoinData\n\n\n  \n\n\nCodedim(semiJoinData)\n\n[1]  5 14\n\n\n\n20.3.7 Anti Join\nAn anti join is a filter. A left anti join returns all rows from \\(x\\) without a match in \\(y\\). That is, it filters out records from \\(x\\) that are in \\(y\\). It returns columns from only \\(x\\) (not from \\(y\\)). Here is how to merge two data frames using a left anti join:\n\nCodeantiJoinData &lt;- anti_join(mydata, mydata2, by = \"ID\")\n\nantiJoinData\n\n\n  \n\n\nCodedim(antiJoinData)\n\n[1] 1041   14\n\n\n\n20.3.8 Cross Join\nA cross join combines each row in \\(x\\) with each row in \\(y\\).\n\nCodecrossJoinData &lt;- cross_join(\n  data.frame(rater = c(\"Mother\",\"Father\",\"Teacher\")),\n  data.frame(timepoint = 1:3))\n\ncrossJoinData\n\n\n  \n\n\nCodedim(crossJoinData)\n\n[1] 9 2",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "dataManagement.html#sec-createFunction",
    "href": "dataManagement.html#sec-createFunction",
    "title": "Data Management",
    "section": "\n24.1 Create a Function",
    "text": "24.1 Create a Function\nNow, let’s put together what we have learned to create a useful function. Functions are useful if you want to perform an operation multiple times. Any operation that you want to perform multiple times, you can create a function to accomplish. Use of a function can save you time without needed to retype out all of the code each time. For instance, let’s say you want to convert temperature between Fahrenheit and Celsius, you could create a function to do that. In this case, our function has two arguments: temperature (in degrees) and unit of the original temperature (F for Fahrenheit or C for Celsius, where the default unit is Fahrenheit).\n\nCodeconvert_temperature &lt;- function(temperature, unit = \"F\"){\n  if(unit == \"F\"){ # if the input temperature(s) in Fahrenheit\n    newtemp &lt;- (temperature - 32) / (9/5)\n  } else if(unit == \"C\"){ # if the input temperature(s) in Celsius\n    newtemp &lt;- (temperature * (9/5)) + 32\n  }\n  \n  return(newtemp)\n}\n\n\nNow we can use the function to convert temperatures between Fahrenheit and Celsius. A temperature of 32°F is equal to 0°C. A temperature of 0°C is equal to 89.6°F.\n\nCodeconvert_temperature(\n  temperature = 32,\n  unit = \"F\"\n)\n\n[1] 0\n\nCodeconvert_temperature(\n  temperature = 32,\n  unit = \"C\"\n)\n\n[1] 89.6\n\n\nWe can also convert the temperature for a vector of values at once:\n\nCodeconvert_temperature(\n  temperature = c(0, 10, 20, 30, 40, 50),\n  unit = \"F\"\n)\n\n[1] -17.777778 -12.222222  -6.666667  -1.111111   4.444444  10.000000\n\nCodeconvert_temperature(\n  temperature = c(0, 10, 20, 30, 40, 50),\n  unit = \"C\"\n)\n\n[1]  32  50  68  86 104 122\n\n\nBecause the default unit is “F”, we do not need to specify the unit if our input temperatures are in Fahrenheit:\n\nCodeconvert_temperature(\n  c(0, 10, 20, 30, 40, 50)\n)\n\n[1] -17.777778 -12.222222  -6.666667  -1.111111   4.444444  10.000000",
    "crumbs": [
      "About",
      "Data Management"
    ]
  },
  {
    "objectID": "regression.html",
    "href": "regression.html",
    "title": "Regression",
    "section": "",
    "text": "Code#install.packages(\"remotes\")\n#remotes::install_github(\"DevPsyLab/petersenlab\")\n\n\n\n\nCodelibrary(\"petersenlab\")\nlibrary(\"MASS\")\nlibrary(\"tidyverse\")\nlibrary(\"psych\")\nlibrary(\"rms\")\nlibrary(\"robustbase\")\nlibrary(\"brms\")\nlibrary(\"cvTools\")\nlibrary(\"car\")\nlibrary(\"mgcv\")\nlibrary(\"AER\")\nlibrary(\"foreign\")\nlibrary(\"olsrr\")\nlibrary(\"quantreg\")\nlibrary(\"mblm\")\nlibrary(\"effects\")\nlibrary(\"correlation\")\nlibrary(\"interactions\")\nlibrary(\"lavaan\")\nlibrary(\"regtools\")\nlibrary(\"mice\")\nlibrary(\"XICOR\")\nlibrary(\"cocor\")\nlibrary(\"effectsize\")\nlibrary(\"rockchalk\")\nlibrary(\"yhat\")",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#install-libraries",
    "href": "regression.html#install-libraries",
    "title": "Regression",
    "section": "",
    "text": "Code#install.packages(\"remotes\")\n#remotes::install_github(\"DevPsyLab/petersenlab\")",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#load-libraries",
    "href": "regression.html#load-libraries",
    "title": "Regression",
    "section": "",
    "text": "Codelibrary(\"petersenlab\")\nlibrary(\"MASS\")\nlibrary(\"tidyverse\")\nlibrary(\"psych\")\nlibrary(\"rms\")\nlibrary(\"robustbase\")\nlibrary(\"brms\")\nlibrary(\"cvTools\")\nlibrary(\"car\")\nlibrary(\"mgcv\")\nlibrary(\"AER\")\nlibrary(\"foreign\")\nlibrary(\"olsrr\")\nlibrary(\"quantreg\")\nlibrary(\"mblm\")\nlibrary(\"effects\")\nlibrary(\"correlation\")\nlibrary(\"interactions\")\nlibrary(\"lavaan\")\nlibrary(\"regtools\")\nlibrary(\"mice\")\nlibrary(\"XICOR\")\nlibrary(\"cocor\")\nlibrary(\"effectsize\")\nlibrary(\"rockchalk\")\nlibrary(\"yhat\")",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#linear-regression-model",
    "href": "regression.html#linear-regression-model",
    "title": "Regression",
    "section": "\n5.1 Linear regression model",
    "text": "5.1 Linear regression model\n\nCodemultipleRegressionModel &lt;- lm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude)\n\nsummary(multipleRegressionModel)\n\n\nCall:\nlm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    data = mydata, na.action = na.exclude)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8.3755 -1.2337 -0.2212  0.9911 12.8017 \n\nCoefficients:\n                        Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)              1.19830    0.05983  20.029  &lt; 2e-16 ***\nbpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***\nbpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.979 on 2871 degrees of freedom\n  (8656 observations deleted due to missingness)\nMultiple R-squared:  0.262, Adjusted R-squared:  0.2615 \nF-statistic: 509.6 on 2 and 2871 DF,  p-value: &lt; 2.2e-16\n\nCodeconfint(multipleRegressionModel)\n\n                            2.5 %    97.5 %\n(Intercept)             1.0809881 1.3156128\nbpi_antisocialT1Sum     0.4290884 0.5019688\nbpi_anxiousDepressedSum 0.1035825 0.2179258\n\nCodeprint(effectsize::standardize_parameters(multipleRegressionModel), digits = 2)\n\n# Standardization method: refit\n\nParameter               | Std. Coef. |        95% CI\n----------------------------------------------------\n(Intercept)             |   1.62e-16 | [-0.03, 0.03]\nbpi antisocialT1Sum     |       0.46 | [ 0.42, 0.49]\nbpi anxiousDepressedSum |       0.10 | [ 0.06, 0.14]\n\n\n\n5.1.1 Remove missing data\n\nCodemultipleRegressionModelNoMissing &lt;- lm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.omit)\n\nmultipleRegressionModelNoMissing &lt;- lm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata %&gt;% select(bpi_antisocialT2Sum, bpi_antisocialT1Sum, bpi_anxiousDepressedSum) %&gt;% na.omit)",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#linear-regression-model-on-correlationcovariance-matrix-for-pairwise-deletion",
    "href": "regression.html#linear-regression-model-on-correlationcovariance-matrix-for-pairwise-deletion",
    "title": "Regression",
    "section": "\n5.2 Linear regression model on correlation/covariance matrix (for pairwise deletion)",
    "text": "5.2 Linear regression model on correlation/covariance matrix (for pairwise deletion)\n\nCodemultipleRegressionModelPairwise &lt;- psych::setCor(\n  y = \"bpi_antisocialT2Sum\",\n  x = c(\"bpi_antisocialT1Sum\",\"bpi_anxiousDepressedSum\"),\n  data = cov(mydata[,c(\"bpi_antisocialT2Sum\",\"bpi_antisocialT1Sum\",\"bpi_anxiousDepressedSum\")], use = \"pairwise.complete.obs\"),\n  n.obs = nrow(mydata))\n\n\n\n\n\n\nCodesummary(multipleRegressionModelPairwise)\n\n\nMultiple Regression from matrix input \npsych::setCor(y = \"bpi_antisocialT2Sum\", x = c(\"bpi_antisocialT1Sum\", \n    \"bpi_anxiousDepressedSum\"), data = cov(mydata[, c(\"bpi_antisocialT2Sum\", \n    \"bpi_antisocialT1Sum\", \"bpi_anxiousDepressedSum\")], use = \"pairwise.complete.obs\"), \n    n.obs = nrow(mydata))\n\nMultiple Regression from matrix input \n\nBeta weights \n                        bpi_antisocialT2Sum\nbpi_antisocialT1Sum                    0.46\nbpi_anxiousDepressedSum                0.09\n\nMultiple R \nbpi_antisocialT2Sum \n               0.51 \n\nMultiple R2 \nbpi_antisocialT2Sum \n               0.26 \n\nCohen's set correlation R2 \n[1] 0.26\n\nSquared Canonical Correlations\nNULL\n\nCodemultipleRegressionModelPairwise[c(\"coefficients\",\"se\",\"Probability\",\"R2\",\"shrunkenR2\")]\n\n$coefficients\n                        bpi_antisocialT2Sum\nbpi_antisocialT1Sum               0.4560961\nbpi_anxiousDepressedSum           0.0899642\n\n$se\n                        bpi_antisocialT2Sum\nbpi_antisocialT1Sum             0.009253718\nbpi_anxiousDepressedSum         0.009253718\n\n$Probability\n                        bpi_antisocialT2Sum\nbpi_antisocialT1Sum            0.000000e+00\nbpi_anxiousDepressedSum        2.959352e-22\n\n$R2\nbpi_antisocialT2Sum \n           0.256918 \n\n$shrunkenR2\nbpi_antisocialT2Sum \n           0.256789",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#linear-regression-model-with-robust-covariance-matrix-rms",
    "href": "regression.html#linear-regression-model-with-robust-covariance-matrix-rms",
    "title": "Regression",
    "section": "\n5.3 Linear regression model with robust covariance matrix (rms)",
    "text": "5.3 Linear regression model with robust covariance matrix (rms)\n\nCodermsMultipleRegressionModel &lt;- robcov(ols(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  x = TRUE,\n  y = TRUE))\n\nrmsMultipleRegressionModel\n\nFrequencies of Missing Values Due to Each Variable\n    bpi_antisocialT2Sum     bpi_antisocialT1Sum bpi_anxiousDepressedSum \n                   7501                    7613                    7616 \n\nLinear Regression Model\n\nols(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    data = mydata, x = TRUE, y = TRUE)\n\n                Model Likelihood    Discrimination    \n                      Ratio Test           Indexes    \nObs    2874    LR chi2    873.09    R2       0.262    \nsigma1.9786    d.f.            2    R2 adj   0.261    \nd.f.   2871    Pr(&gt; chi2) 0.0000    g        1.278    \n\nResiduals\n\n    Min      1Q  Median      3Q     Max \n-8.3755 -1.2337 -0.2212  0.9911 12.8017 \n\n                        Coef   S.E.   t     Pr(&gt;|t|)\nIntercept               1.1983 0.0622 19.26 &lt;0.0001 \nbpi_antisocialT1Sum     0.4655 0.0229 20.30 &lt;0.0001 \nbpi_anxiousDepressedSum 0.1608 0.0330  4.87 &lt;0.0001 \n\nCodeconfint(rmsMultipleRegressionModel)\n\n                             2.5 %    97.5 %\nIntercept               1.07631713 1.3202837\nbpi_antisocialT1Sum     0.42056957 0.5104877\nbpi_anxiousDepressedSum 0.09606644 0.2254418\n\nCodeprint(effectsize::standardize_parameters(rmsMultipleRegressionModel), digits = 2)\n\n# Standardization method: refit\n\nParameter               | Std. Coef. |        95% CI\n----------------------------------------------------\nIntercept               |   1.62e-16 | [-0.03, 0.03]\nbpi antisocialT1Sum     |       0.46 | [ 0.42, 0.49]\nbpi anxiousDepressedSum |       0.10 | [ 0.06, 0.14]",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#robust-linear-regression-mm-type-iteratively-reweighted-least-squares-regression",
    "href": "regression.html#robust-linear-regression-mm-type-iteratively-reweighted-least-squares-regression",
    "title": "Regression",
    "section": "\n5.4 Robust linear regression (MM-type iteratively reweighted least squares regression)",
    "text": "5.4 Robust linear regression (MM-type iteratively reweighted least squares regression)\n\nCoderobustLinearRegression &lt;- lmrob(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude)\n\nsummary(robustLinearRegression)\n\n\nCall:\nlmrob(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    data = mydata, na.action = na.exclude)\n \\--&gt; method = \"MM\"\nResiduals:\n     Min       1Q   Median       3Q      Max \n-8.43518 -1.06680 -0.06707  1.14090 13.05599 \n\nCoefficients:\n                        Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)              0.94401    0.05406  17.464  &lt; 2e-16 ***\nbpi_antisocialT1Sum      0.49135    0.02237  21.966  &lt; 2e-16 ***\nbpi_anxiousDepressedSum  0.15766    0.03102   5.083 3.96e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nRobust residual standard error: 1.628 \n  (8656 observations deleted due to missingness)\nMultiple R-squared:  0.326, Adjusted R-squared:  0.3255 \nConvergence in 14 IRWLS iterations\n\nRobustness weights: \n 12 observations c(52,347,354,517,709,766,768,979,1618,2402,2403,2404)\n     are outliers with |weight| = 0 ( &lt; 3.5e-05); \n 283 weights are ~= 1. The remaining 2579 ones are summarized as\n     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n0.0001311 0.8599000 0.9470000 0.8814000 0.9816000 0.9990000 \nAlgorithmic parameters: \n       tuning.chi                bb        tuning.psi        refine.tol \n        1.548e+00         5.000e-01         4.685e+00         1.000e-07 \n          rel.tol         scale.tol         solve.tol          zero.tol \n        1.000e-07         1.000e-10         1.000e-07         1.000e-10 \n      eps.outlier             eps.x warn.limit.reject warn.limit.meanrw \n        3.479e-05         2.365e-11         5.000e-01         5.000e-01 \n     nResample         max.it         groups        n.group       best.r.s \n           500             50              5            400              2 \n      k.fast.s          k.max    maxit.scale      trace.lev            mts \n             1            200            200              0           1000 \n    compute.rd fast.s.large.n \n             0           2000 \n                  psi           subsampling                   cov \n           \"bisquare\"         \"nonsingular\"         \".vcov.avar1\" \ncompute.outlier.stats \n                 \"SM\" \nseed : int(0) \n\nCodeconfint(robustLinearRegression)\n\n                             2.5 %    97.5 %\n(Intercept)             0.83801565 1.0499981\nbpi_antisocialT1Sum     0.44749135 0.5352118\nbpi_anxiousDepressedSum 0.09683728 0.2184779\n\nCodeprint(effectsize::standardize_parameters(robustLinearRegression), digits = 2)\n\n# Standardization method: refit\n\nParameter               | Std. Coef. |         95% CI\n-----------------------------------------------------\n(Intercept)             |      -0.08 | [-0.11, -0.05]\nbpi antisocialT1Sum     |       0.48 | [ 0.44,  0.52]\nbpi anxiousDepressedSum |       0.10 | [ 0.06,  0.14]",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#least-trimmed-squares-regression-for-removing-outliers",
    "href": "regression.html#least-trimmed-squares-regression-for-removing-outliers",
    "title": "Regression",
    "section": "\n5.5 Least trimmed squares regression (for removing outliers)",
    "text": "5.5 Least trimmed squares regression (for removing outliers)\n\nCodeltsRegression &lt;- robustbase::ltsReg(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude)\n\nsummary(ltsRegression)\n\n\nCall:\nltsReg.formula(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + \n    bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)\n\nResiduals (from reweighted LS):\n    Min      1Q  Median      3Q     Max \n-3.8235 -0.8612  0.0000  1.0376  3.9294 \n\nCoefficients:\n                        Estimate Std. Error t value Pr(&gt;|t|)    \nIntercept                0.75306    0.04786  15.734  &lt; 2e-16 ***\nbpi_antisocialT1Sum      0.55058    0.01523  36.155  &lt; 2e-16 ***\nbpi_anxiousDepressedSum  0.10818    0.02339   4.625 3.92e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.531 on 2707 degrees of freedom\nMultiple R-Squared: 0.4095, Adjusted R-squared: 0.4091 \nF-statistic: 938.7 on 2 and 2707 DF,  p-value: &lt; 2.2e-16 \n\nCodeconfint(robustLinearRegression)\n\n                             2.5 %    97.5 %\n(Intercept)             0.83801565 1.0499981\nbpi_antisocialT1Sum     0.44749135 0.5352118\nbpi_anxiousDepressedSum 0.09683728 0.2184779",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#bayesian-linear-regression",
    "href": "regression.html#bayesian-linear-regression",
    "title": "Regression",
    "section": "\n5.6 Bayesian linear regression",
    "text": "5.6 Bayesian linear regression\n\nCodebayesianRegularizedRegression &lt;- brms::brm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  chains = 4,\n  iter = 2000,\n  seed = 52242)\n\n\n\nCodesummary(bayesianRegularizedRegression)\n\n Family: gaussian \n  Links: mu = identity \nFormula: bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum \n   Data: mydata (Number of observations: 2874) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nRegression Coefficients:\n                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS\nIntercept                   1.20      0.06     1.08     1.32 1.00     4472\nbpi_antisocialT1Sum         0.47      0.02     0.43     0.50 1.00     3350\nbpi_anxiousDepressedSum     0.16      0.03     0.10     0.22 1.00     3184\n                        Tail_ESS\nIntercept                   3070\nbpi_antisocialT1Sum         3292\nbpi_anxiousDepressedSum     2958\n\nFurther Distributional Parameters:\n      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma     1.98      0.03     1.93     2.03 1.00     4104     3454\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n\nCodeprint(effectsize::standardize_parameters(bayesianRegularizedRegression, method = \"basic\"), digits = 2)\n\n# Standardization method: basic\n\nComponent   |               Parameter | Std. Median |       95% CI\n------------------------------------------------------------------\nconditional |             (Intercept) |        0.00 | [0.00, 0.00]\nconditional |     bpi_antisocialT1Sum |        0.46 | [0.42, 0.49]\nconditional | bpi_anxiousDepressedSum |        0.10 | [0.07, 0.14]\nsigma       |                   sigma |        1.98 | [1.93, 2.03]",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#generalized-regression-model",
    "href": "regression.html#generalized-regression-model",
    "title": "Regression",
    "section": "\n6.1 Generalized regression model",
    "text": "6.1 Generalized regression model\nIn this example, we predict a count variable that has a poisson distribution. We could change the distribution.\n\nCodegeneralizedRegressionModel &lt;- glm(\n  countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  family = \"poisson\",\n  na.action = na.exclude)\n\nsummary(generalizedRegressionModel)\n\n\nCall:\nglm(formula = countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    family = \"poisson\", data = mydata, na.action = na.exclude)\n\nCoefficients:\n                        Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)             0.459999   0.019650  23.410  &lt; 2e-16 ***\nbpi_antisocialT1Sum     0.141577   0.004891  28.948  &lt; 2e-16 ***\nbpi_anxiousDepressedSum 0.047567   0.008036   5.919 3.23e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 5849.4  on 2873  degrees of freedom\nResidual deviance: 4562.6  on 2871  degrees of freedom\n  (8656 observations deleted due to missingness)\nAIC: 11482\n\nNumber of Fisher Scoring iterations: 5\n\nCodeconfint(generalizedRegressionModel)\n\n                             2.5 %     97.5 %\n(Intercept)             0.42136094 0.49838751\nbpi_antisocialT1Sum     0.13196544 0.15113708\nbpi_anxiousDepressedSum 0.03177425 0.06327445\n\nCodeprint(effectsize::standardize_parameters(generalizedRegressionModel), digits = 2)\n\n# Standardization method: refit\n\nParameter               | Std. Coef. |       95% CI\n---------------------------------------------------\n(Intercept)             |       0.91 | [0.89, 0.94]\nbpi antisocialT1Sum     |       0.32 | [0.30, 0.34]\nbpi anxiousDepressedSum |       0.07 | [0.05, 0.09]\n\n- Response is unstandardized.",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#generalized-regression-model-rms",
    "href": "regression.html#generalized-regression-model-rms",
    "title": "Regression",
    "section": "\n6.2 Generalized regression model (rms)",
    "text": "6.2 Generalized regression model (rms)\nIn this example, we predict a count variable that has a poisson distribution. We could change the distribution.\n\nCodermsGeneralizedRegressionModel &lt;- rms::Glm(\n  countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  x = TRUE,\n  y = TRUE,\n  family = \"poisson\")\n\nrmsGeneralizedRegressionModel\n\nFrequencies of Missing Values Due to Each Variable\n          countVariable     bpi_antisocialT1Sum bpi_anxiousDepressedSum \n                   7501                    7613                    7616 \n\nGeneral Linear Model\n\nrms::Glm(formula = countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    family = \"poisson\", data = mydata, x = TRUE, y = TRUE)\n\n                       Model Likelihood    \n                             Ratio Test    \n          Obs2874    LR chi2    1286.72    \nResidual d.f.2871    d.f.             2    \n          g 0.387    Pr(&gt; chi2) &lt;0.0001    \n\n                        Coef   S.E.   Wald Z Pr(&gt;|Z|)\nIntercept               0.4600 0.0196 23.41  &lt;0.0001 \nbpi_antisocialT1Sum     0.1416 0.0049 28.95  &lt;0.0001 \nbpi_anxiousDepressedSum 0.0476 0.0080  5.92  &lt;0.0001 \n\nCodeconfint(rmsGeneralizedRegressionModel)\n\nError in `summary.rms()`:\n! adjustment values not defined here or with datadist for bpi_antisocialT1Sum bpi_anxiousDepressedSum\n\nCodeprint(effectsize::standardize_parameters(rmsGeneralizedRegressionModel), digits = 2)\n\n# Standardization method: refit\n\nParameter               | Std. Coef. |       95% CI\n---------------------------------------------------\nIntercept               |       0.91 | [0.89, 0.94]\nbpi antisocialT1Sum     |       0.32 | [0.30, 0.34]\nbpi anxiousDepressedSum |       0.07 | [0.05, 0.09]\n\n- Response is unstandardized.",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#bayesian-generalized-linear-model",
    "href": "regression.html#bayesian-generalized-linear-model",
    "title": "Regression",
    "section": "\n6.3 Bayesian generalized linear model",
    "text": "6.3 Bayesian generalized linear model\nIn this example, we predict a count variable that has a poisson distribution. We could change the distribution. For example, we could use Gamma regression, family = Gamma, when the response variable is continuous and positive, and the coefficient of variation–rather than the variance–is constant.\n\nCodebayesianGeneralizedLinearRegression &lt;- brm(\n  countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  family = poisson,\n  chains = 4,\n  seed = 52242,\n  iter = 2000)\n\n\n\nCodesummary(bayesianGeneralizedLinearRegression)\n\n Family: poisson \n  Links: mu = log \nFormula: countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum \n   Data: mydata (Number of observations: 2874) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nRegression Coefficients:\n                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS\nIntercept                   0.46      0.02     0.42     0.50 1.00     3095\nbpi_antisocialT1Sum         0.14      0.00     0.13     0.15 1.00     2776\nbpi_anxiousDepressedSum     0.05      0.01     0.03     0.06 1.00     2620\n                        Tail_ESS\nIntercept                   2987\nbpi_antisocialT1Sum         2762\nbpi_anxiousDepressedSum     2689\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n\nCodeprint(effectsize::standardize_parameters(bayesianGeneralizedLinearRegression, method = \"basic\"), digits = 2)\n\n# Standardization method: basic\n\nParameter               | Std. Median |       95% CI\n----------------------------------------------------\n(Intercept)             |        0.00 | [0.00, 0.00]\nbpi_antisocialT1Sum     |        0.32 | [0.30, 0.34]\nbpi_anxiousDepressedSum |        0.07 | [0.05, 0.09]\n\n- Response is unstandardized.",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#robust-generalized-regression",
    "href": "regression.html#robust-generalized-regression",
    "title": "Regression",
    "section": "\n6.4 Robust generalized regression",
    "text": "6.4 Robust generalized regression\n\nCoderobustGeneralizedRegression &lt;- robustbase::glmrob(\n  countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  family = \"poisson\",\n  na.action = na.exclude)\n\nsummary(robustGeneralizedRegression)\n\n\nCall:  robustbase::glmrob(formula = countVariable ~ bpi_antisocialT1Sum +      bpi_anxiousDepressedSum, family = \"poisson\", data = mydata,      na.action = na.exclude) \n\n\nCoefficients:\n                        Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)             0.365934   0.020794  17.598  &lt; 2e-16 ***\nbpi_antisocialT1Sum     0.156275   0.005046  30.969  &lt; 2e-16 ***\nbpi_anxiousDepressedSum 0.050526   0.008332   6.064 1.32e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nRobustness weights w.r * w.x: \n 2273 weights are ~= 1. The remaining 601 ones are summarized as\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.1286  0.5550  0.7574  0.7183  0.8874  0.9982 \n\nNumber of observations: 2874 \nFitted by method 'Mqle'  (in 5 iterations)\n\n(Dispersion parameter for poisson family taken to be 1)\n\nNo deviance values available \nAlgorithmic parameters: \n   acc    tcc \n0.0001 1.3450 \nmaxit \n   50 \ntest.acc \n  \"coef\" \n\nCodeconfint(robustGeneralizedRegression)\n\nError in `glm.control()`:\n! unused arguments (acc = 1e-04, test.acc = \"coef\", tcc = 1.345)\n\nCodeprint(effectsize::standardize_parameters(robustGeneralizedRegression), digits = 2)\n\n# Standardization method: refit\n\nParameter               | Std. Coef. |       95% CI\n---------------------------------------------------\n(Intercept)             |       0.87 | [0.84, 0.89]\nbpi antisocialT1Sum     |       0.35 | [0.33, 0.38]\nbpi anxiousDepressedSum |       0.07 | [0.05, 0.10]\n\n- Response is unstandardized.",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#ordinal-regression-model",
    "href": "regression.html#ordinal-regression-model",
    "title": "Regression",
    "section": "\n6.5 Ordinal regression model",
    "text": "6.5 Ordinal regression model\n\nCodeordinalRegressionModel1 &lt;- MASS::polr(\n  orderedVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata)\n\nordinalRegressionModel2 &lt;- rms::lrm(\n  orderedVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  x = TRUE,\n  y = TRUE)\n\nordinalRegressionModel3 &lt;- rms::orm(\n  orderedVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  x = TRUE,\n  y = TRUE)\n\nsummary(ordinalRegressionModel1)\n\nCall:\nMASS::polr(formula = orderedVariable ~ bpi_antisocialT1Sum + \n    bpi_anxiousDepressedSum, data = mydata)\n\nCoefficients:\n                         Value Std. Error t value\nbpi_antisocialT1Sum     0.4404    0.01862  23.647\nbpi_anxiousDepressedSum 0.1427    0.02615   5.457\n\nIntercepts:\n      Value   Std. Error t value\n0|1   -0.6001  0.0630    -9.5185\n1|2    0.6766  0.0585    11.5656\n2|3    1.5801  0.0634    24.9191\n3|4    2.4110  0.0720    33.4816\n4|5    3.1617  0.0825    38.3006\n5|6    3.8560  0.0949    40.6120\n6|7    4.5367  0.1106    41.0316\n7|8    5.1667  0.1291    40.0147\n8|9    5.8129  0.1545    37.6263\n9|10   6.5364  0.1962    33.3193\n10|11  7.1835  0.2513    28.5820\n11|12  7.8469  0.3331    23.5566\n12|14  8.7818  0.5113    17.1741\n\nResidual Deviance: 11088.49 \nAIC: 11118.49 \n(8656 observations deleted due to missingness)\n\nCodeconfint(ordinalRegressionModel1)\n\n                             2.5 %    97.5 %\nbpi_antisocialT1Sum     0.40403039 0.4770422\nbpi_anxiousDepressedSum 0.09149919 0.1940080\n\nCodeordinalRegressionModel2\n\nFrequencies of Missing Values Due to Each Variable\n        orderedVariable     bpi_antisocialT1Sum bpi_anxiousDepressedSum \n                   7501                    7613                    7616 \n\nLogistic Regression Model\n\nrms::lrm(formula = orderedVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    data = mydata, x = TRUE, y = TRUE)\n\n\nFrequencies of Responses\n\n  0   1   2   3   4   5   6   7   8   9  10  11  12  14 \n455 597 527 444 313 205 133  80  52  33  16   9   6   4 \n\n                       Model Likelihood       Discrimination    Rank Discrim.    \n                             Ratio Test              Indexes          Indexes    \nObs          2874    LR chi2     881.26       R2       0.268    C       0.705    \nmax |deriv| 6e-06    d.f.             2      R2(2,2874)0.264    Dxy     0.410    \n                     Pr(&gt; chi2) &lt;0.0001    R2(2,2803.4)0.269    gamma   0.426    \n                                              Brier    0.195    tau-a   0.350    \n\n                        Coef   S.E.   Wald Z Pr(&gt;|Z|)\nbpi_antisocialT1Sum     0.4404 0.0186 23.65  &lt;0.0001 \nbpi_anxiousDepressedSum 0.1427 0.0261  5.46  &lt;0.0001 \n\nCodeprint(effectsize::standardize_parameters(ordinalRegressionModel2), digits = 2)\n\n# Standardization method: refit\n\nParameter               | Std. Coef. |         95% CI\n-----------------------------------------------------\ny&gt;=1                    |       2.01 | [ 1.90,  2.12]\ny&gt;=2                    |       0.73 | [ 0.65,  0.81]\ny&gt;=3                    |      -0.17 | [-0.25, -0.09]\ny&gt;=4                    |      -1.00 | [-1.09, -0.91]\ny&gt;=5                    |      -1.75 | [-1.86, -1.65]\ny&gt;=6                    |      -2.45 | [-2.58, -2.32]\ny&gt;=7                    |      -3.13 | [-3.29, -2.97]\ny&gt;=8                    |      -3.76 | [-3.96, -3.56]\ny&gt;=9                    |      -4.40 | [-4.66, -4.14]\ny&gt;=10                   |      -5.13 | [-5.48, -4.78]\ny&gt;=11                   |      -5.78 | [-6.24, -5.31]\ny&gt;=12                   |      -6.44 | [-7.07, -5.81]\ny&gt;=14                   |      -7.37 | [-8.36, -6.39]\nbpi antisocialT1Sum     |       0.99 | [ 0.91,  1.08]\nbpi anxiousDepressedSum |       0.21 | [ 0.13,  0.28]\n\n- Response is unstandardized.\n\nCodeordinalRegressionModel3\n\nFrequencies of Missing Values Due to Each Variable\n        orderedVariable     bpi_antisocialT1Sum bpi_anxiousDepressedSum \n                   7501                    7613                    7616 \n\nLogistic (Proportional Odds) Ordinal Regression Model\n\nrms::orm(formula = orderedVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    data = mydata, x = TRUE, y = TRUE)\n\n\nFrequencies of Responses\n\n  0   1   2   3   4   5   6   7   8   9  10  11  12  14 \n455 597 527 444 313 205 133  80  52  33  16   9   6   4 \n\n                        Model Likelihood               Discrimination    Rank Discrim.    \n                              Ratio Test                      Indexes          Indexes    \nObs           2874    LR chi2     881.26    R2                  0.268    rho     0.506    \nESS         2803.4    d.f.             2    R2(2,2874)          0.264    Dxy     0.410    \nDistinct Y      14    Pr(&gt; chi2) &lt;0.0001    R2(2,2803.4)        0.269                     \nMedian Y         3    Score chi2  916.79    |Pr(Y&gt;=median)-0.5| 0.188                     \nmax |deriv|  2e-12    Pr(&gt; chi2) &lt;0.0001                                                  \n\n                        Coef   S.E.   Wald Z Pr(&gt;|Z|)\nbpi_antisocialT1Sum     0.4404 0.0186 23.65  &lt;0.0001 \nbpi_anxiousDepressedSum 0.1427 0.0261  5.46  &lt;0.0001 \n\nCodeconfint(ordinalRegressionModel3)\n\n                              2.5 %     97.5 %\ny&gt;=1                             NA         NA\ny&gt;=2                    -0.79129972 -0.5619711\ny&gt;=3                             NA         NA\ny&gt;=4                             NA         NA\ny&gt;=5                             NA         NA\ny&gt;=6                             NA         NA\ny&gt;=7                             NA         NA\ny&gt;=8                             NA         NA\ny&gt;=9                             NA         NA\ny&gt;=10                            NA         NA\ny&gt;=11                            NA         NA\ny&gt;=12                            NA         NA\ny&gt;=14                            NA         NA\nbpi_antisocialT1Sum      0.40390078  0.4769035\nbpi_anxiousDepressedSum  0.09143921  0.1939303\n\nCodeprint(effectsize::standardize_parameters(ordinalRegressionModel3), digits = 2)\n\n# Standardization method: refit\n\nParameter               | Std. Coef. |       95% CI\n---------------------------------------------------\ny&gt;=2                    |       0.73 | [0.65, 0.81]\nbpi antisocialT1Sum     |       0.99 | [0.91, 1.08]\nbpi anxiousDepressedSum |       0.21 | [0.13, 0.28]\n\n- Response is unstandardized.",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#bayesian-ordinal-regression-model",
    "href": "regression.html#bayesian-ordinal-regression-model",
    "title": "Regression",
    "section": "\n6.6 Bayesian ordinal regression model",
    "text": "6.6 Bayesian ordinal regression model\n\nCodebayesianOrdinalRegression &lt;- brm(\n  orderedVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  family = cumulative(),\n  chains = 4,\n  seed = 52242,\n  iter = 2000)\n\n\n\nCodesummary(bayesianOrdinalRegression)\n\n Family: cumulative \n  Links: mu = logit \nFormula: orderedVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum \n   Data: mydata (Number of observations: 2874) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nRegression Coefficients:\n                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS\nIntercept[1]               -0.60      0.06    -0.73    -0.48 1.00     4659\nIntercept[2]                0.67      0.06     0.55     0.79 1.00     6134\nIntercept[3]                1.57      0.06     1.45     1.70 1.00     5916\nIntercept[4]                2.40      0.07     2.26     2.54 1.00     5305\nIntercept[5]                3.15      0.08     2.99     3.31 1.00     4846\nIntercept[6]                3.84      0.09     3.66     4.03 1.00     4741\nIntercept[7]                4.52      0.11     4.31     4.74 1.00     4796\nIntercept[8]                5.15      0.13     4.90     5.40 1.00     4908\nIntercept[9]                5.79      0.15     5.50     6.11 1.00     5172\nIntercept[10]               6.51      0.20     6.14     6.90 1.00     5196\nIntercept[11]               7.17      0.25     6.69     7.69 1.00     5867\nIntercept[12]               7.87      0.34     7.25     8.56 1.00     5503\nIntercept[13]               8.91      0.53     7.99    10.06 1.00     5868\nbpi_antisocialT1Sum         0.44      0.02     0.40     0.48 1.00     4321\nbpi_anxiousDepressedSum     0.14      0.03     0.09     0.19 1.00     4514\n                        Tail_ESS\nIntercept[1]                3538\nIntercept[2]                3487\nIntercept[3]                3551\nIntercept[4]                3532\nIntercept[5]                3866\nIntercept[6]                3599\nIntercept[7]                3222\nIntercept[8]                3125\nIntercept[9]                2991\nIntercept[10]               3098\nIntercept[11]               3043\nIntercept[12]               2906\nIntercept[13]               2873\nbpi_antisocialT1Sum         2945\nbpi_anxiousDepressedSum     3156\n\nFurther Distributional Parameters:\n     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\ndisc     1.00      0.00     1.00     1.00   NA       NA       NA\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n\nCodeprint(effectsize::standardize_parameters(bayesianOrdinalRegression, method = \"basic\"), digits = 2)\n\n# Standardization method: basic\n\nParameter               | Std. Median |         95% CI\n------------------------------------------------------\nIntercept[1]            |        0.00 | [ 0.00,  0.00]\nIntercept[2]            |        1.51 | [ 1.25,  1.78]\nIntercept[3]            |        2.26 | [ 2.08,  2.45]\nIntercept[4]            |        2.40 | [ 2.26,  2.54]\nIntercept[5]            |        3.15 | [ 2.99,  3.31]\nIntercept[6]            |        3.84 | [ 3.66,  4.03]\nIntercept[7]            |        4.52 | [ 4.31,  4.74]\nIntercept[8]            |        5.14 | [ 4.90,  5.40]\nIntercept[9]            |        5.78 | [ 5.50,  6.11]\nIntercept[10]           |        6.50 | [ 6.14,  6.90]\nIntercept[11]           |        7.15 | [ 6.69,  7.69]\nIntercept[12]           |        7.84 | [ 7.25,  8.56]\nIntercept[13]           |        8.87 | [ 7.99, 10.06]\nbpi_antisocialT1Sum     |        0.44 | [ 0.40,  0.48]\nbpi_anxiousDepressedSum |        0.14 | [ 0.09,  0.19]\n\n- Response is unstandardized.",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#bayesian-count-regression-model",
    "href": "regression.html#bayesian-count-regression-model",
    "title": "Regression",
    "section": "\n6.7 Bayesian count regression model",
    "text": "6.7 Bayesian count regression model\n\nCodebayesianCountRegression &lt;- brm(\n  countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  family = \"poisson\",\n  chains = 4,\n  seed = 52242,\n  iter = 2000)\n\n\n\nCodesummary(bayesianCountRegression)\n\n Family: poisson \n  Links: mu = log \nFormula: countVariable ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum \n   Data: mydata (Number of observations: 2874) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nRegression Coefficients:\n                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS\nIntercept                   0.46      0.02     0.42     0.50 1.00     3095\nbpi_antisocialT1Sum         0.14      0.00     0.13     0.15 1.00     2776\nbpi_anxiousDepressedSum     0.05      0.01     0.03     0.06 1.00     2620\n                        Tail_ESS\nIntercept                   2987\nbpi_antisocialT1Sum         2762\nbpi_anxiousDepressedSum     2689\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n\nCodeprint(effectsize::standardize_parameters(bayesianCountRegression, method = \"basic\"), digits = 2)\n\n# Standardization method: basic\n\nParameter               | Std. Median |       95% CI\n----------------------------------------------------\n(Intercept)             |        0.00 | [0.00, 0.00]\nbpi_antisocialT1Sum     |        0.32 | [0.30, 0.34]\nbpi_anxiousDepressedSum |        0.07 | [0.05, 0.09]\n\n- Response is unstandardized.",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#logistic-regression-model-rms",
    "href": "regression.html#logistic-regression-model-rms",
    "title": "Regression",
    "section": "\n6.8 Logistic regression model (rms)",
    "text": "6.8 Logistic regression model (rms)\n\nCodelogisticRegressionModel &lt;- rms::robcov(rms::lrm(\n  female ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  x = TRUE,\n  y = TRUE))\n\nlogisticRegressionModel\n\nFrequencies of Missing Values Due to Each Variable\n                 female     bpi_antisocialT1Sum bpi_anxiousDepressedSum \n                      2                    7613                    7616 \n\nLogistic Regression Model\n\nrms::lrm(formula = female ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    data = mydata, x = TRUE, y = TRUE)\n\n                       Model Likelihood       Discrimination    Rank Discrim.    \n                             Ratio Test              Indexes          Indexes    \nObs          3914    LR chi2      66.63       R2       0.023    C       0.571    \n 0           1965    d.f.             2      R2(2,3914)0.016    Dxy     0.142    \n 1           1949    Pr(&gt; chi2) &lt;0.0001    R2(2,2935.5)0.022    gamma   0.147    \nmax |deriv| 1e-07                             Brier    0.246    tau-a   0.071    \n\n                        Coef    S.E.   Wald Z Pr(&gt;|Z|)\nIntercept                0.3002 0.0529  5.67  &lt;0.0001 \nbpi_antisocialT1Sum     -0.1244 0.0166 -7.48  &lt;0.0001 \nbpi_anxiousDepressedSum  0.0382 0.0253  1.51  0.1314  \n\nCodeconfint(logisticRegressionModel)\n\nError in `summary.rms()`:\n! adjustment values not defined here or with datadist for bpi_antisocialT1Sum bpi_anxiousDepressedSum\n\nCodeprint(effectsize::standardize_parameters(logisticRegressionModel), digits = 2)\n\n# Standardization method: refit\n\nParameter               | Std. Coef. |         95% CI\n-----------------------------------------------------\nIntercept               |  -9.88e-03 | [-0.07,  0.05]\nbpi antisocialT1Sum     |      -0.29 | [-0.36, -0.21]\nbpi anxiousDepressedSum |       0.06 | [-0.02,  0.13]\n\n- Response is unstandardized.",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#bayesian-logistic-regression-model",
    "href": "regression.html#bayesian-logistic-regression-model",
    "title": "Regression",
    "section": "\n6.9 Bayesian logistic regression model",
    "text": "6.9 Bayesian logistic regression model\n\nCodebayesianLogisticRegression &lt;- brm(\n  female ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  family = bernoulli,\n  chains = 4,\n  seed = 52242,\n  iter = 2000)\n\n\n\nCodesummary(bayesianLogisticRegression)\n\n Family: bernoulli \n  Links: mu = logit \nFormula: female ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum \n   Data: mydata (Number of observations: 3914) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nRegression Coefficients:\n                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS\nIntercept                   0.30      0.05     0.20     0.41 1.00     4125\nbpi_antisocialT1Sum        -0.13      0.02    -0.16    -0.09 1.00     2943\nbpi_anxiousDepressedSum     0.04      0.03    -0.01     0.09 1.00     3084\n                        Tail_ESS\nIntercept                   3269\nbpi_antisocialT1Sum         2857\nbpi_anxiousDepressedSum     2730\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n\nCodeprint(effectsize::standardize_parameters(bayesianLogisticRegression, method = \"basic\"), digits = 2)\n\n# Standardization method: basic\n\nParameter               | Std. Median |         95% CI\n------------------------------------------------------\n(Intercept)             |        0.00 | [ 0.00,  0.00]\nbpi_antisocialT1Sum     |       -0.29 | [-0.36, -0.22]\nbpi_anxiousDepressedSum |        0.06 | [-0.02,  0.13]\n\n- Response is unstandardized.",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#mean-center-predictors",
    "href": "regression.html#mean-center-predictors",
    "title": "Regression",
    "section": "\n8.1 Mean Center Predictors",
    "text": "8.1 Mean Center Predictors\nMake sure to mean-center or orthogonalize predictors before computing the interaction term.\n\nCodestates$Illiteracy_centered &lt;- scale(states$Illiteracy, scale = FALSE)\nstates$Murder_centered &lt;- scale(states$Murder, scale = FALSE)",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#model",
    "href": "regression.html#model",
    "title": "Regression",
    "section": "\n8.2 Model",
    "text": "8.2 Model\n\nCodeinteractionModel &lt;- lm(\n  Income ~ Illiteracy_centered + Murder_centered + Illiteracy_centered:Murder_centered + HS.Grad,\n  data = states)\n\nsummary(interactionModel)\n\n\nCall:\nlm(formula = Income ~ Illiteracy_centered + Murder_centered + \n    Illiteracy_centered:Murder_centered + HS.Grad, data = states)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-916.27 -244.42   28.42  228.14 1221.16 \n\nCoefficients:\n                                    Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                          2421.46     594.36   4.074 0.000185 ***\nIlliteracy_centered                    37.12     192.56   0.193 0.848005    \nMurder_centered                        17.07      25.52   0.669 0.507085    \nHS.Grad                                40.76      10.92   3.733 0.000530 ***\nIlliteracy_centered:Murder_centered   -97.04      35.86  -2.706 0.009584 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 459.5 on 45 degrees of freedom\nMultiple R-squared:  0.4864,    Adjusted R-squared:  0.4407 \nF-statistic: 10.65 on 4 and 45 DF,  p-value: 3.689e-06\n\nCodeprint(effectsize::standardize_parameters(interactionModel), digits = 2)\n\n# Standardization method: refit\n\nParameter                             | Std. Coef. |         95% CI\n-------------------------------------------------------------------\n(Intercept)                           |       0.24 | [-0.04,  0.53]\nIlliteracy centered                   |       0.04 | [-0.35,  0.42]\nMurder centered                       |       0.10 | [-0.21,  0.41]\nHS Grad                               |       0.54 | [ 0.25,  0.82]\nIlliteracy centered × Murder centered |      -0.36 | [-0.62, -0.09]",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#plots",
    "href": "regression.html#plots",
    "title": "Regression",
    "section": "\n8.3 Plots",
    "text": "8.3 Plots\n\nCodeinteractions::interact_plot(\n  interactionModel,\n  pred = Illiteracy_centered,\n  modx = Murder_centered)\n\n\n\n\n\n\nCodeinteractions::interact_plot(\n  interactionModel,\n  pred = Illiteracy_centered,\n  modx = Murder_centered,\n  plot.points = TRUE)\n\n\n\n\n\n\nCodeinteractions::interact_plot(\n  interactionModel,\n  pred = Illiteracy_centered,\n  modx = Murder_centered,\n  interval = TRUE)\n\n\n\n\n\n\nCodeinteractions::johnson_neyman(\n  interactionModel,\n  pred = Illiteracy_centered,\n  modx = Murder_centered,\n  alpha = .05)\n\nJOHNSON-NEYMAN INTERVAL\n\nWhen Murder_centered is OUTSIDE the interval [-8.13, 4.37], the slope of\nIlliteracy_centered is p &lt; .05.\n\nNote: The range of observed values of Murder_centered is [-5.98, 7.72]",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#simple-slopes-analysis",
    "href": "regression.html#simple-slopes-analysis",
    "title": "Regression",
    "section": "\n8.4 Simple Slopes Analysis",
    "text": "8.4 Simple Slopes Analysis\n\nCodeinteractions::sim_slopes(\n  interactionModel,\n  pred = Illiteracy_centered,\n  modx = Murder_centered,\n  johnson_neyman = FALSE)\n\nSIMPLE SLOPES ANALYSIS\n\nSlope of Illiteracy_centered when Murder_centered = -3.69154e+00 (- 1 SD): \n\n    Est.     S.E.   t val.      p\n-------- -------- -------- ------\n  395.34   274.84     1.44   0.16\n\nSlope of Illiteracy_centered when Murder_centered = -1.24345e-16 (Mean): \n\n   Est.     S.E.   t val.      p\n------- -------- -------- ------\n  37.12   192.56     0.19   0.85\n\nSlope of Illiteracy_centered when Murder_centered =  3.69154e+00 (+ 1 SD): \n\n     Est.     S.E.   t val.      p\n--------- -------- -------- ------\n  -321.10   183.49    -1.75   0.09\n\nCodeinteractions::sim_slopes(\n  interactionModel,\n  pred = Illiteracy_centered,\n  modx = Murder_centered,\n  modx.values = c(0, 5, 10),\n  johnson_neyman = FALSE)\n\nSIMPLE SLOPES ANALYSIS\n\nSlope of Illiteracy_centered when Murder_centered =  0.00: \n\n   Est.     S.E.   t val.      p\n------- -------- -------- ------\n  37.12   192.56     0.19   0.85\n\nSlope of Illiteracy_centered when Murder_centered =  5.00: \n\n     Est.     S.E.   t val.      p\n--------- -------- -------- ------\n  -448.07   202.17    -2.22   0.03\n\nSlope of Illiteracy_centered when Murder_centered = 10.00: \n\n     Est.     S.E.   t val.      p\n--------- -------- -------- ------\n  -933.27   330.10    -2.83   0.01",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#johnson-neyman-intervals",
    "href": "regression.html#johnson-neyman-intervals",
    "title": "Regression",
    "section": "\n8.5 Johnson-Neyman intervals",
    "text": "8.5 Johnson-Neyman intervals\nIndicates all the values of the moderator for which the slope of the predictor is statistically significant.\n\nCodeinteractions::sim_slopes(\n  interactionModel,\n  pred = Illiteracy_centered,\n  modx = Murder_centered,\n  johnson_neyman = TRUE)\n\nJOHNSON-NEYMAN INTERVAL\n\nWhen Murder_centered is OUTSIDE the interval [-8.13, 4.37], the slope of\nIlliteracy_centered is p &lt; .05.\n\nNote: The range of observed values of Murder_centered is [-5.98, 7.72]\n\nSIMPLE SLOPES ANALYSIS\n\nSlope of Illiteracy_centered when Murder_centered = -3.69154e+00 (- 1 SD): \n\n    Est.     S.E.   t val.      p\n-------- -------- -------- ------\n  395.34   274.84     1.44   0.16\n\nSlope of Illiteracy_centered when Murder_centered = -1.24345e-16 (Mean): \n\n   Est.     S.E.   t val.      p\n------- -------- -------- ------\n  37.12   192.56     0.19   0.85\n\nSlope of Illiteracy_centered when Murder_centered =  3.69154e+00 (+ 1 SD): \n\n     Est.     S.E.   t val.      p\n--------- -------- -------- ------\n  -321.10   183.49    -1.75   0.09\n\nCodeinteractions::probe_interaction(\n  interactionModel,\n  pred = Illiteracy_centered,\n  modx = Murder_centered,\n  cond.int = TRUE,\n  interval = TRUE,\n  jnplot = TRUE)\n\nJOHNSON-NEYMAN INTERVAL\n\nWhen Murder_centered is OUTSIDE the interval [-8.13, 4.37], the slope of\nIlliteracy_centered is p &lt; .05.\n\nNote: The range of observed values of Murder_centered is [-5.98, 7.72]\n\n\n\n\n\n\n\n\nSIMPLE SLOPES ANALYSIS\n\nWhen Murder_centered = -3.69154e+00 (- 1 SD): \n\n                                        Est.     S.E.   t val.      p\n---------------------------------- --------- -------- -------- ------\nSlope of Illiteracy_centered          395.34   274.84     1.44   0.16\nConditional intercept                4523.23   134.99    33.51   0.00\n\nWhen Murder_centered = -1.24345e-16 (Mean): \n\n                                        Est.     S.E.   t val.      p\n---------------------------------- --------- -------- -------- ------\nSlope of Illiteracy_centered           37.12   192.56     0.19   0.85\nConditional intercept                4586.22    85.52    53.63   0.00\n\nWhen Murder_centered =  3.69154e+00 (+ 1 SD): \n\n                                        Est.     S.E.   t val.      p\n---------------------------------- --------- -------- -------- ------\nSlope of Illiteracy_centered         -321.10   183.49    -1.75   0.09\nConditional intercept                4649.22   118.97    39.08   0.00",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#sec-listwiseDeletion",
    "href": "regression.html#sec-listwiseDeletion",
    "title": "Regression",
    "section": "\n10.1 Listwise deletion",
    "text": "10.1 Listwise deletion\nListwise deletion deletes every row in the data file that has a missing value for one of the model variables.\n\nCodelistwiseDeletionModel &lt;- lm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude)\n\nsummary(listwiseDeletionModel)\n\n\nCall:\nlm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    data = mydata, na.action = na.exclude)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8.3755 -1.2337 -0.2212  0.9911 12.8017 \n\nCoefficients:\n                        Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)              1.19830    0.05983  20.029  &lt; 2e-16 ***\nbpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***\nbpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.979 on 2871 degrees of freedom\n  (8656 observations deleted due to missingness)\nMultiple R-squared:  0.262, Adjusted R-squared:  0.2615 \nF-statistic: 509.6 on 2 and 2871 DF,  p-value: &lt; 2.2e-16\n\nCodeconfint(listwiseDeletionModel)\n\n                            2.5 %    97.5 %\n(Intercept)             1.0809881 1.3156128\nbpi_antisocialT1Sum     0.4290884 0.5019688\nbpi_anxiousDepressedSum 0.1035825 0.2179258\n\nCodeprint(effectsize::standardize_parameters(listwiseDeletionModel), digits = 2)\n\n# Standardization method: refit\n\nParameter               | Std. Coef. |        95% CI\n----------------------------------------------------\n(Intercept)             |   1.62e-16 | [-0.03, 0.03]\nbpi antisocialT1Sum     |       0.46 | [ 0.42, 0.49]\nbpi anxiousDepressedSum |       0.10 | [ 0.06, 0.14]",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#sec-pairwiseDeletion",
    "href": "regression.html#sec-pairwiseDeletion",
    "title": "Regression",
    "section": "\n10.2 Pairwise deletion",
    "text": "10.2 Pairwise deletion\nAlso see here:\n\n\nhttps://stats.stackexchange.com/questions/158366/fit-multiple-regression-model-with-pairwise-deletion-or-on-a-correlation-covari/173002#173002 (archived at https://perma.cc/GH5T-RXD9)\n\nhttps://stats.stackexchange.com/questions/299792/r-lm-covariance-matrix-manual-calculation-failure (archived at https://perma.cc/F7EL-AUFZ)\n\nhttps://stats.stackexchange.com/questions/107597/is-there-a-way-to-use-the-covariance-matrix-to-find-coefficients-for-multiple-re (archived at https://perma.cc/KU3X-FB2C)\n\nhttps://stats.stackexchange.com/questions/105006/how-to-perform-a-bivariate-regression-using-pairwise-deletion-of-missing-values (archived at https://perma.cc/QWQ5-2TLW)\n\nhttps://dl.dropboxusercontent.com/s/4sf0et3p47ykctx/MissingPairwise.sps (archived at https://perma.cc/UC4K-2L9T)\n\nAdapted from here: https://stefvanbuuren.name/fimd/sec-simplesolutions.html#sec:pairwise (archived at https://perma.cc/EGU6-3M3Q)\n\nCodemodelData &lt;- mydata[,c(\"bpi_antisocialT2Sum\",\"bpi_antisocialT1Sum\",\"bpi_anxiousDepressedSum\")]\nvarMeans &lt;- colMeans(modelData, na.rm = TRUE)\nvarCovariances &lt;- cov(modelData, use = \"pairwise\")\n\npairwiseRegression_syntax &lt;- '\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum\n  bpi_antisocialT2Sum ~~ bpi_antisocialT2Sum\n  bpi_antisocialT2Sum ~ 1\n'\n\npairwiseRegression_fit &lt;- lavaan::lavaan(\n  pairwiseRegression_syntax,\n  sample.mean = varMeans,\n  sample.cov = varCovariances,\n  sample.nobs = sum(complete.cases(modelData))\n)\n\nsummary(\n  pairwiseRegression_fit,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 1 iteration\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                         4\n\n  Number of observations                          2874\n\nModel Test User Model:\n                                                      \n  Test statistic                                 0.000\n  Degrees of freedom                                 0\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nRegressions:\n                        Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  bpi_antisocialT2Sum ~                                                      \n    bpi_antsclT1Sm         0.441    0.018   24.611    0.000    0.441    0.456\n    bp_nxsDprssdSm         0.137    0.028    4.854    0.000    0.137    0.090\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .bpi_antsclT2Sm    1.175    0.058   20.125    0.000    1.175    0.523\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .bpi_antsclT2Sm    3.755    0.099   37.908    0.000    3.755    0.743\n\nR-Square:\n                   Estimate\n    bpi_antsclT2Sm    0.257",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#sec-fiml",
    "href": "regression.html#sec-fiml",
    "title": "Regression",
    "section": "\n10.3 Full-information maximum likelihood (FIML)",
    "text": "10.3 Full-information maximum likelihood (FIML)\n\nCodefimlRegression_syntax &lt;- '\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum\n  bpi_antisocialT2Sum ~~ bpi_antisocialT2Sum\n  bpi_antisocialT2Sum ~ 1\n'\n\nfimlRegression_fit &lt;- lavaan::lavaan(\n  fimlRegression_syntax,\n  data = mydata,\n  missing = \"ML\",\n)\n\nsummary(\n  fimlRegression_fit,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 11 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                         4\n\n                                                  Used       Total\n  Number of observations                          3914       11530\n  Number of missing patterns                         2            \n\nModel Test User Model:\n                                                      \n  Test statistic                                 0.000\n  Degrees of freedom                                 0\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Observed\n  Observed information based on                Hessian\n\nRegressions:\n                        Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  bpi_antisocialT2Sum ~                                                      \n    bpi_antsclT1Sm         0.466    0.019   25.062    0.000    0.466    0.466\n    bp_nxsDprssdSm         0.161    0.029    5.516    0.000    0.161    0.102\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .bpi_antsclT2Sm    1.198    0.060   20.039    0.000    1.198    0.516\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .bpi_antsclT2Sm    3.911    0.103   37.908    0.000    3.911    0.725\n\nR-Square:\n                   Estimate\n    bpi_antsclT2Sm    0.275",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#sec-imputation",
    "href": "regression.html#sec-imputation",
    "title": "Regression",
    "section": "\n10.4 Multiple imputation",
    "text": "10.4 Multiple imputation\n\nCodemodelData_imputed &lt;- mice::mice(\n  modelData,\n  m = 5,\n  method = \"pmm\") # predictive mean matching; can choose among many methods\n\n\n iter imp variable\n  1   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  1   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  1   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  1   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  1   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  2   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  2   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  2   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  2   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  2   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  3   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  3   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  3   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  3   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  3   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  4   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  4   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  4   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  4   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  4   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  5   1  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  5   2  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  5   3  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  5   4  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n  5   5  bpi_antisocialT2Sum  bpi_antisocialT1Sum  bpi_anxiousDepressedSum\n\nCodeimputedData_fit &lt;- with(\n  modelData_imputed,\n  lm(bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum))\n\nimputedData_pooledEstimates &lt;- pool(imputedData_fit)\nsummary(imputedData_pooledEstimates)",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#linear-regression-1",
    "href": "regression.html#linear-regression-1",
    "title": "Regression",
    "section": "\n16.1 Linear Regression",
    "text": "16.1 Linear Regression\n\nCodemultipleRegressionModelBootstrapped &lt;- Boot(multipleRegressionModelNoMissing, R = 1000)\nsummary(multipleRegressionModelBootstrapped)\n\n\n  \n\n\nCodeconfint(multipleRegressionModelBootstrapped, level = .95, type = \"bca\")\n\nBootstrap percent confidence intervals\n\n                             2.5 %    97.5 %\n(Intercept)             1.07982316 1.3283492\nbpi_antisocialT1Sum     0.42153456 0.5063017\nbpi_anxiousDepressedSum 0.09789034 0.2246641\n\nCodehist(multipleRegressionModelBootstrapped)",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#generalized-regression",
    "href": "regression.html#generalized-regression",
    "title": "Regression",
    "section": "\n16.2 Generalized Regression",
    "text": "16.2 Generalized Regression\n\nCodegeneralizedRegressionModelBootstrapped &lt;- Boot(multipleRegressionModelNoMissing, R = 1000)\nsummary(generalizedRegressionModelBootstrapped)\n\n\n  \n\n\nCodeconfint(generalizedRegressionModelBootstrapped, level = .95, type = \"bca\")\n\nBootstrap percent confidence intervals\n\n                             2.5 %    97.5 %\n(Intercept)             1.08465531 1.3286510\nbpi_antisocialT1Sum     0.41968869 0.5125949\nbpi_anxiousDepressedSum 0.09612606 0.2230757\n\nCodehist(generalizedRegressionModelBootstrapped)",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#k-fold-cross-validation",
    "href": "regression.html#k-fold-cross-validation",
    "title": "Regression",
    "section": "\n17.1 K-fold cross validation",
    "text": "17.1 K-fold cross validation\n\nCodekFolds &lt;- 10\nreplications &lt;- 20\n\nfolds &lt;- cvFolds(nrow(mydata), K = kFolds, R = replications)\n\nfitLm &lt;- lm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = \"na.exclude\")\n\nfitLmrob &lt;- lmrob(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = \"na.exclude\")\n\nfitLts &lt;- ltsReg(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = \"na.exclude\")\n\ncvFitLm &lt;- cvLm(\n  fitLm,\n  K = kFolds,\n  R = replications)\n\ncvFitLmrob &lt;- cvLmrob(\n  fitLmrob,\n  K = kFolds,\n  R = replications)\n\ncvFitLts &lt;- cvLts(\n  fitLts,\n  K = kFolds,\n  R = replications)\n\ncvFits &lt;- cvSelect(\n  OLS = cvFitLm,\n  MM = cvFitLmrob,\n  LTS = cvFitLts)\ncvFits\n\n\n10-fold CV results:\n  Fit       CV\n1 OLS 1.980530\n2  MM 1.026530\n3 LTS 1.006884\n\nBest model:\n   CV \n\"LTS\" \n\nCodebwplot(\n  cvFits,\n  xlab = \"Root Mean Square Error\",\n  xlim = c(0, max(cvFits$cv$CV) + 0.2))",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#effect-plots",
    "href": "regression.html#effect-plots",
    "title": "Regression",
    "section": "\n18.1 Effect Plots",
    "text": "18.1 Effect Plots\n\nCodeallEffects(multipleRegressionModel)\n\n model: bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum\n\n bpi_antisocialT1Sum effect\nbpi_antisocialT1Sum\n       0      3.2      6.5      9.8       13 \n1.394591 2.884283 4.420527 5.956772 7.446463 \n\n bpi_anxiousDepressedSum effect\nbpi_anxiousDepressedSum\n       0        2        4        6        8 \n2.502636 2.824145 3.145653 3.467161 3.788669 \n\nCodeplot(allEffects(multipleRegressionModel))",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#confidence-ellipses",
    "href": "regression.html#confidence-ellipses",
    "title": "Regression",
    "section": "\n18.2 Confidence Ellipses",
    "text": "18.2 Confidence Ellipses\n\nCodeconfidenceEllipse(\n  multipleRegressionModel,\n  levels = c(0.5, .95))",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#data-ellipse",
    "href": "regression.html#data-ellipse",
    "title": "Regression",
    "section": "\n18.3 Data Ellipse",
    "text": "18.3 Data Ellipse\n\nCodemydata_nomissing &lt;- na.omit(mydata[,c(\"bpi_antisocialT1Sum\",\"bpi_antisocialT2Sum\")])\ndataEllipse(\n  mydata_nomissing$bpi_antisocialT1Sum,\n  mydata_nomissing$bpi_antisocialT2Sum,\n  levels = c(0.5, .95))",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#assumptions",
    "href": "regression.html#assumptions",
    "title": "Regression",
    "section": "\n19.1 Assumptions",
    "text": "19.1 Assumptions\n\n19.1.1 1. Linear relation between predictors and outcome\n\n19.1.1.1 Ways to Test\n\n19.1.1.1.1 Before Model Fitting\n\nscatterplot matrix\ndistance correlation\n\n\n19.1.1.1.1.1 Scatterplot Matrix\n\nCodescatterplotMatrix(\n  ~ bpi_antisocialT2Sum + bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata)\n\n\n\n\n\n\n\n\n19.1.1.1.1.2 Distance correlation\nThe distance correlation is an index of the degree of the linear and non-linear association between two variables.\n\nCodecorrelation(\n  mydata[,c(\"bpi_antisocialT1Sum\",\"bpi_antisocialT2Sum\")],\n  method = \"distance\",\n  p_adjust = \"none\")\n\n\n  \n\n\n\n\n19.1.1.1.2 After Model Fitting\nCheck for nonlinearities (non-horizontal line) in plots of:\n\nResiduals versus fitted values (Residual Plots)—best\nResiduals versus predictors (Residual Plots)\nOutcome versus fitted values (Marginal Model Plots)\nOutcome versus predictors, ignoring other predictors (Marginal Model Plots)\nOutcome versus predictors, controlling for other predictors (Added-Variable Plots)\n\n19.1.1.2 Ways to Handle\n\nTransform outcome/predictor variables (Box-Cox transformations)\nSemi-parametric regression models: Generalized additive models (GAM)\nNon-parametric regression models: Nearest-Neighbor Kernel Regression\n\n\n19.1.1.2.1 Semi-parametric or non-parametric regression models\nhttp://www.lisa.stat.vt.edu/?q=node/7517 (archived at https://web.archive.org/web/20180113065042/http://www.lisa.stat.vt.edu/?q=node/7517)\nNote: using semi-parametric or non-parametric models increases fit in context of nonlinearity at the expense of added complexity. Make sure to avoid fitting an overly complex model (e.g., use k-fold cross validation). Often, the simpler (generalized) linear model is preferable to semi-paremetric or non-parametric approaches\n\n19.1.1.2.1.1 Semi-parametric: Generalized Additive Models\nhttp://documents.software.dell.com/Statistics/Textbook/Generalized-Additive-Models (archived at https://web.archive.org/web/20170213041653/http://documents.software.dell.com/Statistics/Textbook/Generalized-Additive-Models)\n\nCodegeneralizedAdditiveModel &lt;- gam(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  family = gaussian(),\n  data = mydata,\n  na.action = na.exclude)\n\nsummary(generalizedAdditiveModel)\n\n\nFamily: gaussian \nLink function: identity \n\nFormula:\nbpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum\n\nParametric coefficients:\n                        Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)              1.19830    0.05983  20.029  &lt; 2e-16 ***\nbpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***\nbpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nR-sq.(adj) =  0.261   Deviance explained = 26.2%\nGCV = 3.9191  Scale est. = 3.915     n = 2874\n\nCodeconfint(generalizedAdditiveModel)\n\nError in `glm.control()`:\n! unused arguments (nthreads = 1, ncv.threads = 1, irls.reg = 0, mgcv.tol = 1e-07, mgcv.half = 15, rank.tol = 1.49011611938477e-08, nlm = list(7, 1e-06, 2, 1e-04, 200, FALSE), optim = list(1e+07), newton = list(1e-06, 5, 2, 30, FALSE), idLinksBases = TRUE, scalePenalty = TRUE, efs.lspmax = 15, efs.tol = 0.1, keepData = FALSE, scale.est = \"fletcher\", edge.correct = FALSE)\n\n\n\n19.1.1.2.1.2 Non-parametric: Nearest-Neighbor Kernel Regression\n\n19.1.2 2. Exogeneity\nExogeneity means that the association between predictors and outcome is fully causal and unrelated to other variables.\n\n19.1.2.1 Ways to Test\n\nDurbin-Wu-Hausman test of endogeneity\n\n\n19.1.2.1.1 Durbin-Wu-Hausman test of endogeneity\nThe instrumental variables (2SLS) estimator is implemented in the R package AER as command:\n\nCodeivreg(y ~ x1 + x2 + w1 + w2 | z1 + z2 + z3 + w1 + w2)\n\n\nwhere x1 and x2 are endogenous regressors, w1 and w2 exogeneous regressors, and z1 to z3 are excluded instruments.\nDurbin-Wu-Hausman test:\n\nCodehsng2 &lt;- read.dta(\"https://www.stata-press.com/data/r11/hsng2.dta\") #archived at https://perma.cc/7P2Q-ARKR\n\n\n\nCodefiv &lt;- ivreg(\n  rent ~ hsngval + pcturban | pcturban + faminc + reg2 + reg3 + reg4,\n  data = hsng2) #Housing values are likely endogeneous and therefore instrumented by median family income (faminc) and 3 regional dummies (reg2, reg4, reg4)\n\nsummary(\n  fiv,\n  diagnostics = TRUE)\n\n\nCall:\nivreg(formula = rent ~ hsngval + pcturban | pcturban + faminc + \n    reg2 + reg3 + reg4, data = hsng2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-84.1948 -11.6023  -0.5239   8.6583  73.6130 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 1.207e+02  1.571e+01   7.685 7.55e-10 ***\nhsngval     2.240e-03  3.388e-04   6.612 3.17e-08 ***\npcturban    8.152e-02  3.082e-01   0.265    0.793    \n\nDiagnostic tests:\n                 df1 df2 statistic  p-value    \nWeak instruments   4  44     13.30  3.5e-07 ***\nWu-Hausman         1  46     15.91 0.000236 ***\nSargan             3  NA     11.29 0.010268 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 22.86 on 47 degrees of freedom\nMultiple R-Squared: 0.5989, Adjusted R-squared: 0.5818 \nWald test: 42.66 on 2 and 47 DF,  p-value: 2.731e-11 \n\n\nThe Eicker-Huber-White covariance estimator which is robust to heteroscedastic error terms is reported after estimation with vcov = sandwich in coeftest()\nFirst stage results are reported by explicitly estimating them. For example:\n\nCodefirst &lt;- lm(\n  hsngval ~ pcturban + faminc + reg2 + reg3 + reg4,\n  data = hsng2)\n\nsummary(first)\n\n\nCall:\nlm(formula = hsngval ~ pcturban + faminc + reg2 + reg3 + reg4, \n    data = hsng2)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-10504  -5223  -1162   2939  46756 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -1.867e+04  1.200e+04  -1.557 0.126736    \npcturban     1.822e+02  1.150e+02   1.584 0.120289    \nfaminc       2.731e+00  6.819e-01   4.006 0.000235 ***\nreg2        -5.095e+03  4.122e+03  -1.236 0.223007    \nreg3        -1.778e+03  4.073e+03  -0.437 0.664552    \nreg4         1.341e+04  4.048e+03   3.314 0.001849 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 9253 on 44 degrees of freedom\nMultiple R-squared:  0.6908,    Adjusted R-squared:  0.6557 \nF-statistic: 19.66 on 5 and 44 DF,  p-value: 3.032e-10\n\n\nIn case of a single endogenous variable (K = 1), the F-statistic to assess weak instruments is reported after estimating the first stage with, for example:\n\nCodewaldtest(\n  first,\n  . ~ . - faminc - reg2 - reg3 - reg4)\n\n\n  \n\n\n\nor in case of heteroscedatistic errors:\n\nCodewaldtest(\n  first,\n  . ~ . - faminc - reg2 - reg3- reg4,\n  vcov = sandwich)\n\n\n  \n\n\n\n\n19.1.2.2 Ways to Handle\n\nConduct an experiment/RCT with random assignment\nInstrumental variables\n\n19.1.3 3. Homoscedasticity of residuals\nHomoscedasticity of the residuals means that the variance of the residuals does not differ as a function of the outcome/predictors (i.e., the residuals show constant variance as a function of outcome/predictors).\n\n19.1.3.1 Ways to Test\n\nPlot residuals vs. outcome and predictor variables (Residual Plots)\nPlot residuals vs. fitted values (Residual Plots)\nTime Series data: Plot residuals vs. time\nSpread-level plot\nBreusch-Pagan test: bptest() function from lmtest package\nGoldfeld-Quandt Test\n\n\n19.1.3.1.1 Residuals vs. outcome and predictor variables\nPlot residuals, or perhaps their absolute values, versus the outcome and predictor variables (Residual Plots). Examine whether residual variance is constant at all levels of other variables or whether it increases/decreases as a function of another variable (or shows some others structure, e.g., small variance at low and high levels of a predictor and high variance in the middle). Note that this is different than whether the residuals show non-linearities—i.e., a non-horizontal line, which would indicate a nonlinear association between variables (see Assumption #1, above). Rather, here we are examining whether there is change in the variance as a function of another variable (e.g., a fan-shaped Residual Plot)\n\n19.1.3.1.2 Spread-level plot\nExamining whether level (e.g., mean) depends on spread (e.g., variance)—plot of log of the absolute Studentized residuals against the log of the fitted values\n\nCodespreadLevelPlot(multipleRegressionModel)\n\n\n\n\n\n\n\n\nSuggested power transformation:  0.5304728 \n\n\n\n19.1.3.1.3 Breusch-Pagan test\nhttps://www.rdocumentation.org/packages/lmtest/versions/0.9-40/topics/bptest (archived at https://perma.cc/K4WC-7TVW)\n\nCodebptest(multipleRegressionModel)\n\n\n    studentized Breusch-Pagan test\n\ndata:  multipleRegressionModel\nBP = 94.638, df = 2, p-value &lt; 2.2e-16\n\n\n\n19.1.3.1.4 Goldfeld-Quandt Test\n\nCodegqtest(multipleRegressionModel)\n\n\n    Goldfeld-Quandt test\n\ndata:  multipleRegressionModel\nGQ = 1.0755, df1 = 1434, df2 = 1434, p-value = 0.08417\nalternative hypothesis: variance increases from segment 1 to 2\n\n\n\n19.1.3.1.5 Test of dependence of spread on level\n\nCodencvTest(multipleRegressionModel)\n\nNon-constant Variance Score Test \nVariance formula: ~ fitted.values \nChisquare = 232.1196, Df = 1, p = &lt; 2.22e-16\n\n\n\n19.1.3.1.6 Test of dependence of spread on predictors\n\nCodencvTest(\n  multipleRegressionModel,\n  ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum)\n\nNon-constant Variance Score Test \nVariance formula: ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum \nChisquare = 233.2878, Df = 2, p = &lt; 2.22e-16\n\n\n\n19.1.3.2 Ways to Handle\n\nIf residual variance increases as a function of the fitted values, consider a poisson regression model (especially for count data), for which the variance does increase with the mean\nIf residual variance differs as a function of model predictors, consider adding interactions/product terms (the effect of one variable depends on the level of another variable)\nTry transforming the outcome variable to be normally distributed (log-transform if the errors seem consistent in percentage rather than absolute terms)\nIf the error variance is proportional to a variable \\(z\\), then fit the model using Weighted Least Squares (WLS), with the weights given be \\(1/z\\)\n\nWeighted least squares (WLS) using the “weights” argument of the lm() function; to get weights, see: https://stats.stackexchange.com/a/100410/20338 (archived at https://perma.cc/C6BY-G9MS)\nHuber-White standard errors (a.k.a. “Sandwich” estimates) from a heteroscedasticity-corrected covariance matrix\n\n\ncoeftest() function from the sandwich package along with hccm sandwich estimates from the car package\n\nrobcov() function from the rms package\n\n\nTime series data: ARCH (auto-regressive conditional heteroscedasticity) models\nTime series data: seasonal patterns can be addressed by applying log transformation to outcome variable\n\n\n19.1.3.2.1 Huber-White standard errors\nStandard errors (SEs) on the diagonal increase\n\nCodevcov(multipleRegressionModel)\n\n                          (Intercept) bpi_antisocialT1Sum\n(Intercept)              0.0035795220       -0.0006533375\nbpi_antisocialT1Sum     -0.0006533375        0.0003453814\nbpi_anxiousDepressedSum -0.0003167540       -0.0002574524\n                        bpi_anxiousDepressedSum\n(Intercept)                       -0.0003167540\nbpi_antisocialT1Sum               -0.0002574524\nbpi_anxiousDepressedSum            0.0008501565\n\nCodehccm(multipleRegressionModel)\n\nError in `V %*% t(X) %*% apply(X, 2, \"*\", (e^2) / factor)`:\n! non-conformable arguments\n\nCodesummary(multipleRegressionModel)\n\n\nCall:\nlm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    data = mydata, na.action = na.exclude)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8.3755 -1.2337 -0.2212  0.9911 12.8017 \n\nCoefficients:\n                        Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)              1.19830    0.05983  20.029  &lt; 2e-16 ***\nbpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***\nbpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.979 on 2871 degrees of freedom\n  (8656 observations deleted due to missingness)\nMultiple R-squared:  0.262, Adjusted R-squared:  0.2615 \nF-statistic: 509.6 on 2 and 2871 DF,  p-value: &lt; 2.2e-16\n\nCodecoeftest(multipleRegressionModel, vcov = sandwich)\n\n\nt test of coefficients:\n\n                        Estimate Std. Error t value  Pr(&gt;|t|)    \n(Intercept)             1.198300   0.062211 19.2618 &lt; 2.2e-16 ***\nbpi_antisocialT1Sum     0.465529   0.022929 20.3030 &lt; 2.2e-16 ***\nbpi_anxiousDepressedSum 0.160754   0.032991  4.8727  1.16e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCodecoeftest(multipleRegressionModel, vcov = hccm)\n\nError in `V %*% t(X) %*% apply(X, 2, \"*\", (e^2) / factor)`:\n! non-conformable arguments\n\nCoderobcov(ols(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  x = TRUE,\n  y = TRUE))\n\nFrequencies of Missing Values Due to Each Variable\n    bpi_antisocialT2Sum     bpi_antisocialT1Sum bpi_anxiousDepressedSum \n                   7501                    7613                    7616 \n\nLinear Regression Model\n\nols(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    data = mydata, x = TRUE, y = TRUE)\n\n                Model Likelihood    Discrimination    \n                      Ratio Test           Indexes    \nObs    2874    LR chi2    873.09    R2       0.262    \nsigma1.9786    d.f.            2    R2 adj   0.261    \nd.f.   2871    Pr(&gt; chi2) 0.0000    g        1.278    \n\nResiduals\n\n    Min      1Q  Median      3Q     Max \n-8.3755 -1.2337 -0.2212  0.9911 12.8017 \n\n                        Coef   S.E.   t     Pr(&gt;|t|)\nIntercept               1.1983 0.0622 19.26 &lt;0.0001 \nbpi_antisocialT1Sum     0.4655 0.0229 20.30 &lt;0.0001 \nbpi_anxiousDepressedSum 0.1608 0.0330  4.87 &lt;0.0001 \n\n\nUse “cluster” variable to account for nested data within-subject:\n\nCoderobcov(ols(\n  t_ext ~ m_ext + age,\n  data = mydata,\n  x = TRUE,\n  y = TRUE),\n  cluster = mydata$tcid) #account for nested data within subject\n\n\n\n19.1.4 4. Errors are independent\nIndependent errors means that the errors are uncorrelated with each other.\n\n19.1.4.1 Ways to Test\n\nIntraclass correlation coefficient (ICC) from mixed model\nPlot residuals vs. predictors (Residual Plots)\nTime Series data: Residual time series plot (residuals vs. row number)\nTime Series data: Table or plot of residual autocorrelations\nTime Series data: Durbin-Watson statistic for test of significant residual autocorrelation at lag 1\n\n19.1.4.2 Ways to Handle\n\nGeneralized least squares (GLS) models are capable of handling correlated errors: https://stat.ethz.ch/R-manual/R-devel/library/nlme/html/gls.html (archived at https://perma.cc/RHZ6-5GT8)\nRegression with cluster variable\n\n\nrobcov() from rms package\n\n\n\nHierarchical linear modeling\n\nLinear mixed effects models\nGeneralized linear mixed effects models\nNonlinear mixed effects models\n\n\n\n19.1.5 5. No multicollinearity\nMulticollinearity occurs when the predictors are correlated with each other.\n\n19.1.5.1 Ways to Test\n\nVariance Inflation Factor (VIF)\nGeneralized Variance Inflation Factor (GVIF)—when models have related regressors (multiple polynomial terms or contrasts from same predictor)\nCorrelation\nTolerance\nCondition Index\n\n\n19.1.5.1.1 Variance Inflation Factor (VIF)\n\\[\n\\text{VIF} = 1/\\text{Tolerance}\n\\]\nIf the variance inflation factor of a predictor variable were 5.27 (\\(\\sqrt{5.27} = 2.3\\)), this means that the standard error for the coefficient of that predictor variable is 2.3 times as large (i.e., confidence interval is 2.3 times wider) as it would be if that predictor variable were uncorrelated with the other predictor variables.\nVIF = 1: Not correlated\n1 &lt; VIF &lt; 5: Moderately correlated\nVIF &gt; 5 to 10: Highly correlated (multicollinearity present)\n\nCodevif(multipleRegressionModel)\n\n    bpi_antisocialT1Sum bpi_anxiousDepressedSum \n               1.291545                1.291545 \n\n\n\n19.1.5.1.2 Generalized Variance Inflation Factor (GVIF)\nUseful when models have related regressors (multiple polynomial terms or contrasts from same predictor)\n\n19.1.5.1.3 Correlation\ncorrelation among all independent variables the correlation coefficients should be smaller than .08\n\nCodecor(\n  mydata[,c(\"bpi_antisocialT1Sum\",\"bpi_anxiousDepressedSum\")],\n  use = \"pairwise.complete.obs\")\n\n                        bpi_antisocialT1Sum bpi_anxiousDepressedSum\nbpi_antisocialT1Sum                1.000000                0.497279\nbpi_anxiousDepressedSum            0.497279                1.000000\n\n\n\n19.1.5.1.4 Tolerance\nThe tolerance is an index of the influence of one independent variable on all other independent variables.\n\\[\n\\text{tolerance} = 1/\\text{VIF}\n\\]\nT &lt; 0.2: there might be multicollinearity in the data\nT &lt; 0.01: there certainly is multicollinarity in the data\n\n19.1.5.1.5 Condition Index\nThe condition index is calculated using a factor analysis on the independent variables. Values of 10-30 indicate a mediocre multicollinearity in the regression variables. Values &gt; 30 indicate strong multicollinearity.\nFor how to interpret, see here: https://stats.stackexchange.com/a/87610/20338 (archived at https://perma.cc/Y4J8-MY7Q)\n\nCodeols_eigen_cindex(multipleRegressionModel)\n\n\n  \n\n\n\n\n19.1.5.2 Ways to Handle\n\nRemove highly correlated (i.e., redundant) predictors\nAverage the correlated predictors\n\nPrincipal Component Analysis for data reduction\nStandardize predictors\nCenter the data (deduct the mean)\nSingular-value decomposition of the model matrix or the mean-centered model matrix\nConduct a factor analysis and rotate the factors to ensure independence of the factors\n\n19.1.6 6. Errors are normally distributed\n\n19.1.6.1 Ways to Test\n\nProbability Plots\n\n\nNormal Quantile (QQ) Plots (based on non-cumulative distribution of residuals)\n\nNormal Probability (PP) Plots (based on cumulative distribution of residuals)\n\n\nDensity Plot of Residuals\nStatistical Tests\n\nKolmogorov-Smirnov test\nShapiro-Wilk test\nJarque-Bera test\nAnderson-Darling test (best test)\n\n\nExamine influence of outliers\n\n19.1.6.2 Ways to Handle\n\nApply a transformation to the predictor or outcome variable\nExclude outliers\nRobust regression\n\nBest when no outliers: MM-type regression estimator\n\n\nlmrob()/glmrob() function of robustbase package\nIteratively reweighted least squares (IRLS): rlm(, method = \"MM\") function of MASS package: http://www.ats.ucla.edu/stat/r/dae/rreg.htm (archived at https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm)\n\n\nMost resistant to outliers: Least trimmed squares (LTS)—but not good as a standalone estimator, better for identifying outliers\n\n\nltsReg() function of robustbase package (best)\n\n\nBest when single predictor: Theil-Sen estimator\n\n\nmblm(, repeated = FALSE) function of mblm package\n\n\nRobust correlation\n\nSpearman’s rho: cor(, method = \"spearman\")\n\nPercentage bend correlation\nMinimum vollume ellipsoid\nMinimum covariance determinant:\nWinsorized correlation\nBiweight midcorrelation\nXi (\\(\\xi\\)) correlation\n\n\nNot great options:\n\nQuantile (L1) regression: rq() function of quantreg package\n\n\n\n\n\n\n19.1.6.2.1 Transformations of Outcome Variable\n\n19.1.6.2.1.1 Box-Cox Transformation\nUseful if the outcome is strictly positive (or add a constant to outcome to make it strictly positive)\nlambda = -1: inverse transformation\nlambda = -0.5: 1/sqrt(Y)\nlambda = 0: log transformation\nlambda = 0.5: square root\nlambda = 0.333: cube root\nlambda = 1: no transformation\nlambda = 2: squared\nRaw distribution\n\nCodeplot(density(na.omit(mydata$bpi_antisocialT2Sum)))\n\n\n\n\n\n\n\nAdd constant to outcome to make it strictly positive\n\nCodestrictlyPositiveDV &lt;- lm(\n  bpi_antisocialT2Sum + 1 ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude)\n\n\nIdentify best power transformation (lambda)\nConsider rounding the power to a common value (square root = .5; cube root = .333; squared = 2)\n\nCodeboxCox(strictlyPositiveDV)\n\n\n\n\n\n\nCodepowerTransform(strictlyPositiveDV) \n\nEstimated transformation parameter \n      Y1 \n0.234032 \n\nCodetransformedDV &lt;- powerTransform(strictlyPositiveDV)\n\nsummary(transformedDV)\n\nbcPower Transformation to Normality \n   Est Power Rounded Pwr Wald Lwr Bnd Wald Upr Bnd\nY1     0.234        0.23       0.1825       0.2856\n\nLikelihood ratio test that transformation parameter is equal to 0\n (log transformation)\n                           LRT df       pval\nLR test, lambda = (0) 78.04052  1 &lt; 2.22e-16\n\nLikelihood ratio test that no transformation is needed\n                           LRT df       pval\nLR test, lambda = (1) 853.8675  1 &lt; 2.22e-16\n\n\nTransform the DV\n\nCodemydata$bpi_antisocialT2SumTransformed &lt;- bcPower(mydata$bpi_antisocialT2Sum + 1, coef(transformedDV))\n\nplot(density(na.omit(mydata$bpi_antisocialT2SumTransformed)))\n\n\n\n\n\n\n\nCompare residuals from model with and without transformation\nModel without transformation\n\nCodesummary(modelWithoutTransformation &lt;- lm(\n  bpi_antisocialT2Sum + 1 ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude))\n\n\nCall:\nlm(formula = bpi_antisocialT2Sum + 1 ~ bpi_antisocialT1Sum + \n    bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8.3755 -1.2337 -0.2212  0.9911 12.8017 \n\nCoefficients:\n                        Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)              2.19830    0.05983  36.743  &lt; 2e-16 ***\nbpi_antisocialT1Sum      0.46553    0.01858  25.049  &lt; 2e-16 ***\nbpi_anxiousDepressedSum  0.16075    0.02916   5.513 3.83e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.979 on 2871 degrees of freedom\n  (8656 observations deleted due to missingness)\nMultiple R-squared:  0.262, Adjusted R-squared:  0.2615 \nF-statistic: 509.6 on 2 and 2871 DF,  p-value: &lt; 2.2e-16\n\nCodeplot(density(na.omit(studres(modelWithoutTransformation))))\n\n\n\n\n\n\n\nModel with transformation\n\nCodesummary(modelWithTransformation &lt;- lm(\n  bpi_antisocialT2SumTransformed ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude))\n\n\nCall:\nlm(formula = bpi_antisocialT2SumTransformed ~ bpi_antisocialT1Sum + \n    bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.3429 -0.4868  0.0096  0.4922  2.9799 \n\nCoefficients:\n                        Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)             0.800373   0.022024  36.342  &lt; 2e-16 ***\nbpi_antisocialT1Sum     0.165476   0.006841  24.189  &lt; 2e-16 ***\nbpi_anxiousDepressedSum 0.055910   0.010733   5.209 2.03e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.7283 on 2871 degrees of freedom\n  (8656 observations deleted due to missingness)\nMultiple R-squared:  0.2477,    Adjusted R-squared:  0.2472 \nF-statistic: 472.7 on 2 and 2871 DF,  p-value: &lt; 2.2e-16\n\nCodeplot(density(na.omit(studres(modelWithTransformation))))\n\n\n\n\n\n\n\nConstructed Variable Test & Plot\nA significant p-value indicates a strong need to transform variable:\n\nCodemultipleRegressionModel_constructedVariable &lt;- update(\n  multipleRegressionModel,\n  . ~ . + boxCoxVariable(bpi_antisocialT1Sum + 1))\nsummary(multipleRegressionModel_constructedVariable)$coef[\"boxCoxVariable(bpi_antisocialT1Sum + 1)\", , drop = FALSE]\n\n                                           Estimate Std. Error   t value\nboxCoxVariable(bpi_antisocialT1Sum + 1) -0.06064732 0.04683415 -1.294938\n                                         Pr(&gt;|t|)\nboxCoxVariable(bpi_antisocialT1Sum + 1) 0.1954457\n\n\nPlot allows us to see whether the need for transformation is spread through data or whether it is just dependent on a small fraction of observations:\n\nCodeavPlots(multipleRegressionModel_constructedVariable, \"boxCoxVariable(bpi_antisocialT1Sum + 1)\")\n\n\n\n\n\n\n\nInverse Response Plot\nThe black line is the best-fitting power transformation:\n\nCodeinverseResponsePlot(strictlyPositiveDV, lambda = c(-1,-0.5,0,1/3,.5,1,2))\n\n\n\n\n\n\n\n\n  \n\n\n\n\n19.1.6.2.1.2 Yeo-Johnson Transformations\nUseful if the outcome is not strictly positive.\n\nCodeyjPower(DV, lambda)\n\n\n\n19.1.6.2.2 Transformations of Predictor Variable\n\n19.1.6.2.2.1 Component-Plus-Residual Plots (Partial Residual Plots)\nLinear model:\n\nCodecrPlots(multipleRegressionModelNoMissing, order = 1)\n\n\n\n\n\n\n\nQuadratic model:\n\nCodecrPlots(multipleRegressionModelNoMissing, order = 2)\n\n\n\n\n\n\n\n\nCodemultipleRegressionModel_quadratic &lt;- lm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + I(bpi_antisocialT1Sum^2) + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude)\n\nsummary(multipleRegressionModel_quadratic)\n\n\nCall:\nlm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + I(bpi_antisocialT1Sum^2) + \n    bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-7.6238 -1.2610 -0.2484  0.9923 12.9008 \n\nCoefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)               1.099237   0.076509  14.367  &lt; 2e-16 ***\nbpi_antisocialT1Sum       0.547680   0.043723  12.526  &lt; 2e-16 ***\nI(bpi_antisocialT1Sum^2) -0.010221   0.004925  -2.075    0.038 *  \nbpi_anxiousDepressedSum   0.161734   0.029144   5.549 3.13e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.977 on 2870 degrees of freedom\n  (8656 observations deleted due to missingness)\nMultiple R-squared:  0.2631,    Adjusted R-squared:  0.2623 \nF-statistic: 341.5 on 3 and 2870 DF,  p-value: &lt; 2.2e-16\n\nCodeanova(\n  multipleRegressionModel_quadratic,\n  multipleRegressionModel)\n\n\n  \n\n\nCodecrPlots(multipleRegressionModel_quadratic, order = 1)\n\n\n\n\n\n\n\n\n19.1.6.2.2.2 CERES Plot (Combining conditional Expectations and RESiduals)\nUseful when nonlinear associations among the predictors are very strong (component-plus-residual plots may appear nonlinear even though the true partial regression is linear, a phenonomen called leakage)\n\nCodeceresPlots(multipleRegressionModel)\n\n\n\n\n\n\nCodeceresPlots(multipleRegressionModel_quadratic)\n\nError in `plot.window()`:\n! need finite 'ylim' values\n\n\n\n\n\n\n\n\n\n19.1.6.2.2.3 Box-Tidwell Method for Choosing Predictor Transformations\npredictors must be strictly positive (or add a constant to make it strictly positive)\n\nCodeboxTidwell(\n  bpi_antisocialT2Sum ~ I(bpi_antisocialT1Sum + 1) + I(bpi_anxiousDepressedSum + 1),\n  other.x = NULL, #list variables not to be transformed in other.x\n  data = mydata,\n  na.action = na.exclude)\n\n                               MLE of lambda Score Statistic (t) Pr(&gt;|t|)\nI(bpi_antisocialT1Sum + 1)           0.90820             -1.0591   0.2897\nI(bpi_anxiousDepressedSum + 1)       0.36689             -1.0650   0.2870\n\niterations =  4 \n\nScore test for null hypothesis that all lambdas = 1:\nF = 1.4056, df = 2 and 2869, Pr(&gt;F) = 0.2454\n\n\n\n19.1.6.2.2.4 Constructed-Variables Plot\n\nCodemultipleRegressionModel_cv &lt;- lm(\n  bpi_antisocialT2Sum ~ I(bpi_antisocialT1Sum + 1) + I(bpi_anxiousDepressedSum + 1) + I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum)) + I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum)),\n  data = mydata,\n  na.action = na.exclude)\n\nsummary(multipleRegressionModel_cv)$coef[\"I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum))\", , drop = FALSE]\n\n                                                    Estimate Std. Error\nI(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum)) -0.1691003 0.06887107\n                                                    t value   Pr(&gt;|t|)\nI(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum)) -2.455317 0.01418393\n\nCodesummary(multipleRegressionModel_cv)$coef[\"I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum))\", , drop = FALSE]\n\n                                                            Estimate Std. Error\nI(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum)) 0.00828867  0.1384918\n                                                             t value  Pr(&gt;|t|)\nI(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum)) 0.05984953 0.9522831\n\nCodeavPlots(multipleRegressionModel_cv, \"I(bpi_antisocialT1Sum * log(bpi_antisocialT1Sum))\")\n\n\n\n\n\n\nCodeavPlots(multipleRegressionModel_cv, \"I(bpi_anxiousDepressedSum * log(bpi_anxiousDepressedSum))\")\n\n\n\n\n\n\n\n\n19.1.6.2.3 Robust models\nResources\n\nFor comparison of methods, see Book: “Modern Methods for Robust Regression”\n\nhttp://www.ats.ucla.edu/stat/r/dae/rreg.htm (archived at https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm)\n\nhttps://stats.stackexchange.com/a/46234/20338 (archived at https://perma.cc/WC57-9GA7)\n\nhttps://cran.r-project.org/web/views/Robust.html (archived at https://perma.cc/THN5-KNY3)\n\n\n19.1.6.2.3.1 Robust correlation\nSpearman’s rho\nSpearman’s rho is a non-parametric correlation.\n\nCodecor.test(\n  mydata$bpi_antisocialT1Sum,\n  mydata$bpi_antisocialT2Sum) #Pearson r, correlation that is sensitive to outliers\n\n\n    Pearson's product-moment correlation\n\ndata:  mydata$bpi_antisocialT1Sum and mydata$bpi_antisocialT2Sum\nt = 31.274, df = 2873, p-value &lt; 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.4761758 0.5307381\nsample estimates:\n      cor \n0.5039595 \n\nCodecor.test(\n  mydata$bpi_antisocialT1Sum,\n  mydata$bpi_antisocialT2Sum, method = \"spearman\") #Spearman's rho, a rank correlation that is less sensitive to outliers\n\n\n    Spearman's rank correlation rho\n\ndata:  mydata$bpi_antisocialT1Sum and mydata$bpi_antisocialT2Sum\nS = 1997347186, p-value &lt; 2.2e-16\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n      rho \n0.4956973 \n\n\nMinimum vollume ellipsoid\n\nCodecov.mve(\n  na.omit(mydata[,c(\"bpi_antisocialT1Sum\",\"bpi_antisocialT2Sum\")]),\n  cor = TRUE)\n\n\n\n\n$center\nbpi_antisocialT1Sum bpi_antisocialT2Sum \n           2.354446            2.232665 \n\n$cov\n                    bpi_antisocialT1Sum bpi_antisocialT2Sum\nbpi_antisocialT1Sum            2.960392            1.912500\nbpi_antisocialT2Sum            1.912500            2.950676\n\n$msg\n[1] \"162 singular samples of size 3 out of 1500\"\n\n$crit\n[1] 3.871201\n\n$best\n[1]  1  3  8  9 10 12\n\n$cor\n                    bpi_antisocialT1Sum bpi_antisocialT2Sum\nbpi_antisocialT1Sum           1.0000000           0.6470919\nbpi_antisocialT2Sum           0.6470919           1.0000000\n\n$n.obs\n[1] 2875\n\n\nMinimum covariance determinant\n\nCodecov.mcd(\n  na.omit(mydata[,c(\"bpi_antisocialT1Sum\",\"bpi_antisocialT2Sum\")]),\n  cor = TRUE)\n\n\n\n\n$center\nbpi_antisocialT1Sum bpi_antisocialT2Sum \n           2.181181            2.094954 \n\n$cov\n                    bpi_antisocialT1Sum bpi_antisocialT2Sum\nbpi_antisocialT1Sum            2.379036            1.096437\nbpi_antisocialT2Sum            1.096437            2.482409\n\n$msg\n[1] \"164 singular samples of size 3 out of 1500\"\n\n$crit\n[1] -0.3839279\n\n$best\n[1]  1  3  8  9 10 12\n\n$cor\n                    bpi_antisocialT1Sum bpi_antisocialT2Sum\nbpi_antisocialT1Sum           1.0000000           0.4511764\nbpi_antisocialT2Sum           0.4511764           1.0000000\n\n$n.obs\n[1] 2875\n\n\nWinsorized correlation\n\nCodecorrelation(\n  mydata[,c(\"bpi_antisocialT1Sum\",\"bpi_antisocialT2Sum\")],\n  winsorize = 0.2,\n  p_adjust = \"none\")\n\n\n  \n\n\n\nPercentage bend correlation\n\nCodecorrelation(\n  mydata[,c(\"bpi_antisocialT1Sum\",\"bpi_antisocialT2Sum\")],\n  method = \"percentage\",\n  p_adjust = \"none\")\n\n\n  \n\n\n\nBiweight midcorrelation\n\nCodecorrelation(\n  mydata[,c(\"bpi_antisocialT1Sum\",\"bpi_antisocialT2Sum\")],\n  method = \"biweight\",\n  p_adjust = \"none\")\n\n\n  \n\n\n\nXi (\\(\\xi\\))\nXi (\\(\\xi\\)) is an index of the degree of dependence between two variables\nChatterjee, S. (2021). A new coefficient of correlation. Journal of the American Statistical Association, 116(536), 2009-2022. https://doi.org/10.1080/01621459.2020.1758115\n\nCodeset.seed(52242) # for reproducibility\n\nXICOR::xicor(\n  mydata$bpi_antisocialT1Sum,\n  mydata$bpi_antisocialT2Sum,\n  method = \"permutation\",\n  pvalue = TRUE\n)\n\n$xi\n[1] 0.1751217\n\n$sd\n[1] 0.012695\n\n$pval\n[1] 0\n\n\n\n19.1.6.2.3.2 Robust regression with a single predictor\nTheil-Sen estimator\nThe Theil-Sen single median estimator is robust to outliers; have to remove missing values first\n\nCodemydata_subset &lt;- na.omit(mydata[,c(\"bpi_antisocialT1Sum\",\"bpi_antisocialT2Sum\")])[1:400,]\nmblm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum,\n  dataframe = mydata_subset,\n  repeated = FALSE)\n\n\nCall:\nmblm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum, dataframe = mydata_subset, \n    repeated = FALSE)\n\nCoefficients:\n        (Intercept)  bpi_antisocialT1Sum  \n                1.0                  0.6  \n\n\n\n19.1.6.2.3.3 Robust multiple regression\nBest when no outliers: MM-type regression estimator\nRobust linear regression\nMM-type regression estimator (best):\n\nCodelmrob(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude)\n\n\nCall:\nlmrob(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,     data = mydata, na.action = na.exclude)\n \\--&gt; method = \"MM\"\nCoefficients:\n            (Intercept)      bpi_antisocialT1Sum  bpi_anxiousDepressedSum  \n                 0.9440                   0.4914                   0.1577  \n\n\nIteratively reweighted least squares (IRLS): http://www.ats.ucla.edu/stat/r/dae/rreg.htm (archived at https://web.archive.org/web/20161119025907/http://www.ats.ucla.edu/stat/r/dae/rreg.htm)\n\nCoderlm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude)\n\nCall:\nrlm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    data = mydata, na.action = na.exclude)\nConverged in 6 iterations\n\nCoefficients:\n            (Intercept)     bpi_antisocialT1Sum bpi_anxiousDepressedSum \n              0.9838033               0.4873118               0.1620020 \n\nDegrees of freedom: 2874 total; 2871 residual\n  (8656 observations deleted due to missingness)\nScale estimate: 1.62 \n\n\nRobust generalized regression\n\nCodeglmrob(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  family = \"poisson\",\n  na.action = \"na.exclude\")\n\n\nCall:  glmrob(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum +      bpi_anxiousDepressedSum, family = \"poisson\", data = mydata,      na.action = \"na.exclude\") \n\nCoefficients:\n            (Intercept)      bpi_antisocialT1Sum  bpi_anxiousDepressedSum  \n                0.37281                  0.15589                  0.05026  \n\nNumber of observations: 2874 \nFitted by method  'Mqle' \n\n\nMost resistant to outliers: Least trimmed squares (LTS)—but not good as a standalone estimator, better for identifying outliers\n\nCodeltsReg(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude)\n\n\nCall:\nltsReg.formula(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum +     bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)\n\nCoefficients:\n              Intercept      bpi_antisocialT1Sum  bpi_anxiousDepressedSum  \n                 0.7813                   0.5145                   0.1318  \n\nScale estimate 1.75 \n\n\nNot great options:\nQuantile (L1) regression: rq() function of quantreg package\nhttps://data.library.virginia.edu/getting-started-with-quantile-regression/ (archived at https://perma.cc/FSV4-5DCR)\n\nCodequantiles &lt;- 1:9/10\n\nquantileRegressionModel &lt;- rq(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  tau = quantiles,\n  na.action = na.exclude)\n\nquantileRegressionModel\n\nCall:\nrq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    tau = quantiles, data = mydata, na.action = na.exclude)\n\nCoefficients:\n                           tau= 0.1  tau= 0.2   tau= 0.3 tau= 0.4 tau= 0.5\n(Intercept)             -0.19607843 0.0000000 0.09090909      0.5     0.88\nbpi_antisocialT1Sum      0.19607843 0.3333333 0.45454545      0.5     0.52\nbpi_anxiousDepressedSum  0.09803922 0.1111111 0.13636364      0.1     0.12\n                         tau= 0.6 tau= 0.7 tau= 0.8  tau= 0.9\n(Intercept)             1.0000000   1.3750   2.1250 3.1000000\nbpi_antisocialT1Sum     0.5913978   0.6250   0.6250 0.6428571\nbpi_anxiousDepressedSum 0.2043011   0.1875   0.1875 0.2285714\n\nDegrees of freedom: 11530 total; 11527 residual\n\nCodesummary(quantileRegressionModel)\n\n\nCall: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    tau = quantiles, data = mydata, na.action = na.exclude)\n\ntau: [1] 0.1\n\nCoefficients:\n                        Value    Std. Error t value  Pr(&gt;|t|)\n(Intercept)             -0.19608  0.05341   -3.67101  0.00025\nbpi_antisocialT1Sum      0.19608  0.03492    5.61452  0.00000\nbpi_anxiousDepressedSum  0.09804  0.03536    2.77276  0.00559\n\nCall: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    tau = quantiles, data = mydata, na.action = na.exclude)\n\ntau: [1] 0.2\n\nCoefficients:\n                        Value    Std. Error t value  Pr(&gt;|t|)\n(Intercept)              0.00000  0.04196    0.00000  1.00000\nbpi_antisocialT1Sum      0.33333  0.02103   15.85299  0.00000\nbpi_anxiousDepressedSum  0.11111  0.02669    4.16376  0.00003\n\nCall: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    tau = quantiles, data = mydata, na.action = na.exclude)\n\ntau: [1] 0.3\n\nCoefficients:\n                        Value    Std. Error t value  Pr(&gt;|t|)\n(Intercept)              0.09091  0.05830    1.55945  0.11900\nbpi_antisocialT1Sum      0.45455  0.02584   17.59380  0.00000\nbpi_anxiousDepressedSum  0.13636  0.03601    3.78723  0.00016\n\nCall: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    tau = quantiles, data = mydata, na.action = na.exclude)\n\ntau: [1] 0.4\n\nCoefficients:\n                        Value    Std. Error t value  Pr(&gt;|t|)\n(Intercept)              0.50000  0.06410    7.80035  0.00000\nbpi_antisocialT1Sum      0.50000  0.02374   21.06425  0.00000\nbpi_anxiousDepressedSum  0.10000  0.03372    2.96584  0.00304\n\nCall: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    tau = quantiles, data = mydata, na.action = na.exclude)\n\ntau: [1] 0.5\n\nCoefficients:\n                        Value    Std. Error t value  Pr(&gt;|t|)\n(Intercept)              0.88000  0.06584   13.36547  0.00000\nbpi_antisocialT1Sum      0.52000  0.02491   20.87561  0.00000\nbpi_anxiousDepressedSum  0.12000  0.03771    3.18245  0.00148\n\nCall: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    tau = quantiles, data = mydata, na.action = na.exclude)\n\ntau: [1] 0.6\n\nCoefficients:\n                        Value    Std. Error t value  Pr(&gt;|t|)\n(Intercept)              1.00000  0.04246   23.55356  0.00000\nbpi_antisocialT1Sum      0.59140  0.02146   27.55553  0.00000\nbpi_anxiousDepressedSum  0.20430  0.03156    6.47422  0.00000\n\nCall: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    tau = quantiles, data = mydata, na.action = na.exclude)\n\ntau: [1] 0.7\n\nCoefficients:\n                        Value    Std. Error t value  Pr(&gt;|t|)\n(Intercept)              1.37500  0.07716   17.82011  0.00000\nbpi_antisocialT1Sum      0.62500  0.02397   26.07659  0.00000\nbpi_anxiousDepressedSum  0.18750  0.03760    4.98623  0.00000\n\nCall: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    tau = quantiles, data = mydata, na.action = na.exclude)\n\ntau: [1] 0.8\n\nCoefficients:\n                        Value    Std. Error t value  Pr(&gt;|t|)\n(Intercept)              2.12500  0.09498   22.37224  0.00000\nbpi_antisocialT1Sum      0.62500  0.03524   17.73509  0.00000\nbpi_anxiousDepressedSum  0.18750  0.05040    3.72020  0.00020\n\nCall: rq(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum, \n    tau = quantiles, data = mydata, na.action = na.exclude)\n\ntau: [1] 0.9\n\nCoefficients:\n                        Value    Std. Error t value  Pr(&gt;|t|)\n(Intercept)              3.10000  0.11730   26.42749  0.00000\nbpi_antisocialT1Sum      0.64286  0.04797   13.40136  0.00000\nbpi_anxiousDepressedSum  0.22857  0.06439    3.54960  0.00039\n\n\nPlot to examine the association between the predictor and the outcome at different levels (i.e., quantiles) of the predictor:\n\nCodeggplot(\n  mydata,\n  aes(bpi_antisocialT1Sum, bpi_antisocialT2Sum)) + \n  geom_point() + \n  geom_quantile(\n    quantiles = quantiles,\n    aes(color = factor(after_stat(quantile))))\n\n\n\n\n\n\n\nBelow is a plot that examines the difference in quantile coefficients (and associated confidence intervals) at different levels (i.e., quantiles) of the predictor. The x-axis is the quantile of the predictor. The y-axis is the slope coefficient. Each black dot is the slope coefficient for the given quantile of the predictor. The red lines are the least squares estimate of the slope coefficient and its confidence interval.\n\nCodeplot(summary(quantileRegressionModel))\n\n\n\n\n\n\nCodeplot(\n  summary(quantileRegressionModel),\n  parm = \"bpi_antisocialT1Sum\")",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "regression.html#examining-model-assumptions",
    "href": "regression.html#examining-model-assumptions",
    "title": "Regression",
    "section": "\n19.2 Examining Model Assumptions",
    "text": "19.2 Examining Model Assumptions\n\n19.2.1 Distribution of Residuals\n\n19.2.1.1 QQ plots\nhttps://www.ucd.ie/ecomodel/Resources/QQplots_WebVersion.html (archived at https://perma.cc/9UC3-3WRX)\n\nCodeqqPlot(multipleRegressionModel, main = \"QQ Plot\", id = TRUE)\n\n\n\n\n\n\n\n[1] 8955 8956\n\nCodeqqnorm(resid(multipleRegressionModel))\n\n\n\n\n\n\nCodeqqnorm(resid(rmsMultipleRegressionModel))\nqqnorm(resid(robustLinearRegression))\n\n\n\n\n\n\nCodeqqnorm(resid(ltsRegression))\n\n\n\n\n\n\nCodeqqnorm(resid(generalizedRegressionModel))\n\n\n\n\n\n\nCodeqqnorm(resid(rmsGeneralizedRegressionModel))\n\nError in `residuals.Glm()`:\n! argument \"type\" is missing, with no default\n\nCodeqqnorm(resid(robustGeneralizedRegression))\n\n\n\n\n\n\nCodeqqnorm(resid(multilevelRegressionModel))\n\nError in `h()`:\n! error in evaluating the argument 'object' in selecting a method for function 'resid': object 'multilevelRegressionModel' not found\n\n\n\n19.2.1.2 PP plots\n\nCodeppPlot(multipleRegressionModel)\n\n\n\n\n\n\nCodeppPlot(rmsMultipleRegressionModel)\nppPlot(robustLinearRegression)\n\n\n\n\n\n\nCodeppPlot(ltsRegression)\n\n\n\n\n\n\nCodeppPlot(generalizedRegressionModel)\n\n\n\n\n\n\nCodeppPlot(rmsGeneralizedRegressionModel)\n\nError in `residuals.Glm()`:\n! argument \"type\" is missing, with no default\n\nCodeppPlot(robustGeneralizedRegression)\n\n\n\n\n\n\n\n\n19.2.1.3 Density Plot of Residuals\n\nCodestudentizedResiduals &lt;- na.omit(rstudent(multipleRegressionModel))\nplot(\n  density(studentizedResiduals),\n  col=\"red\")\nxfit &lt;- seq(\n  min(studentizedResiduals, na.rm = TRUE),\n  max(studentizedResiduals, na.rm = TRUE),\n  length = 40)\nlines(\n  xfit,\n  dnorm(xfit),\n  col=\"gray\") #compare to normal distribution\n\n\n\n\n\n\n\n\n19.2.2 Residual Plots\nResidual plots are plots of the residuals versus observed/fitted values.\nIncludes plots of a) model residuals versus observed values on predictors and b) model residuals versus model fitted values.\nNote: have to remove na.action = na.exclude\nTests include:\n\nlack-of-fit test for every numeric predictor, t-test for the regressor, added to the model, indicating no lack-of-fit for this type\nTukey’s test for nonadditivity: adding the squares of the fitted values to the model and refitting (evaluates adequacy of model fit)\n\n\nCoderesidualPlots(\n  multipleRegressionModelNoMissing,\n  id = TRUE)\n\n\n\n\n\n\n\n                        Test stat Pr(&gt;|Test stat|)  \nbpi_antisocialT1Sum       -2.0755          0.03803 *\nbpi_anxiousDepressedSum   -1.2769          0.20175  \nTukey test                -2.3351          0.01954 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n19.2.3 Marginal Model Plots\nMarginal model plots are plots of the outcome versus predictors/fitted values.\nIncludes plots of a) observed outcome values versus values on predictors (ignoring the other predictors) and b) observed outcome values versus model fitted values.\n\nCodemarginalModelPlots(\n  multipleRegressionModel,\n  sd = TRUE,\n  id = TRUE)\n\n\n\n\n\n\n\n\n19.2.4 Added-Variable Plots\nAdded-variable plots are plots of the partial association between the outcome and each predictor, controlling for all other predictors.\nUseful for identifying jointly influential observations and studying the impact of observations on the regression coefficients.\ny-axis: residuals from model with all predictors excluding the predictor of interest\nx-axis: residuals from model regressing predictor of interest on all other predictors\n\nCodeavPlots(\n  multipleRegressionModel,\n  id = TRUE)\n\n\n\n\n\n\n\n\n19.2.4.1 Refit model removing jointly influential observations\n\nCodemultipleRegressionModel_removeJointlyInfluentialObs &lt;- lm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude,\n  subset = -c(6318,6023,4022,4040))\n\navPlots(\n  multipleRegressionModel_removeJointlyInfluentialObs,\n  id = TRUE)\n\n\n\n\n\n\nCodecompareCoefs(\n  multipleRegressionModel,\n  multipleRegressionModel_removeJointlyInfluentialObs)\n\nCalls:\n1: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + \n  bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)\n2: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + \n  bpi_anxiousDepressedSum, data = mydata, subset = -c(6318, 6023, 4022, 4040),\n   na.action = na.exclude)\n\n                        Model 1 Model 2\n(Intercept)              1.1983  1.1949\nSE                       0.0598  0.0599\n                                       \nbpi_antisocialT1Sum      0.4655  0.4649\nSE                       0.0186  0.0188\n                                       \nbpi_anxiousDepressedSum  0.1608  0.1665\nSE                       0.0292  0.0295\n                                       \n\n\n\n19.2.5 Outlier test\nLocates the largest Studentized residuals in absolute value and computes the Bonferroni-corrected p-values based on a t-test for linear models.\nTest of outlyingness, i.e., how likely one would have a residual of a given magnitude in a normal distribution with the same sample size\nNote: it does not test how extreme an observation is relative to its distribution (i.e., leverage)\n\nCodeoutlierTest(multipleRegressionModel)\n\n     rstudent unadjusted p-value Bonferroni p\n8955 6.519574         8.2999e-11   2.3854e-07\n8956 6.519574         8.2999e-11   2.3854e-07\n8957 6.182195         7.2185e-10   2.0746e-06\n2560 4.914941         9.3800e-07   2.6958e-03\n1385 4.573975         4.9884e-06   1.4337e-02\n\n\n\n19.2.6 Observations with high leverage\nIdentifies observations with high leverage (i.e., high hat values)\nhat values are an index of leverage (observations that are far from the center of the regressor space and have greater influence on OLS regression coefficients)\n\nCodehist(hatvalues(multipleRegressionModel))\n\n\n\n\n\n\nCodeplot(hatvalues(multipleRegressionModel))\n\n\n\n\n\n\nCodeinfluenceIndexPlot(\n  multipleRegressionModel,\n  id = TRUE)\n\n\n\n\n\n\nCodeinfluencePlot(\n  multipleRegressionModel,\n  id = TRUE) # circle size is proportional to Cook's Distance\n\n\n\n\n\n\n\n\n  \n\n\nCodeleveragePlots(\n  multipleRegressionModel,\n  id = TRUE)\n\n\n\n\n\n\n\n\n19.2.7 Observations with high influence (on OLS regression coefficients)\nhttps://cran.r-project.org/web/packages/olsrr/vignettes/influence_measures.html (archived at https://perma.cc/T2TS-PZZ4)\n\nCodehead(influence.measures(multipleRegressionModel)$infmat)\n\n        dfb.1_     dfb.b_T1     dfb.b_DS       dffit     cov.r       cook.d\n1  0.000000000  0.000000000  0.000000000          NA 1.0000000           NA\n2  0.000000000  0.000000000  0.000000000          NA 1.0000000           NA\n3 -0.006546394  0.008357248 -0.006308529 -0.01004886 1.0024362 0.0000336708\n4  0.042862749 -0.025185789 -0.007782877  0.04286275 0.9998621 0.0006121902\n5  0.000000000  0.000000000  0.000000000          NA 1.0000000           NA\n6 -0.018327367  0.010769006  0.003327823 -0.01832737 1.0015775 0.0001119888\n           hat\n1 0.0000000000\n2 0.0000000000\n3 0.0014593072\n4 0.0009143185\n5 0.0000000000\n6 0.0009143185\n\n\n\n19.2.8 DFBETA\n\nCodehead(dfbeta(multipleRegressionModel))\n\n    (Intercept) bpi_antisocialT1Sum bpi_anxiousDepressedSum\n1  0.0000000000        0.0000000000            0.000000e+00\n2  0.0000000000        0.0000000000            0.000000e+00\n3 -0.0003917284        0.0001553400           -1.839704e-04\n4  0.0025639901       -0.0004679817           -2.268890e-04\n5  0.0000000000        0.0000000000            0.000000e+00\n6 -0.0010966309        0.0002001580            9.704151e-05\n\nCodehist(dfbeta(multipleRegressionModel))\n\n\n\n\n\n\nCodedfbetasPlots(\n  multipleRegressionModel,\n  id = TRUE)\n\nError in `dfbetasPlots.lm()`:\n! argument 2 matches multiple formal arguments\n\n\n\n19.2.9 DFFITS\n\nCodehead(dffits(multipleRegressionModel)[order(dffits(multipleRegressionModel), decreasing = TRUE)])\n\n     8472      4468      1917      8955      8956      1986 \n0.2664075 0.2428065 0.2237760 0.1972271 0.1972271 0.1923034 \n\nCodehist(dffits(multipleRegressionModel))\n\n\n\n\n\n\nCodeplot(dffits(multipleRegressionModel))\n\n\n\n\n\n\nCodeplot(dffits(multipleRegressionModel)[order(dffits(multipleRegressionModel), decreasing = TRUE)])\n\n\n\n\n\n\n\n\n19.2.10 Cook’s Distance\nObservations that are both outlying (have a high residual from the regression line) and have high leverage (are far from the center of the regressor space) have high influence on the OLS regression coefficients. An observation will have less influence if it lies on the regression line (not an outlier, i.e., has a low residual) or if it has low leverage (i.e., has a value near the center of a predictor’s distribution).\n\nCodehead(cooks.distance(multipleRegressionModel)[order(cooks.distance(multipleRegressionModel), decreasing = TRUE)])\n\n      2765       1371       2767       8472       6170       6023 \n0.05488391 0.03624388 0.03624388 0.02358305 0.02323282 0.02315496 \n\nCodehist(cooks.distance(multipleRegressionModel))\n\n\n\n\n\n\nCodeplot(cooks.distance(multipleRegressionModel))\n\n\n\n\n\n\nCodeplot(cooks.distance(multipleRegressionModel)[order(cooks.distance(multipleRegressionModel), decreasing = TRUE)])\n\n\n\n\n\n\n\n\n19.2.10.1 Refit model removing values with high cook’s distance\n\nCodemultipleRegressionModel_2 &lt;- lm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude,\n  subset = -c(2765,1371))\n\nmultipleRegressionModel_3 &lt;- lm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude,\n  subset = -c(2765,1371,2767))\n\nmultipleRegressionModel_4 &lt;- lm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude,\n  subset = -c(2765,1371,2767,8472))\n\nmultipleRegressionModel_5 &lt;- lm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude,\n  subset = -c(2765,1371,2767,8472,6170))\n\nmultipleRegressionModel_6 &lt;- lm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude,\n  subset = -c(2765,1371,2767,8472,6170,6023))\n\nmultipleRegressionModel_7 &lt;- lm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = na.exclude,\n  subset = -c(2765,1371,2767,8472,6170,6023,2766))\n\n\n\n19.2.10.1.1 Examine how much regression coefficients change when excluding influential observations\n\nCodecompareCoefs(\n  multipleRegressionModel,\n  multipleRegressionModel_2,\n  multipleRegressionModel_3,\n  multipleRegressionModel_4,\n  multipleRegressionModel_5,\n  multipleRegressionModel_6,\n  multipleRegressionModel_7)\n\nCalls:\n1: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + \n  bpi_anxiousDepressedSum, data = mydata, na.action = na.exclude)\n2: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + \n  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371), na.action =\n   na.exclude)\n3: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + \n  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767), \n  na.action = na.exclude)\n4: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + \n  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767, 8472),\n   na.action = na.exclude)\n5: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + \n  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767, 8472, \n  6170), na.action = na.exclude)\n6: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + \n  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767, 8472, \n  6170, 6023), na.action = na.exclude)\n7: lm(formula = bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + \n  bpi_anxiousDepressedSum, data = mydata, subset = -c(2765, 1371, 2767, 8472, \n  6170, 6023, 2766), na.action = na.exclude)\n\n                        Model 1 Model 2 Model 3 Model 4 Model 5 Model 6 Model 7\n(Intercept)              1.1983  1.1704  1.1577  1.1676  1.1620  1.1537  1.1439\nSE                       0.0598  0.0597  0.0596  0.0596  0.0596  0.0595  0.0595\n                                                                               \nbpi_antisocialT1Sum      0.4655  0.4739  0.4779  0.4748  0.4744  0.4793  0.4836\nSE                       0.0186  0.0185  0.0185  0.0185  0.0185  0.0185  0.0185\n                                                                               \nbpi_anxiousDepressedSum  0.1608  0.1691  0.1726  0.1699  0.1770  0.1742  0.1743\nSE                       0.0292  0.0290  0.0290  0.0289  0.0290  0.0290  0.0289\n                                                                               \n\n\n\n19.2.10.2 Examine how much regression coefficients change when using least trimmed squares (LTS) that is resistant to outliers\n\nCodecoef(lm(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action=\"na.exclude\"))\n\n            (Intercept)     bpi_antisocialT1Sum bpi_anxiousDepressedSum \n              1.1983004               0.4655286               0.1607541 \n\nCodecoef(ltsReg(\n  bpi_antisocialT2Sum ~ bpi_antisocialT1Sum + bpi_anxiousDepressedSum,\n  data = mydata,\n  na.action = \"na.exclude\"))\n\n              Intercept     bpi_antisocialT1Sum bpi_anxiousDepressedSum \n              0.7439567               0.5432644               0.1524929 \n\n\n\n19.2.11 Resources\nBook: An R Companion to Applied Regression\nhttps://people.duke.edu/~rnau/testing.htm (archived at https://perma.cc/9CXH-GBSN)\nhttps://www.statmethods.net/stats/rdiagnostics.html (archived at https://perma.cc/7JX8-K6BY)\nhttps://socserv.socsci.mcmaster.ca/jfox/Courses/Brazil-2009/index.html (archived at https://perma.cc/4A2P-9S49)\nhttps://en.wikipedia.org/wiki/Ordinary_least_squares#Assumptions (archived at https://perma.cc/Q4NS-X8TJ)",
    "crumbs": [
      "About",
      "Regression"
    ]
  },
  {
    "objectID": "R.html",
    "href": "R.html",
    "title": "R",
    "section": "",
    "text": "“R will always be arcane to those who do not make a serious effort to learn it. It is not meant to be intuitive and easy for casual users to just plunge into. It is far too complex and powerful for that. But the rewards are great for serious data analysts who put in the effort.”\n— Berton Gunter R-help August 2007 (archived at https://perma.cc/KY9N-2FTT)\n— Evelyn Hall and Simon ‘Yoda’ Blomberg, R-help April 2005 (archived at https://perma.cc/KY9N-2FTT)",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#base-r",
    "href": "R.html#base-r",
    "title": "R",
    "section": "\n1.1 Base R",
    "text": "1.1 Base R\nHere are a slew of resources for learning base R (in addition to the documents in the lab’s Primer Articles folder):\n\n\nR for Data Science book: https://r4ds.hadley.nz\n\nTutorials from the book are available via the r4ds.tutorials package: https://ppbds.github.io/r4ds.tutorials/\n\n\n\nUse this Intro to R: https://www.statmethods.net (archived at https://perma.cc/SPQ2-DJKM)\n\nI used this resource considerably when I was learning R\n\n\n\n\nCodeacademy has free online courses:\n\nBasics of using R: https://www.codecademy.com/learn/learn-r (archived at https://perma.cc/JHS2-EYUU)\n\n\nLearn how to become a better coder: https://www.r-bloggers.com/10-top-tips-for-becoming-a-better-coder/ (archived at https://perma.cc/H3W7-QDAM)\nHow to become fluent in R: https://www.sharpsightlabs.com/blog/are-you-fluent-r/ (archived at https://perma.cc/RWL5-GTWV)\nVideo training courses in R skills: https://www.pluralsight.com/search?q=R (archived at https://perma.cc/U4ZZ-UE4X)\nBrowse the Cookbook for R to find solutions to common tasks and problems: http://www.cookbook-r.com (archived at https://perma.cc/5ERJ-VRFR)\nBrowse the R Graph Gallery to find examples of various graphs: https://r-graph-gallery.com\n\nFree Coursera courses on R: https://pairach.com/2012/12/22/learn-to-use-r-for-free-with-coursera/ (archived at https://perma.cc/XJ5U-5E4W)\nMOOCs and courses to learn R: https://www.r-bloggers.com/moocs-and-courses-to-learn-r/ (archived at https://perma.cc/MQ25-E3ME)\nWatch these videos from Coursera: https://blog.revolutionanalytics.com/2012/12/coursera-videos.html (archived at https://perma.cc/6FU4-PAQW)\n\nRStudio Webinars: https://www.rstudio.com/resources/webinars/ (archived at https://perma.cc/6RNR-98JB)\nUCLA Stats Website: https://stats.idre.ucla.edu/r/ (archived at https://perma.cc/M3N6-96RY)\nTake this Introduction to R course: https://www.datacamp.com/courses/free-introduction-to-r (archived at https://perma.cc/6ZM9-37L9)\nTeaching R in a Kinder, Gentler, More Effective Manner: https://github.com/matloff/TidyverseSkeptic (archived at https://perma.cc/QU9F-FBS8)\nLearn R interactively with swirl: https://swirlstats.com (archived at https://perma.cc/TT9V-U663)\nUse the learnr package: https://blog.rstudio.com/2017/07/11/introducing-learnr/ (archived at https://perma.cc/XGJ8-EXSN)\nYou will sometimes find relevant articles on R-bloggers: https://www.r-bloggers.com (archived at https://perma.cc/EL3X-ZXBB)",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#statistics-using-r",
    "href": "R.html#statistics-using-r",
    "title": "R",
    "section": "\n1.2 Statistics (using R)",
    "text": "1.2 Statistics (using R)\nThe following are resources for learning statistics using R.\n\n\nR for Data Science: https://r4ds.hadley.nz\n\nUCLA Stats Website: https://stats.oarc.ucla.edu/other/dae/ (archived at https://perma.cc/FVG5-5X82)\n\nCodeacademy has free online courses:\n\nDescriptive analysis and basic hypothesis testing: https://www.codecademy.com/learn/learn-statistics-with-r\n\n\n\nFree textbook on Learning Statistics with R: https://learningstatisticswithr.com (archived at https://perma.cc/SY87-5GCX)\nAn excellent introductory textbook on Discovering Statistics using R: https://www.amazon.com/Discovering-Statistics-Using-Andy-Field/dp/1446200469 (archived at https://perma.cc/9LGU-7ZME)\nMy textbook that teaches R/statistics through the lens of fantasy football: https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#tidyverse",
    "href": "R.html#tidyverse",
    "title": "R",
    "section": "\n1.3 tidyverse\n",
    "text": "1.3 tidyverse\n\nThe following are resources for learning tidyverse, which is a collection of R packages for data management:\n\nhttps://www.tidyverse.org/learn/ (archived at https://perma.cc/5ZUM-XGES)\nhttps://www.linkedin.com/learning/learning-the-r-tidyverse/welcome?u=42459020 (archived at https://perma.cc/TD56-FX8R)",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#sec-questions",
    "href": "R.html#sec-questions",
    "title": "R",
    "section": "\n1.4 Getting Help/Questions",
    "text": "1.4 Getting Help/Questions\nIf you have R questions, you can ask them in a number of places:\n\nForums:\n\n\nPosit: https://forum.posit.co\n\n\nStackOverflow: https://stackoverflow.com/questions/tagged/r\n\n\nReddit: https://www.reddit.com/r/rstats/\n\n\n\nThe R mailing list: https://stat.ethz.ch/mailman/listinfo/r-help\n\n\nThe following article provides additional resources and good guidance: https://www.r-bloggers.com/where-to-get-help-with-your-r-question/ (archived at https://perma.cc/4RRE-KL33).\nWhen posting a question on forums or mailing lists, keep a few things in mind:\n\nRead the posting guidelines before posting!\nBe respectful of other people and their time. R is free software. People are offering their free time to help. They are under no obligation to help you. If you are disrespectful or act like they owe you anything, you will rub people the wrong way and will be less likely to get help.\nProvide a minimal, reproducible example. Providing a minimal, reproducible example can be crucial for getting a helpful response. By going to the trouble of creating a minimal, reproducible example and identifying the minimum conditions necessary to reproduce the issue, you will often figure out how to resolve it. Here are guidelines on providing a minimal, reproducible example: https://stackoverflow.com/help/minimal-reproducible-example (archived at https://perma.cc/6NUB-UTYF). Here are a good example and guidelines for providing a minimal, reproducible example in R: https://stackoverflow.com/a/5963610 (archived at https://perma.cc/PC9L-DQZG). Provide a reprex whenever possible: https://reprex.tidyverse.org.",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#create-rstudio-project",
    "href": "R.html#create-rstudio-project",
    "title": "R",
    "section": "\n7.1 Create Rstudio Project\n",
    "text": "7.1 Create Rstudio Project\n\nFor each data analysis project (i.e., each GitLab/GitHub repo), create an RStudio Project. This helps keep your project files organized.",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#use-r-notebooks-for-computational-notebooks",
    "href": "R.html#use-r-notebooks-for-computational-notebooks",
    "title": "R",
    "section": "\n7.2 Use R Notebooks for “Computational Notebooks”",
    "text": "7.2 Use R Notebooks for “Computational Notebooks”\nUsing R Notebooks for “Computational Notebooks” is helpful for reproducible code that can be shared with others. To create computational notebooks see the Markdown section on computational notebooks in the Data Analysis guides.",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#separate-sections-in-code",
    "href": "R.html#separate-sections-in-code",
    "title": "R",
    "section": "\n7.3 Separate sections in code",
    "text": "7.3 Separate sections in code\n\nIn R scripts, use sections.\n\nTo insert a section in RStudio, use CTRL-Shift-R or “Code” - “Insert Section”\n\n\nIn R Notebooks/Markdown, use Headers and code chunks.\n\nHeaders: 1, 2, or 3 pound signs\nCode Chunks: Ctrl+Alt+I; or click “Insert” button then “R”",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#naming-variables",
    "href": "R.html#naming-variables",
    "title": "R",
    "section": "\n7.4 Naming variables",
    "text": "7.4 Naming variables\n\nUse meaningful variable names; we want to know what a variable represents without having to consult an external codebook for every variable\nVariable names should include the prefix for the measure followed by an underscore\n\ne.g., cbcl_ for the Child Behavior Checklist variables\n\n\nUse lower camel case for variable naming\n\ne.g., prefix_thisIsTheVariableName\n\n\n\nDo not include spaces in variable names",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#comment-code-frequently-and-clearly",
    "href": "R.html#comment-code-frequently-and-clearly",
    "title": "R",
    "section": "\n7.5 Comment code frequently and clearly!",
    "text": "7.5 Comment code frequently and clearly!\nIt is important to comment code frequently and clearly. You want you (and others) to easily be able to understand your code if you come back to it several years later!",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#sec-dontSaveWorkspace",
    "href": "R.html#sec-dontSaveWorkspace",
    "title": "R",
    "section": "\n7.6 Don’t save your workspace image",
    "text": "7.6 Don’t save your workspace image\nFor reproducibility purposes, it is important not to save your workspace image (archived at https://perma.cc/9SCZ-L4DE). It is best practices to begin R each session with a clean workspace. If there is a .Rdata file in the same folder as the Rstudio Project, Rstudio will automatically load the objects into the workspace at the beginning of the session. This is problematic because those objects can interact/interfere with the code and can lead to problems with replicability for others who are running the code without those objects in the workspace. When you exit RStudio, RStudio asks if you want to “Save workspace image to [filepath]/.Rdata?” Make sure to select “Don’t Save”! However, do make sure to save your R scripts before exiting Rstudio.",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#troubleshooting",
    "href": "R.html#troubleshooting",
    "title": "R",
    "section": "\n13.1 Troubleshooting",
    "text": "13.1 Troubleshooting\n\n13.1.1 Pandoc error\nThis error may appear if you are attempting to render a markdown file\npandoc version 1.12.3 or higher is required and was not found.\nThe solution to this problem can be found at this link (archived at https://perma.cc/YX57-BPRS)",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#slacking-specific-users",
    "href": "R.html#slacking-specific-users",
    "title": "R",
    "section": "\n17.1 Slacking Specific Users",
    "text": "17.1 Slacking Specific Users\nIt is also possible to slack specific users with instructions found at this link (archived at https://perma.cc/59U5-V4GQ).",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#working-with-renv-for-package-management",
    "href": "R.html#working-with-renv-for-package-management",
    "title": "R",
    "section": "\n20.1 Working with renv for Package Management",
    "text": "20.1 Working with renv for Package Management\nrenv is used for reproducibility, by helping with package management (tracking package versions, etc.):\nhttps://rstudio.github.io/renv/articles/renv.html\nBefore updating a package locally, make sure that it is available in the Posit Package Manager (so it can be available to GitHub Actions):\nhttps://packagemanager.posit.co\n\n20.1.1 Updating the Package\n\nTo update the package, run the following in R:\n\n\nCode# 1. Update packages in package environment\nrenv::upgrade()\nrenv::update()\nrenv::snapshot()\n\n# 2. Add/edit code\n\n# 3. Update documentation\nroxygen2::roxygenise()\n\n# 4. Update package version (or can do this manually)\nusethis::use_version()\n\n\n\nThen, build the package: Ctrl-Shift-B\nThen, check the package: Ctrl-Shift-E\nThen, run R CMD check\nThen, install the package:\n\n\nCoderenv::install(\"C:/R/Packages/petersenlab\") #PC\nrenv::install(\"/Library/Frameworks/R.framework/Packages/petersenlab\") #Mac\n\n\n\n20.1.2 Installing Packages\nTo install new packages in the package environment, run the following in R:\n\nCoderenv::install(\"NAME_OF_PACKAGE\")\n\n\nor:\n\nCodeinstall.packages(\"NAME_OF_PACKAGE\")",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#sec-rCmdCheck",
    "href": "R.html#sec-rCmdCheck",
    "title": "R",
    "section": "\n20.2 R CMD check\n",
    "text": "20.2 R CMD check\n\n\nBuild the source package (.tar.gz file)\n\nClick on the “Build” tab in the top-right pane of RStudio, and then click “Build Source Package”, or run the following code in the R console:\n\n\n\n\nCodedevtools::build(pkg = \"D:/Documents/GitHub/petersenlab\")\n\n\n\n\nOpen terminal in RStudio\n\nAfter the package source (.tar.gz file) is built, open a terminal window directly in RStudio by clicking on the “Terminal” tab at the bottom of RStudio\n\n\n\nRun R CMD check --as-cran\n\nIn the terminal window, navigate to the directory where your package source (.tar.gz file) is located (commonly up one directory):\n\ncd ..\nThen, run R CMD check --as-cran followed by the name of your package tarball (making sure to update the package version in the filename). For example:\nR CMD check --as-cran petersenlab_1.0.0.tar.gz\n\n\n\n20.2.1 Troubleshooting\n\n20.2.1.1 If errors compiling the PDF manual\n\n\nIn the terminal:\ncd ./petersenlab\nR CMD Rd2pdf . --output=man/figures/manual.pdf --force --no-preview --no-clean\n\nThen, delete the created folder whose name begins with “.Rd2pdf…”\nIn the R Console, build the source package in R (or using the instructions described above):\n\n\nCodedevtools::build(pkg = \"D:/Documents/GitHub/petersenlab\")\n\n\n\n\nIn the terminal (making sure to update the package version in the filename):\ncd ..\nR CMD check --as-cran petersenlab_1.0.0.tar.gz\n\n\n20.2.1.2 no visible binding for global variable; Undefined global functions or variables\n\nFor example:\nno visible binding for global variable\n    'moderatorVal_centered'\n  Undefined global functions or variables:\n    moderatorVal_centered predictorVal_centered\nSolution: set each variable to NULL in the package function before it is mentioned. For example:\npredictorVal_centered &lt;- moderatorVal_centered &lt;- NULL",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#r-cmd-check-via-github-actions",
    "href": "R.html#r-cmd-check-via-github-actions",
    "title": "R",
    "section": "\n20.3 R CMD check via GitHub Actions",
    "text": "20.3 R CMD check via GitHub Actions\n\nCodeusethis::use_github_action(\"check-standard\")",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#useful-keyboard-shortcuts-for-package-authoring",
    "href": "R.html#useful-keyboard-shortcuts-for-package-authoring",
    "title": "R",
    "section": "\n20.4 Useful keyboard shortcuts for package authoring:",
    "text": "20.4 Useful keyboard shortcuts for package authoring:\nInstall Package: ‘Ctrl + Shift + B’\nCheck Package: ‘Ctrl + Shift + E’\nTest Package: ‘Ctrl + Shift + T’\n\nCoderenv::install(\"C:/R/Packages/petersenlab\")\nrenv::snapshot()\nrenv::install()",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#pkgdown",
    "href": "R.html#pkgdown",
    "title": "R",
    "section": "\n20.5 pkgdown\n",
    "text": "20.5 pkgdown\n\nRun once to configure your package to use pkgdown:\n\nCodeusethis::use_pkgdown()\n\n\nThen use pkgdown to build your website:\n\nCodepkgdown::build_site()",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#steps-to-add-functions",
    "href": "R.html#steps-to-add-functions",
    "title": "R",
    "section": "\n20.6 Steps to Add Functions",
    "text": "20.6 Steps to Add Functions\n\nAdd .R file with the function\nAdd the function to the _pkgdown.yml file\nUpdate version number\nrenv::upgrade()\nrenv::update()\nrenv::snapshot()\nroxygen2::roxygenise()\nInstall Package: ‘Ctrl + Shift + B’\nCheck Package: ‘Ctrl + Shift + E’\nR CMD check\nCommit and push changes\nUpdate release version in GitHub",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#add-sub-packages",
    "href": "R.html#add-sub-packages",
    "title": "R",
    "section": "\n20.7 Add sub-packages",
    "text": "20.7 Add sub-packages\n\nCodedevtools::build(pkg = \"D:/Documents/GitHub/petersenlab/inst/extdata/testpackage1\")\ndevtools::build(pkg = \"D:/Documents/GitHub/petersenlab/inst/extdata/testpackage2\")\n\ninstall.packages(\"D:/Documents/GitHub/petersenlab/inst/extdata/testpackage1_0.1.0.tar.gz\", repos = NULL, source = TRUE)\ninstall.packages(\"D:/Documents/GitHub/petersenlab/inst/extdata/testpackage2_0.1.0.tar.gz\", repos = NULL, source = TRUE)\n\nremotes::install_local(\"D:/Documents/GitHub/petersenlab/inst/extdata/testpackage2_0.1.0.tar.gz\")\nremotes::install_local(\"D:/Documents/GitHub/petersenlab/inst/extdata/testpackage2_0.1.0.tar.gz\")",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#submit-package-to-cran",
    "href": "R.html#submit-package-to-cran",
    "title": "R",
    "section": "\n20.8 Submit Package to CRAN",
    "text": "20.8 Submit Package to CRAN\nhttps://cran.r-project.org/submit.html",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#resources",
    "href": "R.html#resources",
    "title": "R",
    "section": "\n20.9 Resources",
    "text": "20.9 Resources\nOfficial documentation for CRAN:\n\nhttps://cran.r-project.org/doc/manuals/R-exts.html\n\nUnofficial documentation:\n\nhttps://rpubs.com/YaRrr/rpackageintro\nhttps://r-pkgs.org\nhttps://cran.r-project.org/doc/contrib/Leisch-CreatingPackages.pdf\nhttps://portal.stats.ox.ac.uk/userdata/ruth/APTS2012/Rcourse10.pdf\nhttps://web.mit.edu/insong/www/pdf/rpackage_instructions.pdf\nhttps://hilaryparker.com/2014/04/29/writing-an-r-package-from-scratch/\n\n\n20.9.1 For Package Development Tasks\n\nhttps://usethis.r-lib.org/index.html\n\n20.9.2 For Documentation\n\nhttps://github.com/r-lib/roxygen2#roxygen2\nhttps://hilaryparker.com/2014/04/29/writing-an-r-package-from-scratch/\n\n20.9.3 Creating Vignettes\n\nhttps://bookdown.org/yihui/rmarkdown-cookbook/package-vignette.html\n\n20.9.4 For Licensing\n\nhttps://usethis.r-lib.org/reference/licenses.html",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#general-troubleshooting-tips",
    "href": "R.html#general-troubleshooting-tips",
    "title": "R",
    "section": "\n21.1 General Troubleshooting Tips",
    "text": "21.1 General Troubleshooting Tips\n\n\nRun code line-by-line to identify the source of the error\n\nIf you are using RStudio, a red line will often appear on the lefthand side of the screen to indicate the particular line(s) of code that result in an error\nIt may be useful to clear your working environment in R before trying to diagnose an error to be sure that you are not experiencing any interference from existing objects in the environment\nRunning code line-by-line is particularly useful because it allows you to inspect the data at each step of its processing\n\nData issues are commonly the culprit of code errors (see below)\n\n\n\n\n\nCheck for typos\n\nAre all brackets/parentheses/etc. closed?\nDoes the object/variable that you are referring to exist? (If the object does not exisit, you will likely get an error message indicating [object name] not found)\n\nHas it been defined somewhere prior in the code?\nDoes it depend on something else to be created?\nIs its name spelled correctly?\nHighlighting the object or variable in question and using CTRL-F to search for it is a good way to check these things\n\n\nDid you spell the function you want to use correctly?\nDo you have commas separating items within a list/function/etc.?\n\n\n\nDoes your working environment have what it needs?\n\nAre all necessary packages/libraries installed? Do any require an update?\nAre all expected objects (dataframes, lists, environment variables, etc) present? Are they correct?\n\n\n\nInvestigate the structure of your data\n\nErrors such as non-numeric argument to binary operator indicate that the function you are trying to use is expecting to recieve numeric data as an input but one or more of the inputs are not numeric\n\nThe function class(data$variable) (replace “data” and “variable” with whatever you are trying to invesitgate) is useful for determining how R is interpreting your data. Often, data that look like numbers can end up being stored as a character (text) variable. This can be due to import/export processes or due to an issue with data entry.\n\nFor example, when 00 is entered instead of 0 in a numeric field R is likely to interpret the variable as a character instead of a number when importing the data\n\n\n\n\nCheck to make sure that all expected rows/columns are present and that they look the way you expect them to\n\nIf your dataset has been created by joining/merging multiple dataframes, any duplicate columns not accounted for when joining may have a suffix appended to distinguish them (i.e., variable.x or variable.y)\nTo resolve this, either call the appended variable in subsequent manipulations (variable.x instead of variable) or deal with the duplicated columns before/during the joining process (e.g., include duplicate columns in the by argument of joining function or remove the redundant column from one of the datasets to be joined)\n\n\nIf you have been creating/computing variables in your dataset, ensure that they are being computed as expected\n\nCheck for NA (missing) or NaN (not a number) values. Such values may not be an issue or error in all cases, but if you are not expecting that as a result of your computations, this might suggest an issue with the code and/or data structure\nCheck whether the computed values are reasonable",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#a-single-error-preventing-a-wiki-site-from-rendering",
    "href": "R.html#a-single-error-preventing-a-wiki-site-from-rendering",
    "title": "R",
    "section": "\n21.2 A single error preventing a Wiki site from rendering",
    "text": "21.2 A single error preventing a Wiki site from rendering\nCode can be wrapped in try() statements so that if an error occurs, the script will simply “skip” to the next line of code. These try() statements are particularly useful when rendering a site; if they are not used, a single error will halt the entire process. try() statements allow the code to continue running in spite of a line or two erroring out.\nIf you have already incorporated try() statements and are still experiencing fatal errors in code, check to make sure that the smallest possible “unit” of code is wrapped in try() statements, rather than large sections of code. See here for more information.",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "R.html#warning-packagename-package-in-filepath-library-will-not-be-updated",
    "href": "R.html#warning-packagename-package-in-filepath-library-will-not-be-updated",
    "title": "R",
    "section": "\n21.3 Warning: PACKAGENAME package in FILEPATH library will not be updated",
    "text": "21.3 Warning: PACKAGENAME package in FILEPATH library will not be updated\nThis warning might indicate that it cannot update the package because it is part of the base R installation. To fix this:\n\nfind and delete the package that is part of the base R installation in the library directory of the R installation (e.g., C:\\R\\R-4.3.1\\library\\PACKAGENAME\\)\nmake sure the package is also not in any other package installation locations (e.g., C:\\R\\Packages\\PACKAGENAME\\); if it is, delete it from there as well\nthen, after deleting the package from these locations, restart R and run install.packages(\"PACKAGENAME\") to reinstall the package\nclose R\n\nif the package was part of the base R installation, move the installed package folder C:\\R\\Packages\\PACKAGENAME\\ to the library directory of the R installation (e.g., C:\\R\\R-4.3.1\\library\\PACKAGENAME\\)",
    "crumbs": [
      "About",
      "R"
    ]
  },
  {
    "objectID": "osf.html",
    "href": "osf.html",
    "title": "Open Science Framework",
    "section": "",
    "text": "Code#install.packages(\"remotes\")\n#remotes::install_github(\"DevPsyLab/petersenlab\")\n#remotes::install_github(\"paulhendricks/anonymizer\")\n\n\n\n\nCodelibrary(\"anonymizer\")\nlibrary(\"tidyverse\")\n\n\n\n\nCodeset.seed(52242)\n\nsampleSize &lt;- 100\n\nID &lt;- 1:sampleSize\nX &lt;- rnorm(sampleSize)\nY &lt;- rnorm(sampleSize)\n\nmydata &lt;- data.frame(\n  ID = ID,\n  X = X,\n  Y = Y)",
    "crumbs": [
      "About",
      "Open Science Framework"
    ]
  },
  {
    "objectID": "osf.html#install-libraries",
    "href": "osf.html#install-libraries",
    "title": "Open Science Framework",
    "section": "",
    "text": "Code#install.packages(\"remotes\")\n#remotes::install_github(\"DevPsyLab/petersenlab\")\n#remotes::install_github(\"paulhendricks/anonymizer\")",
    "crumbs": [
      "About",
      "Open Science Framework"
    ]
  },
  {
    "objectID": "osf.html#load-libraries",
    "href": "osf.html#load-libraries",
    "title": "Open Science Framework",
    "section": "",
    "text": "Codelibrary(\"anonymizer\")\nlibrary(\"tidyverse\")",
    "crumbs": [
      "About",
      "Open Science Framework"
    ]
  },
  {
    "objectID": "osf.html#simulate-data",
    "href": "osf.html#simulate-data",
    "title": "Open Science Framework",
    "section": "",
    "text": "Codeset.seed(52242)\n\nsampleSize &lt;- 100\n\nID &lt;- 1:sampleSize\nX &lt;- rnorm(sampleSize)\nY &lt;- rnorm(sampleSize)\n\nmydata &lt;- data.frame(\n  ID = ID,\n  X = X,\n  Y = Y)",
    "crumbs": [
      "About",
      "Open Science Framework"
    ]
  },
  {
    "objectID": "jamovi.html",
    "href": "jamovi.html",
    "title": "jamovi",
    "section": "",
    "text": "1 Overview of jamovi\njamovi is similar to SPSS in that it has a graphical user interface that allows point-and-click for analysis. Unlike SPSS, however, jamovi is free. jamovi can also provide the R code that used to perform the analysis.\n\n\n2 Best Practices\n\nCreate a syntax file for performing all commands, including importing data, computing variables, recoding variables, running analyses, etc. The benefit of using syntax files (and code-based files, more generally) is that they allow you to reproduce your findings again with the same data file. This is important so you do not have to remember all of the steps you followed to generate the analysis. This also allows you to quickly re-run the analysis if the data file is updated due to the collection of more data. To generate the syntax for a particular step, change to “syntax mode” to see the R syntax that is used to perform the analysis step. If you are unsure what jamovi command is needed, run the command via “point and click” in the interface; however, instead of clicking “OK”, click “Paste”.\n\nHave one syntax file for importing data, computing composites, recoding variables, and saving data (e.g., import.R).\nHave a separate syntax file for generating frequencies, descriptive statistics, and correlation matrices (e.g., descriptives.R).\nHave a separate syntax file for running analyses (e.g., analyses.R).\nComment your syntax frequently\n\nto comment use the following convention:\n\n#type comment\n\n\nSave your syntax frequently\n\n\n\n\n3 Install modules for jamovi\nTo install modules for jamovi, see here: https://dev.jamovi.org/tuts0101-getting-started.html (archived at https://perma.cc/E3NY-8MGH)\n\n\n4 Structural Equation Modeling in jamovi\nSEMLj module for jamovi:\n\nhttps://github.com/semlj/semlj\nhttps://semlj.github.io\n\n\n\n\n\n\n\nReuseCC BY 4.0",
    "crumbs": [
      "About",
      "jamovi"
    ]
  },
  {
    "objectID": "hpc.html",
    "href": "hpc.html",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "",
    "text": "Analysis scripts for High Performance Computing (HPC) at the University of Iowa. Currently uses Argon.\n\nWorkflow: https://workflow.uiowa.edu/entry/new/3282/11927336\nCluster Systems Documentation: https://uiowa.atlassian.net/wiki/spaces/hpcdocs/pages/76513411/Cluster+Systems+Documentation (archived at https://perma.cc/EKB8-ZKR7)\nArgon Cluster Documentation: https://uiowa.atlassian.net/wiki/spaces/hpcdocs/pages/76513466/Argon+Cluster (archived at https://perma.cc/6HST-VV6Y)\n\nSignificant amounts of data storage are provided on Argon, but data are not backed up in any way unless special arrangements are made. It is the responsibility of the user to back up important information.\n\nUser agrees to refrain from storing Restricted data on HPC resources. Data is classified as Restricted when the unauthorized disclosure, alteration or destruction of that data could cause a significant level of risk to the University or its affiliates. Examples of Restricted data include data protected by state or federal privacy regulations and data pertaining to identified human subjects that has not been deidentified.\n\nAt present there are no fees for the use of the Argon cluster for low-priority usage. For large users, or those who want access to dedicated resources, the option of purchasing or renting supplemental system hardware may be available. If you are interested in dedicated hardware, contact research-computing@uiowa.edu.",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#links-to-documentation",
    "href": "hpc.html#links-to-documentation",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "",
    "text": "Workflow: https://workflow.uiowa.edu/entry/new/3282/11927336\nCluster Systems Documentation: https://uiowa.atlassian.net/wiki/spaces/hpcdocs/pages/76513411/Cluster+Systems+Documentation (archived at https://perma.cc/EKB8-ZKR7)\nArgon Cluster Documentation: https://uiowa.atlassian.net/wiki/spaces/hpcdocs/pages/76513466/Argon+Cluster (archived at https://perma.cc/6HST-VV6Y)",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#data-storage",
    "href": "hpc.html#data-storage",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "",
    "text": "Significant amounts of data storage are provided on Argon, but data are not backed up in any way unless special arrangements are made. It is the responsibility of the user to back up important information.",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#sensitive-data",
    "href": "hpc.html#sensitive-data",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "",
    "text": "User agrees to refrain from storing Restricted data on HPC resources. Data is classified as Restricted when the unauthorized disclosure, alteration or destruction of that data could cause a significant level of risk to the University or its affiliates. Examples of Restricted data include data protected by state or federal privacy regulations and data pertaining to identified human subjects that has not been deidentified.",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#fees",
    "href": "hpc.html#fees",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "",
    "text": "At present there are no fees for the use of the Argon cluster for low-priority usage. For large users, or those who want access to dedicated resources, the option of purchasing or renting supplemental system hardware may be available. If you are interested in dedicated hardware, contact research-computing@uiowa.edu.",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#windows",
    "href": "hpc.html#windows",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n3.1 Windows",
    "text": "3.1 Windows\n\nRight click on This PC and select Map Network Drive\n\nSelect Y and type \\\\data.hpc.uiowa.edu\\argon_home\\Documents",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#ssh",
    "href": "hpc.html#ssh",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n4.1 SSH",
    "text": "4.1 SSH\nargon.hpc.uiowa.edu",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#windows-1",
    "href": "hpc.html#windows-1",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n4.2 Windows",
    "text": "4.2 Windows\nWindows Explorer:\n\\\\data.hpc.uiowa.edu\\argon_home (username: itpetersen@uiowa.edu or hawkid@uiowa.edu)\nUsing SecureCRT for an SSH connection: 1. Download SecureCRT from UIowa Informational Technology Services: https://its.uiowa.edu/securecrt 2. In Hostname type argon.hpc.uiowa.edu and in username type HawkID 3. Click connect",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#mac",
    "href": "hpc.html#mac",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n4.3 Mac",
    "text": "4.3 Mac\nMac OS Terminal:\nssh itpetersen@argon.hpc.uiowa.edu (on campus)\nssh -p 40 itpetersen@argon.hpc.uiowa.edu (off campus without VPN)",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#initial-run",
    "href": "hpc.html#initial-run",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n7.1 Initial run",
    "text": "7.1 Initial run\n\n7.1.1 Installing Linux Packages to Install R Packages\nmodule load stack/2022.2\nmodule load r/4.2.2_gcc-9.5.0\nmodule load geos/3.9.1_gcc-9.5.0\nmodule load gdal/2.4.4_gcc-9.5.0\nmodule load proj/5.2.0_gcc-9.5.0\nmodule load gsl/2.7.1_gcc-9.5.0\nmodule load nlopt/2.7.0_gcc-9.5.0\nmodule load jags/4.3.0_gcc-9.5.0-dev\nmodule load zlib/1.2.13_gcc-9.5.0-dev\nmodule load cmake/3.25.0_gcc-9.5.0\nmodule load glpk/4.65_gcc-9.5.0-dev\nmodule load libxml2/2.10.3_gcc-9.5.0\nmodule load r-nloptr\nmodule load r-zlibbioc/1.44.0_gcc-9.5.0\nmodule load r-data-table/1.14.4_gcc-9.5.0\nmodule load r-stringi/1.7.8_gcc-9.5.0\nmodule load r-selectr/0.4-2_gcc-9.5.0\nmodule load r-generics/0.1.3_gcc-9.5.0\nmodule load r-fansi/1.0.3_gcc-9.5.0\nmodule load r-utf8/1.2.2_gcc-9.5.0\nmodule load r-pkgconfig/2.0.3_gcc-9.5.0\nmodule load r-gtable/0.3.1_gcc-9.5.0\nmodule load r-scales/1.2.1_gcc-9.5.0\nmodule load r-tzdb/0.3.0_gcc-9.5.0\nmodule load r-timechange/0.1.1_gcc-9.5.0\nmodule load r-dbi/1.1.3_gcc-9.5.0\n\n7.1.2 Load the Latest Stack\nmodule load stack\n\n7.1.3 Stack 2022.2\nmodule load stack/2022.2\nmodule load r/4.2.2_gcc-9.5.0\ncd path",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#load-software-stacks",
    "href": "hpc.html#load-software-stacks",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n7.2 Load Software Stacks",
    "text": "7.2 Load Software Stacks\nhttps://uiowa.atlassian.net/wiki/spaces/hpcdocs/pages/76513440/Argon+Software+List (archived at https://perma.cc/WJ4Q-GDUS)\nmodule load stack/2022.2",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#job-script",
    "href": "hpc.html#job-script",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n7.3 Job Script",
    "text": "7.3 Job Script\n#!/bin/sh\n\n# Set working directory\ncd /Users/itpetersen/Documents/Projects/Bayesian_IRT/\n\n# Specify qsub options\n#$ -pe smp 4\n#$ -M isaac-t-petersen@uiowa.edu\n#$ -m eas\n#$ -l mf=512G\n#$ -l h_vmem=512G\n#$ -cwd\n#$ -q UI-HM\n#$ -e /Users/itpetersen/Documents/Projects/Bayesian_IRT/Output/\n#$ -o /Users/itpetersen/Documents/Projects/Bayesian_IRT/Output/\n\n# Load the environment modules\nmodule load stack/2022.2\nmodule load r/4.2.2_gcc-9.5.0\n\n# Run the R script\nRscript ./Analyses/factorScores.R\n\n7.3.1 qsub options\n-pe smp 4: specify a parellel environment and number of cores to be used (smp = shared memory parallel environment) - The OMP_NUM_THREADS variable is set to ‘1’ by default. If your code can take advantage of the threading then specify OMP_NUM_THREADS to be equal to the number of job cores per node requested.\n-M isaac-t-petersen@uiowa.edu: Set the email address to receive email about jobs. This must be your University of Iowa email address.\n-m eas: Specify when to send an email message (; ; ; ; )\n\n\nb = beginning of job\n\ne = end of job\n\na = when job is aborted\n\ns = when job is suspended\n\nn = no mail is sent\n\n-l mf=512G: request a particular quantity of memory you expect to use (to be available for your computation to start; the request is only applicable at scheduling time. It is not a limit.)\n-l h_vmem=512G: request a particular quantity of virtual memory you expect to use (to be available for your computation to start; the request is only applicable at scheduling time. It is not a limit.)\n-cwd: Determines whether the job will be executed from the current working directory. If not specified, the job will be run from your home directory.\n-q UI-HM: specify queue\n-e /Users/itpetersen/Documents/Projects/Bayesian_IRT/Output/: Name of a file or directory for standard error.\n-o /Users/itpetersen/Documents/Projects/Bayesian_IRT/Output/: Name of a file or directory for standard output.",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#submit-job",
    "href": "hpc.html#submit-job",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n7.4 Submit Job",
    "text": "7.4 Submit Job\nhttps://uiowa.atlassian.net/wiki/spaces/hpcdocs/pages/76513450/Basic+Job+Submission (archived at https://perma.cc/2SS2-LEJR)\nhttps://uiowa.atlassian.net/wiki/spaces/hpcdocs/pages/76513452/Advanced+Job+Submission (archived at https://perma.cc/8H6G-2M2F)\ncd path/to/dataSet123\n[cd /Users/itpetersen/Documents/Projects/Test/Jobs]\nqsub myscript.job\nJob dependency (run Job B when Job A is finished):\nqsub -hold_jid JOB_ID test_B.job\n\n7.4.1 Bayesian IRT\ncd /Users/itpetersen/Documents/Projects/Bayesian_IRT/Jobs\nqsub bayesianIRT.job\nqsub -hold_jid JOB_ID factorScores.job\n\n7.4.2 Multiple Imputation\ncd /Users/itpetersen/Documents/Projects/Multiple_Imputation/Jobs\nqsub srs_selfRegulation.R",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#queues",
    "href": "hpc.html#queues",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n7.5 Queues",
    "text": "7.5 Queues\nhttps://uiowa.atlassian.net/wiki/spaces/hpcdocs/pages/76513468/Queues+and+Policies (archived at https://perma.cc/UUR7-XLBZ)\nUI\nUI-HM\nUI-GPU-HM\nUI-DEVELOP\nall.q",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#queue-status",
    "href": "hpc.html#queue-status",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n7.6 Queue Status",
    "text": "7.6 Queue Status\nqstat -g c -q QUEUE_NAME\nqstat -g c -q UI",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#job-status",
    "href": "hpc.html#job-status",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n7.7 Job Status",
    "text": "7.7 Job Status\nqstat -u itpetersen\nqstat -j JOB_ID",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#job-time-and-memory",
    "href": "hpc.html#job-time-and-memory",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n7.8 Job Time and Memory",
    "text": "7.8 Job Time and Memory\n\nTerminated jobs: qacct -j JOB_ID\n\nJobs in progress: qstat -j JOB_ID | grep usage",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#cancel-job",
    "href": "hpc.html#cancel-job",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n7.9 Cancel Job",
    "text": "7.9 Cancel Job\nqdel JOB_ID",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#run-r-script",
    "href": "hpc.html#run-r-script",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n7.10 Run R Script",
    "text": "7.10 Run R Script\nSee here",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#find-which-versions-of-r-are-installed",
    "href": "hpc.html#find-which-versions-of-r-are-installed",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n8.1 Find which versions of R are installed",
    "text": "8.1 Find which versions of R are installed\nmodule spider R\nBut, there may be more recent version of R installed in the “Additional Software Stacks” (https://uiowa.atlassian.net/wiki/spaces/hpcdocs/pages/76513440/Argon+Software+List; archived at https://perma.cc/WJ4Q-GDUS)",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#compile-r",
    "href": "hpc.html#compile-r",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n8.2 Compile R\n",
    "text": "8.2 Compile R\n\nIf you want to compile a more recent version of R than is available in the software stacks, see here (archived at https://perma.cc/C6EX-EZL4).",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#install-r-packages",
    "href": "hpc.html#install-r-packages",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n8.3 Install R packages",
    "text": "8.3 Install R packages\nhttps://uiowa.atlassian.net/wiki/spaces/hpcdocs/pages/76514803/Adding+R+programs+to+a+personal+library (archived at https://perma.cc/3SRR-2JE7)\n\nfirst load the R environment module\n\nmodule load r/4.2.2_gcc-9.5.0\n\n\nlaunch R\n\nR\n\n\nthen install the package, (the code below uses a generic package_name):\n\ninstall.packages(\"package_name\", repos = \"http://cran.r-project.org\", dependencies = TRUE, type = \"source\", Ncpus = 40)\nIf using packrat, it is preferable to install packages by source, if possible, but you can remove type = source if you want to install binaries\nAssuming that you do not have a personal library directory you will see\n\nWarning in install.packages(\"package_name\", repos = \"http://cran.r-project.org\") :\nlib = \"/opt/R/3.0.2/lib64/R/library\"' is not writable\n\nWould you like to use a personal library instead?  (y/n)\n\nSelect y\n\nSelect y again when prompted to create the directory; your package should download and install into your personal library directory\n\nExample:\n\nCodeinstall.packages(c(\n    \"renv\",\"psych\",\"tidyverse\",\"data.table\",\"nlme\",\"lme4\",\"mirt\",\"TeachingDemos\",\"Amelia\",\"mice\",\"miceadds\",\"abind\",\"future\",\"lavaan\",\"blavaan\",\"Rcpp\",\"igraph\",\"shinystan\",\"StanHeaders\",\"brms\",\"rstan\",\"rjags\"),\n    repos = \"http://cran.r-project.org\",\n    dependencies = TRUE,\n    Ncpus = 40)\n\n\n\n8.3.1 Install R package locally from source\ninstall.packages(path_to_file, repos = NULL, type = \"source\", Ncpus = 40)\nExample:\n\nCodeinstall.packages(c(\n    \"renv\",\"psych\",\"tidyverse\",\"data.table\",\"nlme\",\"lme4\",\"mirt\",\"TeachingDemos\",\"Amelia\",\"mice\",\"miceadds\",\"abind\",\"future\",\"lavaan\",\"blavaan\",\"Rcpp\",\"igraph\",\"shinystan\",\"StanHeaders\",\"brms\",\"rstan\",\"rjags\"),\n    repos = \"http://cran.r-project.org\",\n    type = \"source\",\n    dependencies = TRUE,\n    Ncpus = 40)\n\n\n\n8.3.2 Managing packages for a project using renv\n\n\nCreate a directory where you want you want to store the project.\n\ncd to the above directory\nStart R\nLoad the renv package: library(\"renv\")\n\nAt the R prompt, initialize the renv project on the local repository of R packages with:\n\nrenv::init(project = \"/Users/itpetersen/Documents/Projects/SelfRegulation_IRT/\")\nor renv::init() if you are in the intended working directory\n\n\nYou must restart your R session in the given project directory after running init in order for the changes to take effect!\nFrom this point on you are working in a renv project. Installed packages will go into a library within this project. After initializing the renv project on the local repository of R packages, packages from the local repository can be installed with renv::install():\n\nrenv::install(\"package_name\")\n\n\nTo restart a renv project, simply start R from the directory created in step (1). The project will initialize automatically.\n\nTo update version of renv: renv::upgrade()\nTo install packages: renv::install(\"package_name\")\nTo update packages: renv::update()\nTo save the current state of your library: renv::snapshot()\nTo restore the state of your library from the lock file: renv::restore()\nTo disable renv on a project: renv::deactivate()\n\n8.3.2.1 To control which packages to install with renv using a DESCRIPTION file\nIf you want to control which packages are installed in a renv project, you can use a DESCRIPTION file to specify the packages that should be installed:\n\n\nCreate a DESCRIPTION file in the project directory with the following format:\nType: project\nDescription: My project.\nDepends:\n    packageName1,\n    packageName2,\n    packageName3\n\nRun renv::settings$snapshot.type(\"explicit\") to suppress dependency discover and to enable “explicit” mode: https://rstudio.github.io/renv/reference/dependencies.html#explicit-dependencies\nRun renv::init(bare=TRUE) to initialize the project without attempting to discover and install R package dependencies\n\n8.3.3 To install a new package for a project after renv has been initialized\n\nFirst, load the R environment module (see Install R packages section above)\ncd to the directory of the R project\nlaunch R\n\nR\n\n\nthen install the package, (the code below uses a generic package_name):\n\ninstall.packages(\"package_name\", repos = \"http://cran.r-project.org\", type = \"source\", dependencies = TRUE, Ncpus = 40)\ninstall.packages(c(\"renv\",\"psych\",\"tidyverse\",\"data.table\",\"nlme\",\"lme4\",\"mirt\",\"TeachingDemos\",\"Amelia\",\"mice\",\"miceadds\",\"abind\",\"future\",\"lavaan\",\"blavaan\",\"Rcpp\",\"igraph\",\"shinystan\",\"StanHeaders\",\"brms\",\"rstan\",\"rjags\",\"renv\"), repos = \"http://cran.r-project.org\", type = \"source\", dependencies = TRUE, Ncpus = 40)\n\n\nrenv::snapshot()",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#update-packages",
    "href": "hpc.html#update-packages",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n8.4 Update Packages",
    "text": "8.4 Update Packages\n\nCodeupdate.packages(ask = FALSE)",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#sec-runRscript",
    "href": "hpc.html#sec-runRscript",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n8.5 Run R Script",
    "text": "8.5 Run R Script\nmodule load r/4.0.5_gcc-9.3.0\ncd path/to/dataSet123\n[cd /Users/itpetersen/Documents/Projects/Test/Analyses]\nRscript path/to/program.R\n[Rscript test.R]",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#quit-r",
    "href": "hpc.html#quit-r",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n8.6 Quit R",
    "text": "8.6 Quit R\nq()",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#having-trouble-installing-packages",
    "href": "hpc.html#having-trouble-installing-packages",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n10.1 Having trouble installing packages?",
    "text": "10.1 Having trouble installing packages?\nSometimes Argon will fail to install packages in an R workspace. We advise the following steps:\n\nSometimes R provides an error stating something like “fatal error: modulename: No such file or directory”. In this instance, you may wish to exist R with q() and load all the modules that begin with the listed module name, as listed above in “Installing Linux Packages to Install R Packages”. Then reopen R and try to install the package again.\n\nYou can also try installing the package from binary using the RStudio Package Manager (RSPM):\nremotes::install_github(\"cran4linux/rspm\")\nrspm::enable()\ninstall.packages(\"PACKAGE_NAME\")\n\n\nIf that does not work, you can try downloading the .tar file directly from the CRAN repository. Then copy the file into your Argon folder and type ‘install.packages(“/Users/path/to/directory/package_name”, repos = NULL, type = “source”)’. Note that you may need to download an older version of the package (e.g., from the CRAN Archive), such that it is compatible with the version of R you are running on Argon (which it typically not the most recent R version):\ninstall.packages(\"http://cran.r-project.org/src/contrib/Archive/MASS/MASS_7.3-60.0.1.tar.gz\", repos = NULL, type = \"source\")\n\n\nCheck if you are installing the necessary modules within your job script:\nmodule load stack/2022.2\nmodule load r/4.2.2_gcc-9.5.0\n\n\nAdd a line to your R script to make sure it is accessing the same repository where you installed the packages manually:\n.libPaths(c(\"/old_Users/HAWKID/Rlibs\", \n        \"/cvmfs/argon.hpc.uiowa.edu/2022.2/apps/linux-centos7-broadwell/gcc-9.5.0/r-4.2.2-lv7yirk/rlib/R/library\"))\n\nIf the prior steps fail, email research-computing@uiowa.edu with the error, asking for help to figure out how to install the packages.",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#error-when-installing-packages-from-source",
    "href": "hpc.html#error-when-installing-packages-from-source",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n10.2 Error When Installing Packages from Source",
    "text": "10.2 Error When Installing Packages from Source\nYou may have to set environment variables in each module file to help the compiler find headers and libraries. Note that if you run into any C++ code, you will need to set the CPLUS_INCLUDE_PATH variable.\n\n10.2.1 nloptr\n\n\nRun the following commands\n\nmodule load stack/2022.1\nmodule load r/4.1.3_gcc-9.4.0\nmodule load nlopt\n\nSet LIBRARY_PATH so linker can find library while launching R session (single line below):\n\nLIBRARY_PATH=$ROOT_NLOPT/lib64:$LIBRARY_PATH R\n\nIn R console, install nloptr (two lines below)\n\n\nCodeinstall.packages(verbose = 1, \"nloptr\")\n\n\n\n10.2.2 tkrplot\n\n\nRun the following commands\n\nmodule load stack/2022.1\nmodule load r/4.1.3_gcc-9.4.0\n\nSet LIBRARY_PATH so linker can find library while launching R session (single line below):\n\nC_INCLUDE_PATH=$ROOT_XPROTO/include LIBRARY_PATH=$ROOT_LIBXEXT/lib:$ROOT_LIBXSCRNSAVER/lib R\n\nIn R console, install tkrplot (two lines below)\n\n\nCodeinstall.packages(verbose = 1, \"tkrplot\")",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#error-reading-from-connection",
    "href": "hpc.html#error-reading-from-connection",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n10.3 Error Reading from Connection",
    "text": "10.3 Error Reading from Connection\nError in unserialize(node$con) : error reading from connection\nCalls: parlmice ... FUN -&gt; recvData -&gt; recvData.SOCK0node -&gt; unserialize\nThere likely wasn’t sufficient memory for a given core. Try increasing the max memory available and decreasing the number of cores and/or slots, so there is more memory available per core:\nhttps://stackoverflow.com/questions/46186375/r-parallel-error-in-unserializenodecon-in-hpc (archived at https://perma.cc/MF6V-NAVS)\nhttps://stackoverflow.com/questions/17015598/error-calling-serialize-r-function (archived at https://perma.cc/3Q75-DA2D)\nhttps://gforge.se/2015/02/how-to-go-parallel-in-r-basics-tips/#Memory_load (archived at https://perma.cc/2JRF-8Y5F)",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#old-stacks",
    "href": "hpc.html#old-stacks",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n11.1 Old Stacks",
    "text": "11.1 Old Stacks\n\n11.1.1 Stack 2022.1\nmodule load stack/2022.1\nmodule load r/4.1.3_gcc-9.4.0\ncd path\n\n11.1.2 Stack 2021.1\nmodule load stack/2021.1\nmodule load r/4.0.5_gcc-9.3.0\ncd path\n\n11.1.3 Stack 2020.2\nmodule load stack/2020.2\nmodule load r/4.0.2_gcc-8.4.0\ncd path\n\n11.1.4 Stack 2020.1\nmodule load stack/2020.1\nmodule load r/3.6.2_gcc-9.2.0\ncd path",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  },
  {
    "objectID": "hpc.html#managing-packages-for-a-project-using-packrat",
    "href": "hpc.html#managing-packages-for-a-project-using-packrat",
    "title": "High-Performance Computing (Argon Supercomputer)",
    "section": "\n11.2 Managing packages for a project using packrat\n",
    "text": "11.2 Managing packages for a project using packrat\n\nPlease note: we now use renv rather than packrat for package management\nhttps://uiowa.atlassian.net/wiki/spaces/hpcdocs/pages/76514803/Adding+R+programs+to+a+personal+library (archived at https://perma.cc/3SRR-2JE7)\n\nCreate a directory where you want you want to store the project.\n\ncd to the above directory\nStart R\nLoad the packrat package: library(\"packrat\")\n\nAt the R prompt, initialize the packrat project on the local repository of R packages with: packrat::init(project = \"/Users/itpetersen/Documents/Projects/INSERT_PROJECT_NAME/\", options = list(local.repos = \"/Users/itpetersen/R/x86_64-pc-linux-gnu-library/4.0\"))\n\nYou must restart your R session in the given project directory after running init in order for the changes to take effect!\nFrom this point on you are working in a packrat project. Installed packages will go into a library within this project. After initializing the packrat project on the local repository of R packages, packages from the local repository can be installed with packrat::install_local():\n\npackrat::install_local(\"package_name\")\n\n\nTo restart a packrat project simply start R from the directory created in step (1). The project will initialize automatically.\n\nTo save the current state of your library: packrat::snapshot(); if that command fails due to an error when fetching sources, try packrat::snapshot(snapshot.sources = FALSE)\nTo disable packrat on a project: disable(restart = FALSE)\n\n11.2.1 To install a new package for a project after packrat has been initialized\n\nFirst, load the R environment module (see Install R packages section above)\ncd to the directory of the R project\nlaunch R\n\nR\n\n\nthen install the package, (the code below uses a generic package_name):\n\ninstall.packages(\"package_name\", repos = \"http://cran.r-project.org\", type = \"source\", dependencies = TRUE, Ncpus = 40)\ninstall.packages(c(\"packrat\",\"psych\",\"tidyverse\",\"data.table\",\"nlme\",\"lme4\",\"mirt\",\"TeachingDemos\",\"Amelia\",\"mice\",\"miceadds\",\"abind\",\"future\",\"lavaan\",\"blavaan\",\"Rcpp\",\"igraph\",\"shinystan\",\"StanHeaders\",\"brms\",\"rstan\",\"rjags\",\"renv\"), repos = \"http://cran.r-project.org\", type = \"source\", dependencies = TRUE, Ncpus = 40)\n\n\n\npackrat::snapshot(); if that command fails due to an error when fetching sources, try packrat::snapshot(snapshot.sources = FALSE)\n\n\n11.2.2 Build packrat environment on a compute node (only if necessary if package load fails due to issues building packages)\n\n\nqlogin – for more info, see here: https://uiowa.atlassian.net/wiki/spaces/hpcdocs/pages/76513454/Qlogin+for+Interactive+Sessions (archived at https://perma.cc/Y3A9-WQ3W)\n\nmodule load stack/2020.2-base_arch – this will ensure that the modules point to the lowest common multiarchitecture on Argon and will run on all nodes\nmodule load r\ncd to the directory of the R project\nR\nCreate packrat project (see above)\nInstall packages\nTake a package snapshot using packrat\n\n\nexit – to exit the qlogin session\n\nNote: Your packrat environment will then be linked to the proper glpk library and will run on any Argon node. You do not need to use the 2020.2-base_arch module at run time, only build time.",
    "crumbs": [
      "About",
      "High-Performance Computing"
    ]
  }
]