<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Isaac T. Petersen">
<meta name="dcterms.date" content="today">
<title>EEG and ERP Processing and Analysis – Data Analysis Guides for the Developmental Psychopathology Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d640c705e8c17715bca3574aa719063f.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9278de052701f0b3f1191ef96b26c196.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-TYR0QMREEW', { 'anonymize_ip': true});
</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><link rel="stylesheet" href="styles.css">
<link rel="stylesheet" href="includes/custom.css">
<link rel="stylesheet" href="font/css/roboto.css">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/labLogo.png" alt="" class="navbar-logo light-content"><img src="./images/labLogo.png" alt="" class="navbar-logo dark-content"></a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Data Analysis Guides for the Developmental Psychopathology Lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-datasets" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Datasets</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-datasets">
<li>
    <a class="dropdown-item" href="./abcdData.html">
 <span class="dropdown-text">ABCD Study Data</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analysis-techniques" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Analysis Techniques</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analysis-techniques">
<li>
    <a class="dropdown-item" href="./bayesian.html">
 <span class="dropdown-text">Bayesian Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dataManagement.html">
 <span class="dropdown-text">Data Management</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dags.html">
 <span class="dropdown-text">Directed Acyclic Graphs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eegERP.html">
 <span class="dropdown-text">Electroencephalography/Event-Related Potentials</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eda.html">
 <span class="dropdown-text">Exploratory Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./factorAnalysis.html">
 <span class="dropdown-text">Factor Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./figures.html">
 <span class="dropdown-text">Figures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./hlm.html">
 <span class="dropdown-text">Hierarchical Linear Modeling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./irt.html">
 <span class="dropdown-text">Item Response Theory</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lda.html">
 <span class="dropdown-text">Longitudinal Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sem.html#mediation">
 <span class="dropdown-text">Mediation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regression.html#moderation">
 <span class="dropdown-text">Moderation/Interaction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./multipleImputation.html">
 <span class="dropdown-text">Multiple Imputation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./pca.html">
 <span class="dropdown-text">Principal Component Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regression.html">
 <span class="dropdown-text">Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./statistics.html">
 <span class="dropdown-text">Statistics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sem.html">
 <span class="dropdown-text">Structural Equation Modeling</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-softwareframeworks" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Software/Frameworks</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-softwareframeworks">
<li>
    <a class="dropdown-item" href="./git.html">
 <span class="dropdown-text">Git, GitLab, and GitHub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./hpc.html">
 <span class="dropdown-text">High-Performance Computing Cluster</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jamovi.html">
 <span class="dropdown-text">jamovi</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jatos.html">
 <span class="dropdown-text">JATOS (Just Another Tool for Online Studies)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jsPsych.html">
 <span class="dropdown-text">jsPsych</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lamp.html">
 <span class="dropdown-text">LAMP (Linux, Apache, MySQL, PHP) Server</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./markdown.html">
 <span class="dropdown-text">Markdown</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mplus.html">
 <span class="dropdown-text">Mplus</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./osf.html">
 <span class="dropdown-text">Open Science Framework</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://devpsylab.github.io/pythonDataAnalysisGuides">
 <span class="dropdown-text">Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./R.html">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SPSS.html">
 <span class="dropdown-text">SPSS</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="https://devpsylab.github.io/LabWiki"> 
<span class="menu-text">Lab Wiki</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://developmental-psychopathology.lab.uiowa.edu"> 
<span class="menu-text">Lab Website</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/DevPsyLab/DataAnalysis">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/DevPsyLab/DataAnalysis/issues/new">
            Report a Bug
            </a>
          </li>
      </ul>
</div>
    <a href="https://twitter.com/devpsylab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="https://www.facebook.com/DevPsyLab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-facebook"></i></a>
    <a href="https://www.instagram.com/devpsylab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-instagram"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./eegERP.html">Electroencephalography/Event-Related Potentials</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abcdData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ABCD Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataManagement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Management</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dags.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Directed Acyclic Graphs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eegERP.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Electroencephalography/Event-Related Potentials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factorAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Factor Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./figures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Git, GitLab, and GitHub</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hlm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hierarchical Linear Modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">High-Performance Computing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./irt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Item Response Theory</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jamovi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">jamovi</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jatos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">JATOS (Just Another Tool for Online Studies)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jsPsych.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">jsPsych</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lamp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LAMP (Linux, Apache, MySQL, PHP) Server</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Longitudinal Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markdown</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html#mediation" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mediation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html#moderation" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Moderation/Interaction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mplus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multipleImputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Imputation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./osf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Open Science Framework</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principal Component Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://devpsylab.github.io/pythonDataAnalysisGuides" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SPSS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SPSS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structural Equation Modeling</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li>
<a href="#sec-happe" id="toc-sec-happe" class="nav-link active" data-scroll-target="#sec-happe"><span class="header-section-number">1</span> ERP Processing Pipeline using HAPPE</a>
  <ul>
<li><a href="#sec-initial" id="toc-sec-initial" class="nav-link" data-scroll-target="#sec-initial"><span class="header-section-number">1.1</span> Inital Set-up</a></li>
  <li><a href="#sec-matlabScripts" id="toc-sec-matlabScripts" class="nav-link" data-scroll-target="#sec-matlabScripts"><span class="header-section-number">1.2</span> MATLAB Scripts to Manage HAPPE Files</a></li>
  <li>
<a href="#oddball-processing-pipeline" id="toc-oddball-processing-pipeline" class="nav-link" data-scroll-target="#oddball-processing-pipeline"><span class="header-section-number">1.3</span> Oddball Processing Pipeline</a>
  <ul>
<li><a href="#recommended-folder-strucure" id="toc-recommended-folder-strucure" class="nav-link" data-scroll-target="#recommended-folder-strucure"><span class="header-section-number">1.3.1</span> Recommended Folder Strucure</a></li>
  <li><a href="#matlab-script" id="toc-matlab-script" class="nav-link" data-scroll-target="#matlab-script"><span class="header-section-number">1.3.2</span> MATLAB Script</a></li>
  <li><a href="#sec-inputOddballHAPPE" id="toc-sec-inputOddballHAPPE" class="nav-link" data-scroll-target="#sec-inputOddballHAPPE"><span class="header-section-number">1.3.3</span> HAPPE Inputs</a></li>
  <li><a href="#sec-oddballPost" id="toc-sec-oddballPost" class="nav-link" data-scroll-target="#sec-oddballPost"><span class="header-section-number">1.3.4</span> Oddball Post-HAPPE Steps</a></li>
  </ul>
</li>
  <li>
<a href="#fishshark-processing-pipeline" id="toc-fishshark-processing-pipeline" class="nav-link" data-scroll-target="#fishshark-processing-pipeline"><span class="header-section-number">1.4</span> FishShark Processing Pipeline</a>
  <ul>
<li><a href="#recommended-folder-strucure-1" id="toc-recommended-folder-strucure-1" class="nav-link" data-scroll-target="#recommended-folder-strucure-1"><span class="header-section-number">1.4.1</span> Recommended Folder Strucure</a></li>
  <li><a href="#matlab-script-1" id="toc-matlab-script-1" class="nav-link" data-scroll-target="#matlab-script-1"><span class="header-section-number">1.4.2</span> MATLAB Script</a></li>
  <li><a href="#sec-inputFishSharkHAPPE" id="toc-sec-inputFishSharkHAPPE" class="nav-link" data-scroll-target="#sec-inputFishSharkHAPPE"><span class="header-section-number">1.4.3</span> HAPPE Inputs</a></li>
  <li><a href="#sec-fishSharkPost" id="toc-sec-fishSharkPost" class="nav-link" data-scroll-target="#sec-fishSharkPost"><span class="header-section-number">1.4.4</span> FishShark Post-HAPPE Steps</a></li>
  </ul>
</li>
  <li><a href="#stop-signal-processing-pipeline" id="toc-stop-signal-processing-pipeline" class="nav-link" data-scroll-target="#stop-signal-processing-pipeline"><span class="header-section-number">1.5</span> Stop-Signal Processing Pipeline</a></li>
  </ul>
</li>
  <li>
<a href="#sec-eptPCA" id="toc-sec-eptPCA" class="nav-link" data-scroll-target="#sec-eptPCA"><span class="header-section-number">2</span> ERP PCA (EP) Toolkit</a>
  <ul>
<li><a href="#sec-average" id="toc-sec-average" class="nav-link" data-scroll-target="#sec-average"><span class="header-section-number">2.1</span> Reading Text Files into EP Toolkit</a></li>
  <li><a href="#update-file-with-experiment-information" id="toc-update-file-with-experiment-information" class="nav-link" data-scroll-target="#update-file-with-experiment-information"><span class="header-section-number">2.2</span> Update File with Experiment Information</a></li>
  <li><a href="#generating-grand-average-waveforms" id="toc-generating-grand-average-waveforms" class="nav-link" data-scroll-target="#generating-grand-average-waveforms"><span class="header-section-number">2.3</span> Generating Grand Average Waveforms</a></li>
  <li><a href="#sec-tPCA" id="toc-sec-tPCA" class="nav-link" data-scroll-target="#sec-tPCA"><span class="header-section-number">2.4</span> Temporal PCA</a></li>
  <li><a href="#spatial-pca" id="toc-spatial-pca" class="nav-link" data-scroll-target="#spatial-pca"><span class="header-section-number">2.5</span> Spatial PCA</a></li>
  <li><a href="#temporospatial-pca" id="toc-temporospatial-pca" class="nav-link" data-scroll-target="#temporospatial-pca"><span class="header-section-number">2.6</span> Temporospatial PCA</a></li>
  <li><a href="#sec-extract" id="toc-sec-extract" class="nav-link" data-scroll-target="#sec-extract"><span class="header-section-number">2.7</span> PCA Component Selection and Extraction</a></li>
  <li><a href="#sec-channels" id="toc-sec-channels" class="nav-link" data-scroll-target="#sec-channels"><span class="header-section-number">2.8</span> Identifying Electrodes that Load Onto PCA Component</a></li>
  <li><a href="#exporting-grand-average-data" id="toc-exporting-grand-average-data" class="nav-link" data-scroll-target="#exporting-grand-average-data"><span class="header-section-number">2.9</span> Exporting Grand Average Data</a></li>
  </ul>
</li>
  <li><a href="#generating-erp-composite-datafiles" id="toc-generating-erp-composite-datafiles" class="nav-link" data-scroll-target="#generating-erp-composite-datafiles"><span class="header-section-number">3</span> Generating ERP Composite Datafiles</a></li>
  <li>
<a href="#visualizations-in-r" id="toc-visualizations-in-r" class="nav-link" data-scroll-target="#visualizations-in-r"><span class="header-section-number">4</span> Visualizations in R</a>
  <ul>
<li><a href="#r-code-for-grand-average-waveform-plot" id="toc-r-code-for-grand-average-waveform-plot" class="nav-link" data-scroll-target="#r-code-for-grand-average-waveform-plot"><span class="header-section-number">4.1</span> R Code for Grand Average Waveform Plot</a></li>
  </ul>
</li>
  <li>
<a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix"><span class="header-section-number">5</span> Appendix</a>
  <ul>
<li><a href="#troubleshooting" id="toc-troubleshooting" class="nav-link" data-scroll-target="#troubleshooting"><span class="header-section-number">5.1</span> Troubleshooting</a></li>
  <li><a href="#to-do" id="toc-to-do" class="nav-link" data-scroll-target="#to-do"><span class="header-section-number">5.2</span> To-do</a></li>
  <li>
<a href="#eeglab" id="toc-eeglab" class="nav-link" data-scroll-target="#eeglab"><span class="header-section-number">5.3</span> EEGLAB</a>
  <ul>
<li><a href="#eeglab-processing-steps" id="toc-eeglab-processing-steps" class="nav-link" data-scroll-target="#eeglab-processing-steps"><span class="header-section-number">5.3.1</span> EEGLab Processing Steps</a></li>
  <li><a href="#install-plugins" id="toc-install-plugins" class="nav-link" data-scroll-target="#install-plugins"><span class="header-section-number">5.3.2</span> Install Plugins</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="header-section-number">5.3.3</span> Import Data</a></li>
  <li><a href="#filter-data" id="toc-filter-data" class="nav-link" data-scroll-target="#filter-data"><span class="header-section-number">5.3.4</span> Filter Data</a></li>
  <li><a href="#average-referencing" id="toc-average-referencing" class="nav-link" data-scroll-target="#average-referencing"><span class="header-section-number">5.3.5</span> Average Referencing</a></li>
  <li>
<a href="#artifact-rejection" id="toc-artifact-rejection" class="nav-link" data-scroll-target="#artifact-rejection"><span class="header-section-number">5.3.6</span> Artifact Rejection</a>
  <ul class="collapse">
<li><a href="#automated-artifact-rejection" id="toc-automated-artifact-rejection" class="nav-link" data-scroll-target="#automated-artifact-rejection"><span class="header-section-number">5.3.6.1</span> Automated Artifact Rejection</a></li>
  <li><a href="#selection-of-bad-channels" id="toc-selection-of-bad-channels" class="nav-link" data-scroll-target="#selection-of-bad-channels"><span class="header-section-number">5.3.6.2</span> Selection of Bad Channels</a></li>
  <li><a href="#selection-of-bad-time-periods" id="toc-selection-of-bad-time-periods" class="nav-link" data-scroll-target="#selection-of-bad-time-periods"><span class="header-section-number">5.3.6.3</span> Selection of Bad Time Periods</a></li>
  <li><a href="#sec-ica" id="toc-sec-ica" class="nav-link" data-scroll-target="#sec-ica"><span class="header-section-number">5.3.6.4</span> Independent Component Analysis</a></li>
  </ul>
</li>
  <li><a href="#interpolate-bad-channels" id="toc-interpolate-bad-channels" class="nav-link" data-scroll-target="#interpolate-bad-channels"><span class="header-section-number">5.3.7</span> Interpolate Bad Channels</a></li>
  <li><a href="#average-referencing-1" id="toc-average-referencing-1" class="nav-link" data-scroll-target="#average-referencing-1"><span class="header-section-number">5.3.8</span> Average Referencing</a></li>
  <li><a href="#segmentation" id="toc-segmentation" class="nav-link" data-scroll-target="#segmentation"><span class="header-section-number">5.3.9</span> Segmentation</a></li>
  <li><a href="#baseline-correction" id="toc-baseline-correction" class="nav-link" data-scroll-target="#baseline-correction"><span class="header-section-number">5.3.10</span> Baseline Correction</a></li>
  <li><a href="#automatic-script-example" id="toc-automatic-script-example" class="nav-link" data-scroll-target="#automatic-script-example"><span class="header-section-number">5.3.11</span> Automatic Script example</a></li>
  <li>
<a href="#automatic-script-that-loops-files" id="toc-automatic-script-that-loops-files" class="nav-link" data-scroll-target="#automatic-script-that-loops-files"><span class="header-section-number">5.3.12</span> Automatic script that loops files</a>
  <ul class="collapse">
<li><a href="#warning-messages-with-script" id="toc-warning-messages-with-script" class="nav-link" data-scroll-target="#warning-messages-with-script"><span class="header-section-number">5.3.12.1</span> Warning messages with script</a></li>
  <li><a href="#filtering-average-referencing-and-automatically-cleaning-the-data." id="toc-filtering-average-referencing-and-automatically-cleaning-the-data." class="nav-link" data-scroll-target="#filtering-average-referencing-and-automatically-cleaning-the-data."><span class="header-section-number">5.3.12.2</span> Filtering, average referencing, and automatically cleaning the data.</a></li>
  </ul>
</li>
  <li><a href="#removing-bad-time-periods-and-channels" id="toc-removing-bad-time-periods-and-channels" class="nav-link" data-scroll-target="#removing-bad-time-periods-and-channels"><span class="header-section-number">5.3.13</span> Removing bad time periods and channels</a></li>
  <li><a href="#running-the-ica" id="toc-running-the-ica" class="nav-link" data-scroll-target="#running-the-ica"><span class="header-section-number">5.3.14</span> Running the ICA</a></li>
  </ul>
</li>
  <li>
<a href="#netstation" id="toc-netstation" class="nav-link" data-scroll-target="#netstation"><span class="header-section-number">5.4</span> NetStation</a>
  <ul>
<li><a href="#processing-order" id="toc-processing-order" class="nav-link" data-scroll-target="#processing-order"><span class="header-section-number">5.4.1</span> Processing Order</a></li>
  <li><a href="#folder-structure" id="toc-folder-structure" class="nav-link" data-scroll-target="#folder-structure"><span class="header-section-number">5.4.2</span> Folder Structure</a></li>
  <li><a href="#data-processing" id="toc-data-processing" class="nav-link" data-scroll-target="#data-processing"><span class="header-section-number">5.4.3</span> Data Processing</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes"><span class="header-section-number">5.4.4</span> Notes</a></li>
  <li><a href="#waveform-tools" id="toc-waveform-tools" class="nav-link" data-scroll-target="#waveform-tools"><span class="header-section-number">5.4.5</span> Waveform Tools</a></li>
  <li><a href="#eeg-behaviors-and-bad-channels-form" id="toc-eeg-behaviors-and-bad-channels-form" class="nav-link" data-scroll-target="#eeg-behaviors-and-bad-channels-form"><span class="header-section-number">5.4.6</span> EEG Behaviors and Bad Channels Form</a></li>
  <li><a href="#troubleshooting-and-qa" id="toc-troubleshooting-and-qa" class="nav-link" data-scroll-target="#troubleshooting-and-qa"><span class="header-section-number">5.4.7</span> Troubleshooting and Q&amp;A</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/DevPsyLab/DataAnalysis/edit/main/eegERP.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/blob/main/eegERP.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">EEG and ERP Processing and Analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="sec-happe" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> ERP Processing Pipeline using HAPPE</h1>
<section id="sec-initial" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="sec-initial">
<span class="header-section-number">1.1</span> Inital Set-up</h2>
<ol type="1">
<li>Download MATLAB: <a href="https://its.uiowa.edu/matlab" class="uri">https://its.uiowa.edu/matlab</a>
<ul>
<li>Click <code>How to Install MatLab</code> and follow the relevant instructions</li>
<li>Create a <code>MatLab</code> folder in your local directory. You will keep all of your MatLab related files in this folder.</li>
</ul>
</li>
<li>Install the HAPPE pipeline: <a href="https://github.com/PINE-Lab/HAPPE" class="uri">https://github.com/PINE-Lab/HAPPE</a>
<ul>
<li>Clone the HAPPE repository to your <code>GitHub</code> account</li>
<li>Open the <code>HAPPE</code> folder</li>
<li>Open the <code>HAPPE User Guide</code> document</li>
<li>Read through the <code>HAPPE User Guide</code>
</li>
<li>Navigate to the <code>Setting up HAPPE</code> section in the user guide and follow the instructions for setting up the HAPPE pipeline, including installation of add-ons and eeglab</li>
<li>Note: This version of the HAPPE pipeline includes functionality from the HAPPE 2.0, HAPPE+ER, and HAPPILEE pipelines, so it is suitable for standard EEG processing as well as ERP and low-density EEG/ERP processing.</li>
</ul>
</li>
<li>Install EP Toolkit: <a href="https://sourceforge.net/projects/erppcatoolkit/" class="uri">https://sourceforge.net/projects/erppcatoolkit/</a>
<ul>
<li>After downloading, copy the <code>EP_Toolkit</code> folder to your <code>Matlab</code> folder (in your local directory)</li>
<li>In the <code>EP_toolkit</code> folder:
<ul>
<li>Open <code>EP_Toolkit</code>
</li>
<li>Open <code>Documentation</code>
</li>
<li>Open <code>tutorial</code>
</li>
</ul>
</li>
<li>In the <code>tutorial</code> document, navigate to the <code>Set Up</code> section and follow the instructions for installing and setting up EP Toolkit and FieldTrip. Do <strong>NOT</strong> follow instructions for setting up EEGLAB. You have already set up your path to EEGLAB when you set up the HAPPE pipeline.</li>
<li>You should have the following subfolders in your <code>MatLab</code> folder:
<ul>
<li><code>EP_Toolkit</code></li>
<li><code>Fieldtrip-[version number]</code></li>
</ul>
</li>
</ul>
</li>
</ol></section><section id="sec-matlabScripts" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="sec-matlabScripts">
<span class="header-section-number">1.2</span> MATLAB Scripts to Manage HAPPE Files</h2>
<p>We have scripts for each task that can prepare files for the HAPPE Pipeline and/or manage the files outputted from HAPPE. These actions can be done manually as well, but the MATLAB scripts make the process more efficient. The scripts will also generate a “log” of all of the files processed through HAPPE to facilitate tracking of EEG data processing. The sections below detail the code used to perform these actions as well as the instructions for using the current scripts.</p>
<p>Note: Before using the scripts/code detailed below, ensure that all filepaths used are in your MATLAB path collection. These may include:</p>
<ul>
<li>The location where the automatic scripts are stored (for our lab, this is under <code>/Data Processing/6. MATLAB EEG Pipeline</code>)</li>
<li>The location where the HAPPE pre-processing script is stored</li>
<li>The location of the raw data (to be processed)</li>
<li>The location(s) of any intermediate files for processing (e.g., the updated .mff files that contain accuracy information in FishShark)</li>
<li>The location(s) for any files outputted by HAPPE and/or places you wish to use the script to move them to</li>
</ul>
<p>To add a file path, click on Home/Set Path/Add Folder in MATLAB. You don’t need to specify the file name, just its containing folder.</p>
</section><section id="oddball-processing-pipeline" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="oddball-processing-pipeline">
<span class="header-section-number">1.3</span> Oddball Processing Pipeline</h2>
<section id="recommended-folder-strucure" class="level3" data-number="1.3.1"><h3 data-number="1.3.1" class="anchored" data-anchor-id="recommended-folder-strucure">
<span class="header-section-number">1.3.1</span> Recommended Folder Strucure</h3>
<ol type="1">
<li><code>1a - Files for HAPPE</code></li>
<li><code>1b - Manual Processing</code></li>
<li><code>2 - Processed Files</code></li>
<li><code>3 - Files for PCA</code></li>
<li><code>4 - EPT Averages</code></li>
<li><code>5 - PCA</code></li>
<li><code>6 - PCA Components</code></li>
</ol></section><section id="matlab-script" class="level3" data-number="1.3.2"><h3 data-number="1.3.2" class="anchored" data-anchor-id="matlab-script">
<span class="header-section-number">1.3.2</span> MATLAB Script</h3>
<p>The following section describes the MATLAB scripts used to manage HAPPE output files for the Oddball task data. If you are running HAPPE manually (i.e., without integrating these scripts), skip to the <a href="#sec-inputOddballHAPPE">Oddball HAPPE inputs</a> section.</p>
<ol type="1">
<li>Open the <code>eegProccessingOddball.m</code> file (accessible via Git <a href="https://research-git.uiowa.edu/PetersenLab/SRS/SRS-DataProcessing/-/blob/master/6.%20MATLAB%20EEG%20Pipeline/eegProcessingOddball.m">here</a>) in MATLAB</li>
<li>Update all thresholds and filepaths in script file (must be done BEFORE running the script)
<ul>
<li>In the second section of our script file, we set our “threshold” for the minimum number of trials that need to be retained after pre-processing for a subject’s data to be eligible for PCA. Additional thresholds can also be set for things like number of channels retained, but these are not currently in use.</li>
</ul>
<pre><code>% Set quality threshold parameters
trialCutoff = 10;</code></pre>
<ul>
<li>We also set environment variables with all of the filepaths that are relevant for managing HAPPE output files and tracking processed data. The following paths should be checked and updated as necessary to reflect the organization of processing on your computer.
<ul>
<li>
<code>passPath</code> is the location you wish to have files that meet or exceed the above-defined thresholds to be saved</li>
<li>
<code>allPath</code> is the location you wish to have ALL files outputted from HAPPE saved to (regardless of whether threshold is met or not)</li>
<li>
<code>failPath</code> is the location you wish to have files that do not meet the above-defined thresholds to be copied to
<ul>
<li>.mff files that do not meet threshold will be copied here as an indication that they should be processed manually to see if they meet threshold afterward</li>
</ul>
</li>
<li>
<code>summPath</code> is the location you wish to save the file that lists all files processed through HAPPE in the current batch
<ul>
<li>We currently use this to save the “processing log” to a location that all team members/computers have access to so it is easier to determine which files require processing when EEG data are not stored on a shared server</li>
</ul>
</li>
<li>
<code>manPath</code> is the location you wish to save the file that lists all files that do not meet the above-defined thresholds
<ul>
<li>We currently use this to save the “to process manually” list to a location that all team members/computers have access to so it is easier to determine which files require manual processing because the copied .mff file would not be acessible via our shared server</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>% Set paths for file sorting
passPath = 'V:\Processing-Repo\Folder Structure\3 - Files for PCA'; %location for .txt output files
allPath = 'V:\Processing-Repo\Folder Structure\2 - Processed Files'; %location for all processed files to end up
failPath = 'V:\Processing-Repo\Folder Structure\1b - Manual Processing'; %location to copy unsuccessful .mff to for manual process

% Set path for processing summary
summPath = 'Z:\Shared Server\Study Folder\Data Processing\6. MATLAB EEG Pipeline\Processed Data Logs';

% Set path for summary of files to process manually 
manPath = 'Z:\Shared Server\Study Folder\Data Processing\6. MATLAB EEG Pipeline\Processing To Do\Cases to Process Manually\Lists of Cases by Batch';</code></pre>
</li>
<li>Run the HAPPE Pipeline
<ul>
<li>This first section is designed to rely on user input. Click “Run” on the MATLAB editor window with the file open to begin the process.</li>
<li>A message will appear in the console prompting you to enter the filepath to the location of the HAPPE pre-processing file you wish to run</li>
<li>Once the path is entered, MATLAB will run the file</li>
<li><strong>Note: the filepath inputted should NOT be in quotes</strong></li>
</ul>
<pre><code>% Set path to HAPPE pre-processing script
happeRun = input('Enter the full path to the HAPPE pre-processing file:\n&gt; ','s') ;

% Call and run HAPPE pre-processing script
run(happeRun);</code></pre>
</li>
<li>Enter HAPPE inputs
<ul>
<li>See the following section for HAPPE user inputs for Oddball</li>
</ul>
</li>
</ol>
<p>After the HAPPE inputs are entered, no more user interaction is required for the script to do its job. The HAPPE pipeline will run, and the remaining MATLAB code in the script file will evaluate the files outputted by HAPPE and move them to the appropriate locations based on this evaluation. See <a href="#sec-oddballPost">Oddball Post-HAPPE Steps</a> for a detailed explanation of the code used to accomplish this.</p>
</section><section id="sec-inputOddballHAPPE" class="level3" data-number="1.3.3"><h3 data-number="1.3.3" class="anchored" data-anchor-id="sec-inputOddballHAPPE">
<span class="header-section-number">1.3.3</span> HAPPE Inputs</h3>
<ol type="1">
<li>If you are not using the MATLAB scripts described above, you must first open the HAPPE pipeline V4 script in MATLAB and click “Run”
<ul>
<li>This will be stored in the location to which you mapped the HAPPE Git repo (e.g.&nbsp;<code>Documents/GitHub/HAPPE/1. pre-process/HAPPE_v4.m</code>)</li>
</ul>
</li>
<li>User Inputs
<ul>
<li>Enter the path to the folder containing the dataset.</li>
<li>Select <code>raw</code>
</li>
<li>Load pre-existing set of input parameter:
<ul>
<li>
<code>N</code> if this is your first time running data through the pipeline.</li>
<li>
<code>Y</code> if you have decided on a set of parameters. Enter the path to the folder containing the input parameters.</li>
</ul>
</li>
<li>Low density data: <code>N</code>
</li>
<li>Data type: <code>task</code>
</li>
<li>Performing event-related potential (ERP) analysis: <code>Y</code>
</li>
<li>Enter the task onset tags
<ul>
<li>Target: <code>tgt+</code>
</li>
<li>Frequent: <code>frq+</code>
</li>
<li><code>done</code></li>
</ul>
</li>
<li>Do multiple onset tags belong to a single condition? <code>N</code>
</li>
<li>File format: <code>5</code>
</li>
<li>Acquisition layout type: <code>2</code>
</li>
<li>Number of channels: <code>128</code>
</li>
<li>Do you have additional type fields besides “code”? <code>N</code>
</li>
<li>Select channels of interest: <code>all</code>
</li>
<li>Frequency of electrical noise in Hz: <code>60</code>
</li>
<li>Are there any additional frequencies, (e.g., harmonics) to reduce? <code>N</code>
</li>
<li>Line Noise reduction method: <code>notch</code>
<ul>
<li>Low cutoff: <code>59</code>
</li>
<li>high cutoff: <code>61</code>
</li>
</ul>
</li>
<li>Resample: <code>N</code>
</li>
<li>Filter
<ul>
<li>Low Pass Cutoff: <code>30</code>
</li>
<li>High Pass Cutoff: <code>.1</code>
</li>
</ul>
</li>
<li>Choose a filter: <code>fir</code>
</li>
<li>Bad Channel Detection: <code>Y</code>
<ul>
<li>
<code>after</code> wavelet thresholding</li>
</ul>
</li>
<li>ECGone: <code>N</code>
</li>
<li>Wavelet Thresholding
<ul>
<li><code>default</code></li>
<li>Threshold rule: <code>hard</code>
</li>
</ul>
</li>
<li>MuscIL: <code>N</code>
</li>
<li>Segmentation: <code>Y</code>
<ul>
<li>Starting parameter for stimulus: <code>-200</code>
</li>
<li>Ending parameter for stimulus: <code>1000</code>
</li>
<li>Task offset: <code>2</code>
</li>
</ul>
</li>
<li>Baseline Correction: <code>Y</code>
<ul>
<li>Baseline Correction start: <code>-200</code>
</li>
<li>Baseline Correction end: <code>0</code>
</li>
</ul>
</li>
<li>Interpolation: <code>Y</code>
</li>
<li>Segment Rejection: <code>Y</code>
<ul>
<li>Segment Rejection Method: <code>amplitude</code>
<ul>
<li>minimum segment rejection threshold: <code>-150</code>
</li>
<li>maximum segment rejection threshold: <code>150</code>
</li>
<li>segment rejection based on all channels or ROI: <code>all</code>
</li>
</ul>
</li>
</ul>
</li>
<li>Re-referencing: <code>Y</code>
<ul>
<li>Does your data contain a flatline or all zero reference channel? <code>N</code>
</li>
<li>re-referencing method: <code>average</code>
</li>
</ul>
</li>
<li>Save format: <code>1</code>
</li>
<li>Visualizations: <code>N</code>
</li>
<li>Parameter file save name: <code>default</code>
</li>
</ul>
</li>
</ol></section><section id="sec-oddballPost" class="level3" data-number="1.3.4"><h3 data-number="1.3.4" class="anchored" data-anchor-id="sec-oddballPost">
<span class="header-section-number">1.3.4</span> Oddball Post-HAPPE Steps</h3>
<p>This section details the actions performed by the MATLAB scripts once HAPPE is completed. These actions will take place automatically upon completion of the HAPPE pipeline. <strong>No user inputs or actions are necessary at this stage.</strong></p>
<ol type="1">
<li>
<p>Exclude files that don’t have any output data from the dataset (containing filename and quality reports from HAPPE pipeline) that will be used to assess file quality</p>
<ul>
<li>This step is important because “empty” files don’t play nicely with the code used to evaluate files that have some data in them (even if the data do not meet threshold)</li>
<li>This code relies on HAPPE’s quality data that remains in the MATLAB environment after the pipeline has finished.</li>
</ul>
<pre><code>% Create a list of files that received some kind of error message
noTags = any(strcmp(dataQC, 'NO_TAGS'), 2);
oneRej = any(strcmp(dataQC, 'REJ_ONE_SEG'), 2);
allRej = any(strcmp(dataQC, 'ALL_SEG_REJ'), 2);
error = any(strcmp(dataQC, 'ERROR'), 2);
loadFail = any(strcmp(dataQC, 'LOAD_FAIL'), 2);

% Combine filenames with quality data (for some reason, they are not automatically connected by HAPPE)
dataQCNew = [FileNames', dataQC];

% Remove all files in the above lists (those receiving errors) from the quality data
dataQCNew(noTags | allRej | error | loadFail | oneRej, :) = [];

% Create list of variable names for quality data
dataQCnamesNew = ["File", dataQCnames];

% Save the data as a table for ease of use in subsequent steps
qcTable = cell2table(dataQCNew, 'VariableNames', dataQCnamesNew);</code></pre>
</li>
<li>
<p>Identify the files that meet (or don’t meet) the threshold</p>
<pre><code>% Create a list of files (i.e., rows in the table) that meet threshold
thresholdTest = qcTable.("Number_tgt+_Segs_Post-Seg_Rej") &gt;= trialCutoff &amp; qcTable.("Number_frq+_Segs_Post-Seg_Rej") &gt;= trialCutoff;

% Add a variable to the quality data table that include whether or not the file meet threshold
qcTable.Test = thresholdTest;</code></pre>
</li>
<li>
<p>Add an identifying variable to be used for data joining down the line</p>
<ul>
<li>This variable is generated using its expected location in the file name (i.e., how many text characters “in” it is)</li>
</ul>
<pre><code>% Generate IDs based on File variable
idWaveQC = extractBefore(qcTable.File, 8);

% Append ID variable to quality data
qcTable.idWave = idWaveQC;</code></pre>
</li>
<li>
<p>Create a subsetted dataset conataining only the <code>idWave</code>, file name, and “test results” (i.e., whether a given file meets the specified cutoff threshold for inclusion) variables</p>
<pre><code>% Subset to ID and threshold information
testInfo = qcTable(:, ["idWave", "File", "Test"]);

fprintf('Assessment Complete \n');</code></pre>
</li>
<li>
<p>Generate a list of files outputted by HAPPE</p>
<pre><code>% Generate path for HAPPE pre-processing output (using the HAPPE environment variable from user's input of location of raw data for processing)
inputPath = strcat(srcDir, "\5 - processed");

% Read in list of files outputted from HAPPE 
preprocessingOutput = dir(inputPath);

% Remove "empty" rows 
preprocessingOutput = preprocessingOutput(~ismember({preprocessingOutput.name}, {'.', '..'}));

% Save data as a table for ease of later use
preprocessingOutput = struct2table(preprocessingOutput);

% Subset to file info
fileInfo = preprocessingOutput(:, ["name", "folder"]);</code></pre>
</li>
<li>
<p>Select only desired files to be moved/copied</p>
<ul>
<li>Currently, we don’t do anything with the “Individual Trial” files outputted by HAPPE. These files are quite large and take a long time to move, so it is more efficient to just remove them from the list of filenames and not worry about moving them anywhere.</li>
</ul>
<pre><code>% Subset to desired files (AveOverTrial)
fileSubset = fileInfo(contains(fileInfo.name, "AveOverTrials"), :);</code></pre>
</li>
<li>
<p>Add condition, ID, and threshold-related variables to the file data</p>
<ul>
<li>NOTE: The value for <code>Condition</code> variable (i.e., “Target” or “Frequent”) should match the name of the condition-specific folders you wish the files to save to within the processing repo.</li>
</ul>
<pre><code>% Generate list of IDs based on file name variable
idWaveFS = extractBefore(fileSubset.name, 8);

% Add ID list to file data
fileSubset.idWave = idWaveFS;

% Generate list of files belonging to each condition based on file name variable
target = contains(fileSubset.name, "tgt+");
frequent = contains(fileSubset.name, "frq+");

% Create empty variable for condition
fileSubset.cond = cell(size(fileSubset, 1), 1);

% Fill in condition variable based on the lists generated above
fileSubset.cond(target) = {'Target'};
fileSubset.cond(frequent) = {'Frequent'};
fileSubset.cond(~target &amp; ~frequent) = {'All'};

% Join threshold test information
fileTest = join(fileSubset, testInfo);</code></pre>
</li>
<li>
<p>Prepare data table with information about files that met the threshold</p>
<ul>
<li>The data generated here are preparing to copy the .txt files outputted by HAPPE into a folder containing all files that are suitable for PCA</li>
</ul>
<pre><code>% Create a separate table for only files that meet threshold
movingInfo = fileTest(fileTest.Test, :);

% Create empty columns for filepath variables
movingInfo.destination = cell(size(movingInfo, 1), 1);
movingInfo.origin = cell(size(movingInfo, 1), 1);
movingInfo.processedTo = cell(size(movingInfo, 1), 1);
movingInfo.processedFrom = cell(size(movingInfo, 1), 1);

% Generate file paths based on condition 
movingInfo.destination = strcat({passPath}, "\", movingInfo.cond, "\", movingInfo.name);
movingInfo.origin = strcat(movingInfo.folder, "\", movingInfo.name);
movingInfo.processedTo = strcat({allPath}, "\", movingInfo.name);
movingInfo.processedFrom = strcat(movingInfo.folder, "\", movingInfo.name);</code></pre>
</li>
<li>
<p>Prepare data table with information about files that do NOT meet the threshold</p>
<ul>
<li>The data generated here are preparing to copy .mff files from the location of the raw files into a folder indicating the need for manual processing</li>
</ul>
<pre><code>% Create a separate table for only files that did not meet threshold
failFiles = fileTest(~fileTest.Test, ["File", "folder", "name"]);

% Create empty columns for filepath variables
failFiles.destination = cell(size(failFiles, 1), 1);
failFiles.origin = cell(size(failFiles, 1), 1);
failFiles.processedTo = cell(size(failFiles, 1), 1);
failFiles.processedFrom = cell(size(failFiles, 1), 1);

% Generate filepaths based on ID and task
failFiles.destination = strcat({failPath}, "\", failFiles.File);
failFiles.origin = strcat({srcDir}, "\", failFiles.File);
failFiles.processedFrom = strcat(failFiles.folder, "\", failFiles.name);
failFiles.processedTo = strcat({allPath}, "\", failFiles.name);
</code></pre>
</li>
<li>
<p>Generate environment variables that correspond to the column index of relevant variables for file sorting</p>
<ul>
<li>Note that the very last line of this code defines the varaible(s) to exclude from the HAPPE outputted files. This variable must be stripped from the data before saving them, because the presence of the extra variable makes the file incompatible with EP Toolkit’s PCA process.</li>
</ul>
<pre><code>% Define column locations for each filepath variable

% For files that meet threshold:
toCol = find(strcmp(movingInfo.Properties.VariableNames, "destination"));
fromCol = find(strcmp(movingInfo.Properties.VariableNames, "origin"));
procColto = find(strcmp(movingInfo.Properties.VariableNames, "processedTo"));
procColfrom = find(strcmp(movingInfo.Properties.VariableNames, "processedFrom"));

% For files that do not meet threshold
rawCol = find(strcmp(failFiles.Properties.VariableNames, "origin"));
manCol = find(strcmp(failFiles.Properties.VariableNames, "destination"));
failProcColto = find(strcmp(failFiles.Properties.VariableNames, "processedTo"));
failProcColFrom = find(strcmp(failFiles.Properties.VariableNames, "processedFrom"));

% Define variable to exclude
extraVar = 'Time';</code></pre>
</li>
<li>
<p>Use a loop to process all files that met threshold</p>
<ul>
<li>For each row in the “movingInfo” dataset, the loop will:
<ul>
<li>Identify the origin and destination paths</li>
<li>Read in the HAPPE output file</li>
<li>Remove the extra variable</li>
<li>Save the “cleaned” data in the appropriate folder (without variable names, as required by EP Toolkit)</li>
</ul>
</li>
</ul>
<pre><code>for row = 1:height(movingInfo)
    % Specify path info
    pathFrom = movingInfo{row, fromCol};
    pathTo = movingInfo{row, toCol};
    % Read in the data
    rawTable = readtable(pathFrom);
    % Remove extra column (Time)
    cleanTable = rawTable{:, ~strcmp(rawTable.Properties.VariableNames, extraVar)};
    % Save without headers
    writematrix(cleanTable, pathTo, 'Delimiter', '\t')
end
</code></pre>
</li>
<li>
<p>Use a loop to copy raw (.mff) files into a location that stores files requiring manual processing</p>
<pre><code>for row = 1:height(failFiles)
    % Specify path info
    pathFrom = failFiles{row, rawCol};
    pathTo = failFiles{row, manCol};
    % Copy file 
    copyfile(pathFrom, pathTo)
end</code></pre>
</li>
<li>
<p>Use a set of loops to copy all HAPPE output files into a folder intended to house all output (whether threshold is met or not)</p>
<pre><code>for row = 1:height(movingInfo)
    % Specify path info
    pathFrom = movingInfo{row, procColfrom};
    pathTo = movingInfo{row, procColto};
    % Copy file
    copyfile(pathFrom, pathTo);
end

for row = 1:height(failFiles)
    % Specify path info
    pathFrom = failFiles{row, failProcColFrom};
    pathTo = failFiles{row, failProcColto};
    % Copy file
    copyfile(pathFrom, pathTo);
end</code></pre>
</li>
<li>
<p>Generate a .txt file listing all processed .mff files</p>
<ul>
<li>This file will contain a list of all raw files (e.g., <code>1111_22_oddball.mff</code>) and save the list to the specified location (<code>summPath</code>)</li>
<li>The file will have the current date and time appended to the end so that it will be distinguishable from past logs</li>
<li>The list of processed files is generated using an environment object (<code>FileNames</code>) that the HAPPE pipeline creates that lists all files inputted to the pipeline</li>
</ul>
<pre><code>% Create a table from HAPPE FileNames cell array
processedList = cell2table(FileNames(:));

% Rename file variable from default
processedList = renamevars(processedList, {'Var1'}, {'File'});

% Save current date as a string variable 
today = string(date());

% Save time as a string variable, replacing ":" with "_" so that file can be written 
time = strrep(datestr(now, 'HH:MM:SS:FFF'), ':', "_");

% Generate file name to include current date and time 
listFile = strcat("\oddballProcessed_", today, "_", time);

% Generate full path including file name
summPathFull = strcat(summPath, listFile);

% Write table to specified location
writetable(processedList, summPathFull);</code></pre>
</li>
<li>
<p>Generate a .txt file listing all of the files that did not meet threshold to go through subsequent processing</p>
<ul>
<li>This file will contain a list of all raw files (e.g., <code>1111_22_oddball.mff</code>) that did not meet threshold and save the list to the specified location (<code>manPath</code>)</li>
<li>The file will have the current date and time appended to the end so that it will be distinguishable from past lists</li>
<li>This list of file to process manually is generated using the environment object <code>FileNames</code> that HAPPE creates; any files listed in <code>FileNames</code> but not in the dataset of files that pass threshold make up the <code>manualList</code>
</li>
</ul>
<pre><code>% Compare movingInfo with FileNames to isolate files that don't meet threshold
manualList = cell2table(FileNames(~ismember(FileNames', movingInfo.File)));
manualList = renamevars(manualList, {'Var1'}, {'File'});

% Generate file name to include current date
manFile = strcat("\oddballManual_", today, "_", time);

% Generate full path including filename
manPathFull = strcat(manPath, manFile);

% Write table to specified location
writetable(manualList, manPathFull);</code></pre>
</li>
</ol></section></section><section id="fishshark-processing-pipeline" class="level2" data-number="1.4"><h2 data-number="1.4" class="anchored" data-anchor-id="fishshark-processing-pipeline">
<span class="header-section-number">1.4</span> FishShark Processing Pipeline</h2>
<section id="recommended-folder-strucure-1" class="level3" data-number="1.4.1"><h3 data-number="1.4.1" class="anchored" data-anchor-id="recommended-folder-strucure-1">
<span class="header-section-number">1.4.1</span> Recommended Folder Strucure</h3>
<ol type="1">
<li><code>0 - Raw</code></li>
<li><code>1a - Files for HAPPE</code></li>
<li><code>1b - Manual Processing</code></li>
<li><code>2 - Processed Files</code></li>
<li><code>3 - Files for PCA</code></li>
<li><code>4 - EPT Averages</code></li>
<li><code>5 - PCA</code></li>
<li><code>6 - PCA Components</code></li>
</ol></section><section id="matlab-script-1" class="level3" data-number="1.4.2"><h3 data-number="1.4.2" class="anchored" data-anchor-id="matlab-script-1">
<span class="header-section-number">1.4.2</span> MATLAB Script</h3>
<p>The following section describes the MATLAB scripts used to manage HAPPE input and output files for the FishShark task data. If you are running HAPPE manually (i.e., without integrating these scripts), skip to the <a href="#sec-inputFishSharkHAPPE">FishShark HAPPE inputs</a> section.</p>
<p><strong>The first two steps described in this section are the same as those described for Oddball processing.</strong> <strong>Processing actions specific to FishSharks task begin in Step 3.</strong></p>
<ol type="1">
<li>Open the <code>eegProccessingFishshark.m</code> file (accessible via Git <a href="https://research-git.uiowa.edu/PetersenLab/SRS/SRS-DataProcessing/-/blob/master/6.%20MATLAB%20EEG%20Pipeline/eegProcessingFishshark.m">here</a>) in MATLAB</li>
<li>Update all thresholds and filepaths in script file (must be done BEFORE running the script)
<ul>
<li>In the fifth section of our script file, we set our “threshold” for the minimum number of trials that need to be retained after pre-processing for a subject’s data to be eligible for PCA. Additional thresholds can also be set for things like number of channels retained, but these are not currently in use.</li>
<li>Note that setting these parameters occurs later in the FishSharks script than the one for Oddball; this is because FishSharks files require additional processing before they are ready for HAPPE (see step 3 for details)</li>
</ul>
<pre><code>% Set quality threshold parameters
trialCutoff = 10;</code></pre>
<ul>
<li>We also set environment variables with all of the filepaths that are relevant for managing HAPPE output files and tracking processed data. The following paths should be checked and updated as necessary to reflect the organization of processing on your computer.
<ul>
<li>
<code>passPath</code> is the location you wish to have files that meet or exceed the above-defined thresholds to be saved</li>
<li>
<code>allPath</code> is the location you wish to have ALL files outputted from HAPPE saved to (regardless of whether threshold is met or not)</li>
<li>
<code>failPath</code> is the location you wish to have files that do not meet the above-defined thresholds to be copied to
<ul>
<li>.mff files that do not meet threshold will be copied here as an indication that they should be processed manually to see if they meet threshold afterward</li>
</ul>
</li>
<li>
<code>summPath</code> is the location you wish to save the file that lists all files processed through HAPPE in the current batch
<ul>
<li>We currently use this to save the “processing log” to a location that all team members/computers have access to so it is easier to determine which files require processing when EEG data are not stored on a shared server</li>
</ul>
</li>
<li>
<code>manPath</code> is the location you wish to save the file that lists all files that do not meet the above-defined thresholds
<ul>
<li>We currently use this to save the “to process manually” list to a location that all team members/computers have access to so it is easier to determine which files require manual processing because the copied .mff file would not be acessible via our shared server</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>% Set paths for file sorting
passPath = 'V:\Processing-Repo\Folder Structure\3 - Files for PCA'; %location for .txt output files
allPath = 'V:\Processing-Repo\Folder Structure\2 - Processed Files'; %location for all processed files to end up
failPath = 'V:\Processing-Repo\Folder Structure\1b - Manual Processing'; %location to copy unsuccessful .mff to for manual process

% Set path for processing summary
summPath = 'Z:\Shared Server\Study Folder\Data Processing\6. MATLAB EEG Pipeline\Processed Data Logs';

% Set path for summary of files to process manually 
manPath = 'Z:\Shared Server\Study Folder\Data Processing\6. MATLAB EEG Pipeline\Processing To Do\Cases to Process Manually\Lists of Cases by Batch';</code></pre>
</li>
<li>Update raw (.mff) files’ condition tags with accuracy information
<ul>
<li>Unlike the Passive Oddball task, FishSharks trials can be either correct or incorrect. Whether or not a trial was “responded to” correctly is relevant to the nature of the extracted ERP. Because the event tags in our .mff files do not inherently contain information about whether each trial was responded to correctly, we need to add it ourselves. This process can be done manually in NetStation, but it can also be automated using the MATLAB code detailed below.</li>
<li>NOTE: This code requires eeglab. <strong>Before running the code, open eeglab in your MATLAB session by typing <code>eeglab</code> into the console.</strong> You can close it as soon as it opens, but this step ensures that eeglab is loaded into your current session and helps prevent the subsequent code from erroring out.</li>
</ul>
<ol type="1">
<li>
<p>Set the filepaths for raw and updated .mff files</p>
<ul>
<li>This section is set to rely on user inputs. Click “Run” in the MATLAB editor to start the processing.</li>
<li>A message will appear in the console prompting you to enter two filepaths: the first is the location of the raw .mff files, and the second is the location you would like the updated files to save in.</li>
<li><strong>Note: the filepaths inputted should NOT be in quotes</strong></li>
</ul>
<pre><code>% User input for location of raw files
pathRaw = input('Enter the full path to the folder containing the raw files:\n&gt; ','s');

% User input for destination of subsetted files
pathSub = input('Enter the full path to the folder in which to save the updated files:\n&gt; ','s');</code></pre>
<p>At this point, there will be no user input/actions necessary until all of the .mff files in the <code>pathRaw</code> directory have been updated and saved into the <code>pathSub</code> directory. The code that asks the user for the path to HAPPE will run when that process has finished. The following section will describe the code used to automate the process of updating .mff event tags to include accuracy information at the trial level. Move on to Step 4 (Run the HAPPE Pipeline) when the process has completed.</p>
</li>
<li>
<p>Gather and manage information from the directory housing the raw (.mff) files</p>
<pre><code>% Have MATLAB gather a list of raw files housed in specified location (pathRaw)
dirInfo = struct2table(dir(pathRaw));

% Remove blank rows
noName = strcmp(dirInfo.name, '.') | strcmp(dirInfo.name, '..');
dirInfo(noName, :) = [];</code></pre>
</li>
<li>
<p>Generate variables necessary for managing raw and updated files</p>
<ul>
<li>This code will generate the full filepaths (including file name) necessary for reading in each .mff file and saving its updated counterpart</li>
<li>It will also generate an ID variable for joining purposes based on the expected location of the subject name in the name of each file</li>
</ul>
<pre><code>% Generate ID variable
dataFiles = dirInfo(:, "name");

% Add ID variable to file data
dataFiles.ID = extractBefore(dataFiles.name, 8);

% Generate path to read raw data
rawPaths = dataFiles;
rawPaths.path = strcat({pathRaw}, "/", dirInfo.name);
rawPaths = rawPaths(:, ["ID", "path"]);

% Generate path to save updated versions of the data (containing accuracy info at trial level)
subPaths = dataFiles;
subPaths.path = strcat({pathSub}, "/", subPaths.ID, "_sub_fishshark.mff");
subPaths = subPaths(:, ["ID", "path"]);

% Join filepath datatables
mergePaths = join(rawPaths, subPaths, 'Keys', {'ID'})</code></pre>
</li>
<li>
<p>Use a loop to update the event tags in each .mff file to reflect accuracy of response</p>
<ul>
<li>For every file included in the <code>mergePaths</code> dataset, MATLAB will perform the following actions:
<ul>
<li>Set environment variables representing the path to read in the original .mff file and save its updated counterpart (updates with each iteration of the loop)</li>
<li>Read in the .mff file</li>
<li>Extract the “event” information from the .mff file</li>
<li>Evaluate whether there is usable data in the file
<ul>
<li>This step prevents the code from erroring out if a subject did not make it past the practice trials</li>
<li>If the evaluation determines that there is NOT usable data in the present file, the loop will jump to the next file</li>
</ul>
</li>
<li>Create a table containing response information (response vs no response and reaction time) and condition information (go vs no-go) at the trial level</li>
<li>Evaluate each trial to determine whether the response was correct or incorrect
<ul>
<li>For No-Go trials, responses are CORRECT if there was no response (incorrect if subject did respond)</li>
<li>For Go trials, responses are CORRECT if there was a response AND subject’s reaction time was at least 200 ms (incorrect if subject did not respond OR if subject responded too quickly for response to be considered “valid”)</li>
</ul>
</li>
<li>Update the event tags in the .mff file to contain a “c” for correct trials and an “x” for incorrect trials
<ul>
<li>The c/x indicator will be appended to the front of the existing event tag (e.g., <code>Go++</code> will become <code>cGo++</code>)</li>
</ul>
</li>
<li>Export an updated version of the .mff file with accuracy information to the specified location (<code>pathSub</code>)</li>
</ul>
<strong>NOTE: When exporting EEG data from MATLAB, it is absolutely necessary for the data to be organized in order of event latency.</strong> <strong>If the rows are out of order, latency errors may be introduced.</strong>
<ul>
<li>Correct row order can be achieved in .mff filetypes by sorting according to either the <code>latency</code> column or the <code>urevent</code> column (as shown below)</li>
</ul>
</li>
</ul>
<pre><code>for row = 1:height(mergePaths)
    % Specify paths
    rawFolder = mergePaths{row, "path_rawPaths"}
    subFolder = mergePaths{row, "path_subPaths"}

    % Read in EEG data
    EEGraw = pop_mffimport(char(rawFolder), 'code')

    % Create table from "event" field of raw data
    EEGevent = struct2table(EEGraw.event)

    % Check for the existence of usable rows
    checkVars = strcmp(EEGevent.Properties.VariableNames, 'mffkey_cel')

    % Skip files without necessary variables
    if max(checkVars) == 0
        continue
    end

    % Create table without practice/training trials
    keepRows = strcmp(EEGevent.mffkey_cel, '4')
    EEGsub  = EEGevent(keepRows, :)

    % Check for the existence of usable rows
    checkRows = max(keepRows)

    % Skip files with no usable rows
    if checkRows == 0
        continue
    end

    % Get response info at trial level
    EEGresp = table(EEGsub.mffkey_obs, EEGsub.mffkey_eval, EEGsub.mffkey_rtim)
    EEGresp = rmmissing(EEGresp)
    EEGresp = renamevars(EEGresp, ["Var1", "Var2", "Var3"], ["Trial", "Eval", "RTime"])

    % Get condition info at trial level
    EEGconds = table(EEGsub.mffkey_obs, EEGsub.type)
    EEGconds = renamevars(EEGconds, ["Var1", "Var2"], ["Trial", "Cond"])
    keepConds = strcmp(EEGconds.Cond, 'Go++') | strcmp(EEGconds.Cond, 'NG++')
    EEGcond = EEGconds(keepConds, :)

    % Merge datasets
    EEGtrials = join(EEGcond, EEGresp)

    EEGtrials.RTime = cellfun(@str2num, EEGtrials.RTime)
    % Evaluate trials for correct-ness of response
    correct = strcmp(EEGtrials.Cond, 'Go++') &amp; strcmp(EEGtrials.Eval, '1') &amp; EEGtrials.RTime &gt; 200 | strcmp(EEGtrials.Cond, 'NG++') &amp; strcmp(EEGtrials.Eval, '0')
    EEGtrials.Acc = correct


    % Create new code tags including accuracy information
    EEGtrials.newCode(EEGtrials.Acc &amp; strcmp(EEGtrials.Cond, 'Go++')) = {'cGo++'}
    EEGtrials.newCode(~EEGtrials.Acc &amp; strcmp(EEGtrials.Cond, 'Go++')) = {'xGo++'}
    EEGtrials.newCode(EEGtrials.Acc &amp; strcmp(EEGtrials.Cond, 'NG++')) = {'cNG++'}
    EEGtrials.newCode(~EEGtrials.Acc &amp; strcmp(EEGtrials.Cond, 'NG++')) = {'xNG++'}

    % Subset information for merge
    EEGmerge = EEGtrials(:, {'Trial', 'Cond', 'newCode'})

    % Prep key in original data
    EEGevent.key = strcat(EEGevent.mffkey_obs, EEGevent.type)

    % Prep key in merge data
    EEGmerge.key = strcat(EEGmerge.Trial, EEGmerge.Cond)
    EEGmerge = EEGmerge(:, {'key', 'newCode'})

    % Merge new codes with event table
    EEGnew = outerjoin(EEGevent, EEGmerge)

    % Replace codes where new code is needed
    EEGnew.code(~strcmp(EEGnew.newCode, '')) = EEGnew.newCode(~strcmp(EEGnew.newCode, ''))
    EEGnew.type(~strcmp(EEGnew.newCode, '')) = EEGnew.newCode(~strcmp(EEGnew.newCode, ''))

    % Arrange table in order of event (CRUCIAL for correct export)
    EEGnew = sortrows(EEGnew, 'urevent')

    % Convert table back to struct and restore original dimensions
    EEGnew = table2struct(EEGnew(:, 1:29))
    EEGnew = reshape(EEGnew, [1, height(EEGnew)])

    % Replace event table(s) in original struct
    EEGraw.event = EEGnew
    EEGraw.urevent = table2struct(struct2table(EEGnew(:, 1:28)))

    % Export updated file
    pop_mffexport(EEGraw, char(subFolder))
end </code></pre>
</li>
</ol>
</li>
<li>Run the HAPPE Pipeline
<ul>
<li>This section is designed to rely on user input.</li>
<li>When the prior steps have finsihed, a message will appear in the console prompting you to enter the filepath to the location of the HAPPE pre-processing file you wish to run</li>
<li>Once the path is entered, MATLAB will run the file</li>
<li><strong>Note: the filepath inputted should NOT be in quotes</strong></li>
</ul>
<pre><code>% Set path to HAPPE pre-processing script
happeRun = input('Enter the full path to the HAPPE pre-processing file:\n&gt; ','s') ;

% Call and run HAPPE pre-processing script
run(happeRun);</code></pre>
</li>
<li>Enter HAPPE inputs
<ul>
<li>See the following section for HAPPE inputs for the Fish/Shark task</li>
</ul>
</li>
</ol>
<p>After the HAPPE inputs are entered, no more user interaction is required for the script to do its job. The HAPPE pipeline will run, and the remaining MATLAB code in the script file will evaluate the files outputted by HAPPE and move them to the appropriate locations based on this evaluation. See <a href="#sec-FishSharkPost">FishShark Post-HAPPE Steps</a> for a detailed explanation of the code used to accomplish this.</p>
</section><section id="sec-inputFishSharkHAPPE" class="level3" data-number="1.4.3"><h3 data-number="1.4.3" class="anchored" data-anchor-id="sec-inputFishSharkHAPPE">
<span class="header-section-number">1.4.3</span> HAPPE Inputs</h3>
<ol type="1">
<li>If you are not using the MATLAB scripts described above, you must first open the HAPPE pipeline V4 script in MATLAB and click “Run”
<ul>
<li>This will be stored in the location to which you mapped the HAPPE Git repo (e.g.&nbsp;<code>Documents/GitHub/HAPPE/1. pre-process/HAPPE_v4.m</code>)</li>
</ul>
</li>
<li>User Inputs
<ul>
<li>Enter the path to the folder containing the dataset.</li>
<li>Select <code>raw</code>
</li>
<li>Load pre-existing set of input parameter:
<ul>
<li>
<code>N</code> if this is your first time running data through the pipeline.</li>
<li>
<code>Y</code> if you have decided on a set of parameters. Enter the path to the folder containing the input parameters.</li>
</ul>
</li>
<li>Low density data: <code>N</code>
</li>
<li>Data type: <code>task</code>
</li>
<li>Performing event-related potential (ERP) analysis: <code>Y</code>
</li>
<li>Enter the task onset tags
<ul>
<li>Correct Go: <code>cGo++</code>
</li>
<li>Incorrect Go: <code>xGo++</code>
</li>
<li>Correct NoGo: <code>cNG++</code>
</li>
<li>Incorrect NoGo: <code>xNG++</code>
</li>
<li><code>done</code></li>
</ul>
</li>
<li>Do multiple onset tags belong to a single condition? <code>N</code>
</li>
<li>File format: <code>5</code>
</li>
<li>Acquisition layout type: <code>2</code>
</li>
<li>Number of channels: <code>128</code>
</li>
<li>Do you have additional type fields besides “code”? <code>N</code>
</li>
<li>Select channels of interest: <code>all</code>
</li>
<li>Frequency of electrical noice in Hz: <code>60</code>
</li>
<li>Are there any additional frequencies, (e.g., harmonics) to reduce? <code>N</code>
</li>
<li>Line Noise reduction method: <code>notch</code>
<ul>
<li>Low cutoff: <code>59</code>
</li>
<li>high cutoff: <code>61</code>
</li>
</ul>
</li>
<li>Resample: <code>N</code>
</li>
<li>Filter
<ul>
<li>Low Pass Cutoff: <code>30</code>
</li>
<li>High Pass Cutoff: <code>.1</code>
</li>
</ul>
</li>
<li>Choose a filter: <code>fir</code>
</li>
<li>Bad Channel Detection: <code>Y</code>
<ul>
<li>
<code>after</code> wavelet thresholding</li>
</ul>
</li>
<li>ECGone: <code>N</code>
</li>
<li>Wavelet Thresholding
<ul>
<li><code>default</code></li>
<li>Threshold rule: <code>hard</code>
</li>
</ul>
</li>
<li>MuscIL: <code>N</code>
</li>
<li>Segmentation: <code>Y</code>
<ul>
<li>Starting parameter for stimulus: <code>-200</code>
</li>
<li>Ending parameter for stimulus: <code>1000</code>
</li>
<li>Task offset: <code>17</code>
</li>
</ul>
</li>
<li>Baseline Correction: <code>Y</code>
<ul>
<li>Baseline Correction start: <code>-200</code>
</li>
<li>Baseline Correction end: <code>0</code>
</li>
</ul>
</li>
<li>Interpolation: <code>Y</code>
</li>
<li>Segment Rejection: <code>Y</code>
<ul>
<li>Segment Rejection Method: <code>amplitude</code>
<ul>
<li>minimum segment rejection threshold: <code>-150</code>
</li>
<li>maximum segment rejection threshold: <code>150</code>
</li>
<li>segment rejection based on all channels or ROI: <code>all</code>
</li>
</ul>
</li>
</ul>
</li>
<li>Re-referencing: <code>Y</code>
<ul>
<li>Does your data contain a flatline or all zero reference channel? <code>N</code>
</li>
<li>re-referencing method: <code>average</code>
</li>
</ul>
</li>
<li>Save format: <code>1</code>
</li>
<li>Visualizations: <code>N</code>
</li>
<li>Parameter file save name: <code>default</code>
</li>
</ul>
</li>
</ol></section><section id="sec-fishSharkPost" class="level3" data-number="1.4.4"><h3 data-number="1.4.4" class="anchored" data-anchor-id="sec-fishSharkPost">
<span class="header-section-number">1.4.4</span> FishShark Post-HAPPE Steps</h3>
<p>This section details the actions performed by the MATLAB scripts once HAPPE is completed. These actions will take place automatically upon completion of the HAPPE pipeline. <strong>No user inputs or actions are necessary at this stage.</strong></p>
<ol type="1">
<li>
<p>Exclude files that don’t have any output data from the dataset (containing filename and quality reports from HAPPE pipeline) that will be used to assess file quality</p>
<ul>
<li>This step is important because “empty” files don’t play nicely with the code used to evaluate files that have some data in them (even if the data do not meet threshold)</li>
<li>This code relies on HAPPE’s quality data that remains in the MATLAB environment after the pipeline has finished.</li>
</ul>
<pre><code>% Create a list of files that received some kind of error message
noTags = any(strcmp(dataQC, 'NO_TAGS'), 2);
allRej = any(strcmp(dataQC, 'ALL_SEG_REJ'), 2);
oneRej = any(strcmp(dataQC, 'REJ_ONE_SEG'), 2);
error = any(strcmp(dataQC, 'ERROR'), 2);
loadFail = any(strcmp(dataQC, 'LOAD_FAIL'), 2);

% Combine filenames with quality data (for some reason, they are not automatically connected by HAPPE)
dataQCNew = [FileNames', dataQC];

% Remove all files in the above lists (those receiving errors) from the quality data
dataQCNew(noTags | allRej | error | loadFail | oneRej, :) = [];

% Create list of variable names for quality data
dataQCnamesNew = ["File", dataQCnames];

% Save the data as a table for ease of use in subsequent steps
qcTable = cell2table(dataQCNew, 'VariableNames', dataQCnamesNew);

% Subset to ID and threshold information
testInfo = qcTable(:, ["idWave", "File", "Test"]);</code></pre>
</li>
<li>
<p>Identify the files that meet (or don’t meet) the threshold</p>
<pre><code>% Create a list of files (i.e., rows in the table) that meet threshold
thresholdTest = qcTable.("Number_cNG++_Segs_Post-Seg_Rej") &gt;= trialCutoff &amp; qcTable.("Number_cGo++_Segs_Post-Seg_Rej") &gt;= trialCutoff;

% Add a variable to the quality data table that include whether or not the file meet threshold
qcTable.Test = thresholdTest;</code></pre>
</li>
<li>
<p>Add an identifying variable to be used for data joining down the line</p>
<ul>
<li>This variable is generated using its expected location in the file name (i.e., how many text characters “in” it is)</li>
</ul>
<pre><code>% Generate IDs based on File variable
idWaveQC = extractBefore(qcTable.File, 8);

% Append ID variable to quality data
qcTable.idWave = idWaveQC;</code></pre>
</li>
<li>
<p>Create a subsetted dataset conataining only the <code>idWave</code>, file name, and “test” results (i.e., whether a given file meets the specified cutoff threshold for inclusion)</p>
<pre><code>% Subset to ID and threshold information
testInfo = qcTable(:, ["idWave", "File", "Test"]);

fprintf('Assessment Complete \n');</code></pre>
</li>
<li>
<p>Generate a list of files outputted by HAPPE</p>
<pre><code>% Generate path for HAPPE pre-processing output (using the HAPPE environment variable from user's input of location of raw data for processing)
inputPath = strcat(srcDir, "\5 - processed");

% Read in list of files outputted from HAPPE 
preprocessingOutput = dir(inputPath);

% Remove "empty" rows 
preprocessingOutput = preprocessingOutput(~ismember({preprocessingOutput.name}, {'.', '..'}));

% Save data as a table for ease of later use
preprocessingOutput = struct2table(preprocessingOutput);

% Subset to file info
fileInfo = preprocessingOutput(:, ["name", "folder"]);</code></pre>
</li>
<li>
<p>Select only desired files to be moved/copied</p>
<ul>
<li>Currently, we don’t do anything with the “Individual Trial” files outputted by HAPPE. These files are quite large and take a long time to move, so it is more efficient to just remove them from the list of filenames and not worry about moving them anywhere.</li>
</ul>
<pre><code>% Subset to desired files (AveOverTrial)
fileSubset = fileInfo(contains(fileInfo.name, "AveOverTrials"), :);</code></pre>
</li>
<li>
<p>Add condition, ID, and threshold-related variables to the file data</p>
<ul>
<li>NOTE: The value for <code>Condition</code> variable (i.e., “cGo” or “cNoGo”) should match the name of the condition-specific folders you wish the files to save to within the processing repo.</li>
</ul>
<pre><code>% Generate list of IDs based on file name variable
idWaveFS = extractBefore(fileSubset.name, 8);

% Add ID list to file data
fileSubset.idWave = idWaveFS;

% Generate list of files belonging to each condition based on file name variable
cGo = contains(fileSubset.name, "cGo++");
cNoGo = contains(fileSubset.name, "cNG++");
xGo = contains(fileSubset.name, "xGo++");
xNoGo = contains(fileSubset.name, "xNG++");

% Create empty variable for condition
fileSubset.cond = cell(size(fileSubset, 1), 1);

% Fill in condition variable based on the lists generated above
fileSubset.cond(cGo) = {'cGo'};
fileSubset.cond(cNoGo) = {'cNoGo'};
fileSubset.cond(xGo) = {'xGo'};
fileSubset.cond(xNoGo) = {'xNoGo'};
fileSubset.cond(~cGo &amp; ~cNoGo &amp; ~xGo &amp; ~xNoGo) = {'All'};

% Join threshold test information
fileTest = join(fileSubset, testInfo);</code></pre>
</li>
<li>
<p>Prepare data table with information about files that met the threshold</p>
<ul>
<li>The data generated here are preparing to copy the .txt files outputted by HAPPE into a folder containing all files that are suitable for PCA</li>
</ul>
<pre><code>% Create a separate table for only files that meet threshold
movingInfo = fileTest(fileTest.Test, :);

% Create empty columns for filepath variables
movingInfo.destination = cell(size(movingInfo, 1), 1);
movingInfo.origin = cell(size(movingInfo, 1), 1);
movingInfo.processedTo = cell(size(movingInfo, 1), 1);
movingInfo.processedFrom = cell(size(movingInfo, 1), 1);

% Generate file paths based on condition 
movingInfo.destination = strcat({passPath}, "\", movingInfo.cond, "\", movingInfo.name);
movingInfo.origin = strcat(movingInfo.folder, "\", movingInfo.name);
movingInfo.processedTo = strcat({allPath}, "\", movingInfo.name);
movingInfo.processedFrom = strcat(movingInfo.folder, "\", movingInfo.name);</code></pre>
</li>
<li>
<p>Prepare data table with information about files that do NOT meet the threshold</p>
<ul>
<li>The data generated here are preparing to copy .mff files from the location of the raw files into a folder indicating the need for manual processing</li>
</ul>
<pre><code>% Create a separate table for only files that did not meet threshold
failFiles = fileTest(~fileTest.Test, ["File", "folder", "name"]);

% Create empty columns for filepath variables
failFiles.destination = cell(size(failFiles, 1), 1);
failFiles.origin = cell(size(failFiles, 1), 1);
failFiles.processedTo = cell(size(failFiles, 1), 1);
failFiles.processedFrom = cell(size(failFiles, 1), 1);

% Generate filepaths based on ID and task
failFiles.destination = strcat({failPath}, "\", failFiles.File);
failFiles.origin = strcat({srcDir}, "\", failFiles.File);
failFiles.processedFrom = strcat(failFiles.folder, "\", failFiles.name);
failFiles.processedTo = strcat({allPath}, "\", failFiles.name);
</code></pre>
</li>
<li>
<p>Generate environment variables that correspond to the column index of relevant variables for file sorting</p>
<ul>
<li>Note that the very last line of this code defines the varaible(s) to exclude from the HAPPE outputted files. This variable must be stripped from the data before saving them, because the presence of the extra variable makes the file incompatible with EP Toolkit’s PCA process.</li>
</ul>
<pre><code>% Define column locations for each filepath variable

% For files that meet threshold:
toCol = find(strcmp(movingInfo.Properties.VariableNames, "destination"));
fromCol = find(strcmp(movingInfo.Properties.VariableNames, "origin"));
procColto = find(strcmp(movingInfo.Properties.VariableNames, "processedTo"));
procColfrom = find(strcmp(movingInfo.Properties.VariableNames, "processedFrom"));

% For files that do not meet threshold
rawCol = find(strcmp(failFiles.Properties.VariableNames, "origin"));
manCol = find(strcmp(failFiles.Properties.VariableNames, "destination"));
failProcColto = find(strcmp(failFiles.Properties.VariableNames, "processedTo"));
failProcColFrom = find(strcmp(failFiles.Properties.VariableNames, "processedFrom"));

% Define variable to exclude
extraVar = 'Time';</code></pre>
</li>
<li>
<p>Use a loop to process all files that met threshold</p>
<ul>
<li>For each row in the “movingInfo” dataset, the loop will:
<ul>
<li>Identify the origin and destination paths</li>
<li>Read in the HAPPE output file</li>
<li>Remove the extra variable</li>
<li>Save the “cleaned” data in the appropriate folder (without variable names, as required by EP Toolkit)</li>
</ul>
</li>
</ul>
<pre><code>for row = 1:height(movingInfo)
    % Specify path info
    pathFrom = movingInfo{row, fromCol};
    pathTo = movingInfo{row, toCol};
    % Read in the data
    rawTable = readtable(pathFrom);
    % Remove extra column (Time)
    cleanTable = rawTable{:, ~strcmp(rawTable.Properties.VariableNames, extraVar)};
    % Save without headers
    writematrix(cleanTable, pathTo, 'Delimiter', '\t')
end
</code></pre>
</li>
<li>
<p>Use a loop to copy raw (.mff) files into a location that stores files requiring manual processing</p>
<pre><code>for row = 1:height(failFiles)
    % Specify path info
    pathFrom = failFiles{row, rawCol};
    pathTo = failFiles{row, manCol};
    % Copy file 
    copyfile(pathFrom, pathTo)
end</code></pre>
</li>
<li>
<p>Use a set of loops to copy all HAPPE output files into a folder intended to house all output (whether threshold is met or not)</p>
<pre><code>for row = 1:height(movingInfo)
    % Specify path info
    pathFrom = movingInfo{row, procColfrom};
    pathTo = movingInfo{row, procColto};
    % Copy file
    copyfile(pathFrom, pathTo);
end

for row = 1:height(failFiles)
    % Specify path info
    pathFrom = failFiles{row, failProcColFrom};
    pathTo = failFiles{row, failProcColto};
    % Copy file
    copyfile(pathFrom, pathTo);
end</code></pre>
</li>
<li>
<p>Generate a .txt file listing all processed .mff files</p>
<ul>
<li>This file will contain a list of all raw files (e.g., <code>1111_22_fishshark.mff</code>) and save the list to the specified location (<code>summPath</code>)</li>
<li>The file will have the current date and time appended to the end so that it will be distinguishable from past logs</li>
<li>The list of processed files is generated using an environment variable that the HAPPE pipeline creates that lists all files inputted to the pipeline</li>
</ul>
<pre><code>% Create a table from HAPPE FileNames cell array
processedList = cell2table(FileNames(:));

% Rename file variable from default
processedList = renamevars(processedList, {'Var1'}, {'File'});

% Save current date as a string variable 
today = string(date());

% Save time as a string variable, replacing ":" with "_" so that file can be written 
time = strrep(datestr(now, 'HH:MM:SS:FFF'), ':', "_");

% Generate file name to include current date and time 
listFile = strcat("\oddballProcessed_", today, "_", time);

% Generate full path including file name
summPathFull = strcat(summPath, listFile);

% Write table to specified location
writetable(processedList, summPathFull);</code></pre>
</li>
<li>
<p>Generate a .txt file listing all of the files that did not meet threshold to go through subsequent processing</p>
<ul>
<li>This file will contain a list of all raw files (e.g., <code>1111_22_fishshark.mff</code>) that did not meet threshold and save the list to the specified location (<code>manPath</code>)</li>
<li>The file will have the current date and time appended to the end so that it will be distinguishable from past lists</li>
<li>This list of file to process manually is generated using the environment object <code>FileNames</code> that HAPPE creates; any files listed in <code>FileNames</code> but not in the dataset of files that pass threshold make up the <code>manualList</code>
</li>
</ul>
<pre><code>% Compare movingInfo with FileNames to isolate files that don't meet threshold
manualList = cell2table(FileNames(~ismember(FileNames', movingInfo.File)));
manualList = renamevars(manualList, {'Var1'}, {'File'});

% Generate file name to include current date
manFile = strcat("\fishSharkManual_", today, "_", time);

% Generate full path including filename
manPathFull = strcat(manPath, manFile);

% Write table to specified location
writetable(manualList, manPathFull);</code></pre>
</li>
</ol></section></section><section id="stop-signal-processing-pipeline" class="level2" data-number="1.5"><h2 data-number="1.5" class="anchored" data-anchor-id="stop-signal-processing-pipeline">
<span class="header-section-number">1.5</span> Stop-Signal Processing Pipeline</h2>
</section></section><section id="sec-eptPCA" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> ERP PCA (EP) Toolkit</h1>
<section id="sec-average" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="sec-average">
<span class="header-section-number">2.1</span> Reading Text Files into EP Toolkit</h2>
<ol type="1">
<li>Open MATLAB with “Run as Administrator”</li>
<li>Open ERP PCA Toolkit in MATLAB
<ul>
<li>Type <code>ep</code> in command prompt</li>
</ul>
</li>
<li>Click <code>Read</code> to import files</li>
<li>Use the following options
<ul>
<li>Format = <code>text (.txt)</code>
</li>
<li>Type = <code>average</code>
</li>
<li>Mont = <code>Adult Hydrocel 128-channel 1.0</code>
</li>
</ul>
</li>
<li>Select <code>Single File Mode</code>.
<ul>
<li>Single file mode will use the filename to assign the task condition and participant ID for each file. Thus, <strong>it is critical to use a standard naming convention to name the files</strong>.
<ul>
<li>For example, an oddball file could be named: <code>1001_36_oddball_processed_AveOverTrials_tgt+.txt</code>
</li>
<li>A FishSharks file meanwhile could be named: <code>1004_36_oddball_processed_AveOverTrials_cGo++.txt</code>
</li>
<li>
<em>Note: The filename examples above reflect the automated naming convention of the files outputted by the HAPPE pipeline.</em> <em>If another processing pipeline is used or if the naming conventions become unstandardized, it is <strong>crucial</strong> that standardization of filenames is implemented</em>
</li>
</ul>
</li>
</ul>
</li>
<li>In the <code>Single File Mode</code> menu use the <code>Subject</code> field to denote which characters in the filename name will determine the participant ID.
<ul>
<li>For the above example <code>1:7</code> would correspond to <code>1001_36</code> in a file called <code>1001_36_oddball_processed_AveOverTrials_tgt+.txt</code> (outputted by HAPPE)</li>
</ul>
</li>
<li>Next, In the <code>Single File Mode</code> menu use the <code>Cell</code> field to denote which characters in the file name will determine the task condition.
<ul>
<li>For the below example <code>41:43</code> would correspond to <code>frq</code> or <code>tgt</code> in a file called <code>1001_36_oddball_processed_AveOverTrials_tgt+.txt</code>
</li>
<li>For FishSharks files, it might be <code>47:49</code> that correspond to <code>cgo</code> or <code>cng</code>.</li>
<li><img src="images/readTextFile2024.png" class="img-fluid"></li>
</ul>
</li>
<li>Select <code>Read</code>. You will be asked to name the aggregate file created by importing and combining the single files. Use the convention “task_condition_age” to name the file (e.g., <code>ob_tgt_54</code>)</li>
<li>A new window will open prompting you to select the files you wish to import. Navigate to the folder housing the data to be imported (e.g., <code>3 - Files for PCA\Target</code>) and use <code>Ctrl + A</code> to select all files in that folder. Click <code>Open</code> once all desired files are selected</li>
<li>Select the <code>2_9AverageNet128.ced</code> file when prompted by another popup. This file corresponds to the electrode template associated with the participant age range and type of net represented in the data
<ul>
<li>For our study using a 128-channel net on children aged 3-7, the <code>2_9AverageNet128.ced</code> template is most appropriate <img src="images/netTemplateFile.png" class="img-fluid">
</li>
</ul>
</li>
<li>The new file will have the participant ID and will combine the conditions for each participant.
<ul>
<li>Subject Names: <img src="images/subjectCombinedNames.png" class="img-fluid">
</li>
<li>Task Conditions <img src="images/conditionCombinedNames.png" class="img-fluid">
</li>
</ul>
</li>
</ol></section><section id="update-file-with-experiment-information" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="update-file-with-experiment-information">
<span class="header-section-number">2.2</span> Update File with Experiment Information</h2>
<ol type="1">
<li>Go to <code>Main</code> and click <code>Edit</code>
</li>
<li>Click on the file you imported</li>
<li>In <code>Overview</code>, add the following information:
<ul>
<li>Experiment Name: <code>Oddball</code>, <code>FishShark</code>, or <code>StopSignal</code>
</li>
<li>Reference Type: change to <code>average reference</code>
</li>
<li>Prestimulus period: change to <code>200</code>
</li>
<li>Nominal sampling rate: change to <code>1000</code>
</li>
</ul>
</li>
<li>Click <code>Done</code>
</li>
<li>Go to <code>Main</code> and click <code>Save</code>
<ul>
<li>Save the combined file as an <code>.ept</code> file in the <code>4-EPT Averages</code> folder using the following naming convention: “task_condition_age”. For example, if you were working on the target condition of oddball for all age groups, you would save the file as <code>ob_tgt_all</code>
</li>
</ul>
</li>
</ol></section><section id="generating-grand-average-waveforms" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="generating-grand-average-waveforms">
<span class="header-section-number">2.3</span> Generating Grand Average Waveforms</h2>
<ol type="1">
<li>If the EPT average file (e.g., <code>ob_tgt_all</code>) is not already in the working environment, read it in using the steps below
<ul>
<li>Go to <code>Read</code>
</li>
<li>Format = <code>EP (.ept)</code>
</li>
<li>Click <code>Read</code>
</li>
<li>Navigate to the <code>4 - EPT Averages</code> folder and select desired file(s)</li>
<li>Click <code>Open</code> in the browser window to read the file(s)</li>
<li>Click <code>Main</code> to return to main menu</li>
</ul>
</li>
<li>Select <code>Edit</code>
</li>
<li>When the editor window opens, navigate to the <code>Subjects</code> pane</li>
<li>Select <code>All</code> from among the many options along the lefthand pane of the editor
<ul>
<li>This will select all of the subjects included in the file and assign them a weight of 1</li>
</ul>
</li>
<li>Confirm that all subjects have been selected (look for a checked box in the subject row) and that all weights have been set to 1</li>
<li>Click <code>Add</code>
</li>
<li>A new “subject” should have now been added to the bottom of the subjects list
<ul>
<li>This subject is called <code>gave</code> and represents the grand average across all subjects</li>
</ul>
</li>
<li>Click <code>Done</code> to exit the editor window, then <code>Main</code> to return to the EP Toolkit home</li>
</ol></section><section id="sec-tPCA" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="sec-tPCA">
<span class="header-section-number">2.4</span> Temporal PCA</h2>
<ol type="1">
<li>Go to <code>Main</code> and click <code>PCA</code>
</li>
<li>Input the following:
<ul>
<li>Mode: <code>temporal</code>
</li>
<li>Rotation: <code>promax</code>
</li>
<li>Factors: <code>0</code>
</li>
<li>Title: tPCA_experimentname (example: <code>tPCA_ob_tgt_all</code>)</li>
</ul>
</li>
<li>Click the appropriate file (e.g., <code>ob_tgt_all</code>)</li>
<li>Determine how many factors to retain using the scree plot (keep the number of factors where the blue line is above the red line)</li>
<li>Determine the percent variance accounted for by the number of factors retained by changing the “minimum % age accounted for criterion”. Record the number of factors retained and % variance accounted for by that number of factors.</li>
<li>Re-run the temporal PCA using the above inputs, <strong>but change the number of factors to the number of factors retained from the above step</strong>
</li>
<li>Return to <code>Main</code> and click <code>Save</code>. Save the tPCA file in the <code>5-PCA</code> folder</li>
</ol></section><section id="spatial-pca" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="spatial-pca">
<span class="header-section-number">2.5</span> Spatial PCA</h2>
<ol type="1">
<li>Go to <code>Main</code> and click <code>PCA</code>
</li>
<li>Change the PCA type, using the following inputs:
<ul>
<li>Mode: <code>spatial</code>
</li>
<li>Rotation: <code>infomax</code>
</li>
<li>Factors: <code>0</code>
</li>
<li>Title: sPCA_experimentname (e.g., <code>sPCA_ob_tgt_all</code>)</li>
</ul>
</li>
<li>Click the appropriate file (e.g., <code>ob_tgt_all</code>)</li>
<li>Determine how many factors to retain using the scree plot (keep the number of factors where the blue line is above the red line)</li>
<li>Determine the percent variance accounted for by the number of factors retained by changing the “minimum % age accounted for criterion”. Record the number of factors retained and % variance accounted for by that number of factors.</li>
<li>Re-run the spatial PCA using the above inputs, <strong>but change the number of factors to the number of factors retained from the above step</strong>
</li>
<li>Return to <code>Main</code> and click <code>Save</code>. Save the sPCA file in the <code>5-PCA</code> folder</li>
</ol></section><section id="temporospatial-pca" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="temporospatial-pca">
<span class="header-section-number">2.6</span> Temporospatial PCA</h2>
<ol type="1">
<li>Go to <code>Main</code> and click <code>PCA</code>
</li>
<li>Change the PCA type, using the following inputs:
<ul>
<li>Mode: <code>spatial</code>
</li>
<li>Rotation: <code>infomax</code>
</li>
<li>Factors: <code>0</code>
</li>
<li>Title: tsPCA_experimentname (e.g., <code>tsPCA_ob_tgt_all</code>)</li>
</ul>
</li>
<li>Click the <code>tPCA</code> file (created in the previous step)</li>
<li>Determine how many factors to retain using the scree plot (keep the number of factors where the blue line is above the red line)</li>
<li>Determine the percent variance accounted for by the number of factors retained by changing the “minimum % age accounted for criterion”. Record the number of factors retained and % variance accounted for by that number of factors.</li>
<li>Re-run the spatial PCA using the above inputs, <strong>but change the number of factors to the number of factors retained from the above step</strong>
</li>
<li>Return to <code>Main</code> and click <code>Save</code>. Save the tsPCA file in the <code>5-PCA</code> folder.</li>
</ol></section><section id="sec-extract" class="level2" data-number="2.7"><h2 data-number="2.7" class="anchored" data-anchor-id="sec-extract">
<span class="header-section-number">2.7</span> PCA Component Selection and Extraction</h2>
<p>Here, the goal is to select the PCA component that corresponds to the ERP component of interest, and the extraction that supports the intended interpretability of the component.</p>
<ol type="1">
<li>Go to <code>View</code> to begin the process of selecting the PCA component that corresponds to the ERP of interest.
<ul>
<li>Iteratively select and view each temporospatial PCA component to identify the PCA component (“factor”) that corresponds to the ERP of interest (e.g., N2 or P3). Select the temporospatial PCA component that corresponds to the ERP of interest based on the timing, spatial location, morphology, and (as relevant) any condition- or age-related differences of the component based on prior work.</li>
</ul>
</li>
<li>Generate tsPCA components. Go to <code>Window</code> and input the following:
<ul>
<li>select the tsPCA file</li>
<li>select among <code>mean</code>, <code>maxPeak</code>, or other options. (According to Joe Dien), when using amplitudes from PCA components, it does not matter which option you select—all the different methods result in comparable <em>p</em>-values when dealing with PCA components. So, select a method that makes sense for the story you want to tell. The methods will yield different results when dealing with the raw waveforms.</li>
<li>select <code>AutoPCA</code> or <code>Window</code> to <a href="#sec-channels">select channels</a>. If the peak amplitude is where you expect temporally and spatially, then use the autoPCA function, and if it is not, then window to where you expect it to be. This will allow you to report results that are more interpretable. As Joe Dien described, the way that PCA data are stored internally in the toolkit are as factor scores (i.e., component scores). When you extract amplitudes from a PCA component, you are extracting the factor scores multiplied by a constant (some scaling factor, representing the electrode where you extract it from). Thus, according to Joe Dien, the <em>p</em>-values should be the same regardless of whether you use AutoPCA, or extract from a single electrode or multiple electrodes (it would be good to verify this). What is changing is merely the scaling factor (i.e., the constant that is multiplied by all factor scores). When you select multiple electrodes, it is computing the PCA-estimated amplitude at each electrode and performing a simple average across those electrodes. The AutoPCA extracts the PCA-estimated amplitude at the peak channel and the peak timepoint. If the waveform is negative-going at the peak channel, and you are interested in the positive-going dipole, you would select the peak positive channel to identify the PCA-estimated amplitude of the positive-going waveform on that PCA component. Nevertheless, even though you are selecting the PCA-estimated amplitude for a given channel at a given electrode, there are now “virtual channels”; the estimates include the contributions of all channels and all timepoints <u>to the extent that</u> they load onto the PCA component of interest. Thus, even if you select to window a PCA component from only 1 channel at 1 timepoint, it is using ALL channels and timepoints in the estimation—this is not the case if windowing the raw ERP waveforms.</li>
<li>Save the files generated from the AutoPCA in the <code>6 - PCA Components</code> folder using the following naming convention: “erp_task_condition_age_component” (e.g.,<code>erp_ob_tgt_all_P3</code>).</li>
</ul>
</li>
<li>To view all of the tsPCA components, click <code>View</code> and input the following
<ul>
<li>select the appropriate file (e.g., <code>ob_tgt_all</code>)</li>
<li>select <code>gave</code>
</li>
<li>select <code>none</code>
</li>
<li>click <code>Waves</code>
</li>
</ul>
</li>
<li>It is good practice to check to make sure that components are comparable across different age ranges
<ul>
<li>You can check this in one of two ways:
<ul>
<li>Visually examine grand averages between age ranges</li>
<li>Apply the PCA from one age group and apply it to another age group and examine whether the results hold up using cross-validation in EPToolkit</li>
</ul>
</li>
</ul>
</li>
<li>It is generally useful to keep track of the extraction process for each PCA component. Our current procedure for doing so is keeping a <code>PCA_ComponentInfo.txt</code> file in the <code>6-PCA Components</code> folder.
<ul>
<li>Relevant information may include the timing used to window a component and the electrodes that load onto the component of interest at a given threshold</li>
</ul>
</li>
</ol></section><section id="sec-channels" class="level2" data-number="2.8"><h2 data-number="2.8" class="anchored" data-anchor-id="sec-channels">
<span class="header-section-number">2.8</span> Identifying Electrodes that Load Onto PCA Component</h2>
<ol type="1">
<li>Go to <code>Window</code>
</li>
<li>Select the PCA file of interest (e.g., <code>tsPCA_ob_tgt_all</code>)</li>
<li>Click the <code>Channels</code> button (about halfway down the <code>Window</code> window)</li>
<li>Click <code>Factor</code>
<ul>
<li>From the dropdown, select the PCA file of interest (e.g., <code>tsPCA_ob_tgt_all</code>)</li>
<li>Enter the threshold in the space below (e.g., 0.5)
<ul>
<li>This sets the minumum factor loading value for an electrode to be “included” in the component-related cluster</li>
</ul>
</li>
<li>Depending on whenther you are interested in positive or negative factor loadings, select the appropriate sign (<code>+</code>, <code>-</code>, or <code>+/-</code>)</li>
<li>A popup window with PCA factors will appear. Select the component(s) you wish to identify spatially (e.g., <code>TF01SF01</code>)</li>
</ul>
</li>
<li>When prompted, give the electrode cluster a name</li>
<li>The channels that change color are those which load onto the selected component at or above the threshold value</li>
<li>If you plan to use this cluster in extracting a PCA component, you’ll need save the cluster
<ul>
<li>Click <code>Save</code> in the <code>Window</code> window</li>
<li>Save the cluster to <code>6-PCA Components</code>
</li>
</ul>
</li>
</ol></section><section id="exporting-grand-average-data" class="level2" data-number="2.9"><h2 data-number="2.9" class="anchored" data-anchor-id="exporting-grand-average-data">
<span class="header-section-number">2.9</span> Exporting Grand Average Data</h2>
<p>If you are only interested in the grand average data and not individual subjects, these instructions will allow you to export a .txt file containing only the grand average data.</p>
<ol type="1">
<li>From EP Toolkit home (<code>Main</code> screen), select <code>Edit</code>
</li>
<li>Select the .ept averages file (e.g., <code>ob_tgt_all</code>) that contains a “subject” representing the grand average
<ul>
<li>If the file does NOT contain a grand average subject, follow the steps in the above section to generate it</li>
</ul>
</li>
<li>Rename the file
<ul>
<li>For example, <code>ob_tgt_all</code> could be renamed to <code>ob_tgt_gav</code>
</li>
<li>Renaming the file will prompt EP Toolkit to ask whether you want to generate a new file with this new name, or overwrite the existing datafile once your changes are complete</li>
</ul>
</li>
<li>Select <code>Subjects</code> from the options at the top of the editor window</li>
<li>Click <code>All</code> from among the options on the lefthand side of the <code>Subjects</code> window
<ul>
<li>This will select all of the subjects</li>
</ul>
</li>
<li>Scroll to the bottom of the list of subjects and <strong>deselect</strong> the subject labeled <code>grand average</code>
<ul>
<li>Essentially, the goal here is to create a dataset that includes ONLY the grand average information, rather than each individual subject</li>
</ul>
</li>
<li>Once everything EXCEPT for the grand average subject is selected, click <code>Delete</code> on the lefthand side of the editor window
<ul>
<li>This will remove the individual subject data from the dataset and leave the grand average information</li>
</ul>
</li>
<li>Click <code>Done</code>
</li>
<li>If you renamed the datafile, EP Toolkit should generate a popup message asking whether you would like to rename your dataset OR generate a new dataset using the new name (leaving the original dataset untouched). From the options presented, click <code>New</code> to generate a new file and preserve the original</li>
<li>The editor window should close, returning you to the EP Toolkit pane that asks you to select a dataset to edit. From here, click <code>Main</code> to return to EP Toolkit “home”</li>
<li>Once in the main window, click <code>Save</code>
<ul>
<li>Set the save format to <code>Text (.txt)</code>
</li>
<li>Click the grand average data (e.g., <code>ob_tgt_gav</code>) to save it</li>
<li>A file explorer window should open, prompting you to select the appropriate save location and give your file a name</li>
</ul>
</li>
</ol></section></section><section id="generating-erp-composite-datafiles" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Generating ERP Composite Datafiles</h1>
<ol type="1">
<li>Save a copy of all extracted PCA component files (e.g., <code>erp_ob_tgt_all_P3</code>) in the following location on the Lab Drive: <code>[...]/Data/LV2/PCA Components</code> under the appropriate task (i.e., Oddball, Fishshark, or Stop Signal)</li>
<li>Use the following R Code to combine all components into a single composites datafile. The following example is taken from the <code>erpOddball.R</code> composite script located in <code>[...]Data Processing/3. Composites</code> and available via Git <a href="https://research-git.uiowa.edu/PetersenLab/SRS/SRS-DataProcessing/-/blob/master/3.%20Composites/erpOddball.R">here</a>. Comparable scripts have also been created for FishShark and Stop Signal tasks.
<ol type="1">
<li>
<p>Create a list of all PCA component files in the specified directory. This list will contain the full filepaths to each component file which are used to read the data into R.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">oddballFilePaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span></span>
<span> path <span class="op">=</span> <span class="st">"Z:/Shared Server/Study Folder/Data/LV2/ERP/PCA Components/Oddball"</span>, </span>
<span> pattern <span class="op">=</span> <span class="st">"*.txt"</span>,</span>
<span> recursive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span> full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
<li>
<p>Generate a list of the names of each PCA component file in the specified directory. This list will be used to rename columns in the final composite dataset according to the name of the component file. For this reason, the naming convention of each component files is crucial; this will determine how the corresponding column of the composite datafile is named.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">oddballFiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span></span>
<span> path <span class="op">=</span> <span class="st">"Z:/Shared Server/Study Folder/Data/LV2/ERP/PCA Components/Oddball"</span>,</span>
<span> pattern <span class="op">=</span> <span class="st">"*.txt"</span>,</span>
<span> recursive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
<li>
<p>Read in each component file, skipping the rows containing summary information about the extracted component (the first 7 rows in this example).</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">oddballData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">oddballFilePaths</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">read_delim</span><span class="op">(</span><span class="va">x</span>, delim <span class="op">=</span> <span class="st">"\t"</span>, skip <span class="op">=</span> <span class="fl">7</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
<li>
<p>“Clean” the list of component file names by removing the file extension (in this case, <code>.txt</code>).</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">componentNames</span> <span class="op">&lt;-</span> <span class="va">oddballFiles</span> <span class="op">%&gt;%</span> <span class="fu">str_remove</span><span class="op">(</span><span class="st">".txt"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
<li>
<p>Give <code>ID</code> variable a proper name.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">oddballData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">oddballData</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"ID"</span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span> <span class="op">}</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
<li>
<p>At this stage, the ERP component data are nested within a list of separate data objects. We must therefore merge them into a single dataframe object.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">oddballDataMerged</span> <span class="op">&lt;-</span> <span class="va">oddballData</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">reduce</span><span class="op">(</span><span class="va">full_join</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
<li>
<p>Organize the combined data. The code below performs the following operations (in order of appearance):</p>
<ul>
<li>Create <code>tcid</code> variable by extracting the first four characters of existing <code>ID</code> variable</li>
<li>Create <code>wave</code> variable by extracting the 6th and 7th characters of existing <code>ID</code> variable</li>
<li>Re-order the data so that <code>tcid</code> and <code>wave</code> appear as the first two columns while all other columns retain their order in the dataset</li>
<li>Remove the <code>ID</code> variable now that it has been separated into <code>tcid</code> and <code>wave</code>
</li>
<li>Convert all values to numeric</li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">oddballDataClean</span> <span class="op">&lt;-</span> <span class="va">oddballDataMerged</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">mutate</span><span class="op">(</span>tcid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">ID</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>          wave <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">ID</span>, <span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">select</span><span class="op">(</span><span class="va">tcid</span>, <span class="va">wave</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">type_convert</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
<li>
<p>Update column names of merged data according to the list of PCA component files.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">oddballDataClean</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tcid"</span>, <span class="st">"wave"</span>, <span class="va">componentNames</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
<li>
<p>Save composite data to desired location.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">oddballDataClean</span>, file <span class="op">=</span> <span class="st">"Z:/Shared Server/Study Folder/Data/REDCap/Composites/erpOddball.csv"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
</ol>
</li>
</ol></section><section id="visualizations-in-r" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Visualizations in R</h1>
<section id="r-code-for-grand-average-waveform-plot" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="r-code-for-grand-average-waveform-plot">
<span class="header-section-number">4.1</span> R Code for Grand Average Waveform Plot</h2>
<ol type="1">
<li>
<p>Read in the grand average waveform data exported from EP Toolkit.</p>
<ul>
<li>We currently process the conditions within a given task separately, so each condition should have its own grand average file.</li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">obTgt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"V:/SRS-ERP-Oddball/Hard/All/4 - EPT Averages/2024-11-05/gave/ob_tgt_gav.txt"</span><span class="op">)</span></span>
<span><span class="va">obFrq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"V:/SRS-ERP-Oddball/Hard/All/4 - EPT Averages/2024-11-05/gave/ob_frq_gav.txt"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
<li>
<p>Create a subset of data that only includes those electrodes that are part of the clusters identified in EP Toolkit.</p>
<ul>
<li>The grand average data does not have row or column labels, but the columns represent the EEG net channels in numerical order (1-129). We can therefore use their column index values to select the desired electrodes; so, the list containing the channel numbers should include ONLY numbers. The code that selects these channels out of the full dataset will rely on numerical input.</li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Set electrode clusters</span></span>
<span><span class="va">obElectrodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">58</span>, <span class="fl">59</span>, <span class="fl">64</span>, <span class="fl">65</span>, <span class="fl">66</span>, <span class="fl">67</span>, <span class="fl">69</span>, <span class="fl">70</span>, <span class="fl">71</span>, <span class="fl">72</span>, <span class="fl">73</span>, <span class="fl">74</span>, <span class="fl">75</span>, <span class="fl">76</span>, <span class="fl">77</span>, <span class="fl">81</span>, <span class="fl">82</span>, <span class="fl">83</span>, <span class="fl">84</span>, <span class="fl">89</span>, <span class="fl">80</span>, <span class="fl">91</span>, <span class="fl">95</span>, <span class="fl">96</span>, <span class="fl">101</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Subset to desired electrodes</span></span>
<span><span class="va">obTgt_sub</span> <span class="op">&lt;-</span> <span class="va">obTgt</span><span class="op">[</span>, <span class="va">obElectrodes</span><span class="op">]</span></span>
<span><span class="va">obFrq_sub</span> <span class="op">&lt;-</span> <span class="va">obFrq</span><span class="op">[</span>, <span class="va">obElectrodes</span><span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
<li>
<p>Compute averages and create labels for conditions</p>
<ul>
<li>Once the data have been subsetted down to include only the electrode channels of interest, all that remains is to compute the average amplitude across all of those channels</li>
<li>Adding a condition label will allow us to combine the two condition-specific datasets into one that can be used for visualizations
<ul>
<li>For ease of plotting, name the conditions the way that you would like them to appear on the figure (i.e., “Target” instead of “tgt”)</li>
</ul>
</li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute averages </span></span>
<span><span class="va">obTgt_sub</span><span class="op">$</span><span class="va">amplitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">obTgt_sub</span><span class="op">)</span></span>
<span><span class="va">obFrq_sub</span><span class="op">$</span><span class="va">amplitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">obFrq_sub</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove raw values and add condition labels</span></span>
<span><span class="va">obTgt_amps</span> <span class="op">&lt;-</span> <span class="va">obTgt_sub</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">amplitude</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>condition <span class="op">=</span> <span class="st">"Target"</span><span class="op">)</span></span>
<span><span class="va">obFrq_amps</span> <span class="op">&lt;-</span> <span class="va">obFrq_sub</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">amplitude</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>condition <span class="op">=</span> <span class="st">"Frequent"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
<li>
<p>Add timing-related information to the data</p>
<ul>
<li>EP Toolkit exports ERP data without timestamps, but arranges it in order of timing</li>
<li>We can create a template with the appropriate timestamps and append this column to the amplitude data</li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create template</span></span>
<span><span class="va">erpTemplate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="op">-</span><span class="fl">199</span><span class="op">:</span><span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merge template with amplitude data</span></span>
<span><span class="va">obTgtTimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">erpTemplate</span>, <span class="va">obTgt_amps</span><span class="op">)</span></span>
<span><span class="va">obFrqTimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">erpTemplate</span>, <span class="va">obFrq_amps</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
<li>
<p>Combine all conditions into a single data object to be used for plotting</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">oddball</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">obTgtTimes</span>, <span class="va">obFrqTimes</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>           <span class="fu">select</span><span class="op">(</span><span class="va">time</span>, <span class="va">condition</span>, <span class="va">amplitude</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>           <span class="fu">arrange</span><span class="op">(</span><span class="va">time</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
<li>
<p>Generate the waveform figures</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">oddball</span>,</span>
<span>  <span class="fu">aes</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">amplitude</span>,</span>
<span>    group <span class="op">=</span> <span class="va">condition</span>,</span>
<span>    color <span class="op">=</span> <span class="va">condition</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Time Relative to Stimulus Onset (ms)"</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">200</span>, to <span class="op">=</span> <span class="fl">1000</span>, by <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Voltage (microvolts)"</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>, to <span class="op">=</span> <span class="fl">15</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_viridis_d</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.7</span>, <span class="fl">.9</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</li>
</ol></section></section><section id="appendix" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Appendix</h1>
<section id="troubleshooting" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="troubleshooting">
<span class="header-section-number">5.1</span> Troubleshooting</h2>
<ol type="1">
<li>Running out of space on EP Toolkit? You can navigate to your folder (maybe under Documents/MATLAB/EPwork) and delete everything except for EPprefs to refresh your workspace. NOTE: This will delete everything stored in EP Toolkit, so remember to back up files that you need to save.</li>
<li>If you get an error or a warning from Git when trying to commit and/or push ERP files up to the repo, you may need to initialize Git LFS. The instructions for initializing Git LFS can be found <a href="./git.html#sec-gitLfs">here</a>.
<ul>
<li>The filetypes that commonly cause such errors in our current ERP processing pipeline are:
<ul>
<li>
<code>.txt</code> files</li>
<li>
<code>.ept</code> files</li>
<li>
<code>.set</code> files</li>
</ul>
</li>
</ul>
</li>
</ol></section><section id="to-do" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="to-do">
<span class="header-section-number">5.2</span> To-do</h2>
<ul>
<li>Better describe the missingness for files
<ul>
<li>We need a systematic way to identify new ways to process the missingness</li>
<li>Find a way to best describe and report the ways of missingness</li>
</ul>
</li>
<li>Go through the maxmem edits on the clean_rawData question. We want a standardized value on the machines</li>
<li>Look at the warning messages for the automatic script updates
<ul>
<li>automatic cleaning of files problems</li>
</ul>
</li>
<li>Integrate ERPLAB with our existing EEGLab Functions including:
<ul>
<li>Adding an event list:
<ul>
<li>Currently, some code for this is updated in the script on the lab drive</li>
<li>Documentation is <a href="https://github.com/lucklab/erplab/wiki/Creating-an-EventList:-ERPLAB-Functions:-Tutorial">here</a>
</li>
</ul>
</li>
<li>Figure out how to average epochs and export to the EP Toolkit</li>
</ul>
</li>
<li>Evaluate the semi-automated pipelines from:
<ul>
<li><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/psyp.13580">Debnath et al.&nbsp;(2020)</a></li>
<li><a href="https://www.sciencedirect.com/science/article/pii/S0165027020303848">Desjardins et al.&nbsp;(2021)</a></li>
<li><a href="https://www.sciencedirect.com/science/article/pii/S1878929322000214">Flo et al.&nbsp;(2022)</a></li>
<li><a href="https://www.frontiersin.org/articles/10.3389/fnins.2018.00097/full">Gabar-Durnam et al.&nbsp;(2018)</a></li>
<li><a href="https://www.sciencedirect.com/science/article/pii/S1878929321001146">Haresign et al.&nbsp;(2021)</a></li>
<li><a href="https://www.sciencedirect.com/science/article/pii/S1878929322000123">Kumaravel et al.&nbsp;(2022)</a></li>
</ul>
</li>
</ul></section><section id="eeglab" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="eeglab">
<span class="header-section-number">5.3</span> EEGLAB</h2>
<section id="eeglab-processing-steps" class="level3" data-number="5.3.1"><h3 data-number="5.3.1" class="anchored" data-anchor-id="eeglab-processing-steps">
<span class="header-section-number">5.3.1</span> EEGLab Processing Steps</h3>
<p><a href="https://eeglab.org/tutorials/" class="uri">https://eeglab.org/tutorials/</a></p>
<ol type="1">
<li>Filtering</li>
<li>Average Referencing</li>
<li>Artifact Rejection
<ol type="1">
<li>Automated artifact rejection (save intermediate file)</li>
<li>Manual selection of bad channels</li>
<li>Manual selection of bad time periods (save intermediate file)</li>
<li>Removal of manually selected bad channels</li>
<li>Removal of manually selected bad time periods (save intermediate file)</li>
<li>
<a href="#sec-ica">Independent Component Analysis</a> (ICA)
<ol type="1">
<li>Run ICA</li>
<li>Automated removal of bad ICA components</li>
<li>Re-run ICA (save intermediate file)</li>
<li>Manual selection of bad ICA components (save intermediate file)</li>
<li>Removal of manually selected bad ICA components</li>
</ol>
</li>
</ol>
</li>
<li>Interpolation of Bad Channels</li>
<li>Average Referencing</li>
<li>Segmentation</li>
<li>Baseline Correction (save final file)</li>
</ol></section><section id="install-plugins" class="level3" data-number="5.3.2"><h3 data-number="5.3.2" class="anchored" data-anchor-id="install-plugins">
<span class="header-section-number">5.3.2</span> Install Plugins</h3>
<p>MFFMatlabIO plugin</p>
</section><section id="import-data" class="level3" data-number="5.3.3"><h3 data-number="5.3.3" class="anchored" data-anchor-id="import-data">
<span class="header-section-number">5.3.3</span> Import Data</h3>
<p>File → Import Data → Using EEGLAB functions and plugins → Import Magstim/EGI .mff file</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb56"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_mffimport</span>({<span class="ss">'\\\\lc-rs-store24.hpc.uiowa.edu\\lss_itpetersen\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\0-Raw Data (mff)\\1613_90_oddball.mff'</span>}<span class="op">,</span>{<span class="ss">'code'</span>}<span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Select <code>.mff</code> file(s)</p>
<p>Event type field (may select multiple): <code>code</code></p>
</section><section id="filter-data" class="level3" data-number="5.3.4"><h3 data-number="5.3.4" class="anchored" data-anchor-id="filter-data">
<span class="header-section-number">5.3.4</span> Filter Data</h3>
<p>Filter → Basic FIR Filter</p>
<p>0.1 – 30 Hz</p>
<p>save as new name</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_eegfiltnew</span>(<span class="va">EEG</span><span class="op">,</span> <span class="ss">'locutoff'</span><span class="op">,</span><span class="fl">0.1</span><span class="op">,</span><span class="ss">'hicutoff'</span><span class="op">,</span><span class="fl">30</span><span class="op">,</span><span class="ss">'plotfreqz'</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section><section id="average-referencing" class="level3" data-number="5.3.5"><h3 data-number="5.3.5" class="anchored" data-anchor-id="average-referencing">
<span class="header-section-number">5.3.5</span> Average Referencing</h3>
<p>Tools → Re-reference the data → Compute average reference</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb58"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_reref</span>( <span class="va">EEG</span><span class="op">,</span> [])<span class="op">;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'1613_90_oddball_fil_ref'</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section><section id="artifact-rejection" class="level3" data-number="5.3.6"><h3 data-number="5.3.6" class="anchored" data-anchor-id="artifact-rejection">
<span class="header-section-number">5.3.6</span> Artifact Rejection</h3>
<section id="automated-artifact-rejection" class="level4" data-number="5.3.6.1"><h4 data-number="5.3.6.1" class="anchored" data-anchor-id="automated-artifact-rejection">
<span class="header-section-number">5.3.6.1</span> Automated Artifact Rejection</h4>
<p>Tools → Reject data using Clean Rawdata and ASR</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_clean_rawdata</span>(<span class="va">EEG</span><span class="op">,</span> <span class="ss">'FlatlineCriterion'</span><span class="op">,</span><span class="fl">5</span><span class="op">,</span><span class="ss">'ChannelCriterion'</span><span class="op">,</span><span class="fl">0.8</span><span class="op">,</span><span class="ss">'LineNoiseCriterion'</span><span class="op">,</span><span class="fl">4</span><span class="op">,</span><span class="ss">'Highpass'</span><span class="op">,</span><span class="ss">'off'</span><span class="op">,</span><span class="ss">'BurstCriterion'</span><span class="op">,</span><span class="fl">20</span><span class="op">,</span><span class="ss">'WindowCriterion'</span><span class="op">,</span><span class="fl">0.25</span><span class="op">,</span><span class="ss">'BurstRejection'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'Distance'</span><span class="op">,</span><span class="ss">'Euclidian'</span><span class="op">,</span><span class="ss">'WindowCriterionTolerances'</span><span class="op">,</span>[<span class="op">-</span><span class="va">Inf</span> <span class="fl">7</span>] )<span class="op">;</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Currently, we run into a bug that yields the following error:</p>
<pre><code>Not enough memory, This is not a bug (Error occurred in function asr_process() at line 132)</code></pre>
<p>As a workaround, type the following code in MATLAB to edit the function:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb61"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="va">edit</span> <span class="va">clean_artifacts</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then, change the number in the following line to a larger number (e.g., 256) and click save:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb62"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>{<span class="ss">'max_mem'</span><span class="op">,</span><span class="ss">'MaxMem'</span>}<span class="op">,</span> <span class="fl">256</span><span class="op">,</span> <span class="op">...</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section><section id="selection-of-bad-channels" class="level4" data-number="5.3.6.2"><h4 data-number="5.3.6.2" class="anchored" data-anchor-id="selection-of-bad-channels">
<span class="header-section-number">5.3.6.2</span> Selection of Bad Channels</h4>
<p>View data to identify bad channels to reject.</p>
<p>Edit → Select data</p>
<p>Specify channels to reject</p>
<p>Specify “on -&gt; remove these”</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb63"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_select</span>( <span class="va">EEG</span><span class="op">,</span> <span class="ss">'nochannel'</span><span class="op">,</span>{<span class="ss">'E44'</span><span class="op">,</span><span class="ss">'E56'</span><span class="op">,</span><span class="ss">'E57'</span><span class="op">,</span><span class="ss">'E113'</span>})<span class="op">;</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'1613_90_oddball_fil_ref_chn'</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section><section id="selection-of-bad-time-periods" class="level4" data-number="5.3.6.3"><h4 data-number="5.3.6.3" class="anchored" data-anchor-id="selection-of-bad-time-periods">
<span class="header-section-number">5.3.6.3</span> Selection of Bad Time Periods</h4>
<p>Plot → Channel data (scroll)</p>
<p>Change voltage scale to 50</p>
<p>Settings → Time range to display</p>
<p>Change to 10 seconds</p>
<p>Settings → Number of channels to display</p>
<p>Change to number of channels to view at one time (e.g., 64)</p>
<p>To erase a selected portion of the data, first drag the mouse (holding down the left mouse button) horizontally across the time region of interest to mark it for rejection. To deselect a portion of the data, simply click on the selected region.</p>
<p>After marking some portions of the data for rejection, press REJECT and a new data set will be created with the rejected data omitted. A new dataset will be created with the marked regions removed. Your goal is to reject non-stereotypic artifacts. Do not reject blinks/saccades, because <a href="#sec-ica">independent component analysis</a> will remove those.</p>
<p>Clicking “Stack” stacks all electrodes on top of each other to more easily identify noisy data.</p>
<p>Click “REJECT” to remove the bad time periods from the data file.</p>
</section><section id="sec-ica" class="level4" data-number="5.3.6.4"><h4 data-number="5.3.6.4" class="anchored" data-anchor-id="sec-ica">
<span class="header-section-number">5.3.6.4</span> Independent Component Analysis</h4>
<p><a href="https://eeglab.org/tutorials/06_RejectArtifacts/RunICA.html" class="uri">https://eeglab.org/tutorials/06_RejectArtifacts/RunICA.html</a> (archived at <a href="https://perma.cc/AEU9-GB3B" class="uri">https://perma.cc/AEU9-GB3B</a>)</p>
<p><a href="https://socialsci.libretexts.org/Bookshelves/Psychology/Book%3A_Applied_Event-Related_Potential_Data_Analysis_(Luck)/14%3A_Appendix_3%3A_Example_Processing_Pipeline" class="uri">https://socialsci.libretexts.org/Bookshelves/Psychology/Book%3A_Applied_Event-Related_Potential_Data_Analysis_(Luck)/14%3A_Appendix_3%3A_Example_Processing_Pipeline</a> (archived at <a href="https://perma.cc/9QYQ-BNFE" class="uri">https://perma.cc/9QYQ-BNFE</a>)</p>
<p>The component order returned by <code>runica.m</code> is in decreasing order of the EEG variance accounted for by each component.</p>
<p>Tools → Decompose data by ICA</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb64"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_runica</span>(<span class="va">EEG</span><span class="op">,</span> <span class="ss">'icatype'</span><span class="op">,</span> <span class="ss">'runica'</span><span class="op">,</span> <span class="ss">'extended'</span><span class="op">,</span><span class="fl">1</span><span class="op">,</span><span class="ss">'interrupt'</span><span class="op">,</span><span class="ss">'on'</span>)<span class="op">;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span>] <span class="op">=</span> <span class="va">eeg_store</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">CURRENTSET</span>)<span class="op">;</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Plot → Component maps → 2D</p>
<p>Visually identify independent components to remove</p>
<p>Tools → Inspect/label components by map</p>
<p>Example ICA Artifact Components</p>
<p><img src="images/ICA_EyeBlink.png" class="img-fluid" alt="ICA Eye Blink Artifact"><img src="images/ICA_LateralEyeMovement.png" class="img-fluid" alt="ICA Lateral Eye Movement Artifact"><img src="images/ICA_MuscleArtifact.png" class="img-fluid" alt="ICA Muscle Artifact"><img src="images/ICA_CardiacArtifact.png" class="img-fluid" alt="ICA Cardiac Artifact"><img src="images/ICA_BadChannel.png" class="img-fluid" alt="ICA Bad Channel"></p>
<p>Example ICA Brain Components <img src="images/ICA_BrainActivityEx1.png" class="img-fluid" alt="ICA Brain Activity Example 1"><img src="images/ICA_BrainActivityEx2.png" class="img-fluid" alt="ICA Brain Activity Example 2"><img src="images/ICA_BrainActivityEx3.png" class="img-fluid" alt="ICA Brain Activity Example 3"></p>
<p>Overview of ICA Components <img src="images/ICA_Overview.png" class="img-fluid" alt="ICA Overview"></p>
<p>Toggle the “Accept” button to reject an independent component, press “OK” to specify it for rejection</p>
<p>Automated detection of artifactual ICA components:</p>
<p><a href="https://eeglab.org/tutorials/06_RejectArtifacts/RunICA.html#automated-detection-of-artifactual-ica-components" class="uri">https://eeglab.org/tutorials/06_RejectArtifacts/RunICA.html#automated-detection-of-artifactual-ica-components</a> (archived at <a href="https://perma.cc/5RQ7-9WBT" class="uri">https://perma.cc/5RQ7-9WBT</a>)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb65"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_iclabel</span>(<span class="va">EEG</span><span class="op">,</span> <span class="ss">'default'</span>)<span class="op">;</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span>] <span class="op">=</span> <span class="va">eeg_store</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">CURRENTSET</span>)<span class="op">;</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_icflag</span>(<span class="va">EEG</span><span class="op">,</span> [<span class="va">NaN</span> <span class="va">NaN</span><span class="op">;</span><span class="fl">0.9</span> <span class="fl">1</span><span class="op">;</span><span class="fl">0.9</span> <span class="fl">1</span><span class="op">;</span><span class="va">NaN</span> <span class="va">NaN</span><span class="op">;</span><span class="va">NaN</span> <span class="va">NaN</span><span class="op">;</span><span class="va">NaN</span> <span class="va">NaN</span><span class="op">;</span><span class="va">NaN</span> <span class="va">NaN</span>])<span class="op">;</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span>] <span class="op">=</span> <span class="va">eeg_store</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">CURRENTSET</span>)<span class="op">;</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>There are six categories of components: Brain, Muscle, Eye, Heart, Line Noise, Channel Noise, and Other</p>
<p>Our goal is to keep the brain components and to remove everything else (i.e., artifacts).</p>
<p>Tools → Classify components using ICLabel → Label components</p>
<p>Tools → Classify components using ICLabel → Flag components as artifacts</p>
<p>Substracting rejected ICA components:</p>
<p><a href="https://eeglab.org/tutorials/06_RejectArtifacts/RunICA.html#subtracting-ica-components-from-data" class="uri">https://eeglab.org/tutorials/06_RejectArtifacts/RunICA.html#subtracting-ica-components-from-data</a> (archived at <a href="https://perma.cc/HVH4-Z4SA" class="uri">https://perma.cc/HVH4-Z4SA</a>)</p>
<p>Tools → Remove components</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb66"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_subcomp</span>( <span class="va">EEG</span><span class="op">,</span> [<span class="fl">1</span>    <span class="fl">2</span>    <span class="fl">6</span>    <span class="fl">7</span>   <span class="fl">10</span>   <span class="fl">13</span>   <span class="fl">21</span>   <span class="fl">24</span>   <span class="fl">26</span>   <span class="fl">31</span>   <span class="fl">32</span>   <span class="fl">33</span>   <span class="fl">36</span>   <span class="fl">43</span>   <span class="fl">44</span>   <span class="fl">51</span>   <span class="fl">54</span>   <span class="fl">55</span>   <span class="fl">59</span>   <span class="fl">61</span>   <span class="fl">67</span>   <span class="fl">68</span>   <span class="fl">74</span>   <span class="fl">83</span>   <span class="fl">90</span>   <span class="fl">91</span>   <span class="fl">93</span>   <span class="fl">99</span>  <span class="fl">103</span>  <span class="fl">112</span>  <span class="fl">113</span>  <span class="fl">116</span>  <span class="fl">118</span>  <span class="fl">121</span>]<span class="op">,</span> <span class="fl">0</span>)<span class="op">;</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">6</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section></section><section id="interpolate-bad-channels" class="level3" data-number="5.3.7"><h3 data-number="5.3.7" class="anchored" data-anchor-id="interpolate-bad-channels">
<span class="header-section-number">5.3.7</span> Interpolate Bad Channels</h3>
<p><a href="https://sccn.ucsd.edu/pipermail/eeglablist/2016/011199.html" class="uri">https://sccn.ucsd.edu/pipermail/eeglablist/2016/011199.html</a> (archived at <a href="https://perma.cc/97NH-8LAR" class="uri">https://perma.cc/97NH-8LAR</a>)</p>
<p>To interpolate channels you would load up one file that has only the good channels, then load up a second file that has the full channel list, and then run the channel interpolation function from the eeglab gui.</p>
<p>Tools → Interpolate Electrodes → Use all channels (or specific channels?) of other dataset</p>
<p>Using all channels of other dataset:</p>
<p><strong>Important Note:</strong> Interpolating files will re-reference the data. Average reference the data after interpolating channels.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb67"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_interp</span>(<span class="va">EEG</span><span class="op">,</span> <span class="va">ALLEEG</span>(<span class="fl">3</span>).<span class="va">chanlocs</span><span class="op">,</span> <span class="ss">'spherical'</span>)<span class="op">;</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">4</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Using specific channels of other dataset:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb68"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_interp</span>(<span class="va">EEG</span><span class="op">,</span> <span class="va">ALLEEG</span>(<span class="fl">3</span>).<span class="va">chanlocs</span>([<span class="fl">44</span>   <span class="fl">56</span>   <span class="fl">57</span>  <span class="fl">113</span>])<span class="op">,</span> <span class="ss">'spherical'</span>)<span class="op">;</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Removed channels:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb69"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_interp</span>(<span class="va">EEG</span><span class="op">,</span> <span class="va">EEG</span>.<span class="va">chaninfo</span>.<span class="va">nodatchans</span>([<span class="fl">44</span>  <span class="fl">56</span>  <span class="fl">57</span>  <span class="fl">113</span>])<span class="op">,</span> <span class="ss">'spherical'</span>)<span class="op">;</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">3</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Data channels:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb70"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_interp</span>(<span class="va">EEG</span><span class="op">,</span> [<span class="fl">44</span>  <span class="fl">56</span>  <span class="fl">57</span>  <span class="fl">113</span>]<span class="op">,</span> <span class="ss">'spherical'</span>)<span class="op">;</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section><section id="average-referencing-1" class="level3" data-number="5.3.8"><h3 data-number="5.3.8" class="anchored" data-anchor-id="average-referencing-1">
<span class="header-section-number">5.3.8</span> Average Referencing</h3>
<p>Tools → Re-reference the data → Compute average reference</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb71"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_reref</span>( <span class="va">EEG</span><span class="op">,</span> [])<span class="op">;</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'1613_90_oddball_fil_ref'</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section><section id="segmentation" class="level3" data-number="5.3.9"><h3 data-number="5.3.9" class="anchored" data-anchor-id="segmentation">
<span class="header-section-number">5.3.9</span> Segmentation</h3>
<p>Tools → Extract Epochs</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb72"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_epoch</span>( <span class="va">EEG</span><span class="op">,</span> {  <span class="ss">'frq+'</span>  <span class="ss">'tgt+'</span>  }<span class="op">,</span> [<span class="op">-</span><span class="fl">0.2</span>           <span class="fl">1</span>]<span class="op">,</span> <span class="ss">'newname'</span><span class="op">,</span> <span class="ss">'1613_90_oddball_fil_ref epochs'</span><span class="op">,</span> <span class="ss">'epochinfo'</span><span class="op">,</span> <span class="ss">'yes'</span>)<span class="op">;</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section><section id="baseline-correction" class="level3" data-number="5.3.10"><h3 data-number="5.3.10" class="anchored" data-anchor-id="baseline-correction">
<span class="header-section-number">5.3.10</span> Baseline Correction</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb73"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_rmbase</span>( <span class="va">EEG</span><span class="op">,</span> [<span class="op">-</span><span class="fl">200</span> <span class="fl">0</span>] <span class="op">,</span>[])<span class="op">;</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section><section id="automatic-script-example" class="level3" data-number="5.3.11"><h3 data-number="5.3.11" class="anchored" data-anchor-id="automatic-script-example">
<span class="header-section-number">5.3.11</span> Automatic Script example</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb74"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">% Starting EEG Lab </span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span> <span class="va">ALLCOM</span>] <span class="op">=</span> <span class="va">eeglab</span><span class="op">;</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co">%% Helpful documentation is located here</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co">% https://eeglab.org/tutorials/11_Scripting/Using_EEGLAB_history.html (archived at https://perma.cc/Y687-5GKE)</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="co">% https://eeglab.org/tutorials/ConceptsGuide/Data_Structures.html (archived at https://perma.cc/5F39-5S32)</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="co">%Loading in the Dataset</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_mffimport</span>({<span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\0-Raw Data (mff)\\1613_90_oddball.mff'</span>}<span class="op">,</span>{<span class="ss">'code'</span>}<span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span>.<span class="va">setname</span><span class="op">=</span><span class="ss">'raw'</span><span class="op">;</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="co">%Storing the current dataset</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span>] <span class="op">=</span> <span class="va">eeg_store</span>( <span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="co">% refreshing the graphical interface</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a><span class="co">%Filter the data</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_eegfiltnew</span>(<span class="va">ALLEEG</span>(<span class="fl">1</span>)<span class="op">,</span> <span class="ss">'locutoff'</span><span class="op">,</span><span class="fl">0.1</span><span class="op">,</span><span class="ss">'hicutoff'</span><span class="op">,</span><span class="fl">30</span><span class="op">,</span><span class="ss">'plotfreqz'</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a><span class="co">%Save the Filtered dataset </span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a><span class="co">%ALLEEG EEG CURRENTSET seems to just be a name for all of the current data</span></span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a><span class="co">%sets </span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a><span class="co">%pop_newset seems to save the dataset in both memory and in the toolkit</span></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">2</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'fil'</span><span class="op">,</span><span class="ss">'savenew'</span><span class="op">,</span><span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\1-Filtering (fil)\\tcid_wave.set'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a><span class="co">% Average referencing</span></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a><span class="co">%EEG = eeg_checkset( EEG );</span></span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_reref</span>( <span class="va">ALLEEG</span>(<span class="fl">2</span>)<span class="op">,</span> [])<span class="op">;</span></span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">3</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'Avg Ref'</span><span class="op">,</span><span class="ss">'savenew'</span><span class="op">,</span><span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\9-Average Reference (ref)\\tcid_wave_avg.set'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span></span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a><span class="co">% Rejecting the artifacts</span></span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a><span class="co">% testing bumping the </span></span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_clean_rawdata</span>(<span class="va">ALLEEG</span>(<span class="fl">3</span>)<span class="op">,</span> <span class="ss">'FlatlineCriterion'</span><span class="op">,</span><span class="fl">5</span><span class="op">,</span><span class="ss">'ChannelCriterion'</span><span class="op">,</span><span class="fl">0.8</span><span class="op">,</span><span class="ss">'LineNoiseCriterion'</span><span class="op">,</span><span class="fl">4</span><span class="op">,</span><span class="ss">'Highpass'</span><span class="op">,</span><span class="ss">'off'</span><span class="op">,</span><span class="ss">'BurstCriterion'</span><span class="op">,</span><span class="fl">30</span><span class="op">,</span><span class="ss">'WindowCriterion'</span><span class="op">,</span><span class="fl">0.25</span><span class="op">,</span><span class="ss">'BurstRejection'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'Distance'</span><span class="op">,</span><span class="ss">'Euclidian'</span><span class="op">,</span><span class="ss">'WindowCriterionTolerances'</span><span class="op">,</span>[<span class="op">-</span><span class="va">Inf</span> <span class="fl">7</span>] )<span class="op">;</span></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a><span class="co">%Saving cleaned dataset</span></span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">4</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'clean data'</span><span class="op">,</span><span class="ss">'savenew'</span><span class="op">,</span><span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\10-Clean Artificats (clean)\\tcid_wave_clean.set'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a><span class="co">% Placeholder to manually remove bad channels</span></span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a><span class="co">% ICA components</span></span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_runica</span>(<span class="va">ALLEEG</span>(<span class="fl">4</span>)<span class="op">,</span> <span class="ss">'icatype'</span><span class="op">,</span> <span class="ss">'runica'</span><span class="op">,</span> <span class="ss">'extended'</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'interrupt'</span><span class="op">,</span><span class="ss">'on'</span>)<span class="op">;</span></span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">5</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'ICA test'</span><span class="op">,</span><span class="ss">'savenew'</span><span class="op">,</span><span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\11-ICA\\tcid_wave_ICA.set'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a><span class="co">%Manually reject ICA components</span></span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_subcomp</span>( <span class="va">EEG</span><span class="op">,</span> [<span class="fl">1</span>    <span class="fl">2</span>    <span class="fl">6</span>    <span class="fl">7</span>   <span class="fl">10</span>   <span class="fl">13</span>   <span class="fl">21</span>   <span class="fl">24</span>   <span class="fl">26</span>   <span class="fl">31</span>   <span class="fl">32</span>   <span class="fl">33</span>   <span class="fl">36</span>   <span class="fl">43</span>   <span class="fl">44</span>   <span class="fl">51</span>   <span class="fl">54</span>   <span class="fl">55</span>   <span class="fl">59</span>   <span class="fl">61</span>   <span class="fl">67</span>   <span class="fl">68</span>   <span class="fl">74</span>   <span class="fl">83</span>   <span class="fl">90</span>   <span class="fl">91</span>   <span class="fl">93</span>   <span class="fl">99</span>  <span class="fl">103</span>  <span class="fl">112</span>  <span class="fl">113</span>  <span class="fl">116</span>  <span class="fl">118</span>  <span class="fl">121</span>]<span class="op">,</span> <span class="fl">0</span>)<span class="op">;</span></span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">6</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a><span class="co">% Place holder to remind to manually remove the channels that we would</span></span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a><span class="co">% like to reject</span></span>
<span id="cb74-54"><a href="#cb74-54" aria-hidden="true" tabindex="-1"></a><span class="co">% taking the EEG channel lock of the first (raw) dataset</span></span>
<span id="cb74-55"><a href="#cb74-55" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_interp</span>(<span class="va">ALLEEG</span>(<span class="fl">5</span>)<span class="op">,</span> <span class="va">ALLEEG</span>(<span class="fl">1</span>).<span class="va">chanlocs</span><span class="op">,</span> <span class="ss">'spherical'</span>)<span class="op">;</span></span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">6</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'Interpolated'</span><span class="op">,</span><span class="ss">'savenew'</span><span class="op">,</span><span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\12-Interpolate\\tcid_wave_Interpolate.set'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb74-58"><a href="#cb74-58" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb74-59"><a href="#cb74-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-60"><a href="#cb74-60" aria-hidden="true" tabindex="-1"></a><span class="co">% Segmenting the Data</span></span>
<span id="cb74-61"><a href="#cb74-61" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb74-62"><a href="#cb74-62" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_epoch</span>( <span class="va">ALLEEG</span>(<span class="fl">6</span>)<span class="op">,</span> {  <span class="ss">'frq+'</span>  <span class="ss">'tgt+'</span>  }<span class="op">,</span> [<span class="op">-</span><span class="fl">0.2</span> <span class="fl">1</span>]<span class="op">,</span> <span class="ss">'newname'</span><span class="op">,</span> <span class="ss">'tcid_wave_segmented'</span><span class="op">,</span> <span class="ss">'epochinfo'</span><span class="op">,</span> <span class="ss">'yes'</span>)<span class="op">;</span></span>
<span id="cb74-63"><a href="#cb74-63" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">7</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'Segmented'</span><span class="op">,</span><span class="ss">'savenew'</span><span class="op">,</span><span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\13-Segment\\tcid_wave_Segment.set'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb74-64"><a href="#cb74-64" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb74-65"><a href="#cb74-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-66"><a href="#cb74-66" aria-hidden="true" tabindex="-1"></a><span class="co">% Baseline Correcting the Data</span></span>
<span id="cb74-67"><a href="#cb74-67" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb74-68"><a href="#cb74-68" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_rmbase</span>( <span class="va">ALLEEG</span>(<span class="fl">7</span>)<span class="op">,</span> [<span class="op">-</span><span class="fl">200</span> <span class="fl">0</span>] <span class="op">,</span>[])<span class="op">;</span></span>
<span id="cb74-69"><a href="#cb74-69" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">8</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'Baseline Correct'</span><span class="op">,</span><span class="ss">'savenew'</span><span class="op">,</span><span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\14-Baseline-Correct\\tcid_wave_baseline-correct.set'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb74-70"><a href="#cb74-70" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section><section id="automatic-script-that-loops-files" class="level3" data-number="5.3.12"><h3 data-number="5.3.12" class="anchored" data-anchor-id="automatic-script-that-loops-files">
<span class="header-section-number">5.3.12</span> Automatic script that loops files</h3>
<section id="warning-messages-with-script" class="level4" data-number="5.3.12.1"><h4 data-number="5.3.12.1" class="anchored" data-anchor-id="warning-messages-with-script">
<span class="header-section-number">5.3.12.1</span> Warning messages with script</h4>
<p>Warning messages appeared when using the automatic cleaning of data. We may have to send a dataset to someone so they can check on it. Some documentation is found here:</p>
<ul>
<li>
<a href="https://sccn.ucsd.edu/pipermail/eeglablist/2021/016222.html" class="uri">https://sccn.ucsd.edu/pipermail/eeglablist/2021/016222.html</a> (archived at <a href="https://perma.cc/9SDG-NGXD" class="uri">https://perma.cc/9SDG-NGXD</a>)</li>
<li>
<a href="https://sccn.ucsd.edu/wiki/EEGLAB_bug1971" class="uri">https://sccn.ucsd.edu/wiki/EEGLAB_bug1971</a> (archived at <a href="https://perma.cc/H7PA-TPTZ" class="uri">https://perma.cc/H7PA-TPTZ</a>)</li>
</ul></section><section id="filtering-average-referencing-and-automatically-cleaning-the-data." class="level4" data-number="5.3.12.2"><h4 data-number="5.3.12.2" class="anchored" data-anchor-id="filtering-average-referencing-and-automatically-cleaning-the-data.">
<span class="header-section-number">5.3.12.2</span> Filtering, average referencing, and automatically cleaning the data.</h4>
<p>This script batch reads in files, filters them, average references, and automatically cleans them. After that, this script reads in the cleaned files for manually processing to remove bad time periods and bad channels</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb75"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">%10/20/22 Working script that reads everything into matlab</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co">%Location of Raw oddball files</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="va">rawOddballFiles</span> <span class="op">=</span> <span class="ss">'\\lc-rs-store24.hpc.uiowa.edu\lss_itpetersen\Lab\Studies\School Readiness Study\Data\LV2\ERP\Oddball\MATLAB\0-Raw\'</span><span class="op">;</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co">%Location of path to save cleaned files</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="va">cleanAutoPath</span> <span class="op">=</span> <span class="ss">'\\lc-rs-store24.hpc.uiowa.edu\lss_itpetersen\Lab\Studies\School Readiness Study\Data\LV2\ERP\Oddball\MATLAB\10-Clean Artificats (clean)\'</span><span class="op">;</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co">%all oddball files in the directory to be processed</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="va">filesInDirectory</span> <span class="op">=</span> <span class="va">dir</span>(<span class="va">fullfile</span>(<span class="va">rawOddballFiles</span><span class="op">,</span> <span class="ss">'*.mff'</span>))<span class="op">;</span> <span class="co">%Reading the files in the directory</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="co">%Listing the number of subjects for the number of times to loop</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="va">numberOfSubject</span> <span class="op">=</span> <span class="va">height</span>(<span class="va">filesInDirectory</span>)<span class="op">;</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="co">%Names of all the files in the directory</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="va">listOfSubjects</span><span class="op">=</span>{<span class="va">filesInDirectory</span>.<span class="va">name</span>}<span class="op">;</span> </span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="co">%splitting the filename up</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a><span class="va">filenameSplit</span> <span class="op">=</span> <span class="va">regexp</span>(<span class="va">listOfSubjects</span><span class="op">,</span> <span class="ss">'_'</span><span class="op">,</span> <span class="ss">'split'</span>)<span class="op">;</span>  </span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a><span class="va">id</span> <span class="op">=</span> <span class="va">cellfun</span>(<span class="op">@</span>(<span class="va">x</span>) <span class="va">x</span>{<span class="fl">1</span>}<span class="op">,</span><span class="va">filenameSplit</span><span class="op">,</span><span class="ss">'un'</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span>  <span class="co">%getting the id's</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="va">wave</span> <span class="op">=</span> <span class="va">cellfun</span>(<span class="op">@</span>(<span class="va">x</span>) <span class="va">x</span>{<span class="fl">2</span>}<span class="op">,</span><span class="va">filenameSplit</span><span class="op">,</span><span class="ss">'un'</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span> <span class="co">%getting the waves</span></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span> <span class="va">ALLCOM</span>] <span class="op">=</span> <span class="va">eeglab</span><span class="op">;</span></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">numberOfSubject</span></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">%%%% Importing Data</span></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>    <span class="va">path</span> <span class="op">=</span> [<span class="va">rawOddballFiles</span><span class="op">,</span><span class="va">filesInDirectory</span>(<span class="va">i</span>).<span class="va">name</span>]<span class="op">;</span></span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>    <span class="va">tcid</span> <span class="op">=</span> <span class="va">char</span>(<span class="va">strcat</span>(<span class="va">id</span>(<span class="va">i</span>)<span class="op">,</span><span class="ss">'_'</span><span class="op">,</span> <span class="va">wave</span>(<span class="va">i</span>)))<span class="op">;</span> <span class="co">%combining the TCID and wave</span></span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_mffimport</span>({<span class="va">path</span>}<span class="op">,</span>{<span class="ss">'code'</span>}<span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span></span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">% Saving the data in memory</span></span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a>   [<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">i</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span> <span class="va">tcid</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span></span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a>    <span class="co">% Filtering the data</span></span>
<span id="cb75-39"><a href="#cb75-39" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_eegfiltnew</span>(<span class="va">ALLEEG</span>(<span class="va">i</span>)<span class="op">,</span> <span class="ss">'locutoff'</span><span class="op">,</span><span class="fl">0.1</span><span class="op">,</span><span class="ss">'hicutoff'</span><span class="op">,</span><span class="fl">30</span><span class="op">,</span><span class="ss">'plotfreqz'</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb75-40"><a href="#cb75-40" aria-hidden="true" tabindex="-1"></a>    [<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">i</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span></span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">% Average Referencing</span></span>
<span id="cb75-43"><a href="#cb75-43" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_reref</span>( <span class="va">ALLEEG</span>(<span class="va">i</span>)<span class="op">,</span> [])<span class="op">;</span></span>
<span id="cb75-44"><a href="#cb75-44" aria-hidden="true" tabindex="-1"></a>    [<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">i</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span></span>
<span id="cb75-45"><a href="#cb75-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-46"><a href="#cb75-46" aria-hidden="true" tabindex="-1"></a>    <span class="co">% They strongly advise importing channel locations before using this</span></span>
<span id="cb75-47"><a href="#cb75-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">% function.</span></span>
<span id="cb75-48"><a href="#cb75-48" aria-hidden="true" tabindex="-1"></a>    <span class="co">%Cleaning the Data</span></span>
<span id="cb75-49"><a href="#cb75-49" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_clean_rawdata</span>(<span class="va">ALLEEG</span>(<span class="va">i</span>)<span class="op">,</span> <span class="ss">'FlatlineCriterion'</span><span class="op">,</span><span class="fl">5</span><span class="op">,</span><span class="ss">'ChannelCriterion'</span><span class="op">,</span><span class="fl">0.8</span><span class="op">,</span><span class="ss">'LineNoiseCriterion'</span><span class="op">,</span><span class="fl">4</span><span class="op">,</span><span class="ss">'Highpass'</span><span class="op">,</span><span class="ss">'off'</span><span class="op">,</span><span class="ss">'BurstCriterion'</span><span class="op">,</span><span class="fl">30</span><span class="op">,</span><span class="ss">'WindowCriterion'</span><span class="op">,</span><span class="fl">0.25</span><span class="op">,</span><span class="ss">'BurstRejection'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'Distance'</span><span class="op">,</span><span class="ss">'Euclidian'</span><span class="op">,</span><span class="ss">'WindowCriterionTolerances'</span><span class="op">,</span>[<span class="op">-</span><span class="va">Inf</span> <span class="fl">7</span>])<span class="op">;</span></span>
<span id="cb75-50"><a href="#cb75-50" aria-hidden="true" tabindex="-1"></a>    <span class="va">nameClean</span> <span class="op">=</span> [<span class="va">tcid</span><span class="op">,</span><span class="ss">'_autoClean.set'</span>]<span class="op">;</span></span>
<span id="cb75-51"><a href="#cb75-51" aria-hidden="true" tabindex="-1"></a>    <span class="va">savePathClean</span> <span class="op">=</span> [<span class="va">cleanAutoPath</span><span class="op">,</span><span class="va">nameClean</span>]<span class="op">;</span></span>
<span id="cb75-52"><a href="#cb75-52" aria-hidden="true" tabindex="-1"></a>    [<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">i</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span> <span class="va">nameClean</span><span class="op">,</span> <span class="ss">'savenew'</span><span class="op">,</span> <span class="va">savePathClean</span><span class="op">,</span> <span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span><span class="op">,</span> <span class="ss">'overwrite'</span><span class="op">,</span> <span class="ss">'on'</span>)<span class="op">;</span></span>
<span id="cb75-53"><a href="#cb75-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-54"><a href="#cb75-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-55"><a href="#cb75-55" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb75-56"><a href="#cb75-56" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">:</span></span>
<span id="cb75-57"><a href="#cb75-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-58"><a href="#cb75-58" aria-hidden="true" tabindex="-1"></a><span class="co">%% Reading in automatically cleaned datasets</span></span>
<span id="cb75-59"><a href="#cb75-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-60"><a href="#cb75-60" aria-hidden="true" tabindex="-1"></a><span class="co">%%%%%%%%%%%%%%</span></span>
<span id="cb75-61"><a href="#cb75-61" aria-hidden="true" tabindex="-1"></a><span class="co">% Clear Data becasue to overwrite anything in memory</span></span>
<span id="cb75-62"><a href="#cb75-62" aria-hidden="true" tabindex="-1"></a><span class="co">%%%%%%%%%%%%%%</span></span>
<span id="cb75-63"><a href="#cb75-63" aria-hidden="true" tabindex="-1"></a><span class="va">ALLEEG</span> <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb75-64"><a href="#cb75-64" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb75-65"><a href="#cb75-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-66"><a href="#cb75-66" aria-hidden="true" tabindex="-1"></a><span class="co">% Adding the path for cleaned files</span></span>
<span id="cb75-67"><a href="#cb75-67" aria-hidden="true" tabindex="-1"></a><span class="va">cleanAutoPath</span> <span class="op">=</span> <span class="ss">'\\lc-rs-store24.hpc.uiowa.edu\lss_itpetersen\Lab\Studies\School Readiness Study\Data\LV2\ERP\Oddball\MATLAB\10-Clean Artificats (clean)\'</span><span class="op">;</span></span>
<span id="cb75-68"><a href="#cb75-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-69"><a href="#cb75-69" aria-hidden="true" tabindex="-1"></a><span class="co">%Starting EEGLAB</span></span>
<span id="cb75-70"><a href="#cb75-70" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span> <span class="va">ALLCOM</span>] <span class="op">=</span> <span class="va">eeglab</span><span class="op">;</span></span>
<span id="cb75-71"><a href="#cb75-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-72"><a href="#cb75-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-73"><a href="#cb75-73" aria-hidden="true" tabindex="-1"></a><span class="co">%Location of cleaned oddball data</span></span>
<span id="cb75-74"><a href="#cb75-74" aria-hidden="true" tabindex="-1"></a><span class="va">filesInDirectoryClean</span> <span class="op">=</span> <span class="va">dir</span>(<span class="va">fullfile</span>(<span class="va">cleanAutoPath</span><span class="op">,</span> <span class="ss">'*.set'</span>))<span class="op">;</span> <span class="co">%Reading the files in the directory</span></span>
<span id="cb75-75"><a href="#cb75-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-76"><a href="#cb75-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-77"><a href="#cb75-77" aria-hidden="true" tabindex="-1"></a><span class="co">%Listing the number of subjects for the number of times to loop</span></span>
<span id="cb75-78"><a href="#cb75-78" aria-hidden="true" tabindex="-1"></a><span class="va">numberOfSubjectClean</span> <span class="op">=</span> <span class="va">height</span>(<span class="va">filesInDirectoryClean</span>)<span class="op">;</span></span>
<span id="cb75-79"><a href="#cb75-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-80"><a href="#cb75-80" aria-hidden="true" tabindex="-1"></a><span class="co">%Names of all the files in the directory</span></span>
<span id="cb75-81"><a href="#cb75-81" aria-hidden="true" tabindex="-1"></a><span class="va">listOfSubjectsClean</span> <span class="op">=</span> {<span class="va">filesInDirectoryClean</span>.<span class="va">name</span>}<span class="op">;</span> </span>
<span id="cb75-82"><a href="#cb75-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-83"><a href="#cb75-83" aria-hidden="true" tabindex="-1"></a><span class="co">%splitting the filename up</span></span>
<span id="cb75-84"><a href="#cb75-84" aria-hidden="true" tabindex="-1"></a><span class="va">filenameSplitClean</span> <span class="op">=</span> <span class="va">regexp</span>(<span class="va">listOfSubjectsClean</span><span class="op">,</span> <span class="ss">'_'</span><span class="op">,</span> <span class="ss">'split'</span>)<span class="op">;</span>  </span>
<span id="cb75-85"><a href="#cb75-85" aria-hidden="true" tabindex="-1"></a><span class="va">id</span> <span class="op">=</span> <span class="va">cellfun</span>(<span class="op">@</span>(<span class="va">x</span>) <span class="va">x</span>{<span class="fl">1</span>}<span class="op">,</span><span class="va">filenameSplitClean</span><span class="op">,</span><span class="ss">'un'</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span>  <span class="co">%getting the id's</span></span>
<span id="cb75-86"><a href="#cb75-86" aria-hidden="true" tabindex="-1"></a><span class="va">wave</span> <span class="op">=</span> <span class="va">cellfun</span>(<span class="op">@</span>(<span class="va">x</span>) <span class="va">x</span>{<span class="fl">2</span>}<span class="op">,</span><span class="va">filenameSplitClean</span><span class="op">,</span><span class="ss">'un'</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span> <span class="co">%getting the waves</span></span>
<span id="cb75-87"><a href="#cb75-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-88"><a href="#cb75-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-89"><a href="#cb75-89" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">numberOfSubjectClean</span></span>
<span id="cb75-90"><a href="#cb75-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-91"><a href="#cb75-91" aria-hidden="true" tabindex="-1"></a>    <span class="co">%%%% Importing Data</span></span>
<span id="cb75-92"><a href="#cb75-92" aria-hidden="true" tabindex="-1"></a>    <span class="va">tcidClean</span> <span class="op">=</span> <span class="va">char</span>(<span class="va">strcat</span>(<span class="va">id</span>(<span class="va">i</span>)<span class="op">,</span><span class="ss">'_'</span><span class="op">,</span> <span class="va">wave</span>(<span class="va">i</span>)<span class="op">,</span> <span class="ss">'_autoClean.set'</span>))<span class="op">;</span> <span class="co">%combining the TCID and wave to name the file</span></span>
<span id="cb75-93"><a href="#cb75-93" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_loadset</span>(<span class="ss">'filename'</span><span class="op">,</span> <span class="va">tcidClean</span><span class="op">,</span> <span class="ss">'filepath'</span><span class="op">,</span> <span class="va">cleanAutoPath</span>)<span class="op">;</span> </span>
<span id="cb75-94"><a href="#cb75-94" aria-hidden="true" tabindex="-1"></a>    [<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">i</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span> <span class="va">tcidClean</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span></span>
<span id="cb75-95"><a href="#cb75-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-96"><a href="#cb75-96" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb75-97"><a href="#cb75-97" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section></section><section id="removing-bad-time-periods-and-channels" class="level3" data-number="5.3.13"><h3 data-number="5.3.13" class="anchored" data-anchor-id="removing-bad-time-periods-and-channels">
<span class="header-section-number">5.3.13</span> Removing bad time periods and channels</h3>
<ol type="1">
<li>In the now open EEGLAB interface, select a dataset. Go to <code>Tools</code> &gt; <code>Inspect/reject data by eye</code>
</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/visual_reject_artifacts.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="visually reject artifacts"><img src="images/visual_reject_artifacts.png" class="img-fluid figure-img" alt="visually reject artifacts"></a></p>
<figcaption>visually reject artifacts</figcaption></figure>
</div>
<ol type="1">
<li>Go through the raw signal and manually reject bad time periods</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/reject_time_periods.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="visually reject artifacts"><img src="images/reject_time_periods.png" class="img-fluid figure-img" alt="visually reject artifacts"></a></p>
<figcaption>visually reject artifacts</figcaption></figure>
</div>
<ol type="1">
<li>Select <code>REJECT</code> and overwrite the file in memory
<ul>
<li>select <code>Overwrite it in memory (set=yes; unset=create a new dataset)</code>
</li>
</ul>
</li>
<li>Visually inspect the data and select any bad channels, and write them down</li>
<li>Next, manually reject the channels by selecting <code>Edit</code> then <code>Select Data</code>
</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/drop_channels.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="visually reject artifacts"><img src="images/drop_channels.png" class="img-fluid figure-img" alt="visually reject artifacts"></a></p>
<figcaption>visually reject artifacts</figcaption></figure>
</div>
<ol type="1">
<li>Manually enter the channels to be removed in the <code>Channel range</code> field and select the checkbox under <code>on-&gt;remove these</code> and select <code>Ok</code>
</li>
<li>Save the file as <code>tcid_wave_manualClean.set</code> in the following drive path
<ul>
<li><code>\\lc-rs-store24.hpc.uiowa.edu\lss_itpetersen\Lab\Studies\School Readiness Study\Data\LV2\ERP\Oddball\MATLAB\11-Manually Cleaned</code></li>
<li>This screenshot represents removing channels <code>23 56 57 97</code> <img src="images/remove_channels_specific.png" class="img-fluid" alt="visually reject artifacts">
</li>
</ul>
</li>
<li>Repeat step for each cleaned dataset</li>
</ol></section><section id="running-the-ica" class="level3" data-number="5.3.14"><h3 data-number="5.3.14" class="anchored" data-anchor-id="running-the-ica">
<span class="header-section-number">5.3.14</span> Running the ICA</h3>
<p>This script runs the ICA. We’ll want to think about how to automatically reject the components here. Once this runs, see the <a href="#sec-ica">ICA section</a> to reject components. Tools → Inspect/label components by map is how to reject components.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb76"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">% Running the ICA</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co">%% Reading in the manually cleaned datasets</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co">%%%%%%%%%%%%%%</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co">% Clear Data becasue to overwrite anything in memory</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co">%%%%%%%%%%%%%%</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="va">ALLEEG</span> <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="co">% Adding the path for cleaned files</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="va">manualCleanPath</span> <span class="op">=</span> <span class="ss">'\\lc-rs-store24.hpc.uiowa.edu\lss_itpetersen\Lab\Studies\School Readiness Study\Data\LV2\ERP\Oddball\MATLAB\11-Manually Cleaned\'</span><span class="op">;</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a><span class="co">%Starting EEGLAB</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span> <span class="va">ALLCOM</span>] <span class="op">=</span> <span class="va">eeglab</span><span class="op">;</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a><span class="co">%Location of cleaned oddball data</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a><span class="va">filesInDirectoryManualClean</span> <span class="op">=</span> <span class="va">dir</span>(<span class="va">fullfile</span>(<span class="va">manualCleanPath</span><span class="op">,</span> <span class="ss">'*.set'</span>))<span class="op">;</span> <span class="co">%Reading the files in the directory</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a><span class="co">%Listing the number of subjects for the number of times to loop</span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a><span class="va">numberOfSubjectManualClean</span> <span class="op">=</span> <span class="va">height</span>(<span class="va">filesInDirectoryManualClean</span>)<span class="op">;</span></span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a><span class="co">%Names of all the files in the directory</span></span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a><span class="va">listOfSubjectsManualClean</span> <span class="op">=</span> {<span class="va">filesInDirectoryManualClean</span>.<span class="va">name</span>}<span class="op">;</span> </span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a><span class="co">%splitting the filename up</span></span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a><span class="va">filenameSplitManualClean</span> <span class="op">=</span> <span class="va">regexp</span>(<span class="va">listOfSubjectsManualClean</span><span class="op">,</span> <span class="ss">'_'</span><span class="op">,</span> <span class="ss">'split'</span>)<span class="op">;</span>  </span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a><span class="va">id</span> <span class="op">=</span> <span class="va">cellfun</span>(<span class="op">@</span>(<span class="va">x</span>) <span class="va">x</span>{<span class="fl">1</span>}<span class="op">,</span><span class="va">filenameSplitManualClean</span><span class="op">,</span><span class="ss">'un'</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span>  <span class="co">%getting the id's</span></span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a><span class="va">wave</span> <span class="op">=</span> <span class="va">cellfun</span>(<span class="op">@</span>(<span class="va">x</span>) <span class="va">x</span>{<span class="fl">2</span>}<span class="op">,</span><span class="va">filenameSplitManualClean</span><span class="op">,</span><span class="ss">'un'</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span> <span class="co">%getting the waves</span></span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">numberOfSubjectManualClean</span></span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">%%%% Importing Data</span></span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a>    <span class="va">tcidClean</span> <span class="op">=</span> <span class="va">char</span>(<span class="va">strcat</span>(<span class="va">id</span>(<span class="va">i</span>)<span class="op">,</span><span class="ss">'_'</span><span class="op">,</span> <span class="va">wave</span>(<span class="va">i</span>)<span class="op">,</span> <span class="ss">'_manualClean.set'</span>))<span class="op">;</span> <span class="co">%combining the TCID and wave to name the file</span></span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_loadset</span>(<span class="ss">'filename'</span><span class="op">,</span> <span class="va">tcidClean</span><span class="op">,</span> <span class="ss">'filepath'</span><span class="op">,</span> <span class="va">manualCleanPath</span>)<span class="op">;</span> </span>
<span id="cb76-39"><a href="#cb76-39" aria-hidden="true" tabindex="-1"></a>    [<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">i</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span> <span class="va">tcidClean</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span></span>
<span id="cb76-40"><a href="#cb76-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-41"><a href="#cb76-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">%%% Running the ICA</span></span>
<span id="cb76-42"><a href="#cb76-42" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb76-43"><a href="#cb76-43" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_runica</span>(<span class="va">EEG</span><span class="op">,</span> <span class="ss">'icatype'</span><span class="op">,</span> <span class="ss">'runica'</span><span class="op">,</span> <span class="ss">'extended'</span><span class="op">,</span><span class="fl">1</span><span class="op">,</span><span class="ss">'interrupt'</span><span class="op">,</span><span class="ss">'on'</span>)<span class="op">;</span></span>
<span id="cb76-44"><a href="#cb76-44" aria-hidden="true" tabindex="-1"></a>    [<span class="va">ALLEEG</span> <span class="va">EEG</span>] <span class="op">=</span> <span class="va">eeg_store</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">CURRENTSET</span>)<span class="op">;</span></span>
<span id="cb76-45"><a href="#cb76-45" aria-hidden="true" tabindex="-1"></a>    <span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb76-46"><a href="#cb76-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-47"><a href="#cb76-47" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb76-48"><a href="#cb76-48" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section></section><section id="netstation" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="netstation">
<span class="header-section-number">5.4</span> NetStation</h2>
<section id="processing-order" class="level3" data-number="5.4.1"><h3 data-number="5.4.1" class="anchored" data-anchor-id="processing-order">
<span class="header-section-number">5.4.1</span> Processing Order</h3>
<ol type="1">
<li>Filtering (fil)</li>
<li>Segmentation (seg)</li>
<li>Manually selected bad channels (seg)</li>
<li>Bad Channel Replacement (bcr)</li>
<li>Artifact Detection (art)</li>
<li>Bad Channel Replacement (bcr)</li>
<li>Artifact Detection (art)</li>
<li>Averaging (ave)</li>
<li>Average Reference (ref)</li>
<li>Baseline Correction (blc)</li>
<li>Grand-Averaging</li>
<li>2-step PCA: Temporal PCA then Spatial PCA</li>
</ol></section><section id="folder-structure" class="level3" data-number="5.4.2"><h3 data-number="5.4.2" class="anchored" data-anchor-id="folder-structure">
<span class="header-section-number">5.4.2</span> Folder Structure</h3>
<ul>
<li><ol start="0" type="1">
<li>Raw Data (mff)</li>
</ol></li>
<li><ol type="1">
<li>Filtering (fil)</li>
</ol></li>
<li><ol start="2" type="1">
<li>Segmentation (seg)</li>
</ol></li>
<li><ol start="3" type="1">
<li>Manually Selected Bad Channels</li>
</ol></li>
<li><ol start="4" type="1">
<li>Bad Channel Replacement_m (bcr)</li>
</ol></li>
<li><ol start="5" type="1">
<li>Artifact Detection (art)</li>
</ol></li>
<li><ol start="6" type="1">
<li>Bad Channel Replacement (bcr)</li>
</ol></li>
<li><ol start="7" type="1">
<li>Artifact Detection (art)</li>
</ol></li>
<li><ol start="8" type="1">
<li>Averaging (ave)
<ul>
<li>Skip if doing PCA on individual trial-level data</li>
</ul>
</li>
</ol></li>
<li><ol start="9" type="1">
<li>Average Reference (ref)</li>
</ol></li>
<li><ol start="10" type="1">
<li>Baseline Correction (blc)</li>
</ol></li>
<li><ol start="11" type="1">
<li>Files for PCA – drop files that have fewer than 10 artifact-free (and correct?) trials per condition</li>
</ol></li>
<li><ol start="12" type="1">
<li>Simple Binary</li>
</ol></li>
<li><ol start="13" type="1">
<li>Individual Trials</li>
</ol></li>
<li><ol start="14" type="1">
<li>EPT Averages</li>
</ol></li>
<li><ol start="15" type="1">
<li>PCA</li>
</ol></li>
<li><ol start="16" type="1">
<li>PCA Components</li>
</ol></li>
</ul>
<p><a href="images/folderStructureNetStation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="images/folderStructureNetStation.png" class="img-fluid"></a></p>
</section><section id="data-processing" class="level3" data-number="5.4.3"><h3 data-number="5.4.3" class="anchored" data-anchor-id="data-processing">
<span class="header-section-number">5.4.3</span> Data Processing</h3>
<ol type="1">
<li>Open NetStation Tools and select Automated Processing Script 1: Run on raw data files (mff)
<ul>
<li>Filtering</li>
<li>Segmentation</li>
</ul>
</li>
<li>Open segmented (seg) files in NetStation Review and select bad channels manually
<ul>
<li>To mark channels as bad across all segments:
<ul>
<li>Put Ø next to bad channels, these changes will automatically be saved when you close the file</li>
</ul>
</li>
<li>To mark channels as bad in individual segments:
<ul>
<li>When in topoplot mode, make sure to have the “Click to Change Channel Status” checked, then click on the channel.</li>
</ul>
</li>
</ul>
</li>
<li>Open NetStation Tools and Manual Script 2: Run on segmented files (seg)
<ul>
<li>Bad Channel Replacement (bcr)</li>
<li>Artifact Detection (art)</li>
<li>Bad Channel Replacement (bcr)</li>
<li>Artifact Detection (art)</li>
<li>Averaging (ave)</li>
<li>Average Reference (ref)</li>
<li>Baseline Correction (blc)</li>
</ul>
</li>
<li>In NetStation Review, open each file after the second Bad Channel Replacement
<ul>
<li>Determine how many trials are marked as good in each condition
<ul>
<li>This is found in the Segment panel on the bottom left when you have your file open. If you open that view, you can use the diverging arrows (those may be hard to see depending on your screen size) in the upper right corner of the “Bad Channels” button in the Segment panel to open in a new window for more screen real estate. The categories will be listed on the left, with the number of good trials noted over the total number of trials in that category.</li>
</ul>
</li>
<li>If the file has 10 or more good trials in each condition:
<ul>
<li>Make note of the bad channels (that are marked as bad across all segments) for each subject on “EEG Behavior and Bad Channels Sheet”</li>
<li>Then, proceed with the next step</li>
</ul>
</li>
<li>If the file does not have 10 more good trials in each condition:
<ul>
<li>Go back to Step 2 and proceed from there</li>
<li>Select additional bad channels manually so that they aren’t included in later processing steps, which might increase the number of trials kept</li>
<li>It can be helpful to take a look, in the file after the second Bad Channel Replacement file, at each trial that was marked as bad.
<ul>
<li>If a trial was clearly bad (many artifacts across many channels) and correctly marked as bad, leave it alone.</li>
<li>If a trial was marked as bad but appeared to have only a few bad channels (i.e., only a few bad channels led it to be marked as bad), then it can be helpful to mark those channels as bad for that individual segment (rather than marking the channel as bad across all segments—unless the channel is bad across many segments)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>In NetStation Review, open each file after the Averaging step
<ul>
<li>If there are continue to be channels that look bad, go back to Step 2 and proceed from there</li>
<li>In Step 2, mark those channel(s) as bad across all segments</li>
<li>Repeat process until there are no more bad channels after Script 2</li>
</ul>
</li>
<li>For files that have at least 10 good trials in each condition, copy and paste (don’t cut/move!) their file from the “10-Baseline Correction (blc)” folder into the “11-Files for PCA” folder</li>
<li>Run the temporo-spatial PCA on those files for data reduction</li>
</ol></section><section id="notes" class="level3" data-number="5.4.4"><h3 data-number="5.4.4" class="anchored" data-anchor-id="notes">
<span class="header-section-number">5.4.4</span> Notes</h3>
<p><u>Options for removing bad segments:</u> - The combine files tool has an exclude bad trials checkbox. If you run this tool on only one file, it is considered a no-op, the intended operation is not done, but it does appear to remove the bad segments. You would have to do this one run per file, if there are multiple files in the input subpane, they will be combined. - In the Net Station File Export Tool, there is a checkbox option to “Export only good segments” when exporting to both the MAT format, and also when exporting to Simple Binary (RAW) format. - In Net Station 5.3, EGI introduced the workflow concept into Net Station Review. The first workflow is combine segment/categories. This workflow allows for shuffling segments around between categories. It is quite a flexible tool, but importantly it includes a “Remove Bad Segments” button. So, you could do a no-op as far as changing categories but write out a MFF with the bad segments excluded.</p>
<p><u>Options for data processing:</u> - Data processing in Net Station → file export to simple binary → PCA in ERP PCA Toolkit - Data processing and PCA in ERP PCA Toolkit - Data processing in EEGLab → PCA in ERP PCA Toolkit - Data processing in MATLAB using scripts → PCA in ERP PCA Toolkit - Ryan Priefer’s approach: - Filter in EEGLab → data processing and PCA in ERP PCA Toolkit: segment, artifact detection/bad channel replacement, montage re-reference/baseline correct, average, then export to .txt file and PCA</p>
</section><section id="waveform-tools" class="level3" data-number="5.4.5"><h3 data-number="5.4.5" class="anchored" data-anchor-id="waveform-tools">
<span class="header-section-number">5.4.5</span> Waveform Tools</h3>
<ol type="1">
<li>
<p>Filtering</p>
<ul>
<li>Highpass: 0.1 Hz</li>
<li>Lowpass: 30.0 Hz</li>
</ul>
<p><a href="images/filteringNetStation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="images/filteringNetStation.png" class="img-fluid"></a></p>
</li>
<li>
<p>Segmentation</p>
<ul>
<li>
<p>Oddball</p>
<ul>
<li>Frequent:
<ul>
<li>Code is <code>frq+</code>
</li>
</ul>
</li>
<li>Target:
<ul>
<li>Code is <code>tgt+</code>
</li>
</ul>
</li>
<li>
<strong>Options</strong>:
<ul>
<li>Segment length before: 200ms (baseline length)</li>
<li>Segment length after: 1000ms (post-stimulus length)</li>
<li>Offset: 2ms</li>
<li>Check “Copy specs to Segment”</li>
</ul>
</li>
</ul>
<p><img src="images/oddballSegmentingNetStation_frq.png" class="img-fluid"><img src="images/oddballSegmentingNetStation_tgt.png" class="img-fluid"></p>
</li>
<li>
<p>Fishsharks</p>
<ul>
<li>Correct go:
<ul>
<li>Code is <code>Go++</code>
</li>
<li>Trial Spec eval is 1</li>
<li>Trial Spec rtim is greater than or equal to 200</li>
</ul>
</li>
</ul>
<p><a href="images/fishSharkSegmentingNetStation_cGo.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="images/fishSharkSegmentingNetStation_cGo.png" class="img-fluid"></a></p>
<ul>
<li>Correct no-go:
<ul>
<li>Code is <code>NG++</code>
</li>
<li>Trial Spec eval is 0</li>
</ul>
</li>
</ul>
<p><a href="images/fishSharkSegmentingNetStation_cNg.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="images/fishSharkSegmentingNetStation_cNg.png" class="img-fluid"></a></p>
<ul>
<li>Incorrect go:
<ul>
<li>Code is <code>Go++</code>
</li>
<li>Trial Spec eval is 0 <strong>or</strong> Trial Spec rtim is less than 200</li>
</ul>
</li>
</ul>
<p><a href="images/fishSharkSegmentingNetStation_xGo.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="images/fishSharkSegmentingNetStation_xGo.png" class="img-fluid"></a></p>
<ul>
<li>Incorrect no-go:
<ul>
<li>Code is <code>NG++</code>
</li>
<li>Trial Spec eval is 1</li>
</ul>
</li>
</ul>
<p><a href="images/fishSharkSegmentingNetStation_xNg.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="images/fishSharkSegmentingNetStation_xNg.png" class="img-fluid"></a></p>
<ul>
<li>All go:
<ul>
<li>Code is <code>Go++</code>
</li>
</ul>
</li>
</ul>
<p><a href="images/fishSharkSegmentingNetStation_allGo.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="images/fishSharkSegmentingNetStation_allGo.png" class="img-fluid"></a></p>
<ul>
<li>All no-go:
<ul>
<li>Code is <code>NG++</code>
</li>
</ul>
</li>
</ul>
<p><a href="images/fishSharkSegmentingNetStation_allNg.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="images/fishSharkSegmentingNetStation_allNg.png" class="img-fluid"></a></p>
<ul>
<li>
<strong>Options</strong>:
<ul>
<li>Segment length before: 200ms</li>
<li>Segment length after: 1000ms</li>
<li>Offset: 17ms</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Stop-signal</p>
<ul>
<li>Go - correct response
<ul>
<li>Code is <code>GoCR</code> <strong>or</strong> <code>NGGC</code>
</li>
<li>Trial Spec rtim is greater than or equal to 200</li>
</ul>
</li>
</ul>
<p><a href="images/stopSignalSegmentingNetStation_crGo.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="images/stopSignalSegmentingNetStation_crGo.png" class="img-fluid"></a></p>
<ul>
<li>Go - incorrect response
<ul>
<li>Code is <code>GoIn</code> <strong>or</strong> <code>NGGI</code>
</li>
</ul>
</li>
</ul>
<p><a href="images/stopSignalSegmentingNetStation_xrGo.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="images/stopSignalSegmentingNetStation_xrGo.png" class="img-fluid"></a></p>
<ul>
<li>Go - omission error
<ul>
<li>Code is <code>GoOm</code>
</li>
</ul>
</li>
</ul>
<p><a href="images/stopSignalSegmentingNetStation_oeGo.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="images/stopSignalSegmentingNetStation_oeGo.png" class="img-fluid"></a></p>
<ul>
<li>NoGo - correct
<ul>
<li>Code is <code>NNCR</code>
</li>
</ul>
</li>
</ul>
<p><a href="images/stopSignalSegmentingNetStation_cNG.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="images/stopSignalSegmentingNetStation_cNG.png" class="img-fluid"></a></p>
<ul>
<li>NoGo - incorrect
<ul>
<li>Code is <code>NNCC</code> <strong>or</strong> <code>NNCI</code>
</li>
</ul>
</li>
</ul>
<p><a href="images/stopSignalSegmentingNetStation_xNG.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="images/stopSignalSegmentingNetStation_xNG.png" class="img-fluid"></a></p>
<ul>
<li>NoGo - incorrect: correct E
<ul>
<li>Code is <code>NNCC</code>
</li>
</ul>
</li>
</ul>
<p><a href="images/stopSignalSegmentingNetStation_xceNG.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="images/stopSignalSegmentingNetStation_xceNG.png" class="img-fluid"></a></p>
<ul>
<li>NoGo - incorrect: incorrect E
<ul>
<li>Code is <code>NNCI</code>
</li>
</ul>
</li>
</ul>
<p><a href="images/stopSignalSegmentingNetStation_xxeNG.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="images/stopSignalSegmentingNetStation_xxeNG.png" class="img-fluid"></a></p>
<ul>
<li>All go:
<ul>
<li>Code is <code>CoGR</code> <strong>or</strong> <code>GoOm</code> <strong>or</strong> <code>GoIn</code> <strong>or</strong> <code>NGGC</code>
</li>
</ul>
</li>
</ul>
<p><a href="images/stopSignalSegmentingNetStation_allGo.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="images/stopSignalSegmentingNetStation_allGo.png" class="img-fluid"></a></p>
<ul>
<li>All no-go:
<ul>
<li>Code is <code>NNCR</code> <strong>or</strong> <code>NNCC</code> <strong>or</strong> <code>NNCI</code>
</li>
</ul>
</li>
</ul>
<p><a href="images/stopSignalSegmentingNetStation_allNG.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="images/stopSignalSegmentingNetStation_allNG.png" class="img-fluid"></a></p>
<ul>
<li>Response-locked correct go
<ul>
<li>Code is <code>rcor</code>
</li>
<li>Key code <code>cel#</code> is 3</li>
</ul>
</li>
</ul>
<p><a href="images/stopSignalSegmentingNetStation_rlcGo.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="images/stopSignalSegmentingNetStation_rlcGo.png" class="img-fluid"></a></p>
<ul>
<li>Response-locked incorrect stop
<ul>
<li>Code is <code>resp</code>
</li>
<li>Key Code <code>cel#</code> is 4</li>
</ul>
</li>
</ul>
<p><a href="images/stopSignalSegmentingNetStation_rlxNG.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="images/stopSignalSegmentingNetStation_rlxNG.png" class="img-fluid"></a></p>
<ul>
<li>Response-locked incorrect go
<ul>
<li>Code is <code>rinc</code>
</li>
<li>Key Code <code>cel#</code> is 3</li>
</ul>
</li>
</ul>
<p><a href="images/stopSignalSegmentingNetStation_rlxGo.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="images/stopSignalSegmentingNetStation_rlxGo.png" class="img-fluid"></a></p>
<ul>
<li>
<strong>Options</strong>:
<ul>
<li>Segment length before: 200ms</li>
<li>Segment length after: 1000ms</li>
<li>Offset: 16ms
<ul>
<li>Note: for “response locked”, offset is 0ms</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Manually prcoess data</p></li>
<li>
<p>Bad channel replacement</p>
<ul>
<li>Prior to running, select bad channels manually</li>
</ul>
<p><a href="images/badChannelReplacementNetStation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="images/badChannelReplacementNetStation.png" class="img-fluid"></a></p>
</li>
<li>
<p>Artifact detection</p>
<ul>
<li>Bad channels:
<ul>
<li>Max - min &gt; 200.00 uv</li>
<li>Entire segment</li>
<li>Moving average: 80ms</li>
</ul>
</li>
<li>Eye blink:
<ul>
<li>Max - min &gt; 175.00 uv</li>
<li>Window size: 640ms</li>
<li>Moving average: 80ms</li>
</ul>
</li>
<li>Eye movement:
<ul>
<li>Max - min &gt; 200.00 uv</li>
<li>Window size: 640ms</li>
<li>Moving average: 80ms</li>
</ul>
</li>
<li>Mark channel bad for all sefments if bad for greater than: 20% of segments</li>
<li>Mark segment bad if it:
<ul>
<li>Contains more than 20 bad channels</li>
<li>Contains an eyeblink (remove if doing ocular artifact removal)</li>
<li>Contains an eye movement (remove if doing ocular artifact removal)</li>
</ul>
</li>
<li>Overwrite all previous bad Segment information</li>
<li>Overwrite all previous bad Channel information</li>
</ul>
<p><a href="images/artifactDetectionNetStation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="images/artifactDetectionNetStation.png" class="img-fluid"></a></p>
</li>
<li>
<p>Bad channel replacement</p>
<ul>
<li>Same as step 4</li>
<li>Specification name: Oddball 06. Bad Channel Replacement</li>
</ul>
</li>
<li>
<p>Artifact detection</p>
<ul>
<li>Same as step 5</li>
</ul>
</li>
<li>
<p>Averaging</p>
<ul>
<li>Handle source files: Separately</li>
<li>Handle subjects: Separately
<ul>
<li>To create final merge file for one ERP for whole sample (i.e., grand average – for graphing purposes only, not analysis – select “Together” for each)</li>
</ul>
</li>
<li>Do <strong>not</strong> compute noise estimate</li>
</ul>
<p><a href="images/averagingNetStation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="images/averagingNetStation.png" class="img-fluid"></a></p>
</li>
<li>
<p>Montage options</p>
<ul>
<li>Average reference</li>
</ul>
<p><a href="images/averageReferenceNetStation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="images/averageReferenceNetStation.png" class="img-fluid"></a></p>
</li>
<li>
<p>Baseline correction</p>
<ul>
<li>Sample baseline with respect to: segment time = 0</li>
<li>Baseline begins: 200ms (length of baseline) before sample and is 200ms (length of baseline) long</li>
</ul>
<p><a href="images/baselineCorrectionNetStation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="images/baselineCorrectionNetStation.png" class="img-fluid"></a></p>
</li>
<li>
<p>Combine files (using the Averaging Tool)</p>
<ul>
<li>Handle source files: Together</li>
<li>Handle subjects: Separately</li>
<li>Do <strong>not</strong> compute noise estimate</li>
</ul>
<p><a href="images/combineFilesNetStation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="images/combineFilesNetStation.png" class="img-fluid"></a></p>
</li>
<li>
<p>File Export</p>
<ul>
<li>Simple binary</li>
<li>Calibrate data</li>
<li>Export calibration information</li>
<li>Export history information</li>
<li>Export reference channel</li>
<li>Export only good segments (if not doing data processing in othe software)</li>
</ul>
<p><a href="images/fileExportNetStation_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="images/fileExportNetStation_1.png" class="img-fluid"></a></p>
</li>
<li>
<p>Grand averaging</p>
<ul>
<li>Handle source files: Together</li>
<li>Handle subjects: together</li>
<li>Copy events from first file</li>
</ul>
<p><a href="images/grandAverageNetStation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="images/grandAverageNetStation.png" class="img-fluid"></a></p>
</li>
<li>
<p>File export</p>
<ul>
<li>Format: Tab-delimited text (.txt)</li>
<li>Export only good segments</li>
</ul>
<p><a href="images/fileExportNetStation_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="images/fileExportNetStation_2.png" class="img-fluid"></a></p>
</li>
</ol></section><section id="eeg-behaviors-and-bad-channels-form" class="level3" data-number="5.4.6"><h3 data-number="5.4.6" class="anchored" data-anchor-id="eeg-behaviors-and-bad-channels-form">
<span class="header-section-number">5.4.6</span> EEG Behaviors and Bad Channels Form</h3>
<ul>
<li>Indicate which channels were badd across <strong>all</strong> trials in the last “bad channel replacement” (bcr) step (Step 6)
<ul>
<li>Include tirals that were marked bad (across all trials) either manually or automatically</li>
</ul>
</li>
<li>Indicate which channels were manually marked bad on each trial for those that were marked bad on a trial by trial basis (step 3)</li>
</ul></section><section id="troubleshooting-and-qa" class="level3" data-number="5.4.7"><h3 data-number="5.4.7" class="anchored" data-anchor-id="troubleshooting-and-qa">
<span class="header-section-number">5.4.7</span> Troubleshooting and Q&amp;A</h3>
<p><strong>Q: How do I mark a channel as bad for an individual trial/segment?</strong></p>
<p>A: To mark an individual trial bad when in topoplot mode, make sure to have the “Click to Change Channel Status” checked and then click on the channel. Click again to make it good. Hold down the <code>Command</code> key to make it good or bad for the whole experiment.</p>
<p><strong>Q: When trying to do some batch data processing in NetStation Tools, I received an error when trying to add a group of .mff files to the “Input Files” box.</strong> <strong>The error says “Blue files are open in review. In order to process these files, they need to be closed in Review fist”</strong> <strong>What can I do?</strong></p>
<p>A: If you run files through the FileValidator found in the Utilities (Application&gt;EGI&gt;Utilities) folder, this will fix the error. If you don’t have that, you can right-click on the files, choose “Show package contents” and deleted the <code>lock.txt</code> or <code>aquiriring.xml</code> file if found</p>
<p><strong>Q: When trying to import files to NetStation Tools from an external hard drive, they do not show up in the “Input Files” box but no error is given.</strong> <strong>How can I resolve this?</strong></p>
<p>A: Copy the files to a local directory (e.g., a folder on the Desktop) before importing to NetStation Tools.</p>


<!-- -->

</section></section></section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section></div></main><!-- /main --><!-- Add lab logo --><p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%"></a>
</p>

<br><hr>
<br><!-- Add icon library --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!-- Add font awesome icons --><p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/devpsylab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/DevPsyLab\.github\.io\/DataAnalysis\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb77" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "EEG and ERP Processing and Analysis"</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span><span class="co"> </span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html_document:</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co">    code_folding: show</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="fu"># ERP Processing Pipeline using HAPPE {#sec-happe}</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inital Set-up {#sec-initial}</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Download MATLAB: <span class="ot">&lt;https://its.uiowa.edu/matlab&gt;</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Click <span class="in">`How to Install MatLab`</span> and follow the relevant instructions</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Create a <span class="in">`MatLab`</span> folder in your local directory.</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>    You will keep all of your MatLab related files in this folder.</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Install the HAPPE pipeline: <span class="ot">&lt;https://github.com/PINE-Lab/HAPPE&gt;</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Clone the HAPPE repository to your <span class="in">`GitHub`</span> account</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Open the <span class="in">`HAPPE`</span> folder</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Open the <span class="in">`HAPPE User Guide`</span> document</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Read through the <span class="in">`HAPPE User Guide`</span></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Navigate to the <span class="in">`Setting up HAPPE`</span> section in the user guide and follow the instructions for setting up the HAPPE pipeline, including installation of add-ons and eeglab</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Note: This version of the HAPPE pipeline includes functionality from the HAPPE 2.0, HAPPE+ER, and HAPPILEE pipelines, so it is suitable for standard EEG processing as well as ERP and low-density EEG/ERP processing.</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Install EP Toolkit: <span class="ot">&lt;https://sourceforge.net/projects/erppcatoolkit/&gt;</span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>After downloading, copy the <span class="in">`EP_Toolkit`</span> folder to your <span class="in">`Matlab`</span> folder (in your local directory)</span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>In the <span class="in">`EP_toolkit`</span> folder: </span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Open <span class="in">`EP_Toolkit`</span></span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Open <span class="in">`Documentation`</span></span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Open <span class="in">`tutorial`</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>In the <span class="in">`tutorial`</span> document, navigate to the <span class="in">`Set Up`</span> section and follow the instructions for installing and setting up EP Toolkit and FieldTrip.</span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>    Do **NOT** follow instructions for setting up EEGLAB.</span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>    You have already set up your path to EEGLAB when you set up the HAPPE pipeline.</span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>You should have the following subfolders in your <span class="in">`MatLab`</span> folder:</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`EP_Toolkit`</span></span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`Fieldtrip-[version number]`</span></span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true" tabindex="-1"></a><span class="fu">## MATLAB Scripts to Manage HAPPE Files {#sec-matlabScripts}</span></span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true" tabindex="-1"></a>We have scripts for each task that can prepare files for the HAPPE Pipeline and/or manage the files outputted from HAPPE.</span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true" tabindex="-1"></a>These actions can be done manually as well, but the MATLAB scripts make the process more efficient.</span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true" tabindex="-1"></a>The scripts will also generate a "log" of all of the files processed through HAPPE to facilitate tracking of EEG data processing.</span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true" tabindex="-1"></a>The sections below detail the code used to perform these actions as well as the instructions for using the current scripts.</span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-43"><a href="#cb77-43" aria-hidden="true" tabindex="-1"></a>Note: Before using the scripts/code detailed below, ensure that all filepaths used are in your MATLAB path collection.</span>
<span id="cb77-44"><a href="#cb77-44" aria-hidden="true" tabindex="-1"></a>These may include:</span>
<span id="cb77-45"><a href="#cb77-45" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb77-46"><a href="#cb77-46" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The location where the automatic scripts are stored (for our lab, this is under <span class="in">`/Data Processing/6. MATLAB EEG Pipeline`</span>)</span>
<span id="cb77-47"><a href="#cb77-47" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The location where the HAPPE pre-processing script is stored</span>
<span id="cb77-48"><a href="#cb77-48" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The location of the raw data (to be processed)</span>
<span id="cb77-49"><a href="#cb77-49" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The location(s) of any intermediate files for processing (e.g., the updated .mff files that contain accuracy information in FishShark)</span>
<span id="cb77-50"><a href="#cb77-50" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The location(s) for any files outputted by HAPPE and/or places you wish to use the script to move them to</span>
<span id="cb77-51"><a href="#cb77-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-52"><a href="#cb77-52" aria-hidden="true" tabindex="-1"></a>To add a file path, click on Home/Set Path/Add Folder in MATLAB.</span>
<span id="cb77-53"><a href="#cb77-53" aria-hidden="true" tabindex="-1"></a>You don't need to specify the file name, just its containing folder.</span>
<span id="cb77-54"><a href="#cb77-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-55"><a href="#cb77-55" aria-hidden="true" tabindex="-1"></a><span class="fu">## Oddball Processing Pipeline </span></span>
<span id="cb77-56"><a href="#cb77-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-57"><a href="#cb77-57" aria-hidden="true" tabindex="-1"></a><span class="fu">### Recommended Folder Strucure</span></span>
<span id="cb77-58"><a href="#cb77-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-59"><a href="#cb77-59" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`1a - Files for HAPPE`</span></span>
<span id="cb77-60"><a href="#cb77-60" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`1b - Manual Processing`</span></span>
<span id="cb77-61"><a href="#cb77-61" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`2 - Processed Files`</span></span>
<span id="cb77-62"><a href="#cb77-62" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`3 - Files for PCA`</span></span>
<span id="cb77-63"><a href="#cb77-63" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`4 - EPT Averages`</span></span>
<span id="cb77-64"><a href="#cb77-64" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`5 - PCA`</span></span>
<span id="cb77-65"><a href="#cb77-65" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`6 - PCA Components`</span></span>
<span id="cb77-66"><a href="#cb77-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-67"><a href="#cb77-67" aria-hidden="true" tabindex="-1"></a><span class="fu">### MATLAB Script</span></span>
<span id="cb77-68"><a href="#cb77-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-69"><a href="#cb77-69" aria-hidden="true" tabindex="-1"></a>The following section describes the MATLAB scripts used to manage HAPPE output files for the Oddball task data. If you are running HAPPE manually (i.e., without integrating these scripts), skip to the <span class="co">[</span><span class="ot">Oddball HAPPE inputs</span><span class="co">](#sec-inputOddballHAPPE)</span> section. </span>
<span id="cb77-70"><a href="#cb77-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-71"><a href="#cb77-71" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Open the <span class="in">`eegProccessingOddball.m`</span> file (accessible via Git <span class="co">[</span><span class="ot">here</span><span class="co">](https://research-git.uiowa.edu/PetersenLab/SRS/SRS-DataProcessing/-/blob/master/6.%20MATLAB%20EEG%20Pipeline/eegProcessingOddball.m)</span>) in MATLAB</span>
<span id="cb77-72"><a href="#cb77-72" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Update all thresholds and filepaths in script file (must be done BEFORE running the script)</span>
<span id="cb77-73"><a href="#cb77-73" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>In the second section of our script file, we set our "threshold" for the minimum number of trials that need to be retained after pre-processing for a subject's data to be eligible for PCA.</span>
<span id="cb77-74"><a href="#cb77-74" aria-hidden="true" tabindex="-1"></a>   Additional thresholds can also be set for things like number of channels retained, but these are not currently in use.</span>
<span id="cb77-75"><a href="#cb77-75" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb77-76"><a href="#cb77-76" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-77"><a href="#cb77-77" aria-hidden="true" tabindex="-1"></a><span class="in">   % Set quality threshold parameters</span></span>
<span id="cb77-78"><a href="#cb77-78" aria-hidden="true" tabindex="-1"></a><span class="in">   trialCutoff = 10;</span></span>
<span id="cb77-79"><a href="#cb77-79" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-80"><a href="#cb77-80" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>We also set environment variables with all of the filepaths that are relevant for managing HAPPE output files and tracking processed data.</span>
<span id="cb77-81"><a href="#cb77-81" aria-hidden="true" tabindex="-1"></a>   The following paths should be checked and updated as necessary to reflect the organization of processing on your computer.</span>
<span id="cb77-82"><a href="#cb77-82" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span><span class="in">`passPath`</span> is the location you wish to have files that meet or exceed the above-defined thresholds to be saved</span>
<span id="cb77-83"><a href="#cb77-83" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span><span class="in">`allPath`</span> is the location you wish to have ALL files outputted from HAPPE saved to (regardless of whether threshold is met or not)</span>
<span id="cb77-84"><a href="#cb77-84" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span><span class="in">`failPath`</span> is the location you wish to have files that do not meet the above-defined thresholds to be copied to</span>
<span id="cb77-85"><a href="#cb77-85" aria-hidden="true" tabindex="-1"></a><span class="ss">         - </span>.mff files that do not meet threshold will be copied here as an indication that they should be processed manually to see if they meet threshold afterward</span>
<span id="cb77-86"><a href="#cb77-86" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span><span class="in">`summPath`</span> is the location you wish to save the file that lists all files processed through HAPPE in the current batch</span>
<span id="cb77-87"><a href="#cb77-87" aria-hidden="true" tabindex="-1"></a><span class="ss">         - </span>We currently use this to save the "processing log" to a location that all team members/computers have access to so it is easier to determine which files require processing when EEG data are not stored on a shared server</span>
<span id="cb77-88"><a href="#cb77-88" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span><span class="in">`manPath`</span> is the location you wish to save the file that lists all files that do not meet the above-defined thresholds</span>
<span id="cb77-89"><a href="#cb77-89" aria-hidden="true" tabindex="-1"></a><span class="ss">         - </span>We currently use this to save the "to process manually" list to a location that all team members/computers have access to so it is easier to determine which files require manual processing because the copied .mff file would not be acessible via our shared server</span>
<span id="cb77-90"><a href="#cb77-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb77-91"><a href="#cb77-91" aria-hidden="true" tabindex="-1"></a>    <span class="in">```</span></span>
<span id="cb77-92"><a href="#cb77-92" aria-hidden="true" tabindex="-1"></a><span class="in">    % Set paths for file sorting</span></span>
<span id="cb77-93"><a href="#cb77-93" aria-hidden="true" tabindex="-1"></a><span class="in">    passPath = 'V:\Processing-Repo\Folder Structure\3 - Files for PCA'; %location for .txt output files</span></span>
<span id="cb77-94"><a href="#cb77-94" aria-hidden="true" tabindex="-1"></a><span class="in">    allPath = 'V:\Processing-Repo\Folder Structure\2 - Processed Files'; %location for all processed files to end up</span></span>
<span id="cb77-95"><a href="#cb77-95" aria-hidden="true" tabindex="-1"></a><span class="in">    failPath = 'V:\Processing-Repo\Folder Structure\1b - Manual Processing'; %location to copy unsuccessful .mff to for manual process</span></span>
<span id="cb77-96"><a href="#cb77-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-97"><a href="#cb77-97" aria-hidden="true" tabindex="-1"></a><span class="in">    % Set path for processing summary</span></span>
<span id="cb77-98"><a href="#cb77-98" aria-hidden="true" tabindex="-1"></a><span class="in">    summPath = 'Z:\Shared Server\Study Folder\Data Processing\6. MATLAB EEG Pipeline\Processed Data Logs';</span></span>
<span id="cb77-99"><a href="#cb77-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-100"><a href="#cb77-100" aria-hidden="true" tabindex="-1"></a><span class="in">    % Set path for summary of files to process manually </span></span>
<span id="cb77-101"><a href="#cb77-101" aria-hidden="true" tabindex="-1"></a><span class="in">    manPath = 'Z:\Shared Server\Study Folder\Data Processing\6. MATLAB EEG Pipeline\Processing To Do\Cases to Process Manually\Lists of Cases by Batch';</span></span>
<span id="cb77-102"><a href="#cb77-102" aria-hidden="true" tabindex="-1"></a><span class="in">    ```</span></span>
<span id="cb77-103"><a href="#cb77-103" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Run the HAPPE Pipeline</span>
<span id="cb77-104"><a href="#cb77-104" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This first section is designed to rely on user input.</span>
<span id="cb77-105"><a href="#cb77-105" aria-hidden="true" tabindex="-1"></a>   Click "Run" on the MATLAB editor window with the file open to begin the process.</span>
<span id="cb77-106"><a href="#cb77-106" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>A message will appear in the console prompting you to enter the filepath to the location of the HAPPE pre-processing file you wish to run</span>
<span id="cb77-107"><a href="#cb77-107" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Once the path is entered, MATLAB will run the file</span>
<span id="cb77-108"><a href="#cb77-108" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Note: the filepath inputted should NOT be in quotes**</span>
<span id="cb77-109"><a href="#cb77-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-110"><a href="#cb77-110" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-111"><a href="#cb77-111" aria-hidden="true" tabindex="-1"></a><span class="in">   % Set path to HAPPE pre-processing script</span></span>
<span id="cb77-112"><a href="#cb77-112" aria-hidden="true" tabindex="-1"></a><span class="in">   happeRun = input('Enter the full path to the HAPPE pre-processing file:\n&gt; ','s') ;</span></span>
<span id="cb77-113"><a href="#cb77-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-114"><a href="#cb77-114" aria-hidden="true" tabindex="-1"></a><span class="in">   % Call and run HAPPE pre-processing script</span></span>
<span id="cb77-115"><a href="#cb77-115" aria-hidden="true" tabindex="-1"></a><span class="in">   run(happeRun);</span></span>
<span id="cb77-116"><a href="#cb77-116" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-117"><a href="#cb77-117" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Enter HAPPE inputs</span>
<span id="cb77-118"><a href="#cb77-118" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>See the following section for HAPPE user inputs for Oddball</span>
<span id="cb77-119"><a href="#cb77-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-120"><a href="#cb77-120" aria-hidden="true" tabindex="-1"></a>After the HAPPE inputs are entered, no more user interaction is required for the script to do its job.</span>
<span id="cb77-121"><a href="#cb77-121" aria-hidden="true" tabindex="-1"></a>The HAPPE pipeline will run, and the remaining MATLAB code in the script file will evaluate the files outputted by HAPPE and move them to the appropriate locations based on this evaluation. </span>
<span id="cb77-122"><a href="#cb77-122" aria-hidden="true" tabindex="-1"></a>See <span class="co">[</span><span class="ot">Oddball Post-HAPPE Steps</span><span class="co">](#sec-oddballPost)</span> for a detailed explanation of the code used to accomplish this.</span>
<span id="cb77-123"><a href="#cb77-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-124"><a href="#cb77-124" aria-hidden="true" tabindex="-1"></a><span class="fu">### HAPPE Inputs {#sec-inputOddballHAPPE}</span></span>
<span id="cb77-125"><a href="#cb77-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-126"><a href="#cb77-126" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>If you are not using the MATLAB scripts described above, you must first open the HAPPE pipeline V4 script in MATLAB and click "Run"</span>
<span id="cb77-127"><a href="#cb77-127" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This will be stored in the location to which you mapped the HAPPE Git repo (e.g. <span class="in">`Documents/GitHub/HAPPE/1. pre-process/HAPPE_v4.m`</span>)</span>
<span id="cb77-128"><a href="#cb77-128" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>User Inputs</span>
<span id="cb77-129"><a href="#cb77-129" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Enter the path to the folder containing the dataset.</span>
<span id="cb77-130"><a href="#cb77-130" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Select <span class="in">`raw`</span></span>
<span id="cb77-131"><a href="#cb77-131" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Load pre-existing set of input parameter: </span>
<span id="cb77-132"><a href="#cb77-132" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`N`</span> if this is your first time running data through the pipeline.</span>
<span id="cb77-133"><a href="#cb77-133" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`Y`</span> if you have decided on a set of parameters.</span>
<span id="cb77-134"><a href="#cb77-134" aria-hidden="true" tabindex="-1"></a>        Enter the path to the folder containing the input parameters.</span>
<span id="cb77-135"><a href="#cb77-135" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Low density data: <span class="in">`N`</span></span>
<span id="cb77-136"><a href="#cb77-136" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Data type: <span class="in">`task`</span></span>
<span id="cb77-137"><a href="#cb77-137" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Performing event-related potential (ERP) analysis: <span class="in">`Y`</span></span>
<span id="cb77-138"><a href="#cb77-138" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Enter the task onset tags</span>
<span id="cb77-139"><a href="#cb77-139" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Target: <span class="in">`tgt+`</span></span>
<span id="cb77-140"><a href="#cb77-140" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Frequent: <span class="in">`frq+`</span></span>
<span id="cb77-141"><a href="#cb77-141" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`done`</span></span>
<span id="cb77-142"><a href="#cb77-142" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Do multiple onset tags belong to a single condition? <span class="in">`N`</span></span>
<span id="cb77-143"><a href="#cb77-143" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>File format: <span class="in">`5`</span></span>
<span id="cb77-144"><a href="#cb77-144" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Acquisition layout type: <span class="in">`2`</span></span>
<span id="cb77-145"><a href="#cb77-145" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Number of channels: <span class="in">`128`</span></span>
<span id="cb77-146"><a href="#cb77-146" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Do you have additional type fields besides "code"? <span class="in">`N`</span></span>
<span id="cb77-147"><a href="#cb77-147" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Select channels of interest: <span class="in">`all`</span></span>
<span id="cb77-148"><a href="#cb77-148" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Frequency of electrical noise in Hz: <span class="in">`60`</span></span>
<span id="cb77-149"><a href="#cb77-149" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Are there any additional frequencies, (e.g., harmonics) to reduce? <span class="in">`N`</span></span>
<span id="cb77-150"><a href="#cb77-150" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Line Noise reduction method: <span class="in">`notch`</span></span>
<span id="cb77-151"><a href="#cb77-151" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Low cutoff: <span class="in">`59`</span></span>
<span id="cb77-152"><a href="#cb77-152" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>high cutoff: <span class="in">`61`</span></span>
<span id="cb77-153"><a href="#cb77-153" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Resample: <span class="in">`N`</span></span>
<span id="cb77-154"><a href="#cb77-154" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Filter</span>
<span id="cb77-155"><a href="#cb77-155" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Low Pass Cutoff: <span class="in">`30`</span></span>
<span id="cb77-156"><a href="#cb77-156" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>High Pass Cutoff: <span class="in">`.1`</span></span>
<span id="cb77-157"><a href="#cb77-157" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Choose a filter: <span class="in">`fir`</span></span>
<span id="cb77-158"><a href="#cb77-158" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Bad Channel Detection: <span class="in">`Y`</span></span>
<span id="cb77-159"><a href="#cb77-159" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`after`</span> wavelet thresholding</span>
<span id="cb77-160"><a href="#cb77-160" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>ECGone: <span class="in">`N`</span></span>
<span id="cb77-161"><a href="#cb77-161" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Wavelet Thresholding</span>
<span id="cb77-162"><a href="#cb77-162" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`default`</span></span>
<span id="cb77-163"><a href="#cb77-163" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Threshold rule: <span class="in">`hard`</span></span>
<span id="cb77-164"><a href="#cb77-164" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>MuscIL: <span class="in">`N`</span></span>
<span id="cb77-165"><a href="#cb77-165" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Segmentation: <span class="in">`Y`</span></span>
<span id="cb77-166"><a href="#cb77-166" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Starting parameter for stimulus: <span class="in">`-200`</span></span>
<span id="cb77-167"><a href="#cb77-167" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Ending parameter for stimulus: <span class="in">`1000`</span></span>
<span id="cb77-168"><a href="#cb77-168" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Task offset: <span class="in">`2`</span></span>
<span id="cb77-169"><a href="#cb77-169" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Baseline Correction: <span class="in">`Y`</span></span>
<span id="cb77-170"><a href="#cb77-170" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Baseline Correction start: <span class="in">`-200`</span></span>
<span id="cb77-171"><a href="#cb77-171" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Baseline Correction end: <span class="in">`0`</span></span>
<span id="cb77-172"><a href="#cb77-172" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Interpolation: <span class="in">`Y`</span></span>
<span id="cb77-173"><a href="#cb77-173" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Segment Rejection: <span class="in">`Y`</span></span>
<span id="cb77-174"><a href="#cb77-174" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Segment Rejection Method: <span class="in">`amplitude`</span></span>
<span id="cb77-175"><a href="#cb77-175" aria-hidden="true" tabindex="-1"></a><span class="ss">            - </span>minimum segment rejection threshold: <span class="in">`-150`</span></span>
<span id="cb77-176"><a href="#cb77-176" aria-hidden="true" tabindex="-1"></a><span class="ss">            - </span>maximum segment rejection threshold: <span class="in">`150`</span></span>
<span id="cb77-177"><a href="#cb77-177" aria-hidden="true" tabindex="-1"></a><span class="ss">            - </span>segment rejection based on all channels or ROI: <span class="in">`all`</span></span>
<span id="cb77-178"><a href="#cb77-178" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Re-referencing: <span class="in">`Y`</span></span>
<span id="cb77-179"><a href="#cb77-179" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Does your data contain a flatline or all zero reference channel? <span class="in">`N`</span></span>
<span id="cb77-180"><a href="#cb77-180" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>re-referencing method: <span class="in">`average`</span></span>
<span id="cb77-181"><a href="#cb77-181" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Save format: <span class="in">`1`</span></span>
<span id="cb77-182"><a href="#cb77-182" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Visualizations: <span class="in">`N`</span></span>
<span id="cb77-183"><a href="#cb77-183" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Parameter file save name: <span class="in">`default`</span></span>
<span id="cb77-184"><a href="#cb77-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-185"><a href="#cb77-185" aria-hidden="true" tabindex="-1"></a><span class="fu">### Oddball Post-HAPPE Steps {#sec-oddballPost}</span></span>
<span id="cb77-186"><a href="#cb77-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-187"><a href="#cb77-187" aria-hidden="true" tabindex="-1"></a>This section details the actions performed by the MATLAB scripts once HAPPE is completed.</span>
<span id="cb77-188"><a href="#cb77-188" aria-hidden="true" tabindex="-1"></a>These actions will take place automatically upon completion of the HAPPE pipeline.</span>
<span id="cb77-189"><a href="#cb77-189" aria-hidden="true" tabindex="-1"></a>**No user inputs or actions are necessary at this stage.**</span>
<span id="cb77-190"><a href="#cb77-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-191"><a href="#cb77-191" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Exclude files that don't have any output data from the dataset (containing filename and quality reports from HAPPE pipeline) that will be used to assess file quality</span>
<span id="cb77-192"><a href="#cb77-192" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This step is important because "empty" files don't play nicely with the code used to evaluate files that have some data in them (even if the data do not meet threshold)</span>
<span id="cb77-193"><a href="#cb77-193" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This code relies on HAPPE's quality data that remains in the MATLAB environment after the pipeline has finished.</span>
<span id="cb77-194"><a href="#cb77-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-195"><a href="#cb77-195" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-196"><a href="#cb77-196" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create a list of files that received some kind of error message</span></span>
<span id="cb77-197"><a href="#cb77-197" aria-hidden="true" tabindex="-1"></a><span class="in">   noTags = any(strcmp(dataQC, 'NO_TAGS'), 2);</span></span>
<span id="cb77-198"><a href="#cb77-198" aria-hidden="true" tabindex="-1"></a><span class="in">   oneRej = any(strcmp(dataQC, 'REJ_ONE_SEG'), 2);</span></span>
<span id="cb77-199"><a href="#cb77-199" aria-hidden="true" tabindex="-1"></a><span class="in">   allRej = any(strcmp(dataQC, 'ALL_SEG_REJ'), 2);</span></span>
<span id="cb77-200"><a href="#cb77-200" aria-hidden="true" tabindex="-1"></a><span class="in">   error = any(strcmp(dataQC, 'ERROR'), 2);</span></span>
<span id="cb77-201"><a href="#cb77-201" aria-hidden="true" tabindex="-1"></a><span class="in">   loadFail = any(strcmp(dataQC, 'LOAD_FAIL'), 2);</span></span>
<span id="cb77-202"><a href="#cb77-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-203"><a href="#cb77-203" aria-hidden="true" tabindex="-1"></a><span class="in">   % Combine filenames with quality data (for some reason, they are not automatically connected by HAPPE)</span></span>
<span id="cb77-204"><a href="#cb77-204" aria-hidden="true" tabindex="-1"></a><span class="in">   dataQCNew = [FileNames', dataQC];</span></span>
<span id="cb77-205"><a href="#cb77-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-206"><a href="#cb77-206" aria-hidden="true" tabindex="-1"></a><span class="in">   % Remove all files in the above lists (those receiving errors) from the quality data</span></span>
<span id="cb77-207"><a href="#cb77-207" aria-hidden="true" tabindex="-1"></a><span class="in">   dataQCNew(noTags | allRej | error | loadFail | oneRej, :) = [];</span></span>
<span id="cb77-208"><a href="#cb77-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-209"><a href="#cb77-209" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create list of variable names for quality data</span></span>
<span id="cb77-210"><a href="#cb77-210" aria-hidden="true" tabindex="-1"></a><span class="in">   dataQCnamesNew = ["File", dataQCnames];</span></span>
<span id="cb77-211"><a href="#cb77-211" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-212"><a href="#cb77-212" aria-hidden="true" tabindex="-1"></a><span class="in">   % Save the data as a table for ease of use in subsequent steps</span></span>
<span id="cb77-213"><a href="#cb77-213" aria-hidden="true" tabindex="-1"></a><span class="in">   qcTable = cell2table(dataQCNew, 'VariableNames', dataQCnamesNew);</span></span>
<span id="cb77-214"><a href="#cb77-214" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-215"><a href="#cb77-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-216"><a href="#cb77-216" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Identify the files that meet (or don't meet) the threshold</span>
<span id="cb77-217"><a href="#cb77-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-218"><a href="#cb77-218" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-219"><a href="#cb77-219" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create a list of files (i.e., rows in the table) that meet threshold</span></span>
<span id="cb77-220"><a href="#cb77-220" aria-hidden="true" tabindex="-1"></a><span class="in">   thresholdTest = qcTable.("Number_tgt+_Segs_Post-Seg_Rej") &gt;= trialCutoff &amp; qcTable.("Number_frq+_Segs_Post-Seg_Rej") &gt;= trialCutoff;</span></span>
<span id="cb77-221"><a href="#cb77-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-222"><a href="#cb77-222" aria-hidden="true" tabindex="-1"></a><span class="in">   % Add a variable to the quality data table that include whether or not the file meet threshold</span></span>
<span id="cb77-223"><a href="#cb77-223" aria-hidden="true" tabindex="-1"></a><span class="in">   qcTable.Test = thresholdTest;</span></span>
<span id="cb77-224"><a href="#cb77-224" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-225"><a href="#cb77-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-226"><a href="#cb77-226" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Add an identifying variable to be used for data joining down the line</span>
<span id="cb77-227"><a href="#cb77-227" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This variable is generated using its expected location in the file name (i.e., how many text characters "in" it is)</span>
<span id="cb77-228"><a href="#cb77-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-229"><a href="#cb77-229" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-230"><a href="#cb77-230" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate IDs based on File variable</span></span>
<span id="cb77-231"><a href="#cb77-231" aria-hidden="true" tabindex="-1"></a><span class="in">   idWaveQC = extractBefore(qcTable.File, 8);</span></span>
<span id="cb77-232"><a href="#cb77-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-233"><a href="#cb77-233" aria-hidden="true" tabindex="-1"></a><span class="in">   % Append ID variable to quality data</span></span>
<span id="cb77-234"><a href="#cb77-234" aria-hidden="true" tabindex="-1"></a><span class="in">   qcTable.idWave = idWaveQC;</span></span>
<span id="cb77-235"><a href="#cb77-235" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-236"><a href="#cb77-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-237"><a href="#cb77-237" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Create a subsetted dataset conataining only the <span class="in">`idWave`</span>, file name, and "test results" (i.e., whether a given file meets the specified cutoff threshold for inclusion) variables</span>
<span id="cb77-238"><a href="#cb77-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-239"><a href="#cb77-239" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-240"><a href="#cb77-240" aria-hidden="true" tabindex="-1"></a><span class="in">   % Subset to ID and threshold information</span></span>
<span id="cb77-241"><a href="#cb77-241" aria-hidden="true" tabindex="-1"></a><span class="in">   testInfo = qcTable(:, ["idWave", "File", "Test"]);</span></span>
<span id="cb77-242"><a href="#cb77-242" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-243"><a href="#cb77-243" aria-hidden="true" tabindex="-1"></a><span class="in">   fprintf('Assessment Complete \n');</span></span>
<span id="cb77-244"><a href="#cb77-244" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-245"><a href="#cb77-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-246"><a href="#cb77-246" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Generate a list of files outputted by HAPPE</span>
<span id="cb77-247"><a href="#cb77-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-248"><a href="#cb77-248" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-249"><a href="#cb77-249" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate path for HAPPE pre-processing output (using the HAPPE environment variable from user's input of location of raw data for processing)</span></span>
<span id="cb77-250"><a href="#cb77-250" aria-hidden="true" tabindex="-1"></a><span class="in">   inputPath = strcat(srcDir, "\5 - processed");</span></span>
<span id="cb77-251"><a href="#cb77-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-252"><a href="#cb77-252" aria-hidden="true" tabindex="-1"></a><span class="in">   % Read in list of files outputted from HAPPE </span></span>
<span id="cb77-253"><a href="#cb77-253" aria-hidden="true" tabindex="-1"></a><span class="in">   preprocessingOutput = dir(inputPath);</span></span>
<span id="cb77-254"><a href="#cb77-254" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-255"><a href="#cb77-255" aria-hidden="true" tabindex="-1"></a><span class="in">   % Remove "empty" rows </span></span>
<span id="cb77-256"><a href="#cb77-256" aria-hidden="true" tabindex="-1"></a><span class="in">   preprocessingOutput = preprocessingOutput(~ismember({preprocessingOutput.name}, {'.', '..'}));</span></span>
<span id="cb77-257"><a href="#cb77-257" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-258"><a href="#cb77-258" aria-hidden="true" tabindex="-1"></a><span class="in">   % Save data as a table for ease of later use</span></span>
<span id="cb77-259"><a href="#cb77-259" aria-hidden="true" tabindex="-1"></a><span class="in">   preprocessingOutput = struct2table(preprocessingOutput);</span></span>
<span id="cb77-260"><a href="#cb77-260" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-261"><a href="#cb77-261" aria-hidden="true" tabindex="-1"></a><span class="in">   % Subset to file info</span></span>
<span id="cb77-262"><a href="#cb77-262" aria-hidden="true" tabindex="-1"></a><span class="in">   fileInfo = preprocessingOutput(:, ["name", "folder"]);</span></span>
<span id="cb77-263"><a href="#cb77-263" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-264"><a href="#cb77-264" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Select only desired files to be moved/copied</span>
<span id="cb77-265"><a href="#cb77-265" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Currently, we don't do anything with the "Individual Trial" files outputted by HAPPE.</span>
<span id="cb77-266"><a href="#cb77-266" aria-hidden="true" tabindex="-1"></a>   These files are quite large and take a long time to move, so it is more efficient to just remove them from the list of filenames and not worry about moving them anywhere.</span>
<span id="cb77-267"><a href="#cb77-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-268"><a href="#cb77-268" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-269"><a href="#cb77-269" aria-hidden="true" tabindex="-1"></a><span class="in">   % Subset to desired files (AveOverTrial)</span></span>
<span id="cb77-270"><a href="#cb77-270" aria-hidden="true" tabindex="-1"></a><span class="in">   fileSubset = fileInfo(contains(fileInfo.name, "AveOverTrials"), :);</span></span>
<span id="cb77-271"><a href="#cb77-271" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-272"><a href="#cb77-272" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Add condition, ID, and threshold-related variables to the file data</span>
<span id="cb77-273"><a href="#cb77-273" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>NOTE: The value for <span class="in">`Condition`</span> variable (i.e., "Target" or "Frequent") should match the name of the condition-specific folders you wish the files to save to within the processing repo.</span>
<span id="cb77-274"><a href="#cb77-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-275"><a href="#cb77-275" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb77-276"><a href="#cb77-276" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-277"><a href="#cb77-277" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate list of IDs based on file name variable</span></span>
<span id="cb77-278"><a href="#cb77-278" aria-hidden="true" tabindex="-1"></a><span class="in">   idWaveFS = extractBefore(fileSubset.name, 8);</span></span>
<span id="cb77-279"><a href="#cb77-279" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-280"><a href="#cb77-280" aria-hidden="true" tabindex="-1"></a><span class="in">   % Add ID list to file data</span></span>
<span id="cb77-281"><a href="#cb77-281" aria-hidden="true" tabindex="-1"></a><span class="in">   fileSubset.idWave = idWaveFS;</span></span>
<span id="cb77-282"><a href="#cb77-282" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-283"><a href="#cb77-283" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate list of files belonging to each condition based on file name variable</span></span>
<span id="cb77-284"><a href="#cb77-284" aria-hidden="true" tabindex="-1"></a><span class="in">   target = contains(fileSubset.name, "tgt+");</span></span>
<span id="cb77-285"><a href="#cb77-285" aria-hidden="true" tabindex="-1"></a><span class="in">   frequent = contains(fileSubset.name, "frq+");</span></span>
<span id="cb77-286"><a href="#cb77-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-287"><a href="#cb77-287" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create empty variable for condition</span></span>
<span id="cb77-288"><a href="#cb77-288" aria-hidden="true" tabindex="-1"></a><span class="in">   fileSubset.cond = cell(size(fileSubset, 1), 1);</span></span>
<span id="cb77-289"><a href="#cb77-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-290"><a href="#cb77-290" aria-hidden="true" tabindex="-1"></a><span class="in">   % Fill in condition variable based on the lists generated above</span></span>
<span id="cb77-291"><a href="#cb77-291" aria-hidden="true" tabindex="-1"></a><span class="in">   fileSubset.cond(target) = {'Target'};</span></span>
<span id="cb77-292"><a href="#cb77-292" aria-hidden="true" tabindex="-1"></a><span class="in">   fileSubset.cond(frequent) = {'Frequent'};</span></span>
<span id="cb77-293"><a href="#cb77-293" aria-hidden="true" tabindex="-1"></a><span class="in">   fileSubset.cond(~target &amp; ~frequent) = {'All'};</span></span>
<span id="cb77-294"><a href="#cb77-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-295"><a href="#cb77-295" aria-hidden="true" tabindex="-1"></a><span class="in">   % Join threshold test information</span></span>
<span id="cb77-296"><a href="#cb77-296" aria-hidden="true" tabindex="-1"></a><span class="in">   fileTest = join(fileSubset, testInfo);</span></span>
<span id="cb77-297"><a href="#cb77-297" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-298"><a href="#cb77-298" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Prepare data table with information about files that met the threshold</span>
<span id="cb77-299"><a href="#cb77-299" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The data generated here are preparing to copy the .txt files outputted by HAPPE into a folder containing all files that are suitable for PCA</span>
<span id="cb77-300"><a href="#cb77-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-301"><a href="#cb77-301" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-302"><a href="#cb77-302" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create a separate table for only files that meet threshold</span></span>
<span id="cb77-303"><a href="#cb77-303" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo = fileTest(fileTest.Test, :);</span></span>
<span id="cb77-304"><a href="#cb77-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-305"><a href="#cb77-305" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create empty columns for filepath variables</span></span>
<span id="cb77-306"><a href="#cb77-306" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.destination = cell(size(movingInfo, 1), 1);</span></span>
<span id="cb77-307"><a href="#cb77-307" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.origin = cell(size(movingInfo, 1), 1);</span></span>
<span id="cb77-308"><a href="#cb77-308" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.processedTo = cell(size(movingInfo, 1), 1);</span></span>
<span id="cb77-309"><a href="#cb77-309" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.processedFrom = cell(size(movingInfo, 1), 1);</span></span>
<span id="cb77-310"><a href="#cb77-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-311"><a href="#cb77-311" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate file paths based on condition </span></span>
<span id="cb77-312"><a href="#cb77-312" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.destination = strcat({passPath}, "\", movingInfo.cond, "\", movingInfo.name);</span></span>
<span id="cb77-313"><a href="#cb77-313" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.origin = strcat(movingInfo.folder, "\", movingInfo.name);</span></span>
<span id="cb77-314"><a href="#cb77-314" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.processedTo = strcat({allPath}, "\", movingInfo.name);</span></span>
<span id="cb77-315"><a href="#cb77-315" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.processedFrom = strcat(movingInfo.folder, "\", movingInfo.name);</span></span>
<span id="cb77-316"><a href="#cb77-316" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-317"><a href="#cb77-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-318"><a href="#cb77-318" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Prepare data table with information about files that do NOT meet the threshold</span>
<span id="cb77-319"><a href="#cb77-319" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The data generated here are preparing to copy .mff files from the location of the raw files into a folder indicating the need for manual processing</span>
<span id="cb77-320"><a href="#cb77-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-321"><a href="#cb77-321" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-322"><a href="#cb77-322" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create a separate table for only files that did not meet threshold</span></span>
<span id="cb77-323"><a href="#cb77-323" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles = fileTest(~fileTest.Test, ["File", "folder", "name"]);</span></span>
<span id="cb77-324"><a href="#cb77-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-325"><a href="#cb77-325" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create empty columns for filepath variables</span></span>
<span id="cb77-326"><a href="#cb77-326" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.destination = cell(size(failFiles, 1), 1);</span></span>
<span id="cb77-327"><a href="#cb77-327" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.origin = cell(size(failFiles, 1), 1);</span></span>
<span id="cb77-328"><a href="#cb77-328" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.processedTo = cell(size(failFiles, 1), 1);</span></span>
<span id="cb77-329"><a href="#cb77-329" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.processedFrom = cell(size(failFiles, 1), 1);</span></span>
<span id="cb77-330"><a href="#cb77-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-331"><a href="#cb77-331" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate filepaths based on ID and task</span></span>
<span id="cb77-332"><a href="#cb77-332" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.destination = strcat({failPath}, "\", failFiles.File);</span></span>
<span id="cb77-333"><a href="#cb77-333" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.origin = strcat({srcDir}, "\", failFiles.File);</span></span>
<span id="cb77-334"><a href="#cb77-334" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.processedFrom = strcat(failFiles.folder, "\", failFiles.name);</span></span>
<span id="cb77-335"><a href="#cb77-335" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.processedTo = strcat({allPath}, "\", failFiles.name);</span></span>
<span id="cb77-336"><a href="#cb77-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-337"><a href="#cb77-337" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-338"><a href="#cb77-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-339"><a href="#cb77-339" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Generate environment variables that correspond to the column index of relevant variables for file sorting</span>
<span id="cb77-340"><a href="#cb77-340" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Note that the very last line of this code defines the varaible(s) to exclude from the HAPPE outputted files.</span>
<span id="cb77-341"><a href="#cb77-341" aria-hidden="true" tabindex="-1"></a>   This variable must be stripped from the data before saving them, because the presence of the extra variable makes the file incompatible with EP Toolkit's PCA process.</span>
<span id="cb77-342"><a href="#cb77-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-343"><a href="#cb77-343" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-344"><a href="#cb77-344" aria-hidden="true" tabindex="-1"></a><span class="in">   % Define column locations for each filepath variable</span></span>
<span id="cb77-345"><a href="#cb77-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-346"><a href="#cb77-346" aria-hidden="true" tabindex="-1"></a><span class="in">   % For files that meet threshold:</span></span>
<span id="cb77-347"><a href="#cb77-347" aria-hidden="true" tabindex="-1"></a><span class="in">   toCol = find(strcmp(movingInfo.Properties.VariableNames, "destination"));</span></span>
<span id="cb77-348"><a href="#cb77-348" aria-hidden="true" tabindex="-1"></a><span class="in">   fromCol = find(strcmp(movingInfo.Properties.VariableNames, "origin"));</span></span>
<span id="cb77-349"><a href="#cb77-349" aria-hidden="true" tabindex="-1"></a><span class="in">   procColto = find(strcmp(movingInfo.Properties.VariableNames, "processedTo"));</span></span>
<span id="cb77-350"><a href="#cb77-350" aria-hidden="true" tabindex="-1"></a><span class="in">   procColfrom = find(strcmp(movingInfo.Properties.VariableNames, "processedFrom"));</span></span>
<span id="cb77-351"><a href="#cb77-351" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-352"><a href="#cb77-352" aria-hidden="true" tabindex="-1"></a><span class="in">   % For files that do not meet threshold</span></span>
<span id="cb77-353"><a href="#cb77-353" aria-hidden="true" tabindex="-1"></a><span class="in">   rawCol = find(strcmp(failFiles.Properties.VariableNames, "origin"));</span></span>
<span id="cb77-354"><a href="#cb77-354" aria-hidden="true" tabindex="-1"></a><span class="in">   manCol = find(strcmp(failFiles.Properties.VariableNames, "destination"));</span></span>
<span id="cb77-355"><a href="#cb77-355" aria-hidden="true" tabindex="-1"></a><span class="in">   failProcColto = find(strcmp(failFiles.Properties.VariableNames, "processedTo"));</span></span>
<span id="cb77-356"><a href="#cb77-356" aria-hidden="true" tabindex="-1"></a><span class="in">   failProcColFrom = find(strcmp(failFiles.Properties.VariableNames, "processedFrom"));</span></span>
<span id="cb77-357"><a href="#cb77-357" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-358"><a href="#cb77-358" aria-hidden="true" tabindex="-1"></a><span class="in">   % Define variable to exclude</span></span>
<span id="cb77-359"><a href="#cb77-359" aria-hidden="true" tabindex="-1"></a><span class="in">   extraVar = 'Time';</span></span>
<span id="cb77-360"><a href="#cb77-360" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-361"><a href="#cb77-361" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use a loop to process all files that met threshold</span>
<span id="cb77-362"><a href="#cb77-362" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>For each row in the "movingInfo" dataset, the loop will:</span>
<span id="cb77-363"><a href="#cb77-363" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>Identify the origin and destination paths</span>
<span id="cb77-364"><a href="#cb77-364" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>Read in the HAPPE output file</span>
<span id="cb77-365"><a href="#cb77-365" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>Remove the extra variable</span>
<span id="cb77-366"><a href="#cb77-366" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>Save the "cleaned" data in the appropriate folder (without variable names, as required by EP Toolkit) </span>
<span id="cb77-367"><a href="#cb77-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-368"><a href="#cb77-368" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-369"><a href="#cb77-369" aria-hidden="true" tabindex="-1"></a><span class="in">   for row = 1:height(movingInfo)</span></span>
<span id="cb77-370"><a href="#cb77-370" aria-hidden="true" tabindex="-1"></a><span class="in">       % Specify path info</span></span>
<span id="cb77-371"><a href="#cb77-371" aria-hidden="true" tabindex="-1"></a><span class="in">       pathFrom = movingInfo{row, fromCol};</span></span>
<span id="cb77-372"><a href="#cb77-372" aria-hidden="true" tabindex="-1"></a><span class="in">       pathTo = movingInfo{row, toCol};</span></span>
<span id="cb77-373"><a href="#cb77-373" aria-hidden="true" tabindex="-1"></a><span class="in">       % Read in the data</span></span>
<span id="cb77-374"><a href="#cb77-374" aria-hidden="true" tabindex="-1"></a><span class="in">       rawTable = readtable(pathFrom);</span></span>
<span id="cb77-375"><a href="#cb77-375" aria-hidden="true" tabindex="-1"></a><span class="in">       % Remove extra column (Time)</span></span>
<span id="cb77-376"><a href="#cb77-376" aria-hidden="true" tabindex="-1"></a><span class="in">       cleanTable = rawTable{:, ~strcmp(rawTable.Properties.VariableNames, extraVar)};</span></span>
<span id="cb77-377"><a href="#cb77-377" aria-hidden="true" tabindex="-1"></a><span class="in">       % Save without headers</span></span>
<span id="cb77-378"><a href="#cb77-378" aria-hidden="true" tabindex="-1"></a><span class="in">       writematrix(cleanTable, pathTo, 'Delimiter', '\t')</span></span>
<span id="cb77-379"><a href="#cb77-379" aria-hidden="true" tabindex="-1"></a><span class="in">   end</span></span>
<span id="cb77-380"><a href="#cb77-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-381"><a href="#cb77-381" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-382"><a href="#cb77-382" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use a loop to copy raw (.mff) files into a location that stores files requiring manual processing</span>
<span id="cb77-383"><a href="#cb77-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-384"><a href="#cb77-384" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-385"><a href="#cb77-385" aria-hidden="true" tabindex="-1"></a><span class="in">   for row = 1:height(failFiles)</span></span>
<span id="cb77-386"><a href="#cb77-386" aria-hidden="true" tabindex="-1"></a><span class="in">       % Specify path info</span></span>
<span id="cb77-387"><a href="#cb77-387" aria-hidden="true" tabindex="-1"></a><span class="in">       pathFrom = failFiles{row, rawCol};</span></span>
<span id="cb77-388"><a href="#cb77-388" aria-hidden="true" tabindex="-1"></a><span class="in">       pathTo = failFiles{row, manCol};</span></span>
<span id="cb77-389"><a href="#cb77-389" aria-hidden="true" tabindex="-1"></a><span class="in">       % Copy file </span></span>
<span id="cb77-390"><a href="#cb77-390" aria-hidden="true" tabindex="-1"></a><span class="in">       copyfile(pathFrom, pathTo)</span></span>
<span id="cb77-391"><a href="#cb77-391" aria-hidden="true" tabindex="-1"></a><span class="in">   end</span></span>
<span id="cb77-392"><a href="#cb77-392" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-393"><a href="#cb77-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-394"><a href="#cb77-394" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use a set of loops to copy all HAPPE output files into a folder intended to house all output (whether threshold is met or not)</span>
<span id="cb77-395"><a href="#cb77-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-396"><a href="#cb77-396" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-397"><a href="#cb77-397" aria-hidden="true" tabindex="-1"></a><span class="in">   for row = 1:height(movingInfo)</span></span>
<span id="cb77-398"><a href="#cb77-398" aria-hidden="true" tabindex="-1"></a><span class="in">       % Specify path info</span></span>
<span id="cb77-399"><a href="#cb77-399" aria-hidden="true" tabindex="-1"></a><span class="in">       pathFrom = movingInfo{row, procColfrom};</span></span>
<span id="cb77-400"><a href="#cb77-400" aria-hidden="true" tabindex="-1"></a><span class="in">       pathTo = movingInfo{row, procColto};</span></span>
<span id="cb77-401"><a href="#cb77-401" aria-hidden="true" tabindex="-1"></a><span class="in">       % Copy file</span></span>
<span id="cb77-402"><a href="#cb77-402" aria-hidden="true" tabindex="-1"></a><span class="in">       copyfile(pathFrom, pathTo);</span></span>
<span id="cb77-403"><a href="#cb77-403" aria-hidden="true" tabindex="-1"></a><span class="in">   end</span></span>
<span id="cb77-404"><a href="#cb77-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-405"><a href="#cb77-405" aria-hidden="true" tabindex="-1"></a><span class="in">   for row = 1:height(failFiles)</span></span>
<span id="cb77-406"><a href="#cb77-406" aria-hidden="true" tabindex="-1"></a><span class="in">       % Specify path info</span></span>
<span id="cb77-407"><a href="#cb77-407" aria-hidden="true" tabindex="-1"></a><span class="in">       pathFrom = failFiles{row, failProcColFrom};</span></span>
<span id="cb77-408"><a href="#cb77-408" aria-hidden="true" tabindex="-1"></a><span class="in">       pathTo = failFiles{row, failProcColto};</span></span>
<span id="cb77-409"><a href="#cb77-409" aria-hidden="true" tabindex="-1"></a><span class="in">       % Copy file</span></span>
<span id="cb77-410"><a href="#cb77-410" aria-hidden="true" tabindex="-1"></a><span class="in">       copyfile(pathFrom, pathTo);</span></span>
<span id="cb77-411"><a href="#cb77-411" aria-hidden="true" tabindex="-1"></a><span class="in">   end</span></span>
<span id="cb77-412"><a href="#cb77-412" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-413"><a href="#cb77-413" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Generate a .txt file listing all processed .mff files</span>
<span id="cb77-414"><a href="#cb77-414" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This file will contain a list of all raw files (e.g., <span class="in">`1111_22_oddball.mff`</span>) and save the list to the specified location (<span class="in">`summPath`</span>)</span>
<span id="cb77-415"><a href="#cb77-415" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The file will have the current date and time appended to the end so that it will be distinguishable from past logs </span>
<span id="cb77-416"><a href="#cb77-416" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The list of processed files is generated using an environment object (<span class="in">`FileNames`</span>) that the HAPPE pipeline creates that lists all files inputted to the pipeline</span>
<span id="cb77-417"><a href="#cb77-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-418"><a href="#cb77-418" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-419"><a href="#cb77-419" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create a table from HAPPE FileNames cell array</span></span>
<span id="cb77-420"><a href="#cb77-420" aria-hidden="true" tabindex="-1"></a><span class="in">   processedList = cell2table(FileNames(:));</span></span>
<span id="cb77-421"><a href="#cb77-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-422"><a href="#cb77-422" aria-hidden="true" tabindex="-1"></a><span class="in">   % Rename file variable from default</span></span>
<span id="cb77-423"><a href="#cb77-423" aria-hidden="true" tabindex="-1"></a><span class="in">   processedList = renamevars(processedList, {'Var1'}, {'File'});</span></span>
<span id="cb77-424"><a href="#cb77-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-425"><a href="#cb77-425" aria-hidden="true" tabindex="-1"></a><span class="in">   % Save current date as a string variable </span></span>
<span id="cb77-426"><a href="#cb77-426" aria-hidden="true" tabindex="-1"></a><span class="in">   today = string(date());</span></span>
<span id="cb77-427"><a href="#cb77-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-428"><a href="#cb77-428" aria-hidden="true" tabindex="-1"></a><span class="in">   % Save time as a string variable, replacing ":" with "_" so that file can be written </span></span>
<span id="cb77-429"><a href="#cb77-429" aria-hidden="true" tabindex="-1"></a><span class="in">   time = strrep(datestr(now, 'HH:MM:SS:FFF'), ':', "_");</span></span>
<span id="cb77-430"><a href="#cb77-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-431"><a href="#cb77-431" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate file name to include current date and time </span></span>
<span id="cb77-432"><a href="#cb77-432" aria-hidden="true" tabindex="-1"></a><span class="in">   listFile = strcat("\oddballProcessed_", today, "_", time);</span></span>
<span id="cb77-433"><a href="#cb77-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-434"><a href="#cb77-434" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate full path including file name</span></span>
<span id="cb77-435"><a href="#cb77-435" aria-hidden="true" tabindex="-1"></a><span class="in">   summPathFull = strcat(summPath, listFile);</span></span>
<span id="cb77-436"><a href="#cb77-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-437"><a href="#cb77-437" aria-hidden="true" tabindex="-1"></a><span class="in">   % Write table to specified location</span></span>
<span id="cb77-438"><a href="#cb77-438" aria-hidden="true" tabindex="-1"></a><span class="in">   writetable(processedList, summPathFull);</span></span>
<span id="cb77-439"><a href="#cb77-439" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-440"><a href="#cb77-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-441"><a href="#cb77-441" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Generate a .txt file listing all of the files that did not meet threshold to go through subsequent processing</span>
<span id="cb77-442"><a href="#cb77-442" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This file will contain a list of all raw files (e.g., <span class="in">`1111_22_oddball.mff`</span>) that did not meet threshold and save the list to the specified location (<span class="in">`manPath`</span>)</span>
<span id="cb77-443"><a href="#cb77-443" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The file will have the current date and time appended to the end so that it will be distinguishable from past lists</span>
<span id="cb77-444"><a href="#cb77-444" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This list of file to process manually is generated using the environment object <span class="in">`FileNames`</span> that HAPPE creates; any files listed in <span class="in">`FileNames`</span> but not in the dataset of files that pass threshold make up the <span class="in">`manualList`</span></span>
<span id="cb77-445"><a href="#cb77-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-446"><a href="#cb77-446" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-447"><a href="#cb77-447" aria-hidden="true" tabindex="-1"></a><span class="in">   % Compare movingInfo with FileNames to isolate files that don't meet threshold</span></span>
<span id="cb77-448"><a href="#cb77-448" aria-hidden="true" tabindex="-1"></a><span class="in">   manualList = cell2table(FileNames(~ismember(FileNames', movingInfo.File)));</span></span>
<span id="cb77-449"><a href="#cb77-449" aria-hidden="true" tabindex="-1"></a><span class="in">   manualList = renamevars(manualList, {'Var1'}, {'File'});</span></span>
<span id="cb77-450"><a href="#cb77-450" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-451"><a href="#cb77-451" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate file name to include current date</span></span>
<span id="cb77-452"><a href="#cb77-452" aria-hidden="true" tabindex="-1"></a><span class="in">   manFile = strcat("\oddballManual_", today, "_", time);</span></span>
<span id="cb77-453"><a href="#cb77-453" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-454"><a href="#cb77-454" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate full path including filename</span></span>
<span id="cb77-455"><a href="#cb77-455" aria-hidden="true" tabindex="-1"></a><span class="in">   manPathFull = strcat(manPath, manFile);</span></span>
<span id="cb77-456"><a href="#cb77-456" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-457"><a href="#cb77-457" aria-hidden="true" tabindex="-1"></a><span class="in">   % Write table to specified location</span></span>
<span id="cb77-458"><a href="#cb77-458" aria-hidden="true" tabindex="-1"></a><span class="in">   writetable(manualList, manPathFull);</span></span>
<span id="cb77-459"><a href="#cb77-459" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-460"><a href="#cb77-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-461"><a href="#cb77-461" aria-hidden="true" tabindex="-1"></a><span class="fu">## FishShark Processing Pipeline</span></span>
<span id="cb77-462"><a href="#cb77-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-463"><a href="#cb77-463" aria-hidden="true" tabindex="-1"></a><span class="fu">### Recommended Folder Strucure</span></span>
<span id="cb77-464"><a href="#cb77-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-465"><a href="#cb77-465" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`0 - Raw`</span></span>
<span id="cb77-466"><a href="#cb77-466" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`1a - Files for HAPPE`</span></span>
<span id="cb77-467"><a href="#cb77-467" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`1b - Manual Processing`</span></span>
<span id="cb77-468"><a href="#cb77-468" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`2 - Processed Files`</span></span>
<span id="cb77-469"><a href="#cb77-469" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`3 - Files for PCA`</span></span>
<span id="cb77-470"><a href="#cb77-470" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`4 - EPT Averages`</span></span>
<span id="cb77-471"><a href="#cb77-471" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`5 - PCA`</span></span>
<span id="cb77-472"><a href="#cb77-472" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`6 - PCA Components`</span></span>
<span id="cb77-473"><a href="#cb77-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-474"><a href="#cb77-474" aria-hidden="true" tabindex="-1"></a><span class="fu">### MATLAB Script</span></span>
<span id="cb77-475"><a href="#cb77-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-476"><a href="#cb77-476" aria-hidden="true" tabindex="-1"></a>The following section describes the MATLAB scripts used to manage HAPPE input and output files for the FishShark task data. If you are running HAPPE manually (i.e., without integrating these scripts), skip to the <span class="co">[</span><span class="ot">FishShark HAPPE inputs</span><span class="co">](#sec-inputFishSharkHAPPE)</span> section.</span>
<span id="cb77-477"><a href="#cb77-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-478"><a href="#cb77-478" aria-hidden="true" tabindex="-1"></a>**The first two steps described in this section are the same as those described for Oddball processing.**</span>
<span id="cb77-479"><a href="#cb77-479" aria-hidden="true" tabindex="-1"></a>**Processing actions specific to FishSharks task begin in Step 3.**</span>
<span id="cb77-480"><a href="#cb77-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-481"><a href="#cb77-481" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Open the <span class="in">`eegProccessingFishshark.m`</span> file (accessible via Git <span class="co">[</span><span class="ot">here</span><span class="co">](https://research-git.uiowa.edu/PetersenLab/SRS/SRS-DataProcessing/-/blob/master/6.%20MATLAB%20EEG%20Pipeline/eegProcessingFishshark.m)</span>) in MATLAB</span>
<span id="cb77-482"><a href="#cb77-482" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Update all thresholds and filepaths in script file (must be done BEFORE running the script)</span>
<span id="cb77-483"><a href="#cb77-483" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>In the fifth section of our script file, we set our "threshold" for the minimum number of trials that need to be retained after pre-processing for a subject's data to be eligible for PCA.</span>
<span id="cb77-484"><a href="#cb77-484" aria-hidden="true" tabindex="-1"></a>   Additional thresholds can also be set for things like number of channels retained, but these are not currently in use.</span>
<span id="cb77-485"><a href="#cb77-485" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Note that setting these parameters occurs later in the FishSharks script than the one for Oddball; </span>
<span id="cb77-486"><a href="#cb77-486" aria-hidden="true" tabindex="-1"></a>   this is because FishSharks files require additional processing before they are ready for HAPPE (see step 3 for details)</span>
<span id="cb77-487"><a href="#cb77-487" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb77-488"><a href="#cb77-488" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-489"><a href="#cb77-489" aria-hidden="true" tabindex="-1"></a><span class="in">   % Set quality threshold parameters</span></span>
<span id="cb77-490"><a href="#cb77-490" aria-hidden="true" tabindex="-1"></a><span class="in">   trialCutoff = 10;</span></span>
<span id="cb77-491"><a href="#cb77-491" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-492"><a href="#cb77-492" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>We also set environment variables with all of the filepaths that are relevant for managing HAPPE output files and tracking processed data.</span>
<span id="cb77-493"><a href="#cb77-493" aria-hidden="true" tabindex="-1"></a>   The following paths should be checked and updated as necessary to reflect the organization of processing on your computer.</span>
<span id="cb77-494"><a href="#cb77-494" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span><span class="in">`passPath`</span> is the location you wish to have files that meet or exceed the above-defined thresholds to be saved</span>
<span id="cb77-495"><a href="#cb77-495" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span><span class="in">`allPath`</span> is the location you wish to have ALL files outputted from HAPPE saved to (regardless of whether threshold is met or not)</span>
<span id="cb77-496"><a href="#cb77-496" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span><span class="in">`failPath`</span> is the location you wish to have files that do not meet the above-defined thresholds to be copied to</span>
<span id="cb77-497"><a href="#cb77-497" aria-hidden="true" tabindex="-1"></a><span class="ss">         - </span>.mff files that do not meet threshold will be copied here as an indication that they should be processed manually to see if they meet threshold afterward</span>
<span id="cb77-498"><a href="#cb77-498" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span><span class="in">`summPath`</span> is the location you wish to save the file that lists all files processed through HAPPE in the current batch</span>
<span id="cb77-499"><a href="#cb77-499" aria-hidden="true" tabindex="-1"></a><span class="ss">         - </span>We currently use this to save the "processing log" to a location that all team members/computers have access to so it is easier to determine which files require processing when EEG data are not stored on a shared server</span>
<span id="cb77-500"><a href="#cb77-500" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span><span class="in">`manPath`</span> is the location you wish to save the file that lists all files that do not meet the above-defined thresholds</span>
<span id="cb77-501"><a href="#cb77-501" aria-hidden="true" tabindex="-1"></a><span class="ss">         - </span>We currently use this to save the "to process manually" list to a location that all team members/computers have access to so it is easier to determine which files require manual processing because the copied .mff file would not be acessible via our shared server</span>
<span id="cb77-502"><a href="#cb77-502" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb77-503"><a href="#cb77-503" aria-hidden="true" tabindex="-1"></a>    <span class="in">```</span></span>
<span id="cb77-504"><a href="#cb77-504" aria-hidden="true" tabindex="-1"></a><span class="in">    % Set paths for file sorting</span></span>
<span id="cb77-505"><a href="#cb77-505" aria-hidden="true" tabindex="-1"></a><span class="in">    passPath = 'V:\Processing-Repo\Folder Structure\3 - Files for PCA'; %location for .txt output files</span></span>
<span id="cb77-506"><a href="#cb77-506" aria-hidden="true" tabindex="-1"></a><span class="in">    allPath = 'V:\Processing-Repo\Folder Structure\2 - Processed Files'; %location for all processed files to end up</span></span>
<span id="cb77-507"><a href="#cb77-507" aria-hidden="true" tabindex="-1"></a><span class="in">    failPath = 'V:\Processing-Repo\Folder Structure\1b - Manual Processing'; %location to copy unsuccessful .mff to for manual process</span></span>
<span id="cb77-508"><a href="#cb77-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-509"><a href="#cb77-509" aria-hidden="true" tabindex="-1"></a><span class="in">    % Set path for processing summary</span></span>
<span id="cb77-510"><a href="#cb77-510" aria-hidden="true" tabindex="-1"></a><span class="in">    summPath = 'Z:\Shared Server\Study Folder\Data Processing\6. MATLAB EEG Pipeline\Processed Data Logs';</span></span>
<span id="cb77-511"><a href="#cb77-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-512"><a href="#cb77-512" aria-hidden="true" tabindex="-1"></a><span class="in">    % Set path for summary of files to process manually </span></span>
<span id="cb77-513"><a href="#cb77-513" aria-hidden="true" tabindex="-1"></a><span class="in">    manPath = 'Z:\Shared Server\Study Folder\Data Processing\6. MATLAB EEG Pipeline\Processing To Do\Cases to Process Manually\Lists of Cases by Batch';</span></span>
<span id="cb77-514"><a href="#cb77-514" aria-hidden="true" tabindex="-1"></a><span class="in">    ```</span></span>
<span id="cb77-515"><a href="#cb77-515" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Update raw (.mff) files' condition tags with accuracy information</span>
<span id="cb77-516"><a href="#cb77-516" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Unlike the Passive Oddball task, FishSharks trials can be either correct or incorrect. </span>
<span id="cb77-517"><a href="#cb77-517" aria-hidden="true" tabindex="-1"></a>   Whether or not a trial was "responded to" correctly is relevant to the nature of the extracted ERP.</span>
<span id="cb77-518"><a href="#cb77-518" aria-hidden="true" tabindex="-1"></a>   Because the event tags in our .mff files do not inherently contain information about whether each trial was responded to correctly, we need to add it ourselves.</span>
<span id="cb77-519"><a href="#cb77-519" aria-hidden="true" tabindex="-1"></a>   This process can be done manually in NetStation, but it can also be automated using the MATLAB code detailed below.</span>
<span id="cb77-520"><a href="#cb77-520" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>NOTE: This code requires eeglab.</span>
<span id="cb77-521"><a href="#cb77-521" aria-hidden="true" tabindex="-1"></a>   **Before running the code, open eeglab in your MATLAB session by typing `eeglab` into the console.**</span>
<span id="cb77-522"><a href="#cb77-522" aria-hidden="true" tabindex="-1"></a>   You can close it as soon as it opens, but this step ensures that eeglab is loaded into your current session and helps prevent the subsequent code from erroring out.</span>
<span id="cb77-523"><a href="#cb77-523" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb77-524"><a href="#cb77-524" aria-hidden="true" tabindex="-1"></a><span class="ss">   1. </span>Set the filepaths for raw and updated .mff files</span>
<span id="cb77-525"><a href="#cb77-525" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>This section is set to rely on user inputs.</span>
<span id="cb77-526"><a href="#cb77-526" aria-hidden="true" tabindex="-1"></a>      Click "Run" in the MATLAB editor to start the processing.</span>
<span id="cb77-527"><a href="#cb77-527" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>A message will appear in the console prompting you to enter two filepaths: </span>
<span id="cb77-528"><a href="#cb77-528" aria-hidden="true" tabindex="-1"></a>      the first is the location of the raw .mff files, and the second is the location you would like the updated files to save in.</span>
<span id="cb77-529"><a href="#cb77-529" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>**Note: the filepaths inputted should NOT be in quotes**</span>
<span id="cb77-530"><a href="#cb77-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-531"><a href="#cb77-531" aria-hidden="true" tabindex="-1"></a>      <span class="in">```</span></span>
<span id="cb77-532"><a href="#cb77-532" aria-hidden="true" tabindex="-1"></a><span class="in">      % User input for location of raw files</span></span>
<span id="cb77-533"><a href="#cb77-533" aria-hidden="true" tabindex="-1"></a><span class="in">      pathRaw = input('Enter the full path to the folder containing the raw files:\n&gt; ','s');</span></span>
<span id="cb77-534"><a href="#cb77-534" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb77-535"><a href="#cb77-535" aria-hidden="true" tabindex="-1"></a><span class="in">      % User input for destination of subsetted files</span></span>
<span id="cb77-536"><a href="#cb77-536" aria-hidden="true" tabindex="-1"></a><span class="in">      pathSub = input('Enter the full path to the folder in which to save the updated files:\n&gt; ','s');</span></span>
<span id="cb77-537"><a href="#cb77-537" aria-hidden="true" tabindex="-1"></a><span class="in">      ```</span></span>
<span id="cb77-538"><a href="#cb77-538" aria-hidden="true" tabindex="-1"></a>       At this point, there will be no user input/actions necessary until all of the .mff files in the <span class="in">`pathRaw`</span> directory have been updated and saved into the <span class="in">`pathSub`</span> directory.</span>
<span id="cb77-539"><a href="#cb77-539" aria-hidden="true" tabindex="-1"></a>       The code that asks the user for the path to HAPPE will run when that process has finished.</span>
<span id="cb77-540"><a href="#cb77-540" aria-hidden="true" tabindex="-1"></a>       The following section will describe the code used to automate the process of updating .mff event tags to include accuracy information at the trial level.</span>
<span id="cb77-541"><a href="#cb77-541" aria-hidden="true" tabindex="-1"></a>       Move on to Step 4 (Run the HAPPE Pipeline) when the process has completed.</span>
<span id="cb77-542"><a href="#cb77-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-543"><a href="#cb77-543" aria-hidden="true" tabindex="-1"></a><span class="ss">   1. </span>Gather and manage information from the directory housing the raw (.mff) files</span>
<span id="cb77-544"><a href="#cb77-544" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-545"><a href="#cb77-545" aria-hidden="true" tabindex="-1"></a>      <span class="in">```</span></span>
<span id="cb77-546"><a href="#cb77-546" aria-hidden="true" tabindex="-1"></a><span class="in">      % Have MATLAB gather a list of raw files housed in specified location (pathRaw)</span></span>
<span id="cb77-547"><a href="#cb77-547" aria-hidden="true" tabindex="-1"></a><span class="in">      dirInfo = struct2table(dir(pathRaw));</span></span>
<span id="cb77-548"><a href="#cb77-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-549"><a href="#cb77-549" aria-hidden="true" tabindex="-1"></a><span class="in">      % Remove blank rows</span></span>
<span id="cb77-550"><a href="#cb77-550" aria-hidden="true" tabindex="-1"></a><span class="in">      noName = strcmp(dirInfo.name, '.') | strcmp(dirInfo.name, '..');</span></span>
<span id="cb77-551"><a href="#cb77-551" aria-hidden="true" tabindex="-1"></a><span class="in">      dirInfo(noName, :) = [];</span></span>
<span id="cb77-552"><a href="#cb77-552" aria-hidden="true" tabindex="-1"></a><span class="in">      ```</span></span>
<span id="cb77-553"><a href="#cb77-553" aria-hidden="true" tabindex="-1"></a><span class="ss">   1. </span>Generate variables necessary for managing raw and updated files</span>
<span id="cb77-554"><a href="#cb77-554" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>This code will generate the full filepaths (including file name) necessary for reading in each .mff file and saving its updated counterpart</span>
<span id="cb77-555"><a href="#cb77-555" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>It will also generate an ID variable for joining purposes based on the expected location of the subject name in the name of each file </span>
<span id="cb77-556"><a href="#cb77-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-557"><a href="#cb77-557" aria-hidden="true" tabindex="-1"></a>      <span class="in">```</span></span>
<span id="cb77-558"><a href="#cb77-558" aria-hidden="true" tabindex="-1"></a><span class="in">      % Generate ID variable</span></span>
<span id="cb77-559"><a href="#cb77-559" aria-hidden="true" tabindex="-1"></a><span class="in">      dataFiles = dirInfo(:, "name");</span></span>
<span id="cb77-560"><a href="#cb77-560" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb77-561"><a href="#cb77-561" aria-hidden="true" tabindex="-1"></a><span class="in">      % Add ID variable to file data</span></span>
<span id="cb77-562"><a href="#cb77-562" aria-hidden="true" tabindex="-1"></a><span class="in">      dataFiles.ID = extractBefore(dataFiles.name, 8);</span></span>
<span id="cb77-563"><a href="#cb77-563" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb77-564"><a href="#cb77-564" aria-hidden="true" tabindex="-1"></a><span class="in">      % Generate path to read raw data</span></span>
<span id="cb77-565"><a href="#cb77-565" aria-hidden="true" tabindex="-1"></a><span class="in">      rawPaths = dataFiles;</span></span>
<span id="cb77-566"><a href="#cb77-566" aria-hidden="true" tabindex="-1"></a><span class="in">      rawPaths.path = strcat({pathRaw}, "/", dirInfo.name);</span></span>
<span id="cb77-567"><a href="#cb77-567" aria-hidden="true" tabindex="-1"></a><span class="in">      rawPaths = rawPaths(:, ["ID", "path"]);</span></span>
<span id="cb77-568"><a href="#cb77-568" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb77-569"><a href="#cb77-569" aria-hidden="true" tabindex="-1"></a><span class="in">      % Generate path to save updated versions of the data (containing accuracy info at trial level)</span></span>
<span id="cb77-570"><a href="#cb77-570" aria-hidden="true" tabindex="-1"></a><span class="in">      subPaths = dataFiles;</span></span>
<span id="cb77-571"><a href="#cb77-571" aria-hidden="true" tabindex="-1"></a><span class="in">      subPaths.path = strcat({pathSub}, "/", subPaths.ID, "_sub_fishshark.mff");</span></span>
<span id="cb77-572"><a href="#cb77-572" aria-hidden="true" tabindex="-1"></a><span class="in">      subPaths = subPaths(:, ["ID", "path"]);</span></span>
<span id="cb77-573"><a href="#cb77-573" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb77-574"><a href="#cb77-574" aria-hidden="true" tabindex="-1"></a><span class="in">      % Join filepath datatables</span></span>
<span id="cb77-575"><a href="#cb77-575" aria-hidden="true" tabindex="-1"></a><span class="in">      mergePaths = join(rawPaths, subPaths, 'Keys', {'ID'})</span></span>
<span id="cb77-576"><a href="#cb77-576" aria-hidden="true" tabindex="-1"></a><span class="in">      ```</span></span>
<span id="cb77-577"><a href="#cb77-577" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>Use a loop to update the event tags in each .mff file to reflect accuracy of response</span>
<span id="cb77-578"><a href="#cb77-578" aria-hidden="true" tabindex="-1"></a><span class="ss">       - </span>For every file included in the <span class="in">`mergePaths`</span> dataset, MATLAB will perform the following actions:</span>
<span id="cb77-579"><a href="#cb77-579" aria-hidden="true" tabindex="-1"></a><span class="ss">          - </span>Set environment variables representing the path to read in the original .mff file and save its updated counterpart (updates with each iteration of the loop)</span>
<span id="cb77-580"><a href="#cb77-580" aria-hidden="true" tabindex="-1"></a><span class="ss">          - </span>Read in the .mff file</span>
<span id="cb77-581"><a href="#cb77-581" aria-hidden="true" tabindex="-1"></a><span class="ss">          - </span>Extract the "event" information from the .mff file </span>
<span id="cb77-582"><a href="#cb77-582" aria-hidden="true" tabindex="-1"></a><span class="ss">          - </span>Evaluate whether there is usable data in the file </span>
<span id="cb77-583"><a href="#cb77-583" aria-hidden="true" tabindex="-1"></a><span class="ss">             - </span>This step prevents the code from erroring out if a subject did not make it past the practice trials</span>
<span id="cb77-584"><a href="#cb77-584" aria-hidden="true" tabindex="-1"></a><span class="ss">             - </span>If the evaluation determines that there is NOT usable data in the present file, the loop will jump to the next file</span>
<span id="cb77-585"><a href="#cb77-585" aria-hidden="true" tabindex="-1"></a><span class="ss">          - </span>Create a table containing response information (response vs no response and reaction time) and condition information (go vs no-go) at the trial level</span>
<span id="cb77-586"><a href="#cb77-586" aria-hidden="true" tabindex="-1"></a><span class="ss">          - </span>Evaluate each trial to determine whether the response was correct or incorrect</span>
<span id="cb77-587"><a href="#cb77-587" aria-hidden="true" tabindex="-1"></a><span class="ss">             - </span>For No-Go trials, responses are CORRECT if there was no response (incorrect if subject did respond)</span>
<span id="cb77-588"><a href="#cb77-588" aria-hidden="true" tabindex="-1"></a><span class="ss">             - </span>For Go trials, responses are CORRECT if there was a response AND subject's reaction time was at least 200 ms (incorrect if subject did not respond OR if subject responded too quickly for response to be considered "valid")</span>
<span id="cb77-589"><a href="#cb77-589" aria-hidden="true" tabindex="-1"></a><span class="ss">          - </span>Update the event tags in the .mff file to contain a "c" for correct trials and an "x" for incorrect trials </span>
<span id="cb77-590"><a href="#cb77-590" aria-hidden="true" tabindex="-1"></a><span class="ss">             - </span>The c/x indicator will be appended to the front of the existing event tag (e.g., <span class="in">`Go++`</span> will become <span class="in">`cGo++`</span>)</span>
<span id="cb77-591"><a href="#cb77-591" aria-hidden="true" tabindex="-1"></a><span class="ss">          - </span>Export an updated version of the .mff file with accuracy information to the specified location (<span class="in">`pathSub`</span>)</span>
<span id="cb77-592"><a href="#cb77-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-593"><a href="#cb77-593" aria-hidden="true" tabindex="-1"></a>         **NOTE: When exporting EEG data from MATLAB, it is absolutely necessary for the data to be organized in order of event latency.**</span>
<span id="cb77-594"><a href="#cb77-594" aria-hidden="true" tabindex="-1"></a>         **If the rows are out of order, latency errors may be introduced.**</span>
<span id="cb77-595"><a href="#cb77-595" aria-hidden="true" tabindex="-1"></a><span class="ss">         - </span>Correct row order can be achieved in .mff filetypes by sorting according to either the <span class="in">`latency`</span> column or the <span class="in">`urevent`</span> column (as shown below) </span>
<span id="cb77-596"><a href="#cb77-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-597"><a href="#cb77-597" aria-hidden="true" tabindex="-1"></a>       <span class="in">```</span></span>
<span id="cb77-598"><a href="#cb77-598" aria-hidden="true" tabindex="-1"></a><span class="in">       for row = 1:height(mergePaths)</span></span>
<span id="cb77-599"><a href="#cb77-599" aria-hidden="true" tabindex="-1"></a><span class="in">           % Specify paths</span></span>
<span id="cb77-600"><a href="#cb77-600" aria-hidden="true" tabindex="-1"></a><span class="in">           rawFolder = mergePaths{row, "path_rawPaths"}</span></span>
<span id="cb77-601"><a href="#cb77-601" aria-hidden="true" tabindex="-1"></a><span class="in">           subFolder = mergePaths{row, "path_subPaths"}</span></span>
<span id="cb77-602"><a href="#cb77-602" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb77-603"><a href="#cb77-603" aria-hidden="true" tabindex="-1"></a><span class="in">           % Read in EEG data</span></span>
<span id="cb77-604"><a href="#cb77-604" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGraw = pop_mffimport(char(rawFolder), 'code')</span></span>
<span id="cb77-605"><a href="#cb77-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-606"><a href="#cb77-606" aria-hidden="true" tabindex="-1"></a><span class="in">           % Create table from "event" field of raw data</span></span>
<span id="cb77-607"><a href="#cb77-607" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGevent = struct2table(EEGraw.event)</span></span>
<span id="cb77-608"><a href="#cb77-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-609"><a href="#cb77-609" aria-hidden="true" tabindex="-1"></a><span class="in">           % Check for the existence of usable rows</span></span>
<span id="cb77-610"><a href="#cb77-610" aria-hidden="true" tabindex="-1"></a><span class="in">           checkVars = strcmp(EEGevent.Properties.VariableNames, 'mffkey_cel')</span></span>
<span id="cb77-611"><a href="#cb77-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-612"><a href="#cb77-612" aria-hidden="true" tabindex="-1"></a><span class="in">           % Skip files without necessary variables</span></span>
<span id="cb77-613"><a href="#cb77-613" aria-hidden="true" tabindex="-1"></a><span class="in">           if max(checkVars) == 0</span></span>
<span id="cb77-614"><a href="#cb77-614" aria-hidden="true" tabindex="-1"></a><span class="in">               continue</span></span>
<span id="cb77-615"><a href="#cb77-615" aria-hidden="true" tabindex="-1"></a><span class="in">           end</span></span>
<span id="cb77-616"><a href="#cb77-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-617"><a href="#cb77-617" aria-hidden="true" tabindex="-1"></a><span class="in">           % Create table without practice/training trials</span></span>
<span id="cb77-618"><a href="#cb77-618" aria-hidden="true" tabindex="-1"></a><span class="in">           keepRows = strcmp(EEGevent.mffkey_cel, '4')</span></span>
<span id="cb77-619"><a href="#cb77-619" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGsub  = EEGevent(keepRows, :)</span></span>
<span id="cb77-620"><a href="#cb77-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-621"><a href="#cb77-621" aria-hidden="true" tabindex="-1"></a><span class="in">           % Check for the existence of usable rows</span></span>
<span id="cb77-622"><a href="#cb77-622" aria-hidden="true" tabindex="-1"></a><span class="in">           checkRows = max(keepRows)</span></span>
<span id="cb77-623"><a href="#cb77-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-624"><a href="#cb77-624" aria-hidden="true" tabindex="-1"></a><span class="in">           % Skip files with no usable rows</span></span>
<span id="cb77-625"><a href="#cb77-625" aria-hidden="true" tabindex="-1"></a><span class="in">           if checkRows == 0</span></span>
<span id="cb77-626"><a href="#cb77-626" aria-hidden="true" tabindex="-1"></a><span class="in">               continue</span></span>
<span id="cb77-627"><a href="#cb77-627" aria-hidden="true" tabindex="-1"></a><span class="in">           end</span></span>
<span id="cb77-628"><a href="#cb77-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-629"><a href="#cb77-629" aria-hidden="true" tabindex="-1"></a><span class="in">           % Get response info at trial level</span></span>
<span id="cb77-630"><a href="#cb77-630" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGresp = table(EEGsub.mffkey_obs, EEGsub.mffkey_eval, EEGsub.mffkey_rtim)</span></span>
<span id="cb77-631"><a href="#cb77-631" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGresp = rmmissing(EEGresp)</span></span>
<span id="cb77-632"><a href="#cb77-632" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGresp = renamevars(EEGresp, ["Var1", "Var2", "Var3"], ["Trial", "Eval", "RTime"])</span></span>
<span id="cb77-633"><a href="#cb77-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-634"><a href="#cb77-634" aria-hidden="true" tabindex="-1"></a><span class="in">           % Get condition info at trial level</span></span>
<span id="cb77-635"><a href="#cb77-635" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGconds = table(EEGsub.mffkey_obs, EEGsub.type)</span></span>
<span id="cb77-636"><a href="#cb77-636" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGconds = renamevars(EEGconds, ["Var1", "Var2"], ["Trial", "Cond"])</span></span>
<span id="cb77-637"><a href="#cb77-637" aria-hidden="true" tabindex="-1"></a><span class="in">           keepConds = strcmp(EEGconds.Cond, 'Go++') | strcmp(EEGconds.Cond, 'NG++')</span></span>
<span id="cb77-638"><a href="#cb77-638" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGcond = EEGconds(keepConds, :)</span></span>
<span id="cb77-639"><a href="#cb77-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-640"><a href="#cb77-640" aria-hidden="true" tabindex="-1"></a><span class="in">           % Merge datasets</span></span>
<span id="cb77-641"><a href="#cb77-641" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGtrials = join(EEGcond, EEGresp)</span></span>
<span id="cb77-642"><a href="#cb77-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-643"><a href="#cb77-643" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGtrials.RTime = cellfun(@str2num, EEGtrials.RTime)</span></span>
<span id="cb77-644"><a href="#cb77-644" aria-hidden="true" tabindex="-1"></a><span class="in">           % Evaluate trials for correct-ness of response</span></span>
<span id="cb77-645"><a href="#cb77-645" aria-hidden="true" tabindex="-1"></a><span class="in">           correct = strcmp(EEGtrials.Cond, 'Go++') &amp; strcmp(EEGtrials.Eval, '1') &amp; EEGtrials.RTime &gt; 200 | strcmp(EEGtrials.Cond, 'NG++') &amp; strcmp(EEGtrials.Eval, '0')</span></span>
<span id="cb77-646"><a href="#cb77-646" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGtrials.Acc = correct</span></span>
<span id="cb77-647"><a href="#cb77-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-648"><a href="#cb77-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-649"><a href="#cb77-649" aria-hidden="true" tabindex="-1"></a><span class="in">           % Create new code tags including accuracy information</span></span>
<span id="cb77-650"><a href="#cb77-650" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGtrials.newCode(EEGtrials.Acc &amp; strcmp(EEGtrials.Cond, 'Go++')) = {'cGo++'}</span></span>
<span id="cb77-651"><a href="#cb77-651" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGtrials.newCode(~EEGtrials.Acc &amp; strcmp(EEGtrials.Cond, 'Go++')) = {'xGo++'}</span></span>
<span id="cb77-652"><a href="#cb77-652" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGtrials.newCode(EEGtrials.Acc &amp; strcmp(EEGtrials.Cond, 'NG++')) = {'cNG++'}</span></span>
<span id="cb77-653"><a href="#cb77-653" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGtrials.newCode(~EEGtrials.Acc &amp; strcmp(EEGtrials.Cond, 'NG++')) = {'xNG++'}</span></span>
<span id="cb77-654"><a href="#cb77-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-655"><a href="#cb77-655" aria-hidden="true" tabindex="-1"></a><span class="in">           % Subset information for merge</span></span>
<span id="cb77-656"><a href="#cb77-656" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGmerge = EEGtrials(:, {'Trial', 'Cond', 'newCode'})</span></span>
<span id="cb77-657"><a href="#cb77-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-658"><a href="#cb77-658" aria-hidden="true" tabindex="-1"></a><span class="in">           % Prep key in original data</span></span>
<span id="cb77-659"><a href="#cb77-659" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGevent.key = strcat(EEGevent.mffkey_obs, EEGevent.type)</span></span>
<span id="cb77-660"><a href="#cb77-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-661"><a href="#cb77-661" aria-hidden="true" tabindex="-1"></a><span class="in">           % Prep key in merge data</span></span>
<span id="cb77-662"><a href="#cb77-662" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGmerge.key = strcat(EEGmerge.Trial, EEGmerge.Cond)</span></span>
<span id="cb77-663"><a href="#cb77-663" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGmerge = EEGmerge(:, {'key', 'newCode'})</span></span>
<span id="cb77-664"><a href="#cb77-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-665"><a href="#cb77-665" aria-hidden="true" tabindex="-1"></a><span class="in">           % Merge new codes with event table</span></span>
<span id="cb77-666"><a href="#cb77-666" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGnew = outerjoin(EEGevent, EEGmerge)</span></span>
<span id="cb77-667"><a href="#cb77-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-668"><a href="#cb77-668" aria-hidden="true" tabindex="-1"></a><span class="in">           % Replace codes where new code is needed</span></span>
<span id="cb77-669"><a href="#cb77-669" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGnew.code(~strcmp(EEGnew.newCode, '')) = EEGnew.newCode(~strcmp(EEGnew.newCode, ''))</span></span>
<span id="cb77-670"><a href="#cb77-670" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGnew.type(~strcmp(EEGnew.newCode, '')) = EEGnew.newCode(~strcmp(EEGnew.newCode, ''))</span></span>
<span id="cb77-671"><a href="#cb77-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-672"><a href="#cb77-672" aria-hidden="true" tabindex="-1"></a><span class="in">           % Arrange table in order of event (CRUCIAL for correct export)</span></span>
<span id="cb77-673"><a href="#cb77-673" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGnew = sortrows(EEGnew, 'urevent')</span></span>
<span id="cb77-674"><a href="#cb77-674" aria-hidden="true" tabindex="-1"></a><span class="in">          </span></span>
<span id="cb77-675"><a href="#cb77-675" aria-hidden="true" tabindex="-1"></a><span class="in">           % Convert table back to struct and restore original dimensions</span></span>
<span id="cb77-676"><a href="#cb77-676" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGnew = table2struct(EEGnew(:, 1:29))</span></span>
<span id="cb77-677"><a href="#cb77-677" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGnew = reshape(EEGnew, [1, height(EEGnew)])</span></span>
<span id="cb77-678"><a href="#cb77-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-679"><a href="#cb77-679" aria-hidden="true" tabindex="-1"></a><span class="in">           % Replace event table(s) in original struct</span></span>
<span id="cb77-680"><a href="#cb77-680" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGraw.event = EEGnew</span></span>
<span id="cb77-681"><a href="#cb77-681" aria-hidden="true" tabindex="-1"></a><span class="in">           EEGraw.urevent = table2struct(struct2table(EEGnew(:, 1:28)))</span></span>
<span id="cb77-682"><a href="#cb77-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-683"><a href="#cb77-683" aria-hidden="true" tabindex="-1"></a><span class="in">           % Export updated file</span></span>
<span id="cb77-684"><a href="#cb77-684" aria-hidden="true" tabindex="-1"></a><span class="in">           pop_mffexport(EEGraw, char(subFolder))</span></span>
<span id="cb77-685"><a href="#cb77-685" aria-hidden="true" tabindex="-1"></a><span class="in">       end </span></span>
<span id="cb77-686"><a href="#cb77-686" aria-hidden="true" tabindex="-1"></a><span class="in">       ```</span></span>
<span id="cb77-687"><a href="#cb77-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-688"><a href="#cb77-688" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb77-689"><a href="#cb77-689" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Run the HAPPE Pipeline</span>
<span id="cb77-690"><a href="#cb77-690" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This section is designed to rely on user input.</span>
<span id="cb77-691"><a href="#cb77-691" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>When the prior steps have finsihed, a message will appear in the console prompting you to enter the filepath to the location of the HAPPE pre-processing file you wish to run</span>
<span id="cb77-692"><a href="#cb77-692" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Once the path is entered, MATLAB will run the file</span>
<span id="cb77-693"><a href="#cb77-693" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Note: the filepath inputted should NOT be in quotes**</span>
<span id="cb77-694"><a href="#cb77-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-695"><a href="#cb77-695" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-696"><a href="#cb77-696" aria-hidden="true" tabindex="-1"></a><span class="in">   % Set path to HAPPE pre-processing script</span></span>
<span id="cb77-697"><a href="#cb77-697" aria-hidden="true" tabindex="-1"></a><span class="in">   happeRun = input('Enter the full path to the HAPPE pre-processing file:\n&gt; ','s') ;</span></span>
<span id="cb77-698"><a href="#cb77-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-699"><a href="#cb77-699" aria-hidden="true" tabindex="-1"></a><span class="in">   % Call and run HAPPE pre-processing script</span></span>
<span id="cb77-700"><a href="#cb77-700" aria-hidden="true" tabindex="-1"></a><span class="in">   run(happeRun);</span></span>
<span id="cb77-701"><a href="#cb77-701" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-702"><a href="#cb77-702" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Enter HAPPE inputs </span>
<span id="cb77-703"><a href="#cb77-703" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>See the following section for HAPPE inputs for the Fish/Shark task</span>
<span id="cb77-704"><a href="#cb77-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-705"><a href="#cb77-705" aria-hidden="true" tabindex="-1"></a>After the HAPPE inputs are entered, no more user interaction is required for the script to do its job.</span>
<span id="cb77-706"><a href="#cb77-706" aria-hidden="true" tabindex="-1"></a>The HAPPE pipeline will run, and the remaining MATLAB code in the script file will evaluate the files outputted by HAPPE and move them to the appropriate locations based on this evaluation. </span>
<span id="cb77-707"><a href="#cb77-707" aria-hidden="true" tabindex="-1"></a>See <span class="co">[</span><span class="ot">FishShark Post-HAPPE Steps</span><span class="co">](#sec-FishSharkPost)</span> for a detailed explanation of the code used to accomplish this.</span>
<span id="cb77-708"><a href="#cb77-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-709"><a href="#cb77-709" aria-hidden="true" tabindex="-1"></a><span class="fu">### HAPPE Inputs {#sec-inputFishSharkHAPPE}</span></span>
<span id="cb77-710"><a href="#cb77-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-711"><a href="#cb77-711" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>If you are not using the MATLAB scripts described above, you must first open the HAPPE pipeline V4 script in MATLAB and click "Run"</span>
<span id="cb77-712"><a href="#cb77-712" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This will be stored in the location to which you mapped the HAPPE Git repo (e.g. <span class="in">`Documents/GitHub/HAPPE/1. pre-process/HAPPE_v4.m`</span>)</span>
<span id="cb77-713"><a href="#cb77-713" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>User Inputs</span>
<span id="cb77-714"><a href="#cb77-714" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Enter the path to the folder containing the dataset.</span>
<span id="cb77-715"><a href="#cb77-715" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Select <span class="in">`raw`</span></span>
<span id="cb77-716"><a href="#cb77-716" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Load pre-existing set of input parameter: </span>
<span id="cb77-717"><a href="#cb77-717" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`N`</span> if this is your first time running data through the pipeline.</span>
<span id="cb77-718"><a href="#cb77-718" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`Y`</span> if you have decided on a set of parameters.</span>
<span id="cb77-719"><a href="#cb77-719" aria-hidden="true" tabindex="-1"></a>        Enter the path to the folder containing the input parameters.</span>
<span id="cb77-720"><a href="#cb77-720" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Low density data: <span class="in">`N`</span></span>
<span id="cb77-721"><a href="#cb77-721" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Data type: <span class="in">`task`</span></span>
<span id="cb77-722"><a href="#cb77-722" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Performing event-related potential (ERP) analysis: <span class="in">`Y`</span></span>
<span id="cb77-723"><a href="#cb77-723" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Enter the task onset tags</span>
<span id="cb77-724"><a href="#cb77-724" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Correct Go: <span class="in">`cGo++`</span></span>
<span id="cb77-725"><a href="#cb77-725" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Incorrect Go: <span class="in">`xGo++`</span></span>
<span id="cb77-726"><a href="#cb77-726" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Correct NoGo: <span class="in">`cNG++`</span></span>
<span id="cb77-727"><a href="#cb77-727" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Incorrect NoGo: <span class="in">`xNG++`</span></span>
<span id="cb77-728"><a href="#cb77-728" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`done`</span></span>
<span id="cb77-729"><a href="#cb77-729" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Do multiple onset tags belong to a single condition? <span class="in">`N`</span></span>
<span id="cb77-730"><a href="#cb77-730" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>File format: <span class="in">`5`</span></span>
<span id="cb77-731"><a href="#cb77-731" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Acquisition layout type: <span class="in">`2`</span></span>
<span id="cb77-732"><a href="#cb77-732" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Number of channels: <span class="in">`128`</span></span>
<span id="cb77-733"><a href="#cb77-733" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Do you have additional type fields besides "code"? <span class="in">`N`</span></span>
<span id="cb77-734"><a href="#cb77-734" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Select channels of interest: <span class="in">`all`</span></span>
<span id="cb77-735"><a href="#cb77-735" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Frequency of electrical noice in Hz: <span class="in">`60`</span></span>
<span id="cb77-736"><a href="#cb77-736" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Are there any additional frequencies, (e.g., harmonics) to reduce? <span class="in">`N`</span></span>
<span id="cb77-737"><a href="#cb77-737" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Line Noise reduction method: <span class="in">`notch`</span></span>
<span id="cb77-738"><a href="#cb77-738" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Low cutoff: <span class="in">`59`</span></span>
<span id="cb77-739"><a href="#cb77-739" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>high cutoff: <span class="in">`61`</span></span>
<span id="cb77-740"><a href="#cb77-740" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Resample: <span class="in">`N`</span></span>
<span id="cb77-741"><a href="#cb77-741" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Filter</span>
<span id="cb77-742"><a href="#cb77-742" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Low Pass Cutoff: <span class="in">`30`</span></span>
<span id="cb77-743"><a href="#cb77-743" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>High Pass Cutoff: <span class="in">`.1`</span></span>
<span id="cb77-744"><a href="#cb77-744" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Choose a filter: <span class="in">`fir`</span></span>
<span id="cb77-745"><a href="#cb77-745" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Bad Channel Detection: <span class="in">`Y`</span></span>
<span id="cb77-746"><a href="#cb77-746" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`after`</span> wavelet thresholding</span>
<span id="cb77-747"><a href="#cb77-747" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>ECGone: <span class="in">`N`</span></span>
<span id="cb77-748"><a href="#cb77-748" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Wavelet Thresholding</span>
<span id="cb77-749"><a href="#cb77-749" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span><span class="in">`default`</span></span>
<span id="cb77-750"><a href="#cb77-750" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Threshold rule: <span class="in">`hard`</span></span>
<span id="cb77-751"><a href="#cb77-751" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>MuscIL: <span class="in">`N`</span></span>
<span id="cb77-752"><a href="#cb77-752" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Segmentation: <span class="in">`Y`</span></span>
<span id="cb77-753"><a href="#cb77-753" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Starting parameter for stimulus: <span class="in">`-200`</span></span>
<span id="cb77-754"><a href="#cb77-754" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Ending parameter for stimulus: <span class="in">`1000`</span></span>
<span id="cb77-755"><a href="#cb77-755" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Task offset: <span class="in">`17`</span></span>
<span id="cb77-756"><a href="#cb77-756" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Baseline Correction: <span class="in">`Y`</span></span>
<span id="cb77-757"><a href="#cb77-757" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Baseline Correction start: <span class="in">`-200`</span></span>
<span id="cb77-758"><a href="#cb77-758" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Baseline Correction end: <span class="in">`0`</span></span>
<span id="cb77-759"><a href="#cb77-759" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Interpolation: <span class="in">`Y`</span></span>
<span id="cb77-760"><a href="#cb77-760" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Segment Rejection: <span class="in">`Y`</span></span>
<span id="cb77-761"><a href="#cb77-761" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Segment Rejection Method: <span class="in">`amplitude`</span></span>
<span id="cb77-762"><a href="#cb77-762" aria-hidden="true" tabindex="-1"></a><span class="ss">            - </span>minimum segment rejection threshold: <span class="in">`-150`</span></span>
<span id="cb77-763"><a href="#cb77-763" aria-hidden="true" tabindex="-1"></a><span class="ss">            - </span>maximum segment rejection threshold: <span class="in">`150`</span></span>
<span id="cb77-764"><a href="#cb77-764" aria-hidden="true" tabindex="-1"></a><span class="ss">            - </span>segment rejection based on all channels or ROI: <span class="in">`all`</span></span>
<span id="cb77-765"><a href="#cb77-765" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Re-referencing: <span class="in">`Y`</span></span>
<span id="cb77-766"><a href="#cb77-766" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>Does your data contain a flatline or all zero reference channel? <span class="in">`N`</span></span>
<span id="cb77-767"><a href="#cb77-767" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>re-referencing method: <span class="in">`average`</span></span>
<span id="cb77-768"><a href="#cb77-768" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Save format: <span class="in">`1`</span></span>
<span id="cb77-769"><a href="#cb77-769" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Visualizations: <span class="in">`N`</span></span>
<span id="cb77-770"><a href="#cb77-770" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Parameter file save name: <span class="in">`default`</span></span>
<span id="cb77-771"><a href="#cb77-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-772"><a href="#cb77-772" aria-hidden="true" tabindex="-1"></a><span class="fu">### FishShark Post-HAPPE Steps {#sec-fishSharkPost}</span></span>
<span id="cb77-773"><a href="#cb77-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-774"><a href="#cb77-774" aria-hidden="true" tabindex="-1"></a>This section details the actions performed by the MATLAB scripts once HAPPE is completed.</span>
<span id="cb77-775"><a href="#cb77-775" aria-hidden="true" tabindex="-1"></a>These actions will take place automatically upon completion of the HAPPE pipeline.</span>
<span id="cb77-776"><a href="#cb77-776" aria-hidden="true" tabindex="-1"></a>**No user inputs or actions are necessary at this stage.**</span>
<span id="cb77-777"><a href="#cb77-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-778"><a href="#cb77-778" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Exclude files that don't have any output data from the dataset (containing filename and quality reports from HAPPE pipeline) that will be used to assess file quality</span>
<span id="cb77-779"><a href="#cb77-779" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This step is important because "empty" files don't play nicely with the code used to evaluate files that have some data in them (even if the data do not meet threshold)</span>
<span id="cb77-780"><a href="#cb77-780" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This code relies on HAPPE's quality data that remains in the MATLAB environment after the pipeline has finished.</span>
<span id="cb77-781"><a href="#cb77-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-782"><a href="#cb77-782" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-783"><a href="#cb77-783" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create a list of files that received some kind of error message</span></span>
<span id="cb77-784"><a href="#cb77-784" aria-hidden="true" tabindex="-1"></a><span class="in">   noTags = any(strcmp(dataQC, 'NO_TAGS'), 2);</span></span>
<span id="cb77-785"><a href="#cb77-785" aria-hidden="true" tabindex="-1"></a><span class="in">   allRej = any(strcmp(dataQC, 'ALL_SEG_REJ'), 2);</span></span>
<span id="cb77-786"><a href="#cb77-786" aria-hidden="true" tabindex="-1"></a><span class="in">   oneRej = any(strcmp(dataQC, 'REJ_ONE_SEG'), 2);</span></span>
<span id="cb77-787"><a href="#cb77-787" aria-hidden="true" tabindex="-1"></a><span class="in">   error = any(strcmp(dataQC, 'ERROR'), 2);</span></span>
<span id="cb77-788"><a href="#cb77-788" aria-hidden="true" tabindex="-1"></a><span class="in">   loadFail = any(strcmp(dataQC, 'LOAD_FAIL'), 2);</span></span>
<span id="cb77-789"><a href="#cb77-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-790"><a href="#cb77-790" aria-hidden="true" tabindex="-1"></a><span class="in">   % Combine filenames with quality data (for some reason, they are not automatically connected by HAPPE)</span></span>
<span id="cb77-791"><a href="#cb77-791" aria-hidden="true" tabindex="-1"></a><span class="in">   dataQCNew = [FileNames', dataQC];</span></span>
<span id="cb77-792"><a href="#cb77-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-793"><a href="#cb77-793" aria-hidden="true" tabindex="-1"></a><span class="in">   % Remove all files in the above lists (those receiving errors) from the quality data</span></span>
<span id="cb77-794"><a href="#cb77-794" aria-hidden="true" tabindex="-1"></a><span class="in">   dataQCNew(noTags | allRej | error | loadFail | oneRej, :) = [];</span></span>
<span id="cb77-795"><a href="#cb77-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-796"><a href="#cb77-796" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create list of variable names for quality data</span></span>
<span id="cb77-797"><a href="#cb77-797" aria-hidden="true" tabindex="-1"></a><span class="in">   dataQCnamesNew = ["File", dataQCnames];</span></span>
<span id="cb77-798"><a href="#cb77-798" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-799"><a href="#cb77-799" aria-hidden="true" tabindex="-1"></a><span class="in">   % Save the data as a table for ease of use in subsequent steps</span></span>
<span id="cb77-800"><a href="#cb77-800" aria-hidden="true" tabindex="-1"></a><span class="in">   qcTable = cell2table(dataQCNew, 'VariableNames', dataQCnamesNew);</span></span>
<span id="cb77-801"><a href="#cb77-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-802"><a href="#cb77-802" aria-hidden="true" tabindex="-1"></a><span class="in">   % Subset to ID and threshold information</span></span>
<span id="cb77-803"><a href="#cb77-803" aria-hidden="true" tabindex="-1"></a><span class="in">   testInfo = qcTable(:, ["idWave", "File", "Test"]);</span></span>
<span id="cb77-804"><a href="#cb77-804" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-805"><a href="#cb77-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-806"><a href="#cb77-806" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Identify the files that meet (or don't meet) the threshold</span>
<span id="cb77-807"><a href="#cb77-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-808"><a href="#cb77-808" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-809"><a href="#cb77-809" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create a list of files (i.e., rows in the table) that meet threshold</span></span>
<span id="cb77-810"><a href="#cb77-810" aria-hidden="true" tabindex="-1"></a><span class="in">   thresholdTest = qcTable.("Number_cNG++_Segs_Post-Seg_Rej") &gt;= trialCutoff &amp; qcTable.("Number_cGo++_Segs_Post-Seg_Rej") &gt;= trialCutoff;</span></span>
<span id="cb77-811"><a href="#cb77-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-812"><a href="#cb77-812" aria-hidden="true" tabindex="-1"></a><span class="in">   % Add a variable to the quality data table that include whether or not the file meet threshold</span></span>
<span id="cb77-813"><a href="#cb77-813" aria-hidden="true" tabindex="-1"></a><span class="in">   qcTable.Test = thresholdTest;</span></span>
<span id="cb77-814"><a href="#cb77-814" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-815"><a href="#cb77-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-816"><a href="#cb77-816" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Add an identifying variable to be used for data joining down the line</span>
<span id="cb77-817"><a href="#cb77-817" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This variable is generated using its expected location in the file name (i.e., how many text characters "in" it is)</span>
<span id="cb77-818"><a href="#cb77-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-819"><a href="#cb77-819" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-820"><a href="#cb77-820" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate IDs based on File variable</span></span>
<span id="cb77-821"><a href="#cb77-821" aria-hidden="true" tabindex="-1"></a><span class="in">   idWaveQC = extractBefore(qcTable.File, 8);</span></span>
<span id="cb77-822"><a href="#cb77-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-823"><a href="#cb77-823" aria-hidden="true" tabindex="-1"></a><span class="in">   % Append ID variable to quality data</span></span>
<span id="cb77-824"><a href="#cb77-824" aria-hidden="true" tabindex="-1"></a><span class="in">   qcTable.idWave = idWaveQC;</span></span>
<span id="cb77-825"><a href="#cb77-825" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-826"><a href="#cb77-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-827"><a href="#cb77-827" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Create a subsetted dataset conataining only the <span class="in">`idWave`</span>, file name, and "test" results (i.e., whether a given file meets the specified cutoff threshold for inclusion)</span>
<span id="cb77-828"><a href="#cb77-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-829"><a href="#cb77-829" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-830"><a href="#cb77-830" aria-hidden="true" tabindex="-1"></a><span class="in">   % Subset to ID and threshold information</span></span>
<span id="cb77-831"><a href="#cb77-831" aria-hidden="true" tabindex="-1"></a><span class="in">   testInfo = qcTable(:, ["idWave", "File", "Test"]);</span></span>
<span id="cb77-832"><a href="#cb77-832" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-833"><a href="#cb77-833" aria-hidden="true" tabindex="-1"></a><span class="in">   fprintf('Assessment Complete \n');</span></span>
<span id="cb77-834"><a href="#cb77-834" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-835"><a href="#cb77-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-836"><a href="#cb77-836" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Generate a list of files outputted by HAPPE</span>
<span id="cb77-837"><a href="#cb77-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-838"><a href="#cb77-838" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-839"><a href="#cb77-839" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate path for HAPPE pre-processing output (using the HAPPE environment variable from user's input of location of raw data for processing)</span></span>
<span id="cb77-840"><a href="#cb77-840" aria-hidden="true" tabindex="-1"></a><span class="in">   inputPath = strcat(srcDir, "\5 - processed");</span></span>
<span id="cb77-841"><a href="#cb77-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-842"><a href="#cb77-842" aria-hidden="true" tabindex="-1"></a><span class="in">   % Read in list of files outputted from HAPPE </span></span>
<span id="cb77-843"><a href="#cb77-843" aria-hidden="true" tabindex="-1"></a><span class="in">   preprocessingOutput = dir(inputPath);</span></span>
<span id="cb77-844"><a href="#cb77-844" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-845"><a href="#cb77-845" aria-hidden="true" tabindex="-1"></a><span class="in">   % Remove "empty" rows </span></span>
<span id="cb77-846"><a href="#cb77-846" aria-hidden="true" tabindex="-1"></a><span class="in">   preprocessingOutput = preprocessingOutput(~ismember({preprocessingOutput.name}, {'.', '..'}));</span></span>
<span id="cb77-847"><a href="#cb77-847" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-848"><a href="#cb77-848" aria-hidden="true" tabindex="-1"></a><span class="in">   % Save data as a table for ease of later use</span></span>
<span id="cb77-849"><a href="#cb77-849" aria-hidden="true" tabindex="-1"></a><span class="in">   preprocessingOutput = struct2table(preprocessingOutput);</span></span>
<span id="cb77-850"><a href="#cb77-850" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-851"><a href="#cb77-851" aria-hidden="true" tabindex="-1"></a><span class="in">   % Subset to file info</span></span>
<span id="cb77-852"><a href="#cb77-852" aria-hidden="true" tabindex="-1"></a><span class="in">   fileInfo = preprocessingOutput(:, ["name", "folder"]);</span></span>
<span id="cb77-853"><a href="#cb77-853" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-854"><a href="#cb77-854" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Select only desired files to be moved/copied</span>
<span id="cb77-855"><a href="#cb77-855" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Currently, we don't do anything with the "Individual Trial" files outputted by HAPPE.</span>
<span id="cb77-856"><a href="#cb77-856" aria-hidden="true" tabindex="-1"></a>   These files are quite large and take a long time to move, so it is more efficient to just remove them from the list of filenames and not worry about moving them anywhere.</span>
<span id="cb77-857"><a href="#cb77-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-858"><a href="#cb77-858" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-859"><a href="#cb77-859" aria-hidden="true" tabindex="-1"></a><span class="in">   % Subset to desired files (AveOverTrial)</span></span>
<span id="cb77-860"><a href="#cb77-860" aria-hidden="true" tabindex="-1"></a><span class="in">   fileSubset = fileInfo(contains(fileInfo.name, "AveOverTrials"), :);</span></span>
<span id="cb77-861"><a href="#cb77-861" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-862"><a href="#cb77-862" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Add condition, ID, and threshold-related variables to the file data</span>
<span id="cb77-863"><a href="#cb77-863" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>NOTE: The value for <span class="in">`Condition`</span> variable (i.e., "cGo" or "cNoGo") should match the name of the condition-specific folders you wish the files to save to within the processing repo.</span>
<span id="cb77-864"><a href="#cb77-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-865"><a href="#cb77-865" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb77-866"><a href="#cb77-866" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-867"><a href="#cb77-867" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate list of IDs based on file name variable</span></span>
<span id="cb77-868"><a href="#cb77-868" aria-hidden="true" tabindex="-1"></a><span class="in">   idWaveFS = extractBefore(fileSubset.name, 8);</span></span>
<span id="cb77-869"><a href="#cb77-869" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-870"><a href="#cb77-870" aria-hidden="true" tabindex="-1"></a><span class="in">   % Add ID list to file data</span></span>
<span id="cb77-871"><a href="#cb77-871" aria-hidden="true" tabindex="-1"></a><span class="in">   fileSubset.idWave = idWaveFS;</span></span>
<span id="cb77-872"><a href="#cb77-872" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-873"><a href="#cb77-873" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate list of files belonging to each condition based on file name variable</span></span>
<span id="cb77-874"><a href="#cb77-874" aria-hidden="true" tabindex="-1"></a><span class="in">   cGo = contains(fileSubset.name, "cGo++");</span></span>
<span id="cb77-875"><a href="#cb77-875" aria-hidden="true" tabindex="-1"></a><span class="in">   cNoGo = contains(fileSubset.name, "cNG++");</span></span>
<span id="cb77-876"><a href="#cb77-876" aria-hidden="true" tabindex="-1"></a><span class="in">   xGo = contains(fileSubset.name, "xGo++");</span></span>
<span id="cb77-877"><a href="#cb77-877" aria-hidden="true" tabindex="-1"></a><span class="in">   xNoGo = contains(fileSubset.name, "xNG++");</span></span>
<span id="cb77-878"><a href="#cb77-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-879"><a href="#cb77-879" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create empty variable for condition</span></span>
<span id="cb77-880"><a href="#cb77-880" aria-hidden="true" tabindex="-1"></a><span class="in">   fileSubset.cond = cell(size(fileSubset, 1), 1);</span></span>
<span id="cb77-881"><a href="#cb77-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-882"><a href="#cb77-882" aria-hidden="true" tabindex="-1"></a><span class="in">   % Fill in condition variable based on the lists generated above</span></span>
<span id="cb77-883"><a href="#cb77-883" aria-hidden="true" tabindex="-1"></a><span class="in">   fileSubset.cond(cGo) = {'cGo'};</span></span>
<span id="cb77-884"><a href="#cb77-884" aria-hidden="true" tabindex="-1"></a><span class="in">   fileSubset.cond(cNoGo) = {'cNoGo'};</span></span>
<span id="cb77-885"><a href="#cb77-885" aria-hidden="true" tabindex="-1"></a><span class="in">   fileSubset.cond(xGo) = {'xGo'};</span></span>
<span id="cb77-886"><a href="#cb77-886" aria-hidden="true" tabindex="-1"></a><span class="in">   fileSubset.cond(xNoGo) = {'xNoGo'};</span></span>
<span id="cb77-887"><a href="#cb77-887" aria-hidden="true" tabindex="-1"></a><span class="in">   fileSubset.cond(~cGo &amp; ~cNoGo &amp; ~xGo &amp; ~xNoGo) = {'All'};</span></span>
<span id="cb77-888"><a href="#cb77-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-889"><a href="#cb77-889" aria-hidden="true" tabindex="-1"></a><span class="in">   % Join threshold test information</span></span>
<span id="cb77-890"><a href="#cb77-890" aria-hidden="true" tabindex="-1"></a><span class="in">   fileTest = join(fileSubset, testInfo);</span></span>
<span id="cb77-891"><a href="#cb77-891" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-892"><a href="#cb77-892" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Prepare data table with information about files that met the threshold</span>
<span id="cb77-893"><a href="#cb77-893" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The data generated here are preparing to copy the .txt files outputted by HAPPE into a folder containing all files that are suitable for PCA</span>
<span id="cb77-894"><a href="#cb77-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-895"><a href="#cb77-895" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-896"><a href="#cb77-896" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create a separate table for only files that meet threshold</span></span>
<span id="cb77-897"><a href="#cb77-897" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo = fileTest(fileTest.Test, :);</span></span>
<span id="cb77-898"><a href="#cb77-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-899"><a href="#cb77-899" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create empty columns for filepath variables</span></span>
<span id="cb77-900"><a href="#cb77-900" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.destination = cell(size(movingInfo, 1), 1);</span></span>
<span id="cb77-901"><a href="#cb77-901" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.origin = cell(size(movingInfo, 1), 1);</span></span>
<span id="cb77-902"><a href="#cb77-902" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.processedTo = cell(size(movingInfo, 1), 1);</span></span>
<span id="cb77-903"><a href="#cb77-903" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.processedFrom = cell(size(movingInfo, 1), 1);</span></span>
<span id="cb77-904"><a href="#cb77-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-905"><a href="#cb77-905" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate file paths based on condition </span></span>
<span id="cb77-906"><a href="#cb77-906" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.destination = strcat({passPath}, "\", movingInfo.cond, "\", movingInfo.name);</span></span>
<span id="cb77-907"><a href="#cb77-907" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.origin = strcat(movingInfo.folder, "\", movingInfo.name);</span></span>
<span id="cb77-908"><a href="#cb77-908" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.processedTo = strcat({allPath}, "\", movingInfo.name);</span></span>
<span id="cb77-909"><a href="#cb77-909" aria-hidden="true" tabindex="-1"></a><span class="in">   movingInfo.processedFrom = strcat(movingInfo.folder, "\", movingInfo.name);</span></span>
<span id="cb77-910"><a href="#cb77-910" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-911"><a href="#cb77-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-912"><a href="#cb77-912" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Prepare data table with information about files that do NOT meet the threshold</span>
<span id="cb77-913"><a href="#cb77-913" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The data generated here are preparing to copy .mff files from the location of the raw files into a folder indicating the need for manual processing</span>
<span id="cb77-914"><a href="#cb77-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-915"><a href="#cb77-915" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-916"><a href="#cb77-916" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create a separate table for only files that did not meet threshold</span></span>
<span id="cb77-917"><a href="#cb77-917" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles = fileTest(~fileTest.Test, ["File", "folder", "name"]);</span></span>
<span id="cb77-918"><a href="#cb77-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-919"><a href="#cb77-919" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create empty columns for filepath variables</span></span>
<span id="cb77-920"><a href="#cb77-920" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.destination = cell(size(failFiles, 1), 1);</span></span>
<span id="cb77-921"><a href="#cb77-921" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.origin = cell(size(failFiles, 1), 1);</span></span>
<span id="cb77-922"><a href="#cb77-922" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.processedTo = cell(size(failFiles, 1), 1);</span></span>
<span id="cb77-923"><a href="#cb77-923" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.processedFrom = cell(size(failFiles, 1), 1);</span></span>
<span id="cb77-924"><a href="#cb77-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-925"><a href="#cb77-925" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate filepaths based on ID and task</span></span>
<span id="cb77-926"><a href="#cb77-926" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.destination = strcat({failPath}, "\", failFiles.File);</span></span>
<span id="cb77-927"><a href="#cb77-927" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.origin = strcat({srcDir}, "\", failFiles.File);</span></span>
<span id="cb77-928"><a href="#cb77-928" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.processedFrom = strcat(failFiles.folder, "\", failFiles.name);</span></span>
<span id="cb77-929"><a href="#cb77-929" aria-hidden="true" tabindex="-1"></a><span class="in">   failFiles.processedTo = strcat({allPath}, "\", failFiles.name);</span></span>
<span id="cb77-930"><a href="#cb77-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-931"><a href="#cb77-931" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-932"><a href="#cb77-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-933"><a href="#cb77-933" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Generate environment variables that correspond to the column index of relevant variables for file sorting</span>
<span id="cb77-934"><a href="#cb77-934" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Note that the very last line of this code defines the varaible(s) to exclude from the HAPPE outputted files.</span>
<span id="cb77-935"><a href="#cb77-935" aria-hidden="true" tabindex="-1"></a>   This variable must be stripped from the data before saving them, because the presence of the extra variable makes the file incompatible with EP Toolkit's PCA process.</span>
<span id="cb77-936"><a href="#cb77-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-937"><a href="#cb77-937" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-938"><a href="#cb77-938" aria-hidden="true" tabindex="-1"></a><span class="in">   % Define column locations for each filepath variable</span></span>
<span id="cb77-939"><a href="#cb77-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-940"><a href="#cb77-940" aria-hidden="true" tabindex="-1"></a><span class="in">   % For files that meet threshold:</span></span>
<span id="cb77-941"><a href="#cb77-941" aria-hidden="true" tabindex="-1"></a><span class="in">   toCol = find(strcmp(movingInfo.Properties.VariableNames, "destination"));</span></span>
<span id="cb77-942"><a href="#cb77-942" aria-hidden="true" tabindex="-1"></a><span class="in">   fromCol = find(strcmp(movingInfo.Properties.VariableNames, "origin"));</span></span>
<span id="cb77-943"><a href="#cb77-943" aria-hidden="true" tabindex="-1"></a><span class="in">   procColto = find(strcmp(movingInfo.Properties.VariableNames, "processedTo"));</span></span>
<span id="cb77-944"><a href="#cb77-944" aria-hidden="true" tabindex="-1"></a><span class="in">   procColfrom = find(strcmp(movingInfo.Properties.VariableNames, "processedFrom"));</span></span>
<span id="cb77-945"><a href="#cb77-945" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-946"><a href="#cb77-946" aria-hidden="true" tabindex="-1"></a><span class="in">   % For files that do not meet threshold</span></span>
<span id="cb77-947"><a href="#cb77-947" aria-hidden="true" tabindex="-1"></a><span class="in">   rawCol = find(strcmp(failFiles.Properties.VariableNames, "origin"));</span></span>
<span id="cb77-948"><a href="#cb77-948" aria-hidden="true" tabindex="-1"></a><span class="in">   manCol = find(strcmp(failFiles.Properties.VariableNames, "destination"));</span></span>
<span id="cb77-949"><a href="#cb77-949" aria-hidden="true" tabindex="-1"></a><span class="in">   failProcColto = find(strcmp(failFiles.Properties.VariableNames, "processedTo"));</span></span>
<span id="cb77-950"><a href="#cb77-950" aria-hidden="true" tabindex="-1"></a><span class="in">   failProcColFrom = find(strcmp(failFiles.Properties.VariableNames, "processedFrom"));</span></span>
<span id="cb77-951"><a href="#cb77-951" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-952"><a href="#cb77-952" aria-hidden="true" tabindex="-1"></a><span class="in">   % Define variable to exclude</span></span>
<span id="cb77-953"><a href="#cb77-953" aria-hidden="true" tabindex="-1"></a><span class="in">   extraVar = 'Time';</span></span>
<span id="cb77-954"><a href="#cb77-954" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-955"><a href="#cb77-955" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use a loop to process all files that met threshold</span>
<span id="cb77-956"><a href="#cb77-956" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>For each row in the "movingInfo" dataset, the loop will:</span>
<span id="cb77-957"><a href="#cb77-957" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>Identify the origin and destination paths</span>
<span id="cb77-958"><a href="#cb77-958" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>Read in the HAPPE output file</span>
<span id="cb77-959"><a href="#cb77-959" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>Remove the extra variable</span>
<span id="cb77-960"><a href="#cb77-960" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>Save the "cleaned" data in the appropriate folder (without variable names, as required by EP Toolkit) </span>
<span id="cb77-961"><a href="#cb77-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-962"><a href="#cb77-962" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-963"><a href="#cb77-963" aria-hidden="true" tabindex="-1"></a><span class="in">   for row = 1:height(movingInfo)</span></span>
<span id="cb77-964"><a href="#cb77-964" aria-hidden="true" tabindex="-1"></a><span class="in">       % Specify path info</span></span>
<span id="cb77-965"><a href="#cb77-965" aria-hidden="true" tabindex="-1"></a><span class="in">       pathFrom = movingInfo{row, fromCol};</span></span>
<span id="cb77-966"><a href="#cb77-966" aria-hidden="true" tabindex="-1"></a><span class="in">       pathTo = movingInfo{row, toCol};</span></span>
<span id="cb77-967"><a href="#cb77-967" aria-hidden="true" tabindex="-1"></a><span class="in">       % Read in the data</span></span>
<span id="cb77-968"><a href="#cb77-968" aria-hidden="true" tabindex="-1"></a><span class="in">       rawTable = readtable(pathFrom);</span></span>
<span id="cb77-969"><a href="#cb77-969" aria-hidden="true" tabindex="-1"></a><span class="in">       % Remove extra column (Time)</span></span>
<span id="cb77-970"><a href="#cb77-970" aria-hidden="true" tabindex="-1"></a><span class="in">       cleanTable = rawTable{:, ~strcmp(rawTable.Properties.VariableNames, extraVar)};</span></span>
<span id="cb77-971"><a href="#cb77-971" aria-hidden="true" tabindex="-1"></a><span class="in">       % Save without headers</span></span>
<span id="cb77-972"><a href="#cb77-972" aria-hidden="true" tabindex="-1"></a><span class="in">       writematrix(cleanTable, pathTo, 'Delimiter', '\t')</span></span>
<span id="cb77-973"><a href="#cb77-973" aria-hidden="true" tabindex="-1"></a><span class="in">   end</span></span>
<span id="cb77-974"><a href="#cb77-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-975"><a href="#cb77-975" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-976"><a href="#cb77-976" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use a loop to copy raw (.mff) files into a location that stores files requiring manual processing</span>
<span id="cb77-977"><a href="#cb77-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-978"><a href="#cb77-978" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-979"><a href="#cb77-979" aria-hidden="true" tabindex="-1"></a><span class="in">   for row = 1:height(failFiles)</span></span>
<span id="cb77-980"><a href="#cb77-980" aria-hidden="true" tabindex="-1"></a><span class="in">       % Specify path info</span></span>
<span id="cb77-981"><a href="#cb77-981" aria-hidden="true" tabindex="-1"></a><span class="in">       pathFrom = failFiles{row, rawCol};</span></span>
<span id="cb77-982"><a href="#cb77-982" aria-hidden="true" tabindex="-1"></a><span class="in">       pathTo = failFiles{row, manCol};</span></span>
<span id="cb77-983"><a href="#cb77-983" aria-hidden="true" tabindex="-1"></a><span class="in">       % Copy file </span></span>
<span id="cb77-984"><a href="#cb77-984" aria-hidden="true" tabindex="-1"></a><span class="in">       copyfile(pathFrom, pathTo)</span></span>
<span id="cb77-985"><a href="#cb77-985" aria-hidden="true" tabindex="-1"></a><span class="in">   end</span></span>
<span id="cb77-986"><a href="#cb77-986" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-987"><a href="#cb77-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-988"><a href="#cb77-988" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use a set of loops to copy all HAPPE output files into a folder intended to house all output (whether threshold is met or not)</span>
<span id="cb77-989"><a href="#cb77-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-990"><a href="#cb77-990" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-991"><a href="#cb77-991" aria-hidden="true" tabindex="-1"></a><span class="in">   for row = 1:height(movingInfo)</span></span>
<span id="cb77-992"><a href="#cb77-992" aria-hidden="true" tabindex="-1"></a><span class="in">       % Specify path info</span></span>
<span id="cb77-993"><a href="#cb77-993" aria-hidden="true" tabindex="-1"></a><span class="in">       pathFrom = movingInfo{row, procColfrom};</span></span>
<span id="cb77-994"><a href="#cb77-994" aria-hidden="true" tabindex="-1"></a><span class="in">       pathTo = movingInfo{row, procColto};</span></span>
<span id="cb77-995"><a href="#cb77-995" aria-hidden="true" tabindex="-1"></a><span class="in">       % Copy file</span></span>
<span id="cb77-996"><a href="#cb77-996" aria-hidden="true" tabindex="-1"></a><span class="in">       copyfile(pathFrom, pathTo);</span></span>
<span id="cb77-997"><a href="#cb77-997" aria-hidden="true" tabindex="-1"></a><span class="in">   end</span></span>
<span id="cb77-998"><a href="#cb77-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-999"><a href="#cb77-999" aria-hidden="true" tabindex="-1"></a><span class="in">   for row = 1:height(failFiles)</span></span>
<span id="cb77-1000"><a href="#cb77-1000" aria-hidden="true" tabindex="-1"></a><span class="in">       % Specify path info</span></span>
<span id="cb77-1001"><a href="#cb77-1001" aria-hidden="true" tabindex="-1"></a><span class="in">       pathFrom = failFiles{row, failProcColFrom};</span></span>
<span id="cb77-1002"><a href="#cb77-1002" aria-hidden="true" tabindex="-1"></a><span class="in">       pathTo = failFiles{row, failProcColto};</span></span>
<span id="cb77-1003"><a href="#cb77-1003" aria-hidden="true" tabindex="-1"></a><span class="in">       % Copy file</span></span>
<span id="cb77-1004"><a href="#cb77-1004" aria-hidden="true" tabindex="-1"></a><span class="in">       copyfile(pathFrom, pathTo);</span></span>
<span id="cb77-1005"><a href="#cb77-1005" aria-hidden="true" tabindex="-1"></a><span class="in">   end</span></span>
<span id="cb77-1006"><a href="#cb77-1006" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-1007"><a href="#cb77-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1008"><a href="#cb77-1008" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Generate a .txt file listing all processed .mff files</span>
<span id="cb77-1009"><a href="#cb77-1009" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This file will contain a list of all raw files (e.g., <span class="in">`1111_22_fishshark.mff`</span>) and save the list to the specified location (<span class="in">`summPath`</span>)</span>
<span id="cb77-1010"><a href="#cb77-1010" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The file will have the current date and time appended to the end so that it will be distinguishable from past logs </span>
<span id="cb77-1011"><a href="#cb77-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The list of processed files is generated using an environment variable that the HAPPE pipeline creates that lists all files inputted to the pipeline</span>
<span id="cb77-1012"><a href="#cb77-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1013"><a href="#cb77-1013" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-1014"><a href="#cb77-1014" aria-hidden="true" tabindex="-1"></a><span class="in">   % Create a table from HAPPE FileNames cell array</span></span>
<span id="cb77-1015"><a href="#cb77-1015" aria-hidden="true" tabindex="-1"></a><span class="in">   processedList = cell2table(FileNames(:));</span></span>
<span id="cb77-1016"><a href="#cb77-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1017"><a href="#cb77-1017" aria-hidden="true" tabindex="-1"></a><span class="in">   % Rename file variable from default</span></span>
<span id="cb77-1018"><a href="#cb77-1018" aria-hidden="true" tabindex="-1"></a><span class="in">   processedList = renamevars(processedList, {'Var1'}, {'File'});</span></span>
<span id="cb77-1019"><a href="#cb77-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1020"><a href="#cb77-1020" aria-hidden="true" tabindex="-1"></a><span class="in">   % Save current date as a string variable </span></span>
<span id="cb77-1021"><a href="#cb77-1021" aria-hidden="true" tabindex="-1"></a><span class="in">   today = string(date());</span></span>
<span id="cb77-1022"><a href="#cb77-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1023"><a href="#cb77-1023" aria-hidden="true" tabindex="-1"></a><span class="in">   % Save time as a string variable, replacing ":" with "_" so that file can be written </span></span>
<span id="cb77-1024"><a href="#cb77-1024" aria-hidden="true" tabindex="-1"></a><span class="in">   time = strrep(datestr(now, 'HH:MM:SS:FFF'), ':', "_");</span></span>
<span id="cb77-1025"><a href="#cb77-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1026"><a href="#cb77-1026" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate file name to include current date and time </span></span>
<span id="cb77-1027"><a href="#cb77-1027" aria-hidden="true" tabindex="-1"></a><span class="in">   listFile = strcat("\oddballProcessed_", today, "_", time);</span></span>
<span id="cb77-1028"><a href="#cb77-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1029"><a href="#cb77-1029" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate full path including file name</span></span>
<span id="cb77-1030"><a href="#cb77-1030" aria-hidden="true" tabindex="-1"></a><span class="in">   summPathFull = strcat(summPath, listFile);</span></span>
<span id="cb77-1031"><a href="#cb77-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1032"><a href="#cb77-1032" aria-hidden="true" tabindex="-1"></a><span class="in">   % Write table to specified location</span></span>
<span id="cb77-1033"><a href="#cb77-1033" aria-hidden="true" tabindex="-1"></a><span class="in">   writetable(processedList, summPathFull);</span></span>
<span id="cb77-1034"><a href="#cb77-1034" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-1035"><a href="#cb77-1035" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-1036"><a href="#cb77-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Generate a .txt file listing all of the files that did not meet threshold to go through subsequent processing</span>
<span id="cb77-1037"><a href="#cb77-1037" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This file will contain a list of all raw files (e.g., <span class="in">`1111_22_fishshark.mff`</span>) that did not meet threshold and save the list to the specified location (<span class="in">`manPath`</span>)</span>
<span id="cb77-1038"><a href="#cb77-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The file will have the current date and time appended to the end so that it will be distinguishable from past lists</span>
<span id="cb77-1039"><a href="#cb77-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This list of file to process manually is generated using the environment object <span class="in">`FileNames`</span> that HAPPE creates; any files listed in <span class="in">`FileNames`</span> but not in the dataset of files that pass threshold make up the <span class="in">`manualList`</span></span>
<span id="cb77-1040"><a href="#cb77-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1041"><a href="#cb77-1041" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-1042"><a href="#cb77-1042" aria-hidden="true" tabindex="-1"></a><span class="in">   % Compare movingInfo with FileNames to isolate files that don't meet threshold</span></span>
<span id="cb77-1043"><a href="#cb77-1043" aria-hidden="true" tabindex="-1"></a><span class="in">   manualList = cell2table(FileNames(~ismember(FileNames', movingInfo.File)));</span></span>
<span id="cb77-1044"><a href="#cb77-1044" aria-hidden="true" tabindex="-1"></a><span class="in">   manualList = renamevars(manualList, {'Var1'}, {'File'});</span></span>
<span id="cb77-1045"><a href="#cb77-1045" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-1046"><a href="#cb77-1046" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate file name to include current date</span></span>
<span id="cb77-1047"><a href="#cb77-1047" aria-hidden="true" tabindex="-1"></a><span class="in">   manFile = strcat("\fishSharkManual_", today, "_", time);</span></span>
<span id="cb77-1048"><a href="#cb77-1048" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-1049"><a href="#cb77-1049" aria-hidden="true" tabindex="-1"></a><span class="in">   % Generate full path including filename</span></span>
<span id="cb77-1050"><a href="#cb77-1050" aria-hidden="true" tabindex="-1"></a><span class="in">   manPathFull = strcat(manPath, manFile);</span></span>
<span id="cb77-1051"><a href="#cb77-1051" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb77-1052"><a href="#cb77-1052" aria-hidden="true" tabindex="-1"></a><span class="in">   % Write table to specified location</span></span>
<span id="cb77-1053"><a href="#cb77-1053" aria-hidden="true" tabindex="-1"></a><span class="in">   writetable(manualList, manPathFull);</span></span>
<span id="cb77-1054"><a href="#cb77-1054" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb77-1055"><a href="#cb77-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1056"><a href="#cb77-1056" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stop-Signal Processing Pipeline </span></span>
<span id="cb77-1057"><a href="#cb77-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1058"><a href="#cb77-1058" aria-hidden="true" tabindex="-1"></a><span class="fu"># ERP PCA (EP) Toolkit {#sec-eptPCA}</span></span>
<span id="cb77-1059"><a href="#cb77-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1060"><a href="#cb77-1060" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reading Text Files into EP Toolkit {#sec-average}</span></span>
<span id="cb77-1061"><a href="#cb77-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1062"><a href="#cb77-1062" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Open MATLAB with "Run as Administrator"</span>
<span id="cb77-1063"><a href="#cb77-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Open ERP PCA Toolkit in MATLAB</span>
<span id="cb77-1064"><a href="#cb77-1064" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Type <span class="in">`ep`</span> in command prompt</span>
<span id="cb77-1065"><a href="#cb77-1065" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Click <span class="in">`Read`</span> to import files</span>
<span id="cb77-1066"><a href="#cb77-1066" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use the following options</span>
<span id="cb77-1067"><a href="#cb77-1067" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Format = <span class="in">`text (.txt)`</span></span>
<span id="cb77-1068"><a href="#cb77-1068" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Type = <span class="in">`average`</span></span>
<span id="cb77-1069"><a href="#cb77-1069" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Mont = <span class="in">`Adult Hydrocel 128-channel 1.0`</span></span>
<span id="cb77-1070"><a href="#cb77-1070" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Select <span class="in">`Single File Mode`</span>.</span>
<span id="cb77-1071"><a href="#cb77-1071" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Single file mode will use the filename to assign the task condition and participant ID for each file.</span>
<span id="cb77-1072"><a href="#cb77-1072" aria-hidden="true" tabindex="-1"></a>    Thus, **it is critical to use a standard naming convention to name the files**.</span>
<span id="cb77-1073"><a href="#cb77-1073" aria-hidden="true" tabindex="-1"></a><span class="ss">       - </span>For example, an oddball file could be named: <span class="in">`1001_36_oddball_processed_AveOverTrials_tgt+.txt`</span></span>
<span id="cb77-1074"><a href="#cb77-1074" aria-hidden="true" tabindex="-1"></a><span class="ss">       - </span>A FishSharks file meanwhile could be named: <span class="in">`1004_36_oddball_processed_AveOverTrials_cGo++.txt`</span></span>
<span id="cb77-1075"><a href="#cb77-1075" aria-hidden="true" tabindex="-1"></a><span class="ss">       - </span>*Note: The filename examples above reflect the automated naming convention of the files outputted by the HAPPE pipeline.*</span>
<span id="cb77-1076"><a href="#cb77-1076" aria-hidden="true" tabindex="-1"></a>       *If another processing pipeline is used or if the naming conventions become unstandardized, it is **crucial** that standardization of filenames is implemented*</span>
<span id="cb77-1077"><a href="#cb77-1077" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>In the <span class="in">`Single File Mode`</span> menu use the <span class="in">`Subject`</span> field to denote which characters in the filename name will determine the participant ID.</span>
<span id="cb77-1078"><a href="#cb77-1078" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>For the above example <span class="in">`1:7`</span> would correspond to <span class="in">`1001_36`</span> in a file called <span class="in">`1001_36_oddball_processed_AveOverTrials_tgt+.txt`</span> (outputted by HAPPE)</span>
<span id="cb77-1079"><a href="#cb77-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Next, In the <span class="in">`Single File Mode`</span> menu use the <span class="in">`Cell`</span> field to denote which characters in the file name will determine the task condition.</span>
<span id="cb77-1080"><a href="#cb77-1080" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>For the below example <span class="in">`41:43`</span> would correspond to <span class="in">`frq`</span> or <span class="in">`tgt`</span> in a file called <span class="in">`1001_36_oddball_processed_AveOverTrials_tgt+.txt`</span></span>
<span id="cb77-1081"><a href="#cb77-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>For FishSharks files, it might be <span class="in">`47:49`</span> that correspond to <span class="in">`cgo`</span> or <span class="in">`cng`</span>.</span>
<span id="cb77-1082"><a href="#cb77-1082" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="al">![](images/readTextFile2024.png)</span></span>
<span id="cb77-1083"><a href="#cb77-1083" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Select <span class="in">`Read`</span>.</span>
<span id="cb77-1084"><a href="#cb77-1084" aria-hidden="true" tabindex="-1"></a>You will be asked to name the aggregate file created by importing and combining the single files.</span>
<span id="cb77-1085"><a href="#cb77-1085" aria-hidden="true" tabindex="-1"></a>Use the convention "task_condition_age" to name the file (e.g., <span class="in">`ob_tgt_54`</span>)</span>
<span id="cb77-1086"><a href="#cb77-1086" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>A new window will open prompting you to select the files you wish to import.</span>
<span id="cb77-1087"><a href="#cb77-1087" aria-hidden="true" tabindex="-1"></a>Navigate to the folder housing the data to be imported (e.g., <span class="in">`3 - Files for PCA\Target`</span>) and use <span class="in">`Ctrl + A`</span> to select all files in that folder.</span>
<span id="cb77-1088"><a href="#cb77-1088" aria-hidden="true" tabindex="-1"></a>Click <span class="in">`Open`</span> once all desired files are selected</span>
<span id="cb77-1089"><a href="#cb77-1089" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Select the <span class="in">`2_9AverageNet128.ced`</span> file when prompted by another popup.</span>
<span id="cb77-1090"><a href="#cb77-1090" aria-hidden="true" tabindex="-1"></a>This file corresponds to the electrode template associated with the participant age range and type of net represented in the data</span>
<span id="cb77-1091"><a href="#cb77-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>For our study using a 128-channel net on children aged 3-7, the <span class="in">`2_9AverageNet128.ced`</span> template is most appropriate </span>
<span id="cb77-1092"><a href="#cb77-1092" aria-hidden="true" tabindex="-1"></a>   <span class="al">![](images/netTemplateFile.png)</span></span>
<span id="cb77-1093"><a href="#cb77-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The new file will have the participant ID and will combine the conditions for each participant.</span>
<span id="cb77-1094"><a href="#cb77-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Subject Names: </span>
<span id="cb77-1095"><a href="#cb77-1095" aria-hidden="true" tabindex="-1"></a>        <span class="al">![](images/subjectCombinedNames.png)</span></span>
<span id="cb77-1096"><a href="#cb77-1096" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Task Conditions</span>
<span id="cb77-1097"><a href="#cb77-1097" aria-hidden="true" tabindex="-1"></a>        <span class="al">![](images/conditionCombinedNames.png)</span></span>
<span id="cb77-1098"><a href="#cb77-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1099"><a href="#cb77-1099" aria-hidden="true" tabindex="-1"></a><span class="fu">## Update File with Experiment Information</span></span>
<span id="cb77-1100"><a href="#cb77-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1101"><a href="#cb77-1101" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Go to <span class="in">`Main`</span> and click <span class="in">`Edit`</span></span>
<span id="cb77-1102"><a href="#cb77-1102" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Click on the file you imported</span>
<span id="cb77-1103"><a href="#cb77-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>In <span class="in">`Overview`</span>, add the following information:</span>
<span id="cb77-1104"><a href="#cb77-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Experiment Name: <span class="in">`Oddball`</span>, <span class="in">`FishShark`</span>, or <span class="in">`StopSignal`</span></span>
<span id="cb77-1105"><a href="#cb77-1105" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Reference Type: change to <span class="in">`average reference`</span></span>
<span id="cb77-1106"><a href="#cb77-1106" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Prestimulus period: change to <span class="in">`200`</span></span>
<span id="cb77-1107"><a href="#cb77-1107" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Nominal sampling rate: change to <span class="in">`1000`</span></span>
<span id="cb77-1108"><a href="#cb77-1108" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Click <span class="in">`Done`</span></span>
<span id="cb77-1109"><a href="#cb77-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Go to <span class="in">`Main`</span> and click <span class="in">`Save`</span></span>
<span id="cb77-1110"><a href="#cb77-1110" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Save the combined file as an <span class="in">`.ept`</span> file in the <span class="in">`4-EPT Averages`</span> folder using the following naming convention: "task_condition_age".</span>
<span id="cb77-1111"><a href="#cb77-1111" aria-hidden="true" tabindex="-1"></a>    For example, if you were working on the target condition of oddball for all age groups, you would save the file as <span class="in">`ob_tgt_all`</span></span>
<span id="cb77-1112"><a href="#cb77-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1113"><a href="#cb77-1113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Generating Grand Average Waveforms</span></span>
<span id="cb77-1114"><a href="#cb77-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1115"><a href="#cb77-1115" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>If the EPT average file (e.g., <span class="in">`ob_tgt_all`</span>) is not already in the working environment, read it in using the steps below</span>
<span id="cb77-1116"><a href="#cb77-1116" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Go to <span class="in">`Read`</span></span>
<span id="cb77-1117"><a href="#cb77-1117" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Format = <span class="in">`EP (.ept)`</span></span>
<span id="cb77-1118"><a href="#cb77-1118" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Click <span class="in">`Read`</span></span>
<span id="cb77-1119"><a href="#cb77-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Navigate to the <span class="in">`4 - EPT Averages`</span> folder and select desired file(s)</span>
<span id="cb77-1120"><a href="#cb77-1120" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Click <span class="in">`Open`</span> in the browser window to read the file(s)</span>
<span id="cb77-1121"><a href="#cb77-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Click <span class="in">`Main`</span> to return to main menu</span>
<span id="cb77-1122"><a href="#cb77-1122" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Select <span class="in">`Edit`</span></span>
<span id="cb77-1123"><a href="#cb77-1123" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>When the editor window opens, navigate to the <span class="in">`Subjects`</span> pane</span>
<span id="cb77-1124"><a href="#cb77-1124" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Select <span class="in">`All`</span> from among the many options along the lefthand pane of the editor</span>
<span id="cb77-1125"><a href="#cb77-1125" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This will select all of the subjects included in the file and assign them a weight of 1</span>
<span id="cb77-1126"><a href="#cb77-1126" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Confirm that all subjects have been selected (look for a checked box in the subject row) and that all weights have been set to 1</span>
<span id="cb77-1127"><a href="#cb77-1127" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Click <span class="in">`Add`</span></span>
<span id="cb77-1128"><a href="#cb77-1128" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>A new "subject" should have now been added to the bottom of the subjects list</span>
<span id="cb77-1129"><a href="#cb77-1129" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This subject is called <span class="in">`gave`</span> and represents the grand average across all subjects</span>
<span id="cb77-1130"><a href="#cb77-1130" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Click <span class="in">`Done`</span> to exit the editor window, then <span class="in">`Main`</span> to return to the EP Toolkit home</span>
<span id="cb77-1131"><a href="#cb77-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1132"><a href="#cb77-1132" aria-hidden="true" tabindex="-1"></a><span class="fu">## Temporal PCA {#sec-tPCA}</span></span>
<span id="cb77-1133"><a href="#cb77-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1134"><a href="#cb77-1134" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Go to <span class="in">`Main`</span> and click <span class="in">`PCA`</span></span>
<span id="cb77-1135"><a href="#cb77-1135" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Input the following:</span>
<span id="cb77-1136"><a href="#cb77-1136" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Mode: <span class="in">`temporal`</span></span>
<span id="cb77-1137"><a href="#cb77-1137" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Rotation: <span class="in">`promax`</span></span>
<span id="cb77-1138"><a href="#cb77-1138" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Factors: <span class="in">`0`</span></span>
<span id="cb77-1139"><a href="#cb77-1139" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Title: tPCA_experimentname (example: <span class="in">`tPCA_ob_tgt_all`</span>)</span>
<span id="cb77-1140"><a href="#cb77-1140" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Click the appropriate file (e.g., <span class="in">`ob_tgt_all`</span>)</span>
<span id="cb77-1141"><a href="#cb77-1141" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Determine how many factors to retain using the scree plot (keep the number of factors where the blue line is above the red line)</span>
<span id="cb77-1142"><a href="#cb77-1142" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Determine the percent variance accounted for by the number of factors retained by changing the "minimum % age accounted for criterion".</span>
<span id="cb77-1143"><a href="#cb77-1143" aria-hidden="true" tabindex="-1"></a>Record the number of factors retained and % variance accounted for by that number of factors.</span>
<span id="cb77-1144"><a href="#cb77-1144" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Re-run the temporal PCA using the above inputs, **but change the number of factors to the number of factors retained from the above step**</span>
<span id="cb77-1145"><a href="#cb77-1145" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Return to <span class="in">`Main`</span> and click <span class="in">`Save`</span>. Save the tPCA file in the <span class="in">`5-PCA`</span> folder</span>
<span id="cb77-1146"><a href="#cb77-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1147"><a href="#cb77-1147" aria-hidden="true" tabindex="-1"></a><span class="fu">## Spatial PCA</span></span>
<span id="cb77-1148"><a href="#cb77-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1149"><a href="#cb77-1149" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Go to <span class="in">`Main`</span> and click <span class="in">`PCA`</span></span>
<span id="cb77-1150"><a href="#cb77-1150" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Change the PCA type, using the following inputs:</span>
<span id="cb77-1151"><a href="#cb77-1151" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Mode: <span class="in">`spatial`</span></span>
<span id="cb77-1152"><a href="#cb77-1152" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Rotation: <span class="in">`infomax`</span></span>
<span id="cb77-1153"><a href="#cb77-1153" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Factors: <span class="in">`0`</span></span>
<span id="cb77-1154"><a href="#cb77-1154" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Title: sPCA_experimentname (e.g., <span class="in">`sPCA_ob_tgt_all`</span>)</span>
<span id="cb77-1155"><a href="#cb77-1155" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Click the appropriate file (e.g., <span class="in">`ob_tgt_all`</span>)</span>
<span id="cb77-1156"><a href="#cb77-1156" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Determine how many factors to retain using the scree plot (keep the number of factors where the blue line is above the red line)</span>
<span id="cb77-1157"><a href="#cb77-1157" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Determine the percent variance accounted for by the number of factors retained by changing the "minimum % age accounted for criterion".</span>
<span id="cb77-1158"><a href="#cb77-1158" aria-hidden="true" tabindex="-1"></a>Record the number of factors retained and % variance accounted for by that number of factors.</span>
<span id="cb77-1159"><a href="#cb77-1159" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Re-run the spatial PCA using the above inputs, **but change the number of factors to the number of factors retained from the above step**</span>
<span id="cb77-1160"><a href="#cb77-1160" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Return to <span class="in">`Main`</span> and click <span class="in">`Save`</span>.</span>
<span id="cb77-1161"><a href="#cb77-1161" aria-hidden="true" tabindex="-1"></a>Save the sPCA file in the <span class="in">`5-PCA`</span> folder</span>
<span id="cb77-1162"><a href="#cb77-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1163"><a href="#cb77-1163" aria-hidden="true" tabindex="-1"></a><span class="fu">## Temporospatial PCA</span></span>
<span id="cb77-1164"><a href="#cb77-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1165"><a href="#cb77-1165" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Go to <span class="in">`Main`</span> and click <span class="in">`PCA`</span></span>
<span id="cb77-1166"><a href="#cb77-1166" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Change the PCA type, using the following inputs:</span>
<span id="cb77-1167"><a href="#cb77-1167" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Mode: <span class="in">`spatial`</span></span>
<span id="cb77-1168"><a href="#cb77-1168" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Rotation: <span class="in">`infomax`</span></span>
<span id="cb77-1169"><a href="#cb77-1169" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Factors: <span class="in">`0`</span></span>
<span id="cb77-1170"><a href="#cb77-1170" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Title: tsPCA_experimentname (e.g., <span class="in">`tsPCA_ob_tgt_all`</span>)</span>
<span id="cb77-1171"><a href="#cb77-1171" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Click the <span class="in">`tPCA`</span> file (created in the previous step)</span>
<span id="cb77-1172"><a href="#cb77-1172" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Determine how many factors to retain using the scree plot (keep the number of factors where the blue line is above the red line)</span>
<span id="cb77-1173"><a href="#cb77-1173" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Determine the percent variance accounted for by the number of factors retained by changing the "minimum % age accounted for criterion".</span>
<span id="cb77-1174"><a href="#cb77-1174" aria-hidden="true" tabindex="-1"></a>Record the number of factors retained and % variance accounted for by that number of factors.</span>
<span id="cb77-1175"><a href="#cb77-1175" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Re-run the spatial PCA using the above inputs, **but change the number of factors to the number of factors retained from the above step**</span>
<span id="cb77-1176"><a href="#cb77-1176" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Return to <span class="in">`Main`</span> and click <span class="in">`Save`</span>.</span>
<span id="cb77-1177"><a href="#cb77-1177" aria-hidden="true" tabindex="-1"></a>Save the tsPCA file in the <span class="in">`5-PCA`</span> folder.</span>
<span id="cb77-1178"><a href="#cb77-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1179"><a href="#cb77-1179" aria-hidden="true" tabindex="-1"></a><span class="fu">## PCA Component Selection and Extraction {#sec-extract}</span></span>
<span id="cb77-1180"><a href="#cb77-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1181"><a href="#cb77-1181" aria-hidden="true" tabindex="-1"></a>Here, the goal is to select the PCA component that corresponds to the ERP component of interest, and the extraction that supports the intended interpretability of the component.</span>
<span id="cb77-1182"><a href="#cb77-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1183"><a href="#cb77-1183" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Go to <span class="in">`View`</span> to begin the process of selecting the PCA component that corresponds to the ERP of interest.</span>
<span id="cb77-1184"><a href="#cb77-1184" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Iteratively select and view each temporospatial PCA component to identify the PCA component ("factor") that corresponds to the ERP of interest (e.g., N2 or P3).</span>
<span id="cb77-1185"><a href="#cb77-1185" aria-hidden="true" tabindex="-1"></a>    Select the temporospatial PCA component that corresponds to the ERP of interest based on the timing, spatial location, morphology, and (as relevant) any condition- or age-related differences of the component based on prior work.</span>
<span id="cb77-1186"><a href="#cb77-1186" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Generate tsPCA components.</span>
<span id="cb77-1187"><a href="#cb77-1187" aria-hidden="true" tabindex="-1"></a>Go to <span class="in">`Window`</span> and input the following:</span>
<span id="cb77-1188"><a href="#cb77-1188" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>select the tsPCA file</span>
<span id="cb77-1189"><a href="#cb77-1189" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>select among <span class="in">`mean`</span>, <span class="in">`maxPeak`</span>, or other options.</span>
<span id="cb77-1190"><a href="#cb77-1190" aria-hidden="true" tabindex="-1"></a>      (According to Joe Dien), when using amplitudes from PCA components, it does not matter which option you select—all the different methods result in comparable *p*-values when dealing with PCA components.</span>
<span id="cb77-1191"><a href="#cb77-1191" aria-hidden="true" tabindex="-1"></a>      So, select a method that makes sense for the story you want to tell.</span>
<span id="cb77-1192"><a href="#cb77-1192" aria-hidden="true" tabindex="-1"></a>      The methods will yield different results when dealing with the raw waveforms.</span>
<span id="cb77-1193"><a href="#cb77-1193" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>select <span class="in">`AutoPCA`</span> or <span class="in">`Window`</span> to <span class="co">[</span><span class="ot">select channels</span><span class="co">](#sec-channels)</span>.</span>
<span id="cb77-1194"><a href="#cb77-1194" aria-hidden="true" tabindex="-1"></a>      If the peak amplitude is where you expect temporally and spatially, then use the autoPCA function, and if it is not, then window to where you expect it to be.</span>
<span id="cb77-1195"><a href="#cb77-1195" aria-hidden="true" tabindex="-1"></a>      This will allow you to report results that are more interpretable.</span>
<span id="cb77-1196"><a href="#cb77-1196" aria-hidden="true" tabindex="-1"></a>      As Joe Dien described, the way that PCA data are stored internally in the toolkit are as factor scores (i.e., component scores).</span>
<span id="cb77-1197"><a href="#cb77-1197" aria-hidden="true" tabindex="-1"></a>      When you extract amplitudes from a PCA component, you are extracting the factor scores multiplied by a constant (some scaling factor, representing the electrode where you extract it from).</span>
<span id="cb77-1198"><a href="#cb77-1198" aria-hidden="true" tabindex="-1"></a>      Thus, according to Joe Dien, the *p*-values should be the same regardless of whether you use AutoPCA, or extract from a single electrode or multiple electrodes (it would be good to verify this).</span>
<span id="cb77-1199"><a href="#cb77-1199" aria-hidden="true" tabindex="-1"></a>      What is changing is merely the scaling factor (i.e., the constant that is multiplied by all factor scores).</span>
<span id="cb77-1200"><a href="#cb77-1200" aria-hidden="true" tabindex="-1"></a>      When you select multiple electrodes, it is computing the PCA-estimated amplitude at each electrode and performing a simple average across those electrodes.</span>
<span id="cb77-1201"><a href="#cb77-1201" aria-hidden="true" tabindex="-1"></a>      The AutoPCA extracts the PCA-estimated amplitude at the peak channel and the peak timepoint.</span>
<span id="cb77-1202"><a href="#cb77-1202" aria-hidden="true" tabindex="-1"></a>      If the waveform is negative-going at the peak channel, and you are interested in the positive-going dipole, you would select the peak positive channel to identify the PCA-estimated amplitude of the positive-going waveform on that PCA component.</span>
<span id="cb77-1203"><a href="#cb77-1203" aria-hidden="true" tabindex="-1"></a>      Nevertheless, even though you are selecting the PCA-estimated amplitude for a given channel at a given electrode, there are now "virtual channels"; the estimates include the contributions of all channels and all timepoints <span class="dt">&lt;</span><span class="kw">u</span><span class="dt">&gt;</span>to the extent that<span class="dt">&lt;/</span><span class="kw">u</span><span class="dt">&gt;</span> they load onto the PCA component of interest.</span>
<span id="cb77-1204"><a href="#cb77-1204" aria-hidden="true" tabindex="-1"></a>      Thus, even if you select to window a PCA component from only 1 channel at 1 timepoint, it is using ALL channels and timepoints in the estimation—this is not the case if windowing the raw ERP waveforms.</span>
<span id="cb77-1205"><a href="#cb77-1205" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Save the files generated from the AutoPCA in the <span class="in">`6 - PCA Components`</span> folder using the following naming convention: "erp_task_condition_age_component" (e.g.,<span class="in">`erp_ob_tgt_all_P3`</span>).</span>
<span id="cb77-1206"><a href="#cb77-1206" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>To view all of the tsPCA components, click <span class="in">`View`</span> and input the following</span>
<span id="cb77-1207"><a href="#cb77-1207" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>select the appropriate file (e.g., <span class="in">`ob_tgt_all`</span>)</span>
<span id="cb77-1208"><a href="#cb77-1208" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>select <span class="in">`gave`</span></span>
<span id="cb77-1209"><a href="#cb77-1209" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>select <span class="in">`none`</span></span>
<span id="cb77-1210"><a href="#cb77-1210" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>click <span class="in">`Waves`</span></span>
<span id="cb77-1211"><a href="#cb77-1211" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>It is good practice to check to make sure that components are comparable across different age ranges</span>
<span id="cb77-1212"><a href="#cb77-1212" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>You can check this in one of two ways:</span>
<span id="cb77-1213"><a href="#cb77-1213" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>Visually examine grand averages between age ranges</span>
<span id="cb77-1214"><a href="#cb77-1214" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>Apply the PCA from one age group and apply it to another age group and examine whether the results hold up using cross-validation in EPToolkit</span>
<span id="cb77-1215"><a href="#cb77-1215" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>It is generally useful to keep track of the extraction process for each PCA component.</span>
<span id="cb77-1216"><a href="#cb77-1216" aria-hidden="true" tabindex="-1"></a>Our current procedure for doing so is keeping a <span class="in">`PCA_ComponentInfo.txt`</span> file in the <span class="in">`6-PCA Components`</span> folder.</span>
<span id="cb77-1217"><a href="#cb77-1217" aria-hidden="true" tabindex="-1"></a><span class="ss">   * </span>Relevant information may include the timing used to window a component and the electrodes that load onto the component of interest at a given threshold</span>
<span id="cb77-1218"><a href="#cb77-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1219"><a href="#cb77-1219" aria-hidden="true" tabindex="-1"></a><span class="fu">## Identifying Electrodes that Load Onto PCA Component {#sec-channels}</span></span>
<span id="cb77-1220"><a href="#cb77-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1221"><a href="#cb77-1221" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Go to <span class="in">`Window`</span></span>
<span id="cb77-1222"><a href="#cb77-1222" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Select the PCA file of interest (e.g., <span class="in">`tsPCA_ob_tgt_all`</span>)</span>
<span id="cb77-1223"><a href="#cb77-1223" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Click the <span class="in">`Channels`</span> button (about halfway down the <span class="in">`Window`</span> window)</span>
<span id="cb77-1224"><a href="#cb77-1224" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Click <span class="in">`Factor`</span> </span>
<span id="cb77-1225"><a href="#cb77-1225" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>From the dropdown, select the PCA file of interest (e.g., <span class="in">`tsPCA_ob_tgt_all`</span>)</span>
<span id="cb77-1226"><a href="#cb77-1226" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Enter the threshold in the space below (e.g., 0.5)</span>
<span id="cb77-1227"><a href="#cb77-1227" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>This sets the minumum factor loading value for an electrode to be "included" in the component-related cluster</span>
<span id="cb77-1228"><a href="#cb77-1228" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Depending on whenther you are interested in positive or negative factor loadings, select the appropriate sign (<span class="in">`+`</span>, <span class="in">`-`</span>, or <span class="in">`+/-`</span>)</span>
<span id="cb77-1229"><a href="#cb77-1229" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>A popup window with PCA factors will appear.</span>
<span id="cb77-1230"><a href="#cb77-1230" aria-hidden="true" tabindex="-1"></a>    Select the component(s) you wish to identify spatially (e.g., <span class="in">`TF01SF01`</span>)</span>
<span id="cb77-1231"><a href="#cb77-1231" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>When prompted, give the electrode cluster a name</span>
<span id="cb77-1232"><a href="#cb77-1232" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The channels that change color are those which load onto the selected component at or above the threshold value</span>
<span id="cb77-1233"><a href="#cb77-1233" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>If you plan to use this cluster in extracting a PCA component, you'll need save the cluster</span>
<span id="cb77-1234"><a href="#cb77-1234" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Click <span class="in">`Save`</span> in the <span class="in">`Window`</span> window</span>
<span id="cb77-1235"><a href="#cb77-1235" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Save the cluster to <span class="in">`6-PCA Components`</span></span>
<span id="cb77-1236"><a href="#cb77-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1237"><a href="#cb77-1237" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exporting Grand Average Data</span></span>
<span id="cb77-1238"><a href="#cb77-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1239"><a href="#cb77-1239" aria-hidden="true" tabindex="-1"></a>If you are only interested in the grand average data and not individual subjects, these instructions will allow you to export a .txt file containing only the grand average data.</span>
<span id="cb77-1240"><a href="#cb77-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1241"><a href="#cb77-1241" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>From EP Toolkit home (<span class="in">`Main`</span> screen), select <span class="in">`Edit`</span></span>
<span id="cb77-1242"><a href="#cb77-1242" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Select the .ept averages file (e.g., <span class="in">`ob_tgt_all`</span>) that contains a "subject" representing the grand average</span>
<span id="cb77-1243"><a href="#cb77-1243" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>If the file does NOT contain a grand average subject, follow the steps in the above section to generate it</span>
<span id="cb77-1244"><a href="#cb77-1244" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Rename the file </span>
<span id="cb77-1245"><a href="#cb77-1245" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>For example, <span class="in">`ob_tgt_all`</span> could be renamed to <span class="in">`ob_tgt_gav`</span></span>
<span id="cb77-1246"><a href="#cb77-1246" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Renaming the file will prompt EP Toolkit to ask whether you want to generate a new file with this new name, or overwrite the existing datafile once your changes are complete</span>
<span id="cb77-1247"><a href="#cb77-1247" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Select <span class="in">`Subjects`</span> from the options at the top of the editor window</span>
<span id="cb77-1248"><a href="#cb77-1248" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Click <span class="in">`All`</span> from among the options on the lefthand side of the <span class="in">`Subjects`</span> window</span>
<span id="cb77-1249"><a href="#cb77-1249" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This will select all of the subjects</span>
<span id="cb77-1250"><a href="#cb77-1250" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Scroll to the bottom of the list of subjects and **deselect** the subject labeled <span class="in">`grand average`</span></span>
<span id="cb77-1251"><a href="#cb77-1251" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Essentially, the goal here is to create a dataset that includes ONLY the grand average information, rather than each individual subject</span>
<span id="cb77-1252"><a href="#cb77-1252" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Once everything EXCEPT for the grand average subject is selected, click <span class="in">`Delete`</span> on the lefthand side of the editor window</span>
<span id="cb77-1253"><a href="#cb77-1253" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This will remove the individual subject data from the dataset and leave the grand average information </span>
<span id="cb77-1254"><a href="#cb77-1254" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Click <span class="in">`Done`</span></span>
<span id="cb77-1255"><a href="#cb77-1255" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>If you renamed the datafile, EP Toolkit should generate a popup message asking whether you would like to rename your dataset OR generate a new dataset using the new name (leaving the original dataset untouched).</span>
<span id="cb77-1256"><a href="#cb77-1256" aria-hidden="true" tabindex="-1"></a>From the options presented, click <span class="in">`New`</span> to generate a new file and preserve the original</span>
<span id="cb77-1257"><a href="#cb77-1257" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The editor window should close, returning you to the EP Toolkit pane that asks you to select a dataset to edit. </span>
<span id="cb77-1258"><a href="#cb77-1258" aria-hidden="true" tabindex="-1"></a>From here, click <span class="in">`Main`</span> to return to EP Toolkit "home"</span>
<span id="cb77-1259"><a href="#cb77-1259" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Once in the main window, click <span class="in">`Save`</span></span>
<span id="cb77-1260"><a href="#cb77-1260" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Set the save format to <span class="in">`Text (.txt)`</span></span>
<span id="cb77-1261"><a href="#cb77-1261" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Click the grand average data (e.g., <span class="in">`ob_tgt_gav`</span>) to save it</span>
<span id="cb77-1262"><a href="#cb77-1262" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>A file explorer window should open, prompting you to select the appropriate save location and give your file a name </span>
<span id="cb77-1263"><a href="#cb77-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1264"><a href="#cb77-1264" aria-hidden="true" tabindex="-1"></a><span class="fu"># Generating ERP Composite Datafiles</span></span>
<span id="cb77-1265"><a href="#cb77-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1266"><a href="#cb77-1266" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Save a copy of all extracted PCA component files (e.g., <span class="in">`erp_ob_tgt_all_P3`</span>) in the following location on the Lab Drive: <span class="in">`[...]/Data/LV2/PCA Components`</span> under the appropriate task (i.e., Oddball, Fishshark, or Stop Signal)</span>
<span id="cb77-1267"><a href="#cb77-1267" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use the following R Code to combine all components into a single composites datafile.</span>
<span id="cb77-1268"><a href="#cb77-1268" aria-hidden="true" tabindex="-1"></a>The following example is taken from the <span class="in">`erpOddball.R`</span> composite script located in <span class="in">`[...]Data Processing/3. Composites`</span> and available via Git <span class="co">[</span><span class="ot">here</span><span class="co">](https://research-git.uiowa.edu/PetersenLab/SRS/SRS-DataProcessing/-/blob/master/3.%20Composites/erpOddball.R)</span>.</span>
<span id="cb77-1269"><a href="#cb77-1269" aria-hidden="true" tabindex="-1"></a>Comparable scripts have also been created for FishShark and Stop Signal tasks.</span>
<span id="cb77-1270"><a href="#cb77-1270" aria-hidden="true" tabindex="-1"></a><span class="ss">   1. </span>Create a list of all PCA component files in the specified directory.</span>
<span id="cb77-1271"><a href="#cb77-1271" aria-hidden="true" tabindex="-1"></a>   This list will contain the full filepaths to each component file which are used to read the data into R.</span>
<span id="cb77-1272"><a href="#cb77-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1273"><a href="#cb77-1273" aria-hidden="true" tabindex="-1"></a>      <span class="in">```{r}</span></span>
<span id="cb77-1274"><a href="#cb77-1274" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1275"><a href="#cb77-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1276"><a href="#cb77-1276" aria-hidden="true" tabindex="-1"></a>      oddballFilePaths <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb77-1277"><a href="#cb77-1277" aria-hidden="true" tabindex="-1"></a>       <span class="at">path =</span> <span class="st">"Z:/Shared Server/Study Folder/Data/LV2/ERP/PCA Components/Oddball"</span>, </span>
<span id="cb77-1278"><a href="#cb77-1278" aria-hidden="true" tabindex="-1"></a>       <span class="at">pattern =</span> <span class="st">"*.txt"</span>,</span>
<span id="cb77-1279"><a href="#cb77-1279" aria-hidden="true" tabindex="-1"></a>       <span class="at">recursive =</span> <span class="cn">FALSE</span>,</span>
<span id="cb77-1280"><a href="#cb77-1280" aria-hidden="true" tabindex="-1"></a>       <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb77-1281"><a href="#cb77-1281" aria-hidden="true" tabindex="-1"></a>      <span class="in">```</span></span>
<span id="cb77-1282"><a href="#cb77-1282" aria-hidden="true" tabindex="-1"></a><span class="ss">   1. </span>Generate a list of the names of each PCA component file in the specified directory.</span>
<span id="cb77-1283"><a href="#cb77-1283" aria-hidden="true" tabindex="-1"></a>   This list will be used to rename columns in the final composite dataset according to the name of the component file.</span>
<span id="cb77-1284"><a href="#cb77-1284" aria-hidden="true" tabindex="-1"></a>   For this reason, the naming convention of each component files is crucial; this will determine how the corresponding column of the composite datafile is named.</span>
<span id="cb77-1285"><a href="#cb77-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1286"><a href="#cb77-1286" aria-hidden="true" tabindex="-1"></a>      <span class="in">```{r}</span></span>
<span id="cb77-1287"><a href="#cb77-1287" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1288"><a href="#cb77-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1289"><a href="#cb77-1289" aria-hidden="true" tabindex="-1"></a>      oddballFiles <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb77-1290"><a href="#cb77-1290" aria-hidden="true" tabindex="-1"></a>       <span class="at">path =</span> <span class="st">"Z:/Shared Server/Study Folder/Data/LV2/ERP/PCA Components/Oddball"</span>,</span>
<span id="cb77-1291"><a href="#cb77-1291" aria-hidden="true" tabindex="-1"></a>       <span class="at">pattern =</span> <span class="st">"*.txt"</span>,</span>
<span id="cb77-1292"><a href="#cb77-1292" aria-hidden="true" tabindex="-1"></a>       <span class="at">recursive =</span> <span class="cn">FALSE</span>)</span>
<span id="cb77-1293"><a href="#cb77-1293" aria-hidden="true" tabindex="-1"></a>      <span class="in">```</span></span>
<span id="cb77-1294"><a href="#cb77-1294" aria-hidden="true" tabindex="-1"></a><span class="ss">   1. </span>Read in each component file, skipping the rows containing summary information about the extracted component (the first 7 rows in this example).</span>
<span id="cb77-1295"><a href="#cb77-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1296"><a href="#cb77-1296" aria-hidden="true" tabindex="-1"></a>      <span class="in">```{r}</span></span>
<span id="cb77-1297"><a href="#cb77-1297" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1298"><a href="#cb77-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1299"><a href="#cb77-1299" aria-hidden="true" tabindex="-1"></a>      oddballData <span class="ot">&lt;-</span> <span class="fu">lapply</span>(oddballFilePaths, <span class="cf">function</span>(x) <span class="fu">read_delim</span>(x, <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">skip =</span> <span class="dv">7</span>)) </span>
<span id="cb77-1300"><a href="#cb77-1300" aria-hidden="true" tabindex="-1"></a>      <span class="in">```</span></span>
<span id="cb77-1301"><a href="#cb77-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1302"><a href="#cb77-1302" aria-hidden="true" tabindex="-1"></a><span class="ss">   1. </span>"Clean" the list of component file names by removing the file extension (in this case, <span class="in">`.txt`</span>).</span>
<span id="cb77-1303"><a href="#cb77-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1304"><a href="#cb77-1304" aria-hidden="true" tabindex="-1"></a>      <span class="in">```{r}</span></span>
<span id="cb77-1305"><a href="#cb77-1305" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1306"><a href="#cb77-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1307"><a href="#cb77-1307" aria-hidden="true" tabindex="-1"></a>      componentNames <span class="ot">&lt;-</span> oddballFiles <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">".txt"</span>)</span>
<span id="cb77-1308"><a href="#cb77-1308" aria-hidden="true" tabindex="-1"></a>      <span class="in">```</span></span>
<span id="cb77-1309"><a href="#cb77-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1310"><a href="#cb77-1310" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>Give <span class="in">`ID`</span> variable a proper name.</span>
<span id="cb77-1311"><a href="#cb77-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1312"><a href="#cb77-1312" aria-hidden="true" tabindex="-1"></a>       <span class="in">```{r}</span></span>
<span id="cb77-1313"><a href="#cb77-1313" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1314"><a href="#cb77-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1315"><a href="#cb77-1315" aria-hidden="true" tabindex="-1"></a>       oddballData <span class="ot">&lt;-</span> <span class="fu">lapply</span>(oddballData, <span class="cf">function</span>(x){</span>
<span id="cb77-1316"><a href="#cb77-1316" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(x)[<span class="fu">length</span>(<span class="fu">names</span>(x))] <span class="ot">&lt;-</span> <span class="st">"ID"</span></span>
<span id="cb77-1317"><a href="#cb77-1317" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(x)</span>
<span id="cb77-1318"><a href="#cb77-1318" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb77-1319"><a href="#cb77-1319" aria-hidden="true" tabindex="-1"></a>       <span class="in">```</span></span>
<span id="cb77-1320"><a href="#cb77-1320" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>At this stage, the ERP component data are nested within a list of separate data objects.</span>
<span id="cb77-1321"><a href="#cb77-1321" aria-hidden="true" tabindex="-1"></a>    We must therefore merge them into a single dataframe object.</span>
<span id="cb77-1322"><a href="#cb77-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1323"><a href="#cb77-1323" aria-hidden="true" tabindex="-1"></a>       <span class="in">```{r}</span></span>
<span id="cb77-1324"><a href="#cb77-1324" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1325"><a href="#cb77-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1326"><a href="#cb77-1326" aria-hidden="true" tabindex="-1"></a>       oddballDataMerged <span class="ot">&lt;-</span> oddballData <span class="sc">%&gt;%</span></span>
<span id="cb77-1327"><a href="#cb77-1327" aria-hidden="true" tabindex="-1"></a>          <span class="fu">reduce</span>(full_join, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ID"</span>))</span>
<span id="cb77-1328"><a href="#cb77-1328" aria-hidden="true" tabindex="-1"></a>       <span class="in">```</span></span>
<span id="cb77-1329"><a href="#cb77-1329" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>Organize the combined data.</span>
<span id="cb77-1330"><a href="#cb77-1330" aria-hidden="true" tabindex="-1"></a>    The code below performs the following operations (in order of appearance):</span>
<span id="cb77-1331"><a href="#cb77-1331" aria-hidden="true" tabindex="-1"></a><span class="ss">       * </span>Create <span class="in">`tcid`</span> variable by extracting the first four characters of existing <span class="in">`ID`</span> variable</span>
<span id="cb77-1332"><a href="#cb77-1332" aria-hidden="true" tabindex="-1"></a><span class="ss">       * </span>Create <span class="in">`wave`</span> variable by extracting the 6th and 7th characters of existing <span class="in">`ID`</span> variable</span>
<span id="cb77-1333"><a href="#cb77-1333" aria-hidden="true" tabindex="-1"></a><span class="ss">       * </span>Re-order the data so that <span class="in">`tcid`</span> and <span class="in">`wave`</span> appear as the first two columns while all other columns retain their order in the dataset</span>
<span id="cb77-1334"><a href="#cb77-1334" aria-hidden="true" tabindex="-1"></a><span class="ss">       * </span>Remove the <span class="in">`ID`</span> variable now that it has been separated into <span class="in">`tcid`</span> and <span class="in">`wave`</span></span>
<span id="cb77-1335"><a href="#cb77-1335" aria-hidden="true" tabindex="-1"></a><span class="ss">       * </span>Convert all values to numeric</span>
<span id="cb77-1336"><a href="#cb77-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1337"><a href="#cb77-1337" aria-hidden="true" tabindex="-1"></a>       <span class="in">```{r}</span></span>
<span id="cb77-1338"><a href="#cb77-1338" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1339"><a href="#cb77-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1340"><a href="#cb77-1340" aria-hidden="true" tabindex="-1"></a>       oddballDataClean <span class="ot">&lt;-</span> oddballDataMerged <span class="sc">%&gt;%</span></span>
<span id="cb77-1341"><a href="#cb77-1341" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">tcid =</span> <span class="fu">substr</span>(ID, <span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb77-1342"><a href="#cb77-1342" aria-hidden="true" tabindex="-1"></a>                 <span class="at">wave =</span> <span class="fu">substr</span>(ID, <span class="dv">6</span>, <span class="dv">7</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb77-1343"><a href="#cb77-1343" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(tcid, wave, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb77-1344"><a href="#cb77-1344" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(<span class="sc">-</span>ID) <span class="sc">%&gt;%</span> </span>
<span id="cb77-1345"><a href="#cb77-1345" aria-hidden="true" tabindex="-1"></a>          <span class="fu">type_convert</span>()</span>
<span id="cb77-1346"><a href="#cb77-1346" aria-hidden="true" tabindex="-1"></a>       <span class="in">```</span></span>
<span id="cb77-1347"><a href="#cb77-1347" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>Update column names of merged data according to the list of PCA component files.</span>
<span id="cb77-1348"><a href="#cb77-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1349"><a href="#cb77-1349" aria-hidden="true" tabindex="-1"></a>       <span class="in">```{r}</span></span>
<span id="cb77-1350"><a href="#cb77-1350" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1351"><a href="#cb77-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1352"><a href="#cb77-1352" aria-hidden="true" tabindex="-1"></a>       <span class="fu">names</span>(oddballDataClean) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tcid"</span>, <span class="st">"wave"</span>, componentNames)</span>
<span id="cb77-1353"><a href="#cb77-1353" aria-hidden="true" tabindex="-1"></a>       <span class="in">```</span></span>
<span id="cb77-1354"><a href="#cb77-1354" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>Save composite data to desired location.</span>
<span id="cb77-1355"><a href="#cb77-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1356"><a href="#cb77-1356" aria-hidden="true" tabindex="-1"></a>       <span class="in">```{r}</span></span>
<span id="cb77-1357"><a href="#cb77-1357" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1358"><a href="#cb77-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1359"><a href="#cb77-1359" aria-hidden="true" tabindex="-1"></a>       <span class="fu">write_csv</span>(oddballDataClean, <span class="at">file =</span> <span class="st">"Z:/Shared Server/Study Folder/Data/REDCap/Composites/erpOddball.csv"</span>)</span>
<span id="cb77-1360"><a href="#cb77-1360" aria-hidden="true" tabindex="-1"></a>       <span class="in">```</span></span>
<span id="cb77-1361"><a href="#cb77-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1362"><a href="#cb77-1362" aria-hidden="true" tabindex="-1"></a><span class="fu"># Visualizations in R </span></span>
<span id="cb77-1363"><a href="#cb77-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1364"><a href="#cb77-1364" aria-hidden="true" tabindex="-1"></a><span class="fu">## R Code for Grand Average Waveform Plot</span></span>
<span id="cb77-1365"><a href="#cb77-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1366"><a href="#cb77-1366" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Read in the grand average waveform data exported from EP Toolkit.</span>
<span id="cb77-1367"><a href="#cb77-1367" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>We currently process the conditions within a given task separately, so each condition should have its own grand average file.</span>
<span id="cb77-1368"><a href="#cb77-1368" aria-hidden="true" tabindex="-1"></a>   <span class="in">```{r}</span></span>
<span id="cb77-1369"><a href="#cb77-1369" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1370"><a href="#cb77-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1371"><a href="#cb77-1371" aria-hidden="true" tabindex="-1"></a>   obTgt <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"V:/SRS-ERP-Oddball/Hard/All/4 - EPT Averages/2024-11-05/gave/ob_tgt_gav.txt"</span>)</span>
<span id="cb77-1372"><a href="#cb77-1372" aria-hidden="true" tabindex="-1"></a>   obFrq <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"V:/SRS-ERP-Oddball/Hard/All/4 - EPT Averages/2024-11-05/gave/ob_frq_gav.txt"</span>)</span>
<span id="cb77-1373"><a href="#cb77-1373" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-1374"><a href="#cb77-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1375"><a href="#cb77-1375" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Create a subset of data that only includes those electrodes that are part of the clusters identified in EP Toolkit.</span>
<span id="cb77-1376"><a href="#cb77-1376" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The grand average data does not have row or column labels, but the columns represent the EEG net channels in numerical order (1-129).</span>
<span id="cb77-1377"><a href="#cb77-1377" aria-hidden="true" tabindex="-1"></a>   We can therefore use their column index values to select the desired electrodes; so, the list containing the channel numbers should include ONLY numbers.</span>
<span id="cb77-1378"><a href="#cb77-1378" aria-hidden="true" tabindex="-1"></a>   The code that selects these channels out of the full dataset will rely on numerical input.  </span>
<span id="cb77-1379"><a href="#cb77-1379" aria-hidden="true" tabindex="-1"></a>   <span class="in">```{r}</span></span>
<span id="cb77-1380"><a href="#cb77-1380" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1381"><a href="#cb77-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1382"><a href="#cb77-1382" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Set electrode clusters</span></span>
<span id="cb77-1383"><a href="#cb77-1383" aria-hidden="true" tabindex="-1"></a>   obElectrodes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">64</span>, <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">67</span>, <span class="dv">69</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">72</span>, <span class="dv">73</span>, <span class="dv">74</span>, <span class="dv">75</span>, <span class="dv">76</span>, <span class="dv">77</span>, <span class="dv">81</span>, <span class="dv">82</span>, <span class="dv">83</span>, <span class="dv">84</span>, <span class="dv">89</span>, <span class="dv">80</span>, <span class="dv">91</span>, <span class="dv">95</span>, <span class="dv">96</span>, <span class="dv">101</span>)</span>
<span id="cb77-1384"><a href="#cb77-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1385"><a href="#cb77-1385" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Subset to desired electrodes</span></span>
<span id="cb77-1386"><a href="#cb77-1386" aria-hidden="true" tabindex="-1"></a>   obTgt_sub <span class="ot">&lt;-</span> obTgt[, obElectrodes]</span>
<span id="cb77-1387"><a href="#cb77-1387" aria-hidden="true" tabindex="-1"></a>   obFrq_sub <span class="ot">&lt;-</span> obFrq[, obElectrodes]</span>
<span id="cb77-1388"><a href="#cb77-1388" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-1389"><a href="#cb77-1389" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Compute averages and create labels for conditions</span>
<span id="cb77-1390"><a href="#cb77-1390" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Once the data have been subsetted down to include only the electrode channels of interest, all that remains is to compute the average amplitude across all of those channels</span>
<span id="cb77-1391"><a href="#cb77-1391" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Adding a condition label will allow us to combine the two condition-specific datasets into one that can be used for visualizations </span>
<span id="cb77-1392"><a href="#cb77-1392" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>For ease of plotting, name the conditions the way that you would like them to appear on the figure (i.e., "Target" instead of "tgt")</span>
<span id="cb77-1393"><a href="#cb77-1393" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb77-1394"><a href="#cb77-1394" aria-hidden="true" tabindex="-1"></a>   <span class="in">```{r}</span></span>
<span id="cb77-1395"><a href="#cb77-1395" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1396"><a href="#cb77-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1397"><a href="#cb77-1397" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Compute averages </span></span>
<span id="cb77-1398"><a href="#cb77-1398" aria-hidden="true" tabindex="-1"></a>   obTgt_sub<span class="sc">$</span>amplitude <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(obTgt_sub)</span>
<span id="cb77-1399"><a href="#cb77-1399" aria-hidden="true" tabindex="-1"></a>   obFrq_sub<span class="sc">$</span>amplitude <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(obFrq_sub)</span>
<span id="cb77-1400"><a href="#cb77-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1401"><a href="#cb77-1401" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Remove raw values and add condition labels</span></span>
<span id="cb77-1402"><a href="#cb77-1402" aria-hidden="true" tabindex="-1"></a>   obTgt_amps <span class="ot">&lt;-</span> obTgt_sub <span class="sc">%&gt;%</span> <span class="fu">select</span>(amplitude) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="st">"Target"</span>)</span>
<span id="cb77-1403"><a href="#cb77-1403" aria-hidden="true" tabindex="-1"></a>   obFrq_amps <span class="ot">&lt;-</span> obFrq_sub <span class="sc">%&gt;%</span> <span class="fu">select</span>(amplitude) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="st">"Frequent"</span>)</span>
<span id="cb77-1404"><a href="#cb77-1404" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-1405"><a href="#cb77-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1406"><a href="#cb77-1406" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Add timing-related information to the data</span>
<span id="cb77-1407"><a href="#cb77-1407" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>EP Toolkit exports ERP data without timestamps, but arranges it in order of timing</span>
<span id="cb77-1408"><a href="#cb77-1408" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>We can create a template with the appropriate timestamps and append this column to the amplitude data</span>
<span id="cb77-1409"><a href="#cb77-1409" aria-hidden="true" tabindex="-1"></a>   <span class="in">```{r}</span></span>
<span id="cb77-1410"><a href="#cb77-1410" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1411"><a href="#cb77-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1412"><a href="#cb77-1412" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Create template</span></span>
<span id="cb77-1413"><a href="#cb77-1413" aria-hidden="true" tabindex="-1"></a>   erpTemplate <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb77-1414"><a href="#cb77-1414" aria-hidden="true" tabindex="-1"></a>     <span class="at">time =</span> <span class="sc">-</span><span class="dv">199</span><span class="sc">:</span><span class="dv">1000</span></span>
<span id="cb77-1415"><a href="#cb77-1415" aria-hidden="true" tabindex="-1"></a>   )</span>
<span id="cb77-1416"><a href="#cb77-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1417"><a href="#cb77-1417" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Merge template with amplitude data</span></span>
<span id="cb77-1418"><a href="#cb77-1418" aria-hidden="true" tabindex="-1"></a>   obTgtTimes <span class="ot">&lt;-</span> <span class="fu">cbind</span>(erpTemplate, obTgt_amps)</span>
<span id="cb77-1419"><a href="#cb77-1419" aria-hidden="true" tabindex="-1"></a>   obFrqTimes <span class="ot">&lt;-</span> <span class="fu">cbind</span>(erpTemplate, obFrq_amps)</span>
<span id="cb77-1420"><a href="#cb77-1420" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-1421"><a href="#cb77-1421" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Combine all conditions into a single data object to be used for plotting </span>
<span id="cb77-1422"><a href="#cb77-1422" aria-hidden="true" tabindex="-1"></a>   <span class="in">```{r}</span></span>
<span id="cb77-1423"><a href="#cb77-1423" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1424"><a href="#cb77-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1425"><a href="#cb77-1425" aria-hidden="true" tabindex="-1"></a>   oddball <span class="ot">&lt;-</span> <span class="fu">rbind</span>(obTgtTimes, obFrqTimes) <span class="sc">%&gt;%</span> </span>
<span id="cb77-1426"><a href="#cb77-1426" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(time, condition, amplitude) <span class="sc">%&gt;%</span> </span>
<span id="cb77-1427"><a href="#cb77-1427" aria-hidden="true" tabindex="-1"></a>              <span class="fu">arrange</span>(time)</span>
<span id="cb77-1428"><a href="#cb77-1428" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-1429"><a href="#cb77-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1430"><a href="#cb77-1430" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Generate the waveform figures </span>
<span id="cb77-1431"><a href="#cb77-1431" aria-hidden="true" tabindex="-1"></a>   <span class="in">```{r}</span></span>
<span id="cb77-1432"><a href="#cb77-1432" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb77-1433"><a href="#cb77-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1434"><a href="#cb77-1434" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(</span>
<span id="cb77-1435"><a href="#cb77-1435" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> oddball,</span>
<span id="cb77-1436"><a href="#cb77-1436" aria-hidden="true" tabindex="-1"></a>     <span class="fu">aes</span>(</span>
<span id="cb77-1437"><a href="#cb77-1437" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> time,</span>
<span id="cb77-1438"><a href="#cb77-1438" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> amplitude,</span>
<span id="cb77-1439"><a href="#cb77-1439" aria-hidden="true" tabindex="-1"></a>       <span class="at">group =</span> condition,</span>
<span id="cb77-1440"><a href="#cb77-1440" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> condition</span>
<span id="cb77-1441"><a href="#cb77-1441" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb77-1442"><a href="#cb77-1442" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">+</span></span>
<span id="cb77-1443"><a href="#cb77-1443" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb77-1444"><a href="#cb77-1444" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_x_continuous</span>(</span>
<span id="cb77-1445"><a href="#cb77-1445" aria-hidden="true" tabindex="-1"></a>       <span class="at">name =</span> <span class="st">"Time Relative to Stimulus Onset (ms)"</span>,</span>
<span id="cb77-1446"><a href="#cb77-1446" aria-hidden="true" tabindex="-1"></a>       <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">200</span>, <span class="dv">1000</span>),</span>
<span id="cb77-1447"><a href="#cb77-1447" aria-hidden="true" tabindex="-1"></a>       <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">200</span>, <span class="at">to =</span> <span class="dv">1000</span>, <span class="at">by =</span> <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb77-1448"><a href="#cb77-1448" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb77-1449"><a href="#cb77-1449" aria-hidden="true" tabindex="-1"></a>       <span class="at">name =</span> <span class="st">"Voltage (microvolts)"</span>,</span>
<span id="cb77-1450"><a href="#cb77-1450" aria-hidden="true" tabindex="-1"></a>       <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">10</span>),</span>
<span id="cb77-1451"><a href="#cb77-1451" aria-hidden="true" tabindex="-1"></a>       <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">to =</span> <span class="dv">15</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb77-1452"><a href="#cb77-1452" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_color_viridis_d</span>()<span class="sc">+</span></span>
<span id="cb77-1453"><a href="#cb77-1453" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb77-1454"><a href="#cb77-1454" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(</span>
<span id="cb77-1455"><a href="#cb77-1455" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">7</span>, .<span class="dv">9</span>),</span>
<span id="cb77-1456"><a href="#cb77-1456" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb77-1457"><a href="#cb77-1457" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb77-1458"><a href="#cb77-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1459"><a href="#cb77-1459" aria-hidden="true" tabindex="-1"></a><span class="fu"># Appendix </span></span>
<span id="cb77-1460"><a href="#cb77-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1461"><a href="#cb77-1461" aria-hidden="true" tabindex="-1"></a><span class="fu">## Troubleshooting</span></span>
<span id="cb77-1462"><a href="#cb77-1462" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Running out of space on EP Toolkit? </span>
<span id="cb77-1463"><a href="#cb77-1463" aria-hidden="true" tabindex="-1"></a>You can navigate to your folder (maybe under Documents/MATLAB/EPwork) and delete everything except for EPprefs to refresh your workspace. </span>
<span id="cb77-1464"><a href="#cb77-1464" aria-hidden="true" tabindex="-1"></a>NOTE: This will delete everything stored in EP Toolkit, so remember to back up files that you need to save.</span>
<span id="cb77-1465"><a href="#cb77-1465" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>If you get an error or a warning from Git when trying to commit and/or push ERP files up to the repo, you may need to initialize Git LFS.</span>
<span id="cb77-1466"><a href="#cb77-1466" aria-hidden="true" tabindex="-1"></a>The instructions for initializing Git LFS can be found <span class="co">[</span><span class="ot">here</span><span class="co">](git.qmd#sec-gitLfs)</span>.</span>
<span id="cb77-1467"><a href="#cb77-1467" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The filetypes that commonly cause such errors in our current ERP processing pipeline are:</span>
<span id="cb77-1468"><a href="#cb77-1468" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span><span class="in">`.txt`</span> files</span>
<span id="cb77-1469"><a href="#cb77-1469" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span><span class="in">`.ept`</span> files</span>
<span id="cb77-1470"><a href="#cb77-1470" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span><span class="in">`.set`</span> files</span>
<span id="cb77-1471"><a href="#cb77-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1472"><a href="#cb77-1472" aria-hidden="true" tabindex="-1"></a><span class="fu">## To-do</span></span>
<span id="cb77-1473"><a href="#cb77-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1474"><a href="#cb77-1474" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Better describe the missingness for files</span>
<span id="cb77-1475"><a href="#cb77-1475" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>We need a systematic way to identify new ways to process the missingness</span>
<span id="cb77-1476"><a href="#cb77-1476" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Find a way to best describe and report the ways of missingness</span>
<span id="cb77-1477"><a href="#cb77-1477" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Go through the maxmem edits on the clean_rawData question.</span>
<span id="cb77-1478"><a href="#cb77-1478" aria-hidden="true" tabindex="-1"></a>We want a standardized value on the machines</span>
<span id="cb77-1479"><a href="#cb77-1479" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Look at the warning messages for the automatic script updates</span>
<span id="cb77-1480"><a href="#cb77-1480" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>automatic cleaning of files problems</span>
<span id="cb77-1481"><a href="#cb77-1481" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Integrate ERPLAB with our existing EEGLab Functions including: </span>
<span id="cb77-1482"><a href="#cb77-1482" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Adding an event list: </span>
<span id="cb77-1483"><a href="#cb77-1483" aria-hidden="true" tabindex="-1"></a><span class="ss">         - </span>Currently, some code for this is updated in the script on the lab drive</span>
<span id="cb77-1484"><a href="#cb77-1484" aria-hidden="true" tabindex="-1"></a><span class="ss">         - </span>Documentation is <span class="co">[</span><span class="ot">here</span><span class="co">](https://github.com/lucklab/erplab/wiki/Creating-an-EventList:-ERPLAB-Functions:-Tutorial)</span></span>
<span id="cb77-1485"><a href="#cb77-1485" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Figure out how to average epochs and export to the EP Toolkit</span>
<span id="cb77-1486"><a href="#cb77-1486" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>Evaluate the semi-automated pipelines from:</span>
<span id="cb77-1487"><a href="#cb77-1487" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Debnath et al. (2020)</span><span class="co">](https://onlinelibrary.wiley.com/doi/full/10.1111/psyp.13580)</span></span>
<span id="cb77-1488"><a href="#cb77-1488" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Desjardins et al. (2021)</span><span class="co">](https://www.sciencedirect.com/science/article/pii/S0165027020303848)</span></span>
<span id="cb77-1489"><a href="#cb77-1489" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Flo et al. (2022)</span><span class="co">](https://www.sciencedirect.com/science/article/pii/S1878929322000214)</span></span>
<span id="cb77-1490"><a href="#cb77-1490" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Gabar-Durnam et al. (2018)</span><span class="co">](https://www.frontiersin.org/articles/10.3389/fnins.2018.00097/full)</span></span>
<span id="cb77-1491"><a href="#cb77-1491" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Haresign et al. (2021)</span><span class="co">](https://www.sciencedirect.com/science/article/pii/S1878929321001146)</span></span>
<span id="cb77-1492"><a href="#cb77-1492" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="co">[</span><span class="ot">Kumaravel et al. (2022)</span><span class="co">](https://www.sciencedirect.com/science/article/pii/S1878929322000123)</span></span>
<span id="cb77-1493"><a href="#cb77-1493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1494"><a href="#cb77-1494" aria-hidden="true" tabindex="-1"></a><span class="fu">## EEGLAB</span></span>
<span id="cb77-1495"><a href="#cb77-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1496"><a href="#cb77-1496" aria-hidden="true" tabindex="-1"></a><span class="fu">### EEGLab Processing Steps</span></span>
<span id="cb77-1497"><a href="#cb77-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1498"><a href="#cb77-1498" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://eeglab.org/tutorials/&gt;</span></span>
<span id="cb77-1499"><a href="#cb77-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1500"><a href="#cb77-1500" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Filtering</span>
<span id="cb77-1501"><a href="#cb77-1501" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Average Referencing</span>
<span id="cb77-1502"><a href="#cb77-1502" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Artifact Rejection</span>
<span id="cb77-1503"><a href="#cb77-1503" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>Automated artifact rejection (save intermediate file)</span>
<span id="cb77-1504"><a href="#cb77-1504" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>Manual selection of bad channels</span>
<span id="cb77-1505"><a href="#cb77-1505" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>Manual selection of bad time periods (save intermediate file)</span>
<span id="cb77-1506"><a href="#cb77-1506" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>Removal of manually selected bad channels</span>
<span id="cb77-1507"><a href="#cb77-1507" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>Removal of manually selected bad time periods (save intermediate file)</span>
<span id="cb77-1508"><a href="#cb77-1508" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span><span class="co">[</span><span class="ot">Independent Component Analysis</span><span class="co">](#sec-ica)</span> (ICA)</span>
<span id="cb77-1509"><a href="#cb77-1509" aria-hidden="true" tabindex="-1"></a><span class="ss">        1. </span>Run ICA</span>
<span id="cb77-1510"><a href="#cb77-1510" aria-hidden="true" tabindex="-1"></a><span class="ss">        1. </span>Automated removal of bad ICA components</span>
<span id="cb77-1511"><a href="#cb77-1511" aria-hidden="true" tabindex="-1"></a><span class="ss">        1. </span>Re-run ICA (save intermediate file)</span>
<span id="cb77-1512"><a href="#cb77-1512" aria-hidden="true" tabindex="-1"></a><span class="ss">        1. </span>Manual selection of bad ICA components (save intermediate file)</span>
<span id="cb77-1513"><a href="#cb77-1513" aria-hidden="true" tabindex="-1"></a><span class="ss">        1. </span>Removal of manually selected bad ICA components</span>
<span id="cb77-1514"><a href="#cb77-1514" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Interpolation of Bad Channels</span>
<span id="cb77-1515"><a href="#cb77-1515" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Average Referencing</span>
<span id="cb77-1516"><a href="#cb77-1516" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Segmentation</span>
<span id="cb77-1517"><a href="#cb77-1517" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Baseline Correction (save final file)</span>
<span id="cb77-1518"><a href="#cb77-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1519"><a href="#cb77-1519" aria-hidden="true" tabindex="-1"></a><span class="fu">### Install Plugins</span></span>
<span id="cb77-1520"><a href="#cb77-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1521"><a href="#cb77-1521" aria-hidden="true" tabindex="-1"></a>MFFMatlabIO plugin</span>
<span id="cb77-1522"><a href="#cb77-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1523"><a href="#cb77-1523" aria-hidden="true" tabindex="-1"></a><span class="fu">### Import Data</span></span>
<span id="cb77-1524"><a href="#cb77-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1525"><a href="#cb77-1525" aria-hidden="true" tabindex="-1"></a>File → Import Data → Using EEGLAB functions and plugins → Import Magstim/EGI .mff file</span>
<span id="cb77-1526"><a href="#cb77-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1527"><a href="#cb77-1527" aria-hidden="true" tabindex="-1"></a><span class="in">```matlab</span></span>
<span id="cb77-1528"><a href="#cb77-1528" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_mffimport</span>({<span class="ss">'\\\\lc-rs-store24.hpc.uiowa.edu\\lss_itpetersen\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\0-Raw Data (mff)\\1613_90_oddball.mff'</span>}<span class="op">,</span>{<span class="ss">'code'</span>}<span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span></span>
<span id="cb77-1529"><a href="#cb77-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1530"><a href="#cb77-1530" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span></span>
<span id="cb77-1531"><a href="#cb77-1531" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1532"><a href="#cb77-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1533"><a href="#cb77-1533" aria-hidden="true" tabindex="-1"></a><span class="va">Select</span> `.<span class="va">mff</span>` <span class="va">file</span>(<span class="va">s</span>)</span>
<span id="cb77-1534"><a href="#cb77-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1535"><a href="#cb77-1535" aria-hidden="true" tabindex="-1"></a><span class="va">Event</span> <span class="va">type</span> <span class="va">field</span> (<span class="va">may</span> <span class="va">select</span> <span class="va">multiple</span>)<span class="op">:</span> `<span class="va">code</span>`</span>
<span id="cb77-1536"><a href="#cb77-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1537"><a href="#cb77-1537" aria-hidden="true" tabindex="-1"></a>### <span class="va">Filter</span> <span class="va">Data</span></span>
<span id="cb77-1538"><a href="#cb77-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1539"><a href="#cb77-1539" aria-hidden="true" tabindex="-1"></a><span class="va">Filter</span> → <span class="va">Basic</span> <span class="va">FIR</span> <span class="va">Filter</span></span>
<span id="cb77-1540"><a href="#cb77-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1541"><a href="#cb77-1541" aria-hidden="true" tabindex="-1"></a><span class="fl">0.1</span> <span class="op">--</span> <span class="fl">30</span> <span class="va">Hz</span></span>
<span id="cb77-1542"><a href="#cb77-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1543"><a href="#cb77-1543" aria-hidden="true" tabindex="-1"></a><span class="va">save</span> <span class="va">as</span> <span class="va">new</span> <span class="va">name</span></span>
<span id="cb77-1544"><a href="#cb77-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1545"><a href="#cb77-1545" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1546"><a href="#cb77-1546" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_eegfiltnew</span>(<span class="va">EEG</span><span class="op">,</span> <span class="ss">'locutoff'</span><span class="op">,</span><span class="fl">0.1</span><span class="op">,</span><span class="ss">'hicutoff'</span><span class="op">,</span><span class="fl">30</span><span class="op">,</span><span class="ss">'plotfreqz'</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb77-1547"><a href="#cb77-1547" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1548"><a href="#cb77-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1549"><a href="#cb77-1549" aria-hidden="true" tabindex="-1"></a>### <span class="va">Average</span> <span class="va">Referencing</span></span>
<span id="cb77-1550"><a href="#cb77-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1551"><a href="#cb77-1551" aria-hidden="true" tabindex="-1"></a><span class="va">Tools</span> → <span class="va">Re</span><span class="op">-</span><span class="va">reference</span> <span class="va">the</span> <span class="va">data</span> → <span class="va">Compute</span> <span class="va">average</span> <span class="va">reference</span></span>
<span id="cb77-1552"><a href="#cb77-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1553"><a href="#cb77-1553" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1554"><a href="#cb77-1554" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1555"><a href="#cb77-1555" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_reref</span>( <span class="va">EEG</span><span class="op">,</span> [])<span class="op">;</span></span>
<span id="cb77-1556"><a href="#cb77-1556" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'1613_90_oddball_fil_ref'</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1557"><a href="#cb77-1557" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1558"><a href="#cb77-1558" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1559"><a href="#cb77-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1560"><a href="#cb77-1560" aria-hidden="true" tabindex="-1"></a>### <span class="va">Artifact</span> <span class="va">Rejection</span></span>
<span id="cb77-1561"><a href="#cb77-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1562"><a href="#cb77-1562" aria-hidden="true" tabindex="-1"></a>#### <span class="va">Automated</span> <span class="va">Artifact</span> <span class="va">Rejection</span></span>
<span id="cb77-1563"><a href="#cb77-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1564"><a href="#cb77-1564" aria-hidden="true" tabindex="-1"></a><span class="va">Tools</span> → <span class="va">Reject</span> <span class="va">data</span> <span class="va">using</span> <span class="va">Clean</span> <span class="va">Rawdata</span> <span class="va">and</span> <span class="va">ASR</span></span>
<span id="cb77-1565"><a href="#cb77-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1566"><a href="#cb77-1566" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1567"><a href="#cb77-1567" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1568"><a href="#cb77-1568" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_clean_rawdata</span>(<span class="va">EEG</span><span class="op">,</span> <span class="ss">'FlatlineCriterion'</span><span class="op">,</span><span class="fl">5</span><span class="op">,</span><span class="ss">'ChannelCriterion'</span><span class="op">,</span><span class="fl">0.8</span><span class="op">,</span><span class="ss">'LineNoiseCriterion'</span><span class="op">,</span><span class="fl">4</span><span class="op">,</span><span class="ss">'Highpass'</span><span class="op">,</span><span class="ss">'off'</span><span class="op">,</span><span class="ss">'BurstCriterion'</span><span class="op">,</span><span class="fl">20</span><span class="op">,</span><span class="ss">'WindowCriterion'</span><span class="op">,</span><span class="fl">0.25</span><span class="op">,</span><span class="ss">'BurstRejection'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'Distance'</span><span class="op">,</span><span class="ss">'Euclidian'</span><span class="op">,</span><span class="ss">'WindowCriterionTolerances'</span><span class="op">,</span>[<span class="op">-</span><span class="va">Inf</span> <span class="fl">7</span>] )<span class="op">;</span></span>
<span id="cb77-1569"><a href="#cb77-1569" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1570"><a href="#cb77-1570" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1571"><a href="#cb77-1571" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1572"><a href="#cb77-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1573"><a href="#cb77-1573" aria-hidden="true" tabindex="-1"></a><span class="va">Currently</span><span class="op">,</span> <span class="va">we</span> <span class="va">run</span> <span class="va">into</span> <span class="va">a</span> <span class="va">bug</span> <span class="va">that</span> <span class="va">yields</span> <span class="va">the</span> <span class="va">following</span> <span class="va">error</span><span class="op">:</span></span>
<span id="cb77-1574"><a href="#cb77-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1575"><a href="#cb77-1575" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1576"><a href="#cb77-1576" aria-hidden="true" tabindex="-1"></a><span class="va">Not</span> <span class="va">enough</span> <span class="va">memory</span><span class="op">,</span> <span class="va">This</span> <span class="va">is</span> <span class="va">not</span> <span class="va">a</span> <span class="va">bug</span> (<span class="va">Error</span> <span class="va">occurred</span> <span class="va">in</span> <span class="kw">function</span> <span class="va">asr_process</span>() <span class="va">at</span> <span class="va">line</span> <span class="fl">132</span>)</span>
<span id="cb77-1577"><a href="#cb77-1577" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1578"><a href="#cb77-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1579"><a href="#cb77-1579" aria-hidden="true" tabindex="-1"></a><span class="va">As</span> <span class="va">a</span> <span class="va">workaround</span><span class="op">,</span> <span class="va">type</span> <span class="va">the</span> <span class="va">following</span> <span class="va">code</span> <span class="va">in</span> <span class="va">MATLAB</span> <span class="va">to</span> <span class="va">edit</span> <span class="va">the</span> <span class="kw">function</span><span class="op">:</span></span>
<span id="cb77-1580"><a href="#cb77-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1581"><a href="#cb77-1581" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1582"><a href="#cb77-1582" aria-hidden="true" tabindex="-1"></a><span class="va">edit</span> <span class="va">clean_artifacts</span></span>
<span id="cb77-1583"><a href="#cb77-1583" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1584"><a href="#cb77-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1585"><a href="#cb77-1585" aria-hidden="true" tabindex="-1"></a><span class="va">Then</span><span class="op">,</span> <span class="va">change</span> <span class="va">the</span> <span class="va">number</span> <span class="va">in</span> <span class="va">the</span> <span class="va">following</span> <span class="va">line</span> <span class="va">to</span> <span class="va">a</span> <span class="va">larger</span> <span class="va">number</span> (<span class="va">e</span>.<span class="va">g</span>.<span class="op">,</span> <span class="fl">256</span>) <span class="va">and</span> <span class="va">click</span> <span class="va">save</span><span class="op">:</span></span>
<span id="cb77-1586"><a href="#cb77-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1587"><a href="#cb77-1587" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1588"><a href="#cb77-1588" aria-hidden="true" tabindex="-1"></a>{<span class="ss">'max_mem'</span><span class="op">,</span><span class="ss">'MaxMem'</span>}<span class="op">,</span> <span class="fl">256</span><span class="op">,</span> <span class="op">...</span></span>
<span id="cb77-1589"><a href="#cb77-1589" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1590"><a href="#cb77-1590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1591"><a href="#cb77-1591" aria-hidden="true" tabindex="-1"></a>#### <span class="va">Selection</span> <span class="va">of</span> <span class="va">Bad</span> <span class="va">Channels</span></span>
<span id="cb77-1592"><a href="#cb77-1592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1593"><a href="#cb77-1593" aria-hidden="true" tabindex="-1"></a><span class="va">View</span> <span class="va">data</span> <span class="va">to</span> <span class="va">identify</span> <span class="va">bad</span> <span class="va">channels</span> <span class="va">to</span> <span class="va">reject</span>.</span>
<span id="cb77-1594"><a href="#cb77-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1595"><a href="#cb77-1595" aria-hidden="true" tabindex="-1"></a><span class="va">Edit</span> → <span class="va">Select</span> <span class="va">data</span></span>
<span id="cb77-1596"><a href="#cb77-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1597"><a href="#cb77-1597" aria-hidden="true" tabindex="-1"></a><span class="va">Specify</span> <span class="va">channels</span> <span class="va">to</span> <span class="va">reject</span></span>
<span id="cb77-1598"><a href="#cb77-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1599"><a href="#cb77-1599" aria-hidden="true" tabindex="-1"></a><span class="va">Specify</span> <span class="st">"on -&gt; remove these"</span></span>
<span id="cb77-1600"><a href="#cb77-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1601"><a href="#cb77-1601" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1602"><a href="#cb77-1602" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1603"><a href="#cb77-1603" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_select</span>( <span class="va">EEG</span><span class="op">,</span> <span class="ss">'nochannel'</span><span class="op">,</span>{<span class="ss">'E44'</span><span class="op">,</span><span class="ss">'E56'</span><span class="op">,</span><span class="ss">'E57'</span><span class="op">,</span><span class="ss">'E113'</span>})<span class="op">;</span></span>
<span id="cb77-1604"><a href="#cb77-1604" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'1613_90_oddball_fil_ref_chn'</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1605"><a href="#cb77-1605" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1606"><a href="#cb77-1606" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1607"><a href="#cb77-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1608"><a href="#cb77-1608" aria-hidden="true" tabindex="-1"></a>#### <span class="va">Selection</span> <span class="va">of</span> <span class="va">Bad</span> <span class="va">Time</span> <span class="va">Periods</span></span>
<span id="cb77-1609"><a href="#cb77-1609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1610"><a href="#cb77-1610" aria-hidden="true" tabindex="-1"></a><span class="va">Plot</span> → <span class="va">Channel</span> <span class="va">data</span> (<span class="va">scroll</span>)</span>
<span id="cb77-1611"><a href="#cb77-1611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1612"><a href="#cb77-1612" aria-hidden="true" tabindex="-1"></a><span class="va">Change</span> <span class="va">voltage</span> <span class="va">scale</span> <span class="va">to</span> <span class="fl">50</span></span>
<span id="cb77-1613"><a href="#cb77-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1614"><a href="#cb77-1614" aria-hidden="true" tabindex="-1"></a><span class="va">Settings</span> → <span class="va">Time</span> <span class="va">range</span> <span class="va">to</span> <span class="va">display</span></span>
<span id="cb77-1615"><a href="#cb77-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1616"><a href="#cb77-1616" aria-hidden="true" tabindex="-1"></a><span class="va">Change</span> <span class="va">to</span> <span class="fl">10</span> <span class="va">seconds</span></span>
<span id="cb77-1617"><a href="#cb77-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1618"><a href="#cb77-1618" aria-hidden="true" tabindex="-1"></a><span class="va">Settings</span> → <span class="va">Number</span> <span class="va">of</span> <span class="va">channels</span> <span class="va">to</span> <span class="va">display</span></span>
<span id="cb77-1619"><a href="#cb77-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1620"><a href="#cb77-1620" aria-hidden="true" tabindex="-1"></a><span class="va">Change</span> <span class="va">to</span> <span class="va">number</span> <span class="va">of</span> <span class="va">channels</span> <span class="va">to</span> <span class="va">view</span> <span class="va">at</span> <span class="va">one</span> <span class="va">time</span> (<span class="va">e</span>.<span class="va">g</span>.<span class="op">,</span> <span class="fl">64</span>)</span>
<span id="cb77-1621"><a href="#cb77-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1622"><a href="#cb77-1622" aria-hidden="true" tabindex="-1"></a><span class="va">To</span> <span class="va">erase</span> <span class="va">a</span> <span class="va">selected</span> <span class="va">portion</span> <span class="va">of</span> <span class="va">the</span> <span class="va">data</span><span class="op">,</span> <span class="va">first</span> <span class="va">drag</span> <span class="va">the</span> <span class="va">mouse</span> (<span class="va">holding</span> <span class="va">down</span> <span class="va">the</span> <span class="va">left</span> <span class="va">mouse</span> <span class="va">button</span>) <span class="va">horizontally</span> <span class="va">across</span> <span class="va">the</span> <span class="va">time</span> <span class="va">region</span> <span class="va">of</span> <span class="va">interest</span> <span class="va">to</span> <span class="va">mark</span> <span class="va">it</span> <span class="kw">for</span> <span class="va">rejection</span>.</span>
<span id="cb77-1623"><a href="#cb77-1623" aria-hidden="true" tabindex="-1"></a><span class="va">To</span> <span class="va">deselect</span> <span class="va">a</span> <span class="va">portion</span> <span class="va">of</span> <span class="va">the</span> <span class="va">data</span><span class="op">,</span> <span class="va">simply</span> <span class="va">click</span> <span class="va">on</span> <span class="va">the</span> <span class="va">selected</span> <span class="va">region</span>.</span>
<span id="cb77-1624"><a href="#cb77-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1625"><a href="#cb77-1625" aria-hidden="true" tabindex="-1"></a><span class="va">After</span> <span class="va">marking</span> <span class="va">some</span> <span class="va">portions</span> <span class="va">of</span> <span class="va">the</span> <span class="va">data</span> <span class="kw">for</span> <span class="va">rejection</span><span class="op">,</span> <span class="va">press</span> <span class="va">REJECT</span> <span class="va">and</span> <span class="va">a</span> <span class="va">new</span> <span class="va">data</span> <span class="va">set</span> <span class="va">will</span> <span class="va">be</span> <span class="va">created</span> <span class="va">with</span> <span class="va">the</span> <span class="va">rejected</span> <span class="va">data</span> <span class="va">omitted</span>.</span>
<span id="cb77-1626"><a href="#cb77-1626" aria-hidden="true" tabindex="-1"></a><span class="va">A</span> <span class="va">new</span> <span class="va">dataset</span> <span class="va">will</span> <span class="va">be</span> <span class="va">created</span> <span class="va">with</span> <span class="va">the</span> <span class="va">marked</span> <span class="va">regions</span> <span class="va">removed</span>.</span>
<span id="cb77-1627"><a href="#cb77-1627" aria-hidden="true" tabindex="-1"></a><span class="va">Your</span> <span class="va">goal</span> <span class="va">is</span> <span class="va">to</span> <span class="va">reject</span> <span class="va">non</span><span class="op">-</span><span class="va">stereotypic</span> <span class="va">artifacts</span>.</span>
<span id="cb77-1628"><a href="#cb77-1628" aria-hidden="true" tabindex="-1"></a><span class="va">Do</span> <span class="va">not</span> <span class="va">reject</span> <span class="va">blinks</span><span class="op">/</span><span class="va">saccades</span><span class="op">,</span> <span class="va">because</span> [<span class="va">independent</span> <span class="va">component</span> <span class="va">analysis</span>](#<span class="va">sec</span><span class="op">-</span><span class="va">ica</span>) <span class="va">will</span> <span class="va">remove</span> <span class="va">those</span>.</span>
<span id="cb77-1629"><a href="#cb77-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1630"><a href="#cb77-1630" aria-hidden="true" tabindex="-1"></a><span class="va">Clicking</span> <span class="st">"Stack"</span> <span class="va">stacks</span> <span class="va">all</span> <span class="va">electrodes</span> <span class="va">on</span> <span class="va">top</span> <span class="va">of</span> <span class="va">each</span> <span class="va">other</span> <span class="va">to</span> <span class="va">more</span> <span class="va">easily</span> <span class="va">identify</span> <span class="va">noisy</span> <span class="va">data</span>.</span>
<span id="cb77-1631"><a href="#cb77-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1632"><a href="#cb77-1632" aria-hidden="true" tabindex="-1"></a><span class="va">Click</span> <span class="st">"REJECT"</span> <span class="va">to</span> <span class="va">remove</span> <span class="va">the</span> <span class="va">bad</span> <span class="va">time</span> <span class="va">periods</span> <span class="va">from</span> <span class="va">the</span> <span class="va">data</span> <span class="va">file</span>.</span>
<span id="cb77-1633"><a href="#cb77-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1634"><a href="#cb77-1634" aria-hidden="true" tabindex="-1"></a>#### <span class="va">Independent</span> <span class="va">Component</span> <span class="va">Analysis</span> {#<span class="va">sec</span><span class="op">-</span><span class="va">ica</span>}</span>
<span id="cb77-1635"><a href="#cb77-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1636"><a href="#cb77-1636" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="va">https</span><span class="op">://</span><span class="va">eeglab</span>.<span class="va">org</span><span class="op">/</span><span class="va">tutorials</span><span class="op">/</span><span class="fl">06</span>_<span class="va">RejectArtifacts</span><span class="op">/</span><span class="va">RunICA</span>.<span class="va">html</span><span class="op">&gt;</span> (<span class="va">archived</span> <span class="va">at</span> <span class="op">&lt;</span><span class="va">https</span><span class="op">://</span><span class="va">perma</span>.<span class="va">cc</span><span class="op">/</span><span class="va">AEU9</span><span class="op">-</span><span class="va">GB3B</span><span class="op">&gt;</span>)</span>
<span id="cb77-1637"><a href="#cb77-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1638"><a href="#cb77-1638" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="va">https</span><span class="op">://</span><span class="va">socialsci</span>.<span class="va">libretexts</span>.<span class="va">org</span><span class="op">/</span><span class="va">Bookshelves</span><span class="op">/</span><span class="va">Psychology</span><span class="op">/</span><span class="va">Book</span><span class="co">%3A_Applied_Event-Related_Potential_Data_Analysis_(Luck)/14%3A_Appendix_3%3A_Example_Processing_Pipeline&gt; (archived at &lt;https://perma.cc/9QYQ-BNFE&gt;)</span></span>
<span id="cb77-1639"><a href="#cb77-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1640"><a href="#cb77-1640" aria-hidden="true" tabindex="-1"></a><span class="va">The</span> <span class="va">component</span> <span class="va">order</span> <span class="va">returned</span> <span class="va">by</span> `<span class="va">runica</span>.<span class="va">m</span>` <span class="va">is</span> <span class="va">in</span> <span class="va">decreasing</span> <span class="va">order</span> <span class="va">of</span> <span class="va">the</span> <span class="va">EEG</span> <span class="va">variance</span> <span class="va">accounted</span> <span class="kw">for</span> <span class="va">by</span> <span class="va">each</span> <span class="va">component</span>.</span>
<span id="cb77-1641"><a href="#cb77-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1642"><a href="#cb77-1642" aria-hidden="true" tabindex="-1"></a><span class="va">Tools</span> → <span class="va">Decompose</span> <span class="va">data</span> <span class="va">by</span> <span class="va">ICA</span></span>
<span id="cb77-1643"><a href="#cb77-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1644"><a href="#cb77-1644" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1645"><a href="#cb77-1645" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1646"><a href="#cb77-1646" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_runica</span>(<span class="va">EEG</span><span class="op">,</span> <span class="ss">'icatype'</span><span class="op">,</span> <span class="ss">'runica'</span><span class="op">,</span> <span class="ss">'extended'</span><span class="op">,</span><span class="fl">1</span><span class="op">,</span><span class="ss">'interrupt'</span><span class="op">,</span><span class="ss">'on'</span>)<span class="op">;</span></span>
<span id="cb77-1647"><a href="#cb77-1647" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span>] <span class="op">=</span> <span class="va">eeg_store</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">CURRENTSET</span>)<span class="op">;</span></span>
<span id="cb77-1648"><a href="#cb77-1648" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1649"><a href="#cb77-1649" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1650"><a href="#cb77-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1651"><a href="#cb77-1651" aria-hidden="true" tabindex="-1"></a><span class="va">Plot</span> → <span class="va">Component</span> <span class="va">maps</span> → <span class="fl">2</span><span class="va">D</span></span>
<span id="cb77-1652"><a href="#cb77-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1653"><a href="#cb77-1653" aria-hidden="true" tabindex="-1"></a><span class="va">Visually</span> <span class="va">identify</span> <span class="va">independent</span> <span class="va">components</span> <span class="va">to</span> <span class="va">remove</span></span>
<span id="cb77-1654"><a href="#cb77-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1655"><a href="#cb77-1655" aria-hidden="true" tabindex="-1"></a><span class="va">Tools</span> → <span class="va">Inspect</span><span class="op">/</span><span class="va">label</span> <span class="va">components</span> <span class="va">by</span> <span class="va">map</span></span>
<span id="cb77-1656"><a href="#cb77-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1657"><a href="#cb77-1657" aria-hidden="true" tabindex="-1"></a><span class="va">Example</span> <span class="va">ICA</span> <span class="va">Artifact</span> <span class="va">Components</span></span>
<span id="cb77-1658"><a href="#cb77-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1659"><a href="#cb77-1659" aria-hidden="true" tabindex="-1"></a><span class="bn">![ICA Eye Blink Artifact](images/ICA_EyeBlink.png)</span></span>
<span id="cb77-1660"><a href="#cb77-1660" aria-hidden="true" tabindex="-1"></a><span class="bn">![ICA Lateral Eye Movement Artifact](images/ICA_LateralEyeMovement.png)</span></span>
<span id="cb77-1661"><a href="#cb77-1661" aria-hidden="true" tabindex="-1"></a><span class="bn">![ICA Muscle Artifact](images/ICA_MuscleArtifact.png)</span></span>
<span id="cb77-1662"><a href="#cb77-1662" aria-hidden="true" tabindex="-1"></a><span class="bn">![ICA Cardiac Artifact](images/ICA_CardiacArtifact.png)</span></span>
<span id="cb77-1663"><a href="#cb77-1663" aria-hidden="true" tabindex="-1"></a><span class="bn">![ICA Bad Channel](images/ICA_BadChannel.png)</span></span>
<span id="cb77-1664"><a href="#cb77-1664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1665"><a href="#cb77-1665" aria-hidden="true" tabindex="-1"></a><span class="va">Example</span> <span class="va">ICA</span> <span class="va">Brain</span> <span class="va">Components</span></span>
<span id="cb77-1666"><a href="#cb77-1666" aria-hidden="true" tabindex="-1"></a><span class="bn">![ICA Brain Activity Example 1](images/ICA_BrainActivityEx1.png)</span></span>
<span id="cb77-1667"><a href="#cb77-1667" aria-hidden="true" tabindex="-1"></a><span class="bn">![ICA Brain Activity Example 2](images/ICA_BrainActivityEx2.png)</span></span>
<span id="cb77-1668"><a href="#cb77-1668" aria-hidden="true" tabindex="-1"></a><span class="bn">![ICA Brain Activity Example 3](images/ICA_BrainActivityEx3.png)</span></span>
<span id="cb77-1669"><a href="#cb77-1669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1670"><a href="#cb77-1670" aria-hidden="true" tabindex="-1"></a><span class="va">Overview</span> <span class="va">of</span> <span class="va">ICA</span> <span class="va">Components</span></span>
<span id="cb77-1671"><a href="#cb77-1671" aria-hidden="true" tabindex="-1"></a><span class="bn">![ICA Overview](images/ICA_Overview.png)</span></span>
<span id="cb77-1672"><a href="#cb77-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1673"><a href="#cb77-1673" aria-hidden="true" tabindex="-1"></a><span class="va">Toggle</span> <span class="va">the</span> <span class="st">"Accept"</span> <span class="va">button</span> <span class="va">to</span> <span class="va">reject</span> <span class="va">an</span> <span class="va">independent</span> <span class="va">component</span><span class="op">,</span> <span class="va">press</span> <span class="st">"OK"</span> <span class="va">to</span> <span class="va">specify</span> <span class="va">it</span> <span class="kw">for</span> <span class="va">rejection</span></span>
<span id="cb77-1674"><a href="#cb77-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1675"><a href="#cb77-1675" aria-hidden="true" tabindex="-1"></a><span class="va">Automated</span> <span class="va">detection</span> <span class="va">of</span> <span class="va">artifactual</span> <span class="va">ICA</span> <span class="va">components</span><span class="op">:</span></span>
<span id="cb77-1676"><a href="#cb77-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1677"><a href="#cb77-1677" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="va">https</span><span class="op">://</span><span class="va">eeglab</span>.<span class="va">org</span><span class="op">/</span><span class="va">tutorials</span><span class="op">/</span><span class="fl">06</span>_<span class="va">RejectArtifacts</span><span class="op">/</span><span class="va">RunICA</span>.<span class="va">html</span>#<span class="va">automated</span><span class="op">-</span><span class="va">detection</span><span class="op">-</span><span class="va">of</span><span class="op">-</span><span class="va">artifactual</span><span class="op">-</span><span class="va">ica</span><span class="op">-</span><span class="va">components</span><span class="op">&gt;</span> (<span class="va">archived</span> <span class="va">at</span> <span class="op">&lt;</span><span class="va">https</span><span class="op">://</span><span class="va">perma</span>.<span class="va">cc</span><span class="op">/</span><span class="fl">5</span><span class="va">RQ7</span><span class="op">-</span><span class="fl">9</span><span class="va">WBT</span><span class="op">&gt;</span>)</span>
<span id="cb77-1678"><a href="#cb77-1678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1679"><a href="#cb77-1679" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1680"><a href="#cb77-1680" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1681"><a href="#cb77-1681" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_iclabel</span>(<span class="va">EEG</span><span class="op">,</span> <span class="ss">'default'</span>)<span class="op">;</span></span>
<span id="cb77-1682"><a href="#cb77-1682" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span>] <span class="op">=</span> <span class="va">eeg_store</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">CURRENTSET</span>)<span class="op">;</span></span>
<span id="cb77-1683"><a href="#cb77-1683" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1684"><a href="#cb77-1684" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_icflag</span>(<span class="va">EEG</span><span class="op">,</span> [<span class="va">NaN</span> <span class="va">NaN</span><span class="op">;</span><span class="fl">0.9</span> <span class="fl">1</span><span class="op">;</span><span class="fl">0.9</span> <span class="fl">1</span><span class="op">;</span><span class="va">NaN</span> <span class="va">NaN</span><span class="op">;</span><span class="va">NaN</span> <span class="va">NaN</span><span class="op">;</span><span class="va">NaN</span> <span class="va">NaN</span><span class="op">;</span><span class="va">NaN</span> <span class="va">NaN</span>])<span class="op">;</span></span>
<span id="cb77-1685"><a href="#cb77-1685" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span>] <span class="op">=</span> <span class="va">eeg_store</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">CURRENTSET</span>)<span class="op">;</span></span>
<span id="cb77-1686"><a href="#cb77-1686" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1687"><a href="#cb77-1687" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1688"><a href="#cb77-1688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1689"><a href="#cb77-1689" aria-hidden="true" tabindex="-1"></a><span class="va">There</span> <span class="va">are</span> <span class="va">six</span> <span class="va">categories</span> <span class="va">of</span> <span class="va">components</span><span class="op">:</span> <span class="va">Brain</span><span class="op">,</span> <span class="va">Muscle</span><span class="op">,</span> <span class="va">Eye</span><span class="op">,</span> <span class="va">Heart</span><span class="op">,</span> <span class="va">Line</span> <span class="va">Noise</span><span class="op">,</span> <span class="va">Channel</span> <span class="va">Noise</span><span class="op">,</span> <span class="va">and</span> <span class="va">Other</span></span>
<span id="cb77-1690"><a href="#cb77-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1691"><a href="#cb77-1691" aria-hidden="true" tabindex="-1"></a><span class="va">Our</span> <span class="va">goal</span> <span class="va">is</span> <span class="va">to</span> <span class="va">keep</span> <span class="va">the</span> <span class="va">brain</span> <span class="va">components</span> <span class="va">and</span> <span class="va">to</span> <span class="va">remove</span> <span class="va">everything</span> <span class="kw">else</span> (<span class="va">i</span>.<span class="va">e</span>.<span class="op">,</span> <span class="va">artifacts</span>).</span>
<span id="cb77-1692"><a href="#cb77-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1693"><a href="#cb77-1693" aria-hidden="true" tabindex="-1"></a><span class="va">Tools</span> → <span class="va">Classify</span> <span class="va">components</span> <span class="va">using</span> <span class="va">ICLabel</span> → <span class="va">Label</span> <span class="va">components</span></span>
<span id="cb77-1694"><a href="#cb77-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1695"><a href="#cb77-1695" aria-hidden="true" tabindex="-1"></a><span class="va">Tools</span> → <span class="va">Classify</span> <span class="va">components</span> <span class="va">using</span> <span class="va">ICLabel</span> → <span class="va">Flag</span> <span class="va">components</span> <span class="va">as</span> <span class="va">artifacts</span></span>
<span id="cb77-1696"><a href="#cb77-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1697"><a href="#cb77-1697" aria-hidden="true" tabindex="-1"></a><span class="va">Substracting</span> <span class="va">rejected</span> <span class="va">ICA</span> <span class="va">components</span><span class="op">:</span></span>
<span id="cb77-1698"><a href="#cb77-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1699"><a href="#cb77-1699" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="va">https</span><span class="op">://</span><span class="va">eeglab</span>.<span class="va">org</span><span class="op">/</span><span class="va">tutorials</span><span class="op">/</span><span class="fl">06</span>_<span class="va">RejectArtifacts</span><span class="op">/</span><span class="va">RunICA</span>.<span class="va">html</span>#<span class="va">subtracting</span><span class="op">-</span><span class="va">ica</span><span class="op">-</span><span class="va">components</span><span class="op">-</span><span class="va">from</span><span class="op">-</span><span class="va">data</span><span class="op">&gt;</span> (<span class="va">archived</span> <span class="va">at</span> <span class="op">&lt;</span><span class="va">https</span><span class="op">://</span><span class="va">perma</span>.<span class="va">cc</span><span class="op">/</span><span class="va">HVH4</span><span class="op">-</span><span class="va">Z4SA</span><span class="op">&gt;</span>)</span>
<span id="cb77-1700"><a href="#cb77-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1701"><a href="#cb77-1701" aria-hidden="true" tabindex="-1"></a><span class="va">Tools</span> → <span class="va">Remove</span> <span class="va">components</span></span>
<span id="cb77-1702"><a href="#cb77-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1703"><a href="#cb77-1703" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1704"><a href="#cb77-1704" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_subcomp</span>( <span class="va">EEG</span><span class="op">,</span> [<span class="fl">1</span>    <span class="fl">2</span>    <span class="fl">6</span>    <span class="fl">7</span>   <span class="fl">10</span>   <span class="fl">13</span>   <span class="fl">21</span>   <span class="fl">24</span>   <span class="fl">26</span>   <span class="fl">31</span>   <span class="fl">32</span>   <span class="fl">33</span>   <span class="fl">36</span>   <span class="fl">43</span>   <span class="fl">44</span>   <span class="fl">51</span>   <span class="fl">54</span>   <span class="fl">55</span>   <span class="fl">59</span>   <span class="fl">61</span>   <span class="fl">67</span>   <span class="fl">68</span>   <span class="fl">74</span>   <span class="fl">83</span>   <span class="fl">90</span>   <span class="fl">91</span>   <span class="fl">93</span>   <span class="fl">99</span>  <span class="fl">103</span>  <span class="fl">112</span>  <span class="fl">113</span>  <span class="fl">116</span>  <span class="fl">118</span>  <span class="fl">121</span>]<span class="op">,</span> <span class="fl">0</span>)<span class="op">;</span></span>
<span id="cb77-1705"><a href="#cb77-1705" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">6</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1706"><a href="#cb77-1706" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1707"><a href="#cb77-1707" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1708"><a href="#cb77-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1709"><a href="#cb77-1709" aria-hidden="true" tabindex="-1"></a>### <span class="va">Interpolate</span> <span class="va">Bad</span> <span class="va">Channels</span></span>
<span id="cb77-1710"><a href="#cb77-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1711"><a href="#cb77-1711" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="va">https</span><span class="op">://</span><span class="va">sccn</span>.<span class="va">ucsd</span>.<span class="va">edu</span><span class="op">/</span><span class="va">pipermail</span><span class="op">/</span><span class="va">eeglablist</span><span class="op">/</span><span class="fl">2016</span><span class="op">/</span><span class="fl">011199</span>.<span class="va">html</span><span class="op">&gt;</span> (<span class="va">archived</span> <span class="va">at</span> <span class="op">&lt;</span><span class="va">https</span><span class="op">://</span><span class="va">perma</span>.<span class="va">cc</span><span class="op">/</span><span class="fl">97</span><span class="va">NH</span><span class="op">-</span><span class="fl">8</span><span class="va">LAR</span><span class="op">&gt;</span>)</span>
<span id="cb77-1712"><a href="#cb77-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1713"><a href="#cb77-1713" aria-hidden="true" tabindex="-1"></a><span class="va">To</span> <span class="va">interpolate</span> <span class="va">channels</span> <span class="va">you</span> <span class="va">would</span> <span class="va">load</span> <span class="va">up</span> <span class="va">one</span> <span class="va">file</span> <span class="va">that</span> <span class="va">has</span> <span class="va">only</span> <span class="va">the</span> <span class="va">good</span> <span class="va">channels</span><span class="op">,</span> <span class="va">then</span> <span class="va">load</span> <span class="va">up</span> <span class="va">a</span> <span class="va">second</span> <span class="va">file</span> <span class="va">that</span> <span class="va">has</span> <span class="va">the</span> <span class="va">full</span> <span class="va">channel</span> <span class="va">list</span><span class="op">,</span> <span class="va">and</span> <span class="va">then</span> <span class="va">run</span> <span class="va">the</span> <span class="va">channel</span> <span class="va">interpolation</span> <span class="kw">function</span> <span class="va">from</span> <span class="va">the</span> <span class="va">eeglab</span> <span class="va">gui</span>.</span>
<span id="cb77-1714"><a href="#cb77-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1715"><a href="#cb77-1715" aria-hidden="true" tabindex="-1"></a><span class="va">Tools</span> → <span class="va">Interpolate</span> <span class="va">Electrodes</span> → <span class="va">Use</span> <span class="va">all</span> <span class="va">channels</span> (<span class="va">or</span> <span class="va">specific</span> <span class="va">channels</span>?) <span class="va">of</span> <span class="va">other</span> <span class="va">dataset</span></span>
<span id="cb77-1716"><a href="#cb77-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1717"><a href="#cb77-1717" aria-hidden="true" tabindex="-1"></a><span class="va">Using</span> <span class="va">all</span> <span class="va">channels</span> <span class="va">of</span> <span class="va">other</span> <span class="va">dataset</span><span class="op">:</span></span>
<span id="cb77-1718"><a href="#cb77-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1719"><a href="#cb77-1719" aria-hidden="true" tabindex="-1"></a><span class="op">**</span><span class="va">Important</span> <span class="va">Note</span><span class="op">:**</span> <span class="va">Interpolating</span> <span class="va">files</span> <span class="va">will</span> <span class="va">re</span><span class="op">-</span><span class="va">reference</span> <span class="va">the</span> <span class="va">data</span>.</span>
<span id="cb77-1720"><a href="#cb77-1720" aria-hidden="true" tabindex="-1"></a><span class="va">Average</span> <span class="va">reference</span> <span class="va">the</span> <span class="va">data</span> <span class="va">after</span> <span class="va">interpolating</span> <span class="va">channels</span>.</span>
<span id="cb77-1721"><a href="#cb77-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1722"><a href="#cb77-1722" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1723"><a href="#cb77-1723" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1724"><a href="#cb77-1724" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_interp</span>(<span class="va">EEG</span><span class="op">,</span> <span class="va">ALLEEG</span>(<span class="fl">3</span>).<span class="va">chanlocs</span><span class="op">,</span> <span class="ss">'spherical'</span>)<span class="op">;</span></span>
<span id="cb77-1725"><a href="#cb77-1725" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">4</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1726"><a href="#cb77-1726" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1727"><a href="#cb77-1727" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1728"><a href="#cb77-1728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1729"><a href="#cb77-1729" aria-hidden="true" tabindex="-1"></a><span class="va">Using</span> <span class="va">specific</span> <span class="va">channels</span> <span class="va">of</span> <span class="va">other</span> <span class="va">dataset</span><span class="op">:</span></span>
<span id="cb77-1730"><a href="#cb77-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1731"><a href="#cb77-1731" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1732"><a href="#cb77-1732" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1733"><a href="#cb77-1733" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_interp</span>(<span class="va">EEG</span><span class="op">,</span> <span class="va">ALLEEG</span>(<span class="fl">3</span>).<span class="va">chanlocs</span>([<span class="fl">44</span>   <span class="fl">56</span>   <span class="fl">57</span>  <span class="fl">113</span>])<span class="op">,</span> <span class="ss">'spherical'</span>)<span class="op">;</span></span>
<span id="cb77-1734"><a href="#cb77-1734" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1735"><a href="#cb77-1735" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1736"><a href="#cb77-1736" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1737"><a href="#cb77-1737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1738"><a href="#cb77-1738" aria-hidden="true" tabindex="-1"></a><span class="va">Removed</span> <span class="va">channels</span><span class="op">:</span></span>
<span id="cb77-1739"><a href="#cb77-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1740"><a href="#cb77-1740" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1741"><a href="#cb77-1741" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1742"><a href="#cb77-1742" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_interp</span>(<span class="va">EEG</span><span class="op">,</span> <span class="va">EEG</span>.<span class="va">chaninfo</span>.<span class="va">nodatchans</span>([<span class="fl">44</span>  <span class="fl">56</span>  <span class="fl">57</span>  <span class="fl">113</span>])<span class="op">,</span> <span class="ss">'spherical'</span>)<span class="op">;</span></span>
<span id="cb77-1743"><a href="#cb77-1743" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">3</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1744"><a href="#cb77-1744" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1745"><a href="#cb77-1745" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1746"><a href="#cb77-1746" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1747"><a href="#cb77-1747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1748"><a href="#cb77-1748" aria-hidden="true" tabindex="-1"></a><span class="va">Data</span> <span class="va">channels</span><span class="op">:</span></span>
<span id="cb77-1749"><a href="#cb77-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1750"><a href="#cb77-1750" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1751"><a href="#cb77-1751" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1752"><a href="#cb77-1752" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_interp</span>(<span class="va">EEG</span><span class="op">,</span> [<span class="fl">44</span>  <span class="fl">56</span>  <span class="fl">57</span>  <span class="fl">113</span>]<span class="op">,</span> <span class="ss">'spherical'</span>)<span class="op">;</span></span>
<span id="cb77-1753"><a href="#cb77-1753" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1754"><a href="#cb77-1754" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1755"><a href="#cb77-1755" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1756"><a href="#cb77-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1757"><a href="#cb77-1757" aria-hidden="true" tabindex="-1"></a>### <span class="va">Average</span> <span class="va">Referencing</span></span>
<span id="cb77-1758"><a href="#cb77-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1759"><a href="#cb77-1759" aria-hidden="true" tabindex="-1"></a><span class="va">Tools</span> → <span class="va">Re</span><span class="op">-</span><span class="va">reference</span> <span class="va">the</span> <span class="va">data</span> → <span class="va">Compute</span> <span class="va">average</span> <span class="va">reference</span></span>
<span id="cb77-1760"><a href="#cb77-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1761"><a href="#cb77-1761" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1762"><a href="#cb77-1762" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1763"><a href="#cb77-1763" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_reref</span>( <span class="va">EEG</span><span class="op">,</span> [])<span class="op">;</span></span>
<span id="cb77-1764"><a href="#cb77-1764" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'1613_90_oddball_fil_ref'</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1765"><a href="#cb77-1765" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1766"><a href="#cb77-1766" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1767"><a href="#cb77-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1768"><a href="#cb77-1768" aria-hidden="true" tabindex="-1"></a>### <span class="va">Segmentation</span></span>
<span id="cb77-1769"><a href="#cb77-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1770"><a href="#cb77-1770" aria-hidden="true" tabindex="-1"></a><span class="va">Tools</span> → <span class="va">Extract</span> <span class="va">Epochs</span></span>
<span id="cb77-1771"><a href="#cb77-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1772"><a href="#cb77-1772" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1773"><a href="#cb77-1773" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1774"><a href="#cb77-1774" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_epoch</span>( <span class="va">EEG</span><span class="op">,</span> {  <span class="ss">'frq+'</span>  <span class="ss">'tgt+'</span>  }<span class="op">,</span> [<span class="op">-</span><span class="fl">0.2</span>           <span class="fl">1</span>]<span class="op">,</span> <span class="ss">'newname'</span><span class="op">,</span> <span class="ss">'1613_90_oddball_fil_ref epochs'</span><span class="op">,</span> <span class="ss">'epochinfo'</span><span class="op">,</span> <span class="ss">'yes'</span>)<span class="op">;</span></span>
<span id="cb77-1775"><a href="#cb77-1775" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1776"><a href="#cb77-1776" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1777"><a href="#cb77-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1778"><a href="#cb77-1778" aria-hidden="true" tabindex="-1"></a>### <span class="va">Baseline</span> <span class="va">Correction</span></span>
<span id="cb77-1779"><a href="#cb77-1779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1780"><a href="#cb77-1780" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1781"><a href="#cb77-1781" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1782"><a href="#cb77-1782" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_rmbase</span>( <span class="va">EEG</span><span class="op">,</span> [<span class="op">-</span><span class="fl">200</span> <span class="fl">0</span>] <span class="op">,</span>[])<span class="op">;</span></span>
<span id="cb77-1783"><a href="#cb77-1783" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1784"><a href="#cb77-1784" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1785"><a href="#cb77-1785" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1786"><a href="#cb77-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1787"><a href="#cb77-1787" aria-hidden="true" tabindex="-1"></a>### <span class="va">Automatic</span> <span class="va">Script</span> <span class="va">example</span> </span>
<span id="cb77-1788"><a href="#cb77-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1789"><a href="#cb77-1789" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1790"><a href="#cb77-1790" aria-hidden="true" tabindex="-1"></a><span class="co">% Starting EEG Lab </span></span>
<span id="cb77-1791"><a href="#cb77-1791" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span> <span class="va">ALLCOM</span>] <span class="op">=</span> <span class="va">eeglab</span><span class="op">;</span></span>
<span id="cb77-1792"><a href="#cb77-1792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1793"><a href="#cb77-1793" aria-hidden="true" tabindex="-1"></a><span class="co">%% Helpful documentation is located here</span></span>
<span id="cb77-1794"><a href="#cb77-1794" aria-hidden="true" tabindex="-1"></a><span class="co">% https://eeglab.org/tutorials/11_Scripting/Using_EEGLAB_history.html (archived at https://perma.cc/Y687-5GKE)</span></span>
<span id="cb77-1795"><a href="#cb77-1795" aria-hidden="true" tabindex="-1"></a><span class="co">% https://eeglab.org/tutorials/ConceptsGuide/Data_Structures.html (archived at https://perma.cc/5F39-5S32)</span></span>
<span id="cb77-1796"><a href="#cb77-1796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1797"><a href="#cb77-1797" aria-hidden="true" tabindex="-1"></a><span class="co">%Loading in the Dataset</span></span>
<span id="cb77-1798"><a href="#cb77-1798" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_mffimport</span>({<span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\0-Raw Data (mff)\\1613_90_oddball.mff'</span>}<span class="op">,</span>{<span class="ss">'code'</span>}<span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span></span>
<span id="cb77-1799"><a href="#cb77-1799" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span>.<span class="va">setname</span><span class="op">=</span><span class="ss">'raw'</span><span class="op">;</span></span>
<span id="cb77-1800"><a href="#cb77-1800" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1801"><a href="#cb77-1801" aria-hidden="true" tabindex="-1"></a><span class="co">%Storing the current dataset</span></span>
<span id="cb77-1802"><a href="#cb77-1802" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span>] <span class="op">=</span> <span class="va">eeg_store</span>( <span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb77-1803"><a href="#cb77-1803" aria-hidden="true" tabindex="-1"></a><span class="co">% refreshing the graphical interface</span></span>
<span id="cb77-1804"><a href="#cb77-1804" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1805"><a href="#cb77-1805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1806"><a href="#cb77-1806" aria-hidden="true" tabindex="-1"></a><span class="co">%Filter the data</span></span>
<span id="cb77-1807"><a href="#cb77-1807" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_eegfiltnew</span>(<span class="va">ALLEEG</span>(<span class="fl">1</span>)<span class="op">,</span> <span class="ss">'locutoff'</span><span class="op">,</span><span class="fl">0.1</span><span class="op">,</span><span class="ss">'hicutoff'</span><span class="op">,</span><span class="fl">30</span><span class="op">,</span><span class="ss">'plotfreqz'</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb77-1808"><a href="#cb77-1808" aria-hidden="true" tabindex="-1"></a><span class="co">%Save the Filtered dataset </span></span>
<span id="cb77-1809"><a href="#cb77-1809" aria-hidden="true" tabindex="-1"></a><span class="co">%ALLEEG EEG CURRENTSET seems to just be a name for all of the current data</span></span>
<span id="cb77-1810"><a href="#cb77-1810" aria-hidden="true" tabindex="-1"></a><span class="co">%sets </span></span>
<span id="cb77-1811"><a href="#cb77-1811" aria-hidden="true" tabindex="-1"></a><span class="co">%pop_newset seems to save the dataset in both memory and in the toolkit</span></span>
<span id="cb77-1812"><a href="#cb77-1812" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">2</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'fil'</span><span class="op">,</span><span class="ss">'savenew'</span><span class="op">,</span><span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\1-Filtering (fil)\\tcid_wave.set'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1813"><a href="#cb77-1813" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1814"><a href="#cb77-1814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1815"><a href="#cb77-1815" aria-hidden="true" tabindex="-1"></a><span class="co">% Average referencing</span></span>
<span id="cb77-1816"><a href="#cb77-1816" aria-hidden="true" tabindex="-1"></a><span class="co">%EEG = eeg_checkset( EEG );</span></span>
<span id="cb77-1817"><a href="#cb77-1817" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_reref</span>( <span class="va">ALLEEG</span>(<span class="fl">2</span>)<span class="op">,</span> [])<span class="op">;</span></span>
<span id="cb77-1818"><a href="#cb77-1818" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">3</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'Avg Ref'</span><span class="op">,</span><span class="ss">'savenew'</span><span class="op">,</span><span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\9-Average Reference (ref)\\tcid_wave_avg.set'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span></span>
<span id="cb77-1819"><a href="#cb77-1819" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1820"><a href="#cb77-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1821"><a href="#cb77-1821" aria-hidden="true" tabindex="-1"></a><span class="co">% Rejecting the artifacts</span></span>
<span id="cb77-1822"><a href="#cb77-1822" aria-hidden="true" tabindex="-1"></a><span class="co">% testing bumping the </span></span>
<span id="cb77-1823"><a href="#cb77-1823" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_clean_rawdata</span>(<span class="va">ALLEEG</span>(<span class="fl">3</span>)<span class="op">,</span> <span class="ss">'FlatlineCriterion'</span><span class="op">,</span><span class="fl">5</span><span class="op">,</span><span class="ss">'ChannelCriterion'</span><span class="op">,</span><span class="fl">0.8</span><span class="op">,</span><span class="ss">'LineNoiseCriterion'</span><span class="op">,</span><span class="fl">4</span><span class="op">,</span><span class="ss">'Highpass'</span><span class="op">,</span><span class="ss">'off'</span><span class="op">,</span><span class="ss">'BurstCriterion'</span><span class="op">,</span><span class="fl">30</span><span class="op">,</span><span class="ss">'WindowCriterion'</span><span class="op">,</span><span class="fl">0.25</span><span class="op">,</span><span class="ss">'BurstRejection'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'Distance'</span><span class="op">,</span><span class="ss">'Euclidian'</span><span class="op">,</span><span class="ss">'WindowCriterionTolerances'</span><span class="op">,</span>[<span class="op">-</span><span class="va">Inf</span> <span class="fl">7</span>] )<span class="op">;</span></span>
<span id="cb77-1824"><a href="#cb77-1824" aria-hidden="true" tabindex="-1"></a><span class="co">%Saving cleaned dataset</span></span>
<span id="cb77-1825"><a href="#cb77-1825" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">4</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'clean data'</span><span class="op">,</span><span class="ss">'savenew'</span><span class="op">,</span><span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\10-Clean Artificats (clean)\\tcid_wave_clean.set'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1826"><a href="#cb77-1826" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1827"><a href="#cb77-1827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1828"><a href="#cb77-1828" aria-hidden="true" tabindex="-1"></a><span class="co">% Placeholder to manually remove bad channels</span></span>
<span id="cb77-1829"><a href="#cb77-1829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1830"><a href="#cb77-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1831"><a href="#cb77-1831" aria-hidden="true" tabindex="-1"></a><span class="co">% ICA components</span></span>
<span id="cb77-1832"><a href="#cb77-1832" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_runica</span>(<span class="va">ALLEEG</span>(<span class="fl">4</span>)<span class="op">,</span> <span class="ss">'icatype'</span><span class="op">,</span> <span class="ss">'runica'</span><span class="op">,</span> <span class="ss">'extended'</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span><span class="ss">'interrupt'</span><span class="op">,</span><span class="ss">'on'</span>)<span class="op">;</span></span>
<span id="cb77-1833"><a href="#cb77-1833" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">5</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'ICA test'</span><span class="op">,</span><span class="ss">'savenew'</span><span class="op">,</span><span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\11-ICA\\tcid_wave_ICA.set'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1834"><a href="#cb77-1834" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1835"><a href="#cb77-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1836"><a href="#cb77-1836" aria-hidden="true" tabindex="-1"></a><span class="co">%Manually reject ICA components</span></span>
<span id="cb77-1837"><a href="#cb77-1837" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_subcomp</span>( <span class="va">EEG</span><span class="op">,</span> [<span class="fl">1</span>    <span class="fl">2</span>    <span class="fl">6</span>    <span class="fl">7</span>   <span class="fl">10</span>   <span class="fl">13</span>   <span class="fl">21</span>   <span class="fl">24</span>   <span class="fl">26</span>   <span class="fl">31</span>   <span class="fl">32</span>   <span class="fl">33</span>   <span class="fl">36</span>   <span class="fl">43</span>   <span class="fl">44</span>   <span class="fl">51</span>   <span class="fl">54</span>   <span class="fl">55</span>   <span class="fl">59</span>   <span class="fl">61</span>   <span class="fl">67</span>   <span class="fl">68</span>   <span class="fl">74</span>   <span class="fl">83</span>   <span class="fl">90</span>   <span class="fl">91</span>   <span class="fl">93</span>   <span class="fl">99</span>  <span class="fl">103</span>  <span class="fl">112</span>  <span class="fl">113</span>  <span class="fl">116</span>  <span class="fl">118</span>  <span class="fl">121</span>]<span class="op">,</span> <span class="fl">0</span>)<span class="op">;</span></span>
<span id="cb77-1838"><a href="#cb77-1838" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">6</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1839"><a href="#cb77-1839" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1840"><a href="#cb77-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1841"><a href="#cb77-1841" aria-hidden="true" tabindex="-1"></a><span class="co">% Place holder to remind to manually remove the channels that we would</span></span>
<span id="cb77-1842"><a href="#cb77-1842" aria-hidden="true" tabindex="-1"></a><span class="co">% like to reject</span></span>
<span id="cb77-1843"><a href="#cb77-1843" aria-hidden="true" tabindex="-1"></a><span class="co">% taking the EEG channel lock of the first (raw) dataset</span></span>
<span id="cb77-1844"><a href="#cb77-1844" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1845"><a href="#cb77-1845" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_interp</span>(<span class="va">ALLEEG</span>(<span class="fl">5</span>)<span class="op">,</span> <span class="va">ALLEEG</span>(<span class="fl">1</span>).<span class="va">chanlocs</span><span class="op">,</span> <span class="ss">'spherical'</span>)<span class="op">;</span></span>
<span id="cb77-1846"><a href="#cb77-1846" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">6</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'Interpolated'</span><span class="op">,</span><span class="ss">'savenew'</span><span class="op">,</span><span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\12-Interpolate\\tcid_wave_Interpolate.set'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1847"><a href="#cb77-1847" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1848"><a href="#cb77-1848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1849"><a href="#cb77-1849" aria-hidden="true" tabindex="-1"></a><span class="co">% Segmenting the Data</span></span>
<span id="cb77-1850"><a href="#cb77-1850" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1851"><a href="#cb77-1851" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_epoch</span>( <span class="va">ALLEEG</span>(<span class="fl">6</span>)<span class="op">,</span> {  <span class="ss">'frq+'</span>  <span class="ss">'tgt+'</span>  }<span class="op">,</span> [<span class="op">-</span><span class="fl">0.2</span> <span class="fl">1</span>]<span class="op">,</span> <span class="ss">'newname'</span><span class="op">,</span> <span class="ss">'tcid_wave_segmented'</span><span class="op">,</span> <span class="ss">'epochinfo'</span><span class="op">,</span> <span class="ss">'yes'</span>)<span class="op">;</span></span>
<span id="cb77-1852"><a href="#cb77-1852" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">7</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'Segmented'</span><span class="op">,</span><span class="ss">'savenew'</span><span class="op">,</span><span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\13-Segment\\tcid_wave_Segment.set'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1853"><a href="#cb77-1853" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1854"><a href="#cb77-1854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1855"><a href="#cb77-1855" aria-hidden="true" tabindex="-1"></a><span class="co">% Baseline Correcting the Data</span></span>
<span id="cb77-1856"><a href="#cb77-1856" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-1857"><a href="#cb77-1857" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_rmbase</span>( <span class="va">ALLEEG</span>(<span class="fl">7</span>)<span class="op">,</span> [<span class="op">-</span><span class="fl">200</span> <span class="fl">0</span>] <span class="op">,</span>[])<span class="op">;</span></span>
<span id="cb77-1858"><a href="#cb77-1858" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="fl">8</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span><span class="ss">'Baseline Correct'</span><span class="op">,</span><span class="ss">'savenew'</span><span class="op">,</span><span class="ss">'R:\\Lab\\Studies\\School Readiness Study\\Data\\LV2\\ERP\\Oddball\\MATLAB\\14-Baseline-Correct\\tcid_wave_baseline-correct.set'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span> </span>
<span id="cb77-1859"><a href="#cb77-1859" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1860"><a href="#cb77-1860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1861"><a href="#cb77-1861" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1862"><a href="#cb77-1862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1863"><a href="#cb77-1863" aria-hidden="true" tabindex="-1"></a>### <span class="va">Automatic</span> <span class="va">script</span> <span class="va">that</span> <span class="va">loops</span> <span class="va">files</span></span>
<span id="cb77-1864"><a href="#cb77-1864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1865"><a href="#cb77-1865" aria-hidden="true" tabindex="-1"></a>#### <span class="va">Warning</span> <span class="va">messages</span> <span class="va">with</span> <span class="va">script</span></span>
<span id="cb77-1866"><a href="#cb77-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1867"><a href="#cb77-1867" aria-hidden="true" tabindex="-1"></a><span class="va">Warning</span> <span class="va">messages</span> <span class="va">appeared</span> <span class="va">when</span> <span class="va">using</span> <span class="va">the</span> <span class="va">automatic</span> <span class="va">cleaning</span> <span class="va">of</span> <span class="va">data</span>.</span>
<span id="cb77-1868"><a href="#cb77-1868" aria-hidden="true" tabindex="-1"></a><span class="va">We</span> <span class="va">may</span> <span class="va">have</span> <span class="va">to</span> <span class="va">send</span> <span class="va">a</span> <span class="va">dataset</span> <span class="va">to</span> <span class="va">someone</span> <span class="va">so</span> <span class="va">they</span> <span class="va">can</span> <span class="va">check</span> <span class="va">on</span> <span class="va">it</span>.</span>
<span id="cb77-1869"><a href="#cb77-1869" aria-hidden="true" tabindex="-1"></a><span class="va">Some</span> <span class="va">documentation</span> <span class="va">is</span> <span class="va">found</span> <span class="va">here</span><span class="op">:</span></span>
<span id="cb77-1870"><a href="#cb77-1870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1871"><a href="#cb77-1871" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">&lt;</span><span class="va">https</span><span class="op">://</span><span class="va">sccn</span>.<span class="va">ucsd</span>.<span class="va">edu</span><span class="op">/</span><span class="va">pipermail</span><span class="op">/</span><span class="va">eeglablist</span><span class="op">/</span><span class="fl">2021</span><span class="op">/</span><span class="fl">016222</span>.<span class="va">html</span><span class="op">&gt;</span> (<span class="va">archived</span> <span class="va">at</span> <span class="op">&lt;</span><span class="va">https</span><span class="op">://</span><span class="va">perma</span>.<span class="va">cc</span><span class="op">/</span><span class="fl">9</span><span class="va">SDG</span><span class="op">-</span><span class="va">NGXD</span><span class="op">&gt;</span>)</span>
<span id="cb77-1872"><a href="#cb77-1872" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="op">&lt;</span><span class="va">https</span><span class="op">://</span><span class="va">sccn</span>.<span class="va">ucsd</span>.<span class="va">edu</span><span class="op">/</span><span class="va">wiki</span><span class="op">/</span><span class="va">EEGLAB_bug1971</span><span class="op">&gt;</span> (<span class="va">archived</span> <span class="va">at</span> <span class="op">&lt;</span><span class="va">https</span><span class="op">://</span><span class="va">perma</span>.<span class="va">cc</span><span class="op">/</span><span class="va">H7PA</span><span class="op">-</span><span class="va">TPTZ</span><span class="op">&gt;</span>)</span>
<span id="cb77-1873"><a href="#cb77-1873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1874"><a href="#cb77-1874" aria-hidden="true" tabindex="-1"></a>#### <span class="va">Filtering</span><span class="op">,</span> <span class="va">average</span> <span class="va">referencing</span><span class="op">,</span> <span class="va">and</span> <span class="va">automatically</span> <span class="va">cleaning</span> <span class="va">the</span> <span class="va">data</span>.</span>
<span id="cb77-1875"><a href="#cb77-1875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1876"><a href="#cb77-1876" aria-hidden="true" tabindex="-1"></a><span class="va">This</span> <span class="va">script</span> <span class="va">batch</span> <span class="va">reads</span> <span class="va">in</span> <span class="va">files</span><span class="op">,</span> <span class="va">filters</span> <span class="va">them</span><span class="op">,</span> <span class="va">average</span> <span class="va">references</span><span class="op">,</span> <span class="va">and</span> <span class="va">automatically</span> <span class="va">cleans</span> <span class="va">them</span>.</span>
<span id="cb77-1877"><a href="#cb77-1877" aria-hidden="true" tabindex="-1"></a><span class="va">After</span> <span class="va">that</span><span class="op">,</span> <span class="va">this</span> <span class="va">script</span> <span class="va">reads</span> <span class="va">in</span> <span class="va">the</span> <span class="va">cleaned</span> <span class="va">files</span> <span class="kw">for</span> <span class="va">manually</span> <span class="va">processing</span> <span class="va">to</span> <span class="va">remove</span> <span class="va">bad</span> <span class="va">time</span> <span class="va">periods</span> <span class="va">and</span> <span class="va">bad</span> <span class="va">channels</span></span>
<span id="cb77-1878"><a href="#cb77-1878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1879"><a href="#cb77-1879" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-1880"><a href="#cb77-1880" aria-hidden="true" tabindex="-1"></a><span class="co">%10/20/22 Working script that reads everything into matlab</span></span>
<span id="cb77-1881"><a href="#cb77-1881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1882"><a href="#cb77-1882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1883"><a href="#cb77-1883" aria-hidden="true" tabindex="-1"></a><span class="co">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span>
<span id="cb77-1884"><a href="#cb77-1884" aria-hidden="true" tabindex="-1"></a><span class="co">%Location of Raw oddball files</span></span>
<span id="cb77-1885"><a href="#cb77-1885" aria-hidden="true" tabindex="-1"></a><span class="va">rawOddballFiles</span> <span class="op">=</span> <span class="ss">'\\lc-rs-store24.hpc.uiowa.edu\lss_itpetersen\Lab\Studies\School Readiness Study\Data\LV2\ERP\Oddball\MATLAB\0-Raw\'</span><span class="op">;</span></span>
<span id="cb77-1886"><a href="#cb77-1886" aria-hidden="true" tabindex="-1"></a><span class="co">%Location of path to save cleaned files</span></span>
<span id="cb77-1887"><a href="#cb77-1887" aria-hidden="true" tabindex="-1"></a><span class="va">cleanAutoPath</span> <span class="op">=</span> <span class="ss">'\\lc-rs-store24.hpc.uiowa.edu\lss_itpetersen\Lab\Studies\School Readiness Study\Data\LV2\ERP\Oddball\MATLAB\10-Clean Artificats (clean)\'</span><span class="op">;</span></span>
<span id="cb77-1888"><a href="#cb77-1888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1889"><a href="#cb77-1889" aria-hidden="true" tabindex="-1"></a><span class="co">%all oddball files in the directory to be processed</span></span>
<span id="cb77-1890"><a href="#cb77-1890" aria-hidden="true" tabindex="-1"></a><span class="va">filesInDirectory</span> <span class="op">=</span> <span class="va">dir</span>(<span class="va">fullfile</span>(<span class="va">rawOddballFiles</span><span class="op">,</span> <span class="ss">'*.mff'</span>))<span class="op">;</span> <span class="co">%Reading the files in the directory</span></span>
<span id="cb77-1891"><a href="#cb77-1891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1892"><a href="#cb77-1892" aria-hidden="true" tabindex="-1"></a><span class="co">%Listing the number of subjects for the number of times to loop</span></span>
<span id="cb77-1893"><a href="#cb77-1893" aria-hidden="true" tabindex="-1"></a><span class="va">numberOfSubject</span> <span class="op">=</span> <span class="va">height</span>(<span class="va">filesInDirectory</span>)<span class="op">;</span></span>
<span id="cb77-1894"><a href="#cb77-1894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1895"><a href="#cb77-1895" aria-hidden="true" tabindex="-1"></a><span class="co">%Names of all the files in the directory</span></span>
<span id="cb77-1896"><a href="#cb77-1896" aria-hidden="true" tabindex="-1"></a><span class="va">listOfSubjects</span><span class="op">=</span>{<span class="va">filesInDirectory</span>.<span class="va">name</span>}<span class="op">;</span> </span>
<span id="cb77-1897"><a href="#cb77-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1898"><a href="#cb77-1898" aria-hidden="true" tabindex="-1"></a><span class="co">%splitting the filename up</span></span>
<span id="cb77-1899"><a href="#cb77-1899" aria-hidden="true" tabindex="-1"></a><span class="va">filenameSplit</span> <span class="op">=</span> <span class="va">regexp</span>(<span class="va">listOfSubjects</span><span class="op">,</span> <span class="ss">'_'</span><span class="op">,</span> <span class="ss">'split'</span>)<span class="op">;</span>  </span>
<span id="cb77-1900"><a href="#cb77-1900" aria-hidden="true" tabindex="-1"></a><span class="va">id</span> <span class="op">=</span> <span class="va">cellfun</span>(<span class="op">@</span>(<span class="va">x</span>) <span class="va">x</span>{<span class="fl">1</span>}<span class="op">,</span><span class="va">filenameSplit</span><span class="op">,</span><span class="ss">'un'</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span>  <span class="co">%getting the id's</span></span>
<span id="cb77-1901"><a href="#cb77-1901" aria-hidden="true" tabindex="-1"></a><span class="va">wave</span> <span class="op">=</span> <span class="va">cellfun</span>(<span class="op">@</span>(<span class="va">x</span>) <span class="va">x</span>{<span class="fl">2</span>}<span class="op">,</span><span class="va">filenameSplit</span><span class="op">,</span><span class="ss">'un'</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span> <span class="co">%getting the waves</span></span>
<span id="cb77-1902"><a href="#cb77-1902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1903"><a href="#cb77-1903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1904"><a href="#cb77-1904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1905"><a href="#cb77-1905" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span> <span class="va">ALLCOM</span>] <span class="op">=</span> <span class="va">eeglab</span><span class="op">;</span></span>
<span id="cb77-1906"><a href="#cb77-1906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1907"><a href="#cb77-1907" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">numberOfSubject</span></span>
<span id="cb77-1908"><a href="#cb77-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1909"><a href="#cb77-1909" aria-hidden="true" tabindex="-1"></a>    <span class="co">%%%% Importing Data</span></span>
<span id="cb77-1910"><a href="#cb77-1910" aria-hidden="true" tabindex="-1"></a>    <span class="va">path</span> <span class="op">=</span> [<span class="va">rawOddballFiles</span><span class="op">,</span><span class="va">filesInDirectory</span>(<span class="va">i</span>).<span class="va">name</span>]<span class="op">;</span></span>
<span id="cb77-1911"><a href="#cb77-1911" aria-hidden="true" tabindex="-1"></a>    <span class="va">tcid</span> <span class="op">=</span> <span class="va">char</span>(<span class="va">strcat</span>(<span class="va">id</span>(<span class="va">i</span>)<span class="op">,</span><span class="ss">'_'</span><span class="op">,</span> <span class="va">wave</span>(<span class="va">i</span>)))<span class="op">;</span> <span class="co">%combining the TCID and wave</span></span>
<span id="cb77-1912"><a href="#cb77-1912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1913"><a href="#cb77-1913" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_mffimport</span>({<span class="va">path</span>}<span class="op">,</span>{<span class="ss">'code'</span>}<span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span></span>
<span id="cb77-1914"><a href="#cb77-1914" aria-hidden="true" tabindex="-1"></a>    <span class="co">% Saving the data in memory</span></span>
<span id="cb77-1915"><a href="#cb77-1915" aria-hidden="true" tabindex="-1"></a>   [<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">i</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span> <span class="va">tcid</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span></span>
<span id="cb77-1916"><a href="#cb77-1916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1917"><a href="#cb77-1917" aria-hidden="true" tabindex="-1"></a>    <span class="co">% Filtering the data</span></span>
<span id="cb77-1918"><a href="#cb77-1918" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_eegfiltnew</span>(<span class="va">ALLEEG</span>(<span class="va">i</span>)<span class="op">,</span> <span class="ss">'locutoff'</span><span class="op">,</span><span class="fl">0.1</span><span class="op">,</span><span class="ss">'hicutoff'</span><span class="op">,</span><span class="fl">30</span><span class="op">,</span><span class="ss">'plotfreqz'</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb77-1919"><a href="#cb77-1919" aria-hidden="true" tabindex="-1"></a>    [<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">i</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span></span>
<span id="cb77-1920"><a href="#cb77-1920" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb77-1921"><a href="#cb77-1921" aria-hidden="true" tabindex="-1"></a>    <span class="co">% Average Referencing</span></span>
<span id="cb77-1922"><a href="#cb77-1922" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_reref</span>( <span class="va">ALLEEG</span>(<span class="va">i</span>)<span class="op">,</span> [])<span class="op">;</span></span>
<span id="cb77-1923"><a href="#cb77-1923" aria-hidden="true" tabindex="-1"></a>    [<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">i</span><span class="op">,</span><span class="ss">'overwrite'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span></span>
<span id="cb77-1924"><a href="#cb77-1924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1925"><a href="#cb77-1925" aria-hidden="true" tabindex="-1"></a>    <span class="co">% They strongly advise importing channel locations before using this</span></span>
<span id="cb77-1926"><a href="#cb77-1926" aria-hidden="true" tabindex="-1"></a>    <span class="co">% function.</span></span>
<span id="cb77-1927"><a href="#cb77-1927" aria-hidden="true" tabindex="-1"></a>    <span class="co">%Cleaning the Data</span></span>
<span id="cb77-1928"><a href="#cb77-1928" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_clean_rawdata</span>(<span class="va">ALLEEG</span>(<span class="va">i</span>)<span class="op">,</span> <span class="ss">'FlatlineCriterion'</span><span class="op">,</span><span class="fl">5</span><span class="op">,</span><span class="ss">'ChannelCriterion'</span><span class="op">,</span><span class="fl">0.8</span><span class="op">,</span><span class="ss">'LineNoiseCriterion'</span><span class="op">,</span><span class="fl">4</span><span class="op">,</span><span class="ss">'Highpass'</span><span class="op">,</span><span class="ss">'off'</span><span class="op">,</span><span class="ss">'BurstCriterion'</span><span class="op">,</span><span class="fl">30</span><span class="op">,</span><span class="ss">'WindowCriterion'</span><span class="op">,</span><span class="fl">0.25</span><span class="op">,</span><span class="ss">'BurstRejection'</span><span class="op">,</span><span class="ss">'on'</span><span class="op">,</span><span class="ss">'Distance'</span><span class="op">,</span><span class="ss">'Euclidian'</span><span class="op">,</span><span class="ss">'WindowCriterionTolerances'</span><span class="op">,</span>[<span class="op">-</span><span class="va">Inf</span> <span class="fl">7</span>])<span class="op">;</span></span>
<span id="cb77-1929"><a href="#cb77-1929" aria-hidden="true" tabindex="-1"></a>    <span class="va">nameClean</span> <span class="op">=</span> [<span class="va">tcid</span><span class="op">,</span><span class="ss">'_autoClean.set'</span>]<span class="op">;</span></span>
<span id="cb77-1930"><a href="#cb77-1930" aria-hidden="true" tabindex="-1"></a>    <span class="va">savePathClean</span> <span class="op">=</span> [<span class="va">cleanAutoPath</span><span class="op">,</span><span class="va">nameClean</span>]<span class="op">;</span></span>
<span id="cb77-1931"><a href="#cb77-1931" aria-hidden="true" tabindex="-1"></a>    [<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">i</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span> <span class="va">nameClean</span><span class="op">,</span> <span class="ss">'savenew'</span><span class="op">,</span> <span class="va">savePathClean</span><span class="op">,</span> <span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span><span class="op">,</span> <span class="ss">'overwrite'</span><span class="op">,</span> <span class="ss">'on'</span>)<span class="op">;</span></span>
<span id="cb77-1932"><a href="#cb77-1932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1933"><a href="#cb77-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1934"><a href="#cb77-1934" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb77-1935"><a href="#cb77-1935" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">:</span></span>
<span id="cb77-1936"><a href="#cb77-1936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1937"><a href="#cb77-1937" aria-hidden="true" tabindex="-1"></a><span class="co">%% Reading in automatically cleaned datasets</span></span>
<span id="cb77-1938"><a href="#cb77-1938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1939"><a href="#cb77-1939" aria-hidden="true" tabindex="-1"></a><span class="co">%%%%%%%%%%%%%%</span></span>
<span id="cb77-1940"><a href="#cb77-1940" aria-hidden="true" tabindex="-1"></a><span class="co">% Clear Data becasue to overwrite anything in memory</span></span>
<span id="cb77-1941"><a href="#cb77-1941" aria-hidden="true" tabindex="-1"></a><span class="co">%%%%%%%%%%%%%%</span></span>
<span id="cb77-1942"><a href="#cb77-1942" aria-hidden="true" tabindex="-1"></a><span class="va">ALLEEG</span> <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb77-1943"><a href="#cb77-1943" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb77-1944"><a href="#cb77-1944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1945"><a href="#cb77-1945" aria-hidden="true" tabindex="-1"></a><span class="co">% Adding the path for cleaned files</span></span>
<span id="cb77-1946"><a href="#cb77-1946" aria-hidden="true" tabindex="-1"></a><span class="va">cleanAutoPath</span> <span class="op">=</span> <span class="ss">'\\lc-rs-store24.hpc.uiowa.edu\lss_itpetersen\Lab\Studies\School Readiness Study\Data\LV2\ERP\Oddball\MATLAB\10-Clean Artificats (clean)\'</span><span class="op">;</span></span>
<span id="cb77-1947"><a href="#cb77-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1948"><a href="#cb77-1948" aria-hidden="true" tabindex="-1"></a><span class="co">%Starting EEGLAB</span></span>
<span id="cb77-1949"><a href="#cb77-1949" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span> <span class="va">ALLCOM</span>] <span class="op">=</span> <span class="va">eeglab</span><span class="op">;</span></span>
<span id="cb77-1950"><a href="#cb77-1950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1951"><a href="#cb77-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1952"><a href="#cb77-1952" aria-hidden="true" tabindex="-1"></a><span class="co">%Location of cleaned oddball data</span></span>
<span id="cb77-1953"><a href="#cb77-1953" aria-hidden="true" tabindex="-1"></a><span class="va">filesInDirectoryClean</span> <span class="op">=</span> <span class="va">dir</span>(<span class="va">fullfile</span>(<span class="va">cleanAutoPath</span><span class="op">,</span> <span class="ss">'*.set'</span>))<span class="op">;</span> <span class="co">%Reading the files in the directory</span></span>
<span id="cb77-1954"><a href="#cb77-1954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1955"><a href="#cb77-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1956"><a href="#cb77-1956" aria-hidden="true" tabindex="-1"></a><span class="co">%Listing the number of subjects for the number of times to loop</span></span>
<span id="cb77-1957"><a href="#cb77-1957" aria-hidden="true" tabindex="-1"></a><span class="va">numberOfSubjectClean</span> <span class="op">=</span> <span class="va">height</span>(<span class="va">filesInDirectoryClean</span>)<span class="op">;</span></span>
<span id="cb77-1958"><a href="#cb77-1958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1959"><a href="#cb77-1959" aria-hidden="true" tabindex="-1"></a><span class="co">%Names of all the files in the directory</span></span>
<span id="cb77-1960"><a href="#cb77-1960" aria-hidden="true" tabindex="-1"></a><span class="va">listOfSubjectsClean</span> <span class="op">=</span> {<span class="va">filesInDirectoryClean</span>.<span class="va">name</span>}<span class="op">;</span> </span>
<span id="cb77-1961"><a href="#cb77-1961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1962"><a href="#cb77-1962" aria-hidden="true" tabindex="-1"></a><span class="co">%splitting the filename up</span></span>
<span id="cb77-1963"><a href="#cb77-1963" aria-hidden="true" tabindex="-1"></a><span class="va">filenameSplitClean</span> <span class="op">=</span> <span class="va">regexp</span>(<span class="va">listOfSubjectsClean</span><span class="op">,</span> <span class="ss">'_'</span><span class="op">,</span> <span class="ss">'split'</span>)<span class="op">;</span>  </span>
<span id="cb77-1964"><a href="#cb77-1964" aria-hidden="true" tabindex="-1"></a><span class="va">id</span> <span class="op">=</span> <span class="va">cellfun</span>(<span class="op">@</span>(<span class="va">x</span>) <span class="va">x</span>{<span class="fl">1</span>}<span class="op">,</span><span class="va">filenameSplitClean</span><span class="op">,</span><span class="ss">'un'</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span>  <span class="co">%getting the id's</span></span>
<span id="cb77-1965"><a href="#cb77-1965" aria-hidden="true" tabindex="-1"></a><span class="va">wave</span> <span class="op">=</span> <span class="va">cellfun</span>(<span class="op">@</span>(<span class="va">x</span>) <span class="va">x</span>{<span class="fl">2</span>}<span class="op">,</span><span class="va">filenameSplitClean</span><span class="op">,</span><span class="ss">'un'</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span> <span class="co">%getting the waves</span></span>
<span id="cb77-1966"><a href="#cb77-1966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1967"><a href="#cb77-1967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1968"><a href="#cb77-1968" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">numberOfSubjectClean</span></span>
<span id="cb77-1969"><a href="#cb77-1969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1970"><a href="#cb77-1970" aria-hidden="true" tabindex="-1"></a>    <span class="co">%%%% Importing Data</span></span>
<span id="cb77-1971"><a href="#cb77-1971" aria-hidden="true" tabindex="-1"></a>    <span class="va">tcidClean</span> <span class="op">=</span> <span class="va">char</span>(<span class="va">strcat</span>(<span class="va">id</span>(<span class="va">i</span>)<span class="op">,</span><span class="ss">'_'</span><span class="op">,</span> <span class="va">wave</span>(<span class="va">i</span>)<span class="op">,</span> <span class="ss">'_autoClean.set'</span>))<span class="op">;</span> <span class="co">%combining the TCID and wave to name the file</span></span>
<span id="cb77-1972"><a href="#cb77-1972" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_loadset</span>(<span class="ss">'filename'</span><span class="op">,</span> <span class="va">tcidClean</span><span class="op">,</span> <span class="ss">'filepath'</span><span class="op">,</span> <span class="va">cleanAutoPath</span>)<span class="op">;</span> </span>
<span id="cb77-1973"><a href="#cb77-1973" aria-hidden="true" tabindex="-1"></a>    [<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">i</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span> <span class="va">tcidClean</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span></span>
<span id="cb77-1974"><a href="#cb77-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1975"><a href="#cb77-1975" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb77-1976"><a href="#cb77-1976" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-1977"><a href="#cb77-1977" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-1978"><a href="#cb77-1978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1979"><a href="#cb77-1979" aria-hidden="true" tabindex="-1"></a>### <span class="va">Removing</span> <span class="va">bad</span> <span class="va">time</span> <span class="va">periods</span> <span class="va">and</span> <span class="va">channels</span></span>
<span id="cb77-1980"><a href="#cb77-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1981"><a href="#cb77-1981" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">In</span> <span class="va">the</span> <span class="va">now</span> <span class="va">open</span> <span class="va">EEGLAB</span> <span class="va">interface</span><span class="op">,</span> <span class="va">select</span> <span class="va">a</span> <span class="va">dataset</span>.</span>
<span id="cb77-1982"><a href="#cb77-1982" aria-hidden="true" tabindex="-1"></a><span class="va">Go</span> <span class="va">to</span> `<span class="va">Tools</span>` <span class="op">&gt;</span> `<span class="va">Inspect</span><span class="op">/</span><span class="va">reject</span> <span class="va">data</span> <span class="va">by</span> <span class="va">eye</span>` </span>
<span id="cb77-1983"><a href="#cb77-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1984"><a href="#cb77-1984" aria-hidden="true" tabindex="-1"></a><span class="bn">![visually reject artifacts](images/visual_reject_artifacts.png)</span></span>
<span id="cb77-1985"><a href="#cb77-1985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1986"><a href="#cb77-1986" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Go</span> <span class="va">through</span> <span class="va">the</span> <span class="va">raw</span> <span class="va">signal</span> <span class="va">and</span> <span class="va">manually</span> <span class="va">reject</span> <span class="va">bad</span> <span class="va">time</span> <span class="va">periods</span></span>
<span id="cb77-1987"><a href="#cb77-1987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1988"><a href="#cb77-1988" aria-hidden="true" tabindex="-1"></a><span class="bn">![visually reject artifacts](images/reject_time_periods.png)</span></span>
<span id="cb77-1989"><a href="#cb77-1989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1990"><a href="#cb77-1990" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Select</span> `<span class="va">REJECT</span>` <span class="va">and</span> <span class="va">overwrite</span> <span class="va">the</span> <span class="va">file</span> <span class="va">in</span> <span class="va">memory</span></span>
<span id="cb77-1991"><a href="#cb77-1991" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">select</span> `<span class="va">Overwrite</span> <span class="va">it</span> <span class="va">in</span> <span class="va">memory</span> (<span class="va">set</span><span class="op">=</span><span class="va">yes</span><span class="op">;</span> <span class="va">unset</span><span class="op">=</span><span class="va">create</span> <span class="va">a</span> <span class="va">new</span> <span class="va">dataset</span>)`</span>
<span id="cb77-1992"><a href="#cb77-1992" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Visually</span> <span class="va">inspect</span> <span class="va">the</span> <span class="va">data</span> <span class="va">and</span> <span class="va">select</span> <span class="va">any</span> <span class="va">bad</span> <span class="va">channels</span><span class="op">,</span> <span class="va">and</span> <span class="va">write</span> <span class="va">them</span> <span class="va">down</span></span>
<span id="cb77-1993"><a href="#cb77-1993" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Next</span><span class="op">,</span> <span class="va">manually</span> <span class="va">reject</span> <span class="va">the</span> <span class="va">channels</span> <span class="va">by</span> <span class="va">selecting</span> `<span class="va">Edit</span>` <span class="va">then</span> `<span class="va">Select</span> <span class="va">Data</span>`</span>
<span id="cb77-1994"><a href="#cb77-1994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1995"><a href="#cb77-1995" aria-hidden="true" tabindex="-1"></a><span class="bn">![visually reject artifacts](images/drop_channels.png)</span></span>
<span id="cb77-1996"><a href="#cb77-1996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1997"><a href="#cb77-1997" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Manually</span> <span class="va">enter</span> <span class="va">the</span> <span class="va">channels</span> <span class="va">to</span> <span class="va">be</span> <span class="va">removed</span> <span class="va">in</span> <span class="va">the</span> `<span class="va">Channel</span> <span class="va">range</span>` <span class="va">field</span> <span class="va">and</span> <span class="va">select</span> <span class="va">the</span> <span class="va">checkbox</span> <span class="va">under</span> `<span class="va">on</span><span class="op">-&gt;</span><span class="va">remove</span> <span class="va">these</span>` <span class="va">and</span> <span class="va">select</span> `<span class="va">Ok</span>`</span>
<span id="cb77-1998"><a href="#cb77-1998" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Save</span> <span class="va">the</span> <span class="va">file</span> <span class="va">as</span> `<span class="va">tcid_wave_manualClean</span>.<span class="va">set</span>` <span class="va">in</span> <span class="va">the</span> <span class="va">following</span> <span class="va">drive</span> <span class="va">path</span> </span>
<span id="cb77-1999"><a href="#cb77-1999" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> `<span class="op">\\</span><span class="va">lc</span><span class="op">-</span><span class="va">rs</span><span class="op">-</span><span class="va">store24</span>.<span class="va">hpc</span>.<span class="va">uiowa</span>.<span class="va">edu</span><span class="op">\</span><span class="va">lss_itpetersen</span><span class="op">\</span><span class="va">Lab</span><span class="op">\</span><span class="va">Studies</span><span class="op">\</span><span class="va">School</span> <span class="va">Readiness</span> <span class="va">Study</span><span class="op">\</span><span class="va">Data</span><span class="op">\</span><span class="va">LV2</span><span class="op">\</span><span class="va">ERP</span><span class="op">\</span><span class="va">Oddball</span><span class="op">\</span><span class="va">MATLAB</span><span class="op">\</span><span class="fl">11</span><span class="op">-</span><span class="va">Manually</span> <span class="va">Cleaned</span>`</span>
<span id="cb77-2000"><a href="#cb77-2000" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="va">This</span> <span class="va">screenshot</span> <span class="va">represents</span> <span class="va">removing</span> <span class="va">channels</span> `<span class="fl">23</span> <span class="fl">56</span> <span class="fl">57</span> <span class="fl">97</span>`</span>
<span id="cb77-2001"><a href="#cb77-2001" aria-hidden="true" tabindex="-1"></a><span class="bn">![visually reject artifacts](images/remove_channels_specific.png)</span></span>
<span id="cb77-2002"><a href="#cb77-2002" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Repeat</span> <span class="va">step</span> <span class="kw">for</span> <span class="va">each</span> <span class="va">cleaned</span> <span class="va">dataset</span></span>
<span id="cb77-2003"><a href="#cb77-2003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2004"><a href="#cb77-2004" aria-hidden="true" tabindex="-1"></a>### <span class="va">Running</span> <span class="va">the</span> <span class="va">ICA</span></span>
<span id="cb77-2005"><a href="#cb77-2005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2006"><a href="#cb77-2006" aria-hidden="true" tabindex="-1"></a><span class="va">This</span> <span class="va">script</span> <span class="va">runs</span> <span class="va">the</span> <span class="va">ICA</span>.</span>
<span id="cb77-2007"><a href="#cb77-2007" aria-hidden="true" tabindex="-1"></a><span class="va">We</span><span class="op">'</span><span class="va">ll</span> <span class="va">want</span> <span class="va">to</span> <span class="va">think</span> <span class="va">about</span> <span class="va">how</span> <span class="va">to</span> <span class="va">automatically</span> <span class="va">reject</span> <span class="va">the</span> <span class="va">components</span> <span class="va">here</span>.</span>
<span id="cb77-2008"><a href="#cb77-2008" aria-hidden="true" tabindex="-1"></a><span class="va">Once</span> <span class="va">this</span> <span class="va">runs</span><span class="op">,</span> <span class="va">see</span> <span class="va">the</span> [<span class="va">ICA</span> <span class="va">section</span>](#<span class="va">sec</span><span class="op">-</span><span class="va">ica</span>) <span class="va">to</span> <span class="va">reject</span> <span class="va">components</span>.</span>
<span id="cb77-2009"><a href="#cb77-2009" aria-hidden="true" tabindex="-1"></a><span class="va">Tools</span> → <span class="va">Inspect</span><span class="op">/</span><span class="va">label</span> <span class="va">components</span> <span class="va">by</span> <span class="va">map</span> <span class="va">is</span> <span class="va">how</span> <span class="va">to</span> <span class="va">reject</span> <span class="va">components</span>.</span>
<span id="cb77-2010"><a href="#cb77-2010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2011"><a href="#cb77-2011" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb77-2012"><a href="#cb77-2012" aria-hidden="true" tabindex="-1"></a><span class="co">% Running the ICA</span></span>
<span id="cb77-2013"><a href="#cb77-2013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2014"><a href="#cb77-2014" aria-hidden="true" tabindex="-1"></a><span class="co">%% Reading in the manually cleaned datasets</span></span>
<span id="cb77-2015"><a href="#cb77-2015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2016"><a href="#cb77-2016" aria-hidden="true" tabindex="-1"></a><span class="co">%%%%%%%%%%%%%%</span></span>
<span id="cb77-2017"><a href="#cb77-2017" aria-hidden="true" tabindex="-1"></a><span class="co">% Clear Data becasue to overwrite anything in memory</span></span>
<span id="cb77-2018"><a href="#cb77-2018" aria-hidden="true" tabindex="-1"></a><span class="co">%%%%%%%%%%%%%%</span></span>
<span id="cb77-2019"><a href="#cb77-2019" aria-hidden="true" tabindex="-1"></a><span class="va">ALLEEG</span> <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb77-2020"><a href="#cb77-2020" aria-hidden="true" tabindex="-1"></a><span class="va">EEG</span> <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb77-2021"><a href="#cb77-2021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2022"><a href="#cb77-2022" aria-hidden="true" tabindex="-1"></a><span class="co">% Adding the path for cleaned files</span></span>
<span id="cb77-2023"><a href="#cb77-2023" aria-hidden="true" tabindex="-1"></a><span class="va">manualCleanPath</span> <span class="op">=</span> <span class="ss">'\\lc-rs-store24.hpc.uiowa.edu\lss_itpetersen\Lab\Studies\School Readiness Study\Data\LV2\ERP\Oddball\MATLAB\11-Manually Cleaned\'</span><span class="op">;</span></span>
<span id="cb77-2024"><a href="#cb77-2024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2025"><a href="#cb77-2025" aria-hidden="true" tabindex="-1"></a><span class="co">%Starting EEGLAB</span></span>
<span id="cb77-2026"><a href="#cb77-2026" aria-hidden="true" tabindex="-1"></a>[<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span> <span class="va">ALLCOM</span>] <span class="op">=</span> <span class="va">eeglab</span><span class="op">;</span></span>
<span id="cb77-2027"><a href="#cb77-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2028"><a href="#cb77-2028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2029"><a href="#cb77-2029" aria-hidden="true" tabindex="-1"></a><span class="co">%Location of cleaned oddball data</span></span>
<span id="cb77-2030"><a href="#cb77-2030" aria-hidden="true" tabindex="-1"></a><span class="va">filesInDirectoryManualClean</span> <span class="op">=</span> <span class="va">dir</span>(<span class="va">fullfile</span>(<span class="va">manualCleanPath</span><span class="op">,</span> <span class="ss">'*.set'</span>))<span class="op">;</span> <span class="co">%Reading the files in the directory</span></span>
<span id="cb77-2031"><a href="#cb77-2031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2032"><a href="#cb77-2032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2033"><a href="#cb77-2033" aria-hidden="true" tabindex="-1"></a><span class="co">%Listing the number of subjects for the number of times to loop</span></span>
<span id="cb77-2034"><a href="#cb77-2034" aria-hidden="true" tabindex="-1"></a><span class="va">numberOfSubjectManualClean</span> <span class="op">=</span> <span class="va">height</span>(<span class="va">filesInDirectoryManualClean</span>)<span class="op">;</span></span>
<span id="cb77-2035"><a href="#cb77-2035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2036"><a href="#cb77-2036" aria-hidden="true" tabindex="-1"></a><span class="co">%Names of all the files in the directory</span></span>
<span id="cb77-2037"><a href="#cb77-2037" aria-hidden="true" tabindex="-1"></a><span class="va">listOfSubjectsManualClean</span> <span class="op">=</span> {<span class="va">filesInDirectoryManualClean</span>.<span class="va">name</span>}<span class="op">;</span> </span>
<span id="cb77-2038"><a href="#cb77-2038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2039"><a href="#cb77-2039" aria-hidden="true" tabindex="-1"></a><span class="co">%splitting the filename up</span></span>
<span id="cb77-2040"><a href="#cb77-2040" aria-hidden="true" tabindex="-1"></a><span class="va">filenameSplitManualClean</span> <span class="op">=</span> <span class="va">regexp</span>(<span class="va">listOfSubjectsManualClean</span><span class="op">,</span> <span class="ss">'_'</span><span class="op">,</span> <span class="ss">'split'</span>)<span class="op">;</span>  </span>
<span id="cb77-2041"><a href="#cb77-2041" aria-hidden="true" tabindex="-1"></a><span class="va">id</span> <span class="op">=</span> <span class="va">cellfun</span>(<span class="op">@</span>(<span class="va">x</span>) <span class="va">x</span>{<span class="fl">1</span>}<span class="op">,</span><span class="va">filenameSplitManualClean</span><span class="op">,</span><span class="ss">'un'</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span>  <span class="co">%getting the id's</span></span>
<span id="cb77-2042"><a href="#cb77-2042" aria-hidden="true" tabindex="-1"></a><span class="va">wave</span> <span class="op">=</span> <span class="va">cellfun</span>(<span class="op">@</span>(<span class="va">x</span>) <span class="va">x</span>{<span class="fl">2</span>}<span class="op">,</span><span class="va">filenameSplitManualClean</span><span class="op">,</span><span class="ss">'un'</span><span class="op">,</span><span class="fl">0</span>)<span class="op">;</span> <span class="co">%getting the waves</span></span>
<span id="cb77-2043"><a href="#cb77-2043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2044"><a href="#cb77-2044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2045"><a href="#cb77-2045" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">numberOfSubjectManualClean</span></span>
<span id="cb77-2046"><a href="#cb77-2046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2047"><a href="#cb77-2047" aria-hidden="true" tabindex="-1"></a>    <span class="co">%%%% Importing Data</span></span>
<span id="cb77-2048"><a href="#cb77-2048" aria-hidden="true" tabindex="-1"></a>    <span class="va">tcidClean</span> <span class="op">=</span> <span class="va">char</span>(<span class="va">strcat</span>(<span class="va">id</span>(<span class="va">i</span>)<span class="op">,</span><span class="ss">'_'</span><span class="op">,</span> <span class="va">wave</span>(<span class="va">i</span>)<span class="op">,</span> <span class="ss">'_manualClean.set'</span>))<span class="op">;</span> <span class="co">%combining the TCID and wave to name the file</span></span>
<span id="cb77-2049"><a href="#cb77-2049" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_loadset</span>(<span class="ss">'filename'</span><span class="op">,</span> <span class="va">tcidClean</span><span class="op">,</span> <span class="ss">'filepath'</span><span class="op">,</span> <span class="va">manualCleanPath</span>)<span class="op">;</span> </span>
<span id="cb77-2050"><a href="#cb77-2050" aria-hidden="true" tabindex="-1"></a>    [<span class="va">ALLEEG</span> <span class="va">EEG</span> <span class="va">CURRENTSET</span>] <span class="op">=</span> <span class="va">pop_newset</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">i</span><span class="op">,</span><span class="ss">'setname'</span><span class="op">,</span> <span class="va">tcidClean</span><span class="op">,</span><span class="ss">'gui'</span><span class="op">,</span><span class="ss">'off'</span>)<span class="op">;</span></span>
<span id="cb77-2051"><a href="#cb77-2051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2052"><a href="#cb77-2052" aria-hidden="true" tabindex="-1"></a>    <span class="co">%%% Running the ICA</span></span>
<span id="cb77-2053"><a href="#cb77-2053" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">eeg_checkset</span>( <span class="va">EEG</span> )<span class="op">;</span></span>
<span id="cb77-2054"><a href="#cb77-2054" aria-hidden="true" tabindex="-1"></a>    <span class="va">EEG</span> <span class="op">=</span> <span class="va">pop_runica</span>(<span class="va">EEG</span><span class="op">,</span> <span class="ss">'icatype'</span><span class="op">,</span> <span class="ss">'runica'</span><span class="op">,</span> <span class="ss">'extended'</span><span class="op">,</span><span class="fl">1</span><span class="op">,</span><span class="ss">'interrupt'</span><span class="op">,</span><span class="ss">'on'</span>)<span class="op">;</span></span>
<span id="cb77-2055"><a href="#cb77-2055" aria-hidden="true" tabindex="-1"></a>    [<span class="va">ALLEEG</span> <span class="va">EEG</span>] <span class="op">=</span> <span class="va">eeg_store</span>(<span class="va">ALLEEG</span><span class="op">,</span> <span class="va">EEG</span><span class="op">,</span> <span class="va">CURRENTSET</span>)<span class="op">;</span></span>
<span id="cb77-2056"><a href="#cb77-2056" aria-hidden="true" tabindex="-1"></a>    <span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-2057"><a href="#cb77-2057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2058"><a href="#cb77-2058" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb77-2059"><a href="#cb77-2059" aria-hidden="true" tabindex="-1"></a><span class="va">eeglab</span> <span class="va">redraw</span><span class="op">;</span></span>
<span id="cb77-2060"><a href="#cb77-2060" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb77-2061"><a href="#cb77-2061" aria-hidden="true" tabindex="-1"></a>## <span class="va">NetStation</span></span>
<span id="cb77-2062"><a href="#cb77-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2063"><a href="#cb77-2063" aria-hidden="true" tabindex="-1"></a>### <span class="va">Processing</span> <span class="va">Order</span></span>
<span id="cb77-2064"><a href="#cb77-2064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2065"><a href="#cb77-2065" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Filtering</span> (<span class="va">fil</span>)</span>
<span id="cb77-2066"><a href="#cb77-2066" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Segmentation</span> (<span class="va">seg</span>)</span>
<span id="cb77-2067"><a href="#cb77-2067" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Manually</span> <span class="va">selected</span> <span class="va">bad</span> <span class="va">channels</span> (<span class="va">seg</span>) </span>
<span id="cb77-2068"><a href="#cb77-2068" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Bad</span> <span class="va">Channel</span> <span class="va">Replacement</span> (<span class="va">bcr</span>)</span>
<span id="cb77-2069"><a href="#cb77-2069" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Artifact</span> <span class="va">Detection</span> (<span class="va">art</span>)</span>
<span id="cb77-2070"><a href="#cb77-2070" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Bad</span> <span class="va">Channel</span> <span class="va">Replacement</span> (<span class="va">bcr</span>)</span>
<span id="cb77-2071"><a href="#cb77-2071" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Artifact</span> <span class="va">Detection</span> (<span class="va">art</span>)</span>
<span id="cb77-2072"><a href="#cb77-2072" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Averaging</span> (<span class="va">ave</span>) </span>
<span id="cb77-2073"><a href="#cb77-2073" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Average</span> <span class="va">Reference</span> (<span class="va">ref</span>)</span>
<span id="cb77-2074"><a href="#cb77-2074" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Baseline</span> <span class="va">Correction</span> (<span class="va">blc</span>)</span>
<span id="cb77-2075"><a href="#cb77-2075" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Grand</span><span class="op">-</span><span class="va">Averaging</span></span>
<span id="cb77-2076"><a href="#cb77-2076" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="fl">2</span><span class="op">-</span><span class="va">step</span> <span class="va">PCA</span><span class="op">:</span> <span class="va">Temporal</span> <span class="va">PCA</span> <span class="va">then</span> <span class="va">Spatial</span> <span class="va">PCA</span></span>
<span id="cb77-2077"><a href="#cb77-2077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2078"><a href="#cb77-2078" aria-hidden="true" tabindex="-1"></a>### <span class="va">Folder</span> <span class="va">Structure</span></span>
<span id="cb77-2079"><a href="#cb77-2079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2080"><a href="#cb77-2080" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">0</span>. <span class="va">Raw</span> <span class="va">Data</span> (<span class="va">mff</span>)</span>
<span id="cb77-2081"><a href="#cb77-2081" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">1</span>. <span class="va">Filtering</span> (<span class="va">fil</span>)</span>
<span id="cb77-2082"><a href="#cb77-2082" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">2</span>. <span class="va">Segmentation</span> (<span class="va">seg</span>)</span>
<span id="cb77-2083"><a href="#cb77-2083" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">3</span>. <span class="va">Manually</span> <span class="va">Selected</span> <span class="va">Bad</span> <span class="va">Channels</span></span>
<span id="cb77-2084"><a href="#cb77-2084" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">4</span>. <span class="va">Bad</span> <span class="va">Channel</span> <span class="va">Replacement_m</span> (<span class="va">bcr</span>)</span>
<span id="cb77-2085"><a href="#cb77-2085" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">5</span>. <span class="va">Artifact</span> <span class="va">Detection</span> (<span class="va">art</span>)</span>
<span id="cb77-2086"><a href="#cb77-2086" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">6</span>. <span class="va">Bad</span> <span class="va">Channel</span> <span class="va">Replacement</span> (<span class="va">bcr</span>)</span>
<span id="cb77-2087"><a href="#cb77-2087" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">7</span>. <span class="va">Artifact</span> <span class="va">Detection</span> (<span class="va">art</span>)</span>
<span id="cb77-2088"><a href="#cb77-2088" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">8</span>. <span class="va">Averaging</span> (<span class="va">ave</span>)</span>
<span id="cb77-2089"><a href="#cb77-2089" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Skip</span> <span class="kw">if</span> <span class="va">doing</span> <span class="va">PCA</span> <span class="va">on</span> <span class="va">individual</span> <span class="va">trial</span><span class="op">-</span><span class="va">level</span> <span class="va">data</span></span>
<span id="cb77-2090"><a href="#cb77-2090" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">9</span>. <span class="va">Average</span> <span class="va">Reference</span> (<span class="va">ref</span>)</span>
<span id="cb77-2091"><a href="#cb77-2091" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">10</span>. <span class="va">Baseline</span> <span class="va">Correction</span> (<span class="va">blc</span>)</span>
<span id="cb77-2092"><a href="#cb77-2092" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">11</span>. <span class="va">Files</span> <span class="kw">for</span> <span class="va">PCA</span> <span class="op">--</span> <span class="va">drop</span> <span class="va">files</span> <span class="va">that</span> <span class="va">have</span> <span class="va">fewer</span> <span class="va">than</span> <span class="fl">10</span> <span class="va">artifact</span><span class="op">-</span><span class="va">free</span> (<span class="va">and</span> <span class="va">correct</span>?) <span class="va">trials</span> <span class="va">per</span> <span class="va">condition</span></span>
<span id="cb77-2093"><a href="#cb77-2093" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">12</span>. <span class="va">Simple</span> <span class="va">Binary</span></span>
<span id="cb77-2094"><a href="#cb77-2094" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">13</span>. <span class="va">Individual</span> <span class="va">Trials</span></span>
<span id="cb77-2095"><a href="#cb77-2095" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">14</span>. <span class="va">EPT</span> <span class="va">Averages</span></span>
<span id="cb77-2096"><a href="#cb77-2096" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">15</span>. <span class="va">PCA</span></span>
<span id="cb77-2097"><a href="#cb77-2097" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="fl">16</span>. <span class="va">PCA</span> <span class="va">Components</span></span>
<span id="cb77-2098"><a href="#cb77-2098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2099"><a href="#cb77-2099" aria-hidden="true" tabindex="-1"></a><span class="bn">![](images/folderStructureNetStation.png)</span></span>
<span id="cb77-2100"><a href="#cb77-2100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2101"><a href="#cb77-2101" aria-hidden="true" tabindex="-1"></a>### <span class="va">Data</span> <span class="va">Processing</span></span>
<span id="cb77-2102"><a href="#cb77-2102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2103"><a href="#cb77-2103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2104"><a href="#cb77-2104" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Open</span> <span class="va">NetStation</span> <span class="va">Tools</span> <span class="va">and</span> <span class="va">select</span> <span class="va">Automated</span> <span class="va">Processing</span> <span class="va">Script</span> <span class="fl">1</span><span class="op">:</span> <span class="va">Run</span> <span class="va">on</span> <span class="va">raw</span> <span class="va">data</span> <span class="va">files</span> (<span class="va">mff</span>)</span>
<span id="cb77-2105"><a href="#cb77-2105" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Filtering</span></span>
<span id="cb77-2106"><a href="#cb77-2106" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Segmentation</span></span>
<span id="cb77-2107"><a href="#cb77-2107" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Open</span> <span class="va">segmented</span> (<span class="va">seg</span>) <span class="va">files</span> <span class="va">in</span> <span class="va">NetStation</span> <span class="va">Review</span> <span class="va">and</span> <span class="va">select</span> <span class="va">bad</span> <span class="va">channels</span> <span class="va">manually</span></span>
<span id="cb77-2108"><a href="#cb77-2108" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">To</span> <span class="va">mark</span> <span class="va">channels</span> <span class="va">as</span> <span class="va">bad</span> <span class="va">across</span> <span class="va">all</span> <span class="va">segments</span><span class="op">:</span></span>
<span id="cb77-2109"><a href="#cb77-2109" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Put</span> Ø <span class="va">next</span> <span class="va">to</span> <span class="va">bad</span> <span class="va">channels</span><span class="op">,</span> <span class="va">these</span> <span class="va">changes</span> <span class="va">will</span> <span class="va">automatically</span> <span class="va">be</span> <span class="va">saved</span> <span class="va">when</span> <span class="va">you</span> <span class="va">close</span> <span class="va">the</span> <span class="va">file</span> </span>
<span id="cb77-2110"><a href="#cb77-2110" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">To</span> <span class="va">mark</span> <span class="va">channels</span> <span class="va">as</span> <span class="va">bad</span> <span class="va">in</span> <span class="va">individual</span> <span class="va">segments</span><span class="op">:</span></span>
<span id="cb77-2111"><a href="#cb77-2111" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">When</span> <span class="va">in</span> <span class="va">topoplot</span> <span class="va">mode</span><span class="op">,</span> <span class="va">make</span> <span class="va">sure</span> <span class="va">to</span> <span class="va">have</span> <span class="va">the</span> “<span class="va">Click</span> <span class="va">to</span> <span class="va">Change</span> <span class="va">Channel</span> <span class="va">Status</span>” <span class="va">checked</span><span class="op">,</span> <span class="va">then</span> <span class="va">click</span> <span class="va">on</span> <span class="va">the</span> <span class="va">channel</span>.</span>
<span id="cb77-2112"><a href="#cb77-2112" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Open</span> <span class="va">NetStation</span> <span class="va">Tools</span> <span class="va">and</span> <span class="va">Manual</span> <span class="va">Script</span> <span class="fl">2</span><span class="op">:</span> <span class="va">Run</span> <span class="va">on</span> <span class="va">segmented</span> <span class="va">files</span> (<span class="va">seg</span>)</span>
<span id="cb77-2113"><a href="#cb77-2113" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Bad</span> <span class="va">Channel</span> <span class="va">Replacement</span> (<span class="va">bcr</span>)</span>
<span id="cb77-2114"><a href="#cb77-2114" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Artifact</span> <span class="va">Detection</span> (<span class="va">art</span>)</span>
<span id="cb77-2115"><a href="#cb77-2115" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Bad</span> <span class="va">Channel</span> <span class="va">Replacement</span> (<span class="va">bcr</span>)</span>
<span id="cb77-2116"><a href="#cb77-2116" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Artifact</span> <span class="va">Detection</span> (<span class="va">art</span>)</span>
<span id="cb77-2117"><a href="#cb77-2117" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Averaging</span> (<span class="va">ave</span>) </span>
<span id="cb77-2118"><a href="#cb77-2118" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Average</span> <span class="va">Reference</span> (<span class="va">ref</span>)</span>
<span id="cb77-2119"><a href="#cb77-2119" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Baseline</span> <span class="va">Correction</span> (<span class="va">blc</span>)</span>
<span id="cb77-2120"><a href="#cb77-2120" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">In</span> <span class="va">NetStation</span> <span class="va">Review</span><span class="op">,</span> <span class="va">open</span> <span class="va">each</span> <span class="va">file</span> <span class="va">after</span> <span class="va">the</span> <span class="va">second</span> <span class="va">Bad</span> <span class="va">Channel</span> <span class="va">Replacement</span></span>
<span id="cb77-2121"><a href="#cb77-2121" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Determine</span> <span class="va">how</span> <span class="va">many</span> <span class="va">trials</span> <span class="va">are</span> <span class="va">marked</span> <span class="va">as</span> <span class="va">good</span> <span class="va">in</span> <span class="va">each</span> <span class="va">condition</span></span>
<span id="cb77-2122"><a href="#cb77-2122" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">This</span> <span class="va">is</span> <span class="va">found</span> <span class="va">in</span> <span class="va">the</span> <span class="va">Segment</span> <span class="va">panel</span> <span class="va">on</span> <span class="va">the</span> <span class="va">bottom</span> <span class="va">left</span> <span class="va">when</span> <span class="va">you</span> <span class="va">have</span> <span class="va">your</span> <span class="va">file</span> <span class="va">open</span>.  <span class="va">If</span> <span class="va">you</span> <span class="va">open</span> <span class="va">that</span> <span class="va">view</span><span class="op">,</span> <span class="va">you</span> <span class="va">can</span> <span class="va">use</span> <span class="va">the</span> <span class="va">diverging</span> <span class="va">arrows</span> (<span class="va">those</span> <span class="va">may</span> <span class="va">be</span> <span class="va">hard</span> <span class="va">to</span> <span class="va">see</span> <span class="va">depending</span> <span class="va">on</span> <span class="va">your</span> <span class="va">screen</span> <span class="va">size</span>) <span class="va">in</span> <span class="va">the</span> <span class="va">upper</span> <span class="va">right</span> <span class="va">corner</span> <span class="va">of</span> <span class="va">the</span> “<span class="va">Bad</span> <span class="va">Channels</span>” <span class="va">button</span> <span class="va">in</span> <span class="va">the</span> <span class="va">Segment</span> <span class="va">panel</span> <span class="va">to</span> <span class="va">open</span> <span class="va">in</span> <span class="va">a</span> <span class="va">new</span> <span class="va">window</span> <span class="kw">for</span> <span class="va">more</span> <span class="va">screen</span> <span class="va">real</span> <span class="va">estate</span>.  <span class="va">The</span> <span class="va">categories</span> <span class="va">will</span> <span class="va">be</span> <span class="va">listed</span> <span class="va">on</span> <span class="va">the</span> <span class="va">left</span><span class="op">,</span> <span class="va">with</span> <span class="va">the</span> <span class="va">number</span> <span class="va">of</span> <span class="va">good</span> <span class="va">trials</span> <span class="va">noted</span> <span class="va">over</span> <span class="va">the</span> <span class="va">total</span> <span class="va">number</span> <span class="va">of</span> <span class="va">trials</span> <span class="va">in</span> <span class="va">that</span> <span class="va">category</span>.</span>
<span id="cb77-2123"><a href="#cb77-2123" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">If</span> <span class="va">the</span> <span class="va">file</span> <span class="va">has</span> <span class="fl">10</span> <span class="va">or</span> <span class="va">more</span> <span class="va">good</span> <span class="va">trials</span> <span class="va">in</span> <span class="va">each</span> <span class="va">condition</span><span class="op">:</span></span>
<span id="cb77-2124"><a href="#cb77-2124" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Make</span> <span class="va">note</span> <span class="va">of</span> <span class="va">the</span> <span class="va">bad</span> <span class="va">channels</span> (<span class="va">that</span> <span class="va">are</span> <span class="va">marked</span> <span class="va">as</span> <span class="va">bad</span> <span class="va">across</span> <span class="va">all</span> <span class="va">segments</span>) <span class="kw">for</span> <span class="va">each</span> <span class="va">subject</span> <span class="va">on</span> “<span class="va">EEG</span> <span class="va">Behavior</span> <span class="va">and</span> <span class="va">Bad</span> <span class="va">Channels</span> <span class="va">Sheet</span>”</span>
<span id="cb77-2125"><a href="#cb77-2125" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Then</span><span class="op">,</span> <span class="va">proceed</span> <span class="va">with</span> <span class="va">the</span> <span class="va">next</span> <span class="va">step</span></span>
<span id="cb77-2126"><a href="#cb77-2126" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">If</span> <span class="va">the</span> <span class="va">file</span> <span class="va">does</span> <span class="va">not</span> <span class="va">have</span> <span class="fl">10</span> <span class="va">more</span> <span class="va">good</span> <span class="va">trials</span> <span class="va">in</span> <span class="va">each</span> <span class="va">condition</span><span class="op">:</span></span>
<span id="cb77-2127"><a href="#cb77-2127" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Go</span> <span class="va">back</span> <span class="va">to</span> <span class="va">Step</span> <span class="fl">2</span> <span class="va">and</span> <span class="va">proceed</span> <span class="va">from</span> <span class="va">there</span></span>
<span id="cb77-2128"><a href="#cb77-2128" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Select</span> <span class="va">additional</span> <span class="va">bad</span> <span class="va">channels</span> <span class="va">manually</span> <span class="va">so</span> <span class="va">that</span> <span class="va">they</span> <span class="va">aren</span>’<span class="va">t</span> <span class="va">included</span> <span class="va">in</span> <span class="va">later</span> <span class="va">processing</span> <span class="va">steps</span><span class="op">,</span> <span class="va">which</span> <span class="va">might</span> <span class="va">increase</span> <span class="va">the</span> <span class="va">number</span> <span class="va">of</span> <span class="va">trials</span> <span class="va">kept</span></span>
<span id="cb77-2129"><a href="#cb77-2129" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">It</span> <span class="va">can</span> <span class="va">be</span> <span class="va">helpful</span> <span class="va">to</span> <span class="va">take</span> <span class="va">a</span> <span class="va">look</span><span class="op">,</span> <span class="va">in</span> <span class="va">the</span> <span class="va">file</span> <span class="va">after</span> <span class="va">the</span> <span class="va">second</span> <span class="va">Bad</span> <span class="va">Channel</span> <span class="va">Replacement</span> <span class="va">file</span><span class="op">,</span> <span class="va">at</span> <span class="va">each</span> <span class="va">trial</span> <span class="va">that</span> <span class="va">was</span> <span class="va">marked</span> <span class="va">as</span> <span class="va">bad</span>.</span>
<span id="cb77-2130"><a href="#cb77-2130" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">If</span> <span class="va">a</span> <span class="va">trial</span> <span class="va">was</span> <span class="va">clearly</span> <span class="va">bad</span> (<span class="va">many</span> <span class="va">artifacts</span> <span class="va">across</span> <span class="va">many</span> <span class="va">channels</span>) <span class="va">and</span> <span class="va">correctly</span> <span class="va">marked</span> <span class="va">as</span> <span class="va">bad</span><span class="op">,</span> <span class="va">leave</span> <span class="va">it</span> <span class="va">alone</span>.</span>
<span id="cb77-2131"><a href="#cb77-2131" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">If</span> <span class="va">a</span> <span class="va">trial</span> <span class="va">was</span> <span class="va">marked</span> <span class="va">as</span> <span class="va">bad</span> <span class="va">but</span> <span class="va">appeared</span> <span class="va">to</span> <span class="va">have</span> <span class="va">only</span> <span class="va">a</span> <span class="va">few</span> <span class="va">bad</span> <span class="va">channels</span> (<span class="va">i</span>.<span class="va">e</span>.<span class="op">,</span> <span class="va">only</span> <span class="va">a</span> <span class="va">few</span> <span class="va">bad</span> <span class="va">channels</span> <span class="va">led</span> <span class="va">it</span> <span class="va">to</span> <span class="va">be</span> <span class="va">marked</span> <span class="va">as</span> <span class="va">bad</span>)<span class="op">,</span> <span class="va">then</span> <span class="va">it</span> <span class="va">can</span> <span class="va">be</span> <span class="va">helpful</span> <span class="va">to</span> <span class="va">mark</span> <span class="va">those</span> <span class="va">channels</span> <span class="va">as</span> <span class="va">bad</span> <span class="kw">for</span> <span class="va">that</span> <span class="va">individual</span> <span class="va">segment</span> (<span class="va">rather</span> <span class="va">than</span> <span class="va">marking</span> <span class="va">the</span> <span class="va">channel</span> <span class="va">as</span> <span class="va">bad</span> <span class="va">across</span> <span class="va">all</span> <span class="va">segments</span><span class="op">---</span><span class="va">unless</span> <span class="va">the</span> <span class="va">channel</span> <span class="va">is</span> <span class="va">bad</span> <span class="va">across</span> <span class="va">many</span> <span class="va">segments</span>)</span>
<span id="cb77-2132"><a href="#cb77-2132" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">In</span> <span class="va">NetStation</span> <span class="va">Review</span><span class="op">,</span> <span class="va">open</span> <span class="va">each</span> <span class="va">file</span> <span class="va">after</span> <span class="va">the</span> <span class="va">Averaging</span> <span class="va">step</span></span>
<span id="cb77-2133"><a href="#cb77-2133" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">If</span> <span class="va">there</span> <span class="va">are</span> <span class="kw">continue</span> <span class="va">to</span> <span class="va">be</span> <span class="va">channels</span> <span class="va">that</span> <span class="va">look</span> <span class="va">bad</span><span class="op">,</span> <span class="va">go</span> <span class="va">back</span> <span class="va">to</span> <span class="va">Step</span> <span class="fl">2</span> <span class="va">and</span> <span class="va">proceed</span> <span class="va">from</span> <span class="va">there</span></span>
<span id="cb77-2134"><a href="#cb77-2134" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">In</span> <span class="va">Step</span> <span class="fl">2</span><span class="op">,</span> <span class="va">mark</span> <span class="va">those</span> <span class="va">channel</span>(<span class="va">s</span>) <span class="va">as</span> <span class="va">bad</span> <span class="va">across</span> <span class="va">all</span> <span class="va">segments</span></span>
<span id="cb77-2135"><a href="#cb77-2135" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Repeat</span> <span class="va">process</span> <span class="va">until</span> <span class="va">there</span> <span class="va">are</span> <span class="va">no</span> <span class="va">more</span> <span class="va">bad</span> <span class="va">channels</span> <span class="va">after</span> <span class="va">Script</span> <span class="fl">2</span></span>
<span id="cb77-2136"><a href="#cb77-2136" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">For</span> <span class="va">files</span> <span class="va">that</span> <span class="va">have</span> <span class="va">at</span> <span class="va">least</span> <span class="fl">10</span> <span class="va">good</span> <span class="va">trials</span> <span class="va">in</span> <span class="va">each</span> <span class="va">condition</span><span class="op">,</span> <span class="va">copy</span> <span class="va">and</span> <span class="va">paste</span> (<span class="va">don</span>’<span class="va">t</span> <span class="va">cut</span><span class="op">/</span><span class="va">move</span><span class="bn">!) their file from the “10-Baseline Correction (blc)” folder into the “11-Files for PCA” folder</span></span>
<span id="cb77-2137"><a href="#cb77-2137" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Run</span> <span class="va">the</span> <span class="va">temporo</span><span class="op">-</span><span class="va">spatial</span> <span class="va">PCA</span> <span class="va">on</span> <span class="va">those</span> <span class="va">files</span> <span class="kw">for</span> <span class="va">data</span> <span class="va">reduction</span> </span>
<span id="cb77-2138"><a href="#cb77-2138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2139"><a href="#cb77-2139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2140"><a href="#cb77-2140" aria-hidden="true" tabindex="-1"></a>### <span class="va">Notes</span></span>
<span id="cb77-2141"><a href="#cb77-2141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2142"><a href="#cb77-2142" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="va">u</span><span class="op">&gt;</span><span class="va">Options</span> <span class="kw">for</span> <span class="va">removing</span> <span class="va">bad</span> <span class="va">segments</span><span class="op">:&lt;/</span><span class="va">u</span><span class="op">&gt;</span></span>
<span id="cb77-2143"><a href="#cb77-2143" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">The</span> <span class="va">combine</span> <span class="va">files</span> <span class="va">tool</span> <span class="va">has</span> <span class="va">an</span> <span class="va">exclude</span> <span class="va">bad</span> <span class="va">trials</span> <span class="va">checkbox</span>. <span class="va">If</span> <span class="va">you</span> <span class="va">run</span> <span class="va">this</span> <span class="va">tool</span> <span class="va">on</span> <span class="va">only</span> <span class="va">one</span> <span class="va">file</span><span class="op">,</span> <span class="va">it</span> <span class="va">is</span> <span class="va">considered</span> <span class="va">a</span> <span class="va">no</span><span class="op">-</span><span class="va">op</span><span class="op">,</span> <span class="va">the</span> <span class="va">intended</span> <span class="va">operation</span> <span class="va">is</span> <span class="va">not</span> <span class="va">done</span><span class="op">,</span> <span class="va">but</span> <span class="va">it</span> <span class="va">does</span> <span class="va">appear</span> <span class="va">to</span> <span class="va">remove</span> <span class="va">the</span> <span class="va">bad</span> <span class="va">segments</span>. <span class="va">You</span> <span class="va">would</span> <span class="va">have</span> <span class="va">to</span> <span class="va">do</span> <span class="va">this</span> <span class="va">one</span> <span class="va">run</span> <span class="va">per</span> <span class="va">file</span><span class="op">,</span> <span class="kw">if</span> <span class="va">there</span> <span class="va">are</span> <span class="va">multiple</span> <span class="va">files</span> <span class="va">in</span> <span class="va">the</span> <span class="va">input</span> <span class="va">subpane</span><span class="op">,</span> <span class="va">they</span> <span class="va">will</span> <span class="va">be</span> <span class="va">combined</span>.</span>
<span id="cb77-2144"><a href="#cb77-2144" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">In</span> <span class="va">the</span> <span class="va">Net</span> <span class="va">Station</span> <span class="va">File</span> <span class="va">Export</span> <span class="va">Tool</span><span class="op">,</span> <span class="va">there</span> <span class="va">is</span> <span class="va">a</span> <span class="va">checkbox</span> <span class="va">option</span> <span class="va">to</span> <span class="st">"Export only good segments"</span> <span class="va">when</span> <span class="va">exporting</span> <span class="va">to</span> <span class="va">both</span> <span class="va">the</span> <span class="va">MAT</span> <span class="va">format</span><span class="op">,</span> <span class="va">and</span> <span class="va">also</span> <span class="va">when</span> <span class="va">exporting</span> <span class="va">to</span> <span class="va">Simple</span> <span class="va">Binary</span> (<span class="va">RAW</span>) <span class="va">format</span>.</span>
<span id="cb77-2145"><a href="#cb77-2145" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">In</span> <span class="va">Net</span> <span class="va">Station</span> <span class="fl">5.3</span><span class="op">,</span> <span class="va">EGI</span> <span class="va">introduced</span> <span class="va">the</span> <span class="va">workflow</span> <span class="va">concept</span> <span class="va">into</span> <span class="va">Net</span> <span class="va">Station</span> <span class="va">Review</span>. <span class="va">The</span> <span class="va">first</span> <span class="va">workflow</span> <span class="va">is</span> <span class="va">combine</span> <span class="va">segment</span><span class="op">/</span><span class="va">categories</span>. <span class="va">This</span> <span class="va">workflow</span> <span class="va">allows</span> <span class="kw">for</span> <span class="va">shuffling</span> <span class="va">segments</span> <span class="va">around</span> <span class="va">between</span> <span class="va">categories</span>. <span class="va">It</span> <span class="va">is</span> <span class="va">quite</span> <span class="va">a</span> <span class="va">flexible</span> <span class="va">tool</span><span class="op">,</span> <span class="va">but</span> <span class="va">importantly</span> <span class="va">it</span> <span class="va">includes</span> <span class="va">a</span> <span class="st">"Remove Bad Segments"</span> <span class="va">button</span>. <span class="va">So</span><span class="op">,</span> <span class="va">you</span> <span class="va">could</span> <span class="va">do</span> <span class="va">a</span> <span class="va">no</span><span class="op">-</span><span class="va">op</span> <span class="va">as</span> <span class="va">far</span> <span class="va">as</span> <span class="va">changing</span> <span class="va">categories</span> <span class="va">but</span> <span class="va">write</span> <span class="va">out</span> <span class="va">a</span> <span class="va">MFF</span> <span class="va">with</span> <span class="va">the</span> <span class="va">bad</span> <span class="va">segments</span> <span class="va">excluded</span>.</span>
<span id="cb77-2146"><a href="#cb77-2146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2147"><a href="#cb77-2147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2148"><a href="#cb77-2148" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="va">u</span><span class="op">&gt;</span><span class="va">Options</span> <span class="kw">for</span> <span class="va">data</span> <span class="va">processing</span><span class="op">:&lt;/</span><span class="va">u</span><span class="op">&gt;</span></span>
<span id="cb77-2149"><a href="#cb77-2149" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Data</span> <span class="va">processing</span> <span class="va">in</span> <span class="va">Net</span> <span class="va">Station</span> → <span class="va">file</span> <span class="va">export</span> <span class="va">to</span> <span class="va">simple</span> <span class="va">binary</span> → <span class="va">PCA</span> <span class="va">in</span> <span class="va">ERP</span> <span class="va">PCA</span> <span class="va">Toolkit</span></span>
<span id="cb77-2150"><a href="#cb77-2150" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Data</span> <span class="va">processing</span> <span class="va">and</span> <span class="va">PCA</span> <span class="va">in</span> <span class="va">ERP</span> <span class="va">PCA</span> <span class="va">Toolkit</span></span>
<span id="cb77-2151"><a href="#cb77-2151" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Data</span> <span class="va">processing</span> <span class="va">in</span> <span class="va">EEGLab</span> → <span class="va">PCA</span> <span class="va">in</span> <span class="va">ERP</span> <span class="va">PCA</span> <span class="va">Toolkit</span></span>
<span id="cb77-2152"><a href="#cb77-2152" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Data</span> <span class="va">processing</span> <span class="va">in</span> <span class="va">MATLAB</span> <span class="va">using</span> <span class="va">scripts</span> → <span class="va">PCA</span> <span class="va">in</span> <span class="va">ERP</span> <span class="va">PCA</span> <span class="va">Toolkit</span></span>
<span id="cb77-2153"><a href="#cb77-2153" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Ryan</span> <span class="va">Priefer</span>’<span class="va">s</span> <span class="va">approach</span><span class="op">:</span></span>
<span id="cb77-2154"><a href="#cb77-2154" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Filter</span> <span class="va">in</span> <span class="va">EEGLab</span> → <span class="va">data</span> <span class="va">processing</span> <span class="va">and</span> <span class="va">PCA</span> <span class="va">in</span> <span class="va">ERP</span> <span class="va">PCA</span> <span class="va">Toolkit</span><span class="op">:</span> <span class="va">segment</span><span class="op">,</span> <span class="va">artifact</span> <span class="va">detection</span><span class="op">/</span><span class="va">bad</span> <span class="va">channel</span> <span class="va">replacement</span><span class="op">,</span> <span class="va">montage</span> <span class="va">re</span><span class="op">-</span><span class="va">reference</span><span class="op">/</span><span class="va">baseline</span> <span class="va">correct</span><span class="op">,</span> <span class="va">average</span><span class="op">,</span> <span class="va">then</span> <span class="va">export</span> <span class="va">to</span> .<span class="va">txt</span> <span class="va">file</span> <span class="va">and</span> <span class="va">PCA</span></span>
<span id="cb77-2155"><a href="#cb77-2155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2156"><a href="#cb77-2156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2157"><a href="#cb77-2157" aria-hidden="true" tabindex="-1"></a>### <span class="va">Waveform</span> <span class="va">Tools</span></span>
<span id="cb77-2158"><a href="#cb77-2158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2159"><a href="#cb77-2159" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Filtering</span></span>
<span id="cb77-2160"><a href="#cb77-2160" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Highpass</span><span class="op">:</span> <span class="fl">0.1</span> <span class="va">Hz</span></span>
<span id="cb77-2161"><a href="#cb77-2161" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Lowpass</span><span class="op">:</span> <span class="fl">30.0</span> <span class="va">Hz</span></span>
<span id="cb77-2162"><a href="#cb77-2162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2163"><a href="#cb77-2163" aria-hidden="true" tabindex="-1"></a>   <span class="bn">![](images/filteringNetStation.png)</span></span>
<span id="cb77-2164"><a href="#cb77-2164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2165"><a href="#cb77-2165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2166"><a href="#cb77-2166" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Segmentation</span></span>
<span id="cb77-2167"><a href="#cb77-2167" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Oddball</span></span>
<span id="cb77-2168"><a href="#cb77-2168" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Frequent</span><span class="op">:</span> </span>
<span id="cb77-2169"><a href="#cb77-2169" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">frq</span><span class="op">+</span>`</span>
<span id="cb77-2170"><a href="#cb77-2170" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Target</span><span class="op">:</span> </span>
<span id="cb77-2171"><a href="#cb77-2171" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">tgt</span><span class="op">+</span>`</span>
<span id="cb77-2172"><a href="#cb77-2172" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="op">**</span><span class="va">Options</span><span class="op">**:</span></span>
<span id="cb77-2173"><a href="#cb77-2173" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Segment</span> <span class="va">length</span> <span class="va">before</span><span class="op">:</span> <span class="fl">200</span><span class="va">ms</span> (<span class="va">baseline</span> <span class="va">length</span>)</span>
<span id="cb77-2174"><a href="#cb77-2174" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Segment</span> <span class="va">length</span> <span class="va">after</span><span class="op">:</span> <span class="fl">1000</span><span class="va">ms</span> (<span class="va">post</span><span class="op">-</span><span class="va">stimulus</span> <span class="va">length</span>)</span>
<span id="cb77-2175"><a href="#cb77-2175" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Offset</span><span class="op">:</span> <span class="fl">2</span><span class="va">ms</span> </span>
<span id="cb77-2176"><a href="#cb77-2176" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Check</span> <span class="st">"Copy specs to Segment"</span></span>
<span id="cb77-2177"><a href="#cb77-2177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2178"><a href="#cb77-2178" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/oddballSegmentingNetStation_frq.png)</span></span>
<span id="cb77-2179"><a href="#cb77-2179" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/oddballSegmentingNetStation_tgt.png)</span></span>
<span id="cb77-2180"><a href="#cb77-2180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2181"><a href="#cb77-2181" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Fishsharks</span></span>
<span id="cb77-2182"><a href="#cb77-2182" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Correct</span> <span class="va">go</span><span class="op">:</span></span>
<span id="cb77-2183"><a href="#cb77-2183" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">Go</span><span class="op">++</span>`</span>
<span id="cb77-2184"><a href="#cb77-2184" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Trial</span> <span class="va">Spec</span> <span class="va">eval</span> <span class="va">is</span> <span class="fl">1</span></span>
<span id="cb77-2185"><a href="#cb77-2185" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Trial</span> <span class="va">Spec</span> <span class="va">rtim</span> <span class="va">is</span> <span class="va">greater</span> <span class="va">than</span> <span class="va">or</span> <span class="va">equal</span> <span class="va">to</span> <span class="fl">200</span></span>
<span id="cb77-2186"><a href="#cb77-2186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2187"><a href="#cb77-2187" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/fishSharkSegmentingNetStation_cGo.png)</span></span>
<span id="cb77-2188"><a href="#cb77-2188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2189"><a href="#cb77-2189" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Correct</span> <span class="va">no</span><span class="op">-</span><span class="va">go</span><span class="op">:</span></span>
<span id="cb77-2190"><a href="#cb77-2190" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">NG</span><span class="op">++</span>`</span>
<span id="cb77-2191"><a href="#cb77-2191" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Trial</span> <span class="va">Spec</span> <span class="va">eval</span> <span class="va">is</span> <span class="fl">0</span></span>
<span id="cb77-2192"><a href="#cb77-2192" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-2193"><a href="#cb77-2193" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/fishSharkSegmentingNetStation_cNg.png)</span></span>
<span id="cb77-2194"><a href="#cb77-2194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2195"><a href="#cb77-2195" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Incorrect</span> <span class="va">go</span><span class="op">:</span></span>
<span id="cb77-2196"><a href="#cb77-2196" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">Go</span><span class="op">++</span>`</span>
<span id="cb77-2197"><a href="#cb77-2197" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Trial</span> <span class="va">Spec</span> <span class="va">eval</span> <span class="va">is</span> <span class="fl">0</span> <span class="op">**</span><span class="va">or</span><span class="op">**</span> <span class="va">Trial</span> <span class="va">Spec</span> <span class="va">rtim</span> <span class="va">is</span> <span class="va">less</span> <span class="va">than</span> <span class="fl">200</span></span>
<span id="cb77-2198"><a href="#cb77-2198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2199"><a href="#cb77-2199" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/fishSharkSegmentingNetStation_xGo.png)</span></span>
<span id="cb77-2200"><a href="#cb77-2200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2201"><a href="#cb77-2201" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Incorrect</span> <span class="va">no</span><span class="op">-</span><span class="va">go</span><span class="op">:</span></span>
<span id="cb77-2202"><a href="#cb77-2202" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">NG</span><span class="op">++</span>`</span>
<span id="cb77-2203"><a href="#cb77-2203" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Trial</span> <span class="va">Spec</span> <span class="va">eval</span> <span class="va">is</span> <span class="fl">1</span></span>
<span id="cb77-2204"><a href="#cb77-2204" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-2205"><a href="#cb77-2205" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/fishSharkSegmentingNetStation_xNg.png)</span></span>
<span id="cb77-2206"><a href="#cb77-2206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2207"><a href="#cb77-2207" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">All</span> <span class="va">go</span><span class="op">:</span></span>
<span id="cb77-2208"><a href="#cb77-2208" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">Go</span><span class="op">++</span>`</span>
<span id="cb77-2209"><a href="#cb77-2209" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-2210"><a href="#cb77-2210" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/fishSharkSegmentingNetStation_allGo.png)</span></span>
<span id="cb77-2211"><a href="#cb77-2211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2212"><a href="#cb77-2212" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">All</span> <span class="va">no</span><span class="op">-</span><span class="va">go</span><span class="op">:</span></span>
<span id="cb77-2213"><a href="#cb77-2213" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">NG</span><span class="op">++</span>`</span>
<span id="cb77-2214"><a href="#cb77-2214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2215"><a href="#cb77-2215" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/fishSharkSegmentingNetStation_allNg.png)</span></span>
<span id="cb77-2216"><a href="#cb77-2216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2217"><a href="#cb77-2217" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="op">**</span><span class="va">Options</span><span class="op">**:</span></span>
<span id="cb77-2218"><a href="#cb77-2218" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Segment</span> <span class="va">length</span> <span class="va">before</span><span class="op">:</span> <span class="fl">200</span><span class="va">ms</span></span>
<span id="cb77-2219"><a href="#cb77-2219" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Segment</span> <span class="va">length</span> <span class="va">after</span><span class="op">:</span> <span class="fl">1000</span><span class="va">ms</span></span>
<span id="cb77-2220"><a href="#cb77-2220" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Offset</span><span class="op">:</span> <span class="fl">17</span><span class="va">ms</span></span>
<span id="cb77-2221"><a href="#cb77-2221" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Stop</span><span class="op">-</span><span class="va">signal</span></span>
<span id="cb77-2222"><a href="#cb77-2222" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Go</span> <span class="op">-</span> <span class="va">correct</span> <span class="va">response</span></span>
<span id="cb77-2223"><a href="#cb77-2223" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">GoCR</span>` <span class="op">**</span><span class="va">or</span><span class="op">**</span> `<span class="va">NGGC</span>`</span>
<span id="cb77-2224"><a href="#cb77-2224" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span> <span class="va">Trial</span> <span class="va">Spec</span> <span class="va">rtim</span> <span class="va">is</span> <span class="va">greater</span> <span class="va">than</span> <span class="va">or</span> <span class="va">equal</span> <span class="va">to</span> <span class="fl">200</span></span>
<span id="cb77-2225"><a href="#cb77-2225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2226"><a href="#cb77-2226" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/stopSignalSegmentingNetStation_crGo.png)</span></span>
<span id="cb77-2227"><a href="#cb77-2227" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-2228"><a href="#cb77-2228" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Go</span> <span class="op">-</span> <span class="va">incorrect</span> <span class="va">response</span></span>
<span id="cb77-2229"><a href="#cb77-2229" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">GoIn</span>` <span class="op">**</span><span class="va">or</span><span class="op">**</span> `<span class="va">NGGI</span>`</span>
<span id="cb77-2230"><a href="#cb77-2230" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-2231"><a href="#cb77-2231" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/stopSignalSegmentingNetStation_xrGo.png)</span></span>
<span id="cb77-2232"><a href="#cb77-2232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2233"><a href="#cb77-2233" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Go</span> <span class="op">-</span> <span class="va">omission</span> <span class="va">error</span></span>
<span id="cb77-2234"><a href="#cb77-2234" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">GoOm</span>`</span>
<span id="cb77-2235"><a href="#cb77-2235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2236"><a href="#cb77-2236" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/stopSignalSegmentingNetStation_oeGo.png)</span></span>
<span id="cb77-2237"><a href="#cb77-2237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2238"><a href="#cb77-2238" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">NoGo</span> <span class="op">-</span> <span class="va">correct</span></span>
<span id="cb77-2239"><a href="#cb77-2239" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">NNCR</span>`</span>
<span id="cb77-2240"><a href="#cb77-2240" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-2241"><a href="#cb77-2241" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/stopSignalSegmentingNetStation_cNG.png)</span></span>
<span id="cb77-2242"><a href="#cb77-2242" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-2243"><a href="#cb77-2243" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">NoGo</span> <span class="op">-</span> <span class="va">incorrect</span></span>
<span id="cb77-2244"><a href="#cb77-2244" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">NNCC</span>` <span class="op">**</span><span class="va">or</span><span class="op">**</span> `<span class="va">NNCI</span>`</span>
<span id="cb77-2245"><a href="#cb77-2245" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-2246"><a href="#cb77-2246" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/stopSignalSegmentingNetStation_xNG.png)</span></span>
<span id="cb77-2247"><a href="#cb77-2247" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-2248"><a href="#cb77-2248" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">NoGo</span> <span class="op">-</span> <span class="va">incorrect</span><span class="op">:</span> <span class="va">correct</span> <span class="va">E</span></span>
<span id="cb77-2249"><a href="#cb77-2249" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">NNCC</span>`</span>
<span id="cb77-2250"><a href="#cb77-2250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2251"><a href="#cb77-2251" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/stopSignalSegmentingNetStation_xceNG.png)   </span></span>
<span id="cb77-2252"><a href="#cb77-2252" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-2253"><a href="#cb77-2253" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">NoGo</span> <span class="op">-</span> <span class="va">incorrect</span><span class="op">:</span> <span class="va">incorrect</span> <span class="va">E</span></span>
<span id="cb77-2254"><a href="#cb77-2254" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">NNCI</span>`</span>
<span id="cb77-2255"><a href="#cb77-2255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2256"><a href="#cb77-2256" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/stopSignalSegmentingNetStation_xxeNG.png)</span></span>
<span id="cb77-2257"><a href="#cb77-2257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2258"><a href="#cb77-2258" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">All</span> <span class="va">go</span><span class="op">:</span></span>
<span id="cb77-2259"><a href="#cb77-2259" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">CoGR</span>` <span class="op">**</span><span class="va">or</span><span class="op">**</span> `<span class="va">GoOm</span>` <span class="op">**</span><span class="va">or</span><span class="op">**</span> `<span class="va">GoIn</span>` <span class="op">**</span><span class="va">or</span><span class="op">**</span> `<span class="va">NGGC</span>`</span>
<span id="cb77-2260"><a href="#cb77-2260" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-2261"><a href="#cb77-2261" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/stopSignalSegmentingNetStation_allGo.png)</span></span>
<span id="cb77-2262"><a href="#cb77-2262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2263"><a href="#cb77-2263" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">All</span> <span class="va">no</span><span class="op">-</span><span class="va">go</span><span class="op">:</span></span>
<span id="cb77-2264"><a href="#cb77-2264" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">NNCR</span>` <span class="op">**</span><span class="va">or</span><span class="op">**</span> `<span class="va">NNCC</span>` <span class="op">**</span><span class="va">or</span><span class="op">**</span> `<span class="va">NNCI</span>`</span>
<span id="cb77-2265"><a href="#cb77-2265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2266"><a href="#cb77-2266" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/stopSignalSegmentingNetStation_allNG.png)</span></span>
<span id="cb77-2267"><a href="#cb77-2267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2268"><a href="#cb77-2268" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Response</span><span class="op">-</span><span class="va">locked</span> <span class="va">correct</span> <span class="va">go</span></span>
<span id="cb77-2269"><a href="#cb77-2269" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">rcor</span>`</span>
<span id="cb77-2270"><a href="#cb77-2270" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Key</span> <span class="va">code</span> `<span class="va">cel</span>#` <span class="va">is</span> <span class="fl">3</span></span>
<span id="cb77-2271"><a href="#cb77-2271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2272"><a href="#cb77-2272" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/stopSignalSegmentingNetStation_rlcGo.png)</span></span>
<span id="cb77-2273"><a href="#cb77-2273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2274"><a href="#cb77-2274" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Response</span><span class="op">-</span><span class="va">locked</span> <span class="va">incorrect</span> <span class="va">stop</span></span>
<span id="cb77-2275"><a href="#cb77-2275" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">resp</span>`</span>
<span id="cb77-2276"><a href="#cb77-2276" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Key</span> <span class="va">Code</span> `<span class="va">cel</span>#` <span class="va">is</span> <span class="fl">4</span></span>
<span id="cb77-2277"><a href="#cb77-2277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2278"><a href="#cb77-2278" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/stopSignalSegmentingNetStation_rlxNG.png)</span></span>
<span id="cb77-2279"><a href="#cb77-2279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2280"><a href="#cb77-2280" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Response</span><span class="op">-</span><span class="va">locked</span> <span class="va">incorrect</span> <span class="va">go</span></span>
<span id="cb77-2281"><a href="#cb77-2281" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Code</span> <span class="va">is</span> `<span class="va">rinc</span>`</span>
<span id="cb77-2282"><a href="#cb77-2282" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Key</span> <span class="va">Code</span> `<span class="va">cel</span>#` <span class="va">is</span> <span class="fl">3</span></span>
<span id="cb77-2283"><a href="#cb77-2283" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-2284"><a href="#cb77-2284" aria-hidden="true" tabindex="-1"></a>      <span class="bn">![](images/stopSignalSegmentingNetStation_rlxGo.png)</span></span>
<span id="cb77-2285"><a href="#cb77-2285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2286"><a href="#cb77-2286" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="op">**</span><span class="va">Options</span><span class="op">**:</span></span>
<span id="cb77-2287"><a href="#cb77-2287" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Segment</span> <span class="va">length</span> <span class="va">before</span><span class="op">:</span> <span class="fl">200</span><span class="va">ms</span></span>
<span id="cb77-2288"><a href="#cb77-2288" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Segment</span> <span class="va">length</span> <span class="va">after</span><span class="op">:</span> <span class="fl">1000</span><span class="va">ms</span></span>
<span id="cb77-2289"><a href="#cb77-2289" aria-hidden="true" tabindex="-1"></a>         <span class="op">-</span> <span class="va">Offset</span><span class="op">:</span> <span class="fl">16</span><span class="va">ms</span></span>
<span id="cb77-2290"><a href="#cb77-2290" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> <span class="va">Note</span><span class="op">:</span> <span class="kw">for</span> <span class="st">"response locked"</span><span class="op">,</span> <span class="va">offset</span> <span class="va">is</span> <span class="fl">0</span><span class="va">ms</span></span>
<span id="cb77-2291"><a href="#cb77-2291" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Manually</span> <span class="va">prcoess</span> <span class="va">data</span> </span>
<span id="cb77-2292"><a href="#cb77-2292" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Bad</span> <span class="va">channel</span> <span class="va">replacement</span></span>
<span id="cb77-2293"><a href="#cb77-2293" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Prior</span> <span class="va">to</span> <span class="va">running</span><span class="op">,</span> <span class="va">select</span> <span class="va">bad</span> <span class="va">channels</span> <span class="va">manually</span></span>
<span id="cb77-2294"><a href="#cb77-2294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2295"><a href="#cb77-2295" aria-hidden="true" tabindex="-1"></a>   <span class="bn">![](images/badChannelReplacementNetStation.png)</span></span>
<span id="cb77-2296"><a href="#cb77-2296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2297"><a href="#cb77-2297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2298"><a href="#cb77-2298" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Artifact</span> <span class="va">detection</span></span>
<span id="cb77-2299"><a href="#cb77-2299" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Bad</span> <span class="va">channels</span><span class="op">:</span> </span>
<span id="cb77-2300"><a href="#cb77-2300" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Max</span> <span class="op">-</span> <span class="va">min</span> <span class="op">&gt;</span> <span class="fl">200.00</span> <span class="va">uv</span></span>
<span id="cb77-2301"><a href="#cb77-2301" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Entire</span> <span class="va">segment</span></span>
<span id="cb77-2302"><a href="#cb77-2302" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Moving</span> <span class="va">average</span><span class="op">:</span> <span class="fl">80</span><span class="va">ms</span></span>
<span id="cb77-2303"><a href="#cb77-2303" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Eye</span> <span class="va">blink</span><span class="op">:</span></span>
<span id="cb77-2304"><a href="#cb77-2304" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Max</span> <span class="op">-</span> <span class="va">min</span> <span class="op">&gt;</span> <span class="fl">175.00</span> <span class="va">uv</span></span>
<span id="cb77-2305"><a href="#cb77-2305" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Window</span> <span class="va">size</span><span class="op">:</span> <span class="fl">640</span><span class="va">ms</span></span>
<span id="cb77-2306"><a href="#cb77-2306" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Moving</span> <span class="va">average</span><span class="op">:</span> <span class="fl">80</span><span class="va">ms</span></span>
<span id="cb77-2307"><a href="#cb77-2307" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Eye</span> <span class="va">movement</span><span class="op">:</span></span>
<span id="cb77-2308"><a href="#cb77-2308" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Max</span> <span class="op">-</span> <span class="va">min</span> <span class="op">&gt;</span> <span class="fl">200.00</span> <span class="va">uv</span></span>
<span id="cb77-2309"><a href="#cb77-2309" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Window</span> <span class="va">size</span><span class="op">:</span> <span class="fl">640</span><span class="va">ms</span></span>
<span id="cb77-2310"><a href="#cb77-2310" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Moving</span> <span class="va">average</span><span class="op">:</span> <span class="fl">80</span><span class="va">ms</span></span>
<span id="cb77-2311"><a href="#cb77-2311" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Mark</span> <span class="va">channel</span> <span class="va">bad</span> <span class="kw">for</span> <span class="va">all</span> <span class="va">sefments</span> <span class="kw">if</span> <span class="va">bad</span> <span class="kw">for</span> <span class="va">greater</span> <span class="va">than</span><span class="op">:</span> <span class="fl">20</span><span class="co">% of segments</span></span>
<span id="cb77-2312"><a href="#cb77-2312" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Mark</span> <span class="va">segment</span> <span class="va">bad</span> <span class="kw">if</span> <span class="va">it</span><span class="op">:</span></span>
<span id="cb77-2313"><a href="#cb77-2313" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Contains</span> <span class="va">more</span> <span class="va">than</span> <span class="fl">20</span> <span class="va">bad</span> <span class="va">channels</span></span>
<span id="cb77-2314"><a href="#cb77-2314" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Contains</span> <span class="va">an</span> <span class="va">eyeblink</span> (<span class="va">remove</span> <span class="kw">if</span> <span class="va">doing</span> <span class="va">ocular</span> <span class="va">artifact</span> <span class="va">removal</span>)</span>
<span id="cb77-2315"><a href="#cb77-2315" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">Contains</span> <span class="va">an</span> <span class="va">eye</span> <span class="va">movement</span> (<span class="va">remove</span> <span class="kw">if</span> <span class="va">doing</span> <span class="va">ocular</span> <span class="va">artifact</span> <span class="va">removal</span>)</span>
<span id="cb77-2316"><a href="#cb77-2316" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Overwrite</span> <span class="va">all</span> <span class="va">previous</span> <span class="va">bad</span> <span class="va">Segment</span> <span class="va">information</span></span>
<span id="cb77-2317"><a href="#cb77-2317" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Overwrite</span> <span class="va">all</span> <span class="va">previous</span> <span class="va">bad</span> <span class="va">Channel</span> <span class="va">information</span></span>
<span id="cb77-2318"><a href="#cb77-2318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2319"><a href="#cb77-2319" aria-hidden="true" tabindex="-1"></a>   <span class="bn">![](images/artifactDetectionNetStation.png)</span></span>
<span id="cb77-2320"><a href="#cb77-2320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2321"><a href="#cb77-2321" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Bad</span> <span class="va">channel</span> <span class="va">replacement</span></span>
<span id="cb77-2322"><a href="#cb77-2322" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Same</span> <span class="va">as</span> <span class="va">step</span> <span class="fl">4</span></span>
<span id="cb77-2323"><a href="#cb77-2323" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Specification</span> <span class="va">name</span><span class="op">:</span> <span class="va">Oddball</span> <span class="fl">06</span>. <span class="va">Bad</span> <span class="va">Channel</span> <span class="va">Replacement</span></span>
<span id="cb77-2324"><a href="#cb77-2324" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Artifact</span> <span class="va">detection</span></span>
<span id="cb77-2325"><a href="#cb77-2325" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Same</span> <span class="va">as</span> <span class="va">step</span> <span class="fl">5</span></span>
<span id="cb77-2326"><a href="#cb77-2326" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Averaging</span></span>
<span id="cb77-2327"><a href="#cb77-2327" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Handle</span> <span class="va">source</span> <span class="va">files</span><span class="op">:</span> <span class="va">Separately</span></span>
<span id="cb77-2328"><a href="#cb77-2328" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Handle</span> <span class="va">subjects</span><span class="op">:</span> <span class="va">Separately</span></span>
<span id="cb77-2329"><a href="#cb77-2329" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="va">To</span> <span class="va">create</span> <span class="va">final</span> <span class="va">merge</span> <span class="va">file</span> <span class="kw">for</span> <span class="va">one</span> <span class="va">ERP</span> <span class="kw">for</span> <span class="va">whole</span> <span class="va">sample</span> (<span class="va">i</span>.<span class="va">e</span>.<span class="op">,</span> <span class="va">grand</span> <span class="va">average</span> <span class="op">--</span> <span class="kw">for</span> <span class="va">graphing</span> <span class="va">purposes</span> <span class="va">only</span><span class="op">,</span> <span class="va">not</span> <span class="va">analysis</span> <span class="op">--</span> <span class="va">select</span> <span class="st">"Together"</span> <span class="kw">for</span> <span class="va">each</span>)</span>
<span id="cb77-2330"><a href="#cb77-2330" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Do</span> <span class="op">**</span><span class="va">not</span><span class="op">**</span> <span class="va">compute</span> <span class="va">noise</span> <span class="va">estimate</span></span>
<span id="cb77-2331"><a href="#cb77-2331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2332"><a href="#cb77-2332" aria-hidden="true" tabindex="-1"></a>   <span class="bn">![](images/averagingNetStation.png)</span></span>
<span id="cb77-2333"><a href="#cb77-2333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2334"><a href="#cb77-2334" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Montage</span> <span class="va">options</span></span>
<span id="cb77-2335"><a href="#cb77-2335" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Average</span> <span class="va">reference</span></span>
<span id="cb77-2336"><a href="#cb77-2336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2337"><a href="#cb77-2337" aria-hidden="true" tabindex="-1"></a>   <span class="bn">![](images/averageReferenceNetStation.png)</span></span>
<span id="cb77-2338"><a href="#cb77-2338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2339"><a href="#cb77-2339" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Baseline</span> <span class="va">correction</span></span>
<span id="cb77-2340"><a href="#cb77-2340" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Sample</span> <span class="va">baseline</span> <span class="va">with</span> <span class="va">respect</span> <span class="va">to</span><span class="op">:</span> <span class="va">segment</span> <span class="va">time</span> <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb77-2341"><a href="#cb77-2341" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Baseline</span> <span class="va">begins</span><span class="op">:</span> <span class="fl">200</span><span class="va">ms</span> (<span class="va">length</span> <span class="va">of</span> <span class="va">baseline</span>) <span class="va">before</span> <span class="va">sample</span> <span class="va">and</span> <span class="va">is</span> <span class="fl">200</span><span class="va">ms</span> (<span class="va">length</span> <span class="va">of</span> <span class="va">baseline</span>) <span class="va">long</span></span>
<span id="cb77-2342"><a href="#cb77-2342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2343"><a href="#cb77-2343" aria-hidden="true" tabindex="-1"></a>   <span class="bn">![](images/baselineCorrectionNetStation.png)</span></span>
<span id="cb77-2344"><a href="#cb77-2344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2345"><a href="#cb77-2345" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Combine</span> <span class="va">files</span> (<span class="va">using</span> <span class="va">the</span> <span class="va">Averaging</span> <span class="va">Tool</span>)</span>
<span id="cb77-2346"><a href="#cb77-2346" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Handle</span> <span class="va">source</span> <span class="va">files</span><span class="op">:</span> <span class="va">Together</span></span>
<span id="cb77-2347"><a href="#cb77-2347" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Handle</span> <span class="va">subjects</span><span class="op">:</span> <span class="va">Separately</span></span>
<span id="cb77-2348"><a href="#cb77-2348" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Do</span> <span class="op">**</span><span class="va">not</span><span class="op">**</span> <span class="va">compute</span> <span class="va">noise</span> <span class="va">estimate</span></span>
<span id="cb77-2349"><a href="#cb77-2349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2350"><a href="#cb77-2350" aria-hidden="true" tabindex="-1"></a>   <span class="bn">![](images/combineFilesNetStation.png)</span></span>
<span id="cb77-2351"><a href="#cb77-2351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2352"><a href="#cb77-2352" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">File</span> <span class="va">Export</span></span>
<span id="cb77-2353"><a href="#cb77-2353" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Simple</span> <span class="va">binary</span></span>
<span id="cb77-2354"><a href="#cb77-2354" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Calibrate</span> <span class="va">data</span></span>
<span id="cb77-2355"><a href="#cb77-2355" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Export</span> <span class="va">calibration</span> <span class="va">information</span></span>
<span id="cb77-2356"><a href="#cb77-2356" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Export</span> <span class="va">history</span> <span class="va">information</span></span>
<span id="cb77-2357"><a href="#cb77-2357" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Export</span> <span class="va">reference</span> <span class="va">channel</span></span>
<span id="cb77-2358"><a href="#cb77-2358" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Export</span> <span class="va">only</span> <span class="va">good</span> <span class="va">segments</span> (<span class="kw">if</span> <span class="va">not</span> <span class="va">doing</span> <span class="va">data</span> <span class="va">processing</span> <span class="va">in</span> <span class="va">othe</span> <span class="va">software</span>)</span>
<span id="cb77-2359"><a href="#cb77-2359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2360"><a href="#cb77-2360" aria-hidden="true" tabindex="-1"></a>   <span class="bn">![](images/fileExportNetStation_1.png)</span></span>
<span id="cb77-2361"><a href="#cb77-2361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2362"><a href="#cb77-2362" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">Grand</span> <span class="va">averaging</span></span>
<span id="cb77-2363"><a href="#cb77-2363" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Handle</span> <span class="va">source</span> <span class="va">files</span><span class="op">:</span> <span class="va">Together</span></span>
<span id="cb77-2364"><a href="#cb77-2364" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Handle</span> <span class="va">subjects</span><span class="op">:</span> <span class="va">together</span></span>
<span id="cb77-2365"><a href="#cb77-2365" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Copy</span> <span class="kw">events</span> <span class="va">from</span> <span class="va">first</span> <span class="va">file</span></span>
<span id="cb77-2366"><a href="#cb77-2366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2367"><a href="#cb77-2367" aria-hidden="true" tabindex="-1"></a>   <span class="bn">![](images/grandAverageNetStation.png)</span></span>
<span id="cb77-2368"><a href="#cb77-2368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2369"><a href="#cb77-2369" aria-hidden="true" tabindex="-1"></a><span class="fl">1</span>. <span class="va">File</span> <span class="va">export</span></span>
<span id="cb77-2370"><a href="#cb77-2370" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Format</span><span class="op">:</span> <span class="va">Tab</span><span class="op">-</span><span class="va">delimited</span> <span class="va">text</span> (.<span class="va">txt</span>)</span>
<span id="cb77-2371"><a href="#cb77-2371" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Export</span> <span class="va">only</span> <span class="va">good</span> <span class="va">segments</span></span>
<span id="cb77-2372"><a href="#cb77-2372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2373"><a href="#cb77-2373" aria-hidden="true" tabindex="-1"></a>   <span class="bn">![](images/fileExportNetStation_2.png)</span></span>
<span id="cb77-2374"><a href="#cb77-2374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2375"><a href="#cb77-2375" aria-hidden="true" tabindex="-1"></a>### <span class="va">EEG</span> <span class="va">Behaviors</span> <span class="va">and</span> <span class="va">Bad</span> <span class="va">Channels</span> <span class="va">Form</span></span>
<span id="cb77-2376"><a href="#cb77-2376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2377"><a href="#cb77-2377" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="va">Indicate</span> <span class="va">which</span> <span class="va">channels</span> <span class="va">were</span> <span class="va">badd</span> <span class="va">across</span> <span class="op">**</span><span class="va">all</span><span class="op">**</span> <span class="va">trials</span> <span class="va">in</span> <span class="va">the</span> <span class="va">last</span> <span class="st">"bad channel replacement"</span> (<span class="va">bcr</span>) <span class="va">step</span> (<span class="va">Step</span> <span class="fl">6</span>)</span>
<span id="cb77-2378"><a href="#cb77-2378" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span> <span class="va">Include</span> <span class="va">tirals</span> <span class="va">that</span> <span class="va">were</span> <span class="va">marked</span> <span class="va">bad</span> (<span class="va">across</span> <span class="va">all</span> <span class="va">trials</span>) <span class="va">either</span> <span class="va">manually</span> <span class="va">or</span> <span class="va">automatically</span></span>
<span id="cb77-2379"><a href="#cb77-2379" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> <span class="va">Indicate</span> <span class="va">which</span> <span class="va">channels</span> <span class="va">were</span> <span class="va">manually</span> <span class="va">marked</span> <span class="va">bad</span> <span class="va">on</span> <span class="va">each</span> <span class="va">trial</span> <span class="kw">for</span> <span class="va">those</span> <span class="va">that</span> <span class="va">were</span> <span class="va">marked</span> <span class="va">bad</span> <span class="va">on</span> <span class="va">a</span> <span class="va">trial</span> <span class="va">by</span> <span class="va">trial</span> <span class="va">basis</span> (<span class="va">step</span> <span class="fl">3</span>)</span>
<span id="cb77-2380"><a href="#cb77-2380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2381"><a href="#cb77-2381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2382"><a href="#cb77-2382" aria-hidden="true" tabindex="-1"></a>### <span class="va">Troubleshooting</span> <span class="va">and</span> <span class="va">Q</span><span class="op">&amp;</span><span class="va">A</span></span>
<span id="cb77-2383"><a href="#cb77-2383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2384"><a href="#cb77-2384" aria-hidden="true" tabindex="-1"></a><span class="op">**</span><span class="va">Q</span><span class="op">:</span> <span class="va">How</span> <span class="va">do</span> <span class="va">I</span> <span class="va">mark</span> <span class="va">a</span> <span class="va">channel</span> <span class="va">as</span> <span class="va">bad</span> <span class="kw">for</span> <span class="va">an</span> <span class="va">individual</span> <span class="va">trial</span><span class="op">/</span><span class="va">segment</span>?<span class="op">**</span></span>
<span id="cb77-2385"><a href="#cb77-2385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2386"><a href="#cb77-2386" aria-hidden="true" tabindex="-1"></a><span class="va">A</span><span class="op">:</span> <span class="va">To</span> <span class="va">mark</span> <span class="va">an</span> <span class="va">individual</span> <span class="va">trial</span> <span class="va">bad</span> <span class="va">when</span> <span class="va">in</span> <span class="va">topoplot</span> <span class="va">mode</span><span class="op">,</span> <span class="va">make</span> <span class="va">sure</span> <span class="va">to</span> <span class="va">have</span> <span class="va">the</span> <span class="st">"Click to Change Channel Status"</span> <span class="va">checked</span> <span class="va">and</span> <span class="va">then</span> <span class="va">click</span> <span class="va">on</span> <span class="va">the</span> <span class="va">channel</span>.</span>
<span id="cb77-2387"><a href="#cb77-2387" aria-hidden="true" tabindex="-1"></a><span class="va">Click</span> <span class="va">again</span> <span class="va">to</span> <span class="va">make</span> <span class="va">it</span> <span class="va">good</span>.</span>
<span id="cb77-2388"><a href="#cb77-2388" aria-hidden="true" tabindex="-1"></a><span class="va">Hold</span> <span class="va">down</span> <span class="va">the</span> `<span class="va">Command</span>` <span class="va">key</span> <span class="va">to</span> <span class="va">make</span> <span class="va">it</span> <span class="va">good</span> <span class="va">or</span> <span class="va">bad</span> <span class="kw">for</span> <span class="va">the</span> <span class="va">whole</span> <span class="va">experiment</span>.</span>
<span id="cb77-2389"><a href="#cb77-2389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2390"><a href="#cb77-2390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2391"><a href="#cb77-2391" aria-hidden="true" tabindex="-1"></a><span class="op">**</span><span class="va">Q</span><span class="op">:</span> <span class="va">When</span> <span class="va">trying</span> <span class="va">to</span> <span class="va">do</span> <span class="va">some</span> <span class="va">batch</span> <span class="va">data</span> <span class="va">processing</span> <span class="va">in</span> <span class="va">NetStation</span> <span class="va">Tools</span><span class="op">,</span> <span class="va">I</span> <span class="va">received</span> <span class="va">an</span> <span class="va">error</span> <span class="va">when</span> <span class="va">trying</span> <span class="va">to</span> <span class="va">add</span> <span class="va">a</span> <span class="va">group</span> <span class="va">of</span> .<span class="va">mff</span> <span class="va">files</span> <span class="va">to</span> <span class="va">the</span> <span class="st">"Input Files"</span> <span class="va">box</span><span class="op">.**</span></span>
<span id="cb77-2392"><a href="#cb77-2392" aria-hidden="true" tabindex="-1"></a><span class="op">**</span><span class="va">The</span> <span class="va">error</span> <span class="va">says</span> <span class="st">"Blue files are open in review. In order to process these files, they need to be closed in Review fist"</span><span class="op">**</span></span>
<span id="cb77-2393"><a href="#cb77-2393" aria-hidden="true" tabindex="-1"></a><span class="op">**</span><span class="va">What</span> <span class="va">can</span> <span class="va">I</span> <span class="va">do</span>?<span class="op">**</span></span>
<span id="cb77-2394"><a href="#cb77-2394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2395"><a href="#cb77-2395" aria-hidden="true" tabindex="-1"></a><span class="va">A</span><span class="op">:</span> <span class="va">If</span> <span class="va">you</span> <span class="va">run</span> <span class="va">files</span> <span class="va">through</span> <span class="va">the</span> <span class="va">FileValidator</span> <span class="va">found</span> <span class="va">in</span> <span class="va">the</span> <span class="va">Utilities</span> (<span class="va">Application</span><span class="op">&gt;</span><span class="va">EGI</span><span class="op">&gt;</span><span class="va">Utilities</span>) <span class="va">folder</span><span class="op">,</span> <span class="va">this</span> <span class="va">will</span> <span class="va">fix</span> <span class="va">the</span> <span class="va">error</span>.</span>
<span id="cb77-2396"><a href="#cb77-2396" aria-hidden="true" tabindex="-1"></a><span class="va">If</span> <span class="va">you</span> <span class="va">don</span><span class="op">'</span><span class="va">t</span> <span class="va">have</span> <span class="va">that</span><span class="op">,</span> <span class="va">you</span> <span class="va">can</span> <span class="va">right</span><span class="op">-</span><span class="va">click</span> <span class="va">on</span> <span class="va">the</span> <span class="va">files</span><span class="op">,</span> <span class="va">choose</span> <span class="st">"Show package contents"</span> <span class="va">and</span> <span class="va">deleted</span> <span class="va">the</span> `<span class="va">lock</span>.<span class="va">txt</span>` <span class="va">or</span> `<span class="va">aquiriring</span>.<span class="va">xml</span>` <span class="va">file</span> <span class="kw">if</span> <span class="va">found</span></span>
<span id="cb77-2397"><a href="#cb77-2397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2398"><a href="#cb77-2398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2399"><a href="#cb77-2399" aria-hidden="true" tabindex="-1"></a><span class="op">**</span><span class="va">Q</span><span class="op">:</span> <span class="va">When</span> <span class="va">trying</span> <span class="va">to</span> <span class="va">import</span> <span class="va">files</span> <span class="va">to</span> <span class="va">NetStation</span> <span class="va">Tools</span> <span class="va">from</span> <span class="va">an</span> <span class="va">external</span> <span class="va">hard</span> <span class="va">drive</span><span class="op">,</span> <span class="va">they</span> <span class="va">do</span> <span class="va">not</span> <span class="va">show</span> <span class="va">up</span> <span class="va">in</span> <span class="va">the</span> <span class="st">"Input Files"</span> <span class="va">box</span> <span class="va">but</span> <span class="va">no</span> <span class="va">error</span> <span class="va">is</span> <span class="va">given</span><span class="op">.**</span></span>
<span id="cb77-2400"><a href="#cb77-2400" aria-hidden="true" tabindex="-1"></a><span class="op">**</span><span class="va">How</span> <span class="va">can</span> <span class="va">I</span> <span class="va">resolve</span> <span class="va">this</span>?<span class="op">**</span></span>
<span id="cb77-2401"><a href="#cb77-2401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2402"><a href="#cb77-2402" aria-hidden="true" tabindex="-1"></a><span class="va">A</span><span class="op">:</span> <span class="va">Copy</span> <span class="va">the</span> <span class="va">files</span> <span class="va">to</span> <span class="va">a</span> <span class="va">local</span> <span class="va">directory</span> (<span class="va">e</span>.<span class="va">g</span>.<span class="op">,</span> <span class="va">a</span> <span class="va">folder</span> <span class="va">on</span> <span class="va">the</span> <span class="va">Desktop</span>) <span class="va">before</span> <span class="va">importing</span> <span class="va">to</span> <span class="va">NetStation</span> <span class="va">Tools</span>.</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/DevPsyLab/DataAnalysis/edit/main/eegERP.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/blob/main/eegERP.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>