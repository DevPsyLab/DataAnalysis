<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Isaac T. Petersen">
<meta name="dcterms.date" content="today">
<title>Hierarchical Linear Modeling – Data Analysis Guides for the Developmental Psychopathology Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d640c705e8c17715bca3574aa719063f.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9278de052701f0b3f1191ef96b26c196.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-TYR0QMREEW', { 'anonymize_ip': true});
</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><link rel="stylesheet" href="styles.css">
<link rel="stylesheet" href="includes/custom.css">
<link rel="stylesheet" href="font/css/roboto.css">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/labLogo.png" alt="" class="navbar-logo light-content"><img src="./images/labLogo.png" alt="" class="navbar-logo dark-content"></a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Data Analysis Guides for the Developmental Psychopathology Lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-datasets" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Datasets</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-datasets">
<li>
    <a class="dropdown-item" href="./abcdData.html">
 <span class="dropdown-text">ABCD Study Data</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analysis-techniques" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Analysis Techniques</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analysis-techniques">
<li>
    <a class="dropdown-item" href="./bayesian.html">
 <span class="dropdown-text">Bayesian Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dataManagement.html">
 <span class="dropdown-text">Data Management</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dags.html">
 <span class="dropdown-text">Directed Acyclic Graphs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eegERP.html">
 <span class="dropdown-text">Electroencephalography/Event-Related Potentials</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eda.html">
 <span class="dropdown-text">Exploratory Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./factorAnalysis.html">
 <span class="dropdown-text">Factor Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./figures.html">
 <span class="dropdown-text">Figures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./hlm.html">
 <span class="dropdown-text">Hierarchical Linear Modeling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./irt.html">
 <span class="dropdown-text">Item Response Theory</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lda.html">
 <span class="dropdown-text">Longitudinal Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sem.html#mediation">
 <span class="dropdown-text">Mediation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regression.html#moderation">
 <span class="dropdown-text">Moderation/Interaction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./multipleImputation.html">
 <span class="dropdown-text">Multiple Imputation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./pca.html">
 <span class="dropdown-text">Principal Component Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regression.html">
 <span class="dropdown-text">Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./statistics.html">
 <span class="dropdown-text">Statistics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sem.html">
 <span class="dropdown-text">Structural Equation Modeling</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-softwareframeworks" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Software/Frameworks</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-softwareframeworks">
<li>
    <a class="dropdown-item" href="./git.html">
 <span class="dropdown-text">Git, GitLab, and GitHub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./hpc.html">
 <span class="dropdown-text">High-Performance Computing Cluster</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jamovi.html">
 <span class="dropdown-text">jamovi</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jatos.html">
 <span class="dropdown-text">JATOS (Just Another Tool for Online Studies)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jsPsych.html">
 <span class="dropdown-text">jsPsych</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lamp.html">
 <span class="dropdown-text">LAMP (Linux, Apache, MySQL, PHP) Server</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./markdown.html">
 <span class="dropdown-text">Markdown</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mplus.html">
 <span class="dropdown-text">Mplus</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./osf.html">
 <span class="dropdown-text">Open Science Framework</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://devpsylab.github.io/pythonDataAnalysisGuides">
 <span class="dropdown-text">Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./R.html">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SPSS.html">
 <span class="dropdown-text">SPSS</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="https://devpsylab.github.io/LabWiki"> 
<span class="menu-text">Lab Wiki</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://developmental-psychopathology.lab.uiowa.edu"> 
<span class="menu-text">Lab Website</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/DevPsyLab/DataAnalysis">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/DevPsyLab/DataAnalysis/issues/new">
            Report a Bug
            </a>
          </li>
      </ul>
</div>
    <a href="https://twitter.com/devpsylab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="https://www.facebook.com/DevPsyLab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-facebook"></i></a>
    <a href="https://www.instagram.com/dev_psy_lab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-instagram"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./hlm.html">Hierarchical Linear Modeling</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abcdData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ABCD Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataManagement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Management</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dags.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Directed Acyclic Graphs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eegERP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Electroencephalography/Event-Related Potentials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factorAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Factor Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./figures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Git, GitLab, and GitHub</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hlm.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Hierarchical Linear Modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">High-Performance Computing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./irt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Item Response Theory</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jamovi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">jamovi</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jatos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">JATOS (Just Another Tool for Online Studies)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jsPsych.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">jsPsych</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lamp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LAMP (Linux, Apache, MySQL, PHP) Server</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Longitudinal Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markdown</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html#mediation" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mediation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html#moderation" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Moderation/Interaction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mplus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multipleImputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Imputation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./osf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Open Science Framework</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principal Component Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://devpsylab.github.io/pythonDataAnalysisGuides" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SPSS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SPSS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structural Equation Modeling</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li>
<a href="#preamble" id="toc-preamble" class="nav-link active" data-scroll-target="#preamble"><span class="header-section-number">1</span> Preamble</a>
  <ul>
<li><a href="#install-libraries" id="toc-install-libraries" class="nav-link" data-scroll-target="#install-libraries"><span class="header-section-number">1.1</span> Install Libraries</a></li>
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries"><span class="header-section-number">1.2</span> Load Libraries</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="header-section-number">1.3</span> Import Data</a></li>
  <li><a href="#simulate-data" id="toc-simulate-data" class="nav-link" data-scroll-target="#simulate-data"><span class="header-section-number">1.4</span> Simulate Data</a></li>
  </ul>
</li>
  <li><a href="#terms" id="toc-terms" class="nav-link" data-scroll-target="#terms"><span class="header-section-number">2</span> Terms</a></li>
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview"><span class="header-section-number">3</span> Overview</a></li>
  <li><a href="#pre-model-computation" id="toc-pre-model-computation" class="nav-link" data-scroll-target="#pre-model-computation"><span class="header-section-number">4</span> Pre-Model Computation</a></li>
  <li><a href="#estimator-ml-or-reml" id="toc-estimator-ml-or-reml" class="nav-link" data-scroll-target="#estimator-ml-or-reml"><span class="header-section-number">5</span> Estimator: ML or REML</a></li>
  <li>
<a href="#linear" id="toc-linear" class="nav-link" data-scroll-target="#linear"><span class="header-section-number">6</span> Linear Mixed Models</a>
  <ul>
<li>
<a href="#gcm" id="toc-gcm" class="nav-link" data-scroll-target="#gcm"><span class="header-section-number">6.1</span> Growth Curve Models</a>
  <ul>
<li>
<a href="#linearGCM" id="toc-linearGCM" class="nav-link" data-scroll-target="#linearGCM"><span class="header-section-number">6.1.1</span> Linear Growth Curve Model</a>
  <ul class="collapse">
<li><a href="#plot-observed-growth-curves" id="toc-plot-observed-growth-curves" class="nav-link" data-scroll-target="#plot-observed-growth-curves"><span class="header-section-number">6.1.1.1</span> Plot Observed Growth Curves</a></li>
  <li>
<a href="#lme4" id="toc-lme4" class="nav-link" data-scroll-target="#lme4"><span class="header-section-number">6.1.1.2</span> <code>lme4</code></a>
  <ul class="collapse">
<li><a href="#protoypical-growth-curve" id="toc-protoypical-growth-curve" class="nav-link" data-scroll-target="#protoypical-growth-curve"><span class="header-section-number">6.1.1.2.1</span> Protoypical Growth Curve</a></li>
  <li><a href="#individuals-growth-curves" id="toc-individuals-growth-curves" class="nav-link" data-scroll-target="#individuals-growth-curves"><span class="header-section-number">6.1.1.2.2</span> Individuals’ Growth Curves</a></li>
  <li><a href="#individuals-trajectories-overlaid-with-prototypical-trajectory" id="toc-individuals-trajectories-overlaid-with-prototypical-trajectory" class="nav-link" data-scroll-target="#individuals-trajectories-overlaid-with-prototypical-trajectory"><span class="header-section-number">6.1.1.2.3</span> Individuals’ Trajectories Overlaid with Prototypical Trajectory</a></li>
  <li><a href="#extractRandomEffects" id="toc-extractRandomEffects" class="nav-link" data-scroll-target="#extractRandomEffects"><span class="header-section-number">6.1.1.2.4</span> Extract Random Effects</a></li>
  </ul>
</li>
  <li><a href="#nlme" id="toc-nlme" class="nav-link" data-scroll-target="#nlme"><span class="header-section-number">6.1.1.3</span> <code>nlme</code></a></li>
  <li><a href="#icc" id="toc-icc" class="nav-link" data-scroll-target="#icc"><span class="header-section-number">6.1.1.4</span> Intraclass Correlation Coefficent</a></li>
  </ul>
</li>
  <li><a href="#timepointSpecificErrorsGCM" id="toc-timepointSpecificErrorsGCM" class="nav-link" data-scroll-target="#timepointSpecificErrorsGCM"><span class="header-section-number">6.1.2</span> Growth Curve Model with Timepoint-Specific Errors</a></li>
  <li>
<a href="#quadraticGCM" id="toc-quadraticGCM" class="nav-link" data-scroll-target="#quadraticGCM"><span class="header-section-number">6.1.3</span> Quadratic Growth Curve Model</a>
  <ul class="collapse">
<li><a href="#fit-model" id="toc-fit-model" class="nav-link" data-scroll-target="#fit-model"><span class="header-section-number">6.1.3.1</span> Fit Model</a></li>
  <li><a href="#protoypical-growth-curve-1" id="toc-protoypical-growth-curve-1" class="nav-link" data-scroll-target="#protoypical-growth-curve-1"><span class="header-section-number">6.1.3.2</span> Protoypical Growth Curve</a></li>
  <li><a href="#individuals-growth-curves-1" id="toc-individuals-growth-curves-1" class="nav-link" data-scroll-target="#individuals-growth-curves-1"><span class="header-section-number">6.1.3.3</span> Individuals’ Growth Curves</a></li>
  <li><a href="#individuals-trajectories-overlaid-with-prototypical-trajectory-1" id="toc-individuals-trajectories-overlaid-with-prototypical-trajectory-1" class="nav-link" data-scroll-target="#individuals-trajectories-overlaid-with-prototypical-trajectory-1"><span class="header-section-number">6.1.3.4</span> Individuals’ Trajectories Overlaid with Prototypical Trajectory</a></li>
  <li><a href="#extract-random-effects" id="toc-extract-random-effects" class="nav-link" data-scroll-target="#extract-random-effects"><span class="header-section-number">6.1.3.5</span> Extract Random Effects</a></li>
  </ul>
</li>
  <li>
<a href="#splineGCM" id="toc-splineGCM" class="nav-link" data-scroll-target="#splineGCM"><span class="header-section-number">6.1.4</span> Spline Growth Curve Model</a>
  <ul class="collapse">
<li><a href="#create-knot" id="toc-create-knot" class="nav-link" data-scroll-target="#create-knot"><span class="header-section-number">6.1.4.1</span> Create Knot</a></li>
  <li><a href="#fit-model-1" id="toc-fit-model-1" class="nav-link" data-scroll-target="#fit-model-1"><span class="header-section-number">6.1.4.2</span> Fit Model</a></li>
  <li><a href="#protoypical-growth-curve-2" id="toc-protoypical-growth-curve-2" class="nav-link" data-scroll-target="#protoypical-growth-curve-2"><span class="header-section-number">6.1.4.3</span> Protoypical Growth Curve</a></li>
  <li><a href="#individuals-growth-curves-2" id="toc-individuals-growth-curves-2" class="nav-link" data-scroll-target="#individuals-growth-curves-2"><span class="header-section-number">6.1.4.4</span> Individuals’ Growth Curves</a></li>
  <li><a href="#individuals-trajectories-overlaid-with-prototypical-trajectory-2" id="toc-individuals-trajectories-overlaid-with-prototypical-trajectory-2" class="nav-link" data-scroll-target="#individuals-trajectories-overlaid-with-prototypical-trajectory-2"><span class="header-section-number">6.1.4.5</span> Individuals’ Trajectories Overlaid with Prototypical Trajectory</a></li>
  <li><a href="#extract-random-effects-1" id="toc-extract-random-effects-1" class="nav-link" data-scroll-target="#extract-random-effects-1"><span class="header-section-number">6.1.4.6</span> Extract Random Effects</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#generalized" id="toc-generalized" class="nav-link" data-scroll-target="#generalized"><span class="header-section-number">7</span> Generalized Linear Mixed Models</a>
  <ul>
<li><a href="#lmer" id="toc-lmer" class="nav-link" data-scroll-target="#lmer"><span class="header-section-number">7.1</span> <code>lmer</code></a></li>
  <li><a href="#mass" id="toc-mass" class="nav-link" data-scroll-target="#mass"><span class="header-section-number">7.2</span> <code>MASS</code></a></li>
  <li><a href="#mcmcglmm" id="toc-mcmcglmm" class="nav-link" data-scroll-target="#mcmcglmm"><span class="header-section-number">7.3</span> <code>MCMCglmm</code></a></li>
  </ul>
</li>
  <li><a href="#nonlinear" id="toc-nonlinear" class="nav-link" data-scroll-target="#nonlinear"><span class="header-section-number">8</span> Nonlinear Mixed Models</a></li>
  <li><a href="#robust-mixed-models" id="toc-robust-mixed-models" class="nav-link" data-scroll-target="#robust-mixed-models"><span class="header-section-number">9</span> Robust Mixed Models</a></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions"><span class="header-section-number">10</span> Assumptions</a></li>
  <li>
<a href="#examining-model-assumptions" id="toc-examining-model-assumptions" class="nav-link" data-scroll-target="#examining-model-assumptions"><span class="header-section-number">11</span> Examining Model Assumptions</a>
  <ul>
<li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources"><span class="header-section-number">11.1</span> Resources</a></li>
  <li><a href="#qq-plots" id="toc-qq-plots" class="nav-link" data-scroll-target="#qq-plots"><span class="header-section-number">11.2</span> QQ Plots</a></li>
  <li><a href="#pp-plots" id="toc-pp-plots" class="nav-link" data-scroll-target="#pp-plots"><span class="header-section-number">11.3</span> PP Plots</a></li>
  <li><a href="#qq-plot-of-residuals" id="toc-qq-plot-of-residuals" class="nav-link" data-scroll-target="#qq-plot-of-residuals"><span class="header-section-number">11.4</span> QQ Plot of residuals</a></li>
  <li><a href="#plot-residuals" id="toc-plot-residuals" class="nav-link" data-scroll-target="#plot-residuals"><span class="header-section-number">11.5</span> Plot residuals</a></li>
  <li><a href="#plot-residuals-by-group-in-the-example-below-level-2-represents-the-individual" id="toc-plot-residuals-by-group-in-the-example-below-level-2-represents-the-individual" class="nav-link" data-scroll-target="#plot-residuals-by-group-in-the-example-below-level-2-represents-the-individual"><span class="header-section-number">11.6</span> Plot residuals by group (in the example below, level 2 represents the individual)</a></li>
  <li><a href="#plot-residuals-by-levels-of-a-predictor" id="toc-plot-residuals-by-levels-of-a-predictor" class="nav-link" data-scroll-target="#plot-residuals-by-levels-of-a-predictor"><span class="header-section-number">11.7</span> Plot residuals by levels of a predictor</a></li>
  <li><a href="#can-model-heteroscedasticity-of-the-within-group-error-with-the-weights-argument" id="toc-can-model-heteroscedasticity-of-the-within-group-error-with-the-weights-argument" class="nav-link" data-scroll-target="#can-model-heteroscedasticity-of-the-within-group-error-with-the-weights-argument"><span class="header-section-number">11.8</span> Can model heteroscedasticity of the within-group error with the weights argument</a></li>
  <li><a href="#plot-observed-and-fitted-values" id="toc-plot-observed-and-fitted-values" class="nav-link" data-scroll-target="#plot-observed-and-fitted-values"><span class="header-section-number">11.9</span> Plot observed and fitted values</a></li>
  <li><a href="#plot-qq-plot-of-residuals-by-levels-of-a-predictor" id="toc-plot-qq-plot-of-residuals-by-levels-of-a-predictor" class="nav-link" data-scroll-target="#plot-qq-plot-of-residuals-by-levels-of-a-predictor"><span class="header-section-number">11.10</span> Plot QQ plot of residuals by levels of a predictor</a></li>
  <li><a href="#qq-plot-of-random-effects" id="toc-qq-plot-of-random-effects" class="nav-link" data-scroll-target="#qq-plot-of-random-effects"><span class="header-section-number">11.11</span> QQ plot of random effects</a></li>
  <li><a href="#qq-plot-of-random-effects-by-levels-of-a-predictor" id="toc-qq-plot-of-random-effects-by-levels-of-a-predictor" class="nav-link" data-scroll-target="#qq-plot-of-random-effects-by-levels-of-a-predictor"><span class="header-section-number">11.12</span> QQ plot of random effects by levels of a predictor</a></li>
  <li><a href="#pairs-plot" id="toc-pairs-plot" class="nav-link" data-scroll-target="#pairs-plot"><span class="header-section-number">11.13</span> Pairs plot</a></li>
  <li><a href="#variance-functions-for-modeling-heteroscedasticity" id="toc-variance-functions-for-modeling-heteroscedasticity" class="nav-link" data-scroll-target="#variance-functions-for-modeling-heteroscedasticity"><span class="header-section-number">11.14</span> Variance functions for modeling heteroscedasticity</a></li>
  <li><a href="#correlation-structures-for-modeling-dependence" id="toc-correlation-structures-for-modeling-dependence" class="nav-link" data-scroll-target="#correlation-structures-for-modeling-dependence"><span class="header-section-number">11.15</span> Correlation structures for modeling dependence</a></li>
  </ul>
</li>
  <li><a href="#powerAnalysis" id="toc-powerAnalysis" class="nav-link" data-scroll-target="#powerAnalysis"><span class="header-section-number">12</span> Power Analysis</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">13</span> Session Info</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/DevPsyLab/DataAnalysis/edit/main/hlm.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/blob/main/hlm.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Hierarchical Linear Modeling</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="preamble" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Preamble</h1>
<section id="install-libraries" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="install-libraries">
<span class="header-section-number">1.1</span> Install Libraries</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#install.packages("remotes")</span></span>
<span><span class="co">#remotes::install_github("DevPsyLab/petersenlab")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="load-libraries" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="load-libraries">
<span class="header-section-number">1.2</span> Load Libraries</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/DevPsyLab/petersenlab">"petersenlab"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/lme4/lme4/">"lme4"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">"nlme"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/runehaubo/lmerTestR">"lmerTest"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">"MASS"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/jarrodhadfield/MCMCglmm">"MCMCglmm"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://easystats.github.io/performance/">"performance"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="import-data" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="import-data">
<span class="header-section-number">1.3</span> Import Data</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"https://osf.io/cqn3d/download"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="simulate-data" class="level2" data-number="1.4"><h2 data-number="1.4" class="anchored" data-anchor-id="simulate-data">
<span class="header-section-number">1.4</span> Simulate Data</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">52242</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section><section id="terms" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Terms</h1>
<p>These models go by a variety of different terms:</p>
<ul>
<li>hierarchical linear model (HLM)</li>
<li>multilevel model (MLM)</li>
<li>mixed effects model</li>
<li>mixed model</li>
</ul></section><section id="overview" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Overview</h1>
<ul>
<li><a href="https://isaactpetersen.github.io/Principles-Psychological-Assessment/reliability.html#mixedModels" class="uri">https://isaactpetersen.github.io/Principles-Psychological-Assessment/reliability.html#mixedModels</a></li>
<li><a href="https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook/mixed-models.html" class="uri">https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook/mixed-models.html</a></li>
</ul></section><section id="pre-model-computation" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Pre-Model Computation</h1>
<p>It can be helpful to center the age/time variable so that the intercept in a growth curve model has meaning. For instance, we can subtract the youngest participant age to set the intercepts to be the earliest age in the sample.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">&lt;-</span> <span class="va">mydata</span><span class="op">$</span><span class="va">age</span> <span class="op">/</span> <span class="fl">12</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">ageMonthsCentered</span> <span class="op">&lt;-</span> <span class="va">mydata</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYearsCentered</span> <span class="op">&lt;-</span> <span class="va">mydata</span><span class="op">$</span><span class="va">ageMonthsCentered</span> <span class="op">/</span> <span class="fl">12</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYearsCenteredSquared</span> <span class="op">&lt;-</span> <span class="va">mydata</span><span class="op">$</span><span class="va">ageYearsCentered</span> <span class="op">^</span> <span class="fl">2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="estimator-ml-or-reml" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Estimator: ML or REML</h1>
<p>For small sample sizes, restricted maximum likelihood (REML) is preferred over maximum likelihood (ML). ML preferred when there is a small number (&lt; 4) of fixed effects; REML is preferred when there are more (&gt; 4) fixed effects. The greater the number of fixed effects, the greater the difference between REML and ML estimates. Likelihood ratio (LR) tests for REML require exactly the same fixed effects specification in both models. So, to compare models with different fixed effects with an LR test (to determine whether to include a particular fixed effect), ML must be used. In contrast to the maximum likelihood estimation, REML can produce unbiased estimates of variance and covariance parameters, variance estimates are larger in REML than ML. To compare whether an effect should be fixed or random, use REML. To simultaneously compare fixed and random effects, use ML.</p>
</section><section id="linear" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Linear Mixed Models</h1>
<p>The following models are models that are fit in a linear mixed modeling framework.</p>
<section id="gcm" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="gcm">
<span class="header-section-number">6.1</span> Growth Curve Models</h2>
<section id="linearGCM" class="level3" data-number="6.1.1"><h3 data-number="6.1.1" class="anchored" data-anchor-id="linearGCM">
<span class="header-section-number">6.1.1</span> Linear Growth Curve Model</h3>
<section id="plot-observed-growth-curves" class="level4" data-number="6.1.1.1"><h4 data-number="6.1.1.1" class="anchored" data-anchor-id="plot-observed-growth-curves">
<span class="header-section-number">6.1.1.1</span> Plot Observed Growth Curves</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>    y <span class="op">=</span> <span class="va">math</span>,</span>
<span>    group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Math Score"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="hlm_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="lme4" class="level4" data-number="6.1.1.2"><h4 data-number="6.1.1.2" class="anchored" data-anchor-id="lme4">
<span class="header-section-number">6.1.1.2</span> <code>lme4</code>
</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">linearMixedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, <span class="co"># random intercepts and slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linearMixedModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite's
  method [lmerModLmerTest]
Formula: math ~ female + ageYearsCentered + female:ageYearsCentered +  
    (1 + ageYearsCentered | id)
   Data: mydata
Control: lmerControl(optimizer = "bobyqa")

      AIC       BIC    logLik -2*log(L)  df.resid 
  15857.9   15903.5   -7920.9   15841.9      2213 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3750 -0.5174  0.0051  0.5239  2.6396 

Random effects:
 Groups   Name             Variance Std.Dev. Corr
 id       (Intercept)      62.5365  7.9080       
          ageYearsCentered  0.6767  0.8226   0.08
 Residual                  32.1505  5.6701       
Number of obs: 2221, groups:  id, 932

Fixed effects:
                         Estimate Std. Error        df t value Pr(&gt;|t|)    
(Intercept)              30.51401    0.56142 752.48747  54.352   &lt;2e-16 ***
female                   -0.61290    0.79482 736.39886  -0.771    0.441    
ageYearsCentered          4.26792    0.11253 610.09410  37.925   &lt;2e-16 ***
female:ageYearsCentered  -0.02558    0.16092 598.89155  -0.159    0.874    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) female agYrsC
female      -0.706              
ageYrsCntrd -0.635  0.448       
fml:gYrsCnt  0.444 -0.631 -0.699</code></pre>
</div>
</div>
<section id="protoypical-growth-curve" class="level5" data-number="6.1.1.2.1"><h5 data-number="6.1.1.2.1" class="anchored" data-anchor-id="protoypical-growth-curve">
<span class="header-section-number">6.1.1.2.1</span> Protoypical Growth Curve</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">newData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span></span>
<span>  female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ageYears <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">ageYearsCentered</span> <span class="op">&lt;-</span> <span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">female</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"male"</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">female</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"female"</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">predictedValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> <span class="co"># predict.merMod</span></span>
<span>  <span class="va">linearMixedModel</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">newData</span>,</span>
<span>  re.form <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">newData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ageYears</span>, y <span class="op">=</span> <span class="va">predictedValue</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="hlm_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="individuals-growth-curves" class="level5" data-number="6.1.1.2.2"><h5 data-number="6.1.1.2.2" class="anchored" data-anchor-id="individuals-growth-curves">
<span class="header-section-number">6.1.1.2.2</span> Individuals’ Growth Curves</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">predictedValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">linearMixedModel</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  re.form <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ageYears</span>, y <span class="op">=</span> <span class="va">predictedValue</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="hlm_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="individuals-trajectories-overlaid-with-prototypical-trajectory" class="level5" data-number="6.1.1.2.3"><h5 data-number="6.1.1.2.3" class="anchored" data-anchor-id="individuals-trajectories-overlaid-with-prototypical-trajectory">
<span class="header-section-number">6.1.1.2.3</span> Individuals’ Trajectories Overlaid with Prototypical Trajectory</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ageYears</span>, y <span class="op">=</span> <span class="va">predictedValue</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">newData</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ageYears</span>, y <span class="op">=</span> <span class="va">predictedValue</span>, group <span class="op">=</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="hlm_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="extractRandomEffects" class="level5" data-number="6.1.1.2.4"><h5 data-number="6.1.1.2.4" class="anchored" data-anchor-id="extractRandomEffects">
<span class="header-section-number">6.1.1.2.4</span> Extract Random Effects</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">linearMixedModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$id
     (Intercept) ageYearsCentered
201     1.125314        0.2140257
303   -12.515509       -0.6614897
2702   12.257492        0.4307630
4303    2.727958        0.2850021
5002    1.943701        0.1707896
5005    4.045983        0.1202867

with conditional variances for "id" </code></pre>
</div>
</div>
</section></section><section id="nlme" class="level4" data-number="6.1.1.3"><h4 data-number="6.1.1.3" class="anchored" data-anchor-id="nlme">
<span class="header-section-number">6.1.1.3</span> <code>nlme</code>
</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">linearMixedModel_nlme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">ageYearsCentered</span>, <span class="co"># sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">ageYearsCentered</span><span class="op">|</span><span class="va">id</span>, <span class="co"># random intercepts and slopes</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"ML"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by maximum likelihood
  Data: mydata 
       AIC     BIC    logLik
  15857.85 15903.5 -7920.926

Random effects:
 Formula: ~1 + ageYearsCentered | id
 Structure: General positive-definite, Log-Cholesky parametrization
                 StdDev    Corr  
(Intercept)      7.9079987 (Intr)
ageYearsCentered 0.8225933 0.082 
Residual         5.6701380       

Fixed effects:  math ~ female + ageYearsCentered + female:ageYearsCentered 
                            Value Std.Error   DF  t-value p-value
(Intercept)             30.514011 0.5619217 1287 54.30296  0.0000
female                  -0.612896 0.7955333  930 -0.77042  0.4412
ageYearsCentered         4.267923 0.1126360 1287 37.89130  0.0000
female:ageYearsCentered -0.025585 0.1610671 1287 -0.15885  0.8738
 Correlation: 
                        (Intr) female agYrsC
female                  -0.706              
ageYearsCentered        -0.635  0.448       
female:ageYearsCentered  0.444 -0.631 -0.699

Standardized Within-Group Residuals:
         Min           Q1          Med           Q3          Max 
-3.375034869 -0.517409797  0.005105047  0.523910718  2.639557775 

Number of Observations: 2221
Number of Groups: 932 </code></pre>
</div>
</div>
</section><section id="icc" class="level4" data-number="6.1.1.4"><h4 data-number="6.1.1.4" class="anchored" data-anchor-id="icc">
<span class="header-section-number">6.1.1.4</span> Intraclass Correlation Coefficent</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/performance/reference/icc.html">icc</a></span><span class="op">(</span><span class="va">linearMixedModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["ICC_adjusted"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["ICC_unadjusted"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["optional"],"name":[3],"type":["lgl"],"align":["right"]}],"data":[{"1":"0.7088602","2":"0.4552299","3":"FALSE"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/performance/reference/icc.html">icc</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["ICC_adjusted"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["ICC_unadjusted"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["optional"],"name":[3],"type":["lgl"],"align":["right"]}],"data":[{"1":"0.7088602","2":"0.4552299","3":"FALSE"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="timepointSpecificErrorsGCM" class="level3" data-number="6.1.2"><h3 data-number="6.1.2" class="anchored" data-anchor-id="timepointSpecificErrorsGCM">
<span class="header-section-number">6.1.2</span> Growth Curve Model with Timepoint-Specific Errors</h3>
<p>Adapted from Usami &amp; Murayama (2018):</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">timepointSpecificErrorsMixedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">ageYearsCentered</span><span class="op">)</span>, <span class="co"># timepoint-specific errors: observations are cross-classified with person and timepoint; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">timepointSpecificErrorsMixedModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite's
  method [lmerModLmerTest]
Formula: math ~ female + ageYearsCentered + female:ageYearsCentered +  
    (1 | id) + (1 | ageYearsCentered)
   Data: mydata
Control: lmerControl(optimizer = "bobyqa")

      AIC       BIC    logLik -2*log(L)  df.resid 
  15808.6   15848.5   -7897.3   15794.6      2214 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.5409 -0.5191  0.0051  0.5093  2.7345 

Random effects:
 Groups           Name        Variance Std.Dev.
 id               (Intercept) 76.219   8.730   
 ageYearsCentered (Intercept)  4.503   2.122   
 Residual                     30.842   5.554   
Number of obs: 2221, groups:  id, 932; ageYearsCentered, 94

Fixed effects:
                          Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)               29.87438    0.75758  211.81838  39.434   &lt;2e-16 ***
female                    -0.38123    0.82243 1960.43213  -0.464    0.643    
ageYearsCentered           4.26419    0.14813  132.95739  28.786   &lt;2e-16 ***
female:ageYearsCentered   -0.08143    0.14596 1364.56012  -0.558    0.577    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) female agYrsC
female      -0.545              
ageYrsCntrd -0.758  0.321       
fml:gYrsCnt  0.356 -0.652 -0.482</code></pre>
</div>
</div>
</section><section id="quadraticGCM" class="level3" data-number="6.1.3"><h3 data-number="6.1.3" class="anchored" data-anchor-id="quadraticGCM">
<span class="header-section-number">6.1.3</span> Quadratic Growth Curve Model</h3>
<p>When using higher-order polynomials, we could specify contrast codes for time to reduce multicollinearity between the linear and quadratic growth factors: <a href="https://tdjorgensen.github.io/SEM-in-Ed-compendium/ch27.html#saturated-growth-model" class="uri">https://tdjorgensen.github.io/SEM-in-Ed-compendium/ch27.html#saturated-growth-model</a></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">factorLoadings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="co"># times (can allow unequal spacing)</span></span>
<span>  degree <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">factorLoadings</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>              1    2
[1,] -0.6708204  0.5
[2,] -0.2236068 -0.5
[3,]  0.2236068 -0.5
[4,]  0.6708204  0.5
attr(,"coefs")
attr(,"coefs")$alpha
[1] 1.5 1.5

attr(,"coefs")$norm2
[1] 1 4 5 4

attr(,"degree")
[1] 1 2
attr(,"class")
[1] "poly"   "matrix"</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">linearLoadings</span> <span class="op">&lt;-</span> <span class="va">factorLoadings</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">quadraticLoadings</span> <span class="op">&lt;-</span> <span class="va">factorLoadings</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="va">linearLoadings</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] -0.6708204 -0.2236068  0.2236068  0.6708204</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">quadraticLoadings</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  0.5 -0.5 -0.5  0.5</code></pre>
</div>
</div>
<section id="fit-model" class="level4" data-number="6.1.3.1"><h4 data-number="6.1.3.1" class="anchored" data-anchor-id="fit-model">
<span class="header-section-number">6.1.3.1</span> Fit Model</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">quadraticGCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">ageYearsCenteredSquared</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">ageYearsCenteredSquared</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, <span class="co"># random intercepts and linear slopes; fixed quadratic slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">quadraticGCM</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite's
  method [lmerModLmerTest]
Formula: math ~ female + ageYearsCentered + ageYearsCenteredSquared +  
    female:ageYearsCentered + female:ageYearsCenteredSquared +  
    (1 + ageYearsCentered | id)
   Data: mydata
Control: lmerControl(optimizer = "bobyqa")

      AIC       BIC    logLik -2*log(L)  df.resid 
  15666.9   15724.0   -7823.5   15646.9      2211 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3660 -0.4945  0.0048  0.5085  2.4377 

Random effects:
 Groups   Name             Variance Std.Dev. Corr 
 id       (Intercept)      69.8860  8.3598        
          ageYearsCentered  0.7099  0.8426   -0.05
 Residual                  27.1959  5.2150        
Number of obs: 2221, groups:  id, 932

Fixed effects:
                                 Estimate Std. Error         df t value
(Intercept)                      23.43112    0.84914 1380.85816  27.594
female                            0.61167    1.18734 1370.91791   0.515
ageYearsCentered                  8.79334    0.42555 1381.21301  20.664
ageYearsCenteredSquared          -0.57623    0.05255 1382.10819 -10.966
female:ageYearsCentered          -0.62379    0.60301 1386.34429  -1.034
female:ageYearsCenteredSquared    0.05700    0.07582 1393.17373   0.752
                               Pr(&gt;|t|)    
(Intercept)                      &lt;2e-16 ***
female                            0.607    
ageYearsCentered                 &lt;2e-16 ***
ageYearsCenteredSquared          &lt;2e-16 ***
female:ageYearsCentered           0.301    
female:ageYearsCenteredSquared    0.452    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) female agYrsC agYrCS fml:YC
female      -0.715                            
ageYrsCntrd -0.836  0.598                     
agYrsCntrdS  0.759 -0.543 -0.969              
fml:gYrsCnt  0.590 -0.829 -0.706  0.683       
fml:gYrsCnS -0.526  0.751  0.671 -0.693 -0.968</code></pre>
</div>
</div>
<p>This is equivalent to:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">quadraticGCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">ageYearsCentered</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">ageYearsCentered</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, <span class="co"># random intercepts and slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">quadraticGCM</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite's
  method [lmerModLmerTest]
Formula: 
math ~ female + ageYearsCentered + I(ageYearsCentered^2) + female:ageYearsCentered +  
    female:I(ageYearsCentered^2) + (1 + ageYearsCentered | id)
   Data: mydata
Control: lmerControl(optimizer = "bobyqa")

      AIC       BIC    logLik -2*log(L)  df.resid 
  15666.9   15724.0   -7823.5   15646.9      2211 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3660 -0.4945  0.0048  0.5085  2.4377 

Random effects:
 Groups   Name             Variance Std.Dev. Corr 
 id       (Intercept)      69.8860  8.3598        
          ageYearsCentered  0.7099  0.8426   -0.05
 Residual                  27.1959  5.2150        
Number of obs: 2221, groups:  id, 932

Fixed effects:
                               Estimate Std. Error         df t value Pr(&gt;|t|)
(Intercept)                    23.43112    0.84914 1380.85816  27.594   &lt;2e-16
female                          0.61167    1.18734 1370.91791   0.515    0.607
ageYearsCentered                8.79334    0.42555 1381.21301  20.664   &lt;2e-16
I(ageYearsCentered^2)          -0.57623    0.05255 1382.10819 -10.966   &lt;2e-16
female:ageYearsCentered        -0.62379    0.60301 1386.34429  -1.034    0.301
female:I(ageYearsCentered^2)    0.05700    0.07582 1393.17373   0.752    0.452
                                
(Intercept)                  ***
female                          
ageYearsCentered             ***
I(ageYearsCentered^2)        ***
female:ageYearsCentered         
female:I(ageYearsCentered^2)    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) female agYrsC I(YC^2 fml:YC
female      -0.715                            
ageYrsCntrd -0.836  0.598                     
I(gYrsCn^2)  0.759 -0.543 -0.969              
fml:gYrsCnt  0.590 -0.829 -0.706  0.683       
fml:I(YC^2) -0.526  0.751  0.671 -0.693 -0.968</code></pre>
</div>
</div>
</section><section id="protoypical-growth-curve-1" class="level4" data-number="6.1.3.2"><h4 data-number="6.1.3.2" class="anchored" data-anchor-id="protoypical-growth-curve-1">
<span class="header-section-number">6.1.3.2</span> Protoypical Growth Curve</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">newData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span></span>
<span>  female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ageYears <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">ageYearsCentered</span> <span class="op">&lt;-</span> <span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span><span class="op">)</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">ageYearsCenteredSquared</span> <span class="op">&lt;-</span> <span class="va">newData</span><span class="op">$</span><span class="va">ageYearsCentered</span> <span class="op">^</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">female</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"male"</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">female</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"female"</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">predictedValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> <span class="co"># predict.merMod</span></span>
<span>  <span class="va">quadraticGCM</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">newData</span>,</span>
<span>  re.form <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">newData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>    y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>    color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="hlm_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="individuals-growth-curves-1" class="level4" data-number="6.1.3.3"><h4 data-number="6.1.3.3" class="anchored" data-anchor-id="individuals-growth-curves-1">
<span class="header-section-number">6.1.3.3</span> Individuals’ Growth Curves</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">predictedValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">quadraticGCM</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  re.form <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>    y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="hlm_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="individuals-trajectories-overlaid-with-prototypical-trajectory-1" class="level4" data-number="6.1.3.4"><h4 data-number="6.1.3.4" class="anchored" data-anchor-id="individuals-trajectories-overlaid-with-prototypical-trajectory-1">
<span class="header-section-number">6.1.3.4</span> Individuals’ Trajectories Overlaid with Prototypical Trajectory</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>    y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">newData</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>      y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>      group <span class="op">=</span> <span class="va">sex</span>,</span>
<span>      color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="hlm_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="extract-random-effects" class="level4" data-number="6.1.3.5"><h4 data-number="6.1.3.5" class="anchored" data-anchor-id="extract-random-effects">
<span class="header-section-number">6.1.3.5</span> Extract Random Effects</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">quadraticGCM</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$id
     (Intercept) ageYearsCentered
201    0.3392871        0.2048916
303  -14.2395541       -0.5404362
2702  13.6789236        0.6053891
4303   1.8792650        0.2622509
5002   1.6186752        0.3766872
5005   5.0034217        0.1103062

with conditional variances for "id" </code></pre>
</div>
</div>
</section></section><section id="splineGCM" class="level3" data-number="6.1.4"><h3 data-number="6.1.4" class="anchored" data-anchor-id="splineGCM">
<span class="header-section-number">6.1.4</span> Spline Growth Curve Model</h3>
<section id="create-knot" class="level4" data-number="6.1.4.1"><h4 data-number="6.1.4.1" class="anchored" data-anchor-id="create-knot">
<span class="header-section-number">6.1.4.1</span> Create Knot</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">knot</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">knot</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">&lt;=</span> <span class="fl">11</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">knot</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">&gt;</span> <span class="fl">11</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="fit-model-1" class="level4" data-number="6.1.4.2"><h4 data-number="6.1.4.2" class="anchored" data-anchor-id="fit-model-1">
<span class="header-section-number">6.1.4.2</span> Fit Model</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">splineGCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">knot</span> <span class="op">+</span> <span class="va">knot</span><span class="op">:</span><span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">knot</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">knot</span><span class="op">:</span><span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, <span class="co"># random intercepts and linear slopes; fixed quadratic slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">splineGCM</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite's
  method [lmerModLmerTest]
Formula: math ~ female + ageYearsCentered + female:ageYearsCentered +  
    knot + knot:ageYearsCentered + female:knot + female:knot:ageYearsCentered +  
    (1 + ageYearsCentered | id)
   Data: mydata
Control: lmerControl(optimizer = "bobyqa")

      AIC       BIC    logLik -2*log(L)  df.resid 
  15691.2   15759.6   -7833.6   15667.2      2209 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3041 -0.5021 -0.0075  0.5034  2.4850 

Random effects:
 Groups   Name             Variance Std.Dev. Corr 
 id       (Intercept)      68.3568  8.2678        
          ageYearsCentered  0.7018  0.8377   -0.03
 Residual                  27.7772  5.2704        
Number of obs: 2221, groups:  id, 932

Fixed effects:
                              Estimate Std. Error        df t value Pr(&gt;|t|)
(Intercept)                    25.9318     0.7222 1223.0139  35.909  &lt; 2e-16
female                          0.3473     1.0060 1208.6807   0.345    0.730
ageYearsCentered                6.2092     0.2328 1374.3269  26.674  &lt; 2e-16
knot                           12.6515     1.8238 1241.0685   6.937 6.43e-12
female:ageYearsCentered        -0.3785     0.3240 1373.1043  -1.168    0.243
ageYearsCentered:knot          -3.4908     0.3746 1283.6771  -9.318  &lt; 2e-16
female:knot                    -1.2105     2.6098 1234.2550  -0.464    0.643
female:ageYearsCentered:knot    0.3530     0.5383 1279.7386   0.656    0.512
                                
(Intercept)                  ***
female                          
ageYearsCentered             ***
knot                         ***
female:ageYearsCentered         
ageYearsCentered:knot        ***
female:knot                     
female:ageYearsCentered:knot    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) female agYrsC knot   fml:YC agYrC: fml:kn
female      -0.718                                          
ageYrsCntrd -0.786  0.564                                   
knot        -0.267  0.192  0.266                            
fml:gYrsCnt  0.565 -0.776 -0.718 -0.191                     
agYrsCntrd:  0.470 -0.337 -0.568 -0.925  0.408              
female:knot  0.187 -0.259 -0.186 -0.699  0.262  0.646       
fml:gYrsCn: -0.327  0.455  0.395  0.644 -0.559 -0.696 -0.927</code></pre>
</div>
</div>
</section><section id="protoypical-growth-curve-2" class="level4" data-number="6.1.4.3"><h4 data-number="6.1.4.3" class="anchored" data-anchor-id="protoypical-growth-curve-2">
<span class="header-section-number">6.1.4.3</span> Protoypical Growth Curve</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">newData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span></span>
<span>  female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ageYears <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">ageYearsCentered</span> <span class="op">&lt;-</span> <span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">knot</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">knot</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">&lt;=</span> <span class="fl">11</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">knot</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">&gt;</span> <span class="fl">11</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">female</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"male"</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">female</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"female"</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">predictedValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> <span class="co"># predict.merMod</span></span>
<span>  <span class="va">splineGCM</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">newData</span>,</span>
<span>  re.form <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">newData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>    y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>    color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-27-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="hlm_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="individuals-growth-curves-2" class="level4" data-number="6.1.4.4"><h4 data-number="6.1.4.4" class="anchored" data-anchor-id="individuals-growth-curves-2">
<span class="header-section-number">6.1.4.4</span> Individuals’ Growth Curves</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">predictedValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">splineGCM</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  re.form <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>    y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-28-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="hlm_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="individuals-trajectories-overlaid-with-prototypical-trajectory-2" class="level4" data-number="6.1.4.5"><h4 data-number="6.1.4.5" class="anchored" data-anchor-id="individuals-trajectories-overlaid-with-prototypical-trajectory-2">
<span class="header-section-number">6.1.4.5</span> Individuals’ Trajectories Overlaid with Prototypical Trajectory</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>    y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">newData</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>      y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>      group <span class="op">=</span> <span class="va">sex</span>,</span>
<span>      color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-29-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="hlm_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="extract-random-effects-1" class="level4" data-number="6.1.4.6"><h4 data-number="6.1.4.6" class="anchored" data-anchor-id="extract-random-effects-1">
<span class="header-section-number">6.1.4.6</span> Extract Random Effects</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">splineGCM</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$id
     (Intercept) ageYearsCentered
201     0.652145        0.2083235
303   -13.900383       -0.5384101
2702   13.248702        0.4885446
4303    2.123618        0.2695865
5002    1.813505        0.3311535
5005    4.914571        0.1306295

with conditional variances for "id" </code></pre>
</div>
</div>
</section></section></section></section><section id="generalized" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> Generalized Linear Mixed Models</h1>
<p><a href="https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html" class="uri">https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html</a> (archived at <a href="https://perma.cc/9RFS-BCE7" class="uri">https://perma.cc/9RFS-BCE7</a>; source code: <a href="https://github.com/bbolker/mixedmodels-misc/blob/master/glmmFAQ.rmd" class="uri">https://github.com/bbolker/mixedmodels-misc/blob/master/glmmFAQ.rmd</a>)</p>
<section id="lmer" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="lmer">
<span class="header-section-number">7.1</span> <code>lmer</code>
</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">generalizedLinearMixedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span></span>
<span>  <span class="va">outcome</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="op">(</span><span class="va">ageYearsCentered</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">generalizedLinearMixedModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: poisson  ( log )
Formula: outcome ~ female + ageYearsCentered + (ageYearsCentered | id)
   Data: mydata

      AIC       BIC    logLik -2*log(L)  df.resid 
   9329.7    9363.9   -4658.8    9317.7      2215 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.0331 -0.5546 -0.0205  0.5350  5.0222 

Random effects:
 Groups Name             Variance  Std.Dev. Corr 
 id     (Intercept)      0.0058309 0.07636       
        ageYearsCentered 0.0002845 0.01687  -1.00
Number of obs: 2221, groups:  id, 932

Fixed effects:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      1.343986   0.026879  50.001   &lt;2e-16 ***
female           0.007439   0.021268   0.350   0.7265    
ageYearsCentered 0.010279   0.005804   1.771   0.0766 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) female
female      -0.421       
ageYrsCntrd -0.831  0.036
optimizer (Nelder_Mead) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
</section><section id="mass" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="mass">
<span class="header-section-number">7.2</span> <code>MASS</code>
</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">glmmPQLmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glmmPQL.html">glmmPQL</a></span><span class="op">(</span></span>
<span>  <span class="va">outcome</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">ageYearsCentered</span><span class="op">|</span><span class="va">id</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">glmmPQLmodel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by maximum likelihood
  Data: mydata 
  AIC BIC logLik
   NA  NA     NA

Random effects:
 Formula: ~1 + ageYearsCentered | id
 Structure: General positive-definite, Log-Cholesky parametrization
                 StdDev       Corr  
(Intercept)      5.533290e-05 (Intr)
ageYearsCentered 9.320922e-08 0     
Residual         1.014184e+00       

Variance function:
 Structure: fixed weights
 Formula: ~invwt 
Fixed effects:  outcome ~ female + ageYearsCentered 
                     Value   Std.Error   DF  t-value p-value
(Intercept)      1.3453017 0.027100741 1288 49.64077  0.0000
female           0.0074130 0.021543030  930  0.34410  0.7308
ageYearsCentered 0.0100806 0.005850753 1288  1.72296  0.0851
 Correlation: 
                 (Intr) female
female           -0.423       
ageYearsCentered -0.829  0.036

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-2.00970268 -0.55110605 -0.02158036  0.53179575  4.98914420 

Number of Observations: 2221
Number of Groups: 932 </code></pre>
</div>
</div>
</section><section id="mcmcglmm" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="mcmcglmm">
<span class="header-section-number">7.3</span> <code>MCMCglmm</code>
</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">MCMCglmmModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MCMCglmm/man/MCMCglmm.html">MCMCglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">outcome</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">us</span><span class="op">(</span><span class="va">ageYearsCentered</span><span class="op">)</span><span class="op">:</span><span class="va">id</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>,<span class="st">"outcome"</span>,<span class="st">"female"</span>,<span class="st">"ageYearsCentered"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
                       MCMC iteration = 0

 Acceptance ratio for liability set 1 = 0.000410

                       MCMC iteration = 1000

 Acceptance ratio for liability set 1 = 0.439819

                       MCMC iteration = 2000

 Acceptance ratio for liability set 1 = 0.439977

                       MCMC iteration = 3000

 Acceptance ratio for liability set 1 = 0.444608

                       MCMC iteration = 4000

 Acceptance ratio for liability set 1 = 0.496749

                       MCMC iteration = 5000

 Acceptance ratio for liability set 1 = 0.490778

                       MCMC iteration = 6000

 Acceptance ratio for liability set 1 = 0.512362

                       MCMC iteration = 7000

 Acceptance ratio for liability set 1 = 0.428231

                       MCMC iteration = 8000

 Acceptance ratio for liability set 1 = 0.412336

                       MCMC iteration = 9000

 Acceptance ratio for liability set 1 = 0.471726

                       MCMC iteration = 10000

 Acceptance ratio for liability set 1 = 0.428491

                       MCMC iteration = 11000

 Acceptance ratio for liability set 1 = 0.400078

                       MCMC iteration = 12000

 Acceptance ratio for liability set 1 = 0.346435

                       MCMC iteration = 13000

 Acceptance ratio for liability set 1 = 0.276170</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">MCMCglmmModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
 Iterations = 3001:12991
 Thinning interval  = 10
 Sample size  = 1000 

 DIC: 9323.524 

 G-structure:  ~us(ageYearsCentered):id

                                     post.mean  l-95% CI  u-95% CI eff.samp
ageYearsCentered:ageYearsCentered.id 6.754e-06 1.087e-08 4.053e-05    7.788

 R-structure:  ~units

      post.mean l-95% CI u-95% CI eff.samp
units   0.00877 0.001634  0.01728    7.797

 Location effects: outcome ~ female + ageYearsCentered 

                 post.mean  l-95% CI  u-95% CI eff.samp  pMCMC    
(Intercept)       1.338707  1.281096  1.387614    55.58 &lt;0.001 ***
female            0.007688 -0.031193  0.052271    58.65  0.706    
ageYearsCentered  0.010561  0.000813  0.021420    57.32  0.046 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section></section><section id="nonlinear" class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> Nonlinear Mixed Models</h1>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nonlinearModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/nlme.html">nlme</a></span><span class="op">(</span></span>
<span>  <span class="va">height</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/SSasymp.html">SSasymp</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">Asym</span>, <span class="va">R0</span>, <span class="va">lrc</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">Loblolly</span>,</span>
<span>  fixed <span class="op">=</span> <span class="va">Asym</span> <span class="op">+</span> <span class="va">R0</span> <span class="op">+</span> <span class="va">lrc</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  random <span class="op">=</span> <span class="va">Asym</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">nonlinearModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Nonlinear mixed-effects model fit by maximum likelihood
  Model: height ~ SSasymp(age, Asym, R0, lrc) 
  Data: Loblolly 
      AIC      BIC   logLik
  239.486 251.6401 -114.743

Random effects:
 Formula: Asym ~ 1 | Seed
            Asym  Residual
StdDev: 3.650645 0.7188624

Fixed effects:  list(Asym ~ 1, R0 ~ 1, lrc ~ 1) 
         Value Std.Error DF   t-value p-value
Asym 101.44830 2.4616151 68  41.21209       0
R0    -8.62749 0.3179519 68 -27.13459       0
lrc   -3.23373 0.0342695 68 -94.36168       0
 Correlation: 
    Asym   R0    
R0   0.704       
lrc -0.908 -0.827

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-2.23604174 -0.62389999  0.05912777  0.65724316  1.95790785 

Number of Observations: 84
Number of Groups: 14 </code></pre>
</div>
</div>
</section><section id="robust-mixed-models" class="level1" data-number="9"><h1 data-number="9">
<span class="header-section-number">9</span> Robust Mixed Models</h1>
<p>To evaluate the extent to which a finding could driven by outliers, this could be done in a number of different ways, such as:</p>
<ul>
<li>identifying and excluding influential observations based on DFBETAS or Cook’s distance (Nieuwenhuis, Grotenhuis, &amp; Pelzer, 2012)</li>
<li>fitting mixed models using rank-based estimation (Bilgic &amp; Susmann, 2013; Finch, 2017) or robust estimating equations (Koller, 2016)</li>
<li>estimating robust standard errors using a sandwich estimator (Wang &amp; Merkle, 2018)</li>
</ul></section><section id="assumptions" class="level1" data-number="10"><h1 data-number="10">
<span class="header-section-number">10</span> Assumptions</h1>
<p>The within-group errors:</p>
<ol type="1">
<li>are independent</li>
<li>are identically normally distributed</li>
<li>have mean zero and variance sigma-squared</li>
<li>are independent of the random effects</li>
</ol>
<p>The random effects:</p>
<ol start="5" type="1">
<li>are normally distributed</li>
<li>have mean zero and covariance matrix Psi (not depending on the group)</li>
<li>are independent for different groups</li>
</ol></section><section id="examining-model-assumptions" class="level1" data-number="11"><h1 data-number="11">
<span class="header-section-number">11</span> Examining Model Assumptions</h1>
<section id="resources" class="level2" data-number="11.1"><h2 data-number="11.1" class="anchored" data-anchor-id="resources">
<span class="header-section-number">11.1</span> Resources</h2>
<p>Pinheiro and Bates (2000) book (p.&nbsp;174, section 4.3.1)</p>
<p><a href="https://stats.stackexchange.com/questions/77891/checking-assumptions-lmer-lme-mixed-models-in-r" class="uri">https://stats.stackexchange.com/questions/77891/checking-assumptions-lmer-lme-mixed-models-in-r</a> (archived at <a href="https://perma.cc/J5GC-PCUT" class="uri">https://perma.cc/J5GC-PCUT</a>)</p>
</section><section id="qq-plots" class="level2" data-number="11.2"><h2 data-number="11.2" class="anchored" data-anchor-id="qq-plots">
<span class="header-section-number">11.2</span> QQ Plots</h2>
<p>Make QQ plots for each level of the random effects. Vary the level from 0, 1, to 2 so that you can check the between- and within-subject residuals.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>,</span>
<span>       <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">.</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-36-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="hlm_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="pp-plots" class="level2" data-number="11.3"><h2 data-number="11.3" class="anchored" data-anchor-id="pp-plots">
<span class="header-section-number">11.3</span> PP Plots</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://devpsylab.github.io/petersenlab/reference/ppPlot.html">ppPlot</a></span><span class="op">(</span><span class="va">linearMixedModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-37-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="hlm_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="qq-plot-of-residuals" class="level2" data-number="11.4"><h2 data-number="11.4" class="anchored" data-anchor-id="qq-plot-of-residuals">
<span class="header-section-number">11.4</span> QQ Plot of residuals</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">linearMixedModel</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">linearMixedModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-38-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="hlm_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="plot-residuals" class="level2" data-number="11.5"><h2 data-number="11.5" class="anchored" data-anchor-id="plot-residuals">
<span class="header-section-number">11.5</span> Plot residuals</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">linearMixedModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-39-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="hlm_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="plot-residuals-by-group-in-the-example-below-level-2-represents-the-individual" class="level2" data-number="11.6"><h2 data-number="11.6" class="anchored" data-anchor-id="plot-residuals-by-group-in-the-example-below-level-2-represents-the-individual">
<span class="header-section-number">11.6</span> Plot residuals by group (in the example below, level 2 represents the individual)</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">linearMixedModel</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>     abline <span class="op">=</span> <span class="fl">0</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-40-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="hlm_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="plot-residuals-by-levels-of-a-predictor" class="level2" data-number="11.7"><h2 data-number="11.7" class="anchored" data-anchor-id="plot-residuals-by-levels-of-a-predictor">
<span class="header-section-number">11.7</span> Plot residuals by levels of a predictor</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">.</span>, type <span class="op">=</span> <span class="st">"p"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">|</span> <span class="va">female</span><span class="op">)</span> <span class="co">#type = "p" specifies standardized residuals</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-41-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="hlm_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="can-model-heteroscedasticity-of-the-within-group-error-with-the-weights-argument" class="level2" data-number="11.8"><h2 data-number="11.8" class="anchored" data-anchor-id="can-model-heteroscedasticity-of-the-within-group-error-with-the-weights-argument">
<span class="header-section-number">11.8</span> Can model heteroscedasticity of the within-group error with the weights argument</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">linearMixedModel_nlmeVarStructure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">ageYearsCentered</span><span class="op">|</span><span class="va">id</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/varIdent.html">varIdent</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">female</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"ML"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linearMixedModel_nlmeVarStructure</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by maximum likelihood
  Data: mydata 
       AIC      BIC    logLik
  15857.83 15903.48 -7920.915

Random effects:
 Formula: ~1 + ageYearsCentered | id
 Structure: General positive-definite, Log-Cholesky parametrization
                 StdDev    Corr  
(Intercept)      7.9177716 (Intr)
ageYearsCentered 0.8278343 0.076 
Residual         5.6410162       

Variance function:
 Structure: Different standard deviations per stratum
 Formula: ~1 | female 
 Parameter estimates:
       1        0 
1.000000 1.009161 
Fixed effects:  math ~ female + ageYearsCentered 
                     Value Std.Error   DF  t-value p-value
(Intercept)      30.554856 0.5040373 1288 60.62022  0.0000
female           -0.692653 0.6172485  930 -1.12216  0.2621
ageYearsCentered  4.255258 0.0805531 1288 52.82553  0.0000
 Correlation: 
                 (Intr) female
female           -0.614       
ageYearsCentered -0.507  0.014

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-3.37982974 -0.51663213  0.00445497  0.52228733  2.63205084 

Number of Observations: 2221
Number of Groups: 932 </code></pre>
</div>
</div>
</section><section id="plot-observed-and-fitted-values" class="level2" data-number="11.9"><h2 data-number="11.9" class="anchored" data-anchor-id="plot-observed-and-fitted-values">
<span class="header-section-number">11.9</span> Plot observed and fitted values</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">linearMixedModel</span>,</span>
<span>     <span class="va">math</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-43-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="hlm_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="plot-qq-plot-of-residuals-by-levels-of-a-predictor" class="level2" data-number="11.10"><h2 data-number="11.10" class="anchored" data-anchor-id="plot-qq-plot-of-residuals-by-levels-of-a-predictor">
<span class="header-section-number">11.10</span> Plot QQ plot of residuals by levels of a predictor</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">|</span> <span class="va">female</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-44-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="hlm_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-44-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="hlm_files/figure-html/unnamed-chunk-44-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="qq-plot-of-random-effects" class="level2" data-number="11.11"><h2 data-number="11.11" class="anchored" data-anchor-id="qq-plot-of-random-effects">
<span class="header-section-number">11.11</span> QQ plot of random effects</h2>
<p>Make QQ plots for each level of the random effects. Vary the level from 0, 1, to 2 so that you can check the between- and within-subject residuals.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>,</span>
<span>       <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">.</span>, level <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `effects[[1L]]`:
! subscript out of bounds</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>,</span>
<span>       <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">.</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-45-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="hlm_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>,</span>
<span>       <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">.</span>, level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error:
! object '.y' not found</code></pre>
</div>
</div>
</section><section id="qq-plot-of-random-effects-by-levels-of-a-predictor" class="level2" data-number="11.12"><h2 data-number="11.12" class="anchored" data-anchor-id="qq-plot-of-random-effects-by-levels-of-a-predictor">
<span class="header-section-number">11.12</span> QQ plot of random effects by levels of a predictor</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>, </span>
<span>       <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">.</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|</span> <span class="va">female</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-46-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="hlm_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="pairs-plot" class="level2" data-number="11.13"><h2 data-number="11.13" class="anchored" data-anchor-id="pairs-plot">
<span class="header-section-number">11.13</span> Pairs plot</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-47-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="hlm_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>,</span>
<span>      <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">.</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|</span> <span class="va">female</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-47-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="hlm_files/figure-html/unnamed-chunk-47-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="variance-functions-for-modeling-heteroscedasticity" class="level2" data-number="11.14"><h2 data-number="11.14" class="anchored" data-anchor-id="variance-functions-for-modeling-heteroscedasticity">
<span class="header-section-number">11.14</span> Variance functions for modeling heteroscedasticity</h2>
<ul>
<li>
<code>varFixed</code>: fixed variance</li>
<li>
<code>varIdent</code>: different variances per stratum</li>
<li>
<code>varPower</code>: power of covariate</li>
<li>
<code>varExp</code>: exponential of covariate</li>
<li>
<code>varConstPower</code>: constant plus power of covariate</li>
<li>
<code>varComb</code>: combination of variance functions</li>
</ul></section><section id="correlation-structures-for-modeling-dependence" class="level2" data-number="11.15"><h2 data-number="11.15" class="anchored" data-anchor-id="correlation-structures-for-modeling-dependence">
<span class="header-section-number">11.15</span> Correlation structures for modeling dependence</h2>
<ul>
<li>
<code>corCompSymm</code>: compound symmetry</li>
<li>
<code>corSymm</code>: general</li>
<li>
<code>corAR1</code>: autoregressive of order 1</li>
<li>
<code>corCAR1</code>: continuous-time AR(1)</li>
<li>
<code>corARMA</code>: autoregressive-moving average</li>
<li>
<code>corExp</code>: exponential</li>
<li>
<code>corGaus</code>: Gaussian</li>
<li>
<code>corLin</code>: linear</li>
<li>
<code>corRatio</code>: rational quadratic</li>
<li>
<code>corSpher</code>: spherical</li>
</ul></section></section><section id="powerAnalysis" class="level1" data-number="12"><h1 data-number="12">
<span class="header-section-number">12</span> Power Analysis</h1>
<ul>
<li>
<code>mlmpower</code>: <a href="https://github.com/bkeller2/mlmpower" class="uri">https://github.com/bkeller2/mlmpower</a> (<a href="https://doi.org/10.1037/met0000614">Enders et al., 2025</a>)</li>
<li><a href="https://aguinis.shinyapps.io/ml_power/" class="uri">https://aguinis.shinyapps.io/ml_power/</a></li>
<li>
<a href="https://www.causalevaluation.org/power-analysis.html" class="uri">https://www.causalevaluation.org/power-analysis.html</a>
<ul>
<li><a href="https://powerupr.shinyapps.io/index/" class="uri">https://powerupr.shinyapps.io/index/</a></li>
</ul>
</li>
<li><a href="https://koumurayama.shinyapps.io/tmethod_mlm/" class="uri">https://koumurayama.shinyapps.io/tmethod_mlm/</a></li>
<li><a href="https://webpower.psychstat.org/wiki/models/index" class="uri">https://webpower.psychstat.org/wiki/models/index</a></li>
</ul></section><section id="session-info" class="level1" data-number="13"><h1 data-number="13">
<span class="header-section-number">13</span> Session Info</h1>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.2 (2025-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] ggplot2_4.0.1      performance_0.15.3 MCMCglmm_2.36      ape_5.8-1         
 [5] coda_0.19-4.1      MASS_7.3-65        lmerTest_3.1-3     nlme_3.1-168      
 [9] lme4_1.1-38        Matrix_1.7-4       petersenlab_1.2.2 

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.1    psych_2.5.6         viridisLite_0.4.2  
 [4] dplyr_1.1.4         farver_2.1.2        S7_0.2.1           
 [7] fastmap_1.2.0       tensorA_0.36.2.1    digest_0.6.39      
[10] rpart_4.1.24        lifecycle_1.0.4     cluster_2.1.8.1    
[13] magrittr_2.0.4      compiler_4.5.2      rlang_1.1.6        
[16] Hmisc_5.2-4         tools_4.5.2         yaml_2.3.12        
[19] data.table_1.17.8   knitr_1.51          labeling_0.4.3     
[22] htmlwidgets_1.6.4   mnormt_2.1.1        plyr_1.8.9         
[25] RColorBrewer_1.1-3  withr_3.0.2         foreign_0.8-90     
[28] purrr_1.2.0         numDeriv_2016.8-1.1 nnet_7.3-20        
[31] grid_4.5.2          stats4_4.5.2        lavaan_0.6-21      
[34] xtable_1.8-4        colorspace_2.1-2    scales_1.4.0       
[37] insight_1.4.4       cli_3.6.5           mvtnorm_1.3-3      
[40] rmarkdown_2.30      reformulas_0.4.3    generics_0.1.4     
[43] otel_0.2.0          rstudioapi_0.17.1   reshape2_1.4.5     
[46] minqa_1.2.8         DBI_1.2.3           stringr_1.6.0      
[49] splines_4.5.2       parallel_4.5.2      base64enc_0.1-3    
[52] mitools_2.4         vctrs_0.6.5         boot_1.3-32        
[55] jsonlite_2.0.0      Formula_1.2-5       htmlTable_2.4.3    
[58] glue_1.8.0          nloptr_2.2.1        cubature_2.1.4-1   
[61] stringi_1.8.7       gtable_0.3.6        quadprog_1.5-8     
[64] tibble_3.3.0        pillar_1.11.1       htmltools_0.5.9    
[67] R6_2.6.1            Rdpack_2.6.4        mix_1.0-13         
[70] evaluate_1.0.5      pbivnorm_0.6.0      lattice_0.22-7     
[73] rbibutils_2.4       backports_1.5.0     corpcor_1.6.10     
[76] Rcpp_1.1.0          gridExtra_2.3       checkmate_2.3.3    
[79] xfun_0.55           pkgconfig_2.0.3    </code></pre>
</div>
</div>


<!-- -->

</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section></div></main><!-- /main --><!-- Add lab logo --><p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%"></a>
</p>

<br><hr>
<br><!-- Add icon library --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!-- Add font awesome icons --><p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/DevPsyLab\.github\.io\/DataAnalysis\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb74" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Hierarchical Linear Modeling"</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html_document:</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co">    code_folding: show</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="fu"># Preamble</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## Install Libraries</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("remotes")</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github("DevPsyLab/petersenlab")</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load Libraries</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"petersenlab"</span>)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"lme4"</span>)</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"nlme"</span>)</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"lmerTest"</span>)</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"MASS"</span>)</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"MCMCglmm"</span>)</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"performance"</span>)</span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a><span class="fu">## Import Data</span></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://osf.io/cqn3d/download"</span>)</span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/nlsy_math_long.csv"</span>) <span class="co">#https://osf.io/cqn3d/download</span></span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulate Data</span></span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb74-58"><a href="#cb74-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-59"><a href="#cb74-59" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>outcome <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="fu">nrow</span>(mydata), <span class="dv">4</span>)</span>
<span id="cb74-60"><a href="#cb74-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-61"><a href="#cb74-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-62"><a href="#cb74-62" aria-hidden="true" tabindex="-1"></a><span class="fu"># Terms</span></span>
<span id="cb74-63"><a href="#cb74-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-64"><a href="#cb74-64" aria-hidden="true" tabindex="-1"></a>These models go by a variety of different terms:</span>
<span id="cb74-65"><a href="#cb74-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-66"><a href="#cb74-66" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>hierarchical linear model (HLM)</span>
<span id="cb74-67"><a href="#cb74-67" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>multilevel model (MLM)</span>
<span id="cb74-68"><a href="#cb74-68" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>mixed effects model</span>
<span id="cb74-69"><a href="#cb74-69" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>mixed model</span>
<span id="cb74-70"><a href="#cb74-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-71"><a href="#cb74-71" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overview</span></span>
<span id="cb74-72"><a href="#cb74-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-73"><a href="#cb74-73" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://isaactpetersen.github.io/Principles-Psychological-Assessment/reliability.html#mixedModels&gt;</span></span>
<span id="cb74-74"><a href="#cb74-74" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook/mixed-models.html&gt;</span></span>
<span id="cb74-75"><a href="#cb74-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-76"><a href="#cb74-76" aria-hidden="true" tabindex="-1"></a><span class="fu"># Pre-Model Computation</span></span>
<span id="cb74-77"><a href="#cb74-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-78"><a href="#cb74-78" aria-hidden="true" tabindex="-1"></a>It can be helpful to center the age/time variable so that the intercept in a growth curve model has meaning.</span>
<span id="cb74-79"><a href="#cb74-79" aria-hidden="true" tabindex="-1"></a>For instance, we can subtract the youngest participant age to set the intercepts to be the earliest age in the sample.</span>
<span id="cb74-80"><a href="#cb74-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-83"><a href="#cb74-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-84"><a href="#cb74-84" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>ageYears <span class="ot">&lt;-</span> mydata<span class="sc">$</span>age <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb74-85"><a href="#cb74-85" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>ageMonthsCentered <span class="ot">&lt;-</span> mydata<span class="sc">$</span>age <span class="sc">-</span> <span class="fu">min</span>(mydata<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb74-86"><a href="#cb74-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-87"><a href="#cb74-87" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>ageYearsCentered <span class="ot">&lt;-</span> mydata<span class="sc">$</span>ageMonthsCentered <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb74-88"><a href="#cb74-88" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>ageYearsCenteredSquared <span class="ot">&lt;-</span> mydata<span class="sc">$</span>ageYearsCentered <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb74-89"><a href="#cb74-89" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-90"><a href="#cb74-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-91"><a href="#cb74-91" aria-hidden="true" tabindex="-1"></a><span class="fu"># Estimator: ML or REML</span></span>
<span id="cb74-92"><a href="#cb74-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-93"><a href="#cb74-93" aria-hidden="true" tabindex="-1"></a>For small sample sizes, restricted maximum likelihood (REML) is preferred over maximum likelihood (ML).</span>
<span id="cb74-94"><a href="#cb74-94" aria-hidden="true" tabindex="-1"></a>ML preferred when there is a small number (&lt; 4) of fixed effects; REML is preferred when there are more (&gt; 4) fixed effects.</span>
<span id="cb74-95"><a href="#cb74-95" aria-hidden="true" tabindex="-1"></a>The greater the number of fixed effects, the greater the difference between REML and ML estimates.</span>
<span id="cb74-96"><a href="#cb74-96" aria-hidden="true" tabindex="-1"></a>Likelihood ratio (LR) tests for REML require exactly the same fixed effects specification in both models.</span>
<span id="cb74-97"><a href="#cb74-97" aria-hidden="true" tabindex="-1"></a>So, to compare models with different fixed effects with an LR test (to determine whether to include a particular fixed effect), ML must be used.</span>
<span id="cb74-98"><a href="#cb74-98" aria-hidden="true" tabindex="-1"></a>In contrast to the maximum likelihood estimation, REML can produce unbiased estimates of variance and covariance parameters, variance estimates are larger in REML than ML.</span>
<span id="cb74-99"><a href="#cb74-99" aria-hidden="true" tabindex="-1"></a>To compare whether an effect should be fixed or random, use REML.</span>
<span id="cb74-100"><a href="#cb74-100" aria-hidden="true" tabindex="-1"></a>To simultaneously compare fixed and random effects, use ML.</span>
<span id="cb74-101"><a href="#cb74-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-102"><a href="#cb74-102" aria-hidden="true" tabindex="-1"></a><span class="fu"># Linear Mixed Models {#linear}</span></span>
<span id="cb74-103"><a href="#cb74-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-104"><a href="#cb74-104" aria-hidden="true" tabindex="-1"></a>The following models are models that are fit in a linear mixed modeling framework.</span>
<span id="cb74-105"><a href="#cb74-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-106"><a href="#cb74-106" aria-hidden="true" tabindex="-1"></a><span class="fu">## Growth Curve Models {#gcm}</span></span>
<span id="cb74-107"><a href="#cb74-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-108"><a href="#cb74-108" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linear Growth Curve Model {#linearGCM}</span></span>
<span id="cb74-109"><a href="#cb74-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-110"><a href="#cb74-110" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plot Observed Growth Curves</span></span>
<span id="cb74-111"><a href="#cb74-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-114"><a href="#cb74-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-115"><a href="#cb74-115" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-116"><a href="#cb74-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-117"><a href="#cb74-117" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-118"><a href="#cb74-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ageYears,</span>
<span id="cb74-119"><a href="#cb74-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> math,</span>
<span id="cb74-120"><a href="#cb74-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> id)) <span class="sc">+</span></span>
<span id="cb74-121"><a href="#cb74-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb74-122"><a href="#cb74-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb74-123"><a href="#cb74-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-124"><a href="#cb74-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb74-125"><a href="#cb74-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Math Score"</span>)</span>
<span id="cb74-126"><a href="#cb74-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-127"><a href="#cb74-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-128"><a href="#cb74-128" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `lme4`</span></span>
<span id="cb74-129"><a href="#cb74-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-132"><a href="#cb74-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-133"><a href="#cb74-133" aria-hidden="true" tabindex="-1"></a>linearMixedModel <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb74-134"><a href="#cb74-134" aria-hidden="true" tabindex="-1"></a>  math <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered <span class="sc">+</span> female<span class="sc">:</span>ageYearsCentered <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> ageYearsCentered <span class="sc">|</span> id), <span class="co"># random intercepts and slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span id="cb74-135"><a href="#cb74-135" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-136"><a href="#cb74-136" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span id="cb74-137"><a href="#cb74-137" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb74-138"><a href="#cb74-138" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span>
<span id="cb74-139"><a href="#cb74-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-140"><a href="#cb74-140" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linearMixedModel)</span>
<span id="cb74-141"><a href="#cb74-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-142"><a href="#cb74-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-143"><a href="#cb74-143" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Protoypical Growth Curve</span></span>
<span id="cb74-144"><a href="#cb74-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-147"><a href="#cb74-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-148"><a href="#cb74-148" aria-hidden="true" tabindex="-1"></a>newData <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb74-149"><a href="#cb74-149" aria-hidden="true" tabindex="-1"></a>  <span class="at">female =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb74-150"><a href="#cb74-150" aria-hidden="true" tabindex="-1"></a>  <span class="at">ageYears =</span> <span class="fu">c</span>(</span>
<span id="cb74-151"><a href="#cb74-151" aria-hidden="true" tabindex="-1"></a>    <span class="fu">min</span>(mydata<span class="sc">$</span>ageYears, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb74-152"><a href="#cb74-152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(mydata<span class="sc">$</span>ageYears, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb74-153"><a href="#cb74-153" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-154"><a href="#cb74-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-155"><a href="#cb74-155" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>ageYearsCentered <span class="ot">&lt;-</span> newData<span class="sc">$</span>ageYears <span class="sc">-</span> <span class="fu">min</span>(newData<span class="sc">$</span>ageYears)</span>
<span id="cb74-156"><a href="#cb74-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-157"><a href="#cb74-157" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb74-158"><a href="#cb74-158" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex[<span class="fu">which</span>(newData<span class="sc">$</span>female <span class="sc">==</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="st">"male"</span></span>
<span id="cb74-159"><a href="#cb74-159" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex[<span class="fu">which</span>(newData<span class="sc">$</span>female <span class="sc">==</span> <span class="dv">1</span>)] <span class="ot">&lt;-</span> <span class="st">"female"</span></span>
<span id="cb74-160"><a href="#cb74-160" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(newData<span class="sc">$</span>sex)</span>
<span id="cb74-161"><a href="#cb74-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-162"><a href="#cb74-162" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>predictedValue <span class="ot">&lt;-</span> <span class="fu">predict</span>( <span class="co"># predict.merMod</span></span>
<span id="cb74-163"><a href="#cb74-163" aria-hidden="true" tabindex="-1"></a>  linearMixedModel,</span>
<span id="cb74-164"><a href="#cb74-164" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> newData,</span>
<span id="cb74-165"><a href="#cb74-165" aria-hidden="true" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="cn">NA</span></span>
<span id="cb74-166"><a href="#cb74-166" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-167"><a href="#cb74-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-168"><a href="#cb74-168" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-169"><a href="#cb74-169" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> newData,</span>
<span id="cb74-170"><a href="#cb74-170" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ageYears, <span class="at">y =</span> predictedValue, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb74-171"><a href="#cb74-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-172"><a href="#cb74-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-173"><a href="#cb74-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb74-174"><a href="#cb74-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-175"><a href="#cb74-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-176"><a href="#cb74-176" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Individuals' Growth Curves</span></span>
<span id="cb74-177"><a href="#cb74-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-180"><a href="#cb74-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-181"><a href="#cb74-181" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>predictedValue <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb74-182"><a href="#cb74-182" aria-hidden="true" tabindex="-1"></a>  linearMixedModel,</span>
<span id="cb74-183"><a href="#cb74-183" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> mydata,</span>
<span id="cb74-184"><a href="#cb74-184" aria-hidden="true" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="cn">NULL</span></span>
<span id="cb74-185"><a href="#cb74-185" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-186"><a href="#cb74-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-187"><a href="#cb74-187" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-188"><a href="#cb74-188" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-189"><a href="#cb74-189" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ageYears, <span class="at">y =</span> predictedValue, <span class="at">group =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb74-190"><a href="#cb74-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-191"><a href="#cb74-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-192"><a href="#cb74-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb74-193"><a href="#cb74-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-194"><a href="#cb74-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-195"><a href="#cb74-195" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Individuals' Trajectories Overlaid with Prototypical Trajectory</span></span>
<span id="cb74-196"><a href="#cb74-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-199"><a href="#cb74-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-200"><a href="#cb74-200" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-201"><a href="#cb74-201" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-202"><a href="#cb74-202" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ageYears, <span class="at">y =</span> predictedValue, <span class="at">group =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb74-203"><a href="#cb74-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-204"><a href="#cb74-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-205"><a href="#cb74-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb74-206"><a href="#cb74-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb74-207"><a href="#cb74-207" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newData,</span>
<span id="cb74-208"><a href="#cb74-208" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ageYears, <span class="at">y =</span> predictedValue, <span class="at">group =</span> sex, <span class="at">color =</span> sex),</span>
<span id="cb74-209"><a href="#cb74-209" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">2</span>)</span>
<span id="cb74-210"><a href="#cb74-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-211"><a href="#cb74-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-212"><a href="#cb74-212" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Extract Random Effects {#extractRandomEffects}</span></span>
<span id="cb74-213"><a href="#cb74-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-216"><a href="#cb74-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-217"><a href="#cb74-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb74-218"><a href="#cb74-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-219"><a href="#cb74-219" aria-hidden="true" tabindex="-1"></a><span class="fu">ranef</span>(linearMixedModel)</span>
<span id="cb74-220"><a href="#cb74-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-221"><a href="#cb74-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-224"><a href="#cb74-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-225"><a href="#cb74-225" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb74-226"><a href="#cb74-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-227"><a href="#cb74-227" aria-hidden="true" tabindex="-1"></a>linearMixedModel_re <span class="ot">&lt;-</span> <span class="fu">ranef</span>(linearMixedModel)</span>
<span id="cb74-228"><a href="#cb74-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-229"><a href="#cb74-229" aria-hidden="true" tabindex="-1"></a>linearMixedModel_re<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">head</span>(linearMixedModel_re<span class="sc">$</span>id)</span>
<span id="cb74-230"><a href="#cb74-230" aria-hidden="true" tabindex="-1"></a>linearMixedModel_re</span>
<span id="cb74-231"><a href="#cb74-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-232"><a href="#cb74-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-233"><a href="#cb74-233" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `nlme`</span></span>
<span id="cb74-234"><a href="#cb74-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-237"><a href="#cb74-237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-238"><a href="#cb74-238" aria-hidden="true" tabindex="-1"></a>linearMixedModel_nlme <span class="ot">&lt;-</span> <span class="fu">lme</span>(</span>
<span id="cb74-239"><a href="#cb74-239" aria-hidden="true" tabindex="-1"></a>  math <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered <span class="sc">+</span> female<span class="sc">:</span>ageYearsCentered, <span class="co"># sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span id="cb74-240"><a href="#cb74-240" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> ageYearsCentered<span class="sc">|</span>id, <span class="co"># random intercepts and slopes</span></span>
<span id="cb74-241"><a href="#cb74-241" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-242"><a href="#cb74-242" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"ML"</span>,</span>
<span id="cb74-243"><a href="#cb74-243" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb74-244"><a href="#cb74-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-245"><a href="#cb74-245" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linearMixedModel_nlme)</span>
<span id="cb74-246"><a href="#cb74-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-247"><a href="#cb74-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-248"><a href="#cb74-248" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Intraclass Correlation Coefficent {#icc}</span></span>
<span id="cb74-249"><a href="#cb74-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-252"><a href="#cb74-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-253"><a href="#cb74-253" aria-hidden="true" tabindex="-1"></a><span class="fu">icc</span>(linearMixedModel)</span>
<span id="cb74-254"><a href="#cb74-254" aria-hidden="true" tabindex="-1"></a><span class="fu">icc</span>(linearMixedModel_nlme)</span>
<span id="cb74-255"><a href="#cb74-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-256"><a href="#cb74-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-257"><a href="#cb74-257" aria-hidden="true" tabindex="-1"></a><span class="fu">### Growth Curve Model with Timepoint-Specific Errors {#timepointSpecificErrorsGCM}</span></span>
<span id="cb74-258"><a href="#cb74-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-259"><a href="#cb74-259" aria-hidden="true" tabindex="-1"></a>Adapted from Usami &amp; Murayama (2018):</span>
<span id="cb74-260"><a href="#cb74-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-263"><a href="#cb74-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-264"><a href="#cb74-264" aria-hidden="true" tabindex="-1"></a>timepointSpecificErrorsMixedModel <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb74-265"><a href="#cb74-265" aria-hidden="true" tabindex="-1"></a>  math <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered <span class="sc">+</span> female<span class="sc">:</span>ageYearsCentered <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ageYearsCentered), <span class="co"># timepoint-specific errors: observations are cross-classified with person and timepoint; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span id="cb74-266"><a href="#cb74-266" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-267"><a href="#cb74-267" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span id="cb74-268"><a href="#cb74-268" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb74-269"><a href="#cb74-269" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span>
<span id="cb74-270"><a href="#cb74-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-271"><a href="#cb74-271" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(timepointSpecificErrorsMixedModel)</span>
<span id="cb74-272"><a href="#cb74-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-273"><a href="#cb74-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-274"><a href="#cb74-274" aria-hidden="true" tabindex="-1"></a><span class="fu">### Quadratic Growth Curve Model {#quadraticGCM}</span></span>
<span id="cb74-275"><a href="#cb74-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-276"><a href="#cb74-276" aria-hidden="true" tabindex="-1"></a>When using higher-order polynomials, we could specify contrast codes for time to reduce multicollinearity between the linear and quadratic growth factors: <span class="ot">&lt;https://tdjorgensen.github.io/SEM-in-Ed-compendium/ch27.html#saturated-growth-model&gt;</span></span>
<span id="cb74-277"><a href="#cb74-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-280"><a href="#cb74-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-281"><a href="#cb74-281" aria-hidden="true" tabindex="-1"></a>factorLoadings <span class="ot">&lt;-</span> <span class="fu">poly</span>(</span>
<span id="cb74-282"><a href="#cb74-282" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="co"># times (can allow unequal spacing)</span></span>
<span id="cb74-283"><a href="#cb74-283" aria-hidden="true" tabindex="-1"></a>  <span class="at">degree =</span> <span class="dv">2</span>)</span>
<span id="cb74-284"><a href="#cb74-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-285"><a href="#cb74-285" aria-hidden="true" tabindex="-1"></a>factorLoadings</span>
<span id="cb74-286"><a href="#cb74-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-287"><a href="#cb74-287" aria-hidden="true" tabindex="-1"></a>linearLoadings <span class="ot">&lt;-</span> factorLoadings[,<span class="dv">1</span>]</span>
<span id="cb74-288"><a href="#cb74-288" aria-hidden="true" tabindex="-1"></a>quadraticLoadings <span class="ot">&lt;-</span> factorLoadings[,<span class="dv">2</span>]</span>
<span id="cb74-289"><a href="#cb74-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-290"><a href="#cb74-290" aria-hidden="true" tabindex="-1"></a>linearLoadings</span>
<span id="cb74-291"><a href="#cb74-291" aria-hidden="true" tabindex="-1"></a>quadraticLoadings</span>
<span id="cb74-292"><a href="#cb74-292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-293"><a href="#cb74-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-294"><a href="#cb74-294" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb74-295"><a href="#cb74-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-298"><a href="#cb74-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-299"><a href="#cb74-299" aria-hidden="true" tabindex="-1"></a>quadraticGCM <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb74-300"><a href="#cb74-300" aria-hidden="true" tabindex="-1"></a>  math <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered <span class="sc">+</span> ageYearsCenteredSquared <span class="sc">+</span> female<span class="sc">:</span>ageYearsCentered <span class="sc">+</span> female<span class="sc">:</span>ageYearsCenteredSquared <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> ageYearsCentered <span class="sc">|</span> id), <span class="co"># random intercepts and linear slopes; fixed quadratic slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span id="cb74-301"><a href="#cb74-301" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-302"><a href="#cb74-302" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span id="cb74-303"><a href="#cb74-303" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb74-304"><a href="#cb74-304" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span>
<span id="cb74-305"><a href="#cb74-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-306"><a href="#cb74-306" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quadraticGCM)</span>
<span id="cb74-307"><a href="#cb74-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-308"><a href="#cb74-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-309"><a href="#cb74-309" aria-hidden="true" tabindex="-1"></a>This is equivalent to:</span>
<span id="cb74-310"><a href="#cb74-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-313"><a href="#cb74-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-314"><a href="#cb74-314" aria-hidden="true" tabindex="-1"></a>quadraticGCM <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb74-315"><a href="#cb74-315" aria-hidden="true" tabindex="-1"></a>  math <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered <span class="sc">+</span> <span class="fu">I</span>(ageYearsCentered<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> female<span class="sc">:</span>ageYearsCentered <span class="sc">+</span> female<span class="sc">:</span><span class="fu">I</span>(ageYearsCentered<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> ageYearsCentered <span class="sc">|</span> id), <span class="co"># random intercepts and slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span id="cb74-316"><a href="#cb74-316" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-317"><a href="#cb74-317" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span id="cb74-318"><a href="#cb74-318" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb74-319"><a href="#cb74-319" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span>
<span id="cb74-320"><a href="#cb74-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-321"><a href="#cb74-321" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quadraticGCM)</span>
<span id="cb74-322"><a href="#cb74-322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-323"><a href="#cb74-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-324"><a href="#cb74-324" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Protoypical Growth Curve</span></span>
<span id="cb74-325"><a href="#cb74-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-328"><a href="#cb74-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-329"><a href="#cb74-329" aria-hidden="true" tabindex="-1"></a>newData <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb74-330"><a href="#cb74-330" aria-hidden="true" tabindex="-1"></a>  <span class="at">female =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb74-331"><a href="#cb74-331" aria-hidden="true" tabindex="-1"></a>  <span class="at">ageYears =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(mydata<span class="sc">$</span>ageYears, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">to =</span> <span class="fu">max</span>(mydata<span class="sc">$</span>ageYears, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">length.out =</span> <span class="dv">10000</span>))</span>
<span id="cb74-332"><a href="#cb74-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-333"><a href="#cb74-333" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>ageYearsCentered <span class="ot">&lt;-</span> newData<span class="sc">$</span>ageYears <span class="sc">-</span> <span class="fu">min</span>(newData<span class="sc">$</span>ageYears)</span>
<span id="cb74-334"><a href="#cb74-334" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>ageYearsCenteredSquared <span class="ot">&lt;-</span> newData<span class="sc">$</span>ageYearsCentered <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb74-335"><a href="#cb74-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-336"><a href="#cb74-336" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb74-337"><a href="#cb74-337" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex[<span class="fu">which</span>(newData<span class="sc">$</span>female <span class="sc">==</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="st">"male"</span></span>
<span id="cb74-338"><a href="#cb74-338" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex[<span class="fu">which</span>(newData<span class="sc">$</span>female <span class="sc">==</span> <span class="dv">1</span>)] <span class="ot">&lt;-</span> <span class="st">"female"</span></span>
<span id="cb74-339"><a href="#cb74-339" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(newData<span class="sc">$</span>sex)</span>
<span id="cb74-340"><a href="#cb74-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-341"><a href="#cb74-341" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>predictedValue <span class="ot">&lt;-</span> <span class="fu">predict</span>( <span class="co"># predict.merMod</span></span>
<span id="cb74-342"><a href="#cb74-342" aria-hidden="true" tabindex="-1"></a>  quadraticGCM,</span>
<span id="cb74-343"><a href="#cb74-343" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> newData,</span>
<span id="cb74-344"><a href="#cb74-344" aria-hidden="true" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="cn">NA</span></span>
<span id="cb74-345"><a href="#cb74-345" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-346"><a href="#cb74-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-347"><a href="#cb74-347" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-348"><a href="#cb74-348" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> newData,</span>
<span id="cb74-349"><a href="#cb74-349" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-350"><a href="#cb74-350" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ageYears,</span>
<span id="cb74-351"><a href="#cb74-351" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> predictedValue,</span>
<span id="cb74-352"><a href="#cb74-352" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb74-353"><a href="#cb74-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-354"><a href="#cb74-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-355"><a href="#cb74-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb74-356"><a href="#cb74-356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-357"><a href="#cb74-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-358"><a href="#cb74-358" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individuals' Growth Curves</span></span>
<span id="cb74-359"><a href="#cb74-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-362"><a href="#cb74-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-363"><a href="#cb74-363" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>predictedValue <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb74-364"><a href="#cb74-364" aria-hidden="true" tabindex="-1"></a>  quadraticGCM,</span>
<span id="cb74-365"><a href="#cb74-365" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> mydata,</span>
<span id="cb74-366"><a href="#cb74-366" aria-hidden="true" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="cn">NULL</span></span>
<span id="cb74-367"><a href="#cb74-367" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-368"><a href="#cb74-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-369"><a href="#cb74-369" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-370"><a href="#cb74-370" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-371"><a href="#cb74-371" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-372"><a href="#cb74-372" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ageYears,</span>
<span id="cb74-373"><a href="#cb74-373" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> predictedValue,</span>
<span id="cb74-374"><a href="#cb74-374" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb74-375"><a href="#cb74-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-376"><a href="#cb74-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-377"><a href="#cb74-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb74-378"><a href="#cb74-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-379"><a href="#cb74-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-380"><a href="#cb74-380" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individuals' Trajectories Overlaid with Prototypical Trajectory</span></span>
<span id="cb74-381"><a href="#cb74-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-384"><a href="#cb74-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-385"><a href="#cb74-385" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-386"><a href="#cb74-386" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-387"><a href="#cb74-387" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-388"><a href="#cb74-388" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ageYears,</span>
<span id="cb74-389"><a href="#cb74-389" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> predictedValue,</span>
<span id="cb74-390"><a href="#cb74-390" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb74-391"><a href="#cb74-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-392"><a href="#cb74-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-393"><a href="#cb74-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb74-394"><a href="#cb74-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb74-395"><a href="#cb74-395" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newData,</span>
<span id="cb74-396"><a href="#cb74-396" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-397"><a href="#cb74-397" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> ageYears,</span>
<span id="cb74-398"><a href="#cb74-398" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> predictedValue,</span>
<span id="cb74-399"><a href="#cb74-399" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> sex,</span>
<span id="cb74-400"><a href="#cb74-400" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> sex),</span>
<span id="cb74-401"><a href="#cb74-401" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">2</span>)</span>
<span id="cb74-402"><a href="#cb74-402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-403"><a href="#cb74-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-404"><a href="#cb74-404" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract Random Effects</span></span>
<span id="cb74-405"><a href="#cb74-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-408"><a href="#cb74-408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-409"><a href="#cb74-409" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb74-410"><a href="#cb74-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-411"><a href="#cb74-411" aria-hidden="true" tabindex="-1"></a><span class="fu">ranef</span>(quadraticGCM)</span>
<span id="cb74-412"><a href="#cb74-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-413"><a href="#cb74-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-416"><a href="#cb74-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-417"><a href="#cb74-417" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb74-418"><a href="#cb74-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-419"><a href="#cb74-419" aria-hidden="true" tabindex="-1"></a>quadraticGCM_re <span class="ot">&lt;-</span> <span class="fu">ranef</span>(quadraticGCM)</span>
<span id="cb74-420"><a href="#cb74-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-421"><a href="#cb74-421" aria-hidden="true" tabindex="-1"></a>quadraticGCM_re<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">head</span>(quadraticGCM_re<span class="sc">$</span>id)</span>
<span id="cb74-422"><a href="#cb74-422" aria-hidden="true" tabindex="-1"></a>quadraticGCM_re</span>
<span id="cb74-423"><a href="#cb74-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-424"><a href="#cb74-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-425"><a href="#cb74-425" aria-hidden="true" tabindex="-1"></a><span class="fu">### Spline Growth Curve Model {#splineGCM}</span></span>
<span id="cb74-426"><a href="#cb74-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-427"><a href="#cb74-427" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Create Knot</span></span>
<span id="cb74-428"><a href="#cb74-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-431"><a href="#cb74-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-432"><a href="#cb74-432" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>knot <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb74-433"><a href="#cb74-433" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>knot[<span class="fu">which</span>(mydata<span class="sc">$</span>ageYears <span class="sc">&lt;=</span> <span class="dv">11</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb74-434"><a href="#cb74-434" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>knot[<span class="fu">which</span>(mydata<span class="sc">$</span>ageYears <span class="sc">&gt;</span> <span class="dv">11</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb74-435"><a href="#cb74-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-436"><a href="#cb74-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-437"><a href="#cb74-437" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb74-438"><a href="#cb74-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-441"><a href="#cb74-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-442"><a href="#cb74-442" aria-hidden="true" tabindex="-1"></a>splineGCM <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb74-443"><a href="#cb74-443" aria-hidden="true" tabindex="-1"></a>  math <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered <span class="sc">+</span> female<span class="sc">:</span>ageYearsCentered <span class="sc">+</span> knot <span class="sc">+</span> knot<span class="sc">:</span>ageYearsCentered <span class="sc">+</span> female<span class="sc">:</span>knot <span class="sc">+</span> female<span class="sc">:</span>knot<span class="sc">:</span>ageYearsCentered <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> ageYearsCentered <span class="sc">|</span> id), <span class="co"># random intercepts and linear slopes; fixed quadratic slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span id="cb74-444"><a href="#cb74-444" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-445"><a href="#cb74-445" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span id="cb74-446"><a href="#cb74-446" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb74-447"><a href="#cb74-447" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span>
<span id="cb74-448"><a href="#cb74-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-449"><a href="#cb74-449" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(splineGCM)</span>
<span id="cb74-450"><a href="#cb74-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-451"><a href="#cb74-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-452"><a href="#cb74-452" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Protoypical Growth Curve</span></span>
<span id="cb74-453"><a href="#cb74-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-456"><a href="#cb74-456" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-457"><a href="#cb74-457" aria-hidden="true" tabindex="-1"></a>newData <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb74-458"><a href="#cb74-458" aria-hidden="true" tabindex="-1"></a>  <span class="at">female =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb74-459"><a href="#cb74-459" aria-hidden="true" tabindex="-1"></a>  <span class="at">ageYears =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(mydata<span class="sc">$</span>ageYears, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">to =</span> <span class="fu">max</span>(mydata<span class="sc">$</span>ageYears, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">length.out =</span> <span class="dv">10000</span>))</span>
<span id="cb74-460"><a href="#cb74-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-461"><a href="#cb74-461" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>ageYearsCentered <span class="ot">&lt;-</span> newData<span class="sc">$</span>ageYears <span class="sc">-</span> <span class="fu">min</span>(newData<span class="sc">$</span>ageYears)</span>
<span id="cb74-462"><a href="#cb74-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-463"><a href="#cb74-463" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>knot <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb74-464"><a href="#cb74-464" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>knot[<span class="fu">which</span>(newData<span class="sc">$</span>ageYears <span class="sc">&lt;=</span> <span class="dv">11</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb74-465"><a href="#cb74-465" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>knot[<span class="fu">which</span>(newData<span class="sc">$</span>ageYears <span class="sc">&gt;</span> <span class="dv">11</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb74-466"><a href="#cb74-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-467"><a href="#cb74-467" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb74-468"><a href="#cb74-468" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex[<span class="fu">which</span>(newData<span class="sc">$</span>female <span class="sc">==</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="st">"male"</span></span>
<span id="cb74-469"><a href="#cb74-469" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex[<span class="fu">which</span>(newData<span class="sc">$</span>female <span class="sc">==</span> <span class="dv">1</span>)] <span class="ot">&lt;-</span> <span class="st">"female"</span></span>
<span id="cb74-470"><a href="#cb74-470" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(newData<span class="sc">$</span>sex)</span>
<span id="cb74-471"><a href="#cb74-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-472"><a href="#cb74-472" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>predictedValue <span class="ot">&lt;-</span> <span class="fu">predict</span>( <span class="co"># predict.merMod</span></span>
<span id="cb74-473"><a href="#cb74-473" aria-hidden="true" tabindex="-1"></a>  splineGCM,</span>
<span id="cb74-474"><a href="#cb74-474" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> newData,</span>
<span id="cb74-475"><a href="#cb74-475" aria-hidden="true" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="cn">NA</span></span>
<span id="cb74-476"><a href="#cb74-476" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-477"><a href="#cb74-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-478"><a href="#cb74-478" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-479"><a href="#cb74-479" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> newData,</span>
<span id="cb74-480"><a href="#cb74-480" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-481"><a href="#cb74-481" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ageYears,</span>
<span id="cb74-482"><a href="#cb74-482" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> predictedValue,</span>
<span id="cb74-483"><a href="#cb74-483" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb74-484"><a href="#cb74-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-485"><a href="#cb74-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-486"><a href="#cb74-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb74-487"><a href="#cb74-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-488"><a href="#cb74-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-489"><a href="#cb74-489" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individuals' Growth Curves</span></span>
<span id="cb74-490"><a href="#cb74-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-493"><a href="#cb74-493" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-494"><a href="#cb74-494" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>predictedValue <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb74-495"><a href="#cb74-495" aria-hidden="true" tabindex="-1"></a>  splineGCM,</span>
<span id="cb74-496"><a href="#cb74-496" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> mydata,</span>
<span id="cb74-497"><a href="#cb74-497" aria-hidden="true" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="cn">NULL</span></span>
<span id="cb74-498"><a href="#cb74-498" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-499"><a href="#cb74-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-500"><a href="#cb74-500" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-501"><a href="#cb74-501" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-502"><a href="#cb74-502" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-503"><a href="#cb74-503" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ageYears,</span>
<span id="cb74-504"><a href="#cb74-504" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> predictedValue,</span>
<span id="cb74-505"><a href="#cb74-505" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb74-506"><a href="#cb74-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-507"><a href="#cb74-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-508"><a href="#cb74-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb74-509"><a href="#cb74-509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-510"><a href="#cb74-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-511"><a href="#cb74-511" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individuals' Trajectories Overlaid with Prototypical Trajectory</span></span>
<span id="cb74-512"><a href="#cb74-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-515"><a href="#cb74-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-516"><a href="#cb74-516" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-517"><a href="#cb74-517" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-518"><a href="#cb74-518" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-519"><a href="#cb74-519" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ageYears,</span>
<span id="cb74-520"><a href="#cb74-520" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> predictedValue,</span>
<span id="cb74-521"><a href="#cb74-521" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb74-522"><a href="#cb74-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-523"><a href="#cb74-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-524"><a href="#cb74-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb74-525"><a href="#cb74-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb74-526"><a href="#cb74-526" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newData,</span>
<span id="cb74-527"><a href="#cb74-527" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-528"><a href="#cb74-528" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> ageYears,</span>
<span id="cb74-529"><a href="#cb74-529" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> predictedValue,</span>
<span id="cb74-530"><a href="#cb74-530" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> sex,</span>
<span id="cb74-531"><a href="#cb74-531" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> sex),</span>
<span id="cb74-532"><a href="#cb74-532" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">2</span>)</span>
<span id="cb74-533"><a href="#cb74-533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-534"><a href="#cb74-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-535"><a href="#cb74-535" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract Random Effects</span></span>
<span id="cb74-536"><a href="#cb74-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-539"><a href="#cb74-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-540"><a href="#cb74-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb74-541"><a href="#cb74-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-542"><a href="#cb74-542" aria-hidden="true" tabindex="-1"></a><span class="fu">ranef</span>(splineGCM)</span>
<span id="cb74-543"><a href="#cb74-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-544"><a href="#cb74-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-547"><a href="#cb74-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-548"><a href="#cb74-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb74-549"><a href="#cb74-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-550"><a href="#cb74-550" aria-hidden="true" tabindex="-1"></a>splineGCM_re <span class="ot">&lt;-</span> <span class="fu">ranef</span>(splineGCM)</span>
<span id="cb74-551"><a href="#cb74-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-552"><a href="#cb74-552" aria-hidden="true" tabindex="-1"></a>splineGCM_re<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">head</span>(splineGCM_re<span class="sc">$</span>id)</span>
<span id="cb74-553"><a href="#cb74-553" aria-hidden="true" tabindex="-1"></a>splineGCM_re</span>
<span id="cb74-554"><a href="#cb74-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-555"><a href="#cb74-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-556"><a href="#cb74-556" aria-hidden="true" tabindex="-1"></a><span class="fu"># Generalized Linear Mixed Models {#generalized}</span></span>
<span id="cb74-557"><a href="#cb74-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-558"><a href="#cb74-558" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/9RFS-BCE7&gt;</span>; source code: <span class="ot">&lt;https://github.com/bbolker/mixedmodels-misc/blob/master/glmmFAQ.rmd&gt;</span>)</span>
<span id="cb74-559"><a href="#cb74-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-560"><a href="#cb74-560" aria-hidden="true" tabindex="-1"></a><span class="fu">## `lmer`</span></span>
<span id="cb74-561"><a href="#cb74-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-564"><a href="#cb74-564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-565"><a href="#cb74-565" aria-hidden="true" tabindex="-1"></a>generalizedLinearMixedModel <span class="ot">&lt;-</span> <span class="fu">glmer</span>(</span>
<span id="cb74-566"><a href="#cb74-566" aria-hidden="true" tabindex="-1"></a>  outcome <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered <span class="sc">+</span> (ageYearsCentered <span class="sc">|</span> id),</span>
<span id="cb74-567"><a href="#cb74-567" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb74-568"><a href="#cb74-568" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-569"><a href="#cb74-569" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb74-570"><a href="#cb74-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-571"><a href="#cb74-571" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(generalizedLinearMixedModel)</span>
<span id="cb74-572"><a href="#cb74-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-573"><a href="#cb74-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-574"><a href="#cb74-574" aria-hidden="true" tabindex="-1"></a><span class="fu">## `MASS`</span></span>
<span id="cb74-575"><a href="#cb74-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-578"><a href="#cb74-578" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-579"><a href="#cb74-579" aria-hidden="true" tabindex="-1"></a>glmmPQLmodel <span class="ot">&lt;-</span> <span class="fu">glmmPQL</span>(</span>
<span id="cb74-580"><a href="#cb74-580" aria-hidden="true" tabindex="-1"></a>  outcome <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered,</span>
<span id="cb74-581"><a href="#cb74-581" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> ageYearsCentered<span class="sc">|</span>id,</span>
<span id="cb74-582"><a href="#cb74-582" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb74-583"><a href="#cb74-583" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata)</span>
<span id="cb74-584"><a href="#cb74-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-585"><a href="#cb74-585" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glmmPQLmodel)</span>
<span id="cb74-586"><a href="#cb74-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-587"><a href="#cb74-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-588"><a href="#cb74-588" aria-hidden="true" tabindex="-1"></a><span class="fu">## `MCMCglmm`</span></span>
<span id="cb74-589"><a href="#cb74-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-592"><a href="#cb74-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-593"><a href="#cb74-593" aria-hidden="true" tabindex="-1"></a>MCMCglmmModel <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(</span>
<span id="cb74-594"><a href="#cb74-594" aria-hidden="true" tabindex="-1"></a>  outcome <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered,</span>
<span id="cb74-595"><a href="#cb74-595" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> <span class="fu">us</span>(ageYearsCentered)<span class="sc">:</span>id,</span>
<span id="cb74-596"><a href="#cb74-596" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb74-597"><a href="#cb74-597" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"id"</span>,<span class="st">"outcome"</span>,<span class="st">"female"</span>,<span class="st">"ageYearsCentered"</span>)]))</span>
<span id="cb74-598"><a href="#cb74-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-599"><a href="#cb74-599" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(MCMCglmmModel)</span>
<span id="cb74-600"><a href="#cb74-600" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-601"><a href="#cb74-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-602"><a href="#cb74-602" aria-hidden="true" tabindex="-1"></a><span class="fu"># Nonlinear Mixed Models {#nonlinear}</span></span>
<span id="cb74-603"><a href="#cb74-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-606"><a href="#cb74-606" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-607"><a href="#cb74-607" aria-hidden="true" tabindex="-1"></a>nonlinearModel <span class="ot">&lt;-</span> <span class="fu">nlme</span>(</span>
<span id="cb74-608"><a href="#cb74-608" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> <span class="fu">SSasymp</span>(age, Asym, R0, lrc),</span>
<span id="cb74-609"><a href="#cb74-609" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Loblolly,</span>
<span id="cb74-610"><a href="#cb74-610" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed =</span> Asym <span class="sc">+</span> R0 <span class="sc">+</span> lrc <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb74-611"><a href="#cb74-611" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> Asym <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb74-612"><a href="#cb74-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-613"><a href="#cb74-613" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nonlinearModel)</span>
<span id="cb74-614"><a href="#cb74-614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-615"><a href="#cb74-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-616"><a href="#cb74-616" aria-hidden="true" tabindex="-1"></a><span class="fu"># Robust Mixed Models</span></span>
<span id="cb74-617"><a href="#cb74-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-618"><a href="#cb74-618" aria-hidden="true" tabindex="-1"></a>To evaluate the extent to which a finding could driven by outliers, this could be done in a number of different ways, such as:</span>
<span id="cb74-619"><a href="#cb74-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-620"><a href="#cb74-620" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>identifying and excluding influential observations based on DFBETAS or Cook’s distance (Nieuwenhuis, Grotenhuis, &amp; Pelzer, 2012)</span>
<span id="cb74-621"><a href="#cb74-621" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>fitting mixed models using rank-based estimation (Bilgic &amp; Susmann, 2013; Finch, 2017) or robust estimating equations (Koller, 2016)</span>
<span id="cb74-622"><a href="#cb74-622" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>estimating robust standard errors using a sandwich estimator (Wang &amp; Merkle, 2018)</span>
<span id="cb74-623"><a href="#cb74-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-624"><a href="#cb74-624" aria-hidden="true" tabindex="-1"></a><span class="fu"># Assumptions</span></span>
<span id="cb74-625"><a href="#cb74-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-626"><a href="#cb74-626" aria-hidden="true" tabindex="-1"></a>The within-group errors:</span>
<span id="cb74-627"><a href="#cb74-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-628"><a href="#cb74-628" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>are independent</span>
<span id="cb74-629"><a href="#cb74-629" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>are identically normally distributed</span>
<span id="cb74-630"><a href="#cb74-630" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>have mean zero and variance sigma-squared</span>
<span id="cb74-631"><a href="#cb74-631" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>are independent of the random effects</span>
<span id="cb74-632"><a href="#cb74-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-633"><a href="#cb74-633" aria-hidden="true" tabindex="-1"></a>The random effects:</span>
<span id="cb74-634"><a href="#cb74-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-635"><a href="#cb74-635" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>are normally distributed</span>
<span id="cb74-636"><a href="#cb74-636" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>have mean zero and covariance matrix Psi (not depending on the group)</span>
<span id="cb74-637"><a href="#cb74-637" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>are independent for different groups</span>
<span id="cb74-638"><a href="#cb74-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-639"><a href="#cb74-639" aria-hidden="true" tabindex="-1"></a><span class="fu"># Examining Model Assumptions</span></span>
<span id="cb74-640"><a href="#cb74-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-641"><a href="#cb74-641" aria-hidden="true" tabindex="-1"></a><span class="fu">## Resources</span></span>
<span id="cb74-642"><a href="#cb74-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-643"><a href="#cb74-643" aria-hidden="true" tabindex="-1"></a>Pinheiro and Bates (2000) book (p. 174, section 4.3.1)</span>
<span id="cb74-644"><a href="#cb74-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-645"><a href="#cb74-645" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.stackexchange.com/questions/77891/checking-assumptions-lmer-lme-mixed-models-in-r&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/J5GC-PCUT&gt;</span>)</span>
<span id="cb74-646"><a href="#cb74-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-647"><a href="#cb74-647" aria-hidden="true" tabindex="-1"></a><span class="fu">## QQ Plots</span></span>
<span id="cb74-648"><a href="#cb74-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-649"><a href="#cb74-649" aria-hidden="true" tabindex="-1"></a>Make QQ plots for each level of the random effects.</span>
<span id="cb74-650"><a href="#cb74-650" aria-hidden="true" tabindex="-1"></a>Vary the level from 0, 1, to 2 so that you can check the between- and within-subject residuals.</span>
<span id="cb74-651"><a href="#cb74-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-654"><a href="#cb74-654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-655"><a href="#cb74-655" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(linearMixedModel_nlme,</span>
<span id="cb74-656"><a href="#cb74-656" aria-hidden="true" tabindex="-1"></a>       <span class="sc">~</span> <span class="fu">ranef</span>(., <span class="at">level =</span> <span class="dv">1</span>))</span>
<span id="cb74-657"><a href="#cb74-657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-658"><a href="#cb74-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-659"><a href="#cb74-659" aria-hidden="true" tabindex="-1"></a><span class="fu">## PP Plots</span></span>
<span id="cb74-660"><a href="#cb74-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-663"><a href="#cb74-663" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-664"><a href="#cb74-664" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(linearMixedModel)</span>
<span id="cb74-665"><a href="#cb74-665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-666"><a href="#cb74-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-667"><a href="#cb74-667" aria-hidden="true" tabindex="-1"></a><span class="fu">## QQ Plot of residuals</span></span>
<span id="cb74-668"><a href="#cb74-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-671"><a href="#cb74-671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-672"><a href="#cb74-672" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(linearMixedModel))</span>
<span id="cb74-673"><a href="#cb74-673" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(linearMixedModel))</span>
<span id="cb74-674"><a href="#cb74-674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-675"><a href="#cb74-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-676"><a href="#cb74-676" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot residuals</span></span>
<span id="cb74-677"><a href="#cb74-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-680"><a href="#cb74-680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-681"><a href="#cb74-681" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(linearMixedModel)</span>
<span id="cb74-682"><a href="#cb74-682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-683"><a href="#cb74-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-684"><a href="#cb74-684" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot residuals by group (in the example below, level 2 represents the individual)</span></span>
<span id="cb74-685"><a href="#cb74-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-688"><a href="#cb74-688" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-689"><a href="#cb74-689" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(linearMixedModel,</span>
<span id="cb74-690"><a href="#cb74-690" aria-hidden="true" tabindex="-1"></a>     <span class="fu">as.factor</span>(id) <span class="sc">~</span> <span class="fu">resid</span>(.),</span>
<span id="cb74-691"><a href="#cb74-691" aria-hidden="true" tabindex="-1"></a>     <span class="at">abline =</span> <span class="dv">0</span>,</span>
<span id="cb74-692"><a href="#cb74-692" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb74-693"><a href="#cb74-693" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-694"><a href="#cb74-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-695"><a href="#cb74-695" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot residuals by levels of a predictor</span></span>
<span id="cb74-696"><a href="#cb74-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-699"><a href="#cb74-699" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-700"><a href="#cb74-700" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(linearMixedModel_nlme,</span>
<span id="cb74-701"><a href="#cb74-701" aria-hidden="true" tabindex="-1"></a>     <span class="fu">resid</span>(., <span class="at">type =</span> <span class="st">"p"</span>) <span class="sc">~</span> <span class="fu">fitted</span>(.) <span class="sc">|</span> female) <span class="co">#type = "p" specifies standardized residuals</span></span>
<span id="cb74-702"><a href="#cb74-702" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-703"><a href="#cb74-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-704"><a href="#cb74-704" aria-hidden="true" tabindex="-1"></a><span class="fu">## Can model heteroscedasticity of the within-group error with the weights argument</span></span>
<span id="cb74-705"><a href="#cb74-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-708"><a href="#cb74-708" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-709"><a href="#cb74-709" aria-hidden="true" tabindex="-1"></a>linearMixedModel_nlmeVarStructure <span class="ot">&lt;-</span> <span class="fu">lme</span>(</span>
<span id="cb74-710"><a href="#cb74-710" aria-hidden="true" tabindex="-1"></a>  math <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered,</span>
<span id="cb74-711"><a href="#cb74-711" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> ageYearsCentered<span class="sc">|</span>id,</span>
<span id="cb74-712"><a href="#cb74-712" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> female),</span>
<span id="cb74-713"><a href="#cb74-713" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"ML"</span>,</span>
<span id="cb74-714"><a href="#cb74-714" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-715"><a href="#cb74-715" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb74-716"><a href="#cb74-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-717"><a href="#cb74-717" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linearMixedModel_nlmeVarStructure)</span>
<span id="cb74-718"><a href="#cb74-718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-719"><a href="#cb74-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-720"><a href="#cb74-720" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot observed and fitted values</span></span>
<span id="cb74-721"><a href="#cb74-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-724"><a href="#cb74-724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-725"><a href="#cb74-725" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(linearMixedModel,</span>
<span id="cb74-726"><a href="#cb74-726" aria-hidden="true" tabindex="-1"></a>     math <span class="sc">~</span> <span class="fu">fitted</span>(.))</span>
<span id="cb74-727"><a href="#cb74-727" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-728"><a href="#cb74-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-729"><a href="#cb74-729" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot QQ plot of residuals by levels of a predictor</span></span>
<span id="cb74-730"><a href="#cb74-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-733"><a href="#cb74-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-734"><a href="#cb74-734" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(linearMixedModel_nlme, <span class="sc">~</span> <span class="fu">resid</span>(.) <span class="sc">|</span> female)</span>
<span id="cb74-735"><a href="#cb74-735" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(linearMixedModel_nlme, <span class="sc">~</span> <span class="fu">resid</span>(.))</span>
<span id="cb74-736"><a href="#cb74-736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-737"><a href="#cb74-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-738"><a href="#cb74-738" aria-hidden="true" tabindex="-1"></a><span class="fu">## QQ plot of random effects</span></span>
<span id="cb74-739"><a href="#cb74-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-740"><a href="#cb74-740" aria-hidden="true" tabindex="-1"></a>Make QQ plots for each level of the random effects.</span>
<span id="cb74-741"><a href="#cb74-741" aria-hidden="true" tabindex="-1"></a>Vary the level from 0, 1, to 2 so that you can check the between- and within-subject residuals.</span>
<span id="cb74-742"><a href="#cb74-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-743"><a href="#cb74-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-746"><a href="#cb74-746" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-747"><a href="#cb74-747" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(linearMixedModel_nlme,</span>
<span id="cb74-748"><a href="#cb74-748" aria-hidden="true" tabindex="-1"></a>       <span class="sc">~</span> <span class="fu">ranef</span>(., <span class="at">level =</span> <span class="dv">0</span>))</span>
<span id="cb74-749"><a href="#cb74-749" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(linearMixedModel_nlme,</span>
<span id="cb74-750"><a href="#cb74-750" aria-hidden="true" tabindex="-1"></a>       <span class="sc">~</span> <span class="fu">ranef</span>(., <span class="at">level =</span> <span class="dv">1</span>))</span>
<span id="cb74-751"><a href="#cb74-751" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(linearMixedModel_nlme,</span>
<span id="cb74-752"><a href="#cb74-752" aria-hidden="true" tabindex="-1"></a>       <span class="sc">~</span> <span class="fu">ranef</span>(., <span class="at">level =</span> <span class="dv">2</span>))</span>
<span id="cb74-753"><a href="#cb74-753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-754"><a href="#cb74-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-755"><a href="#cb74-755" aria-hidden="true" tabindex="-1"></a><span class="fu">## QQ plot of random effects by levels of a predictor</span></span>
<span id="cb74-756"><a href="#cb74-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-759"><a href="#cb74-759" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-760"><a href="#cb74-760" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(linearMixedModel_nlme, </span>
<span id="cb74-761"><a href="#cb74-761" aria-hidden="true" tabindex="-1"></a>       <span class="sc">~</span> <span class="fu">ranef</span>(., <span class="at">level =</span> <span class="dv">1</span>) <span class="sc">|</span> female)</span>
<span id="cb74-762"><a href="#cb74-762" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-763"><a href="#cb74-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-764"><a href="#cb74-764" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pairs plot</span></span>
<span id="cb74-765"><a href="#cb74-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-768"><a href="#cb74-768" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-769"><a href="#cb74-769" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(linearMixedModel_nlme)</span>
<span id="cb74-770"><a href="#cb74-770" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(linearMixedModel_nlme,</span>
<span id="cb74-771"><a href="#cb74-771" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">ranef</span>(., <span class="at">level =</span> <span class="dv">1</span>) <span class="sc">|</span> female)</span>
<span id="cb74-772"><a href="#cb74-772" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-773"><a href="#cb74-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-774"><a href="#cb74-774" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variance functions for modeling heteroscedasticity</span></span>
<span id="cb74-775"><a href="#cb74-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-776"><a href="#cb74-776" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`varFixed`</span>: fixed variance</span>
<span id="cb74-777"><a href="#cb74-777" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`varIdent`</span>: different variances per stratum</span>
<span id="cb74-778"><a href="#cb74-778" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`varPower`</span>: power of covariate</span>
<span id="cb74-779"><a href="#cb74-779" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`varExp`</span>: exponential of covariate</span>
<span id="cb74-780"><a href="#cb74-780" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`varConstPower`</span>: constant plus power of covariate</span>
<span id="cb74-781"><a href="#cb74-781" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`varComb`</span>: combination of variance functions</span>
<span id="cb74-782"><a href="#cb74-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-783"><a href="#cb74-783" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlation structures for modeling dependence</span></span>
<span id="cb74-784"><a href="#cb74-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-785"><a href="#cb74-785" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corCompSymm`</span>: compound symmetry</span>
<span id="cb74-786"><a href="#cb74-786" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corSymm`</span>: general</span>
<span id="cb74-787"><a href="#cb74-787" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corAR1`</span>: autoregressive of order 1</span>
<span id="cb74-788"><a href="#cb74-788" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corCAR1`</span>: continuous-time AR(1)</span>
<span id="cb74-789"><a href="#cb74-789" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corARMA`</span>: autoregressive-moving average</span>
<span id="cb74-790"><a href="#cb74-790" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corExp`</span>: exponential</span>
<span id="cb74-791"><a href="#cb74-791" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corGaus`</span>: Gaussian</span>
<span id="cb74-792"><a href="#cb74-792" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corLin`</span>: linear</span>
<span id="cb74-793"><a href="#cb74-793" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corRatio`</span>: rational quadratic</span>
<span id="cb74-794"><a href="#cb74-794" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corSpher`</span>: spherical</span>
<span id="cb74-795"><a href="#cb74-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-796"><a href="#cb74-796" aria-hidden="true" tabindex="-1"></a><span class="fu"># Power Analysis {#powerAnalysis}</span></span>
<span id="cb74-797"><a href="#cb74-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-798"><a href="#cb74-798" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`mlmpower`</span>: <span class="ot">&lt;https://github.com/bkeller2/mlmpower&gt;</span> (<span class="co">[</span><span class="ot">Enders et al., 2025</span><span class="co">](https://doi.org/10.1037/met0000614)</span>)</span>
<span id="cb74-799"><a href="#cb74-799" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://aguinis.shinyapps.io/ml_power/&gt;</span></span>
<span id="cb74-800"><a href="#cb74-800" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://www.causalevaluation.org/power-analysis.html&gt;</span></span>
<span id="cb74-801"><a href="#cb74-801" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="ot">&lt;https://powerupr.shinyapps.io/index/&gt;</span></span>
<span id="cb74-802"><a href="#cb74-802" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://koumurayama.shinyapps.io/tmethod_mlm/&gt;</span></span>
<span id="cb74-803"><a href="#cb74-803" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://webpower.psychstat.org/wiki/models/index&gt;</span></span>
<span id="cb74-804"><a href="#cb74-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-805"><a href="#cb74-805" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session Info</span></span>
<span id="cb74-806"><a href="#cb74-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-809"><a href="#cb74-809" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-810"><a href="#cb74-810" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb74-811"><a href="#cb74-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-812"><a href="#cb74-812" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb74-813"><a href="#cb74-813" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/DevPsyLab/DataAnalysis/edit/main/hlm.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/blob/main/hlm.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>