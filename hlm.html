<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Isaac T. Petersen">
<meta name="dcterms.date" content="today">
<title>Hierarchical Linear Modeling – Data Analysis Guides for the Developmental Psychopathology Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d640c705e8c17715bca3574aa719063f.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9278de052701f0b3f1191ef96b26c196.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-TYR0QMREEW', { 'anonymize_ip': true});
</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><link rel="stylesheet" href="styles.css">
<link rel="stylesheet" href="includes/custom.css">
<link rel="stylesheet" href="font/css/roboto.css">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/labLogo.png" alt="" class="navbar-logo light-content"><img src="./images/labLogo.png" alt="" class="navbar-logo dark-content"></a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Data Analysis Guides for the Developmental Psychopathology Lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-datasets" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Datasets</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-datasets">
<li>
    <a class="dropdown-item" href="./abcdData.html">
 <span class="dropdown-text">ABCD Study Data</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analysis-techniques" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Analysis Techniques</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analysis-techniques">
<li>
    <a class="dropdown-item" href="./bayesian.html">
 <span class="dropdown-text">Bayesian Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dataManagement.html">
 <span class="dropdown-text">Data Management</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dags.html">
 <span class="dropdown-text">Directed Acyclic Graphs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eegERP.html">
 <span class="dropdown-text">Electroencephalography/Event-Related Potentials</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eda.html">
 <span class="dropdown-text">Exploratory Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./factorAnalysis.html">
 <span class="dropdown-text">Factor Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./figures.html">
 <span class="dropdown-text">Figures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./hlm.html">
 <span class="dropdown-text">Hierarchical Linear Modeling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./irt.html">
 <span class="dropdown-text">Item Response Theory</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lda.html">
 <span class="dropdown-text">Longitudinal Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sem.html#mediation">
 <span class="dropdown-text">Mediation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regression.html#moderation">
 <span class="dropdown-text">Moderation/Interaction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./multipleImputation.html">
 <span class="dropdown-text">Multiple Imputation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./pca.html">
 <span class="dropdown-text">Principal Component Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regression.html">
 <span class="dropdown-text">Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./statistics.html">
 <span class="dropdown-text">Statistics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sem.html">
 <span class="dropdown-text">Structural Equation Modeling</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-softwareframeworks" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Software/Frameworks</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-softwareframeworks">
<li>
    <a class="dropdown-item" href="./git.html">
 <span class="dropdown-text">Git, GitLab, and GitHub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./hpc.html">
 <span class="dropdown-text">High-Performance Computing Cluster</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jamovi.html">
 <span class="dropdown-text">jamovi</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jatos.html">
 <span class="dropdown-text">JATOS (Just Another Tool for Online Studies)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./jsPsych.html">
 <span class="dropdown-text">jsPsych</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lamp.html">
 <span class="dropdown-text">LAMP (Linux, Apache, MySQL, PHP) Server</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./markdown.html">
 <span class="dropdown-text">Markdown</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mplus.html">
 <span class="dropdown-text">Mplus</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./osf.html">
 <span class="dropdown-text">Open Science Framework</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://devpsylab.github.io/pythonDataAnalysisGuides">
 <span class="dropdown-text">Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./R.html">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SPSS.html">
 <span class="dropdown-text">SPSS</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="https://devpsylab.github.io/LabWiki"> 
<span class="menu-text">Lab Wiki</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://developmental-psychopathology.lab.uiowa.edu"> 
<span class="menu-text">Lab Website</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/DevPsyLab/DataAnalysis">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/DevPsyLab/DataAnalysis/issues/new">
            Report a Bug
            </a>
          </li>
      </ul>
</div>
    <a href="https://twitter.com/devpsylab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="https://www.facebook.com/DevPsyLab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-facebook"></i></a>
    <a href="https://www.instagram.com/dev_psy_lab" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-instagram"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./hlm.html">Hierarchical Linear Modeling</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abcdData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ABCD Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataManagement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Management</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dags.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Directed Acyclic Graphs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eegERP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Electroencephalography/Event-Related Potentials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factorAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Factor Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./figures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Git, GitLab, and GitHub</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hlm.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Hierarchical Linear Modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">High-Performance Computing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./irt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Item Response Theory</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jamovi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">jamovi</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jatos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">JATOS (Just Another Tool for Online Studies)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jsPsych.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">jsPsych</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lamp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LAMP (Linux, Apache, MySQL, PHP) Server</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Longitudinal Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markdown</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html#mediation" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mediation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html#moderation" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Moderation/Interaction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mplus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multipleImputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Imputation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./osf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Open Science Framework</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principal Component Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://devpsylab.github.io/pythonDataAnalysisGuides" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SPSS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SPSS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structural Equation Modeling</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li>
<a href="#preamble" id="toc-preamble" class="nav-link active" data-scroll-target="#preamble"><span class="header-section-number">1</span> Preamble</a>
  <ul>
<li><a href="#install-libraries" id="toc-install-libraries" class="nav-link" data-scroll-target="#install-libraries"><span class="header-section-number">1.1</span> Install Libraries</a></li>
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries"><span class="header-section-number">1.2</span> Load Libraries</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="header-section-number">1.3</span> Import Data</a></li>
  <li><a href="#simulate-data" id="toc-simulate-data" class="nav-link" data-scroll-target="#simulate-data"><span class="header-section-number">1.4</span> Simulate Data</a></li>
  </ul>
</li>
  <li><a href="#terms" id="toc-terms" class="nav-link" data-scroll-target="#terms"><span class="header-section-number">2</span> Terms</a></li>
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview"><span class="header-section-number">3</span> Overview</a></li>
  <li><a href="#pre-model-computation" id="toc-pre-model-computation" class="nav-link" data-scroll-target="#pre-model-computation"><span class="header-section-number">4</span> Pre-Model Computation</a></li>
  <li><a href="#estimator-ml-or-reml" id="toc-estimator-ml-or-reml" class="nav-link" data-scroll-target="#estimator-ml-or-reml"><span class="header-section-number">5</span> Estimator: ML or REML</a></li>
  <li>
<a href="#linear" id="toc-linear" class="nav-link" data-scroll-target="#linear"><span class="header-section-number">6</span> Linear Mixed Models</a>
  <ul>
<li>
<a href="#gcm" id="toc-gcm" class="nav-link" data-scroll-target="#gcm"><span class="header-section-number">6.1</span> Growth Curve Models</a>
  <ul>
<li>
<a href="#linearGCM" id="toc-linearGCM" class="nav-link" data-scroll-target="#linearGCM"><span class="header-section-number">6.1.1</span> Linear Growth Curve Model</a>
  <ul class="collapse">
<li><a href="#plot-observed-growth-curves" id="toc-plot-observed-growth-curves" class="nav-link" data-scroll-target="#plot-observed-growth-curves"><span class="header-section-number">6.1.1.1</span> Plot Observed Growth Curves</a></li>
  <li>
<a href="#lme4" id="toc-lme4" class="nav-link" data-scroll-target="#lme4"><span class="header-section-number">6.1.1.2</span> <code>lme4</code></a>
  <ul class="collapse">
<li><a href="#protoypical-growth-curve" id="toc-protoypical-growth-curve" class="nav-link" data-scroll-target="#protoypical-growth-curve"><span class="header-section-number">6.1.1.2.1</span> Protoypical Growth Curve</a></li>
  <li><a href="#individuals-growth-curves" id="toc-individuals-growth-curves" class="nav-link" data-scroll-target="#individuals-growth-curves"><span class="header-section-number">6.1.1.2.2</span> Individuals’ Growth Curves</a></li>
  <li><a href="#individuals-trajectories-overlaid-with-prototypical-trajectory" id="toc-individuals-trajectories-overlaid-with-prototypical-trajectory" class="nav-link" data-scroll-target="#individuals-trajectories-overlaid-with-prototypical-trajectory"><span class="header-section-number">6.1.1.2.3</span> Individuals’ Trajectories Overlaid with Prototypical Trajectory</a></li>
  <li><a href="#extractRandomEffects" id="toc-extractRandomEffects" class="nav-link" data-scroll-target="#extractRandomEffects"><span class="header-section-number">6.1.1.2.4</span> Extract Random Effects</a></li>
  </ul>
</li>
  <li><a href="#nlme" id="toc-nlme" class="nav-link" data-scroll-target="#nlme"><span class="header-section-number">6.1.1.3</span> <code>nlme</code></a></li>
  <li><a href="#icc" id="toc-icc" class="nav-link" data-scroll-target="#icc"><span class="header-section-number">6.1.1.4</span> Intraclass Correlation Coefficent</a></li>
  </ul>
</li>
  <li><a href="#timepointSpecificErrorsGCM" id="toc-timepointSpecificErrorsGCM" class="nav-link" data-scroll-target="#timepointSpecificErrorsGCM"><span class="header-section-number">6.1.2</span> Growth Curve Model with Timepoint-Specific Errors</a></li>
  <li>
<a href="#quadraticGCM" id="toc-quadraticGCM" class="nav-link" data-scroll-target="#quadraticGCM"><span class="header-section-number">6.1.3</span> Quadratic Growth Curve Model</a>
  <ul class="collapse">
<li><a href="#fit-model" id="toc-fit-model" class="nav-link" data-scroll-target="#fit-model"><span class="header-section-number">6.1.3.1</span> Fit Model</a></li>
  <li><a href="#protoypical-growth-curve-1" id="toc-protoypical-growth-curve-1" class="nav-link" data-scroll-target="#protoypical-growth-curve-1"><span class="header-section-number">6.1.3.2</span> Protoypical Growth Curve</a></li>
  <li><a href="#individuals-growth-curves-1" id="toc-individuals-growth-curves-1" class="nav-link" data-scroll-target="#individuals-growth-curves-1"><span class="header-section-number">6.1.3.3</span> Individuals’ Growth Curves</a></li>
  <li><a href="#individuals-trajectories-overlaid-with-prototypical-trajectory-1" id="toc-individuals-trajectories-overlaid-with-prototypical-trajectory-1" class="nav-link" data-scroll-target="#individuals-trajectories-overlaid-with-prototypical-trajectory-1"><span class="header-section-number">6.1.3.4</span> Individuals’ Trajectories Overlaid with Prototypical Trajectory</a></li>
  <li><a href="#extract-random-effects" id="toc-extract-random-effects" class="nav-link" data-scroll-target="#extract-random-effects"><span class="header-section-number">6.1.3.5</span> Extract Random Effects</a></li>
  </ul>
</li>
  <li>
<a href="#splineGCM" id="toc-splineGCM" class="nav-link" data-scroll-target="#splineGCM"><span class="header-section-number">6.1.4</span> Spline Growth Curve Model</a>
  <ul class="collapse">
<li><a href="#create-knot" id="toc-create-knot" class="nav-link" data-scroll-target="#create-knot"><span class="header-section-number">6.1.4.1</span> Create Knot</a></li>
  <li><a href="#fit-model-1" id="toc-fit-model-1" class="nav-link" data-scroll-target="#fit-model-1"><span class="header-section-number">6.1.4.2</span> Fit Model</a></li>
  <li><a href="#protoypical-growth-curve-2" id="toc-protoypical-growth-curve-2" class="nav-link" data-scroll-target="#protoypical-growth-curve-2"><span class="header-section-number">6.1.4.3</span> Protoypical Growth Curve</a></li>
  <li><a href="#individuals-growth-curves-2" id="toc-individuals-growth-curves-2" class="nav-link" data-scroll-target="#individuals-growth-curves-2"><span class="header-section-number">6.1.4.4</span> Individuals’ Growth Curves</a></li>
  <li><a href="#individuals-trajectories-overlaid-with-prototypical-trajectory-2" id="toc-individuals-trajectories-overlaid-with-prototypical-trajectory-2" class="nav-link" data-scroll-target="#individuals-trajectories-overlaid-with-prototypical-trajectory-2"><span class="header-section-number">6.1.4.5</span> Individuals’ Trajectories Overlaid with Prototypical Trajectory</a></li>
  <li><a href="#extract-random-effects-1" id="toc-extract-random-effects-1" class="nav-link" data-scroll-target="#extract-random-effects-1"><span class="header-section-number">6.1.4.6</span> Extract Random Effects</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#generalized" id="toc-generalized" class="nav-link" data-scroll-target="#generalized"><span class="header-section-number">7</span> Generalized Linear Mixed Models</a>
  <ul>
<li><a href="#lmer" id="toc-lmer" class="nav-link" data-scroll-target="#lmer"><span class="header-section-number">7.1</span> <code>lmer</code></a></li>
  <li><a href="#mass" id="toc-mass" class="nav-link" data-scroll-target="#mass"><span class="header-section-number">7.2</span> <code>MASS</code></a></li>
  <li><a href="#mcmcglmm" id="toc-mcmcglmm" class="nav-link" data-scroll-target="#mcmcglmm"><span class="header-section-number">7.3</span> <code>MCMCglmm</code></a></li>
  </ul>
</li>
  <li><a href="#nonlinear" id="toc-nonlinear" class="nav-link" data-scroll-target="#nonlinear"><span class="header-section-number">8</span> Nonlinear Mixed Models</a></li>
  <li><a href="#robust-mixed-models" id="toc-robust-mixed-models" class="nav-link" data-scroll-target="#robust-mixed-models"><span class="header-section-number">9</span> Robust Mixed Models</a></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions"><span class="header-section-number">10</span> Assumptions</a></li>
  <li>
<a href="#examining-model-assumptions" id="toc-examining-model-assumptions" class="nav-link" data-scroll-target="#examining-model-assumptions"><span class="header-section-number">11</span> Examining Model Assumptions</a>
  <ul>
<li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources"><span class="header-section-number">11.1</span> Resources</a></li>
  <li><a href="#qq-plots" id="toc-qq-plots" class="nav-link" data-scroll-target="#qq-plots"><span class="header-section-number">11.2</span> QQ Plots</a></li>
  <li><a href="#pp-plots" id="toc-pp-plots" class="nav-link" data-scroll-target="#pp-plots"><span class="header-section-number">11.3</span> PP Plots</a></li>
  <li><a href="#qq-plot-of-residuals" id="toc-qq-plot-of-residuals" class="nav-link" data-scroll-target="#qq-plot-of-residuals"><span class="header-section-number">11.4</span> QQ Plot of residuals</a></li>
  <li><a href="#plot-residuals" id="toc-plot-residuals" class="nav-link" data-scroll-target="#plot-residuals"><span class="header-section-number">11.5</span> Plot residuals</a></li>
  <li><a href="#plot-residuals-by-group-in-the-example-below-level-2-represents-the-individual" id="toc-plot-residuals-by-group-in-the-example-below-level-2-represents-the-individual" class="nav-link" data-scroll-target="#plot-residuals-by-group-in-the-example-below-level-2-represents-the-individual"><span class="header-section-number">11.6</span> Plot residuals by group (in the example below, level 2 represents the individual)</a></li>
  <li><a href="#plot-residuals-by-levels-of-a-predictor" id="toc-plot-residuals-by-levels-of-a-predictor" class="nav-link" data-scroll-target="#plot-residuals-by-levels-of-a-predictor"><span class="header-section-number">11.7</span> Plot residuals by levels of a predictor</a></li>
  <li><a href="#can-model-heteroscedasticity-of-the-within-group-error-with-the-weights-argument" id="toc-can-model-heteroscedasticity-of-the-within-group-error-with-the-weights-argument" class="nav-link" data-scroll-target="#can-model-heteroscedasticity-of-the-within-group-error-with-the-weights-argument"><span class="header-section-number">11.8</span> Can model heteroscedasticity of the within-group error with the weights argument</a></li>
  <li><a href="#plot-observed-and-fitted-values" id="toc-plot-observed-and-fitted-values" class="nav-link" data-scroll-target="#plot-observed-and-fitted-values"><span class="header-section-number">11.9</span> Plot observed and fitted values</a></li>
  <li><a href="#plot-qq-plot-of-residuals-by-levels-of-a-predictor" id="toc-plot-qq-plot-of-residuals-by-levels-of-a-predictor" class="nav-link" data-scroll-target="#plot-qq-plot-of-residuals-by-levels-of-a-predictor"><span class="header-section-number">11.10</span> Plot QQ plot of residuals by levels of a predictor</a></li>
  <li><a href="#qq-plot-of-random-effects" id="toc-qq-plot-of-random-effects" class="nav-link" data-scroll-target="#qq-plot-of-random-effects"><span class="header-section-number">11.11</span> QQ plot of random effects</a></li>
  <li><a href="#qq-plot-of-random-effects-by-levels-of-a-predictor" id="toc-qq-plot-of-random-effects-by-levels-of-a-predictor" class="nav-link" data-scroll-target="#qq-plot-of-random-effects-by-levels-of-a-predictor"><span class="header-section-number">11.12</span> QQ plot of random effects by levels of a predictor</a></li>
  <li><a href="#pairs-plot" id="toc-pairs-plot" class="nav-link" data-scroll-target="#pairs-plot"><span class="header-section-number">11.13</span> Pairs plot</a></li>
  <li><a href="#variance-functions-for-modeling-heteroscedasticity" id="toc-variance-functions-for-modeling-heteroscedasticity" class="nav-link" data-scroll-target="#variance-functions-for-modeling-heteroscedasticity"><span class="header-section-number">11.14</span> Variance functions for modeling heteroscedasticity</a></li>
  <li><a href="#correlation-structures-for-modeling-dependence" id="toc-correlation-structures-for-modeling-dependence" class="nav-link" data-scroll-target="#correlation-structures-for-modeling-dependence"><span class="header-section-number">11.15</span> Correlation structures for modeling dependence</a></li>
  </ul>
</li>
  <li><a href="#powerAnalysis" id="toc-powerAnalysis" class="nav-link" data-scroll-target="#powerAnalysis"><span class="header-section-number">12</span> Power Analysis</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">13</span> Session Info</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/DevPsyLab/DataAnalysis/edit/main/hlm.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/blob/main/hlm.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Hierarchical Linear Modeling</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="preamble" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Preamble</h1>
<section id="install-libraries" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="install-libraries">
<span class="header-section-number">1.1</span> Install Libraries</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#install.packages("remotes")</span></span>
<span><span class="co">#remotes::install_github("DevPsyLab/petersenlab")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="load-libraries" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="load-libraries">
<span class="header-section-number">1.2</span> Load Libraries</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/DevPsyLab/petersenlab">"petersenlab"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/lme4/lme4/">"lme4"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">"nlme"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/runehaubo/lmerTestR">"lmerTest"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">"MASS"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/jarrodhadfield/MCMCglmm">"MCMCglmm"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://easystats.github.io/performance/">"performance"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="import-data" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="import-data">
<span class="header-section-number">1.3</span> Import Data</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"https://osf.io/cqn3d/download"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="simulate-data" class="level2" data-number="1.4"><h2 data-number="1.4" class="anchored" data-anchor-id="simulate-data">
<span class="header-section-number">1.4</span> Simulate Data</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">52242</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section><section id="terms" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Terms</h1>
<p>These models go by a variety of different terms:</p>
<ul>
<li>hierarchical linear model (HLM)</li>
<li>multilevel model (MLM)</li>
<li>mixed effects model</li>
<li>mixed model</li>
</ul></section><section id="overview" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Overview</h1>
<ul>
<li><a href="https://isaactpetersen.github.io/Principles-Psychological-Assessment/reliability.html#mixedModels" class="uri">https://isaactpetersen.github.io/Principles-Psychological-Assessment/reliability.html#mixedModels</a></li>
<li><a href="https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook/mixed-models.html" class="uri">https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook/mixed-models.html</a></li>
</ul></section><section id="pre-model-computation" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Pre-Model Computation</h1>
<p>It can be helpful to center the age/time variable so that the intercept in a growth curve model has meaning. For instance, we can subtract the youngest participant age to set the intercepts to be the earliest age in the sample.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">&lt;-</span> <span class="va">mydata</span><span class="op">$</span><span class="va">age</span> <span class="op">/</span> <span class="fl">12</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">ageMonthsCentered</span> <span class="op">&lt;-</span> <span class="va">mydata</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYearsCentered</span> <span class="op">&lt;-</span> <span class="va">mydata</span><span class="op">$</span><span class="va">ageMonthsCentered</span> <span class="op">/</span> <span class="fl">12</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYearsCenteredSquared</span> <span class="op">&lt;-</span> <span class="va">mydata</span><span class="op">$</span><span class="va">ageYearsCentered</span> <span class="op">^</span> <span class="fl">2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="estimator-ml-or-reml" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Estimator: ML or REML</h1>
<p>For small sample sizes, restricted maximum likelihood (REML) is preferred over maximum likelihood (ML). ML preferred when there is a small number (&lt; 4) of fixed effects; REML is preferred when there are more (&gt; 4) fixed effects. The greater the number of fixed effects, the greater the difference between REML and ML estimates. Likelihood ratio (LR) tests for REML require exactly the same fixed effects specification in both models. So, to compare models with different fixed effects with an LR test (to determine whether to include a particular fixed effect), ML must be used. In contrast to the maximum likelihood estimation, REML can produce unbiased estimates of variance and covariance parameters, variance estimates are larger in REML than ML. To compare whether an effect should be fixed or random, use REML. To simultaneously compare fixed and random effects, use ML.</p>
</section><section id="linear" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Linear Mixed Models</h1>
<p>The following models are models that are fit in a linear mixed modeling framework.</p>
<section id="gcm" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="gcm">
<span class="header-section-number">6.1</span> Growth Curve Models</h2>
<section id="linearGCM" class="level3" data-number="6.1.1"><h3 data-number="6.1.1" class="anchored" data-anchor-id="linearGCM">
<span class="header-section-number">6.1.1</span> Linear Growth Curve Model</h3>
<section id="plot-observed-growth-curves" class="level4" data-number="6.1.1.1"><h4 data-number="6.1.1.1" class="anchored" data-anchor-id="plot-observed-growth-curves">
<span class="header-section-number">6.1.1.1</span> Plot Observed Growth Curves</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>    y <span class="op">=</span> <span class="va">math</span>,</span>
<span>    group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Math Score"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="hlm_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="lme4" class="level4" data-number="6.1.1.2"><h4 data-number="6.1.1.2" class="anchored" data-anchor-id="lme4">
<span class="header-section-number">6.1.1.2</span> <code>lme4</code>
</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">linearMixedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, <span class="co"># random intercepts and slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linearMixedModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite's
  method [lmerModLmerTest]
Formula: math ~ female + ageYearsCentered + female:ageYearsCentered +  
    (1 + ageYearsCentered | id)
   Data: mydata
Control: lmerControl(optimizer = "bobyqa")

      AIC       BIC    logLik -2*log(L)  df.resid 
  15857.9   15903.5   -7920.9   15841.9      2213 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3750 -0.5174  0.0051  0.5239  2.6396 

Random effects:
 Groups   Name             Variance Std.Dev. Corr
 id       (Intercept)      62.5365  7.9080       
          ageYearsCentered  0.6767  0.8226   0.08
 Residual                  32.1505  5.6701       
Number of obs: 2221, groups:  id, 932

Fixed effects:
                         Estimate Std. Error        df t value Pr(&gt;|t|)    
(Intercept)              30.51401    0.56142 752.48747  54.352   &lt;2e-16 ***
female                   -0.61290    0.79482 736.39886  -0.771    0.441    
ageYearsCentered          4.26792    0.11253 610.09410  37.925   &lt;2e-16 ***
female:ageYearsCentered  -0.02558    0.16092 598.89155  -0.159    0.874    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) female agYrsC
female      -0.706              
ageYrsCntrd -0.635  0.448       
fml:gYrsCnt  0.444 -0.631 -0.699</code></pre>
</div>
</div>
<section id="protoypical-growth-curve" class="level5" data-number="6.1.1.2.1"><h5 data-number="6.1.1.2.1" class="anchored" data-anchor-id="protoypical-growth-curve">
<span class="header-section-number">6.1.1.2.1</span> Protoypical Growth Curve</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">newData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span></span>
<span>  female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ageYears <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">ageYearsCentered</span> <span class="op">&lt;-</span> <span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">female</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"male"</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">female</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"female"</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">predictedValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> <span class="co"># predict.merMod</span></span>
<span>  <span class="va">linearMixedModel</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">newData</span>,</span>
<span>  re.form <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">newData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ageYears</span>, y <span class="op">=</span> <span class="va">predictedValue</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="hlm_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="individuals-growth-curves" class="level5" data-number="6.1.1.2.2"><h5 data-number="6.1.1.2.2" class="anchored" data-anchor-id="individuals-growth-curves">
<span class="header-section-number">6.1.1.2.2</span> Individuals’ Growth Curves</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">predictedValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">linearMixedModel</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  re.form <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ageYears</span>, y <span class="op">=</span> <span class="va">predictedValue</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="hlm_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="individuals-trajectories-overlaid-with-prototypical-trajectory" class="level5" data-number="6.1.1.2.3"><h5 data-number="6.1.1.2.3" class="anchored" data-anchor-id="individuals-trajectories-overlaid-with-prototypical-trajectory">
<span class="header-section-number">6.1.1.2.3</span> Individuals’ Trajectories Overlaid with Prototypical Trajectory</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ageYears</span>, y <span class="op">=</span> <span class="va">predictedValue</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">newData</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ageYears</span>, y <span class="op">=</span> <span class="va">predictedValue</span>, group <span class="op">=</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="hlm_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="extractRandomEffects" class="level5" data-number="6.1.1.2.4"><h5 data-number="6.1.1.2.4" class="anchored" data-anchor-id="extractRandomEffects">
<span class="header-section-number">6.1.1.2.4</span> Extract Random Effects</h5>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">linearMixedModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$id
          (Intercept) ageYearsCentered
201       1.125313761      0.214025701
303     -12.515508864     -0.661489657
2702     12.257492354      0.430762981
4303      2.727957524      0.285002116
5002      1.943700949      0.170789619
5005      4.045982598      0.120286722
5701     12.299499720      0.346624148
6102     10.023593786      0.863981478
6801     10.850796246      0.310493680
6802     11.821009201      0.402109281
6803     13.002187545      0.661133879
9603      4.893027085      0.449774173
12401     2.267934250      0.215890170
12801     3.118093119      0.121909799
13702     9.965512365      0.174385818
13801    14.860587450      0.466936045
13803    12.244139122      0.342974140
17201     8.389382622      0.541441962
18601    -9.114431785     -0.325174564
22104    -8.224888366     -0.162602823
22901    -3.619019303     -0.120180576
23602     8.688461076      0.339697533
23701     3.179383329     -0.022949766
24402     5.504641645      0.352394764
26201     9.719849574      0.702414569
28503    -8.430258804      0.354120841
29201    12.005754759      0.186774027
29202     8.417070934      0.781161659
34401    13.282239330      0.463013476
35401     6.780780604      0.582522293
35402     5.591003405     -0.049981300
36901    15.699222750      0.479509729
36902    10.244502566      0.276867605
37403    -1.843161415     -0.402326018
38202    -3.239859256     -0.028890813
38802    -5.250923211     -0.340856108
40501     3.463053677      0.153135154
40702     7.971281145      0.173100533
42504     2.888138805      0.321177217
42505     6.585722700     -0.155175248
43103     4.433636752      0.238674652
45201     8.183501056      0.541547032
45903    15.716178377      0.502448721
46201    11.011297054      0.881456660
47201    14.720202046      0.427719979
47402     0.880121442     -0.190353845
47601     1.216021904     -0.017165043
48502    -2.519553727      0.312149007
49501     1.743541361      0.182682300
53601    -2.357792771     -0.378382000
55201     8.475516854      0.442472479
55801     2.607026981      0.226992780
56301    -5.108650931      0.279722834
56302    -0.069098635      0.007631557
57604    10.137559691      0.648424109
58503    -9.038592483     -0.145716134
62102     7.594264242      0.514296379
62103   -11.659099523      0.062806196
62202    12.282894687      0.512176358
62703     0.465584787      0.534532255
64002     0.758192010     -0.318985718
65601    12.288113181      0.422395609
65701    11.634539842      0.659937401
66002     4.577549270      0.481784449
70801    -1.720978172     -0.098222417
73602     3.129767946      0.121536903
74602     4.600091569      0.228352651
75603    -8.954581426     -0.158125796
76402     0.105445380     -0.276301811
76403     4.265544047      0.284415843
80102     3.858025733      0.287026976
82901    -3.386576272     -0.285969402
83001    -1.334354997     -0.271017391
83101    -6.092041392     -0.315778466
83102    -0.060917140     -0.148750133
83602     4.330407333     -0.021683400
83603    -0.359555292      0.065349949
85402    -2.755742657     -0.098799494
87501    -1.199237512     -0.175971326
87901     3.270068645      0.148146826
88902    -5.915202379     -0.317691655
89303    -0.058364793     -0.053342839
89803     6.548041328      0.642729376
90002    10.903475521      0.450119296
92303     1.585091240     -0.179298523
93202    -3.666591112     -0.040016525
93901    -3.564923756     -0.080818748
94002     0.625658727      0.677971537
96201    -2.014940963     -0.158988595
96202    -4.068449608     -0.163941086
98102     6.960679147      0.369901362
101701    0.168658221     -0.517413498
101702   -3.629285495      0.142066301
103501   -5.892939203     -0.645193590
108201   16.298148686      0.607038953
113001    8.357403604      0.635293810
113201    5.570042678      0.382727677
114101   -8.066311147     -0.029666619
114702    4.802081813      0.209318715
115901    2.373140471      0.543510541
116002    0.862849698     -0.047444533
116004   11.272635078      0.530370201
118402   11.180501318      0.376954789
122301   -7.041208476     -0.087766848
124201   -2.235992657     -0.057998101
124402   -6.654073179     -0.360197908
125002   -2.036353581     -0.270098667
126101    3.297895109      0.262547616
129502   -6.797821803     -0.419879120
129601   -4.382931097     -0.160115222
129602    0.466740158      0.017451223
132301    9.786381148      0.576039297
132402   -8.839831108     -0.350099054
132403    0.438064947     -0.144665332
136001   -5.458706565     -0.412198348
138901    2.422614923     -0.241055794
138902   -0.353560559     -0.051066863
139902   10.080325125      0.725346721
140004   -3.496297543      0.282378348
140104   -8.512781578     -0.655296107
140901   -0.115083608      0.716800588
140902    0.707055960     -0.308476123
141001    9.865281000      0.428920620
141601    3.020939622     -0.023542778
141603    0.627584701     -0.092923215
143901    3.106422910      0.127377649
144004    0.045069645     -0.112213249
153203   16.087092196      0.356217483
153204  -17.430077261     -0.616817016
153801    0.564118516     -0.113333334
155902   -8.936419914     -0.348618461
156401   12.187261187      0.348144705
156605   10.323654494      0.486995803
158701    8.513660697      0.336830662
158702   10.497163871      0.545777637
159605  -14.147922125     -0.755640107
159606  -11.066745066     -0.540698054
159801   -9.058337641      0.180842500
165501   -8.160174645     -0.377886697
165602    4.162599565      0.224329239
165701  -10.200591739     -0.555846787
165801    7.416486078      0.158087240
166602   -1.002994170      0.072206197
166603  -11.911124448     -0.292497710
167501   11.597707011      0.876649436
167502   17.304114029      0.737624890
169003   -0.779869964     -0.052336104
170403   -3.714540532     -0.672213772
170404   -5.285749530     -0.231791835
171401   -9.836468983     -0.069591914
172502    4.642796953     -0.407352298
173001   -5.588181640     -1.754863314
173201    0.578502007      0.031869950
174001   10.240215969      0.382702555
175405  -10.792035414     -0.348151265
175801   -7.789717327     -0.412713911
176003    8.715520376     -0.004390948
178901   -8.060279252     -0.232927660
179401   -5.537013298     -0.293072902
179701   -2.918516341     -0.698092331
180301    7.530934833      0.497157407
181801   -1.508291042     -0.134899316
182903   -0.244975730     -0.013902331
185304    2.293821497     -0.050900857
187803    2.406041176      0.434335498
188002    5.547847871     -0.253696393
188502    7.326775168      0.461852110
189601    7.020803583      0.239798464
189602    2.295523328      0.565604150
190202    2.361864346      0.109192928
190501   11.272910613      0.411262167
191202    0.109786069      0.287007128
193601   -6.460102071      0.726747858
193803    5.864314159      0.349916488
196002   -6.930064877     -0.316839993
196201    3.816025703      0.426787984
196202   -0.173952604     -0.230887906
204602    9.043456136      0.353334576
205802    8.940355783      0.987958401
207102   10.906815310      0.632212233
207202    3.946083434      0.614767925
207301   -0.305794959     -0.219240732
212001    5.175627775      0.307630681
213101   -1.604988068     -0.157754955
213702    1.853348987      0.136708618
215304   -1.680247506      0.283103740
216701    7.463945088      0.259872555
217402    4.141544076      0.234240048
219003    2.764968942      0.701685107
220401    3.029593716      0.699986352
221202    8.544703486      0.357270902
223002   15.104320740      0.623124524
224901   -4.469678843     -0.379986217
226001   -8.061210006      0.098195084
226502   -7.274549310     -0.100782710
226704   -7.527709790     -0.321128624
227002    2.461705710     -0.802262248
227101  -10.912047462     -0.095120844
227102    3.993605419      0.448123850
227201   -3.041064530     -0.137936840
231502   -7.742581030      0.041937232
233301   -1.019109719     -0.378574893
233901    9.003114610      0.382666793
233902    5.981925269      0.186142904
235503   -8.586220486     -0.338828100
236002   -3.383562465     -0.415619283
236201   -6.061759642      0.038488620
236202  -10.602033124     -0.071094358
236901    5.500138415      0.331178677
237501    6.492126787      0.518736481
238301   -1.069920262     -0.345037345
239603   -4.794009822     -0.505654150
239604   -3.138157293     -0.053065007
240701   -2.633824808     -0.230222843
240702   -5.845413982      0.313454961
244201    0.821623905     -0.010520847
244702    0.386389868      0.049039506
245903   -1.389917735     -0.441635774
248402   -9.640091283     -0.385119312
250502    1.575879281      0.185416145
252902   -8.705342925     -0.428989701
253001   -3.472250915     -0.321775121
253603   -3.952048624     -0.234004326
253802    0.813068757     -0.321677569
254901    1.557440949      0.242732961
255201    4.499756962      0.033367834
255901  -12.966621777     -0.095135814
255902   -6.408643305     -0.249179468
255903   -0.068506317      0.018661532
258801   10.066745258      0.473779137
260702   10.140891704      0.574527205
261501   -6.274288059     -0.078233942
261502   -5.275763532      0.442941285
261503   -3.768648304     -0.388219736
262601    3.713484558     -0.009543953
262602   13.156712564      0.474759507
263801   11.035679006      0.567834817
265902    0.656276991     -0.696886948
268301   -7.098532980     -0.305426775
268303   -3.792822734     -0.106412940
268901   -2.171914979     -0.078913196
268902   -0.431021818     -0.352369652
269001   -6.011169857     -0.488260650
269101    1.858122812      0.001046154
269102   -2.443573441      0.415726816
269902    4.732520442      0.381227590
271001   -2.477610234     -0.146752234
272903    3.562984351     -0.084305656
273501    6.570778698      0.281221305
274401   -2.812921787     -0.263584631
277002   -1.087288775     -0.304425636
277003    2.438031125      0.050445057
277502   -0.269337940     -0.041138191
278103    4.245009083      0.708932977
281001   -0.006211057     -0.564986398
281901    0.663646457      0.008984918
282602    2.931241086      0.373471582
282603    9.565849274      0.545267076
287702   11.892041859      0.660432677
288501    5.787422166      0.216667586
290901   13.929416909      0.821404683
290902    1.730188742      0.132665289
291101    6.259580343      0.294992854
294902   12.621060269      0.244878842
294903    4.072045749      0.087980535
295901   15.894522897      0.084921874
295902   14.439897307      0.297412167
296401    5.254230369      0.531416207
297901    0.856386616     -0.254469811
297902   -0.317311625      0.087017537
298301   -0.060917140     -0.148750133
301101   12.475974495      0.832250226
301401    2.948685577     -0.147761333
302301    0.416783844      0.060061145
302702    0.821664368     -0.089719049
302703   -0.236039902      0.125432324
304103   -4.456206190      0.013561574
304605   -4.255831240     -0.130330842
307301    3.310356602     -0.241802776
307501   -6.283556136     -0.083599724
309802    9.967256858      0.457526730
309901    3.484441714     -0.116828550
310101    1.290473853      0.216435818
311301   -0.080565206     -0.101463857
311701    1.194153804      0.038496161
312102    4.729692013      0.239638219
312201    6.695393683      0.210621990
312901   -2.426393020     -0.576742792
314501   12.287217891      0.539511886
315001    4.880252353      0.291273041
315002   13.783249241      0.739403986
315602    9.531309188      0.466146167
316301    7.479274636      0.567983219
316501    3.430731315      0.177619705
316502    4.093043825      0.093542139
319002   -0.169959992     -0.006645019
319801    2.316432546     -0.055008041
320101   -0.590631906     -0.433742436
320102    5.817675834      0.281357695
322505    8.674753283      0.562890678
324401   12.299517798      0.797447725
324402    4.946384990      0.388171137
324801    8.928434794      0.521462250
325401   -1.069020836      0.078768504
325402   13.458927332      0.509744340
325904   -7.522413853     -0.525541971
326901   -1.850392851     -0.213568608
328702    5.099223572     -0.092063809
328703    4.774712475      0.172466962
330601   -2.762453096     -0.532733818
331506   -6.722315938     -0.032499717
334201    0.565220953     -0.702132818
335001    7.357640498      0.275755052
335002    6.382367575      0.176234888
335501   -2.374164673      0.235733420
336401    1.185753997     -0.636458965
336902   -2.810051956     -0.539564109
340702    5.691374442      0.431253177
340801   -1.079168948     -0.042968743
342301    8.287865554      0.418811940
342302    2.963952990      0.322217400
342402    8.445022113      0.305838605
343302    0.814012955     -0.236369473
344602    3.405934612      0.408305541
346501    5.906782681      0.108977062
347603   -0.806916394     -0.093040005
348103    3.580506175      0.234122072
349101    1.276366531      0.448666727
352201    3.186328990      0.040560676
353101   -1.947908706     -0.288351018
353102   -2.380699827     -0.099749105
354502    9.850394404      0.528654400
354503    9.198698723      0.503643488
354801   -3.600435817     -0.005165597
356402   -5.925097334     -0.571168841
357203    5.670392546      0.505695693
358401    7.765470294      0.330832752
358601    6.140216902      0.314740464
360901    7.365502773      0.282066811
360903    2.573338090      0.148418657
362402   12.566228909      0.502017802
363501   -4.845935868     -0.025504536
364103    4.081607768      0.345151016
367903   -7.797804095     -0.300318789
369702   -3.537069987     -0.288148448
369704   -5.367416735     -0.466579600
370303  -12.143514791     -0.661565047
371502   -1.070681969      0.405907424
371503    9.158128639      0.370666653
372901   -2.054821266     -0.007560218
373401    2.089441579     -0.635811582
373402    0.662371372      0.159297299
373701   -0.288263307      0.003967021
373702    5.644432823      0.322687131
374001   -0.110747486     -0.287723126
374601    0.735524428      0.466568380
374603   13.910932960      0.652962737
375303    2.546408677     -0.043788948
379301   -4.467474981     -0.061563521
379801    2.594953809      0.092579877
379805    6.491025148      0.348084566
380201    8.253721688      0.600937233
381701   11.880686797      0.601939035
382101   -3.172071996     -0.512316258
389902    8.452419713      0.525815025
389903    8.152486867      0.455231844
389904    7.664125643      0.176022901
392102    3.039081126      0.530694935
392103    5.318129275      0.121889968
392301    5.085592795      0.793953355
392303   12.050125677      0.437434640
392401    7.264713421      0.552898978
392402   13.512432396      0.609820206
396202  -13.398745317     -0.946938695
397202    8.679382924      0.091041479
399503   -0.705322629     -0.146010479
400101    8.118709048      0.075614547
403701   -0.287986671     -0.051668622
404503    2.423199648      0.012482426
405002    6.685913424      0.373602320
407702   -9.576743777     -0.251857014
408501   -3.236321500     -0.053226091
411002   -0.617464682     -0.225721762
413202   -6.634279519     -1.016926229
413203   -2.213288415     -0.954349714
413301   -2.882921861     -0.161289727
419401   -6.373053672      0.189996879
420001   -4.571501859     -0.058357128
421001    3.075297678     -0.268336113
422401    5.343843769      0.178984109
424602    5.060375861      0.294690080
425401    5.432593598      0.382583700
425402    2.867481495      0.648454212
425601    2.336594616      0.003970176
427502   -7.140019026     -0.228993677
427703   -1.422417256      0.034062131
431002    1.334772249     -0.038506921
433901   15.572315818      0.288654765
433902   11.537290700      0.286677735
435201    8.604062734      0.596907622
436602    1.286319883      0.083146056
437201    8.199462385      0.436321271
439602   -1.165039552     -0.145739082
442301    9.283673513      0.599666755
442401    5.058711460      0.149529313
442801   12.422994645      0.514664140
443701    3.372151631      0.034408513
443702    2.965683552      0.327947098
443902    3.330639612      0.094353232
444702    2.245534630      0.067226124
448304   -2.523919127     -0.125969751
449401    6.124366003      0.278531064
449501    8.108084433      0.541782203
449601    0.408119166     -0.532499979
449602    6.202286590      0.358563313
452601    5.409230887      0.243634746
453601    5.693903038      0.213866602
453602   -5.393656916      0.057688338
453801    1.806629624      0.220752263
453802   -2.973447072     -0.002836201
453901    7.956689417      0.239268753
453902    8.794889567      0.541355860
456401    5.376041588      0.429696055
457002    5.982731795      0.382596107
458902   -6.884003869     -0.177102358
459201    9.832842881      0.295319911
461402   -5.223562473      0.143944877
463102   -5.914604999     -0.038007959
463702    6.741926582      0.487732984
466201   11.510648679      0.483259001
468301    9.663006601      0.603336592
468302   -8.402799551      0.015900699
468303    8.048645994      0.423556521
471701    4.069906707      0.601552192
471702    3.402939075      0.080496875
472303    7.309057094      0.598630621
474602    2.784221554      0.020671451
474603    4.789628688     -0.036726535
474604   -0.450573465      0.677573886
475401   16.015447512      0.789573937
476601    5.337282412      0.220270084
478501   -0.685925717      0.332780434
480103    9.355832661      0.208839722
481502    7.147688434      0.171696892
482002    9.281364359      0.374158855
482602    8.743116208      0.661362831
487101   -1.809375644     -0.304686432
488001   11.916067532      0.506033601
488201    6.919367836      0.797842059
488202    6.038326722      0.291781413
489902   -0.996170096     -0.085142207
492501    6.359078522      0.793704749
492502    4.793253305      0.217510522
492503    0.006056732      0.009332454
493003   -5.864683724      0.089100729
493301    2.406904487     -0.194779821
495202    5.167157506      0.281204854
497302   -0.429859827      0.381261492
497303    1.799132506      0.107613092
497304    4.510515532      0.277992784
497403    3.287678510      0.373230303
499703   -0.080124222     -0.004679628
502802    6.182310300      0.839743266
503201   11.013937291      0.385017956
504101   13.683756959      0.341837997
506601   -5.937988210     -0.115904557
506602   -1.847719318     -0.128445017
509801   -1.217008558     -0.013977666
509802    0.352609641      0.119905736
510002    0.591354117      0.692573879
510301    0.260699490     -0.357018778
510401    1.629703525      0.313254488
511901    1.470324831      0.126388948
513404   -5.060626103      0.282216269
513405   -3.196731473     -0.480975630
515102    8.546242755      0.295816500
516401    1.572021876      0.083987753
518003    8.172798539      0.353413081
519101  -18.415106357     -0.896889938
519503   -1.371753014     -0.455152222
521602   -3.960317289     -0.532474702
522401   -3.695855272     -0.143703661
523101   -4.384639987     -0.047785062
523201   -4.113749884      0.146941763
523202    0.153012710      0.031958709
524701    1.313244150      0.003955181
524702    4.278511592     -0.264326940
525801   10.488039492      0.466797622
527204   -4.047762593     -0.234372042
531401    0.940685154      0.455729347
531402    7.289578167      0.190362256
531404    7.240013774      0.331596609
531704   -1.650361063     -0.144601048
532601    1.800864423     -0.097583415
532802   -1.677542168     -0.824563729
533002   -5.703553240      0.170866305
533003    6.363244048      0.404819652
534103   15.151287734      0.685514121
537002    4.332209827     -0.447212584
537302    1.937192727      0.519193957
537304   14.199697268      0.744478103
537602    3.141027671      0.439343803
538102   -0.138505963      0.111396227
538703    1.378764507      0.785718978
538704    4.075748871      0.100023981
542702   -1.409693646     -0.230369024
542703   -6.687669938     -0.266286499
542802   13.407691263      0.356698396
543601   -2.350160514     -0.672815693
543602   -9.889088825     -0.257651627
545402   -8.688790180     -0.309988996
546505  -10.734656936     -1.346391440
546702  -13.593010749     -0.531453404
547701    1.515062357      0.166183160
548501    0.782912576     -0.319916183
549801    2.108432062     -0.070117907
550901  -12.207590324     -0.606792845
551501   -9.483258820     -0.249028575
552203    5.375345633      0.119472457
553701   -8.159310369      0.044498342
553702   -2.139811693     -0.069649375
556101   -4.916585005     -0.608556695
556801   -0.653108704      0.014812013
558301   -6.651518096     -0.724535151
559302   -4.998455197     -0.009225589
560902   -5.080406456     -0.546036745
561202    0.914299930     -0.105581452
561402   -1.650460891     -0.401645200
564001   -3.981210746     -0.997318240
564002  -11.964061394     -0.375078260
565601    7.228780094      0.587282473
567002    4.506841997      0.120062683
570601   -4.581916892     -0.394347202
571201   -4.006401224     -0.588944245
571801    2.377697356      0.299360222
571802    6.439438876      0.347286433
572402   -7.448997941     -0.192697636
572801    3.456546909      0.949451425
572802    1.284389677      0.013912093
572803    2.021954122      0.124533751
574003   -9.727922929     -0.477835144
574102   -0.320307604      0.020758475
574602    2.463196484      0.058340403
574603    2.549465760      0.313163093
580202   12.203823999      0.289767654
581303   -6.584442932     -0.299183252
581802   -6.327584741     -0.271856705
586102    5.668892816      0.647542806
587301   -4.796456987     -0.357614187
587303   -3.866231378     -0.114613742
591903    8.151266437      0.427276109
594102    1.983288336      0.760855980
600203   -7.951308547     -0.219342937
602301   -0.089742545      0.088702303
602302   -0.541409817     -0.028474326
602304   -0.129231552      0.002468560
604004   -8.578060685     -0.654845280
604607   -5.359169800      0.124050372
604902   -5.221372571     -0.217412244
607201    1.664383330      0.036623129
607601   -2.474126536     -0.483079001
607602  -13.455962660     -0.348304721
607802   -1.271410157     -0.087873134
610101   -9.640993658     -0.633241497
611802   -0.940294528      0.512491849
613201    5.447005406      0.140823109
613402   -8.043157025     -0.603994188
616105    3.646540805      0.040434304
616402   -2.003597206     -0.432065590
617501  -16.753064578     -0.758201897
621501    2.090728189     -0.090591099
621701    8.017513094      0.061602739
622001   -3.117404067     -0.380963728
623801   -1.096552561     -0.213769511
626201    7.057285064      0.090615207
627702   -2.395033070     -0.162102298
627703   -8.597452591     -0.055319927
627802   -9.020002885     -0.368023234
629404    3.783652406     -0.355473733
629502    4.176765010      0.230099968
631801   -7.316391315     -0.406402539
632205  -12.132319077     -0.249051645
632702   -5.990892500     -0.171403525
632703   -3.234462913      0.043606143
632704   -5.733829052     -0.409870166
634401   -8.312459893     -0.465527636
634503    0.303502674     -0.086974048
635302   -1.498033432     -0.406668296
636402  -15.901044465     -0.608122091
636802   -4.385982190     -0.388351268
637110   -8.842661707     -0.116288161
638402   -1.728818916     -0.404144561
640002  -11.992489942     -0.411548816
640402   -8.845688784     -0.421731402
642601  -13.796063897     -0.693958033
642701   -5.756427948     -0.057758542
642702   -6.808932201     -0.248756386
642901    1.603616016     -0.101585257
642902   -8.239333907     -0.046044308
642903  -10.242537352     -0.208712577
642904   -3.080639103     -0.178553328
643402   -9.413446438     -0.854906422
644203   -2.938326170     -0.327776407
644901  -12.965869279     -0.836975804
648601   -2.497626187     -0.111582921
648602   -1.817813178     -0.165024349
651601   -9.206421401     -0.306663180
665803   -7.937622756     -0.400586179
668403   -3.094074869     -0.203791032
669301    4.288543841      0.203992881
671102    1.650096523      0.192741072
675701   -6.926768526     -0.314028073
677201   -2.217690247      0.184501031
677202   -3.902369697     -0.142733255
678804   -0.983163384     -0.077600270
681601    0.310723059      0.325327512
682502   -3.046918186     -0.108704560
682903    2.590643226     -0.096908763
684201   16.280078439      0.460490211
684203    9.192836006      0.772579781
687602    3.841932936      0.036274111
689101    1.106616352     -0.011870061
690101   -3.325980888     -0.747269213
693001   -1.091016676     -0.435950300
696601   -5.322948686     -0.193431191
700002  -12.025093976     -0.339720875
700003  -15.132582305     -0.552851222
707701   -1.166124231      0.072680470
708401   15.893806763      0.599080922
711602   -9.495807218     -0.228793930
711603   -5.049071022     -0.049297748
712303    0.462837788     -0.633538578
714801   -4.255894456     -0.412541945
714802    6.314626282     -0.095917002
715601    0.853826544      0.537570571
715803  -14.172000226     -0.603752918
716601   12.221371403      0.630392854
716602    7.679000983      0.171371224
717002   -7.515821696     -0.402873460
717003   -7.575151040     -0.504060469
717901   -9.823411841     -0.664607092
717902   -5.873793984     -0.323729629
717903   -6.289457181     -0.088526651
718602    1.131820917      0.511550310
722401   -1.006228629     -0.483989774
722803    4.130434882      0.093201533
723501    0.307440660      0.125419848
725801   -1.696320252      0.438759492
725903  -17.079275454     -1.211660542
737702   -4.388651435     -0.022318441
738201   -2.323832074     -0.082662961
739002   -8.937134009     -0.727537671
739102   -5.479622388     -0.066710565
739301   -5.602359628     -0.445973585
739401    2.968561068      0.001870184
739601    6.194291875      0.076760325
742301    1.224247223      0.083866088
743601   -1.021533187     -0.055151050
743602   -5.660397705     -0.963156384
743801   -4.592250489      0.003493467
743802  -10.643702763     -0.507328981
744102  -17.016481993     -0.373824109
744103   -5.158549836     -0.284186961
744703   -3.259785398     -0.092759390
744704   -8.163758988      0.005928817
745103    5.381951413      0.177010141
745904    0.971919319      0.042952211
748003   -0.722331879     -0.164563391
748502    4.174223809      0.139650670
749802    8.449572727      0.231523244
749803   -1.198480879     -0.318137067
750104  -11.024695311     -0.334826635
750404    1.351435367     -0.527974811
751001   -6.099653262     -0.167631898
752003    0.697845101     -0.445791062
752501   -1.991270419     -0.087024018
760102   -1.034728367     -0.174004389
763603   -8.387036288     -0.315786406
764503   -2.673395685     -0.260101723
765702    1.706178547     -0.085713644
767901    2.219000694      0.054666413
771002   -8.432172662     -0.310977053
775002    7.417445319      0.358097656
778902  -11.782707125     -0.612757333
778903   -1.249249505     -0.704340836
783001   -8.898763592     -0.470550225
783002   -2.057987793     -0.263859943
783301    4.724730332      0.462334273
783502    1.208861841      0.170083010
783602   -1.253856860     -0.045073631
783801    1.319050503      0.284306191
785601    2.710879360      0.164296175
786402    5.178327920      0.242087618
788302  -10.726817911     -0.427258426
788303  -12.016494569     -0.009831985
792103   -2.449710306      0.266315368
792704   -3.273626706     -0.225207718
793001    1.210479848      0.539971187
794301  -10.932162723     -0.450055577
794503   -7.218166115     -0.425840929
795201   -4.249738333     -0.343959448
795901    4.579265935      0.094186547
799803   13.971047989      0.503724235
800602    1.913478000     -0.046791426
804701   -1.519177743      0.205194007
804702   -0.462858324     -0.180163109
809102   -5.218471720     -0.585442071
809103   -8.899982617     -0.839757022
809301   -6.655780200     -0.705423986
810303    1.045058979      0.084625194
811002   -7.206412024     -0.269444781
812504    1.486334628      0.056843620
814101   -0.979875492     -0.047576390
817402   -3.257668016     -0.497166854
817403   -5.087137975     -0.711031193
817404   -5.750879086     -0.581238557
822602    7.013043086      0.420185194
825702   -9.690081735     -0.278014140
825902   -8.608742948     -0.209946447
825903   -3.395839756     -0.527164765
826503    1.469347140     -0.189504850
826504  -18.358242061     -0.978124604
826904  -17.309569594     -0.814240170
826905   -9.616835993     -0.241896347
827101    3.170957010      0.133926977
827302   -6.417483438     -0.062114513
828302    2.747989097      0.196935471
828604   -0.432451327     -0.218443012
828902   -4.744880520     -0.496371189
828903   -4.962825174     -0.391887535
828905  -12.837447967     -0.515666464
829401   -7.300494921     -0.451136076
829403    2.278496761      0.226701780
833601   -0.954648942     -0.046110514
834301    0.185859752     -0.232313965
835202    2.006143445     -0.110537831
835703   -2.622647289      0.215727790
837503   -7.211226372     -0.265336449
837504   -8.857256944     -0.212978546
837602  -13.024762525     -0.390023252
838301   -8.233751839     -0.348036919
838903    3.304616402      0.392749927
841601    0.886759956      0.215410809
841602    0.537895525      0.013521833
846301   10.279980222      0.313542745
847301   -4.210466823     -0.624023570
847302    3.291690158     -0.002044838
847701    8.235072091      0.400242080
847901   -0.432079542      0.114558409
847902   -6.633722012     -0.097355701
848201    4.468851642      0.670151752
849401    0.189416375     -0.149836441
853202   -0.429397010      0.218005012
856103   -3.586214102     -0.092203244
857003   -6.720617097     -0.493204616
858302   -4.204535539     -0.609410105
861503   -3.966967748      0.293400309
861803   -3.135359757      0.264874987
862201    4.653017738      0.132082293
863101  -12.297582748     -0.439929413
863403   -6.477163797     -0.474134043
864302    2.085691014      0.074949397
866203   -9.169437523     -0.147097347
866205   -3.492643017     -0.061050645
866402   -2.782792441     -0.029554824
867903   11.942822075      0.499397590
869001   -7.702502070     -0.202251421
869501    0.806896368      0.352096898
869601  -10.485942895     -0.461798451
870803    8.928434794      0.521462250
878701  -17.568709144     -0.626957686
879403   11.121309995      0.417858606
879404    3.311343239      0.047788637
885801    3.486722522      0.081372459
885802  -16.039468436     -1.050718441
886401   11.077378767      0.671794102
891202   -1.785951488      0.135840571
892601   -6.248449211     -0.100279844
894201   -4.410948902     -0.294281539
894802   -0.313453837     -0.115560234
894803   -5.508871671     -0.307101576
894804   -4.959265629     -0.273862791
897001   -3.323415615     -0.358621058
905003   -6.766784958     -0.578860310
907001   -0.044475957     -0.120023417
908102   -0.826610098      0.037276094
910103   -9.997531168     -0.318016485
911701    1.189104202      0.248190222
914402    4.330045404      0.059557193
918002    1.312890067     -0.031666983
918201    2.010858048      0.084121892
918202    2.960751078      0.071789615
918301   -0.253494219      0.421761227
922901    4.736230982      0.019599188
925503   -2.952847689     -0.184075604
925504   -8.155463950     -0.407774825
925701   -1.560286833     -0.085956943
926102  -11.384931242     -0.440643401
928101   -2.561314916     -0.175971001
929805    2.299878514      0.120028438
931202    6.182482161      0.760747880
931703   -5.921728745      0.253419327
938001   -4.268374580     -0.150332673
938002   -5.203853762     -0.359216554
938205    1.452960485      0.154925383
940103   -2.332263976     -0.136215098
951602   -9.264136115     -0.794456772
952201   -3.740749071     -0.123357170
964101    3.547967803      0.131810129
964102    7.585006320      0.091026089
966001    9.257072985      0.418793561
968001   -0.898120469     -0.728569335
968002   -4.421070337      0.099825430
968003   -8.385332673     -0.022239581
968401    2.945108480      0.304805734
968402    7.276622407      0.604626813
976803   -9.628901937     -0.742544730
982001   -4.695771491     -0.306490550
983703    3.745534505      0.165550609
983902    2.596009547      0.125200150
983903   -3.667967858     -0.155126491
984402   -1.217021320     -0.058975181
984404   -0.789019406     -0.327117617
985802   -3.353538083     -0.397301364
985803    0.978668861     -0.062038203
986203   -2.764543447     -0.702253665
986505    0.235705952     -0.568761949
986506   -5.064852532     -0.934175547
987401   -6.339050700      0.154132170
987701   -4.792430373     -0.496558484
988701   -8.738498236     -0.368233827
989201   -5.672395817     -0.500824137
989503   -3.963618084     -0.191185511
992201    3.713250289      0.037354172
993803   -0.339041448     -0.033276656
995101  -16.855431161     -0.793196728
995102  -16.732009976     -0.816271483
995304    1.141931270      0.039760624
997002   -7.890837919     -0.120332271
998001    2.904616596     -0.099911409
999202   -4.209454375     -0.249228417
999203   -3.445087389     -0.642747361
1002601 -12.615996043     -0.681804312
1003202  -4.900766767     -0.081557288
1003203  -7.168505838     -0.337373360
1003204  -7.477961633     -0.234615583
1003601   4.142234535      0.087851091
1003802   6.694641940      0.582885762
1004802  -6.010511003     -0.127669923
1004903  -5.696529302      0.321126050
1005201  -5.061927500     -0.154374548
1005203   7.744852438      0.359834771
1007201   1.485163277     -0.137844389
1007301 -12.207661253     -0.289172581
1007302 -12.256018327     -0.141761798
1007901  -1.587140380      0.168986153
1013201  -7.449018493     -0.201116136
1017504 -15.113587952     -0.217160076
1018402  -8.195378280     -0.336645460
1018404  -6.060598198     -0.384207768
1019104  -3.898712489     -0.395718677
1019105 -10.441463111     -0.495045209
1023702   0.230071978     -0.062853597
1030801   9.614192285      0.359470695
1031001   7.309989035      0.957296774
1031002   3.338190748      0.463618589
1031302  -7.796511938     -0.032990651
1033202 -13.370171847     -0.281812065
1033601  -5.677419865     -0.172171992
1034001  -6.334557499     -0.663053901
1036001  -2.492905799      0.635495607
1036003  -1.474746601     -0.133442885
1037502  -2.665942104     -0.015951671
1040101   4.276289331      0.440820891
1042101  -2.553330890     -0.258232185
1042201  -6.059952254     -0.189338564
1044801   4.128417062      0.245711117
1047801  -2.849801051     -0.185397056
1050001  -2.717825315     -0.095089574
1050701  -5.872749060      0.457585048
1053201  -0.250978709     -0.100236571
1053202  -6.760663767     -0.293314450
1053802  -6.284836936      0.080095322
1053804  -7.223993827     -0.248573995
1056501  -3.896931891     -0.118419463
1081101  -5.400851712     -0.293731045
1081103  -4.680976218     -0.137297987
1176403  -1.958564728     -0.236731201
1176502  -4.966749948      0.109135738
1179201   5.308169099     -0.088424313
1179202   1.720621134      0.117183301
1180202  -0.431475168     -0.508419596
1181201 -11.704987647     -0.583519704
1181902  -2.349190562     -0.066365192
1181904  -6.320454193     -0.333828815
1182604  -0.232940420     -0.239191587
1185003 -13.222234389     -0.226450008
1187001   3.002185759     -0.284717029
1187303   6.481394612      0.381759227
1189901   8.842299522      0.382244575
1190501  -2.594795950     -0.242898294
1191001   3.134902432      0.262260144
1191901   5.116734779      0.307548594
1194901  -2.642814420      0.740744619
1197902  -7.270379750     -0.242315430
1198101  -1.607639092     -0.129777591
1198901  15.013179772      0.359981902
1201701  -0.835329508     -0.169484890
1201702  -1.378932676     -0.575885435
1203201  -2.032124763     -0.578525839
1205201  -4.566609451      0.130473364
1207601   4.894676196      0.201302925
1209201   0.014426741     -0.133074642
1211502   8.396956305      0.333608159
1211503   5.392613109      0.178489598
1212303  -2.575279428     -0.048814312
1213501  -5.356118638      0.908621520
1217202  -1.881659801     -0.624995211
1217204  -6.521048243     -0.094817905
1217702  -3.406869123     -0.086193891
1217704  -2.337403065     -0.153791714
1219103  -7.263847297     -0.311537184
1219105 -12.688070163     -0.592413772
1219106 -13.168088281     -0.487925838
1219108   2.752059171      0.271825037
1221003  -0.763516936     -0.102460692
1221702  -3.839403600     -0.221064459
1224001   3.233736846     -0.091309850
1225402  -3.826603058     -0.116909854
1228103  -0.096753765     -0.003285703
1230302 -10.049267721     -0.752222025
1256601  -7.299006078     -0.291423458</code></pre>
</div>
</div>
</section></section><section id="nlme" class="level4" data-number="6.1.1.3"><h4 data-number="6.1.1.3" class="anchored" data-anchor-id="nlme">
<span class="header-section-number">6.1.1.3</span> <code>nlme</code>
</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">linearMixedModel_nlme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">ageYearsCentered</span>, <span class="co"># sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">ageYearsCentered</span><span class="op">|</span><span class="va">id</span>, <span class="co"># random intercepts and slopes</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"ML"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by maximum likelihood
  Data: mydata 
       AIC     BIC    logLik
  15857.85 15903.5 -7920.926

Random effects:
 Formula: ~1 + ageYearsCentered | id
 Structure: General positive-definite, Log-Cholesky parametrization
                 StdDev    Corr  
(Intercept)      7.9079987 (Intr)
ageYearsCentered 0.8225933 0.082 
Residual         5.6701380       

Fixed effects:  math ~ female + ageYearsCentered + female:ageYearsCentered 
                            Value Std.Error   DF  t-value p-value
(Intercept)             30.514011 0.5619217 1287 54.30296  0.0000
female                  -0.612896 0.7955333  930 -0.77042  0.4412
ageYearsCentered         4.267923 0.1126360 1287 37.89130  0.0000
female:ageYearsCentered -0.025585 0.1610671 1287 -0.15885  0.8738
 Correlation: 
                        (Intr) female agYrsC
female                  -0.706              
ageYearsCentered        -0.635  0.448       
female:ageYearsCentered  0.444 -0.631 -0.699

Standardized Within-Group Residuals:
         Min           Q1          Med           Q3          Max 
-3.375034869 -0.517409797  0.005105047  0.523910718  2.639557775 

Number of Observations: 2221
Number of Groups: 932 </code></pre>
</div>
</div>
</section><section id="icc" class="level4" data-number="6.1.1.4"><h4 data-number="6.1.1.4" class="anchored" data-anchor-id="icc">
<span class="header-section-number">6.1.1.4</span> Intraclass Correlation Coefficent</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/performance/reference/icc.html">icc</a></span><span class="op">(</span><span class="va">linearMixedModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["ICC_adjusted"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["ICC_unadjusted"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["optional"],"name":[3],"type":["lgl"],"align":["right"]}],"data":[{"1":"0.7088602","2":"0.4552299","3":"FALSE"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/performance/reference/icc.html">icc</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["ICC_adjusted"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["ICC_unadjusted"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["optional"],"name":[3],"type":["lgl"],"align":["right"]}],"data":[{"1":"0.7088602","2":"0.4552299","3":"FALSE"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="timepointSpecificErrorsGCM" class="level3" data-number="6.1.2"><h3 data-number="6.1.2" class="anchored" data-anchor-id="timepointSpecificErrorsGCM">
<span class="header-section-number">6.1.2</span> Growth Curve Model with Timepoint-Specific Errors</h3>
<p>Adapted from Usami &amp; Murayama (2018):</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">timepointSpecificErrorsMixedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">ageYearsCentered</span><span class="op">)</span>, <span class="co"># timepoint-specific errors: observations are cross-classified with person and timepoint; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">timepointSpecificErrorsMixedModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite's
  method [lmerModLmerTest]
Formula: math ~ female + ageYearsCentered + female:ageYearsCentered +  
    (1 | id) + (1 | ageYearsCentered)
   Data: mydata
Control: lmerControl(optimizer = "bobyqa")

      AIC       BIC    logLik -2*log(L)  df.resid 
  15808.6   15848.5   -7897.3   15794.6      2214 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.5409 -0.5191  0.0051  0.5093  2.7345 

Random effects:
 Groups           Name        Variance Std.Dev.
 id               (Intercept) 76.219   8.730   
 ageYearsCentered (Intercept)  4.503   2.122   
 Residual                     30.842   5.554   
Number of obs: 2221, groups:  id, 932; ageYearsCentered, 94

Fixed effects:
                          Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)               29.87438    0.75758  211.81838  39.434   &lt;2e-16 ***
female                    -0.38123    0.82243 1960.43213  -0.464    0.643    
ageYearsCentered           4.26419    0.14813  132.95739  28.786   &lt;2e-16 ***
female:ageYearsCentered   -0.08143    0.14596 1364.56012  -0.558    0.577    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) female agYrsC
female      -0.545              
ageYrsCntrd -0.758  0.321       
fml:gYrsCnt  0.356 -0.652 -0.482</code></pre>
</div>
</div>
</section><section id="quadraticGCM" class="level3" data-number="6.1.3"><h3 data-number="6.1.3" class="anchored" data-anchor-id="quadraticGCM">
<span class="header-section-number">6.1.3</span> Quadratic Growth Curve Model</h3>
<p>When using higher-order polynomials, we could specify contrast codes for time to reduce multicollinearity between the linear and quadratic growth factors: <a href="https://tdjorgensen.github.io/SEM-in-Ed-compendium/ch27.html#saturated-growth-model" class="uri">https://tdjorgensen.github.io/SEM-in-Ed-compendium/ch27.html#saturated-growth-model</a></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">factorLoadings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="co"># times (can allow unequal spacing)</span></span>
<span>  degree <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">factorLoadings</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>              1    2
[1,] -0.6708204  0.5
[2,] -0.2236068 -0.5
[3,]  0.2236068 -0.5
[4,]  0.6708204  0.5
attr(,"coefs")
attr(,"coefs")$alpha
[1] 1.5 1.5

attr(,"coefs")$norm2
[1] 1 4 5 4

attr(,"degree")
[1] 1 2
attr(,"class")
[1] "poly"   "matrix"</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">linearLoadings</span> <span class="op">&lt;-</span> <span class="va">factorLoadings</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">quadraticLoadings</span> <span class="op">&lt;-</span> <span class="va">factorLoadings</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="va">linearLoadings</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] -0.6708204 -0.2236068  0.2236068  0.6708204</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">quadraticLoadings</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  0.5 -0.5 -0.5  0.5</code></pre>
</div>
</div>
<section id="fit-model" class="level4" data-number="6.1.3.1"><h4 data-number="6.1.3.1" class="anchored" data-anchor-id="fit-model">
<span class="header-section-number">6.1.3.1</span> Fit Model</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">quadraticGCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">ageYearsCenteredSquared</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">ageYearsCenteredSquared</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, <span class="co"># random intercepts and linear slopes; fixed quadratic slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">quadraticGCM</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite's
  method [lmerModLmerTest]
Formula: math ~ female + ageYearsCentered + ageYearsCenteredSquared +  
    female:ageYearsCentered + female:ageYearsCenteredSquared +  
    (1 + ageYearsCentered | id)
   Data: mydata
Control: lmerControl(optimizer = "bobyqa")

      AIC       BIC    logLik -2*log(L)  df.resid 
  15666.9   15724.0   -7823.5   15646.9      2211 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3660 -0.4945  0.0048  0.5085  2.4377 

Random effects:
 Groups   Name             Variance Std.Dev. Corr 
 id       (Intercept)      69.8860  8.3598        
          ageYearsCentered  0.7099  0.8426   -0.05
 Residual                  27.1959  5.2150        
Number of obs: 2221, groups:  id, 932

Fixed effects:
                                 Estimate Std. Error         df t value
(Intercept)                      23.43112    0.84914 1380.85816  27.594
female                            0.61167    1.18734 1370.91791   0.515
ageYearsCentered                  8.79334    0.42555 1381.21301  20.664
ageYearsCenteredSquared          -0.57623    0.05255 1382.10819 -10.966
female:ageYearsCentered          -0.62379    0.60301 1386.34429  -1.034
female:ageYearsCenteredSquared    0.05700    0.07582 1393.17373   0.752
                               Pr(&gt;|t|)    
(Intercept)                      &lt;2e-16 ***
female                            0.607    
ageYearsCentered                 &lt;2e-16 ***
ageYearsCenteredSquared          &lt;2e-16 ***
female:ageYearsCentered           0.301    
female:ageYearsCenteredSquared    0.452    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) female agYrsC agYrCS fml:YC
female      -0.715                            
ageYrsCntrd -0.836  0.598                     
agYrsCntrdS  0.759 -0.543 -0.969              
fml:gYrsCnt  0.590 -0.829 -0.706  0.683       
fml:gYrsCnS -0.526  0.751  0.671 -0.693 -0.968</code></pre>
</div>
</div>
<p>This is equivalent to:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">quadraticGCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">ageYearsCentered</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">ageYearsCentered</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, <span class="co"># random intercepts and slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">quadraticGCM</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite's
  method [lmerModLmerTest]
Formula: 
math ~ female + ageYearsCentered + I(ageYearsCentered^2) + female:ageYearsCentered +  
    female:I(ageYearsCentered^2) + (1 + ageYearsCentered | id)
   Data: mydata
Control: lmerControl(optimizer = "bobyqa")

      AIC       BIC    logLik -2*log(L)  df.resid 
  15666.9   15724.0   -7823.5   15646.9      2211 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3660 -0.4945  0.0048  0.5085  2.4377 

Random effects:
 Groups   Name             Variance Std.Dev. Corr 
 id       (Intercept)      69.8860  8.3598        
          ageYearsCentered  0.7099  0.8426   -0.05
 Residual                  27.1959  5.2150        
Number of obs: 2221, groups:  id, 932

Fixed effects:
                               Estimate Std. Error         df t value Pr(&gt;|t|)
(Intercept)                    23.43112    0.84914 1380.85816  27.594   &lt;2e-16
female                          0.61167    1.18734 1370.91791   0.515    0.607
ageYearsCentered                8.79334    0.42555 1381.21301  20.664   &lt;2e-16
I(ageYearsCentered^2)          -0.57623    0.05255 1382.10819 -10.966   &lt;2e-16
female:ageYearsCentered        -0.62379    0.60301 1386.34429  -1.034    0.301
female:I(ageYearsCentered^2)    0.05700    0.07582 1393.17373   0.752    0.452
                                
(Intercept)                  ***
female                          
ageYearsCentered             ***
I(ageYearsCentered^2)        ***
female:ageYearsCentered         
female:I(ageYearsCentered^2)    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) female agYrsC I(YC^2 fml:YC
female      -0.715                            
ageYrsCntrd -0.836  0.598                     
I(gYrsCn^2)  0.759 -0.543 -0.969              
fml:gYrsCnt  0.590 -0.829 -0.706  0.683       
fml:I(YC^2) -0.526  0.751  0.671 -0.693 -0.968</code></pre>
</div>
</div>
</section><section id="protoypical-growth-curve-1" class="level4" data-number="6.1.3.2"><h4 data-number="6.1.3.2" class="anchored" data-anchor-id="protoypical-growth-curve-1">
<span class="header-section-number">6.1.3.2</span> Protoypical Growth Curve</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">newData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span></span>
<span>  female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ageYears <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">ageYearsCentered</span> <span class="op">&lt;-</span> <span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span><span class="op">)</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">ageYearsCenteredSquared</span> <span class="op">&lt;-</span> <span class="va">newData</span><span class="op">$</span><span class="va">ageYearsCentered</span> <span class="op">^</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">female</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"male"</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">female</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"female"</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">predictedValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> <span class="co"># predict.merMod</span></span>
<span>  <span class="va">quadraticGCM</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">newData</span>,</span>
<span>  re.form <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">newData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>    y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>    color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="hlm_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="individuals-growth-curves-1" class="level4" data-number="6.1.3.3"><h4 data-number="6.1.3.3" class="anchored" data-anchor-id="individuals-growth-curves-1">
<span class="header-section-number">6.1.3.3</span> Individuals’ Growth Curves</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">predictedValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">quadraticGCM</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  re.form <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>    y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="hlm_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="individuals-trajectories-overlaid-with-prototypical-trajectory-1" class="level4" data-number="6.1.3.4"><h4 data-number="6.1.3.4" class="anchored" data-anchor-id="individuals-trajectories-overlaid-with-prototypical-trajectory-1">
<span class="header-section-number">6.1.3.4</span> Individuals’ Trajectories Overlaid with Prototypical Trajectory</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>    y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">newData</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>      y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>      group <span class="op">=</span> <span class="va">sex</span>,</span>
<span>      color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="hlm_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="extract-random-effects" class="level4" data-number="6.1.3.5"><h4 data-number="6.1.3.5" class="anchored" data-anchor-id="extract-random-effects">
<span class="header-section-number">6.1.3.5</span> Extract Random Effects</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">quadraticGCM</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$id
         (Intercept) ageYearsCentered
201       0.33928713     0.2048916235
303     -14.23955413    -0.5404361816
2702     13.67892361     0.6053891399
4303      1.87926497     0.2622509407
5002      1.61867520     0.3766872283
5005      5.00342166     0.1103061842
5701     12.64428032     0.1076555275
6102      9.72171668     1.0058459560
6801     11.48936045     0.1758389252
6802     12.40495519     0.2481464174
6803     13.12879251     0.5013588794
9603      5.52979990     0.3824649037
12401     2.66417687     0.1687337604
12801     2.60493276     0.0651466650
13702    10.61884268     0.0773190112
13801    15.36440208     0.2021123643
13803    12.80038202     0.1110485222
17201     8.24256456     0.4483461999
18601   -10.55394363    -0.2272976140
22104    -9.58932495    -0.0696876543
22901    -3.36909773    -0.1407002246
23602     8.73644115     0.2184893264
23701     2.90381073    -0.1385981630
24402     5.15050534     0.2763241243
26201    11.74497151     0.5679253986
28503    -7.77001348     0.3606132618
29201    13.25930100     0.2793576856
29202     8.50001271     0.7611707086
34401    14.78277587     0.6559402946
35401     6.58855382     0.6251281418
35402     5.98225593    -0.1549366084
36901    16.78961779     0.2896274008
36902    11.30118873     0.3128106197
37403    -0.68078847    -0.5658858237
38202    -2.11982646    -0.0736750904
38802    -6.46708684    -0.3200778563
40501     3.50588381     0.0461949896
40702     9.29628413    -0.1320987047
42504     2.10774440     0.3442994520
42505     7.14104463    -0.2915234595
43103     5.89656370     0.3722011257
45201     8.88186398     0.3752300489
45903    16.37615560     0.2261389848
46201    11.02652193     0.9001553207
47201    15.95922365     0.1532676692
47402     1.19209448    -0.1725448956
47601     2.57376058     0.0546115265
48502    -2.34123733     0.3721239616
49501     2.28710572     0.1112760597
53601    -2.11028218    -0.4186090518
55201     9.05810571     0.4267232755
55801     2.29575981     0.3260040562
56301    -6.10596053     0.4517713308
56302    -0.35533626    -0.0486686745
57604    11.11331459     0.5245743801
58503   -10.14200241     0.1536534485
62102     8.48717539     0.4801453109
62103   -12.69760037     0.2296958801
62202    12.35806263     0.3191224628
62703     0.77452010     0.5856085375
64002     1.71077294    -0.3926996243
65601    12.87544176     0.2085534688
65701    11.78439474     0.5456233249
66002     5.40379198     0.4392888893
70801    -2.65816258    -0.0735123899
73602     3.16513985     0.0135861002
74602     5.72595047     0.0721540233
75603    -8.90324447    -0.1220918375
76402    -0.45283569    -0.3607788119
76403     3.78350556     0.2085306910
80102     4.53440782     0.4488751663
82901    -4.12356887    -0.2517007665
83001    -1.10845340    -0.2951734131
83101    -5.98742772    -0.1378607049
83102    -0.58918147    -0.2280723208
83602     4.57144315     0.0534239295
83603    -0.67651981     0.0386622205
85402    -3.99838945    -0.0738311289
87501    -1.77198447    -0.1566500216
87901     3.86408253     0.0422021094
88902    -5.04398320    -0.2410085840
89303    -0.79795914    -0.1172080258
89803     6.03154519     0.6208458885
90002    11.08122472     0.2999687163
92303     1.29841825    -0.2871718825
93202    -4.20231846    -0.0342960418
93901    -4.60550922    -0.0757234632
94002     1.24371789     0.8570523782
96201    -0.60464792    -0.2426181602
96202    -5.47276305    -0.1474929765
98102     7.26657937     0.3154701221
101701    0.45365908    -0.5552006182
101702   -3.25255366     0.2917523724
103501   -4.84603574    -0.5917057237
108201   17.45558375     0.3412531936
113001    8.25332705     0.6615512318
113201    4.85533732     0.3113791635
114101   -7.66963585     0.1296121083
114702    4.14381150     0.1089984927
115901    3.94046139     0.4658765984
116002    2.99535490     0.1558641516
116004   11.48655100     0.3703171298
118402   11.72607831     0.2642909521
122301   -8.29724634     0.0008642110
124201   -2.96428313    -0.0736833441
124402   -7.33985437    -0.2569093160
125002   -2.35193557    -0.2905243916
126101    3.39381990     0.2271836954
129502   -8.07909145    -0.3541445982
129601   -3.45689228    -0.2490279131
129602   -0.17487722    -0.0040696364
132301   11.33564334     0.4280558536
132402  -10.00119746     0.0534339563
132403    1.08313514    -0.3260818342
136001   -4.56348688    -0.2920187214
138901    3.67379091    -0.5247768981
138902   -0.43264445    -0.1346112407
139902   11.60885012     0.8369706922
140004   -3.95730575     0.3364681884
140104   -8.95752535    -0.3326061040
140901    1.37525793     0.5661277449
140902    1.89127979    -0.4967538409
141001   10.73732856     0.2560276404
141601    2.59621507    -0.1471777397
141603    1.93924036    -0.2911545453
143901    2.76970719     0.0313528509
144004   -0.45047988    -0.1165955448
153203   17.80535189    -0.0154451664
153204  -19.12376080    -0.4658278021
153801   -0.09822118    -0.1918032108
155902  -10.30867362    -0.2633796096
156401   13.35462944     0.1125928594
156605   10.63398943     0.3345083845
158701    8.43286617     0.2151088880
158702   11.40471372     0.6628119215
159605  -16.00216781    -0.6142057674
159606  -12.91084109    -0.4281848871
159801   -9.06779608     0.5471884412
165501   -9.75467115    -0.2868447245
165602    3.97431586     0.1993120365
165701  -11.32830715    -0.3639936202
165801    7.78933517     0.2228525316
166602   -1.94451444     0.1210180941
166603  -12.98299208    -0.1850781038
167501   11.99830144     0.7956783043
167502   18.54940620     0.4534675477
169003   -1.39626192     0.1178405897
170403   -3.82923583    -0.5637318758
170404   -6.32722876    -0.1990648050
171401   -8.41664049    -0.0931688103
172502    6.17635892    -0.4867508822
173001   -3.35884458    -1.7939872366
173201   -0.18374350    -0.0076553207
174001   11.79368621     0.1958748643
175405  -10.66754941    -0.3439776675
175801   -7.65149455    -0.1293192916
176003    9.51946854    -0.2589646986
178901   -8.22500414    -0.1929562528
179401   -5.98631450    -0.2120648182
179701   -1.61184407    -0.4857992943
180301    8.85342990     0.5405658890
181801   -2.27056713    -0.1273457793
182903   -1.19774678    -0.0520202928
185304    2.22820417    -0.1693015421
187803    2.95400007     0.4399274619
188002    7.08589693    -0.1499573703
188502    6.92497904     0.3668663068
189601    7.28249552     0.2668362092
189602    2.43919392     0.8899205128
190202    2.24971310     0.0249384121
190501   11.93065226     0.2763993586
191202    1.02500680     0.2783541628
193601   -7.97134181     1.0147012007
193803    5.98928938     0.3131209595
196002   -8.12887851    -0.2865607195
196201    4.16588513     0.3172776489
196202    1.07025430    -0.1986024080
204602    9.15967430     0.1975876524
205802   10.40644860     1.0378733000
207102   10.84106680     0.5250234955
207202    3.61959117     0.6627738055
207301   -0.73393600    -0.2527850522
212001    4.93197921     0.3994909698
213101   -1.81856624    -0.2389323526
213702    1.32189349     0.2106014492
215304   -2.00425763     0.6764159818
216701    7.52632017     0.1176741134
217402    4.76817416     0.1592840231
219003    2.40104521     0.8011217910
220401    4.04986692     0.7066816283
221202    9.95961321     0.1862956300
223002   15.62296224     0.3904701241
224901   -2.54424404    -0.5258845548
226001   -8.69464302     0.2264437414
226502   -8.46369480     0.0200013455
226704   -8.69923742     0.0178851382
227002    3.40751257    -0.7407147380
227101  -12.50235206     0.2301686901
227102    3.73798793     0.4743761774
227201   -3.79582683    -0.0005880306
231502   -8.62515101     0.1650450629
233301   -0.48626285    -0.3585112075
233901    8.94551149     0.2475461882
233902    5.75246207     0.0696455531
235503  -10.20414467    -0.2601952534
236002   -3.74913131    -0.4357038295
236201   -6.81517160     0.1094731371
236202  -11.45090006     0.0579170219
236901    6.27553009     0.2885721138
237501    6.39835784     0.6413707011
238301   -0.73799816    -0.2792083242
239603   -3.80712545    -0.4593309794
239604   -2.59999184    -0.1912901478
240701   -2.85211887    -0.2449069755
240702   -5.31021101     0.3038686704
244201    0.30721779    -0.0868152479
244702    0.10740152    -0.0041185657
245903   -1.81076187    -0.5437115633
248402  -11.46092125    -0.2965954073
250502    1.47731586     0.2913200845
252902   -9.61944151    -0.4193768556
253001   -4.44367189    -0.3569182966
253603   -4.69324115    -0.2576984585
253802    1.95901726    -0.3467847444
254901    0.70301926     0.2606403040
255201    4.75464840    -0.1268180442
255901  -14.59019692     0.1674480301
255902   -7.16976223    -0.1536697557
255903   -0.95919708     0.0018794288
258801   10.31451130     0.3093277365
260702   10.10142087     0.4556405379
261501   -4.68923194    -0.2195455879
261502   -6.97848701     0.8876398938
261503   -3.97508886    -0.4137871613
262601    3.67963270     0.0549935126
262602   13.56456463     0.2596099288
263801   11.68484953     0.4401367906
265902    2.27971944    -0.6898163117
268301   -8.63399203    -0.2602065420
268303   -5.07797169    -0.0925705583
268901   -2.73911711    -0.1080836736
268902   -0.02099607    -0.3175720823
269001   -6.40852830    -0.3308146153
269101    1.64397767     0.1089492888
269102   -3.43560768     0.6082890616
269902    4.22173462     0.3316347284
271001   -2.12334601    -0.1303907024
272903    4.38185278    -0.3130899367
273501    7.80382862     0.1887815078
274401   -3.71240836    -0.2934601340
277002   -1.47109846    -0.2299156546
277003    2.20731651     0.1441361273
277502   -0.87534853    -0.0642997393
278103    3.72179290     0.8281766983
281001    1.13895265    -0.7879445725
281901   -0.07844630    -0.0334560664
282602    1.87317561     0.3683149463
282603    9.88421279     0.4294529720
287702   11.82750378     0.5330757534
288501    6.99971145     0.3983911307
290901   14.11834959     0.6984566312
290902    1.64361999     0.0477031151
291101    6.58907582     0.1904245325
294902   13.52910485     0.0996728574
294903    4.04906007    -0.0348286225
295901   17.84224419    -0.3638195950
295902   16.72697563    -0.0149393415
296401    4.87136372     0.5574356775
297901    0.84687052    -0.2670345370
297902    0.41130645     0.1145698966
298301   -0.58918147    -0.2280723208
301101   13.33506909     0.8782945971
301401    2.99577186    -0.0972184286
302301   -0.05534750     0.0132257043
302702    0.63106664    -0.0995252635
302703    2.31583623     0.0357357292
304103   -4.10462187     0.0070017789
304605   -4.98883064    -0.0687863431
307301    4.16898443    -0.1861782885
307501   -5.83199987    -0.1330714743
309802   10.00231268     0.3151889843
309901    3.61252935    -0.2797896894
310101    2.72671748     0.0507819512
311301    0.06910156    -0.1987183686
311701    1.18602175     0.0214387601
312102    5.24212368     0.1154880962
312201    6.39157472     0.0804486994
312901   -1.36434489    -0.5908760141
314501   12.27895743     0.3561983640
315001    4.80871788     0.4410052527
315002   14.26360252     0.7848261037
315602    9.46741718     0.3196613108
316301    8.00376575     0.4756457183
316501    3.25134480     0.2483367009
316502    4.02667362    -0.0248071619
319002   -0.99029147    -0.0247661620
319801    2.51260084    -0.1898536250
320101    1.05737472    -0.4057983860
320102    5.50177655     0.1859729344
322505    8.99961806     0.4525228302
324401   12.67218826     0.7162788309
324402    4.68943247     0.5037748780
324801    8.98393031     0.4061052517
325401   -0.30588497     0.1504441398
325402   14.13520777     0.3677402341
325904   -7.65060980    -0.4413674652
326901   -2.47507183    -0.1880051850
328702    5.09932905    -0.2731988498
328703    6.05950377     0.0370733815
330601   -1.52431849    -0.5623768857
331506   -4.28604519    -0.0850776291
334201    1.01569419    -0.7862710803
335001    7.51568701     0.2375349381
335002    7.63335237     0.0201921781
335501   -1.26543947     0.1299250669
336401    2.60372823    -0.5942708036
336902   -2.40018714    -0.5858921336
340702    7.26735711     0.5187392959
340801   -0.85913530    -0.1064656599
342301    8.52393897     0.4812263180
342302    2.64890519     0.4751974833
342402    8.88899509     0.2523561606
343302    0.50426922    -0.3098845309
344602    5.26053138     0.3281176910
346501    5.84872166    -0.0365265198
347603   -1.61086388    -0.0874382322
348103    4.27199199     0.1467680540
349101    2.25256295     0.3478203511
352201    2.67063297    -0.0496699420
353101   -2.64498856    -0.3421006608
353102   -2.39007492    -0.1751609503
354502    9.82539513     0.4014066125
354503   10.55906179     0.3653128802
354801   -3.86694825    -0.0322843779
356402   -6.57993704    -0.3743321608
357203    5.17173032     0.5089711989
358401    7.50343498     0.2105341747
358601    6.12932311     0.1929350331
360901    7.50888046     0.1385205953
360903    2.52646621     0.0660842802
362402   12.98417162     0.3360153678
363501   -5.97513635     0.0185743037
364103    5.11580408     0.2476807110
367903   -8.77993459    -0.1638201369
369702   -2.33109907    -0.2469774747
369704   -5.46331820    -0.4170202642
370303  -12.92784420    -0.6396665809
371502   -1.16045066     0.5141694436
371503    9.26459844     0.2505812764
372901   -2.54543475    -0.0346830323
373401    3.89252518    -0.6735275919
373402   -0.34294446     0.1740321059
373701   -0.92276427    -0.0469166652
373702    6.71282977     0.2128305418
374001   -0.34611020    -0.3259551873
374601    2.10709785     0.4917309343
374603   14.31415879     0.4547050055
375303    2.83899510     0.1296090616
379301   -4.30401478    -0.0671579708
379801    2.28828124     0.0492821342
379805    7.33896632     0.2160689278
380201    9.52474854     0.5817236580
381701   11.83879963     0.4424732335
382101   -2.63505628    -0.5593227510
389902    9.17160521     0.3483770138
389903    8.56024293     0.4365974884
389904    8.48746494     0.2000239925
392102    2.41224586     0.7326398460
392103    6.09716713    -0.0834210203
392301    4.46366973     0.9695841788
392303   13.80226641     0.4437150645
392401    7.55631490     0.4644799069
392402   14.38671948     0.4037568725
396202  -13.95313822    -0.8174885512
397202    9.59582195    -0.1519018029
399503    0.83924439    -0.3049420417
400101    8.72427727     0.1216743764
403701   -1.14444791    -0.0906498799
404503    2.78156285     0.0223124926
405002    6.89082758     0.4366989831
407702  -10.75175041    -0.0473625787
408501   -2.67091920    -0.0999998250
411002   -0.65115621    -0.2409778765
413202   -6.71808986    -0.7269686751
413203   -1.37482771    -0.8201798158
413301   -2.66172721    -0.2282981434
419401   -6.15375567     0.4087437635
420001   -5.17111419     0.0480885676
421001    3.73802259    -0.4128200152
422401    5.61585902     0.0906333666
424602    4.85017805     0.3994443371
425401    5.52869399     0.3801297733
425402    3.23083171     0.9752376791
425601    1.81800422    -0.0501868314
427502   -8.34808469    -0.1748916703
427703   -2.58105454     0.0612231823
431002    1.45336857    -0.1526561148
433901   16.71068167     0.0756074877
433902   12.88988712    -0.0369414380
435201    8.58357796     0.5638797341
436602    2.25595485     0.0940861963
437201    8.49615386     0.3070198746
439602   -1.55173568    -0.1503155023
442301    9.12453283     0.5035755763
442401    6.10349394     0.1701659310
442801   13.08240565     0.3121792055
443701    3.33969119     0.0872672738
443702    2.28727869     0.2925396650
443902    2.74162480     0.0168517841
444702    1.65622289    -0.0144715436
448304   -3.52885765    -0.1349501331
449401    5.73738288     0.1736730684
449501    8.12107401     0.7443148376
449601    0.61300547    -0.5809085853
449602    8.00518898     0.3289994215
452601    5.03808314     0.1335260446
453601    5.55206975     0.1961560885
453602   -6.51650685     0.1383941342
453801    1.35359431     0.5149975292
453802   -4.18396178     0.0579802297
453901    8.50615398     0.1764667928
453902    8.63811379     0.4579029277
456401    8.83208735     0.3337672169
457002    7.12177153     0.2272419224
458902   -7.07325468    -0.1154965398
459201   10.50421027     0.0871649428
461402   -3.07817377     0.1717537953
463102   -6.58913972     0.0101886383
463702    6.24407745     0.4497041152
466201   12.16211963     0.2995786843
468301    9.83429950     0.5760321094
468302   -9.24562541     0.1207549542
468303    8.40057932     0.2977980399
471701    3.99751144     0.5852492074
471702    5.68307142     0.2003194023
472303    7.54576634     0.5374487798
474602    3.00860908    -0.0302540522
474603    5.44654790     0.1726615893
474604   -0.19750268     0.7471078221
475401   18.28362371     0.4722576397
476601    6.50818657     0.0592427574
478501   -0.81262081     0.3287675477
480103   10.04768928    -0.0078424346
481502    7.48838897     0.0832038225
482002    9.82930749     0.1981375666
482602    9.21466111     0.6885883280
487101   -2.54324691    -0.3876331314
488001   12.10166948     0.3378831335
488201    8.48944588     0.7108716573
488202    6.15751067     0.2422759315
489902    0.26262580    -0.2417015557
492501    8.41181224     0.6103569142
492502    4.41861846     0.1288007841
492503    0.37103063    -0.0736242417
493003   -5.81067852     0.1425329042
493301    1.98819041    -0.3485372227
495202    4.76071878     0.2109290560
497302   -1.57528046     0.6780668624
497303    1.14467161     0.0736007731
497304    4.86088239     0.1749832668
497403    3.06966419     0.3200731485
499703   -0.90951377    -0.0411132215
502802    6.63064288     0.7634407959
503201   11.56783003     0.4111780168
504101   14.34197985     0.0795024380
506601   -6.74281671    -0.0894814507
506602   -2.67318818    -0.1562468845
509801   -1.60447882    -0.0512030176
509802    0.09920010     0.0712008496
510002    0.06201616     1.0278906947
510301    0.62037154    -0.5245783769
510401    2.20274717     0.2776540669
511901    1.48200004     0.0720984268
513404   -6.48298148     0.5778192504
513405   -3.94051946    -0.5795427854
515102    9.91045021     0.1772474519
516401    0.83141062     0.0331710983
518003    9.10181796     0.3141137266
519101  -20.77844394    -0.7269373977
519503   -1.52544510    -0.2971374733
521602   -4.38337078    -0.4462260781
522401   -3.64488511    -0.1793189072
523101   -3.54440585     0.0523048270
523201   -4.48478872     0.1515196713
523202    3.39194104    -0.1145805906
524701    0.87560675    -0.0715633618
524702    6.49374444    -0.4977759622
525801   10.91496982     0.6047560428
527204   -2.79154351    -0.1141600287
531401    0.92461113     0.5652710374
531402    7.67485702     0.1132916289
531404    6.87434217     0.2124329097
531704   -2.34571786    -0.1902737399
532601    1.65637871    -0.1243266382
532802   -0.80063303    -0.7536805507
533002   -6.07135817     0.3285783699
533003    6.21812835     0.3855830767
534103   15.91636250     0.5329495196
537002    4.81376988    -0.4972065699
537302    1.76851777     0.5350614031
537304   15.97162327     0.5329034206
537602    3.39849941     0.3674605788
538102    0.25725389     0.0441781126
538703    1.16742099     0.8334546607
538704    4.14195624    -0.0318725903
542702   -1.84566047    -0.1432129734
542703   -7.26063262    -0.1844095081
542802   14.09495305     0.0927618870
543601   -1.69130567    -0.5096972220
543602  -11.37736612    -0.0269849015
545402  -10.12673169    -0.2180968585
546505   -9.43666581    -1.1977857411
546702  -15.78959238    -0.3948813191
547701    1.05290957     0.1235885944
548501    0.98894469    -0.1428407727
549801    2.26942850    -0.1915722608
550901  -12.55194571    -0.5194917699
551501   -9.37562448    -0.2152411148
552203    5.14090557    -0.0003448253
553701   -9.73871205     0.3822216460
553702   -3.03880617    -0.0738900118
556101   -3.77283846    -0.7718382911
556801   -1.47570623    -0.0171300296
558301   -7.14324649    -0.5487469069
559302   -6.07905791     0.0400240615
560902   -5.54229041    -0.4336642727
561202    0.75392263    -0.2218294392
561402   -1.37556357    -0.4682488108
564001   -3.48967750    -0.8175299915
564002  -11.94574926    -0.0241249448
565601    9.76657834     0.3680539267
567002    4.15433725     0.0133426000
570601   -4.51569455    -0.2663299700
571201   -4.79272205    -0.6800050860
571801    1.55323351     0.3051389409
571802    6.13115978     0.2549047480
572402   -8.32726732    -0.0656636224
572801    4.62416002     0.8819368502
572802    1.02157458     0.0998848978
572803    1.51500140     0.2176483977
574003  -10.11412909    -0.3340443301
574102   -0.39386523     0.1430315957
574602    2.48365191    -0.0516316786
574603    2.95382533     0.4634923445
580202   12.87049963     0.0508731037
581303   -6.47450073    -0.2375153112
581802   -7.42943481     0.0559642772
586102    7.78230466     0.4290705200
587301   -4.24121968    -0.3397978594
587303   -4.01174036    -0.0621354353
591903    8.30649668     0.3023708916
594102    3.56604927     0.6478537247
600203   -7.28290558    -0.2818346289
602301   -0.45221453     0.0560703208
602302   -1.52539018    -0.0595140731
602304   -1.07015524    -0.0090999711
604004   -9.38738626    -0.2985034137
604607   -5.69204863     0.1792029099
604902   -6.18766241    -0.2029661455
607201    1.10043463    -0.0231308950
607601   -2.05803539    -0.6345825343
607602  -13.04776462    -0.2216714504
607802   -2.20348449    -0.1004745522
610101  -11.11435821    -0.5902563029
611802   -0.13978342     0.6886120263
613201    5.46727108     0.1714387560
613402   -9.37607949    -0.5751985987
616105    4.30973310    -0.1559299180
616402   -2.39820960    -0.4127444922
617501  -18.51801403    -0.6305657123
621501    2.11446055    -0.2288824668
621701    8.61553140    -0.1668611774
622001   -2.94776456    -0.3621177926
623801   -1.76507243    -0.2776193139
626201    8.59262078     0.0751752786
627702   -3.04326268    -0.2012757363
627703   -8.52970641    -0.0080475529
627802  -10.87215247    -0.2908242274
629404    4.32172379    -0.1955163986
629502    3.57445932     0.1489229923
631801   -6.37143804    -0.2736703029
632205  -12.35923616    -0.1477299841
632702   -7.37589491    -0.1007359765
632703   -4.02889088     0.0691741771
632704   -5.47214016    -0.3255188682
634401   -9.57468902    -0.3632211523
634503   -0.27668954    -0.1141029945
635302   -1.72811133    -0.4343437623
636402  -18.26222597    -0.4408466977
636802   -5.31144334    -0.3662305763
637110   -8.68730381    -0.0962076301
638402   -1.40445264    -0.4295161898
640002  -12.44703441    -0.3543034884
640402  -10.21629561    -0.2899051227
642601  -15.49411435    -0.6138021458
642701   -6.49047806    -0.0143410464
642702   -8.10270904    -0.1815307040
642901    1.59567545    -0.2238702653
642902   -7.81501060     0.0529624930
642903   -9.88083787    -0.1054004356
642904   -4.08142053    -0.1563599421
643402   -9.52229064    -0.5194602602
644203   -3.21966631    -0.2293817309
644901  -14.48784208    -0.7265333920
648601   -3.07058758    -0.1420968794
648602   -2.76078318    -0.1936279089
651601  -10.17740034    -0.1418839577
665803   -8.96721530    -0.2627590709
668403   -2.15993031    -0.3023291319
669301    3.69190506     0.1245682511
671102    1.18744864     0.2579028620
675701   -8.00959962    -0.1001605468
677201   -3.19136184     0.3751325462
677202   -4.94268506    -0.1345561528
678804   -1.50642477    -0.1276213379
681601    2.74788969     0.2361923161
682502   -3.91922522    -0.0844073621
682903    2.32299554    -0.2222974062
684201   17.43724634     0.2825095093
684203   10.72930348     0.5940951580
687602    4.12189718    -0.1142496014
689101    1.26233806    -0.1398257266
690101   -2.68719251    -0.5813889877
693001   -1.27687419    -0.2952748946
696601   -5.58706503    -0.2173202332
700002  -13.62742629    -0.1059751275
700003  -17.28590299    -0.3872682730
707701   -1.98391960     0.0604997322
708401   16.47802141     0.3498523756
711602  -10.51885330    -0.1282419784
711603   -6.09351989    -0.0111973218
712303    0.94979708    -0.7358028699
714801   -4.94840910    -0.2783046126
714802    7.19269091    -0.3411300223
715601    0.62464588     0.6207971092
715803  -15.05238385    -0.5123990154
716601   14.25432852     0.6234244176
716602    8.26359495     0.3057598999
717002   -6.38681035    -0.1404121943
717003   -8.22659222    -0.5415894988
717901  -11.10174951    -0.5570404242
717902   -5.58157915    -0.0975620911
717903   -7.20059512     0.0114687740
718602    0.75795977     0.7884020853
722401   -0.78048999    -0.2717673659
722803    4.03436179     0.0515907769
723501    0.05908726     0.1043310084
725801   -1.57495157     0.4853286644
725903  -18.19366967    -1.0139223353
737702   -5.72621066     0.0224789597
738201   -0.76015466    -0.2989000201
739002   -9.12384930    -0.4346644392
739102   -5.01927551    -0.1190896852
739301   -5.29714642    -0.1568363283
739401    3.80759256     0.2419631799
739601    6.28351106    -0.0899081928
742301    0.62244510     0.0222874064
743601   -1.26328765    -0.1224183171
743602   -5.90891613    -0.9651072304
743801   -5.77236269     0.0644369029
743802  -11.75100265    -0.4618711705
744102  -19.15264271    -0.0325021945
744103   -6.49068171    -0.2704218056
744703   -4.55666266    -0.0596432928
744704   -8.55411132     0.0132832961
745103    5.44376720     0.1246754172
745904    0.07062409     0.0021356217
748003   -1.25277068    -0.2412792565
748502    6.80312497    -0.1043084221
749802    8.84739932     0.1671736319
749803   -1.80138996    -0.3964384985
750104  -12.15768075    -0.2460528287
750404    1.62886176    -0.5777132796
751001   -6.96767775    -0.1472712091
752003    1.86283704    -0.6042768788
752501   -2.10429583    -0.1481498762
760102    0.09321882    -0.3280027184
763603   -9.97729015    -0.2324196873
764503   -3.17013340    -0.2162743116
765702    1.22290117    -0.1709812700
767901    3.34640405    -0.1181786125
771002   -9.80823742     0.0363041548
775002    7.26535421     0.2424549293
778902  -13.35237266    -0.2360579361
778903   -1.11963310    -0.7415481973
783001   -8.85817947    -0.1732627355
783002   -2.11893251    -0.1922760022
783301    3.92048142     0.4376465813
783502    1.29473302     0.1308790786
783602   -1.45070043    -0.0918634336
783801    1.52791455     0.2600695857
785601    3.85586110     0.0292718871
786402    4.89369530     0.1606372328
788302  -11.75548157    -0.3673913569
788303  -11.61220554     0.1842763871
792103   -1.43374677     0.2662663316
792704   -4.02916326    -0.1507749643
793001    3.20944565     0.4346527613
794301  -10.79587928    -0.4337240934
794503   -8.01216100    -0.0399914068
795201   -4.76959755    -0.2763319871
795901    5.55386225    -0.0616046594
799803   14.32960293     0.2686957534
800602    1.49286189    -0.1036309975
804701   -1.17293613     0.1062343948
804702    0.28408422    -0.3717005663
809102   -5.50774099    -0.6120425279
809103   -9.73439954    -0.6528738724
809301   -6.17695516    -0.8572911313
810303    0.51773971     0.0366535860
811002   -8.62663496    -0.2007538130
812504    0.87502453     0.0211229274
814101    0.42841358    -0.1408931451
817402   -3.54804620    -0.3472196503
817403   -3.86157131    -0.7364346273
817404   -4.76425763    -0.5337793547
822602    9.16403288     0.1432312623
825702  -10.49440781    -0.1380894481
825902   -8.38039051    -0.1678709474
825903   -1.49536360    -0.5381358973
826503    3.08088843    -0.1347601961
826504  -20.54599464    -0.8000334949
826904  -17.87676247    -0.7851056092
826905   -8.60874422    -0.2217742873
827101    2.66183899     0.0591032723
827302   -6.60753296    -0.0763585846
828302    2.50246833     0.2719766465
828604   -0.59185682    -0.3378811838
828902   -5.44556650    -0.4725825266
828903   -5.69626291    -0.1585394960
828905  -14.30914021    -0.2877583739
829401   -8.46306547    -0.3536454753
829403    1.40174772     0.2195352916
833601    0.46354614    -0.2416298693
834301    0.69847503     0.0904905814
835202    1.90946408    -0.2377733911
835703   -3.71007588     0.4533939673
837503   -7.10529269    -0.2262551947
837504  -10.72089835    -0.0453328518
837602  -14.41077229    -0.2665595443
838301   -7.37823973    -0.4641650815
838903    4.40667481     0.2845479867
841601    0.49388173     0.2429527312
841602    0.96254441    -0.0743071125
846301   12.13543443     0.3270844443
847301   -4.55142777    -0.5435344937
847302    3.26421860     0.0257019024
847701    8.06561086     0.3037528239
847901   -0.38112182     0.0809138027
847902   -7.53187036    -0.0486669826
848201    4.84470600     0.6073714319
849401    1.07203108     0.0033751301
853202   -1.09748063     0.3094748612
856103   -2.73582943    -0.1088943209
857003   -7.66990411    -0.4150471804
858302   -2.74849531    -0.5608923719
861503   -3.78982918     0.2475855901
861803   -2.97073434     0.2254911831
862201    4.25200741     0.0319034787
863101  -14.25117497    -0.3157709628
863403   -6.18115441    -0.4539991103
864302    1.50055212     0.0370319980
866203  -10.11371357     0.0505763752
866205   -4.68628568    -0.0307954020
866402   -3.92159378    -0.0073773810
867903   12.87009522     0.2625227045
869001   -7.85906076    -0.1745015929
869501   -0.26741551     0.3929540575
869601  -12.03373308    -0.3736088706
870803    8.98393031     0.4061052517
878701  -18.68847074    -0.4881939933
879403   12.53343479     0.2662535242
879404    3.41746666    -0.0726789109
885801    3.35147352     0.2891352889
885802  -17.18001472    -0.8362180462
886401   11.94508113     0.7070208010
891202   -1.25942591     0.0769473146
892601   -7.45849183    -0.0347396025
894201   -4.96233381    -0.1898835371
894802   -0.29049460    -0.0498230854
894803   -6.83109938    -0.3037833656
894804   -4.71097248    -0.1486124197
897001   -3.23101044    -0.0424965645
905003   -7.50461778    -0.2942284464
907001   -0.68120953    -0.1740712403
908102    0.61948614    -0.0643721505
910103  -11.12529206    -0.2414020856
911701    2.35085586     0.0316994804
914402    4.16586576    -0.0659339313
918002    0.71214806    -0.1178692639
918201    1.37972142     0.0358380536
918202    3.37420294    -0.0390783123
918301   -0.39304186     0.4941953836
922901    4.71588552    -0.1297348488
925503   -3.46311918     0.1073699380
925504   -9.37905557    -0.3726216531
925701   -2.73247889    -0.1138434926
926102  -13.27001949    -0.2987839730
928101   -3.60879315    -0.2033903084
929805    2.06871029     0.0363303706
931202    6.64695761     1.0144100185
931703   -5.07544155     0.2020379438
938001   -3.80555671     0.1232922861
938002   -4.90566464    -0.3514179845
938205    1.71865625     0.0819954684
940103   -3.38287479    -0.1529178398
951602   -7.89307032    -0.5458241385
952201   -3.92147381    -0.1430649901
964101    4.17160699     0.0114549612
964102    8.61276552    -0.1219688044
966001    9.12818819     0.2929178899
968001   -0.73632140    -0.7271500579
968002   -4.62976856     0.1007097375
968003   -8.56007668     0.0784538132
968401    3.21394765     0.1983660519
968402    7.70923179     0.6755622251
976803   -8.95144070    -0.5889793307
982001   -5.65102312    -0.3193414526
983703    4.26011136     0.0564918407
983902    3.14070377    -0.0393428433
983903   -3.72071923    -0.1340056061
984402   -2.09602353    -0.0859395972
984404   -0.01448188    -0.2800213610
985802   -2.95261179    -0.2024834226
985803    0.85416414    -0.1662302976
986203   -2.27856318    -0.8161348888
986505    0.46788756    -0.6209365248
986506   -4.83382985    -1.0580898374
987401   -6.23784409     0.2277177885
987701   -3.15407859    -0.6870811850
988701   -9.40290690    -0.3343254520
989201   -5.50937820    -0.3491790429
989503   -4.05311451    -0.2403967494
992201    4.25662180    -0.1207129833
993803   -0.69437498     0.1764164915
995101  -17.81253610    -0.3418437764
995102  -18.01823777    -0.6091920302
995304    0.82101435     0.0169707917
997002   -8.97125105    -0.0363371746
998001    3.02315351    -0.2582214586
999202   -3.61008928    -0.4116637140
999203   -2.69887313    -0.4170097125
1002601 -12.91569829    -0.2434075380
1003202  -5.65382038    -0.0147718027
1003203  -7.68965384    -0.3249356517
1003204  -8.23259578    -0.1417066181
1003601   3.68020040    -0.0278905168
1003802   6.22604589     0.5487903889
1004802  -5.92929958    -0.0561947397
1004903  -5.10086883     0.4179924258
1005201  -5.83846763    -0.1489903827
1005203   7.84438293     0.2294645755
1007201   1.30617941    -0.1305151137
1007301 -12.46457362     0.0949988152
1007302 -12.65064253    -0.0076174583
1007901  -2.17175547     0.1870277949
1013201  -7.94123128    -0.1702334943
1017504 -16.11797209     0.2694257975
1018402  -8.50816043    -0.2456271516
1018404  -6.81942108    -0.2592715409
1019104  -4.30967307    -0.3239387802
1019105 -11.59876369    -0.2794359515
1023702  -0.04874114     0.0588083963
1030801   9.88491137     0.2300356579
1031001   8.41926674     0.8884365398
1031002   2.61726444     0.5687764738
1031302  -7.49864845     0.0238281057
1033202 -15.27241276    -0.1013013000
1033601  -6.77615959    -0.1356527064
1034001  -6.38457498    -0.3774152235
1036001  -2.90674838     0.7579398885
1036003  -2.49687709    -0.1787402824
1037502  -1.21200719    -0.1915285497
1040101   3.61694408     0.4188760000
1042101  -2.47889816    -0.3250838342
1042201  -7.07864202    -0.1667731918
1044801   5.27999007     0.1352621731
1047801  -2.78469529    -0.2438990700
1050001  -3.00945189    -0.1172746551
1050701  -5.81647206     0.6866632213
1053201  -0.95441977    -0.1619816337
1053202  -6.95363077    -0.3185416524
1053802  -7.07885643     0.1638374049
1053804  -7.76244443    -0.2296186628
1056501  -5.04202222    -0.0791672561
1081101  -6.75642144    -0.2620547492
1081103  -4.96763880    -0.0609534768
1176403  -2.20154088    -0.3199205933
1176502  -5.18399523     0.1404597238
1179201   6.26432726    -0.3416049617
1179202   3.04900080    -0.0282322304
1180202   1.57919458    -0.5766208445
1181201 -12.69246491    -0.5442199223
1181902  -2.90077365    -0.1014802659
1181904  -5.61383445    -0.1279697556
1182604   0.53424136    -0.3697945245
1185003 -13.13911291    -0.0029829473
1187001   3.32587038    -0.3349836126
1187303   5.94996716     0.2982764506
1189901   9.09614222     0.3593369162
1190501  -3.11456753    -0.0952460874
1191001   2.42903740     0.2403311666
1191901   4.88269987     0.2124648289
1194901  -3.08601463     1.0566024696
1197902  -5.58073826    -0.4460158896
1198101  -1.27644936    -0.2101451737
1198901  16.65324847    -0.0262390833
1201701  -1.67105619    -0.2423445259
1201702   0.08009328    -0.5883490291
1203201  -2.06266202    -0.4507707221
1205201  -6.00924682     0.2217953590
1207601   4.48135562     0.1113411087
1209201  -0.62585073    -0.2031446927
1211502   9.32789455     0.1114924859
1211503   5.69457884     0.1078567048
1212303  -3.26708662     0.0656369113
1213501  -3.82772221     1.0464054797
1217202  -1.94939839    -0.5953455294
1217204  -7.84971939    -0.0171599235
1217702  -2.77265776    -0.0310256094
1217704  -2.68889407    -0.1430860568
1219103  -8.14296645    -0.0699275642
1219105 -14.48626571    -0.4039643861
1219106 -15.39021023    -0.3394775206
1219108   2.23229848     0.3042720787
1221003  -0.11492997    -0.1629173604
1221702  -5.09500316    -0.2257966798
1224001   2.98624921    -0.2283459623
1225402  -4.74670456    -0.1094826571
1228103  -0.52257207    -0.0103495485
1230302  -8.82049460    -0.6378126834
1256601  -8.41003160    -0.1124932283</code></pre>
</div>
</div>
</section></section><section id="splineGCM" class="level3" data-number="6.1.4"><h3 data-number="6.1.4" class="anchored" data-anchor-id="splineGCM">
<span class="header-section-number">6.1.4</span> Spline Growth Curve Model</h3>
<section id="create-knot" class="level4" data-number="6.1.4.1"><h4 data-number="6.1.4.1" class="anchored" data-anchor-id="create-knot">
<span class="header-section-number">6.1.4.1</span> Create Knot</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">knot</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">knot</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">&lt;=</span> <span class="fl">11</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">knot</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">&gt;</span> <span class="fl">11</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="fit-model-1" class="level4" data-number="6.1.4.2"><h4 data-number="6.1.4.2" class="anchored" data-anchor-id="fit-model-1">
<span class="header-section-number">6.1.4.2</span> Fit Model</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">splineGCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">knot</span> <span class="op">+</span> <span class="va">knot</span><span class="op">:</span><span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">knot</span> <span class="op">+</span> <span class="va">female</span><span class="op">:</span><span class="va">knot</span><span class="op">:</span><span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, <span class="co"># random intercepts and linear slopes; fixed quadratic slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">lmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">splineGCM</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite's
  method [lmerModLmerTest]
Formula: math ~ female + ageYearsCentered + female:ageYearsCentered +  
    knot + knot:ageYearsCentered + female:knot + female:knot:ageYearsCentered +  
    (1 + ageYearsCentered | id)
   Data: mydata
Control: lmerControl(optimizer = "bobyqa")

      AIC       BIC    logLik -2*log(L)  df.resid 
  15691.2   15759.6   -7833.6   15667.2      2209 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3041 -0.5021 -0.0075  0.5034  2.4850 

Random effects:
 Groups   Name             Variance Std.Dev. Corr 
 id       (Intercept)      68.3568  8.2678        
          ageYearsCentered  0.7018  0.8377   -0.03
 Residual                  27.7772  5.2704        
Number of obs: 2221, groups:  id, 932

Fixed effects:
                              Estimate Std. Error        df t value Pr(&gt;|t|)
(Intercept)                    25.9318     0.7222 1223.0139  35.909  &lt; 2e-16
female                          0.3473     1.0060 1208.6807   0.345    0.730
ageYearsCentered                6.2092     0.2328 1374.3269  26.674  &lt; 2e-16
knot                           12.6515     1.8238 1241.0685   6.937 6.43e-12
female:ageYearsCentered        -0.3785     0.3240 1373.1043  -1.168    0.243
ageYearsCentered:knot          -3.4908     0.3746 1283.6771  -9.318  &lt; 2e-16
female:knot                    -1.2105     2.6098 1234.2550  -0.464    0.643
female:ageYearsCentered:knot    0.3530     0.5383 1279.7386   0.656    0.512
                                
(Intercept)                  ***
female                          
ageYearsCentered             ***
knot                         ***
female:ageYearsCentered         
ageYearsCentered:knot        ***
female:knot                     
female:ageYearsCentered:knot    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) female agYrsC knot   fml:YC agYrC: fml:kn
female      -0.718                                          
ageYrsCntrd -0.786  0.564                                   
knot        -0.267  0.192  0.266                            
fml:gYrsCnt  0.565 -0.776 -0.718 -0.191                     
agYrsCntrd:  0.470 -0.337 -0.568 -0.925  0.408              
female:knot  0.187 -0.259 -0.186 -0.699  0.262  0.646       
fml:gYrsCn: -0.327  0.455  0.395  0.644 -0.559 -0.696 -0.927</code></pre>
</div>
</div>
</section><section id="protoypical-growth-curve-2" class="level4" data-number="6.1.4.3"><h4 data-number="6.1.4.3" class="anchored" data-anchor-id="protoypical-growth-curve-2">
<span class="header-section-number">6.1.4.3</span> Protoypical Growth Curve</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">newData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span></span>
<span>  female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ageYears <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ageYears</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">ageYearsCentered</span> <span class="op">&lt;-</span> <span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">knot</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">knot</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">&lt;=</span> <span class="fl">11</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">knot</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">ageYears</span> <span class="op">&gt;</span> <span class="fl">11</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">female</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"male"</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">female</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"female"</span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">newData</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newData</span><span class="op">$</span><span class="va">predictedValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> <span class="co"># predict.merMod</span></span>
<span>  <span class="va">splineGCM</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">newData</span>,</span>
<span>  re.form <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">newData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>    y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>    color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-27-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="hlm_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="individuals-growth-curves-2" class="level4" data-number="6.1.4.4"><h4 data-number="6.1.4.4" class="anchored" data-anchor-id="individuals-growth-curves-2">
<span class="header-section-number">6.1.4.4</span> Individuals’ Growth Curves</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">predictedValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">splineGCM</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  re.form <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>    y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-28-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="hlm_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="individuals-trajectories-overlaid-with-prototypical-trajectory-2" class="level4" data-number="6.1.4.5"><h4 data-number="6.1.4.5" class="anchored" data-anchor-id="individuals-trajectories-overlaid-with-prototypical-trajectory-2">
<span class="header-section-number">6.1.4.5</span> Individuals’ Trajectories Overlaid with Prototypical Trajectory</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>    y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Age (Years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Math Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">newData</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">ageYears</span>,</span>
<span>      y <span class="op">=</span> <span class="va">predictedValue</span>,</span>
<span>      group <span class="op">=</span> <span class="va">sex</span>,</span>
<span>      color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-29-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="hlm_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="extract-random-effects-1" class="level4" data-number="6.1.4.6"><h4 data-number="6.1.4.6" class="anchored" data-anchor-id="extract-random-effects-1">
<span class="header-section-number">6.1.4.6</span> Extract Random Effects</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">splineGCM</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$id
          (Intercept) ageYearsCentered
201       0.652144960     0.2083234957
303     -13.900382644    -0.5384100866
2702     13.248702169     0.4885445614
4303      2.123617918     0.2695865314
5002      1.813504926     0.3311534903
5005      4.914571158     0.1306294817
5701     12.746328285     0.1492250422
6102      9.811998768     0.9898072080
6801     11.251157093     0.2057798471
6802     12.123413767     0.2804666424
6803     13.281644740     0.5360890015
9603      5.389868582     0.3847449591
12401     2.656010922     0.1765637817
12801     2.656929651     0.0729177050
13702    10.715721324     0.1073154154
13801    15.450806205     0.2520724528
13803    12.401308398     0.1001032177
17201     7.861599067     0.4026244286
18601   -10.177265186    -0.2439801021
22104    -9.772847154    -0.1501052395
22901    -3.034416924    -0.1081377380
23602     8.698629194     0.2387282168
23701     3.154766594    -0.1140889363
24402     4.792965940     0.2287609053
26201    10.809083835     0.6206665402
28503    -8.129799847     0.3794778473
29201    13.049426803     0.2092913485
29202     8.242040820     0.7597709985
34401    14.369766601     0.5254802987
35401     6.833553015     0.6305626334
35402     5.815713216    -0.1275532970
36901    16.472051954     0.3285090538
36902    11.202203620     0.2812051478
37403    -0.583891740    -0.5036468086
38202    -2.437779179    -0.0475118466
38802    -6.196997784    -0.2974576620
40501     3.268217007     0.0214128468
40702     9.112695574    -0.0492314988
42504     1.995724022     0.3717940459
42505     6.863666740    -0.2638968855
43103     5.821996552     0.3275967123
45201     8.831273789     0.4316009873
45903    15.771000534     0.2051521382
46201    11.264243763     0.9108447155
47201    15.668737876     0.1788208935
47402     1.397962004    -0.1572621684
47601     2.316161114     0.0508547425
48502    -2.010293653     0.3936983795
49501     2.160142219     0.1134996285
53601    -1.775617993    -0.3861595134
55201     9.157903534     0.4402902346
55801     2.566584709     0.3197868128
56301    -6.033375659     0.4309999924
56302    -0.497820148    -0.0766013567
57604    10.920240580     0.5373312559
58503    -9.809490058     0.1142761543
62102     8.723136893     0.5120606501
62103   -12.441656968     0.2256406920
62202    12.496248891     0.3601452142
62703     1.085446072     0.6091981739
64002     1.922686288    -0.3572227883
65601    12.556337701     0.2046818628
65701    12.034497734     0.5863928139
66002     5.629706249     0.4789736360
70801    -2.802991869    -0.0481438997
73602     2.928465530    -0.0111033594
74602     5.341015494     0.0845985843
75603    -9.063079470    -0.1325943166
76402    -0.382474144    -0.3180360760
76403     4.039892562     0.2205538357
80102     4.373011570     0.4045018855
82901    -3.998049469    -0.2277049608
83001    -0.771642029    -0.2655275958
83101    -5.938951649    -0.1721878170
83102    -0.335988597    -0.2163531218
83602     4.768937922     0.0307470347
83603    -0.704466068     0.0518760872
85402    -4.069035989    -0.0549955050
87501    -2.216913886    -0.1313351231
87901     3.713742743     0.0534331179
88902    -5.217618285    -0.2443179929
89303    -0.549963171    -0.1108078629
89803     6.315856211     0.6272311822
90002    11.200283209     0.3496123205
92303     1.591599351    -0.2536957823
93202    -4.272559716    -0.0686060268
93901    -4.258376290    -0.0789601908
94002     1.347898206     0.8180194366
96201    -0.812094574    -0.1820390184
96202    -5.188134771    -0.1368756110
98102     7.021903082     0.3228415319
101701    0.611491352    -0.5395367529
101702   -3.309701677     0.2651586781
103501   -4.855153690    -0.5988670475
108201   17.109929489     0.3560101418
113001    8.103995908     0.6662753745
113201    5.068036082     0.3308741944
114101   -7.638376061     0.1190733697
114702    3.620812603     0.0676329525
115901    3.596298646     0.5221457642
116002    2.607162423     0.0792587285
116004   11.141442069     0.3485010978
118402   11.657468146     0.3032229400
122301   -8.237554758    -0.0444601711
124201   -3.201342516    -0.1291495001
124402   -7.411447467    -0.2726549361
125002   -2.324071622    -0.2732205004
126101    3.395328628     0.2530541153
129502   -8.109352437    -0.3358308547
129601   -3.694174646    -0.1748879841
129602   -0.004890503    -0.0001257246
132301   11.022416508     0.4585683295
132402   -9.869915706    -0.0353655374
132403    1.015949190    -0.2664092494
136001   -4.570641198    -0.3018957317
138901    3.448681327    -0.4417087283
138902   -0.659219825    -0.1648237787
139902   11.569741040     0.7989640943
140004   -4.143993718     0.2820237083
140104   -9.393058287    -0.4183388716
140901    0.506211936     0.5776220274
140902    2.008178668    -0.4332679931
141001   10.529025701     0.2681977001
141601    2.834946460    -0.1234921691
141603    1.864431525    -0.2273344283
143901    2.992285556     0.0424144798
144004   -0.604860664    -0.1055563297
153203   17.584083365     0.0812167576
153204  -19.217608036    -0.5563571110
153801    0.213455250    -0.1616756876
155902   -9.815326467    -0.2648213903
156401   13.106919035     0.1431165911
156605   10.401893628     0.3255663688
158701    8.376065438     0.2669487460
158702   11.327900531     0.6213357486
159605  -15.721145813    -0.6151441672
159606  -12.670157227    -0.4217667273
159801   -8.837673378     0.4405456251
165501   -9.556634747    -0.2746392920
165602    3.848039614     0.2136728781
165701  -10.922472572    -0.3906266026
165801    7.847561348     0.2132949362
166602   -1.772260785     0.1403003024
166603  -13.018202108    -0.2436342004
167501   11.902952461     0.8271717586
167502   18.389913126     0.5251316841
169003   -1.184804415     0.0920900276
170403   -3.640211918    -0.5911589285
170404   -5.888642474    -0.1909256162
171401   -8.774188849    -0.0289529377
172502    6.007624508    -0.4856175096
173001   -3.532202556    -1.8229571244
173201    0.100180877     0.0044099543
174001   11.496154194     0.2386557661
175405  -10.944056962    -0.3543867229
175801   -7.388428629    -0.2115091628
176003    9.279680284    -0.2422432351
178901   -7.900264290    -0.1734262827
179401   -5.569316716    -0.2015112502
179701   -1.573630049    -0.6057534998
180301    8.830015417     0.5339910070
181801   -2.130233232    -0.1011293569
182903   -0.781088208    -0.0357528437
185304    2.054010804    -0.1857004637
187803    3.237960366     0.4697704541
188002    6.682525613    -0.2336373424
188502    7.163180465     0.3866629904
189601    7.497162134     0.2684616832
189602    2.323101362     0.7762704681
190202    2.038508673    -0.0034264974
190501   11.512792021     0.3307443223
191202    0.868352422     0.3079964455
193601   -7.779654363     0.9775400072
193803    5.906687900     0.3316013332
196002   -8.362696350    -0.3529805778
196201    4.219276510     0.3626475506
196202    1.021205365    -0.2030038501
204602    8.872590054     0.1807214418
205802   10.242216349     1.0490612027
207102   10.993956855     0.5654727084
207202    3.525816664     0.6562284526
207301   -0.791545723    -0.2182437680
212001    5.056782807     0.4001862747
213101   -2.062636132    -0.2755041558
213702    1.551355094     0.2113731687
215304   -2.031118393     0.5523556292
216701    7.374241783     0.1131518312
217402    5.064895697     0.2008526677
219003    2.354076655     0.7937105244
220401    3.782415835     0.7125569436
221202   10.070996738     0.2486922321
223002   15.728425584     0.4306337911
224901   -3.013015917    -0.4251288567
226001   -8.599400863     0.1950905140
226502   -8.479978528     0.0002054359
226704   -8.653802583    -0.0481777029
227002    3.020943909    -0.7776319668
227101  -12.003922326     0.1818461513
227102    3.594571099     0.4742016447
227201   -3.471070487    -0.0158667855
231502   -8.470660512     0.1306369113
233301   -0.277743553    -0.3491408232
233901    9.142608012     0.2853892339
233902    5.977265622     0.1037109941
235503   -9.748939377    -0.2559857776
236002   -3.956374105    -0.4352266309
236201   -6.860293369     0.0635328590
236202  -11.405396328     0.0112172260
236901    6.537680492     0.3228252642
237501    6.634815535     0.6219354631
238301   -0.561639744    -0.2775688589
239603   -3.807444046    -0.4613305887
239604   -2.624217708    -0.1392523867
240701   -2.814072362    -0.2265948459
240702   -5.394431688     0.3318887771
244201    0.055103450    -0.1242383480
244702    0.003743181    -0.0272862586
245903   -1.499682835    -0.5018116428
248402  -11.221149647    -0.3177062488
250502    1.687272155     0.2908951509
252902   -9.840652753    -0.4844864290
253001   -4.097697558    -0.3324151023
253603   -4.974154728    -0.3192530906
253802    1.821490157    -0.3424047377
254901    0.933188357     0.2815704653
255201    4.481286992    -0.1425491653
255901  -14.401543986     0.1349502187
255902   -6.802601303    -0.1557736752
255903   -0.693978827     0.0204272984
258801   10.512221706     0.3394946638
260702    9.877213987     0.4397797986
261501   -5.686362487    -0.1323804043
261502   -6.663219382     0.8028337630
261503   -4.189480113    -0.4156013821
262601    3.851042222     0.0482523003
262602   13.080986760     0.2369840503
263801   11.669895820     0.4596394426
265902    1.986862239    -0.7016725848
268301   -8.241647519    -0.2575504204
268303   -4.742035217    -0.0927816751
268901   -2.954530211    -0.1571329152
268902    0.138025639    -0.3118058171
269001   -6.304862424    -0.3485069887
269101    1.861546568     0.0974767425
269102   -3.453675766     0.5784219826
269902    4.445471097     0.3364996881
271001   -1.830838376    -0.1057897562
272903    4.287569963    -0.2487570271
273501    7.635717755     0.2268629055
274401   -3.403635800    -0.2756986901
277002   -1.243933170    -0.2347542123
277003    2.418219955     0.1380275097
277502   -0.502617518    -0.0413044058
278103    3.626497373     0.8115046407
281001    1.184524548    -0.7241158255
281901    0.213884274    -0.0154378167
282602    2.118326702     0.3866349623
282603    9.790238821     0.4315623788
287702   11.817901548     0.5838264952
288501    7.066996520     0.3201208641
290901   14.099909280     0.7470816302
290902    1.235288575    -0.0096163502
291101    6.558065297     0.2267584373
294902   13.061928696     0.1184870528
294903    3.701090470    -0.0737191217
295901   17.536351167    -0.2569181644
295902   16.283912304     0.0475563269
296401    4.814174048     0.5666228506
297901    0.604055604    -0.2645571474
297902    0.300175805     0.1178062781
298301   -0.335988597    -0.2163531218
301101   13.409420437     0.8805909885
301401    3.178349996    -0.1070821273
302301   -0.330216266    -0.0378310093
302702    0.414075786    -0.0966631214
302703    1.625142915     0.0869742473
304103   -4.258930346    -0.0007285439
304605   -4.594662272    -0.0609633247
307301    4.097671261    -0.2070800977
307501   -5.731119892    -0.0976376594
309802   10.210768919     0.3486302793
309901    3.365091391    -0.2940665304
310101    2.347385110     0.1150987239
311301   -0.079230537    -0.2061300176
311701    1.441502874     0.0295624543
312102    5.010523715     0.1092726691
312201    6.531756956     0.1254815215
312901   -1.529426522    -0.5730621638
314501   12.368906421     0.4043090114
315001    4.978399175     0.4164754804
315002   14.324568079     0.7762316498
315602    9.622624095     0.3415007309
316301    7.813598649     0.4696356705
316501    3.505645228     0.2486061869
316502    3.814762666    -0.0454311390
319002   -0.863031650    -0.0236853419
319801    2.329578014    -0.1994627117
320101    1.013056213    -0.4303786086
320102    5.745253336     0.2079915499
322505    8.800142108     0.4403072786
324401   12.472711183     0.7386113252
324402    4.926974035     0.4931659164
324801    9.307156689     0.4423498499
325401   -0.444107885     0.1568379273
325402   13.738092571     0.3904219374
325904   -7.266729700    -0.4349631549
326901   -2.911228814    -0.1638876977
328702    5.234498346    -0.2462162633
328703    5.850018397     0.0647886740
330601   -1.705856099    -0.5528835774
331506   -5.101381795    -0.0305780561
334201    1.152108584    -0.7610134381
335001    7.715419757     0.2579289603
335002    7.418598668     0.0551640301
335501   -1.741422585     0.1710639480
336401    2.346023519    -0.6229368200
336902   -2.094162645    -0.5544568146
340702    7.202832056     0.4778494391
340801   -0.956913652    -0.1071881399
342301    8.704835045     0.4720677533
342302    2.921861452     0.4501960702
342402    8.627781993     0.2631668185
343302    0.566607364    -0.2693856801
344602    4.712798604     0.3726930900
346501    6.052797770    -0.0095679508
347603   -1.721309205    -0.0576561583
348103    4.136958195     0.1614105922
349101    2.141431032     0.3887287248
352201    2.857189324    -0.0203346113
353101   -2.328845896    -0.3179772141
353102   -2.795949498    -0.2292623024
354502    9.414280018     0.3633543593
354503   10.601682996     0.4236930057
354801   -3.770758732    -0.0110762971
356402   -6.397953611    -0.4121958923
357203    5.134882822     0.5372189493
358401    7.645910799     0.2562036013
358601    6.311240253     0.2082612873
360901    7.178736718     0.1105831553
360903    2.392125042     0.0484097036
362402   12.865014267     0.3642492572
363501   -6.173965225    -0.0470830092
364103    4.855755535     0.2614831694
367903   -8.369199168    -0.1698641392
369702   -2.628643614    -0.2467037984
369704   -5.098361243    -0.4024509929
370303  -12.934662970    -0.6739988743
371502   -0.755066027     0.5223393717
371503    8.883492300     0.3017167234
372901   -2.738637191    -0.0793893415
373401    3.810876560    -0.6791280325
373402   -0.193460539     0.1999688177
373701   -1.253211531    -0.1030847253
373702    6.505222654     0.2386146419
374001   -0.915908406    -0.2920226226
374601    1.830191801     0.5260605541
374603   14.495786752     0.4950411151
375303    2.828177631     0.0725274247
379301   -4.385038019    -0.0701858289
379801    2.486466689     0.0596081939
379805    7.128114745     0.2256932305
380201    9.226166693     0.5937558998
381701   12.021485874     0.4805700574
382101   -2.365127627    -0.5252701788
389902    9.142609358     0.4063503563
389903    8.432352420     0.4517620633
389904    8.418959235     0.2085503909
392102    2.722267970     0.7043730423
392103    6.031839924    -0.0211781682
392301    4.788346193     0.9509812755
392303   13.478435609     0.4404240465
392401    7.351647293     0.4479190882
392402   14.087324049     0.4080264824
396202  -13.520441735    -0.8212379808
397202    9.272004411    -0.1428923809
399503    0.447986224    -0.2244860671
400101    8.744736642     0.1113099082
403701   -0.816164297    -0.0648390973
404503    3.056984122     0.0438148488
405002    7.123329178     0.4305210057
407702  -10.789988674    -0.0837651028
408501   -2.448039418    -0.0591879094
411002   -0.340595602    -0.2232830212
413202   -6.775502515    -0.8305434935
413203   -1.457538922    -0.8797885682
413301   -2.789310746    -0.2361028975
419401   -6.015112675     0.3577753578
420001   -5.237150882     0.0338472565
421001    3.485009863    -0.3831222603
422401    5.829261703     0.1234267846
424602    5.052307780     0.3861497325
425401    5.407125908     0.3893021825
425402    3.005234654     0.8540066856
425601    1.831274021    -0.0098355064
427502   -8.384260437    -0.2235018781
427703   -2.361884960     0.0833204408
431002    1.055200188    -0.1972411019
433901   16.286112281     0.1145098583
433902   12.745319758     0.0454684445
435201    8.239836920     0.5983216893
436602    2.134630967     0.1009702983
437201    8.212366679     0.2867709480
439602   -1.754577388    -0.1520604389
442301    8.736255166     0.4601878774
442401    5.991235801     0.1594879876
442801   12.791242284     0.3111619801
443701    3.563785496     0.0892544026
443702    2.576755826     0.2975002715
443902    2.938201966     0.0543486000
444702    1.950221752     0.0049582962
448304   -3.212330335    -0.1286352898
449401    5.890953444     0.1894601932
449501    7.960661939     0.6962985659
449601    0.819391948    -0.5633475827
449602    7.586149616     0.3704181436
452601    5.259189284     0.1519824650
453601    5.215943667     0.2028775023
453602   -6.639855425     0.0715128917
453801    1.401026207     0.4361648604
453802   -3.932446234     0.0704679585
453901    8.294177499     0.1939561831
453902    8.905960641     0.4911907904
456401    7.892697861     0.3904344132
457002    7.202016686     0.2828656599
458902   -6.697520088    -0.0984893092
459201   10.202304152     0.0858383908
461402   -3.800733252     0.2040626388
463102   -6.647717083    -0.0319570534
463702    6.152834543     0.4869901782
466201   11.929377475     0.3045271551
468301    9.663137348     0.5884585664
468302   -9.269048154     0.0687506220
468303    8.216306160     0.2924034204
471701    3.763886469     0.5444009129
471702    5.305866596     0.1619076001
472303    7.547316581     0.5698673804
474602    3.235586532    -0.0028905854
474603    5.262948752     0.0676086593
474604    0.082404546     0.7703311029
475401   17.901219942     0.5505570370
476601    6.135158039     0.0860347065
478501   -0.702645690     0.3558601308
480103    9.785520520    -0.0023276926
481502    7.192875249     0.0988762983
482002    9.548194719     0.1913739120
482602    9.475046751     0.7083578232
487101   -2.225263156    -0.3656467799
488001   12.247447681     0.3844159426
488201    8.102629732     0.7783455025
488202    5.987223071     0.2584736803
489902    0.230219542    -0.1772300862
492501    7.337092394     0.6755953993
492502    4.671513267     0.1494787322
492503    0.221469013    -0.0781491851
493003   -5.478602850     0.1654778966
493301    2.140099569    -0.3255400185
495202    5.031530542     0.2393239489
497302   -1.356430489     0.6230662894
497303    1.443114768     0.0975309585
497304    4.673049533     0.1651969361
497403    2.638405610     0.2507020738
499703   -0.440142997    -0.0209190836
502802    6.577898855     0.8092018798
503201   11.634706733     0.4083105680
504101   13.921881377     0.0752724468
506601   -6.932435031    -0.1507198724
506602   -2.347027061    -0.1472239760
509801   -1.730501392    -0.0825522054
509802   -0.090075249     0.0360765068
510002    0.205538243     0.9542280980
510301    0.702579414    -0.4746678459
510401    2.056260506     0.2848057954
511901    1.453417905     0.0973429495
513404   -6.042612306     0.5389918814
513405   -3.646392133    -0.5580801923
515102    9.722847709     0.2156090752
516401    1.009858860     0.0426850477
518003    9.302402137     0.3445363462
519101  -20.257400756    -0.7379099829
519503   -1.473934126    -0.3374921854
521602   -4.153337712    -0.4494605391
522401   -3.716144124    -0.1852121468
523101   -3.507052647     0.0332933281
523201   -4.472553649     0.1641359594
523202    2.411681739    -0.0408955489
524701    0.539203070    -0.1217671971
524702    6.034277613    -0.3930035680
525801   10.778043519     0.5620550084
527204   -2.905376377    -0.1388765587
531401    1.302471905     0.5699696024
531402    6.962850983     0.1553970849
531404    7.091999028     0.2485304739
531704   -2.649919937    -0.2444868454
532601    1.053870793    -0.0917910589
532802   -0.974004431    -0.7839375568
533002   -5.629425526     0.3264527147
533003    5.636689708     0.4174516474
534103   15.603846087     0.5641142512
537002    4.800717507    -0.4796646686
537302    1.656259892     0.5396232512
537304   15.874065737     0.6042442216
537602    3.326412952     0.4031131857
538102    0.010031153     0.0388542070
538703    1.271166802     0.8545769790
538704    3.857883727    -0.0578289975
542702   -1.605350599    -0.1450513194
542703   -6.925617752    -0.1813053332
542802   13.660919966     0.0865350801
543601   -1.863309800    -0.5720061609
543602  -10.895250243    -0.0513775254
545402   -9.748793425    -0.2337083265
546505   -9.465377543    -1.2643208291
546702  -15.468168978    -0.4245138303
547701    0.821040529     0.0787577217
548501    0.890506609    -0.1850190548
549801    2.185796044    -0.1904365254
550901  -12.110261822    -0.5083420287
551501   -9.458482079    -0.2274652381
552203    5.366109394     0.0341539327
553701   -9.306520650     0.3298493036
553702   -2.677196414    -0.0662259959
556101   -4.098853766    -0.6904491092
556801   -1.123708759    -0.0070401992
558301   -6.897870784    -0.5899296536
559302   -6.228731802    -0.0210775598
560902   -5.230972822    -0.4504349249
561202    0.410588880    -0.2639003793
561402   -1.027279529    -0.4305782115
564001   -3.798078131    -0.8718677315
564002  -12.087399682    -0.1383687684
565601    9.165482401     0.4884945169
567002    4.384027365     0.0373265194
570601   -4.275409590    -0.2861293813
571201   -4.512941408    -0.6460295376
571801    1.832773693     0.3246793184
571802    6.373805424     0.2765514830
572402   -8.414508702    -0.0889523017
572801    4.028924897     0.9429226251
572802    1.320631615     0.0940227606
572803    1.752194492     0.2131732656
574003   -9.707119190    -0.3413922317
574102   -0.155152926     0.1391133187
574602    2.248962575    -0.0761357717
574603    3.120128963     0.4340670920
580202   13.022387194     0.0997430302
581303   -6.120196772    -0.2233415625
581802   -7.260506569    -0.0189295916
586102    6.347244598     0.4276988765
587301   -4.270522304    -0.3136476132
587303   -3.704164917    -0.0663545187
591903    8.016551729     0.2768465055
594102    2.844198101     0.7059391803
600203   -7.411005699    -0.2369221509
602301   -0.541881945     0.0293960087
602302   -1.364506766    -0.0564812144
602304   -0.888339281     0.0198525430
604004   -9.177265588    -0.4007321746
604607   -5.803129595     0.1464837396
604902   -5.714551254    -0.1910331391
607201    1.408024569    -0.0024783694
607601   -2.224009500    -0.6246790844
607602  -12.974686863    -0.2209720964
607802   -1.904649681    -0.0730417460
610101  -10.765536149    -0.5739410895
611802   -0.170691262     0.6648769176
613201    5.669249506     0.1745448840
613402   -9.326881293    -0.5537510022
616105    4.261380940    -0.0972857910
616402   -2.214467326    -0.3964480731
617501  -18.639149690    -0.7186458035
621501    1.835991838    -0.2542207736
621701    8.286044132    -0.1704955040
622001   -2.620652788    -0.3420891548
623801   -1.461860958    -0.2594092231
626201    8.298678423     0.0709192473
627702   -3.294336634    -0.2528605997
627703   -8.356383592     0.0167912871
627802  -10.719655881    -0.3128250204
629404    4.271949399    -0.2825751636
629502    3.842041546     0.1691263674
631801   -6.443346414    -0.2987834921
632205  -12.355631470    -0.1639754635
632702   -6.968964556    -0.0983124216
632703   -4.205911096     0.0107936240
632704   -5.201119015    -0.3205166214
634401   -9.496305337    -0.3525666006
634503   -0.300560452    -0.0830998575
635302   -2.385332305    -0.4039133039
636402  -17.864067138    -0.4747542127
636802   -5.469860683    -0.3400287141
637110   -8.582821719    -0.0688801171
638402   -1.096630852    -0.4008948853
640002  -12.467112891    -0.3845939644
640402  -10.226452438    -0.2850022943
642601  -15.027543402    -0.6283418399
642701   -6.568055056    -0.0605927646
642702   -7.786731063    -0.1934245975
642901    1.365816287    -0.2461050023
642902   -7.727724366     0.0552052437
642903   -9.783845607    -0.1041269653
642904   -3.902721179    -0.1359082868
643402   -9.784829399    -0.6673450281
644203   -2.893498650    -0.2359423115
644901  -14.409620242    -0.7198468219
648601   -3.285283895    -0.1909946975
648602   -2.440359357    -0.1675653778
651601  -10.164457337    -0.1656169561
665803   -8.588165123    -0.2683286666
668403   -2.155576156    -0.2480496971
669301    3.140409865     0.1135270055
671102    1.522198735     0.2626847368
675701   -7.666821307    -0.1358802968
677201   -2.786868394     0.3564281052
677202   -5.112519532    -0.1836048939
678804   -1.686968395    -0.1655281856
681601    2.093995227     0.3277762462
682502   -3.631163368    -0.0870500663
682903    2.533028033    -0.2022871751
684201   17.090879898     0.3183255812
684203   10.550500892     0.6529026987
687602    3.837137069    -0.1324482408
689101    1.320276660    -0.0990678200
690101   -2.777357589    -0.6658898264
693001   -1.185516769    -0.3308131312
696601   -5.488481284    -0.1918743288
700002  -13.546584929    -0.1359268562
700003  -16.826077607    -0.4179645171
707701   -1.629690464     0.0634283004
708401   16.095714969     0.3510674641
711602  -10.364466117    -0.1311523796
711603   -6.298026288    -0.0774363265
712303    1.115210195    -0.7046623183
714801   -4.701190798    -0.2928539317
714802    7.156025117    -0.2743301594
715601    1.071023211     0.6346586556
715803  -14.869698337    -0.5096580848
716601   14.055407036     0.6226336053
716602    8.101777373     0.2717597314
717002   -6.514717529    -0.2164293965
717003   -7.880996157    -0.5365497268
717901  -11.300617102    -0.5463604768
717902   -5.808792038    -0.1781694346
717903   -7.038698377     0.0096350581
718602    0.930533655     0.7131227273
722401   -0.985346156    -0.3272963500
722803    3.508472031     0.0884016598
723501    0.121789963     0.0956484976
725801   -1.347171220     0.5068905555
725903  -17.715805194    -1.0400137961
737702   -5.364316034     0.0132311916
738201   -1.546327158    -0.2326255486
739002   -9.015182191    -0.5451153768
739102   -5.064695317    -0.0888557675
739301   -5.479133915    -0.2615794135
739401    3.548340320     0.1235943748
739601    5.911842256    -0.1183481266
742301    0.224482160    -0.0377872368
743601   -1.501981264    -0.1611641223
743602   -5.764737947    -0.9465123547
743801   -5.281092320     0.0737646699
743802  -11.837457672    -0.5188800428
744102  -19.056782948    -0.0882474409
744103   -6.113028565    -0.2690950378
744703   -4.318480494    -0.0407585018
744704   -8.446451812     0.0303253095
745103    5.127391691     0.1637150344
745904   -0.132089799    -0.0043144746
748003   -0.888274710    -0.2183155180
748502    6.179130229     0.0174522426
749802    8.993189664     0.1935373561
749803   -1.527664909    -0.3678291583
750104  -12.204430161    -0.3060585495
750404    1.798556671    -0.5623006390
751001   -7.194623280    -0.2135921704
752003    1.980723949    -0.5464093787
752501   -2.291324472    -0.1768991458
760102    0.002779244    -0.2678997226
763603   -9.515067832    -0.2267766664
764503   -3.529410857    -0.1965419102
765702    1.477915925    -0.1405890196
767901    3.194300097    -0.0668313731
771002   -9.628492583    -0.0331301722
775002    7.459231867     0.2618756402
778902  -13.159806097    -0.3228931091
778903   -1.398100657    -0.7319082250
783001   -8.902087517    -0.2744852246
783002   -1.867724426    -0.1984787514
783301    4.229424280     0.4597352393
783502    1.293732538     0.1286967835
783602   -1.511633114    -0.1079115367
783801    1.466023472     0.2565860748
785601    3.812960011     0.0865059612
786402    5.189301366     0.1904138171
788302  -11.728646898    -0.4109713490
788303  -11.703157030     0.1904551466
792103   -1.717768617     0.2765264126
792704   -4.263432014    -0.1608600887
793001    2.631618708     0.5444128410
794301  -10.885986014    -0.4341363188
794503   -8.046908048    -0.1400713658
795201   -4.778623885    -0.2761614132
795901    5.312868665    -0.0366368565
799803   14.440612041     0.3134571096
800602    1.575169789    -0.0671218693
804701   -1.182292795     0.1527017788
804702    0.188818697    -0.3088758177
809102   -5.605012786    -0.6008609290
809103   -9.565248243    -0.6846855454
809301   -6.198420982    -0.7978763861
810303    0.377371540     0.0057558757
811002   -8.319520622    -0.2138774760
812504    0.993614255     0.0264062237
814101    0.131310877    -0.1119582959
817402   -3.379127920    -0.3726538867
817403   -4.085829565    -0.7050319754
817404   -4.755705815    -0.5346998879
822602    7.917443103     0.1327733745
825702   -9.970917659    -0.1367166687
825902   -8.435519858    -0.1686452329
825903   -1.699014338    -0.5378369475
826503    2.977856523    -0.1537479884
826504  -20.169375616    -0.8092409240
826904  -17.714957998    -0.7663456674
826905   -8.867298417    -0.2094385227
827101    2.911580798     0.0743696646
827302   -6.515098274    -0.0472490379
828302    2.758256821     0.2710918047
828604   -0.387730778    -0.3245729275
828902   -5.870203967    -0.4487020126
828903   -5.540272045    -0.2053766389
828905  -13.835763582    -0.3159407142
829401   -8.807481226    -0.3429406667
829403    1.481529252     0.2490552553
833601   -0.624297944    -0.2652069381
834301   -0.220777081    -0.0289871697
835202    1.659102580    -0.2632755479
835703   -3.328187213     0.4162598998
837503   -6.753085789    -0.2036923842
837504  -10.706741673    -0.0458817913
837602  -14.410977124    -0.3320380379
838301   -7.498085384    -0.4155690654
838903    4.324118577     0.3380756621
841601    0.380851813     0.2425089126
841602    0.841025013    -0.0739130759
846301   12.045171447     0.3091647315
847301   -4.297862641    -0.5546112145
847302    3.482212270     0.0265452839
847701    7.917419013     0.3513418683
847901   -0.460907634     0.0713428669
847902   -7.658645851    -0.1069721236
848201    4.801092377     0.6521619294
849401    0.832776648    -0.0621926478
853202   -1.129530150     0.3017979514
856103   -2.805522684    -0.0979480708
857003   -8.202760994    -0.4038646396
858302   -2.788553034    -0.5891048005
861503   -3.786890937     0.2863354777
861803   -2.975009858     0.2570636647
862201    4.450524308     0.0632242098
863101  -13.753601142    -0.3306235274
863403   -5.858524796    -0.4329759096
864302    1.683787838     0.0675621624
866203   -9.608254207     0.0391321674
866205   -4.337558707    -0.0313018735
866402   -3.581884688    -0.0063703398
867903   12.840335929     0.3233423898
869001   -7.891305491    -0.1876723061
869501    0.086653086     0.3941996230
869601  -11.564066942    -0.3804197551
870803    9.307156689     0.4423498499
878701  -18.564325364    -0.5304544041
879403   12.691982843     0.3210558438
879404    3.242777255    -0.0845540177
885801    3.311057771     0.2319786141
885802  -16.768413564    -0.8683749095
886401   11.907542234     0.7056690429
891202   -1.081121395     0.1152864260
892601   -7.622453080    -0.1032087784
894201   -5.013783151    -0.2009735418
894802   -0.053149059    -0.0547022339
894803   -6.490546445    -0.2994334585
894804   -4.621840870    -0.1764300223
897001   -3.365401619    -0.1629674155
905003   -7.445714333    -0.3640961880
907001   -0.374151219    -0.1495011196
908102    0.219617324    -0.0345188263
910103  -11.167480720    -0.2984328178
911701    2.073122697     0.1071727942
914402    4.370790200    -0.0459269353
918002    1.007393620    -0.0978816035
918201    1.660847815     0.0600406049
918202    3.268499663    -0.0317340583
918301    0.035351706     0.5101045390
922901    4.361980088    -0.1613853887
925503   -3.438776695     0.0453044433
925504   -9.011543740    -0.3818310966
925701   -2.371167896    -0.1043786247
926102  -12.912275437    -0.3037111025
928101   -3.267917120    -0.1876491634
929805    1.834634487     0.0030545361
931202    6.403164042     0.9217389556
931703   -5.354493946     0.2360415478
938001   -3.994223109     0.0204975093
938002   -4.614140459    -0.3244595553
938205    1.567384264     0.0714191192
940103   -2.876967919    -0.1367363170
951602   -8.075174085    -0.6479917899
952201   -3.945860026    -0.1560927886
964101    3.984661661     0.0219674976
964102    8.360407930    -0.0953735583
966001    9.174016794     0.3432238340
968001   -0.629836663    -0.7223522955
968002   -4.532019378     0.1264415938
968003   -8.173387557     0.0922628561
968401    3.224844494     0.2381162652
968402    7.853238203     0.6730011095
976803   -9.046486242    -0.6135737022
982001   -5.313405819    -0.3165368330
983703    4.116384781     0.0643450735
983902    3.083564815     0.0115067859
983903   -3.849424068    -0.1295673009
984402   -1.843563677    -0.0852790816
984404    0.142760805    -0.2835791644
985802   -3.097528676    -0.2788940500
985803    0.646538579    -0.1911647301
986203   -2.560814112    -0.7966300263
986505    0.638431884    -0.6053352476
986506   -5.014895845    -1.0319359419
987401   -6.344335597     0.2169455056
987701   -3.506675824    -0.6063062528
988701   -9.319877074    -0.3575980333
989201   -5.305093824    -0.3802291161
989503   -3.932088153    -0.2082724988
992201    4.266447975    -0.0669857425
993803   -0.530178376     0.1345058204
995101  -17.804533585    -0.4776618045
995102  -17.473883352    -0.6232233901
995304    1.053291143     0.0243375727
997002   -8.979013260    -0.0885973261
998001    2.729012021    -0.2800570407
999202   -3.670524953    -0.3511758409
999203   -2.979903009    -0.5338115853
1002601 -13.034835722    -0.4012982324
1003202  -5.606812318    -0.0196977607
1003203  -7.477668046    -0.3066633100
1003204  -7.844700539    -0.1540920537
1003601   3.930180280     0.0011913967
1003802   6.540122419     0.5659007953
1004802  -5.570807619    -0.0413438230
1004903  -5.248322978     0.4111272596
1005201  -5.984591162    -0.1987134049
1005203   7.565038265     0.2057572959
1007201   1.510667986    -0.1147921220
1007301 -12.468870981    -0.0066654272
1007302 -12.326574049     0.0022638649
1007901  -2.264068422     0.1464422191
1013201  -7.986005280    -0.2003928810
1017504 -15.664769939     0.1460669934
1018402  -8.067842105    -0.2363769816
1018404  -6.508505979    -0.2698877112
1019104  -4.099081306    -0.3246502915
1019105 -11.252231849    -0.3048711496
1023702   0.234904992     0.0414158079
1030801   9.922354931     0.2550829939
1031001   8.177431667     0.9571389929
1031002   2.887020965     0.5672244473
1031302  -7.580679673     0.0151221031
1033202 -14.810454289    -0.1392893536
1033601  -6.830059011    -0.1810000462
1034001  -6.384315963    -0.4931655541
1036001  -2.463853750     0.7652192225
1036003  -2.232715330    -0.1682196086
1037502  -1.522566381    -0.1243245413
1040101   3.882500958     0.4223124057
1042101  -2.389200357    -0.2881820739
1042201  -7.337963729    -0.2381278056
1044801   5.063737729     0.1565980098
1047801  -2.760234293    -0.2101134212
1050001  -2.834390560    -0.0925525719
1050701  -5.695588916     0.6616487481
1053201  -0.599389674    -0.1378580936
1053202  -7.116932507    -0.3488730245
1053802  -7.098840842     0.1161428377
1053804  -7.518495890    -0.2127588435
1056501  -4.662066297    -0.0688020154
1081101  -6.509487554    -0.2433586628
1081103  -4.535700136    -0.0489579883
1176403  -2.478665580    -0.3619317394
1176502  -5.361130357     0.1014948455
1179201   6.169266543    -0.2715601330
1179202   2.828003388     0.0468697930
1180202   1.281663901    -0.5472646124
1181201 -12.764929271    -0.5961826909
1181902  -3.179238219    -0.1577544718
1181904  -5.521812552    -0.1832687129
1182604   0.677485736    -0.3209083737
1185003 -12.971458846    -0.0415619496
1187001   3.494246653    -0.3201390580
1187303   6.157122681     0.3331643729
1189901   9.250401396     0.3775423118
1190501  -2.887202250    -0.1068928078
1191001   2.654860996     0.2646823447
1191901   4.496785221     0.1631820463
1194901  -2.945928120     1.0021463443
1197902  -6.624966665    -0.3709318601
1198101  -1.383949304    -0.2114699808
1198901  16.464380969     0.0561320208
1201701  -1.448990580    -0.2336679925
1201702  -0.096107319    -0.5865903882
1203201  -1.895771421    -0.4878402424
1205201  -5.525566536     0.2163459801
1207601   4.719495051     0.1382756094
1209201  -0.349522573    -0.1862900381
1211502   9.264718431     0.1745673561
1211503   5.881429621     0.1257080878
1212303  -2.959730778     0.0557280182
1213501  -4.357858111     1.0978055000
1217202  -1.786493616    -0.5895225445
1217204  -7.916052388    -0.0739003214
1217702  -2.632215582    -0.0357903367
1217704  -2.184052557    -0.1210937439
1219103  -7.783664844    -0.1154947959
1219105 -14.003540434    -0.4179680812
1219106 -14.952823473    -0.3505976607
1219108   1.648006949     0.3247083801
1221003   0.152689839    -0.1226131532
1221702  -4.589571607    -0.2141049895
1224001   3.179239571    -0.2058228146
1225402  -4.958955736    -0.1677144514
1228103  -0.253089392    -0.0056286513
1230302  -9.114014727    -0.6678043203
1256601  -7.998906403    -0.1309251668</code></pre>
</div>
</div>
</section></section></section></section><section id="generalized" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> Generalized Linear Mixed Models</h1>
<p><a href="https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html" class="uri">https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html</a> (archived at <a href="https://perma.cc/9RFS-BCE7" class="uri">https://perma.cc/9RFS-BCE7</a>; source code: <a href="https://github.com/bbolker/mixedmodels-misc/blob/master/glmmFAQ.rmd" class="uri">https://github.com/bbolker/mixedmodels-misc/blob/master/glmmFAQ.rmd</a>)</p>
<section id="lmer" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="lmer">
<span class="header-section-number">7.1</span> <code>lmer</code>
</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">generalizedLinearMixedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span><span class="op">(</span></span>
<span>  <span class="va">outcome</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span> <span class="op">+</span> <span class="op">(</span><span class="va">ageYearsCentered</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">generalizedLinearMixedModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: poisson  ( log )
Formula: outcome ~ female + ageYearsCentered + (ageYearsCentered | id)
   Data: mydata

      AIC       BIC    logLik -2*log(L)  df.resid 
   9329.7    9363.9   -4658.8    9317.7      2215 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.0331 -0.5546 -0.0205  0.5350  5.0222 

Random effects:
 Groups Name             Variance  Std.Dev. Corr 
 id     (Intercept)      0.0058309 0.07636       
        ageYearsCentered 0.0002845 0.01687  -1.00
Number of obs: 2221, groups:  id, 932

Fixed effects:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      1.343986   0.026879  50.001   &lt;2e-16 ***
female           0.007439   0.021268   0.350   0.7265    
ageYearsCentered 0.010279   0.005804   1.771   0.0766 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) female
female      -0.421       
ageYrsCntrd -0.831  0.036
optimizer (Nelder_Mead) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
</section><section id="mass" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="mass">
<span class="header-section-number">7.2</span> <code>MASS</code>
</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">glmmPQLmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glmmPQL.html">glmmPQL</a></span><span class="op">(</span></span>
<span>  <span class="va">outcome</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">ageYearsCentered</span><span class="op">|</span><span class="va">id</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">glmmPQLmodel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by maximum likelihood
  Data: mydata 
  AIC BIC logLik
   NA  NA     NA

Random effects:
 Formula: ~1 + ageYearsCentered | id
 Structure: General positive-definite, Log-Cholesky parametrization
                 StdDev       Corr  
(Intercept)      5.533290e-05 (Intr)
ageYearsCentered 9.320922e-08 0     
Residual         1.014184e+00       

Variance function:
 Structure: fixed weights
 Formula: ~invwt 
Fixed effects:  outcome ~ female + ageYearsCentered 
                     Value   Std.Error   DF  t-value p-value
(Intercept)      1.3453017 0.027100741 1288 49.64077  0.0000
female           0.0074130 0.021543030  930  0.34410  0.7308
ageYearsCentered 0.0100806 0.005850753 1288  1.72296  0.0851
 Correlation: 
                 (Intr) female
female           -0.423       
ageYearsCentered -0.829  0.036

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-2.00970268 -0.55110605 -0.02158036  0.53179575  4.98914420 

Number of Observations: 2221
Number of Groups: 932 </code></pre>
</div>
</div>
</section><section id="mcmcglmm" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="mcmcglmm">
<span class="header-section-number">7.3</span> <code>MCMCglmm</code>
</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">MCMCglmmModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MCMCglmm/man/MCMCglmm.html">MCMCglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">outcome</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">us</span><span class="op">(</span><span class="va">ageYearsCentered</span><span class="op">)</span><span class="op">:</span><span class="va">id</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>,<span class="st">"outcome"</span>,<span class="st">"female"</span>,<span class="st">"ageYearsCentered"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
                       MCMC iteration = 0

 Acceptance ratio for liability set 1 = 0.000410

                       MCMC iteration = 1000

 Acceptance ratio for liability set 1 = 0.439819

                       MCMC iteration = 2000

 Acceptance ratio for liability set 1 = 0.439977

                       MCMC iteration = 3000

 Acceptance ratio for liability set 1 = 0.444608

                       MCMC iteration = 4000

 Acceptance ratio for liability set 1 = 0.496749

                       MCMC iteration = 5000

 Acceptance ratio for liability set 1 = 0.490778

                       MCMC iteration = 6000

 Acceptance ratio for liability set 1 = 0.512362

                       MCMC iteration = 7000

 Acceptance ratio for liability set 1 = 0.428231

                       MCMC iteration = 8000

 Acceptance ratio for liability set 1 = 0.412336

                       MCMC iteration = 9000

 Acceptance ratio for liability set 1 = 0.471726

                       MCMC iteration = 10000

 Acceptance ratio for liability set 1 = 0.428491

                       MCMC iteration = 11000

 Acceptance ratio for liability set 1 = 0.400078

                       MCMC iteration = 12000

 Acceptance ratio for liability set 1 = 0.346435

                       MCMC iteration = 13000

 Acceptance ratio for liability set 1 = 0.276170</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">MCMCglmmModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
 Iterations = 3001:12991
 Thinning interval  = 10
 Sample size  = 1000 

 DIC: 9323.524 

 G-structure:  ~us(ageYearsCentered):id

                                     post.mean  l-95% CI  u-95% CI eff.samp
ageYearsCentered:ageYearsCentered.id 6.754e-06 1.087e-08 4.053e-05    7.788

 R-structure:  ~units

      post.mean l-95% CI u-95% CI eff.samp
units   0.00877 0.001634  0.01728    7.797

 Location effects: outcome ~ female + ageYearsCentered 

                 post.mean  l-95% CI  u-95% CI eff.samp  pMCMC    
(Intercept)       1.338707  1.281096  1.387614    55.58 &lt;0.001 ***
female            0.007688 -0.031193  0.052271    58.65  0.706    
ageYearsCentered  0.010561  0.000813  0.021420    57.32  0.046 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section></section><section id="nonlinear" class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> Nonlinear Mixed Models</h1>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nonlinearModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/nlme.html">nlme</a></span><span class="op">(</span></span>
<span>  <span class="va">height</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/SSasymp.html">SSasymp</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">Asym</span>, <span class="va">R0</span>, <span class="va">lrc</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">Loblolly</span>,</span>
<span>  fixed <span class="op">=</span> <span class="va">Asym</span> <span class="op">+</span> <span class="va">R0</span> <span class="op">+</span> <span class="va">lrc</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  random <span class="op">=</span> <span class="va">Asym</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">nonlinearModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Nonlinear mixed-effects model fit by maximum likelihood
  Model: height ~ SSasymp(age, Asym, R0, lrc) 
  Data: Loblolly 
      AIC      BIC   logLik
  239.486 251.6401 -114.743

Random effects:
 Formula: Asym ~ 1 | Seed
            Asym  Residual
StdDev: 3.650645 0.7188624

Fixed effects:  list(Asym ~ 1, R0 ~ 1, lrc ~ 1) 
         Value Std.Error DF   t-value p-value
Asym 101.44830 2.4616151 68  41.21209       0
R0    -8.62749 0.3179519 68 -27.13459       0
lrc   -3.23373 0.0342695 68 -94.36168       0
 Correlation: 
    Asym   R0    
R0   0.704       
lrc -0.908 -0.827

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-2.23604174 -0.62389999  0.05912777  0.65724316  1.95790785 

Number of Observations: 84
Number of Groups: 14 </code></pre>
</div>
</div>
</section><section id="robust-mixed-models" class="level1" data-number="9"><h1 data-number="9">
<span class="header-section-number">9</span> Robust Mixed Models</h1>
<p>To evaluate the extent to which a finding could driven by outliers, this could be done in a number of different ways, such as:</p>
<ul>
<li>identifying and excluding influential observations based on DFBETAS or Cook’s distance (Nieuwenhuis, Grotenhuis, &amp; Pelzer, 2012)</li>
<li>fitting mixed models using rank-based estimation (Bilgic &amp; Susmann, 2013; Finch, 2017) or robust estimating equations (Koller, 2016)</li>
<li>estimating robust standard errors using a sandwich estimator (Wang &amp; Merkle, 2018)</li>
</ul></section><section id="assumptions" class="level1" data-number="10"><h1 data-number="10">
<span class="header-section-number">10</span> Assumptions</h1>
<p>The within-group errors:</p>
<ol type="1">
<li>are independent</li>
<li>are identically normally distributed</li>
<li>have mean zero and variance sigma-squared</li>
<li>are independent of the random effects</li>
</ol>
<p>The random effects:</p>
<ol start="5" type="1">
<li>are normally distributed</li>
<li>have mean zero and covariance matrix Psi (not depending on the group)</li>
<li>are independent for different groups</li>
</ol></section><section id="examining-model-assumptions" class="level1" data-number="11"><h1 data-number="11">
<span class="header-section-number">11</span> Examining Model Assumptions</h1>
<section id="resources" class="level2" data-number="11.1"><h2 data-number="11.1" class="anchored" data-anchor-id="resources">
<span class="header-section-number">11.1</span> Resources</h2>
<p>Pinheiro and Bates (2000) book (p.&nbsp;174, section 4.3.1)</p>
<p><a href="https://stats.stackexchange.com/questions/77891/checking-assumptions-lmer-lme-mixed-models-in-r" class="uri">https://stats.stackexchange.com/questions/77891/checking-assumptions-lmer-lme-mixed-models-in-r</a> (archived at <a href="https://perma.cc/J5GC-PCUT" class="uri">https://perma.cc/J5GC-PCUT</a>)</p>
</section><section id="qq-plots" class="level2" data-number="11.2"><h2 data-number="11.2" class="anchored" data-anchor-id="qq-plots">
<span class="header-section-number">11.2</span> QQ Plots</h2>
<p>Make QQ plots for each level of the random effects. Vary the level from 0, 1, to 2 so that you can check the between- and within-subject residuals.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>,</span>
<span>       <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">.</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-36-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="hlm_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="pp-plots" class="level2" data-number="11.3"><h2 data-number="11.3" class="anchored" data-anchor-id="pp-plots">
<span class="header-section-number">11.3</span> PP Plots</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://devpsylab.github.io/petersenlab/reference/ppPlot.html">ppPlot</a></span><span class="op">(</span><span class="va">linearMixedModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-37-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="hlm_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="qq-plot-of-residuals" class="level2" data-number="11.4"><h2 data-number="11.4" class="anchored" data-anchor-id="qq-plot-of-residuals">
<span class="header-section-number">11.4</span> QQ Plot of residuals</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">linearMixedModel</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">linearMixedModel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-38-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="hlm_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="plot-residuals" class="level2" data-number="11.5"><h2 data-number="11.5" class="anchored" data-anchor-id="plot-residuals">
<span class="header-section-number">11.5</span> Plot residuals</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">linearMixedModel</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-39-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="hlm_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="plot-residuals-by-group-in-the-example-below-level-2-represents-the-individual" class="level2" data-number="11.6"><h2 data-number="11.6" class="anchored" data-anchor-id="plot-residuals-by-group-in-the-example-below-level-2-represents-the-individual">
<span class="header-section-number">11.6</span> Plot residuals by group (in the example below, level 2 represents the individual)</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">linearMixedModel</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>     abline <span class="op">=</span> <span class="fl">0</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-40-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="hlm_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="plot-residuals-by-levels-of-a-predictor" class="level2" data-number="11.7"><h2 data-number="11.7" class="anchored" data-anchor-id="plot-residuals-by-levels-of-a-predictor">
<span class="header-section-number">11.7</span> Plot residuals by levels of a predictor</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">.</span>, type <span class="op">=</span> <span class="st">"p"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">|</span> <span class="va">female</span><span class="op">)</span> <span class="co">#type = "p" specifies standardized residuals</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-41-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="hlm_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="can-model-heteroscedasticity-of-the-within-group-error-with-the-weights-argument" class="level2" data-number="11.8"><h2 data-number="11.8" class="anchored" data-anchor-id="can-model-heteroscedasticity-of-the-within-group-error-with-the-weights-argument">
<span class="header-section-number">11.8</span> Can model heteroscedasticity of the within-group error with the weights argument</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">linearMixedModel_nlmeVarStructure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span><span class="op">(</span></span>
<span>  <span class="va">math</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">ageYearsCentered</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">ageYearsCentered</span><span class="op">|</span><span class="va">id</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/varIdent.html">varIdent</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">female</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"ML"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mydata</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linearMixedModel_nlmeVarStructure</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by maximum likelihood
  Data: mydata 
       AIC      BIC    logLik
  15857.83 15903.48 -7920.915

Random effects:
 Formula: ~1 + ageYearsCentered | id
 Structure: General positive-definite, Log-Cholesky parametrization
                 StdDev    Corr  
(Intercept)      7.9177716 (Intr)
ageYearsCentered 0.8278343 0.076 
Residual         5.6410162       

Variance function:
 Structure: Different standard deviations per stratum
 Formula: ~1 | female 
 Parameter estimates:
       1        0 
1.000000 1.009161 
Fixed effects:  math ~ female + ageYearsCentered 
                     Value Std.Error   DF  t-value p-value
(Intercept)      30.554856 0.5040373 1288 60.62022  0.0000
female           -0.692653 0.6172485  930 -1.12216  0.2621
ageYearsCentered  4.255258 0.0805531 1288 52.82553  0.0000
 Correlation: 
                 (Intr) female
female           -0.614       
ageYearsCentered -0.507  0.014

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-3.37982974 -0.51663213  0.00445497  0.52228733  2.63205084 

Number of Observations: 2221
Number of Groups: 932 </code></pre>
</div>
</div>
</section><section id="plot-observed-and-fitted-values" class="level2" data-number="11.9"><h2 data-number="11.9" class="anchored" data-anchor-id="plot-observed-and-fitted-values">
<span class="header-section-number">11.9</span> Plot observed and fitted values</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">linearMixedModel</span>,</span>
<span>     <span class="va">math</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-43-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="hlm_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="plot-qq-plot-of-residuals-by-levels-of-a-predictor" class="level2" data-number="11.10"><h2 data-number="11.10" class="anchored" data-anchor-id="plot-qq-plot-of-residuals-by-levels-of-a-predictor">
<span class="header-section-number">11.10</span> Plot QQ plot of residuals by levels of a predictor</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">|</span> <span class="va">female</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-44-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="hlm_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-44-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="hlm_files/figure-html/unnamed-chunk-44-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="qq-plot-of-random-effects" class="level2" data-number="11.11"><h2 data-number="11.11" class="anchored" data-anchor-id="qq-plot-of-random-effects">
<span class="header-section-number">11.11</span> QQ plot of random effects</h2>
<p>Make QQ plots for each level of the random effects. Vary the level from 0, 1, to 2 so that you can check the between- and within-subject residuals.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>,</span>
<span>       <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">.</span>, level <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `effects[[1L]]`:
! subscript out of bounds</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>,</span>
<span>       <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">.</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-45-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="hlm_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>,</span>
<span>       <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">.</span>, level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error:
! object '.y' not found</code></pre>
</div>
</div>
</section><section id="qq-plot-of-random-effects-by-levels-of-a-predictor" class="level2" data-number="11.12"><h2 data-number="11.12" class="anchored" data-anchor-id="qq-plot-of-random-effects-by-levels-of-a-predictor">
<span class="header-section-number">11.12</span> QQ plot of random effects by levels of a predictor</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>, </span>
<span>       <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">.</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|</span> <span class="va">female</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-46-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="hlm_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="pairs-plot" class="level2" data-number="11.13"><h2 data-number="11.13" class="anchored" data-anchor-id="pairs-plot">
<span class="header-section-number">11.13</span> Pairs plot</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-47-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="hlm_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">linearMixedModel_nlme</span>,</span>
<span>      <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">.</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|</span> <span class="va">female</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="hlm_files/figure-html/unnamed-chunk-47-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="hlm_files/figure-html/unnamed-chunk-47-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="variance-functions-for-modeling-heteroscedasticity" class="level2" data-number="11.14"><h2 data-number="11.14" class="anchored" data-anchor-id="variance-functions-for-modeling-heteroscedasticity">
<span class="header-section-number">11.14</span> Variance functions for modeling heteroscedasticity</h2>
<ul>
<li>
<code>varFixed</code>: fixed variance</li>
<li>
<code>varIdent</code>: different variances per stratum</li>
<li>
<code>varPower</code>: power of covariate</li>
<li>
<code>varExp</code>: exponential of covariate</li>
<li>
<code>varConstPower</code>: constant plus power of covariate</li>
<li>
<code>varComb</code>: combination of variance functions</li>
</ul></section><section id="correlation-structures-for-modeling-dependence" class="level2" data-number="11.15"><h2 data-number="11.15" class="anchored" data-anchor-id="correlation-structures-for-modeling-dependence">
<span class="header-section-number">11.15</span> Correlation structures for modeling dependence</h2>
<ul>
<li>
<code>corCompSymm</code>: compound symmetry</li>
<li>
<code>corSymm</code>: general</li>
<li>
<code>corAR1</code>: autoregressive of order 1</li>
<li>
<code>corCAR1</code>: continuous-time AR(1)</li>
<li>
<code>corARMA</code>: autoregressive-moving average</li>
<li>
<code>corExp</code>: exponential</li>
<li>
<code>corGaus</code>: Gaussian</li>
<li>
<code>corLin</code>: linear</li>
<li>
<code>corRatio</code>: rational quadratic</li>
<li>
<code>corSpher</code>: spherical</li>
</ul></section></section><section id="powerAnalysis" class="level1" data-number="12"><h1 data-number="12">
<span class="header-section-number">12</span> Power Analysis</h1>
<ul>
<li>
<code>mlmpower</code>: <a href="https://github.com/bkeller2/mlmpower" class="uri">https://github.com/bkeller2/mlmpower</a> (<a href="https://doi.org/10.1037/met0000614">Enders et al., 2025</a>)</li>
<li><a href="https://aguinis.shinyapps.io/ml_power/" class="uri">https://aguinis.shinyapps.io/ml_power/</a></li>
<li>
<a href="https://www.causalevaluation.org/power-analysis.html" class="uri">https://www.causalevaluation.org/power-analysis.html</a>
<ul>
<li><a href="https://powerupr.shinyapps.io/index/" class="uri">https://powerupr.shinyapps.io/index/</a></li>
</ul>
</li>
<li><a href="https://koumurayama.shinyapps.io/tmethod_mlm/" class="uri">https://koumurayama.shinyapps.io/tmethod_mlm/</a></li>
<li><a href="https://webpower.psychstat.org/wiki/models/index" class="uri">https://webpower.psychstat.org/wiki/models/index</a></li>
</ul></section><section id="session-info" class="level1" data-number="13"><h1 data-number="13">
<span class="header-section-number">13</span> Session Info</h1>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.2 (2025-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] ggplot2_4.0.1      performance_0.15.3 MCMCglmm_2.36      ape_5.8-1         
 [5] coda_0.19-4.1      MASS_7.3-65        lmerTest_3.1-3     nlme_3.1-168      
 [9] lme4_1.1-38        Matrix_1.7-4       petersenlab_1.2.2 

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.1    psych_2.5.6         viridisLite_0.4.2  
 [4] dplyr_1.1.4         farver_2.1.2        S7_0.2.1           
 [7] fastmap_1.2.0       tensorA_0.36.2.1    digest_0.6.39      
[10] rpart_4.1.24        lifecycle_1.0.4     cluster_2.1.8.1    
[13] magrittr_2.0.4      compiler_4.5.2      rlang_1.1.6        
[16] Hmisc_5.2-4         tools_4.5.2         yaml_2.3.12        
[19] data.table_1.17.8   knitr_1.51          labeling_0.4.3     
[22] htmlwidgets_1.6.4   mnormt_2.1.1        plyr_1.8.9         
[25] RColorBrewer_1.1-3  withr_3.0.2         foreign_0.8-90     
[28] purrr_1.2.0         numDeriv_2016.8-1.1 nnet_7.3-20        
[31] grid_4.5.2          stats4_4.5.2        lavaan_0.6-21      
[34] xtable_1.8-4        colorspace_2.1-2    scales_1.4.0       
[37] insight_1.4.4       cli_3.6.5           mvtnorm_1.3-3      
[40] rmarkdown_2.30      reformulas_0.4.3    generics_0.1.4     
[43] otel_0.2.0          rstudioapi_0.17.1   reshape2_1.4.5     
[46] minqa_1.2.8         DBI_1.2.3           stringr_1.6.0      
[49] splines_4.5.2       parallel_4.5.2      base64enc_0.1-3    
[52] mitools_2.4         vctrs_0.6.5         boot_1.3-32        
[55] jsonlite_2.0.0      Formula_1.2-5       htmlTable_2.4.3    
[58] glue_1.8.0          nloptr_2.2.1        cubature_2.1.4-1   
[61] stringi_1.8.7       gtable_0.3.6        quadprog_1.5-8     
[64] tibble_3.3.0        pillar_1.11.1       htmltools_0.5.9    
[67] R6_2.6.1            Rdpack_2.6.4        mix_1.0-13         
[70] evaluate_1.0.5      pbivnorm_0.6.0      lattice_0.22-7     
[73] rbibutils_2.4       backports_1.5.0     corpcor_1.6.10     
[76] Rcpp_1.1.0          gridExtra_2.3       checkmate_2.3.3    
[79] xfun_0.55           pkgconfig_2.0.3    </code></pre>
</div>
</div>


<!-- -->

</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section></div></main><!-- /main --><!-- Add lab logo --><p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%"></a>
</p>

<br><hr>
<br><!-- Add icon library --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!-- Add font awesome icons --><p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/DevPsyLab\.github\.io\/DataAnalysis\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb74" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Hierarchical Linear Modeling"</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html_document:</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co">    code_folding: show</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="fu"># Preamble</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## Install Libraries</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("remotes")</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github("DevPsyLab/petersenlab")</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load Libraries</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"petersenlab"</span>)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"lme4"</span>)</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"nlme"</span>)</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"lmerTest"</span>)</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"MASS"</span>)</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"MCMCglmm"</span>)</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"performance"</span>)</span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a><span class="fu">## Import Data</span></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://osf.io/cqn3d/download"</span>)</span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/nlsy_math_long.csv"</span>) <span class="co">#https://osf.io/cqn3d/download</span></span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulate Data</span></span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">52242</span>)</span>
<span id="cb74-58"><a href="#cb74-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-59"><a href="#cb74-59" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>outcome <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="fu">nrow</span>(mydata), <span class="dv">4</span>)</span>
<span id="cb74-60"><a href="#cb74-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-61"><a href="#cb74-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-62"><a href="#cb74-62" aria-hidden="true" tabindex="-1"></a><span class="fu"># Terms</span></span>
<span id="cb74-63"><a href="#cb74-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-64"><a href="#cb74-64" aria-hidden="true" tabindex="-1"></a>These models go by a variety of different terms:</span>
<span id="cb74-65"><a href="#cb74-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-66"><a href="#cb74-66" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>hierarchical linear model (HLM)</span>
<span id="cb74-67"><a href="#cb74-67" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>multilevel model (MLM)</span>
<span id="cb74-68"><a href="#cb74-68" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>mixed effects model</span>
<span id="cb74-69"><a href="#cb74-69" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>mixed model</span>
<span id="cb74-70"><a href="#cb74-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-71"><a href="#cb74-71" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overview</span></span>
<span id="cb74-72"><a href="#cb74-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-73"><a href="#cb74-73" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://isaactpetersen.github.io/Principles-Psychological-Assessment/reliability.html#mixedModels&gt;</span></span>
<span id="cb74-74"><a href="#cb74-74" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook/mixed-models.html&gt;</span></span>
<span id="cb74-75"><a href="#cb74-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-76"><a href="#cb74-76" aria-hidden="true" tabindex="-1"></a><span class="fu"># Pre-Model Computation</span></span>
<span id="cb74-77"><a href="#cb74-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-78"><a href="#cb74-78" aria-hidden="true" tabindex="-1"></a>It can be helpful to center the age/time variable so that the intercept in a growth curve model has meaning.</span>
<span id="cb74-79"><a href="#cb74-79" aria-hidden="true" tabindex="-1"></a>For instance, we can subtract the youngest participant age to set the intercepts to be the earliest age in the sample.</span>
<span id="cb74-80"><a href="#cb74-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-83"><a href="#cb74-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-84"><a href="#cb74-84" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>ageYears <span class="ot">&lt;-</span> mydata<span class="sc">$</span>age <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb74-85"><a href="#cb74-85" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>ageMonthsCentered <span class="ot">&lt;-</span> mydata<span class="sc">$</span>age <span class="sc">-</span> <span class="fu">min</span>(mydata<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb74-86"><a href="#cb74-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-87"><a href="#cb74-87" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>ageYearsCentered <span class="ot">&lt;-</span> mydata<span class="sc">$</span>ageMonthsCentered <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb74-88"><a href="#cb74-88" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>ageYearsCenteredSquared <span class="ot">&lt;-</span> mydata<span class="sc">$</span>ageYearsCentered <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb74-89"><a href="#cb74-89" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-90"><a href="#cb74-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-91"><a href="#cb74-91" aria-hidden="true" tabindex="-1"></a><span class="fu"># Estimator: ML or REML</span></span>
<span id="cb74-92"><a href="#cb74-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-93"><a href="#cb74-93" aria-hidden="true" tabindex="-1"></a>For small sample sizes, restricted maximum likelihood (REML) is preferred over maximum likelihood (ML).</span>
<span id="cb74-94"><a href="#cb74-94" aria-hidden="true" tabindex="-1"></a>ML preferred when there is a small number (&lt; 4) of fixed effects; REML is preferred when there are more (&gt; 4) fixed effects.</span>
<span id="cb74-95"><a href="#cb74-95" aria-hidden="true" tabindex="-1"></a>The greater the number of fixed effects, the greater the difference between REML and ML estimates.</span>
<span id="cb74-96"><a href="#cb74-96" aria-hidden="true" tabindex="-1"></a>Likelihood ratio (LR) tests for REML require exactly the same fixed effects specification in both models.</span>
<span id="cb74-97"><a href="#cb74-97" aria-hidden="true" tabindex="-1"></a>So, to compare models with different fixed effects with an LR test (to determine whether to include a particular fixed effect), ML must be used.</span>
<span id="cb74-98"><a href="#cb74-98" aria-hidden="true" tabindex="-1"></a>In contrast to the maximum likelihood estimation, REML can produce unbiased estimates of variance and covariance parameters, variance estimates are larger in REML than ML.</span>
<span id="cb74-99"><a href="#cb74-99" aria-hidden="true" tabindex="-1"></a>To compare whether an effect should be fixed or random, use REML.</span>
<span id="cb74-100"><a href="#cb74-100" aria-hidden="true" tabindex="-1"></a>To simultaneously compare fixed and random effects, use ML.</span>
<span id="cb74-101"><a href="#cb74-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-102"><a href="#cb74-102" aria-hidden="true" tabindex="-1"></a><span class="fu"># Linear Mixed Models {#linear}</span></span>
<span id="cb74-103"><a href="#cb74-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-104"><a href="#cb74-104" aria-hidden="true" tabindex="-1"></a>The following models are models that are fit in a linear mixed modeling framework.</span>
<span id="cb74-105"><a href="#cb74-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-106"><a href="#cb74-106" aria-hidden="true" tabindex="-1"></a><span class="fu">## Growth Curve Models {#gcm}</span></span>
<span id="cb74-107"><a href="#cb74-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-108"><a href="#cb74-108" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linear Growth Curve Model {#linearGCM}</span></span>
<span id="cb74-109"><a href="#cb74-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-110"><a href="#cb74-110" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plot Observed Growth Curves</span></span>
<span id="cb74-111"><a href="#cb74-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-114"><a href="#cb74-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-115"><a href="#cb74-115" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-116"><a href="#cb74-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-117"><a href="#cb74-117" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-118"><a href="#cb74-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ageYears,</span>
<span id="cb74-119"><a href="#cb74-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> math,</span>
<span id="cb74-120"><a href="#cb74-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> id)) <span class="sc">+</span></span>
<span id="cb74-121"><a href="#cb74-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb74-122"><a href="#cb74-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb74-123"><a href="#cb74-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-124"><a href="#cb74-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb74-125"><a href="#cb74-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Math Score"</span>)</span>
<span id="cb74-126"><a href="#cb74-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-127"><a href="#cb74-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-128"><a href="#cb74-128" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `lme4`</span></span>
<span id="cb74-129"><a href="#cb74-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-132"><a href="#cb74-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-133"><a href="#cb74-133" aria-hidden="true" tabindex="-1"></a>linearMixedModel <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb74-134"><a href="#cb74-134" aria-hidden="true" tabindex="-1"></a>  math <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered <span class="sc">+</span> female<span class="sc">:</span>ageYearsCentered <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> ageYearsCentered <span class="sc">|</span> id), <span class="co"># random intercepts and slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span id="cb74-135"><a href="#cb74-135" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-136"><a href="#cb74-136" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span id="cb74-137"><a href="#cb74-137" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb74-138"><a href="#cb74-138" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span>
<span id="cb74-139"><a href="#cb74-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-140"><a href="#cb74-140" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linearMixedModel)</span>
<span id="cb74-141"><a href="#cb74-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-142"><a href="#cb74-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-143"><a href="#cb74-143" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Protoypical Growth Curve</span></span>
<span id="cb74-144"><a href="#cb74-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-147"><a href="#cb74-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-148"><a href="#cb74-148" aria-hidden="true" tabindex="-1"></a>newData <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb74-149"><a href="#cb74-149" aria-hidden="true" tabindex="-1"></a>  <span class="at">female =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb74-150"><a href="#cb74-150" aria-hidden="true" tabindex="-1"></a>  <span class="at">ageYears =</span> <span class="fu">c</span>(</span>
<span id="cb74-151"><a href="#cb74-151" aria-hidden="true" tabindex="-1"></a>    <span class="fu">min</span>(mydata<span class="sc">$</span>ageYears, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb74-152"><a href="#cb74-152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(mydata<span class="sc">$</span>ageYears, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb74-153"><a href="#cb74-153" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-154"><a href="#cb74-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-155"><a href="#cb74-155" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>ageYearsCentered <span class="ot">&lt;-</span> newData<span class="sc">$</span>ageYears <span class="sc">-</span> <span class="fu">min</span>(newData<span class="sc">$</span>ageYears)</span>
<span id="cb74-156"><a href="#cb74-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-157"><a href="#cb74-157" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb74-158"><a href="#cb74-158" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex[<span class="fu">which</span>(newData<span class="sc">$</span>female <span class="sc">==</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="st">"male"</span></span>
<span id="cb74-159"><a href="#cb74-159" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex[<span class="fu">which</span>(newData<span class="sc">$</span>female <span class="sc">==</span> <span class="dv">1</span>)] <span class="ot">&lt;-</span> <span class="st">"female"</span></span>
<span id="cb74-160"><a href="#cb74-160" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(newData<span class="sc">$</span>sex)</span>
<span id="cb74-161"><a href="#cb74-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-162"><a href="#cb74-162" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>predictedValue <span class="ot">&lt;-</span> <span class="fu">predict</span>( <span class="co"># predict.merMod</span></span>
<span id="cb74-163"><a href="#cb74-163" aria-hidden="true" tabindex="-1"></a>  linearMixedModel,</span>
<span id="cb74-164"><a href="#cb74-164" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> newData,</span>
<span id="cb74-165"><a href="#cb74-165" aria-hidden="true" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="cn">NA</span></span>
<span id="cb74-166"><a href="#cb74-166" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-167"><a href="#cb74-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-168"><a href="#cb74-168" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-169"><a href="#cb74-169" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> newData,</span>
<span id="cb74-170"><a href="#cb74-170" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ageYears, <span class="at">y =</span> predictedValue, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb74-171"><a href="#cb74-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-172"><a href="#cb74-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-173"><a href="#cb74-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb74-174"><a href="#cb74-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-175"><a href="#cb74-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-176"><a href="#cb74-176" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Individuals' Growth Curves</span></span>
<span id="cb74-177"><a href="#cb74-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-180"><a href="#cb74-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-181"><a href="#cb74-181" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>predictedValue <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb74-182"><a href="#cb74-182" aria-hidden="true" tabindex="-1"></a>  linearMixedModel,</span>
<span id="cb74-183"><a href="#cb74-183" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> mydata,</span>
<span id="cb74-184"><a href="#cb74-184" aria-hidden="true" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="cn">NULL</span></span>
<span id="cb74-185"><a href="#cb74-185" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-186"><a href="#cb74-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-187"><a href="#cb74-187" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-188"><a href="#cb74-188" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-189"><a href="#cb74-189" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ageYears, <span class="at">y =</span> predictedValue, <span class="at">group =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb74-190"><a href="#cb74-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-191"><a href="#cb74-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-192"><a href="#cb74-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb74-193"><a href="#cb74-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-194"><a href="#cb74-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-195"><a href="#cb74-195" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Individuals' Trajectories Overlaid with Prototypical Trajectory</span></span>
<span id="cb74-196"><a href="#cb74-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-199"><a href="#cb74-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-200"><a href="#cb74-200" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-201"><a href="#cb74-201" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-202"><a href="#cb74-202" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ageYears, <span class="at">y =</span> predictedValue, <span class="at">group =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb74-203"><a href="#cb74-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-204"><a href="#cb74-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-205"><a href="#cb74-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb74-206"><a href="#cb74-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb74-207"><a href="#cb74-207" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newData,</span>
<span id="cb74-208"><a href="#cb74-208" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ageYears, <span class="at">y =</span> predictedValue, <span class="at">group =</span> sex, <span class="at">color =</span> sex),</span>
<span id="cb74-209"><a href="#cb74-209" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">2</span>)</span>
<span id="cb74-210"><a href="#cb74-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-211"><a href="#cb74-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-212"><a href="#cb74-212" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Extract Random Effects {#extractRandomEffects}</span></span>
<span id="cb74-213"><a href="#cb74-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-216"><a href="#cb74-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-217"><a href="#cb74-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb74-218"><a href="#cb74-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-219"><a href="#cb74-219" aria-hidden="true" tabindex="-1"></a><span class="fu">ranef</span>(linearMixedModel)</span>
<span id="cb74-220"><a href="#cb74-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-221"><a href="#cb74-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-224"><a href="#cb74-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-225"><a href="#cb74-225" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb74-226"><a href="#cb74-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-227"><a href="#cb74-227" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">ranef</span>(linearMixedModel))</span>
<span id="cb74-228"><a href="#cb74-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-229"><a href="#cb74-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-230"><a href="#cb74-230" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `nlme`</span></span>
<span id="cb74-231"><a href="#cb74-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-234"><a href="#cb74-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-235"><a href="#cb74-235" aria-hidden="true" tabindex="-1"></a>linearMixedModel_nlme <span class="ot">&lt;-</span> <span class="fu">lme</span>(</span>
<span id="cb74-236"><a href="#cb74-236" aria-hidden="true" tabindex="-1"></a>  math <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered <span class="sc">+</span> female<span class="sc">:</span>ageYearsCentered, <span class="co"># sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span id="cb74-237"><a href="#cb74-237" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> ageYearsCentered<span class="sc">|</span>id, <span class="co"># random intercepts and slopes</span></span>
<span id="cb74-238"><a href="#cb74-238" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-239"><a href="#cb74-239" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"ML"</span>,</span>
<span id="cb74-240"><a href="#cb74-240" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb74-241"><a href="#cb74-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-242"><a href="#cb74-242" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linearMixedModel_nlme)</span>
<span id="cb74-243"><a href="#cb74-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-244"><a href="#cb74-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-245"><a href="#cb74-245" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Intraclass Correlation Coefficent {#icc}</span></span>
<span id="cb74-246"><a href="#cb74-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-249"><a href="#cb74-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-250"><a href="#cb74-250" aria-hidden="true" tabindex="-1"></a><span class="fu">icc</span>(linearMixedModel)</span>
<span id="cb74-251"><a href="#cb74-251" aria-hidden="true" tabindex="-1"></a><span class="fu">icc</span>(linearMixedModel_nlme)</span>
<span id="cb74-252"><a href="#cb74-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-253"><a href="#cb74-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-254"><a href="#cb74-254" aria-hidden="true" tabindex="-1"></a><span class="fu">### Growth Curve Model with Timepoint-Specific Errors {#timepointSpecificErrorsGCM}</span></span>
<span id="cb74-255"><a href="#cb74-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-256"><a href="#cb74-256" aria-hidden="true" tabindex="-1"></a>Adapted from Usami &amp; Murayama (2018):</span>
<span id="cb74-257"><a href="#cb74-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-260"><a href="#cb74-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-261"><a href="#cb74-261" aria-hidden="true" tabindex="-1"></a>timepointSpecificErrorsMixedModel <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb74-262"><a href="#cb74-262" aria-hidden="true" tabindex="-1"></a>  math <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered <span class="sc">+</span> female<span class="sc">:</span>ageYearsCentered <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ageYearsCentered), <span class="co"># timepoint-specific errors: observations are cross-classified with person and timepoint; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span id="cb74-263"><a href="#cb74-263" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-264"><a href="#cb74-264" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span id="cb74-265"><a href="#cb74-265" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb74-266"><a href="#cb74-266" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span>
<span id="cb74-267"><a href="#cb74-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-268"><a href="#cb74-268" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(timepointSpecificErrorsMixedModel)</span>
<span id="cb74-269"><a href="#cb74-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-270"><a href="#cb74-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-271"><a href="#cb74-271" aria-hidden="true" tabindex="-1"></a><span class="fu">### Quadratic Growth Curve Model {#quadraticGCM}</span></span>
<span id="cb74-272"><a href="#cb74-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-273"><a href="#cb74-273" aria-hidden="true" tabindex="-1"></a>When using higher-order polynomials, we could specify contrast codes for time to reduce multicollinearity between the linear and quadratic growth factors: <span class="ot">&lt;https://tdjorgensen.github.io/SEM-in-Ed-compendium/ch27.html#saturated-growth-model&gt;</span></span>
<span id="cb74-274"><a href="#cb74-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-277"><a href="#cb74-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-278"><a href="#cb74-278" aria-hidden="true" tabindex="-1"></a>factorLoadings <span class="ot">&lt;-</span> <span class="fu">poly</span>(</span>
<span id="cb74-279"><a href="#cb74-279" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="co"># times (can allow unequal spacing)</span></span>
<span id="cb74-280"><a href="#cb74-280" aria-hidden="true" tabindex="-1"></a>  <span class="at">degree =</span> <span class="dv">2</span>)</span>
<span id="cb74-281"><a href="#cb74-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-282"><a href="#cb74-282" aria-hidden="true" tabindex="-1"></a>factorLoadings</span>
<span id="cb74-283"><a href="#cb74-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-284"><a href="#cb74-284" aria-hidden="true" tabindex="-1"></a>linearLoadings <span class="ot">&lt;-</span> factorLoadings[,<span class="dv">1</span>]</span>
<span id="cb74-285"><a href="#cb74-285" aria-hidden="true" tabindex="-1"></a>quadraticLoadings <span class="ot">&lt;-</span> factorLoadings[,<span class="dv">2</span>]</span>
<span id="cb74-286"><a href="#cb74-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-287"><a href="#cb74-287" aria-hidden="true" tabindex="-1"></a>linearLoadings</span>
<span id="cb74-288"><a href="#cb74-288" aria-hidden="true" tabindex="-1"></a>quadraticLoadings</span>
<span id="cb74-289"><a href="#cb74-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-290"><a href="#cb74-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-291"><a href="#cb74-291" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb74-292"><a href="#cb74-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-295"><a href="#cb74-295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-296"><a href="#cb74-296" aria-hidden="true" tabindex="-1"></a>quadraticGCM <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb74-297"><a href="#cb74-297" aria-hidden="true" tabindex="-1"></a>  math <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered <span class="sc">+</span> ageYearsCenteredSquared <span class="sc">+</span> female<span class="sc">:</span>ageYearsCentered <span class="sc">+</span> female<span class="sc">:</span>ageYearsCenteredSquared <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> ageYearsCentered <span class="sc">|</span> id), <span class="co"># random intercepts and linear slopes; fixed quadratic slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span id="cb74-298"><a href="#cb74-298" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-299"><a href="#cb74-299" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span id="cb74-300"><a href="#cb74-300" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb74-301"><a href="#cb74-301" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span>
<span id="cb74-302"><a href="#cb74-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-303"><a href="#cb74-303" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quadraticGCM)</span>
<span id="cb74-304"><a href="#cb74-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-305"><a href="#cb74-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-306"><a href="#cb74-306" aria-hidden="true" tabindex="-1"></a>This is equivalent to:</span>
<span id="cb74-307"><a href="#cb74-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-310"><a href="#cb74-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-311"><a href="#cb74-311" aria-hidden="true" tabindex="-1"></a>quadraticGCM <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb74-312"><a href="#cb74-312" aria-hidden="true" tabindex="-1"></a>  math <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered <span class="sc">+</span> <span class="fu">I</span>(ageYearsCentered<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> female<span class="sc">:</span>ageYearsCentered <span class="sc">+</span> female<span class="sc">:</span><span class="fu">I</span>(ageYearsCentered<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> ageYearsCentered <span class="sc">|</span> id), <span class="co"># random intercepts and slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span id="cb74-313"><a href="#cb74-313" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-314"><a href="#cb74-314" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span id="cb74-315"><a href="#cb74-315" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb74-316"><a href="#cb74-316" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span>
<span id="cb74-317"><a href="#cb74-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-318"><a href="#cb74-318" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quadraticGCM)</span>
<span id="cb74-319"><a href="#cb74-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-320"><a href="#cb74-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-321"><a href="#cb74-321" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Protoypical Growth Curve</span></span>
<span id="cb74-322"><a href="#cb74-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-325"><a href="#cb74-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-326"><a href="#cb74-326" aria-hidden="true" tabindex="-1"></a>newData <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb74-327"><a href="#cb74-327" aria-hidden="true" tabindex="-1"></a>  <span class="at">female =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb74-328"><a href="#cb74-328" aria-hidden="true" tabindex="-1"></a>  <span class="at">ageYears =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(mydata<span class="sc">$</span>ageYears, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">to =</span> <span class="fu">max</span>(mydata<span class="sc">$</span>ageYears, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">length.out =</span> <span class="dv">10000</span>))</span>
<span id="cb74-329"><a href="#cb74-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-330"><a href="#cb74-330" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>ageYearsCentered <span class="ot">&lt;-</span> newData<span class="sc">$</span>ageYears <span class="sc">-</span> <span class="fu">min</span>(newData<span class="sc">$</span>ageYears)</span>
<span id="cb74-331"><a href="#cb74-331" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>ageYearsCenteredSquared <span class="ot">&lt;-</span> newData<span class="sc">$</span>ageYearsCentered <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb74-332"><a href="#cb74-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-333"><a href="#cb74-333" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb74-334"><a href="#cb74-334" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex[<span class="fu">which</span>(newData<span class="sc">$</span>female <span class="sc">==</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="st">"male"</span></span>
<span id="cb74-335"><a href="#cb74-335" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex[<span class="fu">which</span>(newData<span class="sc">$</span>female <span class="sc">==</span> <span class="dv">1</span>)] <span class="ot">&lt;-</span> <span class="st">"female"</span></span>
<span id="cb74-336"><a href="#cb74-336" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(newData<span class="sc">$</span>sex)</span>
<span id="cb74-337"><a href="#cb74-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-338"><a href="#cb74-338" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>predictedValue <span class="ot">&lt;-</span> <span class="fu">predict</span>( <span class="co"># predict.merMod</span></span>
<span id="cb74-339"><a href="#cb74-339" aria-hidden="true" tabindex="-1"></a>  quadraticGCM,</span>
<span id="cb74-340"><a href="#cb74-340" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> newData,</span>
<span id="cb74-341"><a href="#cb74-341" aria-hidden="true" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="cn">NA</span></span>
<span id="cb74-342"><a href="#cb74-342" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-343"><a href="#cb74-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-344"><a href="#cb74-344" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-345"><a href="#cb74-345" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> newData,</span>
<span id="cb74-346"><a href="#cb74-346" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-347"><a href="#cb74-347" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ageYears,</span>
<span id="cb74-348"><a href="#cb74-348" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> predictedValue,</span>
<span id="cb74-349"><a href="#cb74-349" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb74-350"><a href="#cb74-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-351"><a href="#cb74-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-352"><a href="#cb74-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb74-353"><a href="#cb74-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-354"><a href="#cb74-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-355"><a href="#cb74-355" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individuals' Growth Curves</span></span>
<span id="cb74-356"><a href="#cb74-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-359"><a href="#cb74-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-360"><a href="#cb74-360" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>predictedValue <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb74-361"><a href="#cb74-361" aria-hidden="true" tabindex="-1"></a>  quadraticGCM,</span>
<span id="cb74-362"><a href="#cb74-362" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> mydata,</span>
<span id="cb74-363"><a href="#cb74-363" aria-hidden="true" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="cn">NULL</span></span>
<span id="cb74-364"><a href="#cb74-364" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-365"><a href="#cb74-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-366"><a href="#cb74-366" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-367"><a href="#cb74-367" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-368"><a href="#cb74-368" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-369"><a href="#cb74-369" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ageYears,</span>
<span id="cb74-370"><a href="#cb74-370" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> predictedValue,</span>
<span id="cb74-371"><a href="#cb74-371" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb74-372"><a href="#cb74-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-373"><a href="#cb74-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-374"><a href="#cb74-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb74-375"><a href="#cb74-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-376"><a href="#cb74-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-377"><a href="#cb74-377" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individuals' Trajectories Overlaid with Prototypical Trajectory</span></span>
<span id="cb74-378"><a href="#cb74-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-381"><a href="#cb74-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-382"><a href="#cb74-382" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-383"><a href="#cb74-383" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-384"><a href="#cb74-384" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-385"><a href="#cb74-385" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ageYears,</span>
<span id="cb74-386"><a href="#cb74-386" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> predictedValue,</span>
<span id="cb74-387"><a href="#cb74-387" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb74-388"><a href="#cb74-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-389"><a href="#cb74-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-390"><a href="#cb74-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb74-391"><a href="#cb74-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb74-392"><a href="#cb74-392" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newData,</span>
<span id="cb74-393"><a href="#cb74-393" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-394"><a href="#cb74-394" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> ageYears,</span>
<span id="cb74-395"><a href="#cb74-395" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> predictedValue,</span>
<span id="cb74-396"><a href="#cb74-396" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> sex,</span>
<span id="cb74-397"><a href="#cb74-397" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> sex),</span>
<span id="cb74-398"><a href="#cb74-398" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">2</span>)</span>
<span id="cb74-399"><a href="#cb74-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-400"><a href="#cb74-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-401"><a href="#cb74-401" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract Random Effects</span></span>
<span id="cb74-402"><a href="#cb74-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-405"><a href="#cb74-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-406"><a href="#cb74-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb74-407"><a href="#cb74-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-408"><a href="#cb74-408" aria-hidden="true" tabindex="-1"></a><span class="fu">ranef</span>(quadraticGCM)</span>
<span id="cb74-409"><a href="#cb74-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-410"><a href="#cb74-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-413"><a href="#cb74-413" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-414"><a href="#cb74-414" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb74-415"><a href="#cb74-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-416"><a href="#cb74-416" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">ranef</span>(quadraticGCM))</span>
<span id="cb74-417"><a href="#cb74-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-418"><a href="#cb74-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-419"><a href="#cb74-419" aria-hidden="true" tabindex="-1"></a><span class="fu">### Spline Growth Curve Model {#splineGCM}</span></span>
<span id="cb74-420"><a href="#cb74-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-421"><a href="#cb74-421" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Create Knot</span></span>
<span id="cb74-422"><a href="#cb74-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-425"><a href="#cb74-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-426"><a href="#cb74-426" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>knot <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb74-427"><a href="#cb74-427" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>knot[<span class="fu">which</span>(mydata<span class="sc">$</span>ageYears <span class="sc">&lt;=</span> <span class="dv">11</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb74-428"><a href="#cb74-428" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>knot[<span class="fu">which</span>(mydata<span class="sc">$</span>ageYears <span class="sc">&gt;</span> <span class="dv">11</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb74-429"><a href="#cb74-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-430"><a href="#cb74-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-431"><a href="#cb74-431" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fit Model</span></span>
<span id="cb74-432"><a href="#cb74-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-435"><a href="#cb74-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-436"><a href="#cb74-436" aria-hidden="true" tabindex="-1"></a>splineGCM <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb74-437"><a href="#cb74-437" aria-hidden="true" tabindex="-1"></a>  math <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered <span class="sc">+</span> female<span class="sc">:</span>ageYearsCentered <span class="sc">+</span> knot <span class="sc">+</span> knot<span class="sc">:</span>ageYearsCentered <span class="sc">+</span> female<span class="sc">:</span>knot <span class="sc">+</span> female<span class="sc">:</span>knot<span class="sc">:</span>ageYearsCentered <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> ageYearsCentered <span class="sc">|</span> id), <span class="co"># random intercepts and linear slopes; fixed quadratic slopes; sex as a fixed-effect predictor of the intercepts and slopes</span></span>
<span id="cb74-438"><a href="#cb74-438" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-439"><a href="#cb74-439" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="co">#for ML</span></span>
<span id="cb74-440"><a href="#cb74-440" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude,</span>
<span id="cb74-441"><a href="#cb74-441" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span>
<span id="cb74-442"><a href="#cb74-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-443"><a href="#cb74-443" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(splineGCM)</span>
<span id="cb74-444"><a href="#cb74-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-445"><a href="#cb74-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-446"><a href="#cb74-446" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Protoypical Growth Curve</span></span>
<span id="cb74-447"><a href="#cb74-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-450"><a href="#cb74-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-451"><a href="#cb74-451" aria-hidden="true" tabindex="-1"></a>newData <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb74-452"><a href="#cb74-452" aria-hidden="true" tabindex="-1"></a>  <span class="at">female =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb74-453"><a href="#cb74-453" aria-hidden="true" tabindex="-1"></a>  <span class="at">ageYears =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(mydata<span class="sc">$</span>ageYears, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">to =</span> <span class="fu">max</span>(mydata<span class="sc">$</span>ageYears, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">length.out =</span> <span class="dv">10000</span>))</span>
<span id="cb74-454"><a href="#cb74-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-455"><a href="#cb74-455" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>ageYearsCentered <span class="ot">&lt;-</span> newData<span class="sc">$</span>ageYears <span class="sc">-</span> <span class="fu">min</span>(newData<span class="sc">$</span>ageYears)</span>
<span id="cb74-456"><a href="#cb74-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-457"><a href="#cb74-457" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>knot <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb74-458"><a href="#cb74-458" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>knot[<span class="fu">which</span>(newData<span class="sc">$</span>ageYears <span class="sc">&lt;=</span> <span class="dv">11</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb74-459"><a href="#cb74-459" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>knot[<span class="fu">which</span>(newData<span class="sc">$</span>ageYears <span class="sc">&gt;</span> <span class="dv">11</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb74-460"><a href="#cb74-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-461"><a href="#cb74-461" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb74-462"><a href="#cb74-462" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex[<span class="fu">which</span>(newData<span class="sc">$</span>female <span class="sc">==</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="st">"male"</span></span>
<span id="cb74-463"><a href="#cb74-463" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex[<span class="fu">which</span>(newData<span class="sc">$</span>female <span class="sc">==</span> <span class="dv">1</span>)] <span class="ot">&lt;-</span> <span class="st">"female"</span></span>
<span id="cb74-464"><a href="#cb74-464" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(newData<span class="sc">$</span>sex)</span>
<span id="cb74-465"><a href="#cb74-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-466"><a href="#cb74-466" aria-hidden="true" tabindex="-1"></a>newData<span class="sc">$</span>predictedValue <span class="ot">&lt;-</span> <span class="fu">predict</span>( <span class="co"># predict.merMod</span></span>
<span id="cb74-467"><a href="#cb74-467" aria-hidden="true" tabindex="-1"></a>  splineGCM,</span>
<span id="cb74-468"><a href="#cb74-468" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> newData,</span>
<span id="cb74-469"><a href="#cb74-469" aria-hidden="true" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="cn">NA</span></span>
<span id="cb74-470"><a href="#cb74-470" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-471"><a href="#cb74-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-472"><a href="#cb74-472" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-473"><a href="#cb74-473" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> newData,</span>
<span id="cb74-474"><a href="#cb74-474" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-475"><a href="#cb74-475" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ageYears,</span>
<span id="cb74-476"><a href="#cb74-476" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> predictedValue,</span>
<span id="cb74-477"><a href="#cb74-477" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb74-478"><a href="#cb74-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-479"><a href="#cb74-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-480"><a href="#cb74-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb74-481"><a href="#cb74-481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-482"><a href="#cb74-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-483"><a href="#cb74-483" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individuals' Growth Curves</span></span>
<span id="cb74-484"><a href="#cb74-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-487"><a href="#cb74-487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-488"><a href="#cb74-488" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>predictedValue <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb74-489"><a href="#cb74-489" aria-hidden="true" tabindex="-1"></a>  splineGCM,</span>
<span id="cb74-490"><a href="#cb74-490" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> mydata,</span>
<span id="cb74-491"><a href="#cb74-491" aria-hidden="true" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="cn">NULL</span></span>
<span id="cb74-492"><a href="#cb74-492" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-493"><a href="#cb74-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-494"><a href="#cb74-494" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-495"><a href="#cb74-495" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-496"><a href="#cb74-496" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-497"><a href="#cb74-497" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ageYears,</span>
<span id="cb74-498"><a href="#cb74-498" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> predictedValue,</span>
<span id="cb74-499"><a href="#cb74-499" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb74-500"><a href="#cb74-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-501"><a href="#cb74-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-502"><a href="#cb74-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb74-503"><a href="#cb74-503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-504"><a href="#cb74-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-505"><a href="#cb74-505" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individuals' Trajectories Overlaid with Prototypical Trajectory</span></span>
<span id="cb74-506"><a href="#cb74-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-509"><a href="#cb74-509" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-510"><a href="#cb74-510" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb74-511"><a href="#cb74-511" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-512"><a href="#cb74-512" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-513"><a href="#cb74-513" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ageYears,</span>
<span id="cb74-514"><a href="#cb74-514" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> predictedValue,</span>
<span id="cb74-515"><a href="#cb74-515" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">factor</span>(id))) <span class="sc">+</span></span>
<span id="cb74-516"><a href="#cb74-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb74-517"><a href="#cb74-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Math Score"</span>) <span class="sc">+</span></span>
<span id="cb74-518"><a href="#cb74-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb74-519"><a href="#cb74-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb74-520"><a href="#cb74-520" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newData,</span>
<span id="cb74-521"><a href="#cb74-521" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb74-522"><a href="#cb74-522" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> ageYears,</span>
<span id="cb74-523"><a href="#cb74-523" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> predictedValue,</span>
<span id="cb74-524"><a href="#cb74-524" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> sex,</span>
<span id="cb74-525"><a href="#cb74-525" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> sex),</span>
<span id="cb74-526"><a href="#cb74-526" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">2</span>)</span>
<span id="cb74-527"><a href="#cb74-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-528"><a href="#cb74-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-529"><a href="#cb74-529" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract Random Effects</span></span>
<span id="cb74-530"><a href="#cb74-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-533"><a href="#cb74-533" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-534"><a href="#cb74-534" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb74-535"><a href="#cb74-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-536"><a href="#cb74-536" aria-hidden="true" tabindex="-1"></a><span class="fu">ranef</span>(splineGCM)</span>
<span id="cb74-537"><a href="#cb74-537" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-538"><a href="#cb74-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-541"><a href="#cb74-541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-542"><a href="#cb74-542" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb74-543"><a href="#cb74-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-544"><a href="#cb74-544" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">ranef</span>(splineGCM))</span>
<span id="cb74-545"><a href="#cb74-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-546"><a href="#cb74-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-547"><a href="#cb74-547" aria-hidden="true" tabindex="-1"></a><span class="fu"># Generalized Linear Mixed Models {#generalized}</span></span>
<span id="cb74-548"><a href="#cb74-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-549"><a href="#cb74-549" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/9RFS-BCE7&gt;</span>; source code: <span class="ot">&lt;https://github.com/bbolker/mixedmodels-misc/blob/master/glmmFAQ.rmd&gt;</span>)</span>
<span id="cb74-550"><a href="#cb74-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-551"><a href="#cb74-551" aria-hidden="true" tabindex="-1"></a><span class="fu">## `lmer`</span></span>
<span id="cb74-552"><a href="#cb74-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-555"><a href="#cb74-555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-556"><a href="#cb74-556" aria-hidden="true" tabindex="-1"></a>generalizedLinearMixedModel <span class="ot">&lt;-</span> <span class="fu">glmer</span>(</span>
<span id="cb74-557"><a href="#cb74-557" aria-hidden="true" tabindex="-1"></a>  outcome <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered <span class="sc">+</span> (ageYearsCentered <span class="sc">|</span> id),</span>
<span id="cb74-558"><a href="#cb74-558" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb74-559"><a href="#cb74-559" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-560"><a href="#cb74-560" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb74-561"><a href="#cb74-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-562"><a href="#cb74-562" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(generalizedLinearMixedModel)</span>
<span id="cb74-563"><a href="#cb74-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-564"><a href="#cb74-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-565"><a href="#cb74-565" aria-hidden="true" tabindex="-1"></a><span class="fu">## `MASS`</span></span>
<span id="cb74-566"><a href="#cb74-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-569"><a href="#cb74-569" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-570"><a href="#cb74-570" aria-hidden="true" tabindex="-1"></a>glmmPQLmodel <span class="ot">&lt;-</span> <span class="fu">glmmPQL</span>(</span>
<span id="cb74-571"><a href="#cb74-571" aria-hidden="true" tabindex="-1"></a>  outcome <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered,</span>
<span id="cb74-572"><a href="#cb74-572" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> ageYearsCentered<span class="sc">|</span>id,</span>
<span id="cb74-573"><a href="#cb74-573" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb74-574"><a href="#cb74-574" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata)</span>
<span id="cb74-575"><a href="#cb74-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-576"><a href="#cb74-576" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glmmPQLmodel)</span>
<span id="cb74-577"><a href="#cb74-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-578"><a href="#cb74-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-579"><a href="#cb74-579" aria-hidden="true" tabindex="-1"></a><span class="fu">## `MCMCglmm`</span></span>
<span id="cb74-580"><a href="#cb74-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-583"><a href="#cb74-583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-584"><a href="#cb74-584" aria-hidden="true" tabindex="-1"></a>MCMCglmmModel <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(</span>
<span id="cb74-585"><a href="#cb74-585" aria-hidden="true" tabindex="-1"></a>  outcome <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered,</span>
<span id="cb74-586"><a href="#cb74-586" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> <span class="fu">us</span>(ageYearsCentered)<span class="sc">:</span>id,</span>
<span id="cb74-587"><a href="#cb74-587" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb74-588"><a href="#cb74-588" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">na.omit</span>(mydata[,<span class="fu">c</span>(<span class="st">"id"</span>,<span class="st">"outcome"</span>,<span class="st">"female"</span>,<span class="st">"ageYearsCentered"</span>)]))</span>
<span id="cb74-589"><a href="#cb74-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-590"><a href="#cb74-590" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(MCMCglmmModel)</span>
<span id="cb74-591"><a href="#cb74-591" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-592"><a href="#cb74-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-593"><a href="#cb74-593" aria-hidden="true" tabindex="-1"></a><span class="fu"># Nonlinear Mixed Models {#nonlinear}</span></span>
<span id="cb74-594"><a href="#cb74-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-597"><a href="#cb74-597" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-598"><a href="#cb74-598" aria-hidden="true" tabindex="-1"></a>nonlinearModel <span class="ot">&lt;-</span> <span class="fu">nlme</span>(</span>
<span id="cb74-599"><a href="#cb74-599" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> <span class="fu">SSasymp</span>(age, Asym, R0, lrc),</span>
<span id="cb74-600"><a href="#cb74-600" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Loblolly,</span>
<span id="cb74-601"><a href="#cb74-601" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed =</span> Asym <span class="sc">+</span> R0 <span class="sc">+</span> lrc <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb74-602"><a href="#cb74-602" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> Asym <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb74-603"><a href="#cb74-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-604"><a href="#cb74-604" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nonlinearModel)</span>
<span id="cb74-605"><a href="#cb74-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-606"><a href="#cb74-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-607"><a href="#cb74-607" aria-hidden="true" tabindex="-1"></a><span class="fu"># Robust Mixed Models</span></span>
<span id="cb74-608"><a href="#cb74-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-609"><a href="#cb74-609" aria-hidden="true" tabindex="-1"></a>To evaluate the extent to which a finding could driven by outliers, this could be done in a number of different ways, such as:</span>
<span id="cb74-610"><a href="#cb74-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-611"><a href="#cb74-611" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>identifying and excluding influential observations based on DFBETAS or Cook’s distance (Nieuwenhuis, Grotenhuis, &amp; Pelzer, 2012)</span>
<span id="cb74-612"><a href="#cb74-612" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>fitting mixed models using rank-based estimation (Bilgic &amp; Susmann, 2013; Finch, 2017) or robust estimating equations (Koller, 2016)</span>
<span id="cb74-613"><a href="#cb74-613" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>estimating robust standard errors using a sandwich estimator (Wang &amp; Merkle, 2018)</span>
<span id="cb74-614"><a href="#cb74-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-615"><a href="#cb74-615" aria-hidden="true" tabindex="-1"></a><span class="fu"># Assumptions</span></span>
<span id="cb74-616"><a href="#cb74-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-617"><a href="#cb74-617" aria-hidden="true" tabindex="-1"></a>The within-group errors:</span>
<span id="cb74-618"><a href="#cb74-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-619"><a href="#cb74-619" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>are independent</span>
<span id="cb74-620"><a href="#cb74-620" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>are identically normally distributed</span>
<span id="cb74-621"><a href="#cb74-621" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>have mean zero and variance sigma-squared</span>
<span id="cb74-622"><a href="#cb74-622" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>are independent of the random effects</span>
<span id="cb74-623"><a href="#cb74-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-624"><a href="#cb74-624" aria-hidden="true" tabindex="-1"></a>The random effects:</span>
<span id="cb74-625"><a href="#cb74-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-626"><a href="#cb74-626" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>are normally distributed</span>
<span id="cb74-627"><a href="#cb74-627" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>have mean zero and covariance matrix Psi (not depending on the group)</span>
<span id="cb74-628"><a href="#cb74-628" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>are independent for different groups</span>
<span id="cb74-629"><a href="#cb74-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-630"><a href="#cb74-630" aria-hidden="true" tabindex="-1"></a><span class="fu"># Examining Model Assumptions</span></span>
<span id="cb74-631"><a href="#cb74-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-632"><a href="#cb74-632" aria-hidden="true" tabindex="-1"></a><span class="fu">## Resources</span></span>
<span id="cb74-633"><a href="#cb74-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-634"><a href="#cb74-634" aria-hidden="true" tabindex="-1"></a>Pinheiro and Bates (2000) book (p. 174, section 4.3.1)</span>
<span id="cb74-635"><a href="#cb74-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-636"><a href="#cb74-636" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://stats.stackexchange.com/questions/77891/checking-assumptions-lmer-lme-mixed-models-in-r&gt;</span> (archived at <span class="ot">&lt;https://perma.cc/J5GC-PCUT&gt;</span>)</span>
<span id="cb74-637"><a href="#cb74-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-638"><a href="#cb74-638" aria-hidden="true" tabindex="-1"></a><span class="fu">## QQ Plots</span></span>
<span id="cb74-639"><a href="#cb74-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-640"><a href="#cb74-640" aria-hidden="true" tabindex="-1"></a>Make QQ plots for each level of the random effects.</span>
<span id="cb74-641"><a href="#cb74-641" aria-hidden="true" tabindex="-1"></a>Vary the level from 0, 1, to 2 so that you can check the between- and within-subject residuals.</span>
<span id="cb74-642"><a href="#cb74-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-645"><a href="#cb74-645" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-646"><a href="#cb74-646" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(linearMixedModel_nlme,</span>
<span id="cb74-647"><a href="#cb74-647" aria-hidden="true" tabindex="-1"></a>       <span class="sc">~</span> <span class="fu">ranef</span>(., <span class="at">level =</span> <span class="dv">1</span>))</span>
<span id="cb74-648"><a href="#cb74-648" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-649"><a href="#cb74-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-650"><a href="#cb74-650" aria-hidden="true" tabindex="-1"></a><span class="fu">## PP Plots</span></span>
<span id="cb74-651"><a href="#cb74-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-654"><a href="#cb74-654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-655"><a href="#cb74-655" aria-hidden="true" tabindex="-1"></a><span class="fu">ppPlot</span>(linearMixedModel)</span>
<span id="cb74-656"><a href="#cb74-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-657"><a href="#cb74-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-658"><a href="#cb74-658" aria-hidden="true" tabindex="-1"></a><span class="fu">## QQ Plot of residuals</span></span>
<span id="cb74-659"><a href="#cb74-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-662"><a href="#cb74-662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-663"><a href="#cb74-663" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(linearMixedModel))</span>
<span id="cb74-664"><a href="#cb74-664" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(linearMixedModel))</span>
<span id="cb74-665"><a href="#cb74-665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-666"><a href="#cb74-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-667"><a href="#cb74-667" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot residuals</span></span>
<span id="cb74-668"><a href="#cb74-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-671"><a href="#cb74-671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-672"><a href="#cb74-672" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(linearMixedModel)</span>
<span id="cb74-673"><a href="#cb74-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-674"><a href="#cb74-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-675"><a href="#cb74-675" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot residuals by group (in the example below, level 2 represents the individual)</span></span>
<span id="cb74-676"><a href="#cb74-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-679"><a href="#cb74-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-680"><a href="#cb74-680" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(linearMixedModel,</span>
<span id="cb74-681"><a href="#cb74-681" aria-hidden="true" tabindex="-1"></a>     <span class="fu">as.factor</span>(id) <span class="sc">~</span> <span class="fu">resid</span>(.),</span>
<span id="cb74-682"><a href="#cb74-682" aria-hidden="true" tabindex="-1"></a>     <span class="at">abline =</span> <span class="dv">0</span>,</span>
<span id="cb74-683"><a href="#cb74-683" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb74-684"><a href="#cb74-684" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-685"><a href="#cb74-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-686"><a href="#cb74-686" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot residuals by levels of a predictor</span></span>
<span id="cb74-687"><a href="#cb74-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-690"><a href="#cb74-690" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-691"><a href="#cb74-691" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(linearMixedModel_nlme,</span>
<span id="cb74-692"><a href="#cb74-692" aria-hidden="true" tabindex="-1"></a>     <span class="fu">resid</span>(., <span class="at">type =</span> <span class="st">"p"</span>) <span class="sc">~</span> <span class="fu">fitted</span>(.) <span class="sc">|</span> female) <span class="co">#type = "p" specifies standardized residuals</span></span>
<span id="cb74-693"><a href="#cb74-693" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-694"><a href="#cb74-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-695"><a href="#cb74-695" aria-hidden="true" tabindex="-1"></a><span class="fu">## Can model heteroscedasticity of the within-group error with the weights argument</span></span>
<span id="cb74-696"><a href="#cb74-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-699"><a href="#cb74-699" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-700"><a href="#cb74-700" aria-hidden="true" tabindex="-1"></a>linearMixedModel_nlmeVarStructure <span class="ot">&lt;-</span> <span class="fu">lme</span>(</span>
<span id="cb74-701"><a href="#cb74-701" aria-hidden="true" tabindex="-1"></a>  math <span class="sc">~</span> female <span class="sc">+</span> ageYearsCentered,</span>
<span id="cb74-702"><a href="#cb74-702" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> ageYearsCentered<span class="sc">|</span>id,</span>
<span id="cb74-703"><a href="#cb74-703" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> female),</span>
<span id="cb74-704"><a href="#cb74-704" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"ML"</span>,</span>
<span id="cb74-705"><a href="#cb74-705" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb74-706"><a href="#cb74-706" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb74-707"><a href="#cb74-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-708"><a href="#cb74-708" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linearMixedModel_nlmeVarStructure)</span>
<span id="cb74-709"><a href="#cb74-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-710"><a href="#cb74-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-711"><a href="#cb74-711" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot observed and fitted values</span></span>
<span id="cb74-712"><a href="#cb74-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-715"><a href="#cb74-715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-716"><a href="#cb74-716" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(linearMixedModel,</span>
<span id="cb74-717"><a href="#cb74-717" aria-hidden="true" tabindex="-1"></a>     math <span class="sc">~</span> <span class="fu">fitted</span>(.))</span>
<span id="cb74-718"><a href="#cb74-718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-719"><a href="#cb74-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-720"><a href="#cb74-720" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot QQ plot of residuals by levels of a predictor</span></span>
<span id="cb74-721"><a href="#cb74-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-724"><a href="#cb74-724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-725"><a href="#cb74-725" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(linearMixedModel_nlme, <span class="sc">~</span> <span class="fu">resid</span>(.) <span class="sc">|</span> female)</span>
<span id="cb74-726"><a href="#cb74-726" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(linearMixedModel_nlme, <span class="sc">~</span> <span class="fu">resid</span>(.))</span>
<span id="cb74-727"><a href="#cb74-727" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-728"><a href="#cb74-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-729"><a href="#cb74-729" aria-hidden="true" tabindex="-1"></a><span class="fu">## QQ plot of random effects</span></span>
<span id="cb74-730"><a href="#cb74-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-731"><a href="#cb74-731" aria-hidden="true" tabindex="-1"></a>Make QQ plots for each level of the random effects.</span>
<span id="cb74-732"><a href="#cb74-732" aria-hidden="true" tabindex="-1"></a>Vary the level from 0, 1, to 2 so that you can check the between- and within-subject residuals.</span>
<span id="cb74-733"><a href="#cb74-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-734"><a href="#cb74-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-737"><a href="#cb74-737" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-738"><a href="#cb74-738" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(linearMixedModel_nlme,</span>
<span id="cb74-739"><a href="#cb74-739" aria-hidden="true" tabindex="-1"></a>       <span class="sc">~</span> <span class="fu">ranef</span>(., <span class="at">level =</span> <span class="dv">0</span>))</span>
<span id="cb74-740"><a href="#cb74-740" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(linearMixedModel_nlme,</span>
<span id="cb74-741"><a href="#cb74-741" aria-hidden="true" tabindex="-1"></a>       <span class="sc">~</span> <span class="fu">ranef</span>(., <span class="at">level =</span> <span class="dv">1</span>))</span>
<span id="cb74-742"><a href="#cb74-742" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(linearMixedModel_nlme,</span>
<span id="cb74-743"><a href="#cb74-743" aria-hidden="true" tabindex="-1"></a>       <span class="sc">~</span> <span class="fu">ranef</span>(., <span class="at">level =</span> <span class="dv">2</span>))</span>
<span id="cb74-744"><a href="#cb74-744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-745"><a href="#cb74-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-746"><a href="#cb74-746" aria-hidden="true" tabindex="-1"></a><span class="fu">## QQ plot of random effects by levels of a predictor</span></span>
<span id="cb74-747"><a href="#cb74-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-750"><a href="#cb74-750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-751"><a href="#cb74-751" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(linearMixedModel_nlme, </span>
<span id="cb74-752"><a href="#cb74-752" aria-hidden="true" tabindex="-1"></a>       <span class="sc">~</span> <span class="fu">ranef</span>(., <span class="at">level =</span> <span class="dv">1</span>) <span class="sc">|</span> female)</span>
<span id="cb74-753"><a href="#cb74-753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-754"><a href="#cb74-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-755"><a href="#cb74-755" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pairs plot</span></span>
<span id="cb74-756"><a href="#cb74-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-759"><a href="#cb74-759" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-760"><a href="#cb74-760" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(linearMixedModel_nlme)</span>
<span id="cb74-761"><a href="#cb74-761" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(linearMixedModel_nlme,</span>
<span id="cb74-762"><a href="#cb74-762" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">ranef</span>(., <span class="at">level =</span> <span class="dv">1</span>) <span class="sc">|</span> female)</span>
<span id="cb74-763"><a href="#cb74-763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-764"><a href="#cb74-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-765"><a href="#cb74-765" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variance functions for modeling heteroscedasticity</span></span>
<span id="cb74-766"><a href="#cb74-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-767"><a href="#cb74-767" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`varFixed`</span>: fixed variance</span>
<span id="cb74-768"><a href="#cb74-768" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`varIdent`</span>: different variances per stratum</span>
<span id="cb74-769"><a href="#cb74-769" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`varPower`</span>: power of covariate</span>
<span id="cb74-770"><a href="#cb74-770" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`varExp`</span>: exponential of covariate</span>
<span id="cb74-771"><a href="#cb74-771" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`varConstPower`</span>: constant plus power of covariate</span>
<span id="cb74-772"><a href="#cb74-772" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`varComb`</span>: combination of variance functions</span>
<span id="cb74-773"><a href="#cb74-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-774"><a href="#cb74-774" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlation structures for modeling dependence</span></span>
<span id="cb74-775"><a href="#cb74-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-776"><a href="#cb74-776" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corCompSymm`</span>: compound symmetry</span>
<span id="cb74-777"><a href="#cb74-777" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corSymm`</span>: general</span>
<span id="cb74-778"><a href="#cb74-778" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corAR1`</span>: autoregressive of order 1</span>
<span id="cb74-779"><a href="#cb74-779" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corCAR1`</span>: continuous-time AR(1)</span>
<span id="cb74-780"><a href="#cb74-780" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corARMA`</span>: autoregressive-moving average</span>
<span id="cb74-781"><a href="#cb74-781" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corExp`</span>: exponential</span>
<span id="cb74-782"><a href="#cb74-782" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corGaus`</span>: Gaussian</span>
<span id="cb74-783"><a href="#cb74-783" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corLin`</span>: linear</span>
<span id="cb74-784"><a href="#cb74-784" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corRatio`</span>: rational quadratic</span>
<span id="cb74-785"><a href="#cb74-785" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`corSpher`</span>: spherical</span>
<span id="cb74-786"><a href="#cb74-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-787"><a href="#cb74-787" aria-hidden="true" tabindex="-1"></a><span class="fu"># Power Analysis {#powerAnalysis}</span></span>
<span id="cb74-788"><a href="#cb74-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-789"><a href="#cb74-789" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`mlmpower`</span>: <span class="ot">&lt;https://github.com/bkeller2/mlmpower&gt;</span> (<span class="co">[</span><span class="ot">Enders et al., 2025</span><span class="co">](https://doi.org/10.1037/met0000614)</span>)</span>
<span id="cb74-790"><a href="#cb74-790" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://aguinis.shinyapps.io/ml_power/&gt;</span></span>
<span id="cb74-791"><a href="#cb74-791" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://www.causalevaluation.org/power-analysis.html&gt;</span></span>
<span id="cb74-792"><a href="#cb74-792" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="ot">&lt;https://powerupr.shinyapps.io/index/&gt;</span></span>
<span id="cb74-793"><a href="#cb74-793" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://koumurayama.shinyapps.io/tmethod_mlm/&gt;</span></span>
<span id="cb74-794"><a href="#cb74-794" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="ot">&lt;https://webpower.psychstat.org/wiki/models/index&gt;</span></span>
<span id="cb74-795"><a href="#cb74-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-796"><a href="#cb74-796" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session Info</span></span>
<span id="cb74-797"><a href="#cb74-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-800"><a href="#cb74-800" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-801"><a href="#cb74-801" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb74-802"><a href="#cb74-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-803"><a href="#cb74-803" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb74-804"><a href="#cb74-804" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/DevPsyLab/DataAnalysis/edit/main/hlm.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/blob/main/hlm.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/DevPsyLab/DataAnalysis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>