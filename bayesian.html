<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.90      6.92    15.33    42.22 1.00     1730     2192
sd(Days)                6.57      1.51     4.18     9.98 1.00     1238     1993
cor(Intercept,Days)     0.08      0.31    -0.50     0.68 1.00      929     1621

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.01      7.48   236.42   265.69 1.00     1681     2381
Days         10.44      1.75     7.09    13.96 1.00     1289     1917

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.84      1.52    23.06    29.18 1.00     3291     3104

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.4801  12.99245 227.8836 278.8616
309 211.2726  13.51381 184.5217 237.5414
310 212.9899  13.09516 185.8208 237.9871
330 274.3431  13.46032 249.1095 302.0978
331 273.0616  13.30118 248.2321 300.1937
332 259.9084  12.30607 235.5984 284.6013
333 267.7897  12.64969 243.6267 292.7375
334 244.1173  12.36441 219.1948 267.5793
335 250.7654  13.29435 224.9281 278.2357
337 285.9603  13.18498 260.3405 313.1800
349 226.3987  13.05985 199.3931 251.1655
350 238.7251  13.21365 211.4140 264.5005
351 255.8958  11.95077 233.3204 279.8726
352 271.7913  12.24487 248.3379 296.5713
369 254.5843  12.39538 230.2724 279.3584
370 226.2072  13.40630 199.7152 251.7303
371 252.3680  12.32553 228.4689 276.5825
372 263.3167  12.03005 240.4160 287.0373

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6911417  2.507868 14.7708252 24.646897
309  1.8174929  2.515263 -3.1145139  6.789080
310  4.9502529  2.477689  0.1536499  9.904191
330  5.7811315  2.532005  0.6401815 10.654889
331  7.4232857  2.506581  2.3321261 12.184757
332 10.2740959  2.315217  5.6145486 14.617950
333 10.3351084  2.373603  5.6475559 15.035787
334 11.5470988  2.385077  7.0244320 16.246753
335 -0.1984667  2.532752 -5.2135187  4.712122
337 19.1774182  2.489209 14.1890139 24.015327
349 11.5998956  2.444221  6.8301089 16.554616
350 17.0639075  2.486765 12.1855967 22.042201
351  7.4586252  2.290666  2.9634175 11.797485
352 14.0782140  2.369322  9.4050858 18.706068
369 11.3650705  2.372247  6.6704412 15.993739
370 15.1936510  2.551718 10.2665619 20.367364
371  9.4806246  2.358557  4.7784457 14.107576
372 11.7792914  2.307045  7.2607061 16.288790</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.4801 12.992454 227.8836 278.8616
  [2,] 273.1712 11.051444 251.4202 294.3939
  [3,] 292.8624  9.383164 274.4294 311.1840
  [4,] 312.5535  8.156710 296.4582 328.2251
  [5,] 332.2447  7.589392 317.1394 347.0518
  [6,] 351.9358  7.825894 336.7442 367.2224
  [7,] 371.6270  8.801657 354.3330 388.7298
  [8,] 391.3181 10.308856 370.9530 411.6216
  [9,] 411.0092 12.151323 386.9115 434.6354
 [10,] 430.7004 14.199141 402.5710 458.4896
 [11,] 211.2726 13.513807 184.5217 237.5414
 [12,] 213.0901 11.609506 190.1224 235.3796
 [13,] 214.9076  9.979548 195.2850 234.2478
 [14,] 216.7251  8.778111 199.4601 233.9264
 [15,] 218.5426  8.195863 202.4844 234.4313
 [16,] 220.3601  8.363145 204.0935 236.5898
 [17,] 222.1776  9.239336 204.1136 240.1736
 [18,] 223.9951 10.650895 203.2561 244.9570
 [19,] 225.8126 12.416557 201.9621 250.2415
 [20,] 227.6301 14.406710 199.4295 255.7291
 [21,] 212.9899 13.095163 185.8208 237.9871
 [22,] 217.9401 11.205970 195.1059 239.0412
 [23,] 222.8904  9.588645 203.9432 241.1003
 [24,] 227.8406  8.401687 211.0741 244.3305
 [25,] 232.7909  7.842988 217.3360 248.6005
 [26,] 237.7411  8.044530 222.2957 253.7171
 [27,] 242.6914  8.955130 225.4272 260.1421
 [28,] 247.6416 10.390002 227.3992 267.8569
 [29,] 252.5919 12.165024 229.0613 276.3003
 [30,] 257.5421 14.152786 230.1075 284.9643
 [31,] 274.3431 13.460320 249.1095 302.0978
 [32,] 280.1243 11.535849 258.3327 303.9240
 [33,] 285.9054  9.889060 267.0842 305.9941
 [34,] 291.6865  8.679476 275.1197 309.0251
 [35,] 297.4677  8.105258 281.7991 313.4155
 [36,] 303.2488  8.299349 286.9965 319.6388
 [37,] 309.0299  9.213321 291.3608 326.9198
 [38,] 314.8111 10.663652 294.0904 335.4285
 [39,] 320.5922 12.464500 296.2819 344.5708
 [40,] 326.3733 14.485723 297.7452 354.6275
 [41,] 273.0616 13.301177 248.2321 300.1937
 [42,] 280.4849 11.431484 258.9903 303.8552
 [43,] 287.9082  9.848972 268.8109 307.9926
 [44,] 295.3315  8.711577 278.4066 312.7100
 [45,] 302.7548  8.206510 286.8198 318.9084
 [46,] 310.1781  8.447954 293.7021 326.6639
 [47,] 317.6013  9.378430 299.4429 336.3255
 [48,] 325.0246 10.821639 304.3230 346.7944
 [49,] 332.4479 12.602647 308.2297 357.9247
 [50,] 339.8712 14.598337 311.1451 369.4563
 [51,] 259.9084 12.306066 235.5984 284.6013
 [52,] 270.1825 10.601105 249.1452 291.2236
 [53,] 280.4565  9.167772 262.3878 298.5987
 [54,] 290.7306  8.150651 274.9776 306.9037
 [55,] 301.0047  7.716128 286.2788 316.5092
 [56,] 311.2788  7.960190 295.9459 327.0806
 [57,] 321.5529  8.826724 304.1641 338.9827
 [58,] 331.8270 10.157655 311.5945 351.9480
 [59,] 342.1011 11.796834 318.8743 365.0937
 [60,] 352.3752 13.633529 325.4990 378.7299
 [61,] 267.7897 12.649687 243.6267 292.7375
 [62,] 278.1249 10.922487 257.3068 299.6017
 [63,] 288.4600  9.479180 270.0460 306.8765
 [64,] 298.7951  8.466226 282.3117 315.1298
 [65,] 309.1302  8.047799 293.3170 324.5325
 [66,] 319.4653  8.314154 303.1166 335.5708
 [67,] 329.8004  9.206043 311.7856 347.8507
 [68,] 340.1355 10.566233 319.7431 361.1136
 [69,] 350.4706 12.239580 326.8872 374.8580
 [70,] 360.8057 14.115145 333.4554 388.8247
 [71,] 244.1173 12.364408 219.1948 267.5793
 [72,] 255.6644 10.586333 234.5771 275.8582
 [73,] 267.2115  9.090627 249.1992 284.6963
 [74,] 278.7586  8.036524 262.9571 294.4809
 [75,] 290.3057  7.609805 275.6405 305.3642
 [76,] 301.8528  7.912630 286.6811 317.3987
 [77,] 313.3999  8.870596 296.3401 331.2369
 [78,] 324.9470 10.302544 304.9829 345.5592
 [79,] 336.4941 12.040537 313.2667 359.8202
 [80,] 348.0412 13.970821 321.1371 374.9040
 [81,] 250.7654 13.294354 224.9281 278.2357
 [82,] 250.5669 11.388677 228.1344 274.1198
 [83,] 250.3684  9.772089 231.5541 270.1857
 [84,] 250.1700  8.609016 233.3664 267.1749
 [85,] 249.9715  8.097299 234.2821 266.1920
 [86,] 249.7730  8.357453 233.5889 266.2117
 [87,] 249.5746  9.325097 231.7991 267.9183
 [88,] 249.3761 10.811916 228.4694 270.4309
 [89,] 249.1776 12.635953 224.5232 273.6223
 [90,] 248.9792 14.671971 220.5243 277.1377
 [91,] 285.9603 13.184981 260.3405 313.1800
 [92,] 305.1377 11.303235 283.3814 328.8578
 [93,] 324.3151  9.699219 305.6556 343.9993
 [94,] 343.4925  8.531055 327.2382 360.6581
 [95,] 362.6699  7.992200 347.4861 379.0494
 [96,] 381.8473  8.207555 366.5293 397.9892
 [97,] 401.0248  9.123868 384.0325 419.3262
 [98,] 420.2022 10.560223 399.9644 441.0303
 [99,] 439.3796 12.336287 415.8197 464.0380
[100,] 458.5570 14.326268 430.9518 487.1113
[101,] 226.3987 13.059851 199.3931 251.1655
[102,] 237.9986 11.217091 215.0266 259.4069
[103,] 249.5985  9.645464 229.8816 267.8266
[104,] 261.1984  8.496780 243.9553 277.4281
[105,] 272.7983  7.956380 257.1922 288.3085
[106,] 284.3982  8.146235 268.4560 300.3655
[107,] 295.9981  9.020351 277.9918 313.7536
[108,] 307.5979 10.407726 286.9799 328.4398
[109,] 319.1978 12.133558 295.6393 343.7329
[110,] 330.7977 14.073881 303.6702 359.6278
[111,] 238.7251 13.213649 211.4140 264.5005
[112,] 255.7890 11.299570 233.0981 277.9541
[113,] 272.8529  9.650287 253.4201 291.4538
[114,] 289.9168  8.422814 273.0802 306.1529
[115,] 306.9807  7.818412 291.4305 322.2727
[116,] 324.0446  7.979933 308.5774 339.6925
[117,] 341.1085  8.865614 324.2442 358.3992
[118,] 358.1725 10.290135 338.4839 378.2570
[119,] 375.2364 12.064106 352.1072 398.8276
[120,] 392.3003 14.055833 365.3015 419.9956
[121,] 255.8958 11.950768 233.3204 279.8726
[122,] 263.3544 10.334074 243.7206 283.8859
[123,] 270.8130  9.014412 253.4278 288.4809
[124,] 278.2717  8.137596 262.1938 294.2140
[125,] 285.7303  7.853383 270.1026 301.1250
[126,] 293.1889  8.223447 276.6826 309.1524
[127,] 300.6475  9.168906 282.3325 318.4527
[128,] 308.1062 10.535981 287.2362 328.6184
[129,] 315.5648 12.183565 291.5645 339.0878
[130,] 323.0234 14.013063 295.4764 350.1565
[131,] 271.7913 12.244870 248.3379 296.5713
[132,] 285.8696 10.544219 265.2409 307.0468
[133,] 299.9478  9.146127 281.5540 318.0832
[134,] 314.0260  8.206710 297.3840 330.3171
[135,] 328.1042  7.891509 312.3320 343.8993
[136,] 342.1824  8.272188 326.0266 359.1154
[137,] 356.2606  9.263351 338.2708 374.6323
[138,] 370.3388 10.696616 349.8310 391.5849
[139,] 384.4171 12.419859 361.0343 409.1445
[140,] 398.4953 14.328837 371.5772 426.7603
[141,] 254.5843 12.395376 230.2724 279.3584
[142,] 265.9494 10.666093 245.4409 287.3809
[143,] 277.3145  9.227179 259.3242 295.6096
[144,] 288.6796  8.232330 272.5422 304.7326
[145,] 300.0446  7.852183 285.0847 315.2511
[146,] 311.4097  8.172968 295.4941 327.3657
[147,] 322.7748  9.121029 304.9554 340.8974
[148,] 334.1398 10.528249 313.5851 354.9344
[149,] 345.5049 12.237238 321.8000 369.7416
[150,] 356.8700 14.138991 329.2367 384.8335
[151,] 226.2072 13.406302 199.7152 251.7303
[152,] 241.4008 11.423951 218.7156 263.4517
[153,] 256.5945  9.711174 237.5200 275.8155
[154,] 271.7881  8.433842 255.5153 288.5681
[155,] 286.9818  7.808649 272.1271 302.4502
[156,] 302.1754  7.990172 286.7772 317.8095
[157,] 317.3691  8.929346 299.8760 335.0205
[158,] 332.5627 10.423345 312.0151 352.7934
[159,] 347.7564 12.271168 323.7905 372.1044
[160,] 362.9500 14.336650 334.8837 391.2995
[161,] 252.3680 12.325526 228.4689 276.5825
[162,] 261.8487 10.609413 241.0697 282.4561
[163,] 271.3293  9.182935 253.0577 288.9164
[164,] 280.8099  8.198689 264.2697 296.7745
[165,] 290.2905  7.825363 274.5502 305.4942
[166,] 299.7712  8.147373 283.5136 316.2835
[167,] 309.2518  9.091130 291.2167 327.4201
[168,] 318.7324 10.490147 298.4441 339.6117
[169,] 328.2130 12.188654 304.4785 352.0542
[170,] 337.6937 14.078671 310.5005 365.3403
[171,] 263.3167 12.030045 240.4160 287.0373
[172,] 275.0960 10.353088 255.5963 295.3798
[173,] 286.8753  8.960791 269.9760 304.1159
[174,] 298.6546  8.003128 283.0947 314.1127
[175,] 310.4339  7.645210 295.4451 324.8217
[176,] 322.2132  7.968270 306.3820 337.4994
[177,] 333.9925  8.898445 316.4077 351.5127
[178,] 345.7718 10.272110 325.7340 365.9788
[179,] 357.5511 11.937129 334.6176 381.4806
[180,] 369.3304 13.788357 342.7998 397.0168</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -3.9201070 12.992454  -29.3016459  21.6763559
  [2,]  -14.4665487 11.051444  -35.6891713   7.2844962
  [3,]  -42.0617905  9.383164  -60.3834228 -23.6287778
  [4,]    8.8862678  8.156710   -6.7852634  24.9816123
  [5,]   24.6072261  7.589392    9.8000878  39.7125195
  [6,]   62.7542844  7.825894   47.4677248  77.9459114
  [7,]   10.5768426  8.801657   -6.5259713  27.8707723
  [8,] -101.1694991 10.308856 -121.4729664 -80.8044332
  [9,]   19.5760592 12.151323   -4.0500739  43.6737662
 [10,]   35.6531174 14.199141    7.8639062  63.7824825
 [11,]   11.4612679 13.513807  -14.8074859  38.2122216
 [12,]   -7.8243249 11.609506  -30.1137959  15.1433765
 [13,]  -11.9298178  9.979548  -31.2700023   7.6928354
 [14,]  -12.0181107  8.778111  -29.2193896   5.2469113
 [15,]  -10.8265035  8.195863  -26.7152207   5.2317373
 [16,]   -4.3982964  8.363145  -20.6280004  11.8683097
 [17,]   -8.5472892  9.239336  -26.5433143   9.5166793
 [18,]   -6.2678821 10.650895  -27.2298322  14.4710723
 [19,]   -1.5168750 12.416557  -25.9458268  22.3335821
 [20,]    9.6841322 14.406710  -18.4148829  37.8847216
 [21,]  -13.9359619 13.095163  -38.9331584  13.2331417
 [22,]  -23.6079148 11.205970  -44.7089741  -0.7736581
 [23,]   11.4296322  9.588645   -6.7803194  30.3768158
 [24,]    5.0009793  8.401687  -11.4889171  21.7674680
 [25,]   -3.4834736  7.842988  -19.2930500  11.9713676
 [26,]  -17.2832266  8.044530  -33.2592020  -1.8377612
 [27,]   -7.2705795  8.955130  -24.7213183   9.9936386
 [28,]    8.1094675 10.390002  -12.1058300  28.3519148
 [29,]    8.4206146 12.165024  -15.2877853  31.9511643
 [30,]  -10.0268384 14.152786  -37.4490086  17.4078062
 [31,]   47.1994627 13.460320   19.4447939  72.4331071
 [32,]   20.2759313 11.535849   -3.5238148  42.0675307
 [33,]   -2.0489002  9.889060  -22.1375779  16.7723473
 [34,]   -6.5535317  8.679476  -23.8921138  10.0133266
 [35,]  -11.6703631  8.105258  -27.6181580   3.9982352
 [36,]   -5.6632946  8.299349  -22.0532620  10.5889856
 [37,]  -28.7903260  9.213321  -46.6801550 -11.1212380
 [38,]    3.4502425 10.663652  -17.1671723  24.1708768
 [39,]  -15.2426889 12.464500  -39.2212813   9.0675555
 [40,]   27.6753796 14.485723   -0.5788376  56.3034989
 [41,]   14.5462666 13.301177  -12.5858125  39.3757805
 [42,]    4.5150809 11.431484  -18.8551543  26.0096582
 [43,]   13.9123951  9.848972   -6.1720323  33.0096663
 [44,]   24.7838094  8.711577    7.4052743  41.7086922
 [45,]   13.5225236  8.206510   -2.6310694  29.4574943
 [46,]  -16.8593621  8.447954  -33.3452297  -0.3834290
 [47,]  -27.5263479  9.378430  -46.2505112  -9.3678805
 [48,]    9.7930664 10.821639  -11.9767368  30.4947145
 [49,]  -38.7010194 12.602647  -64.1777830 -14.4828063
 [50,]   31.7098949 14.598337    2.1247650  60.4360224
 [51,]  -25.0477572 12.306066  -49.7406551  -0.7378227
 [52,]  -27.3706531 10.601105  -48.4117588  -6.3334295
 [53,]   -7.4952490  9.167772  -25.6373878  10.5734798
 [54,]   19.0381550  8.150651    2.8651411  34.7912349
 [55,]   16.4581591  7.716128    0.9537272  31.1840555
 [56,]   -1.2812369  7.960190  -17.0830363  14.0517339
 [57,]  132.6089672  8.826724  115.1791953 149.9978076
 [58,]   15.0040712 10.157655   -5.1169114  35.2366035
 [59,]  -11.8008247 11.796834  -34.7934026  11.4260038
 [60,]  -98.5108206 13.633529 -124.8655414 -71.6346367
 [61,]   16.0526564 12.649687   -8.8951175  40.2156856
 [62,]   11.4301480 10.922487  -10.0467205  32.2482046
 [63,]  -11.6906605  9.479180  -30.1071966   6.7232647
 [64,]    1.0146311  8.466226  -15.3200756  17.4979608
 [65,]  -11.9591773  8.047799  -27.3614761   3.8540089
 [66,]   18.7012143  8.314154    2.5956716  35.0498736
 [67,]    2.2261059  9.206043  -15.8241643  20.2409353
 [68,]    8.7043974 10.566233  -12.2737069  29.0968071
 [69,]  -17.1106110 12.239580  -41.4979572   6.4728125
 [70,]    1.2370806 14.115145  -26.7818764  28.5873850
 [71,]   21.3557580 12.364408   -2.1062451  46.2783287
 [72,]   20.5367592 10.586333    0.3429505  41.6241247
 [73,]  -23.8468396  9.090627  -41.3315766  -5.8344763
 [74,]  -24.0863384  8.036524  -39.8085641  -8.2848179
 [75,]  -11.2813372  7.609805  -26.3398141   3.3839451
 [76,]  -17.6616360  7.912630  -33.2074766  -2.4899182
 [77,]   -7.8751348  8.870596  -25.7120782   9.1846578
 [78,]    6.5758664 10.302544  -14.0363308  26.5399661
 [79,]   -0.7472324 12.040537  -24.0732673  22.4802481
 [80,]   29.2577688 13.970821    2.3950118  56.1618642
 [81,]   -9.1570650 13.294354  -36.6274391  16.6802494
 [82,]   23.3803017 11.388677   -0.1725509  45.8128424
 [83,]    4.1222684  9.772089  -15.6950037  22.9365879
 [84,]   20.6321350  8.609016    3.6272477  37.4357384
 [85,]    1.4804017  8.097299  -14.7400695  17.1697721
 [86,]    4.8631684  8.357453  -11.5755041  21.0473398
 [87,]   -4.1222649  9.325097  -22.4660309  13.6531933
 [88,]  -14.0650982 10.811916  -35.1198687   6.8415694
 [89,]  -13.4235315 12.635953  -37.8681927  11.2308804
 [90,]  -11.7325648 14.671971  -39.8911370  16.7222753
 [91,]   26.4063434 13.184981   -0.8134371  52.0261063
 [92,]    8.6681252 11.303235  -15.0519858  30.4243703
 [93,]  -32.7038930  9.699219  -52.3880727 -14.0444391
 [94,]    2.6296888  8.531055  -14.5359323  18.8839991
 [95,]    3.0624705  7.992200  -13.3170065  18.2462981
 [96,]    9.9911523  8.207555   -6.1506582  25.3091844
 [97,]    3.2353341  9.123868  -15.0660972  20.2276201
 [98,]   -3.5098841 10.560223  -24.3380230  16.7278645
 [99,]   16.4846977 12.336287   -8.1737063  40.0446128
[100,]    0.3596795 14.326268  -28.1945783  27.9648595
[101,]    9.7045216 13.059851  -15.0623342  36.7101352
[102,]   -7.6818740 11.217091  -29.0902087  15.2900621
[103,]  -10.6728696  9.645464  -28.9009587   9.0440238
[104,]   -6.2763652  8.496780  -22.5060999  10.9667138
[105,]  -22.0879609  7.956380  -37.5982129  -6.4819399
[106,]  -14.6237565  8.146235  -30.5910762   1.3184365
[107,]  -14.4332521  9.020351  -32.1887683   3.5730448
[108,]    0.5040523 10.407726  -20.3378418  21.1221261
[109,]   17.0827566 12.133558   -7.4523476  40.6412578
[110,]   20.8473610 14.073881   -7.9826758  47.9748953
[111,]   17.5716988 13.213649   -8.2036783  44.8827842
[112,]  -12.3347087 11.299570  -34.4997568  10.3561660
[113,]  -16.6483161  9.650287  -35.2491848   2.7844820
[114,]  -34.3897236  8.422814  -50.6258162 -17.5531237
[115,]  -38.0642311  7.818412  -53.3562257 -22.5139653
[116,]    5.6800615  7.979933   -9.9677836  21.1473229
[117,]   38.3359540  8.865614   21.0453017  55.2002565
[118,]    4.7459465 10.290135  -15.3385549  24.4344727
[119,]   19.2508391 12.064106   -4.3403809  42.3799663
[120,]   -3.2475684 14.055833  -30.9429270  23.7511559
[121,]   -5.3692886 11.950768  -29.3461453  17.2061238
[122,]   36.7031862 10.334074   16.1717036  56.3369664
[123,]   -0.9191391  9.014412  -18.5870166  16.4660955
[124,]    2.3174357  8.137596  -13.6248801  18.3953493
[125,]  -13.9028895  7.853383  -29.2976328   1.7248092
[126,]   11.4446853  8.223447   -4.5187998  27.9509970
[127,]  -12.9009400  9.168906  -30.7061250   5.4141375
[128,]  -41.5106652 10.535981  -62.0228950 -20.6407076
[129,]    5.9770096 12.183565  -17.5459977  29.9772588
[130,]   24.5420844 14.013063   -2.5909641  52.0890641
[131,]  -50.1142429 12.244870  -74.8941557 -26.6608142
[132,]   12.3243431 10.544219   -8.8528899  32.9529996
[133,]   26.9307291  9.146127    8.7952940  45.3245289
[134,]   32.8295151  8.206710   16.5384300  49.4715335
[135,]   20.6360011  7.891509    4.8408652  36.4081911
[136,]   10.6462872  8.272188   -6.2866989  26.8021029
[137,]   -1.8340268  9.263351  -20.2057279  16.1558168
[138,]   -9.9062408 10.696616  -31.1523135  10.6015592
[139,]   -8.7764548 12.419859  -33.5038688  14.6062903
[140,]   -9.9535688 14.328837  -38.2185703  16.9645488
[141,]   17.3391572 12.395376   -7.4348745  41.6511225
[142,]    2.4874867 10.666093  -18.9440327  22.9959737
[143,]  -20.0720838  9.227179  -38.3672451  -2.0818374
[144,]  -11.0229543  8.232330  -27.0760471   5.1144208
[145,]   14.7775753  7.852183   -0.4289441  29.7374784
[146,]    5.8038048  8.172968  -10.1521704  21.7193892
[147,]  -24.6394657  9.121029  -42.7621200  -6.8200880
[148,]   13.9830638 10.528249   -6.8115044  34.5377863
[149,]   -5.2249067 12.237238  -29.4615853  18.4799616
[150,]    9.6431228 14.138991  -18.3204259  37.2764326
[151,]   -0.9431749 13.406302  -26.4662556  25.5487583
[152,]   -6.8773259 11.423951  -28.9281972  15.8078706
[153,]  -17.6936769  9.711174  -36.9147134   1.3808147
[154,]  -31.3151278  8.433842  -48.0951430 -15.0422541
[155,]  -19.4444788  7.808649  -34.9128541  -4.5898259
[156,]   42.0182702  7.990172   26.3841646  57.4165028
[157,]  -36.2209808  8.929346  -53.8723661 -18.7279098
[158,]   15.0227682 10.423345   -5.2079405  35.5703936
[159,]   17.4066172 12.271168   -6.9414050  41.3725204
[160,]    9.2787662 14.336650  -19.0706860  37.3450875
[161,]   17.5123695 12.325526   -6.7020938  41.4114645
[162,]   10.5941450 10.609413  -10.0132895  31.3731439
[163,]    6.5696204  9.182935  -11.0175475  24.8411620
[164,]    0.9795958  8.198689  -14.9849603  17.5197936
[165,]  -11.1200287  7.825363  -26.3236785   4.6202884
[166,]  -15.2591533  8.147373  -31.7715153   0.9983581
[167,]  -49.9859779  9.091130  -68.1542711 -31.9509305
[168,]  -14.1018024 10.490147  -34.9810741   6.1865165
[169,]   22.5676730 12.188654   -1.2734913  46.3022316
[170,]   31.7755485 14.078671    4.1288565  58.9686807
[171,]    6.0949597 12.030045  -17.6256324  28.9957211
[172,]   -1.6220317 10.353088  -21.9058100  17.8776916
[173,]   10.7214768  8.960791   -6.5190694  27.6207837
[174,]   11.9769854  8.003128   -3.4810963  27.5369296
[175,]  -23.2613060  7.645210  -37.6491412  -8.2725235
[176,]    7.3944026  7.968270   -7.8918358  23.2255516
[177,]    0.4893111  8.898445  -17.0308552  18.0740896
[178,]   -2.5518803 10.272110  -22.7588746  17.4858749
[179,]   11.5906283 11.937129  -12.3388760  34.5240826
[180,]   -5.2067631 13.788357  -32.8931648  21.3238470</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.3
looic      1769.6 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   603       
 (0.5, 0.7]   (ok)         1    0.6%   107       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.5 22.1
p_loo        33.3  8.1
looic      1721.0 44.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   908       
 (0.5, 0.7]   (ok)         5    2.8%   323       
   (0.7, 1]   (bad)        2    1.1%   56        
   (1, Inf)   (very bad)   1    0.6%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.5  
fit_sleep1 -92.8      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.3
looic      1769.6 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   603       
 (0.5, 0.7]   (ok)         1    0.6%   107       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.5 22.1
p_loo        33.3  8.1
looic      1721.0 44.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   908       
 (0.5, 0.7]   (ok)         5    2.8%   323       
   (0.7, 1]   (bad)        2    1.1%   56        
   (1, Inf)   (very bad)   1    0.6%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.5     22.1        33.3    8.1   1721.0
fit_sleep2  -24.3      11.5  -884.8     14.4        19.3    3.3   1769.6
fit_sleep1  -92.8      20.8  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.2  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
5.029246e-41 2.821438e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.94      1.59     0.37     5.52       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.06      1.59    -3.18     3.07       5.74      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.19      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.6.0   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.19        V8_4.2.2            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.7         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
