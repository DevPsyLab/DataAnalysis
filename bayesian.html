<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.91      6.84    15.70    42.30 1.00     1831     2431
sd(Days)                6.61      1.50     4.22    10.13 1.00     1393     1890
cor(Intercept,Days)     0.08      0.30    -0.49     0.65 1.00     1013     1735

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.39      7.43   236.84   265.97 1.00     1716     2292
Days         10.33      1.73     6.91    13.64 1.00     1297     1922

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.51    23.26    29.13 1.00     4212     2530

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7745  13.05288 226.9871 278.3556
309 211.4498  13.52853 184.4198 237.4866
310 213.3392  13.13724 187.5952 239.1043
330 274.7063  13.59317 249.5889 301.7071
331 273.1868  13.44096 248.5073 299.9192
332 260.1885  12.18479 236.2414 284.6468
333 268.0775  12.85548 243.1284 293.3071
334 244.3273  12.49552 218.9487 268.4973
335 251.1052  13.25030 225.4833 276.8966
337 285.6715  13.03905 260.3796 312.4272
349 226.3039  13.10282 200.0544 251.0828
350 238.8096  13.37034 211.5092 264.3473
351 255.8868  12.61214 231.6412 281.2445
352 271.9369  12.70183 246.8288 296.9129
369 254.7412  12.32244 230.1867 278.3543
370 226.3243  13.34895 199.1821 251.7024
371 252.3388  12.55346 228.5209 277.5566
372 263.7817  12.10706 240.0925 288.1790

, , Days

     Estimate Est.Error        Q2.5     Q97.5
308 19.657772  2.519405 14.79627881 24.665050
309  1.721290  2.555472 -3.36029846  6.655585
310  4.895731  2.454067  0.03014082  9.754147
330  5.667752  2.572354  0.62827819 10.448520
331  7.471752  2.510543  2.37908518 12.184605
332 10.218230  2.410434  5.37528496 14.867155
333 10.301388  2.478113  5.30078793 14.920916
334 11.512987  2.414677  6.84311561 16.442393
335 -0.293659  2.527579 -5.33581911  4.593052
337 19.180793  2.431399 14.38290132 23.938456
349 11.615138  2.473246  6.75636576 16.554175
350 16.986224  2.568861 11.98070175 22.223587
351  7.486374  2.411972  2.67369770 12.109500
352 14.060183  2.408191  9.24332154 18.750982
369 11.275201  2.333644  6.68952794 15.809228
370 15.170390  2.536097 10.36605289 20.121828
371  9.468088  2.424295  4.76038139 14.297407
372 11.765251  2.336741  6.97787024 16.131527</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7745 13.052876 226.9871 278.3556
  [2,] 273.4323 11.139484 250.6021 294.6049
  [3,] 293.0901  9.512803 273.7744 311.4835
  [4,] 312.7479  8.342274 296.0683 329.2179
  [5,] 332.4056  7.835079 316.9294 347.6128
  [6,] 352.0634  8.116539 336.0890 368.1260
  [7,] 371.7212  9.113877 354.0232 389.8275
  [8,] 391.3789 10.627422 370.5354 412.6479
  [9,] 411.0367 12.470615 386.5974 435.9583
 [10,] 430.6945 14.518443 401.9066 459.6020
 [11,] 211.4498 13.528531 184.4198 237.4866
 [12,] 213.1711 11.558927 189.8343 235.2888
 [13,] 214.8924  9.861912 194.9748 233.8790
 [14,] 216.6137  8.600389 199.6075 233.2834
 [15,] 218.3350  7.983541 202.9845 234.0325
 [16,] 220.0563  8.158925 204.2279 236.0867
 [17,] 221.7776  9.080751 204.1023 239.9768
 [18,] 223.4989 10.555231 202.7446 244.5349
 [19,] 225.2201 12.386550 200.6223 249.6485
 [20,] 226.9414 14.439572 198.2077 255.3324
 [21,] 213.3392 13.137244 187.5952 239.1043
 [22,] 218.2349 11.279413 196.0282 240.4297
 [23,] 223.1307  9.690614 204.0450 242.0001
 [24,] 228.0264  8.522660 211.3273 244.5659
 [25,] 232.9221  7.962937 217.5155 248.5108
 [26,] 237.8179  8.137929 222.3811 253.8667
 [27,] 242.7136  9.004903 225.3972 260.8118
 [28,] 247.6093 10.392092 227.6482 268.2974
 [29,] 252.5051 12.122200 229.5201 276.6458
 [30,] 257.4008 14.069286 230.5199 285.4624
 [31,] 274.7063 13.593170 249.5889 301.7071
 [32,] 280.3741 11.608416 258.7991 303.5150
 [33,] 286.0418  9.898000 267.5112 305.4570
 [34,] 291.7096  8.626673 275.2179 308.7116
 [35,] 297.3773  8.006409 281.7636 313.3448
 [36,] 303.0451  8.186555 287.3498 319.1508
 [37,] 308.7128  9.119803 290.6235 326.8752
 [38,] 314.3806 10.609238 293.8496 335.7361
 [39,] 320.0483 12.456928 296.0048 344.9279
 [40,] 325.7161 14.526810 297.4169 354.5280
 [41,] 273.1868 13.440960 248.5073 299.9192
 [42,] 280.6586 11.552250 259.2292 303.3335
 [43,] 288.1303  9.942596 269.5698 307.7711
 [44,] 295.6021  8.767074 278.9920 312.7137
 [45,] 303.0738  8.214233 287.2074 319.1453
 [46,] 310.5456  8.407813 294.2282 327.2283
 [47,] 318.0173  9.301326 300.3871 336.8222
 [48,] 325.4891 10.721178 305.3403 346.9600
 [49,] 332.9608 12.489127 309.2064 358.2176
 [50,] 340.4326 14.478211 312.6582 369.6908
 [51,] 260.1885 12.184787 236.2414 284.6468
 [52,] 270.4067 10.428282 250.0632 291.2525
 [53,] 280.6249  8.980506 263.3439 298.5489
 [54,] 290.8432  8.010637 275.2239 306.7448
 [55,] 301.0614  7.701396 286.2187 316.1847
 [56,] 311.2796  8.128536 295.6235 327.6705
 [57,] 321.4979  9.189944 303.8985 340.2573
 [58,] 331.7161 10.698478 311.3273 353.2271
 [59,] 341.9343 12.493205 317.7158 366.7306
 [60,] 352.1526 14.468010 323.6858 380.6352
 [61,] 268.0775 12.855476 243.1284 293.3071
 [62,] 278.3789 11.026772 257.2524 299.9757
 [63,] 288.6803  9.497276 270.1549 307.4583
 [64,] 298.9817  8.431422 282.1326 315.4820
 [65,] 309.2831  8.016333 292.8697 324.8439
 [66,] 319.5845  8.349635 302.6968 335.3976
 [67,] 329.8858  9.351648 311.3239 347.7213
 [68,] 340.1872 10.838464 318.9183 360.7512
 [69,] 350.4886 12.640150 325.7481 374.4640
 [70,] 360.7900 14.640921 332.0619 388.6508
 [71,] 244.3273 12.495518 218.9487 268.4973
 [72,] 255.8403 10.693971 234.1126 276.7879
 [73,] 267.3533  9.178529 248.9940 285.4049
 [74,] 278.8663  8.111171 263.0791 294.9555
 [75,] 290.3793  7.681023 275.7031 305.1971
 [76,] 301.8923  7.991650 286.5817 317.5932
 [77,] 313.4053  8.966390 296.1608 330.7503
 [78,] 324.9183 10.420517 304.5584 345.0863
 [79,] 336.4312 12.183575 312.5608 360.2381
 [80,] 347.9442 14.140480 320.2405 375.7298
 [81,] 251.1052 13.250297 225.4833 276.8966
 [82,] 250.8115 11.296912 228.7089 272.7474
 [83,] 250.5179  9.614957 231.6687 269.3579
 [84,] 250.2242  8.369700 233.6889 266.5016
 [85,] 249.9305  7.773910 234.3598 264.8278
 [86,] 249.6369  7.974508 233.8502 265.0674
 [87,] 249.3432  8.917914 231.3901 266.5833
 [88,] 249.0496 10.403985 228.2335 269.0261
 [89,] 248.7559 12.236582 224.2014 272.1003
 [90,] 248.4622 14.282937 219.9912 275.2120
 [91,] 285.6715 13.039049 260.3796 312.4272
 [92,] 304.8523 11.203179 283.2525 327.4820
 [93,] 324.0331  9.634783 305.5012 343.3189
 [94,] 343.2139  8.483529 326.6409 360.1755
 [95,] 362.3947  7.933151 346.9189 377.9293
 [96,] 381.5755  8.106967 365.8891 397.1010
 [97,] 400.7563  8.962942 383.4596 417.7969
 [98,] 419.9371 10.332916 399.7932 439.5387
 [99,] 439.1179 12.042731 415.6551 462.0856
[100,] 458.2987 13.968142 430.9425 485.2139
[101,] 226.3039 13.102819 200.0544 251.0828
[102,] 237.9190 11.235958 215.4455 259.3859
[103,] 249.5341  9.645907 230.1644 267.9612
[104,] 261.1493  8.489653 244.0806 277.4185
[105,] 272.7644  7.958566 257.3608 288.3488
[106,] 284.3796  8.175404 268.6547 300.7985
[107,] 295.9947  9.086780 278.3452 314.1855
[108,] 307.6098 10.513602 287.0898 328.2944
[109,] 319.2250 12.277457 295.3701 342.8181
[110,] 330.8401 14.253771 302.6450 358.2285
[111,] 238.8096 13.370335 211.5092 264.3473
[112,] 255.7958 11.411254 232.7352 277.4385
[113,] 272.7820  9.739900 253.5788 291.2054
[114,] 289.7683  8.527173 273.0737 306.2654
[115,] 306.7545  7.984848 291.2508 322.3812
[116,] 323.7407  8.246273 308.0640 339.9863
[117,] 340.7269  9.243501 323.0032 359.1130
[118,] 357.7132 10.774122 336.6279 379.6273
[119,] 374.6994 12.645916 349.7403 400.3198
[120,] 391.6856 14.729385 362.4416 421.9228
[121,] 255.8868 12.612141 231.6412 281.2445
[122,] 263.3732 10.812084 242.3572 284.9903
[123,] 270.8596  9.293624 252.9088 289.4923
[124,] 278.3459  8.214436 262.5320 294.8352
[125,] 285.8323  7.760005 270.5627 301.1781
[126,] 293.3187  8.037015 277.5481 309.7834
[127,] 300.8050  8.978016 283.2692 319.1742
[128,] 308.2914 10.404380 288.0999 329.1344
[129,] 315.7778 12.146305 292.5171 340.1183
[130,] 323.2642 14.087211 296.1865 351.3224
[131,] 271.9369 12.701829 246.8288 296.9129
[132,] 285.9971 10.900367 264.4019 307.5581
[133,] 300.0573  9.375411 281.6287 318.4806
[134,] 314.1175  8.281148 297.9484 330.3336
[135,] 328.1776  7.800978 312.7222 343.4026
[136,] 342.2378  8.045613 326.3584 357.9222
[137,] 356.2980  8.955851 338.9312 373.9434
[138,] 370.3582 10.357675 350.1868 390.4415
[139,] 384.4184 12.081157 360.8126 407.9824
[140,] 398.4786 14.008071 370.6042 425.4902
[141,] 254.7412 12.322436 230.1867 278.3543
[142,] 266.0164 10.607496 245.1539 286.0247
[143,] 277.2916  9.169912 259.1114 294.6732
[144,] 288.5668  8.157659 272.4608 304.1506
[145,] 299.8420  7.739463 284.1994 314.4822
[146,] 311.1172  8.008931 295.3569 326.2966
[147,] 322.3924  8.903844 304.6943 339.5331
[148,] 333.6676 10.261856 313.1907 353.0795
[149,] 344.9428 11.925802 320.7384 367.6644
[150,] 356.2180 13.785339 328.5287 382.4069
[151,] 226.3243 13.348954 199.1821 251.7024
[152,] 241.4947 11.401433 218.5444 263.1685
[153,] 256.6651  9.729047 237.0323 275.3309
[154,] 271.8355  8.495858 255.0856 288.6268
[155,] 287.0059  7.910021 271.6819 302.9845
[156,] 302.1763  8.113004 285.9433 317.9762
[157,] 317.3467  9.051896 299.1966 334.8995
[158,] 332.5171 10.531685 311.8095 352.7120
[159,] 347.6875 12.359592 323.2478 371.3967
[160,] 362.8579 14.403688 334.3143 390.4171
[161,] 252.3388 12.553458 228.5209 277.5566
[162,] 261.8069 10.778064 241.3366 283.8191
[163,] 271.2750  9.300453 253.1322 289.8373
[164,] 280.7430  8.281581 264.6132 297.2898
[165,] 290.2111  7.900959 274.7478 305.8769
[166,] 299.6792  8.247433 283.5816 316.2629
[167,] 309.1473  9.239564 291.2514 327.4691
[168,] 318.6154 10.699221 297.7914 340.2469
[169,] 328.0835 12.463208 303.9986 353.3168
[170,] 337.5516 14.420269 309.5548 366.9074
[171,] 263.7817 12.107062 240.0925 288.1790
[172,] 275.5469 10.429158 255.0750 296.5043
[173,] 287.3122  9.048450 269.7730 305.5370
[174,] 299.0774  8.118021 283.1500 315.1867
[175,] 310.8427  7.800692 295.6300 326.1642
[176,] 322.6079  8.168234 306.7559 338.4386
[177,] 334.3732  9.138381 316.2900 352.1502
[178,] 346.1384 10.546122 324.9819 366.9184
[179,] 357.9037 12.241409 333.4376 381.9957
[180,] 369.6689 14.121055 341.2643 396.9923</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.2145416 13.052876  -28.79558545  22.5729474
  [2,]  -14.7276135 11.139484  -35.90021035   8.1025516
  [3,]  -42.2894854  9.512803  -60.68287071 -22.9738451
  [4,]    8.6919428  8.342274   -7.77806364  25.3714848
  [5,]   24.4462709  7.835079    9.23907164  39.9224848
  [6,]   62.6266990  8.116539   46.56408499  78.6010975
  [7,]   10.4826272  9.113877   -7.62366793  28.1806485
  [8,] -101.2303447 10.627422 -122.49930468 -80.3868433
  [9,]   19.5485834 12.470615   -5.37302631  43.9878705
 [10,]   35.6590116 14.518443    6.75149409  64.4469211
 [11,]   11.2840745 13.528531  -14.75266793  38.3141137
 [12,]   -7.9053159 11.558927  -30.02297041  15.4314544
 [13,]  -11.9146063  9.861912  -30.90123730   8.0030424
 [14,]  -11.9066968  8.600389  -28.57640055   5.0994637
 [15,]  -10.6188872  7.983541  -26.31644476   4.7316135
 [16,]   -4.0944776  8.158925  -20.12490974  11.7338675
 [17,]   -8.1472680  9.080751  -26.34648323   9.5279925
 [18,]   -5.7716584 10.555231  -26.80767187  14.9825948
 [19,]   -0.9244488 12.386550  -25.35281522  23.6734064
 [20,]   10.3727608 14.439572  -18.01818973  39.1065178
 [21,]  -14.2853149 13.137244  -40.05038838  11.4586904
 [22,]  -23.9027459 11.279413  -46.09747613  -1.6960402
 [23,]   11.1893230  9.690614   -7.68005330  30.2750082
 [24,]    4.8151920  8.522660  -11.72427376  21.5143132
 [25,]   -3.6147391  7.962937  -19.20344181  11.7919217
 [26,]  -17.3599701  8.137929  -33.40882142  -1.9231569
 [27,]   -7.2928012  9.004903  -25.39097111  10.0236276
 [28,]    8.1417678 10.392092  -12.54626317  28.1028846
 [29,]    8.5074368 12.122200  -15.63332739  31.4924162
 [30,]   -9.8854943 14.069286  -37.94711348  16.9954013
 [31,]   46.8362952 13.593170   19.83545854  71.9536964
 [32,]   20.0261432 11.608416   -3.11480030  41.6010867
 [33,]   -2.1853087  9.898000  -21.60048479  16.3452532
 [34,]   -6.5765607  8.626673  -23.57863867   9.9151072
 [35,]  -11.5800126  8.006409  -27.54746612   4.0337418
 [36,]   -5.4595646  8.186555  -21.56530080  10.2357464
 [37,]  -28.4732165  9.119803  -46.63555369 -10.3839129
 [38,]    3.8807315 10.609238  -17.47479048  24.4117404
 [39,]  -14.6988204 12.456928  -39.57838341   9.3447451
 [40,]   28.3326276 14.526810   -0.47929477  56.6317981
 [41,]   14.4210917 13.440960  -12.31131995  39.1005932
 [42,]    4.3414396 11.552250  -18.33353155  25.7708115
 [43,]   13.6902875  9.942596   -5.95051764  32.2507730
 [44,]   24.5132354  8.767074    7.40161161  41.1232988
 [45,]   13.2034833  8.214233   -2.86797092  29.0699462
 [46,]  -17.2268688  8.407813  -33.90962827  -0.9095314
 [47,]  -27.9423209  9.301326  -46.74719630 -10.3120624
 [48,]    9.3286271 10.721178  -12.14233010  29.4774260
 [49,]  -39.2139250 12.489127  -64.47065290 -15.4594739
 [50,]   31.1485229 14.478211    1.89032759  58.9228598
 [51,]  -25.3278815 12.184787  -49.78623339  -1.3807657
 [52,]  -27.5949117 10.428282  -48.44073355  -7.2514010
 [53,]   -7.6636418  8.980506  -25.58762066   9.6173838
 [54,]   18.9256281  8.010637    3.02404051  34.5449374
 [55,]   16.4014980  7.701396    1.27816697  31.2441736
 [56,]   -1.2820322  8.128536  -17.67291439  14.3741446
 [57,]  132.6640377  9.189944  113.90462568 150.2634268
 [58,]   15.1150076 10.698478   -6.39601812  35.5037917
 [59,]  -11.6340225 12.493205  -36.43031995  12.5845488
 [60,]  -98.2881527 14.468010 -126.77076007 -69.8213539
 [61,]   15.7648884 12.855476   -9.46467697  40.7139882
 [62,]   11.1761005 11.026772  -10.42073667  32.3025772
 [63,]  -11.9109874  9.497276  -30.68897759   6.6143518
 [64,]    0.8280247  8.431422  -15.67232540  17.6771071
 [65,]  -12.1120631  8.016333  -27.67286435   4.3012946
 [66,]   18.5820490  8.349635    2.76889246  35.4697489
 [67,]    2.1406611  9.351648  -15.69476531  20.7025526
 [68,]    8.6526732 10.838464  -11.91131273  29.9215834
 [69,]  -17.1286147 12.640150  -41.10396805   7.6118592
 [70,]    1.2527975 14.640921  -26.60804526  29.9808589
 [71,]   21.1457508 12.495518   -3.02420788  46.5244079
 [72,]   20.3608635 10.693971   -0.58665858  42.0886315
 [73,]  -23.9886238  9.178529  -42.04022000  -5.6293334
 [74,]  -24.1940111  8.111171  -40.28319060  -8.4068168
 [75,]  -11.3548984  7.681023  -26.17274634   3.3212707
 [76,]  -17.7010856  7.991650  -33.40195252  -2.3904945
 [77,]   -7.8804729  8.966390  -25.22549610   9.3639649
 [78,]    6.6046398 10.420517  -13.56342689  26.9645383
 [79,]   -0.6843475 12.183575  -24.49121496  23.1860597
 [80,]   29.3547653 14.140480    1.56922743  57.0584650
 [81,]   -9.4968706 13.250297  -35.28825545  16.1249636
 [82,]   23.1356884 11.296912    1.19981355  45.2382674
 [83,]    3.9728473  9.614957  -14.86720166  22.8219715
 [84,]   20.5779063  8.369700    4.30054034  37.1132062
 [85,]    1.5213652  7.773910  -13.37585596  17.0920771
 [86,]    4.9993242  7.974508  -10.43123126  20.7859746
 [87,]   -3.8909169  8.917914  -21.13100651  14.0622175
 [88,]  -13.7385579 10.403985  -33.71514637   7.0774579
 [89,]  -13.0017989 12.236582  -36.34620503  11.5527057
 [90,]  -11.2156400 14.282937  -37.96544022  17.2554480
 [91,]   26.6950601 13.039049   -0.06060272  51.9869643
 [92,]    8.9534672 11.203179  -13.67623342  30.5533301
 [93,]  -32.4219258  9.634783  -51.70767746 -13.8900246
 [94,]    2.9082813  8.483529  -14.05331922  19.4813274
 [95,]    3.3376883  7.933151  -12.19688887  18.8135373
 [96,]   10.2629954  8.106967   -5.26247324  25.9494271
 [97,]    3.5038024  8.962942  -13.53682238  20.8004770
 [98,]   -3.2447905 10.332916  -22.84637057  16.8990973
 [99,]   16.7464166 12.042731   -6.22133313  40.2092104
[100,]    0.6180236 13.968142  -26.29720013  27.9741978
[101,]    9.7993370 13.102819  -14.97957590  36.0488466
[102,]   -7.6023013 11.235958  -29.06919836  14.8712314
[103,]  -10.6085397  9.645907  -29.03564394   8.7611709
[104,]   -6.2272781  8.489653  -22.49654179  10.8414003
[105,]  -22.0541165  7.958566  -37.63851603  -6.6505303
[106,]  -14.6051548  8.175404  -31.02408741   1.1197268
[107,]  -14.4298932  9.086780  -32.62070138   3.2195919
[108,]    0.4921684 10.513602  -20.19238914  21.0121852
[109,]   17.0556300 12.277457   -6.53749849  40.9105489
[110,]   20.8049916 14.253771   -6.58339398  49.0001496
[111,]   17.4872125 13.370335   -8.05047126  44.7876413
[112,]  -12.3415113 11.411254  -33.98418084  10.7190735
[113,]  -16.5774350  9.739900  -35.00076323   2.6257890
[114,]  -34.2411587  8.527173  -50.73831379 -17.5466395
[115,]  -37.8379824  7.984848  -53.46468323 -22.3343231
[116,]    5.9839939  8.246273  -10.26155437  21.6606920
[117,]   38.7175702  9.243501   20.33146569  56.4413377
[118,]    5.2052464 10.774122  -16.70885954  26.2904751
[119,]   19.7878227 12.645916   -5.83260016  44.7468752
[120,]   -2.6329010 14.729385  -32.87008136  26.6111459
[121,]   -5.3603040 12.612141  -30.71798462  18.8853415
[122,]   36.6844224 10.812084   15.06727455  57.7004383
[123,]   -0.9656512  9.293624  -19.59835096  16.9851075
[124,]    2.2431752  8.214436  -14.24610604  18.0571049
[125,]  -14.0048984  7.760005  -29.35067377   1.2646626
[126,]   11.3149280  8.037015   -5.14979154  27.0855007
[127,]  -13.0584456  8.978016  -31.42757707   4.4773830
[128,]  -41.6959191 10.404380  -62.53886626 -21.5043801
[129,]    5.7640073 12.146305  -18.57651056  29.0246630
[130,]   24.3013337 14.087211   -3.75689798  51.3790095
[131,]  -50.2598140 12.701829  -75.23584749 -25.1516957
[132,]   12.1968030 10.900367   -9.36418477  33.7919868
[133,]   26.8212199  9.375411    8.39787465  45.2498252
[134,]   32.7380369  8.281148   16.52189797  48.9070504
[135,]   20.5625538  7.800978    5.33764733  36.0179551
[136,]   10.5908707  8.045613   -5.09350366  26.4703317
[137,]   -1.8714123  8.955851  -19.51681288  15.4954254
[138,]   -9.9255954 10.357675  -30.00889969  10.2457834
[139,]   -8.7777785 12.081157  -32.34179766  14.8279716
[140,]   -9.9368615 14.008071  -36.94853791  17.9375307
[141,]   17.1822721 12.322436   -6.43080496  41.7367769
[142,]    2.4204710 10.607496  -17.58783080  23.2830453
[143,]  -20.0492301  9.169912  -37.43081661  -1.8690498
[144,]  -10.9102311  8.157659  -26.49397720   5.1957738
[145,]   14.9801678  7.739463    0.34002570  30.6228112
[146,]    6.0962667  8.008931   -9.08309417  21.8566100
[147,]  -24.2571344  8.903844  -41.39777626  -6.5589704
[148,]   14.4552645 10.261856   -4.95657205  34.9322172
[149,]   -4.6628365 11.925802  -27.38437202  19.5415605
[150,]   10.2950624 13.785339  -15.89375654  37.9843682
[151,]   -1.0603386 13.348954  -26.43842237  26.0819270
[152,]   -6.9712287 11.401433  -28.64496263  15.9791423
[153,]  -17.7643189  9.729047  -36.43014358   1.8685368
[154,]  -31.3625091  8.495858  -48.15382724 -14.6125562
[155,]  -19.4685993  7.910021  -35.44716734  -4.1446062
[156,]   42.0174105  8.113004   26.21745335  58.2503568
[157,]  -36.1985797  9.051896  -53.75141865 -18.0485024
[158,]   15.0684302 10.531685   -5.12653222  35.7759905
[159,]   17.4755400 12.359592   -6.23366690  41.9151953
[160,]    9.3709498 14.403688  -18.18828451  37.9144961
[161,]   17.5416244 12.553458   -7.67624409  41.3595087
[162,]   10.6359367 10.778064  -11.37629861  31.1062408
[163,]    6.6239489  9.300453  -11.93841147  24.7667057
[164,]    1.0464612  8.281581  -15.50031538  17.1762546
[165,]  -11.0406266  7.900959  -26.70641373   4.4227001
[166,]  -15.1672144  8.247433  -31.75093173   0.9304331
[167,]  -49.8815021  9.239564  -68.20328330 -31.9856313
[168,]  -13.9847899 10.699221  -35.61629334   6.8391603
[169,]   22.6972223 12.463208   -2.53608975  46.7821125
[170,]   31.9176346 14.420269    2.56183597  59.9143885
[171,]    5.6300457 12.107062  -18.76728758  29.3191866
[172,]   -2.0729053 10.429158  -23.03030154  18.3990202
[173,]   10.2846438  9.048450   -7.94017582  27.8238405
[174,]   11.5541928  8.118021   -4.55506701  27.4815779
[175,]  -23.6700581  7.800692  -38.99161290  -8.4574202
[176,]    6.9996909  8.168234   -8.83101755  22.8516616
[177,]    0.1086400  9.138381  -17.66842894  18.1918440
[178,]   -2.9185110 10.546122  -23.69854221  18.2380127
[179,]   11.2380381 12.241409  -12.85404912  35.7041123
[180,]   -5.5453129 14.121055  -32.86869061  22.8593407</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.5
p_loo        19.6  3.5
looic      1770.1 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1543      
 (0.5, 0.7]   (ok)         3    1.7%   144       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.4 21.9
p_loo        33.3  8.1
looic      1720.7 43.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   752       
 (0.5, 0.7]   (ok)         5    2.8%   521       
   (0.7, 1]   (bad)        3    1.7%   25        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.7      11.2  
fit_sleep1 -93.0      20.6  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.5
p_loo        19.6  3.5
looic      1770.1 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1543      
 (0.5, 0.7]   (ok)         3    1.7%   144       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.4 21.9
p_loo        33.3  8.1
looic      1720.7 43.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   752       
 (0.5, 0.7]   (ok)         5    2.8%   521       
   (0.7, 1]   (bad)        3    1.7%   25        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.4     21.9        33.3    8.1   1720.7
fit_sleep2  -24.7      11.2  -885.1     14.5        19.6    3.5   1770.1
fit_sleep1  -93.0      20.6  -953.3     10.5         3.2    0.5   1906.7
           se_looic
fit_sleep3   43.8  
fit_sleep2   28.9  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
4.127706e-41 1.841313e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.52     0.43     5.44       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.52    -3.13     2.93       5.66      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.3.5         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.0       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
