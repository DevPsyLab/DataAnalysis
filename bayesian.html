<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.70      7.06    15.22    42.94 1.00     1646     1916
sd(Days)                6.55      1.54     4.06    10.14 1.00     1170     1878
cor(Intercept,Days)     0.08      0.30    -0.48     0.66 1.00      848     1714

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.34      7.25   236.75   265.89 1.00     1646     2430
Days         10.55      1.65     7.25    13.92 1.00     1449     2109

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.95      1.58    23.10    29.33 1.00     3676     3065

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.1508  13.12088 228.5096 279.6439
309 211.4588  12.94219 185.8426 236.8177
310 213.2112  13.69378 185.7991 239.2264
330 274.3546  13.72614 248.4573 301.5547
331 273.0524  13.17380 248.1725 298.8587
332 260.2875  12.46151 236.2840 284.9664
333 267.8030  12.70785 243.1552 293.4889
334 244.2153  12.16747 219.9704 267.5622
335 250.8409  13.14710 225.3590 276.2342
337 285.7267  13.19547 259.7018 310.9345
349 226.6794  13.19324 200.4148 252.0999
350 239.0085  13.15701 212.9852 264.2743
351 255.3994  12.40378 231.9403 280.5375
352 271.8374  12.33862 247.8143 296.2687
369 254.8612  12.27271 230.7044 279.1845
370 226.7676  13.33153 200.5629 253.0239
371 251.8351  12.27135 227.5607 275.9986
372 263.4542  12.49699 239.0854 288.5635

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.5749793  2.492010 14.63980729 24.443241
309  1.8079157  2.459855 -3.12899416  6.614493
310  4.8948082  2.563812 -0.09708073 10.010342
330  5.7839468  2.598369  0.74947878 10.844570
331  7.5440342  2.524003  2.43568214 12.271386
332 10.2166298  2.342451  5.60125613 14.815175
333 10.2950777  2.465937  5.32307055 15.110402
334 11.5600001  2.306962  7.03700942 16.153325
335 -0.2284743  2.539457 -5.15743800  4.753028
337 19.1878910  2.517888 14.27903866 24.131468
349 11.5712358  2.485436  6.87655598 16.538663
350 16.9887312  2.499430 12.14216545 21.976069
351  7.5597274  2.352531  2.85600672 12.120938
352 14.0793139  2.362345  9.41111321 18.652312
369 11.2636025  2.339441  6.59924741 15.934790
370 15.1668325  2.511810 10.24204308 20.370203
371  9.5277293  2.337748  4.96303025 14.196316
372 11.7511674  2.382205  7.00814920 16.186070</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.1508 13.120879 228.5096 279.6439
  [2,] 273.7258 11.248726 251.7237 295.4518
  [3,] 293.3008  9.660767 274.2742 311.9800
  [4,] 312.8758  8.517466 296.1805 329.2799
  [5,] 332.4507  8.011509 317.0052 348.3345
  [6,] 352.0257  8.260844 336.3390 368.0588
  [7,] 371.6007  9.204295 353.5750 389.8754
  [8,] 391.1757 10.659118 370.0821 412.1298
  [9,] 410.7507 12.447279 386.0588 435.5394
 [10,] 430.3256 14.445517 401.7598 459.0303
 [11,] 211.4588 12.942189 185.8426 236.8177
 [12,] 213.2667 11.077307 191.1241 234.5299
 [13,] 215.0746  9.487621 196.4572 233.5450
 [14,] 216.8825  8.332164 200.6714 233.3870
 [15,] 218.6905  7.806199 203.2974 233.9727
 [16,] 220.4984  8.034320 204.6200 236.4062
 [17,] 222.3063  8.959109 204.4020 240.0518
 [18,] 224.1142 10.396285 203.2285 244.8399
 [19,] 225.9221 12.165592 201.6488 249.4955
 [20,] 227.7300 14.142924 199.3650 255.5012
 [21,] 213.2112 13.693781 185.7991 239.2264
 [22,] 218.1060 11.712247 194.9821 240.4310
 [23,] 223.0008  9.999004 203.3670 241.8735
 [24,] 227.8956  8.713764 210.9088 244.5409
 [25,] 232.7904  8.063843 217.3124 248.6362
 [26,] 237.6852  8.201690 221.8906 254.0764
 [27,] 242.5800  9.091542 224.9449 260.6219
 [28,] 247.4748 10.544705 227.0744 268.2101
 [29,] 252.3697 12.364132 228.6014 276.3846
 [30,] 257.2645 14.411765 229.6269 285.2949
 [31,] 274.3546 13.726138 248.4573 301.5547
 [32,] 280.1386 11.716635 257.9470 303.5270
 [33,] 285.9225  9.982749 266.8286 305.5966
 [34,] 291.7065  8.691033 274.7824 308.5566
 [35,] 297.4904  8.057038 281.8533 313.0911
 [36,] 303.2744  8.234118 287.0753 319.4745
 [37,] 309.0583  9.175434 291.2199 327.1648
 [38,] 314.8423 10.680801 294.1049 336.3215
 [39,] 320.6262 12.548844 296.2633 346.2454
 [40,] 326.4101 14.641397 298.4037 356.0890
 [41,] 273.0524 13.173804 248.1725 298.8587
 [42,] 280.5964 11.237804 259.0425 302.6050
 [43,] 288.1404  9.579591 269.5110 306.6117
 [44,] 295.6845  8.366007 278.9447 311.6380
 [45,] 303.2285  7.807225 287.5424 318.1990
 [46,] 310.7725  8.040935 294.8718 326.1527
 [47,] 318.3166  9.005647 300.5355 335.7177
 [48,] 325.8606 10.501806 304.9531 346.1466
 [49,] 333.4046 12.337559 308.4313 357.4531
 [50,] 340.9487 14.383461 311.8861 369.2070
 [51,] 260.2875 12.461505 236.2840 284.9664
 [52,] 270.5041 10.768879 250.3720 292.0449
 [53,] 280.7207  9.360691 263.0753 299.3156
 [54,] 290.9374  8.381555 275.0227 308.0190
 [55,] 301.1540  7.990780 285.6845 317.1020
 [56,] 311.3706  8.272171 295.4643 327.7958
 [57,] 321.5873  9.164017 303.7352 339.7256
 [58,] 331.8039 10.512077 311.2116 352.3907
 [59,] 342.0205 12.165627 318.0509 366.0817
 [60,] 352.2371 14.016966 324.2001 379.9468
 [61,] 267.8030 12.707845 243.1552 293.4889
 [62,] 278.0981 10.896497 257.0506 299.6977
 [63,] 288.3932  9.388272 270.3512 306.8609
 [64,] 298.6883  8.349092 282.7750 315.5524
 [65,] 308.9833  7.964717 293.5879 325.2434
 [66,] 319.2784  8.326331 302.9019 336.1785
 [67,] 329.5735  9.347756 311.0381 348.2313
 [68,] 339.8686 10.844122 318.2934 361.7912
 [69,] 350.1636 12.647969 324.8321 375.0251
 [70,] 360.4587 14.646124 331.0666 388.8297
 [71,] 244.2153 12.167469 219.9704 267.5622
 [72,] 255.7753 10.485492 234.7416 275.3864
 [73,] 267.3353  9.082288 249.2637 284.4573
 [74,] 278.8953  8.103981 263.3083 294.4985
 [75,] 290.4553  7.713961 275.6327 305.6865
 [76,] 302.0153  7.998751 286.3932 318.2075
 [77,] 313.5753  8.893762 295.8556 331.1892
 [78,] 325.1353 10.240220 304.5516 345.0628
 [79,] 336.6953 11.885679 313.1192 359.8421
 [80,] 348.2553 13.723002 321.1393 375.2045
 [81,] 250.8409 13.147102 225.3590 276.2342
 [82,] 250.6124 11.222354 228.5822 272.0982
 [83,] 250.3839  9.588214 231.6139 268.7406
 [84,] 250.1554  8.415710 233.6929 266.3385
 [85,] 249.9270  7.912785 234.3309 265.0656
 [86,] 249.6985  8.203527 233.9817 265.8967
 [87,] 249.4700  9.213102 231.6266 267.6841
 [88,] 249.2415 10.740685 228.0532 270.5416
 [89,] 249.0131 12.599248 224.7722 273.9550
 [90,] 248.7846 14.663475 220.7854 277.7247
 [91,] 285.7267 13.195471 259.7018 310.9345
 [92,] 304.9146 11.288249 282.3604 326.5375
 [93,] 324.1025  9.664792 305.4145 342.5926
 [94,] 343.2904  8.489485 327.0082 359.7848
 [95,] 362.4783  7.963293 347.0395 378.0953
 [96,] 381.6662  8.211955 365.6038 397.5779
 [97,] 400.8541  9.172672 382.8640 418.8154
 [98,] 420.0420 10.654535 399.0585 440.6252
 [99,] 439.2298 12.473165 414.4821 463.6244
[100,] 458.4177 14.502417 430.0541 487.0454
[101,] 226.6794 13.193235 200.4148 252.0999
[102,] 238.2506 11.335307 215.5222 260.1604
[103,] 249.8218  9.760722 230.4723 268.9358
[104,] 261.3931  8.626064 244.4326 278.3822
[105,] 272.9643  8.117946 257.0201 288.6258
[106,] 284.5355  8.351520 268.4925 300.6251
[107,] 296.1068  9.270896 278.3660 314.5249
[108,] 307.6780 10.700744 287.0090 328.6036
[109,] 319.2492 12.466640 295.6680 343.9054
[110,] 330.8205 14.445867 303.5031 359.2840
[111,] 239.0085 13.157011 212.9852 264.2743
[112,] 255.9972 11.262254 233.1674 277.1067
[113,] 272.9860  9.646974 253.8897 291.1060
[114,] 289.9747  8.472553 273.3081 306.2458
[115,] 306.9634  7.937159 291.3343 322.2982
[116,] 323.9522  8.167443 307.7855 339.9975
[117,] 340.9409  9.105496 322.8611 358.7039
[118,] 357.9296 10.564435 337.1212 378.6174
[119,] 374.9184 12.361181 350.5994 399.3503
[120,] 391.9071 14.369573 363.6131 420.1325
[121,] 255.3994 12.403785 231.9403 280.5375
[122,] 262.9591 10.681005 242.8729 284.4075
[123,] 270.5188  9.240274 252.9081 288.6760
[124,] 278.0786  8.231056 261.9862 294.2662
[125,] 285.6383  7.822192 270.3718 301.0251
[126,] 293.1980  8.105055 277.2529 309.5585
[127,] 300.7577  9.014763 282.9910 318.5454
[128,] 308.3175 10.387916 287.6863 328.7111
[129,] 315.8772 12.067329 292.5223 339.2244
[130,] 323.4369 13.942772 296.1790 350.3176
[131,] 271.8374 12.338617 247.8143 296.2687
[132,] 285.9167 10.618103 265.5459 306.9699
[133,] 299.9960  9.187389 282.2753 318.1221
[134,] 314.0753  8.199601 298.2113 330.1171
[135,] 328.1547  7.824330 313.2273 343.1983
[136,] 342.2340  8.146666 326.4461 358.0851
[137,] 356.3133  9.092720 338.9702 373.8981
[138,] 370.3926 10.495155 350.2277 391.0372
[139,] 384.4719 12.197555 361.0691 408.8120
[140,] 398.5512 14.091621 371.5666 426.8375
[141,] 254.8612 12.272708 230.7044 279.1845
[142,] 266.1248 10.593912 245.2199 287.3420
[143,] 277.3884  9.208071 259.1494 295.5352
[144,] 288.6520  8.263904 272.4870 304.9949
[145,] 299.9156  7.920961 284.4133 315.2206
[146,] 311.1792  8.254521 295.0228 327.2664
[147,] 322.4428  9.191222 304.6292 340.2141
[148,] 333.7064 10.571942 313.2060 354.5641
[149,] 344.9700 12.247422 321.2520 368.9271
[150,] 356.2336 14.113068 328.6243 383.8782
[151,] 226.7676 13.331528 200.5629 253.0239
[152,] 241.9344 11.416273 219.3567 264.2398
[153,] 257.1012  9.775037 237.9014 276.1161
[154,] 272.2681  8.566783 255.0958 288.7898
[155,] 287.4349  7.990406 271.6316 303.1408
[156,] 302.6017  8.180573 286.7264 318.2254
[157,] 317.7685  9.089298 300.0819 334.8063
[158,] 332.9354 10.532203 312.0097 352.7584
[159,] 348.1022 12.323053 323.7655 371.2707
[160,] 363.2690 14.332004 334.9396 390.4121
[161,] 251.8351 12.271350 227.5607 275.9986
[162,] 261.3628 10.602321 240.3822 282.6538
[163,] 270.8906  9.228354 252.5783 288.9905
[164,] 280.4183  8.297346 263.8910 296.6948
[165,] 289.9460  7.966148 274.1506 305.6966
[166,] 299.4737  8.306817 282.8664 315.5478
[167,] 309.0015  9.245379 290.5908 326.8395
[168,] 318.5292 10.624546 297.7051 339.0285
[169,] 328.0569 12.296953 304.3979 351.8710
[170,] 337.5847 14.159070 310.2612 365.3573
[171,] 263.4542 12.496989 239.0854 288.5635
[172,] 275.2053 10.764437 254.5466 296.6531
[173,] 286.9565  9.323159 268.9296 305.6463
[174,] 298.7077  8.325820 282.4469 315.4945
[175,] 310.4588  7.941477 294.7752 326.3365
[176,] 322.2100  8.256188 306.0347 338.7319
[177,] 333.9612  9.198479 315.4291 351.5746
[178,] 345.7123 10.602320 324.3148 365.8878
[179,] 357.4635 12.310815 332.5150 380.4727
[180,] 369.2147 14.214533 340.9335 395.7905</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.5908154 13.120879  -30.0839161  21.0504062
  [2,]  -15.0210947 11.248726  -36.7470607   6.9810263
  [3,]  -42.5001741  9.660767  -61.1793881 -23.4736379
  [4,]    8.5640466  8.517466   -7.8401033  25.2592792
  [5,]   24.4011672  8.011509    8.5173619  39.8467155
  [6,]   62.6643879  8.260844   46.6313175  78.3510919
  [7,]   10.6031085  9.204295   -7.6715879  28.6288123
  [8,] -101.0270708 10.659118 -121.9812035 -79.9335213
  [9,]   19.8346498 12.447279   -4.9540656  44.5265096
 [10,]   36.0278705 14.445517    7.3232481  64.5937294
 [11,]   11.2751120 12.942189  -14.0837818  36.8912505
 [12,]   -8.0009038 11.077307  -29.2641438  14.1417335
 [13,]  -12.0968195  9.487621  -30.5672004   6.5206469
 [14,]  -12.1755353  8.332164  -28.6799778   4.0356029
 [15,]  -10.9743510  7.806199  -26.2565891   4.4187018
 [16,]   -4.5365668  8.034320  -20.4443827  11.3418266
 [17,]   -8.6759825  8.959109  -26.4215111   9.2283435
 [18,]   -6.3869983 10.396285  -27.1127108  14.4986792
 [19,]   -1.6264140 12.165592  -25.1998473  22.6469199
 [20,]    9.5841702 14.142924  -18.1869885  37.9492062
 [21,]  -14.1572923 13.693781  -40.1725450  13.2548060
 [22,]  -23.7738005 11.712247  -46.0987717  -0.6499015
 [23,]   11.3191913  9.999004   -7.5534548  30.9530189
 [24,]    4.9459831  8.713764  -11.6992850  21.9327778
 [25,]   -3.4830251  8.063843  -19.3288474  11.9949904
 [26,]  -17.2273333  8.201690  -33.6184913  -1.4327107
 [27,]   -7.1592415  9.091542  -25.2010583  10.4758518
 [28,]    8.2762504 10.544705  -12.4589946  28.6766964
 [29,]    8.6428422 12.364132  -15.3720787  32.4111187
 [30,]   -9.7491660 14.411765  -37.7796118  17.8884233
 [31,]   47.1879764 13.726138   19.9879126  73.0852893
 [32,]   20.2616297 11.716635   -3.1268109  42.4532482
 [33,]   -2.0660171  9.982749  -21.7401018  17.0278981
 [34,]   -6.5734639  8.691033  -23.4236442  10.3506070
 [35,]  -11.6931106  8.057038  -27.2938165   3.9439842
 [36,]   -5.6888574  8.234118  -21.8890311  10.5102271
 [37,]  -28.8187042  9.175434  -46.9251794 -10.9802766
 [38,]    3.4190491 10.680801  -18.0601975  24.1564297
 [39,]  -15.2766977 12.548844  -40.8958641   9.0861523
 [40,]   27.6385555 14.641397   -2.0403363  55.6449665
 [41,]   14.5555453 13.173804  -11.2508280  39.4354345
 [42,]    4.4036111 11.237804  -17.6049950  25.9574805
 [43,]   13.6801768  9.579591   -4.7910915  32.3095610
 [44,]   24.4308426  8.366007    8.4772811  41.1705849
 [45,]   13.0488084  7.807225   -1.9217264  28.7348550
 [46,]  -17.4538259  8.040935  -32.8340300  -1.5531104
 [47,]  -28.2415601  9.005647  -45.6427091 -10.4605424
 [48,]    8.9571056 10.501806  -11.3288766  29.8646275
 [49,]  -39.6577286 12.337559  -63.7061923 -14.6844025
 [50,]   30.6324371 14.383461    2.3741156  59.6949916
 [51,]  -25.4268717 12.461505  -50.1057986  -1.4234421
 [52,]  -27.6923015 10.768879  -49.2330788  -7.5602135
 [53,]   -7.7594313  9.360691  -26.3542898   9.8859731
 [54,]   18.8314390  8.381555    1.7498399  34.7460821
 [55,]   16.3089092  7.990780    0.3609013  31.7784167
 [56,]   -1.3730206  8.272171  -17.7981909  14.5332979
 [57,]  132.5746497  9.164017  114.4362543 150.4266673
 [58,]   15.0272199 10.512077   -5.5596312  35.6194959
 [59,]  -11.7202099 12.165627  -35.7814270  12.2493818
 [60,]  -98.3727396 14.016966 -126.0824228 -70.3356746
 [61,]   16.0393769 12.707845   -9.6465209  40.6872487
 [62,]   11.4568992 10.896497  -10.1426840  32.5044446
 [63,]  -11.6238784  9.388272  -30.0916458   6.4181211
 [64,]    1.1214439  8.349092  -15.7427282  17.0346546
 [65,]  -11.8123337  7.964717  -28.0724377   3.5831365
 [66,]   18.8880886  8.326331    1.9880196  35.2645896
 [67,]    2.4530109  9.347756  -16.2047883  20.9883899
 [68,]    8.9713333 10.844122  -12.9513108  30.5465271
 [69,]  -16.8036444 12.647969  -41.6650775   8.5279324
 [70,]    1.5840780 14.646124  -26.7869144  30.9762411
 [71,]   21.2578292 12.167469   -2.0890648  45.5027428
 [72,]   20.4259291 10.485492    0.8148415  41.4595833
 [73,]  -23.9705711  9.082288  -41.0926450  -5.8990152
 [74,]  -24.2229712  8.103981  -39.8261827  -8.6359587
 [75,]  -11.4308713  7.713961  -26.6620631   3.3917275
 [76,]  -17.8240715  7.998751  -34.0163051  -2.2019605
 [77,]   -8.0504716  8.893762  -25.6644255   9.6691515
 [78,]    6.3876283 10.240220  -13.5399053  26.9713366
 [79,]   -0.9483719 11.885679  -24.0952242  22.6277267
 [80,]   29.0437280 13.723002    2.0945066  56.1596602
 [81,]   -9.2325599 13.147102  -34.6258515  16.2492760
 [82,]   23.3348144 11.222354    1.8490025  45.3650418
 [83,]    4.1067886  9.588214  -14.2499221  22.8768275
 [84,]   20.6466629  8.415710    4.4636063  37.1091560
 [85,]    1.5249372  7.912785  -13.6136801  17.1209707
 [86,]    4.9377115  8.203527  -11.2605060  20.6544791
 [87,]   -4.0177142  9.213102  -22.2318352  13.8256667
 [88,]  -13.9305399 10.740685  -35.2305635   7.2577632
 [89,]  -13.2589656 12.599248  -38.2008925  10.9819223
 [90,]  -11.5379913 14.663475  -40.4780706  16.4611900
 [91,]   26.6398808 13.195471    1.4321434  52.6647840
 [92,]    8.8911898 11.288249  -12.7316899  31.4454318
 [93,]  -32.4913012  9.664792  -50.9814236 -13.8033473
 [94,]    2.8318078  8.489485  -13.6625500  19.1140354
 [95,]    3.2541169  7.963293  -12.3629055  18.6929204
 [96,]   10.1723259  8.211955   -5.7394424  26.2346514
 [97,]    3.4060349  9.172672  -14.5553093  21.3961100
 [98,]   -3.3496561 10.654535  -23.9328632  17.6337870
 [99,]   16.6344530 12.473165   -7.7601407  41.3821970
[100,]    0.4989620 14.502417  -28.1287461  28.8626088
[101,]    9.4238449 13.193235  -15.9967395  35.6883740
[102,]   -7.9338909 11.335307  -29.8436797  14.7944708
[103,]  -10.8962266  9.760722  -30.0101652   8.4532518
[104,]   -6.4710624  8.626064  -23.4602297  10.4894494
[105,]  -22.2539981  8.117946  -37.9155438  -6.3097653
[106,]  -14.7611339  8.351520  -30.8507474   1.2819106
[107,]  -14.5419696  9.270896  -32.9600534   3.1988047
[108,]    0.4239946 10.700744  -20.5015590  21.0930099
[109,]   17.0313589 12.466640   -7.6248041  40.6126097
[110,]   20.8246231 14.445867   -7.6389304  48.1420449
[111,]   17.2882916 13.157011   -7.9775395  43.3115643
[112,]  -12.5429396 11.262254  -33.6524400  10.2869477
[113,]  -16.7813708  9.646974  -34.9013888   2.3149073
[114,]  -34.4476019  8.472553  -50.7187429 -17.7810479
[115,]  -38.0469331  7.937159  -53.3817287 -22.4178372
[116,]    5.7725357  8.167443  -10.2727545  21.9392440
[117,]   38.5036045  9.105496   20.7405592  56.5834247
[118,]    4.9887733 10.564435  -15.6989673  25.7971798
[119,]   19.5688421 12.361181   -4.8630548  43.8878139
[120,]   -2.8543891 14.369573  -31.0798068  25.4395678
[121,]   -4.8728809 12.403785  -30.0110068  18.5862298
[122,]   37.0984916 10.681005   15.6501027  57.1847424
[123,]   -0.6249358  9.240274  -18.7820587  16.9858086
[124,]    2.5105368  8.231056  -13.6771339  18.6028574
[125,]  -13.8108906  7.822192  -29.1976580   1.4556491
[126,]   11.4355820  8.105055   -4.9248673  27.3807247
[127,]  -13.0111454  9.014763  -30.7988237   4.7556326
[128,]  -41.7219729 10.387916  -62.1156154 -21.0908496
[129,]    5.6645997 12.067329  -17.6825919  29.0194991
[130,]   24.1285723 13.942772   -2.7521010  51.3864927
[131,]  -50.1603057 12.338617  -74.5916209 -26.1371760
[132,]   12.2771804 10.618103   -8.7760378  32.6479690
[133,]   26.8824664  9.187389    8.7563950  44.6031642
[134,]   32.7801525  8.199601   16.7383871  48.6442320
[135,]   20.5855385  7.824330    5.5419059  35.5128573
[136,]   10.5947246  8.146666   -5.2563558  26.3826118
[137,]   -1.8866894  9.092720  -19.4715249  15.4563773
[138,]   -9.9600033 10.495155  -30.6045777  10.2049292
[139,]   -8.8313172 12.197555  -33.1713546  14.5715308
[140,]  -10.0095312 14.091621  -38.2957914  16.9750695
[141,]   17.0623485 12.272708   -7.2609562  41.2190537
[142,]    2.3121460 10.593912  -18.9051133  23.2170199
[143,]  -20.1459565  9.208071  -38.2927788  -1.9069587
[144,]  -10.9953590  8.263904  -27.3382865   5.1696020
[145,]   14.9066385  7.920961   -0.3983546  30.4089312
[146,]    6.0343360  8.254521  -10.0529232  22.1906776
[147,]  -24.3074665  9.191222  -42.0788368  -6.4938761
[148,]   14.4165310 10.571942   -6.4411807  34.9168631
[149,]   -4.6899714 12.247422  -28.6471429  19.0279933
[150,]   10.2795261 14.113068  -17.3650869  37.8887626
[151,]   -1.5035532 13.331528  -27.7598992  24.7011023
[152,]   -7.4108856 11.416273  -29.7163319  15.1668033
[153,]  -18.2004181  9.775037  -37.2152733   0.9994495
[154,]  -31.7950505  8.566783  -48.3167730 -14.6227587
[155,]  -19.8975830  7.990406  -35.6035330  -4.0942804
[156,]   41.5919846  8.180573   25.9683339  57.4673197
[157,]  -36.6204479  9.089298  -53.6582043 -18.9337828
[158,]   14.6501196 10.532203   -5.1729088  35.5757863
[159,]   17.0607872 12.323053   -6.1076691  41.3975249
[160,]    8.9597547 14.332004  -18.1832721  37.2892055
[161,]   18.0452965 12.271350   -6.1182469  42.3197442
[162,]   11.0799672 10.602321  -10.2110264  32.0606195
[163,]    7.0083380  9.228354  -11.0915569  25.3205613
[164,]    1.3712087  8.297346  -14.9053064  17.8985057
[165,]  -10.7755205  7.966148  -26.5261282   5.0199062
[166,]  -14.9617498  8.306817  -31.0357666   1.6455555
[167,]  -49.7356790  9.245379  -67.5737475 -31.3249752
[168,]  -13.8986083 10.624546  -34.3978825   6.9254921
[169,]   22.7237625 12.296953   -1.0903293  46.3827618
[170,]   31.8845332 14.159070    4.1119286  59.2080243
[171,]    5.9575225 12.496989  -19.1518199  30.3262728
[172,]   -1.7313449 10.764437  -23.1790526  18.9273801
[173,]   10.6402877  9.323159   -8.0495180  28.6671621
[174,]   11.9239203  8.325820   -4.8628927  28.1847375
[175,]  -23.2862471  7.941477  -39.1638687  -7.6025823
[176,]    7.3975854  8.256188   -9.1243001  23.5729395
[177,]    0.5206180  9.198479  -17.0927933  19.0526652
[178,]   -2.4924494 10.602320  -22.6679446  18.9051365
[179,]   11.6781832 12.310815  -11.3310412  36.6267072
[180,]   -5.0910842 14.214533  -31.6668991  23.1901419</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.4  3.4
looic      1769.9 28.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   637       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   51        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.5 22.3
p_loo        34.4  8.6
looic      1723.0 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     169   93.9%   580       
 (0.5, 0.7]   (ok)         9    5.0%   120       
   (0.7, 1]   (bad)        1    0.6%   17        
   (1, Inf)   (very bad)   1    0.6%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.5      11.5  
fit_sleep1 -91.9      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.

Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.4  3.4
looic      1769.9 28.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   637       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   51        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.5 22.3
p_loo        34.4  8.6
looic      1723.0 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     169   93.9%   580       
 (0.5, 0.7]   (ok)         9    5.0%   120       
   (0.7, 1]   (bad)        1    0.6%   17        
   (1, Inf)   (very bad)   1    0.6%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.5     22.3        34.4    8.6   1723.0
fit_sleep2  -23.5      11.5  -885.0     14.4        19.4    3.4   1769.9
fit_sleep1  -91.9      21.0  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.7  
fit_sleep2   28.9  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.276822e-40 6.433742e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.82      1.57     0.22     5.26       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.18      1.57    -3.43     2.77       5.27      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
