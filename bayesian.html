<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.92      6.83    15.61    41.97 1.00     1656     2465
sd(Days)                6.60      1.52     4.19    10.07 1.00     1472     2111
cor(Intercept,Days)     0.08      0.30    -0.48     0.66 1.00      883     1765

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.07      7.61   235.99   265.82 1.00     1755     2327
Days         10.42      1.72     7.04    13.89 1.00     1414     1849

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.56    23.06    29.17 1.00     3781     2858

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7830  13.10871 227.9170 279.4081
309 211.4541  13.39222 184.7134 237.3702
310 212.6567  13.37270 186.1620 238.6024
330 274.5099  13.12746 250.1356 300.9832
331 273.3837  13.03034 248.1804 299.3633
332 260.3197  11.89353 237.3124 284.0069
333 268.0533  12.31311 244.0376 292.9513
334 244.2468  12.04524 220.5828 267.1986
335 250.7510  13.08501 226.2638 277.1865
337 285.6982  13.14488 259.6903 310.7099
349 226.4651  12.93060 200.2362 251.2967
350 238.7180  12.89502 213.0586 263.9472
351 255.9529  12.49889 231.9763 281.0271
352 271.7707  12.49963 247.6083 296.9479
369 254.3986  12.40906 230.2983 278.7006
370 226.1473  13.41721 199.8301 252.1148
371 252.3060  12.34081 228.1384 277.0478
372 263.4479  12.13999 239.8638 287.1371

, , Days

      Estimate Est.Error         Q2.5     Q97.5
308 19.6471194  2.511605 14.833592537 24.492949
309  1.7878257  2.534122 -3.120869454  6.827467
310  4.9859381  2.526254  0.006209201 10.188247
330  5.7162760  2.504901  0.687476346 10.493040
331  7.4539266  2.488399  2.519922020 12.304323
332 10.2413785  2.284500  5.737755438 14.717435
333 10.2231241  2.356980  5.584764713 14.646328
334 11.5081648  2.340374  6.987387981 16.070316
335 -0.2576629  2.550543 -5.315203851  4.524306
337 19.1707802  2.516125 14.320764420 24.185818
349 11.6226629  2.439366  6.997889145 16.427575
350 17.0122083  2.476206 12.302507739 21.978413
351  7.4403086  2.351456  2.747511311 12.049266
352 14.0865945  2.393726  9.323729420 18.684845
369 11.4114065  2.387378  6.731933509 16.058892
370 15.2363538  2.567521 10.291841781 20.292303
371  9.4490552  2.363339  4.819546205 13.997390
372 11.7972836  2.341423  7.214829452 16.320382</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7830 13.108706 227.9170 279.4081
  [2,] 273.4301 11.182034 251.1638 295.1197
  [3,] 293.0772  9.531732 273.9614 311.8716
  [4,] 312.7243  8.323836 296.3329 329.2196
  [5,] 332.3714  7.767555 317.5875 347.8658
  [6,] 352.0185  7.999994 336.6166 367.8035
  [7,] 371.6657  8.959978 354.7932 389.5772
  [8,] 391.3128 10.448868 371.5893 412.3825
  [9,] 410.9599 12.275699 387.7395 435.2824
 [10,] 430.6070 14.311641 403.0804 458.7791
 [11,] 211.4541 13.392220 184.7134 237.3702
 [12,] 213.2419 11.430723 190.6683 236.0288
 [13,] 215.0297  9.737292 195.6638 234.4339
 [14,] 216.8176  8.474186 200.0444 233.4341
 [15,] 218.6054  7.851902 202.8533 233.7364
 [16,] 220.3932  8.020999 204.7568 236.1321
 [17,] 222.1811  8.936668 204.3586 239.9066
 [18,] 223.9689 10.403615 203.1545 244.1579
 [19,] 225.7567 12.224971 201.8988 249.6788
 [20,] 227.5445 14.265629 199.5179 255.6534
 [21,] 212.6567 13.372705 186.1620 238.6024
 [22,] 217.6426 11.456898 194.8634 239.7534
 [23,] 222.6286  9.821186 203.2339 241.7079
 [24,] 227.6145  8.626402 210.8035 244.6577
 [25,] 232.6004  8.070802 216.6057 248.6010
 [26,] 237.5864  8.284009 221.1732 253.7040
 [27,] 242.5723  9.212800 224.3813 260.6756
 [28,] 247.5582 10.671948 226.6213 268.3582
 [29,] 252.5442 12.476746 228.5866 277.1597
 [30,] 257.5301 14.498684 229.7601 285.9496
 [31,] 274.5099 13.127464 250.1356 300.9832
 [32,] 280.2262 11.248561 259.2459 303.3622
 [33,] 285.9425  9.658104 267.5687 305.3368
 [34,] 291.6588  8.519208 275.5916 308.5701
 [35,] 297.3750  8.026449 281.8666 313.4345
 [36,] 303.0913  8.295777 286.8955 320.0081
 [37,] 308.8076  9.260940 290.5787 327.3880
 [38,] 314.5239 10.735882 293.8825 335.6929
 [39,] 320.2401 12.542024 295.9185 345.0565
 [40,] 325.9564 14.556601 297.6872 354.3705
 [41,] 273.3837 13.030341 248.1804 299.3633
 [42,] 280.8376 11.208140 259.2582 303.0463
 [43,] 288.2915  9.687068 269.4619 307.3273
 [44,] 295.7454  8.627886 278.7878 312.5503
 [45,] 303.1994  8.211322 286.9037 319.5133
 [46,] 310.6533  8.532026 293.8771 327.7640
 [47,] 318.1072  9.515744 299.0232 337.0160
 [48,] 325.5611 10.985789 304.0749 347.7574
 [49,] 333.0151 12.775367 307.7585 358.7299
 [50,] 340.4690 14.768775 311.3207 369.7962
 [51,] 260.3197 11.893535 237.3124 284.0069
 [52,] 270.5611 10.292481 250.7570 290.9946
 [53,] 280.8025  8.991777 263.4314 298.5449
 [54,] 291.0438  8.136757 275.6556 307.3118
 [55,] 301.2852  7.873973 286.3204 317.0131
 [56,] 311.5266  8.260144 295.6229 327.5847
 [57,] 321.7680  9.214031 303.8964 340.0632
 [58,] 332.0094 10.583224 311.8126 353.1350
 [59,] 342.2507 12.229014 318.9062 366.5744
 [60,] 352.4921 14.054565 325.2419 380.2272
 [61,] 268.0533 12.313114 244.0376 292.9513
 [62,] 278.2764 10.584296 257.8613 299.7171
 [63,] 288.4995  9.140710 270.5968 306.7001
 [64,] 298.7226  8.135634 282.6802 314.7740
 [65,] 308.9458  7.741784 294.0371 323.8309
 [66,] 319.1689  8.049385 303.6615 334.8945
 [67,] 329.3920  8.986694 312.0357 347.0259
 [68,] 339.6151 10.384578 319.3299 359.8260
 [69,] 349.8383 12.084244 326.1574 373.5804
 [70,] 360.0614 13.976021 332.0729 387.2323
 [71,] 244.2468 12.045238 220.5828 267.1986
 [72,] 255.7550 10.369990 235.2485 275.6158
 [73,] 267.2632  8.996685 249.6824 284.7053
 [74,] 278.7713  8.080759 262.9070 294.3379
 [75,] 290.2795  7.785352 274.9548 305.3968
 [76,] 301.7876  8.177986 285.8674 317.3508
 [77,] 313.2958  9.170709 295.6615 330.9821
 [78,] 324.8040 10.596181 304.2961 345.5729
 [79,] 336.3121 12.304914 312.1058 360.5146
 [80,] 347.8203 14.194981 320.0130 375.3595
 [81,] 250.7510 13.085013 226.2638 277.1865
 [82,] 250.4934 11.137881 229.5539 272.8672
 [83,] 250.2357  9.481443 232.3743 268.9777
 [84,] 249.9781  8.291783 234.2914 265.9347
 [85,] 249.7204  7.785892 234.4071 264.9059
 [86,] 249.4627  8.093028 233.4049 265.3200
 [87,] 249.2051  9.131520 231.2792 267.0025
 [88,] 248.9474 10.690310 227.7216 269.9459
 [89,] 248.6897 12.577415 223.6831 273.4892
 [90,] 248.4321 14.666647 219.3602 276.9501
 [91,] 285.6982 13.144881 259.6903 310.7099
 [92,] 304.8689 11.212553 282.4295 326.4234
 [93,] 324.0397  9.555971 305.0935 342.3335
 [94,] 343.2105  8.341079 326.9169 359.3191
 [95,] 362.3813  7.777685 347.1126 377.4823
 [96,] 381.5521  8.004558 366.0902 397.2331
 [97,] 400.7228  8.961880 383.2212 418.5485
 [98,] 419.8936 10.450809 399.5130 440.6373
 [99,] 439.0644 12.279466 414.9421 463.1309
[100,] 458.2352 14.318273 430.1190 486.1826
[101,] 226.4651 12.930604 200.2362 251.2967
[102,] 238.0877 11.109761 215.5331 258.9743
[103,] 249.7104  9.568390 230.3630 268.1993
[104,] 261.3331  8.460637 244.6736 277.9374
[105,] 272.9557  7.969423 257.5470 288.6442
[106,] 284.5784  8.206219 268.5010 300.4757
[107,] 296.2010  9.114460 278.6340 313.6778
[108,] 307.8237 10.521680 287.5076 328.5212
[109,] 319.4464 12.257207 295.8610 343.7758
[110,] 331.0690 14.201180 303.9485 359.6350
[111,] 238.7180 12.895015 213.0586 263.9472
[112,] 255.7302 11.032449 233.5459 277.3934
[113,] 272.7424  9.455773 254.0232 291.1891
[114,] 289.7546  8.328958 273.3604 306.1816
[115,] 306.7668  7.848225 291.0990 322.0772
[116,] 323.7790  8.129017 307.7370 339.6203
[117,] 340.7912  9.101120 323.1942 358.5656
[118,] 357.8035 10.575588 337.3818 378.4507
[119,] 374.8157 12.374123 350.7487 398.9858
[120,] 391.8279 14.375603 363.9126 419.5747
[121,] 255.9529 12.498893 231.9763 281.0271
[122,] 263.3932 10.802124 242.9325 284.6921
[123,] 270.8336  9.391917 252.8457 289.3534
[124,] 278.2739  8.413622 262.0999 294.8449
[125,] 285.7142  8.026746 270.2470 301.4480
[126,] 293.1545  8.314262 276.9232 309.8760
[127,] 300.5948  9.213249 283.1421 318.8302
[128,] 308.0351 10.568806 288.1010 329.2752
[129,] 315.4754 12.230047 292.2681 340.1317
[130,] 322.9157 14.089256 296.0897 351.1041
[131,] 271.7707 12.499629 247.6083 296.9479
[132,] 285.8573 10.728842 265.1801 307.4808
[133,] 299.9439  9.243118 282.1496 318.5051
[134,] 314.0305  8.198919 298.0906 330.6961
[135,] 328.1171  7.776191 313.0946 343.3313
[136,] 342.2037  8.073157 326.5637 357.7208
[137,] 356.2903  9.019004 338.3055 374.4260
[138,] 370.3769 10.438814 349.3562 390.7758
[139,] 384.4634 12.167789 360.1676 408.2140
[140,] 398.5500 14.092594 370.8003 425.7511
[141,] 254.3986 12.409055 230.2983 278.7006
[142,] 265.8100 10.654239 244.9755 286.6518
[143,] 277.2214  9.189131 259.4583 295.1679
[144,] 288.6328  8.171083 272.6973 304.6389
[145,] 300.0442  7.777674 284.9674 315.6038
[146,] 311.4556  8.100431 296.0166 327.9209
[147,] 322.8671  9.063161 305.1046 340.7590
[148,] 334.2785 10.491137 313.5167 355.0301
[149,] 345.6899 12.222363 321.5023 369.9956
[150,] 357.1013 14.145937 329.5594 385.2988
[151,] 226.1473 13.417214 199.8301 252.1148
[152,] 241.3837 11.446610 218.9488 263.3898
[153,] 256.6201  9.757689 237.5553 275.6683
[154,] 271.8564  8.519648 255.3818 289.0500
[155,] 287.0928  7.946110 271.5904 302.9206
[156,] 302.3291  8.178095 286.5544 318.3574
[157,] 317.5655  9.154569 299.8639 335.7628
[158,] 332.8018 10.673114 311.5115 354.0488
[159,] 348.0382 12.538298 322.9260 372.7515
[160,] 363.2745 14.618029 334.5052 391.7979
[161,] 252.3060 12.340814 228.1384 277.0478
[162,] 261.7551 10.649533 240.9414 282.8994
[163,] 271.2041  9.257438 252.9889 289.4321
[164,] 280.6532  8.316159 264.3413 297.1180
[165,] 290.1022  7.986714 274.3392 305.7174
[166,] 299.5513  8.341908 282.7657 315.8841
[167,] 309.0004  9.303656 290.1463 326.4926
[168,] 318.4494 10.709778 296.3584 338.9894
[169,] 327.8985 12.410133 301.9179 351.7355
[170,] 337.3475 14.300148 307.7022 365.0531
[171,] 263.4479 12.139994 239.8638 287.1371
[172,] 275.2452 10.447261 254.8357 295.8953
[173,] 287.0424  9.048514 268.9148 304.8779
[174,] 298.8397  8.097560 282.5208 315.1009
[175,] 310.6370  7.760791 295.2974 325.9857
[176,] 322.4343  8.115036 306.6890 338.2827
[177,] 334.2316  9.079772 317.3242 351.8019
[178,] 346.0289 10.487861 326.1875 367.2989
[179,] 357.8261 12.186580 334.7636 382.2711
[180,] 369.6234 14.071061 342.8908 397.8096</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.2229522 13.108706  -29.8481393  21.6429793
  [2,]  -14.7253716 11.182034  -36.4149741   7.5408502
  [3,]  -42.2765910  9.531732  -61.0709637 -23.1608388
  [4,]    8.7154896  8.323836   -7.7798469  25.1069366
  [5,]   24.4804702  7.767555    8.9860930  39.2644129
  [6,]   62.6715508  7.999994   46.8866286  78.0734971
  [7,]   10.5381314  8.959978   -7.3733669  27.4106467
  [8,] -101.1641880 10.448868 -122.2339422 -81.4407346
  [9,]   19.6253926 12.275699   -4.6971432  42.8457735
 [10,]   35.7464732 14.311641    7.5743858  63.2730732
 [11,]   11.2798021 13.392220  -14.6362715  38.0204562
 [12,]   -7.9761236 11.430723  -30.7630254  14.5975215
 [13,]  -12.0519493  9.737292  -31.4561207   7.3140360
 [14,]  -12.1105751  8.474186  -28.7270959   4.6625703
 [15,]  -10.8893008  7.851902  -26.0203271   4.8627734
 [16,]   -4.4314266  8.020999  -20.1702735  11.2050015
 [17,]   -8.5507523  8.936668  -26.2762880   9.2716594
 [18,]   -6.2416780 10.403615  -26.4306907  14.5726698
 [19,]   -1.4610038 12.224971  -25.3831169  22.3969234
 [20,]    9.7696705 14.265629  -18.3392239  37.7962742
 [21,]  -13.6027819 13.372705  -39.5485018  12.8919329
 [22,]  -23.3104199 11.456898  -45.4211811  -0.5311671
 [23,]   11.6914420  9.821186   -7.3878675  31.0860775
 [24,]    5.2271039  8.626402  -11.8161063  22.0381495
 [25,]   -3.2930341  8.070802  -19.2935722  12.7016740
 [26,]  -17.1284722  8.284009  -33.2460789  -0.7153259
 [27,]   -7.1515103  9.212800  -25.2547997  11.0395210
 [28,]    8.1928516 10.671948  -12.6070734  29.1298044
 [29,]    8.4683136 12.476746  -16.1471847  32.4259318
 [30,]  -10.0148245 14.498684  -38.4343456  17.7551939
 [31,]   47.0326675 13.127464   20.5593940  71.4069527
 [32,]   20.1739915 11.248561   -2.9619869  41.1542724
 [33,]   -2.0859845  9.658104  -21.4803475  16.2877554
 [34,]   -6.5257604  8.519208  -23.4370725   9.5413981
 [35,]  -11.5777364  8.026449  -27.6372358   3.9307435
 [36,]   -5.5058124  8.295777  -22.4226453  10.6900202
 [37,]  -28.5679884  9.260940  -47.1484417 -10.3390593
 [38,]    3.7374356 10.735882  -17.4316317  24.3787965
 [39,]  -14.8906404 12.542024  -39.7069673   9.4310223
 [40,]   28.0922836 14.556601   -0.3218105  56.3615437
 [41,]   14.2242427 13.030341  -11.7554195  39.4274663
 [42,]    4.1624161 11.208140  -18.0462648  25.7418332
 [43,]   13.5290895  9.687068   -5.5066643  32.3587406
 [44,]   24.3698630  8.627886    7.5649840  41.3274957
 [45,]   13.0779364  8.211322   -3.2359558  29.3736462
 [46,]  -17.3345902  8.532026  -34.4452979  -0.5584157
 [47,]  -28.0322168  9.515744  -46.9409810  -8.9481859
 [48,]    9.2565567 10.985789  -12.9397370  30.7427674
 [49,]  -39.2681699 12.775367  -64.9830090 -14.0116222
 [50,]   31.1121035 14.768775    1.7848887  60.2604211
 [51,]  -25.4591010 11.893535  -49.1463496  -2.4518064
 [52,]  -27.7492795 10.292481  -48.1828439  -7.9451712
 [53,]   -7.8411580  8.991777  -25.5836239   9.5299406
 [54,]   18.7249635  8.136757    2.4570343  34.1131876
 [55,]   16.1776850  7.873973    0.4497650  31.1424614
 [56,]   -1.5289935  8.260144  -17.5870694  14.3746987
 [57,]  132.3939280  9.214031  114.0987306 150.2654783
 [58,]   14.8217496 10.583224   -6.3038599  35.0184819
 [59,]  -11.9504289 12.229014  -36.2740580  11.3941449
 [60,]  -98.6277074 14.054565 -126.3627510 -71.3774806
 [61,]   15.7891399 12.313114   -9.1089343  39.8047982
 [62,]   11.2786158 10.584296  -10.1621034  31.6937035
 [63,]  -11.7302083  9.140710  -29.9308459   6.1724901
 [64,]    1.0870676  8.135634  -14.9643228  17.1295029
 [65,]  -11.7747564  7.741784  -26.6598544   3.1338536
 [66,]   18.9976195  8.049385    3.2719744  34.5049709
 [67,]    2.6344954  8.986694  -14.9993862  19.9908312
 [68,]    9.2247713 10.384578  -10.9860736  29.5100046
 [69,]  -16.4782528 12.084244  -40.2204260   7.2025721
 [70,]    1.9814232 13.976021  -25.1895131  29.9698570
 [71,]   21.2262752 12.045238   -1.7254922  44.8903383
 [72,]   20.4462104 10.369990    0.5854353  40.9527003
 [73,]  -23.8984544  8.996685  -41.3405644  -6.3176624
 [74,]  -24.0990192  8.080759  -39.6656020  -8.2347021
 [75,]  -11.2550840  7.785352  -26.3724336   4.0695973
 [76,]  -17.5964487  8.177986  -33.1596265  -1.6762390
 [77,]   -7.7710135  9.170709  -25.4573370   9.8632745
 [78,]    6.7189217 10.596181  -14.0500007  27.2267815
 [79,]   -0.5652431 12.304914  -24.7677484  23.6410676
 [80,]   29.4786921 14.194981    1.9394760  57.2860158
 [81,]   -9.1427473 13.085013  -35.5782099  15.3444673
 [82,]   23.4538156 11.137881    1.0799938  44.3932663
 [83,]    4.2549785  9.481443  -14.4870063  22.1163839
 [84,]   20.8240414  8.291783    4.8673906  36.5107188
 [85,]    1.7315043  7.785892  -13.4540294  17.0447867
 [86,]    5.1734672  8.093028  -10.6837662  21.2313391
 [87,]   -3.7527699  9.131520  -21.5501837  14.1731172
 [88,]  -13.6364070 10.690310  -34.6348505   7.5894339
 [89,]  -12.9356441 12.577415  -37.7351003  12.0709566
 [90,]  -11.1854812 14.666647  -39.7035331  17.8864303
 [91,]   26.6684370 13.144881    1.6566751  52.6763069
 [92,]    8.9368568 11.212553  -12.6176248  31.3762910
 [93,]  -32.4285233  9.555971  -50.7222952 -13.4823444
 [94,]    2.9116965  8.341079  -13.1968974  19.2053405
 [95,]    3.3511163  7.777685  -11.7498521  18.6197961
 [96,]   10.2864361  8.004558   -5.3945975  25.7482643
 [97,]    3.5372559  8.961880  -14.2884040  21.0388916
 [98,]   -3.2013242 10.450809  -23.9449826  17.1793389
 [99,]   16.7998956 12.279466   -7.2666045  40.9221907
[100,]    0.6815154 14.318273  -27.2659162  28.7977041
[101,]    9.6381323 12.930604  -15.1934930  35.8670233
[102,]   -7.7710306 11.109761  -28.6576351  14.7836176
[103,]  -10.7847935  9.568390  -29.2737134   8.5626395
[104,]   -6.4110564  8.460637  -23.0154067  10.2483928
[105,]  -22.2454193  7.969423  -37.9338594  -6.8366612
[106,]  -14.8039822  8.206219  -30.7013480   1.2734265
[107,]  -14.6362451  9.114460  -32.1130367   2.9307554
[108,]    0.2782920 10.521680  -20.4191995  20.5943747
[109,]   16.8342291 12.257207   -7.4952375  40.4195850
[110,]   20.5760662 14.201180   -7.9898879  47.6965977
[111,]   17.5788051 12.895015   -7.6503586  43.2381521
[112,]  -12.2759032 11.032449  -33.9391142   9.9083955
[113,]  -16.5378115  9.455773  -34.9845391   2.1813605
[114,]  -34.2275199  8.328958  -50.6545446 -17.8332567
[115,]  -37.8503282  7.848225  -53.1606889 -22.1825184
[116,]    5.9456634  8.129017   -9.8955704  21.9876639
[117,]   38.6532551  9.101120   20.8789335  56.2502648
[118,]    5.1149467 10.575588  -15.5322763  25.5365740
[119,]   19.6715384 12.374123   -4.4985837  43.7384808
[120,]   -2.7751700 14.375603  -30.5219852  25.1400802
[121,]   -5.4264344 12.498893  -30.5005715  18.5501600
[122,]   36.6643570 10.802124   15.3655218  57.1251013
[123,]   -0.9396516  9.391917  -19.4594719  17.0482126
[124,]    2.3152398  8.413622  -14.2557703  18.4891895
[125,]  -13.8867688  8.026746  -29.6205772   1.5803918
[126,]   11.4791226  8.314262   -5.2424264  27.7104007
[127,]  -12.8481861  9.213249  -31.0836484   4.6044886
[128,]  -41.4395947 10.568806  -62.6797018 -21.5055140
[129,]    6.0663967 12.230047  -18.5899065  29.2737143
[130,]   24.6497881 14.089256   -3.5385705  51.4758031
[131,]  -50.0935902 12.499629  -75.2708057 -25.9312135
[132,]   12.3366153 10.728842   -9.2868678  33.0137678
[133,]   26.9346208  9.243118    8.3734239  44.7289369
[134,]   32.8250264  8.198919   16.1594288  48.7649084
[135,]   20.6231319  7.776191    5.4089025  35.6456223
[136,]   10.6250374  8.073157   -4.8921196  26.2650283
[137,]   -1.8636571  9.019004  -19.9993708  16.1210976
[138,]   -9.9442516 10.438814  -30.3431501  11.0763639
[139,]   -8.8228460 12.167789  -32.5734138  15.4730146
[140,]  -10.0083405 14.092594  -37.2094055  17.7413955
[141,]   17.5248825 12.409055   -6.7770890  41.6251604
[142,]    2.6268760 10.654239  -18.2148561  23.4614388
[143,]  -19.9790305  9.189131  -37.9254797  -2.2158596
[144,]  -10.9762370  8.171083  -26.9822668   4.9593375
[145,]   14.7779565  7.777674   -0.7816447  29.8547869
[146,]    5.7578501  8.100431  -10.7073602  21.1968926
[147,]  -24.7317564  9.063161  -42.6236656  -6.9693168
[148,]   13.8444371 10.491137   -6.9071725  34.6062416
[149,]   -5.4098694 12.222363  -29.7155553  18.7777275
[150,]    9.4118241 14.145937  -18.7856602  36.9536767
[151,]   -0.8833459 13.417214  -26.8507755  25.4339316
[152,]   -6.8601996 11.446610  -28.8662833  15.5747035
[153,]  -17.7192534  9.757689  -36.7674906   1.3455243
[154,]  -31.3834072  8.519648  -48.5770377 -14.9088029
[155,]  -19.5554609  7.946110  -35.3833292  -4.0531374
[156,]   41.8645853  8.178095   25.8362859  57.6392894
[157,]  -36.4173685  9.154569  -54.6147145 -18.7157781
[158,]   14.7836778 10.673114   -6.4632641  36.0739717
[159,]   17.1248240 12.538298   -7.5884778  42.2369534
[160,]    8.9542702 14.618029  -19.5691278  37.7236305
[161,]   17.5743715 12.340814   -7.1674283  41.7420010
[162,]   10.6877163 10.649533  -10.4566076  31.5013808
[163,]    6.6947611  9.257438  -11.5332308  24.9099624
[164,]    1.1363059  8.316159  -15.3285105  17.4482050
[165,]  -10.9317493  7.986714  -26.5469194   4.8312916
[166,]  -15.0393045  8.341908  -31.3720710   1.7462924
[167,]  -49.7345597  9.303656  -67.2267632 -30.8805424
[168,]  -13.8188149 10.709778  -34.3587876   8.2721643
[169,]   22.8822299 12.410133   -0.9548492  48.8627716
[170,]   32.1216747 14.300148    4.4161110  61.7669850
[171,]    5.9638270 12.139994  -17.7254060  29.5479179
[172,]   -1.7711566 10.447261  -22.4213237  18.6382797
[173,]   10.5543598  9.048514   -7.2810709  28.6820054
[174,]   11.7918762  8.097560   -4.4692917  28.1107569
[175,]  -23.4644074  7.760791  -38.8131058  -8.1247621
[176,]    7.1733090  8.115036   -8.6751083  22.9186091
[177,]    0.2502255  9.079772  -17.3201318  17.1575915
[178,]   -2.8089581 10.487861  -24.0789982  17.0324422
[179,]   11.3155583 12.186580  -13.1294152  34.3781246
[180,]   -5.4998253 14.071061  -33.6859541  21.2327735</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.6
p_loo        19.8  3.6
looic      1770.4 29.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   506       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   73        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.3 23.2
p_loo        35.3  9.3
looic      1724.6 46.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   615       
 (0.5, 0.7]   (ok)         5    2.8%   572       
   (0.7, 1]   (bad)        1    0.6%   20        
   (1, Inf)   (very bad)   2    1.1%   4         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -22.9      12.2  
fit_sleep1 -91.0      21.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.6
p_loo        19.8  3.6
looic      1770.4 29.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   506       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   73        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.3 23.2
p_loo        35.3  9.3
looic      1724.6 46.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   615       
 (0.5, 0.7]   (ok)         5    2.8%   572       
   (0.7, 1]   (bad)        1    0.6%   20        
   (1, Inf)   (very bad)   2    1.1%   4         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.3     23.2        35.3    9.3   1724.6
fit_sleep2  -22.9      12.2  -885.2     14.6        19.8    3.6   1770.4
fit_sleep1  -91.0      21.8  -953.3     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   46.5  
fit_sleep2   29.1  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
2.934513e-40 1.167120e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.96      1.57     0.34     5.47       0.04      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.04      1.57    -3.22     2.93       5.53      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0.1       tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
