<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.66      6.83    15.42    41.95 1.00     1831     2194
sd(Days)                6.54      1.51     4.10    10.04 1.00     1619     1817
cor(Intercept,Days)     0.08      0.30    -0.50     0.67 1.01      995     1803

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.05      7.19   236.28   264.64 1.00     2089     2563
Days         10.44      1.71     6.97    13.72 1.01     1331     1861

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.96      1.54    23.25    29.26 1.00     3360     2948

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.8232  13.10160 227.8897 279.4108
309 211.5890  13.22782 185.4256 237.2417
310 213.0597  13.02976 186.3959 238.1617
330 274.3354  13.62897 248.0178 301.8320
331 272.8988  13.02417 248.4676 298.7634
332 260.2763  12.16673 235.7152 284.0378
333 267.7926  12.75080 243.6091 293.7874
334 244.2657  12.51117 218.6916 267.9869
335 250.5436  13.53849 223.6965 276.7440
337 285.8257  12.93964 261.4263 311.6258
349 226.9328  13.12660 200.6129 250.7861
350 238.6464  13.34251 212.9470 264.1756
351 255.4550  12.47852 231.2635 279.6626
352 271.6134  12.33517 248.1122 296.1144
369 254.5111  12.34033 229.9826 278.6776
370 226.2990  13.76198 197.8230 252.1536
371 252.2931  12.37212 228.3224 277.3157
372 263.7122  12.55950 238.8805 289.0408

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6267388  2.530198 14.7449718 24.714569
309  1.7936014  2.476091 -3.0865903  6.669382
310  4.9293468  2.463335  0.1248119  9.914029
330  5.7879308  2.595761  0.6581162 10.857946
331  7.5566653  2.462208  2.7878007 12.365906
332 10.2200072  2.353169  5.6193974 14.959288
333 10.3324336  2.438735  5.3604848 15.063604
334 11.5648896  2.433837  6.8063901 16.416123
335 -0.1502158  2.605093 -5.3219348  4.812534
337 19.1831833  2.455754 14.4321822 23.997908
349 11.5567483  2.498433  6.8140913 16.537146
350 16.9711484  2.538245 12.0985917 22.123309
351  7.5393192  2.362396  2.8351968 12.224174
352 14.1343516  2.400919  9.3330959 18.916295
369 11.3809246  2.334102  6.7687548 15.911033
370 15.2046412  2.582118 10.3715927 20.419420
371  9.5003981  2.352149  4.8531432 14.034779
372 11.7408330  2.416298  7.0104957 16.384158</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.8232 13.101597 227.8897 279.4108
  [2,] 273.4499 11.165221 251.4651 295.4652
  [3,] 293.0767  9.511901 274.1317 312.0766
  [4,] 312.7034  8.312290 296.5652 329.1280
  [5,] 332.3302  7.779196 317.1175 347.9112
  [6,] 351.9569  8.046204 336.2225 368.0487
  [7,] 371.5836  9.042716 353.7935 389.8140
  [8,] 391.2104 10.564271 370.0050 412.5925
  [9,] 410.8371 12.419370 385.8523 435.8432
 [10,] 430.4639 14.480382 401.7629 459.6929
 [11,] 211.5890 13.227816 185.4256 237.2417
 [12,] 213.3826 11.340160 191.0483 235.6815
 [13,] 215.1762  9.720360 195.7843 234.3218
 [14,] 216.9698  8.522537 200.1502 233.4780
 [15,] 218.7634  7.940020 203.2884 234.2562
 [16,] 220.5570  8.106557 204.7294 236.6992
 [17,] 222.3506  8.980572 204.6144 240.1764
 [18,] 224.1442 10.384948 203.3526 244.7921
 [19,] 225.9378 12.136955 201.9268 249.7723
 [20,] 227.7314 14.107666 199.4365 255.1585
 [21,] 213.0597 13.029759 186.3959 238.1617
 [22,] 217.9890 11.166592 195.3143 239.4701
 [23,] 222.9184  9.578465 203.9641 241.2446
 [24,] 227.8477  8.422424 211.0094 244.0371
 [25,] 232.7771  7.890723 217.4081 248.1897
 [26,] 237.7064  8.107147 221.9538 253.5196
 [27,] 242.6358  9.017993 225.1184 260.1095
 [28,] 247.5651 10.443113 227.4941 268.2865
 [29,] 252.4945 12.203650 229.1932 276.3108
 [30,] 257.4238 14.175174 230.3327 285.2400
 [31,] 274.3354 13.628973 248.0178 301.8320
 [32,] 280.1233 11.676857 257.0634 303.4715
 [33,] 285.9113 10.021227 266.2680 305.9930
 [34,] 291.6992  8.830456 274.2166 309.3234
 [35,] 297.4871  8.306916 281.3119 313.6215
 [36,] 303.2750  8.573721 286.4337 320.3881
 [37,] 309.0630  9.564961 289.9475 328.0920
 [38,] 314.8509 11.088021 293.6727 336.7384
 [39,] 320.6388 12.956693 295.2558 346.2788
 [40,] 326.4268 15.042723 296.5535 356.2823
 [41,] 272.8988 13.024168 248.4676 298.7634
 [42,] 280.4555 11.180891 259.4434 302.4187
 [43,] 288.0122  9.618764 269.8853 306.4482
 [44,] 295.5688  8.494342 279.2585 312.0167
 [45,] 303.1255  7.994500 287.5583 318.6396
 [46,] 310.6822  8.233781 294.7473 326.6695
 [47,] 318.2388  9.154409 300.0652 335.9515
 [48,] 325.7955 10.579990 304.9277 346.8784
 [49,] 333.3522 12.336698 309.3741 358.2922
 [50,] 340.9088 14.303041 313.3000 369.6390
 [51,] 260.2763 12.166726 235.7152 284.0378
 [52,] 270.4963 10.497401 249.4297 291.2955
 [53,] 280.7163  9.134356 262.0849 298.6997
 [54,] 290.9363  8.231179 274.4743 306.9592
 [55,] 301.1564  7.946253 285.3920 316.2873
 [56,] 311.3764  8.343164 295.0608 327.6692
 [57,] 321.5964  9.335343 303.4453 339.6725
 [58,] 331.8164 10.759354 310.7735 353.2928
 [59,] 342.0364 12.468101 317.9616 367.0893
 [60,] 352.2564 14.360300 324.4854 381.2337
 [61,] 267.7926 12.750796 243.6091 293.7874
 [62,] 278.1251 10.969765 257.2223 300.3321
 [63,] 288.4575  9.485966 269.8192 307.6040
 [64,] 298.7899  8.457316 282.7176 315.9648
 [65,] 309.1224  8.060006 293.0808 325.3315
 [66,] 319.4548  8.384274 302.6140 335.6173
 [67,] 329.7872  9.355387 310.9569 348.0430
 [68,] 340.1197 10.800246 318.6106 361.2113
 [69,] 350.4521 12.556362 325.5289 375.2958
 [70,] 360.7845 14.511168 332.1166 389.3538
 [71,] 244.2657 12.511168 218.6916 267.9869
 [72,] 255.8306 10.728230 234.1577 276.0834
 [73,] 267.3955  9.247035 249.2001 284.8701
 [74,] 278.9604  8.232101 262.6971 294.5728
 [75,] 290.5253  7.866033 275.1867 305.8123
 [76,] 302.0902  8.235810 286.0403 318.2256
 [77,] 313.6551  9.253637 295.0770 331.6253
 [78,] 325.2200 10.736766 303.5399 345.9571
 [79,] 336.7849 12.520927 311.7736 361.1379
 [80,] 348.3497 14.495386 319.7723 376.2937
 [81,] 250.5436 13.538485 223.6965 276.7440
 [82,] 250.3934 11.516741 227.6269 272.7671
 [83,] 250.2432  9.775125 230.9763 269.5164
 [84,] 250.0930  8.487865 233.5794 266.7367
 [85,] 249.9428  7.880841 234.4981 265.7137
 [86,] 249.7926  8.108297 233.9465 265.7826
 [87,] 249.6423  9.107927 232.0327 267.1975
 [88,] 249.4921 10.664764 228.9214 269.6608
 [89,] 249.3419 12.573507 224.8196 273.4172
 [90,] 249.1917 14.697687 220.4403 277.8778
 [91,] 285.8257 12.939641 261.4263 311.6258
 [92,] 305.0088 11.122538 283.7416 327.0161
 [93,] 324.1920  9.594208 305.8775 343.2757
 [94,] 343.3752  8.511655 326.8390 360.3961
 [95,] 362.5584  8.056623 346.6314 378.3098
 [96,] 381.7416  8.332558 365.2133 397.4321
 [97,] 400.9248  9.274445 382.4400 418.2425
 [98,] 420.1079 10.707969 398.8043 440.2266
 [99,] 439.2911 12.464642 414.7966 462.5593
[100,] 458.4743 14.426901 430.1364 485.8530
[101,] 226.9328 13.126596 200.6129 250.7861
[102,] 238.4896 11.261929 215.9860 259.6055
[103,] 250.0463  9.687047 230.3417 268.4968
[104,] 261.6031  8.563355 244.5068 278.1678
[105,] 273.1598  8.081309 257.0875 289.2799
[106,] 284.7166  8.352747 268.4483 301.1806
[107,] 296.2733  9.312011 278.0273 314.6353
[108,] 307.8301 10.776969 286.4816 328.7321
[109,] 319.3868 12.572068 294.2448 344.2486
[110,] 330.9436 14.575838 301.8758 359.9530
[111,] 238.6464 13.342511 212.9470 264.1756
[112,] 255.6175 11.389842 233.6734 277.1641
[113,] 272.5887  9.711836 253.5793 291.4193
[114,] 289.5598  8.473276 272.8824 306.3144
[115,] 306.5310  7.884061 291.0924 322.1876
[116,] 323.5021  8.087386 307.6014 339.6682
[117,] 340.4732  9.029871 322.8056 358.4187
[118,] 357.4444 10.514595 336.9752 378.1812
[119,] 374.4155 12.347478 350.2208 398.7598
[120,] 391.3867 14.396149 363.2564 420.1336
[121,] 255.4550 12.478517 231.2635 279.6626
[122,] 262.9943 10.764627 242.1597 284.1783
[123,] 270.5337  9.338245 252.6761 288.9162
[124,] 278.0730  8.348070 262.5125 294.4137
[125,] 285.6123  7.958616 270.5531 301.4916
[126,] 293.1516  8.255344 277.4894 309.4083
[127,] 300.6909  9.171895 283.3417 318.9143
[128,] 308.2302 10.547912 287.8074 328.7963
[129,] 315.7696 12.229271 291.7955 340.2788
[130,] 323.3089 14.107216 295.3916 351.7874
[131,] 271.6134 12.335171 248.1122 296.1144
[132,] 285.7478 10.596129 265.5629 306.6067
[133,] 299.8821  9.161236 282.6032 317.9986
[134,] 314.0165  8.191910 298.2598 330.3585
[135,] 328.1508  7.862273 312.7971 343.5561
[136,] 342.2852  8.249370 326.4284 358.2489
[137,] 356.4195  9.263784 338.6556 374.0731
[138,] 370.5539 10.729032 349.7973 391.4765
[139,] 384.6882 12.487408 360.4548 408.8540
[140,] 398.8226 14.432166 371.0254 427.2970
[141,] 254.5111 12.340334 229.9826 278.6776
[142,] 265.8921 10.635516 245.0064 286.5937
[143,] 277.2730  9.210898 259.1109 295.2003
[144,] 288.6539  8.213594 272.4523 304.5661
[145,] 300.0348  7.809077 284.7407 315.5448
[146,] 311.4158  8.086798 295.2204 327.2663
[147,] 322.7967  8.983706 304.8795 340.4446
[148,] 334.1776 10.339909 313.2325 354.3934
[149,] 345.5585 12.000688 321.7854 368.7284
[150,] 356.9395 13.856961 329.8153 383.9255
[151,] 226.2990 13.761980 197.8230 252.1536
[152,] 241.5036 11.779691 217.6857 263.7962
[153,] 256.7082 10.072974 236.8240 276.1841
[154,] 271.9129  8.803589 254.7989 289.0576
[155,] 287.1175  8.177787 271.0408 303.0984
[156,] 302.3222  8.341697 286.1197 318.6295
[157,] 317.5268  9.253447 299.3053 335.2989
[158,] 332.7315 10.723960 311.5800 353.3845
[159,] 347.9361 12.558464 323.4424 371.8892
[160,] 363.1407 14.620581 334.9332 391.5486
[161,] 252.2931 12.372121 228.3224 277.3157
[162,] 261.7935 10.686153 241.2216 283.5797
[163,] 271.2939  9.294276 253.4037 290.3950
[164,] 280.7943  8.344966 264.6306 297.4935
[165,] 290.2947  7.997410 274.7617 305.9067
[166,] 299.7951  8.327297 283.5112 315.9804
[167,] 309.2955  9.262526 290.9849 327.1513
[168,] 318.7959 10.644723 297.9559 339.2043
[169,] 328.2963 12.324409 304.0375 351.9577
[170,] 337.7967 14.196379 310.1165 365.4597
[171,] 263.7122 12.559501 238.8805 289.0408
[172,] 275.4531 10.771397 254.1074 297.0575
[173,] 287.1939  9.272644 269.1020 305.6935
[174,] 298.9347  8.223008 282.7384 314.7955
[175,] 310.6756  7.805817 294.9313 325.6744
[176,] 322.4164  8.119155 306.1684 338.0361
[177,] 334.1572  9.087772 316.1428 351.6374
[178,] 345.8981 10.532402 325.2999 366.4446
[179,] 357.6389 12.286268 333.9010 381.8659
[180,] 369.3797 14.235529 341.7415 397.4369</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.2632102 13.101597  -29.8508298  21.6703425
  [2,]  -14.7452489 11.165221  -36.7605113   7.2396443
  [3,]  -42.2760877  9.511901  -61.2760445 -23.3311474
  [4,]    8.7363736  8.312290   -7.6881786  24.8745961
  [5,]   24.5217348  7.779196    8.9407389  39.7343756
  [6,]   62.7331961  8.046204   46.6414281  78.4675642
  [7,]   10.6201573  9.042716   -7.6102360  28.4102740
  [8,] -101.0617814 10.564271 -122.4438953 -79.8564452
  [9,]   19.7481798 12.419370   -5.2579005  44.7330306
 [10,]   35.8896411 14.480382    6.6605852  64.5905889
 [11,]   11.1448811 13.227816  -14.5078483  37.3082529
 [12,]   -8.1168203 11.340160  -30.4156531  14.2175496
 [13,]  -12.1984217  9.720360  -31.3440272   7.1934849
 [14,]  -12.2628232  8.522537  -28.7709867   4.5568343
 [15,]  -11.0473246  7.940020  -26.5400824   4.4276770
 [16,]   -4.5952260  8.106557  -20.7374186  11.2324396
 [17,]   -8.7203274  8.980572  -26.5460668   9.0159180
 [18,]   -6.4170288 10.384948  -27.0648889  14.3746181
 [19,]   -1.6421303 12.136955  -25.4766275  22.3688647
 [20,]    9.5827683 14.107666  -17.8442973  37.8776796
 [21,]  -14.0058015 13.029759  -39.1078417  12.6580348
 [22,]  -23.6568483 11.166592  -45.1378948  -0.9821037
 [23,]   11.4016049  9.578465   -6.9246158  30.3559283
 [24,]    4.9938580  8.422424  -11.1955025  21.8322232
 [25,]   -3.4696888  7.890723  -18.8822510  11.8992741
 [26,]  -17.2485356  8.107147  -33.0616515  -1.4958796
 [27,]   -7.2149824  9.017993  -24.6887258  10.3023907
 [28,]    8.1859708 10.443113  -12.5353931  28.2570400
 [29,]    8.5180240 12.203650  -15.2982624  31.8192526
 [30,]   -9.9085229 14.175174  -37.7246953  17.1826002
 [31,]   47.2072100 13.628973   19.7105530  73.5247800
 [32,]   20.2768792 11.676857   -3.0713055  43.3368408
 [33,]   -2.0547516 10.021227  -22.1364664  17.5884807
 [34,]   -6.5661823  8.830456  -24.1904141  10.9163985
 [35,]  -11.6898131  8.306916  -27.8242391   4.4854334
 [36,]   -5.6895439  8.573721  -22.8025738  11.1518379
 [37,]  -28.8233747  9.564961  -47.8523799  -9.7078799
 [38,]    3.4103945 11.088021  -18.4770584  24.5886223
 [39,]  -15.2893362 12.956693  -40.9292973  10.0936531
 [40,]   27.6219330 15.042723   -2.2335902  57.4951729
 [41,]   14.7090525 13.024168  -11.1554966  39.1403081
 [42,]    4.5444872 11.180891  -17.4187018  25.5565889
 [43,]   13.8084220  9.618764   -4.6276492  31.9352688
 [44,]   24.5464567  8.494342    8.0985822  40.8567786
 [45,]   13.1517914  7.994500   -2.3622872  28.7190358
 [46,]  -17.3634738  8.233781  -33.3508016  -1.4286013
 [47,]  -28.1638391  9.154409  -45.8764609  -9.9901600
 [48,]    9.0221956 10.579990  -12.0606971  29.8900106
 [49,]  -39.6052696 12.336698  -64.5452978 -15.6272308
 [50,]   30.6722651 14.303041    1.9420814  58.2810565
 [51,]  -25.4157221 12.166726  -49.1771698  -0.8546222
 [52,]  -27.6845293 10.497401  -48.4837391  -6.6179137
 [53,]   -7.7550365  9.134356  -25.7383757  10.8763823
 [54,]   18.8324562  8.231179    2.8095889  35.2944759
 [55,]   16.3065490  7.946253    1.1756318  32.0708865
 [56,]   -1.3787582  8.343164  -17.6716342  14.9367598
 [57,]  132.5655345  9.335343  114.4893639 150.7166212
 [58,]   15.0147273 10.759354   -6.4617419  36.0575509
 [59,]  -11.7360799 12.468101  -36.7890313  12.3387229
 [60,]  -98.3919871 14.360300 -127.3692728 -70.6209605
 [61,]   16.0497833 12.750796   -9.9450100  40.2333240
 [62,]   11.4299497 10.969765  -10.7770785  32.3326581
 [63,]  -11.6881840  9.485966  -30.8346604   6.9501172
 [64,]    1.0197824  8.457316  -16.1550541  17.0920900
 [65,]  -11.9513512  8.060006  -28.1604775   4.0901765
 [66,]   18.7117151  8.384274    2.5492328  35.5524993
 [67,]    2.2392815  9.355387  -16.0164805  21.0696197
 [68,]    8.7202478 10.800246  -12.3714408  30.2293191
 [69,]  -17.0920858 12.556362  -41.9358181   7.8310524
 [70,]    1.2582806 14.511168  -27.3110373  29.9262136
 [71,]   21.2073587 12.511168   -2.5137828  46.7814732
 [72,]   20.3705692 10.728230    0.1178023  42.0435486
 [73,]  -24.0308204  9.247035  -41.5054078  -5.8353565
 [74,]  -24.2881099  8.232101  -39.9004668  -8.0247612
 [75,]  -11.5008995  7.866033  -26.7879419   3.8377378
 [76,]  -17.8989890  8.235810  -34.0343800  -1.8490964
 [77,]   -8.1302786  9.253637  -26.1004845  10.4478262
 [78,]    6.3029318 10.736766  -14.4342356  27.9829599
 [79,]   -1.0379577 12.520927  -25.3909751  23.9732871
 [80,]   28.9492527 14.495386    1.0052526  57.5266611
 [81,]   -8.9353412 13.538485  -35.1356793  17.9117898
 [82,]   23.5537746 11.516741    1.1800932  46.3202938
 [83,]    4.2474904  9.775125  -15.0257281  23.5144135
 [84,]   20.7091062  8.487865    4.0654498  37.2226920
 [85,]    1.5091220  7.880841  -14.2618243  16.9537547
 [86,]    4.8436378  8.108297  -11.1464191  20.6897000
 [87,]   -4.1900465  9.107927  -21.7452097  13.4195898
 [88,]  -14.1811307 10.664764  -34.3498343   6.3896483
 [89,]  -13.5878149 12.573507  -37.6631373  10.9344608
 [90,]  -11.9450991 14.697687  -40.6312345  16.8062531
 [91,]   26.5409421 12.939641    0.7407621  50.9403459
 [92,]    8.7969588 11.122538  -13.2103275  30.0642351
 [93,]  -32.5808245  9.594208  -51.6645216 -14.2662868
 [94,]    2.7469922  8.511655  -14.2738977  19.2832175
 [95,]    3.1740090  8.056623  -12.5774297  19.1010240
 [96,]   10.0969257  8.332558   -5.5935510  26.6251689
 [97,]    3.3353424  9.274445  -13.9823812  21.8201182
 [98,]   -3.4156409 10.707969  -23.5343207  17.8880001
 [99,]   16.5731758 12.464642   -6.6950270  41.0677100
[100,]    0.4423925 14.426901  -26.9362578  28.7802881
[101,]    9.1703511 13.126596  -14.6829454  35.4903495
[102,]   -8.1728972 11.261929  -29.2888308  14.3307248
[103,]  -11.1207455  9.687047  -29.5711662   8.5839128
[104,]   -6.6810939  8.563355  -23.2458489  10.4152253
[105,]  -22.4495422  8.081309  -38.5695775  -6.3772489
[106,]  -14.9421905  8.352747  -31.4062342   1.3260576
[107,]  -14.7085388  9.312011  -33.0705000   3.5374646
[108,]    0.2719128 10.776969  -20.6300505  21.6203877
[109,]   16.8937645 12.572068   -7.9679592  42.0358280
[110,]   20.7015162 14.575838   -8.3079221  49.7693283
[111,]   17.6504408 13.342511   -7.8787737  43.3498053
[112,]  -12.1632076 11.389842  -33.7097962   9.7809396
[113,]  -16.3840561  9.711836  -35.2146571   2.6252690
[114,]  -34.0327045  8.473276  -50.7873468 -17.3552891
[115,]  -37.6144529  7.884061  -53.2710746 -22.1759301
[116,]    6.2225986  8.087386   -9.9435144  22.1233469
[117,]   38.9712502  9.029871   21.0258400  56.6388780
[118,]    5.4740018 10.514595  -15.2628035  25.9432349
[119,]   20.0716533 12.347478   -4.2726250  44.2664156
[120,]   -2.3339951 14.396149  -31.0808860  25.7963003
[121,]   -4.9285149 12.478517  -29.1361340  19.2630162
[122,]   37.0632659 10.764627   15.8793022  57.8979262
[123,]   -0.6397533  9.338245  -19.0222710  17.2178008
[124,]    2.5161275  8.348070  -13.8245576  18.0765984
[125,]  -13.7848918  7.958616  -29.6642410   1.2742934
[126,]   11.4819890  8.255344   -4.7746747  27.1442214
[127,]  -12.9443302  9.171895  -31.1677321   4.4048660
[128,]  -41.6347494 10.547912  -62.2008152 -21.2118957
[129,]    5.7722314 12.229271  -18.7370360  29.7462735
[130,]   24.2566122 14.107216   -4.2219430  52.1738890
[131,]  -49.9363198 12.335171  -74.4372609 -26.4350958
[132,]   12.4461286 10.596129   -8.4127879  32.6309783
[133,]   26.9963770  9.161236    8.8798726  44.2753454
[134,]   32.8390254  8.191910   16.4970030  48.5957090
[135,]   20.5893737  7.862273    5.1840813  35.9431067
[136,]   10.5435221  8.249370   -5.4201580  26.4002525
[137,]   -1.9929295  9.263784  -19.6465201  15.7710485
[138,]  -10.1212811 10.729032  -31.0438831  10.6352757
[139,]   -9.0476327 12.487408  -33.2133742  15.1857945
[140,]  -10.2808843 14.432166  -38.7552819  17.5163045
[141,]   17.4123647 12.340334   -6.7540616  41.9408562
[142,]    2.5448401 10.635516  -18.1567616  23.4304665
[143,]  -20.0305846  9.210898  -37.9579354  -1.8684662
[144,]  -10.9973092  8.213594  -26.9094942   5.2043256
[145,]   14.7873662  7.809077   -0.7226365  30.0814980
[146,]    5.7977416  8.086798  -10.0527562  21.9931171
[147,]  -24.6613831  8.983706  -42.3092860  -6.7441897
[148,]   13.9452923 10.339909   -6.2705066  34.8903639
[149,]   -5.2785323 12.000688  -28.4484320  18.4945805
[150,]    9.5736431 13.856961  -17.4123619  36.6978220
[151,]   -1.0349658 13.761980  -26.8896235  27.4410223
[152,]   -6.9801070 11.779691  -29.2727031  16.8378213
[153,]  -17.8074482 10.072974  -37.2833109   2.0768399
[154,]  -31.4398894  8.803589  -48.5845992 -14.3258682
[155,]  -19.5802306  8.177787  -35.5610905  -3.5035003
[156,]   41.8715282  8.341697   25.5642213  58.0739715
[157,]  -36.3787129  9.253447  -54.1508213 -18.1571976
[158,]   14.8540459 10.723960   -5.7990138  36.0055370
[159,]   17.2269047 12.558464   -6.7261683  41.7205948
[160,]    9.0880635 14.620581  -19.3197909  37.2955538
[161,]   17.5872932 12.372121   -7.4352705  41.5579933
[162,]   10.6492951 10.686153  -11.1369051  31.2212184
[163,]    6.6049969  9.294276  -12.4960581  24.4952313
[164,]    0.9951988  8.344966  -15.7040296  17.1589122
[165,]  -11.1241993  7.997410  -26.7362217   4.4087922
[166,]  -15.2830974  8.327297  -31.4684048   1.0008055
[167,]  -50.0296955  9.262526  -67.8855102 -31.7190961
[168,]  -14.1652936 10.644723  -34.5736609   6.6747066
[169,]   22.4844082 12.324409   -1.1769888  46.7431817
[170,]   31.6725101 14.196379    4.0095323  59.3526835
[171,]    5.6994802 12.559501  -19.6290844  30.5312182
[172,]   -1.9790527 10.771397  -23.5835251  19.3666056
[173,]   10.4029143  9.272644   -8.0966664  28.4948397
[174,]   11.6968813  8.223008   -4.1638619  27.8932006
[175,]  -23.5029517  7.805817  -38.5017840  -7.7587453
[176,]    7.1912153  8.119155   -8.4284771  23.4391959
[177,]    0.3245824  9.087772  -17.1555546  18.3390152
[178,]   -2.6781506 10.532402  -23.2246940  17.9199690
[179,]   11.5028164 12.286268  -12.7241980  35.2407323
[180,]   -5.2561166 14.235529  -33.3132735  22.3821029</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.5
p_loo        19.6  3.5
looic      1770.1 28.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1454      
 (0.5, 0.7]   (ok)         1    0.6%   536       
   (0.7, 1]   (bad)        1    0.6%   126       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.3
p_loo        34.2  8.5
looic      1723.2 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     175   97.2%   567       
 (0.5, 0.7]   (ok)         2    1.1%   1019      
   (0.7, 1]   (bad)        1    0.6%   18        
   (1, Inf)   (very bad)   2    1.1%   12        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.5      11.5  
fit_sleep1 -91.8      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.5
p_loo        19.6  3.5
looic      1770.1 28.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1454      
 (0.5, 0.7]   (ok)         1    0.6%   536       
   (0.7, 1]   (bad)        1    0.6%   126       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.3
p_loo        34.2  8.5
looic      1723.2 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     175   97.2%   567       
 (0.5, 0.7]   (ok)         2    1.1%   1019      
   (0.7, 1]   (bad)        1    0.6%   18        
   (1, Inf)   (very bad)   2    1.1%   12        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.6     22.3        34.2    8.5   1723.2
fit_sleep2  -23.5      11.5  -885.1     14.5        19.6    3.5   1770.1
fit_sleep1  -91.8      21.0  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.7  
fit_sleep2   28.9  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.374804e-40 6.422073e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.89      1.56     0.29     5.46       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.11      1.56    -3.32     2.84       5.37      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.3          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.3         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.3.1      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
