<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.73      6.86    15.60    42.70 1.00     1426     2352
sd(Days)                6.57      1.54     4.15    10.13 1.00     1493     2005
cor(Intercept,Days)     0.08      0.30    -0.45     0.65 1.00      967     1853

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.27      7.38   236.29   265.69 1.00     1826     2513
Days         10.43      1.73     6.92    13.78 1.00     1356     2018

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.95      1.60    23.09    29.30 1.00     3477     2377

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.8096  13.04624 226.6175 278.8170
309 211.4003  13.47494 185.2385 236.9649
310 213.0659  13.12019 187.1950 238.9806
330 274.4305  13.69534 248.8492 301.6067
331 273.0530  12.86285 248.0613 299.2949
332 260.1179  12.49760 235.2898 284.8737
333 267.8036  12.34440 244.8084 292.1018
334 244.5717  12.13308 220.6199 268.2111
335 250.6320  13.21964 224.9350 276.8267
337 285.5320  12.99419 260.7813 311.8329
349 226.7525  12.96244 200.5630 251.5607
350 238.7577  13.10083 212.3698 263.7828
351 255.7416  12.48519 231.5656 280.2999
352 271.3806  12.60581 246.5936 296.7003
369 254.4874  12.39674 230.5404 278.7329
370 226.4798  13.48902 199.4640 251.3007
371 252.4503  12.29855 229.1362 276.5717
372 263.3667  12.48426 239.2998 288.1552

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6437817  2.531563 14.72262088 24.727231
309  1.7557863  2.535684 -3.20454886  6.637665
310  4.9378097  2.453560  0.03192942  9.863966
330  5.7368925  2.598257  0.50933527 10.602135
331  7.5210851  2.455402  2.55072144 12.325032
332 10.3080654  2.343851  5.61833093 14.807427
333 10.3385622  2.364306  5.62161020 14.782911
334 11.4369757  2.318554  7.09562740 16.012808
335 -0.2264285  2.558308 -5.25239665  4.779737
337 19.2168165  2.482652 14.32220378 23.938194
349 11.5593177  2.450922  6.77182728 16.450327
350 17.0069994  2.509437 12.23425524 21.931034
351  7.4896962  2.386182  2.82183991 12.118598
352 14.1723842  2.397628  9.41232722 18.970776
369 11.3729566  2.375884  6.84756286 15.856319
370 15.1993832  2.568521 10.31510292 20.298753
371  9.4364513  2.355236  4.88672610 14.053267
372 11.7978143  2.384155  7.08403239 16.484468</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.8096 13.046237 226.6175 278.8170
  [2,] 273.4534 11.142693 250.3832 294.9421
  [3,] 293.0972  9.535856 273.8248 311.2319
  [4,] 312.7410  8.397804 296.3013 328.9742
  [5,] 332.3848  7.932924 316.8294 347.7995
  [6,] 352.0286  8.255730 335.8718 368.0993
  [7,] 371.6723  9.284423 353.7486 389.7777
  [8,] 391.3161 10.819499 370.1052 412.4330
  [9,] 410.9599 12.678337 386.0059 435.7093
 [10,] 430.6037 14.738945 401.6884 459.5796
 [11,] 211.4003 13.474942 185.2385 236.9649
 [12,] 213.1561 11.536018 190.6626 235.3099
 [13,] 214.9118  9.871411 195.5188 234.0027
 [14,] 216.6676  8.641133 199.6287 233.5813
 [15,] 218.4234  8.046925 202.5091 234.2584
 [16,] 220.1792  8.227770 204.4749 236.1230
 [17,] 221.9350  9.137768 204.5785 239.6432
 [18,] 223.6908 10.590599 203.4053 244.4412
 [19,] 225.4466 12.396861 201.3928 249.9458
 [20,] 227.2024 14.424386 198.9777 255.6015
 [21,] 213.0659 13.120187 187.1950 238.9806
 [22,] 218.0037 11.263491 195.9177 240.0670
 [23,] 222.9415  9.676419 204.0009 242.0205
 [24,] 227.8793  8.511159 210.9387 244.7477
 [25,] 232.8171  7.955281 216.9590 248.8086
 [26,] 237.7549  8.134683 221.8724 254.1498
 [27,] 242.6927  9.005530 225.1173 260.6414
 [28,] 247.6305 10.395478 227.0907 268.1698
 [29,] 252.5683 12.127336 228.8085 276.0264
 [30,] 257.5062 14.075457 230.1901 284.8590
 [31,] 274.4305 13.695336 248.8492 301.6067
 [32,] 280.1674 11.698603 258.2200 303.6591
 [33,] 285.9043  9.982700 267.2204 305.9950
 [34,] 291.6412  8.715110 275.1874 308.3139
 [35,] 297.3780  8.108876 281.6631 313.3431
 [36,] 303.1149  8.310023 286.9798 319.7229
 [37,] 308.8518  9.266121 290.8826 327.4202
 [38,] 314.5887 10.778097 293.5637 335.7556
 [39,] 320.3256 12.648148 295.4872 344.9626
 [40,] 326.0625 14.740617 297.1725 354.8150
 [41,] 273.0530 12.862847 248.0613 299.2949
 [42,] 280.5741 11.021184 258.8868 303.0911
 [43,] 288.0951  9.462461 269.2927 307.4041
 [44,] 295.6162  8.346726 279.2252 312.1738
 [45,] 303.1373  7.864827 287.4207 318.3295
 [46,] 310.6584  8.130262 294.6523 326.1823
 [47,] 318.1795  9.077710 300.0782 335.8497
 [48,] 325.7006 10.524566 304.9255 346.0332
 [49,] 333.2217 12.295777 309.4061 357.6105
 [50,] 340.7427 14.271082 312.9302 369.2003
 [51,] 260.1179 12.497601 235.2898 284.8737
 [52,] 270.4260 10.776105 249.1706 291.3589
 [53,] 280.7341  9.329851 262.3675 298.7472
 [54,] 291.0421  8.303919 274.6407 306.8521
 [55,] 301.3502  7.864561 285.5171 316.3309
 [56,] 311.6583  8.107702 295.2745 326.8580
 [57,] 321.9663  8.978064 304.0845 339.0047
 [58,] 332.2744 10.318125 311.9512 351.6007
 [59,] 342.5825 11.971176 318.8018 365.4233
 [60,] 352.8905 13.825400 325.6526 379.3571
 [61,] 267.8036 12.344403 244.8084 292.1018
 [62,] 278.1422 10.626454 258.1137 299.0511
 [63,] 288.4807  9.199927 270.8149 306.2003
 [64,] 298.8193  8.218009 283.0323 314.2586
 [65,] 309.1579  7.849367 293.9963 324.2396
 [66,] 319.4964  8.177368 303.5687 335.1530
 [67,] 329.8350  9.127214 312.0911 347.4518
 [68,] 340.1735 10.531979 319.5836 360.4509
 [69,] 350.5121 12.235973 326.3520 374.5030
 [70,] 360.8507 14.131361 332.6994 388.3796
 [71,] 244.5717 12.133084 220.6199 268.2111
 [72,] 256.0086 10.510051 235.1772 276.4561
 [73,] 267.4456  9.190321 249.3233 285.1358
 [74,] 278.8826  8.319508 262.4675 294.9229
 [75,] 290.3196  8.044739 274.5964 306.0851
 [76,] 301.7565  8.424536 285.0734 318.1074
 [77,] 313.1935  9.379722 295.0299 331.6503
 [78,] 324.6305 10.758110 303.6706 345.7276
 [79,] 336.0675 12.419585 311.7300 360.9579
 [80,] 347.5044 14.265574 319.5462 376.0310
 [81,] 250.6320 13.219635 224.9350 276.8267
 [82,] 250.4056 11.256462 228.7995 272.6013
 [83,] 250.1792  9.578465 231.6601 268.8066
 [84,] 249.9527  8.359182 233.7317 265.9571
 [85,] 249.7263  7.816312 234.3977 264.9440
 [86,] 249.4999  8.087239 233.8550 265.2844
 [87,] 249.2735  9.099561 231.4283 267.1194
 [88,] 249.0470 10.643800 227.9320 269.8774
 [89,] 248.8206 12.524729 223.6256 274.2013
 [90,] 248.5942 14.612907 219.4883 278.1258
 [91,] 285.5320 12.994186 260.7813 311.8329
 [92,] 304.7489 11.128617 283.2157 327.1786
 [93,] 323.9657  9.548323 305.6031 343.3583
 [94,] 343.1825  8.415577 326.2726 359.9389
 [95,] 362.3993  7.924679 346.4356 377.8045
 [96,] 381.6161  8.191840 365.4365 397.4773
 [97,] 400.8329  9.150905 382.8198 418.8400
 [98,] 420.0498 10.615979 399.0605 440.8523
 [99,] 439.2666 12.409112 414.6017 463.6401
[100,] 458.4834 14.408339 430.0733 486.7694
[101,] 226.7525 12.962437 200.5630 251.5607
[102,] 238.3118 11.123500 216.0171 259.7573
[103,] 249.8711  9.563145 230.9395 268.3987
[104,] 261.4304  8.437375 244.6701 277.9660
[105,] 272.9897  7.933402 257.7145 288.5900
[106,] 284.5491  8.167158 268.9199 301.0797
[107,] 296.1084  9.081857 278.5750 314.3703
[108,] 307.6677 10.501038 287.5729 328.7236
[109,] 319.2270 12.250613 295.4083 343.5927
[110,] 330.7863 14.209056 303.2099 358.9414
[111,] 238.7577 13.100831 212.3698 263.7828
[112,] 255.7647 11.194208 233.3510 277.0894
[113,] 272.7717  9.569920 253.8358 290.8581
[114,] 289.7787  8.393509 273.4588 305.7009
[115,] 306.7857  7.868493 292.0513 322.0901
[116,] 323.7927  8.122186 308.1057 339.8285
[117,] 340.7997  9.089620 322.6332 358.5616
[118,] 357.8067 10.576721 336.7003 378.5909
[119,] 374.8137 12.397879 350.0460 398.6166
[120,] 391.8207 14.427139 362.9989 419.6616
[121,] 255.7416 12.485188 231.5656 280.2999
[122,] 263.2313 10.752133 242.1677 284.5072
[123,] 270.7210  9.312602 252.6849 289.3027
[124,] 278.2107  8.320366 261.8480 294.5565
[125,] 285.7004  7.944818 269.7989 301.4133
[126,] 293.1901  8.270401 276.7414 309.4720
[127,] 300.6798  9.223158 282.1730 318.7091
[128,] 308.1695 10.635859 287.1297 329.2541
[129,] 315.6592 12.351684 291.0930 340.3248
[130,] 323.1489 14.261641 294.8249 351.9741
[131,] 271.3806 12.605809 246.5936 296.7003
[132,] 285.5530 10.808815 264.6147 307.3374
[133,] 299.7254  9.287184 281.6569 318.3933
[134,] 313.8977  8.195750 297.8192 330.3508
[135,] 328.0701  7.719203 312.5319 343.2715
[136,] 342.2425  7.968633 326.6415 358.0354
[137,] 356.4149  8.883094 339.5059 374.0992
[138,] 370.5873 10.286731 351.1082 391.2482
[139,] 384.7597 12.009228 361.3264 408.7061
[140,] 398.9320 13.932821 371.4004 427.0355
[141,] 254.4874 12.396737 230.5404 278.7329
[142,] 265.8604 10.666017 245.2654 286.9236
[143,] 277.2334  9.227047 259.4445 295.8034
[144,] 288.6063  8.234230 272.3711 305.1345
[145,] 299.9793  7.858519 284.2736 315.6329
[146,] 311.3522  8.185338 295.1096 327.5328
[147,] 322.7252  9.139630 304.4555 340.8688
[148,] 334.0981 10.552515 313.1242 354.9144
[149,] 345.4711 12.266538 321.1421 369.5004
[150,] 356.8441 14.172861 328.8952 384.5066
[151,] 226.4798 13.489017 199.4640 251.3007
[152,] 241.6792 11.512690 218.3468 263.0018
[153,] 256.8786  9.814535 236.9516 275.2301
[154,] 272.0780  8.561704 254.5735 288.4204
[155,] 287.2773  7.967123 271.0728 302.7936
[156,] 302.4767  8.175691 285.8366 318.4515
[157,] 317.6761  9.132547 299.5812 335.7208
[158,] 332.8755 10.637645 311.9608 353.7218
[159,] 348.0749 12.494407 324.1889 372.2722
[160,] 363.2743 14.568991 335.2905 391.5127
[161,] 252.4503 12.298551 229.1362 276.5717
[162,] 261.8868 10.594057 241.5708 282.9803
[163,] 271.3232  9.181940 253.6301 289.6230
[164,] 280.7597  8.214393 264.7701 297.2504
[165,] 290.1961  7.857401 274.9882 305.6387
[166,] 299.6326  8.191186 283.2385 315.2299
[167,] 309.0690  9.140382 290.6764 326.6980
[168,] 318.5055 10.540014 297.4739 338.9353
[169,] 327.9419 12.236482 303.2906 351.7003
[170,] 337.3784 14.123220 309.1447 364.8782
[171,] 263.3667 12.484260 239.2998 288.1552
[172,] 275.1645 10.725231 254.6441 296.3570
[173,] 286.9624  9.250556 269.1757 305.1175
[174,] 298.7602  8.214828 282.7127 315.0566
[175,] 310.5580  7.795024 295.1719 325.8510
[176,] 322.3558  8.087631 306.5971 338.2550
[177,] 334.1536  9.023610 316.6317 352.0670
[178,] 345.9514 10.431189 325.8141 366.6920
[179,] 357.7492 12.147520 334.1033 381.6502
[180,] 369.5471 14.059985 342.2603 397.2418</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.2496467 13.046237  -29.2569608  22.9425375
  [2,]  -14.7487284 11.142693  -36.2373559   8.3215296
  [3,]  -42.2966100  9.535856  -60.4312828 -23.0241918
  [4,]    8.6988083  8.397804   -7.5343770  25.1385315
  [5,]   24.4671266  7.932924    9.0524087  40.0224606
  [6,]   62.6615450  8.255730   46.5908355  78.8182774
  [7,]   10.5314633  9.284423   -7.5739437  28.4552403
  [8,] -101.1675184 10.819499 -122.2843642 -79.9565655
  [9,]   19.6254000 12.678337   -5.1239710  44.5793539
 [10,]   35.7498183 14.738945    6.7738643  64.6650785
 [11,]   11.3336259 13.474942  -14.2309518  37.4953651
 [12,]   -7.8902604 11.536018  -30.0441186  14.6032327
 [13,]  -11.9340466  9.871411  -31.0248928   7.4590342
 [14,]  -11.9606329  8.641133  -28.8743335   5.0783156
 [15,]  -10.7073192  8.046925  -26.5423223   5.2070189
 [16,]   -4.2174055  8.227770  -20.1612003  11.4868622
 [17,]   -8.3046917  9.137768  -26.0129316   9.0517691
 [18,]   -5.9635780 10.590599  -26.7139549  14.3218523
 [19,]   -1.1508643 12.396861  -25.6501165  22.9028529
 [20,]   10.1118494 14.424386  -18.2873346  38.3364601
 [21,]  -14.0119713 13.120187  -39.9267279  11.8588837
 [22,]  -23.6714810 11.263491  -45.7347857  -1.5854782
 [23,]   11.3785093  9.676419   -7.7004974  30.3190966
 [24,]    4.9622997  8.511159  -11.9061400  21.9029121
 [25,]   -3.5097100  7.955281  -19.5011534  12.3484334
 [26,]  -17.2970197  8.134683  -33.6918898  -1.4144783
 [27,]   -7.2719293  9.005530  -25.2205517  10.3034804
 [28,]    8.1205610 10.395478  -12.4187097  28.6604374
 [29,]    8.4441513 12.127336  -15.0138806  32.2040266
 [30,]   -9.9908583 14.075457  -37.3437241  17.3252157
 [31,]   47.1121204 13.695336   19.9359446  72.6934261
 [32,]   20.2328279 11.698603   -3.2588776  42.1801665
 [33,]   -2.0477646  9.982700  -22.1385212  16.6361289
 [34,]   -6.5081571  8.715110  -23.1809148   9.9456190
 [35,]  -11.5807496  8.108876  -27.5457598   4.1342212
 [36,]   -5.5294421  8.310023  -22.1374445  10.6057060
 [37,]  -28.6122346  9.266121  -47.1806223 -10.6429547
 [38,]    3.6725730 10.778097  -17.4942629  24.6976387
 [39,]  -14.9761195 12.648148  -39.6131294   9.8623370
 [40,]   27.9861880 14.740617   -0.7663362  56.8761646
 [41,]   14.5549230 12.862847  -11.6870051  39.5466357
 [42,]    4.4259380 11.021184  -18.0910897  26.1131663
 [43,]   13.7254529  9.462461   -5.5835067  32.5278949
 [44,]   24.4990678  8.346726    7.9414634  40.8900919
 [45,]   13.1399827  7.864827   -2.0521759  28.8566194
 [46,]  -17.3397023  8.130262  -32.8636262  -1.3336138
 [47,]  -28.1044874  9.077710  -45.7746781 -10.0031751
 [48,]    9.1171275 10.524566  -11.2154983  29.8921690
 [49,]  -39.4747576 12.295777  -63.8636074 -15.6592379
 [50,]   30.8383574 14.271082    2.3807529  58.6509132
 [51,]  -25.2573419 12.497601  -50.0131010  -0.4292489
 [52,]  -27.6142073 10.776105  -48.5471137  -6.3588322
 [53,]   -7.7727727  9.329851  -25.7858843  10.5938209
 [54,]   18.7266619  8.303919    2.9166668  35.1280786
 [55,]   16.1126966  7.864561    1.1319966  31.9458442
 [56,]   -1.6606688  8.107702  -16.8604206  14.7231272
 [57,]  132.1955658  8.978064  115.1572292 150.0773965
 [58,]   14.5567004 10.318125   -4.7696436  34.8798836
 [59,]  -12.2821649 11.971176  -35.1230082  11.4984729
 [60,]  -99.0261303 13.825400 -125.4926571 -71.7882031
 [61,]   16.0387902 12.344403   -8.2594135  39.0339932
 [62,]   11.4128280 10.626454   -9.4960585  31.4413473
 [63,]  -11.7114343  9.199927  -29.4309909   5.9543739
 [64,]    0.9904035  8.218009  -14.4489025  16.7774347
 [65,]  -11.9868587  7.849367  -27.0686096   3.1747123
 [66,]   18.6700790  8.177368    3.0135274  34.5977609
 [67,]    2.1915168  9.127214  -15.4252907  19.9353628
 [68,]    8.6663546 10.531979  -11.6109717  29.2563344
 [69,]  -17.1521077 12.235973  -41.1429514   7.0079863
 [70,]    1.1921301 14.131361  -26.3367956  29.3433818
 [71,]   20.9014485 12.133084   -2.7380401  44.8531777
 [72,]   20.1925728 10.510051   -0.2548516  41.0240155
 [73,]  -24.0809029  9.190321  -41.7711159  -5.9585653
 [74,]  -24.2102787  8.319508  -40.2505652  -7.7951541
 [75,]  -11.2951544  8.044739  -27.0607387   4.4279935
 [76,]  -17.5653302  8.424536  -33.9162173  -0.8821607
 [77,]   -7.6687059  9.379722  -26.1254760  10.4949322
 [78,]    6.8924183 10.758110  -14.2047238  27.8522666
 [79,]   -0.3205574 12.419585  -25.2110413  24.0168651
 [80,]   29.7945669 14.265574    1.2680000  57.7527940
 [81,]   -9.0237275 13.219635  -35.2184477  16.6733023
 [82,]   23.5416010 11.256462    1.3458587  45.1477452
 [83,]    4.3115295  9.578465  -14.3159249  22.8306439
 [84,]   20.8493580  8.359182    4.8449655  37.0704338
 [85,]    1.7255866  7.816312  -13.4920752  17.0541607
 [86,]    5.1363151  8.087239  -10.6482308  20.7812494
 [87,]   -3.8211564  9.099561  -21.6670747  14.0240194
 [88,]  -13.7360279 10.643800  -34.5663891   7.3789991
 [89,]  -13.0664994 12.524729  -38.4472018  12.1285182
 [90,]  -11.3475709 14.612907  -40.8792288  17.7582780
 [91,]   26.8345536 12.994186    0.5336530  51.5852523
 [92,]    9.0569371 11.128617  -13.3728285  30.5901146
 [93,]  -32.3544794  9.548323  -51.7471048 -13.9918688
 [94,]    2.9397042  8.415577  -13.8166945  19.8495996
 [95,]    3.3330877  7.924679  -12.0720562  19.2968256
 [96,]   10.2223712  8.191840   -5.6387508  26.4019543
 [97,]    3.4271548  9.150905  -14.5798823  21.4403462
 [98,]   -3.3574617 10.615979  -24.1600202  17.6318071
 [99,]   16.5977218 12.409112   -7.7757667  41.2626440
[100,]    0.4333054 14.408339  -27.8526578  28.8434063
[101,]    9.3507315 12.962437  -15.4574689  35.5402424
[102,]   -7.9950863 11.123500  -29.4405861  14.2995890
[103,]  -10.9455040  9.563145  -29.4731265   7.9860815
[104,]   -6.5084217  8.437375  -23.0440331  10.2518801
[105,]  -22.2794395  7.933402  -37.8797283  -7.0042009
[106,]  -14.7746572  8.167158  -31.3053076   0.8544536
[107,]  -14.5435750  9.081857  -32.8054811   2.9898347
[108,]    0.4343073 10.501038  -20.6215789  20.5291175
[109,]   17.0535896 12.250613   -7.3121079  40.8722928
[110,]   20.8587718 14.209056   -7.2963135  48.4351521
[111,]   17.5391138 13.100831   -7.4859642  43.9269575
[112,]  -12.3103856 11.194208  -33.6351435  10.1033198
[113,]  -16.5670851  9.569920  -34.6534588   2.3688322
[114,]  -34.2515845  8.393509  -50.1737521 -17.9316576
[115,]  -37.8691839  7.868493  -53.1735910 -23.1348340
[116,]    5.9320166  8.122186  -10.1037633  21.6189870
[117,]   38.6448172  9.089620   20.8828708  56.8113463
[118,]    5.1117178 10.576721  -15.6724959  26.2180960
[119,]   19.6735183 12.397879   -4.1294215  44.4411676
[120,]   -2.7679811 14.427139  -30.6089087  26.0537564
[121,]   -5.2151414 12.485188  -29.7734256  18.9608765
[122,]   36.8262624 10.752133   15.5503893  57.8898986
[123,]   -0.8271338  9.312602  -19.4087549  17.2090123
[124,]    2.3783700  8.320366  -13.9673773  18.7410741
[125,]  -13.8730262  7.944818  -29.5859144   2.0284646
[126,]   11.4434776  8.270401   -4.8384308  27.8921905
[127,]  -12.9332186  9.223158  -30.9625276   5.5735973
[128,]  -41.5740148 10.635859  -62.6585641 -20.5341637
[129,]    5.8825890 12.351684  -18.7830024  30.4487784
[130,]   24.4165928 14.261641   -4.4085569  52.7406480
[131,]  -49.7034849 12.605809  -75.0231709 -24.9164919
[132,]   12.6409309 10.808815   -9.1434947  33.5791957
[133,]   27.1531467  9.287184    8.4852424  45.2216094
[134,]   32.9577625  8.195750   16.5046926  49.0363201
[135,]   20.6700783  7.719203    5.4686909  36.2083040
[136,]   10.5861940  7.968633   -5.2067148  26.1872406
[137,]   -1.9882902  8.883094  -19.6725603  14.9207364
[138,]  -10.1546744 10.286731  -30.8155852   9.3244442
[139,]   -9.1190586 12.009228  -33.0654635  14.3141749
[140,]  -10.3903428 13.932821  -38.4937568  17.1412938
[141,]   17.4360522 12.396737   -6.8093669  41.3831010
[142,]    2.5764956 10.666017  -18.4866812  23.1714964
[143,]  -19.9909609  9.227047  -38.5609646  -2.2020850
[144,]  -10.9497175  8.234230  -27.4778796   5.2855136
[145,]   14.8429259  7.858519   -0.8106765  30.5486177
[146,]    5.8612693  8.185338  -10.3192834  22.1039170
[147,]  -24.5898872  9.139630  -42.7335190  -6.3202249
[148,]   14.0247562 10.552515   -6.7915053  34.9986710
[149,]   -5.1911004 12.266538  -29.2204468  19.1379273
[150,]    9.6690430 14.172861  -17.9935166  37.6179212
[151,]   -1.2158036 13.489017  -26.0366540  25.8000342
[152,]   -7.1556868 11.512690  -28.4782916  16.1766779
[153,]  -17.9777701  9.814535  -36.3293195   1.9491756
[154,]  -31.6049533  8.561704  -47.9474489 -14.1004501
[155,]  -19.7400366  7.967123  -35.2563251  -3.5355196
[156,]   41.7169802  8.175691   25.7422145  58.3570657
[157,]  -36.5280030  9.132547  -54.5727014 -18.4330990
[158,]   14.7100137 10.637645   -6.1362924  35.6246865
[159,]   17.0881305 12.494407   -7.1092287  40.9740525
[160,]    8.9545472 14.568991  -19.2838555  36.9382945
[161,]   17.4300747 12.298551   -6.6912851  40.7442367
[162,]   10.5560234 10.594057  -10.5375227  30.8720295
[163,]    6.5756721  9.181940  -11.7240972  24.2687617
[164,]    1.0298208  8.214393  -15.4609402  17.0193862
[165,]  -11.0256305  7.857401  -26.4681663   4.1822712
[166,]  -15.1205818  8.191186  -30.7178544   1.2734825
[167,]  -49.8032331  9.140382  -67.4322426 -31.4105851
[168,]  -13.8748845 10.540014  -34.3047120   7.1566968
[169,]   22.8387642 12.236482   -0.9196488  47.4900878
[170,]   32.0908129 14.123220    4.5910262  60.3244848
[171,]    6.0449728 12.484260  -18.7435406  30.1119050
[172,]   -1.6905415 10.725231  -22.8829880  18.8299488
[173,]   10.6344443  9.250556   -7.5207020  28.4211236
[174,]   11.8714300  8.214828   -4.4250076  27.9189183
[175,]  -23.3853842  7.795024  -38.6783793  -7.9992762
[176,]    7.2518015  8.087631   -8.6473637  23.0105219
[177,]    0.3281873  9.023610  -17.5851594  17.8501231
[178,]   -2.7315270 10.431189  -23.4721151  17.4058251
[179,]   11.3924588 12.147520  -12.5084755  35.0384280
[180,]   -5.4234555 14.059985  -33.1181820  21.8632778</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.7  3.4
looic      1770.5 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   602       
 (0.5, 0.7]   (ok)         2    1.1%   166       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.3
p_loo        34.0  8.3
looic      1722.3 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   824       
 (0.5, 0.7]   (ok)         5    2.8%   700       
   (0.7, 1]   (bad)        4    2.2%   12        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.1      11.5  
fit_sleep1 -92.1      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.7  3.4
looic      1770.5 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   602       
 (0.5, 0.7]   (ok)         2    1.1%   166       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.3
p_loo        34.0  8.3
looic      1722.3 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   824       
 (0.5, 0.7]   (ok)         5    2.8%   700       
   (0.7, 1]   (bad)        4    2.2%   12        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.2     22.3        34.0    8.3   1722.3
fit_sleep2  -24.1      11.5  -885.2     14.4        19.7    3.4   1770.5
fit_sleep1  -92.1      20.9  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   44.5  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
9.850386e-41 3.423083e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0      2.9      1.55     0.38     5.42       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0     -0.1      1.55    -3.12     2.98       5.27      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.1-0     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_5.0.0           compiler_4.2.2      
 [22] cli_3.6.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.5          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.20      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.1   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.4          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.12       yaml_2.3.7          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.20        V8_4.2.2            
 [88] RcppParallel_5.1.6   vctrs_0.5.2          nloptr_2.0.3        
 [91] httpuv_1.6.8         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
