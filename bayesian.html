<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.86      6.85    15.66    42.05 1.00     1556     2102
sd(Days)                6.59      1.50     4.09    10.00 1.00     1251     2000
cor(Intercept,Days)     0.08      0.31    -0.51     0.67 1.00      923     1536

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.33      7.46   236.83   266.26 1.00     2007     2737
Days         10.41      1.72     6.92    13.82 1.00     1601     1941

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.56    23.05    29.11 1.00     3900     3139

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.5600  13.40516 226.7513 279.1556
309 211.4638  13.40313 184.6067 238.2021
310 212.9534  13.23535 186.3155 238.3807
330 274.5272  13.80185 248.0303 301.8050
331 273.1689  13.28790 247.1783 299.1771
332 259.9520  12.29414 235.8071 284.6788
333 267.7078  12.55079 243.3820 292.8276
334 244.5529  11.99867 220.0109 267.4972
335 250.6460  13.49436 224.4318 277.4958
337 285.9620  13.06155 259.6939 311.8457
349 226.7697  13.18828 200.6433 251.9675
350 238.7189  13.39528 211.8126 264.9480
351 255.4855  12.33719 231.6465 280.4705
352 271.8630  12.63676 247.4483 296.1941
369 255.0039  12.06006 231.4573 278.7375
370 226.1727  13.33661 199.4589 250.8310
371 251.9570  12.10080 227.7417 275.6094
372 263.6923  12.25017 239.6279 287.5837

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.7368307  2.540295 14.9036185 24.858666
309  1.7568443  2.507234 -3.1901505  6.682389
310  4.9279757  2.458272  0.1629750  9.888256
330  5.7174345  2.586395  0.6261322 10.780833
331  7.4657280  2.539837  2.4992566 12.329100
332 10.3010078  2.356139  5.7110634 14.875939
333 10.3659410  2.382767  5.5866567 14.792554
334 11.4749279  2.315128  6.8926356 16.016570
335 -0.2328109  2.543314 -5.2420636  4.668976
337 19.1797583  2.513155 14.2325963 24.115060
349 11.5388373  2.491464  6.6977308 16.455160
350 16.9873173  2.559823 12.0471640 21.922190
351  7.5161757  2.364628  2.8239282 12.089157
352 14.1309358  2.390108  9.3605374 18.705612
369 11.2838407  2.298144  6.7862382 15.838029
370 15.1846399  2.524982 10.2032309 20.203774
371  9.4930142  2.348237  4.7592784 14.098463
372 11.7724761  2.311415  7.2278987 16.303348</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.5600 13.405164 226.7513 279.1556
  [2,] 273.2968 11.465113 250.3025 295.3100
  [3,] 293.0337  9.803336 273.1403 311.7595
  [4,] 312.7705  8.583016 295.5899 329.5613
  [5,] 332.5073  8.008566 316.7277 348.1081
  [6,] 352.2442  8.216587 335.6811 368.2063
  [7,] 371.9810  9.153888 353.9978 389.8547
  [8,] 391.7178 10.629262 370.9233 412.3839
  [9,] 411.4547 12.452910 386.8976 435.3809
 [10,] 431.1915 14.493961 402.5879 459.5079
 [11,] 211.4638 13.403127 184.6067 238.2021
 [12,] 213.2206 11.499934 190.2318 236.1583
 [13,] 214.9775  9.870441 195.0706 234.3054
 [14,] 216.7343  8.670361 199.2394 233.7567
 [15,] 218.4912  8.093032 202.5513 234.4310
 [16,] 220.2480  8.269923 204.2068 236.2108
 [17,] 222.0049  9.157429 204.1110 239.9494
 [18,] 223.7617 10.578178 203.1107 244.4618
 [19,] 225.5186 12.349479 201.3448 249.8821
 [20,] 227.2754 14.342032 198.8857 255.0085
 [21,] 212.9534 13.235348 186.3155 238.3807
 [22,] 217.8814 11.369469 195.1008 239.6699
 [23,] 222.8094  9.769411 203.6880 241.1873
 [24,] 227.7373  8.585113 211.0315 244.0511
 [25,] 232.6653  8.003320 217.1249 248.1614
 [26,] 237.5933  8.154036 221.8699 253.5217
 [27,] 242.5213  9.000538 224.6883 260.1990
 [28,] 247.4493 10.373873 226.7010 268.2524
 [29,] 252.3772 12.095909 228.6122 276.1652
 [30,] 257.3052 14.038910 229.5582 285.3758
 [31,] 274.5272 13.801851 248.0303 301.8050
 [32,] 280.2447 11.811003 257.7723 303.5220
 [33,] 285.9621 10.093929 266.5525 305.7465
 [34,] 291.6795  8.812143 274.5656 308.9586
 [35,] 297.3970  8.173079 281.5342 313.3148
 [36,] 303.1144  8.326071 286.5297 319.6444
 [37,] 308.8318  9.231824 290.8191 327.1703
 [38,] 314.5493 10.700867 293.8977 335.5819
 [39,] 320.2667 12.536723 296.1542 345.2565
 [40,] 325.9841 14.601684 297.4929 354.9579
 [41,] 273.1689 13.287897 247.1783 299.1771
 [42,] 280.6346 11.364116 258.5179 302.7201
 [43,] 288.1004  9.727260 269.3084 307.1733
 [44,] 295.5661  8.543862 278.9648 312.3678
 [45,] 303.0318  8.017300 287.4481 318.6920
 [46,] 310.4976  8.273946 294.4241 327.0480
 [47,] 317.9633  9.248827 299.7750 335.5755
 [48,] 325.4290 10.748253 304.3511 346.1246
 [49,] 332.8947 12.586129 308.4600 357.1367
 [50,] 340.3605 14.635501 311.8411 368.7222
 [51,] 259.9520 12.294143 235.8071 284.6788
 [52,] 270.2530 10.547344 249.7355 291.1419
 [53,] 280.5540  9.080185 262.7428 298.5645
 [54,] 290.8550  8.047102 274.6382 306.4049
 [55,] 301.1560  7.626580 285.4818 315.9605
 [56,] 311.4570  7.916841 295.2159 326.8283
 [57,] 321.7580  8.848210 303.8579 339.0529
 [58,] 332.0590 10.247343 311.4543 352.2287
 [59,] 342.3601 11.951069 318.4043 366.0637
 [60,] 352.6611 13.847414 324.9869 379.9918
 [61,] 267.7078 12.550792 243.3820 292.8276
 [62,] 278.0737 10.826752 257.0555 299.6186
 [63,] 288.4396  9.395206 270.3631 306.7947
 [64,] 298.8056  8.406925 282.5229 315.2607
 [65,] 309.1715  8.027330 293.6059 325.4891
 [66,] 319.5375  8.339953 303.4096 336.1532
 [67,] 329.9034  9.275062 312.3105 348.0801
 [68,] 340.2693 10.670233 319.8462 360.9056
 [69,] 350.6353 12.370777 326.6752 374.3114
 [70,] 361.0012 14.267919 333.3825 388.5598
 [71,] 244.5529 11.998666 220.0109 267.4972
 [72,] 256.0278 10.316991 235.3604 275.5248
 [73,] 267.5027  8.923691 249.6738 284.7206
 [74,] 278.9777  7.971440 263.1529 294.8920
 [75,] 290.4526  7.627259 275.4325 306.0490
 [76,] 301.9275  7.970317 286.2434 317.9339
 [77,] 313.4025  8.921685 295.7097 331.1829
 [78,] 324.8774 10.314388 304.5450 345.1381
 [79,] 336.3523 11.995681 312.3370 360.0581
 [80,] 347.8272 13.860945 319.7927 375.0273
 [81,] 250.6460 13.494361 224.4318 277.4958
 [82,] 250.4132 11.545128 228.1465 273.1430
 [83,] 250.1804  9.870110 231.1563 269.6990
 [84,] 249.9476  8.630473 233.3545 266.4601
 [85,] 249.7148  8.030439 233.7727 265.4143
 [86,] 249.4819  8.211440 233.1750 265.3981
 [87,] 249.2491  9.127125 231.3003 266.9431
 [88,] 249.0163 10.588578 228.0221 269.7324
 [89,] 248.7835 12.404373 224.0820 272.7951
 [90,] 248.5507 14.441462 219.7528 276.8072
 [91,] 285.9620 13.061552 259.6939 311.8457
 [92,] 305.1418 11.165719 282.5000 326.7505
 [93,] 324.3216  9.558992 305.1143 343.3146
 [94,] 343.5013  8.408760 326.7552 360.1958
 [95,] 362.6811  7.916569 347.2187 378.4643
 [96,] 381.8608  8.201754 365.6443 398.1749
 [97,] 401.0406  9.192245 383.0119 419.1474
 [98,] 420.2204 10.693824 398.8470 441.0458
 [99,] 439.4001 12.523987 414.7442 463.4867
[100,] 458.5799 14.559345 430.2798 486.1475
[101,] 226.7697 13.188281 200.6433 251.9675
[102,] 238.3085 11.310348 215.8381 260.3214
[103,] 249.8474  9.712464 230.5799 269.0119
[104,] 261.3862  8.553054 244.6498 278.3428
[105,] 272.9250  8.024481 257.7237 288.8085
[106,] 284.4639  8.248917 268.5500 300.7787
[107,] 296.0027  9.171246 277.9324 314.4187
[108,] 307.5416 10.611016 286.5475 328.3536
[109,] 319.0804 12.389122 294.3258 343.4471
[110,] 330.6192 14.380606 301.8479 358.7810
[111,] 238.7189 13.395284 211.8126 264.9480
[112,] 255.7062 11.424841 232.9963 278.1459
[113,] 272.6935  9.732714 253.5173 291.7374
[114,] 289.6809  8.487040 273.1708 306.1924
[115,] 306.6682  7.901858 291.2304 322.1106
[116,] 323.6555  8.121222 307.8703 339.3454
[117,] 340.6428  9.087053 323.0773 357.7097
[118,] 357.6301 10.597179 337.2424 377.5692
[119,] 374.6174 12.455170 351.0116 398.3075
[120,] 391.6048 14.528169 363.9666 419.0266
[121,] 255.4855 12.337185 231.6465 280.4705
[122,] 263.0016 10.610860 242.2883 284.1857
[123,] 270.5178  9.173739 252.7863 288.8492
[124,] 278.0340  8.179704 262.2520 294.6230
[125,] 285.5502  7.800037 270.5366 301.0145
[126,] 293.0663  8.121361 277.0224 309.2363
[127,] 300.5825  9.069475 282.6405 318.3918
[128,] 308.0987 10.475551 287.4429 328.9616
[129,] 315.6149 12.182032 291.6124 339.7700
[130,] 323.1311 14.080112 295.8449 351.1115
[131,] 271.8630 12.636765 247.4483 296.1941
[132,] 285.9940 10.881821 264.6767 306.6767
[133,] 300.1249  9.410923 281.6523 318.1839
[134,] 314.2558  8.375090 297.9374 330.2115
[135,] 328.3868  7.946321 312.9930 343.6325
[136,] 342.5177  8.220167 326.5374 358.2020
[137,] 356.6486  9.133646 338.6389 374.8285
[138,] 370.7796 10.521458 350.0548 392.0229
[139,] 384.9105 12.223088 360.7128 409.2505
[140,] 399.0414 14.125577 371.0124 426.6280
[141,] 255.0039 12.060061 231.4573 278.7375
[142,] 266.2878 10.392916 246.1448 286.8100
[143,] 277.5716  9.007956 260.3061 295.4844
[144,] 288.8554  8.052129 273.1177 304.5858
[145,] 300.1393  7.687212 284.8919 315.0124
[146,] 311.4231  7.994536 295.4179 326.6000
[147,] 322.7070  8.904770 304.9568 339.6478
[148,] 333.9908 10.258663 313.6614 353.7817
[149,] 345.2746 11.905812 321.8139 368.3425
[150,] 356.5585 13.741160 329.3549 383.0352
[151,] 226.1727 13.336607 199.4589 250.8310
[152,] 241.3573 11.420079 218.2757 262.9911
[153,] 256.5419  9.783783 236.8581 274.8785
[154,] 271.7266  8.589392 254.9260 288.4178
[155,] 286.9112  8.036416 271.3294 302.6525
[156,] 302.0959  8.254779 285.8895 318.2171
[157,] 317.2805  9.189659 299.4892 335.5497
[158,] 332.4651 10.654077 311.7766 353.6048
[159,] 347.6498 12.462743 322.9228 371.7338
[160,] 362.8344 14.487291 334.1543 391.3150
[161,] 251.9570 12.100797 227.7417 275.6094
[162,] 261.4500 10.396549 240.7518 281.6684
[163,] 270.9431  8.987525 252.8824 288.4017
[164,] 280.4361  8.030654 264.4014 295.8225
[165,] 289.9291  7.696470 274.7703 305.0575
[166,] 299.4221  8.062774 283.3475 315.0840
[167,] 308.9151  9.044856 290.7202 326.5588
[168,] 318.4081 10.470862 297.7864 338.5660
[169,] 327.9011 12.185931 303.6766 351.4368
[170,] 337.3942 14.084861 309.4248 364.3681
[171,] 263.6923 12.250171 239.6279 287.5837
[172,] 275.4648 10.552565 254.6463 296.3460
[173,] 287.2373  9.128628 269.1275 305.5065
[174,] 299.0097  8.123567 283.1475 315.1445
[175,] 310.7822  7.703125 295.4730 325.7734
[176,] 322.5547  7.960478 306.6867 338.1622
[177,] 334.3272  8.836603 316.5525 351.6542
[178,] 346.0996 10.172865 325.5105 365.6120
[179,] 357.8721 11.814149 333.9369 380.8604
[180,] 369.6446 13.650872 341.7101 396.1250</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.0000170 13.405164  -29.5955544  22.8087136
  [2,]  -14.5921477 11.465113  -36.6052909   8.4021746
  [3,]  -42.2330784  9.803336  -60.9588966 -22.3397250
  [4,]    8.6692909  8.583016   -8.1215009  25.8498886
  [5,]   24.3445602  8.008566    8.7437735  40.1242288
  [6,]   62.4459295  8.216587   46.4837890  79.0090005
  [7,]   10.2227987  9.153888   -7.6509028  28.2060103
  [8,] -101.5692320 10.629262 -122.2353101 -80.7746864
  [9,]   19.1306373 12.452910   -4.7956014  43.6876523
 [10,]   35.1620066 14.493961    6.8455647  63.7655675
 [11,]   11.2701039 13.403127  -15.4681504  38.1271996
 [12,]   -7.9548404 11.499934  -30.8924779  15.0340082
 [13,]  -11.9996846  9.870441  -31.3276104   7.9072432
 [14,]  -12.0273289  8.670361  -29.0496734   5.4675880
 [15,]  -10.7750732  8.093032  -26.7148734   5.1647890
 [16,]   -4.2862174  8.269923  -20.2490379  11.7549668
 [17,]   -8.3745617  9.157429  -26.3190648   9.5193428
 [18,]   -6.0345060 10.578178  -26.7346074  14.6165121
 [19,]   -1.2228503 12.349479  -25.5863591  22.9509401
 [20,]   10.0388055 14.342032  -17.6943399  38.4284695
 [21,]  -13.8995219 13.235348  -39.3268250  12.7384345
 [22,]  -23.5491976 11.369469  -45.3377259  -0.7686175
 [23,]   11.5106268  9.769411   -6.8672571  30.6319578
 [24,]    5.1042511  8.585113  -11.2094511  21.8101106
 [25,]   -3.3579246  8.003320  -18.8539721  12.1825063
 [26,]  -17.1354003  8.154036  -33.0638351  -1.4119691
 [27,]   -7.1004760  9.000538  -24.7782307  10.7324901
 [28,]    8.3018483 10.373873  -12.5012986  29.0501110
 [29,]    8.6352727 12.095909  -15.1526867  32.4003305
 [30,]   -9.7899030 14.038910  -37.8604960  17.9571482
 [31,]   47.0153690 13.801851   19.7376038  73.5122533
 [32,]   20.1555344 11.811003   -3.1217524  42.6279245
 [33,]   -2.1056001 10.093929  -21.8899923  17.3039648
 [34,]   -6.5465346  8.812143  -23.8255647  10.5673687
 [35,]  -11.5996692  8.173079  -27.5175455   4.2631480
 [36,]   -5.5289037  8.326071  -22.0589043  11.0558174
 [37,]  -28.5922383  9.231824  -46.9307381 -10.5795482
 [38,]    3.7120272 10.700867  -17.3205568  24.3636079
 [39,]  -14.9172074 12.536723  -39.9070038   9.1953230
 [40,]   28.0645581 14.601684   -0.9092085  56.5557671
 [41,]   14.4389791 13.287897  -11.5692464  40.4295767
 [42,]    4.3653511 11.364116  -17.7201092  26.4820866
 [43,]   13.7202230  9.727260   -5.3526806  32.5122087
 [44,]   24.5491950  8.543862    7.7474637  41.1505432
 [45,]   13.2454669  8.017300   -2.4147428  28.8291916
 [46,]  -17.1788611  8.273946  -33.7292846  -1.1053732
 [47,]  -27.8882892  9.248827  -45.5005082  -9.7000373
 [48,]    9.3886828 10.748253  -11.3068835  30.4665983
 [49,]  -39.1478453 12.586129  -63.3898014 -14.7131265
 [50,]   31.2206267 14.635501    2.8588570  59.7400107
 [51,]  -25.0913914 12.294143  -49.8182200  -0.9464832
 [52,]  -27.4411992 10.547344  -48.3301438  -6.9237303
 [53,]   -7.5927070  9.080185  -25.6031582  10.2184803
 [54,]   18.9137852  8.047102    3.3638930  35.1305965
 [55,]   16.3068774  7.626580    1.5023789  31.9810833
 [56,]   -1.4594303  7.916841  -16.8307131  14.7816808
 [57,]  132.4038619  8.848210  115.1090073 150.3039864
 [58,]   14.7720541 10.247343   -5.3975677  35.3768483
 [59,]  -12.0597537 11.951069  -35.7633631  11.8960066
 [60,]  -98.7966615 13.847414 -126.1274283 -71.1225458
 [61,]   16.1346484 12.550792   -8.9852180  40.4604426
 [62,]   11.4813074 10.826752  -10.0635653  32.4995151
 [63,]  -11.6703336  9.395206  -30.0254143   6.4062492
 [64,]    1.0041254  8.406925  -15.4510271  17.2868443
 [65,]  -12.0005156  8.027330  -28.3181260   3.5650772
 [66,]   18.6290434  8.339953    2.0133034  34.7569115
 [67,]    2.1231024  9.275062  -16.0536375  19.7159797
 [68,]    8.5705614 10.670233  -12.0657311  28.9936822
 [69,]  -17.2752796 12.370777  -40.9514106   6.6848338
 [70,]    1.0415794 14.267919  -26.5170250  28.6603435
 [71,]   20.9202076 11.998666   -2.0240586  45.4622233
 [72,]   20.1733797 10.316991    0.6763578  40.8408161
 [73,]  -24.1380482  8.923691  -41.3559158  -6.3091031
 [74,]  -24.3053761  7.971440  -40.2197204  -8.4806202
 [75,]  -11.4282041  7.627259  -27.0246465   3.5919324
 [76,]  -17.7363320  7.970317  -33.7426971  -2.0522496
 [77,]   -7.8776599  8.921685  -25.6580739   9.8150622
 [78,]    6.6455122 10.314388  -13.6151746  26.9778838
 [79,]   -0.6054157 11.995681  -24.3111608  23.4098958
 [80,]   29.4717564 13.860945    2.2717346  57.5062911
 [81,]   -9.0377006 13.494361  -35.8875476  17.1764921
 [82,]   23.5340103 11.545128    0.8041871  45.8007122
 [83,]    4.3103212  9.870110  -15.2082531  23.3343735
 [84,]   20.8545321  8.630473    4.3419694  37.4475730
 [85,]    1.7371430  8.030439  -13.9623996  17.6791892
 [86,]    5.1542539  8.211440  -10.7619411  21.4611601
 [87,]   -3.7968352  9.127125  -21.4908498  14.1519663
 [88,]  -13.7053242 10.588578  -34.4214101   7.2888958
 [89,]  -13.0294133 12.404373  -37.0410093  11.6720605
 [90,]  -11.3041024 14.441462  -39.5606431  17.4938130
 [91,]   26.4045517 13.061552    0.5209023  52.6727213
 [92,]    8.6639934 11.165719  -12.9446833  31.3058305
 [93,]  -32.7103649  9.558992  -51.7033722 -13.5030823
 [94,]    2.6208767  8.408760  -14.0736330  19.3669835
 [95,]    3.0513184  7.916569  -12.7319413  18.5137229
 [96,]    9.9776601  8.201754   -6.3363693  26.1942405
 [97,]    3.2195017  9.192245  -14.8872899  21.2481895
 [98,]   -3.5280566 10.693824  -24.3535466  17.8453074
 [99,]   16.4641851 12.523987   -7.6224392  41.1200800
[100,]    0.3368267 14.559345  -27.2308411  28.6369135
[101,]    9.3335042 13.188281  -15.8642723  35.4599173
[102,]   -7.9918332 11.310348  -30.0047142  14.4785684
[103,]  -10.9217705  9.712464  -30.0862851   8.3456783
[104,]   -6.4642079  8.553054  -23.4208133  10.2722070
[105,]  -22.2147452  8.024481  -38.0981934  -7.0134285
[106,]  -14.6894826  8.248917  -31.0043484   1.2243909
[107,]  -14.4379199  9.171246  -32.8538605   3.6323927
[108,]    0.5604427 10.611016  -20.2516285  21.5544877
[109,]   17.2002054 12.389122   -7.1665200  41.9547676
[110,]   21.0258680 14.380606   -7.1359477  49.7971685
[111,]   17.5779004 13.395284   -8.6511507  44.4841532
[112,]  -12.2519169 11.424841  -34.6916350  10.4579892
[113,]  -16.4889343  9.732714  -35.5328251   2.6872941
[114,]  -34.1537516  8.487040  -50.6653065 -17.6437149
[115,]  -37.7516689  7.901858  -53.1940891 -22.3139378
[116,]    6.0692138  8.121222   -9.6207049  21.8544078
[117,]   38.8016964  9.087053   21.7347887  56.3671924
[118,]    5.2882791 10.597179  -14.6508240  25.6760164
[119,]   19.8697618 12.455170   -3.8203433  43.4756217
[120,]   -2.5520555 14.528169  -29.9738857  25.0860507
[121,]   -4.9589706 12.337185  -29.9439544  18.8799517
[122,]   37.0559537 10.610860   15.8719465  57.7692721
[123,]   -0.6239220  9.173739  -18.9553188  17.1076344
[124,]    2.5551023  8.179704  -14.0339143  18.3370898
[125,]  -13.7227734  7.800037  -29.1871274   1.2907864
[126,]   11.5672509  8.121361   -4.6027031  27.6112393
[127,]  -12.8359248  9.069475  -30.6452267   5.1061214
[128,]  -41.5032005 10.475551  -62.3660753 -20.8474384
[129,]    5.9269238 12.182032  -18.2281854  29.9294099
[130,]   24.4344482 14.080112   -3.5460388  51.7206030
[131,]  -50.1859270 12.636765  -74.5170028 -25.7711665
[132,]   12.1999372 10.881821   -8.4828246  33.5171804
[133,]   26.7536015  9.410923    8.6946248  45.2261805
[134,]   32.5996657  8.375090   16.6440356  48.9181201
[135,]   20.3534300  7.946321    5.1076945  35.7472353
[136,]   10.3109942  8.220167   -5.3732585  26.2913109
[137,]   -2.2220416  9.133646  -20.4019077  15.7876870
[138,]  -10.3469773 10.521458  -31.5903246  10.3778198
[139,]   -9.2699131 12.223088  -33.6099003  14.9278183
[140,]  -10.4997489 14.125577  -38.0862963  17.5293398
[141,]   16.9195786 12.060061   -6.8140256  40.4662401
[142,]    2.1491379 10.392916  -18.3730674  22.2921476
[143,]  -20.3292028  9.007956  -38.2420170  -3.0637096
[144,]  -11.1988435  8.052129  -26.9292064   4.5389291
[145,]   14.6829158  7.687212   -0.1902238  29.9302751
[146,]    5.7903751  7.994536   -9.3865010  21.7956485
[147,]  -24.5716656  8.904770  -41.5125256  -6.8215128
[148,]   14.1320937 10.258663   -5.6587832  34.4614566
[149,]   -4.9946470 11.905812  -28.0624540  18.4661434
[150,]    9.9546124 13.741160  -16.5220951  37.1582291
[151,]   -0.9086665 13.336607  -25.5669627  25.8051499
[152,]   -6.8338065 11.420079  -28.4675791  16.2478034
[153,]  -17.6411464  9.783783  -35.9777458   2.0427221
[154,]  -31.2535863  8.589392  -47.9447768 -14.4530174
[155,]  -19.3739263  8.036416  -35.1151686  -3.7920694
[156,]   42.0978338  8.254779   25.9765565  58.3041805
[157,]  -36.1324061  9.189659  -54.4015676 -18.3410513
[158,]   15.1203539 10.654077   -6.0193439  35.8089156
[159,]   17.5132140 12.462743   -6.5707781  42.2401719
[160,]    9.3943740 14.487291  -19.0861658  38.0745112
[161,]   17.9233681 12.100797   -5.7289801  42.1386916
[162,]   10.9927540 10.396549   -9.2256209  31.6909548
[163,]    6.9558398  8.987525  -10.5027745  25.0164581
[164,]    1.3534256  8.030654  -14.0329705  17.3881482
[165,]  -10.7585885  7.696470  -25.8869818   4.4001600
[166,]  -14.9101027  8.062774  -30.5719939   1.1645043
[167,]  -49.6493169  9.044856  -67.2930265 -31.4544185
[168,]  -13.7775310 10.470862  -33.9354470   6.8441743
[169,]   22.8795548 12.185931   -0.6561200  47.1041440
[170,]   32.0750407 14.084861    5.1011447  60.0443979
[171,]    5.7193842 12.250171  -18.1720315  29.7837843
[172,]   -1.9907918 10.552565  -22.8719689  18.8276810
[173,]   10.3595321  9.128628   -7.9096936  28.4693277
[174,]   11.6218560  8.123567   -4.5128955  27.4841113
[175,]  -23.6096200  7.703125  -38.6007562  -8.3004442
[176,]    7.0529039  7.960478   -8.5545810  22.9209264
[177,]    0.1546278  8.836603  -17.1723735  17.9293216
[178,]   -2.8797483 10.172865  -22.3920702  17.7094080
[179,]   11.2695757 11.814149  -11.7187000  35.2048206
[180,]   -5.5210004 13.650872  -32.0014302  22.4135257</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.4
p_loo        19.8  3.5
looic      1770.6 28.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   577       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   87        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.1
p_loo        33.7  8.1
looic      1721.5 44.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   758       
 (0.5, 0.7]   (ok)         4    2.2%   360       
   (0.7, 1]   (bad)        2    1.1%   47        
   (1, Inf)   (very bad)   1    0.6%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.5      11.4  
fit_sleep1 -92.6      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.4
p_loo        19.8  3.5
looic      1770.6 28.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   577       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   87        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.1
p_loo        33.7  8.1
looic      1721.5 44.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   758       
 (0.5, 0.7]   (ok)         4    2.2%   360       
   (0.7, 1]   (bad)        2    1.1%   47        
   (1, Inf)   (very bad)   1    0.6%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.7     22.1        33.7    8.1   1721.5
fit_sleep2  -24.5      11.4  -885.3     14.4        19.8    3.5   1770.6
fit_sleep1  -92.6      20.8  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.2  
fit_sleep2   28.9  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.316882e-41 2.184195e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.96      1.52     0.38     5.35       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.04      1.52    -3.23     2.81       6.03      0.86
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.5-4.1     

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.32       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
