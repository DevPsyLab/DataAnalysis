<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.01      6.93    15.40    42.57 1.00     1851     2139
sd(Days)                6.61      1.57     4.17    10.31 1.00     1588     1975
cor(Intercept,Days)     0.08      0.29    -0.47     0.66 1.00     1086     1638

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.58      7.32   237.20   266.14 1.00     1827     2280
Days         10.50      1.73     7.21    13.98 1.00     1521     1654

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.93      1.57    23.04    29.30 1.00     3442     2960

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9862  12.93737 228.3096 278.9406
309 211.4063  13.51255 184.8085 237.2435
310 212.9990  12.94188 186.7703 237.3070
330 274.5549  13.15332 249.5502 300.8911
331 273.4038  12.85109 249.2959 298.9906
332 260.3667  12.27600 237.1965 284.4656
333 267.6932  12.48279 243.9095 292.8838
334 244.3124  12.38553 219.7938 268.3163
335 250.9820  13.48587 224.6463 277.4017
337 286.0856  12.86921 261.6562 312.0525
349 226.8626  12.74159 201.2652 251.0377
350 238.4540  13.24530 211.8454 263.2768
351 255.7226  12.45681 230.9127 280.3951
352 271.9714  12.55859 247.1216 296.6874
369 254.5695  12.21290 230.1930 278.0955
370 226.1809  13.49366 199.4132 252.2866
371 252.1852  12.32288 228.5278 276.6920
372 263.5398  12.70795 239.4813 288.8490

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6355876  2.499051 14.8587541 24.573735
309  1.7455060  2.533946 -3.2240864  6.731078
310  4.9389526  2.460433  0.3018202 10.013026
330  5.7420509  2.499199  0.8150895 10.553308
331  7.4008517  2.461020  2.4778666 12.122048
332 10.1661166  2.341756  5.4761949 14.608483
333 10.3331616  2.365704  5.4869619 14.891334
334 11.5200275  2.365808  6.8878204 16.148254
335 -0.2948749  2.601610 -5.4158004  4.688517
337 19.1659192  2.494564 14.3002149 24.030573
349 11.5303020  2.430158  6.8975743 16.314994
350 17.0445772  2.547705 12.2896329 22.212666
351  7.4717204  2.411233  2.7450667 12.224143
352 14.0982151  2.378748  9.4662613 18.842709
369 11.3274994  2.330788  6.8870831 16.054859
370 15.1985574  2.557697 10.3727284 20.206088
371  9.4962867  2.370378  4.8238282 14.139743
372 11.7740273  2.390145  7.0566737 16.312185</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9862 12.937370 228.3096 278.9406
  [2,] 273.6218 11.064776 251.4187 294.7636
  [3,] 293.2574  9.485436 274.4755 311.7490
  [4,] 312.8930  8.367092 296.5745 329.3853
  [5,] 332.5286  7.907810 317.5531 348.2310
  [6,] 352.1642  8.218833 336.4002 368.5048
  [7,] 371.7998  9.222552 353.8204 389.6896
  [8,] 391.4354 10.726240 370.4891 412.6357
  [9,] 411.0709 12.551474 386.7044 436.2288
 [10,] 430.7065 14.577973 401.8245 460.0469
 [11,] 211.4063 13.512546 184.8085 237.2435
 [12,] 213.1519 11.558425 190.4091 235.4383
 [13,] 214.8974  9.871538 195.7738 234.3564
 [14,] 216.6429  8.610406 200.3130 233.6704
 [15,] 218.3884  7.979517 203.4195 234.2723
 [16,] 220.1339  8.126995 204.7520 236.0773
 [17,] 221.8794  9.014720 204.5529 239.8334
 [18,] 223.6249 10.455816 203.1213 244.4204
 [19,] 225.3704 12.256621 201.2453 249.5788
 [20,] 227.1159 14.281708 198.9788 255.0513
 [21,] 212.9990 12.941884 186.7703 237.3070
 [22,] 217.9380 11.111563 195.3927 238.8001
 [23,] 222.8769  9.568111 203.2901 241.0149
 [24,] 227.8159  8.469836 211.0651 244.1845
 [25,] 232.7548  8.002185 217.1394 248.7127
 [26,] 237.6938  8.272804 221.6949 254.2360
 [27,] 242.6327  9.216890 224.6166 261.1774
 [28,] 247.5717 10.656936 227.1232 269.4494
 [29,] 252.5106 12.421634 228.2143 277.9441
 [30,] 257.4496 14.392052 229.2175 286.5625
 [31,] 274.5549 13.153322 249.5502 300.8911
 [32,] 280.2969 11.277934 258.8002 302.8252
 [33,] 286.0390  9.688432 267.3509 305.2142
 [34,] 291.7810  8.545853 275.4677 308.9743
 [35,] 297.5231  8.042979 281.7317 313.3814
 [36,] 303.2651  8.296951 286.8961 319.7776
 [37,] 309.0072  9.245608 291.0297 327.2776
 [38,] 314.7492 10.705846 293.8886 335.5777
 [39,] 320.4913 12.499640 296.4496 345.0516
 [40,] 326.2333 14.503753 298.0428 354.7073
 [41,] 273.4038 12.851086 249.2959 298.9906
 [42,] 280.8046 10.985240 260.4417 302.5666
 [43,] 288.2055  9.397544 270.2543 306.6819
 [44,] 295.6063  8.250176 279.6958 311.8546
 [45,] 303.0072  7.741461 287.7953 317.9142
 [46,] 310.4080  7.994265 294.5287 326.0430
 [47,] 317.8089  8.944247 299.8070 335.5306
 [48,] 325.2097 10.402120 304.4987 346.0319
 [49,] 332.6106 12.186955 308.3184 356.9721
 [50,] 340.0114 14.175785 311.9874 368.3463
 [51,] 260.3667 12.276001 237.1965 284.4656
 [52,] 270.5328 10.550260 250.1533 291.7545
 [53,] 280.6989  9.104033 262.9558 298.8847
 [54,] 290.8650  8.088664 274.8999 307.0002
 [55,] 301.0311  7.677056 285.7768 316.0296
 [56,] 311.1973  7.963388 295.6477 326.3138
 [57,] 321.3634  8.880403 303.6253 338.5748
 [58,] 331.5295 10.260371 311.0805 351.5897
 [59,] 341.6956 11.943889 317.9123 365.1187
 [60,] 351.8617 13.820471 323.9775 378.5799
 [61,] 267.6932 12.482791 243.9095 292.8838
 [62,] 278.0264 10.741714 257.7429 299.6544
 [63,] 288.3595  9.281265 271.2025 306.9262
 [64,] 298.6927  8.251815 282.9455 315.3932
 [65,] 309.0258  7.825351 294.0659 324.7784
 [66,] 319.3590  8.097709 303.8469 335.0654
 [67,] 329.6922  9.005708 312.0333 346.9005
 [68,] 340.0253 10.383919 319.5409 359.9308
 [69,] 350.3585 12.072360 326.7756 373.6349
 [70,] 360.6917 13.958907 332.6413 387.5508
 [71,] 244.3124 12.385533 219.7938 268.3163
 [72,] 255.8324 10.660566 234.6134 276.5971
 [73,] 267.3525  9.224316 249.0717 285.4980
 [74,] 278.8725  8.229365 262.3297 295.1482
 [75,] 290.3925  7.845443 274.5155 306.3691
 [76,] 301.9125  8.159265 285.8153 317.9601
 [77,] 313.4326  9.098919 295.6324 331.4212
 [78,] 324.9526 10.497674 304.3836 346.1255
 [79,] 336.4726 12.198610 312.3629 360.8728
 [80,] 347.9927 14.092732 320.3521 375.9530
 [81,] 250.9820 13.485866 224.6463 277.4017
 [82,] 250.6871 11.506634 227.9794 273.0460
 [83,] 250.3922  9.822088 230.9110 269.5876
 [84,] 250.0974  8.607030 233.1033 267.3133
 [85,] 249.8025  8.076214 234.0326 265.9407
 [86,] 249.5076  8.360997 233.2612 265.9596
 [87,] 249.2127  9.387441 231.1457 267.9050
 [88,] 248.9179 10.948907 227.5336 270.4188
 [89,] 248.6230 12.851842 223.7515 273.6630
 [90,] 248.3281 14.966558 219.1782 277.7163
 [91,] 286.0856 12.869205 261.6562 312.0525
 [92,] 305.2516 11.028661 284.3742 327.0505
 [93,] 324.4175  9.491678 306.1941 343.6891
 [94,] 343.5834  8.426047 327.3288 360.7751
 [95,] 362.7493  8.021861 347.0464 379.0522
 [96,] 381.9152  8.375437 365.1464 398.1432
 [97,] 401.0812  9.401667 381.8778 419.5730
 [98,] 420.2471 10.912397 398.2814 441.7653
 [99,] 439.4130 12.736373 414.0029 464.1892
[100,] 458.5789 14.757902 428.9625 487.0445
[101,] 226.8626 12.741589 201.2652 251.0377
[102,] 238.3929 10.929543 216.5060 259.1980
[103,] 249.9232  9.400695 231.2527 268.0320
[104,] 261.4535  8.312795 244.8111 277.2964
[105,] 272.9838  7.851331 257.7233 288.2359
[106,] 284.5141  8.123766 268.8708 300.5003
[107,] 296.0444  9.064165 278.1097 313.8835
[108,] 307.5747 10.494471 286.9862 327.8711
[109,] 319.1050 12.244187 295.3081 343.0287
[110,] 330.6353 14.195691 302.7985 358.4342
[111,] 238.4540 13.245297 211.8454 263.2768
[112,] 255.4986 11.281624 232.6697 276.5573
[113,] 272.5431  9.596550 253.3585 290.8397
[114,] 289.5877  8.360269 273.2289 305.7822
[115,] 306.6323  7.789481 291.4936 321.8679
[116,] 323.6769  8.027425 307.6867 339.4489
[117,] 340.7215  9.010254 322.9873 358.2575
[118,] 357.7660 10.531448 337.4792 378.5443
[119,] 374.8106 12.394342 351.2092 398.8112
[120,] 391.8552 14.467537 364.1506 420.0010
[121,] 255.7226 12.456812 230.9127 280.3951
[122,] 263.1944 10.675026 241.9025 284.1923
[123,] 270.6661  9.185221 252.6815 288.7796
[124,] 278.1378  8.149140 262.1112 294.3334
[125,] 285.6095  7.750920 270.3426 300.8544
[126,] 293.0812  8.085366 277.1932 308.9358
[127,] 300.5530  9.071804 282.6093 318.4116
[128,] 308.0247 10.528542 287.0189 328.4582
[129,] 315.4964 12.289461 291.2232 339.4861
[130,] 322.9681 14.242177 294.7347 351.1438
[131,] 271.9714 12.558590 247.1216 296.6874
[132,] 286.0696 10.837165 264.6987 307.5198
[133,] 300.1678  9.406753 281.8035 318.7805
[134,] 314.2660  8.417051 297.7578 330.9364
[135,] 328.3642  8.032643 312.3382 343.8597
[136,] 342.4624  8.337677 326.0020 358.8003
[137,] 356.5606  9.264299 338.5518 374.7882
[138,] 370.6589 10.651502 350.1296 391.5111
[139,] 384.7571 12.344984 361.0610 409.0625
[140,] 398.8553 14.235858 371.1429 426.9841
[141,] 254.5695 12.212904 230.1930 278.0955
[142,] 265.8970 10.542740 245.2046 286.2801
[143,] 277.2245  9.165636 258.8245 294.6593
[144,] 288.5520  8.230038 271.9348 304.3627
[145,] 299.8795  7.894513 284.0739 315.0396
[146,] 311.2070  8.232756 294.8787 326.5723
[147,] 322.5345  9.170516 304.3768 340.0591
[148,] 333.8620 10.549105 312.7225 354.1854
[149,] 345.1895 12.220229 320.8408 369.3793
[150,] 356.5170 14.080112 328.6863 384.9992
[151,] 226.1809 13.493662 199.4132 252.2866
[152,] 241.3794 11.535935 218.4157 263.1761
[153,] 256.5780  9.856992 237.0291 275.3580
[154,] 271.7765  8.621278 254.6474 288.6779
[155,] 286.9751  8.035932 271.4413 302.8919
[156,] 302.1736  8.240728 286.2901 318.4211
[157,] 317.3722  9.182952 299.7007 335.3230
[158,] 332.5708 10.668985 311.9276 353.2260
[159,] 347.7693 12.506459 323.5987 372.0738
[160,] 362.9679 14.562946 334.6403 390.5971
[161,] 252.1852 12.322877 228.5278 276.6920
[162,] 261.6815 10.622382 241.2307 282.9419
[163,] 271.1778  9.222476 253.5737 289.3159
[164,] 280.6741  8.277107 264.6888 296.6282
[165,] 290.1703  7.950115 274.8074 305.8273
[166,] 299.6666  8.314778 283.1481 316.4843
[167,] 309.1629  9.290001 290.1987 327.4845
[168,] 318.6592 10.710279 296.8235 339.8967
[169,] 328.1555 12.423905 303.0680 352.3960
[170,] 337.6518 14.325996 309.1490 365.9830
[171,] 263.5398 12.707952 239.4813 288.8490
[172,] 275.3138 10.894144 254.3429 296.7249
[173,] 287.0878  9.343356 269.0357 305.6134
[174,] 298.8618  8.206083 283.1443 315.5129
[175,] 310.6359  7.668565 295.9382 326.0587
[176,] 322.4099  7.854908 307.1956 338.2674
[177,] 334.1839  8.718821 317.0819 351.4746
[178,] 345.9579 10.087700 326.2232 366.1842
[179,] 357.7320 11.786906 334.2202 381.1754
[180,] 369.5060 13.694020 342.1284 396.5921</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.4262381 12.937370  -29.3805739  21.2504463
  [2,]  -14.9171257 11.064776  -36.0589090   7.2860013
  [3,]  -42.4568133  9.485436  -60.9483948 -23.6748549
  [4,]    8.5467991  8.367092   -7.9454945  24.8652584
  [5,]   24.3233115  7.907810    8.6208572  39.2988134
  [6,]   62.5259238  8.218833   46.1853378  78.2898664
  [7,]   10.4040362  9.222552   -7.4858476  28.3834377
  [8,] -101.2867514 10.726240 -122.4870517 -80.3405164
  [9,]   19.5143610 12.551474   -5.6434718  43.8808582
 [10,]   35.6469734 14.577973    6.3066041  64.5290278
 [11,]   11.3275558 13.512546  -14.5096458  37.9254351
 [12,]   -7.8860502 11.558425  -30.1725103  14.8566934
 [13,]  -11.9195562  9.871538  -31.3785630   7.2040419
 [14,]  -11.9358622  8.610406  -28.9633826   4.3939887
 [15,]  -10.6722682  7.979517  -26.5561870   4.2965830
 [16,]   -4.1720741  8.126995  -20.1154804  11.2098386
 [17,]   -8.2490801  9.014720  -26.2031234   9.0773789
 [18,]   -5.8976861 10.455816  -26.6932295  14.6059430
 [19,]   -1.0746921 12.256621  -25.2831344  23.0503987
 [20,]   10.1983020 14.281708  -17.7370675  38.3353922
 [21,]  -13.9451193 12.941884  -38.2531288  12.2836187
 [22,]  -23.6057719 11.111563  -44.4679433  -1.0605248
 [23,]   11.4430756  9.568111   -6.6948698  31.0299052
 [24,]    5.0257230  8.469836  -11.3428854  21.7765367
 [25,]   -3.4474296  8.002185  -19.4053087  12.1680014
 [26,]  -17.2358821  8.272804  -33.7780660  -1.2369966
 [27,]   -7.2119347  9.216890  -25.7566408  10.8041672
 [28,]    8.1794127 10.656936  -13.6982779  28.6279442
 [29,]    8.5018602 12.421634  -16.9315859  32.7981823
 [30,]   -9.9342924 14.392052  -39.0472383  18.2977711
 [31,]   46.9877272 13.153322   20.6515284  71.9923584
 [32,]   20.1032763 11.277934   -2.4249955  41.6000099
 [33,]   -2.1824746  9.688432  -21.3577253  16.5056268
 [34,]   -6.6480255  8.545853  -23.8412716   9.6652660
 [35,]  -11.7257764  8.042979  -27.5841488   4.0656199
 [36,]   -5.6796272  8.296951  -22.1920990  10.6894104
 [37,]  -28.7675781  9.245608  -47.0380218 -10.7901162
 [38,]    3.5120710 10.705846  -17.3164317  24.3727447
 [39,]  -15.1417799 12.499640  -39.7020583   8.8998694
 [40,]   27.8153692 14.503753   -0.6585966  56.0059120
 [41,]   14.2041286 12.851086  -11.3826700  38.3120467
 [42,]    4.1953769 10.985240  -17.5665615  24.5583285
 [43,]   13.6151252  9.397544   -4.8613497  31.5662993
 [44,]   24.5089735  8.250176    8.2606918  40.4194777
 [45,]   13.2701218  7.741461   -1.6368661  28.4819847
 [46,]  -17.0893299  7.994265  -32.7242645  -1.2100118
 [47,]  -27.7338817  8.944247  -45.4555574  -9.7320080
 [48,]    9.6079666 10.402120  -11.2142468  30.3189550
 [49,]  -38.8636851 12.186955  -63.2251864 -14.5714905
 [50,]   31.5696632 14.175785    3.2347972  59.5936588
 [51,]  -25.5060698 12.276001  -49.6050270  -2.3358818
 [52,]  -27.7209864 10.550260  -48.9426542  -7.3415497
 [53,]   -7.7376030  9.104033  -25.9233762  10.0055083
 [54,]   18.9037803  8.088664    2.7685568  34.8689296
 [55,]   16.4317637  7.677056    1.4332599  31.6861346
 [56,]   -1.1996529  7.963388  -16.3161702  14.3499097
 [57,]  132.7985305  8.880403  115.5870505 150.5365947
 [58,]   15.3016139 10.260371   -4.7586405  35.7506492
 [59,]  -11.3953028 11.943889  -34.8184449  12.3880397
 [60,]  -97.9973194 13.820471 -124.7154821 -70.1131065
 [61,]   16.1492035 12.482791   -9.0413853  39.9329303
 [62,]   11.5286419 10.741714  -10.0994272  31.8120863
 [63,]  -11.5902197  9.281265  -30.1568630   5.5668218
 [64,]    1.1170188  8.251815  -15.5834595  16.8641613
 [65,]  -11.8548428  7.825351  -27.6073702   3.1050869
 [66,]   18.8074956  8.097709    3.1011277  34.3195924
 [67,]    2.3343340  9.005708  -14.8739802  19.9931817
 [68,]    8.8145724 10.383919  -11.0909494  29.2990482
 [69,]  -16.9984891 12.072360  -40.2748961   6.5844026
 [70,]    1.3511493 13.958907  -25.5079575  29.4015223
 [71,]   21.1606878 12.385533   -2.8431889  45.6793125
 [72,]   20.3687603 10.660566   -0.3959089  41.5877519
 [73,]  -23.9877672  9.224316  -42.1332561  -5.7070142
 [74,]  -24.2001946  8.229365  -40.4759272  -7.6574401
 [75,]  -11.3681221  7.845443  -27.3446576   4.5089025
 [76,]  -17.7213496  8.159265  -33.7689090  -1.6241299
 [77,]   -7.9077770  9.098919  -25.8963676   9.8924158
 [78,]    6.5702955 10.497674  -14.6026297  27.1393094
 [79,]   -0.7257320 12.198610  -25.1258647  23.3839902
 [80,]   29.3063405 14.092732    1.3460186  56.9468741
 [81,]   -9.3736802 13.485866  -35.7934423  16.9619976
 [82,]   23.2600947 11.506634    0.9012452  45.9677734
 [83,]    4.0984695  9.822088  -15.0968849  23.5796660
 [84,]   20.7047444  8.607030    3.4888155  37.6988308
 [85,]    1.6494193  8.076214  -14.4887579  17.4193179
 [86,]    5.1285941  8.360997  -11.3234433  21.3750352
 [87,]   -3.7604310  9.387441  -22.4526945  14.3065664
 [88,]  -13.6068561 10.948907  -35.1077698   7.7774385
 [89,]  -12.8688813 12.851842  -37.9088738  12.0025577
 [90,]  -11.0815064 14.966558  -40.4697081  18.0683691
 [91,]   26.2809515 12.869205    0.3140539  50.7104195
 [92,]    8.5542323 11.028661  -13.2447297  29.4316082
 [93,]  -32.8062869  9.491678  -52.0779222 -14.5829176
 [94,]    2.5387939  8.426047  -14.6529426  18.7934361
 [95,]    2.9830747  8.021861  -13.3197740  18.6860052
 [96,]    9.9232555  8.375437   -6.3047196  26.6920625
 [97,]    3.1789363  9.401667  -15.3129438  22.3823479
 [98,]   -3.5547829 10.912397  -25.0730424  18.4108780
 [99,]   16.4512979 12.736373   -8.3249031  41.8614278
[100,]    0.3377787 14.757902  -28.1277549  29.9542212
[101,]    9.2406370 12.741589  -14.9345095  34.8379757
[102,]   -8.0761650 10.929543  -28.8812927  13.8107098
[103,]  -10.9975671  9.400695  -29.1063971   7.6728758
[104,]   -6.5314691  8.312795  -22.3743759  10.1109076
[105,]  -22.2734712  7.851331  -37.5256173  -7.0129871
[106,]  -14.7396732  8.123766  -30.7258872   0.9035826
[107,]  -14.4795752  9.064165  -32.3186560   3.4551049
[108,]    0.5273227 10.494471  -19.7691410  21.1157748
[109,]   17.1756207 12.244187   -6.7480722  40.9725199
[110,]   21.0098187 14.195691   -6.7890573  48.8466312
[111,]   17.8428118 13.245297   -6.9800222  44.4513853
[112,]  -12.0442654 11.281624  -33.1029511  10.7845886
[113,]  -16.3385426  9.596550  -34.6350945   2.8460842
[114,]  -34.0606197  8.360269  -50.2550970 -17.7017812
[115,]  -37.7157969  7.789481  -52.9513663 -22.5770935
[116,]    6.0478259  8.027425   -9.7241776  22.0379664
[117,]   38.7230487  9.010254   21.1869943  56.4571790
[118,]    5.1523715 10.531448  -15.6259108  25.4392176
[119,]   19.6765943 12.394342   -4.3239682  43.2780165
[120,]   -2.8024829 14.467537  -30.9483028  24.9021131
[121,]   -5.1961410 12.456812  -29.8686008  19.6137862
[122,]   36.8632386 10.675026   15.8653150  58.1551315
[123,]   -0.7721818  9.185221  -18.8856603  17.2123789
[124,]    2.4512978  8.149140  -13.7443063  18.4779227
[125,]  -13.7821226  7.750920  -29.0269688   1.4847898
[126,]   11.5523570  8.085366   -4.3021738  27.4403830
[127,]  -12.8063633  9.071804  -30.6649589   5.1372750
[128,]  -41.4291837 10.528542  -61.8627131 -20.4234030
[129,]    6.0453959 12.289461  -17.9443114  30.3185650
[130,]   24.5973755 14.242177   -3.5783352  52.8307653
[131,]  -50.2942563 12.558590  -75.0102964 -25.4445324
[132,]   12.1243285 10.837165   -9.3258583  33.4951929
[133,]   26.7107134  9.406753    8.0979966  45.0749942
[134,]   32.5894983  8.417051   15.9190548  49.0977077
[135,]   20.3759831  8.032643    4.8805103  36.4019808
[136,]   10.3662680  8.337677   -5.9716325  26.8267138
[137,]   -2.1340472  9.264299  -20.3615931  15.8747856
[138,]  -10.2262623 10.651502  -31.0784542  10.3029804
[139,]   -9.1164774 12.344984  -33.4218815  14.5795626
[140,]  -10.3135926 14.235858  -38.4423662  17.3988457
[141,]   17.3539596 12.212904   -6.1720197  41.7304545
[142,]    2.5398602 10.542740  -17.8431751  23.2322518
[143,]  -19.9821391  9.165636  -37.4169075  -1.5821146
[144,]  -10.8954385  8.230038  -26.7061030   5.7217759
[145,]   14.9426621  7.894513   -0.2173790  30.7482640
[146,]    6.0064628  8.232756   -9.3588085  22.3347571
[147,]  -24.3992366  9.170516  -41.9237561  -6.2415202
[148,]   14.2608641 10.549105   -6.0625213  35.4004191
[149,]   -4.9095353 12.220229  -29.0993185  19.4392365
[150,]    9.9960653 14.080112  -18.4861361  37.8267820
[151,]   -0.9168588 13.493662  -27.0226008  25.8507801
[152,]   -6.8559162 11.535935  -28.6525749  16.1078195
[153,]  -17.6771736  9.856992  -36.4572167   1.8716718
[154,]  -31.3035310  8.621278  -48.2049312 -14.1744314
[155,]  -19.4377884  8.035932  -35.3546136  -3.9040148
[156,]   42.0200543  8.240728   25.7725789  57.9035595
[157,]  -36.2241031  9.182952  -54.1748685 -18.5525552
[158,]   15.0147395 10.668985   -5.6405049  35.6579245
[159,]   17.3936821 12.506459   -6.9108329  41.5642535
[160,]    9.2609247 14.562946  -18.3682557  37.5884790
[161,]   17.6952034 12.322877   -6.8115998  41.3525844
[162,]   10.7613167 10.622382  -10.4990999  31.2120835
[163,]    6.7211300  9.222476  -11.4170165  24.3252162
[164,]    1.1154433  8.277107  -14.8387157  17.1007372
[165,]  -10.9998434  7.950115  -26.6568246   4.3631484
[166,]  -15.1546301  8.314778  -31.9722819   1.3638936
[167,]  -49.8971167  9.290001  -68.2186832 -30.9328729
[168,]  -14.0286034 10.710279  -35.2661079   7.8070871
[169,]   22.6252099 12.423905   -1.6152956  47.7126741
[170,]   31.8174232 14.325996    3.4861825  60.3201818
[171,]    5.8719444 12.707952  -19.4373214  29.9304196
[172,]   -1.8397829 10.894144  -23.2508946  19.1310992
[173,]   10.5089898  9.343356   -8.0166096  28.5611416
[174,]   11.7697625  8.206083   -4.8812562  27.4872544
[175,]  -23.4632648  7.668565  -38.8860790  -8.7656067
[176,]    7.1977079  7.854908   -8.6598383  22.4119755
[177,]    0.2978806  8.718821  -16.9928396  17.3998522
[178,]   -2.7380467 10.087700  -22.9642871  16.9966631
[179,]   11.4097260 11.786906  -12.0337393  34.9215056
[180,]   -5.3824013 13.694020  -32.4684890  21.9952424</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.4  3.4
looic      1769.9 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1521      
 (0.5, 0.7]   (ok)         2    1.1%   291       
   (0.7, 1]   (bad)        1    0.6%   71        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.4
p_loo        33.8  8.4
looic      1721.9 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   1001      
 (0.5, 0.7]   (ok)         3    1.7%   413       
   (0.7, 1]   (bad)        3    1.7%   11        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.0      11.6  
fit_sleep1 -92.3      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.4  3.4
looic      1769.9 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1521      
 (0.5, 0.7]   (ok)         2    1.1%   291       
   (0.7, 1]   (bad)        1    0.6%   71        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.4
p_loo        33.8  8.4
looic      1721.9 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   1001      
 (0.5, 0.7]   (ok)         3    1.7%   413       
   (0.7, 1]   (bad)        3    1.7%   11        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.0     22.4        33.8    8.4   1721.9
fit_sleep2  -24.0      11.6  -884.9     14.4        19.4    3.4   1769.9
fit_sleep1  -92.3      21.0  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   44.8  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.257111e-41 3.897195e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92       1.6     0.26     5.53       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08       1.6    -3.31     3.14       5.99      0.86
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0         tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
