<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">Jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.75      6.87    15.41    42.29 1.00     1245     1961
sd(Days)                6.63      1.59     4.18    10.39 1.00     1297     1689
cor(Intercept,Days)     0.09      0.31    -0.49     0.72 1.00      772     1034

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.12      7.45   236.72   266.33 1.00     1452     2099
Days         10.44      1.76     7.07    14.04 1.00     1211     1316

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.51    23.23    29.04 1.00     3271     3124

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9051  13.08761 227.2897 278.8942
309 211.7809  13.37279 185.9378 238.0956
310 213.0820  13.28518 186.5611 238.3094
330 274.2323  13.23792 249.1010 300.5478
331 273.0163  13.02447 248.2951 298.9169
332 260.2805  12.37638 236.2604 284.9430
333 267.8442  12.70432 244.1369 292.8762
334 244.4438  11.95787 221.0380 267.6191
335 250.7947  13.58823 224.6382 278.2920
337 285.8335  13.19309 259.5914 311.0464
349 226.6820  12.90512 199.9508 250.4841
350 238.7429  13.45291 212.1735 264.2176
351 255.5515  12.29343 231.7732 280.1233
352 271.6453  12.56143 248.3381 297.0082
369 254.6768  11.96731 230.7916 278.3317
370 226.3874  13.47574 199.7020 252.6432
371 252.0644  12.25577 228.7188 276.0773
372 263.4204  12.15688 239.2632 287.2553

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6275031  2.523415 14.78158545 24.774845
309  1.6888785  2.526537 -3.35716678  6.656460
310  4.9161262  2.470853  0.05228257  9.877993
330  5.8245922  2.523047  0.83461219 10.712360
331  7.4771229  2.431732  2.67122200 12.128707
332 10.1772080  2.363496  5.47924009 14.774724
333 10.2985273  2.448425  5.53338643 15.057674
334 11.5096448  2.298257  6.97979371 16.014999
335 -0.2386499  2.627378 -5.34030498  4.806482
337 19.2051051  2.515028 14.19088408 24.026389
349 11.5869823  2.434120  7.03570697 16.506321
350 17.0239452  2.549803 12.19898943 22.151437
351  7.5232628  2.385947  2.76898984 12.074728
352 14.1156868  2.384851  9.32583263 18.631042
369 11.3278052  2.302589  6.87753109 15.994587
370 15.1805730  2.558199 10.07805455 20.167453
371  9.4696052  2.328302  4.88589168 13.946097
372 11.7990668  2.364129  7.05958220 16.510060</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9051 13.087609 227.2897 278.8942
  [2,] 273.5326 11.158345 250.9192 295.2952
  [3,] 293.1601  9.511419 274.1189 311.7074
  [4,] 312.7876  8.316295 296.0448 329.2928
  [5,] 332.4151  7.783937 316.8740 347.5369
  [6,] 352.0426  8.046977 336.2708 367.7679
  [7,] 371.6702  9.036219 353.5539 389.4787
  [8,] 391.2977 10.549309 370.7236 411.7462
  [9,] 410.9252 12.395879 386.7524 435.0144
 [10,] 430.5527 14.448633 402.5673 458.9546
 [11,] 211.7809 13.372790 185.9378 238.0956
 [12,] 213.4697 11.435327 191.5139 235.9840
 [13,] 215.1586  9.770807 196.4763 234.5180
 [14,] 216.8475  8.540340 200.2113 233.9676
 [15,] 218.5364  7.948140 202.7923 234.3910
 [16,] 220.2252  8.134816 203.9359 236.2351
 [17,] 221.9141  9.052310 203.7497 239.5714
 [18,] 223.6030 10.510954 202.3202 243.5528
 [19,] 225.2919 12.320016 200.6242 249.2753
 [20,] 226.9808 14.347550 197.9332 254.5562
 [21,] 213.0820 13.285176 186.5611 238.3094
 [22,] 217.9981 11.423242 195.1629 240.2882
 [23,] 222.9143  9.833374 203.0784 242.3445
 [24,] 227.8304  8.666618 210.3718 244.8600
 [25,] 232.7465  8.107744 216.4480 248.5055
 [26,] 237.6627  8.280760 221.4306 253.8385
 [27,] 242.5788  9.144217 224.8521 260.0376
 [28,] 247.4949 10.529608 226.9415 267.5765
 [29,] 252.4110 12.261273 228.5299 275.5279
 [30,] 257.3272 14.213205 229.4225 284.4443
 [31,] 274.2323 13.237922 249.1010 300.5478
 [32,] 280.0569 11.319040 258.2236 302.3644
 [33,] 285.8815  9.681442 267.0776 305.0251
 [34,] 291.7060  8.489494 274.8223 308.4884
 [35,] 297.5306  7.946334 281.7933 313.4879
 [36,] 303.3552  8.182205 287.2072 319.7170
 [37,] 309.1798  9.136972 291.4932 327.6722
 [38,] 315.0044 10.618455 294.3186 336.0359
 [39,] 320.8290 12.439874 296.9777 345.7291
 [40,] 326.6536 14.473454 298.7174 355.3214
 [41,] 273.0163 13.024475 248.2951 298.9169
 [42,] 280.4935 11.199835 259.5052 302.7033
 [43,] 287.9706  9.646880 269.7237 307.3842
 [44,] 295.4477  8.515570 279.1998 312.6556
 [45,] 302.9248  7.987128 287.3351 318.7717
 [46,] 310.4020  8.179251 294.3646 326.6022
 [47,] 317.8791  9.046145 300.2399 335.9908
 [48,] 325.3562 10.420747 304.9714 346.0002
 [49,] 332.8333 12.131687 309.1652 356.6217
 [50,] 340.3104 14.056683 312.9846 367.5843
 [51,] 260.2805 12.376379 236.2604 284.9430
 [52,] 270.4578 10.612526 249.5595 291.9794
 [53,] 280.6350  9.124083 262.9670 298.9367
 [54,] 290.8122  8.065004 275.2112 306.7885
 [55,] 300.9894  7.616557 286.0224 316.2716
 [56,] 311.1666  7.883642 295.8588 326.3222
 [57,] 321.3438  8.801359 304.2784 338.3023
 [58,] 331.5210 10.195501 311.3720 351.1886
 [59,] 341.6982 11.899782 318.2678 364.9912
 [60,] 351.8754 13.799768 324.4296 378.7539
 [61,] 267.8442 12.704316 244.1369 292.8762
 [62,] 278.1427 10.888751 257.3338 299.7880
 [63,] 288.4412  9.365881 270.4588 306.8335
 [64,] 298.7398  8.298441 282.5303 314.9980
 [65,] 309.0383  7.873887 293.4646 324.1935
 [66,] 319.3368  8.192780 303.0184 335.1928
 [67,] 329.6353  9.177950 311.3435 347.3948
 [68,] 339.9339 10.646007 318.4478 361.1457
 [69,] 350.2324 12.426976 325.6807 374.7556
 [70,] 360.5309 14.405262 332.0285 389.0709
 [71,] 244.4438 11.957871 221.0380 267.6191
 [72,] 255.9534 10.325289 235.5212 276.1522
 [73,] 267.4631  8.988685 250.0921 285.0466
 [74,] 278.9727  8.096006 263.3991 295.1718
 [75,] 290.4824  7.801163 275.4722 306.3875
 [76,] 301.9920  8.169145 286.1173 318.3226
 [77,] 313.5017  9.120072 295.5781 331.4375
 [78,] 325.0113 10.496687 304.1687 345.5419
 [79,] 336.5210 12.155211 312.0754 360.3444
 [80,] 348.0306 13.995779 319.9169 375.4414
 [81,] 250.7947 13.588232 224.6382 278.2920
 [82,] 250.5560 11.539963 228.3236 273.7385
 [83,] 250.3174  9.772803 231.3346 269.9622
 [84,] 250.0787  8.464681 233.7240 266.7205
 [85,] 249.8401  7.848581 234.8127 264.9081
 [86,] 249.6014  8.084297 234.1206 265.3915
 [87,] 249.3628  9.105916 232.0183 267.2061
 [88,] 249.1241 10.690454 228.6454 270.1740
 [89,] 248.8855 12.627752 224.3709 273.4822
 [90,] 248.6469 14.779739 219.7250 277.3937
 [91,] 285.8335 13.193091 259.5914 311.0464
 [92,] 305.0386 11.264846 283.0649 326.7790
 [93,] 324.2437  9.611796 305.4069 342.8479
 [94,] 343.4489  8.398048 326.9492 360.0933
 [95,] 362.6540  7.830615 347.4250 377.9257
 [96,] 381.8591  8.047396 366.0769 397.4040
 [97,] 401.0642  8.991851 383.2688 418.5003
 [98,] 420.2693 10.468855 399.2382 440.5528
 [99,] 439.4744 12.287847 415.0813 463.4974
[100,] 458.6795 14.319085 430.2648 486.7199
[101,] 226.6820 12.905118 199.9508 250.4841
[102,] 238.2689 11.095220 215.5215 259.1524
[103,] 249.8559  9.566380 230.4522 268.3269
[104,] 261.4429  8.472144 244.6540 278.2838
[105,] 273.0299  7.993041 257.5051 289.1299
[106,] 284.6169  8.237115 268.7115 300.8240
[107,] 296.2039  9.146656 278.6427 314.1705
[108,] 307.7908 10.550944 287.3267 328.3308
[109,] 319.3778 12.281426 295.9100 343.3392
[110,] 330.9648 14.219504 303.8548 358.5085
[111,] 238.7429 13.452908 212.1735 264.2176
[112,] 255.7668 11.488725 233.4324 277.8215
[113,] 272.7908  9.798155 253.4658 291.6890
[114,] 289.8147  8.545166 272.9362 306.4878
[115,] 306.8387  7.939703 291.3943 322.7414
[116,] 323.8626  8.127785 308.4756 340.0440
[117,] 340.8866  9.060126 323.7477 358.9147
[118,] 357.9105 10.541057 337.7977 378.4904
[119,] 374.9345 12.375171 351.4075 399.2453
[120,] 391.9584 14.428404 364.6990 420.4378
[121,] 255.5515 12.293434 231.7732 280.1233
[122,] 263.0747 10.578992 242.4596 284.3625
[123,] 270.5980  9.169902 252.5158 288.8765
[124,] 278.1212  8.224634 262.3350 294.3137
[125,] 285.6445  7.911232 269.8947 301.5859
[126,] 293.1678  8.301570 276.5531 309.7851
[127,] 300.6910  9.307524 282.0805 319.0562
[128,] 308.2143 10.757762 286.4737 329.2934
[129,] 315.7376 12.498574 290.6540 340.2848
[130,] 323.2608 14.425143 294.6148 351.4703
[131,] 271.6453 12.561426 248.3381 297.0082
[132,] 285.7609 10.789941 265.4625 307.3642
[133,] 299.8766  9.296842 282.3932 318.9829
[134,] 313.9923  8.234969 298.3246 330.4162
[135,] 328.1080  7.782879 312.5346 343.3061
[136,] 342.2237  8.044049 326.2471 357.8197
[137,] 356.3394  8.956297 338.6569 373.5012
[138,] 370.4551 10.348856 350.2032 390.5948
[139,] 384.5708 12.056427 361.0628 408.1789
[140,] 398.6864 13.963920 371.4472 425.9969
[141,] 254.6768 11.967307 230.7916 278.3317
[142,] 266.0046 10.343334 245.5524 286.2162
[143,] 277.3324  9.019784 259.6413 294.9848
[144,] 288.6602  8.144463 273.0267 304.6226
[145,] 299.9880  7.868411 284.8790 315.6861
[146,] 311.3158  8.251989 295.4396 327.4662
[147,] 322.6436  9.213175 304.9522 340.5905
[148,] 333.9714 10.595928 313.4402 354.6617
[149,] 345.2992 12.258410 321.5215 369.7334
[150,] 356.6270 14.102034 329.5410 385.2341
[151,] 226.3874 13.475738 199.7020 252.6432
[152,] 241.5680 11.495642 218.9987 263.9292
[153,] 256.7486  9.787380 237.6953 275.8807
[154,] 271.9291  8.516137 255.2602 288.6714
[155,] 287.1097  7.895894 271.4650 302.7024
[156,] 302.2903  8.078023 286.4153 318.3082
[157,] 317.4709  9.014019 299.5469 335.3284
[158,] 332.6514 10.504255 312.0866 353.5619
[159,] 347.8320 12.349696 323.6188 372.3177
[160,] 363.0126 14.414554 334.7931 391.3459
[161,] 252.0644 12.255765 228.7188 276.0773
[162,] 261.5340 10.563649 241.4211 282.0709
[163,] 271.0037  9.155303 253.4189 288.8532
[164,] 280.4733  8.178658 264.4471 296.0531
[165,] 289.9429  7.797646 274.7968 305.0595
[166,] 299.4125  8.096797 283.6349 315.1979
[167,] 308.8821  9.008603 290.9103 326.4981
[168,] 318.3517 10.372739 298.1330 339.3170
[169,] 327.8213 12.036382 304.5721 351.8379
[170,] 337.2909 13.892345 310.3057 364.8949
[171,] 263.4204 12.156884 239.2632 287.2553
[172,] 275.2194 10.470936 254.9703 295.9382
[173,] 287.0185  9.092270 269.7662 304.7496
[174,] 298.8176  8.177802 283.1328 314.9926
[175,] 310.6166  7.890612 295.4832 325.9850
[176,] 322.4157  8.296100 306.2082 338.4837
[177,] 334.2148  9.304139 315.5823 352.4180
[178,] 346.0138 10.746486 324.6646 367.0381
[179,] 357.8129 12.473376 333.0791 382.3848
[180,] 369.6120 14.382680 341.0928 398.0339</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.3451341 13.087609  -29.33424544  22.2703114
  [2,]  -14.8279372 11.158345  -36.59046800   7.7855224
  [3,]  -42.3595403  9.511419  -60.90684630 -23.3183175
  [4,]    8.6521567  8.316295   -7.85304964  25.3949882
  [5,]   24.4367536  7.783937    9.31495481  39.9779056
  [6,]   62.6474505  8.046977   46.92220971  78.4192994
  [7,]   10.5336474  9.036219   -7.27488344  28.6498521
  [8,] -101.1490556 10.549309 -121.59759943 -80.5750074
  [9,]   19.6601413 12.395879   -4.42906900  43.8328638
 [10,]   35.8008382 14.448633    7.39889620  63.7861910
 [11,]   10.9530440 13.372790  -15.36166450  36.7961445
 [12,]   -8.2039346 11.435327  -30.71816793  13.7519032
 [13,]  -12.1808131  9.770807  -31.54018848   6.5015245
 [14,]  -12.1404917  8.540340  -29.26059633   4.4956576
 [15,]  -10.8202702  7.948140  -26.67490843   4.9237966
 [16,]   -4.2634488  8.134816  -20.27330219  12.0258628
 [17,]   -8.2838273  9.052310  -25.94105512   9.8805542
 [18,]   -5.8758059 10.510954  -25.82556290  15.4070014
 [19,]   -0.9961844 12.320016  -24.97963747  23.6715256
 [20,]   10.3334370 14.347550  -17.24201897  39.3809597
 [21,]  -14.0281192 13.285176  -39.25545927  12.4927740
 [22,]  -23.6659455 11.423242  -45.95603943  -0.8306780
 [23,]   11.4057283  9.833374   -8.02454345  31.2416401
 [24,]    5.0112021  8.666618  -12.01837119  22.4698016
 [25,]   -3.4391241  8.107744  -19.19813101  12.8593862
 [26,]  -17.2047503  8.280760  -33.38061035  -0.9726753
 [27,]   -7.1579766  9.144217  -24.61682667  10.5686830
 [28,]    8.2561972 10.529608  -11.82536818  28.8096141
 [29,]    8.6014710 12.261273  -14.51535883  32.4825796
 [30,]   -9.8118552 14.213205  -36.92902602  18.0927890
 [31,]   47.3103297 13.237922   20.99475543  72.4415835
 [32,]   20.3433375 11.319040   -1.96421031  42.1765668
 [33,]   -2.0249547  9.681442  -21.16863495  16.7788667
 [34,]   -6.5730469  8.489494  -23.35536210  10.3107130
 [35,]  -11.7333392  7.946334  -27.69058975   4.0039805
 [36,]   -5.7697314  8.182205  -22.13145467  10.3782530
 [37,]  -28.9402236  9.136972  -47.43257336 -11.2536338
 [38,]    3.2568842 10.618455  -17.77458542  23.9426671
 [39,]  -15.4795081 12.439874  -40.37963680   8.3718474
 [40,]   27.3950997 14.473454   -1.27269698  55.3313426
 [41,]   14.5915596 13.024475  -11.30895041  39.3127623
 [42,]    4.5065366 11.199835  -17.70331710  25.4947920
 [43,]   13.8500137  9.646880   -5.56357754  32.0968985
 [44,]   24.6675908  8.515570    7.45967194  40.9154534
 [45,]   13.3524679  7.987128   -2.49443758  28.9421779
 [46,]  -17.0832550  8.179251  -33.28347833  -1.0459180
 [47,]  -27.8040779  9.046145  -45.91578641 -10.1649073
 [48,]    9.4614992 10.420747  -11.18249884  29.8463022
 [49,]  -39.0864238 12.131687  -62.87484650 -15.4182960
 [50,]   31.2706533 14.056683    3.99684022  58.5965089
 [51,]  -25.4199456 12.376379  -50.08236684  -1.3997934
 [52,]  -27.6459536 10.612526  -49.16759253  -6.7477353
 [53,]   -7.6736617  9.124083  -25.97538040   9.9943351
 [54,]   18.9566303  8.065004    2.98026708  34.5576484
 [55,]   16.4735223  7.616557    1.19131796  31.4405100
 [56,]   -1.1689857  7.883642  -16.32463462  14.1387508
 [57,]  132.8181063  8.801359  115.85956318 149.8835183
 [58,]   15.3100983 10.195501   -4.35749023  35.4591264
 [59,]  -11.3979097 11.899782  -34.69093902  12.0325207
 [60,]  -98.0110177 13.799768 -124.88946263 -70.5652378
 [61,]   15.9982158 12.704316   -9.03377151  39.7054649
 [62,]   11.4122886 10.888751  -10.23297842  32.2212261
 [63,]  -11.6719387  9.365881  -30.06422956   6.3104809
 [64,]    1.0699340  8.298441  -15.18832657  17.2794405
 [65,]  -11.8672932  7.873887  -27.02245696   3.7063999
 [66,]   18.8296795  8.192780    2.97373034  35.1480950
 [67,]    2.3911522  9.177950  -15.36834314  20.6829795
 [68,]    8.9060250 10.646007  -12.30577657  30.3920758
 [69,]  -16.8724023 12.426976  -41.39562231   7.6793308
 [70,]    1.5118704 14.405262  -27.02807285  30.0143059
 [71,]   21.0293032 11.957871   -2.14595292  44.4351442
 [72,]   20.2477584 10.325289    0.04899143  40.6799654
 [73,]  -24.0983864  8.988685  -41.68185568  -6.7273998
 [74,]  -24.3004312  8.096006  -40.49948183  -8.7267735
 [75,]  -11.4579760  7.801163  -27.36307861   3.5521520
 [76,]  -17.8008207  8.169145  -34.13141108  -1.9261413
 [77,]   -7.9768655  9.120072  -25.91270540   9.9467432
 [78,]    6.5115897 10.496687  -14.01895860  27.3542281
 [79,]   -0.7740551 12.155211  -24.59752163  23.6715367
 [80,]   29.2684001 13.995779    1.85758149  57.3820802
 [81,]   -9.1863989 13.588232  -36.68366901  16.9701173
 [82,]   23.3911509 11.539963    0.20874289  45.6235908
 [83,]    4.1733008  9.772803  -15.47151651  23.1560532
 [84,]   20.7233507  8.464681    4.08158894  37.0780554
 [85,]    1.6118006  7.848581  -13.45621678  16.6391650
 [86,]    5.0347504  8.084297  -10.75531204  20.5155629
 [87,]   -3.9104997  9.105916  -21.75377450  13.4340226
 [88,]  -13.8131498 10.690454  -34.86300793   6.6655547
 [89,]  -13.1314000 12.627752  -37.72810105  11.3832339
 [90,]  -11.4002501 14.779739  -40.14714541  17.5215925
 [91,]   26.5330612 13.193091    1.32023098  52.7751639
 [92,]    8.7671561 11.264846  -12.97321754  30.7408682
 [93,]  -32.6325491  9.611796  -51.23670362 -13.7957196
 [94,]    2.6733458  8.398048  -13.97107014  19.1729519
 [95,]    3.0784407  7.830615  -12.19327998  18.3073756
 [96,]    9.9794356  8.047396   -5.56553362  25.7616374
 [97,]    3.1959305  8.991851  -14.24016292  20.9912641
 [98,]   -3.5769747 10.468855  -23.86053277  17.4541362
 [99,]   16.3899202 12.287847   -7.63306129  40.7829919
[100,]    0.2372151 14.319085  -27.80321233  28.6518893
[101,]    9.4212360 12.905118  -14.38087694  36.1524268
[102,]   -7.9522463 11.095220  -28.83574290  14.7951971
[103,]  -10.9303286  9.566380  -29.40125176   8.4734135
[104,]   -6.5209109  8.472144  -23.36180588  10.2680415
[105,]  -22.3195932  7.993041  -38.41956358  -6.7948029
[106,]  -14.8424755  8.237115  -31.04962278   1.0629432
[107,]  -14.6390578  9.146656  -32.60572606   2.9220601
[108,]    0.3111599 10.550944  -20.22883175  20.7753225
[109,]   16.9027776 12.281426   -7.05856543  40.3705688
[110,]   20.6802953 14.219504   -6.86337342  47.7903415
[111,]   17.5539070 13.452908   -7.92075262  44.1232522
[112,]  -12.3125382 11.488725  -34.36716108  10.0219475
[113,]  -16.5861834  9.798155  -35.48438578   2.7388267
[114,]  -34.2876285  8.545166  -50.96074716 -17.4090875
[115,]  -37.9221737  7.939703  -53.82486348 -22.4777564
[116,]    5.8620811  8.127785  -10.31926216  21.2491095
[117,]   38.5579360  9.060126   20.52975549  55.6967846
[118,]    5.0078908 10.541057  -15.57200529  25.1207068
[119,]   19.5527457 12.375171   -4.75814158  43.0796922
[120,]   -2.9056995 14.428404  -31.38506404  24.3536953
[121,]   -5.0249513 12.293434  -29.59677753  18.7532963
[122,]   36.9828858 10.578992   15.69508735  57.5980319
[123,]   -0.7040770  9.169902  -18.98256190  17.3780880
[124,]    2.4678602  8.224634  -13.72462782  18.2541314
[125,]  -13.8171026  7.911232  -29.75847926   1.9326862
[126,]   11.4658346  8.301570   -5.15149941  28.0804772
[127,]  -12.9444282  9.307524  -31.30962727   5.6660906
[128,]  -41.6187910 10.757762  -62.69785171 -19.8782259
[129,]    5.8042462 12.498574  -18.74295487  30.8878393
[130,]   24.3046834 14.425143   -3.90477145  52.9506526
[131,]  -49.9681612 12.561426  -75.33105645 -26.6609694
[132,]   12.4329519 10.789941   -9.17025736  32.7314398
[133,]   27.0018651  9.296842    7.89559085  44.4853188
[134,]   32.8631783  8.234969   16.43930976  48.5308653
[135,]   20.6321914  7.782879    5.43409646  36.2056244
[136,]   10.6050046  8.044049   -4.99095458  26.5816300
[137,]   -1.9127823  8.956297  -19.07464432  15.7696943
[138,]  -10.0224691 10.348856  -30.16217952  10.2293688
[139,]   -8.9301559 12.056427  -32.53832470  14.5777909
[140,]  -10.1447428 13.963920  -37.45518123  17.0945262
[141,]   17.2467003 11.967307   -6.40820162  41.1318806
[142,]    2.4322950 10.343334  -17.77932374  22.8844594
[143,]  -20.0900102  9.019784  -37.74235435  -2.3988942
[144,]  -11.0036154  8.144463  -26.96604600   4.6299325
[145,]   14.8341794  7.868411   -0.86388551  29.9431568
[146,]    5.8976741  8.251989  -10.25274044  21.7738533
[147,]  -24.5083311  9.213175  -42.45519507  -6.8169232
[148,]   14.1514637 10.595928   -6.53884512  34.6827071
[149,]   -5.0192415 12.258410  -29.45343530  18.7584759
[150,]    9.8860532 14.102034  -18.72095172  36.9721020
[151,]   -1.1234208 13.475738  -27.37915927  25.5619541
[152,]   -7.0444938 11.495642  -29.40569427  15.5247524
[153,]  -17.8477667  9.787380  -36.97988988   1.2054527
[154,]  -31.4561397  8.516137  -48.19837226 -14.7871626
[155,]  -19.5724127  7.895894  -35.16505937  -3.9276519
[156,]   41.9034143  8.078023   25.88547030  57.7783910
[157,]  -36.3227586  9.014019  -54.18026432 -18.3988135
[158,]   14.9340684 10.504255   -5.97636799  35.4988679
[159,]   17.3309954 12.349696   -7.15468187  41.5442474
[160,]    9.2162225 14.414554  -19.11708485  37.4357206
[161,]   17.8159568 12.255765   -6.19687119  41.1615564
[162,]   10.9087517 10.563649   -9.62812323  31.0216522
[163,]    6.8952465  9.155303  -10.95431191  24.4800059
[164,]    1.3162414  8.178658  -14.26360550  17.3424311
[165,]  -10.7723638  7.797646  -25.88902562   4.3737485
[166,]  -14.9004689  8.096797  -30.68591283   0.8771484
[167,]  -49.6162741  9.008603  -67.23227589 -31.6445189
[168,]  -13.7210792 10.372739  -34.68636826   6.4975763
[169,]   22.9594156 12.036382   -1.05723720  46.2085627
[170,]   32.1783104 13.892345    4.57428385  59.1634756
[171,]    5.9913270 12.156884  -17.84360897  30.1484559
[172,]   -1.7454397 10.470936  -22.46419794  18.5036503
[173,]   10.5782935  9.092270   -7.15278463  27.8306486
[174,]   11.8140267  8.177802   -4.36098545  27.4988461
[175,]  -23.4440401  7.890612  -38.81237270  -8.3105752
[176,]    7.1918931  8.296100   -8.87609805  23.3993542
[177,]    0.2670263  9.304139  -17.93619564  18.8995434
[178,]   -2.7939405 10.746486  -23.81823409  18.5552551
[179,]   11.3287927 12.473376  -13.24310140  36.0625807
[180,]   -5.4883741 14.382680  -33.91027865  23.0308265</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.6
p_loo         3.3  0.5
looic      1906.7 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.2  3.4
looic      1769.6 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   474       
 (0.5, 0.7]   (ok)         1    0.6%   141       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.3 22.0
p_loo        33.1  7.9
looic      1720.6 43.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   549       
 (0.5, 0.7]   (ok)         7    3.9%   582       
   (0.7, 1]   (bad)        3    1.7%   25        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.5      11.3  
fit_sleep1 -93.1      20.7  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.6
p_loo         3.3  0.5
looic      1906.7 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.2  3.4
looic      1769.6 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   474       
 (0.5, 0.7]   (ok)         1    0.6%   141       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.3 22.0
p_loo        33.1  7.9
looic      1720.6 43.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   549       
 (0.5, 0.7]   (ok)         7    3.9%   582       
   (0.7, 1]   (bad)        3    1.7%   25        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.3     22.0        33.1    7.9   1720.6
fit_sleep2  -24.5      11.3  -884.8     14.4        19.2    3.4   1769.6
fit_sleep1  -93.1      20.7  -953.3     10.6         3.3    0.5   1906.7
           se_looic
fit_sleep3   43.9  
fit_sleep2   28.8  
fit_sleep1   21.1  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
3.823971e-41 2.282880e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88      1.58     0.27     5.46       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12      1.58    -3.34     2.94        5.4      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.3.5         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.0       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
