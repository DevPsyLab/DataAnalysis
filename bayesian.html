<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.86      6.57    16.25    41.83 1.00     1669     2639
sd(Days)                6.51      1.55     4.19    10.18 1.00     1329     1769
cor(Intercept,Days)     0.09      0.30    -0.50     0.67 1.00      903     1533

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   250.89      7.30   236.31   265.69 1.00     1833     2378
Days         10.39      1.73     6.97    13.78 1.00     1535     1502

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.56    23.05    29.20 1.00     3475     2749

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.5961  12.87555 227.5059 278.7689
309 211.0508  13.20926 184.9808 236.2955
310 212.5942  13.24264 186.2420 237.6260
330 274.5268  13.51722 248.0455 300.7894
331 273.0635  13.10504 248.2382 298.6810
332 260.3383  12.58759 235.7820 284.7339
333 267.8139  12.30982 243.5068 292.6007
334 244.4107  12.38336 219.7427 268.7000
335 250.5168  13.07689 224.3987 276.3393
337 285.9447  13.05162 261.0416 312.4707
349 226.3642  13.09186 200.6739 251.5445
350 238.5782  12.85757 212.7500 262.4656
351 255.9455  12.26335 232.3234 279.8766
352 271.8023  12.55490 248.1811 297.1665
369 254.8769  12.24016 230.5044 279.0949
370 226.5616  13.14713 199.9461 251.9047
371 252.0854  12.15479 228.5077 276.1525
372 263.3159  12.22525 239.4548 287.1715

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6964311  2.478114 14.8910366 24.642652
309  1.7934721  2.473796 -2.9777555  6.615130
310  4.9769957  2.458463  0.2657947  9.843412
330  5.7659613  2.567352  0.6023329 10.632006
331  7.5253196  2.468338  2.6142650 12.354721
332 10.1934294  2.379436  5.4718871 14.895722
333 10.3212901  2.322950  5.8292726 14.833668
334 11.5144671  2.357135  6.8880043 16.207516
335 -0.1932473  2.530539 -5.1500416  4.593328
337 19.1068859  2.481069 14.1569272 23.949682
349 11.6204610  2.485470  6.7047783 16.606733
350 17.0470074  2.468662 12.2938875 22.010760
351  7.4699477  2.354792  2.9171290 12.020962
352 14.0797918  2.403193  9.4293181 18.700538
369 11.3027367  2.333346  6.6438100 15.858049
370 15.1400901  2.475417 10.4931621 20.097619
371  9.5365439  2.351696  4.9101411 14.062135
372 11.8071276  2.327306  7.1930106 16.353134</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.5961 12.875549 227.5059 278.7689
  [2,] 273.2926 11.030866 251.1467 294.8109
  [3,] 292.9890  9.479575 274.5234 311.5068
  [4,] 312.6854  8.386106 296.3208 329.2381
  [5,] 332.3818  7.941870 316.8366 347.9865
  [6,] 352.0783  8.252390 335.7399 368.1956
  [7,] 371.7747  9.241898 353.1019 389.4275
  [8,] 391.4711 10.724062 369.5783 411.9656
  [9,] 411.1676 12.525192 385.9225 434.8986
 [10,] 430.8640 14.527129 401.7074 458.4998
 [11,] 211.0508 13.209257 184.9808 236.2955
 [12,] 212.8443 11.343145 190.5364 234.7011
 [13,] 214.6378  9.751346 195.2169 233.2554
 [14,] 216.4313  8.587776 199.4583 232.6160
 [15,] 218.2247  8.040546 202.2016 233.6409
 [16,] 220.0182  8.233480 203.8144 236.1423
 [17,] 221.8117  9.119722 203.7054 239.5955
 [18,] 223.6052 10.525579 202.7575 243.7512
 [19,] 225.3986 12.273778 201.2415 248.9254
 [20,] 227.1921 14.238777 199.2693 254.6253
 [21,] 212.5942 13.242640 186.2420 237.6260
 [22,] 217.5712 11.378316 194.5667 239.4860
 [23,] 222.5482  9.780220 202.8537 241.7845
 [24,] 227.5252  8.598105 210.4525 244.3318
 [25,] 232.5022  8.018116 216.8421 248.1027
 [26,] 237.4792  8.169520 221.8125 253.5372
 [27,] 242.4562  9.015542 224.9709 260.4788
 [28,] 247.4332 10.387831 227.3117 268.0209
 [29,] 252.4102 12.108763 229.0339 276.4513
 [30,] 257.3871 14.050812 230.0137 285.3118
 [31,] 274.5268 13.517219 248.0455 300.7894
 [32,] 280.2927 11.495116 257.5272 302.7582
 [33,] 286.0587  9.733588 266.6450 304.9485
 [34,] 291.8247  8.398237 275.1676 307.8498
 [35,] 297.5906  7.713665 282.2031 312.3837
 [36,] 303.3566  7.851972 287.4099 318.7029
 [37,] 309.1225  8.774332 291.0593 325.9030
 [38,] 314.8885 10.271656 293.6870 334.6945
 [39,] 320.6545 12.132912 295.9755 344.1474
 [40,] 326.4204 14.215863 297.8191 354.1595
 [41,] 273.0635 13.105039 248.2382 298.6810
 [42,] 280.5888 11.245460 259.0755 302.3229
 [43,] 288.1141  9.662509 269.2891 307.0516
 [44,] 295.6394  8.511943 278.9569 312.2291
 [45,] 303.1648  7.982960 287.3578 318.6479
 [46,] 310.6901  8.196799 294.5333 326.9104
 [47,] 318.2154  9.101250 300.4399 336.3405
 [48,] 325.7407 10.519666 305.2621 346.2167
 [49,] 333.2660 12.275153 309.2591 357.3646
 [50,] 340.7914 14.243622 312.6727 368.8536
 [51,] 260.3383 12.587590 235.7820 284.7339
 [52,] 270.5317 10.846393 249.6262 291.3338
 [53,] 280.7251  9.389594 262.5025 298.9801
 [54,] 290.9185  8.367087 274.3479 306.9359
 [55,] 301.1120  7.948285 285.2894 316.2008
 [56,] 311.3054  8.225921 294.7711 327.1732
 [57,] 321.4988  9.136724 303.2974 339.4626
 [58,] 331.6923 10.517467 311.1279 352.4262
 [59,] 341.8857 12.209747 317.8426 365.9240
 [60,] 352.0791 14.101850 324.4428 380.0940
 [61,] 267.8139 12.309822 243.5068 292.6007
 [62,] 278.1352 10.643235 257.5127 299.1335
 [63,] 288.4564  9.263767 270.4015 306.6081
 [64,] 298.7777  8.315558 282.5166 315.1509
 [65,] 309.0990  7.954359 293.1804 324.8365
 [66,] 319.4203  8.257563 302.8838 335.5365
 [67,] 329.7416  9.159424 311.3405 347.6066
 [68,] 340.0629 10.506900 319.3516 360.5239
 [69,] 350.3842 12.152656 326.8763 373.9611
 [70,] 360.7055 13.991831 333.4632 387.7366
 [71,] 244.4107 12.383357 219.7427 268.7000
 [72,] 255.9252 10.668078 234.7164 276.7923
 [73,] 267.4396  9.240151 249.3935 285.4683
 [74,] 278.9541  8.250157 262.9310 295.0440
 [75,] 290.4686  7.865237 275.0790 306.3261
 [76,] 301.9830  8.171352 286.0078 318.0043
 [77,] 313.4975  9.099022 295.4134 331.4028
 [78,] 325.0120 10.484540 304.0833 345.8903
 [79,] 336.5264 12.172557 312.5599 360.6891
 [80,] 348.0409 14.054497 320.7099 375.5839
 [81,] 250.5168 13.076886 224.3987 276.3393
 [82,] 250.3235 11.160317 228.0326 272.3075
 [83,] 250.1303  9.534551 230.8568 268.9425
 [84,] 249.9370  8.370777 232.9693 265.9558
 [85,] 249.7438  7.876510 234.2809 264.9533
 [86,] 249.5505  8.174115 233.6434 265.5252
 [87,] 249.3573  9.186955 231.7592 267.3882
 [88,] 249.1640 10.714075 228.3459 270.4849
 [89,] 248.9708 12.569404 224.2366 274.2906
 [90,] 248.7776 14.628591 220.3617 277.8340
 [91,] 285.9447 13.051623 261.0416 312.4707
 [92,] 305.0516 11.220240 283.5750 328.0661
 [93,] 324.1585  9.682670 305.6531 344.1093
 [94,] 343.2654  8.598013 326.6742 360.7011
 [95,] 362.3723  8.149170 346.4327 378.3699
 [96,] 381.4792  8.438217 364.6819 397.7943
 [97,] 400.5861  9.397311 381.9055 419.0665
 [98,] 419.6929 10.850199 398.1008 441.1551
 [99,] 438.7998 12.627572 413.8647 463.8334
[100,] 457.9067 14.611493 429.0006 486.5653
[101,] 226.3642 13.091864 200.6739 251.5445
[102,] 237.9846 11.249178 215.9312 259.3545
[103,] 249.6051  9.697743 230.6643 268.4283
[104,] 261.2255  8.596718 244.1831 277.9043
[105,] 272.8460  8.131177 257.3113 288.5215
[106,] 284.4665  8.407356 268.3192 300.6964
[107,] 296.0869  9.359827 277.7408 314.1754
[108,] 307.7074 10.811300 286.8302 328.1327
[109,] 319.3278 12.590361 294.5028 343.4377
[110,] 330.9483 14.577561 302.2250 359.3187
[111,] 238.5782 12.857569 212.7500 262.4656
[112,] 255.6252 11.052197 233.6511 276.3567
[113,] 272.6722  9.548488 253.7616 291.1024
[114,] 289.7192  8.507923 273.2842 306.3404
[115,] 306.7662  8.110763 291.1739 322.5180
[116,] 323.8132  8.448242 307.5054 340.3344
[117,] 340.8602  9.441912 322.3425 359.4801
[118,] 357.9072 10.913991 336.4368 379.3096
[119,] 374.9542 12.699184 349.7601 399.8838
[120,] 392.0012 14.683730 362.8228 421.0133
[121,] 255.9455 12.263352 232.3234 279.8766
[122,] 263.4154 10.560298 243.0576 284.1391
[123,] 270.8854  9.150960 253.4204 289.1027
[124,] 278.3553  8.188427 262.4376 294.2644
[125,] 285.8252  7.839050 270.7760 301.0911
[126,] 293.2952  8.181757 277.3681 309.2327
[127,] 300.7651  9.139020 282.6846 318.9769
[128,] 308.2351 10.544777 287.5839 329.4948
[129,] 315.7050 12.245531 291.5246 340.1236
[130,] 323.1750 14.135198 295.4350 351.1855
[131,] 271.8023 12.554903 248.1811 297.1665
[132,] 285.8821 10.810753 265.1692 307.5821
[133,] 299.9619  9.363217 281.8563 318.1318
[134,] 314.0417  8.367675 297.3662 330.1776
[135,] 328.1214  7.994798 312.2540 343.5686
[136,] 342.2012  8.328642 325.3932 358.3927
[137,] 356.2810  9.293355 337.3914 374.4594
[138,] 370.3608 10.719949 348.7606 391.3138
[139,] 384.4406 12.450655 359.6266 408.7353
[140,] 398.5204 14.376057 369.9338 426.3400
[141,] 254.8769 12.240161 230.5044 279.0949
[142,] 266.1797 10.576838 245.2687 287.1193
[143,] 277.4824  9.209042 259.2055 295.4457
[144,] 288.7852  8.284469 272.6239 304.9519
[145,] 300.0879  7.959108 284.2444 315.8413
[146,] 311.3906  8.303697 295.0950 327.6181
[147,] 322.6934  9.243612 304.4618 340.4606
[148,] 333.9961 10.621975 313.0093 354.5099
[149,] 345.2988 12.292167 321.1287 369.3374
[150,] 356.6016 14.151232 328.6924 384.1502
[151,] 226.5616 13.147130 199.9461 251.9047
[152,] 241.7017 11.252929 219.3425 263.3073
[153,] 256.8417  9.626275 237.9727 275.6076
[154,] 271.9818  8.423617 255.4386 288.4939
[155,] 287.1219  7.842502 272.0248 302.4881
[156,] 302.2620  8.019211 286.3637 317.9867
[157,] 317.4021  8.908762 299.7053 334.8959
[158,] 332.5422 10.328587 312.1305 352.6443
[159,] 347.6823 12.093336 324.2542 371.6854
[160,] 362.8224 14.073848 335.1298 390.7385
[161,] 252.0854 12.154792 228.5077 276.1525
[162,] 261.6219 10.448205 241.5282 282.2596
[163,] 271.1584  9.036146 253.8998 289.3736
[164,] 280.6950  8.074642 265.2405 296.8968
[165,] 290.2315  7.733609 275.3828 305.2979
[166,] 299.7681  8.091880 283.5261 315.5697
[167,] 309.3046  9.066933 291.6552 327.1122
[168,] 318.8412 10.488136 298.2318 339.5636
[169,] 328.3777 12.200560 304.3091 352.6453
[170,] 337.9143 14.098485 310.0663 365.9231
[171,] 263.3159 12.225253 239.4548 287.1715
[172,] 275.1230 10.546859 254.4862 295.3696
[173,] 286.9301  9.156875 268.7775 304.8147
[174,] 298.7372  8.203244 282.5267 314.7361
[175,] 310.5444  7.846704 295.3008 325.6145
[176,] 322.3515  8.165845 306.4761 338.3595
[177,] 334.1586  9.089774 316.5214 351.8869
[178,] 345.9658 10.459429 325.4912 366.1382
[179,] 357.7729 12.124688 334.0970 381.6318
[180,] 369.5800 13.980313 342.3429 397.0184</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error       Q2.5      Q97.5
  [1,]   -4.2879000  28.97845  -63.39585  53.059864
  [2,]  -13.3731606  28.53434  -67.92031  43.343288
  [3,]  -41.8741071  27.54032  -97.57183  11.859805
  [4,]    9.1309055  27.40463  -44.83386  63.654437
  [5,]   24.3369041  26.76990  -28.20067  77.547774
  [6,]   62.1639048  26.85756    9.64419 114.546685
  [7,]   10.7211033  27.71810  -42.55568  64.848756
  [8,] -100.8914175  28.35560 -156.79290 -44.107406
  [9,]   19.1549361  29.02841  -38.66108  76.721982
 [10,]   35.6577801  29.40900  -21.93669  93.091720
 [11,]   11.3422569  29.13494  -45.16209  68.743366
 [12,]   -7.4175900  28.57716  -63.27263  48.108993
 [13,]  -11.8005244  27.74205  -67.56991  43.054848
 [14,]  -11.6791500  26.93572  -64.95167  41.417273
 [15,]  -10.1285331  26.99203  -61.39161  42.357948
 [16,]   -3.7206429  26.96492  -55.90755  51.122158
 [17,]   -7.7013726  27.31450  -60.75641  46.281176
 [18,]   -5.3332186  28.23946  -60.78325  50.162523
 [19,]   -1.6323190  29.17011  -58.62899  56.086681
 [20,]   10.9566659  29.67651  -45.50593  68.824910
 [21,]  -14.6211733  28.95932  -71.12066  41.645224
 [22,]  -23.3913473  27.92416  -76.47369  32.251070
 [23,]   12.3810432  27.50833  -41.15633  66.464021
 [24,]    6.0145944  27.71997  -50.04240  58.921546
 [25,]   -2.7653222  27.11162  -55.36499  50.225066
 [26,]  -17.2290557  27.48346  -72.09365  35.542480
 [27,]   -7.0339034  27.32764  -60.66158  47.904696
 [28,]    8.3544206  27.52111  -46.70050  62.169248
 [29,]    8.2511312  28.69086  -48.49958  66.750095
 [30,]   -9.8811766  29.00387  -68.15080  47.051971
 [31,]   46.9227740  29.62802   -9.80505 104.621503
 [32,]   20.3729564  29.02110  -35.47152  78.756890
 [33,]   -1.8628680  27.58776  -55.88308  52.147653
 [34,]   -5.7780811  27.42193  -58.48385  47.952254
 [35,]  -11.1815386  27.52875  -64.71026  43.611636
 [36,]   -5.8740289  26.64551  -57.63476  46.534770
 [37,]  -28.9721928  27.56851  -83.22153  24.074329
 [38,]    3.1083550  27.21623  -51.80316  55.914610
 [39,]  -15.9222641  28.27845  -72.08973  39.670484
 [40,]   27.2354989  29.82580  -33.30963  83.903384
 [41,]   14.6338776  28.46869  -39.06753  72.060770
 [42,]    3.6576193  28.11872  -52.09996  57.018198
 [43,]   13.6925579  26.87031  -39.07353  66.127526
 [44,]   23.5355637  27.46090  -30.07537  77.878750
 [45,]   13.3728670  26.90625  -40.40016  66.352979
 [46,]  -16.8328993  27.52781  -71.45819  37.054339
 [47,]  -28.3964869  27.19184  -82.25171  25.329373
 [48,]    8.5089440  28.18273  -46.34140  65.346144
 [49,]  -39.5232642  28.99069  -95.24652  17.896623
 [50,]   30.9102957  29.65732  -26.13447  89.725475
 [51,]  -25.4034120  28.97849  -82.25929  32.102931
 [52,]  -28.0205790  28.56840  -82.77333  27.790527
 [53,]   -8.2913519  27.23035  -62.03147  46.149425
 [54,]   18.8784137  27.54201  -34.65572  72.495436
 [55,]   15.8094643  26.48896  -37.81090  67.592361
 [56,]   -1.7051874  27.67443  -55.58301  52.575276
 [57,]  132.3690672  27.34560   78.43226 184.797556
 [58,]   15.8037857  27.94461  -39.01248  70.376905
 [59,]  -11.7839780  28.75223  -68.87141  45.113811
 [60,]  -98.1730088  29.42224 -155.69891 -41.304656
 [61,]   16.0051669  29.00439  -42.40655  71.599848
 [62,]   12.0551120  27.72817  -43.48139  65.931708
 [63,]  -11.8566950  27.53093  -66.11490  43.713133
 [64,]    1.3163560  27.17595  -51.06304  54.013723
 [65,]  -11.4622760  27.72961  -66.44664  42.810659
 [66,]   19.1783803  27.03554  -34.74476  70.021319
 [67,]    2.1795290  27.32149  -50.15437  55.082000
 [68,]    9.0573955  28.46580  -47.32011  63.590095
 [69,]  -16.9113951  28.59414  -72.46719  39.626168
 [70,]    0.5288657  29.74610  -58.16629  59.068373
 [71,]   20.4512959  28.63158  -36.72797  76.652862
 [72,]   20.1507328  28.17264  -35.73636  74.834542
 [73,]  -23.7143458  27.46107  -76.66461  31.147728
 [74,]  -23.5112707  27.18195  -76.97865  27.738576
 [75,]  -11.0366064  27.20603  -64.20356  43.904360
 [76,]  -17.9393532  27.08288  -70.80596  36.124833
 [77,]   -8.1491635  27.64912  -62.90799  45.423594
 [78,]    7.0633873  28.31667  -48.47453  63.965829
 [79,]   -1.4786925  28.52717  -57.45127  55.729766
 [80,]   29.3812756  29.17356  -27.28584  84.657302
 [81,]   -9.0799683  28.74837  -66.11381  45.411620
 [82,]   23.3804877  28.34917  -31.91384  80.111533
 [83,]    3.9055481  28.17746  -50.30407  59.994429
 [84,]   20.8070361  27.18244  -32.10220  74.433210
 [85,]    1.4405460  26.72142  -50.19960  53.951301
 [86,]    5.2171429  27.00916  -48.37956  58.060838
 [87,]   -4.5598030  28.19266  -61.24941  50.612158
 [88,]  -13.8589525  27.98357  -70.71032  40.273419
 [89,]  -13.2256412  29.33997  -71.75144  43.455510
 [90,]  -11.5838815  29.55679  -70.98218  45.440607
 [91,]   26.6295157  29.17188  -30.38506  84.704154
 [92,]    8.3579682  28.84252  -47.79473  64.010228
 [93,]  -32.8219383  27.86722  -87.73872  21.464858
 [94,]    3.3911792  27.47006  -50.08953  56.836322
 [95,]    3.2394474  26.59167  -50.77778  55.302881
 [96,]   10.7569186  27.42464  -43.53752  63.424470
 [97,]    3.3893568  27.81917  -52.10738  58.688673
 [98,]   -3.0554804  27.74524  -55.45818  51.119278
 [99,]   16.6157548  28.79462  -40.26721  72.647538
[100,]    0.7344470  29.99927  -58.97930  59.460048
[101,]    9.1780169  28.92188  -48.11137  65.410963
[102,]   -7.7872756  28.08480  -62.84695  47.308047
[103,]  -10.9148164  27.97574  -64.41574  44.550445
[104,]   -6.2224762  27.40299  -61.34914  46.896044
[105,]  -22.1605975  27.03069  -74.80799  31.536695
[106,]  -14.7989311  27.75063  -69.31257  38.335984
[107,]  -13.9805075  28.25336  -68.73212  42.184904
[108,]    0.3959894  27.77369  -52.77442  55.943889
[109,]   17.4535590  29.05513  -38.14778  74.207966
[110,]   20.0589998  30.34793  -38.47525  78.672448
[111,]   16.9924999  28.92859  -40.58526  72.730949
[112,]  -12.9298792  28.09499  -68.06194  40.209367
[113,]  -16.1208616  27.54443  -69.58271  38.300051
[114,]  -34.2811842  26.81246  -86.15159  18.190697
[115,]  -37.1418279  27.16427  -91.20836  18.322318
[116,]    6.0221806  27.19003  -47.64141  59.392404
[117,]   38.6399833  27.34065  -13.46852  92.661631
[118,]    5.5753395  28.01542  -48.53540  60.501306
[119,]   20.0328209  28.69691  -35.88011  77.450826
[120,]   -3.2094879  29.57365  -62.43935  54.926548
[121,]   -5.3882984  28.75586  -62.11154  50.672577
[122,]   36.8443016  28.40275  -18.86024  92.771267
[123,]   -0.5677199  27.73926  -54.75805  55.253103
[124,]    2.6046269  27.04459  -50.95151  55.290024
[125,]  -13.7842111  27.23338  -68.85891  38.230010
[126,]   11.4603774  27.34809  -41.32836  64.740425
[127,]  -13.3083910  27.20320  -65.78782  41.015266
[128,]  -42.0260384  27.95673  -96.29619  13.473294
[129,]    6.3335645  28.52584  -49.15172  62.057186
[130,]   24.7600649  28.82237  -32.94722  82.392911
[131,]  -50.1759099  28.87958 -106.40607   6.789466
[132,]   11.8292674  28.03835  -44.06530  65.604415
[133,]   27.0375940  27.52895  -26.39030  80.640781
[134,]   32.6791016  27.43630  -20.26792  87.532369
[135,]   20.2868317  27.46878  -33.24747  74.279685
[136,]   11.0732505  27.01197  -41.33473  63.835902
[137,]   -1.0374860  27.34239  -55.07963  53.360471
[138,]   -9.0387452  27.78411  -64.17870  44.181084
[139,]   -8.0432181  28.42800  -62.33464  47.423990
[140,]  -10.7110798  30.15912  -69.13977  48.142800
[141,]   16.6180406  28.84049  -38.81464  72.805901
[142,]    2.9968029  27.87671  -51.40060  56.392119
[143,]  -20.1975614  27.46116  -73.03281  34.327778
[144,]  -10.8295081  27.16363  -66.60842  42.261559
[145,]   14.1022297  27.73938  -40.13405  67.957666
[146,]    5.3598062  27.04798  -47.65868  58.125551
[147,]  -25.3932826  27.79794  -80.12370  29.647212
[148,]   14.6788005  28.38310  -41.51368  71.194785
[149,]   -5.0551259  28.53253  -61.14855  51.014434
[150,]    9.3001506  29.12203  -47.72123  66.153964
[151,]   -1.8273540  28.75188  -59.40530  53.917976
[152,]   -6.8977640  28.35580  -61.59963  49.408998
[153,]  -17.6558288  27.17962  -72.97446  36.055668
[154,]  -31.3976100  27.27376  -85.30367  22.188498
[155,]  -19.2967492  27.06014  -74.07646  31.932133
[156,]   42.5729637  27.17230  -10.54428  96.651247
[157,]  -36.7413151  27.33794  -88.61319  16.488938
[158,]   15.3506817  27.66757  -39.28016  70.655540
[159,]   17.6214521  28.75915  -39.62162  74.654910
[160,]    9.8418616  29.57545  -48.56429  67.253234
[161,]   17.6534157  28.72836  -39.64091  73.383027
[162,]   11.2483800  27.92354  -44.77224  66.443590
[163,]    6.8204897  27.95971  -47.98291  60.939967
[164,]    1.9515531  27.40487  -52.85162  55.103386
[165,]  -11.1834007  27.57246  -64.36111  43.018812
[166,]  -14.4190345  26.90071  -66.12943  38.960311
[167,]  -50.1783070  27.52609 -103.02079   3.645081
[168,]  -14.9976071  27.89722  -68.48939  38.853245
[169,]   23.1489025  29.04155  -34.14674  79.631199
[170,]   31.0604180  29.36330  -27.15124  88.939071
[171,]    5.6219887  27.87654  -50.29007  59.890959
[172,]   -2.0931835  28.53779  -58.48108  54.326380
[173,]   10.6060511  27.29604  -42.64906  65.317984
[174,]   11.6109652  27.62250  -42.66154  65.675178
[175,]  -23.2774626  27.06756  -76.35811  29.871717
[176,]    6.6749147  27.13383  -46.32361  59.815261
[177,]    0.1501377  27.38785  -55.19243  54.991980
[178,]   -2.1501362  27.38206  -54.69675  50.983282
[179,]   11.4668587  28.88873  -45.32916  68.408476
[180,]   -5.5417369  29.19883  -63.42677  49.686743</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.4  3.4
looic      1769.8 28.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1614      
 (0.5, 0.7]   (ok)         1    0.6%   418       
   (0.7, 1]   (bad)        1    0.6%   123       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.5 22.6
p_loo        34.5  8.7
looic      1723.1 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   739       
 (0.5, 0.7]   (ok)         6    3.3%   139       
   (0.7, 1]   (bad)        1    0.6%   19        
   (1, Inf)   (very bad)   1    0.6%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.4      11.7  
fit_sleep1 -91.8      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.4  3.4
looic      1769.8 28.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1614      
 (0.5, 0.7]   (ok)         1    0.6%   418       
   (0.7, 1]   (bad)        1    0.6%   123       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.5 22.6
p_loo        34.5  8.7
looic      1723.1 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   739       
 (0.5, 0.7]   (ok)         6    3.3%   139       
   (0.7, 1]   (bad)        1    0.6%   19        
   (1, Inf)   (very bad)   1    0.6%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.5     22.6        34.5    8.7   1723.1
fit_sleep2  -23.4      11.7  -884.9     14.4        19.4    3.4   1769.8
fit_sleep1  -91.8      21.2  -953.3     10.5         3.2    0.5   1906.7
           se_looic
fit_sleep3   45.2  
fit_sleep2   28.9  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.359720e-40 7.196427e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(
  set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
  set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
  set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))

bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.94      1.57     0.34     5.41       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.06      1.57    -3.28     2.99       5.28      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.20.4        Rcpp_1.0.11        rstan_2.32.2       StanHeaders_2.32.2
[5] lme4_1.1-34        Matrix_1.6-1.1    

loaded via a namespace (and not attached):
  [1] tidyselect_1.2.0     dplyr_1.1.3          farver_2.1.1        
  [4] loo_2.6.0            fastmap_1.1.1        tensorA_0.36.2      
  [7] shinystan_2.6.0      shinyjs_2.1.0        promises_1.2.1      
 [10] digest_0.6.33        mime_0.12            lifecycle_1.0.3     
 [13] ellipsis_0.3.2       processx_3.8.2       magrittr_2.0.3      
 [16] posterior_1.4.1      compiler_4.3.1       rlang_1.1.1         
 [19] sass_0.4.7           tools_4.3.1          igraph_1.5.1        
 [22] utf8_1.2.3           yaml_2.3.7           knitr_1.44          
 [25] labeling_0.4.3       prettyunits_1.2.0    bridgesampling_1.1-2
 [28] htmlwidgets_1.6.2    pkgbuild_1.4.2       plyr_1.8.9          
 [31] dygraphs_1.1.1.6     abind_1.4-5          miniUI_0.1.1.1      
 [34] withr_2.5.1          grid_4.3.1           stats4_4.3.1        
 [37] fansi_1.0.5          xts_0.13.1           xtable_1.8-4        
 [40] colorspace_2.1-0     inline_0.3.19        ggplot2_3.4.3       
 [43] gtools_3.9.4         scales_1.2.1         MASS_7.3-60         
 [46] cli_3.6.1            mvtnorm_1.2-3        rmarkdown_2.25      
 [49] crayon_1.5.2         generics_0.1.3       RcppParallel_5.1.7  
 [52] rstudioapi_0.15.0    reshape2_1.4.4       minqa_1.2.6         
 [55] cachem_1.0.8         stringr_1.5.0        shinythemes_1.2.0   
 [58] splines_4.3.1        bayesplot_1.10.0     parallel_4.3.1      
 [61] base64enc_0.1-3      matrixStats_1.0.0    vctrs_0.6.3         
 [64] boot_1.3-28.1        jsonlite_1.8.7       callr_3.7.3         
 [67] crosstalk_1.2.0      jquerylib_0.1.4      glue_1.6.2          
 [70] nloptr_2.0.3         codetools_0.2-19     ps_1.7.5            
 [73] DT_0.30              distributional_0.3.2 stringi_1.7.12      
 [76] gtable_0.3.4         later_1.3.1          QuickJSR_1.0.6      
 [79] munsell_0.5.0        tibble_3.2.1         colourpicker_1.3.0  
 [82] pillar_1.9.0         htmltools_0.5.6.1    Brobdingnag_1.2-9   
 [85] R6_2.5.1             evaluate_0.22        shiny_1.7.5         
 [88] lattice_0.21-8       markdown_1.9         threejs_0.3.3       
 [91] backports_1.4.1      httpuv_1.6.11        bslib_0.5.1         
 [94] rstantools_2.3.1.1   coda_0.19-4          gridExtra_2.3       
 [97] nlme_3.1-162         checkmate_2.2.0      xfun_0.40           
[100] zoo_1.8-12           pkgconfig_2.0.3     </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoCiAgc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogIHNldF9wcmlvcigibGtqKDIpIiwgY2xhc3MgPSAiY29yIikpCgpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
