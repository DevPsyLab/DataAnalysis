<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.92      7.05    15.54    42.10 1.00     1785     2447
sd(Days)                6.58      1.57     4.14    10.16 1.00     1416     1896
cor(Intercept,Days)     0.09      0.31    -0.49     0.69 1.00      895     1561

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   250.99      7.24   237.11   265.25 1.00     2035     2814
Days         10.40      1.69     7.07    13.77 1.00     1346     2012

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.58    23.08    29.24 1.00     3566     2926

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.8177  12.67187 227.9104 278.2773
309 211.7298  13.26674 185.2998 237.0984
310 212.9112  13.31110 186.2409 238.5567
330 274.5447  13.57690 248.7669 301.7283
331 272.8392  13.33120 247.6529 300.0026
332 260.2475  12.05074 238.0822 284.9197
333 267.9029  12.39897 243.6890 292.5087
334 244.2999  12.65677 218.9752 269.1659
335 250.3424  13.25394 225.3295 276.6135
337 286.0138  13.03535 260.4810 311.6859
349 226.7288  13.05039 200.5472 252.1281
350 239.0298  13.05759 212.6277 263.5035
351 256.0101  12.01703 232.9561 279.5463
352 271.9204  12.70061 246.6002 297.0709
369 254.8322  12.17522 231.3012 279.4172
370 226.4529  13.44863 199.8582 251.9007
371 252.0336  12.27574 227.0023 276.7505
372 263.3318  12.16694 239.5593 287.6980

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6122871  2.430604 14.9637231 24.447204
309  1.7740703  2.479536 -3.0242654  6.699828
310  4.9027563  2.475574  0.2360841  9.831217
330  5.7224486  2.589436  0.6191892 10.826600
331  7.4759557  2.491709  2.5333605 12.122530
332 10.2595472  2.313778  5.5559216 14.666008
333 10.2608877  2.374808  5.5158723 14.759818
334 11.5220631  2.418651  6.8426111 16.307376
335 -0.1782425  2.600283 -5.3037679  4.918922
337 19.1500898  2.466811 14.3941287 24.018668
349 11.5379075  2.442981  6.8735651 16.364008
350 16.9675307  2.503578 12.1452661 21.902080
351  7.4158586  2.314382  2.8079134 11.853692
352 14.0457044  2.422764  9.2660508 18.759490
369 11.3505758  2.322883  6.7152997 15.986916
370 15.1923827  2.483744 10.4528180 20.202174
371  9.5190065  2.357844  4.9263745 14.219229
372 11.7978731  2.347728  7.1377829 16.474396</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.8177 12.671874 227.9104 278.2773
  [2,] 273.4300 10.877178 251.5838 294.6320
  [3,] 293.0423  9.373648 274.3936 311.1738
  [4,] 312.6546  8.320651 296.2419 328.5256
  [5,] 332.2669  7.900434 316.8646 347.1305
  [6,] 351.8791  8.210734 335.5671 367.2779
  [7,] 371.4914  9.177752 353.3611 388.9979
  [8,] 391.1037 10.623643 370.3419 411.1853
  [9,] 410.7160 12.381765 386.7959 434.1870
 [10,] 430.3283 14.337716 402.3959 457.8598
 [11,] 211.7298 13.266742 185.2998 237.0984
 [12,] 213.5038 11.402863 190.8686 235.0596
 [13,] 215.2779  9.815310 195.5548 234.0541
 [14,] 217.0520  8.657455 200.0510 234.0795
 [15,] 218.8260  8.115352 202.3686 234.6248
 [16,] 220.6001  8.310389 203.7590 236.9041
 [17,] 222.3742  9.195780 204.0765 240.5359
 [18,] 224.1483 10.599923 203.1830 245.1705
 [19,] 225.9223 12.347088 201.5093 250.2648
 [20,] 227.6964 14.312197 199.1364 256.0320
 [21,] 212.9112 13.311101 186.2409 238.5567
 [22,] 217.8140 11.440484 194.6449 239.8201
 [23,] 222.7167  9.840777 203.2033 241.6726
 [24,] 227.6195  8.663373 210.2607 244.2860
 [25,] 232.5222  8.094696 216.4454 248.1974
 [26,] 237.4250  8.261423 221.2745 253.7184
 [27,] 242.3278  9.123325 224.7855 260.0894
 [28,] 247.2305 10.510753 226.9443 267.7391
 [29,] 252.1333 12.246377 228.4394 276.1883
 [30,] 257.0360 14.203116 229.6913 285.0933
 [31,] 274.5447 13.576897 248.7669 301.7283
 [32,] 280.2671 11.531660 258.5137 303.3133
 [33,] 285.9896  9.748670 267.3276 305.1310
 [34,] 291.7120  8.396685 275.7482 308.6087
 [35,] 297.4345  7.706000 282.4354 312.8128
 [36,] 303.1569  7.853083 287.9829 318.4745
 [37,] 308.8794  8.796008 291.3517 326.1075
 [38,] 314.6018 10.318864 293.9871 334.9719
 [39,] 320.3243 12.206495 295.6892 344.8366
 [40,] 326.0467 14.315322 297.2193 354.8450
 [41,] 272.8392 13.331202 247.6529 300.0026
 [42,] 280.3152 11.420891 258.7434 303.4508
 [43,] 287.7911  9.775980 269.3237 307.0678
 [44,] 295.2671  8.551026 278.8817 312.2461
 [45,] 302.7430  7.942766 287.3032 318.5076
 [46,] 310.2190  8.091493 294.3944 326.6215
 [47,] 317.6949  8.959587 300.5126 335.6908
 [48,] 325.1709 10.367901 305.1952 345.8035
 [49,] 332.6469 12.129707 309.5621 357.2175
 [50,] 340.1228 14.113236 312.8700 368.6772
 [51,] 260.2475 12.050742 238.0822 284.9197
 [52,] 270.5070 10.424503 251.0397 291.6480
 [53,] 280.7666  9.100949 263.3100 298.8915
 [54,] 291.0261  8.227481 274.9157 307.2047
 [55,] 301.2857  7.953787 285.5566 316.6702
 [56,] 311.5452  8.339134 295.0123 327.6989
 [57,] 321.8048  9.301974 303.5122 340.1155
 [58,] 332.0643 10.687348 311.1932 353.0336
 [59,] 342.3239 12.353916 318.1343 366.8949
 [60,] 352.5834 14.203035 324.4445 380.4164
 [61,] 267.9029 12.398969 243.6890 292.5087
 [62,] 278.1638 10.673856 257.2764 299.1991
 [63,] 288.4247  9.241611 270.2935 306.5743
 [64,] 298.6856  8.256088 282.5204 314.8025
 [65,] 308.9465  7.886572 293.3475 324.1812
 [66,] 319.2074  8.216597 302.8489 335.6539
 [67,] 329.4682  9.170951 311.0687 347.6216
 [68,] 339.7291 10.582044 318.4101 360.8100
 [69,] 349.9900 12.293591 325.9000 374.4254
 [70,] 360.2509 14.197342 332.3072 388.4344
 [71,] 244.2999 12.656767 218.9752 269.1659
 [72,] 255.8220 10.833274 234.2383 276.9344
 [73,] 267.3440  9.285776 248.7790 285.3992
 [74,] 278.8661  8.172589 262.8397 294.8922
 [75,] 290.3882  7.684824 275.0308 305.6629
 [76,] 301.9102  7.938614 285.9664 317.8752
 [77,] 313.4323  8.870536 295.7283 331.1093
 [78,] 324.9544 10.298105 303.9871 345.2239
 [79,] 336.4764 12.046381 311.8673 360.1289
 [80,] 347.9985 13.995690 319.6095 375.2070
 [81,] 250.3424 13.253944 225.3295 276.6135
 [82,] 250.1641 11.249581 228.8217 272.6465
 [83,] 249.9859  9.537403 231.8010 269.2774
 [84,] 249.8077  8.300241 233.9489 266.9566
 [85,] 249.6294  7.768454 234.7060 265.2178
 [86,] 249.4512  8.082493 233.8982 266.0290
 [87,] 249.2729  9.155733 231.4482 267.7076
 [88,] 249.0947 10.763417 228.4251 270.6704
 [89,] 248.9164 12.704243 224.5862 274.2893
 [90,] 248.7382 14.848143 219.9480 278.2984
 [91,] 286.0138 13.035348 260.4810 311.6859
 [92,] 305.1639 11.207581 282.6405 327.3136
 [93,] 324.3140  9.667975 304.7513 343.6773
 [94,] 343.4640  8.573210 326.4178 360.5955
 [95,] 362.6141  8.105580 346.9430 378.6337
 [96,] 381.7642  8.370857 366.0215 398.3646
 [97,] 400.9143  9.306576 383.1338 419.7034
 [98,] 420.0644 10.738892 399.3945 441.8693
 [99,] 439.2145 12.498222 414.9672 464.6048
[100,] 458.3646 14.465739 430.4242 487.6441
[101,] 226.7288 13.050393 200.5472 252.1281
[102,] 238.2667 11.214173 215.9722 260.1661
[103,] 249.8046  9.650850 230.7077 268.5996
[104,] 261.3425  8.512135 244.6813 277.6430
[105,] 272.8804  7.981873 257.5083 288.3941
[106,] 284.4183  8.179270 268.4398 300.1106
[107,] 295.9562  9.056872 278.3939 313.5972
[108,] 307.4941 10.444603 287.5423 327.9736
[109,] 319.0320 12.169175 295.7934 343.0825
[110,] 330.5699 14.107595 303.4143 358.2632
[111,] 239.0298 13.057591 212.6277 263.5035
[112,] 255.9974 11.131826 233.6718 276.6164
[113,] 272.9649  9.479991 254.0338 290.8654
[114,] 289.9324  8.267934 273.5520 305.9124
[115,] 306.8999  7.706039 291.9249 321.9509
[116,] 323.8675  7.933671 308.8383 339.4414
[117,] 340.8350  8.890391 324.0438 358.4759
[118,] 357.8025 10.376453 338.1287 378.6110
[119,] 374.7701 12.199931 351.9935 399.0882
[120,] 391.7376 14.231713 364.8847 420.1310
[121,] 256.0101 12.017029 232.9561 279.5463
[122,] 263.4260 10.341813 243.2780 283.8596
[123,] 270.8418  8.956000 252.8970 288.4624
[124,] 278.2577  8.011212 262.2865 294.1850
[125,] 285.6735  7.672146 270.5002 300.5532
[126,] 293.0894  8.016038 277.3173 308.7100
[127,] 300.5053  8.964633 283.2427 318.1661
[128,] 307.9211 10.353026 287.9566 328.2151
[129,] 315.3370 12.029896 291.6919 338.3981
[130,] 322.7528 13.891161 295.4271 349.7062
[131,] 271.9204 12.700605 246.6002 297.0709
[132,] 285.9661 10.898516 264.4596 307.5109
[133,] 300.0118  9.380271 281.5514 318.5506
[134,] 314.0575  8.303066 297.9177 330.4624
[135,] 328.1032  7.850598 312.5833 343.6232
[136,] 342.1489  8.127880 325.6929 358.2749
[137,] 356.1946  9.068217 337.9997 374.1233
[138,] 370.2403 10.494868 349.3972 390.8493
[139,] 384.2860 12.238935 360.3177 408.3851
[140,] 398.3317 14.183806 370.2969 425.7521
[141,] 254.8322 12.175222 231.3012 279.4172
[142,] 266.1828 10.492472 246.1220 287.1197
[143,] 277.5334  9.096123 259.8856 295.5008
[144,] 288.8840  8.135018 273.1446 304.7348
[145,] 300.2346  7.772333 285.0009 315.4824
[146,] 311.5851  8.088967 295.7829 327.3093
[147,] 322.9357  9.013611 305.4599 340.9584
[148,] 334.2863 10.385112 314.5986 354.2400
[149,] 345.6369 12.051866 322.8108 369.2840
[150,] 356.9874 13.908127 330.5497 384.6794
[151,] 226.4529 13.448631 199.8582 251.9007
[152,] 241.6453 11.520330 218.7646 263.6991
[153,] 256.8377  9.844200 237.3916 275.8766
[154,] 272.0301  8.569511 255.3189 288.9265
[155,] 287.2225  7.893208 271.5755 302.4259
[156,] 302.4149  7.969122 286.4635 318.0662
[157,] 317.6072  8.777758 300.3240 334.6338
[158,] 332.7996 10.145400 312.5611 352.4417
[159,] 347.9920 11.880538 324.4028 371.2414
[160,] 363.1844 13.845693 335.8941 390.5481
[161,] 252.0336 12.275740 227.0023 276.7505
[162,] 261.5526 10.515919 239.8764 282.5799
[163,] 271.0716  9.032950 253.0036 289.0402
[164,] 280.5906  7.982648 264.8835 296.4721
[165,] 290.1096  7.547848 275.3433 305.7108
[166,] 299.6286  7.831742 284.1930 315.2283
[167,] 309.1476  8.764772 291.3913 326.4022
[168,] 318.6667 10.169814 297.8505 338.6878
[169,] 328.1857 11.880567 304.2405 351.7481
[170,] 337.7047 13.783666 310.0882 364.8834
[171,] 263.3318 12.166941 239.5593 287.6980
[172,] 275.1297 10.488315 254.5875 295.7100
[173,] 286.9276  9.110362 268.9488 304.6120
[174,] 298.7254  8.186348 282.4643 314.7490
[175,] 310.5233  7.877661 295.3046 325.4952
[176,] 322.3212  8.253632 306.6704 338.2456
[177,] 334.1191  9.230979 316.5022 352.1828
[178,] 345.9169 10.645336 325.5875 366.8883
[179,] 357.7148 12.347430 333.9833 382.0384
[180,] 369.5127 14.234413 342.2201 397.6363</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.2577120 12.671874  -28.7173110  21.6496314
  [2,]  -14.7252991 10.877178  -35.9273136   7.1209108
  [3,]  -42.2416862  9.373648  -60.3731920 -23.5930014
  [4,]    8.7852268  8.320651   -7.0857954  25.1979193
  [5,]   24.5850397  7.900434    9.7214460  39.9872538
  [6,]   62.8109526  8.210734   47.4121618  79.1230207
  [7,]   10.7123656  9.177752   -6.7940874  28.8426747
  [8,] -100.9551215 10.623643 -121.0366954 -80.1933482
  [9,]   19.8692914 12.381765   -3.6016855  43.7893692
 [10,]   36.0252044 14.337716    8.4936779  63.9575595
 [11,]   11.0041355 13.266742  -14.3644510  37.4340720
 [12,]   -8.2380348 11.402863  -29.7937979  14.3972347
 [13,]  -12.3001052  9.815310  -31.0763494   7.4229505
 [14,]  -12.3449755  8.657455  -29.3725242   4.6560485
 [15,]  -11.1099458  8.115352  -26.9086946   5.3475381
 [16,]   -4.6383162  8.310389  -20.9423498  12.2028371
 [17,]   -8.7438865  9.195780  -26.9055510   9.5537713
 [18,]   -6.4210569 10.599923  -27.4432775  14.5441748
 [19,]   -1.6266272 12.347088  -25.9691275  22.7864114
 [20,]    9.6178024 14.312197  -18.7178437  38.1778462
 [21,]  -13.8573208 13.311101  -39.5028108  12.8129970
 [22,]  -23.4817772 11.440484  -45.4879312  -0.3126707
 [23,]   11.6032665  9.840777   -7.3526095  31.1167060
 [24,]    5.2221102  8.663373  -11.4443939  22.5808824
 [25,]   -3.2148462  8.094696  -18.8900263  12.8619714
 [26,]  -16.9671025  8.261423  -33.2604870  -0.8165566
 [27,]   -6.9069589  9.123325  -24.6686198  10.6352527
 [28,]    8.5205848 10.510753  -11.9879581  28.8067508
 [29,]    8.8792284 12.246377  -15.1758244  32.5731244
 [30,]   -9.5207279 14.203116  -37.5779808  17.8239818
 [31,]   46.9979384 13.576897   19.8143275  72.7756734
 [32,]   20.1330897 11.531660   -2.9131183  41.8865375
 [33,]   -2.1330589  9.748670  -21.2745216  16.5289314
 [34,]   -6.5790075  8.396685  -23.4756528   9.3847713
 [35,]  -11.6371561  7.706000  -27.0155144   3.3619078
 [36,]   -5.5714048  7.853083  -20.8890104   9.6025820
 [37,]  -28.6397534  8.796008  -45.8679064 -11.1121430
 [38,]    3.6594980 10.318864  -16.7106389  24.2741931
 [39,]  -14.9747506 12.206495  -39.4871283   9.6602902
 [40,]   28.0020007 14.315322   -0.7963422  56.8294278
 [41,]   14.7686950 13.331202  -12.3946988  39.9549831
 [42,]    4.6848393 11.420891  -18.4508178  26.2566226
 [43,]   14.0294836  9.775980   -5.2471985  32.4968594
 [44,]   24.8482279  8.551026    7.8691664  41.2335659
 [45,]   13.5342722  7.942766   -2.2302937  28.9740800
 [46,]  -16.9002835  8.091493  -33.3028133  -1.0757264
 [47,]  -27.6199392  8.959587  -45.6158126 -10.4375739
 [48,]    9.6468051 10.367901  -10.9857546  29.6225308
 [49,]  -38.8999506 12.129707  -63.4706053 -15.8152148
 [50,]   31.4582936 14.113236    2.9038760  58.7111342
 [51,]  -25.3868851 12.050742  -50.0590637  -3.2215948
 [52,]  -27.6952322 10.424503  -48.8362009  -8.2279137
 [53,]   -7.8052794  9.100949  -25.9301740   9.6512637
 [54,]   18.7426735  8.227481    2.5640577  34.8530640
 [55,]   16.1772263  7.953787    0.7927131  31.9063006
 [56,]   -1.5476208  8.339134  -17.7013451  14.9853298
 [57,]  132.3571320  9.301974  114.0463626 150.6496800
 [58,]   14.7667849 10.687348   -6.2024816  35.6379451
 [59,]  -12.0235623 12.353916  -36.5945892  12.1660264
 [60,]  -98.7190094 14.203035 -126.5519733 -70.5801175
 [61,]   15.9394774 12.398969   -8.6662898  40.1533892
 [62,]   11.3911897 10.673856   -9.6440800  32.2785779
 [63,]  -11.6553981  9.241611  -29.8049989   6.4758232
 [64,]    1.1241142  8.256088  -14.9927948  17.2893005
 [65,]  -11.7754735  7.886572  -27.0101886   3.8234716
 [66,]   18.9591388  8.216597    2.5126186  35.3175919
 [67,]    2.5582510  9.170951  -15.5950611  20.9578277
 [68,]    9.1107633 10.582044  -11.9701248  30.4297875
 [69,]  -16.6300244 12.293591  -41.0654126   7.4599522
 [70,]    1.7918879 14.197342  -26.3916108  29.7356298
 [71,]   21.1731773 12.656767   -3.6928226  46.4979006
 [72,]   20.3792141 10.833274   -0.7331798  41.9628773
 [73,]  -23.9793490  9.285776  -42.0344589  -5.4143302
 [74,]  -24.1938122  8.172589  -40.2198865  -8.1674243
 [75,]  -11.3637753  7.684824  -26.6384959   3.9936257
 [76,]  -17.7190385  7.938614  -33.6840051  -1.7751824
 [77,]   -7.9075016  8.870536  -25.5844979   9.7964791
 [78,]    6.5685352 10.298105  -13.7010126  27.5358112
 [79,]   -0.7295279 12.046381  -24.3819549  23.8796480
 [80,]   29.3005089 13.995690    2.0919641  57.6895042
 [81,]   -8.7340826 13.253944  -35.0052373  16.2787782
 [82,]   23.7830599 11.249581    1.3007271  45.1254631
 [83,]    4.5048024  9.537403  -14.7866911  22.6896614
 [84,]   20.9944449  8.300241    3.8454954  36.8532361
 [85,]    1.8224874  7.768454  -13.7658910  16.7459097
 [86,]    5.1850299  8.082493  -11.3928041  20.7380164
 [87,]   -3.8206276  9.155733  -22.2552651  14.0041478
 [88,]  -13.7836852 10.763417  -35.3593923   6.8858794
 [89,]  -13.1623427 12.704243  -38.5351611  11.1678628
 [90,]  -11.4916002 14.848143  -41.0518296  17.2985915
 [91,]   26.3528205 13.035348    0.6807334  51.8855603
 [92,]    8.6419308 11.207581  -13.5078447  31.1653109
 [93,]  -32.7027590  9.667975  -52.0661468 -13.1400551
 [94,]    2.6581513  8.573210  -14.4732830  19.7044353
 [95,]    3.1182615  8.105580  -12.9013102  18.7893765
 [96,]   10.0742718  8.370857   -6.5260703  25.8169962
 [97,]    3.3457820  9.306576  -15.4433470  21.1262519
 [98,]   -3.3721077 10.738892  -25.1769543  17.2978088
 [99,]   16.6498025 12.498222   -8.7404648  40.8971073
[100,]    0.5521128 14.465739  -28.7274355  28.4924634
[101,]    9.3744225 13.050393  -16.0249171  35.5560127
[102,]   -7.9499850 11.214173  -29.8494467  14.3445024
[103,]  -10.8789925  9.650850  -29.6739624   8.2178526
[104,]   -6.4205000  8.512135  -22.7209737  10.2406923
[105,]  -22.1701075  7.981873  -37.6837741  -6.7980113
[106,]  -14.6439150  8.179270  -30.3362194   1.3345746
[107,]  -14.3914225  9.056872  -32.0324059   3.1709423
[108,]    0.6078700 10.444603  -19.8715944  20.5597274
[109,]   17.2485625 12.169175   -6.8018566  40.4872029
[110,]   21.0751550 14.107595   -6.6180627  48.2307899
[111,]   17.2669746 13.057591   -7.2066699  43.6691112
[112,]  -12.5430562 11.131826  -33.1620666   9.7825430
[113,]  -16.7602869  9.479991  -34.6607857   2.1707941
[114,]  -34.4053176  8.267934  -50.3852859 -18.0249415
[115,]  -37.9834483  7.706039  -53.0344366 -23.0083901
[116,]    5.8572210  7.933671   -9.7167153  20.8864342
[117,]   38.6094903  8.890391   20.9685845  55.4006958
[118,]    5.1158596 10.376453  -15.6926178  24.7896747
[119,]   19.7171289 12.199931   -4.6010314  42.4937070
[120,]   -2.6849018 14.231713  -31.0782579  24.1679933
[121,]   -5.4836135 12.017029  -29.0198226  17.5703584
[122,]   36.6316279 10.341813   16.1980034  56.7796451
[123,]   -0.9479307  8.956000  -18.5684948  16.9969413
[124,]    2.3314106  8.011212  -13.5959170  18.3025703
[125,]  -13.8461480  7.672146  -28.7257714   1.3272103
[126,]   11.5441934  8.016038   -4.0764409  27.3162729
[127,]  -12.7586653  8.964633  -30.4194799   4.5039103
[128,]  -41.3256239 10.353026  -61.6195709 -21.3611028
[129,]    6.2048175 12.029896  -16.8563483  29.8498761
[130,]   24.8126589 13.891161   -2.1407063  52.1383516
[131,]  -50.2432981 12.700605  -75.3938097 -24.9231415
[132,]   12.2277974 10.898516   -9.3170332  33.7343101
[133,]   26.8666930  9.380271    8.3279075  45.3270687
[134,]   32.7979886  8.303066   16.3931014  48.9378344
[135,]   20.6369841  7.850598    5.1169838  36.1569415
[136,]   10.6797797  8.127880   -5.4461555  27.1358328
[137,]   -1.7680248  9.068217  -19.6967147  16.4269404
[138,]   -9.8077292 10.494868  -30.4167059  11.0353947
[139,]   -8.6454337 12.238935  -32.7445401  15.3228762
[140,]   -9.7900381 14.183806  -37.2103660  18.2447980
[141,]   17.0912520 12.175222   -7.4937099  40.6223492
[142,]    2.2540762 10.492472  -18.6827724  22.3148651
[143,]  -20.2909995  9.096123  -38.2583828  -2.6432459
[144,]  -11.2273753  8.135018  -27.0782417   4.5120296
[145,]   14.5876489  7.772333   -0.6601533  29.8212804
[146,]    5.6283731  8.088967  -10.0958327  21.4306122
[147,]  -24.8004027  9.013611  -42.8230861  -7.3245514
[148,]   13.8366215 10.385112   -6.1171166  33.5242728
[149,]   -5.3568543 12.051866  -29.0040177  17.4692394
[150,]    9.5256700 13.908127  -18.1663483  35.9634352
[151,]   -1.1889425 13.448631  -26.6367030  25.4057959
[152,]   -7.1218252 11.520330  -29.1755568  15.7589008
[153,]  -17.9369078  9.844200  -36.9758459   1.5092003
[154,]  -31.5570905  8.569511  -48.4534855 -14.8458797
[155,]  -19.6851732  7.893208  -34.8885732  -4.0381533
[156,]   41.7788441  7.969122   26.1275052  57.7302187
[157,]  -36.4591386  8.777758  -53.4857222 -19.1758543
[158,]   14.7858787 10.145400   -4.8561605  35.0243547
[159,]   17.1709960 11.880538   -6.0784329  40.7602134
[160,]    9.0444134 13.845693  -18.3193137  36.3347150
[161,]   17.8467922 12.275740   -6.8701453  42.8781069
[162,]   10.8901857 10.515919  -10.1371458  32.5664400
[163,]    6.8272792  9.032950  -11.1412699  24.8953277
[164,]    1.1988727  7.982648  -14.6826264  16.9059866
[165,]  -10.9391337  7.547848  -26.5402788   3.8272498
[166,]  -15.1166402  7.831742  -30.7163440   0.3189819
[167,]  -49.8818467  8.764772  -67.1363795 -32.1254730
[168,]  -14.0360532 10.169814  -34.0572028   6.7800529
[169,]   22.5950403 11.880567   -0.9674279  46.5401658
[170,]   31.7645338 13.783666    4.5857850  59.3810398
[171,]    6.0798771 12.166941  -18.2863282  29.8524180
[172,]   -1.6556960 10.488315  -22.2359647  18.8864575
[173,]   10.6692309  9.110362   -7.0151914  28.6480017
[174,]   11.9061578  8.186348   -4.1173636  28.1673353
[175,]  -23.3507153  7.877661  -38.3225811  -8.1320243
[176,]    7.2864117  8.253632   -8.6380268  22.9371962
[177,]    0.3627386  9.230979  -17.7010150  17.9795628
[178,]   -2.6970345 10.645336  -23.6683979  17.6324286
[179,]   11.4268924 12.347430  -12.8966645  35.1583511
[180,]   -5.3890807 14.234413  -33.5127034  21.9035231</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1770.1 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.3 22.6
p_loo        34.3  8.7
looic      1722.6 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1063      
 (0.5, 0.7]   (ok)         6    3.3%   342       
   (0.7, 1]   (bad)        1    0.6%   39        
   (1, Inf)   (very bad)   2    1.1%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.7      11.8  
fit_sleep1 -92.0      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1770.1 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.3 22.6
p_loo        34.3  8.7
looic      1722.6 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1063      
 (0.5, 0.7]   (ok)         6    3.3%   342       
   (0.7, 1]   (bad)        1    0.6%   39        
   (1, Inf)   (very bad)   2    1.1%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.3     22.6        34.3    8.7   1722.6
fit_sleep2  -23.7      11.8  -885.0     14.4        19.5    3.4   1770.1
fit_sleep1  -92.0      21.2  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   45.2  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.076167e-40 5.041153e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.91      1.57     0.29     5.51       0.04      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.09      1.57    -3.26     3.02       5.17      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.3          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.3         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.3.1      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
