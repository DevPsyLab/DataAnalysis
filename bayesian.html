<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.67      6.76    15.43    41.56 1.00     1810     2329
sd(Days)                6.61      1.52     4.19    10.05 1.00     1473     2165
cor(Intercept,Days)     0.08      0.30    -0.48     0.66 1.00     1000     1806

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   250.81      7.39   236.54   265.47 1.00     1538     1873
Days         10.50      1.70     7.09    13.95 1.00     1378     2086

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.88      1.59    23.02    29.24 1.00     3582     2786

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6842  12.90620 228.0634 278.8177
309 211.7895  13.40065 185.6720 238.0344
310 213.2264  13.41708 186.1596 238.5877
330 274.3643  13.43973 249.4852 301.5721
331 273.3706  13.05922 248.4306 298.4606
332 260.0196  12.27330 235.9124 284.8330
333 267.8804  12.28284 244.7018 292.3018
334 244.5813  12.41246 219.5188 268.2071
335 250.8923  13.33230 225.8503 277.8450
337 285.6340  13.43385 259.5701 312.3867
349 226.7266  13.09613 200.2187 251.9971
350 238.6940  13.18651 212.3132 263.4140
351 255.7316  12.34533 231.6685 280.2740
352 271.6376  12.41872 247.5278 296.5775
369 254.1851  11.99401 230.0593 277.8110
370 226.3873  13.59441 198.5391 252.0389
371 252.3216  12.29405 228.0269 276.7110
372 263.8060  12.37148 239.8039 288.3226

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6879873  2.456275 14.9473807 24.510878
309  1.7207021  2.508714 -3.2491200  6.640893
310  4.8771593  2.490836  0.1929476  9.866596
330  5.7563327  2.558230  0.6326222 10.623766
331  7.4935578  2.474431  2.7633483 12.304241
332 10.2472700  2.336887  5.5379767 14.760275
333 10.2779970  2.388807  5.4783641 14.878729
334 11.4782647  2.368740  7.0588171 16.088838
335 -0.2504536  2.574525 -5.3731707  4.705968
337 19.2015987  2.510852 14.3113167 24.222380
349 11.5532535  2.468352  6.8465141 16.549522
350 16.9953665  2.492999 12.2607126 21.952004
351  7.4583246  2.386590  2.6870517 12.076650
352 14.0793809  2.378592  9.3678297 18.714145
369 11.4042894  2.304607  6.8027694 16.027300
370 15.1918080  2.530725 10.4162833 20.272859
371  9.4405055  2.357113  4.7409682 13.963222
372 11.7168180  2.362978  7.1131494 16.415983</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6842 12.906199 228.0634 278.8177
  [2,] 273.3722 11.028554 251.4125 294.8277
  [3,] 293.0601  9.420966 274.3798 311.1047
  [4,] 312.7481  8.242983 296.1724 328.5214
  [5,] 332.4361  7.694512 317.4116 347.2101
  [6,] 352.1241  7.907644 336.5990 367.3240
  [7,] 371.8121  8.827385 354.1514 388.8944
  [8,] 391.5001 10.265534 371.2335 411.4580
  [9,] 411.1881 12.037699 387.5206 434.3619
 [10,] 430.8761 14.017768 403.5077 458.0577
 [11,] 211.7895 13.400653 185.6720 238.0344
 [12,] 213.5103 11.494624 190.8218 235.8413
 [13,] 215.2310  9.862177 195.9822 234.4216
 [14,] 216.9517  8.659445 200.3494 233.8779
 [15,] 218.6724  8.080639 203.1377 234.7952
 [16,] 220.3931  8.258012 204.7752 237.1434
 [17,] 222.1138  9.147682 204.5598 240.6433
 [18,] 223.8345 10.571314 203.3393 244.7697
 [19,] 225.5552 12.345549 201.3276 249.5765
 [20,] 227.2759 14.340843 198.7291 254.6790
 [21,] 213.2264 13.417084 186.1596 238.5877
 [22,] 218.1036 11.496780 194.9024 239.8222
 [23,] 222.9808  9.835765 203.5177 241.6843
 [24,] 227.8579  8.585868 210.7829 244.2964
 [25,] 232.7351  7.943584 217.2325 247.9898
 [26,] 237.6122  8.055585 221.8029 253.8657
 [27,] 242.4894  8.893419 224.5989 260.3532
 [28,] 247.3666 10.281143 226.8158 267.7661
 [29,] 252.2437 12.029938 228.3564 275.9698
 [30,] 257.1209 14.005194 229.6794 284.6968
 [31,] 274.3643 13.439725 249.4852 301.5721
 [32,] 280.1206 11.486988 258.3406 302.7787
 [33,] 285.8770  9.816550 266.5274 305.0064
 [34,] 291.6333  8.594620 274.7135 308.1926
 [35,] 297.3896  8.028661 281.3908 312.9547
 [36,] 303.1459  8.254720 286.7000 318.9163
 [37,] 308.9023  9.214688 290.7741 327.0132
 [38,] 314.6586 10.713059 293.4615 335.2772
 [39,] 320.4149 12.558578 295.6936 344.7886
 [40,] 326.1713 14.620369 297.5725 354.7470
 [41,] 273.3706 13.059216 248.4306 298.4606
 [42,] 280.8642 11.215707 259.1713 302.5143
 [43,] 288.3577  9.658502 269.4016 306.9153
 [44,] 295.8513  8.545575 278.8683 312.6680
 [45,] 303.3449  8.063043 287.5162 318.9596
 [46,] 310.8384  8.321303 294.5603 326.7907
 [47,] 318.3320  9.258571 300.3911 336.5225
 [48,] 325.8255 10.697841 305.2546 346.6222
 [49,] 333.3191 12.466438 309.6029 357.3001
 [50,] 340.8126 14.443891 312.9107 368.7708
 [51,] 260.0196 12.273296 235.9124 284.8330
 [52,] 270.2669 10.586485 249.3777 291.4310
 [53,] 280.5142  9.188886 262.7123 298.7538
 [54,] 290.7615  8.229195 274.9658 306.8621
 [55,] 301.0087  7.869292 285.2418 316.3541
 [56,] 311.2560  8.188647 295.3895 327.3933
 [57,] 321.5033  9.116151 304.0452 339.0714
 [58,] 331.7505 10.491738 310.8704 351.9040
 [59,] 341.9978 12.164332 317.8077 365.1259
 [60,] 352.2451 14.028096 324.3597 379.0329
 [61,] 267.8804 12.282837 244.7018 292.3018
 [62,] 278.1584 10.554286 258.0245 299.2156
 [63,] 288.4364  9.128560 270.9955 306.4980
 [64,] 298.7144  8.165847 282.9380 314.8350
 [65,] 308.9924  7.838642 294.1349 324.1621
 [66,] 319.2704  8.223159 303.1531 335.4826
 [67,] 329.5484  9.230883 311.2149 347.7220
 [68,] 339.8264 10.686947 318.9639 360.9500
 [69,] 350.1044 12.434841 325.8751 374.3376
 [70,] 360.3824 14.368455 332.4648 388.0403
 [71,] 244.5813 12.412461 219.5188 268.2071
 [72,] 256.0595 10.701594 234.3732 276.5066
 [73,] 267.5378  9.284444 249.1337 285.4585
 [74,] 279.0160  8.312613 262.5081 295.2095
 [75,] 290.4943  7.951103 274.8856 305.9320
 [76,] 301.9726  8.280240 285.9935 318.5246
 [77,] 313.4508  9.226407 295.1399 331.9925
 [78,] 324.9291 10.626036 304.0542 345.7463
 [79,] 336.4074 12.325606 312.4244 360.4503
 [80,] 347.8856 14.217958 320.6959 375.8400
 [81,] 250.8923 13.332297 225.8503 277.8450
 [82,] 250.6419 11.356857 229.3424 273.9833
 [83,] 250.3914  9.667608 231.8440 270.2288
 [84,] 250.1410  8.438213 233.8594 267.5225
 [85,] 249.8905  7.886735 234.5324 265.7312
 [86,] 249.6401  8.151938 233.7536 266.0141
 [87,] 249.3896  9.163186 231.5727 267.7409
 [88,] 249.1392 10.711219 228.5967 270.7134
 [89,] 248.8887 12.599714 224.7066 274.5426
 [90,] 248.6383 14.698019 220.5185 279.3192
 [91,] 285.6340 13.433853 259.5701 312.3867
 [92,] 304.8356 11.494077 282.5570 327.4859
 [93,] 324.0372  9.816718 304.5793 343.1233
 [94,] 343.2388  8.557502 326.0242 359.8654
 [95,] 362.4404  7.918490 346.4164 377.3388
 [96,] 381.6420  8.048781 365.7033 397.0450
 [97,] 400.8436  8.914709 383.1215 417.8157
 [98,] 420.0452 10.332954 399.5950 440.0303
 [99,] 439.2468 12.111011 415.8178 462.6528
[100,] 458.4484 14.113540 431.4193 486.2042
[101,] 226.7266 13.096127 200.2187 251.9971
[102,] 238.2799 11.219667 216.0992 259.9523
[103,] 249.8331  9.614512 231.0718 268.3754
[104,] 261.3864  8.436959 245.1401 278.0526
[105,] 272.9396  7.881068 257.9011 288.6884
[106,] 284.4929  8.076245 269.2429 300.4694
[107,] 296.0461  8.973614 278.8870 313.6311
[108,] 307.5994 10.392847 287.3910 327.5120
[109,] 319.1527 12.152462 295.1794 342.3442
[110,] 330.7059 14.125825 303.1655 357.9903
[111,] 238.6940 13.186510 212.3132 263.4140
[112,] 255.6894 11.268976 233.1435 277.0296
[113,] 272.6848  9.619027 253.5981 290.8587
[114,] 289.6801  8.395930 273.2623 305.8704
[115,] 306.6755  7.803056 291.5620 321.7949
[116,] 323.6709  7.982094 308.2301 339.1996
[117,] 340.6662  8.886509 323.3942 357.8968
[118,] 357.6616 10.327457 337.9142 377.5803
[119,] 374.6570 12.114981 351.3249 398.3449
[120,] 391.6523 14.118047 364.2646 418.9487
[121,] 255.7316 12.345333 231.6685 280.2740
[122,] 263.1899 10.593489 242.5539 284.1666
[123,] 270.6483  9.133914 253.0965 288.7995
[124,] 278.1066  8.125662 262.1347 293.8911
[125,] 285.5649  7.747000 270.4153 300.9979
[126,] 293.0232  8.086858 277.0709 309.1252
[127,] 300.4816  9.064775 283.0395 318.1227
[128,] 307.9399 10.504031 287.7881 327.9691
[129,] 315.3982 12.242990 291.8073 338.8207
[130,] 322.8565 14.171752 295.1940 350.1392
[131,] 271.6376 12.418720 247.5278 296.5775
[132,] 285.7170 10.665172 265.2126 307.0973
[133,] 299.7964  9.196879 281.8442 317.9461
[134,] 313.8758  8.169128 298.0186 329.8595
[135,] 327.9552  7.759004 312.7867 342.8213
[136,] 342.0346  8.061330 326.3187 357.4877
[137,] 356.1139  9.004628 338.7634 373.7590
[138,] 370.1933 10.416190 350.0453 390.7472
[139,] 384.2727 12.133676 361.1590 408.4044
[140,] 398.3521 14.045305 371.5944 425.8951
[141,] 254.1851 11.994010 230.0593 277.8110
[142,] 265.5894 10.387510 244.9150 285.7122
[143,] 276.9936  9.086631 258.9914 294.9589
[144,] 288.3979  8.237463 272.2872 304.6642
[145,] 299.8022  7.985435 284.1027 315.5424
[146,] 311.2065  8.384567 294.4888 327.9657
[147,] 322.6108  9.351855 304.1037 340.9940
[148,] 334.0151 10.734797 313.2082 354.7184
[149,] 345.4194 12.395037 320.9279 369.8115
[150,] 356.8237 14.235887 328.6637 385.1479
[151,] 226.3873 13.594407 198.5391 252.0389
[152,] 241.5792 11.625215 217.9140 264.1595
[153,] 256.7710  9.914258 236.8211 275.9781
[154,] 271.9628  8.616758 254.5088 288.6657
[155,] 287.1546  7.938115 271.4560 302.6691
[156,] 302.3464  8.036664 286.2709 318.1721
[157,] 317.5382  8.886585 299.9302 334.8888
[158,] 332.7300 10.303590 312.2368 352.8500
[159,] 347.9218 12.089900 324.1186 371.4469
[160,] 363.1136 14.105904 335.2349 390.4381
[161,] 252.3216 12.294051 228.0269 276.7110
[162,] 261.7621 10.545767 241.2113 282.2344
[163,] 271.2026  9.077151 253.6065 288.6618
[164,] 280.6431  8.042892 264.9646 295.9216
[165,] 290.0836  7.621909 275.0490 304.7483
[166,] 299.5242  7.912702 283.7302 315.1482
[167,] 308.9647  8.845347 291.7376 326.5306
[168,] 318.4052 10.246045 298.7864 338.5493
[169,] 327.8457 11.951346 304.7882 351.3756
[170,] 337.2862 13.849183 310.4777 364.3683
[171,] 263.8060 12.371477 239.8039 288.3226
[172,] 275.5228 10.613540 255.4697 296.5422
[173,] 287.2396  9.132816 269.8395 305.5784
[174,] 298.9565  8.083116 283.5408 315.1324
[175,] 310.6733  7.644116 295.8376 325.8104
[176,] 322.3901  7.918055 306.8904 337.8146
[177,] 334.1069  8.838892 316.8263 351.1690
[178,] 345.8237 10.233462 325.4807 365.3316
[179,] 357.5406 11.936868 334.0964 379.9382
[180,] 369.2574 13.835505 342.3707 395.5831</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.1241667 12.906199  -29.25770306  21.4965968
  [2,]  -14.6674540 11.028554  -36.12303017   7.2922068
  [3,]  -42.2595413  9.420966  -60.30406911 -23.5791983
  [4,]    8.6916715  8.242983   -7.08164807  25.2673683
  [5,]   24.4157842  7.694512    9.64180367  39.4402950
  [6,]   62.5659969  7.907644   47.36612574  78.0911113
  [7,]   10.3917097  8.827385   -6.69064964  28.0523918
  [8,] -101.3514776 10.265534 -121.30939760 -81.0849087
  [9,]   19.3972351 12.037699   -3.77660515  43.0647170
 [10,]   35.4774479 14.017768    8.29575403  62.8458258
 [11,]   10.9443505 13.400653  -15.30046015  37.0619129
 [12,]   -8.2444516 11.494624  -30.57551083  14.4439702
 [13,]  -12.2531537  9.862177  -31.44382110   6.9955970
 [14,]  -12.2446558  8.659445  -29.17093495   4.3575721
 [15,]  -10.9562580  8.080639  -27.07912596   4.5783723
 [16,]   -4.4312601  8.258012  -21.18158682  11.1866095
 [17,]   -8.4834622  9.147682  -27.01300142   9.0704855
 [18,]   -6.1072643 10.571314  -27.04251071  14.3878802
 [19,]   -1.2594665 12.345549  -25.28078508  22.9680539
 [20,]   10.0383314 14.340843  -17.36480021  38.5850722
 [21,]  -14.1725392 13.417084  -39.53378403  12.8942749
 [22,]  -23.7713984 11.496780  -45.49002193  -0.5701770
 [23,]   11.3392423  9.835765   -7.36429604  30.8023300
 [24,]    4.9836830  8.585868  -11.45481779  22.0587187
 [25,]   -3.4276762  7.943584  -18.68239185  12.0749313
 [26,]  -17.1543355  8.055585  -33.40780170  -1.3449851
 [27,]   -7.0685947  8.893419  -24.93244388  10.8218786
 [28,]    8.3845460 10.281143  -12.01497022  28.9353464
 [29,]    8.7687868 12.029938  -14.95725153  32.6560522
 [30,]   -9.6055725 14.005194  -37.18145024  17.8359399
 [31,]   47.1783150 13.439725   19.97049005  72.0574403
 [32,]   20.2795822 11.486988   -2.37853407  42.0596324
 [33,]   -2.0204505  9.816550  -21.14993159  17.3291404
 [34,]   -6.5002832  8.594620  -23.05959790  10.4194639
 [35,]  -11.5923159  8.028661  -27.15739563   4.4064990
 [36,]   -5.5604487  8.254720  -21.33079584  10.8854584
 [37,]  -28.6626814  9.214688  -46.77361696 -10.5345370
 [38,]    3.6026859 10.713059  -17.01587766  24.7997968
 [39,]  -15.0654469 12.558578  -39.43914658   9.6559317
 [40,]   27.8774204 14.620369   -0.69832975  56.4761615
 [41,]   14.2372743 13.059216  -10.85274030  39.1772906
 [42,]    4.1358164 11.215707  -17.51433311  25.8287251
 [43,]   13.4628586  9.658502   -5.09466083  32.4190187
 [44,]   24.2640007  8.545575    7.44731437  41.2469546
 [45,]   12.9324429  8.063043   -2.68230050  28.7611051
 [46,]  -17.5197150  8.321303  -33.47202028  -1.2416047
 [47,]  -28.2569728  9.258571  -46.44752685 -10.3161266
 [48,]    8.9921693 10.697841  -11.80449988  29.5631461
 [49,]  -39.5721885 12.466438  -63.55322187 -15.8560427
 [50,]   30.7684536 14.443891    2.81028463  58.6703794
 [51,]  -25.1590399 12.273296  -49.97237351  -1.0518076
 [52,]  -27.4551100 10.586485  -48.61916954  -6.5659147
 [53,]   -7.5528800  9.188886  -25.79245671  10.2490335
 [54,]   19.0073500  8.229195    2.90672834  34.8029503
 [55,]   16.4541799  7.869292    1.10877976  32.2211408
 [56,]   -1.2583901  8.188647  -17.39570421  14.6080515
 [57,]  132.6586399  9.116151  115.09047615 150.1166802
 [58,]   15.0805698 10.491738   -5.07292092  35.9607133
 [59,]  -11.6975002 12.164332  -34.82556115  12.4925767
 [60,]  -98.3806702 14.028096 -125.16846120 -70.4953225
 [61,]   15.9619689 12.282837   -8.45937433  39.1406382
 [62,]   11.3965719 10.554286   -9.66063732  31.5304627
 [63,]  -11.6671251  9.128560  -29.72866910   5.7738489
 [64,]    1.0952779  8.165847  -15.02526961  16.8716758
 [65,]  -11.8214191  7.838642  -26.99107779   3.0360887
 [66,]   18.8960839  8.223159    2.68387534  35.0133530
 [67,]    2.4780869  9.230883  -15.69546895  20.8116353
 [68,]    9.0134899 10.686947  -12.11006375  29.8760385
 [69,]  -16.7444071 12.434841  -40.97761613   7.4848680
 [70,]    1.6603959 14.368455  -25.99751347  29.5779903
 [71,]   20.8918458 12.412461   -2.73397948  45.9542537
 [72,]   20.1416811 10.701594   -0.30538582  41.8279747
 [73,]  -24.1730835  9.284444  -42.09383430  -5.7690491
 [74,]  -24.3437482  8.312613  -40.53717542  -7.8357901
 [75,]  -11.4699129  7.951103  -26.90761556   4.1387961
 [76,]  -17.7813776  8.280240  -34.33339427  -1.8023218
 [77,]   -7.9260422  9.226407  -26.46773250  10.3849037
 [78,]    6.5937931 10.626036  -14.22342258  27.4686843
 [79,]   -0.6604716 12.325606  -24.70340654  23.3224683
 [80,]   29.4133637 14.217958    1.45897163  56.6031334
 [81,]   -9.2840440 13.332297  -36.23674679  15.7579689
 [82,]   23.3053097 11.356857   -0.03605935  44.6048366
 [83,]    4.0992633  9.667608  -15.73807511  22.6466565
 [84,]   20.6611170  8.438213    3.27962601  36.9426671
 [85,]    1.5613706  7.886735  -14.27933003  16.9195354
 [86,]    4.9961243  8.151938  -11.37791503  20.8826439
 [87,]   -3.9373221  9.163186  -22.28856718  13.8795856
 [88,]  -13.8281684 10.711219  -35.40236373   6.7142782
 [89,]  -13.1346148 12.599714  -38.78852435  11.0474524
 [90,]  -11.3916611 14.698019  -42.07257884  16.7280698
 [91,]   26.7325849 13.433853   -0.02006370  52.7964685
 [92,]    8.9701862 11.494077  -13.68012500  31.2487686
 [93,]  -32.4260125  9.816718  -51.51207244 -12.9681020
 [94,]    2.8833888  8.557502  -13.74320017  20.0979755
 [95,]    3.2919902  7.918490  -11.60641419  19.3159722
 [96,]   10.1964915  8.048781   -5.20648405  26.1352479
 [97,]    3.4164928  8.914709  -13.55555391  21.1385979
 [98,]   -3.3529059 10.332954  -23.33802885  17.0973236
 [99,]   16.6174955 12.111011   -6.78851420  40.0464771
[100,]    0.4682968 14.113540  -27.28752620  27.4974131
[101,]    9.3765756 13.096127  -15.89385726  35.8845161
[102,]   -7.9631779 11.219667  -29.63556153  14.2175176
[103,]  -10.9075314  9.614512  -29.44982781   7.8537581
[104,]   -6.4643849  8.436959  -23.13056458   9.7818990
[105,]  -22.2293384  7.881068  -37.97805291  -7.1907904
[106,]  -14.7184918  8.076245  -30.69495641   0.5315108
[107,]  -14.4813453  8.973614  -32.06625636   2.6777688
[108,]    0.5026012 10.392847  -19.40999400  20.7109947
[109,]   17.1279477 12.152462   -6.06360753  41.1012444
[110,]   20.9391942 14.125825   -6.34518340  48.4795830
[111,]   17.6027703 13.186510   -7.11717030  43.9836025
[112,]  -12.2350961 11.268976  -33.57525074  10.3107584
[113,]  -16.4801626  9.619027  -34.65406497   2.6065331
[114,]  -34.1530291  8.395930  -50.34325340 -17.7352458
[115,]  -37.7589955  7.803056  -52.87836429 -22.6454754
[116,]    6.0538380  7.982094   -9.47489056  21.4946267
[117,]   38.7782716  8.886509   21.54774358  56.0502815
[118,]    5.2568051 10.327457  -14.66185345  25.0041853
[119,]   19.8302387 12.114981   -3.85773912  43.1623470
[120,]   -2.5996278 14.118047  -29.89595150  24.7881129
[121,]   -5.2051217 12.345333  -29.74745693  18.8580160
[122,]   36.8676537 10.593489   15.89100083  57.5036917
[123,]   -0.7543709  9.133914  -18.90561701  16.7973859
[124,]    2.4825045  8.125662  -13.30196262  18.4543680
[125,]  -13.7375201  7.747000  -29.17046787   1.4120799
[126,]   11.6103554  8.086858   -4.49156282  27.5626690
[127,]  -12.7349692  9.064775  -30.37612551   4.7071486
[128,]  -41.3443938 10.504031  -61.37363274 -21.1926243
[129,]    6.1435816 12.242990  -17.27890178  29.7344811
[130,]   24.7089570 14.171752   -2.57373708  52.3714866
[131,]  -49.9605491 12.418720  -74.90041134 -25.8507100
[132,]   12.4768699 10.665172   -8.90344230  32.9813345
[133,]   27.0820890  9.196879    8.93236761  45.0342944
[134,]   32.9797080  8.169128   16.99601297  48.8368529
[135,]   20.7850271  7.759004    5.91891580  35.9534627
[136,]   10.7941461  8.061330   -4.65903306  26.5100219
[137,]   -1.6873348  9.004628  -19.33243756  15.6632482
[138,]   -9.7607158 10.416190  -30.31464953  10.3872596
[139,]   -8.6320967 12.133676  -32.76384767  14.4815915
[140,]   -9.8103777 14.045305  -37.35343420  16.9472704
[141,]   17.7384300 11.994010   -5.88748308  41.8641650
[142,]    2.8475406 10.387510  -17.27531187  23.5219252
[143,]  -19.7512488  9.086631  -37.71651666  -1.7490006
[144,]  -10.7413382  8.237463  -27.00757923   5.3693799
[145,]   15.0199724  7.985435   -0.72017009  30.7195252
[146,]    6.0069830  8.384567  -10.75222395  22.7247315
[147,]  -24.4755064  9.351855  -42.85869262  -5.9683790
[148,]   14.1078042 10.734797   -6.59552719  34.9147213
[149,]   -5.1393852 12.395037  -29.53152674  19.3520589
[150,]    9.6894254 14.235887  -18.63476051  37.8493961
[151,]   -1.1233499 13.594407  -26.77492785  26.7249304
[152,]   -7.0556580 11.625215  -29.63597785  16.6095412
[153,]  -17.8701660  9.914258  -37.07734920   2.0796756
[154,]  -31.4897740  8.616758  -48.19268288 -14.0358321
[155,]  -19.6172820  7.938115  -35.13175586  -3.9186983
[156,]   41.8473100  8.036664   26.02162845  57.9228162
[157,]  -36.3900981  8.886585  -53.74067504 -18.7820800
[158,]   14.8554939 10.303590   -5.26450581  35.3487259
[159,]   17.2411859 12.089900   -6.28386849  41.0444118
[160,]    9.1151779 14.105904  -18.20927837  36.9939316
[161,]   17.5587759 12.294051   -6.83059086  41.8535131
[162,]   10.6806703 10.545767   -9.79158404  31.2315305
[163,]    6.6962648  9.077151  -10.76289963  24.2923728
[164,]    1.1463593  8.042892  -14.13207711  16.8248814
[165,]  -10.9131462  7.621909  -25.57775980   4.1215044
[166,]  -15.0121518  7.912702  -30.63617994   0.7817824
[167,]  -49.6988573  8.845347  -67.26478269 -32.4717624
[168,]  -13.7745628 10.246045  -33.91866749   5.8442018
[169,]   22.9350317 11.951346   -0.59489888  45.9924607
[170,]   32.1830262 13.849183    5.10092975  58.9914757
[171,]    5.6056905 12.371477  -18.91086981  29.6078015
[172,]   -2.0488275 10.613540  -23.06819092  18.0042806
[173,]   10.3571545  9.132816   -7.98159199  27.7572823
[174,]   11.6751365  8.083116   -4.50080180  27.0907670
[175,]  -23.5006816  7.644116  -38.63777745  -8.6649732
[176,]    7.2175004  7.918055   -8.20698185  22.7171895
[177,]    0.3748824  8.838892  -16.68716823  17.6555480
[178,]   -2.6038356 10.233462  -22.11171447  17.7391622
[179,]   11.6011463 11.936868  -10.79654681  35.0452913
[180,]   -5.1337717 13.835505  -31.45949968  21.7529001</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.3 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1637      
 (0.5, 0.7]   (ok)         1    0.6%   376       
   (0.7, 1]   (bad)        1    0.6%   118       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.5 22.7
p_loo        34.6  8.9
looic      1723.1 45.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   507       
 (0.5, 0.7]   (ok)         5    2.8%   669       
   (0.7, 1]   (bad)        2    1.1%   21        
   (1, Inf)   (very bad)   1    0.6%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.6      11.9  
fit_sleep1 -91.8      21.3  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.3 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1637      
 (0.5, 0.7]   (ok)         1    0.6%   376       
   (0.7, 1]   (bad)        1    0.6%   118       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.5 22.7
p_loo        34.6  8.9
looic      1723.1 45.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   507       
 (0.5, 0.7]   (ok)         5    2.8%   669       
   (0.7, 1]   (bad)        2    1.1%   21        
   (1, Inf)   (very bad)   1    0.6%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.5     22.7        34.6    8.9   1723.1
fit_sleep2  -23.6      11.9  -885.1     14.4        19.6    3.4   1770.3
fit_sleep1  -91.8      21.3  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   45.4  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.311016e-40 5.700139e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.55     0.38     5.38       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.55    -3.15     2.96       5.33      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.26 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.5      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.3         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.0          
 [52] processx_3.8.1       pkgbuild_1.4.0       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.0        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.0         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-1       
 [85] grid_4.3.0           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.31       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
