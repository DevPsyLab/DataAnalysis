<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.67      6.81    15.18    42.02 1.00     1993     2602
sd(Days)                6.54      1.54     4.16    10.10 1.00     1574     2076
cor(Intercept,Days)     0.08      0.29    -0.48     0.65 1.00     1067     1780

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.06      7.38   236.34   265.47 1.00     1984     2361
Days         10.41      1.68     7.20    13.86 1.01     1343     1963

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.58    23.08    29.24 1.00     3849     3303

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9680  13.06375 227.4625 279.0835
309 211.5822  13.29250 184.2955 237.4723
310 213.0256  13.18207 187.2735 238.7979
330 274.2017  13.57122 248.3185 301.6232
331 273.1828  13.12596 248.3487 300.2207
332 260.4027  12.39676 235.9414 285.4253
333 267.8194  12.69536 243.3822 293.2495
334 244.0001  12.95007 218.1113 268.8560
335 250.8049  13.45564 225.0534 277.2739
337 285.8528  13.04460 260.2714 311.3273
349 227.2218  13.13327 200.2442 251.6125
350 238.8893  13.28548 212.4832 263.8420
351 256.1366  12.64630 231.2416 281.3068
352 271.7803  12.93030 246.2007 296.6431
369 254.4027  12.52767 230.1213 278.8941
370 226.6205  13.30310 200.0860 252.0707
371 251.8338  12.20593 228.5654 275.4594
372 263.6031  12.61300 238.6976 289.0802

, , Days

     Estimate Est.Error       Q2.5     Q97.5
308 19.597901  2.466372 14.9576899 24.704450
309  1.790734  2.501852 -3.0425277  6.699962
310  4.864344  2.447234  0.0853164  9.770968
330  5.818519  2.558316  0.8325953 10.743043
331  7.477627  2.482818  2.5329836 12.196685
332 10.218282  2.337617  5.4959409 14.922526
333 10.342654  2.395380  5.6586182 15.112599
334 11.551227  2.466633  6.7933003 16.444804
335 -0.255368  2.620758 -5.4198482  4.747707
337 19.165189  2.482673 14.1704506 23.952571
349 11.467445  2.505793  6.7118104 16.473678
350 16.991295  2.506317 12.2844905 21.949283
351  7.450190  2.418099  2.5938307 12.066430
352 14.050760  2.414077  9.3080108 18.705736
369 11.388122  2.363005  6.6971486 16.002703
370 15.148614  2.562953 10.1941040 20.172024
371  9.493475  2.303020  5.0639951 14.033807
372 11.799074  2.359150  7.1702637 16.399582</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9680 13.063754 227.4625 279.0835
  [2,] 273.5659 11.201838 250.8873 295.4245
  [3,] 293.1638  9.615958 273.8975 311.9491
  [4,] 312.7617  8.462749 295.9906 329.6008
  [5,] 332.3596  7.933195 316.7070 348.0847
  [6,] 351.9575  8.149786 336.2305 368.1057
  [7,] 371.5554  9.059163 353.7381 389.7817
  [8,] 391.1533 10.482549 370.7428 411.9531
  [9,] 410.7512 12.241945 387.1346 435.1361
 [10,] 430.3491 14.213113 402.7758 458.4791
 [11,] 211.5822 13.292498 184.2955 237.4723
 [12,] 213.3729 11.384156 190.2757 235.6198
 [13,] 215.1636  9.748129 196.0326 233.9106
 [14,] 216.9544  8.542339 199.8090 233.5427
 [15,] 218.7451  7.964648 203.0713 234.2240
 [16,] 220.5359  8.149737 204.6119 236.7224
 [17,] 222.3266  9.050930 204.5409 240.2915
 [18,] 224.1173 10.485179 203.7323 244.5168
 [19,] 225.9081 12.266913 201.8146 249.4465
 [20,] 227.6988 14.266529 199.8108 255.2522
 [21,] 213.0256 13.182067 187.2735 238.7979
 [22,] 217.8900 11.349104 196.2237 239.9439
 [23,] 222.7543  9.788530 204.0379 242.0240
 [24,] 227.6186  8.649070 211.0792 244.6519
 [25,] 232.4830  8.110203 216.9213 248.6261
 [26,] 237.3473  8.289890 221.4651 253.6219
 [27,] 242.2117  9.145878 224.7098 260.4160
 [28,] 247.0760 10.514266 227.1535 268.2358
 [29,] 251.9404 12.224173 228.7290 276.8761
 [30,] 256.8047 14.152347 230.1143 285.5160
 [31,] 274.2017 13.571225 248.3185 301.6232
 [32,] 280.0202 11.589218 257.6919 303.2844
 [33,] 285.8388  9.875818 266.6548 305.4039
 [34,] 291.6573  8.593226 275.0313 308.5665
 [35,] 297.4758  7.952689 282.0248 313.1996
 [36,] 303.2943  8.107832 287.4981 319.7670
 [37,] 309.1128  9.017681 291.5583 327.3634
 [38,] 314.9314 10.487619 294.4657 336.5852
 [39,] 320.7499 12.318754 297.0127 345.9625
 [40,] 326.5684 14.373699 298.9303 355.4617
 [41,] 273.1828 13.125961 248.3487 300.2207
 [42,] 280.6604 11.239712 259.6541 303.4865
 [43,] 288.1381  9.628094 270.0685 308.0112
 [44,] 295.6157  8.449735 279.8650 312.5294
 [45,] 303.0933  7.900925 288.2739 318.8499
 [46,] 310.5709  8.110486 294.7549 326.8290
 [47,] 318.0486  9.025748 300.6233 336.1104
 [48,] 325.5262 10.463128 305.1170 346.3378
 [49,] 333.0038 12.240047 309.1455 357.3467
 [50,] 340.4814 14.229870 312.5869 368.2171
 [51,] 260.4027 12.396764 235.9414 285.4253
 [52,] 270.6210 10.673002 249.5949 291.9304
 [53,] 280.8392  9.223616 262.3190 299.3422
 [54,] 291.0575  8.195494 274.6515 307.2292
 [55,] 301.2758  7.757968 285.5480 316.3967
 [56,] 311.4941  8.008427 295.7797 327.3969
 [57,] 321.7124  8.888906 304.3333 339.1738
 [58,] 331.9307 10.238130 311.7718 351.9386
 [59,] 342.1489 11.897683 318.6913 365.4681
 [60,] 352.3672 13.755702 325.1956 378.8539
 [61,] 267.8194 12.695360 243.3822 293.2495
 [62,] 278.1620 10.902215 257.0240 300.0517
 [63,] 288.5047  9.381904 270.3761 307.3128
 [64,] 298.8473  8.285990 282.8878 314.9746
 [65,] 309.1900  7.795565 293.9631 324.4342
 [66,] 319.5326  8.022450 303.7948 334.8604
 [67,] 329.8753  8.912030 312.5818 347.2947
 [68,] 340.2179 10.293908 319.9590 360.2864
 [69,] 350.5606 11.999187 327.2435 373.8882
 [70,] 360.9032 13.909425 333.6813 387.9293
 [71,] 244.0001 12.950071 218.1113 268.8560
 [72,] 255.5513 11.094623 233.7366 277.3148
 [73,] 267.1026  9.520795 248.4709 285.9910
 [74,] 278.6538  8.388622 262.0538 295.3572
 [75,] 290.2050  7.890562 274.1591 305.9622
 [76,] 301.7563  8.143802 285.3882 317.6004
 [77,] 313.3075  9.085736 295.3800 330.9090
 [78,] 324.8587 10.533197 304.0913 345.6349
 [79,] 336.4099 12.309120 312.4467 360.2656
 [80,] 347.9612 14.291578 319.9263 375.4051
 [81,] 250.8049 13.455638 225.0534 277.2739
 [82,] 250.5495 11.440234 228.0838 272.9151
 [83,] 250.2941  9.718047 231.1249 269.3233
 [84,] 250.0388  8.469869 233.2143 266.3228
 [85,] 249.7834  7.922983 233.8988 265.3473
 [86,] 249.5280  8.218601 233.5998 265.5660
 [87,] 249.2727  9.276524 231.6783 267.6169
 [88,] 249.0173 10.876540 228.8153 270.5887
 [89,] 248.7619 12.817219 224.3368 273.5808
 [90,] 248.5066 14.966625 219.3633 277.1479
 [91,] 285.8528 13.044597 260.2714 311.3273
 [92,] 305.0180 11.206209 283.0085 326.9545
 [93,] 324.1832  9.660438 305.4632 342.9790
 [94,] 343.3484  8.567167 326.3532 359.7956
 [95,] 362.5136  8.111471 346.8893 377.9126
 [96,] 381.6788  8.397791 365.6051 398.1066
 [97,] 400.8440  9.358268 382.5779 419.2297
 [98,] 420.0092 10.814749 398.5979 440.9749
 [99,] 439.1744 12.596339 414.4568 463.5320
[100,] 458.3396 14.584376 429.6963 486.3786
[101,] 227.2218 13.133266 200.2442 251.6125
[102,] 238.6892 11.242213 215.8286 259.5009
[103,] 250.1567  9.635872 230.6459 268.5659
[104,] 261.6241  8.477658 244.9602 278.2106
[105,] 273.0916  7.965509 257.8761 289.2356
[106,] 284.5590  8.221070 268.7886 301.2476
[107,] 296.0265  9.180448 278.0863 314.1348
[108,] 307.4939 10.655198 286.2548 328.2577
[109,] 318.9614 12.463702 294.2828 343.3427
[110,] 330.4288 14.481453 302.1651 359.0052
[111,] 238.8893 13.285482 212.4832 263.8420
[112,] 255.8806 11.375164 233.1529 277.5657
[113,] 272.8719  9.738990 253.6448 291.6833
[114,] 289.8632  8.536084 273.0658 306.8253
[115,] 306.8545  7.965224 291.4217 323.1295
[116,] 323.8458  8.160153 307.9287 340.1087
[117,] 340.8370  9.071640 323.1861 359.0102
[118,] 357.8283 10.514963 336.6600 378.9119
[119,] 374.8196 12.304369 350.6563 399.2595
[120,] 391.8109 14.310618 363.9056 420.2475
[121,] 256.1366 12.646299 231.2416 281.3068
[122,] 263.5868 10.860122 242.2345 285.0917
[123,] 271.0370  9.362160 252.6826 289.5512
[124,] 278.4872  8.309767 262.0799 294.9154
[125,] 285.9374  7.883453 270.5251 301.6888
[126,] 293.3876  8.181677 277.0631 309.8977
[127,] 300.8378  9.133743 282.6348 319.5633
[128,] 308.2880 10.564330 287.4205 329.4524
[129,] 315.7382 12.307693 291.6741 340.2120
[130,] 323.1883 14.249489 295.2711 351.2603
[131,] 271.7803 12.930300 246.2007 296.6431
[132,] 285.8310 11.083917 264.2776 307.2353
[133,] 299.8818  9.495754 281.4463 318.3334
[134,] 313.9326  8.315106 297.6558 329.9710
[135,] 327.9833  7.730987 312.8790 342.9842
[136,] 342.0341  7.877238 326.8325 357.5401
[137,] 356.0848  8.717175 339.2050 373.1350
[138,] 370.1356 10.078836 350.2834 389.9213
[139,] 384.1864 11.782710 360.7572 407.3680
[140,] 398.2371 13.701719 371.7965 424.9316
[141,] 254.4027 12.527669 230.1213 278.8941
[142,] 265.7908 10.795559 244.9831 286.8014
[143,] 277.1790  9.344158 259.4217 295.7403
[144,] 288.5671  8.321663 273.1221 305.2610
[145,] 299.9552  7.896483 284.9161 315.9316
[146,] 311.3433  8.162501 295.5230 327.8840
[147,] 322.7315  9.059027 304.9704 340.9523
[148,] 334.1196 10.424640 313.5689 354.4315
[149,] 345.5077 12.101564 321.2985 369.3412
[150,] 356.8958 13.978203 328.6989 383.8864
[151,] 226.6205 13.303098 200.0860 252.0707
[152,] 241.7691 11.369228 219.3342 263.5344
[153,] 256.9177  9.730557 238.0464 275.8042
[154,] 272.0663  8.558364 255.7516 288.5137
[155,] 287.2149  8.058841 271.7774 302.9143
[156,] 302.3636  8.353544 286.5643 318.7457
[157,] 317.5122  9.367814 299.2642 335.4872
[158,] 332.6608 10.902643 311.2129 353.7406
[159,] 347.8094 12.771718 322.4808 372.3595
[160,] 362.9580 14.849357 333.5111 391.1649
[161,] 251.8338 12.205931 228.5654 275.4594
[162,] 261.3273 10.541492 241.2862 282.1322
[163,] 270.8207  9.158009 252.8889 288.7569
[164,] 280.3142  8.198965 264.0605 295.9612
[165,] 289.8077  7.822066 274.4077 304.9174
[166,] 299.3012  8.108897 283.4104 315.0423
[167,] 308.7946  8.996194 291.4066 326.4975
[168,] 318.2881 10.330373 298.2954 338.4133
[169,] 327.7816 11.962838 304.2790 350.9757
[170,] 337.2751 13.788045 309.8571 364.4334
[171,] 263.6031 12.613003 238.6976 289.0802
[172,] 275.4021 10.869090 254.5684 297.2388
[173,] 287.2012  9.397743 269.2043 305.8004
[174,] 299.0003  8.344411 282.6680 315.1764
[175,] 310.7994  7.878580 295.5006 326.4450
[176,] 322.5984  8.102222 306.4438 338.7052
[177,] 334.3975  8.963882 316.9015 351.7960
[178,] 346.1966 10.304733 325.4535 366.2528
[179,] 357.9957 11.964742 334.1167 381.4540
[180,] 369.7947 13.829453 342.2347 396.3516</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.40799679 13.063754  -29.5235340  22.0975484
  [2,]  -14.86119732 11.201838  -36.7198211   7.8174178
  [3,]  -42.36319784  9.615958  -61.1485495 -23.0969049
  [4,]    8.67810163  8.462749   -8.1610303  25.4492440
  [5,]   24.49230110  7.933195    8.7671631  40.1448566
  [6,]   62.73260058  8.149786   46.5844242  78.4596470
  [7,]   10.64840005  9.059163   -7.5778556  28.4657438
  [8,] -101.00470047 10.482549 -121.8044826 -80.5941640
  [9,]   19.83409900 12.241945   -4.5507770  43.4507405
 [10,]   36.00439847 14.213113    7.8743524  63.5776558
 [11,]   11.15171747 13.292498  -14.7384378  38.4383683
 [12,]   -8.10711614 11.384156  -30.3540220  14.9901057
 [13,]  -12.18584976  9.748129  -30.9328114   6.9451696
 [14,]  -12.24738338  8.542339  -28.8357045   4.8979725
 [15,]  -11.02901699  7.964648  -26.5079102   4.6447629
 [16,]   -4.57405061  8.149737  -20.7606066  11.3498918
 [17,]   -8.69628423  9.050930  -26.6612022   9.0894144
 [18,]   -6.39011784 10.485179  -26.7896380  13.9949304
 [19,]   -1.61235146 12.266913  -25.1507777  22.4811480
 [20,]    9.61541492 14.266529  -17.9380377  37.5034385
 [21,]  -13.97171617 13.182067  -39.7440020  11.7804127
 [22,]  -23.55775970 11.349104  -45.6116925  -1.8915299
 [23,]   11.56569677  9.788530   -7.7040476  30.2821078
 [24,]    5.22295323  8.649070  -11.8102613  21.7624264
 [25,]   -3.17559030  8.110203  -19.3186639  12.3861183
 [26,]  -16.88943383  8.289890  -33.1639638  -1.0072341
 [27,]   -6.79087737  9.145878  -24.9951995  10.7109598
 [28,]    8.67507910 10.514266  -12.4846926  28.5975952
 [29,]    9.07213557 12.224173  -15.8635683  32.2835157
 [30,]   -9.28940797 14.152347  -38.0006794  17.4009697
 [31,]   47.34087436 13.571225   19.9193961  73.2240757
 [32,]   20.37995557 11.589218   -2.8842105  42.7083249
 [33,]   -1.98226322  9.875818  -21.5473826  17.2017036
 [34,]   -6.52428201  8.593226  -23.4335330  10.1016557
 [35,]  -11.67850080  7.952689  -27.4023206   3.7724502
 [36,]   -5.70881958  8.107832  -22.1815251  10.0874380
 [37,]  -28.87323837  9.017681  -47.1237912 -11.3186684
 [38,]    3.32994284 10.487619  -18.3238710  23.7955603
 [39,]  -15.40037595 12.318754  -40.6130138   8.3368185
 [40,]   27.48030526 14.373699   -1.4129915  55.1184325
 [41,]   14.42509679 13.125961  -12.6127718  39.2592095
 [42,]    4.33957021 11.239712  -18.4865157  25.3459141
 [43,]   13.68254364  9.628094   -6.1906083  31.7520773
 [44,]   24.49961706  8.449735    7.5858709  40.2502767
 [45,]   13.18399049  7.900925   -2.5726052  28.0034072
 [46,]  -17.25223608  8.110486  -33.5102610  -1.4362178
 [47,]  -27.97356266  9.025748  -46.0354306 -10.5482995
 [48,]    9.29151077 10.463128  -11.5200639  29.7006856
 [49,]  -39.25691581 12.240047  -63.5998126 -15.3986310
 [50,]   31.09965762 14.229870    3.3640252  58.9941825
 [51,]  -25.54207802 12.396764  -50.5647296  -1.0808199
 [52,]  -27.80915982 10.673002  -49.1186039  -6.7831153
 [53,]   -7.87794162  9.223616  -26.3809079  10.6423212
 [54,]   18.71127658  8.195494    2.5395675  35.1172921
 [55,]   16.18709477  7.757968    1.0661584  31.9148746
 [56,]   -1.49648703  8.008427  -17.3992632  14.2178787
 [57,]  132.44953117  8.888906  114.9881326 149.8285602
 [58,]   14.90044937 10.238130   -5.1074791  35.0592840
 [59,]  -11.84863243 11.897683  -35.1678442  11.6090259
 [60,]  -98.50281424 13.755702 -124.9894761 -71.3311704
 [61,]   16.02303781 12.695360   -9.4070781  40.4602085
 [62,]   11.39298386 10.902215  -10.4967456  32.5310167
 [63,]  -11.73537010  9.381904  -30.5434700   6.3931561
 [64,]    0.96237594  8.285990  -15.1649202  16.9219174
 [65,]  -12.01897801  7.795565  -27.2631979   3.2078770
 [66,]   18.63386803  8.022450    3.3061059  34.3717452
 [67,]    2.15121408  8.912030  -15.2681796  19.4446844
 [68,]    8.62196012 10.293908  -11.4465297  28.8809019
 [69,]  -17.20059383 11.999187  -40.5282362   6.1165272
 [70,]    1.13955221 13.909425  -25.8865280  28.3614913
 [71,]   21.47298106 12.950071   -3.3828670  47.3618113
 [72,]   20.64985394 11.094623   -1.1136402  42.4646368
 [73,]  -23.73787318  9.520795  -42.6262562  -5.1061720
 [74,]  -23.98150029  8.388622  -40.6849067  -7.3815347
 [75,]  -11.18062741  7.890562  -26.9378046   4.8653179
 [76,]  -17.56505453  8.143802  -33.4092136  -1.1970271
 [77,]   -7.78268165  9.085736  -25.3842242  10.1447952
 [78,]    6.66419123 10.533197  -14.1119996  27.4316041
 [79,]   -0.66303589 12.309120  -24.5186762  23.3001788
 [80,]   29.33783699 14.291578    1.8939371  57.3726621
 [81,]   -9.19657561 13.455638  -35.6655767  16.5548959
 [82,]   23.39769238 11.440234    1.0320842  45.8633964
 [83,]    4.19656037  9.718047  -14.8325507  23.3658072
 [84,]   20.76332835  8.469869    4.4793080  37.5877810
 [85,]    1.66849634  7.922983  -13.8953610  17.5531009
 [86,]    5.10816433  8.218601  -10.9298325  21.0363552
 [87,]   -3.82036769  9.276524  -22.1646130  13.7740444
 [88,]  -13.70629970 10.876540  -35.2777267   6.4957064
 [89,]  -13.00783171 12.817219  -37.8266581  11.4173006
 [90,]  -11.25996373 14.966625  -39.9013090  17.8833436
 [91,]   26.51375017 13.044597    1.0393463  52.0952123
 [92,]    8.78776073 11.206209  -13.1487105  30.7973250
 [93,]  -32.57202870  9.660438  -51.3678014 -13.8519624
 [94,]    2.77378186  8.567167  -13.6734441  19.7689724
 [95,]    3.21879243  8.111471  -12.1802435  18.8431104
 [96,]   10.15970299  8.397791   -6.2681036  26.2334133
 [97,]    3.41611356  9.358268  -14.9695609  21.6822019
 [98,]   -3.31687588 10.814749  -24.2825675  18.0944417
 [99,]   16.68993469 12.596339   -7.6677044  41.4075419
[100,]    0.57714525 14.584376  -27.4619328  29.2204036
[101,]    8.88140684 13.133266  -15.5093393  35.8590364
[102,]   -8.37253800 11.242213  -29.1842158  14.4881478
[103,]  -11.23108285  9.635872  -29.6403340   8.2796773
[104,]   -6.70212769  8.477658  -23.2886487   9.9618217
[105,]  -22.38127254  7.965509  -38.5253005  -7.1657986
[106,]  -14.78461739  8.221070  -31.4731791   0.9857959
[107,]  -14.46166223  9.180448  -32.5699847   3.4784853
[108,]    0.60809292 10.655198  -20.1556897  21.8471667
[109,]   17.31924808 12.463702   -7.0621406  41.9978335
[110,]   21.21630323 14.481453   -7.3600678  49.4799999
[111,]   17.40752176 13.285482   -7.5452134  43.8136110
[112,]  -12.42627331 11.375164  -34.1113754  10.3013734
[113,]  -16.66726838  9.738990  -35.4786561   2.5597803
[114,]  -34.33606344  8.536084  -51.2982182 -17.5387363
[115,]  -37.93795851  7.965224  -54.2129896 -22.5051535
[116,]    5.87894642  8.160153  -10.3840086  21.7960005
[117,]   38.60745135  9.071640   20.4343049  56.2583910
[118,]    5.09005628 10.514963  -15.9935139  26.2583662
[119,]   19.66756122 12.304369   -4.7722573  43.8308701
[120,]   -2.75823385 14.310618  -31.1947620  25.1470845
[121,]   -5.61013690 12.646299  -30.7803298  19.2849364
[122,]   36.47077340 10.860122   14.9659068  57.8230995
[123,]   -1.14311629  9.362160  -19.6573215  17.2113320
[124,]    2.10189401  8.309767  -14.3262678  18.5092469
[125,]  -14.10999568  7.883453  -29.8613514   1.3023459
[126,]   11.24601462  8.181677   -5.2640664  27.5704710
[127,]  -13.09117507  9.133743  -31.8166520   5.1118111
[128,]  -41.69246477 10.564330  -62.8569142 -20.8249780
[129,]    5.80364554 12.307693  -18.6701690  29.8676998
[130,]   24.37715584 14.249489   -3.6947965  52.2943836
[131,]  -50.10317347 12.930300  -74.9659929 -24.5236400
[132,]   12.36286690 11.083917   -9.0413852  33.9163103
[133,]   26.99670728  9.495754    8.5450516  45.4322340
[134,]   32.92294765  8.315106   16.8844674  49.1997393
[135,]   20.75688802  7.730987    5.7560285  35.8612273
[136,]   10.79462840  7.877238   -4.7114173  25.9961905
[137,]   -1.65823123  8.717175  -18.7084179  15.2215888
[138,]   -9.70299086 10.078836  -29.4886793  10.1491792
[139,]   -8.54575049 11.782710  -31.7274154  14.8833550
[140,]   -9.69541011 13.701719  -36.3899086  16.7451661
[141,]   17.52077752 12.527669   -6.9706282  41.8022464
[142,]    2.64605528 10.795559  -18.3644992  23.4538248
[143,]  -19.93656697  9.344158  -38.4979243  -2.1793259
[144,]  -10.91048921  8.321663  -27.6044089   4.5344986
[145,]   14.86698854  7.896483   -1.1094154  29.9061375
[146,]    5.87016630  8.162501  -10.6705277  21.6905105
[147,]  -24.59615595  9.059027  -42.8169519  -6.8350693
[148,]   14.00332180 10.424640   -6.3086097  34.5540341
[149,]   -5.22770044 12.101564  -29.0611731  18.9815482
[150,]    9.61727731 13.978203  -17.3732668  37.8142155
[151,]   -1.35649261 13.303098  -26.8066826  25.1780417
[152,]   -7.24560623 11.369228  -29.0108567  15.1892562
[153,]  -18.01691985  9.730557  -36.9033980   0.8543551
[154,]  -31.59333347  8.558364  -48.0407352 -15.2786111
[155,]  -19.67764709  8.058841  -35.3769531  -4.2400542
[156,]   41.83013929  8.353544   25.4479601  57.6294324
[157,]  -36.36407433  9.367814  -54.3391135 -18.1161330
[158,]   14.92471205 10.902643   -6.1550980  36.3726235
[159,]   17.35359844 12.771718   -7.1964794  42.6821628
[160,]    9.27078482 14.849357  -18.9360610  38.7177230
[161,]   18.04661273 12.205931   -5.5790345  41.3150199
[162,]   11.11553761 10.541492   -9.6894325  31.1566020
[163,]    7.07816248  9.158009  -10.8579771  25.0099879
[164,]    1.47528736  8.198965  -14.1717104  17.7290055
[165,]  -10.63718777  7.822066  -25.7468726   4.7628229
[166,]  -14.78916289  8.108897  -30.5303037   1.1016391
[167,]  -49.52883801  8.996194  -67.2316714 -32.1408372
[168,]  -13.65751314 10.330373  -33.7827269   6.3351909
[169,]   22.99911174 11.962838   -0.1949853  46.5016973
[170,]   32.19413662 13.788045    5.0358411  59.6121390
[171,]    5.80863886 12.613003  -19.6685072  30.7140869
[172,]   -1.92813541 10.869090  -23.7648089  18.9056434
[173,]   10.39559032  9.397743   -8.2036171  28.3924514
[174,]   11.63131605  8.344411   -4.5447539  27.9636177
[175,]  -23.62675822  7.878580  -39.2723768  -8.3279629
[176,]    7.00916750  8.102222   -9.0976424  23.1637876
[177,]    0.08429323  8.963882  -17.3142313  17.5803347
[178,]   -2.97668104 10.304733  -23.0328851  17.7664175
[179,]   11.14604469 11.964742  -12.3122778  35.0249777
[180,]   -5.67112958 13.829453  -32.2279863  21.8888812</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.1  3.2
looic      1769.3 28.5
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1799      
 (0.5, 0.7]   (ok)         3    1.7%   234       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.9 22.1
p_loo        33.7  8.1
looic      1721.8 44.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   887       
 (0.5, 0.7]   (ok)         5    2.8%   424       
   (0.7, 1]   (bad)        2    1.1%   26        
   (1, Inf)   (very bad)   1    0.6%   29        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.8      11.5  
fit_sleep1 -92.3      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.1  3.2
looic      1769.3 28.5
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1799      
 (0.5, 0.7]   (ok)         3    1.7%   234       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.9 22.1
p_loo        33.7  8.1
looic      1721.8 44.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   887       
 (0.5, 0.7]   (ok)         5    2.8%   424       
   (0.7, 1]   (bad)        2    1.1%   26        
   (1, Inf)   (very bad)   1    0.6%   29        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.9     22.1        33.7    8.1   1721.8
fit_sleep2  -23.8      11.5  -884.7     14.3        19.1    3.2   1769.3
fit_sleep1  -92.3      20.8  -953.2     10.5         3.1    0.5   1906.4
           se_looic
fit_sleep3   44.2  
fit_sleep2   28.5  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.065500e-41 4.821072e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.95      1.55     0.39     5.43       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.05      1.55     -3.2     3.01       5.61      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.25 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_0.63.0   compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.21      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.4      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.42           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.2         tidyselect_1.2.0    
 [46] abind_1.4-5          yaml_2.3.7           codetools_0.2-19    
 [49] miniUI_0.1.1.1       curl_5.0.0           processx_3.8.1      
 [52] pkgbuild_1.4.0       lattice_0.21-8       tibble_3.2.1        
 [55] plyr_1.8.8           shiny_1.7.4          withr_2.5.0         
 [58] bridgesampling_1.1-2 posterior_1.4.1      coda_0.19-4         
 [61] evaluate_0.21        RcppParallel_5.1.7   xts_0.13.1          
 [64] pillar_1.9.0         tensorA_0.36.2       checkmate_2.2.0     
 [67] DT_0.28              stats4_4.3.0         shinyjs_2.1.0       
 [70] distributional_0.3.2 generics_0.1.3       ggplot2_3.4.2       
 [73] rstantools_2.3.1     munsell_0.5.0        scales_1.2.1        
 [76] minqa_1.2.5          gtools_3.9.4         xtable_1.8-4        
 [79] glue_1.6.2           tools_4.3.0          shinystan_2.6.0     
 [82] colourpicker_1.2.0   mvtnorm_1.1-3        grid_4.3.0          
 [85] crosstalk_1.2.0      colorspace_2.1-0     nlme_3.1-162        
 [88] cli_3.6.1            fansi_1.0.4          Brobdingnag_1.2-9   
 [91] dplyr_1.1.2          V8_4.3.0             gtable_0.3.3        
 [94] sass_0.4.6           digest_0.6.31        htmlwidgets_1.6.2   
 [97] farver_2.1.1         htmltools_0.5.5      lifecycle_1.0.3     
[100] mime_0.12            shinythemes_1.2.0    MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
