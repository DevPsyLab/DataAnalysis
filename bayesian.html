<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.23      6.92    15.50    43.13 1.00     1388     1808
sd(Days)                6.58      1.47     4.24     9.93 1.00     1126     1750
cor(Intercept,Days)     0.07      0.30    -0.50     0.66 1.00      797     1326

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.20      7.45   236.29   265.94 1.00     1610     2613
Days         10.41      1.67     7.10    13.62 1.00     1395     1747

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.55    23.03    29.16 1.00     2979     2853

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6758  12.96935 228.2326 279.0917
309 211.4367  13.38238 185.5228 237.2864
310 213.0398  13.55107 186.2205 238.3707
330 274.6168  13.68065 248.8557 301.4649
331 273.1228  12.99881 248.1053 298.7492
332 260.2205  12.28244 236.1209 283.8105
333 268.0291  12.95128 243.0431 294.3083
334 244.2709  12.26324 219.7118 268.5745
335 250.7184  13.12497 224.8687 276.0281
337 285.8674  12.88586 261.1486 311.5935
349 226.7849  12.91613 200.2790 250.7286
350 238.5109  12.98055 212.0297 263.3725
351 255.8268  12.57515 230.8247 280.2291
352 272.1068  12.79430 247.6978 297.1815
369 254.4979  12.03466 230.9651 278.0199
370 226.1454  13.73191 198.7332 253.9889
371 252.3844  12.50328 228.1372 277.3230
372 263.4278  12.25251 240.0754 288.0203

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6566473  2.469884 14.99793441 24.647106
309  1.7698478  2.491480 -3.10540513  6.546806
310  4.9127061  2.534091 -0.07212882  9.863586
330  5.7704017  2.571435  0.57175716 10.538988
331  7.4827450  2.453937  2.57255077 12.340392
332 10.2468419  2.314174  5.64317582 14.763285
333 10.2997342  2.415433  5.45483467 14.999530
334 11.5914175  2.319157  7.00106673 16.185511
335 -0.2531064  2.516022 -4.98816655  4.762902
337 19.1574899  2.464964 14.37679891 24.074534
349 11.5545848  2.410646  6.89719553 16.457001
350 17.0266384  2.512974 12.17110597 22.064571
351  7.4932301  2.402342  2.66613486 12.148566
352 14.0503424  2.379676  9.40048220 18.707561
369 11.3392432  2.326581  6.78789487 15.804490
370 15.2529380  2.594752 10.35210862 20.361685
371  9.4301657  2.346294  4.97219086 13.964513
372 11.7973410  2.315699  7.29647273 16.270548</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6758 12.969353 228.2326 279.0917
  [2,] 273.3324 11.100008 251.4006 295.0765
  [3,] 292.9891  9.508779 274.3997 311.8362
  [4,] 312.6457  8.356091 296.3266 329.5363
  [5,] 332.3024  7.837874 316.7738 347.9574
  [6,] 351.9590  8.077186 335.6071 367.7984
  [7,] 371.6157  9.013893 353.9262 389.0749
  [8,] 391.2723 10.462325 370.6311 411.0976
  [9,] 410.9290 12.242176 386.5073 434.7216
 [10,] 430.5856 14.229623 402.6552 458.1174
 [11,] 211.4367 13.382383 185.5228 237.2864
 [12,] 213.2065 11.476212 191.1184 235.6728
 [13,] 214.9764  9.835328 196.0818 234.3623
 [14,] 216.7462  8.612714 200.3645 233.6539
 [15,] 218.5161  8.002435 203.1953 234.4152
 [16,] 220.2859  8.143343 204.5794 236.4775
 [17,] 222.0558  9.000226 204.6068 239.8688
 [18,] 223.8256 10.397549 203.5270 243.8398
 [19,] 225.5955 12.150266 202.0381 249.2470
 [20,] 227.3653 14.126706 199.6318 254.7609
 [21,] 213.0398 13.551069 186.2205 238.3707
 [22,] 217.9525 11.625307 194.7943 239.8714
 [23,] 222.8652  9.975335 202.7448 242.0626
 [24,] 227.7779  8.758428 209.9525 244.5692
 [25,] 232.6906  8.170438 216.3740 248.6117
 [26,] 237.6033  8.345375 220.7456 253.5925
 [27,] 242.5160  9.240007 224.1795 260.3959
 [28,] 247.4287 10.674897 226.2022 268.2351
 [29,] 252.3414 12.464844 227.7427 276.4647
 [30,] 257.2541 14.478760 228.4978 285.9957
 [31,] 274.6168 13.680653 248.8557 301.4649
 [32,] 280.3872 11.698557 258.1456 303.5623
 [33,] 286.1576  9.988832 267.0204 306.1403
 [34,] 291.9280  8.713315 274.9917 309.2519
 [35,] 297.6984  8.080316 281.6296 313.5451
 [36,] 303.4688  8.239279 287.0113 319.4978
 [37,] 309.2392  9.149015 291.5326 326.7123
 [38,] 315.0096 10.618277 294.5938 335.5071
 [39,] 320.7800 12.450529 296.7013 344.5880
 [40,] 326.5504 14.508898 298.3968 354.3687
 [41,] 273.1228 12.998811 248.1053 298.7492
 [42,] 280.6055 11.144787 258.8895 302.5466
 [43,] 288.0883  9.564887 269.2836 306.7153
 [44,] 295.5710  8.414954 279.0981 312.1456
 [45,] 303.0538  7.885396 287.7169 318.6241
 [46,] 310.5365  8.098833 294.6593 326.7247
 [47,] 318.0193  9.002574 300.2512 335.7630
 [48,] 325.5020 10.418502 305.2097 345.8503
 [49,] 332.9847 12.169127 309.2351 357.0072
 [50,] 340.4675 14.130596 312.4662 368.6699
 [51,] 260.2205 12.282436 236.1209 283.8105
 [52,] 270.4673 10.640264 250.0572 291.4582
 [53,] 280.7141  9.288865 262.9995 298.9434
 [54,] 290.9610  8.370282 274.9909 307.6902
 [55,] 301.2078  8.034365 285.6818 317.1664
 [56,] 311.4547  8.351719 295.2423 327.5891
 [57,] 321.7015  9.255388 303.3061 339.4856
 [58,] 331.9483 10.596415 310.8074 352.3856
 [59,] 342.1952 12.231787 317.8659 365.9968
 [60,] 352.4420 14.059161 324.6224 379.5296
 [61,] 268.0291 12.951277 243.0431 294.3083
 [62,] 278.3288 11.146994 256.6936 300.8520
 [63,] 288.6286  9.614782 269.6586 307.9859
 [64,] 298.9283  8.503012 282.2407 315.9180
 [65,] 309.2280  7.989183 293.8836 324.9061
 [66,] 319.5278  8.186665 303.6285 335.6490
 [67,] 329.8275  9.049010 312.3177 347.4991
 [68,] 340.1272 10.412315 319.7583 360.7148
 [69,] 350.4270 12.108537 326.5026 374.3116
 [70,] 360.7267 14.017334 332.8884 387.9504
 [71,] 244.2709 12.263235 219.7118 268.5745
 [72,] 255.8623 10.583449 234.8827 276.9518
 [73,] 267.4537  9.186339 249.2044 285.5540
 [74,] 279.0451  8.217375 262.6690 295.3522
 [75,] 290.6366  7.837005 275.7967 305.7617
 [76,] 302.2280  8.128286 286.3351 317.8568
 [77,] 313.8194  9.026428 295.7152 331.4327
 [78,] 325.4108 10.375006 304.7215 345.6315
 [79,] 337.0022 12.023397 312.9406 360.6898
 [80,] 348.5937 13.865078 320.9462 375.9049
 [81,] 250.7184 13.124968 224.8687 276.0281
 [82,] 250.4653 11.188320 228.5331 271.9570
 [83,] 250.2122  9.526435 231.4400 268.3744
 [84,] 249.9591  8.305910 233.4831 265.8843
 [85,] 249.7060  7.738479 234.4614 264.7580
 [86,] 249.4529  7.964967 233.8585 265.0208
 [87,] 249.1998  8.925138 231.3234 266.5858
 [88,] 248.9466 10.418071 227.9427 269.3080
 [89,] 248.6935 12.250512 223.8532 272.7770
 [90,] 248.4404 14.292467 219.6312 276.9597
 [91,] 285.8674 12.885860 261.1486 311.5935
 [92,] 305.0248 11.053903 283.7417 327.1912
 [93,] 324.1823  9.512321 305.5703 342.7261
 [94,] 343.3398  8.422104 327.1351 359.7255
 [95,] 362.4973  7.970665 347.1855 377.9200
 [96,] 381.6548  8.263369 365.6149 397.6571
 [97,] 400.8123  9.229688 383.0066 419.0717
 [98,] 419.9698 10.688457 399.2516 441.0565
 [99,] 439.1273 12.468006 414.9810 463.7046
[100,] 458.2848 14.450305 430.0957 486.9023
[101,] 226.7849 12.916128 200.2790 250.7286
[102,] 238.3394 11.125341 215.9237 259.0980
[103,] 249.8940  9.609501 230.2950 268.0755
[104,] 261.4486  8.516704 244.4551 277.7072
[105,] 273.0032  8.021745 257.0058 288.5054
[106,] 284.5578  8.233163 268.1333 300.7472
[107,] 296.1124  9.101867 278.3977 314.4801
[108,] 307.6669 10.465439 287.1515 328.5413
[109,] 319.2215 12.158506 295.2921 342.8135
[110,] 330.7761 14.062559 303.0112 358.5365
[111,] 238.5109 12.980547 212.0297 263.3725
[112,] 255.5376 11.074002 233.4613 276.6013
[113,] 272.5642  9.455290 253.8046 290.9446
[114,] 289.5909  8.294671 273.0636 305.6143
[115,] 306.6175  7.799404 291.0009 321.8959
[116,] 323.6441  8.092584 307.6516 338.8730
[117,] 340.6708  9.098307 322.9185 357.8767
[118,] 357.6974 10.615958 336.9914 377.9820
[119,] 374.7240 12.459855 350.2097 398.9983
[120,] 391.7507 14.506119 363.6196 420.1972
[121,] 255.8268 12.575145 230.8247 280.2291
[122,] 263.3201 10.777164 241.8628 284.1335
[123,] 270.8133  9.257578 252.0004 288.9734
[124,] 278.3065  8.173171 261.7182 294.4689
[125,] 285.7998  7.709811 270.5920 300.6282
[126,] 293.2930  7.976475 277.4618 308.6322
[127,] 300.7862  8.907840 283.1798 318.1966
[128,] 308.2795 10.325579 288.0715 328.5623
[129,] 315.7727 12.059355 292.9138 340.0448
[130,] 323.2659 13.992176 296.6562 351.5198
[131,] 272.1068 12.794301 247.6978 297.1815
[132,] 286.1571 11.016960 265.0974 307.7479
[133,] 300.2074  9.506755 282.0011 318.8174
[134,] 314.2578  8.408869 297.9904 330.9008
[135,] 328.3081  7.897183 312.9553 343.8938
[136,] 342.3585  8.083787 326.5465 357.8673
[137,] 356.4088  8.924989 338.6613 373.7739
[138,] 370.4592 10.261042 350.4685 390.3047
[139,] 384.5095 11.926786 361.3188 407.6671
[140,] 398.5598 13.803376 371.6704 425.3653
[141,] 254.4979 12.034660 230.9651 278.0199
[142,] 265.8371 10.338603 245.5331 286.3567
[143,] 277.1764  8.931200 259.9812 295.1170
[144,] 288.5156  7.966927 273.0865 304.3024
[145,] 299.8549  7.616001 284.9497 314.9584
[146,] 311.1941  7.959961 295.3563 327.1664
[147,] 322.5333  8.918770 304.7518 340.2204
[148,] 333.8726 10.322494 313.7748 354.0416
[149,] 345.2118 12.016208 322.2565 368.7043
[150,] 356.5511 13.894265 329.6663 383.9143
[151,] 226.1454 13.731913 198.7332 253.9889
[152,] 241.3983 11.713516 218.0751 264.8459
[153,] 256.6512  9.965589 237.0106 276.9710
[154,] 271.9042  8.653609 254.5878 289.0790
[155,] 287.1571  7.995149 271.4589 302.7737
[156,] 302.4100  8.150175 286.1280 318.1454
[157,] 317.6630  9.077101 299.8540 335.2784
[158,] 332.9159 10.574860 312.5804 353.8544
[159,] 348.1689 12.438932 324.0943 373.0548
[160,] 363.4218 14.529001 335.2695 392.2000
[161,] 252.3844 12.503275 228.1372 277.3230
[162,] 261.8146 10.813169 241.1901 283.6549
[163,] 271.2447  9.408907 253.3637 289.8151
[164,] 280.6749  8.434491 264.7218 297.1420
[165,] 290.1051  8.047603 274.2362 305.7698
[166,] 299.5352  8.330509 283.2813 315.9516
[167,] 308.9654  9.221770 290.8704 326.7877
[168,] 318.3956 10.568580 297.3186 338.8058
[169,] 327.8257 12.221249 303.7630 351.5517
[170,] 337.2559 14.072425 309.5999 364.1370
[171,] 263.4278 12.252509 240.0754 288.0203
[172,] 275.2252 10.572205 254.7990 295.8039
[173,] 287.0225  9.173004 269.6395 305.1669
[174,] 298.8199  8.200086 283.4176 314.7968
[175,] 310.6172  7.814329 295.5242 325.8396
[176,] 322.4145  8.100060 306.6483 338.5006
[177,] 334.2119  8.993506 316.4091 352.0035
[178,] 346.0092 10.338290 325.6534 366.1235
[179,] 357.8066 11.983415 334.1497 381.0353
[180,] 369.6039 13.822054 342.3220 396.1479</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.1157901 12.969353  -29.5316743  21.3274123
  [2,]  -14.6277374 11.100008  -36.3717694   7.3041430
  [3,]  -42.1884847  9.508779  -61.0356022 -23.5990705
  [4,]    8.7940680  8.356091   -8.0964964  25.1131827
  [5,]   24.5495208  7.837874    8.8945399  40.0780599
  [6,]   62.7310735  8.077186   46.8916607  79.0829897
  [7,]   10.5881262  9.013893   -6.8710982  28.2775595
  [8,] -101.1237211 10.462325 -120.9490398 -80.4824923
  [9,]   19.6563317 12.242176   -4.1363081  44.0779786
 [10,]   35.7678844 14.229623    8.2360962  63.6982897
 [11,]   11.2972151 13.382383  -14.5525142  37.2110998
 [12,]   -7.9407328 11.476212  -30.4070049  14.1473596
 [13,]  -11.9985806  9.835328  -31.3844895   6.8960151
 [14,]  -12.0392284  8.612714  -28.9469441   4.3424854
 [15,]  -10.7999763  8.002435  -26.6990921   4.5208340
 [16,]   -4.3241241  8.143343  -20.5157361  11.3824218
 [17,]   -8.4254720  9.000226  -26.2384575   9.0235387
 [18,]   -6.0984198 10.397549  -26.1126323  14.2001755
 [19,]   -1.2997676 12.150266  -24.9513225  22.2575973
 [20,]    9.9488845 14.126706  -17.4466999  37.6823809
 [21,]  -13.9858755 13.551069  -39.3167850  12.8333671
 [22,]  -23.6202816 11.625307  -45.5392248  -0.4620807
 [23,]   11.4548123  9.975335   -7.7425768  31.5751831
 [24,]    5.0637062  8.758428  -11.7275631  22.8890587
 [25,]   -3.3832000  8.170438  -19.3043331  12.9334007
 [26,]  -17.1454061  8.345375  -33.1345603  -0.2876608
 [27,]   -7.0952122  9.240007  -24.9750709  11.2412755
 [28,]    8.3223817 10.674897  -12.4840162  29.5488529
 [29,]    8.6710756 12.464844  -15.4522338  33.2697736
 [30,]   -9.7388305 14.478760  -38.4803934  19.0175338
 [31,]   46.9258069 13.680653   20.0776680  72.6868990
 [32,]   20.0130052 11.698557   -3.1620742  42.2546228
 [33,]   -2.3010965  9.988832  -22.2837605  16.8361334
 [34,]   -6.7949982  8.713315  -24.1188938  10.1413334
 [35,]  -11.9011000  8.080316  -27.7478070   4.1676914
 [36,]   -5.8833017  8.239279  -21.9123313  10.5742134
 [37,]  -28.9996034  9.149015  -46.4727077 -11.2930165
 [38,]    3.2516948 10.618277  -17.2458342  23.6674776
 [39,]  -15.4305069 12.450529  -39.2385445   8.6482098
 [40,]   27.4982914 14.508898   -0.3200185  55.6519324
 [41,]   14.4851128 12.998811  -11.1413230  39.5025865
 [42,]    4.3944677 11.144787  -17.5465918  26.1105318
 [43,]   13.7323227  9.564887   -4.8946636  32.5369970
 [44,]   24.5442777  8.414954    7.9697416  41.0171763
 [45,]   13.2235327  7.885396   -2.3467769  28.5604134
 [46,]  -17.2178124  8.098833  -33.4060219  -1.3406420
 [47,]  -27.9442574  9.002574  -45.6879673 -10.1761944
 [48,]    9.3156976 10.418502  -11.0325862  29.6080450
 [49,]  -39.2378475 12.169127  -63.2602911 -15.4881783
 [50,]   31.1136075 14.130596    2.9112279  59.1149455
 [51,]  -25.3598556 12.282436  -48.9498624  -1.2602736
 [52,]  -27.6554976 10.640264  -48.6463856  -7.2454383
 [53,]   -7.7528395  9.288865  -25.9821289   9.9618175
 [54,]   18.8078185  8.370282    2.0785662  34.7779003
 [55,]   16.2550766  8.034365    0.2965287  31.7810821
 [56,]   -1.4570653  8.351719  -17.5914776  14.7552592
 [57,]  132.4603927  9.255388  114.6763343 150.8558383
 [58,]   14.8827508 10.596415   -5.5544745  36.0236959
 [59,]  -11.8948912 12.231787  -35.6965426  12.4343668
 [60,]  -98.5776331 14.059161 -125.6651836 -70.7579973
 [61,]   15.8133136 12.951277  -10.4659031  40.7993424
 [62,]   11.2261793 11.146994  -11.2970383  32.8614346
 [63,]  -11.8592549  9.614782  -31.2166023   7.1106521
 [64,]    0.8814109  8.503012  -16.1082903  17.5689967
 [65,]  -12.0570233  7.989183  -27.7350928   3.2874491
 [66,]   18.6387425  8.186665    2.5175013  34.5379649
 [67,]    2.1990082  9.049010  -15.4726298  19.7087835
 [68,]    8.7126740 10.412315  -11.8749474  29.0816419
 [69,]  -17.0669602 12.108537  -40.9516434   6.8574089
 [70,]    1.3161056 14.017334  -25.9075829  29.1544477
 [71,]   21.2022048 12.263235   -3.1014438  45.7613359
 [72,]   20.3388873 10.583449   -0.7506376  41.3184900
 [73,]  -24.0890302  9.186339  -42.1892575  -5.8397179
 [74,]  -24.3728477  8.217375  -40.6799058  -7.9967234
 [75,]  -11.6121651  7.837005  -26.7373206   3.2277074
 [76,]  -18.0367826  8.128286  -33.6656199  -2.1439217
 [77,]   -8.2946001  9.026428  -25.9078785   9.8096300
 [78,]    6.1120824 10.375006  -14.1086257  26.8014094
 [79,]   -1.2553351 12.023397  -24.9429400  22.8063077
 [80,]   28.7053475 13.865078    1.3940914  56.3528422
 [81,]   -9.1100932 13.124968  -34.4198038  16.7395862
 [82,]   23.4819132 11.188320    1.9902038  45.4141318
 [83,]    4.2785195  9.526435  -13.8837451  23.0507161
 [84,]   20.8430259  8.305910    4.9177778  37.3190352
 [85,]    1.7459323  7.738479  -13.3060950  16.9904825
 [86,]    5.1833386  7.964967  -10.3846337  20.7777457
 [87,]   -3.7474550  8.925138  -21.1335080  14.1288588
 [88,]  -13.6356487 10.418071  -33.9969584   7.3682589
 [89,]  -12.9394423 12.250512  -37.0228596  11.9008761
 [90,]  -11.1938359 14.292467  -39.7130913  17.6154490
 [91,]   26.4992407 12.885860    0.7731300  51.2180075
 [92,]    8.7809508 11.053903  -13.3854004  30.0640893
 [93,]  -32.5711391  9.512321  -51.1149431 -13.9590938
 [94,]    2.7823710  8.422104  -13.6033102  18.9871473
 [95,]    3.2350811  7.970665  -12.1875741  18.5468833
 [96,]   10.1836912  8.263369   -5.8185705  26.2236176
 [97,]    3.4478013  9.229688  -14.8116131  21.2534985
 [98,]   -3.2774886 10.688457  -24.3641889  17.4406529
 [99,]   16.7370215 12.468006   -7.8403423  40.8832790
[100,]    0.6319316 14.450305  -27.9856475  28.8209504
[101,]    9.3183485 12.916128  -14.6254482  35.8241501
[102,]   -8.0227364 11.125341  -28.7812709  14.3930085
[103,]  -10.9684212  9.609501  -29.1498701   8.6306099
[104,]   -6.5266060  8.516704  -22.7851666  10.4668772
[105,]  -22.2928908  8.021745  -37.7950903  -6.2954588
[106,]  -14.7833756  8.233163  -30.9728378   1.6410578
[107,]  -14.5475604  9.101867  -32.9153482   3.1670760
[108,]    0.4350548 10.465439  -20.4393231  20.9504507
[109,]   17.0590700 12.158506   -6.5329365  40.9885157
[110,]   20.8689852 14.062559   -6.8914456  48.6338901
[111,]   17.7858608 12.980547   -7.0756846  44.2671429
[112,]  -12.0832777 11.074002  -33.1470109   9.9929662
[113,]  -16.3596161  9.455290  -34.7399752   2.4000336
[114,]  -34.0637545  8.294671  -50.0872292 -17.5364860
[115,]  -37.7009929  7.799404  -52.9794458 -22.0843776
[116,]    6.0805687  8.092584   -9.1482931  22.0730798
[117,]   38.7737303  9.098307   21.5677857  56.5260248
[118,]    5.2209919 10.615958  -15.0635956  25.9270024
[119,]   19.7631535 12.459855   -4.5111065  44.2775445
[120,]   -2.6979849 14.506119  -31.1444534  25.4330791
[121,]   -5.3003470 12.575145  -29.7026488  19.7017657
[122,]   36.7375229 10.777164   15.9240536  58.1948412
[123,]   -0.9194072  9.257578  -19.0795082  17.8935454
[124,]    2.2825627  8.173171  -13.8798293  18.8708574
[125,]  -13.9723674  7.709811  -28.8008160   1.2353910
[126,]   11.3406025  7.976475   -3.9986250  27.1717972
[127,]  -13.0396276  8.907840  -30.4499989   4.5667575
[128,]  -41.6839577 10.325579  -61.9667997 -21.4759827
[129,]    5.7691122 12.059355  -18.5029563  28.6280224
[130,]   24.2995821 13.992176   -3.9543161  50.9093142
[131,]  -50.4296605 12.794301  -75.5044204 -26.0207277
[132,]   12.0367972 11.016960   -9.5539552  33.0965239
[133,]   26.6710548  9.506755    8.0611117  44.8774207
[134,]   32.5977124  8.408869   15.9547327  48.8651369
[135,]   20.4320700  7.897183    4.8464207  35.7849183
[136,]   10.4702276  8.083787   -5.0385966  26.2821603
[137,]   -1.9822148  8.924989  -19.3472629  15.7653162
[138,]  -10.0265572 10.261042  -29.8720784   9.9640663
[139,]   -8.8688996 11.926786  -32.0265258  14.3217944
[140,]  -10.0181420 13.803376  -36.8235877  16.8712594
[141,]   17.4256182 12.034660   -6.0964135  40.9583910
[142,]    2.5997750 10.338603  -17.9197891  22.9038261
[143,]  -19.9339682  8.931200  -37.8746026  -2.7388253
[144,]  -10.8590114  7.966927  -26.6458485   4.5701183
[145,]   14.9673454  7.616001   -0.1362197  29.8725077
[146,]    6.0194022  7.959961   -9.9529379  21.8572202
[147,]  -24.3980410  8.918770  -42.0851372  -6.6164902
[148,]   14.2503158 10.322494   -5.9187033  34.3481250
[149,]   -4.9318273 12.016208  -28.4243160  18.0234695
[150,]    9.9620295 13.894265  -17.4011825  36.8467898
[151,]   -0.8813583 13.731913  -28.7248834  26.5308187
[152,]   -6.8747963 11.713516  -30.3223559  16.4483815
[153,]  -17.7504343  9.965589  -38.0701792   1.8901559
[154,]  -31.4311723  8.653609  -48.6060053 -14.1147502
[155,]  -19.6198103  7.995149  -35.2363604  -3.9215571
[156,]   41.7836517  8.150175   26.0483196  58.0656527
[157,]  -36.5148864  9.077101  -54.1303199 -18.7059051
[158,]   14.6695756 10.574860   -6.2688700  35.0050945
[159,]   16.9941376 12.438932   -7.8918180  41.0687445
[160,]    8.8069996 14.529001  -19.9711621  36.9592954
[161,]   17.4959860 12.503275   -7.4425582  41.7432332
[162,]   10.6282203 10.813169  -11.2121201  31.2527443
[163,]    6.6541546  9.408907  -11.9162349  24.5351918
[164,]    1.1145888  8.434491  -15.3524643  17.0676757
[165,]  -10.9345769  8.047603  -26.5993250   4.9342956
[166,]  -15.0232426  8.330509  -31.4396200   1.2307489
[167,]  -49.6996083  9.221770  -67.5219329 -31.6046112
[168,]  -13.7649740 10.568580  -34.1752490   7.3119510
[169,]   22.9549603 12.221249   -0.7709699  47.0177231
[170,]   32.2132946 14.072425    5.3321868  59.8693361
[171,]    5.9838599 12.252509  -18.6085710  29.3363075
[172,]   -1.7511811 10.572205  -22.3299252  18.6750033
[173,]   10.5742778  9.173004   -7.5700793  27.9572913
[174,]   11.8117368  8.200086   -4.1651514  27.2140237
[175,]  -23.4446043  7.814329  -38.6669971  -8.3516292
[176,]    7.1930547  8.100060   -8.8929759  22.9593137
[177,]    0.2699136  8.993506  -17.5217089  18.0726695
[178,]   -2.7893274 10.338290  -22.9035567  17.5665069
[179,]   11.3351315 11.983415  -11.8935620  34.9920098
[180,]   -5.4803095 13.822054  -32.0242830  21.8015948</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.4
p_loo        19.2  3.3
looic      1769.3 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1311      
 (0.5, 0.7]   (ok)         2    1.1%   162       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.5
p_loo        34.0  8.6
looic      1722.0 45.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   807       
 (0.5, 0.7]   (ok)         2    1.1%   760       
   (0.7, 1]   (bad)        2    1.1%   56        
   (1, Inf)   (very bad)   2    1.1%   11        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.6      11.8  
fit_sleep1 -92.3      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.4
p_loo        19.2  3.3
looic      1769.3 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1311      
 (0.5, 0.7]   (ok)         2    1.1%   162       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.5
p_loo        34.0  8.6
looic      1722.0 45.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   807       
 (0.5, 0.7]   (ok)         2    1.1%   760       
   (0.7, 1]   (bad)        2    1.1%   56        
   (1, Inf)   (very bad)   2    1.1%   11        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.0     22.5        34.0    8.6   1722.0
fit_sleep2  -23.6      11.8  -884.7     14.4        19.2    3.3   1769.3
fit_sleep1  -92.3      21.1  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   45.0  
fit_sleep2   28.7  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.581430e-41 5.397008e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.87      1.62     0.18     5.51       0.05      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.13      1.62    -3.41     2.99       5.13      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.0         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
