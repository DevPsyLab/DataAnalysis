<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.09      6.92    15.75    43.03 1.00     1588     2395
sd(Days)                6.54      1.50     4.15     9.96 1.00     1355     2327
cor(Intercept,Days)     0.09      0.30    -0.47     0.67 1.00      949     1690

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.28      7.52   236.11   266.30 1.00     1715     2148
Days         10.46      1.62     7.25    13.74 1.01     1404     2013

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.58    23.06    29.21 1.00     3607     2800

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7893  13.09510 228.0046 279.5436
309 211.4897  13.12662 185.7986 237.2145
310 212.8287  12.98631 186.9840 237.6453
330 274.4291  13.69333 247.6526 301.6733
331 273.0079  13.32294 247.2282 300.7124
332 260.3486  12.15712 236.7119 284.5083
333 267.8097  12.61041 243.3442 293.1966
334 244.4823  12.25751 219.9920 268.3242
335 250.8796  13.07380 225.8139 276.3227
337 285.9282  13.41321 259.8400 312.3931
349 226.7865  12.70019 201.4883 251.1319
350 239.1441  13.04439 212.6661 263.8249
351 255.7418  12.56764 232.1249 281.0534
352 272.0387  12.74395 247.7182 297.9244
369 254.6628  12.01442 230.0832 278.5302
370 226.0644  13.50832 198.5956 251.7682
371 252.1756  12.49130 228.2239 276.8003
372 263.7160  12.18575 239.8407 288.1110

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6138069  2.515883 14.8039394 24.524135
309  1.7702799  2.461196 -3.0025131  6.535173
310  4.9599105  2.442677  0.1787844  9.936495
330  5.7755685  2.611585  0.5861653 10.836003
331  7.5040992  2.518948  2.4180286 12.472101
332 10.2116858  2.326549  5.5979043 14.824735
333 10.3628272  2.387091  5.6103062 14.869521
334 11.4686076  2.358555  6.9054024 16.238009
335 -0.2731029  2.528063 -5.0451356  4.859045
337 19.1278155  2.513712 14.1181396 23.964139
349 11.5366348  2.411218  6.8686656 16.383938
350 16.9033709  2.438813 12.2483667 21.845719
351  7.4846837  2.395102  2.7053425 12.173678
352 14.0409874  2.397297  9.2557541 18.717754
369 11.3355700  2.291296  6.7947976 15.783161
370 15.2236906  2.560290 10.3181520 20.221073
371  9.4729445  2.377582  4.9121124 14.208617
372 11.7617086  2.376529  7.0810917 16.445963</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7893 13.095096 228.0046 279.5436
  [2,] 273.4031 11.198307 251.5855 295.1645
  [3,] 293.0169  9.590721 274.2390 311.5088
  [4,] 312.6307  8.439260 296.1512 328.8427
  [5,] 332.2446  7.944787 316.5831 347.5913
  [6,] 351.8584  8.226633 335.3297 367.4130
  [7,] 371.4722  9.213830 352.8067 389.2094
  [8,] 391.0860 10.713132 369.5204 411.7930
  [9,] 410.6998 12.542210 385.8759 435.1226
 [10,] 430.3136 14.577456 401.7042 458.9117
 [11,] 211.4897 13.126621 185.7986 237.2145
 [12,] 213.2600 11.283609 191.0835 235.6115
 [13,] 215.0302  9.718357 196.0040 234.2933
 [14,] 216.8005  8.584175 199.8276 233.8296
 [15,] 218.5708  8.065025 202.7676 234.5180
 [16,] 220.3411  8.277449 204.1077 237.1195
 [17,] 222.1114  9.170751 204.2031 240.7087
 [18,] 223.8816 10.573749 203.4525 244.9745
 [19,] 225.6519 12.313432 202.1366 250.2629
 [20,] 227.4222 14.267166 200.2259 255.9602
 [21,] 212.8287 12.986310 186.9840 237.6453
 [22,] 217.7886 11.139134 195.6527 239.2405
 [23,] 222.7485  9.562933 204.1524 241.1493
 [24,] 227.7084  8.411446 211.0408 244.5236
 [25,] 232.6683  7.873277 217.1896 248.6474
 [26,] 237.6282  8.072044 221.7460 253.6618
 [27,] 242.5881  8.958830 225.2124 260.1609
 [28,] 247.5480 10.358413 227.1618 267.9013
 [29,] 252.5080 12.094054 228.9104 276.6650
 [30,] 257.4679 14.041684 230.2606 285.8384
 [31,] 274.4291 13.693332 247.6526 301.6733
 [32,] 280.2047 11.671190 257.3717 303.6168
 [33,] 285.9803  9.928079 266.9615 305.7647
 [34,] 291.7558  8.634673 275.1182 308.8035
 [35,] 297.5314  8.011815 282.0625 313.2687
 [36,] 303.3070  8.213496 287.4660 319.0559
 [37,] 309.0826  9.185566 291.1308 326.6740
 [38,] 314.8581 10.720471 294.0154 335.1628
 [39,] 320.6337 12.614401 296.1599 345.2167
 [40,] 326.4093 14.729511 297.7269 354.7442
 [41,] 273.0079 13.322936 247.2282 300.7124
 [42,] 280.5120 11.427739 258.5132 304.2934
 [43,] 288.0161  9.817128 268.5540 308.0213
 [44,] 295.5202  8.651530 278.6506 312.4991
 [45,] 303.0243  8.124786 286.9041 319.0646
 [46,] 310.5284  8.358560 293.9457 326.1889
 [47,] 318.0325  9.295649 299.9949 335.7489
 [48,] 325.5366 10.753736 304.5544 346.0394
 [49,] 333.0407 12.552561 308.3772 357.3028
 [50,] 340.5448 14.566432 312.1824 369.3556
 [51,] 260.3486 12.157122 236.7119 284.5083
 [52,] 270.5603 10.441398 250.2361 291.6059
 [53,] 280.7719  9.004199 263.4103 298.7955
 [54,] 290.9836  7.997129 275.1981 306.6051
 [55,] 301.1953  7.593300 286.1685 316.0975
 [56,] 311.4070  7.885937 296.0048 327.1376
 [57,] 321.6187  8.805875 304.4612 339.0179
 [58,] 331.8304 10.184525 311.6809 351.8554
 [59,] 342.0421 11.863022 318.8377 365.2219
 [60,] 352.2537 13.731850 325.6368 379.2029
 [61,] 267.8097 12.610415 243.3442 293.1966
 [62,] 278.1725 10.868098 257.1128 300.1586
 [63,] 288.5354  9.413019 270.3574 307.2107
 [64,] 298.8982  8.395875 282.7140 315.5798
 [65,] 309.2610  7.985794 293.5580 325.0335
 [66,] 319.6238  8.273542 303.3014 335.6304
 [67,] 329.9867  9.193829 311.9553 347.5299
 [68,] 340.3495 10.582906 319.4946 360.5053
 [69,] 350.7123 12.282740 326.5969 374.0912
 [70,] 361.0751 14.182027 332.6684 388.0956
 [71,] 244.4823 12.257514 219.9920 268.3242
 [72,] 255.9509 10.562599 234.7843 276.6898
 [73,] 267.4195  9.166020 249.2501 285.5379
 [74,] 278.8881  8.221248 262.6840 294.9985
 [75,] 290.3567  7.892241 275.0377 305.9689
 [76,] 301.8253  8.252975 285.7608 317.8343
 [77,] 313.2939  9.222868 295.0781 331.2698
 [78,] 324.7625 10.636566 303.9359 345.5474
 [79,] 336.2311 12.342502 312.4532 360.3293
 [80,] 347.6998 14.236002 319.9399 375.4478
 [81,] 250.8796 13.073799 225.8139 276.3227
 [82,] 250.6065 11.160513 229.1252 272.2354
 [83,] 250.3334  9.537928 231.7818 268.7652
 [84,] 250.0603  8.376712 233.7721 266.3724
 [85,] 249.7872  7.883448 234.3346 265.3936
 [86,] 249.5141  8.179878 233.2507 265.8704
 [87,] 249.2409  9.189900 231.0313 267.4136
 [88,] 248.9678 10.713559 228.2465 270.2227
 [89,] 248.6947 12.565374 224.4048 273.9845
 [90,] 248.4216 14.621187 220.3504 278.3003
 [91,] 285.9282 13.413206 259.8400 312.3931
 [92,] 305.0560 11.497068 282.6272 328.0663
 [93,] 324.1838  9.853352 304.8951 344.0712
 [94,] 343.3116  8.638983 326.2477 360.4232
 [95,] 362.4394  8.050652 346.3772 378.0185
 [96,] 381.5673  8.223835 365.0678 397.6941
 [97,] 400.6951  9.115231 382.8137 418.7427
 [98,] 419.8229 10.544235 399.1637 440.5576
 [99,] 438.9507 12.325253 415.0329 463.1798
[100,] 458.0785 14.327607 430.5627 486.2747
[101,] 226.7865 12.700190 201.4883 251.1319
[102,] 238.3232 10.882527 216.8582 259.3470
[103,] 249.8598  9.337661 231.6400 268.0859
[104,] 261.3964  8.220851 245.4424 277.2271
[105,] 272.9331  7.720155 257.9224 287.7820
[106,] 284.4697  7.952808 268.9955 299.4730
[107,] 296.0063  8.861233 278.6108 312.7807
[108,] 307.5430 10.267604 287.6350 326.8009
[109,] 319.0796 11.998078 295.8630 341.7175
[110,] 330.6162 13.932409 303.5829 357.0682
[111,] 239.1441 13.044391 212.6661 263.8249
[112,] 256.0474 11.200296 233.2053 277.2690
[113,] 272.9508  9.624592 253.3433 291.4859
[114,] 289.8542  8.468442 272.8838 306.3700
[115,] 306.7575  7.917820 290.9384 322.2412
[116,] 323.6609  8.097212 307.3329 339.4388
[117,] 340.5643  8.962892 322.7290 358.2522
[118,] 357.4677 10.343967 336.7333 378.4088
[119,] 374.3710 12.064720 350.2391 398.6386
[120,] 391.2744 14.000461 363.1211 419.4765
[121,] 255.7418 12.567641 232.1249 281.0534
[122,] 263.2265 10.830911 242.9068 284.8876
[123,] 270.7111  9.388542 252.8684 289.6228
[124,] 278.1958  8.393678 262.0995 294.8319
[125,] 285.6805  8.014735 270.0815 301.6295
[126,] 293.1652  8.336135 276.7409 309.6440
[127,] 300.6499  9.285437 281.7269 319.0520
[128,] 308.1346 10.696756 286.8267 329.2392
[129,] 315.6192 12.413495 291.3933 340.2908
[130,] 323.1039 14.326275 295.2498 351.3338
[131,] 272.0387 12.743953 247.7182 297.9244
[132,] 286.0797 10.925048 264.9551 308.2203
[133,] 300.1207  9.370116 281.7722 318.6436
[134,] 314.1617  8.230160 298.1039 330.3794
[135,] 328.2027  7.691948 312.9514 343.2534
[136,] 342.2436  7.879762 326.2874 357.6243
[137,] 356.2846  8.746960 339.0957 373.4960
[138,] 370.3256 10.120377 350.6048 390.1966
[139,] 384.3666 11.824924 361.6460 407.9917
[140,] 398.4076 13.737892 371.4982 425.5346
[141,] 254.6628 12.014424 230.0832 278.5302
[142,] 265.9983 10.369580 244.9547 286.4972
[143,] 277.3339  9.011662 259.2067 294.9049
[144,] 288.6695  8.086531 272.7724 304.3670
[145,] 300.0051  7.750742 284.9451 314.9411
[146,] 311.3406  8.078124 295.7514 327.3404
[147,] 322.6762  8.996568 305.4451 340.2711
[148,] 334.0118 10.349902 314.4278 354.2690
[149,] 345.3473 11.991780 322.7913 368.9007
[150,] 356.6829 13.819738 330.1770 383.5248
[151,] 226.0644 13.508320 198.5956 251.7682
[152,] 241.2881 11.552314 217.8629 263.0622
[153,] 256.5118  9.876608 236.6742 274.9673
[154,] 271.7355  8.645750 254.3266 288.0135
[155,] 286.9592  8.066026 271.0047 302.0753
[156,] 302.1829  8.275429 286.1942 317.8896
[157,] 317.4066  9.220349 299.6092 334.9035
[158,] 332.6302 10.707808 311.9899 353.3553
[159,] 347.8539 12.546299 323.4202 372.2708
[160,] 363.0776 14.603844 334.7191 391.4817
[161,] 252.1756 12.491304 228.2239 276.8003
[162,] 261.6485 10.743040 240.9848 282.6035
[163,] 271.1215  9.278950 253.2553 289.0804
[164,] 280.5944  8.251709 264.7159 296.4610
[165,] 290.0674  7.835068 274.6065 304.8741
[166,] 299.5403  8.123526 283.8651 315.2985
[167,] 309.0132  9.049909 291.7643 327.0990
[168,] 318.4862 10.445851 298.2182 339.5946
[169,] 327.9591 12.150579 304.1691 352.4433
[170,] 337.4321 14.052156 310.0048 365.3762
[171,] 263.7160 12.185746 239.8407 288.1110
[172,] 275.4777 10.455634 255.3642 296.3078
[173,] 287.2394  9.024629 269.4826 305.3564
[174,] 299.0011  8.053779 283.3703 314.9638
[175,] 310.7628  7.718715 296.1142 325.9189
[176,] 322.5245  8.098737 306.8791 338.4412
[177,] 334.2862  9.104740 316.5497 351.9997
[178,] 346.0479 10.559300 325.2662 366.4478
[179,] 357.8096 12.304354 333.9391 382.0163
[180,] 369.5713 14.233454 342.0983 397.6923</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error        Q2.5      Q97.5
  [1,]   -4.3993987  29.59191  -62.641682  52.609560
  [2,]  -13.9789963  27.73914  -68.432546  40.035829
  [3,]  -41.5886123  27.32370  -94.450437  10.890915
  [4,]    8.0712449  27.40599  -46.996933  61.157987
  [5,]   25.0387118  26.76678  -27.884899  79.652737
  [6,]   63.4738114  26.97887   10.664383 115.127098
  [7,]   10.5097528  27.45986  -42.600848  63.205406
  [8,] -101.2016148  28.25233 -156.523445 -45.936012
  [9,]   19.8493815  28.96686  -37.927168  76.849664
 [10,]   36.3754271  29.44042  -21.078693  94.996236
 [11,]   10.7864383  29.54378  -47.686730  69.601801
 [12,]   -8.4098596  28.24500  -63.221818  47.018828
 [13,]  -12.7349150  27.79319  -67.127722  42.210394
 [14,]  -11.8682539  27.30320  -65.871609  42.011342
 [15,]  -10.3836735  27.00070  -63.941097  41.437304
 [16,]   -4.3242358  27.29787  -58.521103  49.689570
 [17,]   -7.6686369  27.09230  -61.400543  45.335700
 [18,]   -6.0276774  28.18008  -59.700108  48.678126
 [19,]   -1.7597740  28.74994  -58.151191  54.570269
 [20,]   10.4142598  29.58182  -49.140293  66.845794
 [21,]  -13.6048512  29.07853  -69.374143  45.900872
 [22,]  -23.2137388  28.45038  -81.000110  32.113744
 [23,]   11.1179916  27.76364  -42.755604  65.636405
 [24,]    5.0303968  27.37984  -48.225143  59.608105
 [25,]   -3.6595542  27.19194  -57.252663  49.530780
 [26,]  -17.4754844  26.80456  -69.689841  34.521853
 [27,]   -7.3315674  27.43521  -61.343771  46.449944
 [28,]    8.2698534  28.22171  -47.938343  62.491503
 [29,]    8.7561952  29.38689  -48.207698  66.974255
 [30,]  -10.2517817  29.20800  -66.356343  47.729562
 [31,]   47.3029904  29.49231   -9.786553 104.221229
 [32,]   20.7348498  28.44289  -34.140458  78.131551
 [33,]   -3.0621812  27.49184  -57.609443  50.240105
 [34,]   -6.5300233  27.53337  -59.064442  47.742724
 [35,]  -11.5353985  27.47459  -65.602106  42.988696
 [36,]   -6.3750357  27.33300  -59.331253  47.116715
 [37,]  -28.7015256  27.26106  -82.487284  24.652786
 [38,]    3.5382290  28.12914  -51.276398  58.115544
 [39,]  -15.5670430  28.87338  -72.669709  41.175996
 [40,]   28.1325057  29.36440  -28.658283  86.434875
 [41,]   14.9623944  29.30180  -43.558746  70.711722
 [42,]    4.1229374  28.78486  -51.023431  60.738827
 [43,]   13.9004063  27.62613  -39.748473  68.324724
 [44,]   24.8929802  27.30877  -27.382866  78.913889
 [45,]   13.1023496  26.86235  -40.369965  65.325171
 [46,]  -16.7792248  27.32741  -70.287283  36.268493
 [47,]  -27.8626801  27.37724  -81.463524  25.834724
 [48,]    9.2753124  28.54126  -46.789109  65.521713
 [49,]  -38.9654866  29.02216  -95.686399  17.853001
 [50,]   30.9163606  29.58701  -25.338981  87.795589
 [51,]  -25.4411316  28.84008  -81.360112  30.295773
 [52,]  -27.0807194  27.61615  -82.832263  28.100832
 [53,]   -8.0719160  27.38442  -61.470799  45.008237
 [54,]   18.1144878  26.87868  -34.827224  71.460811
 [55,]   16.2788777  27.08873  -36.948884  70.661765
 [56,]   -1.4395943  27.48004  -54.934000  53.145989
 [57,]  131.7605482  27.90143   75.811723 185.205342
 [58,]   14.5109546  27.66721  -39.072924  68.213015
 [59,]  -11.9440350  28.70955  -67.714837  44.157216
 [60,]  -97.8646655  29.75882 -156.985975 -40.734718
 [61,]   16.2779373  28.07696  -39.033087  71.147994
 [62,]   10.5035621  28.51750  -47.355836  65.875293
 [63,]  -11.2988091  26.97018  -64.337946  40.839267
 [64,]    1.0186903  27.71704  -51.892762  55.274539
 [65,]  -12.0380280  27.24926  -66.032271  40.048575
 [66,]   17.7982867  26.77607  -35.213266  69.482054
 [67,]    1.6933745  27.65190  -51.973840  54.966937
 [68,]    8.5852175  27.91884  -46.622908  62.856243
 [69,]  -17.6768158  28.47994  -73.269385  36.985600
 [70,]    1.7238996  30.11364  -57.866915  60.745983
 [71,]   21.8910095  28.76649  -33.922157  79.745148
 [72,]   20.1285969  27.88315  -35.024327  75.055470
 [73,]  -24.5204589  27.72636  -78.270250  30.450580
 [74,]  -25.2046993  27.22890  -79.295328  28.563422
 [75,]  -11.3944316  27.39174  -65.235814  41.617182
 [76,]  -18.1012000  27.49725  -71.289812  35.275287
 [77,]   -7.1223503  27.38356  -59.857044  48.088598
 [78,]    5.7887444  28.29005  -50.511080  60.497196
 [79,]   -0.3081339  28.83693  -58.681147  56.537165
 [80,]   29.6349411  29.56578  -28.415147  88.210057
 [81,]   -9.4343446  29.31898  -65.786229  48.387593
 [82,]   23.1814820  27.96147  -31.335229  79.010810
 [83,]    3.6039582  27.45177  -49.303683  59.094995
 [84,]   21.0948572  27.12092  -32.304846  75.120924
 [85,]    2.1481852  26.70298  -50.155445  54.428566
 [86,]    5.3751097  27.25531  -47.559330  58.522622
 [87,]   -3.4892104  27.75444  -56.911924  51.869264
 [88,]  -12.7764826  28.55293  -69.129886  42.189969
 [89,]  -13.1397056  28.16891  -67.428533  42.770943
 [90,]  -11.4524716  29.22061  -67.925499  45.419060
 [91,]   26.7438454  29.47587  -30.828481  85.388980
 [92,]    9.4442063  28.76808  -47.984136  64.315753
 [93,]  -33.1812625  27.89043  -87.037000  20.739099
 [94,]    2.7604598  27.23854  -51.403820  56.142042
 [95,]    3.5919070  27.06104  -48.538640  56.635630
 [96,]   10.8587509  27.04008  -40.916717  65.224332
 [97,]    3.5287907  27.30694  -49.892137  55.748322
 [98,]   -3.6311663  28.32620  -59.111379  52.687546
 [99,]   17.3863548  28.81037  -39.359488  73.707682
[100,]    1.3307327  29.66559  -57.962760  59.752407
[101,]    8.4992014  29.03236  -47.514888  64.960939
[102,]   -8.7102520  27.86889  -63.314618  45.437831
[103,]  -10.6168897  27.63545  -66.339371  44.096377
[104,]   -6.2741344  26.88045  -61.229992  46.305748
[105,]  -22.4450149  26.85418  -75.804795  29.518598
[106,]  -14.8535336  26.72543  -67.354832  38.159394
[107,]  -14.3845701  26.82380  -67.835729  37.991731
[108,]    0.1909865  28.03763  -53.592432  55.593272
[109,]   16.9973362  28.30135  -39.169792  72.385229
[110,]   21.2639183  29.27067  -35.596136  79.797580
[111,]   17.0339214  29.17840  -41.058324  73.669592
[112,]  -12.3311567  28.23034  -68.249843  45.656463
[113,]  -16.9608637  27.61861  -71.669207  37.389148
[114,]  -34.9035495  26.92154  -88.511642  17.314411
[115,]  -37.8835778  26.66670  -89.951196  13.794145
[116,]    5.6820278  27.30104  -48.516397  57.987691
[117,]   38.8538771  27.91655  -16.563661  93.783268
[118,]    5.9444815  28.33752  -48.569394  61.637377
[119,]   19.9589269  28.58070  -35.631647  76.991999
[120,]   -2.5754640  29.70451  -60.335759  56.971404
[121,]   -5.0204890  28.79361  -61.263867  50.544281
[122,]   36.3407140  27.61936  -18.029761  89.093518
[123,]   -1.2749134  27.88901  -56.958688  54.254638
[124,]    2.2793292  27.07549  -50.426611  54.525084
[125,]  -13.0111555  27.03389  -66.426697  38.859378
[126,]   11.5376310  27.82329  -43.961044  64.694295
[127,]  -12.7762705  27.26234  -67.031056  41.037211
[128,]  -40.9929836  28.09738  -96.600861  12.684557
[129,]    6.4088312  28.35160  -49.173870  61.749973
[130,]   24.8880145  30.38542  -36.844118  84.979876
[131,]  -50.8386255  29.07156 -108.598685   7.035534
[132,]   11.2072022  28.01077  -44.804989  65.203009
[133,]   26.4154393  28.29044  -28.232392  81.239825
[134,]   32.5473466  27.07348  -19.121122  85.918147
[135,]   20.9519336  27.54292  -32.201931  74.466040
[136,]   10.5774504  27.20547  -42.876217  64.401132
[137,]   -1.9699799  28.01821  -57.170617  52.896421
[138,]  -10.2924842  27.47546  -64.466098  43.024660
[139,]   -9.6049464  28.64266  -65.250867  46.083711
[140,]  -10.1638225  29.18027  -69.217911  46.140622
[141,]   17.4489279  29.27393  -40.011108  74.979034
[142,]    2.6443960  27.42283  -51.270010  57.195333
[143,]  -19.5817486  27.90337  -73.801395  34.283416
[144,]  -11.4079925  27.77826  -66.524605  44.743698
[145,]   15.5402954  27.62813  -38.104569  70.039818
[146,]    6.3683674  26.89450  -45.690844  60.111928
[147,]  -24.6141443  27.49368  -77.719725  29.616685
[148,]   13.6333495  27.93759  -42.867112  66.281567
[149,]   -5.4048676  28.33136  -61.801575  50.877933
[150,]   10.0154772  28.94145  -47.791893  67.582003
[151,]   -0.9640849  28.85759  -57.678755  54.853275
[152,]   -6.8139491  28.67898  -64.105689  49.102124
[153,]  -17.9979501  27.91242  -72.122351  37.288363
[154,]  -31.1264704  27.29157  -83.985140  23.140644
[155,]  -19.8548720  27.54621  -74.179847  33.480108
[156,]   42.4994304  27.18540   -9.935878  95.931048
[157,]  -36.3578701  27.61381  -90.638961  16.906974
[158,]   14.9899042  27.46267  -39.413482  68.530795
[159,]   17.5294976  28.62086  -37.524577  75.208925
[160,]    9.6088670  29.62426  -48.272708  67.397303
[161,]   17.8190824  28.39176  -37.351567  73.886919
[162,]   11.1899263  27.76248  -44.406473  65.042050
[163,]    6.5665173  28.04364  -47.398317  62.488801
[164,]    1.5588517  27.72079  -52.435360  56.877131
[165,]  -11.3367470  27.10343  -64.093711  41.725251
[166,]  -15.7447428  27.25678  -69.853182  37.647075
[167,]  -49.6017132  27.61895 -104.147651   4.253778
[168,]  -13.5734738  28.19736  -68.073466  41.352097
[169,]   22.0619149  28.15444  -32.730707  77.008557
[170,]   31.8771634  29.30897  -24.886044  88.380138
[171,]    5.5620027  28.68158  -49.513123  62.174938
[172,]   -2.1901132  27.70243  -56.584551  52.954482
[173,]   10.7322275  27.63821  -43.449152  63.447412
[174,]   11.8432302  27.14356  -42.183517  65.410667
[175,]  -23.6107955  26.91514  -75.308663  29.784868
[176,]    6.4206320  27.23785  -45.924979  60.253428
[177,]    0.6183925  27.64264  -53.419676  54.561606
[178,]   -2.3569320  27.40282  -56.758957  51.232874
[179,]   11.3408886  29.15198  -44.816529  68.947098
[180,]   -5.5446748  29.03658  -60.772602  51.421882</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1769.9 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   407       
 (0.5, 0.7]   (ok)         1    0.6%   167       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.3 22.5
p_loo        34.3  8.5
looic      1722.6 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   905       
 (0.5, 0.7]   (ok)         6    3.3%   285       
   (0.7, 1]   (bad)        2    1.1%   27        
   (1, Inf)   (very bad)   1    0.6%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.7      11.6  
fit_sleep1 -91.9      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1769.9 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   407       
 (0.5, 0.7]   (ok)         1    0.6%   167       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.3 22.5
p_loo        34.3  8.5
looic      1722.6 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   905       
 (0.5, 0.7]   (ok)         6    3.3%   285       
   (0.7, 1]   (bad)        2    1.1%   27        
   (1, Inf)   (very bad)   1    0.6%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.3     22.5        34.3    8.5   1722.6
fit_sleep2  -23.7      11.6  -885.0     14.4        19.5    3.4   1769.9
fit_sleep1  -91.9      21.1  -953.2     10.5         3.1    0.5   1906.4
           se_looic
fit_sleep3   44.9  
fit_sleep2   28.9  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.195470e-40 5.198789e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(
  set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
  set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
  set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))

bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.82      1.63     0.11      5.5       0.05      0.05     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.18      1.63     -3.5     3.06       5.21      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.20.4         Rcpp_1.0.11         rstan_2.26.23      
[4] StanHeaders_2.26.28 lme4_1.1-34         Matrix_1.6-1.1     

loaded via a namespace (and not attached):
  [1] tidyselect_1.2.0     dplyr_1.1.3          farver_2.1.1        
  [4] loo_2.6.0            fastmap_1.1.1        tensorA_0.36.2      
  [7] shinystan_2.6.0      shinyjs_2.1.0        promises_1.2.1      
 [10] digest_0.6.33        mime_0.12            lifecycle_1.0.3     
 [13] ellipsis_0.3.2       processx_3.8.2       magrittr_2.0.3      
 [16] posterior_1.4.1      compiler_4.3.1       rlang_1.1.1         
 [19] sass_0.4.7           tools_4.3.1          igraph_1.5.1        
 [22] utf8_1.2.3           yaml_2.3.7           knitr_1.44          
 [25] labeling_0.4.3       prettyunits_1.2.0    bridgesampling_1.1-2
 [28] htmlwidgets_1.6.2    pkgbuild_1.4.2       plyr_1.8.9          
 [31] dygraphs_1.1.1.6     abind_1.4-5          miniUI_0.1.1.1      
 [34] withr_2.5.1          grid_4.3.1           stats4_4.3.1        
 [37] fansi_1.0.4          xts_0.13.1           xtable_1.8-4        
 [40] colorspace_2.1-0     inline_0.3.19        ggplot2_3.4.3       
 [43] gtools_3.9.4         scales_1.2.1         MASS_7.3-60         
 [46] cli_3.6.1            mvtnorm_1.2-3        rmarkdown_2.25      
 [49] crayon_1.5.2         generics_0.1.3       RcppParallel_5.1.7  
 [52] rstudioapi_0.15.0    reshape2_1.4.4       minqa_1.2.6         
 [55] cachem_1.0.8         stringr_1.5.0        shinythemes_1.2.0   
 [58] splines_4.3.1        bayesplot_1.10.0     parallel_4.3.1      
 [61] base64enc_0.1-3      matrixStats_1.0.0    vctrs_0.6.3         
 [64] boot_1.3-28.1        jsonlite_1.8.7       callr_3.7.3         
 [67] crosstalk_1.2.0      jquerylib_0.1.4      glue_1.6.2          
 [70] nloptr_2.0.3         codetools_0.2-19     ps_1.7.5            
 [73] DT_0.29              distributional_0.3.2 stringi_1.7.12      
 [76] gtable_0.3.4         later_1.3.1          QuickJSR_1.0.6      
 [79] munsell_0.5.0        tibble_3.2.1         colourpicker_1.3.0  
 [82] pillar_1.9.0         htmltools_0.5.6      Brobdingnag_1.2-9   
 [85] R6_2.5.1             evaluate_0.22        shiny_1.7.5         
 [88] lattice_0.21-8       markdown_1.9         threejs_0.3.3       
 [91] backports_1.4.1      httpuv_1.6.11        bslib_0.5.1         
 [94] rstantools_2.3.1.1   coda_0.19-4          gridExtra_2.3       
 [97] nlme_3.1-162         checkmate_2.2.0      xfun_0.40           
[100] zoo_1.8-12           pkgconfig_2.0.3     </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoCiAgc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogIHNldF9wcmlvcigibGtqKDIpIiwgY2xhc3MgPSAiY29yIikpCgpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
