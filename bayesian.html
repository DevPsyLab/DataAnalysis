<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">Jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.84      6.98    15.17    42.54 1.00     1862     2519
sd(Days)                6.65      1.55     4.19    10.30 1.00     1479     2299
cor(Intercept,Days)     0.10      0.30    -0.46     0.67 1.00      971     1891

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.30      7.35   237.02   265.82 1.00     1963     2572
Days         10.49      1.75     7.07    14.03 1.00     1447     1911

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.86      1.54    23.00    29.06 1.00     3196     2909

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.8214  13.08739 228.4062 278.7117
309 211.4564  13.23697 185.9387 237.1773
310 212.9881  13.33471 186.6112 238.9090
330 274.3728  13.41208 249.0550 300.8503
331 272.9575  13.02937 248.2097 298.8624
332 260.2127  12.14013 237.3083 285.0170
333 267.7256  12.28437 244.5580 292.0496
334 244.2403  12.08223 220.5999 268.0012
335 250.6378  13.28389 225.0789 277.1694
337 285.8316  13.05948 261.1034 311.8441
349 226.9225  13.43937 199.8298 252.6320
350 238.8557  13.33079 212.0607 263.6568
351 255.8152  12.40125 232.2945 280.1603
352 272.0253  12.60898 247.8006 297.2361
369 254.7529  12.12379 231.4565 278.8014
370 226.6991  13.28214 200.1205 251.6862
371 252.1605  12.13883 228.9556 275.8084
372 263.3457  12.28778 239.3750 287.7514

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6397892  2.485598 14.9919183 24.649182
309  1.7394071  2.473308 -2.9473361  6.634963
310  4.9132925  2.491541  0.2331161  9.936536
330  5.7395171  2.554614  0.6653745 10.747469
331  7.5045292  2.483917  2.6979213 12.320615
332 10.2197694  2.341433  5.6459535 14.767069
333 10.3650430  2.330865  5.6807976 14.778102
334 11.4968975  2.333725  6.9570498 16.077032
335 -0.2468662  2.583257 -5.2961888  4.831323
337 19.1745194  2.477682 14.1852015 24.036491
349 11.5272528  2.533553  6.7074244 16.567995
350 16.9698031  2.469791 12.1448159 21.887115
351  7.4616253  2.346643  2.9216059 12.120462
352 14.0139785  2.408755  9.0933373 18.687815
369 11.3522160  2.315872  6.6277560 15.803393
370 15.1733415  2.555932 10.1856600 20.136230
371  9.4706272  2.350055  4.8353212 13.924947
372 11.8245537  2.360642  7.1080534 16.488657</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.8214 13.087387 228.4062 278.7117
  [2,] 273.4612 11.184463 251.9632 294.9219
  [3,] 293.1010  9.553068 274.7152 311.7576
  [4,] 312.7408  8.353825 296.8215 329.1015
  [5,] 332.3806  7.788971 317.2159 347.5564
  [6,] 352.0204  7.994131 336.1864 367.5625
  [7,] 371.6602  8.916310 354.0471 389.0820
  [8,] 391.3000 10.365879 371.4924 411.8665
  [9,] 410.9398 12.155603 387.5405 434.8372
 [10,] 430.5796 14.157059 403.1027 458.6646
 [11,] 211.4564 13.236969 185.9387 237.1773
 [12,] 213.1958 11.356555 191.4984 235.3519
 [13,] 214.9352  9.744734 196.3006 234.1626
 [14,] 216.6746  8.554696 200.1725 233.5809
 [15,] 218.4140  7.977488 202.8821 234.2854
 [16,] 220.1535  8.144465 204.4492 236.3171
 [17,] 221.8929  9.014367 204.6069 239.6296
 [18,] 223.6323 10.412484 203.4022 244.3685
 [19,] 225.3717 12.157933 201.7452 250.0607
 [20,] 227.1111 14.122512 199.1027 256.0870
 [21,] 212.9881 13.334713 186.6112 238.9090
 [22,] 217.9014 11.452578 195.1434 240.6424
 [23,] 222.8147  9.845002 203.3574 242.0811
 [24,] 227.7280  8.666149 210.6930 245.1098
 [25,] 232.6413  8.105292 216.7210 249.0342
 [26,] 237.5545  8.288844 221.4010 253.9945
 [27,] 242.4678  9.172222 224.1336 260.6041
 [28,] 247.3811 10.581584 226.6552 268.0483
 [29,] 252.2944 12.337980 228.3051 276.4595
 [30,] 257.2077 14.314228 229.4901 285.6099
 [31,] 274.3728 13.412080 249.0550 300.8503
 [32,] 280.1123 11.473591 258.8400 303.0251
 [33,] 285.8518  9.821141 267.8535 305.5009
 [34,] 291.5913  8.620814 274.9507 308.2953
 [35,] 297.3308  8.076768 281.2168 313.4045
 [36,] 303.0704  8.318775 286.5752 319.3081
 [37,] 308.8099  9.285579 290.2323 327.0452
 [38,] 314.5494 10.783971 293.4929 335.5769
 [39,] 320.2889 12.626092 295.7697 344.8008
 [40,] 326.0284 14.683136 297.2587 354.7376
 [41,] 272.9575 13.029369 248.2097 298.8624
 [42,] 280.4620 11.145738 259.2520 302.3766
 [43,] 287.9665  9.540973 269.7976 306.6464
 [44,] 295.4711  8.376905 279.0819 311.6500
 [45,] 302.9756  7.852045 287.4950 318.1267
 [46,] 310.4801  8.091747 294.2643 326.2769
 [47,] 317.9846  9.035365 299.7552 335.4731
 [48,] 325.4892 10.494711 304.3557 345.6913
 [49,] 332.9937 12.287383 308.2365 356.5069
 [50,] 340.4982 14.288467 311.7318 367.5669
 [51,] 260.2127 12.140134 237.3083 285.0170
 [52,] 270.4325 10.403155 250.5515 291.5186
 [53,] 280.6522  8.946119 263.5935 298.8425
 [54,] 290.8720  7.924965 275.2645 306.7057
 [55,] 301.0918  7.519423 286.5600 315.7498
 [56,] 311.3116  7.825790 296.6394 326.4244
 [57,] 321.5313  8.769771 305.0937 338.6504
 [58,] 331.7511 10.175430 312.4013 351.3336
 [59,] 341.9709 11.880004 319.2307 364.5279
 [60,] 352.1906 13.772954 325.7449 378.3422
 [61,] 267.7256 12.284366 244.5580 292.0496
 [62,] 278.0907 10.602600 258.0287 299.2584
 [63,] 288.4557  9.208173 270.8823 306.7894
 [64,] 298.8208  8.248130 282.8663 315.3445
 [65,] 309.1858  7.882812 293.6035 324.6489
 [66,] 319.5509  8.192170 303.1918 335.4852
 [67,] 329.9159  9.107714 311.5596 347.6480
 [68,] 340.2809 10.471634 319.3417 360.2333
 [69,] 350.6460 12.133658 326.3566 373.7156
 [70,] 361.0110 13.987925 333.3317 387.8752
 [71,] 244.2403 12.082230 220.5999 268.0012
 [72,] 255.7372 10.368858 235.6925 276.1580
 [73,] 267.2341  8.940843 249.6381 284.8568
 [74,] 278.7310  7.953407 263.1342 294.3549
 [75,] 290.2279  7.580714 275.6033 305.3223
 [76,] 301.7248  7.910141 286.3255 317.3029
 [77,] 313.2217  8.863744 296.1614 330.5707
 [78,] 324.7186 10.269087 304.6736 345.1899
 [79,] 336.2155 11.968077 312.7858 359.3023
 [80,] 347.7124 13.853091 320.3348 374.7090
 [81,] 250.6378 13.283894 225.0789 277.1694
 [82,] 250.3910 11.312384 228.6171 272.8123
 [83,] 250.1441  9.634554 231.6345 269.0027
 [84,] 249.8972  8.427673 233.6481 266.2063
 [85,] 249.6504  7.910318 234.2653 265.0983
 [86,] 249.4035  8.213832 233.1733 265.5441
 [87,] 249.1566  9.257828 231.2445 267.5210
 [88,] 248.9098 10.830242 227.5302 270.2147
 [89,] 248.6629 12.736850 223.7384 273.8119
 [90,] 248.4160 14.849477 219.8192 277.9874
 [91,] 285.8316 13.059477 261.1034 311.8441
 [92,] 305.0061 11.189355 283.4472 327.4423
 [93,] 324.1807  9.598500 305.6708 343.6575
 [94,] 343.3552  8.446215 326.6998 360.1185
 [95,] 362.5297  7.926141 346.5599 377.9147
 [96,] 381.7042  8.160066 365.3263 397.3298
 [97,] 400.8787  9.089965 382.7186 418.2756
 [98,] 420.0532 10.533093 398.8719 440.7567
 [99,] 439.2278 12.310259 414.8480 463.6109
[100,] 458.4023 14.297436 430.4299 486.9044
[101,] 226.9225 13.439368 199.8298 252.6320
[102,] 238.4498 11.483391 215.2382 260.4084
[103,] 249.9771  9.795801 230.6285 268.7521
[104,] 261.5043  8.537269 244.5146 277.9768
[105,] 273.0316  7.915174 257.3280 288.6131
[106,] 284.5588  8.077920 268.9037 300.7774
[107,] 296.0861  8.982949 278.7685 313.7734
[108,] 307.6133 10.438953 287.3728 328.1670
[109,] 319.1406 12.251036 295.0509 343.1651
[110,] 330.6678 14.284321 302.4288 358.9700
[111,] 238.8557 13.330789 212.0607 263.6568
[112,] 255.8255 11.437053 232.9327 277.3603
[113,] 272.7953  9.803171 253.3853 291.6442
[114,] 289.7651  8.578920 272.8514 306.2971
[115,] 306.7349  7.955709 291.4636 322.1776
[116,] 323.7047  8.073939 308.5203 339.6974
[117,] 340.6745  8.904123 323.7475 358.5871
[118,] 357.6443 10.275118 337.8972 378.1189
[119,] 374.6141 12.003017 351.0408 398.8204
[120,] 391.5839 13.955878 364.4369 419.5417
[121,] 255.8152 12.401248 232.2945 280.1603
[122,] 263.2768 10.665665 242.5480 284.2036
[123,] 270.7384  9.205179 252.5940 288.9917
[124,] 278.2001  8.168703 261.8703 294.0794
[125,] 285.6617  7.728749 270.3093 300.7227
[126,] 293.1233  7.984540 277.4251 308.7579
[127,] 300.5849  8.876129 283.1486 318.5616
[128,] 308.0466 10.238746 287.9940 328.8934
[129,] 315.5082 11.911828 292.3685 339.6794
[130,] 322.9698 13.782774 296.4299 350.6843
[131,] 272.0253 12.608977 247.8006 297.2361
[132,] 286.0392 10.835714 264.8554 307.7964
[133,] 300.0532  9.351112 281.7405 319.0001
[134,] 314.0672  8.311323 297.8879 330.7115
[135,] 328.0812  7.894118 312.4585 343.5144
[136,] 342.0952  8.195139 326.0348 358.2735
[137,] 356.1091  9.143726 338.6648 373.8996
[138,] 370.1231 10.566898 349.4505 390.3538
[139,] 384.1371 12.301022 359.7259 407.8066
[140,] 398.1511 14.232890 369.7353 425.7328
[141,] 254.7529 12.123785 231.4565 278.8014
[142,] 266.1051 10.450491 245.8259 286.9630
[143,] 277.4573  9.064539 259.5310 295.6983
[144,] 288.8095  8.114525 272.6445 304.8561
[145,] 300.1617  7.762196 284.9211 315.4246
[146,] 311.5140  8.086062 295.3351 327.5493
[147,] 322.8662  9.013524 304.9978 340.7195
[148,] 334.2184 10.384093 313.9115 354.5675
[149,] 345.5706 12.047476 322.2230 369.5056
[150,] 356.9228 13.898938 329.8799 384.3861
[151,] 226.6991 13.282144 200.1205 251.6862
[152,] 241.8725 11.307072 219.4105 263.4940
[153,] 257.0458  9.609891 238.1010 275.7226
[154,] 272.2192  8.361561 256.0271 288.7855
[155,] 287.3925  7.781193 272.7499 302.8432
[156,] 302.5658  8.015224 287.1994 318.3510
[157,] 317.7392  9.000347 299.9108 335.1402
[158,] 332.9125 10.527784 312.0588 353.4218
[159,] 348.0859 12.398702 323.2963 372.1715
[160,] 363.2592 14.480572 334.4792 390.9301
[161,] 252.1605 12.138828 228.9556 275.8084
[162,] 261.6311 10.427193 241.3424 281.9150
[163,] 271.1018  9.008169 253.5359 288.5921
[164,] 280.5724  8.038244 264.9337 296.0068
[165,] 290.0430  7.689287 274.8679 304.6439
[166,] 299.5137  8.042538 283.3078 314.9570
[167,] 308.9843  9.015832 290.8925 326.3658
[168,] 318.4549 10.437123 297.8027 338.4372
[169,] 327.9255 12.150201 304.0167 350.9078
[170,] 337.3962 14.048727 309.9363 364.0458
[171,] 263.3457 12.287784 239.3750 287.7514
[172,] 275.1702 10.564951 254.2889 296.0418
[173,] 286.9948  9.131923 268.9985 305.0806
[174,] 298.8193  8.143164 282.6500 314.5904
[175,] 310.6439  7.770166 295.2435 326.1344
[176,] 322.4684  8.098462 306.4481 338.5817
[177,] 334.2930  9.052070 316.4644 352.2359
[178,] 346.1175 10.461363 325.7270 366.9766
[179,] 357.9421 12.169040 334.0645 381.9176
[180,] 369.7667 14.066848 342.0689 397.2181</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.2614499 13.087387  -29.15171432  21.1537654
  [2,]  -14.7565391 11.184463  -36.21715583   6.7415488
  [3,]  -42.3004283  9.553068  -60.95698700 -23.9146362
  [4,]    8.6989825  8.353825   -7.66174230  24.6183478
  [5,]   24.4712933  7.788971    9.29554820  39.6360108
  [6,]   62.6697040  7.994131   47.12757330  78.5036779
  [7,]   10.5436148  8.916310   -6.87817295  28.1567394
  [8,] -101.1513744 10.365879 -121.71789216 -81.3437817
  [9,]   19.6455364 12.155603   -4.25186716  43.0447904
 [10,]   35.7739472 14.157059    7.68891888  63.2508238
 [11,]   11.2774848 13.236969  -14.44340165  36.7951778
 [12,]   -7.9300223 11.356555  -30.08610781  13.7673595
 [13,]  -11.9574295  9.744734  -31.18476313   6.6772493
 [14,]  -11.9676366  8.554696  -28.87394205   4.5344861
 [15,]  -10.6979437  7.977488  -26.56925975   4.8339798
 [16,]   -4.1916508  8.144465  -20.35534993  11.5126360
 [17,]   -8.2625580  9.014367  -25.99934635   9.0233960
 [18,]   -5.9050651 10.412484  -26.64130184  14.3249846
 [19,]   -1.0759722 12.157933  -25.76496716  22.5505425
 [20,]   10.2031206 14.122512  -18.77279919  38.2114986
 [21,]  -13.9341870 13.334713  -39.85505867  12.4427135
 [22,]  -23.5691795 11.452578  -46.31020813  -0.8111939
 [23,]   11.5053279  9.845002   -7.76106064  30.9626470
 [24,]    5.1136354  8.666149  -12.26815731  22.1486048
 [25,]   -3.3338571  8.105292  -19.72682352  12.5863613
 [26,]  -17.0966496  8.288844  -33.53662432  -0.9430698
 [27,]   -7.0470422  9.172222  -25.18326356  11.2871838
 [28,]    8.3699653 10.581584  -12.29721014  29.0959053
 [29,]    8.7180728 12.337980  -15.44704074  32.7074169
 [30,]   -9.6924198 14.314228  -38.09458147  18.0251889
 [31,]   47.1698217 13.412080   20.69232273  72.4875631
 [32,]   20.2879046 11.473591   -2.62492294  41.5602122
 [33,]   -1.9953125  9.821141  -21.64437934  16.0030400
 [34,]   -6.4583296  8.620814  -23.16227992  10.1823029
 [35,]  -11.5335467  8.076768  -27.60717415   4.5805197
 [36,]   -5.4848638  8.318775  -21.72261896  11.0102601
 [37,]  -28.5702809  9.285579  -46.80564318  -9.9927114
 [38,]    3.7119020 10.783971  -17.31563452  24.7684156
 [39,]  -14.9394151 12.626092  -39.45125537   9.5798282
 [40,]   28.0202678 14.683136   -0.68886332  56.7899841
 [41,]   14.6504309 13.029369  -11.25454543  39.3982251
 [42,]    4.5380017 11.145738  -17.37664350  25.7480321
 [43,]   13.8540725  9.540973   -4.82578889  32.0230340
 [44,]   24.6442434  8.376905    8.46527745  41.0334166
 [45,]   13.3017142  7.852045   -1.84941219  28.7823068
 [46,]  -17.1614150  8.091747  -32.95823749  -0.9456374
 [47,]  -27.9096442  9.035365  -45.39806426  -9.6802111
 [48,]    9.3285266 10.494711  -10.87357207  30.4620121
 [49,]  -39.2468026 12.287383  -62.76000393 -14.4895674
 [50,]   31.0828682 14.288467    4.01419060  59.8492571
 [51,]  -25.3521062 12.140134  -50.15636738  -2.4476940
 [52,]  -27.6206756 10.403155  -48.70683467  -7.7397474
 [53,]   -7.6909450  8.946119  -25.88123153   9.3677587
 [54,]   18.8967856  7.924965    3.06306551  34.5043195
 [55,]   16.3711162  7.519423    1.71306903  30.9029158
 [56,]   -1.3139532  7.825790  -16.42684230  13.3582177
 [57,]  132.6305774  8.769771  115.51152030 149.0681998
 [58,]   15.0800080 10.175430   -4.50254450  34.4297684
 [59,]  -11.6705614 11.880004  -34.22756812  11.0695837
 [60,]  -98.3262308 13.772954 -124.47779971 -71.8805426
 [61,]   16.1167539 12.284366   -8.20719635  39.2844303
 [62,]   11.4643108 10.602600   -9.70337439  31.5263169
 [63,]  -11.6864322  9.208173  -30.02010722   5.8870177
 [64,]    0.9889248  8.248130  -15.53483880  16.9433897
 [65,]  -12.0148183  7.882812  -27.47790081   3.5674519
 [66,]   18.6156387  8.192170    2.68128808  34.9747453
 [67,]    2.1105957  9.107714  -15.62147400  20.4669377
 [68,]    8.5589526 10.471634  -11.39344261  29.4981540
 [69,]  -17.2859904 12.133658  -40.35558742   7.0033544
 [70,]    1.0317666 13.987925  -25.83237099  28.7110962
 [71,]   21.2327921 12.082230   -2.52811534  44.8732319
 [72,]   20.4639946 10.368858    0.04318973  40.5087059
 [73,]  -23.8694029  8.940843  -41.49213790  -6.2734256
 [74,]  -24.0587004  7.953407  -39.68257140  -8.4619159
 [75,]  -11.2034979  7.580714  -26.29789591   3.4211381
 [76,]  -17.5335954  7.910141  -33.11167581  -2.1343018
 [77,]   -7.6968928  8.863744  -25.04587453   9.3633624
 [78,]    6.8043097 10.269087  -13.66697789  26.8492989
 [79,]   -0.4685878 11.968077  -23.55537636  22.9610524
 [80,]   29.5866147 13.853091    2.59002041  56.9642171
 [81,]   -9.0295454 13.283894  -35.56109847  16.5293988
 [82,]   23.5562208 11.312384    1.13493225  45.3301205
 [83,]    4.3465871  9.634554  -14.51204799  22.8562220
 [84,]   20.9048533  8.427673    4.59581230  37.1539690
 [85,]    1.8015195  7.910318  -13.64639283  17.1866407
 [86,]    5.2326857  8.213832  -10.90788466  21.4629161
 [87,]   -3.7043481  9.257828  -22.06872456  14.2078412
 [88,]  -13.5987819 10.830242  -34.90366988   7.7807603
 [89,]  -12.9088157 12.736850  -38.05775397  12.0156881
 [90,]  -11.1694495 14.849477  -40.74078932  17.4274117
 [91,]   26.5349873 13.059477    0.52254591  51.2631839
 [92,]    8.7996679 11.189355  -13.63654100  30.3586195
 [93,]  -32.5694516  9.598500  -52.04625347 -14.0596026
 [94,]    2.7670290  8.446215  -13.99628969  19.4223776
 [95,]    3.2027096  7.926141  -12.18226695  19.1725020
 [96,]   10.1342901  8.160066   -5.49128867  26.5121596
 [97,]    3.3813707  9.089965  -14.01550942  21.5415334
 [98,]   -3.3609487 10.533093  -24.06442764  17.8203907
 [99,]   16.6365318 12.310259   -7.74663568  41.0162913
[100,]    0.5144124 14.297436  -27.98768084  28.4867916
[101,]    9.1806532 13.439368  -16.52882606  36.2734320
[102,]   -8.1330996 11.483391  -30.09171636  15.0785377
[103,]  -11.0514524  9.795801  -29.82650848   8.2970682
[104,]   -6.5823053  8.537269  -23.05481860  10.4073806
[105,]  -22.3212581  7.915174  -37.90275109  -6.6177225
[106,]  -14.7844109  8.077920  -31.00297437   0.8706943
[107,]  -14.5212637  8.982949  -32.20856853   2.7963212
[108,]    0.4886835 10.438953  -20.06503424  20.7291602
[109,]   17.1400306 12.251036   -6.88454324  41.2296807
[110,]   20.9772778 14.284321   -7.32487537  49.2163039
[111,]   17.4410910 13.330789   -7.36000070  44.2361330
[112,]  -12.3712120 11.437053  -33.90598612  10.5216151
[113,]  -16.5907151  9.803171  -35.43957416   2.8193213
[114,]  -34.2380182  8.578920  -50.76997651 -17.3242983
[115,]  -37.8184213  7.955709  -53.26113382 -22.5471004
[116,]    6.0199757  8.073939   -9.97266601  21.2044220
[117,]   38.7699726  8.904123   20.85737438  55.6969805
[118,]    5.2740695 10.275118  -15.20047081  25.0212013
[119,]   19.8730665 12.003017   -4.33320108  43.4463707
[120,]   -2.5312366 13.955878  -30.48900089  24.6157639
[121,]   -5.2886816 12.401248  -29.63375179  18.2320475
[122,]   36.7807931 10.665665   15.85397029  57.5096006
[123,]   -0.8445322  9.205179  -19.09783964  17.2998901
[124,]    2.3890425  8.168703  -13.49032075  18.7188346
[125,]  -13.8342828  7.728749  -28.89525327   1.5181234
[126,]   11.5102919  7.984540   -4.12425201  27.2085285
[127,]  -12.8383335  8.876129  -30.81503601   4.5980099
[128,]  -41.4510588 10.238746  -62.29785983 -21.3985067
[129,]    6.0336159 11.911828  -18.13762211  29.1732623
[130,]   24.5956906 13.782774   -3.11876462  51.1355857
[131,]  -50.3481698 12.608977  -75.55904965 -26.1235225
[132,]   12.1546517 10.835714   -9.60249429  33.3385465
[133,]   26.8252733  9.351112    7.87838868  45.1379852
[134,]   32.7882948  8.311323   16.14396074  48.9676193
[135,]   20.6590163  7.894118    5.22576949  36.2816550
[136,]   10.7335378  8.195139   -5.44478310  26.7939351
[137,]   -1.6825406  9.143726  -19.47302558  15.7617803
[138,]   -9.6905191 10.566898  -29.92115906  10.9821082
[139,]   -8.4964976 12.301022  -32.16603815  15.9147009
[140,]   -9.6093761 14.232890  -37.19112148  18.8063702
[141,]   17.1706296 12.123785   -6.87787130  40.4669512
[142,]    2.3318136 10.450491  -18.52605054  22.6109879
[143,]  -20.2149024  9.064539  -38.45589106  -2.2885892
[144,]  -11.1529183  8.114525  -27.19949037   5.0120555
[145,]   14.6604657  7.762196   -0.60239249  29.9010508
[146,]    5.6995497  8.086062  -10.33584806  21.8783885
[147,]  -24.7308663  9.013524  -42.58418214  -6.8624559
[148,]   13.9045177 10.384093   -6.44461766  34.2113579
[149,]   -5.2905982 12.047476  -29.22564275  18.0570242
[150,]    9.5902858 13.898938  -17.87296738  36.6331520
[151,]   -1.4351421 13.282144  -26.42218857  25.1435280
[152,]   -7.3489836 11.307072  -28.97052307  15.1130312
[153,]  -18.1450251  9.609891  -36.82176820   0.7998212
[154,]  -31.7461666  8.361561  -48.31254574 -15.5540856
[155,]  -19.8552081  7.781193  -35.30588630  -5.2126404
[156,]   41.6278504  8.015224   25.84266049  56.9942860
[157,]  -36.5910911  9.000347  -53.99205473 -18.7627012
[158,]   14.6729674 10.527784   -5.83628708  35.5266595
[159,]   17.0771259 12.398702   -7.00854031  41.8667065
[160,]    8.9695844 14.480572  -18.70125395  37.7495609
[161,]   17.7198846 12.138828   -5.92803807  40.9247808
[162,]   10.8116575 10.427193   -9.47224931  31.1004486
[163,]    6.7971303  9.008169  -10.69316610  24.3630095
[164,]    1.2171032  8.038244  -14.21733090  16.8558385
[165,]  -10.8725240  7.689287  -25.47338880   4.3026159
[166,]  -15.0016512  8.042538  -30.44502347   1.2041863
[167,]  -49.7184783  9.015832  -67.10000741 -31.6266791
[168,]  -13.8243055 10.437123  -33.80659109   6.8279336
[169,]   22.8551674 12.150201   -0.12712676  46.7639940
[170,]   32.0730402 14.048727    5.42340103  59.5329095
[171,]    6.0660330 12.287784  -18.33971052  30.0367057
[172,]   -1.6962207 10.564951  -22.56776311  19.1850909
[173,]   10.6020257  9.131923   -7.48377729  28.5982703
[174,]   11.8122720  8.143164   -3.95884660  27.9815996
[175,]  -23.4712817  7.770166  -38.96183583  -8.0708574
[176,]    7.1391646  8.098462   -8.97410831  23.1595178
[177,]    0.1888109  9.052070  -17.75414685  18.0174125
[178,]   -2.8976428 10.461363  -23.75672290  17.4928504
[179,]   11.1996036 12.169040  -12.77591996  35.0772198
[180,]   -5.6430501 14.066848  -33.09451233  22.0546725</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.4
looic      1769.6 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1679      
 (0.5, 0.7]   (ok)         2    1.1%   353       
   (0.7, 1]   (bad)        1    0.6%   99        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.3 22.1
p_loo        33.1  7.9
looic      1720.5 44.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     167   92.8%   856       
 (0.5, 0.7]   (ok)        10    5.6%   589       
   (0.7, 1]   (bad)        3    1.7%   32        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.5      11.4  
fit_sleep1 -93.2      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.4
looic      1769.6 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1679      
 (0.5, 0.7]   (ok)         2    1.1%   353       
   (0.7, 1]   (bad)        1    0.6%   99        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.3 22.1
p_loo        33.1  7.9
looic      1720.5 44.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     167   92.8%   856       
 (0.5, 0.7]   (ok)        10    5.6%   589       
   (0.7, 1]   (bad)        3    1.7%   32        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.3     22.1        33.1    7.9   1720.5
fit_sleep2  -24.5      11.4  -884.8     14.4        19.3    3.4   1769.6
fit_sleep1  -93.2      20.8  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   44.1  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
3.509779e-41 2.204893e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.84      1.58     0.23     5.37       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.16      1.58    -3.32     2.86       5.11      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.3.5         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.0       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
