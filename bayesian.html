<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.42      6.70    15.36    42.01 1.00     1754     1986
sd(Days)                6.51      1.49     4.13    10.01 1.00     1703     2054
cor(Intercept,Days)     0.10      0.31    -0.49     0.70 1.01      887     1447

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.21      7.33   236.84   265.91 1.00     1822     2595
Days         10.41      1.66     7.13    13.68 1.00     1419     2044

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.93      1.57    23.05    29.25 1.00     3787     2507

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.3364  13.38882 227.9633 280.5069
309 211.4586  13.19355 185.0185 237.0480
310 213.3627  13.21804 186.8053 238.0211
330 274.1448  13.35028 248.1149 300.9404
331 272.7977  12.93269 248.0642 299.2916
332 259.9937  12.25772 237.4554 284.5673
333 267.6794  12.63646 243.4515 293.5966
334 244.6862  12.10183 220.3473 268.2899
335 250.3825  13.58131 223.8967 277.2554
337 286.1163  13.15102 260.4092 312.3161
349 227.0109  12.93215 201.5932 251.3737
350 239.2342  13.18740 213.3552 264.3313
351 255.4313  12.27122 232.1263 279.7844
352 271.8815  12.71505 246.9445 297.0938
369 254.8295  12.25801 230.6927 278.7554
370 226.8654  13.66193 200.4464 251.7906
371 251.9535  12.14327 227.6256 276.4275
372 263.7226  12.18225 240.8261 287.7204

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5536867  2.558775 14.5604002 24.466676
309  1.7783037  2.478270 -3.2607623  6.660788
310  4.9171649  2.471957  0.2257808  9.751228
330  5.8402197  2.502595  0.9299728 10.560750
331  7.5407306  2.454771  2.6748664 12.248634
332 10.2379430  2.336347  5.6816146 14.630437
333 10.3617856  2.404307  5.5642168 14.940624
334 11.4551101  2.302588  6.8869977 15.993550
335 -0.1658032  2.593094 -5.2929776  4.816379
337 19.1215229  2.473028 14.3105432 23.977083
349 11.5514457  2.470498  6.8367116 16.351031
350 16.9396799  2.507180 12.1710329 21.977944
351  7.5263173  2.335552  2.8752330 11.946358
352 14.0620328  2.384036  9.4090179 18.657857
369 11.3291410  2.303233  6.8177795 15.810887
370 15.1330002  2.571333 10.3279072 20.343882
371  9.5402464  2.384279  5.0124286 14.305976
372 11.7388540  2.311597  7.0767288 16.139643</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.3364 13.388824 227.9633 280.5069
  [2,] 273.8901 11.444931 251.3773 296.2013
  [3,] 293.4438  9.788102 274.5379 312.4890
  [4,] 312.9975  8.586158 296.4412 329.4130
  [5,] 332.5512  8.045615 316.6695 347.9287
  [6,] 352.1049  8.296771 335.4193 367.9880
  [7,] 371.6586  9.275534 353.1767 389.9744
  [8,] 391.2123 10.785608 369.8325 412.4450
  [9,] 410.7659 12.637950 385.9394 435.6345
 [10,] 430.3196 14.703771 401.1772 459.1545
 [11,] 211.4586 13.193551 185.0185 237.0480
 [12,] 213.2369 11.337321 190.3310 234.9877
 [13,] 215.0152  9.761329 195.6241 233.8123
 [14,] 216.7935  8.620667 199.5519 233.7211
 [15,] 218.5718  8.101351 202.4538 234.7852
 [16,] 220.3501  8.320549 204.0263 236.5150
 [17,] 222.1284  9.225769 204.2595 240.0782
 [18,] 223.9067 10.643390 202.7106 244.3950
 [19,] 225.6850 12.398884 200.6274 249.5950
 [20,] 227.4633 14.368944 198.2785 254.8622
 [21,] 213.3627 13.218040 186.8053 238.0211
 [22,] 218.2798 11.366741 195.5120 239.6641
 [23,] 223.1970  9.793375 203.7131 241.8272
 [24,] 228.1142  8.650938 210.8981 244.9179
 [25,] 233.0313  8.123324 217.0889 249.3070
 [26,] 237.9485  8.328217 221.1520 254.3211
 [27,] 242.8657  9.216896 224.1830 260.5876
 [28,] 247.7828 10.619052 226.5564 268.0052
 [29,] 252.7000 12.361170 228.7622 276.3946
 [30,] 257.6172 14.319703 230.1422 285.0634
 [31,] 274.1448 13.350277 248.1149 300.9404
 [32,] 279.9850 11.450794 257.4839 302.5905
 [33,] 285.8253  9.825346 266.1449 305.0626
 [34,] 291.6655  8.630188 274.1877 308.0594
 [35,] 297.5057  8.059083 281.4044 313.1446
 [36,] 303.3459  8.242782 287.6573 319.4988
 [37,] 309.1861  9.135866 291.3245 326.8437
 [38,] 315.0264 10.559858 294.6095 335.7892
 [39,] 320.8666 12.332199 296.7281 345.2365
 [40,] 326.7068 14.324162 298.1905 354.5307
 [41,] 272.7977 12.932693 248.0642 299.2916
 [42,] 280.3384 11.071563 259.1654 302.6813
 [43,] 287.8791  9.484528 269.3731 307.0739
 [44,] 295.4199  8.329756 278.9191 311.9056
 [45,] 302.9606  7.801615 287.3474 317.9960
 [46,] 310.5013  8.024797 294.4789 325.6103
 [47,] 318.0421  8.943228 300.5881 335.2585
 [48,] 325.5828 10.373865 305.3010 345.8036
 [49,] 333.1235 12.136912 309.9722 356.9832
 [50,] 340.6643 14.108295 313.6309 368.8477
 [51,] 259.9937 12.257719 237.4554 284.5673
 [52,] 270.2317 10.546595 250.4572 291.2459
 [53,] 280.4696  9.117384 263.3508 298.7444
 [54,] 290.7075  8.120330 274.8977 307.1757
 [55,] 300.9455  7.724628 285.6972 316.3996
 [56,] 311.1834  8.019789 295.3048 326.8224
 [57,] 321.4214  8.937628 304.0768 338.5486
 [58,] 331.6593 10.313215 311.3585 351.9911
 [59,] 341.8973 11.990024 318.0901 365.3820
 [60,] 352.1352 13.859147 324.6757 379.1794
 [61,] 267.6794 12.636460 243.4515 293.5966
 [62,] 278.0412 10.837608 257.4840 300.1318
 [63,] 288.4029  9.316048 270.5536 307.1709
 [64,] 298.7647  8.227098 283.0970 315.3706
 [65,] 309.1265  7.755187 294.4816 324.4511
 [66,] 319.4883  8.010124 303.6733 335.0927
 [67,] 329.8501  8.929873 311.7969 346.9819
 [68,] 340.2119 10.338499 319.8170 360.2073
 [69,] 350.5737 12.065981 326.6692 373.6198
 [70,] 360.9354 13.994735 333.5072 388.0361
 [71,] 244.6862 12.101831 220.3473 268.2899
 [72,] 256.1413 10.425112 235.4364 276.3712
 [73,] 267.5965  9.028589 249.4557 285.4616
 [74,] 279.0516  8.059262 263.2413 294.9628
 [75,] 290.5067  7.680613 275.0905 305.7042
 [76,] 301.9618  7.977202 285.6797 317.6392
 [77,] 313.4169  8.881639 295.3794 330.6814
 [78,] 324.8720 10.234017 304.4526 344.6337
 [79,] 336.3271 11.882361 312.7671 359.3817
 [80,] 347.7822 13.720413 320.7576 374.2962
 [81,] 250.3825 13.581311 223.8967 277.2554
 [82,] 250.2167 11.598694 227.6278 273.0883
 [83,] 250.0509  9.902306 230.9126 269.4940
 [84,] 249.8851  8.661981 232.9869 266.8686
 [85,] 249.7193  8.090268 234.3770 265.7462
 [86,] 249.5535  8.326057 233.2803 265.9934
 [87,] 249.3877  9.308185 231.2193 268.0482
 [88,] 249.2219 10.835574 228.3676 271.0300
 [89,] 249.0561 12.713193 224.5371 274.6966
 [90,] 248.8903 14.808416 220.5817 278.7273
 [91,] 286.1163 13.151015 260.4092 312.3161
 [92,] 305.2378 11.284018 282.9356 327.8133
 [93,] 324.3593  9.692299 304.8074 343.7692
 [94,] 343.4808  8.531353 326.0671 360.4816
 [95,] 362.6024  7.991185 346.9400 378.3568
 [96,] 381.7239  8.195476 365.6609 397.9228
 [97,] 400.8454  9.094192 383.2250 418.7457
 [98,] 419.9669 10.510689 399.7635 441.0220
 [99,] 439.0885 12.266889 415.5345 462.8903
[100,] 458.2100 14.237635 430.8812 485.9032
[101,] 227.0109 12.932147 201.5932 251.3737
[102,] 238.5623 11.090580 216.5701 259.7351
[103,] 250.1138  9.537726 230.8505 268.5480
[104,] 261.6652  8.434583 244.9723 278.0433
[105,] 273.2167  7.970124 257.6621 288.8068
[106,] 284.7681  8.252896 268.6270 300.9044
[107,] 296.3195  9.214359 278.1650 314.5938
[108,] 307.8710 10.672640 286.9518 328.8468
[109,] 319.4224 12.454429 295.1188 343.2658
[110,] 330.9739 14.440467 302.3211 358.6714
[111,] 239.2342 13.187404 213.3552 264.3313
[112,] 256.1739 11.293471 234.2664 277.7573
[113,] 273.1136  9.682421 254.2176 291.9900
[114,] 290.0533  8.516335 273.2495 306.8416
[115,] 306.9930  7.992406 291.4462 322.1858
[116,] 323.9326  8.234140 307.6388 339.8026
[117,] 340.8723  9.181256 323.2067 358.3225
[118,] 357.8120 10.647148 337.3532 378.4040
[119,] 374.7517 12.449899 350.7613 398.6434
[120,] 391.6914 14.464097 364.0985 419.7770
[121,] 255.4313 12.271221 232.1263 279.7844
[122,] 262.9577 10.557856 242.9170 283.9958
[123,] 270.4840  9.124878 252.8304 288.3303
[124,] 278.0103  8.122073 261.9602 293.6719
[125,] 285.5366  7.718960 270.4506 300.3980
[126,] 293.0629  8.006637 277.0344 308.4037
[127,] 300.5893  8.918505 282.4026 317.7277
[128,] 308.1156 10.289939 287.5018 327.7480
[129,] 315.6419 11.963927 291.8327 338.6680
[130,] 323.1682 13.831048 295.9685 349.7696
[131,] 271.8815 12.715052 246.9445 297.0938
[132,] 285.9436 10.982597 264.2855 307.4497
[133,] 300.0056  9.535701 281.3772 319.0057
[134,] 314.0676  8.521092 297.3410 330.4755
[135,] 328.1297  8.102819 312.4476 343.6268
[136,] 342.1917  8.370759 325.7805 358.4718
[137,] 356.2537  9.265570 337.9547 374.2232
[138,] 370.3158 10.630110 349.7184 390.8096
[139,] 384.3778 12.309140 360.2285 408.4778
[140,] 398.4398 14.191473 370.9464 426.1816
[141,] 254.8295 12.258014 230.6927 278.7554
[142,] 266.1587 10.615296 245.2471 287.2735
[143,] 277.4878  9.258502 259.0533 295.9192
[144,] 288.8170  8.328565 272.0518 305.0774
[145,] 300.1461  7.976207 284.1606 315.3913
[146,] 311.4752  8.275539 294.5980 327.1986
[147,] 322.8044  9.162913 304.4933 340.2450
[148,] 334.1335 10.490146 313.1145 354.6259
[149,] 345.4627 12.113510 321.2122 369.4028
[150,] 356.7918 13.929855 329.5044 384.5721
[151,] 226.8654 13.661934 200.4464 251.7906
[152,] 241.9984 11.678652 219.7518 263.5477
[153,] 257.1314  9.967792 238.1944 275.8935
[154,] 272.2644  8.691741 255.3631 288.7808
[155,] 287.3974  8.059737 271.5282 303.0605
[156,] 302.5304  8.221670 286.3253 318.6271
[157,] 317.6634  9.135418 299.9718 335.1210
[158,] 332.7964 10.608457 312.4992 353.2635
[159,] 347.9294 12.443729 324.2725 372.4228
[160,] 363.0624 14.504376 335.5530 391.5950
[161,] 251.9535 12.143273 227.6256 276.4275
[162,] 261.4938 10.412768 241.1857 282.5066
[163,] 271.0340  8.986765 253.7090 289.0563
[164,] 280.5742  8.029180 265.0110 296.3722
[165,] 290.1145  7.716417 275.0963 305.0997
[166,] 299.6547  8.123301 284.0063 315.3221
[167,] 309.1950  9.154371 291.5151 327.0956
[168,] 318.7352 10.629514 298.3734 339.5514
[169,] 328.2755 12.391134 304.6733 352.4021
[170,] 337.8157 14.333995 310.2840 366.2191
[171,] 263.7226 12.182246 240.8261 287.7204
[172,] 275.4615 10.545640 255.2178 296.5008
[173,] 287.2003  9.203309 269.3246 305.4118
[174,] 298.9392  8.299291 282.6292 315.3686
[175,] 310.6780  7.983892 294.6613 326.5380
[176,] 322.4169  8.324290 305.7814 338.5309
[177,] 334.1557  9.248353 315.5351 351.7274
[178,] 345.8946 10.604585 324.8564 366.1730
[179,] 357.6334 12.250281 332.8401 381.3092
[180,] 369.3723 14.084335 340.8018 396.3380</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.7764484 13.388824  -30.94685646  21.5966852
  [2,]  -15.1854351 11.444931  -37.49657027   7.3274277
  [3,]  -42.6432218  9.788102  -61.68837668 -23.7372510
  [4,]    8.4422915  8.586158   -7.97315958  24.9986191
  [5,]   24.3007049  8.045615    8.92317730  40.1823533
  [6,]   62.5852182  8.296771   46.70208876  79.2707835
  [7,]   10.5452315  9.275534   -7.77062725  29.0270597
  [8,] -101.0636552 10.785608 -122.29635945 -79.6839332
  [9,]   19.8193581 12.637950   -5.04917345  44.6458672
 [10,]   36.0338714 14.703771    7.19900864  65.1762698
 [11,]   11.2752867 13.193551  -14.31413279  37.7154478
 [12,]   -7.9711170 11.337321  -29.72188310  14.9348268
 [13,]  -12.0374207  9.761329  -30.83449123   7.3536504
 [14,]  -12.0865244  8.620667  -29.01412042   5.1551095
 [15,]  -10.8557281  8.101351  -27.06906324   5.2623280
 [16,]   -4.3883318  8.320549  -20.55322523  11.9355363
 [17,]   -8.4981355  9.225769  -26.44791731   9.3708359
 [18,]   -6.1795392 10.643390  -26.66777468  15.0166144
 [19,]   -1.3893429 12.398884  -25.29931708  23.6682892
 [20,]    9.8508534 14.368944  -17.54796372  39.0357372
 [21,]  -14.3087718 13.218040  -38.96719872  12.2485872
 [22,]  -23.9476367 11.366741  -45.33190339  -1.1798147
 [23,]   11.1229983  9.793375   -7.50717383  30.6069085
 [24,]    4.7274334  8.650938  -12.07629176  21.9434745
 [25,]   -3.7239316  8.123324  -19.99964635  12.2184702
 [26,]  -17.4905965  8.328217  -33.86320269  -0.6940959
 [27,]   -7.4448615  9.216896  -25.16683079  11.2377726
 [28,]    7.9682736 10.619052  -12.25406495  29.1946833
 [29,]    8.3125087 12.361170  -15.38208798  32.2502815
 [30,]  -10.1018563 14.319703  -37.54810195  17.3731021
 [31,]   47.3977784 13.350277   20.60221508  73.4277304
 [32,]   20.4151587 11.450794   -2.19031577  42.9162615
 [33,]   -1.9687610  9.825346  -21.20607615  17.7115512
 [34,]   -6.5324808  8.630188  -22.92636689  10.9453353
 [35,]  -11.7084005  8.059083  -27.34726593   4.3929394
 [36,]   -5.7604202  8.242782  -21.91329474   9.9282120
 [37,]  -28.9465399  9.135866  -46.60409204 -11.0849072
 [38,]    3.2349404 10.559858  -17.52791743  23.6518409
 [39,]  -15.5170793 12.332199  -39.88702917   8.6214379
 [40,]   27.3419009 14.324162   -0.48201906  55.8582096
 [41,]   14.8102181 12.932693  -11.68370963  39.5436618
 [42,]    4.6615875 11.071563  -17.68134728  25.8345581
 [43,]   13.9414569  9.484528   -5.25331400  32.4474841
 [44,]   24.6954264  8.329756    8.20971886  41.1961850
 [45,]   13.3166958  7.801615   -1.71873069  28.9298919
 [46,]  -17.1826348  8.024797  -32.29155247  -1.1602392
 [47,]  -27.9670654  8.943228  -45.18350681 -10.5131152
 [48,]    9.2349041 10.373865  -10.98594595  29.5166997
 [49,]  -39.3766265 12.136912  -63.23630172 -16.2252862
 [50,]   30.9168429 14.108295    2.73336772  57.9502489
 [51,]  -25.1331158 12.257719  -49.70672293  -2.5948286
 [52,]  -27.4198588 10.546595  -48.43409661  -7.6454407
 [53,]   -7.5083019  9.117384  -25.78306521   9.6104772
 [54,]   19.0612551  8.120330    2.59313625  34.8710868
 [55,]   16.5174121  7.724628    1.06331078  31.7656842
 [56,]   -1.1858309  8.019789  -16.82480563  14.6927547
 [57,]  132.7405261  8.937628  115.61334807 150.0850711
 [58,]   15.1717830 10.313215   -5.16000835  35.4726132
 [59,]  -11.5969600 11.990024  -35.08169973  12.2102418
 [60,]  -98.2708030 13.859147 -125.31496025 -70.8113114
 [61,]   16.1630279 12.636460   -9.75419934  40.3908941
 [62,]   11.5138423 10.837608  -10.57682625  32.0710442
 [63,]  -11.6336434  9.316048  -30.40161215   6.2156589
 [64,]    1.0449710  8.227098  -15.56092629  16.7127151
 [65,]  -11.9555146  7.755187  -27.28009037   2.6893646
 [66,]   18.6781998  8.010124    3.07381277  34.4931571
 [67,]    2.1764142  8.929873  -14.95538623  20.2296025
 [68,]    8.6280285 10.338499  -11.36744400  29.0228930
 [69,]  -17.2136571 12.065981  -40.25975184   6.6908424
 [70,]    1.1073573 13.994735  -25.99333647  28.5356395
 [71,]   20.7868625 12.101831   -2.81680168  45.1257745
 [72,]   20.0598524 10.425112   -0.16995664  40.7647844
 [73,]  -24.2317578  9.028589  -42.09686139  -6.0909986
 [74,]  -24.3792679  8.059262  -40.29051874  -8.5689509
 [75,]  -11.4822780  7.680613  -26.67977760   3.9338788
 [76,]  -17.7705881  7.977202  -33.44802742  -1.4884801
 [77,]   -7.8920983  8.881639  -25.15663455  10.1453574
 [78,]    6.6508916 10.234017  -13.11075998  27.0702583
 [79,]   -0.5802185 11.882361  -23.63483997  22.9797793
 [80,]   29.5167713 13.720413    3.00282485  56.5414405
 [81,]   -8.7742089 13.581311  -35.64714583  17.7116362
 [82,]   23.7304943 11.598694    0.85886585  46.3193625
 [83,]    4.4397974  9.902306  -15.00331048  23.5780893
 [84,]   20.9170006  8.661981    3.93354492  37.8151642
 [85,]    1.7326038  8.090268  -14.29430144  17.0748699
 [86,]    5.0827070  8.326057  -11.35719956  21.3559343
 [87,]   -3.9353899  9.308185  -22.59591601  14.2330227
 [88,]  -13.9108867 10.835574  -35.71898761   6.9434417
 [89,]  -13.3019835 12.713193  -38.94247957  11.2170426
 [90,]  -11.6436803 14.808416  -41.48068150  16.6649127
 [91,]   26.2503240 13.151015    0.05054529  51.9573824
 [92,]    8.5680011 11.284018  -14.00748760  30.8702180
 [93,]  -32.7481217  9.692299  -52.15799020 -13.1962121
 [94,]    2.6413554  8.531353  -14.35936948  20.0550712
 [95,]    3.1300325  7.991185  -12.62438922  18.7924414
 [96,]   10.1146097  8.195476   -6.08432446  26.1775962
 [97,]    3.4146868  9.094192  -14.48563945  21.0351138
 [98,]   -3.2746361 10.510689  -24.32967387  16.9288076
 [99,]   16.7758411 12.266889   -7.02599765  40.3298295
[100,]    0.7067182 14.237635  -26.98650892  28.0355347
[101,]    9.0923312 12.932147  -15.27050012  34.5099987
[102,]   -8.2456145 11.090580  -29.41836628  13.7465609
[103,]  -11.1881602  9.537726  -29.62244692   8.0750993
[104,]   -6.7432059  8.434583  -23.12129083   9.9496527
[105,]  -22.5063516  7.970124  -38.09654390  -6.9517649
[106,]  -14.9936973  8.252896  -31.13000079   1.1474449
[107,]  -14.7547430  9.214359  -33.02901447   3.3998155
[108,]    0.2310113 10.672640  -20.74483724  21.1502332
[109,]   16.8581656 12.454429   -6.98523804  41.1617808
[110,]   20.6712199 14.440467   -7.02632030  49.3239688
[111,]   17.0625678 13.187404   -8.03453346  42.9415506
[112,]  -12.7196120 11.293471  -34.30304598   9.1879015
[113,]  -16.9089919  9.682421  -35.78541317   1.9870192
[114,]  -34.5261718  8.516335  -51.31450371 -17.7224100
[115,]  -38.0764517  7.992406  -53.26934375 -22.5297262
[116,]    5.7920685  8.234140  -10.07785455  22.0859156
[117,]   38.5721886  9.181256   21.12195208  56.2377914
[118,]    5.1064087 10.647148  -15.48557790  25.5651616
[119,]   19.7355288 12.449899   -4.15619544  43.7258631
[120,]   -2.6386510 14.464097  -30.72433670  24.9542468
[121,]   -4.9048485 12.271221  -29.25789431  18.4002416
[122,]   37.0999342 10.557856   16.06176449  57.1405720
[123,]   -0.5900831  9.124878  -18.43641579  17.0634586
[124,]    2.5787995  8.122073  -13.08277005  18.6289251
[125,]  -13.7092178  7.718960  -28.57061787   1.3767817
[126,]   11.5706649  8.006637   -3.77011500  27.5991861
[127,]  -12.8426524  8.918505  -29.98114269   5.3440147
[128,]  -41.5200697 10.289939  -61.15251904 -20.9062652
[129,]    5.8999130 11.963927  -17.12623792  29.7091429
[130,]   24.3972957 13.831048   -2.20406370  51.5970039
[131,]  -50.2044279 12.715052  -75.41670635 -25.2674495
[132,]   12.2503394 10.982597   -9.25582060  33.9084481
[133,]   26.8729066  9.535701    7.87278242  45.5012522
[134,]   32.7878739  8.521092   16.37998885  49.5144984
[135,]   20.6105411  8.102819    5.11336604  36.2926184
[136,]   10.6370083  8.370759   -5.64308857  27.0482350
[137,]   -1.8271244  9.265570  -19.79662640  16.4718548
[138,]   -9.8831572 10.630110  -30.37699417  10.7141527
[139,]   -8.7371899 12.309140  -32.83719546  15.4120618
[140,]   -9.8981227 14.191473  -37.63990150  17.5952525
[141,]   17.0939650 12.258014   -6.83192006  41.2307914
[142,]    2.2782241 10.615296  -18.83658143  23.1897992
[143,]  -20.2454169  9.258502  -38.67678739  -1.8109204
[144,]  -11.1603578  8.328565  -27.42076884   5.6048480
[145,]   14.6761012  7.976207   -0.56907568  30.6616054
[146,]    5.7382602  8.275539   -9.98508045  22.6155276
[147,]  -24.6690807  9.162913  -42.10968885  -6.3579661
[148,]   13.9893783 10.490146   -6.50295759  35.0084127
[149,]   -5.1826626 12.113510  -29.12284027  19.0677917
[150,]    9.7212964 13.929855  -18.05901999  37.0087140
[151,]   -1.6014267 13.661934  -26.52664373  24.8175769
[152,]   -7.4749269 11.678652  -29.02417163  14.7716583
[153,]  -18.2306272  9.967792  -36.99274167   0.7063693
[154,]  -31.7914274  8.691741  -48.30776118 -14.8900725
[155,]  -19.8601276  8.059737  -35.52321762  -3.9908974
[156,]   41.6632721  8.221670   25.56663375  57.8684079
[157,]  -36.5153281  9.135418  -53.97287192 -18.8237176
[158,]   14.7890716 10.608457   -5.67803500  35.0863106
[159,]   17.2335714 12.443729   -7.25980946  40.8905137
[160,]    9.1663712 14.504376  -19.36619114  36.6758082
[161,]   17.9268944 12.143273   -6.54713260  42.2548031
[162,]   10.9490480 10.412768  -10.06379050  31.2571432
[163,]    6.8649016  8.986765  -11.15736805  24.1899202
[164,]    1.2152551  8.029180  -14.58271979  16.7784740
[165,]  -10.9439913  7.716417  -25.92922641   4.0742023
[166,]  -15.1427377  8.123301  -30.81009319   0.5057226
[167,]  -49.9291842  9.154371  -67.82980667 -32.2493369
[168,]  -14.1046306 10.629514  -34.92079743   6.2572230
[169,]   22.5052230 12.391134   -1.62142467  46.1074066
[170,]   31.6534765 14.333995    3.25008825  59.1852219
[171,]    5.6890896 12.182246  -18.30873656  28.5856060
[172,]   -1.9874644 10.545640  -23.02675824  18.2561770
[173,]   10.3964816  9.203309   -7.81497685  28.2722414
[174,]   11.6924276  8.299291   -4.73701468  28.0024196
[175,]  -23.5054264  7.983892  -39.36543427  -7.4887401
[176,]    7.1907196  8.324290   -8.92329523  23.8262415
[177,]    0.3260656  9.248353  -17.24564254  18.9467127
[178,]   -2.6746884 10.604585  -22.95312242  18.3635222
[179,]   11.5082576 12.250281  -12.16753820  36.3016075
[180,]   -5.2486964 14.084335  -32.21444759  23.3217736</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.4  3.3
looic      1770.0 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1283      
 (0.5, 0.7]   (ok)         2    1.1%   191       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.1
p_loo        33.7  8.2
looic      1722.1 44.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   865       
 (0.5, 0.7]   (ok)         5    2.8%   506       
   (0.7, 1]   (bad)        2    1.1%   29        
   (1, Inf)   (very bad)   1    0.6%   15        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.9      11.5  
fit_sleep1 -92.3      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.4  3.3
looic      1770.0 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1283      
 (0.5, 0.7]   (ok)         2    1.1%   191       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.1
p_loo        33.7  8.2
looic      1722.1 44.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   865       
 (0.5, 0.7]   (ok)         5    2.8%   506       
   (0.7, 1]   (bad)        2    1.1%   29        
   (1, Inf)   (very bad)   1    0.6%   15        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.1     22.1        33.7    8.2   1722.1
fit_sleep2  -23.9      11.5  -885.0     14.3        19.4    3.3   1770.0
fit_sleep1  -92.3      20.8  -953.3     10.5         3.2    0.5   1906.7
           se_looic
fit_sleep3   44.2  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.317752e-41 4.068487e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0      2.9      1.63     0.18     5.57       0.05      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0     -0.1      1.63    -3.46     3.07       5.15      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0.1       tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
