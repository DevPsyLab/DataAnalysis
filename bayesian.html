<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.00      7.06    15.78    43.09 1.00     1686     2398
sd(Days)                6.59      1.51     4.23    10.36 1.01     1025     1231
cor(Intercept,Days)     0.10      0.30    -0.48     0.68 1.01      856     1684

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.29      7.56   236.65   265.92 1.00     1777     2059
Days         10.41      1.68     7.11    13.66 1.00     1397     2104

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.88      1.53    23.18    29.05 1.00     3294     2986

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.2162  12.92603 227.9786 277.7702
309 211.1853  12.97772 185.5281 235.7679
310 212.8267  13.11163 186.5763 238.0238
330 274.5916  13.29853 249.9973 302.1984
331 273.0282  13.03506 248.2975 300.0732
332 260.0840  12.21743 236.1865 284.1221
333 268.0571  12.62397 243.2993 293.7176
334 244.1751  12.26738 219.1010 268.1765
335 250.5666  13.69449 224.2432 278.6002
337 286.0128  12.91449 260.8151 311.4574
349 226.6268  13.01911 200.6262 251.2632
350 238.9602  13.10403 212.3397 263.3221
351 255.6542  12.00702 232.2482 279.0961
352 272.1564  12.40735 248.7400 296.8792
369 254.4706  12.41183 230.7901 279.6285
370 226.2935  13.80648 198.9048 251.9399
371 252.3799  12.29657 228.4862 277.1615
372 263.3504  11.94699 240.3195 287.2587

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6090208  2.521568 14.7691315 24.614295
309  1.8071134  2.446780 -2.9104852  6.727587
310  4.9199821  2.435412  0.1592434  9.726210
330  5.7810624  2.536796  0.6595237 10.649089
331  7.5093762  2.459206  2.5997842 12.010298
332 10.2694427  2.326280  5.6325219 14.942528
333 10.2657054  2.396235  5.3159376 14.922941
334 11.5408349  2.347700  6.7265675 16.122699
335 -0.2186322  2.620607 -5.3726183  4.927230
337 19.1342827  2.458566 14.2818790 23.879678
349 11.5521766  2.470246  6.7933667 16.568973
350 16.9802887  2.469200 12.2515701 21.851910
351  7.5087954  2.346094  2.8264158 12.077410
352 14.0226409  2.384660  9.3504684 18.595802
369 11.3687643  2.408927  6.6592730 16.231626
370 15.1931431  2.607870 10.3076639 20.402297
371  9.4746553  2.383869  4.6621616 13.981652
372 11.8162372  2.291560  7.3431956 16.256812</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.2162 12.926027 227.9786 277.7702
  [2,] 273.8252 10.996178 251.3347 294.1422
  [3,] 293.4342  9.352342 274.3998 311.1509
  [4,] 313.0432  8.169045 296.6215 328.5300
  [5,] 332.6523  7.662695 317.5339 347.4286
  [6,] 352.2613  7.963486 336.7960 367.9578
  [7,] 371.8703  8.990769 354.4648 389.3480
  [8,] 391.4793 10.534104 370.8088 411.9449
  [9,] 411.0883 12.402314 386.5089 435.3854
 [10,] 430.6974 14.470108 402.1636 459.0667
 [11,] 211.1853 12.977721 185.5281 235.7679
 [12,] 212.9924 11.155981 191.1552 234.4419
 [13,] 214.7995  9.615824 195.8163 233.1641
 [14,] 216.6066  8.511503 200.3377 233.6313
 [15,] 218.4137  8.025009 202.9822 234.2214
 [16,] 220.2208  8.266155 203.9667 236.2430
 [17,] 222.0279  9.177763 203.7962 239.6692
 [18,] 223.8351 10.588051 202.5365 244.0331
 [19,] 225.6422 12.327034 201.2008 249.5283
 [20,] 227.4493 14.275090 199.2719 254.9897
 [21,] 212.8267 13.111626 186.5763 238.0238
 [22,] 217.7467 11.261515 195.2981 239.5630
 [23,] 222.6667  9.674254 203.5762 241.4079
 [24,] 227.5867  8.498417 211.2180 244.0574
 [25,] 232.5067  7.919437 216.9426 247.9718
 [26,] 237.4267  8.066865 221.5505 253.2481
 [27,] 242.3466  8.904696 224.6433 259.5505
 [28,] 247.2666 10.265251 226.6826 267.3722
 [29,] 252.1866 11.971617 228.2797 275.2670
 [30,] 257.1066 13.896989 229.0915 284.1109
 [31,] 274.5916 13.298533 249.9973 302.1984
 [32,] 280.3727 11.358981 258.8563 303.8044
 [33,] 286.1538  9.699103 267.5788 305.9150
 [34,] 291.9348  8.484658 275.3533 308.8405
 [35,] 297.7159  7.923188 282.0338 313.3003
 [36,] 303.4970  8.150770 287.4225 319.2468
 [37,] 309.2780  9.108451 291.2634 326.7671
 [38,] 315.0591 10.600159 294.1765 335.4268
 [39,] 320.8401 12.435173 296.5800 344.6737
 [40,] 326.6212 14.483589 298.2251 354.4814
 [41,] 273.0282 13.035064 248.2975 300.0732
 [42,] 280.5376 11.160765 259.2361 303.6928
 [43,] 288.0470  9.555513 269.8671 307.1060
 [44,] 295.5564  8.375462 279.3680 312.2466
 [45,] 303.0657  7.815644 287.5413 318.0470
 [46,] 310.5751  8.007222 294.5464 325.9975
 [47,] 318.0845  8.901815 300.6444 335.2174
 [48,] 325.5939 10.318159 305.9734 345.8522
 [49,] 333.1033 12.074017 309.7373 356.6133
 [50,] 340.6126 14.042605 313.2460 367.6729
 [51,] 260.0840 12.217428 236.1865 284.1221
 [52,] 270.3535 10.533775 249.8497 291.1551
 [53,] 280.6229  9.136653 263.0286 298.5726
 [54,] 290.8923  8.174326 274.6449 306.8802
 [55,] 301.1618  7.809221 285.5253 316.7069
 [56,] 311.4312  8.122278 295.0198 327.3278
 [57,] 321.7007  9.043342 303.3206 339.2626
 [58,] 331.9701 10.412291 310.7144 351.9940
 [59,] 342.2396 12.077779 317.8772 365.6056
 [60,] 352.5090 13.933873 324.5210 379.4036
 [61,] 268.0571 12.623968 243.2993 293.7176
 [62,] 278.3228 10.837340 257.1906 300.2944
 [63,] 288.5885  9.328193 270.3312 306.9167
 [64,] 298.8542  8.250233 282.7056 315.1432
 [65,] 309.1199  7.784689 293.8142 324.0448
 [66,] 319.3856  8.038675 303.6424 334.7865
 [67,] 329.6513  8.951152 311.6843 347.1416
 [68,] 339.9170 10.349387 318.8628 359.7870
 [69,] 350.1827 12.065671 325.8268 373.2463
 [70,] 360.4484 13.983379 332.2358 386.7767
 [71,] 244.1751 12.267379 219.1010 268.1765
 [72,] 255.7160 10.550061 234.3688 276.3967
 [73,] 267.2568  9.118244 249.2924 285.0452
 [74,] 278.7976  8.124306 263.0162 294.6794
 [75,] 290.3385  7.738845 275.3090 305.2974
 [76,] 301.8793  8.049749 286.4361 317.7660
 [77,] 313.4201  8.985021 295.9421 331.0557
 [78,] 324.9610 10.377192 304.3605 345.0955
 [79,] 336.5018 12.069177 312.5178 359.5986
 [80,] 348.0427 13.952324 320.1590 374.5765
 [81,] 250.5666 13.694490 224.2432 278.6002
 [82,] 250.3480 11.675627 227.4222 274.3165
 [83,] 250.1293  9.941662 230.9887 270.0464
 [84,] 249.9107  8.665342 232.9561 266.5538
 [85,] 249.6921  8.066898 233.8488 265.4094
 [86,] 249.4735  8.294377 233.1253 265.4797
 [87,] 249.2548  9.287286 231.5767 267.3490
 [88,] 249.0362 10.837243 228.4858 270.2353
 [89,] 248.8176 12.742573 224.1757 273.8307
 [90,] 248.5989 14.867267 219.6633 278.2052
 [91,] 286.0128 12.914490 260.8151 311.4574
 [92,] 305.1471 11.066567 283.5788 327.1063
 [93,] 324.2814  9.499623 305.9437 343.4381
 [94,] 343.4157  8.372924 327.1954 360.3561
 [95,] 362.5500  7.877689 346.8915 378.3825
 [96,] 381.6842  8.130141 365.4967 397.3659
 [97,] 400.8185  9.068047 382.8177 417.9852
 [98,] 419.9528 10.509466 399.2671 439.6333
 [99,] 439.0871 12.278328 414.6810 462.1711
[100,] 458.2214 14.253242 429.6088 485.0866
[101,] 226.6268 13.019111 200.6262 251.2632
[102,] 238.1790 11.165325 216.0668 259.0509
[103,] 249.7312  9.593536 230.7111 268.1687
[104,] 261.2833  8.462365 244.4845 277.6257
[105,] 272.8355  7.961881 257.0275 288.7336
[106,] 284.3877  8.208270 268.1593 300.5482
[107,] 295.9399  9.141339 278.0167 313.6342
[108,] 307.4920 10.580959 286.6361 327.9593
[109,] 319.0442 12.351256 294.5497 342.7652
[110,] 330.5964 14.330199 302.5607 358.0755
[111,] 238.9602 13.104032 212.3397 263.3221
[112,] 255.9405 11.209674 233.5052 276.8892
[113,] 272.9208  9.580804 253.7849 290.9522
[114,] 289.9011  8.373811 273.0920 305.7005
[115,] 306.8813  7.787394 291.3806 321.8564
[116,] 323.8616  7.959912 308.0210 339.6941
[117,] 340.8419  8.847077 323.2788 358.2553
[118,] 357.8222 10.265245 337.7112 378.4737
[119,] 374.8025 12.028035 351.2154 398.5412
[120,] 391.7828 14.005923 364.0749 419.3159
[121,] 255.6542 12.007017 232.2482 279.0961
[122,] 263.1630 10.320462 242.9779 283.0678
[123,] 270.6718  8.936649 253.2349 288.1860
[124,] 278.1806  8.013974 262.7080 293.8815
[125,] 285.6894  7.719597 270.5305 301.0630
[126,] 293.1982  8.122123 277.1083 309.2308
[127,] 300.7069  9.129836 282.9422 319.1729
[128,] 308.2157 10.571057 287.6956 329.2513
[129,] 315.7245 12.294263 291.7720 340.5050
[130,] 323.2333 14.197143 295.4981 351.2265
[131,] 272.1564 12.407345 248.7400 296.8792
[132,] 286.1790 10.657101 266.3166 307.4860
[133,] 300.2017  9.196662 282.7242 318.7661
[134,] 314.2243  8.182700 298.4815 330.5289
[135,] 328.2470  7.791521 313.0116 343.5466
[136,] 342.2696  8.113705 326.4407 358.6906
[137,] 356.2922  9.073579 338.8052 374.4113
[138,] 370.3149 10.497651 350.0627 390.9732
[139,] 384.3375 12.224759 360.7451 407.8273
[140,] 398.3602 14.144327 371.2128 425.6376
[141,] 254.4706 12.411825 230.7901 279.6285
[142,] 265.8394 10.656714 245.4488 287.6721
[143,] 277.2081  9.202367 259.5841 295.7673
[144,] 288.5769  8.210202 272.6751 304.7185
[145,] 299.9457  7.857298 284.4219 315.4408
[146,] 311.3144  8.226341 295.1700 327.4368
[147,] 322.6832  9.231149 304.6889 340.5193
[148,] 334.0520 10.693988 313.1902 354.8771
[149,] 345.4207 12.454498 321.0357 369.5359
[150,] 356.7895 14.403941 327.9423 384.6628
[151,] 226.2935 13.806480 198.9048 251.9399
[152,] 241.4867 11.735091 218.1393 263.2108
[153,] 256.6798  9.920071 237.1448 275.1789
[154,] 271.8730  8.526736 254.8485 288.0580
[155,] 287.0661  7.784897 271.6971 302.1477
[156,] 302.2592  7.880736 286.8466 317.3740
[157,] 317.4524  8.786885 300.2783 334.6272
[158,] 332.6455 10.291485 312.5678 352.9349
[159,] 347.8387 12.174645 323.7339 372.0470
[160,] 363.0318 14.287451 334.8466 391.3997
[161,] 252.3799 12.296570 228.4862 277.1615
[162,] 261.8546 10.539445 241.3972 283.3288
[163,] 271.3292  9.073027 253.5571 289.3438
[164,] 280.8039  8.057630 264.9199 296.8164
[165,] 290.2785  7.674415 275.0514 305.3799
[166,] 299.7532  8.014583 283.9953 315.7445
[167,] 309.2279  8.996450 291.4911 326.9381
[168,] 318.7025 10.440514 298.2027 338.9416
[169,] 328.1772 12.183522 304.2770 351.9253
[170,] 337.6518 14.115160 310.1126 365.3901
[171,] 263.3504 11.946987 240.3195 287.2587
[172,] 275.1666 10.311536 255.0538 295.6254
[173,] 286.9829  8.968140 269.4172 304.5358
[174,] 298.7991  8.064106 283.0968 314.3086
[175,] 310.6153  7.754649 295.4343 325.5528
[176,] 322.4316  8.108134 306.7946 338.0610
[177,] 334.2478  9.047187 316.6998 352.0821
[178,] 346.0640 10.414598 326.3918 367.1412
[179,] 357.8803 12.065596 334.8942 382.3799
[180,] 369.6965 13.899491 343.4255 397.5694</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.6561804 12.926027  -28.2102114  21.5813824
  [2,]  -15.1205012 10.996178  -35.4375172   7.3700124
  [3,]  -42.6336220  9.352342  -60.3502653 -23.5992479
  [4,]    8.3965571  8.169045   -7.0902374  24.8183100
  [5,]   24.1996363  7.662695    9.4232801  39.3180245
  [6,]   62.4288155  7.963486   46.7323305  77.8940820
  [7,]   10.3334947  8.990769   -7.1441725  27.7389654
  [8,] -101.3307261 10.534104 -121.7962678 -80.6602349
  [9,]   19.4969531 12.402314   -4.8001069  44.0764444
 [10,]   35.6561323 14.470108    7.2868476  64.1898517
 [11,]   11.5486372 12.977721  -13.0339514  37.2058126
 [12,]   -7.7265761 11.155981  -29.1761437  14.1105623
 [13,]  -11.8216895  9.615824  -30.1863163   7.1615073
 [14,]  -11.8996028  8.511503  -28.9242897   4.3693409
 [15,]  -10.6976162  8.025009  -26.5053314   4.7339288
 [16,]   -4.2590295  8.266155  -20.2812365  11.9950851
 [17,]   -8.3976429  9.177763  -26.0388958   9.8340620
 [18,]   -6.1078563 10.588051  -26.3058677  15.1907444
 [19,]   -1.3464696 12.327034  -25.2326453  23.0949375
 [20,]    9.8649170 14.275090  -17.6754598  38.0422998
 [21,]  -13.7728495 13.111626  -38.9698766  12.4776092
 [22,]  -23.4145316 11.261515  -45.2307706  -0.9658520
 [23,]   11.6532862  9.674254   -7.0878606  30.7437753
 [24,]    5.2549041  8.498417  -11.2157977  21.6235968
 [25,]   -3.1992780  7.919437  -18.6644055  12.3648018
 [26,]  -16.9687602  8.066865  -32.7901824  -1.0926225
 [27,]   -6.9258423  8.904696  -24.1297311  10.7774939
 [28,]    8.4844755 10.265251  -11.6210748  29.0685196
 [29,]    8.8258934 11.971617  -14.2544708  32.7327967
 [30,]   -9.5912888 13.896989  -36.5956169  18.4237942
 [31,]   46.9509522 13.298533   19.3442075  71.5452684
 [32,]   20.0274898 11.358981   -3.4041630  41.5438761
 [33,]   -2.2972725  9.699103  -22.0584630  16.2777342
 [34,]   -6.8018349  8.484658  -23.7074843   9.7796643
 [35,]  -11.9185972  7.923188  -27.5030284   3.7634953
 [36,]   -5.9114596  8.150770  -21.6612689  10.1630390
 [37,]  -29.0384219  9.108451  -46.5275290 -11.0237616
 [38,]    3.2022157 10.600159  -17.1654583  24.0848308
 [39,]  -15.4906466 12.435173  -39.3242209   8.7694864
 [40,]   27.4274910 14.483589   -0.4326547  55.8236085
 [41,]   14.5796562 13.035064  -12.4652625  39.3103846
 [42,]    4.4623800 11.160765  -18.6927905  25.7638724
 [43,]   13.7736037  9.555513   -5.2854164  31.9535008
 [44,]   24.5589275  8.375462    7.8686707  40.7472775
 [45,]   13.2115512  7.815644   -1.7696720  28.7360018
 [46,]  -17.2564250  8.007222  -32.6788029  -1.2277012
 [47,]  -28.0095012  8.901815  -45.1423835 -10.5694477
 [48,]    9.2238225 10.318159  -11.0344973  28.8443234
 [49,]  -39.3563537 12.074017  -62.8664301 -15.9903715
 [50,]   30.9684701 14.042605    3.9081859  58.3350929
 [51,]  -25.2234155 12.217428  -49.2614664  -1.3259058
 [52,]  -27.5416582 10.533775  -48.3433174  -7.0378921
 [53,]   -7.6616009  9.136653  -25.6112942   9.9326678
 [54,]   18.8764563  8.174326    2.8886027  35.1239053
 [55,]   16.3011136  7.809221    0.7560155  31.9375976
 [56,]   -1.4336292  8.122278  -17.3302433  14.9778114
 [57,]  132.4612281  9.043342  114.8992534 150.8413207
 [58,]   14.8609853 10.412291   -5.1628806  36.1166753
 [59,]  -11.9392574 12.077779  -35.3053493  12.4230606
 [60,]  -98.6446001 13.933873 -125.5391894 -70.6565558
 [61,]   15.7853022 12.623968   -9.8751993  40.5431407
 [62,]   11.2321968 10.837340  -10.7394180  32.3644465
 [63,]  -11.8192086  9.328193  -30.1473820   6.4380802
 [64,]    0.9554860  8.250233  -15.3334795  17.1040611
 [65,]  -11.9489194  7.784689  -26.8738454   3.3568165
 [66,]   18.7808753  8.038675    3.3799780  34.5241044
 [67,]    2.3751699  8.951152  -15.1151258  20.3421982
 [68,]    8.9228645 10.349387  -10.9470645  29.9770734
 [69,]  -16.8227409 12.065671  -39.8863231   7.5331541
 [70,]    1.5943537 13.983379  -24.7338543  29.8069802
 [71,]   21.2979629 12.267379   -2.7034436  46.3721119
 [72,]   20.4852280 10.550061   -0.1954985  41.8323783
 [73,]  -23.8921069  9.118244  -41.6804972  -5.9276887
 [74,]  -24.1253418  8.124306  -40.0070826  -8.3439164
 [75,]  -11.3140767  7.738845  -26.2730057   3.7154445
 [76,]  -17.6881116  8.049749  -33.5748299  -2.2449121
 [77,]   -7.8953466  8.985021  -25.5308683   9.5826909
 [78,]    6.5619185 10.377192  -13.5726201  27.1624375
 [79,]   -0.7549164 12.069177  -23.8517467  23.2290676
 [80,]   29.2563487 13.952324    2.7225026  57.1400165
 [81,]   -8.9583117 13.694490  -36.9918596  17.3651242
 [82,]   23.5992205 11.675627   -0.3692853  46.5249694
 [83,]    4.3613527  9.941662  -15.5557324  23.5019545
 [84,]   20.8913848  8.665342    4.2482558  37.8460191
 [85,]    1.7598170  8.066898  -13.9574539  17.6031066
 [86,]    5.1627492  8.294377  -10.8434977  21.5109337
 [87,]   -3.8025186  9.287286  -21.8967219  13.8755897
 [88,]  -13.7251865 10.837243  -34.9243221   6.8251840
 [89,]  -13.0634543 12.742573  -38.0765924  11.5784146
 [90,]  -11.3523221 14.867267  -40.9586237  17.5833165
 [91,]   26.3537711 12.914490    0.9092191  51.5514984
 [92,]    8.6586885 11.066567  -13.3005400  30.2270091
 [93,]  -32.6701942  9.499623  -51.8268548 -14.3324626
 [94,]    2.7065232  8.372924  -14.2338681  18.9267993
 [95,]    3.1824405  7.877689  -12.6501113  18.8409156
 [96,]   10.1542579  8.130141   -5.5274127  26.3417740
 [97,]    3.4415752  9.068047  -13.7251396  21.4423564
 [98,]   -3.2605074 10.509466  -22.9409762  17.4251900
 [99,]   16.7772099 12.278328   -6.3068228  41.1833229
[100,]    0.6953273 14.253242  -26.1699170  29.3079218
[101,]    9.4764028 13.019111  -15.1599616  35.4769588
[102,]   -7.8622738 11.165325  -28.7341979  14.2499194
[103,]  -10.8055504  9.593536  -29.2430964   8.2144602
[104,]   -6.3613270  8.462365  -22.7036693  10.4374973
[105,]  -22.1252036  7.961881  -38.0232744  -6.3171809
[106,]  -14.6132802  8.208270  -30.7737585   1.6151349
[107,]  -14.3750568  9.141339  -32.0693812   3.5481245
[108,]    0.6099666 10.580959  -19.8573459  21.4658626
[109,]   17.2363900 12.351256   -6.4846071  41.7308963
[110,]   21.0487134 14.330199   -6.4304326  49.0843706
[111,]   17.3366114 13.104032   -7.0252786  43.9571068
[112,]  -12.4861773 11.209674  -33.4349305   9.9491179
[113,]  -16.7161659  9.580804  -34.7476380   2.4197205
[114,]  -34.3739546  8.373811  -50.1733701 -17.5648920
[115,]  -37.9648432  7.787394  -52.9398994 -22.4641301
[116,]    5.8630681  7.959912   -9.9693961  21.7036670
[117,]   38.6025794  8.847077   21.1892418  56.1656633
[118,]    5.0961908 10.265245  -15.5552885  25.2072237
[119,]   19.6847021 12.028035   -4.0539737  43.2717815
[120,]   -2.7300865 14.005923  -30.2631896  24.9777646
[121,]   -5.1276734 12.007017  -28.5695513  18.2782523
[122,]   36.8946312 10.320462   16.9897781  57.0796797
[123,]   -0.7778642  8.936649  -18.2920606  16.6590103
[124,]    2.4085404  8.013974  -13.2924252  17.8810721
[125,]  -13.8619550  7.719597  -29.2355612   1.2969436
[126,]   11.4354496  8.122123   -4.5972025  27.5252966
[127,]  -12.9603458  9.129836  -31.4262867   4.8044486
[128,]  -41.6202412 10.571057  -62.6558162 -21.1001061
[129,]    5.8172634 12.294263  -18.9631823  29.7697884
[130,]   24.3321680 14.197143   -3.6610374  52.0674461
[131,]  -50.4792995 12.407345  -75.2020929 -27.0628737
[132,]   12.0148596 10.657101   -9.2921368  31.8773217
[133,]   26.6768186  9.196662    8.1124478  44.1542874
[134,]   32.6311777  8.182700   16.3266082  48.3740182
[135,]   20.4932368  7.791521    5.1935807  35.7286152
[136,]   10.5590959  8.113705   -5.8619186  26.3880282
[137,]   -1.8656451  9.073579  -19.9846849  15.6214102
[138,]   -9.8822860 10.497651  -30.5406218  10.3698518
[139,]   -8.6969269 12.224759  -32.1867226  14.8955219
[140,]   -9.8184678 14.144327  -37.0958766  17.3288522
[141,]   17.4528883 12.411825   -7.7050287  41.1333519
[142,]    2.5975240 10.656714  -19.2352358  22.9881331
[143,]  -19.9657403  9.202367  -38.5248581  -2.3417199
[144,]  -10.9203045  8.210202  -27.0618675   4.9814758
[145,]   14.8765312  7.857298   -0.6186000  30.4003161
[146,]    5.8990669  8.226341  -10.2233123  22.0435427
[147,]  -24.5478973  9.231149  -42.3840346  -6.5536322
[148,]   14.0709384 10.693988   -6.7541955  34.9326664
[149,]   -5.1407259 12.454498  -29.2559189  19.2443324
[150,]    9.7236099 14.403941  -18.1497037  38.5707640
[151,]   -1.0295289 13.806480  -26.6759190  26.3592106
[152,]   -6.9631720 11.735091  -28.6872527  16.3841716
[153,]  -17.7790151  9.920071  -36.2780828   1.7560222
[154,]  -31.3999582  8.526736  -47.5849942 -14.3754774
[155,]  -19.5288013  7.784897  -34.6103629  -4.1598243
[156,]   41.9344556  7.880736   26.8196848  57.3471238
[157,]  -36.3042875  8.786885  -53.4791178 -19.1301800
[158,]   14.9399694 10.291485   -5.3493611  35.0176574
[159,]   17.3243263 12.174645   -6.8839871  41.4291368
[160,]    9.1969832 14.287451  -19.1708775  37.3822081
[161,]   17.5004777 12.296570   -7.2810744  41.3941728
[162,]   10.5882224 10.539445  -10.8860120  31.0455928
[163,]    6.5696671  9.073027  -11.4449189  24.3417989
[164,]    0.9856119  8.057630  -15.0269227  16.8696432
[165,]  -11.1080434  7.674415  -26.2093699   4.1190869
[166,]  -15.2411987  8.014583  -31.2325472   0.5166997
[167,]  -49.9620539  8.996450  -67.6722580 -32.2253337
[168,]  -14.0719092 10.440514  -34.3109739   6.4278717
[169,]   22.6035355 12.183522   -1.1445720  46.5037401
[170,]   31.8173802 14.115160    4.0790708  59.3566165
[171,]    6.0613124 11.946987  -17.8470055  29.0921837
[172,]   -1.6926248 10.311536  -22.1513585  18.4202385
[173,]   10.6139380  8.968140   -6.9389547  28.1795609
[174,]   11.8325008  8.064106   -3.6769750  27.5348270
[175,]  -23.4427364  7.754649  -38.3801727  -8.2617330
[176,]    7.1760264  8.108134   -8.4534370  22.8130377
[177,]    0.2339892  9.047187  -17.6003096  17.7819517
[178,]   -2.8441480 10.414598  -23.9213162  16.8281250
[179,]   11.2614148 12.065596  -13.2382370  34.2474676
[180,]   -5.5729224 13.899491  -33.4458059  20.6981398</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.4  3.3
looic      1769.9 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1150      
 (0.5, 0.7]   (ok)         2    1.1%   106       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.7
p_loo        34.1  8.7
looic      1722.3 45.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   558       
 (0.5, 0.7]   (ok)         3    1.7%   752       
   (0.7, 1]   (bad)        2    1.1%   36        
   (1, Inf)   (very bad)   2    1.1%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.8      12.0  
fit_sleep1 -92.2      21.3  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.4  3.3
looic      1769.9 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1150      
 (0.5, 0.7]   (ok)         2    1.1%   106       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.7
p_loo        34.1  8.7
looic      1722.3 45.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   558       
 (0.5, 0.7]   (ok)         3    1.7%   752       
   (0.7, 1]   (bad)        2    1.1%   36        
   (1, Inf)   (very bad)   2    1.1%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.1     22.7        34.1    8.7   1722.3
fit_sleep2  -23.8      12.0  -885.0     14.3        19.4    3.3   1769.9
fit_sleep1  -92.2      21.3  -953.3     10.5         3.2    0.5   1906.7
           se_looic
fit_sleep3   45.4  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
9.073299e-41 4.398442e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.94      1.53     0.42     5.35       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.06      1.53    -3.11     2.76       5.82      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.3.5         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.0       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
