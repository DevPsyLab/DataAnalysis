<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.21      7.06    15.93    43.28 1.00     1712     2214
sd(Days)                6.56      1.55     4.17    10.05 1.00     1369     1918
cor(Intercept,Days)     0.08      0.30    -0.49     0.67 1.00     1105     1800

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.10      7.55   236.25   266.01 1.00     2156     2584
Days         10.38      1.70     7.04    13.69 1.00     1810     2286

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.59    23.01    29.20 1.00     3697     2869

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9285  13.00224 227.6393 278.7610
309 211.2148  13.32281 185.0361 237.5074
310 212.6920  13.11182 186.4829 237.8233
330 274.8962  13.29996 249.6654 301.0903
331 273.0481  13.07538 248.4352 298.9350
332 260.3230  12.20636 236.9092 284.1582
333 267.9224  12.50385 243.9907 292.4832
334 244.4696  12.47016 220.1523 268.7800
335 250.5834  13.27730 224.8610 277.1989
337 286.0972  13.09832 259.8150 311.4165
349 226.3041  12.87447 200.4258 251.5205
350 238.5338  13.25297 212.3507 264.4457
351 255.6890  12.15858 231.6789 279.8087
352 272.2640  12.75138 248.1214 297.5108
369 254.5429  12.61852 230.0531 279.5562
370 226.0341  13.85522 198.4939 252.0285
371 252.1657  12.22838 227.8804 276.3500
372 263.5067  12.58751 238.4514 287.7215

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5853672  2.511458 14.8754933 24.657853
309  1.8292593  2.525168 -3.2288640  6.713821
310  4.9864469  2.506704  0.1866918  9.907621
330  5.7233586  2.512611  0.7115794 10.431075
331  7.5068384  2.466966  2.6642753 12.199344
332 10.2353059  2.330339  5.5929438 14.683079
333 10.2949601  2.356457  5.6478187 14.860244
334 11.5288636  2.401956  6.9005234 16.258407
335 -0.2110768  2.562927 -5.2691325  4.676047
337 19.1127045  2.478725 14.2217824 24.024616
349 11.6038851  2.440712  6.9114718 16.445459
350 17.0315022  2.484656 12.1483811 21.867586
351  7.5239131  2.354418  2.8967299 12.227717
352 13.9901603  2.435922  9.2306366 18.667093
369 11.3915862  2.399118  6.6315557 16.037066
370 15.2526449  2.576964 10.2070144 20.446806
371  9.4991082  2.337137  4.9760620 14.056882
372 11.7999910  2.409690  7.1191729 16.604494</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9285 13.002237 227.6393 278.7610
  [2,] 273.5139 11.109360 251.3928 294.8522
  [3,] 293.0992  9.507494 274.0645 311.7339
  [4,] 312.6846  8.365514 295.8415 329.0652
  [5,] 332.2700  7.885814 316.4822 347.4999
  [6,] 351.8553  8.185666 335.6004 368.1433
  [7,] 371.4407  9.189072 353.2367 389.1684
  [8,] 391.0261 10.699896 370.0968 411.7656
  [9,] 410.6114 12.536003 386.0870 435.2177
 [10,] 430.1968 14.574971 401.9104 459.2463
 [11,] 211.2148 13.322814 185.0361 237.5074
 [12,] 213.0440 11.391398 190.5791 235.0379
 [13,] 214.8733  9.735681 195.6788 233.5552
 [14,] 216.7025  8.517978 199.8671 232.9732
 [15,] 218.5318  7.942378 202.8619 233.8179
 [16,] 220.3610  8.146149 204.3662 236.4235
 [17,] 222.1903  9.076952 204.8258 239.8780
 [18,] 224.0196 10.543971 203.6573 244.6796
 [19,] 225.8488 12.357692 201.7660 249.3717
 [20,] 227.6781 14.387589 199.5783 255.2450
 [21,] 212.6920 13.111819 186.4829 237.8233
 [22,] 217.6785 11.213020 195.4180 238.7923
 [23,] 222.6649  9.597445 203.5910 241.0056
 [24,] 227.6514  8.429545 210.9872 243.9376
 [25,] 232.6378  7.910160 216.8064 248.3137
 [26,] 237.6243  8.164016 221.4683 253.9096
 [27,] 242.6107  9.126819 224.8813 260.5054
 [28,] 247.5972 10.607243 226.7686 268.2646
 [29,] 252.5836 12.421575 227.8672 276.7766
 [30,] 257.5701 14.444534 229.3347 285.3883
 [31,] 274.8962 13.299957 249.6654 301.0903
 [32,] 280.6195 11.369964 259.1302 303.2018
 [33,] 286.3429  9.710291 267.9773 305.4565
 [34,] 292.0662  8.481146 276.0218 308.8040
 [35,] 297.7896  7.886467 282.6044 313.3216
 [36,] 303.5130  8.067795 287.4501 319.3647
 [37,] 309.2363  8.978234 291.5845 326.7798
 [38,] 314.9597 10.428542 294.1685 335.4630
 [39,] 320.6830 12.228112 296.9333 344.2224
 [40,] 326.4064 14.245187 298.6588 353.9382
 [41,] 273.0481 13.075381 248.4352 298.9350
 [42,] 280.5549 11.257229 259.2394 302.6113
 [43,] 288.0617  9.729166 269.2446 307.0141
 [44,] 295.5686  8.646386 278.3209 312.3863
 [45,] 303.0754  8.187499 286.7453 319.0905
 [46,] 310.5823  8.454711 294.0034 327.3297
 [47,] 318.0891  9.386211 299.8695 336.2054
 [48,] 325.5959 10.811644 304.5911 346.6958
 [49,] 333.1028 12.564003 308.9985 357.2674
 [50,] 340.6096 14.525444 312.3821 368.5531
 [51,] 260.3230 12.206359 236.9092 284.1582
 [52,] 270.5584 10.503759 250.2504 291.2307
 [53,] 280.7937  9.084254 263.1432 298.8057
 [54,] 291.0290  8.098107 275.4506 306.9682
 [55,] 301.2643  7.713364 286.4564 316.3317
 [56,] 311.4996  8.017081 295.9012 327.2453
 [57,] 321.7349  8.939359 304.2082 339.1445
 [58,] 331.9702 10.315603 311.6518 352.1388
 [59,] 342.2055 11.990502 318.6997 365.5975
 [60,] 352.4408 13.856175 325.0668 379.3995
 [61,] 267.9224 12.503851 243.9907 292.4832
 [62,] 278.2174 10.809337 257.7947 299.4213
 [63,] 288.5123  9.404414 270.3658 307.4021
 [64,] 298.8073  8.435048 282.6515 316.1295
 [65,] 309.1023  8.059953 293.5895 325.4607
 [66,] 319.3972  8.359511 303.1484 336.0317
 [67,] 329.6922  9.268538 311.8504 348.0220
 [68,] 339.9871 10.631836 319.0601 360.7265
 [69,] 350.2821 12.299262 326.4927 374.8727
 [70,] 360.5771 14.163811 332.9105 388.6690
 [71,] 244.4696 12.470163 220.1523 268.7800
 [72,] 255.9984 10.699217 234.8812 277.1401
 [73,] 267.5273  9.218476 249.2459 285.6277
 [74,] 279.0562  8.186949 262.9652 295.2977
 [75,] 290.5850  7.785292 275.4532 305.8341
 [76,] 302.1139  8.107662 286.1852 317.4979
 [77,] 313.6428  9.077245 295.8693 331.3814
 [78,] 325.1716 10.516529 304.1037 345.2594
 [79,] 336.7005 12.261205 312.4604 360.4087
 [80,] 348.2293 14.199145 320.1603 375.9786
 [81,] 250.5834 13.277300 224.8610 277.1989
 [82,] 250.3724 11.298399 228.5413 272.7195
 [83,] 250.1613  9.599901 231.7514 268.8658
 [84,] 249.9502  8.354615 233.5361 266.2353
 [85,] 249.7391  7.783205 234.2401 264.7474
 [86,] 249.5281  8.030825 233.3737 265.0508
 [87,] 249.3170  9.030350 231.1564 267.1058
 [88,] 249.1059 10.570595 227.8952 269.7515
 [89,] 248.8948 12.452506 224.1994 273.1304
 [90,] 248.6838 14.544056 219.6738 276.9135
 [91,] 286.0972 13.098322 259.8150 311.4165
 [92,] 305.2099 11.234100 282.6335 327.2796
 [93,] 324.3226  9.650498 305.3238 343.0022
 [94,] 343.4353  8.505728 326.8148 359.7961
 [95,] 362.5480  7.990672 346.5939 377.5772
 [96,] 381.6607  8.224503 365.2098 397.0572
 [97,] 400.7734  9.149984 382.6337 418.0394
 [98,] 419.8862 10.587263 398.8522 440.0155
 [99,] 438.9989 12.359054 414.3453 462.9731
[100,] 458.1116 14.341912 429.4284 486.2336
[101,] 226.3041 12.874474 200.4258 251.5205
[102,] 237.9080 11.095072 216.2186 259.5450
[103,] 249.5118  9.610583 230.9827 268.3393
[104,] 261.1157  8.575555 244.6003 278.3679
[105,] 272.7196  8.162789 257.0162 289.3949
[106,] 284.3235  8.463820 268.2811 301.0937
[107,] 295.9274  9.410395 278.3593 315.0540
[108,] 307.5313 10.834618 286.6711 328.9588
[109,] 319.1352 12.575234 294.6410 343.9944
[110,] 330.7390 14.518892 302.4488 360.0538
[111,] 238.5338 13.252967 212.3507 264.4457
[112,] 255.5653 11.332022 233.0619 277.8378
[113,] 272.5968  9.671367 253.8731 291.4175
[114,] 289.6283  8.426326 273.1118 305.9916
[115,] 306.6598  7.798566 291.2553 321.7756
[116,] 323.6913  7.935952 307.8662 338.9813
[117,] 340.7228  8.802730 323.0545 357.7384
[118,] 357.7543 10.214881 337.3342 377.1652
[119,] 374.7858 11.981092 351.1522 397.5946
[120,] 391.8173 13.967690 364.1757 418.6983
[121,] 255.6890 12.158584 231.6789 279.8087
[122,] 263.2130 10.451389 242.5804 284.0658
[123,] 270.7369  9.039827 252.8570 288.6081
[124,] 278.2608  8.080345 262.0598 293.4002
[125,] 285.7847  7.742871 270.2728 300.4209
[126,] 293.3086  8.105472 276.9730 308.6315
[127,] 300.8325  9.084706 282.5239 318.2814
[128,] 308.3564 10.509598 287.6867 328.5590
[129,] 315.8804 12.225301 292.1310 339.5874
[130,] 323.4043 14.126248 296.3753 351.2778
[131,] 272.2640 12.751379 248.1214 297.5108
[132,] 286.2542 10.938886 265.2569 307.8231
[133,] 300.2443  9.412131 281.9861 318.6752
[134,] 314.2345  8.329743 297.7163 330.5320
[135,] 328.2247  7.877085 312.8190 343.5687
[136,] 342.2148  8.159642 326.4553 358.7241
[137,] 356.2050  9.109252 337.8891 374.7443
[138,] 370.1951 10.547257 349.4857 391.4744
[139,] 384.1853 12.303586 360.4739 408.8646
[140,] 398.1755 14.261110 370.8641 426.5499
[141,] 254.5429 12.618520 230.0531 279.5562
[142,] 265.9345 10.881271 244.5163 287.6285
[143,] 277.3261  9.438675 259.1062 295.6934
[144,] 288.7177  8.443141 272.2339 305.2822
[145,] 300.1092  8.062024 284.6483 315.8282
[146,] 311.5008  8.379580 295.4893 327.8587
[147,] 322.8924  9.324700 304.8315 341.0651
[148,] 334.2840 10.732857 313.2335 355.3918
[149,] 345.6756 12.447890 320.9906 370.6776
[150,] 357.0672 14.360265 328.8694 385.7548
[151,] 226.0341 13.855219 198.4939 252.0285
[152,] 241.2867 11.879795 217.5243 263.6397
[153,] 256.5394 10.177105 236.5077 275.8971
[154,] 271.7920  8.904992 254.2724 289.2086
[155,] 287.0446  8.264730 270.8345 303.3657
[156,] 302.2973  8.402032 286.1548 319.0267
[157,] 317.5499  9.282457 299.6736 335.5040
[158,] 332.8026 10.724521 311.6904 353.5627
[159,] 348.0552 12.535875 323.2730 372.3492
[160,] 363.3079 14.579522 334.4234 391.6062
[161,] 252.1657 12.228383 227.8804 276.3500
[162,] 261.6648 10.534777 240.6159 282.4608
[163,] 271.1640  9.129849 252.9452 289.0865
[164,] 280.6631  8.164017 264.5371 296.6512
[165,] 290.1622  7.802091 274.5681 305.7231
[166,] 299.6613  8.125176 283.4544 315.4954
[167,] 309.1604  9.060285 291.3752 327.0207
[168,] 318.6595 10.444303 298.3278 339.0734
[169,] 328.1586 12.124463 304.4219 351.8088
[170,] 337.6577 13.994504 310.5640 364.8476
[171,] 263.5067 12.587513 238.4514 287.7215
[172,] 275.3067 10.780419 254.0726 295.7518
[173,] 287.1067  9.252167 268.5332 304.7034
[174,] 298.9066  8.160942 282.7360 314.5301
[175,] 310.7066  7.694970 295.5345 325.4903
[176,] 322.5066  7.964758 306.5059 338.0066
[177,] 334.3066  8.903673 316.5934 351.7653
[178,] 346.1066 10.330857 325.6710 366.2246
[179,] 357.9066 12.074397 333.8848 381.4985
[180,] 369.7066 14.016730 341.9306 396.9343</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.3684866 13.002237  -29.2010411  21.9207417
  [2,]  -14.8091538 11.109360  -36.1475078   7.3118957
  [3,]  -42.2986210  9.507494  -60.9333366 -23.2639375
  [4,]    8.7552118  8.365514   -7.6254466  25.5983448
  [5,]   24.5819446  7.885814    9.3519857  40.3697010
  [6,]   62.8347774  8.185666   46.5468165  79.0896890
  [7,]   10.7631102  9.189072   -6.9645806  28.9670713
  [8,] -100.8774570 10.699896 -121.6169663 -79.9482016
  [9,]   19.9738758 12.536003   -4.6323508  44.4983437
 [10,]   36.1567086 14.574971    7.1071568  64.4431312
 [11,]   11.5191491 13.322814  -14.7735425  37.6977771
 [12,]   -7.7782101 11.391398  -29.7720719  14.6867077
 [13,]  -11.8954694  9.735681  -30.5773530   7.2989711
 [14,]  -11.9955286  8.517978  -28.2662211   4.8399498
 [15,]  -10.8156879  7.942378  -26.1017553   4.8542343
 [16,]   -4.3992471  8.146149  -20.4616534  11.5956252
 [17,]   -8.5600064  9.076952  -26.2476868   8.8044907
 [18,]   -6.2923656 10.543971  -26.9523892  14.0699094
 [19,]   -1.5531249 12.357692  -25.0759619  22.5296645
 [20,]    9.6361159 14.387589  -17.9308329  37.7358650
 [21,]  -13.6381371 13.111819  -38.7693746  12.5710378
 [22,]  -23.3462840 11.213020  -44.4601399  -1.0858038
 [23,]   11.6550691  9.597445   -6.6855557  30.7289891
 [24,]    5.1902222  8.429545  -11.0959962  21.8544178
 [25,]   -3.3304247  7.910160  -19.0063305  12.5009945
 [26,]  -17.1663716  8.164016  -33.4516554  -1.0104455
 [27,]   -7.1899184  9.126819  -25.0846384  10.5395432
 [28,]    8.1539347 10.607243  -12.5134589  28.9825348
 [29,]    8.4288878 12.421575  -15.7641313  33.1452903
 [30,]  -10.0547591 14.444534  -37.8729622  18.1806176
 [31,]   46.6464292 13.299957   20.4523434  71.8771908
 [32,]   19.7806707 11.369964   -2.8015573  41.2700204
 [33,]   -2.4863879  9.710291  -21.5999791  15.8792447
 [34,]   -6.9332465  8.481146  -23.6709766   9.1111787
 [35,]  -11.9923051  7.886467  -27.5242890   3.1929128
 [36,]   -5.9274637  8.067795  -21.7791910  10.1353972
 [37,]  -28.9967223  8.978234  -46.5401648 -11.3449447
 [38,]    3.3016191 10.428542  -17.2016615  24.0927563
 [39,]  -15.3335395 12.228112  -38.8728839   8.4162426
 [40,]   27.6423019 14.245187    0.1105295  55.3898932
 [41,]   14.5598405 13.075381  -11.3271394  39.1726816
 [42,]    4.4451021 11.257229  -17.6112563  25.7605525
 [43,]   13.7588637  9.729166   -5.1934883  32.5760350
 [44,]   24.5467253  8.646386    7.7290110  41.7943732
 [45,]   13.2018869  8.187499   -2.8131811  29.5319715
 [46,]  -17.2635515  8.454711  -34.0110357  -0.6847416
 [47,]  -28.0140899  9.386211  -46.1303526  -9.7945355
 [48,]    9.2217717 10.811644  -11.8781000  30.2265513
 [49,]  -39.3558667 12.564003  -63.5205105 -15.2515812
 [50,]   30.9714949 14.525444    3.0280174  59.1990249
 [51,]  -25.4624492 12.206359  -49.2976218  -2.0486200
 [52,]  -27.7465551 10.503759  -48.4189102  -7.4386470
 [53,]   -7.8323610  9.084254  -25.8444334   9.8180743
 [54,]   18.7398331  8.098107    2.8006335  34.3182164
 [55,]   16.1986272  7.713364    1.1311503  31.0065053
 [56,]   -1.5019787  8.017081  -17.2476883  14.0963664
 [57,]  132.4270154  8.939359  115.0173895 149.9537074
 [58,]   14.8609095 10.315603   -5.3076780  35.1792500
 [59,]  -11.9051964 11.990502  -35.2972193  11.6005634
 [60,]  -98.5764023 13.856175 -125.5351290 -71.2024186
 [61,]   15.9199726 12.503851   -8.6407640  39.8517213
 [62,]   11.3376125 10.809337   -9.8662848  31.7602946
 [63,]  -11.7430477  9.404414  -30.6327513   6.4035031
 [64,]    1.0023922  8.435048  -16.3197810  17.1582370
 [65,]  -11.9312679  8.059953  -28.2897184   3.5815066
 [66,]   18.7692719  8.359511    2.1347529  35.0180809
 [67,]    2.3343118  9.268538  -15.9954820  20.1761009
 [68,]    8.8527517 10.631836  -11.8866066  29.7798253
 [69,]  -16.9221085 12.299262  -41.5126849   6.8673496
 [70,]    1.4657314 14.163811  -26.6262204  29.1322722
 [71,]   21.0035276 12.470163   -3.3068748  45.3208188
 [72,]   20.2027640 10.699217   -0.9389453  41.3200411
 [73,]  -24.1625995  9.218476  -42.2630003  -5.8812094
 [74,]  -24.3838631  8.186949  -40.6253803  -8.2928764
 [75,]  -11.5606266  7.785292  -26.8097121   3.5712309
 [76,]  -17.9226902  8.107662  -33.3066927  -1.9939615
 [77,]   -8.1179538  9.077245  -25.8565531   9.6555088
 [78,]    6.3512827 10.516529  -13.7365351  27.4191855
 [79,]   -0.9535809 12.261205  -24.6617512  23.2865212
 [80,]   29.0696556 14.199145    1.3203738  57.1387440
 [81,]   -8.9751435 13.277300  -35.5905880  16.7473139
 [82,]   23.5748333 11.298399    1.2276779  45.4059168
 [83,]    4.3294101  9.599901  -14.3751438  22.7392767
 [84,]   20.8518869  8.354615    4.5667631  37.2659960
 [85,]    1.7127637  7.783205  -13.2955308  17.2117748
 [86,]    5.1081406  8.030825  -10.4145982  21.2624510
 [87,]   -3.8646826  9.030350  -21.6535250  14.2958860
 [88,]  -13.7949058 10.570595  -34.4404500   7.4157551
 [89,]  -13.1407290 12.452506  -37.3762842  11.5547045
 [90,]  -11.4371522 14.544056  -39.6668566  17.5728054
 [91,]   26.2693787 13.098322    0.9500882  52.5515925
 [92,]    8.5958742 11.234100  -13.4738384  31.1722675
 [93,]  -32.7114303  9.650498  -51.3910426 -13.7126334
 [94,]    2.6868652  8.505728  -13.6738507  19.3074408
 [95,]    3.1843607  7.990672  -11.8448102  19.1384750
 [96,]   10.1777562  8.224503   -5.2187206  26.6287034
 [97,]    3.4866517  9.149984  -13.7792537  21.6263889
 [98,]   -3.1938528 10.587263  -23.3232075  17.8401194
 [99,]   16.8654427 12.359054   -7.1087824  41.5190359
[100,]    0.8051382 14.341912  -27.3168964  29.4882569
[101,]    9.7991287 12.874474  -15.4172561  35.6774468
[102,]   -7.5912564 11.095072  -29.2283090  14.0980608
[103,]  -10.5862415  9.610583  -29.4136618   7.9429147
[104,]   -6.1937266  8.575555  -23.4458547  10.3216816
[105,]  -22.0093117  8.162789  -38.6846376  -6.3059254
[106,]  -14.5490968  8.463820  -31.3192819   1.4932521
[107,]  -14.3625818  9.410395  -33.4891560   3.2054766
[108,]    0.5707331 10.834618  -20.8567996  21.4309393
[109,]   17.1454480 12.575234   -7.7138044  41.6395518
[110,]   20.9060629 14.518892   -8.4086990  49.1962644
[111,]   17.7629759 13.252967   -8.1489295  43.9461305
[112,]  -12.1110263 11.332022  -34.3834707  10.3923560
[113,]  -16.3922285  9.671367  -35.2129058   2.3315057
[114,]  -34.1012307  8.426326  -50.4645063 -17.5847476
[115,]  -37.7433329  7.798566  -52.8591396 -22.3387514
[116,]    6.0333649  7.935952   -9.2565953  21.8585227
[117,]   38.7216627  8.802730   21.7060907  56.3899909
[118,]    5.1640605 10.214881  -14.2468216  25.5841711
[119,]   19.7013583 11.981092   -3.1073568  43.3349912
[120,]   -2.7646439 13.967690  -29.6455705  24.8769607
[121,]   -5.1625458 12.158584  -29.2822098  18.8475763
[122,]   36.8446411 10.451389   15.9918275  57.4772351
[123,]   -0.8429720  9.039827  -18.7141734  17.0368734
[124,]    2.3283149  8.080345  -12.8110710  18.5293090
[125,]  -13.9572982  7.742871  -28.5935460   1.5545865
[126,]   11.3249887  8.105472   -3.9978873  27.6605630
[127,]  -13.0859245  9.084706  -30.5347557   5.2227051
[128,]  -41.7609376 10.509598  -61.9635330 -21.0912370
[129,]    5.6614493 12.225301  -18.0456201  29.4107700
[130,]   24.1612362 14.126248   -3.7123409  51.1902095
[131,]  -50.5869114 12.751379  -75.8336703 -26.4443174
[132,]   11.9397282 10.938886   -9.6292280  32.9370449
[133,]   26.6341679  9.412131    8.2033362  44.8923891
[134,]   32.6210076  8.329743   16.3234581  49.1391832
[135,]   20.5155473  7.877085    5.1715008  35.9212444
[136,]   10.6138870  8.159642   -5.8954403  26.3733985
[137,]   -1.7783733  9.109252  -20.3176922  16.5374848
[138,]   -9.7625336 10.547257  -31.0418182  10.9469358
[139,]   -8.5446939 12.303586  -33.2240445  15.1666790
[140,]   -9.6337543 14.261110  -38.0082249  17.6776280
[141,]   17.3806060 12.618520   -7.6326839  41.8703952
[142,]    2.5024199 10.881271  -19.1915893  23.9206255
[143,]  -20.0836663  9.438675  -38.4510161  -1.8638269
[144,]  -11.0610524  8.443141  -27.6255994   5.4226902
[145,]   14.7129614  8.062024   -1.0059713  30.1738995
[146,]    5.7126752  8.379580  -10.6452310  21.7241643
[147,]  -24.7571109  9.324700  -42.9298166  -6.6961802
[148,]   13.8389029 10.732857   -7.2688896  34.8894383
[149,]   -5.3955832 12.447890  -30.3976430  19.2894083
[150,]    9.4459306 14.360265  -19.2416998  37.6437179
[151,]   -0.7700636 13.855219  -26.7644728  26.7700925
[152,]   -6.7632085 11.879795  -29.1162087  16.9991841
[153,]  -17.6385534 10.177105  -36.9962647   2.3931439
[154,]  -31.3189983  8.904992  -48.7355819 -13.7994371
[155,]  -19.5073432  8.264730  -35.8283796  -3.2971906
[156,]   41.8964119  8.402032   25.1669538  58.0389482
[157,]  -36.4018330  9.282457  -54.3559095 -18.5254674
[158,]   14.7829221 10.724521   -5.9772396  35.8950769
[159,]   17.1077772 12.535875   -7.1862370  41.8900226
[160,]    8.9209323 14.579522  -19.3774091  37.8053642
[161,]   17.7146621 12.228383   -6.4695833  42.0000406
[162,]   10.7779539 10.534777  -10.0179801  31.8269355
[163,]    6.7349457  9.129849  -11.1876392  24.9536743
[164,]    1.1264375  8.164017  -14.8617324  17.2524484
[165,]  -10.9916706  7.802091  -26.5526449   4.6024373
[166,]  -15.1492788  8.125176  -30.9833773   1.0575659
[167,]  -49.8945870  9.060285  -67.7548578 -32.1093863
[168,]  -14.0288952 10.444303  -34.4428435   6.3027579
[169,]   22.6220966 12.124463   -1.0281075  46.3588405
[170,]   31.8114885 13.994504    4.6216469  58.9052153
[171,]    5.9050233 12.587513  -18.3098306  30.9602875
[172,]   -1.8326678 10.780419  -22.2778116  19.4013798
[173,]   10.4901412  9.252167   -7.1066109  29.0636180
[174,]   11.7249501  8.160942   -3.8985345  27.8955670
[175,]  -23.5340409  7.694970  -38.3177065  -8.3618748
[176,]    7.1009680  7.964758   -8.3990159  23.1016665
[177,]    0.1751770  8.903673  -17.2835115  17.8883520
[178,]   -2.8867141 10.330857  -23.0047302  17.5488932
[179,]   11.2350949 12.074397  -12.3567854  35.2568976
[180,]   -5.5829962 14.016730  -32.8106564  22.1930435</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.2
p_loo        19.2  3.2
looic      1769.8 28.5
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   567       
 (0.5, 0.7]   (ok)         1    0.6%   169       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.3
p_loo        34.0  8.3
looic      1722.1 44.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   983       
 (0.5, 0.7]   (ok)         4    2.2%   188       
   (0.7, 1]   (bad)        2    1.1%   20        
   (1, Inf)   (very bad)   1    0.6%   18        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.8      11.7  
fit_sleep1 -92.2      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.2
p_loo        19.2  3.2
looic      1769.8 28.5
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   567       
 (0.5, 0.7]   (ok)         1    0.6%   169       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.3
p_loo        34.0  8.3
looic      1722.1 44.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   983       
 (0.5, 0.7]   (ok)         4    2.2%   188       
   (0.7, 1]   (bad)        2    1.1%   20        
   (1, Inf)   (very bad)   1    0.6%   18        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.1     22.3        34.0    8.3   1722.1
fit_sleep2  -23.8      11.7  -884.9     14.2        19.2    3.2   1769.8
fit_sleep1  -92.2      21.0  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   44.6  
fit_sleep2   28.5  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
9.110897e-41 4.393065e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88      1.63     0.12      5.5       0.05      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12      1.63     -3.5     2.99       4.95      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-33         Matrix_1.5-4.1     

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.5      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.1       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.32       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
