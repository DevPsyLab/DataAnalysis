<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.69      6.69    15.68    41.61 1.00     1694     2479
sd(Days)                6.61      1.54     4.19    10.26 1.00     1441     1894
cor(Intercept,Days)     0.08      0.30    -0.50     0.65 1.00      998     1746

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.22      7.13   237.30   265.81 1.00     2060     2206
Days         10.44      1.71     7.00    13.98 1.00     1561     1903

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.94      1.54    23.14    29.12 1.00     3650     3015

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.5088  13.00835 227.0419 277.5448
309 211.4622  13.76864 184.7320 237.8725
310 213.0902  13.35630 185.5341 238.5477
330 274.3310  13.41309 249.9633 302.2426
331 272.8256  13.02982 247.8928 298.5783
332 260.3707  12.45363 235.5398 285.1470
333 267.9177  12.61225 244.0122 293.8744
334 244.3805  12.46723 219.2738 268.7147
335 250.9296  13.18369 225.7056 277.2382
337 285.7200  12.99126 260.6542 311.7280
349 226.6204  12.93402 199.2401 250.5636
350 238.6577  12.79846 213.1491 263.6257
351 255.5389  12.46380 231.9220 280.6881
352 271.9541  12.18807 248.1326 295.8885
369 254.8201  12.01847 230.9006 278.0438
370 226.2655  13.40697 198.7652 251.4575
371 252.4087  12.22862 228.0732 276.6028
372 263.5563  12.20476 239.8163 286.7987

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6676212  2.482446 14.9712457 24.654302
309  1.8007327  2.543336 -3.0267695  6.784960
310  4.9342509  2.490919  0.1026009  9.986233
330  5.7716931  2.552983  0.6376791 10.580549
331  7.5076986  2.471915  2.5398760 12.340147
332 10.2134656  2.369090  5.6004074 14.780201
333 10.2857594  2.387762  5.4194540 14.786234
334 11.4915016  2.380970  6.9376449 16.190785
335 -0.2295026  2.541344 -5.4273133  4.672646
337 19.1855924  2.491479 14.1143693 23.890283
349 11.5543781  2.457548  6.8877491 16.544126
350 17.0035180  2.460591 12.1277430 21.777369
351  7.5171129  2.393830  2.6364838 12.220533
352 14.0505924  2.378411  9.4728778 18.536646
369 11.3165696  2.339636  6.7541665 15.916262
370 15.2205348  2.532146 10.3796045 20.297544
371  9.4632244  2.368685  4.8421041 14.141891
372 11.7542835  2.346439  7.2608386 16.279191</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.5088 13.008352 227.0419 277.5448
  [2,] 273.1764 11.116496 250.4414 294.1638
  [3,] 292.8440  9.500569 273.6013 311.0319
  [4,] 312.5117  8.322873 296.1017 328.7858
  [5,] 332.1793  7.784901 317.0342 347.3029
  [6,] 351.8469  8.016498 336.3669 367.6612
  [7,] 371.5145  8.958173 354.0594 389.1172
  [8,] 391.1821 10.419145 370.9332 411.0720
  [9,] 410.8498 12.214473 386.6639 434.3894
 [10,] 430.5174 14.218060 402.6374 458.1938
 [11,] 211.4622 13.768638 184.7320 237.8725
 [12,] 213.2629 11.838113 190.7187 235.8941
 [13,] 215.0636 10.180549 195.3926 234.3918
 [14,] 216.8644  8.948929 199.2207 234.0390
 [15,] 218.6651  8.334280 202.3779 235.1552
 [16,] 220.4658  8.471967 203.8351 236.7580
 [17,] 222.2666  9.328738 203.9661 241.0039
 [18,] 224.0673 10.733760 203.2310 245.4472
 [19,] 225.8680 12.503558 201.9406 250.3398
 [20,] 227.6688 14.505221 199.9469 256.0404
 [21,] 213.0902 13.356300 185.5341 238.5477
 [22,] 218.0245 11.470021 194.4024 239.7010
 [23,] 222.9587  9.856031 202.8301 241.7348
 [24,] 227.8930  8.667795 210.5012 245.2202
 [25,] 232.8272  8.095019 217.1151 248.4356
 [26,] 237.7615  8.266642 221.8186 253.9067
 [27,] 242.6957  9.140829 224.9777 261.1847
 [28,] 247.6300 10.544263 227.3026 269.1038
 [29,] 252.5642 12.297055 228.5063 277.4105
 [30,] 257.4985 14.271055 229.4592 286.4021
 [31,] 274.3310 13.413091 249.9633 302.2426
 [32,] 280.1027 11.455551 259.3143 303.9661
 [33,] 285.8744  9.776694 267.8282 305.8096
 [34,] 291.6461  8.542440 275.5904 309.1405
 [35,] 297.4178  7.962303 282.1402 313.6310
 [36,] 303.1895  8.176717 287.5213 319.7707
 [37,] 308.9612  9.129874 291.0957 327.2604
 [38,] 314.7329 10.624779 294.0112 335.9947
 [39,] 320.5046 12.468067 296.1236 345.2060
 [40,] 326.2763 14.527730 297.7842 354.7636
 [41,] 272.8256 13.029822 247.8928 298.5783
 [42,] 280.3333 11.177704 258.9794 302.1169
 [43,] 287.8410  9.608673 269.2390 306.5812
 [44,] 295.3487  8.481324 278.7088 311.7857
 [45,] 302.8564  7.984976 287.2269 318.5148
 [46,] 310.3641  8.234533 294.3324 326.5364
 [47,] 317.8718  9.169295 300.2523 336.0720
 [48,] 325.3795 10.609671 304.4249 346.4033
 [49,] 332.8872 12.380428 308.4868 357.5202
 [50,] 340.3949 14.359861 312.2397 369.2853
 [51,] 260.3707 12.453626 235.5398 285.1470
 [52,] 270.5842 10.722483 249.1394 291.7353
 [53,] 280.7977  9.277696 262.3136 298.8894
 [54,] 291.0111  8.270721 274.6111 306.8686
 [55,] 301.2246  7.871415 285.3503 316.2976
 [56,] 311.4381  8.169376 295.2454 327.2605
 [57,] 321.6515  9.096340 303.8555 339.0055
 [58,] 331.8650 10.486814 311.3186 352.1697
 [59,] 342.0785 12.183115 318.6242 365.6312
 [60,] 352.2919 14.075103 324.9874 379.3544
 [61,] 267.9177 12.612250 244.0122 293.8744
 [62,] 278.2034 10.822892 257.6265 300.3130
 [63,] 288.4892  9.306124 270.6095 307.4760
 [64,] 298.7750  8.214361 282.7514 315.4574
 [65,] 309.0607  7.729833 294.0858 324.6688
 [66,] 319.3465  7.964153 304.1022 335.2270
 [67,] 329.6322  8.860471 312.5434 347.3305
 [68,] 339.9180 10.246511 320.2557 360.0798
 [69,] 350.2038 11.953110 326.4359 373.5280
 [70,] 360.4895 13.862377 332.8042 387.8455
 [71,] 244.3805 12.467229 219.2738 268.7147
 [72,] 255.8720 10.741937 234.2995 277.0302
 [73,] 267.3635  9.310460 248.5812 285.6684
 [74,] 278.8550  8.325753 262.0691 295.3969
 [75,] 290.3465  7.955482 274.6034 305.8027
 [76,] 301.8380  8.282468 285.6083 318.0135
 [77,] 313.3295  9.232924 295.1225 331.2701
 [78,] 324.8210 10.641078 303.9358 345.5124
 [79,] 336.3125 12.351366 311.8320 360.1253
 [80,] 347.8040 14.255454 320.1638 375.4330
 [81,] 250.9296 13.183693 225.7056 277.2382
 [82,] 250.7000 11.243543 229.1868 272.7246
 [83,] 250.4705  9.588618 231.5935 269.1887
 [84,] 250.2410  8.389446 233.3827 266.6933
 [85,] 250.0115  7.857536 234.2949 265.2608
 [86,] 249.7820  8.125011 233.5428 265.3257
 [87,] 249.5525  9.121819 231.6553 267.2937
 [88,] 249.3230 10.645009 228.2270 269.7941
 [89,] 249.0935 12.503667 224.3802 273.2923
 [90,] 248.8640 14.569971 219.2226 277.2764
 [91,] 285.7200 12.991256 260.6542 311.7280
 [92,] 304.9056 11.123371 283.5371 327.3440
 [93,] 324.0912  9.544682 305.5273 343.2754
 [94,] 343.2768  8.419469 326.9770 359.8879
 [95,] 362.4624  7.942852 347.2243 377.8757
 [96,] 381.6480  8.228322 365.4551 397.7066
 [97,] 400.8335  9.205249 382.6422 418.6151
 [98,] 420.0191 10.685639 399.2820 440.4864
 [99,] 439.2047 12.491760 413.9608 462.7914
[100,] 458.3903 14.502421 428.6971 485.6261
[101,] 226.6204 12.934023 199.2401 250.5636
[102,] 238.1747 11.087843 214.5800 258.8601
[103,] 249.7291  9.522115 230.0335 267.3967
[104,] 261.2835  8.395246 244.5185 277.1487
[105,] 272.8379  7.897388 257.3305 288.2078
[106,] 284.3923  8.144717 268.9727 300.4859
[107,] 295.9466  9.076518 278.6321 314.2767
[108,] 307.5010 10.512327 287.3696 328.2805
[109,] 319.0554 12.276561 295.5126 343.3774
[110,] 330.6098 14.247736 303.3118 359.0373
[111,] 238.6577 12.798455 213.1491 263.6257
[112,] 255.6612 10.944481 233.8752 276.4895
[113,] 272.6647  9.374000 253.9107 290.6232
[114,] 289.6682  8.250523 273.3087 305.8751
[115,] 306.6717  7.770417 291.3158 321.9090
[116,] 323.6752  8.049637 307.9528 339.3517
[117,] 340.6788  9.017924 322.9454 357.9698
[118,] 357.6823 10.486099 336.8706 377.9058
[119,] 374.6858 12.276099 349.7937 398.0483
[120,] 391.6893 14.267304 363.0562 418.9102
[121,] 255.5389 12.463803 231.9220 280.6881
[122,] 263.0560 10.691955 242.6065 284.2491
[123,] 270.5731  9.205990 252.4938 288.6245
[124,] 278.0902  8.163545 261.9117 293.9198
[125,] 285.6073  7.745806 270.0644 300.4067
[126,] 293.1245  8.050616 276.8735 308.6072
[127,] 300.6416  9.004896 282.7933 317.9898
[128,] 308.1587 10.431909 287.4663 328.5479
[129,] 315.6758 12.166436 291.5731 339.4309
[130,] 323.1929 14.095405 295.3054 350.6401
[131,] 271.9541 12.188073 248.1326 295.8885
[132,] 286.0046 10.453802 265.7741 306.1471
[133,] 300.0552  9.018233 282.4083 317.3315
[134,] 314.1058  8.042931 298.4913 329.6156
[135,] 328.1564  7.704715 312.8792 342.9163
[136,] 342.2070  8.083948 326.1038 358.0205
[137,] 356.2576  9.091286 338.1567 374.4809
[138,] 370.3082 10.548291 349.7239 391.2614
[139,] 384.3588 12.296140 360.4981 408.6415
[140,] 398.4094 14.228049 370.5140 426.2028
[141,] 254.8201 12.018474 230.9006 278.0438
[142,] 266.1367 10.340569 245.3261 285.9713
[143,] 277.4533  8.964309 259.3575 294.8448
[144,] 288.7698  8.045998 272.5347 304.0614
[145,] 300.0864  7.750169 284.7947 314.9628
[146,] 311.4030  8.144934 294.8753 326.9639
[147,] 322.7196  9.141256 304.5062 340.5568
[148,] 334.0361 10.570382 313.2972 354.4950
[149,] 345.3527 12.282148 321.1677 369.1135
[150,] 356.6693 14.174525 328.6566 384.5665
[151,] 226.2655 13.406974 198.7652 251.4575
[152,] 241.4860 11.478928 217.9037 263.4813
[153,] 256.7065  9.828945 236.7156 275.5375
[154,] 271.9271  8.618239 254.5032 288.6490
[155,] 287.1476  8.047575 270.9016 302.7913
[156,] 302.3681  8.250844 286.1558 318.3517
[157,] 317.5887  9.176758 299.8833 335.6173
[158,] 332.8092 10.638275 311.8849 353.6171
[159,] 348.0297 12.448150 323.7406 372.7550
[160,] 363.2503 14.476308 335.2328 392.0695
[161,] 252.4087 12.228618 228.0732 276.6028
[162,] 261.8719 10.497705 241.2084 282.5403
[163,] 271.3352  9.060124 253.4900 288.8113
[164,] 280.7984  8.074108 264.7867 296.3085
[165,] 290.2616  7.714787 275.1209 305.0997
[166,] 299.7248  8.066349 283.4387 315.5418
[167,] 309.1881  9.046290 291.2639 326.6369
[168,] 318.6513 10.479794 297.8121 339.0477
[169,] 328.1145 12.208118 303.9712 351.8895
[170,] 337.5777 14.123439 309.5647 365.2560
[171,] 263.5563 12.204756 239.8163 286.7987
[172,] 275.3106 10.493167 255.0102 295.3342
[173,] 287.0649  9.070203 269.3140 304.7364
[174,] 298.8192  8.089633 282.8071 314.5321
[175,] 310.5735  7.721871 295.6214 325.1057
[176,] 322.3278  8.051334 306.9361 337.9266
[177,] 334.0820  9.001790 316.9053 351.2958
[178,] 345.8363 10.404424 325.7386 366.0955
[179,] 357.5906 12.103032 334.0454 381.0406
[180,] 369.3449 13.990221 342.2647 396.5924</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5        Q97.5
  [1,]   -3.9487986 13.008352  -27.9847931  22.51814176
  [2,]  -14.4717198 11.116496  -35.4590561   8.26333003
  [3,]  -42.0434410  9.500569  -60.2313209 -22.80072772
  [4,]    8.9281378  8.322873   -7.3459982  25.33808380
  [5,]   24.6726166  7.784901    9.5490329  39.81765806
  [6,]   62.8431954  8.016498   47.0289189  78.32316572
  [7,]   10.6892742  8.958173   -6.9133785  28.14440730
  [8,] -101.0335470 10.419145 -120.9233561 -80.78460889
  [9,]   19.7355318 12.214473   -3.8040901  43.92136551
 [10,]   35.8361106 14.218060    8.1596540  63.71614388
 [11,]   11.2717429 13.768638  -15.1385805  38.00192732
 [12,]   -7.9970899 11.838113  -30.6283364  14.54713878
 [13,]  -12.0858226 10.180549  -31.4139983   7.58524656
 [14,]  -12.1573554  8.948929  -29.3319517   5.48630206
 [15,]  -10.9489881  8.334280  -27.4391455   5.33824390
 [16,]   -4.5040208  8.471967  -20.7962138  12.12673403
 [17,]   -8.6362536  9.328738  -27.3736410   9.66423897
 [18,]   -6.3400863 10.733760  -27.7200230  14.49623984
 [19,]   -1.5723191 12.503558  -26.0441253  22.35510492
 [20,]    9.6454482 14.505221  -18.7261736  37.36727753
 [21,]  -14.0363338 13.356300  -39.4937677  13.51976554
 [22,]  -23.6922847 11.470021  -45.3687720  -0.07015848
 [23,]   11.3612644  9.856031   -7.4147562  31.48992437
 [24,]    4.9486135  8.667795  -12.3785855  22.34038698
 [25,]   -3.5198374  8.095019  -19.1281901  12.19225258
 [26,]  -17.3035884  8.266642  -33.4487655  -1.36067133
 [27,]   -7.2749393  9.140829  -25.7638808  10.44312006
 [28,]    8.1211098 10.544263  -13.3527320  28.44854466
 [29,]    8.4482589 12.297055  -16.3980344  32.50619928
 [30,]   -9.9831920 14.271055  -38.8868326  18.05610323
 [31,]   47.2115577 13.413091   19.3000213  71.57926675
 [32,]   20.2974645 11.455551   -3.5658759  41.08588368
 [33,]   -2.0179286  9.776694  -21.9530616  16.02826107
 [34,]   -6.5131218  8.542440  -24.0075376   9.54255303
 [35,]  -11.6205149  7.962303  -27.8337222   3.65714292
 [36,]   -5.6040081  8.176717  -22.1851954  10.06422641
 [37,]  -28.7216012  9.129874  -47.0208382 -10.85614131
 [38,]    3.5284056 10.624779  -17.7333914  24.25007738
 [39,]  -15.1550875 12.468067  -39.8565491   9.22585965
 [40,]   27.7724193 14.527730   -0.7148764  56.26445741
 [41,]   14.7823064 13.029822  -10.9703932  39.71507362
 [42,]    4.6667078 11.177704  -17.1169406  26.02061155
 [43,]   13.9796091  9.608673   -4.7606134  32.58160662
 [44,]   24.7666105  8.481324    8.3296209  41.40651186
 [45,]   13.4209119  7.984976   -2.2375105  29.05042748
 [46,]  -17.0453868  8.234533  -33.2176776  -1.01372955
 [47,]  -27.7967854  9.169295  -45.9969780 -10.17728622
 [48,]    9.4382159 10.609671  -11.5856120  30.39282115
 [49,]  -39.1402827 12.380428  -63.7732966 -14.73993042
 [50,]   31.1862187 14.359861    2.2958211  59.34143028
 [51,]  -25.5101445 12.453626  -50.2863965  -0.67924792
 [52,]  -27.7724101 10.722483  -48.9234611  -6.32758140
 [53,]   -7.8363757  9.277696  -25.9281368  10.64773239
 [54,]   18.7576586  8.270721    2.9002128  35.15774933
 [55,]   16.2382930  7.871415    1.1652997  32.11258456
 [56,]   -1.4404727  8.169376  -17.2629050  14.75221146
 [57,]  132.5103617  9.096340  115.1563628 150.30638059
 [58,]   14.9660961 10.486814   -5.3386263  35.51248987
 [59,]  -11.7781696 12.183115  -35.3309245  11.67607217
 [60,]  -98.4275352 14.075103 -125.4899864 -71.12296140
 [61,]   15.9247241 12.612250  -10.0320354  39.83022952
 [62,]   11.3515647 10.822892  -10.7580158  31.92849154
 [63,]  -11.7198948  9.306124  -30.7067499   6.15982401
 [64,]    1.0347458  8.214361  -15.6476525  17.05825051
 [65,]  -11.8897136  7.729833  -27.4977867   3.08517912
 [66,]   18.8200270  7.964153    2.9395447  34.06427388
 [67,]    2.3942675  8.860471  -15.3039814  19.48312349
 [68,]    8.9219081 10.246511  -11.2399175  28.58415130
 [69,]  -16.8437513 11.953110  -40.1679930   6.92411569
 [70,]    1.5532893 13.862377  -25.8027367  29.23858863
 [71,]   21.0926466 12.467229   -3.2415679  46.19930129
 [72,]   20.3292450 10.741937   -0.8290479  41.90174609
 [73,]  -23.9987566  9.310460  -42.3037478  -5.21645775
 [74,]  -24.1826581  8.325753  -40.7246465  -7.39681007
 [75,]  -11.3220597  7.955482  -26.7783097   4.42097007
 [76,]  -17.6467613  8.282468  -33.8223137  -1.41707930
 [77,]   -7.8046629  9.232924  -25.7452952  10.40230412
 [78,]    6.7019355 10.641078  -13.9894939  27.58712511
 [79,]   -0.5655661 12.351366  -24.3783694  23.91491097
 [80,]   29.4950323 14.255454    1.8659938  57.13522833
 [81,]   -9.3212505 13.183693  -35.6299469  15.90267566
 [82,]   23.2471520 11.243543    1.2226286  44.76040975
 [83,]    4.0201546  9.588618  -14.6980221  22.89719973
 [84,]   20.5610572  8.389446    4.1088179  37.41940448
 [85,]    1.4403598  7.857536  -13.8089370  17.15696531
 [86,]    4.8541624  8.125011  -10.6894997  21.09341577
 [87,]   -4.1002350  9.121819  -21.8414042  13.79696784
 [88,]  -14.0120324 10.645009  -34.4831052   7.08396581
 [89,]  -13.3394298 12.503667  -37.5381871  11.37392312
 [90,]  -11.6174272 14.569971  -40.0298188  18.02400653
 [91,]   26.6466104 12.991256    0.6386227  51.71242530
 [92,]    8.9002180 11.123371  -13.5382063  30.26867085
 [93,]  -32.4799743  9.544682  -51.6642063 -13.91611093
 [94,]    2.8454333  8.419469  -13.7657317  19.14521724
 [95,]    3.2700409  7.942852  -12.1433301  18.50813444
 [96,]   10.1905486  8.228322   -5.8680748  26.38339789
 [97,]    3.4265562  9.205249  -14.3549520  21.61785065
 [98,]   -3.3268362 10.685639  -23.7941279  17.41025454
 [99,]   16.6595714 12.491760   -6.9271128  41.90352706
[100,]    0.5263791 14.502421  -26.7094237  30.21958902
[101,]    9.4828359 12.934023  -14.4603995  36.86307852
[102,]   -7.8580422 11.087843  -28.5433764  15.73670206
[103,]  -10.8035203  9.522115  -28.4711032   8.89214440
[104,]   -6.3614984  8.395246  -22.2267077  10.40352886
[105,]  -22.1275765  7.897388  -37.4975047  -6.62018007
[106,]  -14.6178546  8.144717  -30.7114915   0.80165100
[107,]  -14.3818327  9.076518  -32.7119117   2.93269147
[108,]    0.6009891 10.512327  -20.1784563  20.73243679
[109,]   17.2252110 12.276561   -7.0968060  40.76797968
[110,]   21.0353329 14.247736   -7.3921630  48.33329247
[111,]   17.6391481 12.798455   -7.3288822  43.14769060
[112,]  -12.2068699 10.944481  -33.0352133   9.57910235
[113,]  -16.4600879  9.374000  -34.4186265   2.29386921
[114,]  -34.1411059  8.250523  -50.3479847 -17.78161656
[115,]  -37.7552239  7.770417  -52.9924931 -22.39934233
[116,]    6.0494581  8.049637   -9.6270355  21.77188956
[117,]   38.7657401  9.017924   21.4747135  56.49911121
[118,]    5.2361221 10.486099  -14.9874485  26.04778253
[119,]   19.8014041 12.276099   -3.5610553  44.69354911
[120,]   -2.6366139 14.267304  -29.8575284  25.99650771
[121,]   -5.0123873 12.463803  -30.1615914  18.60452157
[122,]   37.0015998 10.691955   15.8084934  57.45108992
[123,]   -0.6792132  9.205990  -18.7306164  17.40011532
[124,]    2.4988739  8.163545  -13.3307105  18.67742081
[125,]  -13.7799390  7.745806  -28.5792715   1.76296293
[126,]   11.5091481  8.050616   -3.9735918  27.76014381
[127,]  -12.8949649  9.004896  -30.2431958   4.95325255
[128,]  -41.5631778 10.431909  -61.9523803 -20.87079818
[129,]    5.8660093 12.166436  -17.8890937  29.96872566
[130,]   24.3725963 14.095405   -3.0745705  52.26011420
[131,]  -50.2769513 12.188073  -74.2113786 -26.45545158
[132,]   12.1892563 10.453802   -7.9532131  32.41980273
[133,]   26.8232639  9.018233    9.5470067  44.47024738
[134,]   32.7496714  8.042931   17.2399197  48.36424390
[135,]   20.5837790  7.704715    5.8238512  35.86099979
[136,]   10.6216866  8.083948   -5.1917779  26.72493142
[137,]   -1.8310058  9.091286  -20.0542759  16.26990401
[138,]   -9.8755982 10.548291  -30.8288046  10.70868149
[139,]   -8.7181907 12.296140  -33.0008857  15.14248743
[140,]   -9.8676831 14.228049  -37.6610817  18.02773009
[141,]   17.1033637 12.018474   -6.1202878  41.02286089
[142,]    2.3001941 10.340569  -17.5343826  23.11078531
[143,]  -20.2108755  8.964309  -37.6023543  -2.11512363
[144,]  -11.1132450  8.045998  -26.4048297   5.12190116
[145,]   14.7357854  7.750169   -0.1405677  30.02752697
[146,]    5.8105158  8.144934   -9.7503556  22.33815165
[147,]  -24.5842537  9.141256  -42.4214946  -6.37093894
[148,]   14.0867767 10.570382   -6.3720819  34.82571419
[149,]   -5.0726929 12.282148  -28.8334702  19.11225582
[150,]    9.8438376 14.174525  -18.0533842  37.85646810
[151,]   -1.0014673 13.406974  -26.1934516  26.49884001
[152,]   -6.9625021 11.478928  -28.9578066  16.61975657
[153,]  -17.8057369  9.828945  -36.6367231   2.18522316
[154,]  -31.4540716  8.618239  -48.1759694 -14.03015095
[155,]  -19.6103064  8.047575  -35.2540426  -3.36429795
[156,]   41.8255588  8.250844   25.8419716  58.03788596
[157,]  -36.4405760  9.176758  -54.4692398 -18.73518168
[158,]   14.7762893 10.638275   -6.0315740  35.70057683
[159,]   17.1332545 12.448150   -7.5920332  41.42236832
[160,]    8.9785197 14.476308  -19.8406502  36.99602193
[161,]   17.4716753 12.228618   -6.7224019  41.80719316
[162,]   10.5708509 10.497705  -10.0975212  31.23444818
[163,]    6.5637266  9.060124  -10.9123730  24.40885269
[164,]    0.9911022  8.074108  -14.5189657  17.00276532
[165,]  -11.0911221  7.714787  -25.9291743   4.04962657
[166,]  -15.2128465  8.066349  -31.0297532   1.07325679
[167,]  -49.9222708  9.046290  -67.3710672 -31.99814100
[168,]  -14.0206952 10.479794  -34.4170803   6.81854023
[169,]   22.6661805 12.208118   -1.1087553  46.80951666
[170,]   31.8914561 14.123439    4.2131896  59.90447833
[171,]    5.8553640 12.204756  -17.3869856  29.59535444
[172,]   -1.8366195 10.493167  -21.8602053  18.46378763
[173,]   10.5318970  9.070203   -7.1396031  28.28275430
[174,]   11.8124134  8.089633   -3.9004756  27.82447543
[175,]  -23.4008701  7.721871  -37.9331424  -8.44876631
[176,]    7.2798464  8.051334   -8.3190094  22.67152832
[177,]    0.3997628  9.001790  -16.8139685  17.57649218
[178,]   -2.6164207 10.404424  -22.8756400  17.48125189
[179,]   11.5510958 12.103032  -11.8988508  35.09626442
[180,]   -5.2212878 13.990221  -32.4687568  21.85885976</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.3
p_loo        19.6  3.3
looic      1770.5 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     176   97.8%   1272      
 (0.5, 0.7]   (ok)         4    2.2%   164       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.4 22.2
p_loo        33.2  8.2
looic      1720.8 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   841       
 (0.5, 0.7]   (ok)         3    1.7%   1145      
   (0.7, 1]   (bad)        3    1.7%   17        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.8      11.5  
fit_sleep1 -92.9      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.3
p_loo        19.6  3.3
looic      1770.5 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     176   97.8%   1272      
 (0.5, 0.7]   (ok)         4    2.2%   164       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.4 22.2
p_loo        33.2  8.2
looic      1720.8 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   841       
 (0.5, 0.7]   (ok)         3    1.7%   1145      
   (0.7, 1]   (bad)        3    1.7%   17        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.4     22.2        33.2    8.2   1720.8
fit_sleep2  -24.8      11.5  -885.2     14.3        19.6    3.3   1770.5
fit_sleep1  -92.9      20.8  -953.3     10.5         3.2    0.5   1906.7
           se_looic
fit_sleep3   44.3  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
4.403904e-41 1.622566e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0      2.9      1.59     0.24     5.54       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0     -0.1      1.59    -3.29     3.02       5.28      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
