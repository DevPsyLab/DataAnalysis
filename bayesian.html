<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.69      6.86    15.34    41.98 1.00     1575     2061
sd(Days)                6.47      1.48     4.12     9.68 1.00     1478     1839
cor(Intercept,Days)     0.10      0.29    -0.44     0.68 1.01     1038     1797

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.08      7.45   236.04   265.64 1.00     1918     2190
Days         10.41      1.72     6.94    13.93 1.00     1509     1781

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.97      1.58    23.14    29.30 1.00     3157     2442

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.2228  12.88439 228.2049 278.6498
309 211.5116  13.45238 184.6279 237.1967
310 212.9330  13.39096 185.9525 238.4130
330 274.0682  13.33388 248.0605 300.5618
331 272.7405  12.72557 248.7255 299.1468
332 260.0188  12.17273 236.5787 284.5778
333 267.5508  12.39828 243.8085 291.9855
334 244.3352  12.54135 219.4987 268.3652
335 250.1185  13.44821 223.9484 276.1949
337 286.1686  13.10412 259.8445 311.5849
349 226.9703  13.15216 200.9605 251.8144
350 239.2528  13.23075 212.2266 264.1030
351 255.5436  12.65375 231.2791 280.5961
352 271.9722  12.43939 247.6141 296.7859
369 254.8179  12.00758 231.0042 277.9694
370 226.8337  13.20383 200.0780 251.7620
371 252.1298  12.17643 228.7793 276.7485
372 263.5762  12.36587 239.3478 287.8600

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5836607  2.498195 14.9235783 24.342062
309  1.7646795  2.524444 -3.0885699  6.796285
310  4.9591570  2.448232  0.1838484  9.859771
330  5.8185260  2.522446  0.9324034 10.721795
331  7.5534354  2.487763  2.4575061 12.232146
332 10.2768392  2.389352  5.5307388 14.989960
333 10.3498546  2.344753  5.6758257 14.806167
334 11.5096774  2.368234  7.0267603 16.247066
335 -0.1212956  2.613589 -5.2803329  5.011866
337 19.1344965  2.485732 14.3124594 23.984827
349 11.4853096  2.510924  6.7763398 16.502901
350 16.9091488  2.504755 12.2625612 21.995944
351  7.4738358  2.436035  2.5408292 12.199119
352 14.0361456  2.323092  9.4862256 18.584941
369 11.3315276  2.310918  6.7497625 15.867202
370 15.1464681  2.521491 10.2084391 20.179981
371  9.5241250  2.321033  4.9117033 13.991777
372 11.7644491  2.325386  7.1477804 16.327102</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.2228 12.884388 228.2049 278.6498
  [2,] 273.8065 11.015892 251.4272 294.9172
  [3,] 293.3901  9.443211 274.3071 311.9772
  [4,] 312.9738  8.335500 296.1218 329.1800
  [5,] 332.5575  7.891061 317.2819 348.1607
  [6,] 352.1411  8.218217 335.5803 368.7225
  [7,] 371.7248  9.235328 353.0330 390.1142
  [8,] 391.3084 10.748275 369.5248 412.3177
  [9,] 410.8921 12.579409 385.1885 435.8418
 [10,] 430.4758 14.609572 400.6748 458.9644
 [11,] 211.5116 13.452383 184.6279 237.1967
 [12,] 213.2763 11.519515 190.3030 235.0252
 [13,] 215.0410  9.857865 195.0754 234.0924
 [14,] 216.8057  8.625624 199.5560 234.0704
 [15,] 218.5703  8.023149 202.7721 234.7348
 [16,] 220.3350  8.190609 204.6007 236.8810
 [17,] 222.0997  9.085531 204.6644 239.6944
 [18,] 223.8644 10.523940 203.6626 244.3229
 [19,] 225.6291 12.316874 201.7609 249.9055
 [20,] 227.3937 14.331890 199.8271 255.4170
 [21,] 212.9330 13.390957 185.9525 238.4130
 [22,] 217.8922 11.560996 194.6094 239.5518
 [23,] 222.8513  9.999161 203.1078 241.9256
 [24,] 227.8105  8.848586 210.4671 245.1424
 [25,] 232.7696  8.282476 216.5875 248.8688
 [26,] 237.7288  8.419562 221.1553 254.2519
 [27,] 242.6879  9.228561 224.4765 260.8621
 [28,] 247.6471 10.556103 226.2186 268.1810
 [29,] 252.6063 12.234540 227.6981 276.3590
 [30,] 257.5654 14.139460 228.9594 285.0902
 [31,] 274.0682 13.333878 248.0605 300.5618
 [32,] 279.8867 11.420578 257.7694 302.4326
 [33,] 285.7053  9.787357 266.9205 305.3489
 [34,] 291.5238  8.595382 274.6984 308.9058
 [35,] 297.3423  8.043276 281.5075 313.3606
 [36,] 303.1608  8.260355 287.2205 319.5663
 [37,] 308.9794  9.192285 291.2111 327.2255
 [38,] 314.7979 10.653084 294.0267 336.1978
 [39,] 320.6164 12.458081 296.4267 345.7180
 [40,] 326.4349 14.479116 298.4820 355.1710
 [41,] 272.7405 12.725567 248.7255 299.1468
 [42,] 280.2939 10.871497 259.8985 302.8039
 [43,] 287.8473  9.317550 270.1992 306.8935
 [44,] 295.4008  8.235410 279.6487 312.1769
 [45,] 302.9542  7.823372 287.7808 318.4610
 [46,] 310.5076  8.183290 294.5111 326.2551
 [47,] 318.0611  9.225250 300.2408 335.9484
 [48,] 325.6145 10.752776 304.9476 346.2864
 [49,] 333.1679 12.590356 308.6009 357.4068
 [50,] 340.7214 14.621554 312.3671 368.7093
 [51,] 260.0188 12.172731 236.5787 284.5778
 [52,] 270.2956 10.464235 250.2601 291.1870
 [53,] 280.5725  9.068796 262.8548 298.6291
 [54,] 290.8493  8.148859 275.0074 306.7216
 [55,] 301.1261  7.872913 285.7999 316.5097
 [56,] 311.4030  8.305397 295.0230 327.4790
 [57,] 321.6798  9.348503 303.2502 339.6609
 [58,] 331.9567 10.827160 310.2592 352.8769
 [59,] 342.2335 12.588816 316.8560 366.7582
 [60,] 352.5103 14.530905 323.2068 380.8530
 [61,] 267.5508 12.398283 243.8085 291.9855
 [62,] 277.9006 10.676556 257.5922 299.1310
 [63,] 288.2505  9.233418 270.3509 306.7762
 [64,] 298.6004  8.216989 282.2528 315.1559
 [65,] 308.9502  7.795996 293.2899 324.7522
 [66,] 319.3001  8.064237 303.4239 335.4683
 [67,] 329.6499  8.960024 312.2916 347.2992
 [68,] 339.9998 10.321235 319.9295 360.1821
 [69,] 350.3496 11.990391 327.3401 374.0315
 [70,] 360.6995 13.856652 333.8555 387.9852
 [71,] 244.3352 12.541353 219.4987 268.3652
 [72,] 255.8448 10.790397 234.3848 276.5287
 [73,] 267.3545  9.316485 249.3679 285.2601
 [74,] 278.8642  8.269108 262.5913 294.5890
 [75,] 290.3739  7.821540 274.9278 305.2517
 [76,] 301.8835  8.074149 286.3898 317.2969
 [77,] 313.3932  8.967961 295.9423 330.6993
 [78,] 324.9029 10.337981 304.2943 345.0266
 [79,] 336.4126 12.022496 312.7855 359.8858
 [80,] 347.9222 13.907698 320.3797 375.4210
 [81,] 250.1185 13.448210 223.9484 276.1949
 [82,] 249.9972 11.454697 227.3770 272.0988
 [83,] 249.8759  9.758458 230.4514 269.0988
 [84,] 249.7546  8.538538 233.0163 266.5952
 [85,] 249.6333  8.015451 233.5970 265.1547
 [86,] 249.5120  8.321657 233.1321 265.5581
 [87,] 249.3907  9.376257 230.8568 267.7749
 [88,] 249.2694 10.965406 227.9209 270.9718
 [89,] 249.1481 12.892934 224.6966 274.7268
 [90,] 249.0268 15.029207 220.5360 278.9701
 [91,] 286.1686 13.104119 259.8445 311.5849
 [92,] 305.3031 11.239623 282.5309 326.9572
 [93,] 324.4376  9.659091 305.2435 343.3678
 [94,] 343.5721  8.522011 326.9725 360.4629
 [95,] 362.7066  8.019291 346.9929 378.6130
 [96,] 381.8411  8.267473 365.5347 398.1522
 [97,] 400.9756  9.206026 383.2385 419.2334
 [98,] 420.1101 10.654034 399.7420 441.0969
 [99,] 439.2446 12.434777 414.6376 463.3962
[100,] 458.3791 14.425555 429.6380 486.3090
[101,] 226.9703 13.152164 200.9605 251.8144
[102,] 238.4556 11.253125 216.0682 259.8096
[103,] 249.9409  9.638242 230.7527 268.2208
[104,] 261.4262  8.471603 244.9274 277.8720
[105,] 272.9115  7.952981 257.4143 288.7202
[106,] 284.3968  8.206170 268.5895 300.3839
[107,] 295.8822  9.167443 277.8757 313.2955
[108,] 307.3675 10.646703 286.3171 328.0383
[109,] 318.8528 12.460820 294.5017 342.9258
[110,] 330.3381 14.484519 302.1863 358.4951
[111,] 239.2528 13.230749 212.2266 264.1030
[112,] 256.1619 11.316486 233.2867 277.4617
[113,] 273.0711  9.675773 253.5553 291.5710
[114,] 289.9802  8.469115 272.9660 306.3999
[115,] 306.8894  7.898026 291.5006 322.4614
[116,] 323.7985  8.098106 307.8140 339.8712
[117,] 340.7077  9.018172 323.0395 358.4646
[118,] 357.6168 10.470106 336.6744 378.1522
[119,] 374.5260 12.266475 350.0526 398.6522
[120,] 391.4351 14.277860 362.9517 419.2283
[121,] 255.5436 12.653750 231.2791 280.5961
[122,] 263.0175 10.877790 241.8945 284.5344
[123,] 270.4913  9.402328 252.2140 289.1198
[124,] 277.9651  8.387476 261.2455 294.5888
[125,] 285.4390  8.010260 269.7136 301.5099
[126,] 292.9128  8.357471 276.1733 309.5363
[127,] 300.3866  9.348737 281.7652 319.1723
[128,] 307.8605 10.808283 286.8493 329.6333
[129,] 315.3343 12.574085 290.5954 340.5110
[130,] 322.8081 14.534950 294.3516 351.9858
[131,] 271.9722 12.439388 247.6141 296.7859
[132,] 286.0083 10.721589 265.0645 307.4701
[133,] 300.0445  9.271466 281.6584 318.3232
[134,] 314.0806  8.231719 298.0491 330.6934
[135,] 328.1168  7.768901 313.0390 343.2593
[136,] 342.1529  7.983981 326.2924 357.1511
[137,] 356.1891  8.827548 338.3715 372.8884
[138,] 370.2252 10.144001 349.5067 389.7459
[139,] 384.2614 11.775798 360.4901 407.3485
[140,] 398.2975 13.609981 371.1461 424.6974
[141,] 254.8179 12.007583 231.0042 277.9694
[142,] 266.1494 10.349749 245.9013 286.3504
[143,] 277.4810  8.985168 259.9392 295.3050
[144,] 288.8125  8.064110 273.4752 304.8397
[145,] 300.1440  7.746430 284.7127 315.7713
[146,] 311.4755  8.103405 295.2250 327.2947
[147,] 322.8071  9.055598 304.5793 340.5207
[148,] 334.1386 10.441418 313.2034 354.4880
[149,] 345.4701 12.112938 321.4434 368.9952
[150,] 356.8016 13.967963 329.3876 384.0150
[151,] 226.8337 13.203834 200.0780 251.7620
[152,] 241.9801 11.266161 219.4035 263.2429
[153,] 257.1266  9.603509 238.1630 275.5928
[154,] 272.2731  8.381182 255.4747 288.1348
[155,] 287.4195  7.808768 271.8828 302.6867
[156,] 302.5660  8.026540 286.6244 317.9326
[157,] 317.7125  8.977174 299.8581 334.9548
[158,] 332.8589 10.462781 312.2644 353.3306
[159,] 348.0054 12.290881 323.4266 372.0917
[160,] 363.1519 14.331000 334.6291 391.3455
[161,] 252.1298 12.176432 228.7793 276.7485
[162,] 261.6540 10.485019 241.3970 282.9409
[163,] 271.1781  9.076350 252.8937 289.1074
[164,] 280.7022  8.099324 264.2793 296.1615
[165,] 290.2263  7.719608 274.6583 305.1072
[166,] 299.7505  8.022471 283.6338 315.1985
[167,] 309.2746  8.938799 291.2784 326.6837
[168,] 318.7987 10.306241 298.2309 338.4884
[169,] 328.3228 11.971193 304.6679 351.3519
[170,] 337.8470 13.826595 310.2827 364.5451
[171,] 263.5762 12.365868 239.3478 287.8600
[172,] 275.3407 10.661180 254.5644 295.9157
[173,] 287.1051  9.231559 268.9209 305.3186
[174,] 298.8696  8.221766 282.7856 315.0177
[175,] 310.6340  7.796669 295.1067 325.9012
[176,] 322.3985  8.049441 306.8474 337.9633
[177,] 334.1629  8.922656 316.9143 351.2742
[178,] 345.9274 10.259089 325.9671 365.3082
[179,] 357.6918 11.903734 334.4231 380.2934
[180,] 369.4563 13.746407 342.9159 395.4823</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.6628189 12.884388  -29.0897759  21.3551068
  [2,]  -15.1017796 11.015892  -36.2124596   7.2774521
  [3,]  -42.5895403  9.443211  -61.1766458 -23.5065073
  [4,]    8.4659990  8.335500   -7.7401588  25.3180363
  [5,]   24.2944383  7.891061    8.6912044  39.5700158
  [6,]   62.5489776  8.218217   45.9676225  79.1097937
  [7,]   10.4790170  9.235328   -7.9104062  29.1708289
  [8,] -101.1598437 10.748275 -122.1690972 -79.3761818
  [9,]   19.6931956 12.579409   -5.2564585  45.3967582
 [10,]   35.8777349 14.609572    7.3891124  65.6787096
 [11,]   11.2222835 13.452383  -14.4628263  38.1060106
 [12,]   -8.0104960 11.519515  -29.7594491  14.9628053
 [13,]  -12.0631755  9.857865  -31.1146113   7.9023655
 [14,]  -12.0986550  8.625624  -29.3634019   5.1509627
 [15,]  -10.8542345  8.023149  -27.0187312   4.9440259
 [16,]   -4.3732140  8.190609  -20.9192330  11.3611168
 [17,]   -8.4693935  9.085531  -26.0641136   8.9659100
 [18,]   -6.1371730 10.523940  -26.5956757  14.0646231
 [19,]   -1.3333525 12.316874  -25.6097648  22.5347987
 [20,]    9.9204680 14.331890  -18.1027956  37.4870681
 [21,]  -13.8790989 13.390957  -39.3590525  13.1014087
 [22,]  -23.5599559 11.560996  -45.2196428  -0.2772221
 [23,]   11.4686871  9.999161   -7.6056309  31.2121727
 [24,]    5.0311300  8.848586  -12.3007960  22.3744775
 [25,]   -3.4622270  8.282476  -19.5613797  12.7199017
 [26,]  -17.2708840  8.419562  -33.7939788  -0.6973716
 [27,]   -7.2671410  9.228561  -25.4413071  10.9443453
 [28,]    8.1040019 10.556103  -12.4299305  29.5325385
 [29,]    8.4062449 12.234540  -15.3464993  33.3144131
 [30,]  -10.0501121 14.139460  -37.5749086  18.5558918
 [31,]   47.4744013 13.333878   20.9808188  73.4821284
 [32,]   20.5134753 11.420578   -2.0324329  42.6307640
 [33,]   -1.8487506  9.787357  -21.4923509  16.9359714
 [34,]   -6.3907766  8.595382  -23.7728086  10.4346500
 [35,]  -11.5450026  8.043276  -27.5633448   4.2898382
 [36,]   -5.5753286  8.260355  -21.9807846  10.3649795
 [37,]  -28.7397546  9.192285  -46.9858531 -10.9714973
 [38,]    3.4634194 10.653084  -17.9364624  24.2346216
 [39,]  -15.2669066 12.458081  -40.3684687   8.9227905
 [40,]   27.6137674 14.479116   -1.1223177  55.5667346
 [41,]   14.8674455 12.725567  -11.5388620  38.8824063
 [42,]    4.7061101 10.871497  -17.8039104  25.1014643
 [43,]   13.9732747  9.317550   -5.0729374  31.6213956
 [44,]   24.7145393  8.235410    7.9383623  40.4666210
 [45,]   13.3231039  7.823372   -2.1836919  28.4965390
 [46,]  -17.1889315  8.183290  -32.9364092  -1.1924207
 [47,]  -27.9860669  9.225250  -45.8734260 -10.1658446
 [48,]    9.2031978 10.752776  -11.4687343  29.8700715
 [49,]  -39.4210376 12.590356  -63.6599371 -14.8539933
 [50,]   30.8597270 14.621554    2.8718115  59.2140279
 [51,]  -25.1581857 12.172731  -49.7171945  -1.7181154
 [52,]  -27.4838248 10.464235  -48.3751872  -7.4483117
 [53,]   -7.6111640  9.068796  -25.6678062  10.1064948
 [54,]   18.9194969  8.148859    3.0471991  34.7614027
 [55,]   16.3367577  7.872913    0.9532331  31.6630373
 [56,]   -1.4053814  8.305397  -17.4813883  14.9745573
 [57,]  132.4820794  9.348503  114.5009849 150.9117283
 [58,]   14.8744403 10.827160   -6.0458490  36.5719336
 [59,]  -11.9331989 12.588816  -36.4579371  13.4443033
 [60,]  -98.6459381 14.530905 -126.9886455 -69.3423862
 [61,]   16.2916050 12.398283   -8.1431299  40.0339413
 [62,]   11.6543505 10.676556   -9.5759670  31.9627592
 [63,]  -11.4812041  9.233418  -30.0068596   6.4183711
 [64,]    1.2093413  8.216989  -15.3462314  17.5569066
 [65,]  -11.7792133  7.795996  -27.5812316   3.8810620
 [66,]   18.8664322  8.064237    2.6981668  34.7425525
 [67,]    2.3765776  8.960024  -15.2726611  19.7348896
 [68,]    8.8401230 10.321235  -11.3421760  28.9104334
 [69,]  -16.9896315 11.990391  -40.6715220   6.0199129
 [70,]    1.3433139 13.856652  -25.9423691  28.1872734
 [71,]   21.1379488 12.541353   -2.8921163  45.9744188
 [72,]   20.3563714 10.790397   -0.3274932  41.8163681
 [73,]  -23.9898059  9.316485  -41.8954057  -6.0031689
 [74,]  -24.1918833  8.269108  -39.9166967  -7.9189844
 [75,]  -11.3494606  7.821540  -26.2272968   4.0966064
 [76,]  -17.6923380  8.074149  -33.1057298  -2.1985665
 [77,]   -7.8684153  8.967961  -25.1745130   9.5824798
 [78,]    6.6200073 10.337981  -13.5036602  27.2285562
 [79,]   -0.6656700 12.022496  -24.1389315  22.9614425
 [80,]   29.3767526 13.907698    1.8780306  56.9192501
 [81,]   -8.5102100 13.448210  -34.5866277  17.6598558
 [82,]   23.9499857 11.454697    1.8484371  46.5702210
 [83,]    4.6147813  9.758458  -14.6081329  24.0393238
 [84,]   21.0474770  8.538538    4.2069434  37.7857723
 [85,]    1.8185726  8.015451  -13.7028394  17.8548554
 [86,]    5.1241682  8.321657  -10.9219269  21.5040742
 [87,]   -3.9384361  9.376257  -22.3225545  14.5954970
 [88,]  -13.9584405 10.965406  -35.6608199   7.3900520
 [89,]  -13.3940448 12.892934  -38.9726896  11.0575285
 [90,]  -11.7802492 15.029207  -41.7234594  16.7106291
 [91,]   26.1979891 13.104119    0.7816892  52.5220787
 [92,]    8.5026926 11.239623  -13.1514319  31.2748669
 [93,]  -32.8264038  9.659091  -51.7566048 -13.6323208
 [94,]    2.5500997  8.522011  -14.3407090  19.1496834
 [95,]    3.0258032  8.019291  -12.8805666  18.7394650
 [96,]    9.9974068  8.267473   -6.3137013  26.3037823
 [97,]    3.2845103  9.206026  -14.9732811  21.0215731
 [98,]   -3.4177862 10.654034  -24.4046080  16.9503149
 [99,]   16.6197174 12.434777   -7.5318554  41.2267050
[100,]    0.5376209 14.425555  -27.3923195  29.2786613
[101,]    9.1329054 13.152164  -15.7112423  35.1427412
[102,]   -8.1389041 11.253125  -29.4928786  14.2485272
[103,]  -11.0153137  9.638242  -29.2951805   8.1729345
[104,]   -6.5042233  8.471603  -22.9499785   9.9945847
[105,]  -22.2012329  7.952981  -38.0098618  -6.7039764
[106,]  -14.6224425  8.206170  -30.6095406   1.1848904
[107,]  -14.3173520  9.167443  -31.7307034   3.6890540
[108,]    0.7345384 10.646703  -19.9362737  21.7849099
[109,]   17.4278288 12.460820   -6.6451758  41.7789033
[110,]   21.3070192 14.484519   -6.8499808  49.4587543
[111,]   17.0440268 13.230749   -7.8062411  44.0702484
[112,]  -12.7076220 11.316486  -34.0074238  10.1675503
[113,]  -16.8664708  9.675773  -35.3663999   2.6492874
[114,]  -34.4531196  8.469115  -50.8728272 -17.4389470
[115,]  -37.9728684  7.898026  -53.5448967 -22.5841282
[116,]    5.9261828  8.098106  -10.1464993  21.9107164
[117,]   38.7368340  9.018172   20.9799267  56.4050302
[118,]    5.3015852 10.470106  -15.2337523  26.2440334
[119,]   19.9612364 12.266475   -4.1649860  44.4346346
[120,]   -2.3824124 14.277860  -30.1756108  26.1010115
[121,]   -5.0171186 12.653750  -30.0695627  19.2474492
[122,]   37.0401456 10.877790   15.5232398  58.1631343
[123,]   -0.5973903  9.402328  -19.2259450  17.6798616
[124,]    2.6239739  8.387476  -13.9997395  19.3436055
[125,]  -13.6115619  8.010260  -29.6825050   2.1138200
[126,]   11.7208023  8.357471   -4.9026692  28.4602907
[127,]  -12.6400335  9.348737  -31.4257333   5.9814065
[128,]  -41.2649693 10.808283  -63.0377568 -20.2538320
[129,]    6.2074949 12.574085  -18.9691807  30.9464305
[130,]   24.7573591 14.534950   -4.4202619  53.2138943
[131,]  -50.2950963 12.439388  -75.1088479 -25.9370178
[132,]   12.1855581 10.721589   -9.2762423  33.1293948
[133,]   26.8340125  9.271466    8.5552614  45.2201125
[134,]   32.7748670  8.231719   16.1621369  48.8063892
[135,]   20.6234214  7.768901    5.4808742  35.7011949
[136,]   10.6757758  7.983981   -4.3224174  26.5362627
[137,]   -1.7624698  8.827548  -18.4617788  16.0551074
[138,]   -9.7926153 10.144001  -29.3133482  10.9259382
[139,]   -8.6207609 11.775798  -31.7079103  15.1504589
[140,]   -9.7558065 13.609981  -36.1556983  17.3956407
[141,]   17.1055991 12.007583   -6.0458580  40.9192655
[142,]    2.2874714 10.349749  -17.9134681  22.5355850
[143,]  -20.2385562  8.985168  -38.0625615  -2.6967971
[144,]  -11.1558839  8.064110  -27.1831017   4.1813916
[145,]   14.6781885  7.746430   -0.9490853  30.1094913
[146,]    5.7379609  8.103405  -10.0811544  21.9885027
[147,]  -24.6717668  9.055598  -42.3854085  -6.4439505
[148,]   13.9843056 10.441418   -6.3650759  34.9195347
[149,]   -5.1901221 12.112938  -28.7152280  18.8366279
[150,]    9.7114503 13.967963  -17.5019270  37.1255000
[151,]   -1.5696528 13.203834  -26.4979839  25.1860100
[152,]   -7.4566209 11.266161  -28.7193793  15.1199597
[153,]  -18.2257890  9.603509  -36.6920398   0.7378129
[154,]  -31.8000571  8.381182  -47.6618487 -15.0016809
[155,]  -19.8822253  7.808768  -35.1494214  -4.3455223
[156,]   41.6277066  8.026540   26.2610699  57.5692821
[157,]  -36.5643615  8.977174  -53.8066671 -18.7100099
[158,]   14.7265704 10.462781   -5.7450844  35.3210596
[159,]   17.1576023 12.290881   -6.9286927  41.7364298
[160,]    9.0769341 14.331000  -19.1167254  37.5996735
[161,]   17.7505536 12.176432   -6.8681259  41.1010937
[162,]   10.7888287 10.485019  -10.4980858  31.0458201
[163,]    6.7208037  9.076350  -11.2085005  25.0052461
[164,]    1.0872787  8.099324  -14.3720130  17.5102405
[165,]  -11.0558463  7.719608  -25.9366764   4.5122488
[166,]  -15.2384713  8.022471  -30.6865181   0.8781902
[167,]  -50.0087963  8.938799  -67.4179451 -32.0126391
[168,]  -14.1681212 10.306241  -33.8578390   6.3996735
[169,]   22.4578538 11.971193   -0.5711944  46.1127949
[170,]   31.6222288 13.826595    4.9240555  59.1864632
[171,]    5.8354674 12.365868  -18.4482551  30.0638571
[172,]   -1.8666817 10.661180  -22.4416828  18.9096452
[173,]   10.4916692  9.231559   -7.7217546  28.6759052
[174,]   11.7620201  8.221766   -4.3861159  27.8460498
[175,]  -23.4614290  7.796669  -38.7286179  -7.9340632
[176,]    7.2091219  8.049441   -8.3557300  22.7602462
[177,]    0.3188728  8.922656  -16.7924465  17.5675488
[178,]   -2.7074763 10.259089  -22.0883357  17.2527631
[179,]   11.4498746 11.903734  -11.1516616  34.7185860
[180,]   -5.3326745 13.746407  -31.3587340  21.2076548</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1769.9 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1440      
 (0.5, 0.7]   (ok)         1    0.6%   328       
   (0.7, 1]   (bad)        1    0.6%   139       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.8 22.6
p_loo        34.8  8.9
looic      1723.6 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   755       
 (0.5, 0.7]   (ok)         6    3.3%   312       
   (0.7, 1]   (bad)        1    0.6%   52        
   (1, Inf)   (very bad)   2    1.1%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.1      11.7  
fit_sleep1 -91.5      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1769.9 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1440      
 (0.5, 0.7]   (ok)         1    0.6%   328       
   (0.7, 1]   (bad)        1    0.6%   139       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.8 22.6
p_loo        34.8  8.9
looic      1723.6 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   755       
 (0.5, 0.7]   (ok)         6    3.3%   312       
   (0.7, 1]   (bad)        1    0.6%   52        
   (1, Inf)   (very bad)   2    1.1%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.8     22.6        34.8    8.9   1723.6
fit_sleep2  -23.1      11.7  -885.0     14.4        19.5    3.4   1769.9
fit_sleep1  -91.5      21.2  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   45.1  
fit_sleep2   28.8  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.887054e-40 8.872007e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.85      1.61     0.15      5.4       0.05      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.15      1.61    -3.49     2.95       5.33      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.3.5         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.0       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
