<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.06      6.89    15.96    42.62 1.00     1719     2392
sd(Days)                6.54      1.51     4.08    10.05 1.00     1510     1849
cor(Intercept,Days)     0.08      0.29    -0.47     0.65 1.00     1076     1661

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.05      7.56   236.29   266.05 1.00     1695     2201
Days         10.48      1.72     7.04    13.98 1.00     1338     1938

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.89      1.56    23.03    29.11 1.00     2907     2578

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9940  13.09952 227.7271 279.1817
309 211.3357  13.49503 185.2667 237.9157
310 212.8919  13.21905 186.4946 238.7084
330 274.5823  13.19873 249.7894 301.1541
331 273.0081  13.00634 248.0487 298.9543
332 260.3070  12.24744 236.6350 284.5099
333 267.7514  12.65886 243.1299 293.9948
334 244.2053  12.47524 218.5239 268.3555
335 250.8487  13.18533 226.0172 276.9962
337 285.8830  13.09237 259.9506 311.7497
349 226.3640  12.92749 200.3825 250.9440
350 238.9071  12.93244 212.9743 263.2981
351 255.7877  12.31430 232.0975 280.1934
352 272.1522  12.52479 247.9007 296.1227
369 254.5646  12.32949 230.5875 278.3515
370 225.9133  13.42929 199.2421 251.4355
371 252.2157  12.15763 229.3889 276.6456
372 263.4012  12.37440 239.2944 287.9231

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.5872615  2.510737 14.63682074 24.568105
309  1.8042431  2.523826 -3.14517258  6.825187
310  4.9366814  2.471342  0.08713808  9.800601
330  5.7841040  2.523733  0.80825828 10.631012
331  7.4866313  2.459868  2.49353877 12.074422
332 10.2491111  2.352777  5.60875076 14.918705
333 10.3189016  2.418096  5.47631684 15.013698
334 11.5532770  2.379803  6.99458580 16.252047
335 -0.2277266  2.553342 -5.41186808  4.670865
337 19.1389683  2.499889 14.29317554 24.198108
349 11.5710352  2.471427  6.81667856 16.574248
350 16.9984550  2.477062 12.30836106 21.968011
351  7.4661902  2.342761  2.69872587 11.934010
352 14.0342869  2.413302  9.34047362 18.773717
369 11.3146211  2.354374  6.77842847 16.029047
370 15.2327730  2.506502 10.50981326 20.336867
371  9.4723586  2.302831  4.96351200 13.915502
372 11.7784119  2.356909  7.21910341 16.527353</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9940 13.099524 227.7271 279.1817
  [2,] 273.5812 11.195972 251.0672 294.8227
  [3,] 293.1685  9.576517 274.0650 311.4672
  [4,] 312.7558  8.406971 296.1260 328.9566
  [5,] 332.3430  7.890009 316.8171 347.5577
  [6,] 351.9303  8.150763 335.9270 368.0772
  [7,] 371.5176  9.122786 353.7740 389.1193
  [8,] 391.1048 10.612404 370.3378 411.5743
  [9,] 410.6921 12.434976 386.1701 434.8709
 [10,] 430.2793 14.465190 401.7249 458.5596
 [11,] 211.3357 13.495033 185.2667 237.9157
 [12,] 213.1399 11.573295 191.0403 235.8221
 [13,] 214.9442  9.925009 196.0429 234.3086
 [14,] 216.7484  8.706884 200.1139 233.7088
 [15,] 218.5527  8.115002 202.2729 234.1922
 [16,] 220.3569  8.284690 203.8711 236.1650
 [17,] 222.1611  9.173784 203.9454 240.1734
 [18,] 223.9654 10.602827 203.1308 244.4591
 [19,] 225.7696 12.386322 201.4058 249.9434
 [20,] 227.5739 14.393103 199.4567 255.8008
 [21,] 212.8919 13.219053 186.4946 238.7084
 [22,] 217.8286 11.349697 195.5388 240.2403
 [23,] 222.7653  9.752075 203.8324 242.0008
 [24,] 227.7020  8.579357 210.7910 244.3926
 [25,] 232.6386  8.020152 217.1067 248.0466
 [26,] 237.5753  8.200937 221.5502 254.0058
 [27,] 242.5120  9.077608 224.8392 260.4474
 [28,] 247.4487 10.476909 226.8453 267.8946
 [29,] 252.3854 12.220612 228.0835 275.7083
 [30,] 257.3221 14.182247 229.5308 284.4579
 [31,] 274.5823 13.198727 249.7894 301.1541
 [32,] 280.3664 11.288078 258.9744 303.0570
 [33,] 286.1506  9.662997 267.5308 305.1409
 [34,] 291.9347  8.489096 275.6784 308.5923
 [35,] 297.7188  7.968340 282.2439 313.6970
 [36,] 303.5029  8.225728 287.7436 319.9967
 [37,] 309.2870  9.196152 291.3794 327.8878
 [38,] 315.0711 10.687107 294.4725 336.6595
 [39,] 320.8552 12.513904 296.2727 345.8934
 [40,] 326.6393 14.550593 297.7169 356.1380
 [41,] 273.0081 13.006342 248.0487 298.9543
 [42,] 280.4948 11.181533 258.6136 302.8868
 [43,] 287.9814  9.643148 268.9812 307.5956
 [44,] 295.4680  8.547271 278.4025 312.0764
 [45,] 302.9547  8.076093 286.9557 318.7118
 [46,] 310.4413  8.336223 294.0469 326.6846
 [47,] 317.9279  9.266274 299.5822 335.9957
 [48,] 325.4146 10.692846 304.1985 346.1193
 [49,] 332.9012 12.446365 308.1383 357.0801
 [50,] 340.3878 14.407946 312.2577 368.1338
 [51,] 260.3070 12.247436 236.6350 284.5099
 [52,] 270.5562 10.502166 249.9022 291.3342
 [53,] 280.8053  9.036726 262.9878 298.8623
 [54,] 291.0544  8.006276 274.9765 306.7860
 [55,] 301.3035  7.590100 286.5904 316.3751
 [56,] 311.5526  7.886058 296.4907 327.0867
 [57,] 321.8017  8.822773 304.8323 339.0376
 [58,] 332.0508 10.225646 312.2043 352.1387
 [59,] 342.2999 11.931366 319.2518 366.2675
 [60,] 352.5490 13.828314 325.6858 379.9819
 [61,] 267.7514 12.658858 243.1299 293.9948
 [62,] 278.0703 10.858332 256.9199 300.1645
 [63,] 288.3892  9.341008 270.1914 307.0209
 [64,] 298.7081  8.264373 282.3685 314.9748
 [65,] 309.0270  7.812789 293.2328 324.0917
 [66,] 319.3459  8.091593 302.8731 334.7156
 [67,] 329.6648  9.033407 311.0807 346.9607
 [68,] 339.9837 10.460660 318.6278 360.1774
 [69,] 350.3026 12.204210 325.8080 374.0952
 [70,] 360.6215 14.147595 332.4497 388.4446
 [71,] 244.2053 12.475239 218.5239 268.3555
 [72,] 255.7586 10.704567 233.5993 276.5127
 [73,] 267.3119  9.212537 248.5289 285.1652
 [74,] 278.8652  8.153578 262.5125 294.7745
 [75,] 290.4184  7.708292 275.1560 305.3614
 [76,] 301.9717  7.980076 286.3074 317.4401
 [77,] 313.5250  8.903504 295.9997 330.9768
 [78,] 325.0783 10.304857 305.0468 345.3933
 [79,] 336.6315 12.018099 312.9249 360.3933
 [80,] 348.1848 13.928612 320.5457 375.8441
 [81,] 250.8487 13.185328 226.0172 276.9962
 [82,] 250.6209 11.245970 229.0042 272.5617
 [83,] 250.3932  9.598433 231.8714 268.9915
 [84,] 250.1655  8.415884 233.2705 266.8077
 [85,] 249.9377  7.909702 234.4773 265.2446
 [86,] 249.7100  8.206022 234.1176 265.2614
 [87,] 249.4823  9.227855 232.0222 267.2866
 [88,] 249.2546 10.770651 228.7292 270.2983
 [89,] 249.0268 12.645143 224.7549 273.9132
 [90,] 248.7991 14.725199 220.1137 277.8100
 [91,] 285.8830 13.092374 259.9506 311.7497
 [92,] 305.0220 11.218689 282.7157 327.0188
 [93,] 324.1609  9.633619 305.4402 342.6970
 [94,] 343.2999  8.500184 326.8162 359.8536
 [95,] 362.4389  8.012399 346.9254 377.6035
 [96,] 381.5778  8.285096 365.3159 397.4708
 [97,] 400.7168  9.251270 382.9371 418.7664
 [98,] 419.8558 10.725114 399.2307 440.9941
 [99,] 438.9947 12.528728 415.1204 463.6269
[100,] 458.1337 14.539907 430.4457 486.8184
[101,] 226.3640 12.927488 200.3825 250.9440
[102,] 237.9351 11.082179 215.8665 259.1116
[103,] 249.5061  9.524986 230.7969 267.8915
[104,] 261.0771  8.417359 244.6534 277.2808
[105,] 272.6482  7.949491 256.9711 287.7800
[106,] 284.2192  8.231209 267.8176 300.3189
[107,] 295.7902  9.193862 277.0496 313.7224
[108,] 307.3613 10.654449 285.7674 328.1191
[109,] 318.9323 12.438786 294.5295 343.1202
[110,] 330.5033 14.427245 302.4165 358.4470
[111,] 238.9071 12.932439 212.9743 263.2981
[112,] 255.9056 11.054747 233.6582 277.1052
[113,] 272.9040  9.457195 254.0987 291.6621
[114,] 289.9025  8.303092 273.6248 306.3987
[115,] 306.9009  7.792035 291.6818 322.2386
[116,] 323.8994  8.047481 308.3627 340.2448
[117,] 340.8978  9.004430 323.5748 358.6539
[118,] 357.8963 10.472309 337.7288 378.3388
[119,] 374.8947 12.269083 350.9886 398.9152
[120,] 391.8932 14.271063 364.2649 419.5550
[121,] 255.7877 12.314303 232.0975 280.1934
[122,] 263.2538 10.610242 242.7631 284.3105
[123,] 270.7200  9.191815 252.8825 288.9522
[124,] 278.1862  8.208457 262.1722 294.4043
[125,] 285.6524  7.825926 270.2839 301.1069
[126,] 293.1186  8.129485 277.3654 309.1586
[127,] 300.5848  9.050360 283.0604 318.6784
[128,] 308.0510 10.426243 287.8153 328.7699
[129,] 315.5172 12.102940 291.6335 339.5408
[130,] 322.9834 13.972573 295.3887 350.5085
[131,] 272.1522 12.524790 247.9007 296.1227
[132,] 286.1865 10.765443 264.7669 306.8441
[133,] 300.2208  9.304151 281.5148 318.2096
[134,] 314.2551  8.299863 297.7945 330.6131
[135,] 328.2894  7.928196 312.4846 343.8646
[136,] 342.3236  8.274836 325.9569 358.6256
[137,] 356.3579  9.259459 338.0079 374.4794
[138,] 370.3922 10.707488 349.2801 391.4563
[139,] 384.4265 12.458374 360.4834 408.7979
[140,] 398.4608 14.402080 370.6274 427.0834
[141,] 254.5646 12.329486 230.5875 278.3515
[142,] 265.8792 10.615280 245.3211 286.5326
[143,] 277.1938  9.189029 259.3676 295.2762
[144,] 288.5085  8.202348 272.4451 304.5857
[145,] 299.8231  7.823357 284.4167 314.9685
[146,] 311.1377  8.137411 295.4257 326.8363
[147,] 322.4523  9.072826 304.8662 340.0396
[148,] 333.7669 10.464274 313.4920 354.5834
[149,] 345.0816 12.156153 321.7570 369.4730
[150,] 356.3962 14.040272 329.2679 384.1322
[151,] 225.9133 13.429291 199.2421 251.4355
[152,] 241.1461 11.513795 218.4081 262.9652
[153,] 256.3788  9.866822 236.5335 275.2470
[154,] 271.6116  8.643264 254.2436 288.4650
[155,] 286.8444  8.038839 270.8028 302.6423
[156,] 302.0771  8.191762 285.7401 318.0144
[157,] 317.3099  9.063779 299.7434 334.8288
[158,] 332.5427 10.476847 312.4676 353.3884
[159,] 347.7755 12.245066 324.2080 372.3921
[160,] 363.0082 14.236716 335.6642 391.3666
[161,] 252.2157 12.157634 229.3889 276.6456
[162,] 261.6881 10.490545 241.7399 282.6550
[163,] 271.1604  9.105001 253.7535 289.6131
[164,] 280.6328  8.145957 264.9440 297.3782
[165,] 290.1052  7.772918 275.0006 305.5128
[166,] 299.5775  8.067587 284.1595 315.4966
[167,] 309.0499  8.964358 291.7516 326.7306
[168,] 318.5222 10.307257 299.0109 339.2797
[169,] 327.9946 11.946775 305.2117 351.7222
[170,] 337.4670 13.777423 310.8057 364.5995
[171,] 263.4012 12.374396 239.2944 287.9231
[172,] 275.1796 10.667868 254.5791 296.4266
[173,] 286.9580  9.251551 269.0403 305.5091
[174,] 298.7364  8.275810 282.9489 315.0326
[175,] 310.5148  7.905498 295.7673 326.4006
[176,] 322.2933  8.222823 306.5633 338.9194
[177,] 334.0717  9.156570 316.4599 352.2137
[178,] 345.8501 10.544229 325.5504 366.9071
[179,] 357.6285 12.232286 334.0946 382.3795
[180,] 369.4069 14.113359 342.2986 398.2416</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.4339833 13.099524  -29.6217005  21.8328958
  [2,]  -14.8765447 11.195972  -36.1180237   7.6374576
  [3,]  -42.3679062  9.576517  -60.6666483 -23.2643623
  [4,]    8.6840324  8.406971   -7.5167642  25.3137796
  [5,]   24.5088709  7.890009    9.2942028  40.0347788
  [6,]   62.7598094  8.150763   46.6129200  78.7630741
  [7,]   10.6862480  9.122786   -6.9155315  28.4297739
  [8,] -100.9562135 10.612404 -121.4256645 -80.1892400
  [9,]   19.8932251 12.434976   -4.2855716  44.4151847
 [10,]   36.0741636 14.465190    7.7938965  64.6286038
 [11,]   11.3982090 13.495033  -15.1817681  37.4672129
 [12,]   -7.8741341 11.573295  -30.5562866  14.2255414
 [13,]  -11.9663771  9.925009  -31.3308131   6.9349419
 [14,]  -12.0414202  8.706884  -29.0018321   4.5930596
 [15,]  -10.8365633  8.115002  -26.4761487   5.4432021
 [16,]   -4.3951064  8.284690  -20.2031788  12.0906971
 [17,]   -8.5308495  9.173784  -26.5431180   9.6849040
 [18,]   -6.2381926 10.602827  -26.7318831  14.5964401
 [19,]   -1.4739357 12.386322  -25.6477093  22.8898530
 [20,]    9.7403212 14.393103  -18.4866139  37.8574633
 [21,]  -13.8380205 13.219053  -39.6545055  12.5592743
 [22,]  -23.4964020 11.349697  -45.9081473  -1.2065963
 [23,]   11.5547166  9.752075   -7.6808410  30.4875671
 [24,]    5.1396352  8.579357  -11.5510354  22.0505886
 [25,]   -3.3312463  8.020152  -18.7391890  12.2006633
 [26,]  -17.1174277  8.200937  -33.5478782  -1.0922905
 [27,]   -7.0912091  9.077608  -25.0265501  10.5816234
 [28,]    8.3024095 10.476909  -12.1434850  28.9058479
 [29,]    8.6271280 12.220612  -14.6957709  32.9289910
 [30,]   -9.8067534 14.182247  -36.9425854  17.9845113
 [31,]   46.9602571 13.198727   20.3884706  71.7531841
 [32,]   20.0337531 11.288078   -2.6568371  41.4257759
 [33,]   -2.2940509  9.662997  -21.2844092  16.3256836
 [34,]   -6.8016548  8.489096  -23.4592904   9.4546437
 [35,]  -11.9214588  7.968340  -27.8997140   3.5533578
 [36,]   -5.9173628  8.225728  -22.4111633   9.8419088
 [37,]  -29.0473668  9.196152  -47.6481853 -11.1397714
 [38,]    3.1902292 10.687107  -18.3981796  23.7888231
 [39,]  -15.5056747 12.513904  -40.5438886   9.0767513
 [40,]   27.4094213 14.550593   -2.0893410  56.3317846
 [41,]   14.5997621 13.006342  -11.3464281  39.5592432
 [42,]    4.5052308 11.181533  -17.8868390  26.3864411
 [43,]   13.8391995  9.643148   -5.7750090  32.8394417
 [44,]   24.6472682  8.547271    8.0389392  41.7128047
 [45,]   13.3226370  8.076093   -2.4345348  29.3216321
 [46,]  -17.1225943  8.336223  -33.3658620  -0.7282109
 [47,]  -27.8529256  9.266274  -45.9207187  -9.5071573
 [48,]    9.4031431 10.692846  -11.3016065  30.6192400
 [49,]  -39.1542882 12.446365  -63.3332271 -14.3914367
 [50,]   31.1932805 14.407946    3.4473161  59.3234021
 [51,]  -25.4464464 12.247436  -49.6492692  -1.7743854
 [52,]  -27.7443575 10.502166  -48.5223576  -7.0904035
 [53,]   -7.8439687  9.036726  -25.9010131   9.9735455
 [54,]   18.7144202  8.006276    2.9828226  34.7922723
 [55,]   16.1594090  7.590100    1.0877978  30.8724932
 [56,]   -1.5550021  7.886058  -17.0891238  13.5068506
 [57,]  132.3601868  8.822773  115.1243362 149.3296163
 [58,]   14.7802756 10.225646   -5.3075799  34.6268043
 [59,]  -11.9996355 11.931366  -35.9671864  11.0484806
 [60,]  -98.6846466 13.828314 -126.1175316 -71.8214334
 [61,]   16.0909707 12.658858  -10.1523762  40.7124981
 [62,]   11.4846692 10.858332  -10.6095019  32.6351208
 [63,]  -11.6199324  9.341008  -30.2515703   6.5779367
 [64,]    1.1015661  8.264373  -15.1650686  17.4411988
 [65,]  -11.8560355  7.812789  -26.9206971   3.9381846
 [66,]   18.8205630  8.091593    3.4509286  35.2934207
 [67,]    2.3616614  9.033407  -14.9342217  20.9458274
 [68,]    8.8561599 10.460660  -11.3374779  30.2121288
 [69,]  -16.9426417 12.204210  -40.7352272   7.5519714
 [70,]    1.4212567 14.147595  -26.4018393  29.5930670
 [71,]   21.2677732 12.475239   -2.8824475  46.9492034
 [72,]   20.4425962 10.704567   -0.3115187  42.6019228
 [73,]  -23.9471808  9.212537  -41.8005132  -5.1641541
 [74,]  -24.1928578  8.153578  -40.1021542  -7.8402180
 [75,]  -11.3940348  7.708292  -26.3370480   3.8684477
 [76,]  -17.7805118  7.980076  -33.2488926  -2.1162433
 [77,]   -8.0001888  8.903504  -25.4519692   9.5250785
 [78,]    6.4446342 10.304857  -13.8703886  26.4761035
 [79,]   -0.8846428 12.018099  -24.6463729  22.8219616
 [80,]   29.1141802 13.928612    1.4548785  56.7532973
 [81,]   -9.2403542 13.185328  -35.3878553  15.5910858
 [82,]   23.3262724 11.245970    1.3854697  44.9430409
 [83,]    4.0974991  9.598433  -14.5007541  22.6192695
 [84,]   20.6366257  8.415884    3.9944010  37.5316064
 [85,]    1.5141523  7.909702  -13.7927249  16.9746073
 [86,]    4.9261790  8.206022  -10.6252430  20.5186218
 [87,]   -4.0299944  9.227855  -21.8343330  13.4300880
 [88,]  -13.9435677 10.770651  -34.9872803   6.5818472
 [89,]  -13.2727411 12.645143  -38.1591081  10.9992403
 [90,]  -11.5525145 14.725199  -40.5633586  17.1329088
 [91,]   26.4836135 13.092374    0.6168533  52.4160387
 [92,]    8.7838452 11.218689  -13.2129780  31.0901191
 [93,]  -32.5497230  9.633619  -51.0857549 -13.8289626
 [94,]    2.8223087  8.500184  -13.7314066  19.3060437
 [95,]    3.2935404  8.012399  -11.8711181  18.8069723
 [96,]   10.2606722  8.285096   -5.6322975  26.5226117
 [97,]    3.5433039  9.251270  -14.5063495  21.3230476
 [98,]   -3.1634644 10.725114  -24.3018012  17.4615500
 [99,]   16.8695673 12.528728   -7.7626178  40.7438945
[100,]    0.7829991 14.539907  -27.9017318  28.4709791
[101,]    9.7391744 12.927488  -14.8407521  35.7206525
[102,]   -7.6183608 11.082179  -28.7948677  14.4501760
[103,]  -10.5804960  9.524986  -28.9658659   8.1287209
[104,]   -6.1551312  8.417359  -22.3587618  10.2685728
[105,]  -21.9378664  7.949491  -37.0696532  -6.2608055
[106,]  -14.4448016  8.231209  -30.5444663   1.9568144
[107,]  -14.2254369  9.193862  -32.1575741   4.5152450
[108,]    0.7407279 10.654449  -20.0170988  22.3345928
[109,]   17.3482927 12.438786   -6.8396064  41.7511211
[110,]   21.1417575 14.427245   -6.8019139  49.2286320
[111,]   17.3897048 12.932439   -7.0013140  43.3224912
[112,]  -12.4512502 11.054747  -33.6509293   9.7960507
[113,]  -16.6994051  9.457195  -35.4575490   2.1058899
[114,]  -34.3753601  8.303092  -50.8716074 -18.0977345
[115,]  -37.9844151  7.792035  -53.3220609 -22.7653156
[116,]    5.8253299  8.047481  -10.5201338  21.3619864
[117,]   38.5466750  9.004430   20.7906450  55.8697209
[118,]    5.0221200 10.472309  -15.4204490  25.1895680
[119,]   19.5924650 12.269083   -4.4279848  43.4986225
[120,]   -2.8404900 14.271063  -30.5023282  24.7877885
[121,]   -5.2611570 12.314303  -29.6668803  18.4290166
[122,]   36.8037528 10.610242   15.7471136  57.2944727
[123,]   -0.8261375  9.191815  -19.0582653  17.0113710
[124,]    2.4028723  8.208457  -13.8151502  18.4169348
[125,]  -13.8250180  7.825926  -29.2794524   1.5435253
[126,]   11.5149918  8.129485   -4.5250286  27.2682411
[127,]  -12.8381984  9.050360  -30.9317839   4.6862201
[128,]  -41.4554887 10.426243  -62.1743747 -21.2198040
[129,]    6.0246211 12.102940  -17.9990315  29.9082793
[130,]   24.5821309 13.972573   -2.9429595  52.1768220
[131,]  -50.4751107 12.524790  -74.4455688 -26.2235921
[132,]   12.0074025 10.765443   -8.6501872  33.4270372
[133,]   26.6577156  9.304151    8.6688678  45.3636804
[134,]   32.6004288  8.299863   16.2423821  49.0609593
[135,]   20.4508419  7.928196    4.8756228  36.2556492
[136,]   10.5050551  8.274836   -5.7969359  26.8717977
[137,]   -1.9313318  9.259459  -20.0528117  16.4186692
[138,]   -9.9596187 10.707488  -31.0236777  11.1525375
[139,]   -8.7859055 12.458374  -33.1573345  15.1571828
[140,]   -9.9190924 14.402080  -38.5416993  17.9143306
[141,]   17.3589114 12.329486   -6.4279779  41.3359717
[142,]    2.5576903 10.615280  -18.0957243  23.1158205
[143,]  -19.9514309  9.189029  -38.0337502  -2.1251833
[144,]  -10.8518520  8.202348  -26.9290655   5.2114528
[145,]   14.9991269  7.823357   -0.1462865  30.4054752
[146,]    6.0758057  8.137411   -9.6228266  21.7878385
[147,]  -24.3170154  9.072826  -41.9043465  -6.7308625
[148,]   14.3559634 10.464274   -6.4605211  34.6309325
[149,]   -4.8015577 12.156153  -29.1929785  18.5230422
[150,]   10.1169211 14.040272  -17.6190748  37.2452023
[151,]   -0.6492833 13.429291  -26.1714529  26.0218701
[152,]   -6.6225563 11.513795  -28.4416988  16.1153576
[153,]  -17.4780294  9.866822  -36.3461674   2.3672830
[154,]  -31.1386024  8.643264  -47.9919875 -13.7705748
[155,]  -19.3070754  8.038839  -35.1050133  -3.2654822
[156,]   42.1165515  8.191762   26.1792782  58.4536282
[157,]  -36.1618215  9.063779  -53.6806643 -18.5952848
[158,]   15.0428054 10.476847   -5.8028643  35.1178603
[159,]   17.3875324 12.245066   -7.2291141  40.9550423
[160,]    9.2205593 14.236716  -19.1378022  36.5646389
[161,]   17.6646723 12.157634   -6.7651874  40.4914659
[162,]   10.7547137 10.490545  -10.2122435  30.7029499
[163,]    6.7384550  9.105001  -11.7142402  24.1453563
[164,]    1.1566964  8.145957  -15.5887001  16.8455272
[165,]  -10.9346623  7.772918  -26.3423235   4.1698570
[166,]  -15.0655209  8.067587  -30.9846478   0.3524918
[167,]  -49.7840796  8.964358  -67.4648215 -32.4857742
[168,]  -13.8916382 10.307257  -34.6490833   5.6196913
[169,]   22.7861031 11.946775   -0.9414535  45.5690416
[170,]   32.0022445 13.777423    4.8696555  58.6635286
[171,]    6.0105000 12.374396  -18.5113692  30.1172533
[172,]   -1.7056119 10.667868  -22.9525985  18.8949444
[173,]   10.6387762  9.251551   -7.9122692  28.5565207
[174,]   11.8951643  8.275810   -4.4010490  27.6826908
[175,]  -23.3422477  7.905498  -39.2280337  -8.5947101
[176,]    7.3143404  8.222823   -9.3117639  23.0442916
[177,]    0.4101285  9.156570  -17.7319003  18.0219430
[178,]   -2.6301834 10.544229  -23.6872248  17.6695455
[179,]   11.5132047 12.232286  -13.2378378  35.0470961
[180,]   -5.2833072 14.113359  -34.1179738  21.8249951</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.5
p_loo        19.6  3.5
looic      1770.2 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   621       
 (0.5, 0.7]   (ok)         1    0.6%   105       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.2
p_loo        33.8  8.3
looic      1721.7 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1054      
 (0.5, 0.7]   (ok)         6    3.3%   284       
   (0.7, 1]   (bad)        3    1.7%   18        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.5  
fit_sleep1 -92.4      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.5
p_loo        19.6  3.5
looic      1770.2 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   621       
 (0.5, 0.7]   (ok)         1    0.6%   105       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.2
p_loo        33.8  8.3
looic      1721.7 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1054      
 (0.5, 0.7]   (ok)         6    3.3%   284       
   (0.7, 1]   (bad)        3    1.7%   18        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.8     22.2        33.8    8.3   1721.7
fit_sleep2  -24.3      11.5  -885.1     14.5        19.6    3.5   1770.2
fit_sleep1  -92.4      20.9  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.5  
fit_sleep2   28.9  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
7.157149e-41 2.938609e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88      1.62     0.16     5.48       0.05      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12      1.62    -3.53     3.01       4.87      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_5.0.0           compiler_4.2.2      
 [22] cli_3.6.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.19      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.1   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.12       yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.19        V8_4.2.2            
 [88] RcppParallel_5.1.6   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.8         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
