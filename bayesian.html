<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.92      6.91    15.64    42.58 1.00     1822     2430
sd(Days)                6.54      1.50     4.18     9.98 1.00     1624     2241
cor(Intercept,Days)     0.10      0.30    -0.47     0.68 1.00     1097     1755

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.34      7.21   237.03   265.95 1.00     1918     2298
Days         10.39      1.70     6.99    13.80 1.00     1374     1912

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.88      1.57    23.16    29.25 1.00     3218     2831

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0242  12.89884 228.7304 279.3449
309 211.3740  13.04827 185.2511 236.4483
310 212.9233  13.30647 187.0958 238.0352
330 275.0649  13.49155 250.0318 301.9824
331 273.3177  13.08247 248.4134 299.1503
332 260.6502  12.33244 236.4250 285.8044
333 268.0618  12.45791 244.1510 293.5437
334 244.2417  12.31376 219.9818 268.1674
335 250.5026  13.41972 224.9977 278.3496
337 286.0721  13.14079 260.6002 312.6552
349 226.7216  12.91613 200.8893 250.9852
350 238.9073  12.97060 213.0799 263.7048
351 255.4917  12.27363 232.2224 279.2596
352 271.9246  12.43235 248.3494 296.7489
369 254.7851  12.10993 231.1004 278.2619
370 226.4945  13.40479 199.4244 252.8298
371 252.1867  12.50905 226.8777 276.5532
372 263.7363  12.36673 240.0774 287.9656

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5914506  2.478641 14.7510075 24.558457
309  1.7909608  2.475374 -2.9669846  6.689137
310  4.9484936  2.487637  0.1313588  9.863138
330  5.6487954  2.564473  0.6058526 10.612855
331  7.4418629  2.495385  2.5153004 12.288263
332 10.1764116  2.378421  5.2766388 14.599981
333 10.2773962  2.362912  5.5604585 14.884270
334 11.5290428  2.353996  6.8306424 16.162381
335 -0.1915788  2.537804 -5.4099313  4.516903
337 19.1387659  2.492336 14.2685084 24.034090
349 11.5141539  2.419810  6.7334886 16.328062
350 16.9507480  2.514308 11.9700744 22.096111
351  7.5197190  2.340508  2.9021138 12.021844
352 14.0153412  2.369491  9.2512323 18.607395
369 11.3329898  2.322204  6.8952551 15.822474
370 15.1968212  2.564478 10.1972242 20.291429
371  9.4781127  2.379177  4.8285514 14.218489
372 11.7128322  2.382636  6.9955632 16.151833</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0242 12.898837 228.7304 279.3449
  [2,] 273.6156 11.026009 251.9798 295.4428
  [3,] 293.2071  9.436794 275.0231 311.6921
  [4,] 312.7985  8.295818 297.1322 329.1372
  [5,] 332.3900  7.802270 317.1878 347.7277
  [6,] 351.9814  8.075740 336.2937 367.6180
  [7,] 371.5729  9.046936 353.9858 389.1188
  [8,] 391.1643 10.524440 370.5350 411.7741
  [9,] 410.7558 12.327528 386.7597 435.0072
 [10,] 430.3472 14.333855 402.3617 459.0113
 [11,] 211.3740 13.048272 185.2511 236.4483
 [12,] 213.1650 11.188423 190.9338 234.8229
 [13,] 214.9559  9.610367 195.7113 233.6496
 [14,] 216.7469  8.473044 199.7235 233.3233
 [15,] 218.5378  7.967479 202.6007 234.2717
 [16,] 220.3288  8.211208 204.2792 235.9287
 [17,] 222.1198  9.144512 204.6017 239.8695
 [18,] 223.9107 10.586559 203.9005 244.4613
 [19,] 225.7017 12.360554 202.0225 250.1066
 [20,] 227.4926 14.343860 200.0764 256.6369
 [21,] 212.9233 13.306467 187.0958 238.0352
 [22,] 217.8718 11.406408 195.7105 239.5052
 [23,] 222.8203  9.773787 203.5811 241.2895
 [24,] 227.7688  8.562964 210.6279 244.2803
 [25,] 232.7173  7.968593 216.7698 248.1641
 [26,] 237.6658  8.127070 221.7392 253.6308
 [27,] 242.6143  8.998708 224.4225 259.9766
 [28,] 247.5628 10.405811 226.6361 268.2412
 [29,] 252.5112 12.163952 228.1938 276.5724
 [30,] 257.4597 14.142816 229.9541 285.2976
 [31,] 275.0649 13.491553 250.0318 301.9824
 [32,] 280.7136 11.520296 259.2587 303.6161
 [33,] 286.3624  9.826774 267.9841 305.9020
 [34,] 292.0112  8.577108 276.0579 309.0485
 [35,] 297.6600  7.982552 282.2231 313.6402
 [36,] 303.3088  8.187096 287.5629 319.6112
 [37,] 308.9576  9.137231 291.4372 326.7840
 [38,] 314.6064 10.634965 294.0896 335.8115
 [39,] 320.2552 12.484751 296.3550 345.3917
 [40,] 325.9040 14.552958 297.8067 354.9290
 [41,] 273.3177 13.082472 248.4134 299.1503
 [42,] 280.7596 11.222434 258.8251 302.7806
 [43,] 288.2014  9.653437 269.2581 307.1510
 [44,] 295.6433  8.537479 278.3424 311.8175
 [45,] 303.0852  8.064872 286.9429 318.3950
 [46,] 310.5270  8.345636 293.8708 326.5554
 [47,] 317.9689  9.311875 299.2819 336.6527
 [48,] 325.4108 10.780830 304.2896 346.8826
 [49,] 332.8526 12.577577 308.4203 357.7991
 [50,] 340.2945 14.581443 312.1769 369.6259
 [51,] 260.6502 12.332443 236.4250 285.8044
 [52,] 270.8266 10.558374 250.1488 291.9401
 [53,] 281.0030  9.065492 263.5381 298.8746
 [54,] 291.1794  8.012539 275.8724 307.2782
 [55,] 301.3559  7.584998 286.7935 316.6211
 [56,] 311.5323  7.885263 295.9695 327.3419
 [57,] 321.7087  8.839476 304.5397 339.1417
 [58,] 331.8851 10.266891 311.8661 352.1712
 [59,] 342.0615 11.999814 318.5554 365.6911
 [60,] 352.2379 13.924647 324.7202 379.6410
 [61,] 268.0618 12.457909 244.1510 293.5437
 [62,] 278.3392 10.681163 257.8427 300.0977
 [63,] 288.6166  9.172877 270.9726 307.1796
 [64,] 298.8940  8.084728 283.1703 314.9128
 [65,] 309.1714  7.599387 294.4369 323.8933
 [66,] 319.4488  7.829767 304.1844 334.6326
 [67,] 329.7262  8.719319 312.6880 346.2844
 [68,] 340.0036 10.095271 320.4569 359.6070
 [69,] 350.2810 11.788520 327.3470 373.4003
 [70,] 360.5584 13.681762 334.1340 387.4610
 [71,] 244.2417 12.313756 219.9818 268.1674
 [72,] 255.7708 10.590162 235.1591 276.5131
 [73,] 267.2998  9.151889 249.3635 285.3240
 [74,] 278.8289  8.151393 263.2503 294.8644
 [75,] 290.3579  7.759892 275.4433 305.3646
 [76,] 301.8870  8.066551 286.4542 317.7284
 [77,] 313.4160  9.000286 295.7869 331.1909
 [78,] 324.9450 10.393443 304.3690 345.2672
 [79,] 336.4741 12.088207 312.4781 360.1670
 [80,] 348.0031 13.975279 319.7835 375.1216
 [81,] 250.5026 13.419716 224.9977 278.3496
 [82,] 250.3110 11.479547 228.6268 274.3489
 [83,] 250.1194  9.815912 231.1332 270.1428
 [84,] 249.9279  8.590993 233.2602 266.9704
 [85,] 249.7363  8.008687 234.2172 265.5904
 [86,] 249.5447  8.206942 233.8127 265.8389
 [87,] 249.3531  9.135076 231.5636 267.6201
 [88,] 249.1615 10.603123 228.5184 270.5389
 [89,] 248.9700 12.421101 224.7939 274.0100
 [90,] 248.7784 14.457599 220.6294 277.4002
 [91,] 286.0721 13.140789 260.6002 312.6552
 [92,] 305.2109 11.259698 283.0308 328.3335
 [93,] 324.3497  9.659438 305.1673 343.9392
 [94,] 343.4884  8.500128 326.7199 360.4991
 [95,] 362.6272  7.976407 346.6645 378.3506
 [96,] 381.7660  8.210813 365.5047 397.9392
 [97,] 400.9047  9.145234 382.7566 418.7381
 [98,] 420.0435 10.596067 399.2818 440.9732
 [99,] 439.1823 12.383111 415.0661 463.3901
[100,] 458.3210 14.381576 430.2658 487.0379
[101,] 226.7216 12.916129 200.8893 250.9852
[102,] 238.2357 11.082747 216.2581 258.8238
[103,] 249.7499  9.515204 231.0838 267.7268
[104,] 261.2640  8.364324 244.7082 277.2191
[105,] 272.7782  7.816373 257.3276 287.8483
[106,] 284.2923  7.996276 268.4927 299.5681
[107,] 295.8065  8.859804 278.0209 312.9765
[108,] 307.3206 10.235370 287.0227 327.6108
[109,] 318.8348 11.947402 295.3482 342.4527
[110,] 330.3490 13.871878 303.0337 357.6267
[111,] 238.9073 12.970596 213.0799 263.7048
[112,] 255.8580 11.068793 234.1805 277.0181
[113,] 272.8087  9.457456 254.2290 290.5361
[114,] 289.7595  8.307362 273.9159 305.6185
[115,] 306.7102  7.824611 291.5819 321.7585
[116,] 323.6610  8.128979 308.0030 339.2950
[117,] 340.6117  9.142185 323.0424 358.4760
[118,] 357.5625 10.664065 337.3336 378.2389
[119,] 374.5132 12.510336 350.9803 398.9342
[120,] 391.4640 14.558097 363.7179 419.7379
[121,] 255.4917 12.273633 232.2224 279.2596
[122,] 263.0114 10.575411 242.8342 283.4045
[123,] 270.5311  9.164743 252.8443 288.6072
[124,] 278.0508  8.191561 262.2564 294.4138
[125,] 285.5705  7.820919 270.4736 301.1570
[126,] 293.0903  8.135591 277.1469 309.4625
[127,] 300.6100  9.064483 282.7423 318.3786
[128,] 308.1297 10.444990 287.5441 328.6452
[129,] 315.6494 12.123808 291.2409 339.4845
[130,] 323.1691 13.993984 295.3919 350.6849
[131,] 271.9246 12.432347 248.3494 296.7489
[132,] 285.9399 10.709553 265.7097 307.5073
[133,] 299.9552  9.276572 282.2906 318.3624
[134,] 313.9706  8.285169 297.8173 330.0182
[135,] 327.9859  7.903306 312.2820 343.5113
[136,] 342.0013  8.216412 325.4283 357.7993
[137,] 356.0166  9.153448 337.8281 373.4671
[138,] 370.0319 10.549443 349.0898 390.8485
[139,] 384.0473 12.248465 359.7278 408.2521
[140,] 398.0626 14.141711 370.1332 426.0007
[141,] 254.7851 12.109935 231.1004 278.2619
[142,] 266.1181 10.442583 245.5339 286.4939
[143,] 277.4511  9.068066 259.7179 294.7983
[144,] 288.7841  8.136176 272.9575 304.0107
[145,] 300.1170  7.807058 284.7447 315.1558
[146,] 311.4500  8.154031 295.6186 327.1809
[147,] 322.7830  9.100085 304.8691 340.4997
[148,] 334.1160 10.484280 313.6299 354.5548
[149,] 345.4490 12.157876 321.7525 369.1448
[150,] 356.7820 14.017598 329.4537 384.0448
[151,] 226.4945 13.404790 199.4244 252.8298
[152,] 241.6913 11.433589 218.7386 264.1066
[153,] 256.8881  9.742619 237.4441 276.3893
[154,] 272.0849  8.500787 255.0294 288.8637
[155,] 287.2817  7.922199 271.6815 302.6104
[156,] 302.4786  8.149367 286.4611 318.3693
[157,] 317.6754  9.122292 299.3913 335.7373
[158,] 332.8722 10.638297 311.6494 354.0101
[159,] 348.0690 12.501343 323.4720 372.4664
[160,] 363.2658 14.578988 334.4353 391.8984
[161,] 252.1867 12.509051 226.8777 276.5532
[162,] 261.6648 10.761429 240.0161 282.8748
[163,] 271.1429  9.298459 252.2447 289.6972
[164,] 280.6210  8.272561 264.2519 296.9087
[165,] 290.0991  7.856855 274.6307 305.7606
[166,] 299.5772  8.145308 283.6452 315.9275
[167,] 309.0554  9.070990 291.6487 327.0947
[168,] 318.5335 10.466168 298.5240 339.5360
[169,] 328.0116 12.170433 304.7690 352.0367
[170,] 337.4897 14.071928 310.6546 365.2316
[171,] 263.7363 12.366728 240.0774 287.9656
[172,] 275.4491 10.649366 255.1637 296.5897
[173,] 287.1620  9.232332 269.6879 305.5760
[174,] 298.8748  8.271445 283.1843 315.4807
[175,] 310.5876  7.934201 295.2323 326.3598
[176,] 322.3005  8.297000 306.0700 338.7973
[177,] 334.0133  9.278080 315.8429 352.4228
[178,] 345.7261 10.708839 324.3152 366.6347
[179,] 357.4389 12.435015 332.3342 381.2750
[180,] 369.1518 14.350396 340.6207 396.4985</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.4641672 12.898837  -29.7848697  20.8295586
  [2,]  -14.9109178 11.026009  -36.7381041   6.7249310
  [3,]  -42.4064684  9.436794  -60.8915072 -24.2224876
  [4,]    8.6412810  8.295818   -7.6973794  24.3076016
  [5,]   24.4619304  7.802270    9.1241782  39.6641438
  [6,]   62.7086797  8.075740   47.0721162  78.3964456
  [7,]   10.6309291  9.046936   -6.9149505  28.2180131
  [8,] -101.0157215 10.524440 -121.6255144 -80.3863797
  [9,]   19.8295279 12.327528   -4.4219089  43.8255666
 [10,]   36.0062773 14.333855    7.3421823  63.9918089
 [11,]   11.3599069 13.048272  -13.7143782  37.4828039
 [12,]   -7.8991539 11.188423  -29.5570960  14.3320446
 [13,]  -11.9781147  9.610367  -30.6717689   7.2664698
 [14,]  -12.0398755  8.473044  -28.6162809   4.9835439
 [15,]  -10.8217363  7.967479  -26.5555741   5.1153613
 [16,]   -4.3669971  8.211208  -19.9668681  11.6826282
 [17,]   -8.4894579  9.144512  -26.2392419   9.0286256
 [18,]   -6.1835187 10.586559  -26.7340972  13.8267152
 [19,]   -1.4059794 12.360554  -25.8109049  22.2732348
 [20,]    9.8215598 14.343860  -19.3227460  37.2377914
 [21,]  -13.8693952 13.306467  -38.9813479  11.9580975
 [22,]  -23.5395887 11.406408  -45.1730319  -1.3783243
 [23,]   11.4997177  9.773787   -6.9694588  30.7389471
 [24,]    5.0728242  8.562964  -11.4387350  22.2137481
 [25,]   -3.4098694  7.968593  -18.8567114  12.5375682
 [26,]  -17.2078630  8.127070  -33.1729244  -1.2813070
 [27,]   -7.1934565  8.998708  -24.5557828  10.9982773
 [28,]    8.1883499 10.405811  -12.4901482  29.1149981
 [29,]    8.5012563 12.163952  -15.5599065  32.8187313
 [30,]   -9.9444372 14.142816  -37.7822744  17.5611589
 [31,]   46.4777495 13.491553   19.5601833  71.5107566
 [32,]   19.6865540 11.520296   -3.2159152  41.1415356
 [33,]   -2.5059414  9.826774  -22.0455183  15.8723811
 [34,]   -6.8782369  8.577108  -23.9154629   9.0751006
 [35,]  -11.8627323  7.982552  -27.8429157   3.5742150
 [36,]   -5.7233277  8.187096  -22.0256606  10.0226287
 [37,]  -28.7180232  9.137231  -46.5443764 -11.1976317
 [38,]    3.6548814 10.634965  -17.5502472  24.1717136
 [39,]  -14.9057141 12.484751  -40.0421546   8.9945251
 [40,]   28.1446905 14.552958   -0.8802947  56.2420357
 [41,]   14.2901783 13.082472  -11.5424112  39.1945440
 [42,]    4.2404154 11.222434  -17.7806284  26.1748676
 [43,]   13.6191525  9.653437   -5.3303829  32.5625472
 [44,]   24.4719896  8.537479    8.2977650  41.7728980
 [45,]   13.1921267  8.064872   -2.1176706  29.3344236
 [46,]  -17.2083362  8.345636  -33.2367408  -0.5520650
 [47,]  -27.8938991  9.311875  -46.5777200  -9.2069439
 [48,]    9.4069381 10.780830  -12.0649249  30.5280759
 [49,]  -39.1057248 12.577577  -64.0522089 -14.6734009
 [50,]   31.2866123 14.581443    1.9552143  59.4042324
 [51,]  -25.7896041 12.332443  -50.9438162  -1.5644138
 [52,]  -28.0148157 10.558374  -49.1283342  -7.3369742
 [53,]   -8.0417273  9.065492  -25.9132843   9.4231748
 [54,]   18.5893611  8.012539    2.4906263  33.8964389
 [55,]   16.1070495  7.584998    0.8417694  30.6694183
 [56,]   -1.5346621  7.885263  -17.3443168  14.0280996
 [57,]  132.4532263  8.839476  115.0202023 149.6221607
 [58,]   14.9460147 10.266891   -5.3400720  34.9650254
 [59,]  -11.7611969 11.999814  -35.3908401  11.7449087
 [60,]  -98.3735085 13.924647 -125.7765851 -70.8557672
 [61,]   15.7806126 12.457909   -9.7013180  39.6914364
 [62,]   11.2158165 10.681163  -10.5427307  31.7123260
 [63,]  -11.8472797  9.172877  -30.4103456   5.7967010
 [64,]    0.9157241  8.084728  -15.1030884  16.6394081
 [65,]  -12.0003720  7.599387  -26.7223300   2.7340895
 [66,]   18.7177318  7.829767    3.5339488  33.9820766
 [67,]    2.3003357  8.719319  -14.2579072  19.3385476
 [68,]    8.8363395 10.095271  -10.7670781  28.3829604
 [69,]  -16.9209566 11.788520  -40.0402661   6.0129986
 [70,]    1.4844472 13.681762  -25.4182386  27.9088382
 [71,]   21.2313539 12.313756   -2.6943287  45.4913133
 [72,]   20.4304112 10.590162   -0.3118796  41.0420813
 [73,]  -23.9351316  9.151889  -41.9593114  -5.9987645
 [74,]  -24.1565744  8.151393  -40.1920966  -8.5779864
 [75,]  -11.3335171  7.759892  -26.3402159   3.5810583
 [76,]  -17.6957599  8.066551  -33.5372142  -2.2629905
 [77,]   -7.8912027  9.000286  -25.6661291   9.7379010
 [78,]    6.5778546 10.393443  -13.7442520  27.1538571
 [79,]   -0.7271882 12.088207  -24.4201018  23.2687514
 [80,]   29.2958690 13.975279    2.1773791  57.5155228
 [81,]   -8.8943002 13.419716  -36.7413342  16.6106368
 [82,]   23.6361786 11.479547   -0.4016636  45.3204456
 [83,]    4.3712573  9.815912  -15.6520682  23.3575286
 [84,]   20.8742361  8.590993    3.8316924  37.5419276
 [85,]    1.7156149  8.008687  -14.1385336  17.2346902
 [86,]    5.0914937  8.206942  -11.2026588  20.8234729
 [87,]   -3.9008275  9.135076  -22.1678390  13.8887122
 [88,]  -13.8505488 10.603123  -35.2278819   6.7925721
 [89,]  -13.2158700 12.421101  -38.2559395  10.9602392
 [90,]  -11.5317912 14.457599  -40.1535729  16.6171768
 [91,]   26.2944598 13.140789   -0.2886457  51.7663519
 [92,]    8.5948939 11.259698  -14.5276871  30.7749736
 [93,]  -32.7384721  9.659438  -52.3280193 -13.5561302
 [94,]    2.6337620  8.500128  -14.3768946  19.4023277
 [95,]    3.1051961  7.976407  -12.6181913  19.0679168
 [96,]   10.0725302  8.210813   -6.1007015  26.3337693
 [97,]    3.3553642  9.145234  -14.4779560  21.5034966
 [98,]   -3.3512017 10.596067  -24.2808709  17.4105398
 [99,]   16.6820324 12.383111   -7.5258240  40.7982133
[100,]    0.5956664 14.381576  -28.1211698  28.6509489
[101,]    9.3816335 12.916129  -14.8819611  35.2138900
[102,]   -7.9190203 11.082747  -28.5071456  14.0586107
[103,]  -10.8242742  9.515204  -28.8011726   7.8418286
[104,]   -6.3420280  8.364324  -22.2971294  10.2138104
[105,]  -22.0678819  7.816373  -37.1380155  -6.6172917
[106,]  -14.5179357  7.996276  -29.7936952   1.2816623
[107,]  -14.2416896  8.859804  -31.4117335   3.5438525
[108,]    0.7813566 10.235370  -19.5088474  21.0792723
[109,]   17.4458027 11.947402   -6.1720788  40.9324084
[110,]   21.2961489 13.871878   -5.9816128  48.6113863
[111,]   17.3895485 12.970596   -7.4080352  43.2168744
[112,]  -12.4036995 11.068793  -33.5638045   9.2738422
[113,]  -16.6041475  9.457456  -34.3314664   1.9755937
[114,]  -34.2323954  8.307362  -50.0913987 -18.3887555
[115,]  -37.7937434  7.824611  -52.8420078 -22.6654137
[116,]    6.0637086  8.128979   -9.5703068  21.7217351
[117,]   38.8327606  9.142185   20.9684818  56.4021494
[118,]    5.3559126 10.664065  -15.3204755  25.5847543
[119,]   19.9739647 12.510336   -4.4469650  43.5069286
[120,]   -2.4112833 14.558097  -30.6852087  25.3347973
[121,]   -4.9651607 12.273633  -28.7331292  18.3041020
[122,]   37.0462203 10.575411   16.6531404  57.2233724
[123,]   -0.6371986  9.164743  -18.7132788  17.0495541
[124,]    2.5382824  8.191561  -13.8247083  18.3327378
[125,]  -13.7431365  7.820919  -29.3296047   1.3537534
[126,]   11.5433445  8.135591   -4.8288549  27.4866670
[127,]  -12.8633745  9.064483  -30.6319779   5.0043099
[128,]  -41.5341934 10.444990  -62.0496585 -20.9485561
[129,]    5.8923876 12.123808  -17.9426671  30.3009397
[130,]   24.3963687 13.993984   -3.1194457  52.1736057
[131,]  -50.2474591 12.432347  -75.0717626 -26.6722764
[132,]   12.2539997 10.709553   -9.3134145  32.4842370
[133,]   26.9232586  9.276572    8.5161107  44.5878561
[134,]   32.8849174  8.285169   16.8372810  49.0381941
[135,]   20.7542762  7.903306    5.2288688  36.4581702
[136,]   10.8274351  8.216412   -4.9705869  27.4003996
[137,]   -1.5900061  9.153448  -19.0404896  16.5984749
[138,]   -9.5993472 10.549443  -30.4159099  11.3427877
[139,]   -8.4066884 12.248465  -32.6115302  15.9127793
[140,]   -9.5209295 14.141711  -37.4590225  18.4084936
[141,]   17.1384182 12.109935   -6.3384457  40.8230984
[142,]    2.3188284 10.442583  -18.0569675  22.9029604
[143,]  -20.2086614  9.068066  -37.5558825  -2.4755352
[144,]  -11.1274512  8.136176  -26.3540722   4.6990735
[145,]   14.7051590  7.807058   -0.3336169  30.0774807
[146,]    5.7634692  8.154031   -9.9674211  21.5949195
[147,]  -24.6477206  9.100085  -42.3643544  -6.7337805
[148,]   14.0068896 10.484280   -6.4318724  34.4929568
[149,]   -5.1690002 12.157876  -28.8647512  18.5275176
[150,]    9.7311100 14.017598  -17.5317340  37.0594454
[151,]   -1.2304519 13.404790  -27.5657632  25.8396115
[152,]   -7.1677731 11.433589  -29.5831290  15.7849002
[153,]  -17.9872943  9.742619  -37.4885411   1.4567229
[154,]  -31.6119154  8.500787  -48.3907310 -14.5564225
[155,]  -19.7444366  7.922199  -35.0730961  -4.1441972
[156,]   41.7151422  8.149367   25.8244457  57.7325616
[157,]  -36.5272790  9.122292  -54.5891798 -18.2431971
[158,]   14.7132998 10.638297   -6.4245506  35.9360744
[159,]   17.0939787 12.501343   -7.3034176  41.6909918
[160,]    8.9629575 14.578988  -19.6695688  37.7934856
[161,]   17.6937257 12.509051   -6.6728232  43.0027234
[162,]   10.7780130 10.761429  -10.4320131  32.4266752
[163,]    6.7560003  9.298459  -11.7983321  25.6542024
[164,]    1.1684876  8.272561  -15.1192117  17.5375671
[165,]  -10.9286251  7.856855  -26.5901145   4.5397613
[166,]  -15.0652378  8.145308  -31.4154757   0.8668257
[167,]  -49.7895506  9.070990  -67.8288612 -32.3828931
[168,]  -13.9028633 10.466168  -34.9053698   6.1066110
[169,]   22.7691240 12.170433   -1.2560287  46.0116740
[170,]   31.9795113 14.071928    4.2375992  58.8146384
[171,]    5.6754093 12.366728  -18.5538921  29.3342510
[172,]   -1.9751229 10.649366  -23.1157342  18.3103347
[173,]   10.4348449  9.232332   -7.9792487  27.9089419
[174,]   11.7568126  8.271445   -4.8490956  27.4473359
[175,]  -23.4150196  7.934201  -39.1871772  -8.0596756
[176,]    7.3071481  8.297000   -9.1897106  23.5375943
[177,]    0.4685159  9.278080  -17.9410020  18.6389439
[178,]   -2.5062164 10.708839  -23.4148436  18.9046620
[179,]   11.7027514 12.435015  -12.1332792  36.8074567
[180,]   -5.0281808 14.350396  -32.3749424  23.5028697</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 5 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.5
p_loo        19.7  3.5
looic      1770.3 28.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   543       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   74        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.4
p_loo        34.2  8.5
looic      1722.3 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   985       
 (0.5, 0.7]   (ok)         3    1.7%   751       
   (0.7, 1]   (bad)        3    1.7%   33        
   (1, Inf)   (very bad)   2    1.1%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.0      11.6  
fit_sleep1 -92.1      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 5 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.5
p_loo        19.7  3.5
looic      1770.3 28.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   543       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   74        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.4
p_loo        34.2  8.5
looic      1722.3 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   985       
 (0.5, 0.7]   (ok)         3    1.7%   751       
   (0.7, 1]   (bad)        3    1.7%   33        
   (1, Inf)   (very bad)   2    1.1%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.2     22.4        34.2    8.5   1722.3
fit_sleep2  -24.0      11.6  -885.2     14.5        19.7    3.5   1770.3
fit_sleep1  -92.1      21.1  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.9  
fit_sleep2   28.9  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
9.658835e-41 3.773831e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.87      1.58     0.29     5.43       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.13      1.58    -3.35     2.89       5.53      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0         tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
