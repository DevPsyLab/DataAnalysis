<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.61      6.66    15.43    41.18 1.00     2074     2575
sd(Days)                6.62      1.53     4.15    10.17 1.00     1471     1748
cor(Intercept,Days)     0.10      0.31    -0.49     0.70 1.00      835     1315

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.36      7.24   237.75   266.21 1.00     1753     2303
Days         10.49      1.76     7.05    14.03 1.00     1150     1696

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.51    23.23    29.07 1.00     3147     2867

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9997  13.47548 227.1131 280.0045
309 211.4506  13.43327 185.1008 237.6174
310 213.1989  13.37082 186.9776 239.7031
330 274.3806  13.47551 249.1401 301.5499
331 272.9283  13.13319 247.6128 299.6431
332 260.0568  12.08960 236.5287 284.4255
333 267.8437  12.50166 244.5291 293.8729
334 244.2187  12.20872 219.9621 268.1945
335 250.8474  13.65031 224.9693 277.9683
337 285.6174  13.37547 259.6632 312.2162
349 226.8442  12.77224 201.1233 250.8936
350 239.0877  13.54419 211.4274 264.2529
351 255.8212  12.35272 231.7304 279.5938
352 271.8037  12.48814 247.0190 296.5177
369 254.4989  12.45749 230.5382 279.6147
370 226.5216  13.47360 199.1286 251.6064
371 251.7818  12.29913 228.0763 276.1403
372 263.3755  12.55151 238.9672 287.9802

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6104066  2.603021 14.5676891 24.941036
309  1.7289996  2.516456 -3.1478954  6.650997
310  4.9339296  2.480798  0.1227367  9.747633
330  5.8206447  2.561342  0.7054312 10.704471
331  7.5495242  2.490504  2.6945646 12.368916
332 10.2562412  2.315128  5.6749438 14.706548
333 10.2927662  2.370573  5.4520201 14.723348
334 11.5149612  2.346725  6.9642070 16.266732
335 -0.2599543  2.603585 -5.4306330  4.809477
337 19.2065567  2.539421 14.3247422 24.196782
349 11.4881019  2.409691  6.8001668 16.331084
350 16.9902443  2.562535 12.1558819 22.135555
351  7.4409304  2.353084  2.9480512 12.100181
352 14.0354807  2.373408  9.4154832 18.849764
369 11.3570870  2.376588  6.6700346 16.121667
370 15.1262280  2.577198 10.3611177 20.345071
371  9.5003537  2.322583  4.8615924 13.942887
372 11.8130906  2.389886  7.0871533 16.367546</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9997 13.475476 227.1131 280.0045
  [2,] 273.6101 11.461283 250.7832 295.6667
  [3,] 293.2206  9.730622 274.2587 311.8560
  [4,] 312.8310  8.459340 296.2316 329.3794
  [5,] 332.4414  7.873201 316.9663 347.9386
  [6,] 352.0518  8.121922 336.0474 368.1603
  [7,] 371.6622  9.137580 353.7485 389.6700
  [8,] 391.2726 10.704044 370.5481 412.4076
  [9,] 410.8830 12.617812 386.5314 436.1666
 [10,] 430.4934 14.744262 402.1781 460.4171
 [11,] 211.4506 13.433275 185.1008 237.6174
 [12,] 213.1796 11.519943 190.5061 235.9031
 [13,] 214.9086  9.880810 195.7047 234.1782
 [14,] 216.6376  8.672762 199.4681 233.6826
 [15,] 218.3666  8.091249 202.4455 234.4382
 [16,] 220.0956  8.269517 204.2200 236.6714
 [17,] 221.8246  9.163330 203.8170 240.0417
 [18,] 223.5536 10.593083 202.2850 244.2121
 [19,] 225.2826 12.374381 200.5195 249.5295
 [20,] 227.0116 14.377145 198.2614 254.8298
 [21,] 213.1989 13.370825 186.9776 239.7031
 [22,] 218.1328 11.501881 195.5774 240.8718
 [23,] 223.0668  9.905366 203.5176 242.3590
 [24,] 228.0007  8.732011 210.6154 244.8917
 [25,] 232.9346  8.166300 216.6432 248.9707
 [26,] 237.8686  8.332924 221.7096 254.5863
 [27,] 242.8025  9.192144 225.0060 261.0926
 [28,] 247.7364 10.576488 227.3554 268.7169
 [29,] 252.6704 12.310054 228.9256 276.9126
 [30,] 257.6043 14.266094 229.9016 285.8758
 [31,] 274.3806 13.475507 249.1401 301.5499
 [32,] 280.2012 11.528824 258.4814 303.4379
 [33,] 286.0218  9.867078 267.3314 305.9390
 [34,] 291.8425  8.655958 275.0453 308.9751
 [35,] 297.6631  8.100181 281.9033 313.5077
 [36,] 303.4838  8.331940 286.8501 319.7457
 [37,] 309.3044  9.292495 290.7036 327.7079
 [38,] 315.1251 10.788913 293.5996 336.4489
 [39,] 320.9457 12.632173 296.5047 345.8564
 [40,] 326.7664 14.692307 297.7926 355.5478
 [41,] 272.9283 13.133193 247.6128 299.6431
 [42,] 280.4779 11.253146 258.7340 303.2259
 [43,] 288.0274  9.653551 269.4351 307.6696
 [44,] 295.5769  8.494352 278.9396 312.3892
 [45,] 303.1264  7.970082 287.5239 318.8400
 [46,] 310.6759  8.203390 294.4912 326.7666
 [47,] 318.2255  9.136423 300.3512 336.4611
 [48,] 325.7750 10.585749 305.1420 346.9178
 [49,] 333.3245 12.371222 309.6288 358.2765
 [50,] 340.8740 14.368069 313.2190 369.7236
 [51,] 260.0568 12.089599 236.5287 284.4255
 [52,] 270.3130 10.395527 250.0604 291.3169
 [53,] 280.5693  8.983050 262.8876 298.8204
 [54,] 290.8255  8.002689 274.8711 306.8388
 [55,] 301.0818  7.623025 285.8025 316.0119
 [56,] 311.3380  7.930802 295.6352 327.0018
 [57,] 321.5942  8.854624 303.8881 339.3587
 [58,] 331.8505 10.228917 311.6400 352.6063
 [59,] 342.1067 11.898603 318.7120 365.9584
 [60,] 352.3630 13.756540 325.3619 379.7037
 [61,] 267.8437 12.501662 244.5291 293.8729
 [62,] 278.1365 10.742402 258.0774 299.8642
 [63,] 288.4293  9.259918 270.9950 306.7279
 [64,] 298.7220  8.205619 282.8862 315.3851
 [65,] 309.0148  7.756128 293.6138 324.5574
 [66,] 319.3076  8.013869 303.6799 335.3447
 [67,] 329.6003  8.917729 312.4589 347.2962
 [68,] 339.8931 10.298976 319.8854 360.2849
 [69,] 350.1859 11.993797 326.6148 373.5233
 [70,] 360.4786 13.887860 333.4824 386.8420
 [71,] 244.2187 12.208717 219.9621 268.1945
 [72,] 255.7336 10.490422 234.9749 276.1417
 [73,] 267.2486  9.058662 249.2682 285.0014
 [74,] 278.7635  8.067465 262.7473 294.4030
 [75,] 290.2785  7.689139 274.9476 305.2825
 [76,] 301.7935  8.010990 285.9517 317.5336
 [77,] 313.3084  8.957862 295.4095 331.3803
 [78,] 324.8234 10.359771 304.0865 345.4581
 [79,] 336.3383 12.059049 311.9921 360.0792
 [80,] 347.8533 13.947426 320.0457 375.2739
 [81,] 250.8474 13.650313 224.9693 277.9683
 [82,] 250.5875 11.613312 228.3102 273.6075
 [83,] 250.3275  9.847044 231.4499 269.8039
 [84,] 250.0676  8.521553 233.6799 266.6307
 [85,] 249.8076  7.862999 234.3976 264.9978
 [86,] 249.5477  8.037036 233.5847 264.9242
 [87,] 249.2877  8.995469 231.3668 266.2397
 [88,] 249.0277 10.526172 227.9110 269.0563
 [89,] 248.7678 12.419316 224.2479 272.9573
 [90,] 248.5078 14.533955 219.9724 276.4738
 [91,] 285.6174 13.375468 259.6632 312.2162
 [92,] 304.8240 11.466840 282.7724 328.0527
 [93,] 324.0305  9.847385 304.9766 343.7893
 [94,] 343.2371  8.680488 326.8247 360.7397
 [95,] 362.4436  8.162603 346.3753 378.7703
 [96,] 381.6502  8.414428 365.0379 397.9626
 [97,] 400.8568  9.374137 382.2439 418.9930
 [98,] 420.0633 10.855579 398.4819 441.4764
 [99,] 439.2699 12.677147 414.1257 464.1998
[100,] 458.4764 14.713050 429.4968 487.5960
[101,] 226.8442 12.772244 201.1233 250.8936
[102,] 238.3323 10.951873 216.6289 259.0607
[103,] 249.8204  9.400534 231.3920 267.6976
[104,] 261.3085  8.271021 245.4424 277.1400
[105,] 272.7966  7.750016 257.7493 287.9551
[106,] 284.2847  7.957947 268.9647 299.9578
[107,] 295.7728  8.843547 278.6733 313.2121
[108,] 307.2609 10.232347 287.5806 327.2378
[109,] 318.7490 11.950178 295.5730 342.3353
[110,] 330.2371 13.875367 302.8987 357.6654
[111,] 239.0877 13.544185 211.4274 264.2529
[112,] 256.0779 11.568030 232.1820 277.5399
[113,] 273.0682  9.865437 252.8267 291.7104
[114,] 290.0584  8.600440 272.8021 306.6821
[115,] 307.0487  7.983825 290.9627 322.5205
[116,] 324.0389  8.163855 307.6840 339.9217
[117,] 341.0291  9.093336 323.0426 358.7590
[118,] 358.0194 10.576492 337.5952 378.4714
[119,] 375.0096 12.416472 351.0280 399.4506
[120,] 391.9999 14.477864 364.2299 420.6910
[121,] 255.8212 12.352720 231.7304 279.5938
[122,] 263.2621 10.634752 242.5939 283.5514
[123,] 270.7031  9.202185 252.6670 288.3576
[124,] 278.1440  8.205881 261.6568 293.9892
[125,] 285.5849  7.814523 269.8084 300.8157
[126,] 293.0258  8.116100 276.8404 308.8102
[127,] 300.4668  9.041536 282.7162 317.6304
[128,] 307.9077 10.426011 287.5427 327.8301
[129,] 315.3486 12.113135 291.8250 338.9392
[130,] 322.7896 13.993869 295.4408 349.9446
[131,] 271.8037 12.488145 247.0190 296.5177
[132,] 285.8392 10.748271 264.2551 307.0033
[133,] 299.8747  9.293171 281.4813 317.9098
[134,] 313.9102  8.274470 297.5908 329.9270
[135,] 327.9456  7.863638 312.7798 343.3673
[136,] 341.9811  8.153090 325.8377 357.8389
[137,] 356.0166  9.076072 338.4480 373.5825
[138,] 370.0521 10.466300 349.8207 390.2093
[139,] 384.0876 12.164616 360.5567 407.5798
[140,] 398.1230 14.059818 370.9639 425.6383
[141,] 254.4989 12.457485 230.5382 279.6147
[142,] 265.8560 10.698975 244.9736 287.4345
[143,] 277.2131  9.221905 259.0074 295.8838
[144,] 288.5702  8.180180 272.6174 304.9093
[145,] 299.9273  7.751355 285.1693 315.6235
[146,] 311.2843  8.034177 295.5446 327.2964
[147,] 322.6414  8.961520 305.5203 340.2051
[148,] 333.9985 10.361757 314.1040 354.5805
[149,] 345.3556 12.071435 321.8897 369.4709
[150,] 356.7127 13.977461 329.6828 384.9132
[151,] 226.5216 13.473603 199.1286 251.6064
[152,] 241.6478 11.490773 218.1840 263.2464
[153,] 256.7740  9.788853 237.1788 275.3872
[154,] 271.9003  8.537524 255.0249 288.0833
[155,] 287.0265  7.952415 271.4239 302.6506
[156,] 302.1527  8.177799 286.0180 318.1834
[157,] 317.2790  9.154004 299.3989 335.4950
[158,] 332.4052 10.677035 311.7170 353.5560
[159,] 347.5314 12.549354 323.2801 372.2398
[160,] 362.6576 14.637533 334.5416 391.4575
[161,] 251.7818 12.299131 228.0763 276.1403
[162,] 261.2821 10.647493 240.5827 282.0520
[163,] 270.7825  9.287539 252.7992 289.1328
[164,] 280.2828  8.362801 263.7285 296.7716
[165,] 289.7832  8.025166 274.0916 305.5758
[166,] 299.2836  8.346192 282.6528 315.5152
[167,] 308.7839  9.257610 290.5553 326.6665
[168,] 318.2843 10.608325 297.4725 338.6635
[169,] 327.7846 12.253920 303.8037 351.5096
[170,] 337.2850 14.091464 309.4967 364.2652
[171,] 263.3755 12.551508 238.9672 287.9802
[172,] 275.1885 10.767699 254.1993 296.2332
[173,] 287.0016  9.261179 268.8874 305.1877
[174,] 298.8147  8.186491 282.4093 314.9293
[175,] 310.6278  7.725992 295.5344 325.8942
[176,] 322.4409  7.986638 306.7509 337.4205
[177,] 334.2540  8.905332 316.6353 351.4087
[178,] 346.0671 10.307599 325.3189 365.9076
[179,] 357.8802 12.025446 333.9067 381.1010
[180,] 369.6933 13.942713 342.2463 396.7069</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.4397400 13.475476  -30.44445882  22.4469303
  [2,]  -14.9054466 11.461283  -36.96198033   7.9214978
  [3,]  -42.4199533  9.730622  -61.05542156 -23.4581172
  [4,]    8.6088401  8.459340   -7.93961206  25.2081571
  [5,]   24.4105335  7.873201    8.91332760  39.8855523
  [6,]   62.6383268  8.121922   46.52982985  78.6426681
  [7,]   10.5416202  9.137580   -7.46623393  28.4552602
  [8,] -101.1239865 10.704044 -122.25895990 -80.3994605
  [9,]   19.7023069 12.617812   -5.58129767  44.0539066
 [10,]   35.8601003 14.744262    5.93641161  64.1753970
 [11,]   11.2832630 13.433275  -14.88348734  37.6330733
 [12,]   -7.9138366 11.519943  -30.63728267  14.7597358
 [13,]  -11.9308361  9.880810  -31.20040631   7.2730775
 [14,]  -11.9306357  8.672762  -28.97557128   5.2389108
 [15,]  -10.6505352  8.091249  -26.72213794   5.2706401
 [16,]   -4.1338348  8.269517  -20.70959715  11.7418407
 [17,]   -8.1943343  9.163330  -26.41138540   9.8133302
 [18,]   -5.8264339 10.593083  -26.48490358  15.4422467
 [19,]   -0.9869335 12.374381  -25.23382570  23.7761858
 [20,]   10.3025670 14.377145  -17.51564049  39.0527733
 [21,]  -14.1450136 13.370825  -40.64919415  12.0762744
 [22,]  -23.8006432 11.501881  -46.53956489  -1.2451574
 [23,]   11.2532272  9.905366   -8.03900779  30.8023542
 [24,]    4.8408976  8.732011  -12.05011986  22.2262402
 [25,]   -3.6272320  8.166300  -19.66328424  12.6642061
 [26,]  -17.4106616  8.332924  -34.12843762  -1.2517336
 [27,]   -7.3816912  9.192144  -25.67183445  10.4147549
 [28,]    8.0146792 10.576488  -12.96576769  28.3956523
 [29,]    8.3421496 12.310054  -15.90014434  32.0869149
 [30,]  -10.0889800 14.266094  -38.36048821  17.6137494
 [31,]   47.1620414 13.475507   19.99269686  72.4024505
 [32,]   20.1989967 11.528824   -3.03771252  41.9188066
 [33,]   -2.1653480  9.867078  -22.08248774  16.5251144
 [34,]   -6.7094927  8.655958  -23.84207220  10.0877323
 [35,]  -11.8658374  8.100181  -27.71040287   3.8940451
 [36,]   -5.8982821  8.331940  -22.16015743  10.7354344
 [37,]  -29.0648268  9.292495  -47.46832553 -10.4639530
 [38,]    3.1362285 10.788913  -18.18761578  24.6616605
 [39,]  -15.5962162 12.632173  -40.50686803   8.8447597
 [40,]   27.2823391 14.692307   -1.49905605  56.2561192
 [41,]   14.6795730 13.133193  -12.03520457  39.9951090
 [42,]    4.5221488 11.253146  -18.22592937  26.2659758
 [43,]   13.7932246  9.653551   -5.84904029  32.3855303
 [44,]   24.5384004  8.494352    7.72610481  41.1757284
 [45,]   13.1508762  7.970082   -2.56271919  28.7534330
 [46,]  -17.3572480  8.203390  -33.44790141  -1.1725295
 [47,]  -28.1504722  9.136423  -46.38613030 -10.2762402
 [48,]    9.0427036 10.585749  -12.10012631  29.6757355
 [49,]  -39.5776206 12.371222  -64.52961482 -15.8819441
 [50,]   30.7070552 14.368069    1.85751396  58.3620669
 [51,]  -25.1961866 12.089599  -49.56487970  -1.6680723
 [52,]  -27.5012278 10.395527  -48.50509876  -7.2486241
 [53,]   -7.6079690  8.983050  -25.85912995  10.0736809
 [54,]   18.9432898  8.002689    2.93003742  34.8976696
 [55,]   16.3811486  7.623025    1.45098608  31.6603556
 [56,]   -1.3403926  7.930802  -17.00418294  14.3624310
 [57,]  132.5676662  8.854624  114.80317248 150.2737801
 [58,]   14.9806250 10.228917   -5.77518856  35.1911194
 [59,]  -11.8064162 11.898603  -35.65811962  11.5882649
 [60,]  -98.4985575 13.756540 -125.83931967 -71.4975380
 [61,]   15.9986657 12.501662  -10.03053227  39.3132978
 [62,]   11.4184995 10.742402  -10.30924125  31.4776002
 [63,]  -11.6599667  9.259918  -29.95858517   5.7743010
 [64,]    1.0876670  8.205619  -15.57536221  16.9234803
 [65,]  -11.8437992  7.756128  -27.38642400   3.5572273
 [66,]   18.8589346  8.013869    2.82180421  34.4865517
 [67,]    2.4261684  8.917729  -15.26971831  19.5676246
 [68,]    8.9468021 10.298976  -11.44502414  28.9545183
 [69,]  -16.8258641 11.993797  -40.16326255   6.7452111
 [70,]    1.5641697 13.887860  -24.79916642  28.5604390
 [71,]   21.2544469 12.208717   -2.72141016  45.5109729
 [72,]   20.4675857 10.490422    0.05951265  41.2263121
 [73,]  -23.8838756  9.058662  -41.63667113  -5.9034887
 [74,]  -24.0912368  8.067465  -39.73069122  -8.0750199
 [75,]  -11.2540980  7.689139  -26.25809425   4.0767972
 [76,]  -17.6022592  8.010990  -33.34244617  -1.7604771
 [77,]   -7.7836204  8.957862  -25.85554694  10.1153196
 [78,]    6.6995184 10.359771  -13.93519641  27.4363897
 [79,]   -0.5914428 12.059049  -24.33225344  23.7547931
 [80,]   29.4456960 13.947426    2.02514457  57.2533352
 [81,]   -9.2391300 13.650313  -36.36000788  16.6389899
 [82,]   23.3597244 11.613312    0.33974154  45.6369704
 [83,]    4.1631787  9.847044  -15.31317855  23.0408007
 [84,]   20.7345330  8.521553    4.17136828  37.1221597
 [85,]    1.6442874  7.862999  -13.54594296  17.0543444
 [86,]    5.0885417  8.037036  -10.28803323  21.0515062
 [87,]   -3.8354040  8.995469  -20.78738902  14.0854919
 [88,]  -13.7167496 10.526172  -33.74533886   7.3999896
 [89,]  -13.0136953 12.419316  -37.20321845  11.5061990
 [90,]  -11.2612410 14.533955  -39.22720622  17.2742374
 [91,]   26.7491818 13.375468    0.15038988  52.7033816
 [92,]    8.9818251 11.466840  -14.24694697  31.0334262
 [93,]  -32.4193316  9.847385  -52.17809746 -13.3653951
 [94,]    2.8851117  8.680488  -14.61754288  19.2975271
 [95,]    3.2887550  8.162603  -13.03789592  19.3571157
 [96,]   10.1882982  8.414428   -6.12405405  26.8005677
 [97,]    3.4033415  9.374137  -14.73285149  22.0162424
 [98,]   -3.3710152 10.855579  -24.78406838  18.2104196
 [99,]   16.5944281 12.677147   -8.33549487  41.7385717
[100,]    0.4402714 14.713050  -28.67929541  29.4198965
[101,]    9.2589793 12.772244  -14.79043315  34.9798877
[102,]   -8.0156226 10.951873  -28.74397258  13.6878263
[103,]  -10.8948244  9.400534  -28.77195415   7.5336378
[104,]   -6.3865263  8.271021  -22.21798333   9.4795581
[105,]  -22.0863282  7.750016  -37.24483189  -7.0389900
[106,]  -14.5103300  7.957947  -30.18344563   0.8097026
[107,]  -14.2080319  8.843547  -31.64732156   2.8914884
[108,]    0.8410662 10.232347  -19.13579353  20.5214493
[109,]   17.5315644 11.950178   -6.05469082  40.7075565
[110,]   21.4079625 13.875367   -6.02026531  48.7463632
[111,]   17.2091250 13.544185   -7.95607032  44.8693930
[112,]  -12.6236193 11.568030  -34.08560310  11.2723420
[113,]  -16.8635636  9.865437  -35.50580658   3.3778676
[114,]  -34.5313078  8.600440  -51.15499204 -17.2750464
[115,]  -38.1321521  7.983825  -53.60396482 -22.0462407
[116,]    5.6858036  8.163855  -10.19698671  22.0406949
[117,]   38.4153594  9.093336   20.68549041  56.4019472
[118,]    4.8990151 10.576492  -15.55297069  25.3231690
[119,]   19.4775709 12.416472   -4.96342196  43.4592404
[120,]   -2.9471734 14.477864  -31.63830566  24.8228064
[121,]   -5.2946899 12.352720  -29.06728124  18.7961455
[122,]   36.7954796 10.634752   16.50618356  57.4637437
[123,]   -0.8091508  9.202185  -18.46366502  17.2268735
[124,]    2.4451188  8.205881  -13.40006062  18.9323310
[125,]  -13.7575117  7.814523  -28.98831666   2.0189755
[126,]   11.6077579  8.116100   -4.17659911  27.7931866
[127,]  -12.7201725  9.041536  -29.88379114   5.0303601
[128,]  -41.3122030 10.426011  -61.23461512 -20.9472017
[129,]    6.1931666 12.113135  -17.39741971  29.7167862
[130,]   24.7759362 13.993869   -2.37912644  52.1246940
[131,]  -50.1266229 12.488145  -74.84063105 -25.3418916
[132,]   12.3546964 10.748271   -8.80939204  33.9388238
[133,]   27.0038157  9.293171    8.96868871  45.3971696
[134,]   32.9453349  8.274470   16.92854385  49.2646593
[135,]   20.7945542  7.863638    5.37286509  35.9603699
[136,]   10.8475735  8.153090   -5.01016986  26.9909535
[137,]   -1.5900072  9.076072  -19.15591115  15.9786304
[138,]   -9.6194880 10.466300  -29.77671185  10.6118566
[139,]   -8.4469687 12.164616  -31.93924318  15.0839301
[140,]   -9.5813494 14.059818  -37.09657062  17.5777608
[141,]   17.4245979 12.457485   -7.69123429  41.3853204
[142,]    2.5809109 10.698975  -18.99764153  23.4633184
[143,]  -19.9706761  9.221905  -38.64143391  -1.7650250
[144,]  -10.9135631  8.180180  -27.25271680   5.0391966
[145,]   14.8949499  7.751355   -0.80128043  29.6529106
[146,]    5.9291629  8.034177  -10.08291051  21.6689103
[147,]  -24.5061241  8.961520  -42.06979376  -7.3850469
[148,]   14.1243889 10.361757   -6.45761314  34.0189009
[149,]   -5.0755981 12.071435  -29.19085891  18.3902629
[150,]    9.8004148 13.977461  -18.40008305  36.8303074
[151,]   -1.2575849 13.473603  -26.34244413  26.1354050
[152,]   -7.1243129 11.490773  -28.72285898  16.3395011
[153,]  -17.8732409  9.788853  -36.48642863   1.7220439
[154,]  -31.4272689  8.537524  -47.61026730 -14.5518843
[155,]  -19.4891968  7.952415  -35.11332264  -3.8865537
[156,]   42.0409752  8.177799   26.01030803  58.1757186
[157,]  -36.1308528  9.154004  -54.34693660 -18.2508469
[158,]   15.1803192 10.677035   -5.97049905  35.8684617
[159,]   17.6315912 12.549354   -7.07684740  41.8829314
[160,]    9.5711633 14.637533  -19.22873191  37.6872321
[161,]   18.0986185 12.299131   -6.25989684  41.8040752
[162,]   11.1606648 10.647493   -9.60919705  31.8600586
[163,]    7.1164111  9.287539  -11.23392574  25.0996662
[164,]    1.5066573  8.362801  -14.98214446  18.0610288
[165,]  -10.6126964  8.025166  -26.40530445   5.0788870
[166,]  -14.7715502  8.346192  -31.00318190   1.8591515
[167,]  -49.5181039  9.257610  -67.40067152 -31.2895381
[168,]  -13.6536576 10.608325  -34.03293156   7.1581441
[169,]   22.9960886 12.253920   -0.72891477  46.9770130
[170,]   32.1842349 14.091464    5.20395036  59.9725344
[171,]    6.0362445 12.551508  -18.56849402  30.4444792
[172,]   -1.7145461 10.767699  -22.75917899  19.2746901
[173,]   10.5951634  9.261179   -7.59091746  28.7094416
[174,]   11.8168728  8.186491   -4.29767471  28.2222991
[175,]  -23.4552177  7.725992  -38.72161439  -8.3618454
[176,]    7.1666917  7.986638   -7.81294589  22.8566895
[177,]    0.2278012  8.905332  -16.92686171  17.8464515
[178,]   -2.8471894 10.307599  -22.68771318  17.9009864
[179,]   11.2615200 12.025446  -11.95929569  35.2349879
[180,]   -5.5696705 13.942713  -32.58327835  21.8772996</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.5  3.3
looic      1770.2 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1738      
 (0.5, 0.7]   (ok)         2    1.1%   90        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.3
p_loo        34.0  8.4
looic      1722.5 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   629       
 (0.5, 0.7]   (ok)         4    2.2%   959       
   (0.7, 1]   (bad)        2    1.1%   26        
   (1, Inf)   (very bad)   1    0.6%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.9      11.6  
fit_sleep1 -92.1      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.5  3.3
looic      1770.2 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1738      
 (0.5, 0.7]   (ok)         2    1.1%   90        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.3
p_loo        34.0  8.4
looic      1722.5 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   629       
 (0.5, 0.7]   (ok)         4    2.2%   959       
   (0.7, 1]   (bad)        2    1.1%   26        
   (1, Inf)   (very bad)   1    0.6%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.2     22.3        34.0    8.4   1722.5
fit_sleep2  -23.9      11.6  -885.1     14.4        19.5    3.3   1770.2
fit_sleep1  -92.1      21.0  -953.3     10.5         3.2    0.5   1906.7
           se_looic
fit_sleep3   44.7  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
9.941912e-41 4.352934e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.89      1.55     0.28     5.36       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.11      1.55    -3.35     2.73       4.88      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.2            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
