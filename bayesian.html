<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.87      6.82    15.58    41.87 1.00     1948     2583
sd(Days)                6.55      1.50     4.17    10.01 1.00     1456     1734
cor(Intercept,Days)     0.08      0.30    -0.48     0.68 1.00      981     1310

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.25      7.39   236.60   265.55 1.00     1957     2770
Days         10.35      1.70     6.83    13.65 1.00     1420     1942

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.61    22.96    29.21 1.00     3287     2385

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.1047  12.92603 228.0999 279.4474
309 211.3392  13.08183 185.6760 236.5875
310 212.9842  13.56007 185.8733 238.8371
330 274.5342  13.42688 248.7583 301.3082
331 273.2547  13.09595 247.6643 299.9903
332 260.3203  12.78401 234.6560 286.1826
333 267.8279  12.42254 244.1963 292.3338
334 244.6613  12.25708 220.0064 268.9544
335 250.4743  13.17574 225.1281 276.6308
337 286.0455  13.05104 260.4444 311.7526
349 227.0101  12.64477 201.7913 250.5549
350 238.7520  13.38109 211.1431 263.9513
351 255.9002  12.30884 231.8358 280.4710
352 271.7977  12.46478 247.6863 297.0214
369 254.8447  12.23834 230.8434 278.5012
370 226.8129  13.28181 200.9198 251.8934
371 252.1282  12.46977 227.7154 276.2930
372 263.6986  12.53807 239.2533 287.9519

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6121325  2.449007 14.88421048 24.478311
309  1.8169658  2.476907 -3.05481355  6.680177
310  4.9114730  2.532533 -0.04112509 10.096081
330  5.7655151  2.541442  0.72900496 10.784659
331  7.4526628  2.470599  2.56778739 12.108526
332 10.1995525  2.423645  5.48144407 15.012304
333 10.2707465  2.351491  5.72217457 14.789108
334 11.4645639  2.346854  6.86294743 16.083324
335 -0.1695564  2.517252 -5.09216594  4.690268
337 19.1784532  2.487442 14.17987076 24.145944
349 11.5377740  2.393732  6.88273957 16.322789
350 17.0001750  2.519950 12.20861565 21.963412
351  7.4627416  2.379090  2.76433679 12.027512
352 14.0684551  2.344841  9.34079153 18.605554
369 11.3271073  2.327987  6.86253262 16.001617
370 15.1092779  2.568752 10.08944828 20.187608
371  9.5028430  2.339382  4.99941314 14.160997
372 11.7185072  2.374813  7.08118640 16.373829</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.1047 12.926031 228.0999 279.4474
  [2,] 273.7168 11.078993 251.5829 295.1534
  [3,] 293.3289  9.507952 274.2904 312.0132
  [4,] 312.9411  8.369796 296.5448 329.4502
  [5,] 332.5532  7.855005 316.9801 347.9226
  [6,] 352.1653  8.083562 336.2365 368.1387
  [7,] 371.7775  8.999006 353.3869 389.3009
  [8,] 391.3896 10.421877 370.4477 411.2398
  [9,] 411.0017 12.175557 386.6213 434.5388
 [10,] 430.6139 14.137473 402.4919 457.7674
 [11,] 211.3392 13.081830 185.6760 236.5875
 [12,] 213.1561 11.195272 191.4037 234.4362
 [13,] 214.9731  9.581446 196.3467 233.0684
 [14,] 216.7901  8.399060 200.5545 232.4641
 [15,] 218.6070  7.845664 203.4398 233.7883
 [16,] 220.4240  8.052006 204.9422 236.4858
 [17,] 222.2410  8.965785 205.0964 239.9806
 [18,] 224.0579 10.402208 203.8938 244.5357
 [19,] 225.8749 12.177713 202.3688 249.3664
 [20,] 227.6919 14.165366 200.3078 255.7058
 [21,] 212.9842 13.560075 185.8733 238.8371
 [22,] 217.8956 11.619932 194.8954 240.0593
 [23,] 222.8071  9.949747 202.8744 242.0400
 [24,] 227.7186  8.706294 209.9241 244.3112
 [25,] 232.6300  8.088825 216.2441 248.4085
 [26,] 237.5415  8.239300 221.3294 253.5933
 [27,] 242.4530  9.119785 224.4474 260.2421
 [28,] 247.3645 10.549044 226.8129 267.7525
 [29,] 252.2759 12.337813 227.9231 276.7181
 [30,] 257.1874 14.352295 228.6139 285.5614
 [31,] 274.5342 13.426876 248.7583 301.3082
 [32,] 280.2997 11.493002 258.0054 303.1948
 [33,] 286.0652  9.839463 266.6333 305.4535
 [34,] 291.8307  8.628952 274.7860 308.9230
 [35,] 297.5962  8.063526 281.8793 313.3731
 [36,] 303.3617  8.276470 286.8482 319.6379
 [37,] 309.1273  9.213973 291.3387 327.0373
 [38,] 314.8928 10.687025 294.1084 335.8904
 [39,] 320.6583 12.507820 296.6822 344.8788
 [40,] 326.4238 14.546356 297.9658 354.8917
 [41,] 273.2547 13.095955 247.6643 299.9903
 [42,] 280.7074 11.239685 259.2172 303.6840
 [43,] 288.1601  9.662543 269.5906 307.5612
 [44,] 295.6127  8.520954 279.0494 312.5440
 [45,] 303.0654  8.003518 287.8451 319.0316
 [46,] 310.5181  8.228830 294.7005 327.0334
 [47,] 317.9707  9.142140 300.0010 335.8085
 [48,] 325.4234 10.566527 304.5522 345.8613
 [49,] 332.8760 12.326070 308.5341 356.9831
 [50,] 340.3287 14.297560 311.6941 368.4508
 [51,] 260.3203 12.784009 234.6560 286.1826
 [52,] 270.5199 11.002703 248.7708 292.4249
 [53,] 280.7194  9.509793 261.7923 299.3704
 [54,] 290.9190  8.459371 273.7566 307.5563
 [55,] 301.1185  8.027071 285.0622 316.8764
 [56,] 311.3181  8.309928 295.1757 327.7381
 [57,] 321.5176  9.242513 303.5892 339.9153
 [58,] 331.7172 10.655576 310.9078 352.7041
 [59,] 341.9167 12.385744 318.2441 366.5993
 [60,] 352.1163 14.318525 324.8188 380.4864
 [61,] 267.8279 12.422540 244.1963 292.3338
 [62,] 278.0987 10.699642 257.4999 299.1488
 [63,] 288.3694  9.257656 270.5418 306.8327
 [64,] 298.6402  8.245305 282.7774 314.6435
 [65,] 308.9109  7.831024 293.6287 324.0513
 [66,] 319.1817  8.107024 303.2885 334.9348
 [67,] 329.4524  9.010092 311.8267 347.2082
 [68,] 339.7232 10.377797 319.2969 360.4913
 [69,] 349.9939 12.052992 326.4009 373.7228
 [70,] 360.2647 13.925142 333.0700 387.7915
 [71,] 244.6613 12.257082 220.0064 268.9544
 [72,] 256.1258 10.560096 235.0065 277.4251
 [73,] 267.5904  9.154816 249.4446 286.1473
 [74,] 279.0549  8.192749 263.1628 295.6261
 [75,] 290.5195  7.838817 275.2492 306.2948
 [76,] 301.9841  8.172418 285.7315 318.0902
 [77,] 313.4486  9.118401 295.8579 331.2766
 [78,] 324.9132 10.512729 304.1318 345.3447
 [79,] 336.3778 12.202671 312.1210 360.2674
 [80,] 347.8423 14.082199 320.4621 375.5612
 [81,] 250.4743 13.175737 225.1281 276.6308
 [82,] 250.3048 11.236489 228.5341 272.8792
 [83,] 250.1352  9.570288 231.5703 268.8384
 [84,] 249.9657  8.342378 233.8412 266.5312
 [85,] 249.7961  7.763585 234.7827 264.8053
 [86,] 249.6265  7.976486 233.9236 264.9161
 [87,] 249.4570  8.924602 231.8056 267.0544
 [88,] 249.2874 10.408930 228.6350 270.0356
 [89,] 249.1179 12.235858 224.9555 273.5380
 [90,] 248.9483 14.274444 220.8106 277.3493
 [91,] 286.0455 13.051043 260.4444 311.7526
 [92,] 305.2239 11.179090 283.6055 327.2857
 [93,] 324.4024  9.591095 305.8850 343.5721
 [94,] 343.5808  8.448721 327.0921 360.0529
 [95,] 362.7593  7.946533 347.1783 378.3445
 [96,] 381.9377  8.202965 365.4319 398.0030
 [97,] 401.1162  9.154486 382.9080 419.3160
 [98,] 420.2947 10.615805 399.1307 441.1077
 [99,] 439.4731 12.408092 414.9101 463.5402
[100,] 458.6516 14.408363 430.0077 486.9489
[101,] 227.0101 12.644765 201.7913 250.5549
[102,] 238.5478 10.880832 216.9300 258.7764
[103,] 250.0856  9.399724 231.6288 268.3365
[104,] 261.6234  8.353264 245.3045 278.1525
[105,] 273.1612  7.915752 257.6270 288.7204
[106,] 284.6989  8.185423 268.8976 300.8412
[107,] 296.2367  9.099619 278.3510 314.1874
[108,] 307.7745 10.491181 287.0271 328.3421
[109,] 319.3123 12.197812 295.2054 343.6503
[110,] 330.8500 14.105610 302.7394 358.6896
[111,] 238.7520 13.381089 211.1431 263.9513
[112,] 255.7522 11.456980 232.3441 277.8286
[113,] 272.7524  9.806708 253.3360 292.0496
[114,] 289.7526  8.589585 272.9943 306.8347
[115,] 306.7527  8.005668 290.9769 322.7012
[116,] 323.7529  8.191505 307.6749 339.5709
[117,] 340.7531  9.100060 322.7594 358.0262
[118,] 357.7533 10.546171 337.1501 377.7957
[119,] 374.7534 12.342311 350.3513 398.3231
[120,] 391.7536 14.357712 362.9880 419.0709
[121,] 255.9002 12.308836 231.8358 280.4710
[122,] 263.3629 10.580323 242.7256 284.3703
[123,] 270.8257  9.148724 253.2476 288.6497
[124,] 278.2884  8.171610 262.7907 293.8255
[125,] 285.7512  7.821215 270.7838 301.0829
[126,] 293.2139  8.178492 277.4338 309.3300
[127,] 300.6766  9.161015 282.8940 318.6777
[128,] 308.1394 10.596263 287.5020 329.0097
[129,] 315.6021 12.327105 291.0079 339.8793
[130,] 323.0649 14.246206 294.7438 351.0369
[131,] 271.7977 12.464782 247.6863 297.0214
[132,] 285.8661 10.743587 265.1177 307.8503
[133,] 299.9346  9.299200 281.7872 319.0492
[134,] 314.0030  8.277809 297.7736 330.8118
[135,] 328.0715  7.846380 312.6890 343.2203
[136,] 342.1399  8.099741 326.0052 357.6442
[137,] 356.2084  8.980117 338.6135 373.1970
[138,] 370.2768 10.328395 349.9300 389.6661
[139,] 384.3453 11.987725 360.7254 407.2920
[140,] 398.4138 13.846729 371.1266 425.0612
[141,] 254.8447 12.238340 230.8434 278.5012
[142,] 266.1718 10.526697 245.4530 286.6537
[143,] 277.4989  9.093117 259.6091 294.6644
[144,] 288.8260  8.086857 272.6474 304.6850
[145,] 300.1531  7.677811 284.9316 315.5084
[146,] 311.4802  7.958602 295.7780 327.5868
[147,] 322.8073  8.863913 305.6592 340.3081
[148,] 334.1344 10.229252 314.1988 354.4300
[149,] 345.4615 11.897281 322.3449 369.2939
[150,] 356.7887 13.758344 330.0472 384.4127
[151,] 226.8129 13.281811 200.9198 251.8934
[152,] 241.9221 11.321558 219.6254 263.4738
[153,] 257.0314  9.651208 238.0772 275.1996
[154,] 272.1407  8.444579 255.5130 288.1090
[155,] 287.2500  7.916628 271.6805 302.1783
[156,] 302.3592  8.199516 286.1333 317.7270
[157,] 317.4685  9.218898 299.2510 335.5166
[158,] 332.5778 10.767594 310.8530 353.7517
[159,] 347.6871 12.652710 322.1082 372.3181
[160,] 362.7964 14.745780 332.4622 391.3200
[161,] 252.1282 12.469774 227.7154 276.2930
[162,] 261.6310 10.780264 240.6088 282.8406
[163,] 271.1339  9.374344 252.4680 289.4777
[164,] 280.6367  8.395712 263.6535 297.1641
[165,] 290.1396  8.002689 274.4986 306.0587
[166,] 299.6424  8.279101 283.7159 316.0131
[167,] 309.1452  9.164573 291.3591 326.8461
[168,] 318.6481 10.506222 298.1138 339.0468
[169,] 328.1509 12.153906 304.1977 351.4894
[170,] 337.6538 13.999984 310.2327 364.9008
[171,] 263.6986 12.538070 239.2533 287.9519
[172,] 275.4171 10.791300 254.3178 296.1066
[173,] 287.1356  9.326337 268.5446 305.4178
[174,] 298.8541  8.293880 282.1627 314.8678
[175,] 310.5726  7.866118 295.0186 325.7556
[176,] 322.2911  8.138958 306.1552 338.3152
[177,] 334.0097  9.049250 316.1376 351.4396
[178,] 345.7282 10.431428 325.8352 366.1029
[179,] 357.4467 12.125177 334.4793 381.1983
[180,] 369.1652 14.018011 342.2321 397.0100</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.5446793 12.926031  -29.8873845  21.4601193
  [2,]  -15.0121118 11.078993  -36.4487372   7.1218193
  [3,]  -42.5283444  9.507952  -61.2126282 -23.4898139
  [4,]    8.4987231  8.369796   -8.0103618  24.8949936
  [5,]   24.2986906  7.855005    8.9293029  39.8717967
  [6,]   62.5247580  8.083562   46.5513886  78.4536469
  [7,]   10.4263255  8.999006   -7.0970703  28.8168886
  [8,] -101.2410070 10.421877 -121.0912059 -80.2991418
  [9,]   19.5835604 12.175557   -3.9534930  43.9640164
 [10,]   35.7396279 14.137473    8.5861247  63.8615603
 [11,]   11.3947332 13.081830  -13.8535649  37.0579394
 [12,]   -7.8903326 11.195272  -29.1704006  13.8620766
 [13,]  -11.9952983  9.581446  -30.0905910   6.6311298
 [14,]  -12.0830641  8.399060  -27.7570744   4.1525448
 [15,]  -10.8909299  7.845664  -26.0722245   4.2762839
 [16,]   -4.4621957  8.052006  -20.5240285  11.0196120
 [17,]   -8.6106614  8.965785  -26.3503278   8.5339059
 [18,]   -6.3307272 10.402208  -26.8085367  13.8334197
 [19,]   -1.5791930 12.177713  -25.0707446  21.9268891
 [20,]    9.6223412 14.165366  -18.3915567  37.0063650
 [21,]  -13.9302522 13.560075  -39.7832232  13.1805962
 [22,]  -23.5634251 11.619932  -45.7270662  -0.5631678
 [23,]   11.5129019  9.949747   -7.7199689  31.4456258
 [24,]    5.1230290  8.706294  -11.4695928  22.9175038
 [25,]   -3.3226440  8.088825  -19.1010904  13.0633196
 [26,]  -17.0836169  8.239300  -33.1353564  -0.8715114
 [27,]   -7.0321899  9.119785  -24.8213012  10.9733703
 [28,]    8.3866372 10.549044  -12.0013808  28.9381542
 [29,]    8.7365642 12.337813  -15.7055640  33.0893721
 [30,]   -9.6721088 14.352295  -38.0461108  18.9013719
 [31,]   47.0084396 13.426876   20.2344398  72.7843342
 [32,]   20.1005245 11.493002   -2.7945629  42.3947976
 [33,]   -2.2086906  9.839463  -21.5970474  17.2231665
 [34,]   -6.6977057  8.628952  -23.7900397  10.3470143
 [35,]  -11.7989208  8.063526  -27.5758411   3.9180279
 [36,]   -5.7762358  8.276470  -22.0523900  10.7373261
 [37,]  -28.8876509  9.213973  -46.7977098 -11.0991486
 [38,]    3.3685340 10.687025  -17.6291106  24.1529282
 [39,]  -15.3087811 12.507820  -39.5292737   8.6672590
 [40,]   27.6249038 14.546356   -0.8429975  56.0829427
 [41,]   14.3531566 13.095955  -12.3823815  39.9435582
 [42,]    4.2925938 11.239685  -18.6839702  25.7827879
 [43,]   13.6605310  9.662543   -5.7405578  32.2299899
 [44,]   24.5025682  8.520954    7.5712704  41.0658994
 [45,]   13.2119054  8.003518   -2.7542730  28.4322491
 [46,]  -17.1993574  8.228830  -33.7146545  -1.3818111
 [47,]  -27.8957201  9.142140  -45.7334893  -9.9259888
 [48,]    9.3943171 10.566527  -11.0436332  30.2655115
 [49,]  -39.1291457 12.326070  -63.2362092 -14.7871966
 [50,]   31.2523915 14.297560    3.1302834  59.8869888
 [51,]  -25.4597232 12.784009  -51.3220058   0.2045734
 [52,]  -27.7080757 11.002703  -49.6131456  -5.9589815
 [53,]   -7.7581281  9.509793  -26.4090966  11.1689624
 [54,]   18.8498194  8.459371    2.2125468  36.0122118
 [55,]   16.3443669  8.027071    0.5865276  32.4006600
 [56,]   -1.3204856  8.309928  -17.7404864  14.8219078
 [57,]  132.6442619  9.242513  114.2465797 150.5727066
 [58,]   15.1139094 10.655576   -5.8729992  35.9233197
 [59,]  -11.6164431 12.385744  -36.2989760  12.0562093
 [60,]  -98.2518955 14.318525 -126.6219770 -70.9543921
 [61,]   16.0144537 12.422540   -8.4914107  39.6460802
 [62,]   11.4563072 10.699642   -9.5938315  32.0550770
 [63,]  -11.6001393  9.257656  -30.0633608   6.2275423
 [64,]    1.1695143  8.245305  -14.8337976  17.0323467
 [65,]  -11.7399322  7.831024  -26.8802827   3.5423403
 [66,]   18.9848213  8.107024    3.2317316  34.8779834
 [67,]    2.5740748  9.010092  -15.1816761  20.1997671
 [68,]    9.1167283 10.377797  -11.6513533  29.5429844
 [69,]  -16.6339181 12.052992  -40.3628436   6.9591421
 [70,]    1.7781354 13.925142  -25.7486637  28.9728040
 [71,]   20.8118481 12.257082   -3.4812549  45.4667236
 [72,]   20.0753842 10.560096   -1.2238535  41.1946746
 [73,]  -24.2256796  9.154816  -42.7826079  -6.0799412
 [74,]  -24.3826435  8.192749  -40.9538449  -8.4905276
 [75,]  -11.4951073  7.838817  -27.2704330   3.7752069
 [76,]  -17.7928712  8.172418  -33.8989609  -1.5403496
 [77,]   -7.9238350  9.118401  -25.7518460   9.6668648
 [78,]    6.6097011 10.512729  -13.8217613  27.3910794
 [79,]   -0.6308627 12.202671  -24.5204504  23.6259167
 [80,]   29.4566734 14.082199    1.7377801  56.8369021
 [81,]   -8.8660237 13.175737  -35.0225183  16.4801723
 [82,]   23.6424327 11.236489    1.0680356  45.4130988
 [83,]    4.3554891  9.570288  -14.3477044  22.9203844
 [84,]   20.8364455  8.342378    4.2708590  36.9608836
 [85,]    1.6558019  7.763585  -13.3533918  16.6692326
 [86,]    5.0096583  7.976486  -10.2798819  20.7126177
 [87,]   -4.0046853  8.924602  -21.6021299  13.6467324
 [88,]  -13.9764289 10.408930  -34.7246204   6.6760074
 [89,]  -13.3637725 12.235858  -37.7839009  10.7986267
 [90,]  -11.7017161 14.274444  -40.1026659  16.4359729
 [91,]   26.3211197 13.051043    0.6139936  51.9222209
 [92,]    8.5818666 11.179090  -13.4798603  30.2003452
 [93,]  -32.7911866  9.591095  -51.9608887 -14.2738400
 [94,]    2.5413602  8.448721  -13.9306545  19.0300934
 [95,]    2.9731070  7.946533  -12.6120780  18.5540917
 [96,]    9.9007538  8.202965   -6.1645098  26.4066423
 [97,]    3.1439006  9.154486  -15.0558610  21.3521292
 [98,]   -3.6023525 10.615805  -24.4153679  17.5615605
 [99,]   16.3911943 12.408092   -7.6758784  40.9542237
[100,]    0.2651411 14.408363  -28.0322484  28.9089685
[101,]    9.0931338 12.644765  -14.4516664  34.3118587
[102,]   -8.2311402 10.880832  -28.4596591  13.3867406
[103,]  -11.1600142  9.399724  -29.4108891   7.2968350
[104,]   -6.7013882  8.353264  -23.2304823   9.6175041
[105,]  -22.4508622  7.915752  -38.0100821  -6.9167264
[106,]  -14.9245362  8.185423  -31.0667520   0.8767975
[107,]  -14.6719102  9.099619  -32.6225822   3.2138281
[108,]    0.3275158 10.491181  -20.2400813  21.0749179
[109,]   16.9683418 12.197812   -7.3696598  41.0751788
[110,]   20.7950678 14.105610   -7.0445045  48.9056641
[111,]   17.5447558 13.381089   -7.6545090  45.1536589
[112,]  -12.2979193 11.456980  -34.3742847  11.1102117
[113,]  -16.5477943  9.806708  -35.8449823   2.8686333
[114,]  -34.2254693  8.589585  -51.3076253 -17.4672429
[115,]  -37.8362444  8.005668  -53.7846797 -22.0603564
[116,]    5.9717806  8.191505   -9.8461757  22.0497710
[117,]   38.6914056  9.100060   21.4183073  56.6851373
[118,]    5.1651305 10.546171  -14.8773319  25.7683278
[119,]   19.7337555 12.342311   -3.8358561  44.1359078
[120,]   -2.7009195 14.357712  -30.0182377  26.0647365
[121,]   -5.3736901 12.308836  -29.9444649  18.6907243
[122,]   36.6946683 10.580323   15.6873384  57.3320073
[123,]   -0.9317733  9.148724  -18.7558457  16.6462877
[124,]    2.3006851  8.171610  -13.2363580  17.7984286
[125,]  -13.9237565  7.821215  -29.2555343   1.0435952
[126,]   11.4197018  8.178492   -4.6964161  27.1997609
[127,]  -12.9300398  9.161015  -30.9311273   4.8525623
[128,]  -41.5438814 10.596263  -62.4141959 -20.9065144
[129,]    5.9396770 12.327105  -18.3374546  30.5338914
[130,]   24.5006354 14.246206   -3.4713923  52.8216531
[131,]  -50.1205624 12.464782  -75.3443115 -26.0092350
[132,]   12.3277825 10.743587   -9.6564154  33.0761993
[133,]   26.9439273  9.299200    7.8292819  45.0913496
[134,]   32.8524722  8.277809   16.0436824  49.0818755
[135,]   20.6687170  7.846380    5.5199146  36.0511983
[136,]   10.6887619  8.099741   -4.8154534  26.8235223
[137,]   -1.7817933  8.980117  -18.7703543  15.8131116
[138,]   -9.8442484 10.328395  -29.2335279  10.5025948
[139,]   -8.7047036 11.987725  -31.6514438  14.9152219
[140,]   -9.8720587 13.846729  -36.5195425  17.4150520
[141,]   17.0788117 12.238340   -6.5776766  41.0800775
[142,]    2.2651044 10.526697  -18.2167710  22.9838553
[143,]  -20.2565030  9.093117  -37.4220318  -2.3666756
[144,]  -11.1694103  8.086857  -27.0284098   5.0092098
[145,]   14.6690823  7.677811   -0.6862184  29.8905654
[146,]    5.7332750  7.958602  -10.3733368  21.4355065
[147,]  -24.6720324  8.863913  -42.1728286  -7.5238723
[148,]   13.9884603 10.229252   -6.3070859  33.9241029
[149,]   -5.1815471 11.897281  -29.0139158  17.9350660
[150,]    9.7244456 13.758344  -17.8996353  36.4658565
[151,]   -1.5488547 13.281811  -26.6294132  24.3442155
[152,]   -7.3986326 11.321558  -28.9503033  14.8981103
[153,]  -18.1306105  9.651208  -36.2988493   0.8235955
[154,]  -31.6676884  8.444579  -47.6360194 -15.0400287
[155,]  -19.7126663  7.916628  -34.6409823  -4.1432387
[156,]   41.8344558  8.199516   26.4667256  58.0603921
[157,]  -36.3204221  9.218898  -54.3685196 -18.1028733
[158,]   15.0077000 10.767594   -6.1661570  36.7325235
[159,]   17.4759221 12.652710   -7.1550920  43.0547807
[160,]    9.4324442 14.745780  -19.0911748  39.7665597
[161,]   17.7522106 12.469774   -6.4125560  42.1649721
[162,]   10.8117676 10.780264  -10.3978232  31.8339593
[163,]    6.7650246  9.374344  -11.5788019  25.4308579
[164,]    1.1527816  8.395712  -15.3745907  18.1360196
[165,]  -10.9690614  8.002689  -26.8881855   4.6719247
[166,]  -15.1304044  8.279101  -31.5010543   0.7961207
[167,]  -49.8794474  9.164573  -67.5802577 -32.0932667
[168,]  -14.0174904 10.506222  -34.4161595   6.5167540
[169,]   22.6297666 12.153906   -0.7086954  46.5830491
[170,]   31.8154236 13.999984    4.5684196  59.2364658
[171,]    5.7130873 12.538070  -18.5402157  30.1584143
[172,]   -1.9431199 10.791300  -22.6326410  19.1561655
[173,]   10.4611728  9.326337   -7.8210036  29.0522246
[174,]   11.7774656  8.293880   -4.2362154  28.4688812
[175,]  -23.4000416  7.866118  -38.5829623  -7.8459668
[176,]    7.3164512  8.138958   -8.7076487  23.4524205
[177,]    0.4721439  9.049250  -16.9577767  18.3442170
[178,]   -2.5082633 10.431428  -22.8830211  17.3847145
[179,]   11.6950295 12.125177  -12.0565705  34.6624148
[180,]   -5.0415778 14.018011  -32.8863576  21.8914526</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1770.0 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   506       
 (0.5, 0.7]   (ok)         2    1.1%   105       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.6
p_loo        34.6  8.8
looic      1723.2 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   807       
 (0.5, 0.7]   (ok)         2    1.1%   776       
   (0.7, 1]   (bad)        3    1.7%   25        
   (1, Inf)   (very bad)   1    0.6%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.4      11.8  
fit_sleep1 -91.6      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1770.0 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   506       
 (0.5, 0.7]   (ok)         2    1.1%   105       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.6
p_loo        34.6  8.8
looic      1723.2 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   807       
 (0.5, 0.7]   (ok)         2    1.1%   776       
   (0.7, 1]   (bad)        3    1.7%   25        
   (1, Inf)   (very bad)   1    0.6%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.6     22.6        34.6    8.8   1723.2
fit_sleep2  -23.4      11.8  -885.0     14.4        19.5    3.4   1770.0
fit_sleep1  -91.6      21.2  -953.2     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   45.2  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.575776e-40 6.915288e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88      1.57     0.21     5.41       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12      1.57    -3.31     2.88       5.22      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.15      
[4] StanHeaders_2.26.15 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.0         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.9        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
