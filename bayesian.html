<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.93      7.14    15.49    43.74 1.00     1658     2380
sd(Days)                6.55      1.49     4.19     9.97 1.00     1280     2110
cor(Intercept,Days)     0.08      0.29    -0.47     0.65 1.00      943     2040

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.35      7.54   236.50   266.28 1.00     1745     2428
Days         10.39      1.75     6.91    13.74 1.01     1137     1554

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.56    22.99    29.24 1.00     4265     3190

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6170  12.99729 227.5371 278.5861
309 211.3428  13.63846 184.5646 237.1385
310 213.0408  12.95181 187.7971 237.5386
330 274.7011  13.57010 249.3360 302.0536
331 273.1762  13.21434 248.6407 299.5076
332 260.1393  12.29274 236.0363 285.1131
333 268.2029  12.54176 244.8857 293.2387
334 244.2143  12.26816 219.4694 268.6626
335 250.8491  13.27014 224.6187 277.9959
337 285.6911  12.97947 261.2972 311.6339
349 226.7438  12.80475 200.5772 250.3812
350 238.7557  13.29915 212.4968 264.5846
351 255.8543  12.18213 231.8624 279.9951
352 272.1992  12.81618 247.1731 297.4997
369 254.2972  12.44304 229.5562 279.7235
370 226.3544  13.64456 199.3090 252.5426
371 251.9770  12.04684 227.7558 275.2408
372 263.3003  12.39967 239.2398 288.1558

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6954277  2.533558 14.7981722 24.866486
309  1.7797393  2.575040 -3.2279900  6.892358
310  4.9196810  2.428923  0.2062050  9.692602
330  5.6982770  2.521762  0.6279078 10.495484
331  7.4718642  2.509326  2.6725091 12.273781
332 10.2181527  2.359079  5.3818348 14.791587
333 10.1996341  2.373980  5.3878110 14.609588
334 11.5482226  2.334128  6.8977272 16.162843
335 -0.1833504  2.538645 -5.3269035  4.791738
337 19.2367710  2.400462 14.3696468 23.876820
349 11.5708972  2.425707  6.9930042 16.439704
350 17.0257356  2.554938 12.0310824 22.070016
351  7.4569501  2.381481  2.7228771 12.126661
352 14.0290808  2.443924  9.3303315 18.911493
369 11.4161615  2.357292  6.7176990 16.072927
370 15.2212921  2.555028 10.3181702 20.395207
371  9.4839925  2.274290  4.9531651 13.956217
372 11.8115036  2.384653  7.1507671 16.487596</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6170 12.997291 227.5371 278.5861
  [2,] 273.3124 11.066667 250.8601 294.5147
  [3,] 293.0078  9.426053 273.7809 311.2132
  [4,] 312.7033  8.250314 296.2926 328.5979
  [5,] 332.3987  7.753885 317.1563 347.4840
  [6,] 352.0941  8.063225 336.0318 367.8008
  [7,] 371.7895  9.096500 353.5450 389.5904
  [8,] 391.4850 10.644945 370.1403 412.2685
  [9,] 411.1804 12.518835 386.6004 435.4602
 [10,] 430.8758 14.593336 401.8798 459.4253
 [11,] 211.3428 13.638456 184.5646 237.1385
 [12,] 213.1225 11.657364 189.8045 235.3619
 [13,] 214.9022  9.952007 195.1342 234.3447
 [14,] 216.6820  8.686334 199.7047 233.8089
 [15,] 218.4617  8.069946 202.5960 234.3486
 [16,] 220.2415  8.249685 204.1458 237.0191
 [17,] 222.0212  9.178902 204.0426 240.5643
 [18,] 223.8009 10.663435 202.4945 244.9081
 [19,] 225.5807 12.507083 200.5470 250.5162
 [20,] 227.3604 14.574191 198.2652 256.3817
 [21,] 213.0408 12.951811 187.7971 237.5386
 [22,] 217.9604 11.186377 196.1950 239.2910
 [23,] 222.8801  9.711848 204.0372 241.4691
 [24,] 227.7998  8.677803 210.6952 244.4066
 [25,] 232.7195  8.251538 216.3061 248.3183
 [26,] 237.6392  8.524719 220.6013 254.2325
 [27,] 242.5588  9.436795 223.8530 260.8180
 [28,] 247.4785 10.827498 225.7278 268.1801
 [29,] 252.3982 12.538567 227.3671 276.6848
 [30,] 257.3179 14.456691 228.6234 285.4294
 [31,] 274.7011 13.570100 249.3360 302.0536
 [32,] 280.3994 11.618135 258.3821 303.9934
 [33,] 286.0976  9.926382 267.2758 306.2188
 [34,] 291.7959  8.648910 275.2640 309.9297
 [35,] 297.4942  7.987039 282.1327 313.7514
 [36,] 303.1925  8.093239 287.4548 319.2278
 [37,] 308.8907  8.940180 291.4466 327.0236
 [38,] 314.5890 10.347544 294.0052 335.2662
 [39,] 320.2873 12.121679 295.9400 344.1778
 [40,] 325.9856 14.125053 297.2516 353.7338
 [41,] 273.1762 13.214337 248.6407 299.5076
 [42,] 280.6480 11.296648 260.0527 303.2416
 [43,] 288.1199  9.654184 270.4223 307.5728
 [44,] 295.5918  8.449005 279.5890 312.5781
 [45,] 303.0636  7.884260 288.1008 318.7288
 [46,] 310.5355  8.095113 294.7054 326.3107
 [47,] 318.0074  9.027379 300.3563 335.4729
 [48,] 325.4792 10.490460 305.2034 345.6204
 [49,] 332.9511 12.296314 309.5063 356.2740
 [50,] 340.4230 14.315809 313.2042 367.4565
 [51,] 260.1393 12.292743 236.0363 285.1131
 [52,] 270.3575 10.551620 249.7299 291.4848
 [53,] 280.5756  9.093533 263.0339 298.3366
 [54,] 290.7938  8.073321 275.1900 306.7756
 [55,] 301.0119  7.667803 285.9452 316.1559
 [56,] 311.2301  7.971349 295.1117 326.7071
 [57,] 321.4482  8.911796 303.4410 338.6540
 [58,] 331.6664 10.316411 310.2340 351.8397
 [59,] 341.8846 12.023604 316.9092 365.5613
 [60,] 352.1027 13.922510 323.2268 379.2508
 [61,] 268.2029 12.541757 244.8857 293.2387
 [62,] 278.4025 10.783879 258.1135 300.0170
 [63,] 288.6022  9.303761 270.8073 307.0858
 [64,] 298.8018  8.252241 282.6339 314.9584
 [65,] 309.0014  7.804522 293.7398 324.3672
 [66,] 319.2011  8.061836 303.7761 335.0775
 [67,] 329.4007  8.963671 311.8632 346.7001
 [68,] 339.6003 10.342784 319.5245 359.3835
 [69,] 349.8000 12.036217 326.2839 373.1197
 [70,] 359.9996 13.929804 332.8912 386.9899
 [71,] 244.2143 12.268163 219.4694 268.6626
 [72,] 255.7626 10.579354 235.0171 276.9947
 [73,] 267.3108  9.177904 249.2279 285.3399
 [74,] 278.8590  8.212274 262.8096 294.9010
 [75,] 290.4072  7.845078 274.9799 305.6878
 [76,] 301.9555  8.157535 286.0715 317.5814
 [77,] 313.5037  9.079746 295.7924 331.1047
 [78,] 325.0519 10.451532 304.3177 345.7522
 [79,] 336.6001 12.121203 312.7304 360.5465
 [80,] 348.1483 13.982450 321.1688 375.6526
 [81,] 250.8491 13.270145 224.6187 277.9959
 [82,] 250.6658 11.324965 228.4444 273.9653
 [83,] 250.4824  9.659315 231.6763 270.2237
 [84,] 250.2991  8.440339 233.7295 267.3954
 [85,] 250.1157  7.878181 234.5814 265.6853
 [86,] 249.9324  8.110585 233.9798 265.7357
 [87,] 249.7490  9.076722 232.0876 267.6421
 [88,] 249.5657 10.577410 229.0964 270.2868
 [89,] 249.3823 12.420377 225.5125 273.6030
 [90,] 249.1990 14.475475 221.0193 277.5675
 [91,] 285.6911 12.979471 261.2972 311.6339
 [92,] 304.9279 11.210531 284.1372 327.2730
 [93,] 324.1647  9.716470 305.6379 343.2239
 [94,] 343.4014  8.641065 326.4316 360.1627
 [95,] 362.6382  8.151727 346.8464 378.4627
 [96,] 381.8750  8.352110 365.2925 398.0706
 [97,] 401.1117  9.197242 382.5825 418.9472
 [98,] 420.3485 10.533053 399.5566 440.6852
 [99,] 439.5853 12.199410 415.6242 463.1656
[100,] 458.8221 14.079432 431.0710 485.8667
[101,] 226.7438 12.804753 200.5772 250.3812
[102,] 238.3147 10.979738 215.8590 258.4776
[103,] 249.8856  9.429512 230.6705 267.5190
[104,] 261.4565  8.309323 244.9549 277.1502
[105,] 273.0274  7.806544 257.5718 287.8670
[106,] 284.5983  8.037880 268.9447 300.1404
[107,] 296.1692  8.946564 278.8997 313.4165
[108,] 307.7401 10.355800 287.6268 328.0549
[109,] 319.3110 12.091828 295.9074 342.8553
[110,] 330.8819 14.033892 303.5522 358.5217
[111,] 238.7557 13.299154 212.4968 264.5846
[112,] 255.7814 11.357684 233.0897 277.7842
[113,] 272.8071  9.704735 253.5233 291.7982
[114,] 289.8329  8.510124 273.2570 306.5215
[115,] 306.8586  7.982351 291.2474 322.6905
[116,] 323.8843  8.250399 307.4690 340.2198
[117,] 340.9101  9.245303 322.2568 359.1204
[118,] 357.9358 10.767432 336.7547 378.5353
[119,] 374.9616 12.627549 350.0780 399.4328
[120,] 391.9873 14.697884 363.0811 419.9510
[121,] 255.8543 12.182130 231.8624 279.9951
[122,] 263.3113 10.468565 242.5152 284.0148
[123,] 270.7682  9.062027 252.9777 288.9180
[124,] 278.2252  8.123590 262.4365 294.3052
[125,] 285.6821  7.823554 270.3367 301.1788
[126,] 293.1391  8.232021 276.9797 309.6416
[127,] 300.5960  9.255661 282.7932 318.8440
[128,] 308.0530 10.719666 287.2789 329.1483
[129,] 315.5099 12.469888 291.0862 339.9543
[130,] 322.9669 14.402357 294.5969 350.9980
[131,] 272.1992 12.816178 247.1731 297.4997
[132,] 286.2283 11.020215 264.9189 307.8108
[133,] 300.2573  9.517426 281.5560 318.7115
[134,] 314.2864  8.465412 297.1711 330.1439
[135,] 328.3155  8.043042 312.4486 343.7703
[136,] 342.3446  8.346459 325.7390 358.4626
[137,] 356.3737  9.304932 337.8327 374.2924
[138,] 370.4027 10.744565 349.0137 391.3900
[139,] 384.4318 12.500205 359.3717 408.6020
[140,] 398.4609 14.457182 369.6006 426.7466
[141,] 254.2972 12.443040 229.5562 279.7235
[142,] 265.7134 10.721627 244.4142 287.4424
[143,] 277.1296  9.283908 259.0904 295.6541
[144,] 288.5457  8.279026 272.3103 304.6601
[145,] 299.9619  7.874468 284.6035 315.1573
[146,] 311.3781  8.160017 295.4022 327.0152
[147,] 322.7942  9.070731 304.8470 340.0502
[148,] 334.2104 10.444332 313.1793 353.9200
[149,] 345.6265 12.124506 321.4279 368.3762
[150,] 357.0427 14.001317 329.3864 383.6294
[151,] 226.3544 13.644564 199.3090 252.5426
[152,] 241.5757 11.694652 218.4335 263.9568
[153,] 256.7970 10.020579 237.0635 275.9656
[154,] 272.0182  8.781541 254.7329 288.7420
[155,] 287.2395  8.177729 271.0114 302.8312
[156,] 302.4608  8.348137 285.3515 318.3528
[157,] 317.6821  9.250074 298.8140 335.2323
[158,] 332.9034 10.700125 311.5467 352.9572
[159,] 348.1247 12.509110 323.5096 371.6024
[160,] 363.3460 14.543704 335.2204 390.9659
[161,] 251.9770 12.046843 227.7558 275.2408
[162,] 261.4610 10.437048 240.3994 281.5178
[163,] 270.9450  9.114950 252.3857 288.3349
[164,] 280.4290  8.220549 264.0949 296.4424
[165,] 289.9130  7.900464 274.4086 305.2715
[166,] 299.3970  8.222046 283.0199 315.4279
[167,] 308.8810  9.117649 290.8994 327.0017
[168,] 318.3650 10.440584 298.2537 338.7110
[169,] 327.8490 12.050927 304.5170 351.6508
[170,] 337.3329 13.848779 310.6562 364.6443
[171,] 263.3003 12.399670 239.2398 288.1558
[172,] 275.1118 10.676250 254.1565 296.3785
[173,] 286.9233  9.251269 269.0337 305.5511
[174,] 298.7348  8.280263 282.3760 315.3892
[175,] 310.5463  7.931753 294.8833 325.8376
[176,] 322.3578  8.284671 306.3078 338.6916
[177,] 334.1693  9.259158 316.0828 352.4831
[178,] 345.9808 10.686504 325.2391 366.8177
[179,] 357.7923 12.411441 333.1704 382.1928
[180,] 369.6038 14.326881 341.1411 397.5303</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.05697329 12.997291  -29.02608164  22.0229025
  [2,]  -14.60770103 11.066667  -35.80998191   7.8446046
  [3,]  -42.20722878  9.426053  -60.41262884 -22.9803108
  [4,]    8.73654348  8.250314   -7.15810836  25.1472395
  [5,]   24.45321573  7.753885    9.36786553  39.6955924
  [6,]   62.59598799  8.063225   46.88929882  78.6582596
  [7,]   10.41426024  9.096500   -7.38659629  28.6587826
  [8,] -101.33636750 10.644945 -122.11985107 -79.9917053
  [9,]   19.40490475 12.518835   -4.87493062  43.9849388
 [10,]   35.47767701 14.593336    6.92817249  64.4736548
 [11,]   11.39114432 13.638456  -14.40457313  38.1693106
 [12,]   -7.85669500 11.657364  -30.09613800  15.4613383
 [13,]  -11.92443432  9.952007  -31.36687062   7.8435846
 [14,]  -11.97497364  8.686334  -29.10186752   5.0022599
 [15,]  -10.74561297  8.069946  -26.63247006   5.1201402
 [16,]   -4.27965229  8.249685  -21.05731593  11.8160298
 [17,]   -8.39089161  9.178902  -26.93401543   9.5877463
 [18,]   -6.07373093 10.663435  -27.18085154  15.2326946
 [19,]   -1.28497025 12.507083  -26.22054819  23.7486719
 [20,]    9.95379043 14.574191  -19.06749289  39.0489888
 [21,]  -13.98685363 12.951811  -38.48473162  11.2567576
 [22,]  -23.62823468 11.186377  -44.95881623  -1.8627615
 [23,]   11.43988428  9.711848   -7.14907211  30.2828406
 [24,]    5.04180324  8.677803  -11.56496942  22.1464469
 [25,]   -3.41207781  8.251538  -19.01091512  13.0013081
 [26,]  -17.18125885  8.524719  -33.77457468  -0.1433976
 [27,]   -7.13803989  9.436795  -25.39724407  11.5678423
 [28,]    8.27257906 10.827498  -12.42897326  30.0233268
 [29,]    8.61429802 12.538567  -15.67232477  33.6454226
 [30,]   -9.80258302 14.456691  -37.91410870  18.8919132
 [31,]   46.84151323 13.570100   19.48902598  72.2065883
 [32,]   20.00083620 11.618135   -3.59324181  42.0181164
 [33,]   -2.24114084  9.926382  -22.36225026  16.5806511
 [34,]   -6.66291788  8.648910  -24.79673932   9.8690411
 [35,]  -11.69689491  7.987039  -27.95410809   3.6646149
 [36,]   -5.60697195  8.093239  -21.64225055  10.1306935
 [37,]  -28.65114899  8.940180  -46.78402124 -11.2070170
 [38,]    3.67227398 10.347544  -17.00492225  24.2560638
 [39,]  -14.93780306 12.121679  -38.82828467   9.4095310
 [40,]   28.06311990 14.125053    0.31491058  56.7970747
 [41,]   14.43172040 13.214337  -11.89966846  38.9672158
 [42,]    4.35195616 11.296648  -18.24157347  24.9472635
 [43,]   13.70069192  9.654184   -5.75224948  31.3983326
 [44,]   24.52352768  8.449005    7.53715864  40.5263494
 [45,]   13.21366343  7.884260   -2.45146928  28.1765434
 [46,]  -17.21680081  8.095113  -32.99204170  -1.3866747
 [47,]  -27.93236505  9.027379  -45.39792387 -10.2813483
 [48,]    9.33847071 10.490460  -10.80271295  29.6143146
 [49,]  -39.20419353 12.296314  -62.52714319 -15.7594367
 [50,]   31.15814223 14.315809    4.12455618  58.3768952
 [51,]  -25.27873216 12.292743  -50.25252073  -1.1757078
 [52,]  -27.54568491 10.551620  -48.67303787  -6.9180708
 [53,]   -7.61433765  9.093533  -25.37527428   9.9274266
 [54,]   18.97500960  8.073321    2.99321388  34.5788161
 [55,]   16.45095686  7.667803    1.30699599  31.5176656
 [56,]   -1.23249589  7.971349  -16.70946530  14.8859451
 [57,]  132.71365137  8.911796  115.50791876 150.7208556
 [58,]   15.16469862 10.316411   -5.00864023  36.5970875
 [59,]  -11.58425412 12.023604  -35.26102255  13.3910728
 [60,]  -98.23830687 13.922510 -125.38639315 -69.3624467
 [61,]   15.63949844 12.541757   -9.39629744  38.9566573
 [62,]   11.15246430 10.783879  -10.46203379  31.4414534
 [63,]  -11.83286983  9.303761  -30.31648024   5.9620377
 [64,]    1.00789603  8.252241  -15.14868147  17.1758030
 [65,]  -11.83043811  7.804522  -27.19618163   3.4311808
 [66,]   18.96542775  8.061836    3.08903448  34.3903545
 [67,]    2.62579361  8.963671  -14.67364796  20.1632762
 [68,]    9.23955947 10.342784  -10.54361664  29.3153518
 [69,]  -16.43997467 12.036217  -39.75966030   7.0761001
 [70,]    2.04319120 13.929804  -24.94707383  29.1516302
 [71,]   21.25876140 12.268163   -3.18947796  46.0037069
 [72,]   20.43863882 10.579354   -0.79350950  41.1841209
 [73,]  -23.94608377  9.177904  -41.97521075  -5.8631537
 [74,]  -24.18670635  8.212274  -40.22872886  -8.1372528
 [75,]  -11.38282893  7.845078  -26.66336550   4.0444853
 [76,]  -17.76425152  8.157535  -33.39019978  -1.8803422
 [77,]   -7.97887410  9.079746  -25.57991734   9.7323644
 [78,]    6.47100331 10.451532  -14.22930824  27.2052131
 [79,]   -0.85321927 12.121203  -24.79955281  23.0164652
 [80,]   29.15065815 13.982450    1.64636649  56.1302389
 [81,]   -9.24083551 13.270145  -36.38762521  16.9895833
 [82,]   23.28141488 11.324965   -0.01807026  45.5028166
 [83,]    4.00826528  9.659315  -15.73295688  22.8143644
 [84,]   20.50301567  8.440339    3.40673631  37.0725790
 [85,]    1.33616607  7.878181  -14.23341783  16.8705261
 [86,]    4.70381646  8.110585  -11.09945950  20.6564472
 [87,]   -4.29673314  9.076722  -22.18980550  13.3647123
 [88,]  -14.25468275 10.577410  -34.97579084   6.2145618
 [89,]  -13.62823235 12.420377  -37.84894164  10.2415733
 [90,]  -11.95238196 14.475475  -40.32086596  16.2273364
 [91,]   26.67548020 12.979471    0.73268642  51.0694112
 [92,]    8.87790917 11.210531  -13.46720481  29.6685886
 [93,]  -32.55346186  9.716470  -51.61266171 -14.0266766
 [94,]    2.72076711  8.641065  -14.04047337  19.6906201
 [95,]    3.09419608  8.151727  -12.73030348  18.8860388
 [96,]    9.96352505  8.352110   -6.23208090  26.5460478
 [97,]    3.14835402  9.197242  -14.68709004  21.6775832
 [98,]   -3.65621701 10.533053  -23.99288377  17.1356869
 [99,]   16.27901196 12.199410   -7.30128596  40.2401076
[100,]    0.09464093 14.079432  -26.94996177  27.8457336
[101,]    9.35939951 12.804753  -14.27804296  35.5260491
[102,]   -7.99799773 10.979738  -28.16090683  14.4576770
[103,]  -10.95999497  9.429512  -28.59343966   8.2551472
[104,]   -6.53449221  8.309323  -22.22818176   9.9671457
[105,]  -22.31708945  7.806544  -37.15670442  -6.8614737
[106,]  -14.82388670  8.037880  -30.36599921   0.8296686
[107,]  -14.60438394  8.946564  -31.85171207   2.6650776
[108,]    0.36191882 10.355800  -19.95292602  20.4751917
[109,]   16.96962158 12.091828   -6.57469304  40.3731580
[110,]   20.76322434 14.033892   -6.87655746  48.0928758
[111,]   17.54113276 13.299154   -8.28779864  43.7999905
[112,]  -12.32710286 11.357684  -34.32990450  10.3646047
[113,]  -16.60253849  9.704735  -35.59358138   2.6812797
[114,]  -34.30577411  8.510124  -50.99440295 -17.7298832
[115,]  -37.94210974  7.982351  -53.77395194 -22.3308781
[116,]    5.84035464  8.250399  -10.49508353  22.2556789
[117,]   38.53441901  9.245303   20.32406502  57.1876613
[118,]    4.98258339 10.767432  -15.61694322  26.1636795
[119,]   19.52564776 12.627549   -4.94558030  44.4091636
[120,]   -2.93458786 14.697884  -30.89830282  25.9716013
[121,]   -5.32781104 12.182130  -29.46858523  18.6640773
[122,]   36.74633884 10.468565   16.04283512  57.5423967
[123,]   -0.87431128  9.062027  -19.02409159  16.9161694
[124,]    2.36393860  8.123590  -13.71605420  18.1526255
[125,]  -13.85471152  7.823554  -29.35135722   1.4906613
[126,]   11.49453836  8.232021   -5.00799894  27.6539458
[127,]  -12.84941176  9.255661  -31.09738087   4.9533930
[128,]  -41.45746188 10.719666  -62.55281195 -20.6833791
[129,]    6.03188800 12.469888  -18.41248349  30.4556251
[130,]   24.59863789 14.402357   -3.43248376  52.9685926
[131,]  -50.52207582 12.816178  -75.82264023 -25.4960029
[132,]   11.96564341 11.020215   -9.61687691  33.2749533
[133,]   26.62116264  9.517426    8.16695106  45.3225375
[134,]   32.56908186  8.465412   16.71158119  49.6844322
[135,]   20.42470109  8.043042    4.96988591  36.2916026
[136,]   10.48412032  8.346459   -5.63386581  27.0896820
[137,]   -1.94706045  9.304932  -19.86576689  16.5938520
[138,]   -9.97014122 10.744565  -30.95739238  11.4188662
[139,]   -8.79122199 12.500205  -32.96135445  16.2689396
[140,]   -9.91920276 14.457182  -38.20490341  18.9411020
[141,]   17.62625342 12.443040   -7.80002375  42.3673073
[142,]    2.72349194 10.721627  -19.00554915  24.0226903
[143,]  -19.88716954  9.283908  -38.41168758  -1.8479879
[144,]  -10.88913102  8.279026  -27.00354479   5.3463417
[145,]   14.86030750  7.874468   -0.33512734  30.2186632
[146,]    5.83544603  8.160017   -9.80169155  21.8113026
[147,]  -24.65891545  9.070731  -41.91488746  -6.7116552
[148,]   13.91252307 10.444332   -5.79710797  34.9436081
[149,]   -5.34653841 12.124506  -28.09624903  18.8521496
[150,]    9.47040011 14.001317  -17.11628659  37.1266799
[151,]   -1.09036978 13.644564  -27.27862433  25.9550293
[152,]   -7.05216185 11.694652  -29.43329161  16.0899761
[153,]  -17.89615393 10.020579  -37.06476047   1.8373148
[154,]  -31.54524601  8.781541  -48.26897612 -14.2598505
[155,]  -19.70223809  8.177729  -35.29387706  -3.4740942
[156,]   41.73286984  8.348137   25.84088970  58.8422001
[157,]  -36.53402224  9.250074  -54.08417826 -17.6658623
[158,]   14.68208568 10.700125   -5.37172544  36.0388106
[159,]   17.03829361 12.509110   -6.43938698  41.6533759
[160,]    8.88280153 14.543704  -18.73709489  37.0083951
[161,]   17.90338339 12.046843   -5.36042631  42.1245588
[162,]   10.98179089 10.437048   -9.07502612  32.0433638
[163,]    6.95389840  9.114950  -10.43600759  25.5131538
[164,]    1.36050590  8.220549  -14.65294987  17.6945882
[165,]  -10.74248660  7.900464  -26.10096252   4.7618730
[166,]  -14.88497910  8.222046  -30.91591256   1.4920713
[167,]  -49.61517160  9.117649  -67.73591446 -31.6336415
[168,]  -13.73436410 10.440584  -34.08038617   6.3768502
[169,]   22.93174340 12.050927   -0.87007789  46.2636507
[170,]   32.13625091 13.848779    4.82493813  58.8129650
[171,]    6.11140713 12.399670  -18.74406257  30.1718603
[172,]   -1.63779646 10.676250  -22.90454438  19.3175460
[173,]   10.67349996  9.251269   -7.95434494  28.5630829
[174,]   11.89679637  8.280263   -4.75755518  28.2556118
[175,]  -23.37370722  7.931753  -38.66496637  -7.7107350
[176,]    7.24978919  8.284671   -9.08404440  23.2997554
[177,]    0.31248561  9.259158  -18.00132539  18.3990015
[178,]   -2.76091798 10.686504  -23.59783722  17.9807655
[179,]   11.34937843 12.411441  -13.05107563  35.9713322
[180,]   -5.48022515 14.326881  -33.40666723  22.9824806</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.9 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1770.0 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   625       
 (0.5, 0.7]   (ok)         2    1.1%   156       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.4
p_loo        34.0  8.3
looic      1722.3 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   595       
 (0.5, 0.7]   (ok)         5    2.8%   666       
   (0.7, 1]   (bad)        2    1.1%   27        
   (1, Inf)   (very bad)   1    0.6%   17        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.8      11.7  
fit_sleep1 -92.3      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.9 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1770.0 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   625       
 (0.5, 0.7]   (ok)         2    1.1%   156       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.4
p_loo        34.0  8.3
looic      1722.3 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   595       
 (0.5, 0.7]   (ok)         5    2.8%   666       
   (0.7, 1]   (bad)        2    1.1%   27        
   (1, Inf)   (very bad)   1    0.6%   17        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.2     22.4        34.0    8.3   1722.3
fit_sleep2  -23.8      11.7  -885.0     14.4        19.5    3.4   1770.0
fit_sleep1  -92.3      21.1  -953.4     10.5         3.3    0.5   1906.9
           se_looic
fit_sleep3   44.8  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.517847e-41 4.471759e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.89      1.58     0.22     5.35       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.11      1.58    -3.43     2.94       5.15      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.62.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.2          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.3         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.3.1      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
