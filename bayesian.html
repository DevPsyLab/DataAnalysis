<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.19      6.78    16.13    42.55 1.00     1997     2628
sd(Days)                6.59      1.51     4.12     9.98 1.00     1590     2099
cor(Intercept,Days)     0.09      0.30    -0.47     0.66 1.00     1150     1847

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.12      7.62   236.52   266.47 1.00     2041     2602
Days         10.41      1.72     7.07    14.02 1.00     1477     1841

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.53    23.10    29.08 1.00     3061     2866

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7890  13.16183 227.2805 278.7190
309 211.1167  13.41396 185.2291 237.1339
310 212.6127  13.12786 186.9269 237.8000
330 274.5909  13.71249 248.7713 301.9779
331 273.2174  13.00519 248.3043 299.5942
332 260.2772  12.37468 236.2163 284.9143
333 268.3092  12.59204 244.2343 293.3662
334 244.0341  12.24828 219.9473 267.3992
335 250.5748  13.44967 224.3521 277.1705
337 286.0946  12.94293 261.3455 311.5180
349 226.3356  12.93618 199.9157 250.7653
350 238.7113  13.03771 212.3006 263.2574
351 255.6668  12.60217 230.4380 281.6443
352 272.0388  12.50959 247.0541 296.5984
369 254.7831  12.23697 230.9087 278.9821
370 225.9931  13.29939 199.6456 251.3113
371 252.0668  12.21971 227.9466 276.4158
372 263.9511  12.53988 239.6766 288.6410

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6816464  2.550635 14.7871820 24.784872
309  1.8125106  2.538294 -3.2292928  6.701254
310  4.9847238  2.461128  0.1807800  9.916481
330  5.7522124  2.574193  0.5381669 10.634332
331  7.4711489  2.464020  2.5751439 12.202444
332 10.2196371  2.333141  5.5482245 14.785495
333 10.2423961  2.388543  5.6000199 14.965502
334 11.5580563  2.316517  7.0571694 16.125297
335 -0.1853582  2.577269 -5.2755664  4.812600
337 19.0972364  2.472637 14.2659726 24.013045
349 11.5849161  2.417919  7.0416254 16.360539
350 17.0174013  2.521592 12.2423882 22.014036
351  7.4918125  2.398212  2.7517830 12.230152
352 14.0645271  2.374957  9.4885537 18.803448
369 11.3095234  2.328280  6.6972409 15.832845
370 15.2169078  2.545663 10.4061080 20.296415
371  9.4593525  2.300790  4.9102178 13.944426
372 11.7183643  2.389429  6.9285263 16.366279</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7890 13.161831 227.2805 278.7190
  [2,] 273.4707 11.247341 250.5843 294.9052
  [3,] 293.1523  9.632394 273.4612 311.9635
  [4,] 312.8340  8.489690 295.7660 329.2876
  [5,] 332.5156  8.023599 316.4445 348.2322
  [6,] 352.1973  8.348228 335.7179 368.8379
  [7,] 371.8789  9.381853 353.5077 390.7600
  [8,] 391.5605 10.925058 370.5680 413.5872
  [9,] 411.2422 12.794768 386.9294 437.1927
 [10,] 430.9238 14.868315 402.3589 460.7297
 [11,] 211.1167 13.413964 185.2291 237.1339
 [12,] 212.9292 11.501795 190.6603 235.3896
 [13,] 214.7417  9.875930 195.6130 234.2011
 [14,] 216.5542  8.698423 199.5901 233.8743
 [15,] 218.3668  8.165599 202.6581 234.3790
 [16,] 220.1793  8.401031 203.9873 236.6896
 [17,] 221.9918  9.346844 203.8997 240.2740
 [18,] 223.8043 10.818297 202.6812 244.7667
 [19,] 225.6168 12.633030 200.7463 250.1883
 [20,] 227.4293 14.664148 198.2768 255.9265
 [21,] 212.6127 13.127856 186.9269 237.8000
 [22,] 217.5975 11.284089 195.6734 239.2230
 [23,] 222.5822  9.717768 203.7948 241.5719
 [24,] 227.5669  8.582171 210.9747 244.0396
 [25,] 232.5516  8.061428 216.5885 248.3540
 [26,] 237.5363  8.272476 221.5365 253.3714
 [27,] 242.5211  9.164901 224.4492 260.4457
 [28,] 247.5058 10.567463 226.1167 268.1370
 [29,] 252.4905 12.306966 227.9598 276.9220
 [30,] 257.4752 14.260641 229.0151 285.9002
 [31,] 274.5909 13.712490 248.7713 301.9779
 [32,] 280.3432 11.709801 258.0183 303.7445
 [33,] 286.0954  9.972934 266.9644 305.3659
 [34,] 291.8476  8.663274 275.0379 308.5576
 [35,] 297.5998  7.993633 282.1211 312.7786
 [36,] 303.3520  8.123851 287.9612 318.9345
 [37,] 309.1042  9.019351 291.8617 326.7313
 [38,] 314.8564 10.485864 294.6343 335.3551
 [39,] 320.6086 12.321159 296.4393 344.9546
 [40,] 326.3609 14.384766 297.9273 354.6859
 [41,] 273.2174 13.005191 248.3043 299.5942
 [42,] 280.6885 11.134925 259.4571 303.5142
 [43,] 288.1597  9.538390 269.7990 307.6012
 [44,] 295.6308  8.373650 279.3068 312.7559
 [45,] 303.1020  7.835683 287.6135 318.7833
 [46,] 310.5731  8.051126 294.8072 326.5852
 [47,] 318.0442  8.965831 300.6201 335.5075
 [48,] 325.5154 10.396846 305.4701 345.6274
 [49,] 332.9865 12.163283 309.1777 356.3770
 [50,] 340.4577 14.139990 313.1095 367.7598
 [51,] 260.2772 12.374682 236.2163 284.9143
 [52,] 270.4969 10.694300 249.7463 291.9287
 [53,] 280.7165  9.300025 262.7819 299.3798
 [54,] 290.9361  8.336663 274.6557 307.4040
 [55,] 301.1558  7.962195 285.6252 316.6949
 [56,] 311.3754  8.257132 295.0534 327.4287
 [57,] 321.5951  9.157020 303.5961 339.4019
 [58,] 331.8147 10.507564 311.3653 352.3312
 [59,] 342.0343 12.159518 318.0722 365.5166
 [60,] 352.2540 14.006639 324.5181 379.3052
 [61,] 268.3092 12.592037 244.2343 293.3662
 [62,] 278.5516 10.833479 257.5288 300.1880
 [63,] 288.7940  9.358387 270.6663 306.8717
 [64,] 299.0364  8.318944 282.6739 314.9678
 [65,] 309.2788  7.889267 293.6147 324.8216
 [66,] 319.5212  8.166181 303.6253 335.7459
 [67,] 329.7636  9.085304 312.4844 347.9997
 [68,] 340.0060 10.478992 320.1964 361.1705
 [69,] 350.2484 12.185486 327.3000 374.4053
 [70,] 360.4908 14.091598 333.7353 388.2431
 [71,] 244.0341 12.248278 219.9473 267.3992
 [72,] 255.5921 10.544690 235.1231 276.0656
 [73,] 267.1502  9.115545 249.6189 285.1695
 [74,] 278.7083  8.107301 262.8168 294.8758
 [75,] 290.2663  7.687392 275.0250 305.3663
 [76,] 301.8244  7.949601 286.4200 317.6014
 [77,] 313.3824  8.833393 296.2195 330.9449
 [78,] 324.9405 10.178113 305.4317 344.8842
 [79,] 336.4985 11.827580 313.6348 359.6036
 [80,] 348.0566 13.671935 321.8530 374.8634
 [81,] 250.5748 13.449668 224.3521 277.1705
 [82,] 250.3895 11.428327 228.2861 273.2283
 [83,] 250.2041  9.674935 231.3281 269.4677
 [84,] 250.0187  8.359827 233.7047 266.6998
 [85,] 249.8334  7.710621 234.6397 264.9662
 [86,] 249.6480  7.893370 234.0835 265.1766
 [87,] 249.4627  8.856722 232.3824 267.0565
 [88,] 249.2773 10.385683 228.9935 269.9906
 [89,] 249.0919 12.270612 225.6715 273.5931
 [90,] 248.9066 14.372128 221.0088 277.3299
 [91,] 286.0946 12.942926 261.3455 311.5180
 [92,] 305.1919 11.084381 284.1548 326.6652
 [93,] 324.2891  9.509759 306.0396 342.7887
 [94,] 343.3863  8.380658 326.8599 359.8782
 [95,] 362.4836  7.890703 346.8485 377.8829
 [96,] 381.5808  8.155908 365.3873 397.5098
 [97,] 400.6781  9.110562 382.6974 418.2716
 [98,] 419.7753 10.569471 398.9697 440.1718
 [99,] 438.8725 12.355281 414.5795 462.9495
[100,] 457.9698 14.346432 430.0092 485.8538
[101,] 226.3356 12.936182 199.9157 250.7653
[102,] 237.9205 11.100593 215.5156 259.1391
[103,] 249.5054  9.528598 230.4428 267.8475
[104,] 261.0903  8.370058 244.4348 277.1933
[105,] 272.6752  7.811160 256.8328 287.8695
[106,] 284.2601  7.978925 268.2142 299.4728
[107,] 295.8450  8.832040 278.2290 312.7369
[108,] 307.4300 10.199965 287.3949 327.2463
[109,] 319.0149 11.906566 296.0376 341.7087
[110,] 330.5998 13.827003 304.2163 356.3943
[111,] 238.7113 13.037709 212.3006 263.2574
[112,] 255.7287 11.108201 233.2628 276.5986
[113,] 272.7461  9.461462 253.6013 290.7418
[114,] 289.7635  8.268207 272.9669 305.8540
[115,] 306.7809  7.741065 291.3930 322.0136
[116,] 323.7983  8.012601 308.0471 339.3270
[117,] 340.8157  9.010900 322.5000 358.1809
[118,] 357.8331 10.531273 336.8372 377.9070
[119,] 374.8505 12.382890 350.3630 398.6992
[120,] 391.8679 14.438873 363.2666 419.8108
[121,] 255.6668 12.602171 230.4380 281.6443
[122,] 263.1586 10.809769 241.5924 285.3458
[123,] 270.6505  9.294641 252.4695 289.1098
[124,] 278.1423  8.211725 262.0565 293.9850
[125,] 285.6341  7.744503 270.1638 300.5325
[126,] 293.1259  8.001567 277.1517 308.8588
[127,] 300.6177  8.920519 283.1939 318.1136
[128,] 308.1095 10.326136 288.0423 328.1469
[129,] 315.6013 12.049288 291.8567 339.1528
[130,] 323.0931 13.972990 295.2783 350.6755
[131,] 272.0388 12.509593 247.0541 296.5984
[132,] 286.1033 10.720521 264.5852 307.2113
[133,] 300.1678  9.200547 281.7786 318.1190
[134,] 314.2324  8.102554 298.4565 330.0603
[135,] 328.2969  7.611409 313.4086 343.2190
[136,] 342.3614  7.841974 326.8850 357.5081
[137,] 356.4259  8.737300 339.3958 373.5852
[138,] 370.4905 10.122504 351.0014 390.2380
[139,] 384.5550 11.826691 361.7530 407.7347
[140,] 398.6195 13.731605 371.8472 425.9082
[141,] 254.7831 12.236970 230.9087 278.9821
[142,] 266.0927 10.532092 245.3539 286.8868
[143,] 277.4022  9.107594 259.6379 295.4307
[144,] 288.7117  8.112542 272.7247 304.6845
[145,] 300.0212  7.714933 285.1190 315.4085
[146,] 311.3308  8.004300 295.7282 327.4085
[147,] 322.6403  8.913990 305.1122 340.4906
[148,] 333.9498 10.280632 313.7365 354.1700
[149,] 345.2593 11.948445 321.4689 368.5988
[150,] 356.5689 13.808732 328.9333 383.2337
[151,] 225.9931 13.299392 199.6456 251.3113
[152,] 241.2100 11.353085 218.9456 262.5178
[153,] 256.4269  9.688759 237.8296 274.9990
[154,] 271.6438  8.474217 255.1137 288.0950
[155,] 286.8607  7.919184 271.4322 302.4192
[156,] 302.0776  8.159374 286.0904 318.2827
[157,] 317.2945  9.132256 299.0296 335.1252
[158,] 332.5114 10.638685 311.4840 353.4375
[159,] 347.7284 12.487030 323.6346 371.7837
[160,] 362.9453 14.547544 334.5954 391.1700
[161,] 252.0668 12.219710 227.9466 276.4158
[162,] 261.5262 10.561507 240.5384 282.9827
[163,] 270.9856  9.184596 252.7064 289.2888
[164,] 280.4449  8.231371 264.2841 296.7712
[165,] 289.9043  7.857569 274.3724 305.4739
[166,] 299.3636  8.143377 283.6544 315.0856
[167,] 308.8230  9.026354 291.2772 326.2045
[168,] 318.2823 10.354845 298.2095 338.1141
[169,] 327.7417 11.981562 304.7542 350.5876
[170,] 337.2010 13.801454 310.2499 363.7061
[171,] 263.9511 12.539878 239.6766 288.6410
[172,] 275.6695 10.809326 254.5606 296.7996
[173,] 287.3879  9.373007 269.3778 305.8282
[174,] 299.1062  8.383539 282.7524 315.5449
[175,] 310.8246  8.008304 294.8159 326.3507
[176,] 322.5430  8.330719 306.0364 338.6540
[177,] 334.2613  9.278338 316.1589 352.2994
[178,] 345.9797 10.686111 325.4563 367.1484
[179,] 357.6980 12.398272 333.7511 382.0349
[180,] 369.4164 14.305944 341.7593 397.3748</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.2290237 13.161831  -29.1589761  22.2795454
  [2,]  -14.7659701 11.247341  -36.2005497   8.1204393
  [3,]  -42.3517165  9.632394  -61.1628853 -22.6606048
  [4,]    8.6058371  8.489690   -7.8478476  25.6738248
  [5,]   24.3362907  8.023599    8.6196619  40.4074214
  [6,]   62.4928443  8.348228   45.8521700  78.9722098
  [7,]   10.3248979  9.381853   -8.5561898  28.6961067
  [8,] -101.4119485 10.925058 -123.4385837 -80.4193896
  [9,]   19.3431051 12.794768   -6.6073687  43.6558878
 [10,]   35.4296587 14.868315    5.6237721  63.9945822
 [11,]   11.6171910 13.413964  -14.3999576  37.5048333
 [12,]   -7.6634196 11.501795  -30.1237720  14.6054599
 [13,]  -11.7639301  9.875930  -31.2233233   7.3647753
 [14,]  -11.8472407  8.698423  -29.1672795   5.1169317
 [15,]  -10.6506512  8.165599  -26.6628946   5.0579584
 [16,]   -4.2174618  8.401031  -20.7277922  11.9744707
 [17,]   -8.3614723  9.346844  -26.6437377   9.7305941
 [18,]   -6.0770829 10.818297  -27.0395274  15.0460224
 [19,]   -1.3210934 12.633030  -25.8925741  23.5493600
 [20,]    9.8848960 14.664148  -18.6123471  39.0373947
 [21,]  -13.5588307 13.127856  -38.7461477  12.1270237
 [22,]  -23.2652545 11.284089  -44.8907555  -1.3412435
 [23,]   11.7378217  9.717768   -7.2518851  30.5251948
 [24,]    5.2746978  8.582171  -11.1980245  21.8668515
 [25,]   -3.2442260  8.061428  -19.0465531  12.7188589
 [26,]  -17.0784498  8.272476  -32.9134661  -1.0786216
 [27,]   -7.1002736  9.164901  -25.0248860  10.9715918
 [28,]    8.2453026 10.567463  -12.3859376  29.6343647
 [29,]    8.5219787 12.306966  -15.9094935  33.0527065
 [30,]   -9.9599451 14.260641  -38.3848529  18.5002241
 [31,]   46.9516519 13.712490   19.5647265  72.7713266
 [32,]   20.0570395 11.709801   -3.3443467  42.3819232
 [33,]   -2.2388729  9.972934  -21.5093988  16.8921399
 [34,]   -6.7145853  8.663274  -23.4245857  10.0951173
 [35,]  -11.8024977  7.993633  -26.9813271   3.6762321
 [36,]   -5.7665101  8.123851  -21.3490234   9.6242613
 [37,]  -28.8646226  9.019351  -46.4916576 -11.6220742
 [38,]    3.4048650 10.485864  -17.0938102  23.6270050
 [39,]  -15.2591474 12.321159  -39.6051080   8.9102062
 [40,]   27.6878402 14.384766   -0.6372036  56.1213543
 [41,]   14.3905453 13.005191  -11.9862757  39.3036228
 [42,]    4.3114964 11.134925  -18.5142410  25.5429324
 [43,]   13.6609475  9.538390   -5.7805921  32.0216500
 [44,]   24.4844986  8.373650    7.3594195  40.8085091
 [45,]   13.1753497  7.835683   -2.5060261  28.6638099
 [46,]  -17.2543993  8.051126  -33.2665041  -1.4884800
 [47,]  -27.9692482  8.965831  -45.4324546 -10.5451103
 [48,]    9.3023029 10.396846  -10.8096766  29.3476427
 [49,]  -39.2396460 12.163283  -62.6300690 -15.4308115
 [50,]   31.1234051 14.139990    3.8212949  58.4716226
 [51,]  -25.4166324 12.374682  -50.0536972  -1.3556850
 [52,]  -27.6850695 10.694300  -49.1168691  -6.9344677
 [53,]   -7.7552066  9.300025  -26.4184914  10.1794232
 [54,]   18.8326564  8.336663    2.3648274  35.1131122
 [55,]   16.3071193  7.962195    0.7680275  31.8376756
 [56,]   -1.3778178  8.257132  -17.4311365  14.9441634
 [57,]  132.5668451  9.157020  114.7599661 150.5657679
 [58,]   15.0164080 10.507564   -5.5000587  35.4658054
 [59,]  -11.7340291 12.159518  -35.2163094  12.2280765
 [60,]  -98.3895662 14.006639 -125.4407796 -70.6536803
 [61,]   15.5331988 12.592037   -9.5238317  39.6081057
 [62,]   11.0034027 10.833479  -10.6330471  32.0261831
 [63,]  -12.0246934  9.358387  -30.1023904   6.1029921
 [64,]    0.7733105  8.318944  -15.1581462  17.1358410
 [65,]  -12.1077856  7.889267  -27.6505910   3.5563327
 [66,]   18.6453184  8.166181    2.4206143  34.5411836
 [67,]    2.2629223  9.085304  -15.9732018  19.5421030
 [68,]    8.8339262 10.478992  -12.3305721  28.6435478
 [69,]  -16.8883699 12.185486  -41.0452677   6.0599926
 [70,]    1.5520340 14.091598  -26.2003193  28.3075320
 [71,]   21.4390081 12.248278   -1.9260630  45.5258359
 [72,]   20.6090518 10.544690    0.1356077  41.0780531
 [73,]  -23.7855045  9.115545  -41.8047753  -6.2542458
 [74,]  -24.0359608  8.107301  -40.2034554  -8.1444704
 [75,]  -11.2419171  7.687392  -26.3418867   3.9993612
 [76,]  -17.6331734  7.949601  -33.4101677  -2.2287803
 [77,]   -7.8576297  8.833393  -25.4201110   9.3053339
 [78,]    6.5824140 10.178113  -13.3612661  26.0912281
 [79,]   -0.7516423 11.827580  -23.8567314  22.1120950
 [80,]   29.2424014 13.671935    2.4355932  55.4459960
 [81,]   -8.9665116 13.449668  -35.5621891  17.2561651
 [82,]   23.5577466 11.428327    0.7188946  45.6611287
 [83,]    4.2866048  9.674935  -14.9770454  23.1626100
 [84,]   20.7833630  8.359827    4.1022871  37.0974191
 [85,]    1.6185212  7.710621  -13.5142772  16.8121834
 [86,]    4.9881794  7.893370  -10.5403554  20.5527126
 [87,]   -4.0103624  8.856722  -21.6042114  13.0699483
 [88,]  -13.9663042 10.385683  -34.6796101   6.3174751
 [89,]  -13.3378459 12.270612  -37.8390261  10.0826035
 [90,]  -11.6599877 14.372128  -40.0833287  16.2378009
 [91,]   26.2719664 12.942926    0.8486134  51.0210889
 [92,]    8.6139301 11.084381  -12.8594028  29.6509559
 [93,]  -32.6779063  9.509759  -51.1775271 -14.4284258
 [94,]    2.7358573  8.380658  -13.7560364  19.2623146
 [95,]    3.2488210  7.890703  -12.1505359  18.8838583
 [96,]   10.2576846  8.155908   -5.6712566  26.4512388
 [97,]    3.5820482  9.110562  -14.0114980  21.5627021
 [98,]   -3.0829881 10.569471  -23.4794996  17.7225890
 [99,]   16.9917755 12.355281   -7.0852367  41.2848200
[100,]    0.9469391 14.346432  -26.9371363  28.9074875
[101,]    9.7676491 12.936182  -14.6620784  36.1875339
[102,]   -7.6037670 11.100593  -28.8224243  14.8011390
[103,]  -10.5797832  9.528598  -28.9219193   8.4827748
[104,]   -6.1682993  8.370058  -22.2712934  10.4872053
[105,]  -21.9649154  7.811160  -37.1591642  -6.1225406
[106,]  -14.4857316  7.978925  -29.6984432   1.5602235
[107,]  -14.2802477  8.832040  -31.1721287   3.3358166
[108,]    0.6720362 10.199965  -19.1443395  20.7070631
[109,]   17.2657200 11.906566   -5.4281380  40.2430348
[110,]   21.0453039 13.827003   -4.7492178  47.4287725
[111,]   17.5855143 13.037709   -6.9606480  43.9961670
[112,]  -12.2743870 11.108201  -33.1442917  10.1915048
[113,]  -16.5414882  9.461462  -34.5371545   2.6032566
[114,]  -34.2363895  8.268207  -50.3269426 -17.4397750
[115,]  -37.8643908  7.741065  -53.0971348 -22.4765374
[116,]    5.9264080  8.012601   -9.6022789  21.6775745
[117,]   38.6288067  9.010900   21.2636438  56.9445462
[118,]    5.0853055 10.531273  -14.9885699  26.0811504
[119,]   19.6367042 12.382890   -4.2119932  44.1241539
[120,]   -2.8151971 14.438873  -30.7581225  25.7860946
[121,]   -5.1403344 12.602171  -31.1178409  20.0884548
[122,]   36.8989531 10.809769   14.7118440  58.4651882
[123,]   -0.7565595  9.294641  -19.2159442  17.4243544
[124,]    2.4468280  8.211725  -13.3958758  18.5325891
[125,]  -13.8066845  7.744503  -28.7050549   1.6636369
[126,]   11.5077029  8.001567   -4.2252101  27.4819172
[127,]  -12.8711096  8.920519  -30.3670113   4.5526965
[128,]  -41.5140221 10.326136  -61.5514460 -21.4467728
[129,]    5.9404653 12.049288  -17.6109794  29.6850839
[130,]   24.4723528 13.972990   -3.1100392  52.2871963
[131,]  -50.3616788 12.509593  -74.9212893 -25.3770443
[132,]   12.0905942 10.720521   -9.0174460  33.6086550
[133,]   26.7106671  9.200547    8.7595114  45.0999217
[134,]   32.6231400  8.102554   16.7952223  48.3989643
[135,]   20.4433130  7.611409    5.5211741  35.3316037
[136,]   10.4672859  7.841974   -4.6793633  25.9437007
[137,]   -1.9993412  8.737300  -19.1585764  15.0308349
[138,]  -10.0578682 10.122504  -29.8054304   9.4312421
[139,]   -8.9143953 11.826691  -32.0940678  13.8875834
[140,]  -10.0778224 13.731605  -37.3664746  16.6945383
[141,]   17.1403540 12.236970   -7.0586210  41.0148269
[142,]    2.3442307 10.532092  -18.4498575  23.0829741
[143,]  -20.1597927  9.107594  -38.1882663  -2.3954799
[144,]  -11.0551160  8.112542  -27.0278799   4.9318707
[145,]   14.8009606  7.714933   -0.5862722  29.7031677
[146,]    5.8827373  8.004300  -10.1950042  21.4852689
[147,]  -24.5049861  8.913990  -42.3552916  -6.9769252
[148,]   14.1730906 10.280632   -6.0471111  34.3864387
[149,]   -4.9793328 11.948445  -28.3187762  18.8110972
[150,]    9.9442439 13.808732  -16.7206251  37.5797605
[151,]   -0.7290929 13.299392  -26.0473048  25.6183550
[152,]   -6.6865007 11.353085  -27.9943392  15.5779074
[153,]  -17.5261085  9.688759  -36.0982149   1.0711749
[154,]  -31.1708163  8.474217  -47.6219548 -14.6406775
[155,]  -19.3234241  7.919184  -34.8819301  -3.8948959
[156,]   42.1160681  8.159374   25.9110080  58.1033412
[157,]  -36.1464397  9.132256  -53.9771365 -17.8814668
[158,]   15.0740525 10.638685   -5.8519615  36.1014962
[159,]   17.4346447 12.487030   -6.6206862  41.5284272
[160,]    9.2835369 14.547544  -18.9411690  37.6334346
[161,]   17.8135529 12.219710   -6.5353692  41.9337539
[162,]   10.9166003 10.561507  -10.5399431  31.9043693
[163,]    6.9133478  9.184596  -11.3898632  25.1924995
[164,]    1.3445953  8.231371  -14.9816594  17.5053922
[165,]  -10.7337572  7.857569  -26.3033533   4.7980802
[166,]  -14.8516097  8.143377  -30.5736207   0.8575967
[167,]  -49.5571623  9.026354  -66.9387343 -32.0114301
[168,]  -13.6517148 10.354845  -33.4835304   6.4210693
[169,]   23.0390327 11.981562    0.1931084  46.0264635
[170,]   32.2681802 13.801454    5.7630554  59.2192868
[171,]    5.4605691 12.539878  -19.2292515  29.7351344
[172,]   -2.1954952 10.809326  -23.3256296  18.9133768
[173,]   10.2089406  9.373007   -8.2314435  28.2189542
[174,]   11.5253763  8.383539   -4.9133117  27.8791551
[175,]  -23.6519880  8.008304  -39.1781286  -7.6433407
[176,]    7.0646478  8.330719   -9.0463607  23.5711589
[177,]    0.2204835  9.278338  -17.8175664  18.3228984
[178,]   -2.7597807 10.686111  -23.9284811  17.7635895
[179,]   11.4436550 12.398272  -12.8931886  35.3906353
[180,]   -5.2928093 14.305944  -33.2511872  22.3642621</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.3
p_loo        19.3  3.2
looic      1769.6 28.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   612       
 (0.5, 0.7]   (ok)         1    0.6%   2668      
   (0.7, 1]   (bad)        1    0.6%   228       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.4
p_loo        33.8  8.4
looic      1721.4 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   865       
 (0.5, 0.7]   (ok)         5    2.8%   465       
   (0.7, 1]   (bad)        3    1.7%   13        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.1      11.8  
fit_sleep1 -92.6      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.3
p_loo        19.3  3.2
looic      1769.6 28.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   612       
 (0.5, 0.7]   (ok)         1    0.6%   2668      
   (0.7, 1]   (bad)        1    0.6%   228       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.4
p_loo        33.8  8.4
looic      1721.4 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   865       
 (0.5, 0.7]   (ok)         5    2.8%   465       
   (0.7, 1]   (bad)        3    1.7%   13        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.7     22.4        33.8    8.4   1721.4
fit_sleep2  -24.1      11.8  -884.8     14.3        19.3    3.2   1769.6
fit_sleep1  -92.6      21.0  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.8  
fit_sleep2   28.5  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.118237e-41 3.467569e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.91      1.55     0.34     5.47       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.09      1.55    -3.27     2.91       5.39      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.3          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.3         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.3.1      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
