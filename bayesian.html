<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.05      6.67    15.67    42.53 1.00     1813     2698
sd(Days)                6.62      1.51     4.21    10.14 1.00     1272     1738
cor(Intercept,Days)     0.09      0.30    -0.47     0.69 1.00      833     1372

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.07      7.44   235.90   266.02 1.00     1835     2099
Days         10.42      1.73     7.13    13.93 1.00     1411     1966

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.88      1.58    22.97    29.23 1.00     3847     3145

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7820  12.91592 228.7209 278.4127
309 211.3866  13.37632 184.8177 237.7231
310 212.9366  13.25943 186.5411 238.4704
330 274.4773  13.41375 248.9258 300.7426
331 273.2218  13.54510 247.3999 300.6897
332 260.1410  12.26846 236.5336 284.7096
333 267.7115  12.55310 243.6519 293.0659
334 244.1766  12.22345 219.7649 267.7319
335 250.9133  13.12391 225.4957 277.4700
337 286.1228  13.43800 260.0141 312.9448
349 226.7016  13.04679 201.2677 251.0342
350 238.8183  13.16843 211.6990 263.2930
351 255.9611  12.28665 232.5248 280.3162
352 272.1005  12.02195 248.7093 296.4331
369 254.7222  11.78278 231.7245 277.8242
370 226.5343  13.02193 200.7669 252.1922
371 251.9856  12.16960 227.6648 276.2476
372 263.8845  12.37899 239.7824 288.6220

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6307519  2.513082 14.6637906 24.564707
309  1.7290695  2.495446 -3.1115625  6.641246
310  4.9011332  2.495613 -0.0122816  9.820239
330  5.7488649  2.541523  0.5609214 10.620628
331  7.4792492  2.552783  2.3226569 12.548124
332 10.2271281  2.351011  5.7297169 14.735787
333 10.3195469  2.397993  5.4838146 15.027486
334 11.5289247  2.310218  7.1573816 16.223223
335 -0.2738307  2.494207 -5.1709849  4.605004
337 19.1396120  2.537524 14.0635246 24.146060
349 11.5434254  2.466556  6.9720899 16.505705
350 16.9777418  2.484815 12.3741753 21.993064
351  7.4469919  2.342468  2.7621480 11.944322
352 14.0221625  2.323094  9.4681911 18.600450
369 11.3197409  2.276566  6.7646862 15.752353
370 15.1853595  2.523077 10.3571813 20.199351
371  9.5186184  2.312014  4.9464011 13.971945
372 11.7175271  2.316420  7.2106467 16.204198</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7820 12.915921 228.7209 278.4127
  [2,] 273.4127 11.029729 252.1028 294.4101
  [3,] 293.0435  9.440339 274.8251 311.7887
  [4,] 312.6742  8.319631 296.5395 329.0462
  [5,] 332.3050  7.870430 316.8035 347.5739
  [6,] 351.9357  8.203794 335.6795 368.1622
  [7,] 371.5665  9.235366 353.4059 389.7037
  [8,] 391.1972 10.766285 369.9369 412.8544
  [9,] 410.8280 12.616060 386.1050 436.2763
 [10,] 430.4587 14.664522 401.6236 459.7538
 [11,] 211.3866 13.376325 184.8177 237.7231
 [12,] 213.1157 11.478726 190.7535 235.9376
 [13,] 214.8448  9.851433 195.5627 234.5914
 [14,] 216.5738  8.648399 199.3305 233.6449
 [15,] 218.3029  8.061848 202.3393 234.3329
 [16,] 220.0320  8.224748 204.0006 236.6174
 [17,] 221.7610  9.096926 204.1885 239.8158
 [18,] 223.4901 10.503149 202.7799 243.9547
 [19,] 225.2192 12.261025 201.4453 248.9401
 [20,] 226.9482 14.240920 199.7504 254.5760
 [21,] 212.9366 13.259427 186.5411 238.4704
 [22,] 217.8377 11.360355 195.6235 239.5799
 [23,] 222.7389  9.734428 203.9619 241.8139
 [24,] 227.6400  8.539127 210.8878 244.5016
 [25,] 232.5411  7.970600 216.9071 248.2497
 [26,] 237.4423  8.160906 221.4856 253.7817
 [27,] 242.3434  9.062367 224.6530 260.8021
 [28,] 247.2445 10.493273 227.0211 268.0911
 [29,] 252.1457 12.269768 228.3713 276.2488
 [30,] 257.0468 14.263303 229.2084 284.9681
 [31,] 274.4773 13.413747 248.9258 300.7426
 [32,] 280.2262 11.452050 257.9953 302.6391
 [33,] 285.9750  9.761606 266.9068 304.6337
 [34,] 291.7239  8.505712 274.8671 308.1270
 [35,] 297.4728  7.894555 281.5727 312.5974
 [36,] 303.2216  8.075862 287.0418 318.2663
 [37,] 308.9705  9.001875 290.9882 325.8127
 [38,] 314.7194 10.476958 293.8655 334.6461
 [39,] 320.4682 12.305211 295.6222 343.4546
 [40,] 326.2171 14.352298 297.4472 353.1312
 [41,] 273.2218 13.545101 247.3999 300.6897
 [42,] 280.7011 11.558859 258.5030 304.0973
 [43,] 288.1803  9.837586 269.1207 308.1649
 [44,] 295.6596  8.542973 278.9596 313.0420
 [45,] 303.1388  7.887969 287.7587 318.8177
 [46,] 310.6181  8.030638 294.9013 326.5258
 [47,] 318.0973  8.932840 300.5248 335.5824
 [48,] 325.5766 10.398726 305.0699 346.1214
 [49,] 333.0558 12.227215 309.2397 357.3961
 [50,] 340.5351 14.279687 312.4803 368.4386
 [51,] 260.1410 12.268459 236.5336 284.7096
 [52,] 270.3682 10.563875 249.7582 291.3795
 [53,] 280.5953  9.150428 262.3344 298.7909
 [54,] 290.8224  8.180447 274.5271 306.8495
 [55,] 301.0496  7.820716 285.6443 316.6976
 [56,] 311.2767  8.152423 295.4872 327.5137
 [57,] 321.5038  9.100270 304.0260 339.7548
 [58,] 331.7309 10.498682 311.3334 352.9438
 [59,] 341.9581 12.193615 318.4272 366.0975
 [60,] 352.1852 14.078377 324.7161 380.1773
 [61,] 267.7115 12.553100 243.6519 293.0659
 [62,] 278.0310 10.763648 257.5434 299.7443
 [63,] 288.3506  9.253791 270.4187 307.0402
 [64,] 298.6701  8.179849 283.1003 315.0835
 [65,] 308.9897  7.725797 294.2155 324.2712
 [66,] 319.3092  7.997918 303.6144 335.3189
 [67,] 329.6288  8.930073 312.1692 347.3587
 [68,] 339.9483 10.345358 320.0807 360.5174
 [69,] 350.2679 12.075074 326.9046 374.5749
 [70,] 360.5874 14.003183 333.1526 388.4328
 [71,] 244.1766 12.223446 219.7649 267.7319
 [72,] 255.7056 10.546765 234.5354 275.9882
 [73,] 267.2345  9.150414 248.6923 284.6732
 [74,] 278.7634  8.179249 262.3564 294.6954
 [75,] 290.2923  7.793868 274.5366 305.3635
 [76,] 301.8213  8.078543 285.9602 317.7004
 [77,] 313.3502  8.969702 295.6833 330.7931
 [78,] 324.8791 10.311278 304.7114 345.2053
 [79,] 336.4080 11.952556 313.1074 360.2000
 [80,] 347.9370 13.786912 321.0511 375.2582
 [81,] 250.9133 13.123911 225.4957 277.4700
 [82,] 250.6395 11.242170 229.0339 273.1329
 [83,] 250.3656  9.642502 231.9397 269.5106
 [84,] 250.0918  8.485957 233.8357 266.7436
 [85,] 249.8180  7.967887 234.7440 265.2946
 [86,] 249.5441  8.210062 234.2278 265.8718
 [87,] 249.2703  9.152331 232.0052 267.3669
 [88,] 248.9965 10.609776 228.4805 270.1854
 [89,] 248.7226 12.402083 224.4603 273.4029
 [90,] 248.4488 14.404795 220.4270 277.1230
 [91,] 286.1228 13.438003 260.0141 312.9448
 [92,] 305.2624 11.460289 283.0567 328.2401
 [93,] 324.4020  9.745491 305.8574 344.0658
 [94,] 343.5416  8.455117 327.0138 360.5108
 [95,] 362.6812  7.802658 346.8647 378.0211
 [96,] 381.8208  7.946824 365.8252 397.2912
 [97,] 400.9605  8.848762 383.4924 418.0724
 [98,] 420.1001 10.311510 400.2975 440.0658
 [99,] 439.2397 12.133916 416.0165 462.9060
[100,] 458.3793 14.177964 431.3981 486.0100
[101,] 226.7016 13.046792 201.2677 251.0342
[102,] 238.2450 11.171803 216.6993 258.9761
[103,] 249.7885  9.569084 231.1574 267.8627
[104,] 261.3319  8.396032 245.1734 277.8085
[105,] 272.8753  7.847747 257.4205 288.1426
[106,] 284.4187  8.052869 268.8445 300.3301
[107,] 295.9622  8.959803 278.5608 314.0703
[108,] 307.5056 10.386301 287.2073 328.6895
[109,] 319.0490 12.150728 295.8517 343.8935
[110,] 330.5924 14.127029 303.1916 358.9874
[111,] 238.8183 13.168432 211.6990 263.2930
[112,] 255.7961 11.241620 233.0648 276.9362
[113,] 272.7738  9.575440 253.4547 290.9042
[114,] 289.7516  8.327826 273.3359 305.6403
[115,] 306.7293  7.704865 291.8555 322.0824
[116,] 323.7070  7.856577 308.3935 339.0741
[117,] 340.6848  8.742728 323.6591 357.7488
[118,] 357.6625 10.173170 337.4236 377.0480
[119,] 374.6403 11.954083 351.3859 397.2465
[120,] 391.6180 13.951897 364.8187 418.4069
[121,] 255.9611 12.286645 232.5248 280.3162
[122,] 263.4081 10.613777 243.2814 284.2747
[123,] 270.8551  9.236731 253.0311 289.1892
[124,] 278.3021  8.304001 262.1294 294.9430
[125,] 285.7491  7.973079 270.0378 301.5985
[126,] 293.1961  8.316120 276.9155 309.5686
[127,] 300.6431  9.258511 282.3718 318.8887
[128,] 308.0901 10.642205 287.4255 329.1826
[129,] 315.5371 12.319389 291.9599 339.9384
[130,] 322.9841 14.186348 295.6496 351.0774
[131,] 272.1005 12.021951 248.7093 296.4331
[132,] 286.1227 10.378000 265.8320 307.0177
[133,] 300.1449  9.037255 282.5358 318.3295
[134,] 314.1670  8.150742 298.1447 330.5191
[135,] 328.1892  7.873421 312.5913 343.6338
[136,] 342.2113  8.266827 325.3817 358.6269
[137,] 356.2335  9.245737 337.3609 374.6475
[138,] 370.2557 10.649900 348.7481 391.5008
[139,] 384.2778 12.334936 359.8475 408.4866
[140,] 398.3000 14.201212 370.1181 426.1909
[141,] 254.7222 11.782779 231.7245 277.8242
[142,] 266.0419 10.155141 246.0902 285.5596
[143,] 277.3617  8.819604 260.4434 294.0719
[144,] 288.6814  7.925241 273.1917 303.8918
[145,] 300.0011  7.628825 285.1195 314.6510
[146,] 311.3209  7.997125 295.8623 326.9544
[147,] 322.6406  8.948439 305.4050 339.8763
[148,] 333.9604 10.322820 314.2425 353.9033
[149,] 345.2801 11.975482 322.1036 368.8411
[150,] 356.5998 13.806854 330.1969 384.1620
[151,] 226.5343 13.021932 200.7669 252.1922
[152,] 241.7197 11.097201 219.6633 263.6448
[153,] 256.9050  9.458165 238.3323 275.5124
[154,] 272.0904  8.276336 255.9708 288.4839
[155,] 287.2757  7.763403 272.3227 303.0157
[156,] 302.4611  8.048288 286.5423 318.7799
[157,] 317.6465  9.056009 299.3218 335.3573
[158,] 332.8318 10.582036 312.1797 353.4215
[159,] 348.0172 12.437022 323.5541 372.4743
[160,] 363.2025 14.495220 334.6005 391.6065
[161,] 251.9856 12.169601 227.6648 276.2476
[162,] 261.5042 10.471484 240.5921 282.4844
[163,] 271.0228  9.049619 253.0529 288.6955
[164,] 280.5415  8.051712 264.7066 296.0397
[165,] 290.0601  7.645608 275.1425 304.9521
[166,] 299.5787  7.922841 284.2142 315.3448
[167,] 309.0973  8.819202 292.1252 325.9583
[168,] 318.6159 10.172318 298.6452 337.7843
[169,] 328.1346 11.826436 305.1222 350.4472
[170,] 337.6532 13.672745 311.0519 363.9333
[171,] 263.8845 12.378991 239.7824 288.6220
[172,] 275.6020 10.654580 254.8810 296.7742
[173,] 287.3195  9.194146 269.3797 305.9219
[174,] 299.0371  8.141018 283.2430 315.8150
[175,] 310.7546  7.664961 295.8837 326.2554
[176,] 322.4721  7.871384 306.5151 338.0242
[177,] 334.1896  8.711908 317.0473 351.4605
[178,] 345.9072 10.028339 325.9536 365.2604
[179,] 357.6247 11.660594 334.4152 380.7127
[180,] 369.3422 13.494550 342.5298 396.5831</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.2219642 12.915921  -28.8526867  20.8390990
  [2,]  -14.7080160 11.029729  -35.7054427   6.6019002
  [3,]  -42.2428679  9.440339  -60.9880682 -24.0244804
  [4,]    8.7655803  8.319631   -7.6064260  24.9003021
  [5,]   24.5469284  7.870430    9.2779974  40.0484471
  [6,]   62.7543765  8.203794   46.5279156  79.0106302
  [7,]   10.6373247  9.235366   -7.4999001  28.7979036
  [8,] -101.0486272 10.766285 -122.7058046 -79.7883027
  [9,]   19.7573210 12.616060   -5.6909614  44.4802505
 [10,]   35.8947691 14.664522    6.5996771  64.7298777
 [11,]   11.3472793 13.376325  -14.9892277  37.9162494
 [12,]   -7.8498902 11.478726  -30.6717716  14.5122859
 [13,]  -11.8669597  9.851433  -31.6135910   7.4151101
 [14,]  -11.8668292  8.648399  -28.9379476   5.3765056
 [15,]  -10.5867986  8.061848  -26.6167989   5.3767528
 [16,]   -4.0701681  8.224748  -20.6556488  11.9611665
 [17,]   -8.1307376  9.096926  -26.1854975   9.4418330
 [18,]   -5.7629071 10.503149  -26.2274814  14.9472528
 [19,]   -0.9234766 12.261025  -24.6444065  22.8503850
 [20,]   10.3659539 14.240920  -17.2618043  37.5638200
 [21,]  -13.8827090 13.259427  -39.4164844  12.5128499
 [22,]  -23.5055422 11.360355  -45.2476721  -1.2913447
 [23,]   11.5811245  9.734428   -7.4938521  30.3580989
 [24,]    5.2015913  8.539127  -11.6599877  21.9538019
 [25,]   -3.2337419  7.970600  -18.9423353  12.4003200
 [26,]  -16.9843752  8.160906  -33.3237506  -1.0277248
 [27,]   -6.9226084  9.062367  -25.3812527  10.7677639
 [28,]    8.5065584 10.493273  -12.3399603  28.7299514
 [29,]    8.8668251 12.269768  -15.2363423  32.6412236
 [30,]   -9.5315081 14.263303  -37.4527528  18.3068958
 [31,]   47.0652923 13.413747   20.8000399  72.6167780
 [32,]   20.1740275 11.452050   -2.2388528  42.4049402
 [33,]   -2.1185374  9.761606  -20.7771927  16.9497168
 [34,]   -6.5909022  8.505712  -22.9939833  10.2658958
 [35,]  -11.6754671  7.894555  -26.8000754   4.2246100
 [36,]   -5.6361320  8.075862  -20.6808403  10.5437339
 [37,]  -28.7308968  9.001875  -45.5730545 -10.7485936
 [38,]    3.5419383 10.476958  -16.3847960  24.3958089
 [39,]  -15.1187266 12.305211  -38.1051273   9.7272979
 [40,]   27.8316086 14.352298    0.9175186  56.6014587
 [41,]   14.3860918 13.545101  -13.0817559  40.2080198
 [42,]    4.2989426 11.558859  -19.0972662  26.4969557
 [43,]   13.6402933  9.837586   -6.3443203  32.6999438
 [44,]   24.4557441  8.542973    7.0733209  41.1556871
 [45,]   13.1384949  7.887969   -2.5403722  28.5185917
 [46,]  -17.2993544  8.030638  -33.2070640  -1.5826087
 [47,]  -28.0223036  8.932840  -45.5074339 -10.4498324
 [48,]    9.2411471 10.398726  -11.3036717  29.7478316
 [49,]  -39.3089021 12.227215  -63.6492116 -15.4928027
 [50,]   31.0460486 14.279687    3.1424595  59.1007662
 [51,]  -25.2804477 12.268459  -49.8489807  -1.6729581
 [52,]  -27.5563758 10.563875  -48.5676696  -6.9463922
 [53,]   -7.6340040  9.150428  -25.8296394  10.6269350
 [54,]   18.9463679  8.180447    2.9193054  35.2417073
 [55,]   16.4133397  7.820716    0.7653326  31.8186383
 [56,]   -1.2790884  8.152423  -17.5160809  14.5104136
 [57,]  132.6580834  9.100270  114.4071287 150.1359327
 [58,]   15.1001553 10.498682   -6.1126886  35.4976614
 [59,]  -11.6577729 12.193615  -35.7972271  11.8730513
 [60,]  -98.3208010 14.078377 -126.3129058 -70.8517272
 [61,]   16.1309038 12.553100   -9.2234553  40.1905120
 [62,]   11.5239569 10.763648  -10.1892710  32.0116030
 [63,]  -11.5812900  9.253791  -30.2708568   6.3506077
 [64,]    1.1395630  8.179849  -15.2738271  16.7093685
 [65,]  -11.8186839  7.725797  -27.1002418   2.9554503
 [66,]   18.8572692  7.997918    2.8475557  34.5521290
 [67,]    2.3977223  8.930073  -15.3322014  19.8572651
 [68,]    8.8915754 10.345358  -11.6775487  28.7592387
 [69,]  -16.9078715 12.075074  -41.2148638   6.4554261
 [70,]    1.4553816 14.003183  -26.3900354  28.8901542
 [71,]   21.2964562 12.223446   -2.2587774  45.7081828
 [72,]   20.4956314 10.546765    0.2129699  41.6658115
 [73,]  -23.8697933  9.150414  -41.3084994  -5.3276170
 [74,]  -24.0911180  8.179249  -40.0231298  -7.6841041
 [75,]  -11.2679428  7.793868  -26.3390915   4.4877610
 [76,]  -17.6300675  8.078543  -33.5092151  -1.7690331
 [77,]   -7.8253923  8.969702  -25.2683285   9.8415051
 [78,]    6.6437830 10.311278  -13.6824282  26.8115204
 [79,]   -0.6611417 11.952556  -24.4530926  22.6394887
 [80,]   29.3620335 13.786912    2.0408199  56.2479387
 [81,]   -9.3049876 13.123911  -35.8617465  16.1126194
 [82,]   23.3077431 11.242170    0.8142801  44.9133006
 [83,]    4.1250738  9.642502  -15.0199058  22.5510456
 [84,]   20.7103045  8.485957    4.0584940  36.9664048
 [85,]    1.6339352  7.967887  -13.8426776  16.7078833
 [86,]    5.0920659  8.210062  -11.2356072  20.4084232
 [87,]   -3.8180034  9.152331  -21.9146327  13.4470506
 [88,]  -13.6854727 10.609776  -34.8744251   6.8305227
 [89,]  -12.9685420 12.402083  -37.6488127  11.2937941
 [90,]  -11.2022113 14.404795  -39.8764156  16.8196449
 [91,]   26.2438129 13.438003   -0.5782324  52.3524804
 [92,]    8.5434009 11.460289  -14.4342796  30.7491125
 [93,]  -32.7908111  9.745491  -52.4545907 -14.2462339
 [94,]    2.5805769  8.455117  -14.3886134  19.1084411
 [95,]    3.0511649  7.802658  -12.2886541  18.8676781
 [96,]   10.0176529  7.946824   -5.4527285  26.0132522
 [97,]    3.2996409  8.848762  -13.8123185  20.7676738
 [98,]   -3.4077711 10.311510  -23.3735050  16.3948209
 [99,]   16.6246169 12.133916   -7.0417119  39.8478066
[100,]    0.5374049 14.177964  -27.0932831  27.5185611
[101,]    9.4015863 13.046792  -14.9309573  34.8355273
[102,]   -7.9283391 11.171803  -28.6594001  13.6174128
[103,]  -10.8628645  9.569084  -28.9370734   7.7681725
[104,]   -6.4098898  8.396032  -22.8865290   9.7486076
[105,]  -22.1650152  7.847747  -37.4323476  -6.7102237
[106,]  -14.6443406  8.052869  -30.5557072   0.9298990
[107,]  -14.3973660  8.959803  -32.5054806   3.0039893
[108,]    0.5964086 10.386301  -20.5874826  20.8946685
[109,]   17.2315832 12.150728   -7.6128744  40.4288517
[110,]   21.0526579 14.127029   -7.3422770  48.4534520
[111,]   17.4784596 13.168432   -6.9962352  44.5977891
[112,]  -12.3417821 11.241620  -33.4819320  10.3894970
[113,]  -16.5692239  9.575440  -34.6996181   2.7499478
[114,]  -34.2244657  8.327826  -50.1132085 -17.8087722
[115,]  -37.8128074  7.704865  -53.1659199 -22.9389695
[116,]    6.0176508  7.856577   -9.3494090  21.3311508
[117,]   38.7597090  8.742728   21.6957317  55.7853796
[118,]    5.2558673 10.173170  -14.1295807  25.4947818
[119,]   19.8469255 11.954083   -2.7592849  43.1013380
[120,]   -2.5653162 13.951897  -29.3542163  24.2339617
[121,]   -5.4346440 12.286645  -29.7897164  18.0016911
[122,]   36.6494641 10.613777   15.7828582  56.7762372
[123,]   -0.9612279  9.236731  -19.2953214  16.8628185
[124,]    2.2869802  8.304001  -14.3538551  18.4597336
[125,]  -13.9217117  7.973079  -29.7711238   1.7896124
[126,]   11.4374963  8.316120   -4.9350144  27.7180825
[127,]  -12.8964956  9.258511  -31.1420657   5.3747713
[128,]  -41.4945876 10.642205  -62.5871001 -20.8300044
[129,]    6.0047205 12.319389  -18.3966460  29.5819260
[130,]   24.5814286 14.186348   -3.5119188  51.9158774
[131,]  -50.4234368 12.021951  -74.7560077 -27.0322100
[132,]   12.0712007 10.378000   -8.8238136  32.3618815
[133,]   26.7336383  9.037255    8.5489939  44.3426985
[134,]   32.6884758  8.150742   16.3363628  48.7107607
[135,]   20.5510134  7.873421    5.1064493  36.1489140
[136,]   10.6173509  8.266827   -5.7982045  27.4470373
[137,]   -1.8069116  9.245737  -20.2208925  17.0657412
[138,]   -9.8230740 10.649900  -31.0681920  11.6845095
[139,]   -8.6372365 12.334936  -32.8460229  15.7931226
[140,]   -9.7582990 14.201212  -37.6492103  18.4236365
[141,]   17.2013294 11.782779   -5.9006923  40.1989616
[142,]    2.3949885 10.155141  -17.1226789  22.3467488
[143,]  -20.1192524  8.819604  -36.8294979  -3.2009984
[144,]  -11.0247933  7.925241  -26.2351735   4.4649322
[145,]   14.8210658  7.628825    0.1712227  29.7026819
[146,]    5.8926249  7.997125   -9.7408729  21.3512346
[147,]  -24.5053161  8.948439  -41.7409676  -7.2696656
[148,]   14.1625430 10.322820   -5.7804474  33.8803716
[149,]   -5.0000979 11.975482  -28.5610669  18.1763986
[150,]    9.9132612 13.806854  -17.6488986  36.3161741
[151,]   -1.2703099 13.021932  -26.9281848  24.4971224
[152,]   -7.1961693 11.097201  -29.1213328  14.8602388
[153,]  -18.0042288  9.458165  -36.6115503   0.5685062
[154,]  -31.6173883  8.276336  -48.0108523 -15.4977555
[155,]  -19.7384478  7.763403  -35.4783612  -4.7853526
[156,]   41.7325927  8.048288   25.4138447  57.6514190
[157,]  -36.4983667  9.056009  -54.2091511 -18.1737178
[158,]   14.7536738 10.582036   -5.8360367  35.4058018
[159,]   17.1458143 12.437022   -7.3112904  41.6089485
[160,]    9.0262548 14.495220  -19.3777014  37.6283499
[161,]   17.8947881 12.169601   -6.3672057  42.2155957
[162,]   10.9385698 10.471484  -10.0415736  31.8506845
[163,]    6.8760514  9.049619  -10.7965816  24.8459891
[164,]    1.2480330  8.051712  -14.2501675  17.0828856
[165,]  -10.8895854  7.645608  -25.7816440   4.0280062
[166,]  -15.0667038  7.922841  -30.8327656   0.2977643
[167,]  -49.8315221  8.819202  -66.6924660 -32.8593922
[168,]  -13.9853405 10.172318  -33.1537424   5.9853967
[169,]   22.6461411 11.826436    0.3335409  45.6584938
[170,]   31.8160227 13.672745    5.5358885  58.4172675
[171,]    5.5272277 12.378991  -19.2103107  29.6293376
[172,]   -2.1279994 10.654580  -23.3001756  18.5930163
[173,]   10.2772734  9.194146   -8.3251392  28.2170963
[174,]   11.5945463  8.141018   -5.1834056  27.3885753
[175,]  -23.5819809  7.664961  -39.0827719  -8.7111141
[176,]    7.1354920  7.871384   -8.4166065  23.0924786
[177,]    0.2921648  8.711908  -16.9787138  17.4344709
[178,]   -2.6872623 10.028339  -22.0405389  17.2663090
[179,]   11.5170105 11.660594  -11.5710176  34.7265489
[180,]   -5.2186166 13.494550  -32.4594773  21.5938115</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.5
p_loo        19.8  3.6
looic      1770.4 29.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     176   97.8%   1859      
 (0.5, 0.7]   (ok)         3    1.7%   355       
   (0.7, 1]   (bad)        1    0.6%   84        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.5
p_loo        34.1  8.6
looic      1721.9 45.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   881       
 (0.5, 0.7]   (ok)         5    2.8%   376       
   (0.7, 1]   (bad)        2    1.1%   16        
   (1, Inf)   (very bad)   1    0.6%   19        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.8  
fit_sleep1 -92.4      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.5
p_loo        19.8  3.6
looic      1770.4 29.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     176   97.8%   1859      
 (0.5, 0.7]   (ok)         3    1.7%   355       
   (0.7, 1]   (bad)        1    0.6%   84        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.5
p_loo        34.1  8.6
looic      1721.9 45.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   881       
 (0.5, 0.7]   (ok)         5    2.8%   376       
   (0.7, 1]   (bad)        2    1.1%   16        
   (1, Inf)   (very bad)   1    0.6%   19        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.0     22.5        34.1    8.6   1721.9
fit_sleep2  -24.3      11.8  -885.2     14.5        19.8    3.6   1770.4
fit_sleep1  -92.4      21.2  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   45.0  
fit_sleep2   29.1  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
7.308653e-41 2.939605e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.82       1.6     0.13     5.36       0.05      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.18       1.6    -3.41     2.84       4.99      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.62.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.2          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        ggridges_0.5.4       callr_3.7.3         
 [34] stringr_1.4.1        digest_0.6.30        minqa_1.2.5         
 [37] rmarkdown_2.18       base64enc_0.1-3      pkgconfig_2.0.3     
 [40] htmltools_0.5.3      highr_0.9            fastmap_1.1.0       
 [43] htmlwidgets_1.5.4    rlang_1.0.6          shiny_1.7.3         
 [46] jquerylib_0.1.4      farver_2.1.1         generics_0.1.3      
 [49] zoo_1.8-11           jsonlite_1.8.3       gtools_3.9.3        
 [52] crosstalk_1.2.0      dplyr_1.0.10         distributional_0.3.1
 [55] inline_0.3.19        magrittr_2.0.3       loo_2.5.1           
 [58] bayesplot_1.9.0      munsell_0.5.0        fansi_1.0.3         
 [61] abind_1.4-5          lifecycle_1.0.3      stringi_1.7.8       
 [64] yaml_2.3.6           MASS_7.3-58.1        plyr_1.8.8          
 [67] pkgbuild_1.3.1       grid_4.2.2           parallel_4.2.2      
 [70] promises_1.2.0.1     crayon_1.5.2         miniUI_0.1.1.1      
 [73] lattice_0.20-45      splines_4.2.2        knitr_1.40          
 [76] ps_1.7.2             pillar_1.8.1         igraph_1.3.5        
 [79] boot_1.3-28          markdown_1.3         shinystan_2.6.0     
 [82] reshape2_1.4.4       codetools_0.2-18     stats4_4.2.2        
 [85] rstantools_2.2.0     glue_1.6.2           evaluate_0.18       
 [88] V8_4.2.1             RcppParallel_5.1.5   vctrs_0.5.0         
 [91] nloptr_2.0.3         httpuv_1.6.6         gtable_0.3.1        
 [94] assertthat_0.2.1     cachem_1.0.6         ggplot2_3.4.0       
 [97] xfun_0.34            mime_0.12            xtable_1.8-4        
[100] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[103] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
