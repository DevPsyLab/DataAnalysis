<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.01      6.77    15.83    41.99 1.00     2018     2659
sd(Days)                6.57      1.54     4.16    10.23 1.00     1600     1807
cor(Intercept,Days)     0.09      0.30    -0.47     0.66 1.00      983     1569

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.31      7.41   236.77   266.10 1.00     2270     2775
Days         10.38      1.73     7.04    13.81 1.00     1464     1475

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.55    23.02    29.14 1.00     3667     3138

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6931  12.81921 227.2296 277.7066
309 211.3901  13.03222 185.5013 235.7631
310 212.6175  13.09929 186.8604 238.1965
330 274.6683  13.38359 249.3308 301.3159
331 273.1026  12.90046 248.9993 299.1483
332 260.2499  12.09098 236.8830 284.1699
333 267.8499  12.39845 244.5676 292.7433
334 243.9999  12.57584 219.1503 267.8590
335 250.8513  13.44491 225.6289 277.4323
337 285.9325  13.07001 260.8147 311.8799
349 226.8543  12.76397 200.9550 250.9357
350 238.8229  12.98804 212.5893 263.4295
351 255.5992  12.45909 230.8458 280.5941
352 272.0941  12.54140 247.9978 297.1563
369 254.5925  12.05987 231.2390 278.4167
370 226.4472  13.75695 198.8600 252.8728
371 252.2088  12.28651 227.8871 276.6907
372 263.3229  12.27133 239.4967 288.0725

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6671900  2.449243 14.8791187 24.508160
309  1.7769741  2.435913 -2.9608862  6.418807
310  4.9717575  2.472590  0.1952284  9.835344
330  5.7205668  2.511857  0.8397956 10.577716
331  7.4662874  2.461135  2.5538483 12.122305
332 10.2555073  2.299909  5.7200935 14.651694
333 10.2761547  2.330889  5.5674478 14.752264
334 11.5264491  2.391619  6.7984834 16.218402
335 -0.2439324  2.603052 -5.4461216  4.785246
337 19.1727528  2.454684 14.3202460 24.083202
349 11.5235966  2.451901  6.7966797 16.481531
350 17.0151009  2.465988 12.2308732 21.921965
351  7.5238141  2.357999  2.8822246 12.134298
352 14.0717169  2.373512  9.3453882 18.861773
369 11.3339345  2.312001  6.7309368 15.895825
370 15.2043544  2.561485 10.2999836 20.298640
371  9.4306410  2.319704  4.9669336 14.025336
372 11.8197540  2.330060  7.1809935 16.426952</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6931 12.819213 227.2296 277.7066
  [2,] 273.3603 10.965688 250.9542 293.9972
  [3,] 293.0275  9.389248 273.9504 310.7414
  [4,] 312.6947  8.250286 296.0335 328.9127
  [5,] 332.3618  7.744292 316.9873 347.7562
  [6,] 352.0290  7.992400 336.0797 367.5925
  [7,] 371.6962  8.931990 353.7905 389.0850
  [8,] 391.3634 10.376899 370.7849 411.6548
  [9,] 411.0306 12.148135 386.9512 434.9718
 [10,] 430.6978 14.123452 402.7947 458.4890
 [11,] 211.3901 13.032219 185.5013 235.7631
 [12,] 213.1671 11.215046 190.6075 234.1393
 [13,] 214.9441  9.673837 195.2421 233.3109
 [14,] 216.7210  8.558992 199.5433 233.1351
 [15,] 218.4980  8.049652 202.5896 234.1149
 [16,] 220.2750  8.258619 204.2763 236.1576
 [17,] 222.0520  9.136740 204.0724 239.9517
 [18,] 223.8289 10.517728 202.9315 244.4545
 [19,] 225.6059 12.232437 201.3097 249.1571
 [20,] 227.3829 14.160148 199.5668 254.3581
 [21,] 212.6175 13.099290 186.8604 238.1965
 [22,] 217.5892 11.240385 195.3184 239.6994
 [23,] 222.5610  9.660668 203.3740 241.7085
 [24,] 227.5327  8.516933 211.0392 244.5811
 [25,] 232.5045  7.998449 217.2478 248.1452
 [26,] 237.4763  8.224331 221.8796 253.8629
 [27,] 242.4480  9.139555 224.9037 260.9207
 [28,] 247.4198 10.566490 227.1190 268.7433
 [29,] 252.3915 12.328720 228.5511 276.8544
 [30,] 257.3633 14.302845 229.6696 285.9107
 [31,] 274.6683 13.383592 249.3308 301.3159
 [32,] 280.3889 11.440034 258.4332 303.0812
 [33,] 286.1095  9.759461 267.0274 305.1134
 [34,] 291.8300  8.499332 275.1523 308.4545
 [35,] 297.5506  7.864418 281.9036 312.8717
 [36,] 303.2712  8.004895 287.5911 318.5968
 [37,] 308.9917  8.884057 292.0813 326.1319
 [38,] 314.7123 10.314720 294.6102 335.1276
 [39,] 320.4329 12.102863 297.1217 344.5995
 [40,] 326.1534 14.113256 298.8308 354.0220
 [41,] 273.1026 12.900464 248.9993 299.1483
 [42,] 280.5689 11.064765 259.7017 302.6796
 [43,] 288.0352  9.515799 270.0804 307.0389
 [44,] 295.5015  8.413455 279.1448 312.2854
 [45,] 302.9678  7.945841 287.1391 318.7238
 [46,] 310.4341  8.221978 294.2164 327.0039
 [47,] 317.9003  9.174957 300.0163 336.2552
 [48,] 325.3666 10.624176 304.2561 346.7932
 [49,] 332.8329 12.396804 308.2492 357.6997
 [50,] 340.2992 14.373684 312.0054 369.1719
 [51,] 260.2499 12.090985 236.8830 284.1699
 [52,] 270.5054 10.441943 250.2755 290.9343
 [53,] 280.7609  9.080508 263.0548 298.3971
 [54,] 291.0164  8.152069 275.0736 306.7421
 [55,] 301.2719  7.812554 286.3325 316.5186
 [56,] 311.5274  8.136028 295.7220 327.6437
 [57,] 321.7829  9.051688 303.8699 339.8462
 [58,] 332.0384 10.404342 311.7135 352.9338
 [59,] 342.2940 12.047687 318.9948 366.4220
 [60,] 352.5495 13.878847 325.9590 380.0452
 [61,] 267.8499 12.398446 244.5676 292.7433
 [62,] 278.1261 10.684501 257.9931 299.5417
 [63,] 288.4022  9.244552 270.8657 306.8600
 [64,] 298.6784  8.223807 282.9251 314.6989
 [65,] 308.9545  7.788861 293.7853 323.8846
 [66,] 319.2307  8.035408 303.4947 334.4711
 [67,] 329.5068  8.907036 311.9375 346.3995
 [68,] 339.7830 10.245433 319.6373 359.3573
 [69,] 350.0591 11.894056 326.0040 372.9203
 [70,] 360.3353 13.741701 332.5375 386.5510
 [71,] 243.9999 12.575841 219.1503 267.8590
 [72,] 255.5264 10.790247 234.3162 276.1750
 [73,] 267.0528  9.281529 248.6842 285.1620
 [74,] 278.5793  8.203890 262.4046 294.5646
 [75,] 290.1057  7.739543 274.8450 305.5297
 [76,] 301.6322  7.996057 286.1431 317.3645
 [77,] 313.1586  8.911398 295.7314 330.8408
 [78,] 324.6851 10.311586 304.3829 345.2942
 [79,] 336.2115 12.028477 312.5057 360.4009
 [80,] 347.7380 13.945588 320.3428 375.8240
 [81,] 250.8513 13.444913 225.6289 277.4323
 [82,] 250.6074 11.448274 228.5739 273.2381
 [83,] 250.3635  9.742280 231.5738 269.0685
 [84,] 250.1195  8.503695 233.5503 266.2200
 [85,] 249.8756  7.953954 234.4586 265.3894
 [86,] 249.6317  8.232235 233.9917 265.8348
 [87,] 249.3878  9.264220 231.5986 267.8932
 [88,] 249.1438 10.836679 228.3908 270.7498
 [89,] 248.8999 12.751204 224.4595 274.6749
 [90,] 248.6560 14.876308 219.8770 278.7592
 [91,] 285.9325 13.070015 260.8147 311.8799
 [92,] 305.1052 11.199762 283.4541 327.4828
 [93,] 324.2780  9.596613 305.9648 343.2286
 [94,] 343.4508  8.414644 327.2588 359.9417
 [95,] 362.6235  7.846556 347.5658 378.0436
 [96,] 381.7963  8.023814 366.1916 397.8172
 [97,] 400.9690  8.902004 383.8693 418.4212
 [98,] 420.1418 10.303432 400.2966 440.3714
 [99,] 439.3145 12.046854 416.0754 462.6462
[100,] 458.4873 14.005128 431.3287 485.7330
[101,] 226.8543 12.763968 200.9550 250.9357
[102,] 238.3779 10.923424 216.4558 259.1594
[103,] 249.9015  9.367344 231.0959 267.8290
[104,] 261.4251  8.258131 244.9281 277.4122
[105,] 272.9486  7.789093 257.7925 288.2269
[106,] 284.4722  8.072598 268.4101 300.0326
[107,] 295.9958  9.038106 277.8704 313.1894
[108,] 307.5194 10.499120 286.7536 327.7937
[109,] 319.0430 12.280038 294.6596 342.7942
[110,] 330.5666 14.261513 301.8666 358.2530
[111,] 238.8229 12.988041 212.5893 263.4295
[112,] 255.8380 11.143640 233.5589 276.9384
[113,] 272.8531  9.583027 253.8205 291.1960
[114,] 289.8682  8.464650 273.1695 306.4663
[115,] 306.8833  7.976740 291.2286 322.8393
[116,] 323.8984  8.232172 308.0000 339.8613
[117,] 340.9135  9.169031 323.3709 358.4266
[118,] 357.9286 10.608289 337.9260 378.3028
[119,] 374.9437 12.375890 351.3687 398.8185
[120,] 391.9588 14.351017 364.2506 420.1452
[121,] 255.5992 12.459093 230.8458 280.5941
[122,] 263.1230 10.752912 241.8159 284.6636
[123,] 270.6468  9.334963 252.1789 289.2276
[124,] 278.1706  8.353340 261.5988 294.6358
[125,] 285.6944  7.970908 270.0363 301.0331
[126,] 293.2182  8.271201 276.9181 309.4255
[127,] 300.7421  9.187518 283.1529 319.3622
[128,] 308.2659 10.560707 288.0473 329.9115
[129,] 315.7897 12.237928 292.5106 340.9893
[130,] 323.3135 14.111186 296.5253 352.1946
[131,] 272.0941 12.541397 247.9978 297.1563
[132,] 286.1658 10.774794 265.3777 307.2722
[133,] 300.2376  9.282934 282.1648 318.4348
[134,] 314.3093  8.216851 298.0012 330.3498
[135,] 328.3810  7.754196 312.9033 343.8908
[136,] 342.4527  8.000349 326.0488 358.4052
[137,] 356.5244  8.896669 338.6709 374.2028
[138,] 370.5961 10.274386 349.3583 390.8833
[139,] 384.6679 11.968391 360.1188 408.3265
[140,] 398.7396 13.863221 370.7242 425.8283
[141,] 254.5925 12.059869 231.2390 278.4167
[142,] 265.9264 10.412073 245.6048 286.4844
[143,] 277.2604  9.059403 259.3446 294.9007
[144,] 288.5943  8.150154 272.4494 304.7301
[145,] 299.9282  7.840148 284.6514 315.5327
[146,] 311.2622  8.197653 295.5910 327.2712
[147,] 322.5961  9.144716 304.8088 340.4143
[148,] 333.9300 10.523346 313.6013 354.1574
[149,] 345.2640 12.187966 321.4943 369.0136
[150,] 356.5979 14.037197 329.1556 383.7467
[151,] 226.4472 13.756954 198.8600 252.8728
[152,] 241.6516 11.787260 218.2108 264.5349
[153,] 256.8559 10.087002 236.9095 276.6233
[154,] 272.0603  8.813520 254.8097 289.1681
[155,] 287.2646  8.168909 271.3820 303.3723
[156,] 302.4690  8.300989 286.3527 318.6346
[157,] 317.6733  9.176283 300.0661 335.4381
[158,] 332.8777 10.612461 312.2806 353.6966
[159,] 348.0820 12.416396 323.6193 372.3063
[160,] 363.2864 14.451016 334.6032 391.4206
[161,] 252.2088 12.286512 227.8871 276.6907
[162,] 261.6395 10.593317 241.0182 282.5273
[163,] 271.0701  9.178256 252.8475 289.0017
[164,] 280.5008  8.186847 264.3775 296.6874
[165,] 289.9314  7.782711 274.7527 305.2685
[166,] 299.3620  8.054736 283.6476 315.3984
[167,] 308.7927  8.941421 291.4000 326.7583
[168,] 318.2233 10.285004 298.5067 338.6181
[169,] 327.6540 11.932126 304.4997 351.2145
[170,] 337.0846 13.774325 310.3735 364.4082
[171,] 263.3229 12.271327 239.4967 288.0725
[172,] 275.1426 10.596949 254.6138 296.1505
[173,] 286.9624  9.212142 268.8947 305.1097
[174,] 298.7821  8.263786 282.2302 315.0474
[175,] 310.6019  7.910443 295.0854 326.3781
[176,] 322.4216  8.229120 306.2396 338.5978
[177,] 334.2414  9.149869 316.2541 352.3527
[178,] 346.0611 10.515709 325.6361 366.6001
[179,] 357.8809 12.177788 333.8016 381.3079
[180,] 369.7006 14.031225 341.9026 396.4682</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.1330864 12.819213  -28.14662512  22.3303843
  [2,]  -14.6555764 10.965688  -35.29254205   7.7505301
  [3,]  -42.2268664  9.389248  -59.94082971 -23.1498054
  [4,]    8.7451436  8.250286   -7.47294907  25.4063236
  [5,]   24.4900536  7.744292    9.09574460  39.8646020
  [6,]   62.6610636  7.992400   47.09760369  78.6103587
  [7,]   10.5075737  8.931990   -6.88120202  28.4132808
  [8,] -101.2148163 10.376899 -121.50617839 -80.6363395
  [9,]   19.5546937 12.148135   -4.38651165  43.6340637
 [10,]   35.6557037 14.123452    7.86447955  63.5587913
 [11,]   11.3437734 13.032219  -13.02915136  37.2326074
 [12,]   -7.9013008 11.215046  -28.87346961  14.6583069
 [13,]  -11.9662749  9.673837  -30.33309131   7.7356655
 [14,]  -12.0140490  8.558992  -28.42808839   5.1637375
 [15,]  -10.7819232  8.049652  -26.39883703   5.1264883
 [16,]   -4.3131973  8.258619  -20.19579967  11.6855063
 [17,]   -8.4216714  9.136740  -26.32143795   9.5579350
 [18,]   -6.1017456 10.517728  -26.72728735  14.7957475
 [19,]   -1.3102197 12.232437  -24.86137088  22.9860489
 [20,]    9.9313062 14.160148  -17.04385040  37.7474054
 [21,]  -13.5635771 13.099290  -39.14264579  12.1935113
 [22,]  -23.2570346 11.240385  -45.36718991  -0.9862406
 [23,]   11.7590079  9.660668   -7.38854976  30.9459542
 [24,]    5.3088504  8.516933  -11.73949173  21.8024051
 [25,]   -3.1971071  7.998449  -18.83784855  12.0596131
 [26,]  -17.0183646  8.224331  -33.40495220  -1.4216871
 [27,]   -7.0272220  9.139555  -25.49991845  10.5171134
 [28,]    8.3313205 10.566490  -12.99218218  28.6321284
 [29,]    8.6209630 12.328720  -15.84193439  32.4613598
 [30,]   -9.8479945 14.302845  -38.39538175  17.8457152
 [31,]   46.8742636 13.383592   20.22668885  72.2118208
 [32,]   20.0112968 11.440034   -2.68099638  41.9670408
 [33,]   -2.2529700  9.759461  -21.25689266  16.8290540
 [34,]   -6.6970368  8.499332  -23.32153245   9.9807149
 [35,]  -11.7533037  7.864418  -27.07439712   3.8936898
 [36,]   -5.6856705  8.004895  -21.01131648   9.9944205
 [37,]  -28.7521373  8.884057  -45.89227647 -11.8417318
 [38,]    3.5489959 10.314720  -16.86629602  23.6511382
 [39,]  -15.0833709 12.102863  -39.24995236   8.2277945
 [40,]   27.8952623 14.113256    0.02674137  55.2178601
 [41,]   14.5052794 12.900464  -11.54038390  38.6086445
 [42,]    4.4310920 11.064765  -17.67963052  25.2982940
 [43,]   13.7854046  9.515799   -5.21826457  31.7402321
 [44,]   24.6138172  8.413455    7.82994699  40.9704948
 [45,]   13.3095298  7.945841   -2.44648792  29.1382492
 [46,]  -17.1153577  8.221978  -33.68518386  -0.8977084
 [47,]  -27.8253451  9.174957  -46.18015794  -9.9412786
 [48,]    9.4510675 10.624176  -11.97551695  30.5615781
 [49,]  -39.0860199 12.396804  -63.95282226 -14.5023335
 [50,]   31.2818927 14.373684    2.40924854  59.5757195
 [51,]  -25.3892926 12.090985  -49.30926978  -2.0223859
 [52,]  -27.6936000 10.441943  -48.12249369  -7.4637318
 [53,]   -7.7996073  9.080508  -25.43583034   9.9065100
 [54,]   18.7523854  8.152069    3.02669170  34.6952345
 [55,]   16.1909781  7.812554    0.94431610  31.1304213
 [56,]   -1.5298292  8.136028  -17.64605696  14.2756371
 [57,]  132.3789635  9.051688  114.31574999 150.2919710
 [58,]   14.7926562 10.404342   -6.10270411  35.1175925
 [59,]  -11.9936511 12.047687  -36.12168971  11.3054825
 [60,]  -98.6850584 13.878847 -126.18084014 -72.0945582
 [61,]   15.9924967 12.398446   -8.90092703  39.2748290
 [62,]   11.4289420 10.684501   -9.98674027  31.5619259
 [63,]  -11.6329126  9.244552  -30.09071040   5.9036021
 [64,]    1.1313327  8.223807  -14.88919509  16.8846127
 [65,]  -11.7835220  7.788861  -26.71362680   3.3857431
 [66,]   18.9358233  8.035408    3.69543783  34.6718082
 [67,]    2.5196687  8.907036  -14.37300505  20.0889713
 [68,]    9.0569140 10.245433  -10.51738391  29.2026066
 [69,]  -16.6991407 11.894056  -39.56030364   7.3559552
 [70,]    1.7075047 13.741701  -24.50822922  29.5052716
 [71,]   21.4731697 12.575841   -2.38589903  46.3227784
 [72,]   20.6748206 10.790247    0.02619960  41.8850242
 [73,]  -23.6881285  9.281529  -41.79726933  -5.3194914
 [74,]  -23.9069776  8.203890  -39.89226946  -7.7322618
 [75,]  -11.0813267  7.739543  -26.50531041   4.1793856
 [76,]  -17.4409758  7.996057  -33.17331586  -1.9519283
 [77,]   -7.6338249  8.911398  -25.31595674   9.7933711
 [78,]    6.8378260 10.311586  -13.77131870  27.1400246
 [79,]   -0.4646230 12.028477  -24.65397068  23.2411996
 [80,]   29.5610279 13.945588    1.47498821  56.9561865
 [81,]   -9.2430449 13.444913  -35.82398880  15.9793734
 [82,]   23.3397875 11.448274    0.70907256  45.3732968
 [83,]    4.1272198  9.742280  -14.57783767  22.9168809
 [84,]   20.6825522  8.503695    4.58208717  37.2517653
 [85,]    1.5762846  7.953954  -13.93747559  16.9932898
 [86,]    5.0045170  8.232235  -11.19855204  20.6444992
 [87,]   -3.9354506  9.264220  -22.44092830  13.8537060
 [88,]  -13.8328182 10.836679  -35.43879527   6.9201678
 [89,]  -13.1457858 12.751204  -38.92077675  11.2946127
 [90,]  -11.4093534 14.876308  -41.51255943  17.3695761
 [91,]   26.4341034 13.070015    0.48665458  51.5518869
 [92,]    8.7005506 11.199762  -13.67698871  30.3516622
 [93,]  -32.6668023  9.596613  -51.61744758 -14.3535946
 [94,]    2.6714449  8.414644  -13.81946942  18.8634056
 [95,]    3.1088921  7.846556  -12.31119552  18.1666349
 [96,]   10.0422392  8.023814   -5.97871722  25.6469449
 [97,]    3.2910864  8.902004  -14.16113643  20.3908252
 [98,]   -3.4494665 10.303432  -23.67907530  16.3957147
 [99,]   16.5497807 12.046854   -6.78187191  39.7889427
[100,]    0.4294279 14.005128  -26.81625553  27.5880221
[101,]    9.2489375 12.763968  -14.83245188  35.1481812
[102,]   -8.0611591 10.923424  -28.84267358  13.8609116
[103,]  -10.9758557  9.367344  -28.90344581   7.8296932
[104,]   -6.5030523  8.258131  -22.49024030   9.9939349
[105,]  -22.2383489  7.789093  -37.51657625  -7.0821781
[106,]  -14.6978455  8.072598  -30.25815359   1.3643291
[107,]  -14.4310421  9.038106  -31.62461636   3.6944047
[108,]    0.5825613 10.499120  -19.69168157  21.3483892
[109,]   17.2375647 12.280038   -6.51361169  41.6210169
[110,]   21.0784681 14.261513   -6.60789146  49.7785195
[111,]   17.4739181 12.988041   -7.13267860  43.7075273
[112,]  -12.3836829 11.143640  -33.48410039   9.8953695
[113,]  -16.6484838  9.583027  -34.99143793   2.3841119
[114,]  -34.3410848  8.464650  -50.93924076 -17.6424215
[115,]  -37.9667857  7.976740  -53.92275779 -22.3120507
[116,]    5.8263133  8.232172  -10.13655983  21.7246674
[117,]   38.5310124  9.169031   21.01786370  56.0735748
[118,]    4.9898115 10.608289  -15.38443588  24.9923655
[119,]   19.5435105 12.375890   -4.33132306  43.1184746
[120,]   -2.9060904 14.351017  -31.09246466  24.8020988
[121,]   -5.0726691 12.459093  -30.06761512  19.6806988
[122,]   36.9346168 10.752912   15.39397843  58.2417237
[123,]   -0.7528972  9.334963  -19.33371154  17.7149896
[124,]    2.4184887  8.353340  -14.04665371  18.9903359
[125,]  -13.8670254  7.970908  -29.20567346   1.7911130
[126,]   11.4153606  8.271201   -4.79189645  27.7155008
[127,]  -12.9954535  9.187518  -31.61563718   4.5936571
[128,]  -41.6703676 10.560707  -63.31599066 -21.4517590
[129,]    5.7521184 12.237928  -19.44750945  29.0312038
[130,]   24.2520043 14.111186   -4.62911715  51.0402321
[131,]  -50.4170176 12.541397  -75.47920214 -26.3206813
[132,]   12.0280655 10.774794   -9.07825689  32.8162135
[133,]   26.6409486  9.282934    8.44372168  44.7136950
[134,]   32.5462318  8.216851   16.50570874  48.8543078
[135,]   20.3592149  7.754196    4.84935551  35.8368981
[136,]   10.3759980  8.000349   -5.57647473  26.7798519
[137,]   -2.0978188  8.896669  -19.77621257  15.7556837
[138,]  -10.1635357 10.274386  -30.45070643  11.0742976
[139,]   -9.0272526 11.968391  -32.68591407  15.5217829
[140,]  -10.1978694 13.863221  -37.28663433  17.8174998
[141,]   17.3310167 12.059869   -6.49317354  40.6844723
[142,]    2.5104822 10.412073  -18.04751212  22.8321258
[143,]  -20.0179523  9.059403  -37.65825210  -2.1022500
[144,]  -10.9376869  8.150154  -27.07351224   5.2071981
[145,]   14.8939786  7.840148   -0.71047490  30.1707836
[146,]    5.9513440  8.197653  -10.05765276  21.6225347
[147,]  -24.4607905  9.144716  -42.27902963  -6.6735114
[148,]   14.1928749 10.523346   -6.03452735  34.5216422
[149,]   -4.9839596 12.187966  -28.73364897  18.7856543
[150,]    9.9152058 14.037197  -17.23360276  37.3575216
[151,]   -1.1832061 13.756954  -27.60880355  26.4039564
[152,]   -7.1280605 11.787260  -30.01139592  16.3126661
[153,]  -17.9551149 10.087002  -37.72254362   1.9913091
[154,]  -31.5872693  8.813520  -48.69506093 -14.3366527
[155,]  -19.7273237  8.168909  -35.83499175  -3.8446939
[156,]   41.7247219  8.300989   25.55907879  57.8409788
[157,]  -36.5252325  9.176283  -54.29002279 -18.9179554
[158,]   14.7078131 10.612461   -6.11110818  35.3049359
[159,]   17.0809587 12.416396   -7.14329790  41.5436614
[160,]    8.9424043 14.451016  -19.19178057  37.6256375
[161,]   17.6715616 12.286512   -6.81026283  41.9933013
[162,]   10.8033206 10.593317  -10.08452738  31.4246340
[163,]    6.8287796  9.178256  -11.10283762  25.0514299
[164,]    1.2887386  8.186847  -14.89793507  17.4119894
[165,]  -10.7609023  7.782711  -26.09802651   4.4178126
[166,]  -14.8500433  8.054736  -30.88637365   0.8644366
[167,]  -49.5268843  8.941421  -67.49251462 -32.1341813
[168,]  -13.5927253 10.285004  -33.98747638   6.1239233
[169,]   23.1267337 11.932126   -0.43381769  46.2810187
[170,]   32.3845927 13.774325    5.06103691  59.0956845
[171,]    6.0888387 12.271327  -18.66082772  29.9149642
[172,]   -1.6686153 10.596949  -22.67650031  18.8601644
[173,]   10.6344306  9.212142   -7.51293437  28.7020781
[174,]   11.8494766  8.263786   -4.41579503  28.4013698
[175,]  -23.4292774  7.910443  -39.20546927  -7.9128324
[176,]    7.1859686  8.229120   -8.99015600  23.3679785
[177,]    0.2404146  9.149869  -17.87089016  18.2276567
[178,]   -2.8412394 10.515709  -23.38020984  17.5837606
[179,]   11.2608066 12.177788  -12.16623968  35.3401365
[180,]   -5.5770475 14.031225  -32.34457796  22.2209685</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.5 14.3
p_loo        19.0  3.3
looic      1769.0 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1402      
 (0.5, 0.7]   (ok)         2    1.1%   130       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.6
p_loo        34.1  8.7
looic      1722.1 45.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   1042      
 (0.5, 0.7]   (ok)         5    2.8%   446       
   (0.7, 1]   (bad)        1    0.6%   76        
   (1, Inf)   (very bad)   2    1.1%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.4      11.9  
fit_sleep1 -92.3      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.5 14.3
p_loo        19.0  3.3
looic      1769.0 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1402      
 (0.5, 0.7]   (ok)         2    1.1%   130       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.6
p_loo        34.1  8.7
looic      1722.1 45.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   1042      
 (0.5, 0.7]   (ok)         5    2.8%   446       
   (0.7, 1]   (bad)        1    0.6%   76        
   (1, Inf)   (very bad)   2    1.1%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.1     22.6        34.1    8.7   1722.1
fit_sleep2  -23.4      11.9  -884.5     14.3        19.0    3.3   1769.0
fit_sleep1  -92.3      21.2  -953.3     10.5         3.2    0.5   1906.7
           se_looic
fit_sleep3   45.3  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.552470e-41 6.604812e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.89       1.6     0.26     5.48       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.11       1.6    -3.35     2.92       5.27      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.15      
[4] StanHeaders_2.26.15 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.13.0          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.4.0      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.0         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.9        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
