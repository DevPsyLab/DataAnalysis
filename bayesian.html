<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.77      6.69    15.39    41.52 1.00     2055     2525
sd(Days)                6.58      1.48     4.20    10.00 1.00     1459     1934
cor(Intercept,Days)     0.09      0.30    -0.45     0.69 1.00     1053     1620

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.08      7.24   237.15   265.92 1.00     1529     1970
Days         10.48      1.67     7.21    13.74 1.00     1515     1945

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.94      1.56    23.08    29.19 1.00     3481     2635

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9075  13.05769 228.7820 279.6736
309 211.5814  13.56698 185.1195 238.6809
310 212.9266  13.27587 185.2985 237.9172
330 274.1699  13.54216 248.8157 301.2098
331 273.0216  13.20590 248.0521 300.0177
332 260.0290  12.67793 235.8303 284.9684
333 267.9307  12.54654 243.5377 293.5516
334 244.3561  12.24712 219.4242 267.7955
335 250.6891  13.35416 224.3807 277.1924
337 285.9053  12.94042 261.0232 311.8490
349 226.4596  13.08767 199.8280 251.2038
350 238.7607  13.43537 212.3878 264.3128
351 255.5724  12.34442 232.0331 279.9964
352 271.6680  12.15076 247.7629 295.6466
369 254.5087  12.28204 230.1377 278.7169
370 226.2462  13.49418 199.5166 252.1986
371 252.1571  12.25077 228.5313 276.1369
372 263.5936  12.51667 239.5828 288.9896

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6376397  2.523267 14.8298014 24.548220
309  1.7132804  2.486611 -3.2725998  6.638758
310  4.9655166  2.475942  0.2134232  9.987259
330  5.8416620  2.575996  0.9039442 10.799105
331  7.5103333  2.497898  2.5054737 12.338258
332 10.2974066  2.397600  5.7108395 14.875276
333 10.2736344  2.387878  5.5471936 14.825819
334 11.4995178  2.358180  6.8299175 16.066924
335 -0.1908933  2.614533 -5.2872066  4.963001
337 19.1670350  2.454218 14.4138365 23.966103
349 11.5517265  2.448955  6.8940987 16.368686
350 17.0255420  2.555118 12.1479087 22.152884
351  7.5356879  2.375144  2.8410979 12.181819
352 14.1044464  2.343620  9.4786490 18.729031
369 11.3968449  2.369140  6.8771088 15.985198
370 15.2066625  2.559702 10.3380943 20.285978
371  9.5084820  2.309394  4.8332447 13.955283
372 11.7878160  2.309065  7.1672559 16.344137</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9075 13.057689 228.7820 279.6736
  [2,] 273.5451 11.156960 251.9916 295.8342
  [3,] 293.1827  9.549137 274.9252 312.1948
  [4,] 312.8204  8.404048 296.4274 329.6964
  [5,] 332.4580  7.924885 316.9601 347.9936
  [6,] 352.0957  8.228810 336.0505 367.7689
  [7,] 371.7333  9.238862 353.6186 389.2365
  [8,] 391.3709 10.757955 370.3492 411.8536
  [9,] 411.0086 12.603347 386.4158 434.9913
 [10,] 430.6462 14.652265 401.9473 458.6520
 [11,] 211.5814 13.566980 185.1195 238.6809
 [12,] 213.2947 11.699308 190.1561 236.5470
 [13,] 215.0080 10.102035 194.9326 235.1213
 [14,] 216.7212  8.921598 199.1803 234.0940
 [15,] 218.4345  8.336976 202.0831 234.5907
 [16,] 220.1478  8.472420 203.5090 236.6076
 [17,] 221.8611  9.296510 203.4977 240.2123
 [18,] 223.5744 10.650576 202.5359 244.2063
 [19,] 225.2876 12.361671 200.9618 249.3040
 [20,] 227.0009 14.302221 198.6163 254.6049
 [21,] 212.9266 13.275868 185.2985 237.9172
 [22,] 217.8921 11.399222 194.8664 239.8324
 [23,] 222.8577  9.792674 202.6668 241.7352
 [24,] 227.8232  8.608788 210.5395 244.7568
 [25,] 232.7887  8.036577 217.0271 248.6528
 [26,] 237.7542  8.205029 222.0804 254.1165
 [27,] 242.7197  9.072982 225.1049 261.1894
 [28,] 247.6852 10.467860 227.1870 268.9678
 [29,] 252.6508 12.210395 229.0479 277.6949
 [30,] 257.6163 14.172931 230.4548 286.2272
 [31,] 274.1699 13.542162 248.8157 301.2098
 [32,] 280.0115 11.550327 257.9213 303.0393
 [33,] 285.8532  9.833690 266.8825 305.7206
 [34,] 291.6949  8.559461 275.2579 308.9663
 [35,] 297.5365  7.943476 281.9593 312.9474
 [36,] 303.3782  8.136631 287.7063 319.2479
 [37,] 309.2199  9.087477 291.6822 327.2531
 [38,] 315.0615 10.593924 294.7824 336.4305
 [39,] 320.9032 12.455991 297.5950 346.1224
 [40,] 326.7448 14.537666 299.1217 355.8290
 [41,] 273.0216 13.205904 248.0521 300.0177
 [42,] 280.5319 11.306359 258.9109 303.4654
 [43,] 288.0423  9.682488 269.3526 307.8738
 [44,] 295.5526  8.493903 279.3652 312.8474
 [45,] 303.0629  7.938588 287.6372 318.6300
 [46,] 310.5733  8.147084 294.3096 326.5488
 [47,] 318.0836  9.066849 299.5874 336.0560
 [48,] 325.5939 10.512827 304.6299 346.5064
 [49,] 333.1043 12.300825 308.8744 357.5134
 [50,] 340.6146 14.303148 312.1331 369.0329
 [51,] 260.0290 12.677927 235.8303 284.9684
 [52,] 270.3264 10.897750 249.4066 291.9511
 [53,] 280.6238  9.396226 262.4632 299.4507
 [54,] 290.9212  8.325512 274.7851 307.3714
 [55,] 301.2186  7.863599 286.0748 316.6462
 [56,] 311.5160  8.115122 295.4177 327.3349
 [57,] 321.8134  9.020598 304.1393 339.7679
 [58,] 332.1108 10.410771 311.2402 352.9894
 [59,] 342.4082 12.119986 317.4212 366.2646
 [60,] 352.7056 14.032141 324.3437 380.0596
 [61,] 267.9307 12.546539 243.5377 293.5516
 [62,] 278.2043 10.799388 256.9058 300.3347
 [63,] 288.4780  9.340333 270.1020 307.2508
 [64,] 298.7516  8.322306 282.6789 315.4463
 [65,] 309.0252  7.917301 294.0399 324.9914
 [66,] 319.2989  8.216475 303.5376 335.9582
 [67,] 329.5725  9.151021 311.9535 348.4505
 [68,] 339.8461 10.553475 319.9204 361.5409
 [69,] 350.1198 12.264355 326.7258 375.0052
 [70,] 360.3934 14.172399 332.9566 389.1538
 [71,] 244.3561 12.247125 219.4242 267.7955
 [72,] 255.8556 10.505978 234.5564 276.2943
 [73,] 267.3551  9.048817 249.2175 284.6909
 [74,] 278.8547  8.031727 263.2286 294.6672
 [75,] 290.3542  7.632706 275.4167 305.3208
 [76,] 301.8537  7.945426 286.3718 317.7969
 [77,] 313.3532  8.895134 296.1929 331.4163
 [78,] 324.8527 10.307233 304.9753 345.9671
 [79,] 336.3522 12.019846 312.7032 360.5621
 [80,] 347.8518 13.922514 320.1768 375.9421
 [81,] 250.6891 13.354164 224.3807 277.1924
 [82,] 250.4982 11.332642 228.3541 273.0452
 [83,] 250.3073  9.601846 231.4025 269.4314
 [84,] 250.1164  8.344678 233.7865 266.7830
 [85,] 249.9256  7.793808 234.8621 265.4952
 [86,] 249.7347  8.094738 234.0144 265.9927
 [87,] 249.5438  9.163935 231.8363 267.9821
 [88,] 249.3529 10.775072 228.3433 271.1987
 [89,] 249.1620 12.723923 224.7679 275.0490
 [90,] 248.9711 14.878367 220.4186 279.1559
 [91,] 285.9053 12.940420 261.0232 311.8490
 [92,] 305.0723 11.093066 283.4458 327.1342
 [93,] 324.2393  9.523871 305.7429 343.0729
 [94,] 343.4064  8.390382 327.0449 359.5922
 [95,] 362.5734  7.882848 347.0051 377.8871
 [96,] 381.7405  8.119509 365.6242 397.4920
 [97,] 400.9075  9.042121 382.9926 419.1225
 [98,] 420.0745 10.470904 399.4491 440.8601
 [99,] 439.2416 12.229722 415.2418 463.3364
[100,] 458.4086 14.196434 430.6877 486.4626
[101,] 226.4596 13.087669 199.8280 251.2038
[102,] 238.0113 11.261517 215.3654 259.5460
[103,] 249.5630  9.713454 229.9941 268.2157
[104,] 261.1147  8.595079 243.7214 277.7399
[105,] 272.6665  8.086677 256.1636 288.5008
[106,] 284.2182  8.301088 267.8593 300.3177
[107,] 295.7699  9.187847 277.8465 313.6599
[108,] 307.3217 10.579214 286.5855 327.5839
[109,] 318.8734 12.305192 294.4863 342.4671
[110,] 330.4251 14.244666 302.3917 358.1011
[111,] 238.7607 13.435367 212.3878 264.3128
[112,] 255.7862 11.462924 233.2032 277.8252
[113,] 272.8118  9.764498 253.4793 291.9365
[114,] 289.8373  8.505849 273.1572 306.5924
[115,] 306.8629  7.900049 291.5075 322.5161
[116,] 323.8884  8.095020 308.0965 339.5914
[117,] 340.9139  9.039092 323.0216 358.1077
[118,] 357.9395 10.532724 336.8930 378.0201
[119,] 374.9650 12.378555 350.5930 398.6838
[120,] 391.9906 14.442168 364.0490 419.6711
[121,] 255.5724 12.344421 232.0331 279.9964
[122,] 263.1081 10.604335 242.3721 283.7674
[123,] 270.6437  9.154329 252.8417 288.7735
[124,] 278.1794  8.150716 261.6387 294.2183
[125,] 285.7151  7.768476 270.2176 300.7130
[126,] 293.2508  8.096104 277.0730 308.9710
[127,] 300.7865  9.056886 282.9659 318.3767
[128,] 308.3222 10.478076 287.7307 328.8414
[129,] 315.8579 12.199819 291.5413 339.4601
[130,] 323.3936 14.112538 295.3206 350.6664
[131,] 271.6680 12.150755 247.7629 295.6466
[132,] 285.7724 10.465201 264.9813 306.3514
[133,] 299.8769  9.076626 282.2658 317.8377
[134,] 313.9813  8.138487 297.9290 329.8236
[135,] 328.0857  7.814723 312.5474 343.5083
[136,] 342.1902  8.178627 325.8430 358.0606
[137,] 356.2946  9.148503 338.1067 373.7606
[138,] 370.3991 10.558664 349.8455 390.5504
[139,] 384.5035 12.258090 360.3369 408.3928
[140,] 398.6080 14.142887 370.7250 426.1989
[141,] 254.5087 12.282045 230.1377 278.7169
[142,] 265.9055 10.568954 245.2577 286.7777
[143,] 277.3024  9.153284 259.2585 295.2386
[144,] 288.6992  8.190730 272.6236 304.2938
[145,] 300.0960  7.849787 284.6327 315.4802
[146,] 311.4929  8.208283 295.5641 327.6120
[147,] 322.8897  9.184677 304.8496 341.1482
[148,] 334.2866 10.609728 313.6101 355.3773
[149,] 345.6834 12.328829 321.7839 369.8859
[150,] 357.0803 14.235847 329.6204 384.9385
[151,] 226.2462 13.494181 199.5166 252.1986
[152,] 241.4528 11.543608 218.4321 263.5377
[153,] 256.6595  9.875273 237.1954 275.5023
[154,] 271.8661  8.653976 254.4757 288.7716
[155,] 287.0728  8.084908 270.7894 303.1473
[156,] 302.2795  8.303272 286.0639 318.6369
[157,] 317.4861  9.253490 299.7525 335.8207
[158,] 332.6928 10.743089 312.3378 353.8582
[159,] 347.8995 12.581932 324.0374 372.6150
[160,] 363.1061 14.638996 335.1714 392.1996
[161,] 252.1571 12.250772 228.5313 276.1369
[162,] 261.6655 10.571717 241.2578 282.2720
[163,] 271.1740  9.171019 253.2397 289.1749
[164,] 280.6825  8.192714 264.3779 296.7352
[165,] 290.1910  7.797445 274.5451 305.6082
[166,] 299.6995  8.071328 283.8648 316.0336
[167,] 309.2079  8.953163 291.8713 327.1323
[168,] 318.7164 10.287785 298.5577 339.3694
[169,] 328.2249 11.924114 304.6845 351.6624
[170,] 337.7334 13.754893 309.9239 364.7255
[171,] 263.5936 12.516671 239.5828 288.9896
[172,] 275.3814 10.782688 254.7851 297.1405
[173,] 287.1693  9.302110 269.0614 305.5305
[174,] 298.9571  8.213142 283.2202 315.3014
[175,] 310.7449  7.684121 295.9178 325.6536
[176,] 322.5327  7.829387 307.3412 337.8368
[177,] 334.3205  8.614896 317.5036 350.8603
[178,] 346.1083  9.889244 327.0150 365.1423
[179,] 357.8961 11.490928 335.8491 380.0021
[180,] 369.6840 13.302228 343.8678 395.1781</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.3474631 13.057689  -30.11360071  20.7780137
  [2,]  -14.8404029 11.156960  -37.12953534   6.7130764
  [3,]  -42.3821426  9.549137  -61.39419732 -24.1245859
  [4,]    8.6194177  8.404048   -8.25655422  25.0123568
  [5,]   24.3938779  7.924885    8.85832065  39.8918262
  [6,]   62.5944382  8.228810   46.92122687  78.6395516
  [7,]   10.4704985  9.238862   -7.03273956  28.5852251
  [8,] -101.2223413 10.757955 -121.70495651 -80.2005612
  [9,]   19.5767190 12.603347   -4.40595513  44.1695056
 [10,]   35.7072793 14.652265    7.70153775  64.4062014
 [11,]   11.1525012 13.566980  -15.94701907  37.6144141
 [12,]   -8.0288792 11.699308  -31.28115206  15.1096820
 [13,]  -12.0301596 10.102035  -32.14345980   8.0451875
 [14,]  -12.0142400  8.921598  -29.38701799   5.5267069
 [15,]  -10.7184204  8.336976  -26.87458456   5.6329536
 [16,]   -4.1860008  8.472420  -20.64576609  12.4528116
 [17,]   -8.2307812  9.296510  -26.58195256  10.1326204
 [18,]   -5.8471616 10.650576  -26.47911026  15.1912508
 [19,]   -0.9919420 12.361671  -25.00827142  23.3338985
 [20,]   10.3132776 14.302221  -17.29074938  38.6979326
 [21,]  -13.8727304 13.275868  -38.86330827  13.7553729
 [22,]  -23.5599470 11.399222  -45.50019855  -0.5342321
 [23,]   11.4623364  9.792674   -7.41522384  31.6531991
 [24,]    5.0184198  8.608788  -11.91519473  22.3021245
 [25,]   -3.4812968  8.036577  -19.34543864  12.2802981
 [26,]  -17.2963134  8.205029  -33.65860250  -1.6225035
 [27,]   -7.2989300  9.072982  -25.76862190  10.3159135
 [28,]    8.0658534 10.467860  -13.21674235  28.5641028
 [29,]    8.3617368 12.210395  -16.68235911  31.9645916
 [30,]  -10.1009798 14.172931  -38.71189657  17.0605247
 [31,]   47.3727159 13.542162   20.33279281  72.7269234
 [32,]   20.3886539 11.550327   -2.63909649  42.4789302
 [33,]   -1.9967081  9.833690  -21.86413586  16.9739694
 [34,]   -6.5618701  8.559461  -23.83334860   9.8750918
 [35,]  -11.7392321  7.943476  -27.15011382   3.8379542
 [36,]   -5.7926941  8.136631  -21.66244626   9.8791769
 [37,]  -28.9802560  9.087477  -47.01352108 -11.4425775
 [38,]    3.1997820 10.593924  -18.16918560  23.4788652
 [39,]  -15.5536800 12.455991  -40.77292294   7.7545269
 [40,]   27.3038580 14.537666   -1.78031660  54.9270068
 [41,]   14.5863033 13.205904  -12.40975957  39.5558373
 [42,]    4.4680700 11.306359  -18.46543526  26.0891177
 [43,]   13.7783367  9.682488   -6.05324795  32.4679580
 [44,]   24.5627034  8.493903    7.26789342  40.7500579
 [45,]   13.2143701  7.938588   -2.35265878  28.6400639
 [46,]  -17.2545633  8.147084  -33.23009768  -0.9909027
 [47,]  -28.0085966  9.066849  -45.98096998  -9.5124299
 [48,]    9.2237701 10.512827  -11.68871876  30.1878183
 [49,]  -39.3573632 12.300825  -63.76653331 -15.1275385
 [50,]   30.9665034 14.303148    2.54820956  59.4479837
 [51,]  -25.1683644 12.677927  -50.10776684  -0.9697449
 [52,]  -27.5145710 10.897750  -49.13934270  -6.5947896
 [53,]   -7.6624777  9.396226  -26.48942262  10.4980728
 [54,]   18.8476157  8.325512    2.39737229  34.9837413
 [55,]   16.2443091  7.863599    0.81670810  31.3881217
 [56,]   -1.5183976  8.115122  -17.33731190  14.5799230
 [57,]  132.3484958  9.020598  114.39400247 150.0226104
 [58,]   14.7202892 10.410771   -6.15825990  35.5909220
 [59,]  -12.1079175 12.119986  -35.96428439  12.8790503
 [60,]  -98.8412241 14.032141 -126.19516891 -70.4792792
 [61,]   15.9117095 12.546539   -9.70922545  40.3047344
 [62,]   11.3506750 10.799388  -10.77966344  32.6492458
 [63,]  -11.7086594  9.340333  -30.48152180   6.6673374
 [64,]    1.0581062  8.322306  -15.63659793  17.1308002
 [65,]  -11.8542283  7.917301  -27.82040247   3.1310870
 [66,]   18.8676373  8.216475    2.20825897  34.6288816
 [67,]    2.4540029  9.151021  -16.42398093  20.0730215
 [68,]    8.9937684 10.553475  -12.70102792  28.9195333
 [69,]  -16.7597660 12.264355  -41.64521913   6.6341517
 [70,]    1.6493996 14.172399  -27.11103553  29.0861886
 [71,]   21.1170028 12.247125   -2.32240193  46.0488732
 [72,]   20.3455849 10.505978   -0.09312019  41.6447802
 [73,]  -23.9904329  9.048817  -41.32617176  -5.8528088
 [74,]  -24.1823508  8.031727  -39.99494275  -8.5563400
 [75,]  -11.3297686  7.632706  -26.29642065   3.6076919
 [76,]  -17.6624864  7.945426  -33.60574499  -2.1806320
 [77,]   -7.8284043  8.895134  -25.89148268   9.3318770
 [78,]    6.6701779 10.307233  -14.44424984  26.5476316
 [79,]   -0.6053400 12.019846  -24.81515914  23.0437495
 [80,]   29.4472422 13.922514    1.35688885  57.1222126
 [81,]   -9.0808270 13.354164  -35.58406123  17.2275935
 [82,]   23.4489663 11.332642    0.90200797  45.5930511
 [83,]    4.1833596  9.601846  -14.94071459  23.0881719
 [84,]   20.6856529  8.344678    4.01914069  37.0155858
 [85,]    1.5263463  7.793808  -14.04331881  16.5897832
 [86,]    4.9015396  8.094738  -11.35652114  20.6218064
 [87,]   -4.0914671  9.163935  -22.52981044  13.6159598
 [88,]  -14.0418738 10.775072  -35.88772670   6.9677365
 [89,]  -13.4078805 12.723923  -39.29488710  10.9862400
 [90,]  -11.7244872 14.878367  -41.90925323  16.8280000
 [91,]   26.4613201 12.940420    0.51756523  51.3434413
 [92,]    8.7334851 11.093066  -13.32836301  30.3599967
 [93,]  -32.6281499  9.523871  -51.46166600 -14.1316512
 [94,]    2.7158151  8.390382  -13.47001118  19.0773432
 [95,]    3.1589801  7.882848  -12.15470347  18.7273344
 [96,]   10.0980451  8.119509   -5.65346665  26.2142905
 [97,]    3.3526101  9.042121  -14.86242616  21.2675264
 [98,]   -3.3822249 10.470904  -24.16776849  17.2432193
 [99,]   16.6227401 12.229722   -7.47207901  40.6225441
[100,]    0.5081051 14.196434  -27.54591569  28.2289999
[101,]    9.6436300 13.087669  -15.10059915  36.2752030
[102,]   -7.6945965 11.261517  -29.22928848  14.9513029
[103,]  -10.6374230  9.713454  -29.29010595   8.9315340
[104,]   -6.1927495  8.595079  -22.81790472  11.2005718
[105,]  -21.9561760  8.086677  -37.79052450  -5.4533340
[106,]  -14.4438025  8.301088  -30.54326970   1.9151259
[107,]  -14.2051290  9.187847  -32.09512139   3.7182938
[108,]    0.7803445 10.579214  -19.48190738  21.5165393
[109,]   17.4072180 12.305192   -6.18649284  41.7943194
[110,]   21.2199915 14.244666   -6.45603812  49.2534472
[111,]   17.5361133 13.435367   -8.01598812  43.9089846
[112,]  -12.3319287 11.462924  -34.37089170  10.2511318
[113,]  -16.6071707  9.764498  -35.73189819   2.7253080
[114,]  -34.3102127  8.505849  -51.06532065 -17.6301141
[115,]  -37.9463547  7.900049  -53.59956510 -22.5909740
[116,]    5.8363033  8.095020   -9.86665485  21.6282099
[117,]   38.5305613  9.039092   21.33682797  56.4228625
[118,]    4.9789193 10.532724  -15.10168579  26.0253751
[119,]   19.5221773 12.378555   -4.19662511  43.8942045
[120,]   -2.9378647 14.442168  -30.61837162  25.0037046
[121,]   -5.0458628 12.344421  -29.46991981  18.4933630
[122,]   36.9495494 10.604335   16.29022023  57.6854571
[123,]   -0.7498385  9.154329  -18.87962170  17.0522117
[124,]    2.4096737  8.150716  -13.62917126  18.9503573
[125,]  -13.8877142  7.768476  -28.88558507   1.6098020
[126,]   11.3827980  8.096104   -4.33743588  27.5606265
[127,]  -13.0398899  9.056886  -30.63005017   4.7807063
[128,]  -41.7266777 10.478076  -62.24588954 -21.1352362
[129,]    5.6839344 12.199819  -17.91834368  30.0005060
[130,]   24.1719465 14.112538   -3.10092495  52.2448504
[131,]  -49.9908599 12.150755  -73.96946531 -26.0858210
[132,]   12.4214937 10.465201   -8.15747416  33.2125744
[133,]   27.0016473  9.076626    9.04080316  44.6127139
[134,]   32.8742010  8.138487   17.03194115  48.9265296
[135,]   20.6544546  7.814723    5.23185799  36.1928405
[136,]   10.6385082  8.178627   -5.23189692  26.9857050
[137,]   -1.8680382  9.148503  -19.33404629  16.3199328
[138,]   -9.9664845 10.558664  -30.11783410  10.5870916
[139,]   -8.8629309 12.258090  -32.75215869  15.3036601
[140,]  -10.0662773 14.142887  -37.65723258  17.8167360
[141,]   17.4148351 12.282045   -6.79339060  41.7858428
[142,]    2.5313901 10.568954  -18.34080560  23.1791721
[143,]  -20.0599548  9.153284  -37.99620266  -2.0160628
[144,]  -11.0425997  8.190730  -26.63719889   5.0330129
[145,]   14.7261554  7.849787   -0.65795376  30.1895047
[146,]    5.7206105  8.208283  -10.39848835  21.6493503
[147,]  -24.7544344  9.184677  -43.01293069  -6.7143199
[148,]   13.8363206 10.609728   -7.25443830  34.5128295
[149,]   -5.4034243 12.328829  -29.60588432  18.4961019
[150,]    9.4328308 14.235847  -18.42537201  36.8927037
[151,]   -0.9821616 13.494181  -26.93461517  25.7473958
[152,]   -6.9293241 11.543608  -29.01421632  16.0914017
[153,]  -17.7586867  9.875273  -36.60150313   1.7053966
[154,]  -31.3931492  8.653976  -48.29863347 -14.0027177
[155,]  -19.5355117  8.084908  -35.60999498  -3.2520959
[156,]   41.9142257  8.303272   25.55675974  58.1297867
[157,]  -36.3380368  9.253490  -54.67258707 -18.6043993
[158,]   14.8927006 10.743089   -6.27274788  35.2477297
[159,]   17.2635381 12.581932   -7.45198860  41.1256138
[160,]    9.1226755 14.638996  -19.97078982  37.0573910
[161,]   17.7233478 12.250772   -6.25646733  41.3491271
[162,]   10.7772658 10.571717   -9.82915834  31.1850137
[163,]    6.7248838  9.171019  -11.27599431  24.6591617
[164,]    1.1070018  8.192714  -14.94570913  17.4116138
[165,]  -11.0204802  7.797445  -26.43767021   4.6254163
[166,]  -15.1874621  8.071328  -31.52163903   0.6471583
[167,]  -49.9421441  8.953163  -67.86654597 -32.6055345
[168,]  -14.0858261 10.287785  -34.73879880   6.0728698
[169,]   22.5557919 11.924114   -0.88172914  46.0962027
[170,]   31.7358099 13.754893    4.74371566  59.5453269
[171,]    5.8180810 12.516671  -19.57786983  29.8289439
[172,]   -1.9074350 10.782688  -23.66650137  18.6889110
[173,]   10.4275491  9.302110   -7.93365491  28.5354331
[174,]   11.6745331  8.213142   -4.66981739  27.4113860
[175,]  -23.5722829  7.684121  -38.48101120  -8.7451844
[176,]    7.0749012  7.829387   -8.22915056  22.2663776
[177,]    0.1612852  8.614896  -16.37852621  16.9781885
[178,]   -2.8884307  9.889244  -21.92239261  16.2049325
[179,]   11.2455533 11.490928  -10.86040872  33.2925974
[180,]   -5.5603627 13.302228  -31.05446567  20.2557524</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.3
p_loo        19.3  3.3
looic      1769.8 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1407      
 (0.5, 0.7]   (ok)         3    1.7%   178       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.3
p_loo        34.0  8.5
looic      1722.2 44.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   908       
 (0.5, 0.7]   (ok)         6    3.3%   403       
   (0.7, 1]   (bad)        1    0.6%   23        
   (1, Inf)   (very bad)   2    1.1%   21        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.8      11.6  
fit_sleep1 -92.3      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.3
p_loo        19.3  3.3
looic      1769.8 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1407      
 (0.5, 0.7]   (ok)         3    1.7%   178       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.3
p_loo        34.0  8.5
looic      1722.2 44.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   908       
 (0.5, 0.7]   (ok)         6    3.3%   403       
   (0.7, 1]   (bad)        1    0.6%   23        
   (1, Inf)   (very bad)   2    1.1%   21        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.1     22.3        34.0    8.5   1722.2
fit_sleep2  -23.8      11.6  -884.9     14.3        19.3    3.3   1769.8
fit_sleep1  -92.3      21.0  -953.3     10.5         3.2    0.5   1906.7
           se_looic
fit_sleep3   44.6  
fit_sleep2   28.6  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.573476e-41 4.604531e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.89      1.63     0.14     5.48       0.05      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.11      1.63     -3.5     3.05       5.24      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-33         Matrix_1.5-4.1     

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.5      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.1       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.32       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
