<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.81      6.92    15.49    42.09 1.00     1750     2398
sd(Days)                6.50      1.47     4.14     9.99 1.00     1341     2143
cor(Intercept,Days)     0.10      0.31    -0.48     0.69 1.00      873     1584

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.28      7.19   237.34   265.57 1.00     1714     2395
Days         10.44      1.68     7.15    13.83 1.01     1158     1953

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.97      1.60    23.06    29.36 1.00     3461     2806

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.7707  13.28333 227.8443 279.5336
309 211.2698  13.39683 185.0355 237.5862
310 213.1803  13.42466 186.0227 239.0678
330 274.1177  13.61659 248.9809 301.5750
331 273.1170  12.84331 249.5170 299.9754
332 260.4225  12.23007 236.1498 284.7996
333 268.0054  12.47282 245.0839 293.4631
334 244.3152  12.40574 219.6893 267.9496
335 250.4756  13.64849 224.5876 277.9017
337 286.1520  12.92929 261.2307 311.4529
349 227.2621  12.58867 201.5697 250.9930
350 239.2356  13.00538 213.0857 263.4970
351 255.4992  12.72770 230.6708 280.9754
352 271.9636  12.55449 248.3987 296.6795
369 254.5277  11.75289 231.8832 277.6218
370 226.8530  13.34073 199.4382 251.9755
371 251.9342  12.29700 227.9214 276.6547
372 263.3347  12.24900 239.4684 287.6156

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.4946120  2.529514 14.78728404 24.632446
309  1.8243243  2.563966 -3.20880803  6.863339
310  4.9087352  2.495460  0.09393069  9.837377
330  5.8239189  2.530903  0.68116942 10.619094
331  7.4892537  2.484413  2.39161483 12.218767
332 10.2495257  2.361640  5.68157487 15.016321
333 10.2923007  2.374148  5.60834188 14.793755
334 11.4943990  2.331840  6.99344226 16.165740
335 -0.1876486  2.623430 -5.38312793  4.648272
337 19.1067078  2.440738 14.43771471 23.889767
349 11.4947476  2.415180  6.78192992 16.341788
350 16.9422722  2.513475 12.15175783 22.016787
351  7.5491079  2.427336  2.52993956 12.218544
352 14.0318409  2.383194  9.47038102 18.819868
369 11.3648873  2.250983  6.90205112 15.802400
370 15.0848922  2.466443 10.53368733 20.148287
371  9.4927674  2.338751  4.70415695 14.075676
372 11.7780992  2.367616  7.11856720 16.458983</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.7707 13.283333 227.8443 279.5336
  [2,] 274.2654 11.381191 251.2096 295.6772
  [3,] 293.7600  9.767957 274.1966 312.4941
  [4,] 313.2546  8.607632 296.3610 329.8515
  [5,] 332.7492  8.097319 316.9996 348.6063
  [6,] 352.2438  8.356954 336.0506 368.9690
  [7,] 371.7384  9.322429 353.5840 390.5408
  [8,] 391.2330 10.806182 370.2868 412.8467
  [9,] 410.7276 12.626810 386.6339 435.7642
 [10,] 430.2223 14.659331 402.2779 459.4836
 [11,] 211.2698 13.396829 185.0355 237.5862
 [12,] 213.0942 11.434969 190.8092 235.1828
 [13,] 214.9185  9.756528 195.6956 234.2399
 [14,] 216.7428  8.530476 200.0093 233.2130
 [15,] 218.5671  7.968441 203.0691 234.4185
 [16,] 220.3914  8.207979 204.4340 236.8960
 [17,] 222.2158  9.186601 204.3283 240.6256
 [18,] 224.0401 10.703467 202.9942 245.3884
 [19,] 225.8644 12.565135 201.2176 250.9140
 [20,] 227.6887 14.640659 198.9915 256.8105
 [21,] 213.1803 13.424661 186.0227 239.0678
 [22,] 218.0890 11.565884 195.2299 240.2013
 [23,] 222.9977  9.988616 202.8063 242.2112
 [24,] 227.9065  8.844765 210.1415 245.0994
 [25,] 232.8152  8.315163 216.2219 249.1787
 [26,] 237.7239  8.515201 221.0457 254.2289
 [27,] 242.6327  9.398404 224.1201 260.8458
 [28,] 247.5414 10.798425 226.4204 268.7268
 [29,] 252.4501 12.543390 227.6578 277.2713
 [30,] 257.3589 14.509373 228.9382 286.3419
 [31,] 274.1177 13.616586 248.9809 301.5750
 [32,] 279.9416 11.666347 258.2452 303.5591
 [33,] 285.7656  9.980323 267.4041 305.6373
 [34,] 291.5895  8.713265 275.3647 308.8404
 [35,] 297.4134  8.065114 281.8976 313.0558
 [36,] 303.2373  8.184259 287.2775 319.2934
 [37,] 309.0612  9.040412 291.5009 327.1449
 [38,] 314.8852 10.454040 294.5454 335.6952
 [39,] 320.7091 12.233389 296.3207 344.4724
 [40,] 326.5330 14.242036 298.0268 354.2613
 [41,] 273.1170 12.843306 249.5170 299.9754
 [42,] 280.6063 10.968410 260.3843 303.2156
 [43,] 288.0956  9.381158 270.3515 306.9390
 [44,] 295.5848  8.249295 279.7505 311.7769
 [45,] 303.0741  7.774330 287.8475 318.2868
 [46,] 310.5633  8.073052 294.7738 326.5127
 [47,] 318.0526  9.069329 300.2177 335.9471
 [48,] 325.5418 10.567683 304.8962 345.9440
 [49,] 333.0311 12.387240 308.7030 357.0785
 [50,] 340.5203 14.406809 312.1032 368.5552
 [51,] 260.4225 12.230068 236.1498 284.7996
 [52,] 270.6720 10.485461 249.8690 291.7665
 [53,] 280.9215  9.026068 262.9559 299.1358
 [54,] 291.1710  8.009345 275.8151 307.2069
 [55,] 301.4206  7.614722 287.0399 316.5730
 [56,] 311.6701  7.935558 296.8411 327.4582
 [57,] 321.9196  8.894765 304.8137 339.5849
 [58,] 332.1691 10.315779 312.1915 352.4018
 [59,] 342.4187 12.036131 319.1762 365.7093
 [60,] 352.6682 13.945475 325.6571 379.9304
 [61,] 268.0054 12.472822 245.0839 293.4631
 [62,] 278.2977 10.765993 258.2543 300.0930
 [63,] 288.5900  9.354949 270.8610 307.4052
 [64,] 298.8823  8.390274 282.6928 315.4813
 [65,] 309.1746  8.034394 293.5526 325.4292
 [66,] 319.4669  8.365371 303.3214 336.1527
 [67,] 329.7592  9.310238 311.6490 348.1558
 [68,] 340.0515 10.707698 318.9383 360.9813
 [69,] 350.3438 12.405733 325.7903 374.7737
 [70,] 360.6361 14.297650 332.3427 388.6991
 [71,] 244.3152 12.405740 219.6893 267.9496
 [72,] 255.8096 10.704508 234.6046 276.7441
 [73,] 267.3040  9.281462 249.2294 285.7420
 [74,] 278.7984  8.281277 262.4992 295.1741
 [75,] 290.2928  7.866926 274.6984 305.6315
 [76,] 301.7872  8.128495 285.9460 317.0865
 [77,] 313.2816  9.007292 295.3873 330.1171
 [78,] 324.7760 10.347228 304.7111 343.9816
 [79,] 336.2704 11.994744 312.7004 358.7803
 [80,] 347.7648 13.840434 320.9302 373.8250
 [81,] 250.4756 13.648489 224.5876 277.9017
 [82,] 250.2880 11.630541 228.0435 273.8996
 [83,] 250.1003  9.900631 231.0313 269.6573
 [84,] 249.9127  8.633670 233.1739 266.9047
 [85,] 249.7250  8.051262 233.8901 265.4128
 [86,] 249.5374  8.298804 233.0103 265.8743
 [87,] 249.3497  9.310330 230.5513 267.2530
 [88,] 249.1621 10.874701 227.7812 270.0830
 [89,] 248.9744 12.790651 223.4618 273.2778
 [90,] 248.7868 14.923377 218.7646 276.6726
 [91,] 286.1520 12.929293 261.2307 311.4529
 [92,] 305.2587 11.123291 283.8533 327.3642
 [93,] 324.3654  9.602238 306.0504 343.3750
 [94,] 343.4721  8.520138 327.0999 360.7792
 [95,] 362.5788  8.055862 346.9485 378.6480
 [96,] 381.6855  8.313573 365.3293 398.1192
 [97,] 400.7922  9.233010 382.7418 418.8346
 [98,] 419.8989 10.644052 398.5866 440.7744
 [99,] 439.0056 12.379726 414.3434 463.0787
[100,] 458.1123 14.322492 429.5546 486.0226
[101,] 227.2621 12.588665 201.5697 250.9930
[102,] 238.7568 10.815170 217.1697 259.1016
[103,] 250.2516  9.334211 231.5090 267.9742
[104,] 261.7463  8.303811 245.2613 277.3018
[105,] 273.2411  7.902232 258.0106 288.4923
[106,] 284.7358  8.222131 268.6767 300.9127
[107,] 296.2306  9.188460 277.9041 314.6324
[108,] 307.7253 10.626305 286.9780 328.6246
[109,] 319.2201 12.372353 295.0627 343.3955
[110,] 330.7148 14.314261 302.5556 358.7862
[111,] 239.2356 13.005381 213.0857 263.4970
[112,] 256.1779 11.102005 233.5511 277.1876
[113,] 273.1202  9.487054 253.3276 291.1107
[114,] 290.0625  8.330005 273.0127 305.8948
[115,] 307.0047  7.836382 291.2763 321.8177
[116,] 323.9470  8.127970 308.1646 339.3686
[117,] 340.8893  9.129842 323.0762 358.7227
[118,] 357.8315 10.643273 337.2799 378.9756
[119,] 374.7738 12.483573 350.7320 399.4996
[120,] 391.7161 14.527045 363.4332 420.7320
[121,] 255.4992 12.727698 230.6708 280.9754
[122,] 263.0483 10.932200 241.6946 284.9091
[123,] 270.5974  9.424203 252.3307 289.2839
[124,] 278.1466  8.360750 261.8765 294.4357
[125,] 285.6957  7.922917 270.1344 301.1077
[126,] 293.2448  8.211394 277.3345 309.2213
[127,] 300.7939  9.157800 283.1506 318.9981
[128,] 308.3430 10.587140 287.7521 329.3200
[129,] 315.8921 12.332627 291.9195 340.2810
[130,] 323.4412 14.278787 294.8982 351.6068
[131,] 271.9636 12.554485 248.3987 296.6795
[132,] 285.9955 10.801877 265.6110 306.9751
[133,] 300.0273  9.333017 282.0141 317.9092
[134,] 314.0592  8.299946 298.0714 329.8092
[135,] 328.0910  7.876054 312.6186 343.6517
[136,] 342.1228  8.156873 326.1906 358.5408
[137,] 356.1547  9.077233 338.8129 374.6341
[138,] 370.1865 10.469813 350.4080 391.4257
[139,] 384.2184 12.173620 361.4392 408.3787
[140,] 398.2502 14.076089 371.4043 426.3799
[141,] 254.5277 11.752891 231.8832 277.6218
[142,] 265.8926 10.182201 245.7813 286.0521
[143,] 277.2575  8.908300 259.7191 295.0647
[144,] 288.6224  8.072935 272.8234 304.8527
[145,] 299.9873  7.817966 284.4477 315.1674
[146,] 311.3522  8.197728 295.1458 327.3609
[147,] 322.7171  9.133387 304.5766 340.8134
[148,] 334.0819 10.477052 313.2254 354.6252
[149,] 345.4468 12.093483 321.2235 368.9995
[150,] 356.8117 13.887761 329.2218 383.8265
[151,] 226.8530 13.340733 199.4382 251.9755
[152,] 241.9379 11.481197 218.6053 263.8319
[153,] 257.0228  9.890768 236.7811 276.0867
[154,] 272.1077  8.717992 254.5623 288.7446
[155,] 287.1926  8.145315 270.7091 303.0785
[156,] 302.2775  8.297929 285.5076 318.2374
[157,] 317.3624  9.139573 299.6075 335.3128
[158,] 332.4473 10.505933 312.3771 353.2494
[159,] 347.5322 12.222281 323.8013 371.7545
[160,] 362.6171 14.161934 335.4737 390.7830
[161,] 251.9342 12.296996 227.9214 276.6547
[162,] 261.4270 10.621898 241.0645 282.5554
[163,] 270.9197  9.239742 253.1942 288.8479
[164,] 280.4125  8.298221 264.4741 296.7016
[165,] 289.9053  7.955352 274.5567 305.8042
[166,] 299.3980  8.285788 283.0889 315.6905
[167,] 308.8908  9.217400 290.3662 327.1376
[168,] 318.3836 10.592741 297.2794 339.1339
[169,] 327.8763 12.263416 303.1659 351.7286
[170,] 337.3691 14.125016 308.9647 364.0665
[171,] 263.3347 12.249002 239.4684 287.6156
[172,] 275.1128 10.507320 254.6171 295.6313
[173,] 286.8909  9.054320 269.1752 304.5657
[174,] 298.6690  8.047910 282.5379 314.6249
[175,] 310.4471  7.666043 295.3379 325.5169
[176,] 322.2252  7.998673 306.3285 337.5848
[177,] 334.0033  8.966635 316.2149 351.4262
[178,] 345.7814 10.393918 325.3742 366.1723
[179,] 357.5595 12.119312 333.4946 381.3374
[180,] 369.3376 14.033287 341.4170 396.6414</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error        Q2.5      Q97.5
  [1,]   -5.3307201  29.54325  -63.124524  52.899674
  [2,]  -14.7663923  28.46031  -68.991542  42.102845
  [3,]  -42.7437104  27.99718  -97.958329  11.378582
  [4,]    8.0215940  27.66309  -44.847699  64.379118
  [5,]   24.3724701  27.46281  -29.171068  78.721599
  [6,]   62.6459696  27.48605    8.782146 116.611569
  [7,]   10.0170497  27.86919  -43.997894  64.264826
  [8,] -101.9211866  28.18583 -155.807188 -44.552496
  [9,]   20.2549703  29.12010  -38.493539  77.521748
 [10,]   36.1892894  30.01549  -22.105638  94.990269
 [11,]   12.1987075  28.50736  -44.183096  67.580267
 [12,]   -8.0742986  28.39254  -64.936510  47.442077
 [13,]  -11.7793219  27.41478  -64.926043  40.468896
 [14,]  -12.6624043  27.34011  -66.014529  41.743225
 [15,]  -11.4880961  27.28530  -64.437878  43.788657
 [16,]   -4.4569687  27.60520  -57.867359  50.157351
 [17,]   -8.6959351  27.11808  -62.878273  45.795340
 [18,]   -6.8753620  28.14484  -62.393300  48.148389
 [19,]   -1.3219867  29.16348  -57.214038  56.779014
 [20,]    9.0179361  30.66589  -51.501867  70.225303
 [21,]  -14.2406151  29.48041  -70.950149  44.699208
 [22,]  -23.9754422  28.21339  -80.655616  30.986435
 [23,]   11.4460599  28.42194  -45.089972  66.872667
 [24,]    4.5967742  27.43748  -48.984098  56.759631
 [25,]   -3.8065369  26.77945  -57.447820  48.761289
 [26,]  -18.2536909  27.50892  -70.967817  35.133902
 [27,]   -7.2814951  27.65925  -62.722216  46.088120
 [28,]    8.4685300  28.46104  -48.245899  65.473584
 [29,]    8.6212580  29.52912  -48.808321  66.995864
 [30,]   -9.7740874  30.22577  -68.155222  49.882344
 [31,]   47.2694474  28.76766   -8.197631 104.381997
 [32,]   20.4583056  28.66918  -37.457296  76.372600
 [33,]   -1.3257239  28.31531  -56.804750  54.680428
 [34,]   -6.7580643  27.37759  -60.285823  47.987550
 [35,]  -11.9788330  27.13087  -65.617330  42.108018
 [36,]   -5.8605281  27.42349  -59.308265  47.179750
 [37,]  -29.6347343  27.03524  -84.404248  22.756328
 [38,]    3.8080365  27.84454  -49.665454  58.508697
 [39,]  -15.9911107  28.96265  -71.127022  40.070892
 [40,]   27.6539522  29.53028  -30.396574  83.499385
 [41,]   14.4145621  28.86833  -43.940770  69.536585
 [42,]    4.3592768  28.38275  -50.569511  59.277166
 [43,]   13.9711000  27.59298  -40.929873  67.955944
 [44,]   24.8216257  27.38996  -32.511978  78.530748
 [45,]   13.8255997  27.14496  -39.281025  67.699473
 [46,]  -17.1861915  27.49640  -72.969818  38.668315
 [47,]  -28.1786118  27.63036  -82.589739  25.717207
 [48,]    9.4771581  28.04962  -46.986575  63.357687
 [49,]  -40.4213291  28.73822  -96.799557  16.894550
 [50,]   31.4494581  29.55558  -25.193330  89.209006
 [51,]  -25.7817699  29.15547  -82.072069  30.712042
 [52,]  -27.5946415  27.69758  -81.282712  27.945086
 [53,]   -8.5795455  27.90352  -62.545208  45.167568
 [54,]   17.7584411  27.23512  -35.588645  69.065391
 [55,]   16.1551950  27.23570  -37.590112  70.031539
 [56,]   -1.8507802  26.85738  -54.945733  50.056641
 [57,]  132.6050019  27.60201   78.719151 186.242902
 [58,]   15.6224792  27.70723  -37.365940  71.069388
 [59,]  -12.5239820  28.97041  -68.838688  43.781845
 [60,]  -98.9064569  29.67859 -156.995708 -42.042168
 [61,]   15.6576337  29.00490  -40.944182  73.444896
 [62,]   10.8678647  27.91997  -43.736307  65.603890
 [63,]  -11.8039172  27.61071  -64.868733  42.402883
 [64,]    0.5741282  27.40640  -52.569446  54.877900
 [65,]  -12.2538736  26.90451  -65.493958  39.799863
 [66,]   18.4578524  27.30888  -34.414917  71.735576
 [67,]    2.4570457  27.58283  -50.984115  58.514384
 [68,]    8.9836038  28.35705  -46.671165  64.808706
 [69,]  -16.9621525  28.61424  -73.553198  40.582266
 [70,]    1.1658964  30.39047  -58.353217  61.343389
 [71,]   20.9188761  28.54851  -34.215893  77.393632
 [72,]   20.0960987  28.40213  -36.985446  75.098794
 [73,]  -24.1943497  28.09711  -79.160212  30.831849
 [74,]  -23.3680552  27.52028  -77.496718  30.665302
 [75,]   -9.9058678  26.76868  -62.731286  43.835800
 [76,]  -17.1256276  27.20593  -68.035277  35.890197
 [77,]   -7.3061391  27.88227  -60.944217  46.831512
 [78,]    6.2714516  27.68242  -49.174926  59.503492
 [79,]   -0.8252842  28.57370  -56.605425  53.350518
 [80,]   29.6248068  29.65573  -29.472140  87.571328
 [81,]   -9.8263163  29.04524  -68.425935  46.913759
 [82,]   23.7619809  28.31522  -30.351648  80.369370
 [83,]    4.8322994  27.87998  -49.157595  60.131344
 [84,]   20.8599458  26.95217  -32.787892  71.979252
 [85,]    2.4739967  27.41094  -50.767310  56.699655
 [86,]    5.5880412  27.19460  -46.864777  59.668918
 [87,]   -3.8404756  27.63957  -59.809157  50.663835
 [88,]  -13.2474815  28.58405  -69.886613  42.434816
 [89,]  -13.6933715  29.29772  -71.221407  42.235818
 [90,]  -11.4142124  29.98286  -71.262468  46.933492
 [91,]   25.7823414  29.50046  -32.268145  84.718576
 [92,]    8.7500303  28.96631  -49.551914  64.029270
 [93,]  -33.1129588  27.83971  -87.635651  20.488694
 [94,]    3.2310249  27.71716  -50.864581  58.232489
 [95,]    3.4191591  27.36306  -50.332745  56.921051
 [96,]   10.2893981  27.24074  -44.182455  63.297735
 [97,]    3.6034258  27.69907  -50.526780  57.059455
 [98,]   -3.1428133  28.34539  -59.190518  51.472227
 [99,]   15.7351293  28.91945  -43.310360  71.373418
[100,]    0.8435669  29.42429  -57.158349  58.816819
[101,]    8.8714196  28.99666  -48.449049  65.116792
[102,]   -8.3348481  27.81586  -62.865745  46.118794
[103,]  -11.7257362  27.65401  -66.322219  43.252741
[104,]   -7.0841550  26.81771  -59.998942  43.947670
[105,]  -22.2889868  27.55977  -76.256530  32.138655
[106,]  -14.4350674  26.40589  -66.689062  38.378083
[107,]  -14.9059543  27.86247  -69.277704  40.851744
[108,]    0.7139879  28.34908  -54.555403  58.587085
[109,]   16.8226194  29.09054  -39.149295  73.555549
[110,]   21.3316119  29.80876  -36.032568  81.305344
[111,]   16.9823560  29.10109  -41.045484  73.130303
[112,]  -12.6201037  28.17603  -68.076150  42.286756
[113,]  -17.0633113  27.99921  -71.957311  37.898927
[114,]  -34.9272282  26.93557  -86.609596  18.244843
[115,]  -37.3602638  27.01685  -90.116954  15.269258
[116,]    5.3771786  27.21190  -48.506246  58.935479
[117,]   37.9419701  27.78405  -15.858695  93.385644
[118,]    5.8887809  28.34032  -50.989810  61.458035
[119,]   19.2257622  28.78310  -36.522139  75.455035
[120,]   -2.7847168  29.32407  -60.261354  54.738122
[121,]   -4.5004451  29.00270  -61.641847  51.989311
[122,]   37.6061670  28.23031  -18.442646  93.882162
[123,]   -0.5501156  27.34693  -54.003188  51.164724
[124,]    3.0053327  26.96034  -48.975370  55.160706
[125,]  -14.3357839  26.95832  -66.951760  39.134211
[126,]   11.1220428  26.93783  -42.091665  64.388593
[127,]  -13.5305349  27.31002  -66.809247  39.445930
[128,]  -41.9821704  27.75507  -96.200461  14.127522
[129,]    5.4577784  28.85735  -52.261060  62.971207
[130,]   24.2063589  30.10137  -35.811189  82.776317
[131,]  -50.7842034  28.59266 -108.097054   4.779350
[132,]   12.5144777  27.77431  -41.254657  67.639355
[133,]   27.1914575  27.49133  -27.151508  80.752584
[134,]   31.9703117  26.77973  -19.471303  84.272206
[135,]   19.9727019  26.84239  -31.993841  74.884641
[136,]   11.0292784  26.99182  -41.818143  63.760681
[137,]   -1.8138045  27.28643  -55.887733  52.042472
[138,]   -9.7474812  28.21185  -64.831027  46.153356
[139,]   -8.8632294  28.17935  -65.320507  46.860435
[140,]  -10.1553488  30.83040  -71.157635  49.212191
[141,]   17.3426461  28.83510  -40.357765  73.808882
[142,]    2.9453157  28.12423  -52.369118  58.453413
[143,]  -20.6597660  27.18079  -73.598034  32.754516
[144,]  -11.3318060  27.34229  -64.942599  41.626837
[145,]   14.7845295  26.96926  -38.814355  67.051447
[146,]    6.7469304  26.63719  -44.789305  57.510043
[147,]  -24.0221794  27.45664  -78.940151  29.433281
[148,]   14.4375338  28.44171  -43.043537  70.345688
[149,]   -5.4407704  28.42515  -61.173788  50.635611
[150,]    9.4579748  29.95012  -48.615303  68.285776
[151,]   -1.5016413  28.92868  -57.069061  54.447219
[152,]   -7.2860924  28.47693  -63.565644  49.090973
[153,]  -18.6778961  27.98896  -74.029010  37.797514
[154,]  -31.6266757  27.83441  -87.483367  23.569494
[155,]  -19.4275735  27.33948  -73.433875  33.860141
[156,]   42.1138284  27.05301  -11.536870  93.694278
[157,]  -35.7913328  27.63209  -90.361568  18.498700
[158,]   15.0604943  28.33404  -39.086922  71.371633
[159,]   17.9797151  28.90574  -37.794831  74.185644
[160,]    9.1001537  29.68674  -49.360579  67.760257
[161,]   17.6262981  28.27776  -39.485000  74.090974
[162,]   10.5251024  28.00039  -46.400370  64.630364
[163,]    6.2049762  27.44402  -47.374313  58.914011
[164,]    1.2643682  27.85690  -52.504676  56.219747
[165,]  -10.3095965  27.46941  -64.385984  44.050223
[166,]  -14.8243860  27.04780  -69.060307  37.789871
[167,]  -49.7509990  27.97674 -105.360943   4.855952
[168,]  -13.7698391  28.21558  -69.670173  40.205129
[169,]   22.8921761  28.61283  -33.325329  78.651800
[170,]   31.7096164  29.67740  -25.074594  89.791343
[171,]    6.2996878  28.42272  -50.443931  60.338003
[172,]   -1.3198058  28.01521  -56.032970  52.392575
[173,]   10.7905399  27.20772  -42.537799  65.157196
[174,]   12.2259100  27.13164  -41.332731  65.072801
[175,]  -23.3381569  27.43041  -77.010828  30.533025
[176,]    7.5098722  27.35947  -45.992837  62.125505
[177,]    0.7550367  27.41021  -52.348367  53.825470
[178,]   -2.5019818  27.96496  -57.175562  52.876862
[179,]   11.6656965  28.78918  -44.034876  68.124210
[180,]   -4.7754600  29.33277  -63.463586  53.034244</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.4  0.5
looic      1906.9 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.5 14.6
p_loo        20.1  3.7
looic      1771.0 29.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   585       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   100       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.4
p_loo        34.2  8.5
looic      1723.2 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   1087      
 (0.5, 0.7]   (ok)         6    3.3%   659       
   (0.7, 1]   (bad)        2    1.1%   40        
   (1, Inf)   (very bad)   2    1.1%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.9      11.6  
fit_sleep1 -91.9      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.4  0.5
looic      1906.9 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.5 14.6
p_loo        20.1  3.7
looic      1771.0 29.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   585       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   100       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.4
p_loo        34.2  8.5
looic      1723.2 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   1087      
 (0.5, 0.7]   (ok)         6    3.3%   659       
   (0.7, 1]   (bad)        2    1.1%   40        
   (1, Inf)   (very bad)   2    1.1%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.6     22.4        34.2    8.5   1723.2
fit_sleep2  -23.9      11.6  -885.5     14.6        20.1    3.7   1771.0
fit_sleep1  -91.9      21.1  -953.4     10.5         3.4    0.5   1906.9
           se_looic
fit_sleep3   44.9  
fit_sleep2   29.2  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.265042e-40 4.041601e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(
  set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
  set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
  set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))

bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.89      1.57      0.3     5.44       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.11      1.57    -3.41     2.98       5.67      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.20.3         Rcpp_1.0.11         rstan_2.26.23      
[4] StanHeaders_2.26.28 lme4_1.1-34         Matrix_1.6-1       

loaded via a namespace (and not attached):
  [1] tidyselect_1.2.0     dplyr_1.1.3          farver_2.1.1        
  [4] loo_2.6.0            fastmap_1.1.1        tensorA_0.36.2      
  [7] shinystan_2.6.0      shinyjs_2.1.0        promises_1.2.1      
 [10] digest_0.6.33        mime_0.12            lifecycle_1.0.3     
 [13] ellipsis_0.3.2       processx_3.8.2       magrittr_2.0.3      
 [16] posterior_1.4.1      compiler_4.3.1       rlang_1.1.1         
 [19] sass_0.4.7           tools_4.3.1          igraph_1.5.1        
 [22] utf8_1.2.3           yaml_2.3.7           knitr_1.44          
 [25] labeling_0.4.3       prettyunits_1.1.1    bridgesampling_1.1-2
 [28] htmlwidgets_1.6.2    pkgbuild_1.4.2       plyr_1.8.8          
 [31] dygraphs_1.1.1.6     abind_1.4-5          miniUI_0.1.1.1      
 [34] withr_2.5.0          grid_4.3.1           stats4_4.3.1        
 [37] fansi_1.0.4          xts_0.13.1           xtable_1.8-4        
 [40] colorspace_2.1-0     inline_0.3.19        ggplot2_3.4.3       
 [43] gtools_3.9.4         scales_1.2.1         MASS_7.3-60         
 [46] cli_3.6.1            mvtnorm_1.2-3        rmarkdown_2.24      
 [49] crayon_1.5.2         generics_0.1.3       RcppParallel_5.1.7  
 [52] rstudioapi_0.15.0    reshape2_1.4.4       minqa_1.2.6         
 [55] cachem_1.0.8         stringr_1.5.0        shinythemes_1.2.0   
 [58] splines_4.3.1        bayesplot_1.10.0     parallel_4.3.1      
 [61] base64enc_0.1-3      matrixStats_1.0.0    vctrs_0.6.3         
 [64] boot_1.3-28.1        jsonlite_1.8.7       callr_3.7.3         
 [67] crosstalk_1.2.0      jquerylib_0.1.4      glue_1.6.2          
 [70] nloptr_2.0.3         codetools_0.2-19     ps_1.7.5            
 [73] DT_0.29              distributional_0.3.2 stringi_1.7.12      
 [76] gtable_0.3.4         later_1.3.1          QuickJSR_1.0.6      
 [79] munsell_0.5.0        tibble_3.2.1         colourpicker_1.3.0  
 [82] pillar_1.9.0         htmltools_0.5.6      Brobdingnag_1.2-9   
 [85] R6_2.5.1             evaluate_0.21        shiny_1.7.5         
 [88] lattice_0.21-8       markdown_1.8         threejs_0.3.3       
 [91] backports_1.4.1      httpuv_1.6.11        bslib_0.5.1         
 [94] rstantools_2.3.1.1   coda_0.19-4          gridExtra_2.3       
 [97] nlme_3.1-162         checkmate_2.2.0      xfun_0.40           
[100] zoo_1.8-12           pkgconfig_2.0.3     </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoCiAgc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogIHNldF9wcmlvcigibGtqKDIpIiwgY2xhc3MgPSAiY29yIikpCgpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
