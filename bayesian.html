<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.83      6.82    15.51    42.34 1.00     1752     2450
sd(Days)                6.57      1.49     4.11    10.08 1.00     1373     2158
cor(Intercept,Days)     0.09      0.31    -0.48     0.70 1.00      855     1151

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.47      7.40   237.39   266.23 1.00     1604     2430
Days         10.43      1.71     6.97    13.84 1.00     1230     1746

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.93      1.56    23.00    29.28 1.00     3113     3004

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.3974  13.19264 227.7481 279.3112
309 211.5743  13.18854 185.1966 236.4845
310 212.7089  13.61463 185.3133 238.7678
330 274.2596  13.63447 248.4311 301.6765
331 272.8928  13.11993 247.8650 298.8780
332 260.1272  12.58541 236.1028 285.3827
333 267.8852  12.37203 244.3643 292.7861
334 244.2646  12.00139 219.8667 267.4905
335 250.8057  13.68891 224.7184 278.2264
337 285.5873  13.06765 258.8728 310.8927
349 226.7857  13.21047 200.7232 252.3869
350 238.8544  13.45320 211.8698 264.9659
351 255.7903  12.64001 231.9416 281.2756
352 272.0624  12.37377 248.4978 296.7682
369 254.5108  12.17793 230.6545 278.6596
370 226.6824  13.67878 199.4887 253.0756
371 251.9342  11.94596 228.5878 275.3616
372 263.5575  12.25069 240.2598 288.3400

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5052588  2.531367 14.7185679 24.574836
309  1.7318083  2.499632 -3.1620868  6.557203
310  4.9378941  2.542629  0.1282992  9.883785
330  5.7985464  2.568973  0.6842804 10.762146
331  7.5913052  2.426638  2.8236811 12.250140
332 10.2496794  2.416671  5.5992251 14.936430
333 10.2868077  2.360821  5.5783579 14.871334
334 11.5438927  2.320953  6.9998407 16.183933
335 -0.3093413  2.613579 -5.4531884  4.615798
337 19.1907062  2.488294 14.2676726 24.132266
349 11.5410011  2.478216  6.7442400 16.533874
350 16.9904628  2.590721 12.0825370 22.275663
351  7.5166425  2.411477  2.7590567 12.099035
352 14.0633759  2.331571  9.3738322 18.643455
369 11.3357450  2.361388  6.8403047 16.005891
370 15.1669140  2.577250 10.2815974 20.318391
371  9.5324191  2.321204  4.8775753 14.041821
372 11.7879796  2.354058  7.1880307 16.324066</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.3974 13.192641 227.7481 279.3112
  [2,] 273.9027 11.263017 251.2847 295.1225
  [3,] 293.4079  9.616701 273.9033 311.6405
  [4,] 312.9132  8.421518 295.7746 329.1272
  [5,] 332.4184  7.885343 316.6569 347.7477
  [6,] 351.9237  8.139468 335.5392 367.3189
  [7,] 371.4290  9.118053 353.2866 388.6153
  [8,] 390.9342 10.622733 369.8841 411.1850
  [9,] 410.4395 12.464417 385.9767 433.9361
 [10,] 429.9447 14.515389 401.5892 457.6612
 [11,] 211.5743 13.188539 185.1966 236.4845
 [12,] 213.3061 11.305502 190.9327 234.6218
 [13,] 215.0380  9.705025 195.9513 233.8029
 [14,] 216.7698  8.547337 199.7705 233.3701
 [15,] 218.5016  8.026379 202.6738 234.0980
 [16,] 220.2334  8.263466 203.7396 235.9853
 [17,] 221.9652  9.200179 203.8498 239.8751
 [18,] 223.6970 10.653547 202.2856 244.4784
 [19,] 225.4288 12.443839 200.1326 249.6353
 [20,] 227.1606 14.446333 197.8365 255.7468
 [21,] 212.7089 13.614634 185.3133 238.7678
 [22,] 217.6468 11.678631 194.3550 240.0625
 [23,] 222.5847 10.017610 202.9573 242.1477
 [24,] 227.5226  8.788887 210.5707 244.9500
 [25,] 232.4605  8.189413 216.5739 248.7956
 [26,] 237.3984  8.355737 221.0329 254.1190
 [27,] 242.3363  9.246629 224.1664 260.7797
 [28,] 247.2742 10.682315 226.0896 268.5007
 [29,] 252.2121 12.476118 227.6477 276.7132
 [30,] 257.1500 14.495692 228.8045 285.5268
 [31,] 274.2596 13.634473 248.4311 301.6765
 [32,] 280.0582 11.642983 257.9742 303.4670
 [33,] 285.8567  9.920609 266.9316 305.5743
 [34,] 291.6553  8.630016 274.9301 309.0603
 [35,] 297.4538  7.983426 281.7807 313.6452
 [36,] 303.2524  8.135863 287.0421 319.5382
 [37,] 309.0509  9.047026 291.1789 327.2439
 [38,] 314.8494 10.521612 293.9602 335.9598
 [39,] 320.6480 12.359580 296.1843 344.9608
 [40,] 326.4465 14.422668 298.1448 355.1387
 [41,] 272.8928 13.119929 247.8650 298.8780
 [42,] 280.4841 11.265774 259.2148 302.9625
 [43,] 288.0754  9.668502 270.0343 307.4583
 [44,] 295.6667  8.474630 279.3263 312.5453
 [45,] 303.2580  7.869937 288.2841 318.8561
 [46,] 310.8493  7.989345 295.4270 326.5746
 [47,] 318.4406  8.803436 301.3442 336.0082
 [48,] 326.0319 10.146354 305.9100 346.5638
 [49,] 333.6232 11.839496 309.7242 357.4911
 [50,] 341.2145 13.754125 313.9509 369.0135
 [51,] 260.1272 12.585405 236.1028 285.3827
 [52,] 270.3769 10.809541 249.5057 291.5431
 [53,] 280.6266  9.326335 262.4076 298.7997
 [54,] 290.8763  8.294303 274.6642 306.9641
 [55,] 301.1260  7.892465 285.9191 316.9248
 [56,] 311.3756  8.213838 295.4354 327.7980
 [57,] 321.6253  9.182802 303.9808 339.8146
 [58,] 331.8750 10.623614 311.4695 352.7009
 [59,] 342.1247 12.372514 317.9579 366.7513
 [60,] 352.3744 14.317039 324.3868 380.8857
 [61,] 267.8852 12.372025 244.3643 292.7861
 [62,] 278.1720 10.667363 257.4557 299.4864
 [63,] 288.4588  9.255550 270.0818 307.0796
 [64,] 298.7456  8.287625 282.5815 315.0906
 [65,] 309.0325  7.927876 293.8799 324.3856
 [66,] 319.3193  8.256188 303.5034 335.4558
 [67,] 329.6061  9.199187 311.8443 347.9205
 [68,] 339.8929 10.593978 319.2565 360.7742
 [69,] 350.1797 12.287663 326.1363 374.3147
 [70,] 360.4665 14.173494 332.6909 388.2499
 [71,] 244.2646 12.001387 219.8667 267.4905
 [72,] 255.8085 10.337051 234.9042 275.6693
 [73,] 267.3524  8.969371 249.3270 284.3978
 [74,] 278.8963  8.050979 262.8258 294.2349
 [75,] 290.4401  7.743420 275.3720 305.1247
 [76,] 301.9840  8.116433 286.2726 317.5485
 [77,] 313.5279  9.086587 296.2307 331.0110
 [78,] 325.0718 10.489485 304.7434 345.2874
 [79,] 336.6157 12.176460 313.1341 360.3401
 [80,] 348.1596 14.045522 321.0934 375.6470
 [81,] 250.8057 13.688909 224.7184 278.2264
 [82,] 250.4963 11.659185 228.2959 273.8103
 [83,] 250.1870  9.906996 231.3782 270.1388
 [84,] 249.8776  8.603611 233.0994 266.8048
 [85,] 249.5683  7.972282 234.0445 265.2418
 [86,] 249.2590  8.170313 233.4645 265.1134
 [87,] 248.9496  9.143978 231.5816 266.7520
 [88,] 248.6403 10.683270 228.3648 269.2522
 [89,] 248.3309 12.582280 224.3332 272.9746
 [90,] 248.0216 14.702274 219.7253 277.3493
 [91,] 285.5873 13.067648 258.8728 310.8927
 [92,] 304.7780 11.224041 282.1053 326.5400
 [93,] 323.9687  9.673571 304.5740 342.9964
 [94,] 343.1594  8.576717 326.1008 360.2620
 [95,] 362.3501  8.119445 346.2934 378.2720
 [96,] 381.5408  8.406778 365.0685 397.7959
 [97,] 400.7315  9.370468 382.3130 419.0553
 [98,] 419.9222 10.831465 398.7472 440.9706
 [99,] 439.1129 12.618194 414.7503 463.4385
[100,] 458.3036 14.611647 429.9478 486.3431
[101,] 226.7857 13.210470 200.7232 252.3869
[102,] 238.3267 11.314911 216.0375 260.3673
[103,] 249.8677  9.686125 230.7520 268.8566
[104,] 261.4087  8.479265 244.7868 278.0176
[105,] 272.9497  7.890371 257.2352 288.3953
[106,] 284.4907  8.056121 268.8199 300.3514
[107,] 296.0317  8.934615 278.7120 313.4409
[108,] 307.5727 10.345854 287.3262 327.8533
[109,] 319.1137 12.104924 295.3747 342.8454
[110,] 330.6547 14.082073 303.0852 358.2930
[111,] 238.8544 13.453203 211.8698 264.9659
[112,] 255.8448 11.443948 232.5999 277.7201
[113,] 272.8353  9.714055 253.1675 291.5840
[114,] 289.8258  8.437148 273.0849 305.8860
[115,] 306.8162  7.837840 291.1985 321.7707
[116,] 323.8067  8.068561 307.7661 339.2371
[117,] 340.7972  9.066161 322.6370 358.1572
[118,] 357.7876 10.616616 336.1490 378.2336
[119,] 374.7781 12.516128 349.5950 398.8041
[120,] 391.7686 14.629356 363.1904 420.1791
[121,] 255.7903 12.640013 231.9416 281.2756
[122,] 263.3069 10.836381 242.8850 285.1890
[123,] 270.8236  9.312078 253.2742 289.7060
[124,] 278.3402  8.223922 262.7848 294.9714
[125,] 285.8569  7.757670 270.9839 301.2733
[126,] 293.3735  8.022495 277.4819 309.2893
[127,] 300.8901  8.953762 283.4352 318.1862
[128,] 308.4068 10.373511 288.2658 328.5708
[129,] 315.9234 12.111154 292.5601 339.7167
[130,] 323.4401 14.049228 296.0855 351.0567
[131,] 272.0624 12.373775 248.4978 296.7682
[132,] 286.1258 10.663533 265.6233 307.2471
[133,] 300.1892  9.229519 282.0549 318.1928
[134,] 314.2525  8.217637 298.4663 330.5929
[135,] 328.3159  7.794070 313.0166 343.7513
[136,] 342.3793  8.052201 326.3458 358.4312
[137,] 356.4427  8.933130 338.6250 373.7301
[138,] 370.5060 10.277943 349.8129 390.5430
[139,] 384.5694 11.930794 360.5661 407.7720
[140,] 398.6328 13.781293 370.9939 425.4404
[141,] 254.5108 12.177926 230.6545 278.6596
[142,] 265.8466 10.481087 245.3762 286.7655
[143,] 277.1823  9.086077 259.3329 295.6483
[144,] 288.5180  8.149401 272.8338 304.6948
[145,] 299.8538  7.837153 284.9004 315.4453
[146,] 311.1895  8.220797 295.1575 327.5645
[147,] 322.5253  9.213814 304.3782 341.0331
[148,] 333.8610 10.647043 312.9637 355.3582
[149,] 345.1968 12.368387 321.0124 370.1375
[150,] 356.5325 14.273990 329.0439 385.5588
[151,] 226.6824 13.678784 199.4887 253.0756
[152,] 241.8493 11.674177 218.3829 264.4393
[153,] 257.0162  9.937208 237.2029 276.5406
[154,] 272.1831  8.631005 255.2750 289.3045
[155,] 287.3501  7.970246 272.0813 302.8619
[156,] 302.5170  8.114174 286.6473 317.8899
[157,] 317.6839  9.024371 300.0971 334.6997
[158,] 332.8508 10.503482 312.4315 352.9286
[159,] 348.0177 12.348743 323.5029 372.1471
[160,] 363.1846 14.420270 335.3454 391.3682
[161,] 251.9342 11.945956 228.5878 275.3616
[162,] 261.4666 10.290673 241.5664 281.3315
[163,] 270.9991  8.936779 253.5860 288.1178
[164,] 280.5315  8.038039 264.7989 296.3254
[165,] 290.0639  7.754359 274.8315 305.4769
[166,] 299.5963  8.150220 283.7897 315.6448
[167,] 309.1287  9.137727 291.3576 327.0464
[168,] 318.6612 10.552061 297.4457 339.1066
[169,] 328.1936 12.246221 303.4264 351.9276
[170,] 337.7260 14.119838 309.5244 365.1640
[171,] 263.5575 12.250692 240.2598 288.3400
[172,] 275.3455 10.530045 255.3672 296.3047
[173,] 287.1335  9.097659 269.7284 304.9837
[174,] 298.9215  8.107783 283.1960 314.3107
[175,] 310.7094  7.732274 295.5822 325.8544
[176,] 322.4974  8.057491 306.6942 338.5478
[177,] 334.2854  9.007855 316.9326 352.1570
[178,] 346.0734 10.413592 325.9554 366.2100
[179,] 357.8614 12.117242 334.7766 381.2135
[180,] 369.6493 14.010545 343.0981 396.5267</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error        Q2.5      Q97.5
  [1,]   -4.4550597  29.04052  -61.707971  52.094585
  [2,]  -15.7714767  28.51894  -71.391862  40.631968
  [3,]  -42.6066509  27.67761  -95.537321  12.070240
  [4,]    8.9900600  27.00511  -42.546043  63.241540
  [5,]   24.1934072  26.87664  -28.157402  76.994000
  [6,]   62.5184833  27.13510    9.686377 116.275891
  [7,]   10.6835559  27.22678  -42.206872  64.879200
  [8,] -101.5208645  27.66664 -154.462567 -47.844765
  [9,]   20.6774823  28.58887  -35.881503  76.342527
 [10,]   36.4030794  29.79181  -20.713943  95.785576
 [11,]   11.2699794  29.49334  -46.041033  69.166033
 [12,]   -7.8018549  28.77500  -63.093323  47.792757
 [13,]  -12.2796362  27.56243  -67.942484  41.436294
 [14,]  -11.9291507  27.71775  -66.746949  42.558369
 [15,]  -10.8810126  27.58490  -65.884693  43.137100
 [16,]   -3.8090452  27.13747  -56.766260  49.604544
 [17,]   -8.4341732  27.46569  -62.401502  44.638394
 [18,]   -5.2086391  28.16512  -59.603197  51.226779
 [19,]   -0.6701023  28.78708  -56.523502  55.480809
 [20,]    9.4660645  30.05413  -48.786509  69.229306
 [21,]  -13.6924450  29.16356  -70.529158  43.998804
 [22,]  -23.7923515  28.36186  -79.307769  32.172080
 [23,]   11.7273575  28.07454  -44.021223  66.125784
 [24,]    5.6950637  27.23328  -48.364111  58.409113
 [25,]   -3.4545145  27.16433  -55.865609  50.430493
 [26,]  -16.6303353  27.37748  -68.642650  36.895809
 [27,]   -6.7730408  27.04183  -59.282101  45.963756
 [28,]    7.5282750  28.01236  -47.691099  62.927132
 [29,]    8.4205544  28.41565  -48.270419  64.221270
 [30,]   -9.8841203  29.76608  -67.413500  48.612446
 [31,]   47.1069783  29.34278  -10.543850 105.209285
 [32,]   19.6369166  28.45063  -35.151377  76.538429
 [33,]   -1.6462326  27.18598  -55.339400  51.476123
 [34,]   -6.2807589  27.20002  -60.544219  44.999206
 [35,]  -11.3149027  27.18178  -64.535379  43.431084
 [36,]   -5.3262724  27.49022  -58.329672  49.836538
 [37,]  -27.5460485  27.51509  -82.094348  25.783185
 [38,]    3.6469605  28.22508  -52.503329  59.661584
 [39,]  -15.4762242  28.60266  -71.694277  40.233469
 [40,]   27.5729972  29.78060  -30.702936  86.821119
 [41,]   14.5129130  29.76651  -43.041771  73.732815
 [42,]    4.0504767  28.59066  -51.021743  60.810063
 [43,]   13.7224342  27.70317  -40.186181  67.392803
 [44,]   24.1075597  26.77761  -27.812959  77.377259
 [45,]   12.7265952  27.57580  -40.377899  67.184959
 [46,]  -17.1420901  27.37905  -71.050823  35.504913
 [47,]  -27.6783732  27.59961  -81.462470  27.871356
 [48,]    7.9775980  27.44932  -46.193901  61.152029
 [49,]  -39.9848450  28.12460  -93.246765  15.684084
 [50,]   30.4748415  29.75459  -29.214734  89.365298
 [51,]  -24.9254052  28.47122  -79.575170  31.424122
 [52,]  -27.4122545  28.25872  -83.293515  28.069201
 [53,]   -7.9897486  27.62560  -63.438512  45.977564
 [54,]   19.6693998  26.74283  -33.307273  71.722281
 [55,]   16.1295726  26.67023  -36.678007  68.917256
 [56,]   -1.1812805  27.69093  -56.211668  53.686884
 [57,]  132.2119585  27.52210   78.303345 185.346219
 [58,]   14.3974049  28.08005  -41.649559  69.064219
 [59,]  -11.4328751  29.09788  -69.331649  43.686899
 [60,]  -98.2757991  29.02449 -155.403999 -41.868315
 [61,]   15.6833852  28.84732  -41.314694  71.467567
 [62,]   11.2239489  27.90618  -44.359008  64.078106
 [63,]  -11.4918825  27.56445  -64.860888  42.126978
 [64,]    1.3348794  26.96067  -50.758341  55.080894
 [65,]  -11.4020214  27.11634  -63.788573  42.969886
 [66,]   18.8177155  27.32629  -34.277405  72.828201
 [67,]    2.0676519  27.31125  -51.704328  56.099569
 [68,]    8.9171176  28.16670  -47.098099  62.514530
 [69,]  -16.9234873  28.63223  -74.381734  40.130375
 [70,]    2.1807491  29.26329  -56.942976  57.746077
 [71,]   21.5519594  28.49517  -32.679633  77.046131
 [72,]   20.0377208  27.50111  -31.727803  74.315827
 [73,]  -23.5244384  27.31322  -78.300436  28.070522
 [74,]  -24.0365751  26.73883  -77.446101  28.238982
 [75,]  -11.0892830  26.90632  -64.878475  40.454879
 [76,]  -18.0358748  27.77068  -71.886961  35.306508
 [77,]   -8.3068815  27.78161  -63.099051  45.198853
 [78,]    5.6754884  28.41437  -49.219596  60.674798
 [79,]   -0.1488438  28.32278  -55.294132  56.088447
 [80,]   29.1916863  29.46543  -27.990144  86.374328
 [81,]   -8.9758214  29.39222  -65.958507  49.024638
 [82,]   24.2380436  28.51527  -31.109293  81.398002
 [83,]    4.2495476  27.60431  -50.085852  57.381040
 [84,]   21.3656581  27.50288  -31.489725  75.507668
 [85,]    1.3245152  27.58442  -52.521997  54.274748
 [86,]    5.3027253  27.05035  -47.049556  58.623101
 [87,]   -3.7664805  27.88057  -58.832123  50.942290
 [88,]  -12.9464982  27.80167  -67.837691  40.474583
 [89,]  -11.3808796  29.10161  -69.423511  44.823975
 [90,]  -11.2115566  29.50010  -69.308443  46.858142
 [91,]   27.2594126  29.50075  -30.900826  86.604876
 [92,]    9.1496645  28.10423  -46.703289  63.253950
 [93,]  -32.7647212  27.18458  -86.987550  20.761605
 [94,]    2.6864900  27.05787  -50.310472  55.355975
 [95,]    3.7097282  27.16872  -49.013588  58.788554
 [96,]   10.6459864  26.64049  -41.168155  64.226806
 [97,]    3.8074700  27.90265  -49.644872  59.414906
 [98,]   -3.3033865  28.14300  -58.374369  52.481983
 [99,]   16.7405785  28.80566  -40.517438  72.615394
[100,]    1.0205482  29.77752  -55.177546  60.398889
[101,]    8.7790809  29.47025  -48.294170  67.116767
[102,]   -7.8108480  28.41793  -60.538628  47.806009
[103,]  -10.1300806  27.87382  -65.936916  44.657173
[104,]   -6.7414263  26.62961  -58.187294  44.131044
[105,]  -22.0316148  26.50477  -73.792139  29.312675
[106,]  -14.5743540  26.91287  -66.054771  39.982680
[107,]  -14.4704890  27.57991  -69.729076  37.698285
[108,]    0.9759157  27.74133  -54.467607  55.695139
[109,]   17.5406645  28.44421  -39.175659  72.827047
[110,]   21.1874061  29.42120  -36.360199  78.583348
[111,]   16.9579040  29.22342  -39.569377  73.928044
[112,]  -12.0100871  27.81514  -66.331401  42.857187
[113,]  -16.8099891  27.68116  -73.527748  35.806333
[114,]  -33.8661447  27.40394  -86.887391  19.736203
[115,]  -38.1050698  27.85219  -92.135653  17.462116
[116,]    6.8526856  27.51078  -46.122195  61.145828
[117,]   37.9787668  27.40226  -14.059875  93.302004
[118,]    5.6731702  27.72690  -47.132602  61.643054
[119,]   20.5949664  29.02599  -35.982905  79.532136
[120,]   -2.4518365  29.35426  -59.987172  54.453573
[121,]   -5.0090567  29.02567  -61.466062  53.170234
[122,]   36.9315887  27.97114  -19.095905  91.248019
[123,]   -0.5489428  27.19992  -52.618028  52.437283
[124,]    2.8273918  27.12532  -50.714279  56.654892
[125,]  -14.1820208  27.06392  -66.413446  39.803766
[126,]   11.6031487  27.11607  -40.364705  64.923675
[127,]  -13.4812907  27.69664  -68.368838  41.326409
[128,]  -41.6189597  28.25048  -95.420926  12.793168
[129,]    5.2758287  28.77106  -51.714237  61.954367
[130,]   24.1776325  29.18919  -32.775767  82.289222
[131,]  -50.6538509  28.82275 -107.624853   4.535559
[132,]   11.8678395  28.07811  -45.492890  66.421522
[133,]   26.8749037  27.21770  -26.718802  79.946544
[134,]   32.7158688  26.92290  -19.685677  86.048746
[135,]   20.2222271  27.03107  -32.744456  71.231551
[136,]   10.2104266  26.95768  -43.700920  63.921774
[137,]   -2.2830052  27.63280  -56.412802  51.111787
[138,]   -8.7863231  28.08373  -63.753210  47.383034
[139,]   -8.6123400  29.00101  -64.565848  49.491500
[140,]  -10.7064056  29.09221  -67.146971  46.310356
[141,]   17.5168920  28.65485  -37.488391  74.026565
[142,]    2.2071430  28.15078  -53.688956  55.582561
[143,]  -20.0454595  26.73682  -71.625507  32.866622
[144,]  -11.2830968  27.51845  -66.301675  41.151671
[145,]   14.1296039  26.92497  -40.061465  68.017606
[146,]    5.1575903  27.06816  -48.463624  58.661244
[147,]  -24.1352011  27.69793  -79.273186  30.362103
[148,]   14.2179543  27.73915  -40.099582  67.964007
[149,]   -4.5115854  29.22106  -61.783244  53.503202
[150,]    9.1228134  30.14599  -48.833894  68.471963
[151,]   -1.3677467  28.99836  -60.627703  54.098145
[152,]   -7.4451363  28.59175  -64.657167  46.657877
[153,]  -17.4798574  27.81087  -71.930358  34.739692
[154,]  -31.7930748  27.84574  -86.689911  22.809126
[155,]  -20.1982750  27.53586  -73.771159  32.771795
[156,]   41.2784823  27.48947  -13.015769  94.834910
[157,]  -36.0613566  27.50326  -90.590501  16.950928
[158,]   14.9006243  28.17176  -41.207048  70.675302
[159,]   17.0791336  28.69945  -40.368237  73.162025
[160,]    9.5218317  29.14341  -47.679683  65.879884
[161,]   17.6327934  28.58274  -37.867631  74.573242
[162,]   10.5940625  27.85216  -43.298203  64.479295
[163,]    6.8037411  27.54952  -47.437068  60.493120
[164,]    1.1906998  27.17085  -52.530331  53.927720
[165,]  -11.0170982  27.29482  -64.447096  42.901001
[166,]  -14.7571248  26.68362  -65.316667  37.479599
[167,]  -49.8029926  27.57301 -105.192708   4.909232
[168,]  -14.5436570  27.82920  -69.584507  39.521079
[169,]   23.1766105  28.81692  -33.653717  81.226722
[170,]   31.7378987  29.40857  -24.886724  88.284733
[171,]    5.8390630  29.06072  -49.881407  64.714846
[172,]   -1.9992615  27.86438  -56.733897  53.107686
[173,]   10.7119954  27.74930  -42.810789  66.755549
[174,]   12.1574297  27.42540  -43.129851  65.893791
[175,]  -23.3097664  27.64815  -76.499759  31.749185
[176,]    6.4008412  27.78250  -47.211977  60.144731
[177,]    0.4523770  27.61481  -53.908668  54.026384
[178,]   -2.3940627  28.26563  -58.437399  52.283509
[179,]   11.9065378  28.91739  -45.015847  68.514068
[180,]   -5.9293982  29.29559  -64.563669  50.943407</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.3 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   560       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   80        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.1 22.9
p_loo        35.0  9.1
looic      1724.2 45.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   767       
 (0.5, 0.7]   (ok)         4    2.2%   471       
   (0.7, 1]   (bad)        2    1.1%   16        
   (1, Inf)   (very bad)   1    0.6%   4         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.0      12.1  
fit_sleep1 -91.2      21.4  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.3 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   560       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   80        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.1 22.9
p_loo        35.0  9.1
looic      1724.2 45.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   767       
 (0.5, 0.7]   (ok)         4    2.2%   471       
   (0.7, 1]   (bad)        2    1.1%   16        
   (1, Inf)   (very bad)   1    0.6%   4         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.1     22.9        35.0    9.1   1724.2
fit_sleep2  -23.0      12.1  -885.1     14.4        19.6    3.4   1770.3
fit_sleep1  -91.2      21.4  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   45.7  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
2.371046e-40 1.006697e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(
  set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
  set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
  set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))

bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.95       1.6      0.3     5.55       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.05       1.6    -3.31     3.06       5.48      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.20.1         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-1       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.1       rmarkdown_2.24      
 [22] markdown_1.8         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.40            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.1          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.1         tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.2          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.5         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.3        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.3.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.3            
 [94] gtable_0.3.4         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.6     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoCiAgc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogIHNldF9wcmlvcigibGtqKDIpIiwgY2xhc3MgPSAiY29yIikpCgpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
