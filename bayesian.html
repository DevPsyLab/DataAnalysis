<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.71      6.96    15.31    42.87 1.00     1485     2051
sd(Days)                6.55      1.51     4.13    10.10 1.00     1336     2038
cor(Intercept,Days)     0.09      0.30    -0.48     0.68 1.01      856      984

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.14      7.57   236.26   266.08 1.00     1795     2308
Days         10.38      1.74     6.84    13.78 1.01     1319     1934

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.54    23.05    29.06 1.00     3612     2910

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.8198  12.61274 228.9418 278.4637
309 211.4502  13.32104 184.3559 237.2488
310 212.8999  13.20842 186.7766 237.4817
330 274.3804  13.56161 248.6075 301.4371
331 273.2207  13.06851 248.2988 298.4354
332 260.3033  12.14050 237.5972 284.2745
333 267.5918  12.76900 242.8890 292.7752
334 244.6126  12.78786 219.2526 269.1819
335 250.7216  13.57861 224.7795 277.2167
337 285.8830  13.18710 260.5035 311.7006
349 226.9332  12.96338 201.0442 251.5705
350 238.7413  12.97744 213.2239 263.7681
351 255.8735  12.16698 232.0877 280.2209
352 271.9642  12.60723 247.2676 297.2865
369 254.5781  12.18297 230.5116 278.4794
370 226.4583  13.59834 198.9602 252.1882
371 252.3772  12.22927 228.1702 277.1592
372 263.4478  12.43710 238.6152 288.5572

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6482750  2.446446 14.95902059 24.546276
309  1.7639755  2.479375 -3.04959757  6.723971
310  4.9206523  2.510578  0.05223581 10.010874
330  5.7314172  2.571353  0.55835904 10.578138
331  7.4492006  2.499672  2.51563928 12.248281
332 10.2111848  2.307299  5.70148423 14.741920
333 10.3425496  2.385957  5.54446571 15.034852
334 11.4539205  2.376221  6.72870552 16.042401
335 -0.2500537  2.613364 -5.34701132  4.695453
337 19.1503543  2.461583 14.37058241 23.992234
349 11.4783837  2.435838  6.84293146 16.286837
350 17.0580186  2.531022 12.31732692 22.064381
351  7.4832399  2.309531  2.80949864 11.912510
352 14.0465247  2.415387  9.19886021 18.682503
369 11.3584372  2.336179  6.67606435 15.844629
370 15.1662741  2.569659 10.23727598 20.201937
371  9.4498383  2.347598  4.80372835 13.994350
372 11.8177901  2.399543  7.00686038 16.565058</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.8198 12.612740 228.9418 278.4637
  [2,] 273.4681 10.800911 252.0413 294.7778
  [3,] 293.1164  9.284846 274.4884 311.3460
  [4,] 312.7646  8.229656 296.2603 328.6115
  [5,] 332.4129  7.824084 316.6970 347.3744
  [6,] 352.0612  8.165509 335.8706 367.9416
  [7,] 371.7095  9.170877 353.6361 389.9468
  [8,] 391.3577 10.653855 370.8004 412.6135
  [9,] 411.0060 12.444857 387.3026 436.1443
 [10,] 430.6543 14.429639 403.2413 459.8018
 [11,] 211.4502 13.321036 184.3559 237.2488
 [12,] 213.2142 11.468887 190.0211 235.4745
 [13,] 214.9781  9.895218 195.4020 234.0293
 [14,] 216.7421  8.751566 199.8127 233.8905
 [15,] 218.5061  8.219433 202.5054 234.8216
 [16,] 220.2701  8.415632 203.8420 237.4509
 [17,] 222.0340  9.294152 203.8751 240.6955
 [18,] 223.7980 10.688042 203.1857 244.8443
 [19,] 225.5620 12.425049 200.9679 249.6996
 [20,] 227.3260 14.381379 198.6419 255.0581
 [21,] 212.8999 13.208419 186.7766 237.4817
 [22,] 217.8206 11.315807 195.3360 239.1430
 [23,] 222.7412  9.707658 203.3655 241.2999
 [24,] 227.6619  8.546097 210.9849 244.0364
 [25,] 232.5825  8.027385 217.1983 247.7990
 [26,] 237.5032  8.273334 221.4019 253.5128
 [27,] 242.4238  9.222972 224.5386 260.1899
 [28,] 247.3445 10.690387 226.1218 267.7416
 [29,] 252.2651 12.494459 227.3119 276.3310
 [30,] 257.1858 14.510158 228.2153 285.0426
 [31,] 274.3804 13.561606 248.6075 301.4371
 [32,] 280.1118 11.574014 258.2339 302.8242
 [33,] 285.8432  9.860130 266.9033 304.8923
 [34,] 291.5746  8.585465 275.1508 308.4289
 [35,] 297.3060  7.963792 281.7094 312.6290
 [36,] 303.0375  8.146009 286.8985 318.5408
 [37,] 308.7689  9.083868 290.8011 325.8639
 [38,] 314.5003 10.578259 293.6279 334.7436
 [39,] 320.2317 12.430051 295.8131 343.6464
 [40,] 325.9631 14.502982 297.4451 353.3504
 [41,] 273.2207 13.068512 248.2988 298.4354
 [42,] 280.6699 11.197876 259.6350 302.3613
 [43,] 288.1191  9.617462 269.7607 306.7391
 [44,] 295.5683  8.490902 278.9699 312.0381
 [45,] 303.0175  8.011991 287.3553 318.5906
 [46,] 310.4667  8.293690 294.0772 327.0339
 [47,] 317.9159  9.266894 299.6816 336.4196
 [48,] 325.3651 10.745327 304.4015 346.5889
 [49,] 332.8143 12.551714 308.3780 356.9631
 [50,] 340.2635 14.564536 311.7319 368.4832
 [51,] 260.3033 12.140500 237.5972 284.2745
 [52,] 270.5145 10.485356 250.9684 291.3013
 [53,] 280.7257  9.118164 263.3901 298.4761
 [54,] 290.9368  8.184521 275.5094 306.9875
 [55,] 301.1480  7.840862 286.0881 315.9536
 [56,] 311.3592  8.162053 295.2971 326.8077
 [57,] 321.5704  9.077794 303.1739 339.0500
 [58,] 331.7816 10.432681 310.4878 351.9064
 [59,] 341.9928 12.079842 317.0977 365.2765
 [60,] 352.2040 13.915876 323.9069 379.1986
 [61,] 267.5918 12.768998 242.8890 292.7752
 [62,] 277.9344 10.988577 257.0891 299.7563
 [63,] 288.2769  9.478182 270.1460 307.6295
 [64,] 298.6195  8.385023 282.5271 315.9014
 [65,] 308.9620  7.884598 293.9846 324.7483
 [66,] 319.3046  8.087691 303.4720 335.4076
 [67,] 329.6471  8.946519 312.5135 347.4808
 [68,] 339.9897 10.298312 320.5019 359.9308
 [69,] 350.3322 11.977305 327.5510 374.0858
 [70,] 360.6748 13.865138 334.2351 387.9960
 [71,] 244.6126 12.787864 219.2526 269.1819
 [72,] 256.0665 11.026650 234.2980 277.5189
 [73,] 267.5204  9.536110 248.8502 286.0911
 [74,] 278.9744  8.460533 262.4941 295.6796
 [75,] 290.4283  7.969736 274.7561 306.2028
 [76,] 301.8822  8.169800 285.5655 318.4280
 [77,] 313.3361  9.014844 295.4034 331.3187
 [78,] 324.7900 10.348045 304.3658 345.1748
 [79,] 336.2440 12.007894 312.3928 359.2971
 [80,] 347.6979 13.877674 320.2108 374.7263
 [81,] 250.7216 13.578609 224.7795 277.2167
 [82,] 250.4716 11.573059 228.1198 273.0050
 [83,] 250.2215  9.856576 231.2007 269.6983
 [84,] 249.9714  8.603942 233.0831 266.7827
 [85,] 249.7214  8.035105 233.9095 265.3253
 [86,] 249.4713  8.292005 233.2263 265.5053
 [87,] 249.2213  9.306510 231.1642 267.3176
 [88,] 248.9712 10.868499 228.1394 270.1862
 [89,] 248.7212 12.778761 224.0944 273.9369
 [90,] 248.4711 14.903978 219.9130 277.9972
 [91,] 285.8830 13.187095 260.5035 311.7006
 [92,] 305.0334 11.320631 283.2557 327.2570
 [93,] 324.1837  9.722792 305.6030 343.0091
 [94,] 343.3341  8.545610 327.1783 360.0565
 [95,] 362.4845  7.977531 347.2943 378.1472
 [96,] 381.6348  8.146984 365.8168 397.7294
 [97,] 400.7852  9.012462 383.2869 418.9976
 [98,] 419.9355 10.401653 399.6286 441.1974
 [99,] 439.0859 12.136024 415.3920 463.5102
[100,] 458.2362 14.088667 431.2048 486.6330
[101,] 226.9332 12.963382 201.0442 251.5705
[102,] 238.4116 11.150206 215.8803 259.9312
[103,] 249.8900  9.616210 230.3783 268.7682
[104,] 261.3684  8.513666 244.5930 278.0647
[105,] 272.8468  8.022477 257.3133 288.6669
[106,] 284.3251  8.252537 268.6912 300.5908
[107,] 295.8035  9.149602 278.4001 313.7393
[108,] 307.2819 10.544794 287.0647 328.1331
[109,] 318.7603 12.269341 295.0669 342.7998
[110,] 330.2387 14.203782 302.7666 357.9756
[111,] 238.7413 12.977438 213.2239 263.7681
[112,] 255.7993 11.082010 234.1116 277.2221
[113,] 272.8574  9.487896 254.4181 291.1460
[114,] 289.9154  8.369081 273.6412 306.3466
[115,] 306.9734  7.929377 291.6991 322.3955
[116,] 324.0314  8.277722 307.6215 340.1891
[117,] 341.0894  9.326226 322.4149 359.7042
[118,] 358.1475 10.874210 336.3055 379.2367
[119,] 375.2055 12.740900 349.8982 400.1524
[120,] 392.2635 14.806241 362.6144 420.9841
[121,] 255.8735 12.166977 232.0877 280.2209
[122,] 263.3568 10.492917 242.7774 284.1445
[123,] 270.8400  9.101381 252.7922 289.2107
[124,] 278.3233  8.138602 262.2603 294.7167
[125,] 285.8065  7.765720 270.7974 301.2352
[126,] 293.2897  8.064975 277.7593 309.2398
[127,] 300.7730  8.969343 283.2040 318.7138
[128,] 308.2562 10.320963 288.1739 329.1246
[129,] 315.7395 11.969264 292.7157 339.4089
[130,] 323.2227 13.808410 296.7174 350.5188
[131,] 271.9642 12.607233 247.2676 297.2865
[132,] 286.0107 10.816586 264.8754 307.6715
[133,] 300.0572  9.312515 281.7521 318.8264
[134,] 314.1038  8.253214 297.8136 330.6640
[135,] 328.1503  7.821529 312.7970 343.5346
[136,] 342.1968  8.118207 326.4793 358.1731
[137,] 356.2433  9.072070 338.6822 374.2556
[138,] 370.2899 10.505608 349.6376 390.9348
[139,] 384.3364 12.251585 360.4280 408.5326
[140,] 398.3829 14.195177 370.4701 426.3540
[141,] 254.5781 12.182970 230.5116 278.4794
[142,] 265.9365 10.505801 245.5818 286.5039
[143,] 277.2950  9.123290 259.7518 295.3407
[144,] 288.6534  8.186113 272.4543 304.8461
[145,] 300.0118  7.855312 284.2383 315.6426
[146,] 311.3703  8.204565 294.9874 327.2084
[147,] 322.7287  9.156381 304.1913 340.4586
[148,] 334.0871 10.548895 312.4607 354.4375
[149,] 345.4456 12.232520 320.2872 368.6870
[150,] 356.8040 14.103381 327.9391 383.7777
[151,] 226.4583 13.598338 198.9602 252.1882
[152,] 241.6246 11.617813 218.4667 263.7144
[153,] 256.7909  9.911543 237.4778 275.8852
[154,] 271.9571  8.643499 254.7924 288.8969
[155,] 287.1234  8.024199 271.0912 303.2252
[156,] 302.2897  8.201936 285.8059 318.5342
[157,] 317.4560  9.130281 299.1577 334.9921
[158,] 332.6222 10.614076 311.4603 352.9406
[159,] 347.7885 12.456383 323.0803 371.8062
[160,] 362.9548 14.521386 334.5092 391.1220
[161,] 252.3772 12.229274 228.1702 277.1592
[162,] 261.8271 10.542142 240.9673 283.2634
[163,] 271.2769  9.151001 253.1057 289.6458
[164,] 280.7268  8.207759 264.4136 296.8431
[165,] 290.1766  7.875038 274.7453 305.3470
[166,] 299.6264  8.227245 283.3043 316.0247
[167,] 309.0763  9.185932 290.8326 327.1557
[168,] 318.5261 10.587614 297.8409 339.5890
[169,] 327.9759 12.281540 304.3122 352.4424
[170,] 337.4258 14.163238 309.8693 365.7021
[171,] 263.4478 12.437099 238.6152 288.5572
[172,] 275.2656 10.717358 254.2541 296.5926
[173,] 287.0834  9.303640 268.7599 305.1023
[174,] 298.9012  8.352800 282.4927 315.1876
[175,] 310.7190  8.030968 295.2343 326.5869
[176,] 322.5368  8.410663 305.9069 339.2649
[177,] 334.3545  9.407319 315.9064 353.2116
[178,] 346.1723 10.852266 325.2315 367.8469
[179,] 357.9901 12.592113 334.0113 383.1541
[180,] 369.8079 14.521245 342.1163 398.5064</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.2598249 12.612740  -28.9037311  20.6182276
  [2,]  -14.7633998 10.800911  -36.0731325   6.6633511
  [3,]  -42.3157748  9.284846  -60.5454294 -23.6877638
  [4,]    8.6751502  8.229656   -7.1716720  25.1794865
  [5,]   24.4389752  7.824084    9.4774826  40.1549447
  [6,]   62.6289003  8.165509   46.7484505  78.8195237
  [7,]   10.4943253  9.170877   -7.7429728  28.5676543
  [8,] -101.2091497 10.653855 -122.4648570 -80.6518064
  [9,]   19.5792753 12.444857   -5.5589923  43.2827394
 [10,]   35.6992004 14.429639    6.5516872  63.1122084
 [11,]   11.2837056 13.321036  -14.5148849  38.3779972
 [12,]   -7.9483699 11.468887  -30.2087480  15.2446610
 [13,]  -12.0003454  9.895218  -31.0514841   7.5758306
 [14,]  -12.0351209  8.751566  -29.1834803   4.8942941
 [15,]  -10.7899964  8.219433  -27.1055108   5.2106545
 [16,]   -4.3082718  8.415632  -21.4891251  12.1198285
 [17,]   -8.4037473  9.294152  -27.0652331   9.7552181
 [18,]   -6.0708228 10.688042  -27.1171339  14.5415450
 [19,]   -1.2662983 12.425049  -25.4038900  23.3277560
 [20,]    9.9882262 14.381379  -17.7438520  38.6722743
 [21,]  -13.8460039 13.208419  -38.4277781  12.2773232
 [22,]  -23.4883562 11.315807  -44.8107731  -1.0038343
 [23,]   11.5787915  9.707658   -6.9798549  30.9545229
 [24,]    5.1797392  8.546097  -11.1947907  21.8567153
 [25,]   -3.2751131  8.027385  -18.4916315  12.1091484
 [26,]  -17.0452654  8.273334  -33.0549305  -0.9439673
 [27,]   -7.0030177  9.222972  -24.7690771  10.8821967
 [28,]    8.4066300 10.690387  -11.9904992  29.6292809
 [29,]    8.7473777 12.494459  -15.3185432  33.7006373
 [30,]   -9.6704746 14.510158  -37.5272957  19.3000305
 [31,]   47.1622282 13.561606   20.1054923  72.9351453
 [32,]   20.2884111 11.574014   -2.4240095  42.1663478
 [33,]   -1.9867061  9.860130  -21.0357940  16.9531928
 [34,]   -6.4416233  8.585465  -23.2959425   9.9821901
 [35,]  -11.5087405  7.963792  -26.8317334   4.0879288
 [36,]   -5.4519577  8.146009  -20.9552977  10.6870365
 [37,]  -28.5292749  9.083868  -45.6243164 -10.5614738
 [38,]    3.7610079 10.578259  -16.4822531  24.6334287
 [39,]  -14.8822093 12.430051  -38.2969386   9.5364140
 [40,]   28.0855735 14.502982    0.6982723  56.6035996
 [41,]   14.3871978 13.068512  -10.8275257  39.3090823
 [42,]    4.3300972 11.197876  -17.3612962  25.3650444
 [43,]   13.7014965  9.617462   -4.9185164  32.0599332
 [44,]   24.5469959  8.490902    8.0771953  41.1453937
 [45,]   13.2597953  8.011991   -2.3133148  28.9219617
 [46,]  -17.1480053  8.293690  -33.7152268  -0.7584886
 [47,]  -27.8409060  9.266894  -46.3445638  -9.6065550
 [48,]    9.4525934 10.745327  -11.7711914  30.4162064
 [49,]  -39.0674072 12.551714  -63.2161611 -14.6311344
 [50,]   31.3175921 14.564536    3.0978624  59.8491540
 [51,]  -25.4426894 12.140500  -49.4138738  -2.7366263
 [52,]  -27.7026743 10.485356  -48.4894511  -8.1566186
 [53,]   -7.7643591  9.118164  -25.5148463   9.5711503
 [54,]   18.8319561  8.184521    2.7812834  34.2594456
 [55,]   16.3148712  7.840862    1.5092688  31.3748111
 [56,]   -1.3616136  8.162053  -16.8100595  14.7004545
 [57,]  132.5915015  9.077794  115.1118518 150.9879938
 [58,]   15.0495167 10.432681   -5.0753499  36.3433241
 [59,]  -11.6924681 12.079842  -34.9762057  13.2025998
 [60,]  -98.3395530 13.915876 -125.3342371 -70.0425047
 [61,]   16.2505584 12.768998   -8.9328102  40.9534180
 [62,]   11.6206088 10.988577  -10.2013314  32.4659057
 [63,]  -11.5076408  9.478182  -30.8601730   6.6233112
 [64,]    1.1902096  8.385023  -16.0917229  17.2825641
 [65,]  -11.7910400  7.884598  -27.5773264   3.1864193
 [66,]   18.8619104  8.087691    2.7589405  34.6945230
 [67,]    2.3793607  8.946519  -15.4543110  19.5130429
 [68,]    8.8502111 10.298312  -11.0908811  28.3379741
 [69,]  -16.9722385 11.977305  -40.7257542   5.8090366
 [70,]    1.3680119 13.865138  -25.9531888  27.8076513
 [71,]   20.8605093 12.787864   -3.7088200  46.2205256
 [72,]   20.1346888 11.026650   -1.3177125  41.9031841
 [73,]  -24.1557316  9.536110  -42.7263619  -5.4855085
 [74,]  -24.3020521  8.460533  -41.0073429  -7.8217917
 [75,]  -11.4038726  7.969736  -27.1783681   4.2682761
 [76,]  -17.6909930  8.169800  -34.2368032  -1.3743113
 [77,]   -7.8113135  9.014844  -25.7939220  10.1214487
 [78,]    6.7328660 10.348045  -13.6519314  27.1570634
 [79,]   -0.4970544 12.007894  -23.5501524  23.3541397
 [80,]   29.6011251 13.877674    2.5726737  57.0881908
 [81,]   -9.1133043 13.578609  -35.6083738  16.8287587
 [82,]   23.4756494 11.573059    0.9422474  45.8274289
 [83,]    4.2692031  9.856576  -15.2076440  23.2899644
 [84,]   20.8306568  8.603942    4.0194293  37.7189984
 [85,]    1.7305106  8.035105  -13.8734051  17.5423797
 [86,]    5.1648643  8.292005  -10.8690676  21.4098667
 [87,]   -3.7689820  9.306510  -21.8653029  14.2880884
 [88,]  -13.6602283 10.868499  -34.8752029   7.1716176
 [89,]  -12.9670746 12.778761  -38.1827578  11.6597336
 [90,]  -11.2245209 14.903978  -40.7505567  17.3336085
 [91,]   26.4835613 13.187095    0.6659993  51.8630790
 [92,]    8.7724070 11.320631  -13.4511570  30.5501492
 [93,]  -32.5725473  9.722792  -51.3978876 -13.9917917
 [94,]    2.7880983  8.545610  -13.9343261  18.9439216
 [95,]    3.2479440  7.977531  -12.4148215  18.4381006
 [96,]   10.2036897  8.146984   -5.8908594  26.0217442
 [97,]    3.4749353  9.012462  -14.7375232  20.9732361
 [98,]   -3.2432190 10.401653  -24.5050955  17.0637131
 [99,]   16.7784267 12.136024   -7.6459283  40.4722703
[100,]    0.6804724 14.088667  -27.7163453  27.7119209
[101,]    9.1699839 12.963382  -15.4673342  35.0589673
[102,]   -8.0948998 11.150206  -29.6144683  14.4363599
[103,]  -10.9643834  9.616210  -29.8426070   8.5472550
[104,]   -6.4463671  8.513666  -23.1427252  10.3289733
[105,]  -22.1364508  8.022477  -37.9566488  -6.6029980
[106,]  -14.5507344  8.252537  -30.8164286   1.0831635
[107,]  -14.2387181  9.149602  -32.1744601   3.1647145
[108,]    0.8200982 10.544794  -20.0310738  21.0373075
[109,]   17.5203145 12.269341   -6.5192147  41.2137053
[110,]   21.4064309 14.203782   -6.3305203  48.8785170
[111,]   17.5554725 12.977438   -7.4712624  43.0729450
[112,]  -12.3450461 11.082010  -33.7677684   9.3427255
[113,]  -16.6527647  9.487896  -34.9414394   1.7865324
[114,]  -34.3882833  8.369081  -50.8195357 -18.1141009
[115,]  -38.0569019  7.929377  -53.4789603 -22.7826177
[116,]    5.6932796  8.277722  -10.4643512  22.1031989
[117,]   38.3550610  9.326226   19.7402621  57.0296100
[118,]    4.7709424 10.874210  -16.3183314  26.6128626
[119,]   19.2817238 12.740900   -5.6652452  44.5890011
[120,]   -3.2107948 14.806241  -31.9314097  26.4382669
[121,]   -5.3470485 12.166977  -29.6944115  18.4388219
[122,]   36.7008116 10.492917   15.9131192  57.2801633
[123,]   -0.9461283  9.101381  -19.3168378  17.1017047
[124,]    2.2658318  8.138602  -14.1275700  18.3288238
[125,]  -13.9791081  7.765720  -29.4078038   1.0300003
[126,]   11.3438520  8.064975   -4.6062124  26.8743249
[127,]  -13.0263879  8.969343  -30.9671938   4.5426262
[128,]  -41.6607278 10.320963  -62.5291244 -21.5783860
[129,]    5.8023323 11.969264  -17.8670923  28.8260742
[130,]   24.3427924 13.808410   -2.9533325  50.8480783
[131,]  -50.2870834 12.607233  -75.6094190 -25.5904571
[132,]   12.1831919 10.816586   -9.4775835  33.3184880
[133,]   26.8212672  9.312515    8.0520741  45.1264453
[134,]   32.7517425  8.253214   16.1915496  49.0419208
[135,]   20.5899178  7.821529    5.2056036  35.9432021
[136,]   10.6318931  8.118207   -5.3443653  26.3494439
[137,]   -1.8167316  9.072070  -19.8289607  15.7444181
[138,]   -9.8572563 10.505608  -30.5022122  10.7950417
[139,]   -8.6957810 12.251585  -32.8919531  15.2125855
[140,]   -9.8412057 14.195177  -37.8123144  18.0715857
[141,]   17.3454242 12.182970   -6.5559167  41.4118893
[142,]    2.5003870 10.505801  -18.0669981  22.8551108
[143,]  -20.0525503  9.123290  -38.0983092  -2.5093597
[144,]  -10.9967875  8.186113  -27.1895192   5.2023466
[145,]   14.8103753  7.855312   -0.8203897  30.5838538
[146,]    5.8432380  8.204565   -9.9949133  22.2261032
[147,]  -24.5933992  9.156381  -42.3233307  -6.0560346
[148,]   14.0357636 10.548895   -6.3145548  35.6621640
[149,]   -5.1655737 12.232520  -28.4070465  19.9927777
[150,]    9.7090891 14.103381  -17.2646476  38.5740171
[151,]   -1.1943165 13.598338  -26.9241772  26.3038386
[152,]   -7.1010906 11.617813  -29.1908701  16.0567565
[153,]  -17.8900647  9.911543  -36.9844017   1.4230101
[154,]  -31.4841387  8.643499  -48.4238864 -14.3193900
[155,]  -19.5861128  8.024199  -35.6879343  -3.5538922
[156,]   41.9040132  8.201936   25.6595485  58.3878391
[157,]  -36.3078609  9.130281  -53.8440499 -18.0095580
[158,]   14.9632650 10.614076   -5.3551429  36.1252108
[159,]   17.3744910 12.456383   -6.6432040  42.0826719
[160,]    9.2740169 14.521386  -18.8932196  37.7195786
[161,]   17.5031604 12.229274   -7.2787778  41.7102268
[162,]   10.6157221 10.542142  -10.8205754  31.4755254
[163,]    6.6219838  9.151001  -11.7468906  24.7931520
[164,]    1.0627455  8.207759  -15.0535873  17.3759269
[165,]  -11.0060928  7.875038  -26.1764823   4.4251822
[166,]  -15.1144311  8.227245  -31.5126921   1.2077455
[167,]  -49.8104693  9.185932  -67.8898796 -31.5668145
[168,]  -13.8955076 10.587614  -34.9583800   6.7897319
[169,]   22.8047541 12.281540   -1.6617376  46.4684690
[170,]   32.0434158 14.163238    3.7670518  59.5998774
[171,]    5.9638967 12.437099  -19.1455036  30.7965336
[172,]   -1.7915934 10.717358  -23.1185653  19.2198531
[173,]   10.5134164  9.303640   -7.5055463  28.8369400
[174,]   11.7304263  8.352800   -4.5560287  28.1389057
[175,]  -23.5463638  8.030968  -39.4142849  -8.0616911
[176,]    7.0708460  8.410663   -9.6572958  23.7007461
[177,]    0.1272559  9.407319  -18.7297665  18.5753748
[178,]   -2.9524342 10.852266  -24.6270443  17.9884176
[179,]   11.1515756 12.592113  -14.0123840  35.1303958
[180,]   -5.6843145 14.521245  -34.3827716  22.0073442</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.5  3.3
looic      1769.8 28.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   223       
 (0.5, 0.7]   (ok)         1    0.6%   2220      
   (0.7, 1]   (bad)        1    0.6%   176       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.8 22.7
p_loo        34.5  8.7
looic      1723.6 45.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   1001      
 (0.5, 0.7]   (ok)         5    2.8%   350       
   (0.7, 1]   (bad)        1    0.6%   43        
   (1, Inf)   (very bad)   2    1.1%   15        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.1      11.9  
fit_sleep1 -91.5      21.3  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.5  3.3
looic      1769.8 28.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   223       
 (0.5, 0.7]   (ok)         1    0.6%   2220      
   (0.7, 1]   (bad)        1    0.6%   176       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.8 22.7
p_loo        34.5  8.7
looic      1723.6 45.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   1001      
 (0.5, 0.7]   (ok)         5    2.8%   350       
   (0.7, 1]   (bad)        1    0.6%   43        
   (1, Inf)   (very bad)   2    1.1%   15        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.8     22.7        34.5    8.7   1723.6
fit_sleep2  -23.1      11.9  -884.9     14.4        19.5    3.3   1769.8
fit_sleep1  -91.5      21.3  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   45.3  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.830608e-40 9.292608e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.91      1.55     0.31     5.42       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.09      1.55    -3.16     2.91       5.83      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.22 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.0         
  [4] magrittr_2.0.3       matrixStats_0.63.0   compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.21      
 [22] markdown_1.6         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.7         jsonlite_1.8.4      
 [28] highr_0.10           later_1.3.0          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.42           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.9        
 [43] splines_4.3.0        igraph_1.4.2         tidyselect_1.2.0    
 [46] abind_1.4-5          yaml_2.3.7           codetools_0.2-19    
 [49] miniUI_0.1.1.1       curl_5.0.0           processx_3.8.1      
 [52] pkgbuild_1.4.0       lattice_0.21-8       tibble_3.2.1        
 [55] plyr_1.8.8           shiny_1.7.4          withr_2.5.0         
 [58] bridgesampling_1.1-2 posterior_1.4.1      coda_0.19-4         
 [61] evaluate_0.20        RcppParallel_5.1.7   xts_0.13.1          
 [64] pillar_1.9.0         tensorA_0.36.2       checkmate_2.2.0     
 [67] DT_0.27              stats4_4.3.0         shinyjs_2.1.0       
 [70] distributional_0.3.2 generics_0.1.3       ggplot2_3.4.2       
 [73] rstantools_2.3.1     munsell_0.5.0        scales_1.2.1        
 [76] minqa_1.2.5          gtools_3.9.4         xtable_1.8-4        
 [79] glue_1.6.2           tools_4.3.0          shinystan_2.6.0     
 [82] colourpicker_1.2.0   mvtnorm_1.1-3        grid_4.3.0          
 [85] crosstalk_1.2.0      colorspace_2.1-0     nlme_3.1-162        
 [88] cli_3.6.1            fansi_1.0.4          Brobdingnag_1.2-9   
 [91] dplyr_1.1.2          V8_4.3.0             gtable_0.3.3        
 [94] sass_0.4.5           digest_0.6.31        htmlwidgets_1.6.2   
 [97] farver_2.1.1         htmltools_0.5.5      lifecycle_1.0.3     
[100] mime_0.12            shinythemes_1.2.0    MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
