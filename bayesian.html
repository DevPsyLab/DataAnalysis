<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing
adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.00      6.75    15.58    41.68 1.00     2120     2817
sd(Days)                6.57      1.50     4.17     9.95 1.00     1614     2446
cor(Intercept,Days)     0.07      0.30    -0.49     0.66 1.00      949     1613

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.44      7.44   236.20   266.33 1.00     1613     2168
Days         10.37      1.71     7.00    13.76 1.00     1289     2005

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.54    22.93    29.18 1.00     3699     3265

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9705  13.09615 227.3646 278.9481
309 211.5069  13.33753 185.7030 237.2221
310 212.9280  12.94988 187.0211 237.5356
330 274.7635  13.39084 249.6192 301.0964
331 272.9763  13.19638 246.9842 300.2165
332 260.1796  12.22007 236.4346 285.2517
333 268.0837  12.27237 244.4577 292.8610
334 244.3919  12.52568 219.1341 268.6716
335 250.9697  13.61968 225.2661 278.1713
337 286.0939  13.09541 260.2825 311.9196
349 226.0232  13.03165 199.5459 250.5249
350 238.5167  13.27801 211.9001 263.5854
351 255.5000  12.31882 231.6817 279.7740
352 272.0445  12.38993 247.8358 296.7405
369 254.8355  12.50322 229.5013 280.1426
370 226.1976  13.54316 199.0719 252.8644
371 252.0942  12.27430 227.6720 276.2953
372 263.6072  12.27570 239.2716 287.7366

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6105539  2.508807 14.6943934 24.472186
309  1.7731386  2.537451 -3.3526695  6.675141
310  4.9289267  2.416917  0.1764275  9.617949
330  5.7186729  2.487334  0.7410563 10.524724
331  7.4924825  2.446356  2.6059413 12.195248
332 10.2345618  2.331813  5.7439609 14.848790
333 10.2660113  2.354879  5.6146048 14.779533
334 11.5030518  2.373857  6.9225167 16.151445
335 -0.3071337  2.643553 -5.4752118  4.950688
337 19.1721042  2.497707 14.3018101 23.967692
349 11.6653454  2.475614  6.9350685 16.620585
350 17.0678080  2.521362 12.3411069 22.136198
351  7.5417165  2.381291  2.9460677 12.093740
352 14.0469137  2.394702  9.3275433 18.653054
369 11.2929537  2.376992  6.5817903 16.087833
370 15.2653853  2.538525 10.2566661 20.228892
371  9.4611478  2.348946  4.7576437 14.126576
372 11.7737321  2.330691  7.1328343 16.206449</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9705 13.096152 227.3646 278.9481
  [2,] 273.5811 11.176367 250.9347 295.0889
  [3,] 293.1916  9.534224 273.6328 311.5206
  [4,] 312.8022  8.335459 295.9829 328.8321
  [5,] 332.4127  7.787591 316.7712 347.5352
  [6,] 352.0233  8.025053 336.2335 367.8341
  [7,] 371.6338  8.985802 353.5451 389.2552
  [8,] 391.2444 10.472631 369.9227 411.2951
  [9,] 410.8549 12.296162 386.0189 434.3058
 [10,] 430.4655 14.328414 402.0940 458.1057
 [11,] 211.5069 13.337531 185.7030 237.2221
 [12,] 213.2801 11.412617 190.9381 235.3028
 [13,] 215.0532  9.771552 195.9770 234.2958
 [14,] 216.8263  8.578807 200.0018 233.5887
 [15,] 218.5995  8.036539 202.9753 234.5070
 [16,] 220.3726  8.273652 204.2241 236.3627
 [17,] 222.1458  9.230275 204.5277 239.7110
 [18,] 223.9189 10.715407 203.4417 244.1942
 [19,] 225.6920 12.542697 201.3556 249.3565
 [20,] 227.4652 14.584096 199.0134 254.5550
 [21,] 212.9280 12.949883 187.0211 237.5356
 [22,] 217.8569 11.182213 195.4233 239.4301
 [23,] 222.7859  9.698828 203.9030 241.5332
 [24,] 227.7148  8.647290 211.2437 244.7262
 [25,] 232.6437  8.195544 216.9551 249.1103
 [26,] 237.5726  8.440453 221.4556 254.0635
 [27,] 242.5016  9.327300 224.6668 260.4095
 [28,] 247.4305 10.697605 226.7441 267.8053
 [29,] 252.3594 12.392012 227.5590 276.6418
 [30,] 257.2884 14.295739 228.3320 285.0476
 [31,] 274.7635 13.390838 249.6192 301.0964
 [32,] 280.4822 11.489391 258.6347 303.1177
 [33,] 286.2009  9.852478 267.1725 305.4682
 [34,] 291.9195  8.631930 274.9154 308.7453
 [35,] 297.6382  8.020147 281.9725 313.1611
 [36,] 303.3569  8.155302 287.3206 318.8057
 [37,] 309.0756  9.003822 291.4829 326.3688
 [38,] 314.7942 10.392417 294.6777 335.0253
 [39,] 320.5129 12.137113 296.6874 344.6501
 [40,] 326.2316 14.106394 298.6964 354.3252
 [41,] 272.9763 13.196383 246.9842 300.2165
 [42,] 280.4688 11.356741 258.1995 303.8683
 [43,] 287.9613  9.786517 268.3449 307.9070
 [44,] 295.4538  8.633977 278.7781 312.8218
 [45,] 302.9462  8.079884 287.3151 319.5244
 [46,] 310.4387  8.245775 294.2781 326.9609
 [47,] 317.9312  9.092326 299.7860 336.1271
 [48,] 325.4237 10.455491 304.1820 346.2266
 [49,] 332.9162 12.162791 308.2739 356.9442
 [50,] 340.4087 14.089678 312.2683 368.1197
 [51,] 260.1796 12.220072 236.4346 285.2517
 [52,] 270.4141 10.515907 249.7415 292.0286
 [53,] 280.6487  9.094678 263.2452 299.0950
 [54,] 290.8833  8.106585 275.3150 306.7220
 [55,] 301.1178  7.719779 286.3715 316.0574
 [56,] 311.3524  8.021718 295.6708 326.8827
 [57,] 321.5869  8.942910 304.0065 339.2476
 [58,] 331.8215 10.318818 311.6305 352.0207
 [59,] 342.0561 11.993961 318.3389 365.2371
 [60,] 352.2906 13.860263 324.7862 379.3049
 [61,] 268.0837 12.272370 244.4577 292.8610
 [62,] 278.3497 10.575202 257.7343 299.8906
 [63,] 288.6158  9.173311 270.7442 307.1786
 [64,] 298.8818  8.219201 282.8200 315.3909
 [65,] 309.1478  7.877298 293.9500 324.9957
 [66,] 319.4138  8.224310 303.3822 335.8295
 [67,] 329.6798  9.182463 311.8838 348.2078
 [68,] 339.9458 10.587110 319.7318 361.2930
 [69,] 350.2118 12.286052 326.4556 375.0825
 [70,] 360.4778 14.173855 332.8046 388.8548
 [71,] 244.3919 12.525682 219.1341 268.6716
 [72,] 255.8950 10.804370 234.1695 276.4322
 [73,] 267.3980  9.372645 248.9020 285.0580
 [74,] 278.9011  8.380272 262.2435 294.9810
 [75,] 290.4041  7.992611 274.3046 305.8901
 [76,] 301.9072  8.294884 285.1905 318.0299
 [77,] 313.4102  9.219478 294.9545 331.2506
 [78,] 324.9133 10.604850 304.0537 345.4618
 [79,] 336.4163 12.296231 312.2691 360.0792
 [80,] 347.9194 14.184575 320.1476 375.2035
 [81,] 250.9697 13.619676 225.2661 278.1713
 [82,] 250.6626 11.584005 228.6449 273.5371
 [83,] 250.3555  9.841725 231.7390 269.9188
 [84,] 250.0483  8.573602 233.7597 266.9197
 [85,] 249.7412  8.008152 234.5618 265.8166
 [86,] 249.4341  8.290422 233.4041 265.9779
 [87,] 249.1269  9.343898 230.6598 268.0551
 [88,] 248.8198 10.948174 227.1708 270.5614
 [89,] 248.5127 12.899355 222.6715 274.0319
 [90,] 248.2055 15.063231 218.0733 278.0535
 [91,] 286.0939 13.095407 260.2825 311.9196
 [92,] 305.2660 11.221785 283.7129 327.4894
 [93,] 324.4381  9.635574 306.1128 343.4788
 [94,] 343.6102  8.499249 327.2194 360.4824
 [95,] 362.7823  8.006700 347.4440 378.6414
 [96,] 381.9544  8.273714 365.9092 397.7923
 [97,] 401.1265  9.234637 382.8177 419.1853
 [98,] 420.2986 10.704195 398.8049 440.6700
 [99,] 439.4707 12.504325 414.6144 463.5309
[100,] 458.6428 14.512532 429.9131 486.6376
[101,] 226.0232 13.031650 199.5459 250.5249
[102,] 237.6885 11.161563 214.7071 258.5213
[103,] 249.3539  9.570496 229.9887 267.7528
[104,] 261.0192  8.418173 244.4312 277.0306
[105,] 272.6846  7.899000 257.2178 287.6444
[106,] 284.3499  8.135115 268.4757 300.1663
[107,] 296.0152  9.067707 278.4912 313.6488
[108,] 307.6806 10.513033 287.4473 328.0240
[109,] 319.3459 12.291532 295.6133 343.0045
[110,] 331.0113 14.279249 303.4135 358.9798
[111,] 238.5167 13.278010 211.9001 263.5854
[112,] 255.5845 11.359915 232.6612 277.1847
[113,] 272.6523  9.721334 253.3471 291.1427
[114,] 289.7202  8.524995 272.8130 306.3922
[115,] 306.7880  7.972532 290.7959 322.2899
[116,] 323.8558  8.195214 308.0435 340.3956
[117,] 340.9236  9.136538 323.6597 359.1206
[118,] 357.9914 10.606869 337.9963 378.8122
[119,] 375.0592 12.419724 351.7224 399.3418
[120,] 392.1270 14.446728 364.7610 420.5415
[121,] 255.5000 12.318817 231.6817 279.7740
[122,] 263.0417 10.593431 242.5121 283.8701
[123,] 270.5834  9.166755 252.8271 288.4162
[124,] 278.1251  8.196287 262.2502 293.9559
[125,] 285.6668  7.853020 270.2182 300.8026
[126,] 293.2085  8.215949 277.0892 309.2789
[127,] 300.7503  9.201891 282.7722 318.9612
[128,] 308.2920 10.639027 287.6578 329.0865
[129,] 315.8337 12.371098 292.0554 339.7763
[130,] 323.3754 14.291267 295.5657 351.2073
[131,] 272.0445 12.389934 247.8358 296.7405
[132,] 286.0914 10.628969 265.4666 307.2780
[133,] 300.1384  9.160170 282.4179 317.9795
[134,] 314.1853  8.143195 298.3228 330.0319
[135,] 328.2322  7.757817 313.0019 343.4457
[136,] 342.2791  8.094753 325.9808 358.2393
[137,] 356.3260  9.073892 338.2381 374.2274
[138,] 370.3729 10.517377 349.4695 391.1874
[139,] 384.4198 12.262304 360.6804 408.9983
[140,] 398.4668 14.197964 371.0564 427.0777
[141,] 254.8355 12.503221 229.5013 280.1426
[142,] 266.1285 10.733536 244.3281 287.5188
[143,] 277.4214  9.240522 258.8683 295.8940
[144,] 288.7144  8.177155 272.3377 304.6896
[145,] 300.0074  7.722996 284.7373 315.1107
[146,] 311.3003  7.982709 295.6229 326.5913
[147,] 322.5933  8.893976 305.1400 339.7436
[148,] 333.8862 10.285045 313.4238 353.6070
[149,] 345.1792 11.990065 321.3133 368.2728
[150,] 356.4721 13.893932 328.5699 383.7183
[151,] 226.1976 13.543156 199.0719 252.8644
[152,] 241.4630 11.591464 218.1108 264.0951
[153,] 256.7284  9.909350 237.0070 276.1435
[154,] 271.9938  8.655438 255.1243 288.8557
[155,] 287.2592  8.032822 271.4617 303.1093
[156,] 302.5246  8.186822 286.7949 319.3072
[157,] 317.7899  9.078001 300.3218 335.9025
[158,] 333.0553 10.520664 312.4321 353.5875
[159,] 348.3207 12.322615 324.4874 372.3838
[160,] 363.5861 14.349130 336.0346 391.6401
[161,] 252.0942 12.274298 227.6720 276.2953
[162,] 261.5554 10.577715 240.4499 282.2033
[163,] 271.0165  9.173484 252.9031 288.8386
[164,] 280.4776  8.212958 264.6142 296.3720
[165,] 289.9388  7.860511 274.9560 305.3056
[166,] 299.3999  8.194980 283.5007 315.3172
[167,] 308.8611  9.141272 291.1137 326.8805
[168,] 318.3222 10.535801 298.0139 339.1407
[169,] 327.7834 12.226138 304.3203 351.7310
[170,] 337.2445 14.106343 310.1268 364.9209
[171,] 263.6072 12.275699 239.2716 287.7366
[172,] 275.3809 10.596909 254.2585 295.9160
[173,] 287.1547  9.206543 269.2085 305.0124
[174,] 298.9284  8.251704 282.6583 314.9510
[175,] 310.7021  7.892088 295.2007 325.4090
[176,] 322.4759  8.206323 306.3183 338.2332
[177,] 334.2496  9.125057 316.1567 352.0812
[178,] 346.0233 10.490655 324.8970 366.8108
[179,] 357.7971 12.153405 333.8091 381.6530
[180,] 369.5708 14.007888 342.2156 397.1348</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.4105144 13.096152  -29.3881075  22.1954359
  [2,]  -14.8763683 11.176367  -36.3842378   7.7699957
  [3,]  -42.3910222  9.534224  -60.7199901 -22.8322171
  [4,]    8.6376240  8.335459   -7.3923497  25.4569141
  [5,]   24.4391701  7.787591    9.3167012  40.0806975
  [6,]   62.6668163  8.025053   46.8559639  78.4565665
  [7,]   10.5699624  8.985802   -7.0514358  28.6587304
  [8,] -101.0957914 10.472631 -121.1464999 -79.7741099
  [9,]   19.7303547 12.296162   -3.7205274  44.5663632
 [10,]   35.8880008 14.328414    8.2477993  64.2594968
 [11,]   11.2269745 13.337531  -14.4882346  37.0308980
 [12,]   -8.0142641 11.412617  -30.0370147  14.3276996
 [13,]  -12.0754028  9.771552  -31.3180024   7.0008225
 [14,]  -12.1193414  8.578807  -28.8817420   4.7052060
 [15,]  -10.8833801  8.036539  -26.7908777   4.7407771
 [16,]   -4.4108187  8.273652  -20.4009246  11.7376819
 [17,]   -8.5154573  9.230275  -26.0806714   9.1025915
 [18,]   -6.1916960 10.715407  -26.4669627  14.2855185
 [19,]   -1.3963346 12.542697  -25.0608010  22.9400806
 [20,]    9.8490267 14.584096  -17.2408268  38.3007870
 [21,]  -13.8741156 12.949883  -38.4816593  12.0328161
 [22,]  -23.5247423 11.182213  -45.0979097  -1.0910554
 [23,]   11.5341311  9.698828   -7.2132261  30.4169539
 [24,]    5.1268044  8.647290  -11.8845654  21.5978706
 [25,]   -3.3363223  8.195544  -19.8029307  12.3523031
 [26,]  -17.1147489  8.440453  -33.6055816  -0.9976614
 [27,]   -7.0807756  9.327300  -24.9886947  10.7539675
 [28,]    8.3205978 10.697605  -12.0541742  29.0069927
 [29,]    8.6530711 12.392012  -15.6292791  33.4534973
 [30,]   -9.7730556 14.295739  -37.5323404  19.1832915
 [31,]   46.7790757 13.390838   20.4461907  71.9234121
 [32,]   19.9180028 11.489391   -2.7174843  41.7654944
 [33,]   -2.3443700  9.852478  -21.6116781  16.6839550
 [34,]   -6.7865429  8.631930  -23.6122511  10.2175994
 [35,]  -11.8409157  8.020147  -27.3637681   3.8247930
 [36,]   -5.7713886  8.155302  -21.2202134  10.2649437
 [37,]  -28.8359614  9.003822  -46.1292216 -11.2433245
 [38,]    3.4670657 10.392417  -16.7639933  23.5835778
 [39,]  -15.1634072 12.137113  -39.3006172   8.6620711
 [40,]   27.8171200 14.106394   -0.2764828  55.3522667
 [41,]   14.6315816 13.196383  -12.6086267  40.6236540
 [42,]    4.5311991 11.356741  -18.8682858  26.8004666
 [43,]   13.8593166  9.786517   -6.0864049  33.4757025
 [44,]   24.6615340  8.633977    7.2935105  41.3371881
 [45,]   13.3310515  8.079884   -3.2471187  28.9622130
 [46,]  -17.1200311  8.245775  -33.6422448  -0.9593567
 [47,]  -27.8562136  9.092326  -46.0520839  -9.7109522
 [48,]    9.3940038 10.455491  -11.4089480  30.6356750
 [49,]  -39.1692787 12.162791  -63.1973228 -14.5270045
 [50,]   31.1724388 14.089678    3.4613527  59.3128421
 [51,]  -25.3189763 12.220072  -50.3911022  -1.5740325
 [52,]  -27.6023381 10.515907  -49.2167639  -6.9297065
 [53,]   -7.6873999  9.094678  -26.1336876   9.7161483
 [54,]   18.8855382  8.106585    3.0468488  34.4538266
 [55,]   16.3450764  7.719779    1.4054601  31.0914363
 [56,]   -1.3547854  8.021718  -16.8850847  14.3267752
 [57,]  132.5749528  8.942910  114.9143197 150.1553734
 [58,]   15.0095909 10.318818   -5.1895673  35.2006242
 [59,]  -11.7557709 11.993961  -34.9367723  11.9614258
 [60,]  -98.4262327 13.860263 -125.4404531 -70.9217615
 [61,]   15.7586680 12.272370   -9.0186060  39.3847114
 [62,]   11.2052566 10.575202  -10.3356397  31.8206885
 [63,]  -11.8464547  9.173311  -30.4092783   6.0250652
 [64,]    0.9279339  8.219201  -15.5811669  16.9896539
 [65,]  -11.9767774  7.877298  -27.8247418   3.2209534
 [66,]   18.7527112  8.224310    2.3369501  34.7843345
 [67,]    2.3466999  9.182463  -16.1812746  20.1427006
 [68,]    8.8940885 10.587110  -12.4531028  29.1080973
 [69,]  -16.8518228 12.286052  -41.7224607   6.9044093
 [70,]    1.5649658 14.173855  -26.8120403  29.2381999
 [71,]   21.0811729 12.525682   -3.1985490  46.3390219
 [72,]   20.3062212 10.804370   -0.2310134  42.0317071
 [73,]  -24.0333306  9.372645  -41.6933298  -5.5372521
 [74,]  -24.2287824  8.380272  -40.3087459  -7.5712168
 [75,]  -11.3797341  7.992611  -26.8656833   4.7197928
 [76,]  -17.7159859  8.294884  -33.8386960  -0.9992878
 [77,]   -7.8854377  9.219478  -25.7257982  10.5703081
 [78,]    6.6096106 10.604850  -13.9389491  27.4691953
 [79,]   -0.6694412 12.296231  -24.3323497  23.4777914
 [80,]   29.3796070 14.184575    2.0954512  57.1513739
 [81,]   -9.3614428 13.619676  -36.5630380  16.3421869
 [82,]   23.2845909 11.584005    0.4101349  45.3022916
 [83,]    4.1352247  9.841725  -15.4281269  22.7516881
 [84,]   20.7537584  8.573602    3.8823554  37.0424173
 [85,]    1.7106922  8.008152  -14.3646630  16.8900831
 [86,]    5.2021259  8.290422  -11.3417312  21.2320865
 [87,]   -3.6746403  9.343898  -22.6028420  14.7924527
 [88,]  -13.5088066 10.948174  -35.2504345   8.1401575
 [89,]  -12.7585728 12.899355  -38.2777677  13.0825898
 [90,]  -10.9589391 15.063231  -40.8068745  19.1733483
 [91,]   26.2727285 13.095407    0.4470372  52.0840931
 [92,]    8.5398242 11.221785  -13.6836231  30.0929274
 [93,]  -32.8268800  9.635574  -51.8675935 -14.5016349
 [94,]    2.5120158  8.499249  -14.3602399  18.9027956
 [95,]    2.9501115  8.006700  -12.9089681  18.2883828
 [96,]    9.8841073  8.273714   -5.9538219  25.9292815
 [97,]    3.1336030  9.234637  -14.9252147  21.4424096
 [98,]   -3.6063012 10.704195  -23.9777387  17.8873910
 [99,]   16.3935946 12.504325   -7.6666036  41.2498704
[100,]    0.2738903 14.512532  -27.7208801  29.0036280
[101,]   10.0800261 13.031650  -14.4216782  36.5573082
[102,]   -7.3718193 11.161563  -28.2046365  15.6095984
[103,]  -10.4282647  9.570496  -28.8271645   8.9369127
[104,]   -6.0972100  8.418173  -22.1085866  10.4908055
[105,]  -21.9742554  7.899000  -36.9340767  -6.5074791
[106,]  -14.5755008  8.135115  -30.3918748   1.2987112
[107,]  -14.4504461  9.067707  -32.0839814   3.0736246
[108,]    0.4214085 10.513033  -19.9219780  20.6546947
[109,]   16.9346631 12.291532   -6.7238959  40.6672792
[110,]   20.6338178 14.279249   -7.3346643  48.2316017
[111,]   17.7800715 13.278010   -7.2886283  44.3967275
[112,]  -12.1302365 11.359915  -33.7304015  10.7931058
[113,]  -16.4477444  9.721334  -34.9381009   2.8575024
[114,]  -34.1930524  8.524995  -50.8650519 -17.2858929
[115,]  -37.8714603  7.972532  -53.3734363 -21.8793647
[116,]    5.8689317  8.195214  -10.6708891  21.6811822
[117,]   38.5209237  9.136538   20.3238893  55.7847559
[118,]    4.9270158 10.606869  -15.8938147  24.9220518
[119,]   19.4280078 12.419724   -4.8545664  42.7647975
[120,]   -3.0743002 14.446728  -31.4887501  24.2916982
[121,]   -4.9734580 12.318817  -29.2475354  18.8447865
[122,]   37.0159255 10.593431   16.1875337  57.5454577
[123,]   -0.6894910  9.166755  -18.5222590  17.0668487
[124,]    2.4639925  8.196287  -13.3667642  18.3389126
[125,]  -13.8394239  7.853020  -28.9751718   1.6092316
[126,]   11.4250596  8.215949   -4.6452846  27.5444266
[127,]  -13.0036569  9.201891  -31.2146279   4.9744451
[128,]  -41.6964734 10.639027  -62.4909907 -21.0623173
[129,]    5.7081101 12.371098  -18.2345256  29.4864204
[130,]   24.1900937 14.291267   -3.6417924  51.9998015
[131,]  -50.3674352 12.389934  -75.0633928 -26.1587018
[132,]   12.1024511 10.628969   -9.0841345  32.7273046
[133,]   26.7401374  9.160170    8.8989635  44.4606061
[134,]   32.6702237  8.143195   16.8236409  48.5326998
[135,]   20.5080100  7.757817    5.2944980  35.7382743
[136,]   10.5495963  8.094753   -5.4106101  26.8478815
[137,]   -1.8994174  9.073892  -19.8008492  16.1884614
[138,]   -9.9403311 10.517377  -30.7547515  10.9630565
[139,]   -8.7792448 12.262304  -33.3576897  14.9601699
[140,]   -9.9250584 14.197964  -38.5359679  17.4853122
[141,]   17.0879584 12.503221   -8.2190562  42.4222465
[142,]    2.3084047 10.733536  -19.0818959  24.1088349
[143,]  -20.1790490  9.240522  -38.6515652  -1.6258515
[144,]  -11.0578027  8.177155  -27.0330470   5.3189153
[145,]   14.8148436  7.722996   -0.2884733  30.0848683
[146,]    5.9131899  7.982709   -9.3777939  21.5906019
[147,]  -24.4579638  8.893976  -41.6083202  -7.0047356
[148,]   14.2366825 10.285045   -5.4841237  34.6990554
[149,]   -4.8991712 11.990065  -27.9928497  18.9667086
[150,]   10.0409751 13.893932  -17.2051943  37.9431711
[151,]   -0.9336322 13.543156  -27.6003914  26.1920841
[152,]   -6.9395176 11.591464  -29.5716196  16.4126633
[153,]  -17.8276029  9.909350  -37.2427269   1.8938196
[154,]  -31.5207882  8.655438  -48.3827075 -14.6512581
[155,]  -19.7218736  8.032822  -35.5720292  -3.9244129
[156,]   41.6691411  8.186822   24.8864501  57.3987752
[157,]  -36.6418443  9.078001  -54.7544147 -19.1736943
[158,]   14.5301704 10.520664   -6.0019840  35.1534014
[159,]   16.8422851 12.322615   -7.2208271  40.6756260
[160,]    8.6426997 14.349130  -19.4113038  36.1941506
[161,]   17.7861969 12.274298   -6.4149087  42.2084282
[162,]   10.8874491 10.577715   -9.7605438  31.9929395
[163,]    6.8824014  9.173484  -10.9396519  24.9958444
[164,]    1.3118536  8.212958  -14.5824820  17.1753143
[165,]  -10.7682942  7.860511  -26.1351466   4.2144593
[166,]  -14.8879420  8.194980  -30.8051851   1.0112943
[167,]  -49.5952898  9.141272  -67.6146928 -31.8478862
[168,]  -13.6916375 10.535801  -34.5100927   6.6167357
[169,]   22.9973147 12.226138   -0.9502831  46.4603799
[170,]   32.2246669 14.106343    4.5483188  59.3423822
[171,]    5.8044834 12.275699  -18.3249094  30.1400919
[172,]   -1.9069487 10.596909  -22.4420342  19.2155250
[173,]   10.4421192  9.206543   -7.4156338  28.3882856
[174,]   11.7031871  8.251704   -4.3193707  27.9733232
[175,]  -23.5295450  7.892088  -38.2363883  -8.0281139
[176,]    7.1317229  8.206323   -8.6255825  23.2893374
[177,]    0.2321908  9.125057  -17.5994160  18.3251398
[178,]   -2.8034413 10.490655  -23.5908992  18.3228968
[179,]   11.3446266 12.153405  -12.5112539  35.3326196
[180,]   -5.4472055 14.007888  -33.0111736  21.9079988</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.4  3.3
looic      1770.0 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1133      
 (0.5, 0.7]   (ok)         2    1.1%   108       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.2
p_loo        33.5  8.2
looic      1721.4 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   945       
 (0.5, 0.7]   (ok)         3    1.7%   836       
   (0.7, 1]   (bad)        2    1.1%   61        
   (1, Inf)   (very bad)   2    1.1%   18        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.5  
fit_sleep1 -92.6      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.4  3.3
looic      1770.0 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1133      
 (0.5, 0.7]   (ok)         2    1.1%   108       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.2
p_loo        33.5  8.2
looic      1721.4 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   945       
 (0.5, 0.7]   (ok)         3    1.7%   836       
   (0.7, 1]   (bad)        2    1.1%   61        
   (1, Inf)   (very bad)   2    1.1%   18        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.7     22.2        33.5    8.2   1721.4
fit_sleep2  -24.3      11.5  -885.0     14.4        19.4    3.3   1770.0
fit_sleep1  -92.6      20.8  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.3  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.218329e-41 2.822599e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.91      1.54     0.33     5.44       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.09      1.54    -3.25     2.88       5.42      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.22 lme4_1.1-32         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.0         
  [4] magrittr_2.0.3       matrixStats_0.63.0   compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.21      
 [22] markdown_1.6         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.7         jsonlite_1.8.4      
 [28] highr_0.10           later_1.3.0          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.42           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.9        
 [43] splines_4.3.0        igraph_1.4.2         tidyselect_1.2.0    
 [46] abind_1.4-5          yaml_2.3.7           codetools_0.2-19    
 [49] miniUI_0.1.1.1       curl_5.0.0           processx_3.8.1      
 [52] pkgbuild_1.4.0       lattice_0.21-8       tibble_3.2.1        
 [55] plyr_1.8.8           shiny_1.7.4          withr_2.5.0         
 [58] bridgesampling_1.1-2 posterior_1.4.1      coda_0.19-4         
 [61] evaluate_0.20        RcppParallel_5.1.7   xts_0.13.1          
 [64] pillar_1.9.0         tensorA_0.36.2       checkmate_2.1.0     
 [67] DT_0.27              stats4_4.3.0         shinyjs_2.1.0       
 [70] distributional_0.3.2 generics_0.1.3       ggplot2_3.4.2       
 [73] rstantools_2.3.1     munsell_0.5.0        scales_1.2.1        
 [76] minqa_1.2.5          gtools_3.9.4         xtable_1.8-4        
 [79] glue_1.6.2           tools_4.3.0          shinystan_2.6.0     
 [82] colourpicker_1.2.0   mvtnorm_1.1-3        grid_4.3.0          
 [85] crosstalk_1.2.0      colorspace_2.1-0     nlme_3.1-162        
 [88] cli_3.6.1            fansi_1.0.4          Brobdingnag_1.2-9   
 [91] dplyr_1.1.2          V8_4.3.0             gtable_0.3.3        
 [94] sass_0.4.5           digest_0.6.31        htmlwidgets_1.6.2   
 [97] farver_2.1.1         htmltools_0.5.5      lifecycle_1.0.3     
[100] mime_0.12            shinythemes_1.2.0    MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
