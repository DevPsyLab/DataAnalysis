<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.88      6.58    15.97    41.36 1.00     1892     2607
sd(Days)                6.50      1.45     4.16     9.76 1.00     1498     2364
cor(Intercept,Days)     0.09      0.30    -0.47     0.66 1.00     1138     1835

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.37      7.32   236.96   265.65 1.00     1682     2141
Days         10.45      1.67     7.08    13.74 1.00     1388     2321

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.56    23.11    29.15 1.00     3738     3222

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.1298  12.97385 228.1684 278.2164
309 211.3711  12.95263 185.3841 236.5137
310 212.8823  13.33489 185.9797 238.2162
330 274.3430  13.36418 249.4556 302.2515
331 272.9691  13.02773 249.4851 299.9339
332 260.4485  12.34144 236.4987 285.6513
333 267.9098  12.56074 243.7290 293.2419
334 244.1396  12.61428 219.5359 268.9255
335 250.5718  13.17312 225.8284 277.2810
337 285.8879  13.17238 260.3886 311.6134
349 226.6608  12.84432 201.0265 251.1068
350 239.2819  13.12914 213.4373 265.0157
351 255.8563  12.61234 230.6561 280.6824
352 272.0115  12.36436 247.8107 296.2811
369 254.9649  12.22103 230.1807 278.2165
370 226.3237  13.31049 199.5183 251.3517
371 251.8649  12.19763 227.5161 276.0435
372 263.4528  12.29152 238.9799 288.3292

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.5536138  2.500295 14.78405243 24.603119
309  1.7778027  2.479717 -3.15885897  6.599441
310  4.9333450  2.496816  0.09566172  9.953080
330  5.7905327  2.529262  0.80946890 10.653647
331  7.4999859  2.467178  2.50959089 12.152087
332 10.2305501  2.349537  5.64836167 14.722859
333 10.3172124  2.395340  5.56003103 15.002851
334 11.5199858  2.406028  6.84213260 16.288184
335 -0.2291839  2.540375 -5.32673472  4.638697
337 19.1279576  2.495462 14.29443509 23.965861
349 11.5829894  2.441734  6.96775023 16.383506
350 16.9662506  2.500489 12.08914620 21.825029
351  7.4599442  2.413037  2.77487479 12.228973
352 14.0386475  2.333904  9.55850557 18.726420
369 11.2956703  2.352417  6.61294789 15.809689
370 15.2133720  2.527338 10.56731413 20.307941
371  9.5549770  2.365210  4.97202363 14.260771
372 11.7347443  2.327331  7.19146931 16.274994</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.1298 12.973849 228.1684 278.2164
  [2,] 273.6834 11.098656 251.2221 294.9434
  [3,] 293.2370  9.515383 273.9280 311.9804
  [4,] 312.7906  8.390937 296.0333 329.4473
  [5,] 332.3442  7.923136 316.7892 347.8089
  [6,] 351.8978  8.224797 336.1507 367.7628
  [7,] 371.4515  9.220708 353.7626 389.5442
  [8,] 391.0051 10.719074 370.4793 411.8816
  [9,] 410.5587 12.541077 385.6714 434.9351
 [10,] 430.1123 14.565768 401.1053 458.2595
 [11,] 211.3711 12.952625 185.3841 236.5137
 [12,] 213.1489 11.106491 190.6807 234.7436
 [13,] 214.9267  9.551741 195.9484 233.4686
 [14,] 216.7045  8.450762 200.2598 233.1989
 [15,] 218.4824  7.993309 203.3735 233.9988
 [16,] 220.2602  8.286652 204.1830 236.6175
 [17,] 222.0380  9.259709 204.0290 240.1275
 [18,] 223.8158 10.729110 202.6875 244.6500
 [19,] 225.5936 12.521318 201.1568 249.5072
 [20,] 227.3714 14.517265 199.4161 254.9397
 [21,] 212.8823 13.334894 185.9797 238.2162
 [22,] 217.8156 11.469357 194.6812 239.5878
 [23,] 222.7490  9.886408 202.9242 241.7413
 [24,] 227.6823  8.740948 210.3432 244.3505
 [25,] 232.6156  8.217996 216.6602 248.6573
 [26,] 237.5490  8.434153 221.3858 253.9109
 [27,] 242.4823  9.338233 224.3756 260.8656
 [28,] 247.4157 10.758180 226.9936 268.9370
 [29,] 252.3490 12.519683 227.6865 277.1624
 [30,] 257.2824 14.498781 229.0315 286.3060
 [31,] 274.3430 13.364178 249.4556 302.2515
 [32,] 280.1336 11.407772 258.7878 304.0377
 [33,] 285.9241  9.719444 267.5559 305.8892
 [34,] 291.7146  8.461221 275.6012 308.9373
 [35,] 297.5052  7.842911 282.1693 313.2653
 [36,] 303.2957  8.014024 287.6822 319.2445
 [37,] 309.0862  8.929291 291.3287 326.6757
 [38,] 314.8768 10.393951 294.5002 335.2306
 [39,] 320.6673 12.211902 296.8808 344.7528
 [40,] 326.4578 14.248550 298.4076 354.6394
 [41,] 272.9691 13.027733 249.4851 299.9339
 [42,] 280.4691 11.129405 259.9661 303.3700
 [43,] 287.9691  9.496286 270.2140 306.8822
 [44,] 295.4691  8.286686 279.9580 311.9791
 [45,] 302.9691  7.702781 287.7214 318.2681
 [46,] 310.4691  7.884823 294.8882 326.0569
 [47,] 317.9691  8.785327 301.0640 335.5034
 [48,] 325.4690 10.216038 305.6601 345.6034
 [49,] 332.9690 11.988614 309.2788 356.4324
 [50,] 340.4690 13.973554 312.7754 367.9404
 [51,] 260.4485 12.341438 236.4987 285.6513
 [52,] 270.6790 10.668775 249.8929 292.4392
 [53,] 280.9096  9.293821 262.2787 299.5203
 [54,] 291.1401  8.364692 274.7997 307.5724
 [55,] 301.3707  8.037519 285.5370 316.8122
 [56,] 311.6013  8.383077 295.5587 327.8294
 [57,] 321.8318  9.326891 303.9977 340.2165
 [58,] 332.0624 10.711978 311.7766 353.5566
 [59,] 342.2929 12.391234 318.8355 367.1502
 [60,] 352.5235 14.261120 325.3916 381.0363
 [61,] 267.9098 12.560741 243.7290 293.2419
 [62,] 278.2270 10.780682 257.5408 299.8495
 [63,] 288.5442  9.281665 270.3239 306.8801
 [64,] 298.8614  8.218931 282.4282 314.9753
 [65,] 309.1786  7.773522 293.8475 324.2559
 [66,] 319.4958  8.048589 303.7647 334.9350
 [67,] 329.8131  8.978152 312.0653 347.3085
 [68,] 340.1303 10.387972 319.9806 360.5391
 [69,] 350.4475 12.111483 326.7275 374.4886
 [70,] 360.7647 14.033580 333.4530 389.0262
 [71,] 244.1396 12.614283 219.5359 268.9255
 [72,] 255.6596 10.848520 234.3129 276.8125
 [73,] 267.1796  9.372223 248.6469 285.5116
 [74,] 278.6996  8.340546 262.4183 294.6662
 [75,] 290.2196  7.928984 274.7241 305.6261
 [76,] 301.7396  8.231088 285.3391 318.2610
 [77,] 313.2596  9.176643 295.1928 331.2346
 [78,] 324.7795 10.594749 304.2132 344.9720
 [79,] 336.2995 12.323334 312.3484 359.7854
 [80,] 347.8195 14.249855 319.9341 375.4331
 [81,] 250.5718 13.173118 225.8284 277.2810
 [82,] 250.3426 11.235840 229.1460 272.7533
 [83,] 250.1134  9.584580 231.8755 269.2604
 [84,] 249.8843  8.389950 233.5900 266.4760
 [85,] 249.6551  7.862911 234.2620 265.0157
 [86,] 249.4259  8.134279 233.3536 265.1659
 [87,] 249.1967  9.133161 231.4999 266.6400
 [88,] 248.9675 10.656913 228.3267 269.6295
 [89,] 248.7383 12.515269 224.5839 273.2488
 [90,] 248.5092 14.580848 220.5584 277.1568
 [91,] 285.8879 13.172381 260.3886 311.6134
 [92,] 305.0158 11.287014 283.2444 326.9720
 [93,] 324.1438  9.681755 305.6667 343.3235
 [94,] 343.2718  8.516499 326.9357 360.0702
 [95,] 362.3997  7.986224 346.5554 378.1219
 [96,] 381.5277  8.214832 365.3718 397.4466
 [97,] 400.6556  9.145590 383.2075 418.1257
 [98,] 419.7836 10.595038 399.2710 440.3671
 [99,] 438.9115 12.382347 414.7467 462.7930
[100,] 458.0395 14.382102 430.1843 486.0456
[101,] 226.6608 12.844321 201.0265 251.1068
[102,] 238.2438 11.057041 216.0891 259.4150
[103,] 249.8268  9.563675 230.6860 268.4993
[104,] 261.4098  8.520194 244.0425 278.1255
[105,] 272.9928  8.102326 256.6128 289.3818
[106,] 284.5758  8.403915 268.0989 301.6791
[107,] 296.1588  9.355641 277.7670 314.9014
[108,] 307.7418 10.786769 286.5548 329.4141
[109,] 319.3248 12.534148 294.7066 344.3774
[110,] 330.9077 14.483767 302.4450 359.9480
[111,] 239.2819 13.129140 213.4373 265.0157
[112,] 256.2482 11.242189 234.2191 278.4395
[113,] 273.2144  9.638683 254.2465 292.1236
[114,] 290.1807  8.480949 273.8073 306.8172
[115,] 307.1469  7.965781 291.6174 322.7623
[116,] 324.1132  8.214970 307.3779 340.2848
[117,] 341.0794  9.166388 322.7828 358.9736
[118,] 358.0457 10.633180 336.7993 378.5211
[119,] 375.0119 12.434277 350.5098 398.9781
[120,] 391.9782 14.445168 363.7203 420.0402
[121,] 255.8563 12.612338 230.6561 280.6824
[122,] 263.3163 10.818280 241.7157 284.5042
[123,] 270.7762  9.308318 252.4057 288.8872
[124,] 278.2362  8.240140 262.0032 294.1443
[125,] 285.6961  7.797469 270.2170 300.8534
[126,] 293.1561  8.083726 277.3054 308.7683
[127,] 300.6160  9.029853 282.9366 318.1146
[128,] 308.0759 10.458267 287.7818 328.3524
[129,] 315.5359 12.200736 291.8648 338.9314
[130,] 322.9958 14.141643 295.6685 350.3100
[131,] 272.0115 12.364358 247.8107 296.2811
[132,] 286.0501 10.690297 265.5387 307.2819
[133,] 300.0888  9.304931 281.7230 318.5676
[134,] 314.1274  8.353159 297.5851 330.4816
[135,] 328.1661  7.991433 311.8619 343.5457
[136,] 342.2047  8.297286 325.3189 358.5295
[137,] 356.2434  9.204407 337.5952 374.5851
[138,] 370.2820 10.558954 349.1945 391.5928
[139,] 384.3207 12.212948 360.6400 408.7685
[140,] 398.3593 14.061114 370.9493 426.2383
[141,] 254.9649 12.221030 230.1807 278.2165
[142,] 266.2605 10.511258 245.0096 286.6391
[143,] 277.5562  9.093254 259.5945 295.1302
[144,] 288.8519  8.121311 272.7657 304.9724
[145,] 300.1475  7.764784 284.9280 315.4566
[146,] 311.4432  8.105293 295.3127 327.0942
[147,] 322.7389  9.064624 304.6343 339.9058
[148,] 334.0346 10.474100 313.4496 354.1700
[149,] 345.3302 12.178418 321.2080 368.8864
[150,] 356.6259 14.070846 328.9507 384.1793
[151,] 226.3237 13.310490 199.5183 251.3517
[152,] 241.5371 11.370554 219.3229 263.0733
[153,] 256.7505  9.704883 237.3348 275.3484
[154,] 271.9638  8.476725 255.0799 288.2915
[155,] 287.1772  7.893027 271.5880 302.6419
[156,] 302.3906  8.094427 286.5800 318.3915
[157,] 317.6039  9.028538 300.1987 334.8572
[158,] 332.8173 10.501625 312.8458 352.8718
[159,] 348.0307 12.321876 324.3087 371.9453
[160,] 363.2441 14.357856 336.1008 391.8571
[161,] 251.8649 12.197635 227.5161 276.0435
[162,] 261.4198 10.477242 240.9434 282.0989
[163,] 270.9748  9.052698 253.2688 288.5017
[164,] 280.5298  8.081987 264.5192 296.2088
[165,] 290.0848  7.737837 274.8279 305.3582
[166,] 299.6397  8.100504 283.6216 315.4419
[167,] 309.1947  9.085738 291.6429 326.7623
[168,] 318.7497 10.520054 297.9958 338.7485
[169,] 328.3047 12.246669 304.2942 351.5326
[170,] 337.8597 14.159049 310.2428 365.1460
[171,] 263.4528 12.291522 238.9799 288.3292
[172,] 275.1876 10.618003 253.7893 296.5126
[173,] 286.9223  9.232301 268.5159 305.5764
[174,] 298.6571  8.280201 282.0836 314.9738
[175,] 310.3918  7.919660 294.7464 325.9521
[176,] 322.1266  8.228805 306.0590 338.4413
[177,] 333.8613  9.139933 316.1381 351.9371
[178,] 345.5961 10.497451 325.4914 366.0602
[179,] 357.3308 12.152675 333.6714 381.2415
[180,] 369.0655 14.000409 341.9042 396.3093</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.5697705 12.973849  -28.6564411  21.3915878
  [2,]  -14.9786843 11.098656  -36.2387335   7.4826439
  [3,]  -42.4363981  9.515383  -61.1797730 -23.1274456
  [4,]    8.6491882  8.390937   -8.0075050  25.4065468
  [5,]   24.5076744  7.923136    9.0429849  40.0627298
  [6,]   62.7922607  8.224797   46.9273216  78.5394225
  [7,]   10.7523469  9.220708   -7.3403743  28.4411703
  [8,] -100.8564668 10.719074 -121.7329583 -80.3306830
  [9,]   20.0266194 12.541077   -4.3498184  44.9139326
 [10,]   36.2412057 14.565768    8.0939705  65.2481784
 [11,]   11.3627591 12.952625  -13.7797923  37.3498457
 [12,]   -7.8831436 11.106491  -29.4778472  14.5851073
 [13,]  -11.9489464  9.551741  -30.4907742   7.0294373
 [14,]  -11.9975491  8.450762  -28.4918599   4.4472090
 [15,]  -10.7662518  7.993309  -26.2827450   4.3426214
 [16,]   -4.2983546  8.286652  -20.6557287  11.7788029
 [17,]   -8.4076573  9.259709  -26.4971777   9.6013327
 [18,]   -6.0885601 10.729110  -26.9227817  15.0397110
 [19,]   -1.2978628 12.521318  -25.2115495  23.1389179
 [20,]    9.9428345 14.517265  -17.6254856  37.8981448
 [21,]  -13.8283698 13.334894  -39.1623333  13.0741932
 [22,]  -23.4834148 11.469357  -45.2556162  -0.3489557
 [23,]   11.5710403  9.886408   -7.4212834  31.3957842
 [24,]    5.1592953  8.740948  -11.5089491  22.4984491
 [25,]   -3.3082496  8.217996  -19.3499214  12.6472008
 [26,]  -17.0910946  8.434153  -33.4530269  -0.9278539
 [27,]   -7.0615395  9.338233  -25.4447603  11.0452488
 [28,]    8.3354155 10.758180  -13.1859333  28.7574906
 [29,]    8.6634706 12.519683  -16.1498654  33.3260361
 [30,]   -9.7670744 14.498781  -38.7907496  18.4838226
 [31,]   47.1995625 13.364178   19.2911165  72.0869969
 [32,]   20.2666297 11.407772   -3.6374769  41.6124417
 [33,]   -2.0676030  9.719444  -22.0326566  16.3006037
 [34,]   -6.5816357  8.461221  -23.8042718   9.5318262
 [35,]  -11.7078684  7.842911  -27.4679918   3.6279696
 [36,]   -5.7102011  8.014024  -21.6589905   9.9033394
 [37,]  -28.8466338  8.929291  -46.4360952 -11.0890522
 [38,]    3.3845335 10.393951  -16.9692624  23.7610573
 [39,]  -15.3177992 12.211902  -39.4033326   8.4687222
 [40,]   27.5908681 14.248550   -0.5906973  55.6411199
 [41,]   14.6387521 13.027733  -12.3260249  38.1228209
 [42,]    4.5308661 11.129405  -18.3699529  25.0339102
 [43,]   13.8514802  9.496286   -5.0616285  31.6065805
 [44,]   24.6461943  8.286686    8.1362292  40.1573260
 [45,]   13.3082084  7.702781   -1.9908168  28.5559424
 [46,]  -17.1503776  7.884823  -32.7381679  -1.5694508
 [47,]  -27.8940635  8.785327  -45.4283771 -10.9890193
 [48,]    9.3486506 10.216038  -10.7857210  29.1576365
 [49,]  -39.2221353 11.988614  -62.6854903 -15.5319476
 [50,]   31.1120788 13.973554    3.6407264  58.8057158
 [51,]  -25.5878998 12.341438  -50.7907253  -1.6381497
 [52,]  -27.8672499 10.668775  -49.6274473  -7.0810554
 [53,]   -7.9482999  9.293821  -26.5589579  10.6826180
 [54,]   18.6286500  8.364692    2.1963751  34.9690654
 [55,]   16.0921999  8.037519    0.6506595  31.9258602
 [56,]   -1.6036501  8.383077  -17.8317563  14.4388956
 [57,]  132.3300998  9.326891  113.9453664 150.1642144
 [58,]   14.7687497 10.711978   -6.7255049  35.0544846
 [59,]  -11.9926003 12.391234  -36.8498716  11.4648327
 [60,]  -98.6590504 14.261120 -127.1718608 -71.5271692
 [61,]   15.9326140 12.560741   -9.3994723  40.1134290
 [62,]   11.3280016 10.780682  -10.2945187  32.0141546
 [63,]  -11.7749107  9.281665  -30.1108422   6.4454405
 [64,]    0.9482769  8.218931  -15.1655727  17.3815326
 [65,]  -12.0076355  7.773522  -27.0849279   3.3234740
 [66,]   18.6706521  8.048589    3.2315157  34.4018413
 [67,]    2.2134398  8.978152  -15.2820176  19.9612026
 [68,]    8.7096274 10.387972  -11.6991603  28.8593018
 [69,]  -17.0874850 12.111483  -41.1285907   6.6324931
 [70,]    1.2781027 14.033580  -26.9834213  28.5898321
 [71,]   21.3334590 12.614283   -3.4523805  45.9372363
 [72,]   20.5415732 10.848520   -0.6113146  41.8882594
 [73,]  -23.8149127  9.372223  -42.1468806  -5.2821954
 [74,]  -24.0272985  8.340546  -39.9938619  -7.7460449
 [75,]  -11.1951843  7.928984  -26.6016697   4.3002816
 [76,]  -17.5483701  8.231088  -34.0698023  -1.1478742
 [77,]   -7.7347559  9.176643  -25.7097692  10.3319889
 [78,]    6.7433583 10.594749  -13.4491367  27.3096729
 [79,]   -0.5526276 12.323334  -24.0385116  23.3985217
 [80,]   29.4794866 14.249855    1.8658737  57.3648724
 [81,]   -8.9635078 13.173118  -35.6727111  15.7799264
 [82,]   23.6045761 11.235840    1.1939025  44.8012311
 [83,]    4.3772601  9.584580  -14.7697015  22.6151714
 [84,]   20.9178440  8.389950    4.3261370  37.2121364
 [85,]    1.7968280  7.862911  -13.5637812  17.1899325
 [86,]    5.2103119  8.134279  -10.5296573  21.2825589
 [87,]   -3.7444041  9.133161  -21.1877418  13.9523653
 [88,]  -13.6565202 10.656913  -34.3184923   6.9843340
 [89,]  -12.9842362 12.515269  -37.4947261  11.1702272
 [90,]  -11.2625523 14.580848  -39.9101813  16.6882163
 [91,]   26.4787113 13.172381    0.7532390  51.9779981
 [92,]    8.7899537 11.287014  -13.1662300  30.5613899
 [93,]  -32.5326039  9.681755  -51.7123389 -14.0554501
 [94,]    2.8504384  8.516499  -13.9480018  19.1865201
 [95,]    3.3326808  7.986224  -12.3895199  19.1770058
 [96,]   10.3108232  8.214832   -5.6080971  26.4667400
 [97,]    3.6044655  9.145590  -13.8655825  21.0525936
 [98,]   -3.0912921 10.595038  -23.6747923  17.4212575
 [99,]   16.9527503 12.382347   -6.9287317  41.1175933
[100,]    0.8771926 14.382102  -27.1288638  28.7323947
[101,]    9.4423608 12.844321  -15.0036145  35.0766618
[102,]   -7.9271286 11.057041  -29.0983165  14.2276106
[103,]  -10.9012180  9.563675  -29.5736711   8.2395976
[104,]   -6.4878074  8.520194  -23.2034822  10.8795259
[105,]  -22.2824969  8.102326  -38.6715201  -5.9024809
[106,]  -14.8013863  8.403915  -31.9047265   1.6755382
[107,]  -14.5939757  9.355641  -33.3365867   3.7977825
[108,]    0.3602349 10.786769  -21.3120815  21.5472278
[109,]   16.9558455 12.534148   -8.0968047  41.5739871
[110,]   20.7373561 14.483767   -8.3028746  49.2000921
[111,]   17.0148622 13.129140   -8.7188886  42.8595279
[112,]  -12.7938884 11.242189  -34.9851955   9.2351564
[113,]  -17.0098391  9.638683  -35.9189589   1.9580690
[114,]  -34.6535897  8.480949  -51.2900827 -18.2801826
[115,]  -38.2304404  7.965781  -53.8457742 -22.7008540
[116,]    5.6115090  8.214970  -10.5600559  22.3467631
[117,]   38.3650584  9.166388   20.4708988  56.6617072
[118,]    4.8727077 10.633180  -15.6026761  26.1191199
[119,]   19.4752571 12.434277   -4.4909386  43.9773824
[120,]   -2.9254936 14.445168  -30.9874598  25.3324304
[121,]   -5.3298303 12.612338  -30.1558616  19.8703680
[122,]   36.7413254 10.818280   15.5534124  58.3418554
[123,]   -0.8823188  9.308318  -18.9933469  17.4882098
[124,]    2.3529370  8.240140  -13.5551893  18.5859042
[125,]  -13.8687073  7.797469  -29.0259930   1.6104286
[126,]   11.4775485  8.083726   -4.1347157  27.3282137
[127,]  -12.8693958  9.029853  -30.3679769   4.8100269
[128,]  -41.4804400 10.458267  -61.7569057 -21.1863342
[129,]    6.0059158 12.200736  -17.3896173  29.6770166
[130,]   24.5696715 14.141643   -2.7445017  51.8970418
[131,]  -50.3343770 12.364358  -74.6040014 -26.1336493
[132,]   12.1437755 10.690297   -9.0880390  32.6552404
[133,]   26.7897280  9.304931    8.3108823  45.1555282
[134,]   32.7280804  8.353159   16.3738650  49.2704479
[135,]   20.5741329  7.991433    5.1945405  36.8783475
[136,]   10.6239854  8.297286   -5.7008385  27.5097620
[137,]   -1.8167622  9.204407  -20.1585247  16.8313708
[138,]   -9.8494097 10.558954  -31.1601770  11.2380838
[139,]   -8.6800573 12.212948  -33.1279382  15.0006331
[140,]   -9.8176048 14.061114  -37.6965695  17.5924007
[141,]   16.9586411 12.221030   -6.2930083  41.7428214
[142,]    2.1763707 10.511258  -18.2021900  23.4272762
[143,]  -20.3137996  9.093254  -37.8878253  -2.3521282
[144,]  -11.1952699  8.121311  -27.3158075   4.8908819
[145,]   14.6746598  7.764784   -0.6344043  29.8941967
[146,]    5.7702895  8.105293   -9.8807107  21.9007506
[147,]  -24.6035808  9.064624  -41.7705270  -6.4990160
[148,]   14.0883489 10.474100   -6.0471097  34.6733493
[149,]   -5.0502214 12.178418  -28.6064309  19.0720112
[150,]    9.8872083 14.070846  -17.6662129  37.5623750
[151,]   -1.0597179 13.310490  -26.0877209  25.7456933
[152,]   -7.0135898 11.370554  -28.5497702  15.2006140
[153,]  -17.8496618  9.704883  -36.4475718   1.5659700
[154,]  -31.4908337  8.476725  -47.8184708 -14.6068606
[155,]  -19.6399057  7.893027  -35.1045911  -4.0506826
[156,]   41.8031223  8.094427   25.8021679  57.6136840
[157,]  -36.4558496  9.028538  -53.7090965 -19.0505518
[158,]   14.7681784 10.501625   -5.2863007  34.7397484
[159,]   17.1323064 12.321876   -6.7823417  40.8543010
[160,]    8.9847345 14.357856  -19.6283339  36.1279610
[161,]   18.0155355 12.197635   -6.1631236  42.3642565
[162,]   11.0229585 10.477242   -9.6561263  31.4994375
[163,]    6.9240815  9.052698  -10.6027970  24.6301334
[164,]    1.2597044  8.081987  -14.4193321  17.2702605
[165,]  -10.9142726  7.737837  -26.1876969   4.3425718
[166,]  -15.1277496  8.100504  -30.9298660   0.8903740
[167,]  -49.9289267  9.085738  -67.4964649 -32.3771130
[168,]  -14.1191037 10.520054  -34.1178516   6.6347842
[169,]   22.4760193 12.246669   -0.7518862  46.4864898
[170,]   31.6095422 14.159049    4.3232170  59.2263741
[171,]    5.9588571 12.291522  -18.9175047  30.4318022
[172,]   -1.7135872 10.618003  -23.0386357  19.6846591
[173,]   10.6744685  9.232301   -7.9795581  29.0808518
[174,]   11.9745242  8.280201   -4.3421744  28.5480384
[175,]  -23.2192201  7.919660  -38.7794859  -7.5738140
[176,]    7.4810356  8.228805   -8.8337254  23.5485559
[177,]    0.6204913  9.139933  -17.4552675  18.3437191
[178,]   -2.3761530 10.497451  -22.8402599  17.7284741
[179,]   11.8109027 12.152675  -12.0997899  35.4703257
[180,]   -4.9419417 14.000409  -32.1856559  22.2193689</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.3 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.6  3.4
looic      1770.5 28.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1458      
 (0.5, 0.7]   (ok)         2    1.1%   376       
   (0.7, 1]   (bad)        1    0.6%   126       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.4
p_loo        34.2  8.6
looic      1722.5 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   779       
 (0.5, 0.7]   (ok)         6    3.3%   433       
   (0.7, 1]   (bad)        1    0.6%   60        
   (1, Inf)   (very bad)   2    1.1%   11        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.0      11.6  
fit_sleep1 -91.9      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.3 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.6  3.4
looic      1770.5 28.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1458      
 (0.5, 0.7]   (ok)         2    1.1%   376       
   (0.7, 1]   (bad)        1    0.6%   126       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.4
p_loo        34.2  8.6
looic      1722.5 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   779       
 (0.5, 0.7]   (ok)         6    3.3%   433       
   (0.7, 1]   (bad)        1    0.6%   60        
   (1, Inf)   (very bad)   2    1.1%   11        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.2     22.4        34.2    8.6   1722.5
fit_sleep2  -24.0      11.6  -885.2     14.4        19.6    3.4   1770.5
fit_sleep1  -91.9      21.0  -953.2     10.5         3.1    0.5   1906.3
           se_looic
fit_sleep3   44.7  
fit_sleep2   28.7  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.180529e-40 3.752552e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0      2.9       1.6      0.2     5.53       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0     -0.1       1.6    -3.26     2.94       5.53      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.22 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.0         
  [4] magrittr_2.0.3       matrixStats_0.63.0   compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.21      
 [22] markdown_1.6         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.7         jsonlite_1.8.4      
 [28] highr_0.10           later_1.3.0          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.42           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.9        
 [43] splines_4.3.0        igraph_1.4.2         tidyselect_1.2.0    
 [46] abind_1.4-5          yaml_2.3.7           codetools_0.2-19    
 [49] miniUI_0.1.1.1       curl_5.0.0           processx_3.8.1      
 [52] pkgbuild_1.4.0       lattice_0.21-8       tibble_3.2.1        
 [55] plyr_1.8.8           shiny_1.7.4          withr_2.5.0         
 [58] bridgesampling_1.1-2 posterior_1.4.1      coda_0.19-4         
 [61] evaluate_0.20        RcppParallel_5.1.7   xts_0.13.1          
 [64] pillar_1.9.0         tensorA_0.36.2       checkmate_2.1.0     
 [67] DT_0.27              stats4_4.3.0         shinyjs_2.1.0       
 [70] distributional_0.3.2 generics_0.1.3       ggplot2_3.4.2       
 [73] rstantools_2.3.1     munsell_0.5.0        scales_1.2.1        
 [76] minqa_1.2.5          gtools_3.9.4         xtable_1.8-4        
 [79] glue_1.6.2           tools_4.3.0          shinystan_2.6.0     
 [82] colourpicker_1.2.0   mvtnorm_1.1-3        grid_4.3.0          
 [85] crosstalk_1.2.0      colorspace_2.1-0     nlme_3.1-162        
 [88] cli_3.6.1            fansi_1.0.4          Brobdingnag_1.2-9   
 [91] dplyr_1.1.2          V8_4.3.0             gtable_0.3.3        
 [94] sass_0.4.5           digest_0.6.31        htmlwidgets_1.6.2   
 [97] farver_2.1.1         htmltools_0.5.5      lifecycle_1.0.3     
[100] mime_0.12            shinythemes_1.2.0    MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
