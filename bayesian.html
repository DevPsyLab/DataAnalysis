<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.93      6.88    15.68    42.66 1.00     1684     2726
sd(Days)                6.56      1.53     4.13    10.10 1.00     1782     2208
cor(Intercept,Days)     0.10      0.30    -0.47     0.67 1.01      843     1540

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.29      7.49   236.91   266.29 1.00     1800     2331
Days         10.40      1.71     6.94    13.83 1.00     1560     1932

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.53    23.01    29.05 1.00     3499     2929

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.1420  12.96570 228.0923 278.9435
309 211.5818  13.14381 185.3730 237.7843
310 212.9197  13.22375 186.3780 237.6944
330 274.1600  13.37529 248.6003 301.3934
331 273.0461  12.83142 248.8052 298.5188
332 260.4831  12.11176 236.3570 284.7146
333 267.7602  12.75842 243.6306 293.0588
334 244.2877  12.08205 219.8368 267.3201
335 250.1920  13.21899 224.8739 276.3112
337 285.9751  13.18454 260.8137 312.5150
349 226.9096  13.02219 201.0174 251.5112
350 238.6854  13.24089 212.4808 263.7476
351 255.5926  12.12889 231.8169 279.6395
352 271.8578  12.52409 248.0679 296.7782
369 254.7415  12.33720 230.7627 279.2153
370 226.5118  13.71203 199.2264 252.3287
371 252.1942  12.30978 228.4292 276.6989
372 263.5274  12.29813 239.2512 288.2917

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5966131  2.519951 14.6784572 24.865486
309  1.7698568  2.459508 -3.0043110  6.625131
310  4.9931307  2.472247  0.2621634  9.978264
330  5.8238011  2.551732  0.8255205 10.725705
331  7.5140990  2.415548  2.8045860 12.183385
332 10.1841424  2.342307  5.5375653 14.771624
333 10.3178186  2.419015  5.5808142 15.024003
334 11.5180673  2.323341  7.1304475 16.159876
335 -0.1742548  2.579925 -5.2412071  4.686732
337 19.1509694  2.496417 14.3027444 23.988703
349 11.5238404  2.451134  6.8999164 16.323970
350 17.0424007  2.543828 12.2362790 21.993442
351  7.5403791  2.368841  2.8401932 12.129041
352 14.0955527  2.411955  9.3671428 18.911214
369 11.2785453  2.368290  6.5212324 15.942596
370 15.2164699  2.585886 10.2788966 20.552615
371  9.5000744  2.330854  4.8756926 14.003027
372 11.7695293  2.339805  7.1182554 16.409966</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.1420 12.965695 228.0923 278.9435
  [2,] 273.7386 11.059338 251.6085 295.1149
  [3,] 293.3353  9.445049 274.1708 311.7137
  [4,] 312.9319  8.295134 296.2697 329.2543
  [5,] 332.5285  7.817279 317.1047 348.0192
  [6,] 352.1251  8.130852 336.1349 368.3098
  [7,] 371.7217  9.154888 353.7189 389.6864
  [8,] 391.3183 10.687071 370.4833 412.7224
  [9,] 410.9149 12.542539 385.9110 436.3705
 [10,] 430.5115 14.598541 401.5670 459.8119
 [11,] 211.5818 13.143813 185.3730 237.7843
 [12,] 213.3516 11.292342 190.8065 235.8706
 [13,] 215.1215  9.714551 196.0414 234.3210
 [14,] 216.8913  8.563082 200.0279 233.4577
 [15,] 218.6612  8.023628 202.7604 234.1183
 [16,] 220.4310  8.217616 204.3502 236.5455
 [17,] 222.2009  9.098251 204.2519 239.9808
 [18,] 223.9708 10.494069 203.5277 244.5545
 [19,] 225.7406 12.229930 201.3187 250.3280
 [20,] 227.5105 14.181510 198.7815 256.2450
 [21,] 212.9197 13.223753 186.3780 237.6944
 [22,] 217.9128 11.324252 194.9125 239.2579
 [23,] 222.9060  9.686780 203.7057 241.2618
 [24,] 227.8991  8.464796 211.1990 244.1430
 [25,] 232.8922  7.854670 217.6469 248.3042
 [26,] 237.8853  7.997682 222.0833 253.7816
 [27,] 242.8785  8.857427 225.9541 260.4392
 [28,] 247.8716 10.255200 227.9817 267.9701
 [29,] 252.8647 12.004509 229.3083 276.7606
 [30,] 257.8579 13.973953 230.5378 285.7317
 [31,] 274.1600 13.375286 248.6003 301.3934
 [32,] 279.9838 11.428434 257.8602 303.3127
 [33,] 285.8076  9.764354 266.5827 305.1920
 [34,] 291.6314  8.549782 275.0498 308.5517
 [35,] 297.4552  7.992346 281.7442 312.9725
 [36,] 303.2790  8.226731 287.0787 319.4035
 [37,] 309.1028  9.192567 290.9845 327.2278
 [38,] 314.9266 10.693462 293.6909 335.6846
 [39,] 320.7504 12.538726 295.4499 345.3002
 [40,] 326.5742 14.598350 297.1799 355.1316
 [41,] 273.0461 12.831425 248.8052 298.5188
 [42,] 280.5602 11.054556 259.4589 302.0575
 [43,] 288.0743  9.561940 269.1655 306.8914
 [44,] 295.5884  8.504583 278.8921 312.4059
 [45,] 303.1025  8.055739 287.3218 318.8614
 [46,] 310.6166  8.314545 294.2354 326.7735
 [47,] 318.1307  9.221613 300.0582 335.9557
 [48,] 325.6448 10.611992 304.7817 346.4266
 [49,] 333.1589 12.323163 309.0552 357.7678
 [50,] 340.6730 14.239946 312.8515 369.2133
 [51,] 260.4831 12.111765 236.3570 284.7146
 [52,] 270.6672 10.429963 249.7733 291.4305
 [53,] 280.8514  9.046890 262.8332 298.6466
 [54,] 291.0355  8.116718 274.9213 306.9549
 [55,] 301.2196  7.803128 286.1792 316.3164
 [56,] 311.4038  8.177365 295.3849 327.2006
 [57,] 321.5879  9.155468 303.1694 339.2593
 [58,] 331.7721 10.571125 310.5949 352.2340
 [59,] 341.9562 12.273858 317.6043 365.5863
 [60,] 352.1404 14.160483 323.9953 379.7420
 [61,] 267.7602 12.758420 243.6306 293.0588
 [62,] 278.0780 10.942140 257.2989 300.0566
 [63,] 288.3959  9.401428 270.5111 307.2093
 [64,] 298.7137  8.291354 282.9042 315.3536
 [65,] 309.0315  7.798045 294.2234 324.4422
 [66,] 319.3493  8.035903 304.0690 335.0831
 [67,] 329.6671  8.946801 312.3422 347.1982
 [68,] 339.9849 10.354613 320.0600 360.5647
 [69,] 350.3028 12.086938 326.9104 374.1717
 [70,] 360.6206 14.024028 333.5396 388.3376
 [71,] 244.2877 12.082049 219.8368 267.3201
 [72,] 255.8058 10.432028 234.8270 275.8928
 [73,] 267.3239  9.081539 249.2784 284.8971
 [74,] 278.8419  8.180300 263.0048 294.9502
 [75,] 290.3600  7.883914 275.1832 305.9776
 [76,] 301.8781  8.257767 285.7828 318.3267
 [77,] 313.3961  9.220692 295.7699 331.7854
 [78,] 324.9142 10.613550 304.6152 345.8645
 [79,] 336.4323 12.291036 312.9662 360.4863
 [80,] 347.9503 14.152297 320.9980 375.6569
 [81,] 250.1920 13.218988 224.8739 276.3112
 [82,] 250.0177 11.249848 228.0775 272.1645
 [83,] 249.8435  9.575413 231.2218 268.5160
 [84,] 249.6692  8.374366 232.8956 266.0243
 [85,] 249.4950  7.866608 233.8247 264.5822
 [86,] 249.3207  8.182240 233.2731 264.8306
 [87,] 249.1465  9.237240 230.3952 266.8830
 [88,] 248.9722 10.817402 227.1380 270.1846
 [89,] 248.7980 12.728621 223.1118 273.3125
 [90,] 248.6237 14.843565 218.7506 277.2874
 [91,] 285.9751 13.184538 260.8137 312.5150
 [92,] 305.1260 11.292190 283.4774 328.1632
 [93,] 324.2770  9.677772 305.9515 344.0331
 [94,] 343.4280  8.501128 327.0783 360.4463
 [95,] 362.5789  7.958849 347.1029 377.9256
 [96,] 381.7299  8.178115 365.8569 397.6752
 [97,] 400.8809  9.104068 382.7463 419.0956
 [98,] 420.0318 10.552286 398.9209 441.3244
 [99,] 439.1828 12.340244 414.4012 463.4328
[100,] 458.3338 14.341433 429.7955 486.1015
[101,] 226.9096 13.022194 201.0174 251.5112
[102,] 238.4334 11.146280 216.1495 259.8485
[103,] 249.9573  9.535077 230.8322 268.4160
[104,] 261.4811  8.343377 244.7092 278.2011
[105,] 273.0049  7.766743 257.7348 288.4457
[106,] 284.5288  7.940326 268.8363 300.4122
[107,] 296.0526  8.819941 278.8599 313.0755
[108,] 307.5765 10.224972 287.7971 327.4075
[109,] 319.1003 11.971836 295.8501 342.1200
[110,] 330.6241 13.932544 303.8634 357.6671
[111,] 238.6854 13.240886 212.4808 263.7476
[112,] 255.7278 11.303462 233.7118 277.1397
[113,] 272.7702  9.651818 253.8183 291.2904
[114,] 289.8126  8.455120 273.2064 306.2312
[115,] 306.8550  7.922287 291.1499 322.4448
[116,] 323.8974  8.184030 307.8090 339.9265
[117,] 340.9398  9.172577 322.6518 359.2394
[118,] 357.9822 10.688130 336.6679 378.8464
[119,] 375.0247 12.541061 349.9715 398.8994
[120,] 392.0671 14.603506 362.8632 420.0987
[121,] 255.5926 12.128887 231.8169 279.6395
[122,] 263.1330 10.360830 242.4737 283.6311
[123,] 270.6733  8.877303 252.6143 288.4247
[124,] 278.2137  7.841495 262.3158 293.5251
[125,] 285.7541  7.442741 270.9579 300.1572
[126,] 293.2945  7.779625 278.1116 308.0236
[127,] 300.8348  8.767757 283.6143 317.5268
[128,] 308.3752 10.219949 288.5103 328.1677
[129,] 315.9156 11.968458 292.3731 339.2085
[130,] 323.4560 13.901922 295.6776 350.7548
[131,] 271.8578 12.524091 248.0679 296.7782
[132,] 285.9533 10.771472 265.2714 307.6093
[133,] 300.0489  9.318337 282.0532 318.7097
[134,] 314.1444  8.323056 297.7852 330.4759
[135,] 328.2400  7.959282 312.7109 343.5535
[136,] 342.3355  8.310364 326.0429 358.4080
[137,] 356.4311  9.295653 338.0556 374.8313
[138,] 370.5266 10.742032 348.8377 392.2890
[139,] 384.6222 12.490331 359.7631 409.6968
[140,] 398.7177 14.431236 369.8953 427.8597
[141,] 254.7415 12.337198 230.7627 279.2153
[142,] 266.0201 10.614740 245.8811 286.9836
[143,] 277.2986  9.184581 259.5282 295.2707
[144,] 288.5772  8.201094 272.3337 304.4450
[145,] 299.8557  7.834345 284.3590 314.9338
[146,] 311.1343  8.167838 295.1546 327.0569
[147,] 322.4128  9.125119 304.5069 340.0002
[148,] 333.6913 10.537533 312.9049 354.0339
[149,] 344.9699 12.248633 320.8720 368.4544
[150,] 356.2484 14.150477 328.2713 383.2406
[151,] 226.5118 13.712033 199.2264 252.3287
[152,] 241.7283 11.699451 218.5636 263.8612
[153,] 256.9447  9.955304 237.3483 275.7492
[154,] 272.1612  8.643646 255.1404 289.0670
[155,] 287.3777  7.980649 271.9750 303.5499
[156,] 302.5941  8.126655 287.1256 318.7610
[157,] 317.8106  9.042561 300.2773 335.7279
[158,] 333.0271 10.529335 312.7049 353.4525
[159,] 348.2436 12.383032 324.0976 372.6797
[160,] 363.4600 14.463253 335.1672 392.1579
[161,] 252.1942 12.309780 228.4292 276.6989
[162,] 261.6943 10.619955 241.2999 282.7568
[163,] 271.1944  9.214225 253.4280 289.7599
[164,] 280.6944  8.239310 264.8291 296.9872
[165,] 290.1945  7.857243 275.1390 305.8916
[166,] 299.6946  8.151815 283.6913 316.0600
[167,] 309.1947  9.057243 291.4535 327.0176
[168,] 318.6947 10.415421 298.3909 339.2298
[169,] 328.1948 12.074522 304.4815 351.9848
[170,] 337.6949 13.927417 310.4319 364.7973
[171,] 263.5274 12.298127 239.2512 288.2917
[172,] 275.2969 10.596331 254.8986 296.1220
[173,] 287.0665  9.179863 269.2188 305.1747
[174,] 298.8360  8.197982 282.6703 314.7688
[175,] 310.6055  7.816222 294.9971 326.0799
[176,] 322.3751  8.119673 306.1991 338.4767
[177,] 334.1446  9.039593 316.0099 352.0422
[178,] 345.9141 10.413874 325.2346 366.4309
[179,] 357.6836 12.088534 333.5956 381.3909
[180,] 369.4532 13.955856 341.9999 396.5823</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.5820238 12.965695  -29.3835039  21.4676627
  [2,]  -15.0339370 11.059338  -36.4102364   7.0962257
  [3,]  -42.5346501  9.445049  -60.9131008 -23.3702218
  [4,]    8.5079368  8.295134   -7.8145375  25.1701353
  [5,]   24.3234237  7.817279    8.8327451  39.7472484
  [6,]   62.5650106  8.130852   46.3803361  78.5552317
  [7,]   10.4820975  9.154888   -7.4826335  28.4849497
  [8,] -101.1697156 10.687071 -122.5738043 -80.3347210
  [9,]   19.6703713 12.542539   -5.7851565  44.6743258
 [10,]   35.8419582 14.598541    6.5415956  64.7865484
 [11,]   11.1521415 13.143813  -15.0504371  37.3608844
 [12,]   -8.0858153 11.292342  -30.6048225  14.4593123
 [13,]  -12.1436720  9.714551  -31.3432198   6.9364072
 [14,]  -12.1843288  8.563082  -28.7506907   4.6790583
 [15,]  -10.9450856  8.023628  -26.4022158   4.9557404
 [16,]   -4.4692423  8.217616  -20.5837197  11.6116026
 [17,]   -8.5705991  9.098251  -26.3505047   9.3783523
 [18,]   -6.2435559 10.494069  -26.8272641  14.1994729
 [19,]   -1.4449126 12.229930  -26.0323302  22.9770022
 [20,]    9.8037306 14.181510  -18.9308080  38.5327255
 [21,]  -13.8657915 13.223753  -38.6404932  12.6758952
 [22,]  -23.5806222 11.324252  -44.9256566  -0.5802714
 [23,]   11.4140471  9.686780   -6.9417811  30.6143150
 [24,]    4.9425164  8.464796  -11.3014294  21.6426496
 [25,]   -3.5848143  7.854670  -18.9967921  11.6604629
 [26,]  -17.4274450  7.997682  -33.3237077  -1.6254316
 [27,]   -7.4576757  8.857427  -25.0184118   9.4667348
 [28,]    7.8794936 10.255200  -12.2190258  27.7694126
 [29,]    8.1477629 12.004509  -15.7481170  31.7041541
 [30,]  -10.3425678 13.973953  -38.2163944  16.9774520
 [31,]   47.3825744 13.375286   20.1491889  72.9423225
 [32,]   20.4163733 11.428434   -2.9125451  42.5399637
 [33,]   -1.9511278  9.764354  -21.3355122  17.2738286
 [34,]   -6.4984290  8.549782  -23.4186610  10.0831965
 [35,]  -11.6579301  7.992346  -27.1752445   4.0530577
 [36,]   -5.6935312  8.226731  -21.8179712  10.5068117
 [37,]  -28.8632323  9.192567  -46.9881577 -10.7448950
 [38,]    3.3346666 10.693462  -17.4232858  24.5704470
 [39,]  -15.4009345 12.538726  -39.9507216   9.8995854
 [40,]   27.4744644 14.598350   -1.0829092  56.8688042
 [41,]   14.5618084 12.831425  -10.9108602  38.8027170
 [42,]    4.4398093 11.054556  -17.0574769  25.5411154
 [43,]   13.7463103  9.561940   -5.0707660  32.6550916
 [44,]   24.5269112  8.504583    7.7094475  41.2231817
 [45,]   13.1748122  8.055739   -2.5841462  28.9555066
 [46,]  -17.2978868  8.314545  -33.4548292  -0.9167359
 [47,]  -28.0556859  9.221613  -45.8806501  -9.9831887
 [48,]    9.1729151 10.611992  -11.6088564  30.0359721
 [49,]  -39.4119840 12.323163  -64.0209392 -15.3083474
 [50,]   30.9081170 14.239946    2.3677995  58.7296479
 [51,]  -25.6224801 12.111765  -49.8540389  -1.4964405
 [52,]  -27.8554225 10.429963  -48.6186528  -6.9614713
 [53,]   -7.8900649  9.046890  -25.6853167  10.1281332
 [54,]   18.7332927  8.116718    2.8138939  34.8475395
 [55,]   16.2432503  7.803128    1.1465021  31.2836703
 [56,]   -1.4061921  8.177365  -17.2030072  14.6127253
 [57,]  132.5739655  9.155468  114.9025736 150.9924609
 [58,]   15.0590230 10.571125   -5.4029451  36.2362289
 [59,]  -11.6559194 12.273858  -35.2860310  12.6960229
 [60,]  -98.2759618 14.160483 -125.8776082 -70.1309032
 [61,]   16.0821854 12.758420   -9.2163508  40.2117922
 [62,]   11.4769669 10.942140  -10.5015771  32.2560672
 [63,]  -11.6265517  9.401428  -30.4399604   6.2582149
 [64,]    1.0960297  8.291354  -15.5438910  16.9055292
 [65,]  -11.8604889  7.798045  -27.2711763   2.9475868
 [66,]   18.8171925  8.035903    3.0834240  34.0975230
 [67,]    2.3593739  8.946801  -15.1716598  19.6843407
 [68,]    8.8549553 10.354613  -11.7248078  28.7799007
 [69,]  -16.9427633 12.086938  -40.8116788   6.4495838
 [70,]    1.4222181 14.024028  -26.2947873  28.5032027
 [71,]   21.1853713 12.082049   -1.8470218  45.6363283
 [72,]   20.3954040 10.432028    0.3084013  41.3742466
 [73,]  -23.9591633  9.081539  -41.5323835  -5.9137010
 [74,]  -24.1696306  8.180300  -40.2778902  -8.3325426
 [75,]  -11.3355979  7.883914  -26.9531538   3.8411877
 [76,]  -17.6868652  8.257767  -34.1354944  -1.5915513
 [77,]   -7.8713325  9.220692  -26.2605740   9.7548852
 [78,]    6.6087002 10.613550  -14.3415651  26.9077126
 [79,]   -0.6853671 12.291036  -24.7394167  22.7806552
 [80,]   29.3486656 14.152297    1.6421173  56.3009507
 [81,]   -8.5837030 13.218988  -34.7029182  16.7343538
 [82,]   23.9294518 11.249848    1.7827217  45.8696877
 [83,]    4.6472066  9.575413  -14.0253173  23.2689415
 [84,]   21.1328615  8.374366    4.7778037  37.9064680
 [85,]    1.9569163  7.866608  -13.1302795  17.6271886
 [86,]    5.3154711  8.182240  -10.1944012  21.3631178
 [87,]   -3.6941740  9.237240  -21.4307475  15.0571140
 [88,]  -13.6612192 10.817402  -34.8735604   8.1729608
 [89,]  -13.0438644 12.728621  -37.5584008  12.6422530
 [90,]  -11.3771095 14.843565  -40.0408343  18.4960127
 [91,]   26.3915424 13.184538   -0.1483934  51.5528638
 [92,]    8.6797729 11.292190  -14.3573702  30.3283556
 [93,]  -32.6657965  9.677772  -52.4218624 -14.3403386
 [94,]    2.6942340  8.501128  -14.3241444  19.0438928
 [95,]    3.1534646  7.958849  -12.1932360  18.6294794
 [96,]   10.1085951  8.178115   -5.8366927  25.9816085
 [97,]    3.3792257  9.104068  -14.8354997  21.5138124
 [98,]   -3.3395438 10.552286  -24.6320738  17.7714366
 [99,]   16.6814868 12.340244   -7.5685202  41.4631298
[100,]    0.5829173 14.341433  -27.1848315  29.1212252
[101,]    9.1936158 13.022194  -15.4079795  35.0858014
[102,]   -8.1167246 11.146280  -29.5317804  14.1672115
[103,]  -11.0316650  9.535077  -29.4904435   8.0934262
[104,]   -6.5591054  8.343377  -23.2791088  10.2128281
[105,]  -22.2946458  7.766743  -37.7353845  -7.0244896
[106,]  -14.7543862  7.940326  -30.6377795   0.9381374
[107,]  -14.4878266  8.819941  -31.5107256   2.7049343
[108,]    0.5255330 10.224972  -19.3054925  20.3048821
[109,]   17.1802926 11.971836   -5.8394312  40.4304629
[110,]   21.0209522 13.932544   -6.0220497  47.7817310
[111,]   17.6113552 13.240886   -7.4507824  43.8159988
[112,]  -12.2735455 11.303462  -33.6854318   9.7424829
[113,]  -16.5656462  9.651818  -35.0857954   2.3862818
[114,]  -34.2855469  8.455120  -50.7041240 -17.6792759
[115,]  -37.9385476  7.922287  -53.5282537 -22.2333923
[116,]    5.8272517  8.184030  -10.2017639  21.9156635
[117,]   38.5046510  9.172577   20.2051164  56.7927272
[118,]    4.9361503 10.688130  -15.9280076  26.2504886
[119,]   19.4625496 12.541061   -4.4121821  44.5156599
[120,]   -3.0143511 14.603506  -31.0459769  26.1894777
[121,]   -5.0660713 12.128887  -29.1130285  18.7096391
[122,]   36.9246496 10.360830   16.4264542  57.5838595
[123,]   -0.7794296  8.877303  -18.5308174  17.2796326
[124,]    2.3753913  7.841495  -12.9360180  18.2733332
[125,]  -13.9266879  7.442741  -28.3298215   0.8695497
[126,]   11.3391330  7.779625   -3.3899742  26.5219517
[127,]  -13.0882462  8.767757  -29.7801790   4.1323014
[128,]  -41.7797253 10.219949  -61.5721831 -21.9147944
[129,]    5.6261955 11.968458  -17.6666510  29.1687017
[130,]   24.1095164 13.901922   -3.1892757  51.8879288
[131,]  -50.1806681 12.524091  -75.1011300 -26.3908370
[132,]   12.2405793 10.771472   -9.4154469  32.9224955
[133,]   26.8296266  9.318337    8.1687565  44.8252646
[134,]   32.7110739  8.323056   16.3796365  49.0703380
[135,]   20.5002212  7.959282    5.1866723  36.0292639
[136,]   10.4931685  8.310364   -5.5792770  26.7857548
[137,]   -2.0044841  9.295653  -20.4047283  16.3709598
[138,]  -10.0940368 10.742032  -31.8564382  11.5949281
[139,]   -8.9815895 12.490331  -34.0562444  15.8775083
[140,]  -10.1760422 14.431236  -39.3180116  18.6464120
[141,]   17.1819759 12.337198   -7.2917732  41.1607764
[142,]    2.4168306 10.614740  -18.5466595  22.5557528
[143,]  -20.0562147  9.184581  -38.0282961  -2.2858339
[144,]  -10.9205600  8.201094  -26.7883918   5.3229239
[145,]   14.9664947  7.834345   -0.1116160  30.4631666
[146,]    6.0792494  8.167838   -9.8433952  22.0589199
[147,]  -24.2774959  9.125119  -41.8649430  -6.3715885
[148,]   14.4315588 10.537533   -5.9110083  35.2180341
[149,]   -4.6898865 12.248633  -28.1744400  19.4080045
[150,]   10.2646682 14.150477  -16.7274572  38.2417813
[151,]   -1.2477923 13.712033  -27.0647438  26.0375808
[152,]   -7.2047622 11.699451  -29.3377427  15.9599205
[153,]  -18.0439321  9.955304  -36.8484444   1.5524650
[154,]  -31.6882020  8.643646  -48.5939642 -14.6673991
[155,]  -19.8403719  7.980649  -36.0126257  -4.4376918
[156,]   41.5995582  8.126655   25.4326748  57.0680594
[157,]  -36.6625118  9.042561  -54.5798121 -19.1292036
[158,]   14.5584183 10.529335   -5.8670287  34.8806317
[159,]   16.9194484 12.383032   -7.5167163  41.0653976
[160,]    8.7687785 14.463253  -19.9291165  37.0616292
[161,]   17.6861849 12.309780   -6.8185465  41.4512288
[162,]   10.7485105 10.619955  -10.3139549  31.1428618
[163,]    6.7045360  9.214225  -11.8610127  24.4709081
[164,]    1.0950616  8.239310  -15.1977041  16.9603873
[165,]  -11.0240128  7.857243  -26.7211264   4.0315112
[166,]  -15.1825873  8.151815  -31.5480149   0.8206628
[167,]  -49.9288617  9.057243  -67.7517985 -32.1877222
[168,]  -14.0641362 10.415421  -34.5992413   6.2396647
[169,]   22.5858894 12.074522   -1.2041237  46.2991769
[170,]   31.7743150 13.927417    4.6718590  59.0373144
[171,]    5.8842920 12.298127  -18.8799791  30.1605276
[172,]   -1.8229373 10.596331  -22.6479674  18.5754429
[173,]   10.5303334  9.179863   -7.5778996  28.3779944
[174,]   11.7956041  8.197982   -4.1371934  27.9612885
[175,]  -23.4329253  7.816222  -38.9073474  -7.8245041
[176,]    7.2325454  8.119673   -8.8690724  23.4085411
[177,]    0.3372161  9.039593  -17.5603638  18.4718951
[178,]   -2.6942132 10.413874  -23.2109747  17.9852954
[179,]   11.4580575 12.088534  -12.2492368  35.5460894
[180,]   -5.3295719 13.955856  -32.4586656  22.1236980</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.4
p_loo        19.8  3.5
looic      1770.7 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   504       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   61        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.6 22.2
p_loo        33.6  8.3
looic      1721.2 44.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   767       
 (0.5, 0.7]   (ok)         5    2.8%   105       
   (0.7, 1]   (bad)        1    0.6%   17        
   (1, Inf)   (very bad)   1    0.6%   26        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.7      11.4  
fit_sleep1 -92.8      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.4
p_loo        19.8  3.5
looic      1770.7 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   504       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   61        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.6 22.2
p_loo        33.6  8.3
looic      1721.2 44.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   767       
 (0.5, 0.7]   (ok)         5    2.8%   105       
   (0.7, 1]   (bad)        1    0.6%   17        
   (1, Inf)   (very bad)   1    0.6%   26        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.6     22.2        33.6    8.3   1721.2
fit_sleep2  -24.7      11.4  -885.3     14.4        19.8    3.5   1770.7
fit_sleep1  -92.8      20.8  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.4  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
5.158701e-41 1.801510e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.58     0.31     5.47       0.04      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.58    -3.21     2.98       5.39      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0         tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
