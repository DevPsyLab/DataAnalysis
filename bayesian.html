<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.80      6.84    15.67    42.10 1.00     2041     2631
sd(Days)                6.59      1.57     4.11    10.18 1.00     1383     1785
cor(Intercept,Days)     0.07      0.30    -0.48     0.66 1.00     1228     2047

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.31      7.34   237.19   265.99 1.00     1849     2892
Days         10.39      1.68     7.10    13.81 1.00     1725     2003

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.88      1.58    23.06    29.21 1.00     3298     2850

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6792  13.28648 227.0943 279.1711
309 211.4464  12.91372 186.4153 236.1279
310 212.9464  13.27572 186.0672 238.0253
330 275.0062  13.41463 249.8166 302.0794
331 273.3298  12.78282 248.6940 298.1923
332 260.3890  12.49415 236.3636 285.2414
333 267.8955  12.56805 242.8841 293.5304
334 244.3379  12.21205 220.3595 268.0423
335 250.7857  13.31707 224.9335 277.7646
337 285.8212  12.77671 261.2523 311.3790
349 226.6863  12.82656 201.5756 250.7947
350 238.6906  12.84796 212.5012 263.2508
351 255.5276  12.73581 230.8340 281.0849
352 272.1756  12.35674 248.8785 297.2349
369 254.9612  11.95534 231.1574 278.3592
370 226.2177  13.53062 199.3060 252.7173
371 252.2575  12.11621 228.1004 276.7119
372 263.2932  12.36419 239.7804 288.2643

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.7107196  2.478678 15.00593802 24.768583
309  1.7477987  2.436304 -2.91603849  6.610850
310  4.9511972  2.519439 -0.02032344  9.955084
330  5.6607211  2.557089  0.51576913 10.551760
331  7.4119674  2.416384  2.59457555 12.017504
332 10.2024081  2.374604  5.45138405 14.873608
333 10.3158237  2.375137  5.56479679 14.901507
334 11.5399943  2.310740  7.03716055 16.078638
335 -0.2216083  2.549463 -5.09395500  4.830340
337 19.2227271  2.465362 14.43894866 24.024900
349 11.5655037  2.428628  6.93363470 16.439191
350 17.0075985  2.422216 12.55112303 21.964021
351  7.5292389  2.426754  2.70722744 12.259433
352 14.0332307  2.364415  9.44639287 18.673356
369 11.3016282  2.338736  6.80552357 16.001380
370 15.2311097  2.525603 10.40939784 20.419438
371  9.4985172  2.335596  4.84694061 14.034405
372 11.8419290  2.352016  7.20601920 16.393260</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6792 13.286485 227.0943 279.1711
  [2,] 273.3899 11.400691 250.3955 295.3859
  [3,] 293.1006  9.783075 273.8896 312.2618
  [4,] 312.8113  8.586561 296.3749 330.0561
  [5,] 332.5220  8.002324 317.3376 348.3974
  [6,] 352.2327  8.162907 336.2689 367.9931
  [7,] 371.9435  9.028655 353.8974 389.4662
  [8,] 391.6542 10.425346 371.2017 411.3806
  [9,] 411.3649 12.171556 387.1008 434.4191
 [10,] 431.0756 14.138366 403.3172 458.3278
 [11,] 211.4464 12.913719 186.4153 236.1279
 [12,] 213.1942 11.112793 191.5524 234.3839
 [13,] 214.9420  9.596633 196.3087 233.4738
 [14,] 216.6898  8.518668 200.2500 233.1979
 [15,] 218.4376  8.056750 203.2075 234.3460
 [16,] 220.1854  8.314197 204.5459 236.6688
 [17,] 221.9332  9.231018 204.0439 240.0523
 [18,] 223.6810 10.638077 202.9125 244.3817
 [19,] 225.4288 12.369188 201.0711 249.3703
 [20,] 227.1766 14.307205 199.0811 254.7150
 [21,] 212.9464 13.275723 186.0672 238.0253
 [22,] 217.8976 11.351322 195.0027 239.8448
 [23,] 222.8488  9.703367 203.2085 241.5350
 [24,] 227.8000  8.494312 210.6064 244.0675
 [25,] 232.7512  7.927577 217.1999 247.6472
 [26,] 237.7024  8.138474 221.5445 253.7105
 [27,] 242.6536  9.072938 224.5700 259.9050
 [28,] 247.6048 10.540246 226.8216 267.5706
 [29,] 252.5560 12.351944 228.2121 276.1557
 [30,] 257.5072 14.378436 229.4215 285.4918
 [31,] 275.0062 13.414634 249.8166 302.0794
 [32,] 280.6669 11.454149 258.7264 303.6565
 [33,] 286.3276  9.773437 267.4700 305.8197
 [34,] 291.9884  8.539321 275.2949 308.5667
 [35,] 297.6491  7.962246 282.2865 313.0320
 [36,] 303.3098  8.182428 287.3359 319.1815
 [37,] 308.9705  9.142445 291.3289 327.3087
 [38,] 314.6312 10.643960 294.1284 336.0527
 [39,] 320.2920 12.493234 296.5354 345.3559
 [40,] 325.9527 14.558341 297.9639 355.0885
 [41,] 273.3298 12.782817 248.6940 298.1923
 [42,] 280.7418 10.977636 259.3517 301.9492
 [43,] 288.1538  9.449570 269.9041 306.4176
 [44,] 295.5657  8.352131 279.5706 311.9408
 [45,] 302.9777  7.867631 287.5423 318.1291
 [46,] 310.3897  8.106724 294.5961 326.1278
 [47,] 317.8016  9.012000 300.5945 335.5691
 [48,] 325.2136 10.411106 305.0791 345.3198
 [49,] 332.6256 12.134411 308.9395 356.0436
 [50,] 340.0375 14.063234 312.6465 366.9649
 [51,] 260.3890 12.494151 236.3636 285.2414
 [52,] 270.5914 10.760515 249.8327 292.3702
 [53,] 280.7938  9.314023 262.8712 299.2818
 [54,] 290.9962  8.306075 275.1401 307.6149
 [55,] 301.1986  7.906214 285.9575 316.7084
 [56,] 311.4010  8.203843 295.5954 327.6574
 [57,] 321.6034  9.131011 304.3221 339.6715
 [58,] 331.8058 10.522603 311.4021 352.4228
 [59,] 342.0082 12.220985 318.2172 365.7134
 [60,] 352.2106 14.115851 324.2175 379.4914
 [61,] 267.8955 12.568054 242.8841 293.5304
 [62,] 278.2113 10.830203 256.9054 300.0177
 [63,] 288.5271  9.376203 270.0414 306.9201
 [64,] 298.8429  8.355575 282.3058 315.4408
 [65,] 309.1588  7.937293 293.2597 324.8027
 [66,] 319.4746  8.213901 303.1181 335.6412
 [67,] 329.7904  9.122404 311.7376 347.7588
 [68,] 340.1062 10.500043 319.2983 360.8041
 [69,] 350.4221 12.188770 326.0839 374.3867
 [70,] 360.7379 14.077069 332.4780 388.4343
 [71,] 244.3379 12.212049 220.3595 268.0423
 [72,] 255.8779 10.578380 235.2542 276.2040
 [73,] 267.4179  9.238459 249.3007 285.2745
 [74,] 278.9579  8.335178 262.6801 294.8906
 [75,] 290.4978  8.017499 274.9183 306.3398
 [76,] 302.0378  8.352510 285.8381 318.6421
 [77,] 313.5778  9.269714 295.0100 331.9448
 [78,] 325.1178 10.619314 303.8898 345.7933
 [79,] 336.6578 12.259327 312.4285 360.1968
 [80,] 348.1978 14.088697 320.3313 375.5703
 [81,] 250.7857 13.317074 224.9335 277.7646
 [82,] 250.5641 11.374020 228.1754 273.4923
 [83,] 250.3425  9.715539 231.3945 269.8269
 [84,] 250.1209  8.509676 233.6718 266.5698
 [85,] 249.8993  7.964735 234.3141 265.6564
 [86,] 249.6777  8.213339 233.2703 265.9145
 [87,] 249.4561  9.191321 231.4003 267.4927
 [88,] 249.2345 10.700531 228.0610 270.3854
 [89,] 249.0129 12.550771 224.6149 273.8576
 [90,] 248.7913 14.613071 220.8961 277.7157
 [91,] 285.8212 12.776711 261.2523 311.3790
 [92,] 305.0439 10.937505 283.4805 327.0863
 [93,] 324.2666  9.389874 305.6647 343.3803
 [94,] 343.4894  8.298583 326.5400 359.8387
 [95,] 362.7121  7.856158 347.0820 377.4774
 [96,] 381.9348  8.168721 365.8829 397.7417
 [97,] 401.1575  9.159301 383.3669 418.7475
 [98,] 420.3803 10.640188 399.3643 441.0801
 [99,] 439.6030 12.437461 414.7985 463.4436
[100,] 458.8257 14.433408 430.0166 486.5288
[101,] 226.6863 12.826561 201.5756 250.7947
[102,] 238.2518 10.999975 216.5582 259.2608
[103,] 249.8173  9.448529 231.1926 268.4573
[104,] 261.3828  8.327450 244.9038 277.6657
[105,] 272.9483  7.823976 257.5187 288.6121
[106,] 284.5139  8.054766 268.9474 300.4846
[107,] 296.0794  8.963279 278.2896 313.5303
[108,] 307.6449 10.372944 287.2373 327.5637
[109,] 319.2104 12.109997 294.7639 342.3834
[110,] 330.7759 14.053560 302.0931 357.3915
[111,] 238.6906 12.847965 212.5012 263.2508
[112,] 255.6982 11.039201 233.4871 277.0511
[113,] 272.7058  9.507470 253.7870 291.0488
[114,] 289.7134  8.405610 273.3294 306.1192
[115,] 306.7210  7.915227 291.3207 321.9814
[116,] 323.7286  8.147493 307.9695 339.6180
[117,] 340.7362  9.046918 323.1085 358.8168
[118,] 357.7438 10.442512 337.2578 379.0964
[119,] 374.7514 12.164690 351.2185 399.2111
[120,] 391.7590 14.094238 364.2915 420.0012
[121,] 255.5276 12.735808 230.8340 281.0849
[122,] 263.0569 10.945795 241.7099 285.3898
[123,] 270.5861  9.444488 252.4862 289.5505
[124,] 278.1154  8.388356 261.8113 294.9269
[125,] 285.6446  7.956694 269.9893 301.1272
[126,] 293.1738  8.248133 276.9327 308.9528
[127,] 300.7031  9.194166 282.8297 318.7771
[128,] 308.2323 10.621298 287.6611 328.9731
[129,] 315.7615 12.364041 291.7276 339.7793
[130,] 323.2908 14.307526 294.6102 351.6194
[131,] 272.1756 12.356740 248.8785 297.2349
[132,] 286.2088 10.619230 266.0221 307.1644
[133,] 300.2420  9.166678 282.8005 318.4791
[134,] 314.2753  8.152842 298.7761 330.5004
[135,] 328.3085  7.751814 313.4394 343.7882
[136,] 342.3417  8.055638 327.0820 358.6831
[137,] 356.3750  8.993160 339.0686 374.4438
[138,] 370.4082 10.394299 350.2138 391.3014
[139,] 384.4414 12.099046 361.0358 408.3559
[140,] 398.4747 13.996903 371.5266 426.3584
[141,] 254.9612 11.955338 231.1574 278.3592
[142,] 266.2628 10.242556 246.0422 286.2101
[143,] 277.5645  8.822084 259.9310 295.0494
[144,] 288.8661  7.854155 273.5846 304.2561
[145,] 300.1677  7.515698 285.5506 314.9552
[146,] 311.4693  7.888159 296.3363 326.9338
[147,] 322.7710  8.882554 305.2878 340.0028
[148,] 334.0726 10.320652 314.0034 354.1323
[149,] 345.3742 12.044556 321.4222 368.7778
[150,] 356.6758 13.948698 329.5793 383.4418
[151,] 226.2177 13.530621 199.3060 252.7173
[152,] 241.4488 11.594832 218.6533 264.3347
[153,] 256.6799  9.927734 237.2238 276.2542
[154,] 271.9110  8.685448 255.3230 289.4216
[155,] 287.1421  8.066688 271.6810 303.3743
[156,] 302.3732  8.213602 286.6103 318.4450
[157,] 317.6043  9.089136 300.1529 334.7030
[158,] 332.8355 10.512796 312.9276 352.6627
[159,] 348.0666 12.295638 324.3917 372.3046
[160,] 363.2977 14.303982 335.8070 391.9120
[161,] 252.2575 12.116208 228.1004 276.7119
[162,] 261.7560 10.461112 241.1294 283.0150
[163,] 271.2545  9.109184 253.3192 289.0710
[164,] 280.7530  8.211554 264.8395 296.9540
[165,] 290.2516  7.924142 275.1093 305.9336
[166,] 299.7501  8.310503 284.0840 316.1146
[167,] 309.2486  9.286922 291.4314 327.2121
[168,] 318.7471 10.692960 297.9470 339.4499
[169,] 328.2456 12.383129 304.3357 352.5829
[170,] 337.7441 14.256732 309.9654 365.4602
[171,] 263.2932 12.364185 239.7804 288.2643
[172,] 275.1351 10.623554 254.9562 296.1484
[173,] 286.9770  9.160277 269.4725 305.3424
[174,] 298.8190  8.125602 283.5320 314.9560
[175,] 310.6609  7.694421 295.9617 325.6284
[176,] 322.5028  7.965347 306.8987 337.8180
[177,] 334.3447  8.874309 316.6950 351.6381
[178,] 346.1867 10.252996 325.8407 366.2746
[179,] 358.0286 11.939784 334.3792 381.6802
[180,] 369.8705 13.822334 342.4885 397.3708</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.11915052 13.286485 -2.961109e+01  22.4656736
  [2,]  -14.68517015 11.400691 -3.668118e+01   8.3092372
  [3,]  -42.29998978  9.783075 -6.146119e+01 -23.0890454
  [4,]    8.62849059  8.586561 -8.616318e+00  25.0649387
  [5,]   24.32987096  8.002324  8.454456e+00  39.5142607
  [6,]   62.45735133  8.162907  4.669702e+01  78.4211901
  [7,]   10.26033170  9.028655 -7.262449e+00  28.3063886
  [8,] -101.50558793 10.425346 -1.212320e+02 -81.0531105
  [9,]   19.22039245 12.171556 -3.833809e+00  43.4844632
 [10,]   35.27787282 14.138366  8.025665e+00  63.0362625
 [11,]   11.28752760 12.913719 -1.339396e+01  36.3185545
 [12,]   -7.92837115 11.112793 -2.911806e+01  13.7133973
 [13,]  -11.96416989  9.596633 -3.049600e+01   6.6691419
 [14,]  -11.98276864  8.518668 -2.849093e+01   4.4569916
 [15,]  -10.72146738  8.056750 -2.662993e+01   4.5085883
 [16,]   -4.22356612  8.314197 -2.070699e+01  11.4158666
 [17,]   -8.30286487  9.231018 -2.642201e+01   9.5864062
 [18,]   -5.95376361 10.638077 -2.665454e+01  14.8146731
 [19,]   -1.13306235 12.369188 -2.507459e+01  23.2246364
 [20,]   10.13763890 14.307205 -1.740084e+01  38.2331121
 [21,]  -13.89253155 13.275723 -3.897145e+01  12.9866956
 [22,]  -23.56542875 11.351322 -4.551261e+01  -0.6705287
 [23,]   11.47117405  9.703367 -7.215039e+00  31.1114803
 [24,]    5.04157684  8.494312 -1.122593e+01  22.2352001
 [25,]   -3.44382036  7.927577 -1.833984e+01  12.1074763
 [26,]  -17.24451756  8.138474 -3.325260e+01  -1.0865820
 [27,]   -7.23281476  9.072938 -2.448422e+01  10.8507733
 [28,]    8.14628804 10.540246 -1.181946e+01  28.9294890
 [29,]    8.45649084 12.351944 -1.514319e+01  32.8003617
 [30,]   -9.99190636 14.378436 -3.797654e+01  18.0937898
 [31,]   46.53640928 13.414634  1.946319e+01  71.7259951
 [32,]   19.73328814 11.454149 -3.256346e+00  41.6738005
 [33,]   -2.47113301  9.773437 -2.196318e+01  16.3865132
 [34,]   -6.85535415  8.539321 -2.343371e+01   9.8381084
 [35,]  -11.85177530  7.962246 -2.723471e+01   3.5108162
 [36,]   -5.72429644  8.182428 -2.159596e+01  10.2496267
 [37,]  -28.73091759  9.142445 -4.706913e+01 -11.0893488
 [38,]    3.63006127 10.643960 -1.779135e+01  24.1328856
 [39,]  -14.94245988 12.493234 -4.000643e+01   8.8140759
 [40,]   28.09601898 14.558341 -1.039784e+00  56.0847700
 [41,]   14.27805974 12.782817 -1.058441e+01  38.9138558
 [42,]    4.25819232 10.977636 -1.694918e+01  25.6482570
 [43,]   13.66682490  9.449570 -4.597018e+00  31.9165436
 [44,]   24.54955748  8.352131  8.174526e+00  40.5447066
 [45,]   13.29959005  7.867631 -1.851819e+00  28.7349912
 [46,]  -17.07097737  8.106724 -3.280908e+01  -1.2773899
 [47,]  -27.72664479  9.012000 -4.549412e+01 -10.5194663
 [48,]    9.60408779 10.411106 -1.050214e+01  29.7385984
 [49,]  -38.87867964 12.134411 -6.229667e+01 -15.1925691
 [50,]   31.54355294 14.063234  4.616182e+00  58.9346392
 [51,]  -25.52837587 12.494151 -5.038083e+01  -1.5029892
 [52,]  -27.77958394 10.760515 -4.955845e+01  -7.0209155
 [53,]   -7.83249201  9.314023 -2.632050e+01  10.0900854
 [54,]   18.77259991  8.306075  2.153920e+00  34.6286544
 [55,]   16.26429184  7.906214  7.545172e-01  31.5053607
 [56,]   -1.40341623  8.203843 -1.765977e+01  14.4022136
 [57,]  132.55847569  9.131011  1.144904e+02 149.8397699
 [58,]   15.02526762 10.522603 -5.591658e+00  35.4290074
 [59,]  -11.70794045 12.220985 -3.541308e+01  12.0830540
 [60,]  -98.34624853 14.115851 -1.256270e+02 -70.3530529
 [61,]   15.94693790 12.568054 -9.688025e+00  40.9582612
 [62,]   11.34371416 10.830203 -1.046273e+01  32.6495540
 [63,]  -11.75780959  9.376203 -3.015081e+01   6.7278898
 [64,]    0.96676667  8.355575 -1.563107e+01  17.5039327
 [65,]  -11.98775708  7.937293 -2.763168e+01   3.9113076
 [66,]   18.69191918  8.213901  2.525259e+00  35.0483529
 [67,]    2.23609543  9.122404 -1.573228e+01  20.2888717
 [68,]    8.73367169 10.500043 -1.196424e+01  29.5415550
 [69,]  -17.06205206 12.188770 -4.102673e+01   7.2760999
 [70,]    1.30492420 14.077069 -2.639150e+01  29.5647991
 [71,]   21.13522778 12.212049 -2.569192e+00  45.1135846
 [72,]   20.32333347 10.578380 -2.831974e-03  40.9469568
 [73,]  -24.05316084  9.238459 -4.190977e+01  -5.9359664
 [74,]  -24.28555515  8.335178 -4.021826e+01  -8.0077570
 [75,]  -11.47344946  8.017499 -2.731539e+01   4.1060761
 [76,]  -17.84664376  8.352510 -3.445089e+01  -1.6468993
 [77,]   -8.05303807  9.269714 -2.641995e+01  10.5148102
 [78,]    6.40506762 10.619314 -1.427043e+01  27.6331126
 [79,]   -0.91092669 12.259327 -2.444989e+01  23.3184287
 [80,]   29.10117900 14.088697  1.728665e+00  56.9677416
 [81,]   -9.17742849 13.317074 -3.615632e+01  16.6747697
 [82,]   23.38307980 11.374020  4.549416e-01  45.7717792
 [83,]    4.14818809  9.715539 -1.533617e+01  23.0961661
 [84,]   20.68119638  8.509676  4.232343e+00  37.1302601
 [85,]    1.55260467  7.964735 -1.420445e+01  17.1378134
 [86,]    4.95851296  8.213339 -1.127826e+01  21.3658968
 [87,]   -4.00377875  9.191321 -2.204041e+01  14.0520348
 [88,]  -13.92347046 10.700531 -3.507436e+01   7.2499861
 [89,]  -13.25876217 12.550771 -3.810355e+01  11.1392013
 [90,]  -11.54465388 14.613071 -4.046912e+01  16.3505283
 [91,]   26.54542992 12.776711  9.875999e-01  51.1143343
 [92,]    8.76190285 10.937505 -1.328051e+01  30.3253173
 [93,]  -32.65542423  9.389874 -5.176913e+01 -14.0534590
 [94,]    2.63284870  8.298583 -1.371653e+01  19.5821526
 [95,]    3.02032163  7.856158 -1.174504e+01  18.6503656
 [96,]    9.90369456  8.168721 -5.903169e+00  25.9555832
 [97,]    3.10256749  9.159301 -1.448738e+01  20.8931825
 [98,]   -3.68795958 10.640188 -2.438776e+01  17.3279803
 [99,]   16.26131335 12.437461 -7.579282e+00  41.0658098
[100,]    0.09098627 14.433408 -2.761209e+01  28.9001130
[101,]    9.41686729 12.826561 -1.469146e+01  34.5275806
[102,]   -7.93513643 10.999975 -2.894413e+01  13.7584604
[103,]  -10.89174016  9.448529 -2.953167e+01   7.7329877
[104,]   -6.46084388  8.327450 -2.274370e+01  10.0181580
[105,]  -22.23804761  7.823976 -3.790180e+01  -6.8083960
[106,]  -14.73945133  8.054766 -3.071020e+01   0.8270286
[107,]  -14.51455506  8.963279 -3.196546e+01   3.2751702
[108,]    0.45714122 10.372944 -1.946173e+01  20.8647385
[109,]   17.07023749 12.109997 -6.102784e+00  41.5167160
[110,]   20.86923377 14.053560 -5.746438e+00  49.5520269
[111,]   17.60616739 12.847965 -6.953956e+00  43.7956434
[112,]  -12.24393108 11.039201 -3.359678e+01   9.9672447
[113,]  -16.50122955  9.507470 -3.484422e+01   2.4175552
[114,]  -34.18632802  8.405610 -5.059211e+01 -17.8023389
[115,]  -37.80452649  7.915227 -5.306491e+01 -22.4041563
[116,]    5.99607504  8.147493 -9.893342e+00  21.7551679
[117,]   38.70827656  9.046918  2.062767e+01  56.3359587
[118,]    5.17457809 10.442512 -1.617799e+01  25.6605690
[119,]   19.73577962 12.164690 -4.723901e+00  43.2687297
[120,]   -2.70631885 14.094238 -3.094845e+01  24.7611597
[121,]   -5.00113804 12.735808 -3.055841e+01  19.6924985
[122,]   37.00072309 10.945795  1.466777e+01  58.3477010
[123,]   -0.69221578  9.444488 -1.965662e+01  17.4077404
[124,]    2.47374536  8.388356 -1.433784e+01  18.7778083
[125,]  -13.81719351  7.956694 -2.929981e+01   1.8380642
[126,]   11.45976763  8.248133 -4.319234e+00  27.7008973
[127,]  -12.95647124  9.194166 -3.103052e+01   4.9169349
[128,]  -41.63681010 10.621298 -6.237763e+01 -21.0655662
[129,]    5.78025103 12.364041 -1.823755e+01  29.8142082
[130,]   24.27471216 14.307526 -4.053868e+00  52.9552777
[131,]  -50.49847915 12.356740 -7.555781e+01 -27.2013672
[132,]   11.98509015 10.619230 -8.970462e+00  32.1718416
[133,]   26.63645945  9.166678  8.399404e+00  44.0779562
[134,]   32.58022876  8.152842  1.635508e+01  48.0794397
[135,]   20.43169806  7.751814  4.951980e+00  35.3007927
[136,]   10.48696736  8.055638 -5.854414e+00  25.7466856
[137,]   -1.94836334  8.993160 -2.001715e+01  15.3579905
[138,]   -9.97559403 10.394299 -3.086878e+01  10.2188249
[139,]   -8.80082473 12.099046 -3.271529e+01  14.6048420
[140,]   -9.93295543 13.996903 -3.781671e+01  17.0151252
[141,]   16.96230625 11.955338 -6.435724e+00  40.7661401
[142,]    2.17407803 10.242556 -1.777318e+01  22.3947015
[143,]  -20.32205020  8.822084 -3.780704e+01  -2.6886419
[144,]  -11.20947843  7.854155 -2.659949e+01   4.0720034
[145,]   14.65449334  7.515698 -1.329791e-01  29.2715714
[146,]    5.74416511  7.888159 -9.720306e+00  20.8771981
[147,]  -24.63566312  8.882554 -4.186747e+01  -7.1525281
[148,]   14.05030865 10.320652 -6.009441e+00  34.1194996
[149,]   -5.09421958 12.044556 -2.849779e+01  18.8577844
[150,]    9.83725220 13.948698 -1.692867e+01  36.9337909
[151,]   -0.95368947 13.530621 -2.745331e+01  25.9580229
[152,]   -6.92529918 11.594832 -2.981121e+01  15.8702261
[153,]  -17.77910890  9.927734 -3.735337e+01   1.6769961
[154,]  -31.43801861  8.685448 -4.894861e+01 -14.8500080
[155,]  -19.60482833  8.066688 -3.583699e+01  -4.1437191
[156,]   41.82046196  8.213602  2.574869e+01  57.5834415
[157,]  -36.45624776  9.089136 -5.355491e+01 -19.0048273
[158,]   14.75004253 10.512796 -5.077229e+00  34.6578784
[159,]   17.09643281 12.295638 -7.141608e+00  40.7713243
[160,]    8.93112310 14.303982 -1.968323e+01  36.4217864
[161,]   17.62291451 12.116208 -6.831501e+00  41.7800490
[162,]   10.68679730 10.461112 -1.057220e+01  31.3134455
[163,]    6.64438010  9.109184 -1.117209e+01  24.5797404
[164,]    1.03646289  8.211554 -1.516451e+01  16.9499996
[165,]  -11.08105432  7.924142 -2.676314e+01   4.0612162
[166,]  -15.23807153  8.310503 -3.160261e+01   0.4279894
[167,]  -49.98278874  9.286922 -6.794630e+01 -32.1655972
[168,]  -14.11650594 10.692960 -3.481926e+01   6.6835501
[169,]   22.53507685 12.383129 -1.802234e+00  46.4450292
[170,]   31.72505964 14.256732  4.008988e+00  59.5037973
[171,]    6.11852674 12.364185 -1.885256e+01  29.6313030
[172,]   -1.66110222 10.623554 -2.267442e+01  18.5178417
[173,]   10.61976882  9.160277 -7.745599e+00  28.1242935
[174,]   11.81263986  8.125602 -4.324372e+00  27.0995536
[175,]  -23.48828909  7.694421 -3.845576e+01  -8.7890854
[176,]    7.10478195  7.965347 -8.210386e+00  22.7088894
[177,]    0.13705299  8.874309 -1.715632e+01  17.7868185
[178,]   -2.96677597 10.252996 -2.305474e+01  17.3792258
[179,]   11.11309507 11.939784 -1.253853e+01  34.7625315
[180,]   -5.74693389 13.822334 -3.324721e+01  21.6350988</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.2
p_loo        19.3  3.2
looic      1769.8 28.5
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1426      
 (0.5, 0.7]   (ok)         2    1.1%   210       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.5 22.2
p_loo        33.7  8.3
looic      1721.0 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   638       
 (0.5, 0.7]   (ok)         5    2.8%   1096      
   (0.7, 1]   (bad)        3    1.7%   23        
   (1, Inf)   (very bad)   1    0.6%   32        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.4      11.7  
fit_sleep1 -92.8      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.2
p_loo        19.3  3.2
looic      1769.8 28.5
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1426      
 (0.5, 0.7]   (ok)         2    1.1%   210       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.5 22.2
p_loo        33.7  8.3
looic      1721.0 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   638       
 (0.5, 0.7]   (ok)         5    2.8%   1096      
   (0.7, 1]   (bad)        3    1.7%   23        
   (1, Inf)   (very bad)   1    0.6%   32        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.5     22.2        33.7    8.3   1721.0
fit_sleep2  -24.4      11.7  -884.9     14.2        19.3    3.2   1769.8
fit_sleep1  -92.8      20.9  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   44.5  
fit_sleep2   28.5  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
5.227900e-41 2.605817e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.87      1.59     0.21     5.45       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.13      1.59    -3.39     2.95       5.59      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_5.0.0           compiler_4.2.2      
 [22] cli_3.6.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.19      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.1   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.12       yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.19        V8_4.2.2            
 [88] RcppParallel_5.1.6   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.8         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
