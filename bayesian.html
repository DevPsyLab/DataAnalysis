<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.73      7.03    15.17    42.78 1.00     1737     2660
sd(Days)                6.59      1.55     4.19    10.25 1.00     1599     2170
cor(Intercept,Days)     0.09      0.31    -0.48     0.70 1.00      886     1847

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.17      7.29   236.53   265.68 1.00     2166     2770
Days         10.46      1.74     7.09    13.97 1.00     1626     2144

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.94      1.51    23.20    29.08 1.00     3156     2854

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7266  13.37105 227.7076 279.9252
309 211.5497  13.14887 185.1076 236.4019
310 213.0624  13.29413 186.7722 238.0517
330 274.4991  13.42676 248.7062 301.4380
331 272.8366  13.20917 247.9594 298.9537
332 260.1538  12.22878 237.0046 283.6699
333 267.6933  12.62270 243.7128 292.7045
334 244.2619  12.28375 219.4840 267.6159
335 250.7765  13.50447 224.8293 277.9442
337 286.0506  13.33267 260.5420 312.8129
349 226.5213  13.47258 200.0528 252.1923
350 238.6379  13.29761 210.8868 264.1885
351 255.3977  12.62376 230.7377 280.4186
352 271.7896  12.66401 248.2950 297.3404
369 254.5737  12.19131 230.1960 278.4217
370 226.7932  13.44143 199.6175 251.7335
371 252.1722  12.53444 227.7661 276.6938
372 263.6493  12.11790 240.0486 287.5618

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6481268  2.530161 14.76615589 24.648924
309  1.7624650  2.479436 -3.02678118  6.572909
310  4.9012465  2.494164  0.03465906  9.746088
330  5.7522541  2.510750  0.67005674 10.533636
331  7.5197413  2.471719  2.58159912 12.204535
332 10.2731865  2.370661  5.72134332 14.909973
333 10.3603316  2.442963  5.41470030 15.130418
334 11.5132455  2.371122  7.01664493 16.181346
335 -0.2498467  2.586154 -5.42902568  4.667812
337 19.1322609  2.540026 14.11220887 24.101770
349 11.5742617  2.525955  6.77075868 16.558831
350 17.0402871  2.525520 12.21289029 22.202673
351  7.5133566  2.396511  2.76354460 12.007420
352 14.0627962  2.390108  9.43870320 18.674940
369 11.3794343  2.343013  6.82704591 15.946722
370 15.1077605  2.514521 10.36255919 20.101783
371  9.4965195  2.406085  4.71429936 14.252059
372 11.7935054  2.310936  7.30763584 16.358036</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7266 13.371052 227.7076 279.9252
  [2,] 273.3747 11.439892 251.1583 296.0134
  [3,] 293.0229  9.785737 273.9977 312.1662
  [4,] 312.6710  8.570509 296.1539 329.2614
  [5,] 332.3191  7.996875 316.7027 347.9903
  [6,] 351.9672  8.200600 335.7488 367.9654
  [7,] 371.6154  9.129792 353.5066 388.9273
  [8,] 391.2635 10.595273 369.8547 411.2413
  [9,] 410.9116 12.408462 385.9543 434.8341
 [10,] 430.5598 14.438957 401.6416 458.8373
 [11,] 211.5497 13.148866 185.1076 236.4019
 [12,] 213.3122 11.268842 190.7130 234.7777
 [13,] 215.0746  9.663131 195.8351 233.8606
 [14,] 216.8371  8.488853 200.0868 233.6203
 [15,] 218.5996  7.939795 203.0522 233.8611
 [16,] 220.3620  8.143419 204.5462 236.3114
 [17,] 222.1245  9.049055 204.6734 239.7666
 [18,] 223.8870 10.476199 203.0817 244.4435
 [19,] 225.6494 12.243826 201.3708 249.1912
 [20,] 227.4119 14.225577 199.1190 254.6068
 [21,] 213.0624 13.294128 186.7722 238.0517
 [22,] 217.9636 11.381946 195.1161 239.2096
 [23,] 222.8649  9.736800 203.3134 241.4716
 [24,] 227.7661  8.514901 210.6670 244.8259
 [25,] 232.6674  7.914766 216.9393 248.4160
 [26,] 237.5686  8.076212 221.5369 253.4941
 [27,] 242.4699  8.958157 224.6999 260.0780
 [28,] 247.3711 10.378520 226.6513 267.2537
 [29,] 252.2724 12.149917 227.6770 275.5910
 [30,] 257.1736 14.141039 229.0207 284.3057
 [31,] 274.4991 13.426758 248.7062 301.4380
 [32,] 280.2514 11.518135 257.8691 303.0755
 [33,] 286.0036  9.882550 266.4974 305.7388
 [34,] 291.7559  8.675821 274.3930 308.5852
 [35,] 297.5081  8.092136 280.9280 313.1444
 [36,] 303.2604  8.264575 286.4829 319.0523
 [37,] 309.0126  9.150490 290.8479 326.4707
 [38,] 314.7649 10.572012 294.0946 335.2282
 [39,] 320.5171 12.345491 296.2638 344.4633
 [40,] 326.2694 14.340941 298.4461 353.7801
 [41,] 272.8366 13.209172 247.9594 298.9537
 [42,] 280.3563 11.354374 258.7607 302.6640
 [43,] 287.8761  9.776512 269.1165 306.8553
 [44,] 295.3958  8.628867 278.6931 312.0568
 [45,] 302.9155  8.096500 287.0538 318.7551
 [46,] 310.4353  8.298677 294.2471 326.6033
 [47,] 317.9550  9.187033 300.1158 335.8235
 [48,] 325.4748 10.590274 304.6065 346.2201
 [49,] 332.9945 12.333897 308.8810 356.8424
 [50,] 340.5142 14.293876 312.3772 368.3654
 [51,] 260.1538 12.228782 237.0046 283.6699
 [52,] 270.4270 10.501504 250.7504 290.6125
 [53,] 280.7002  9.069737 263.5801 298.0167
 [54,] 290.9734  8.091894 275.6735 306.3538
 [55,] 301.2466  7.741927 286.4808 316.4228
 [56,] 311.5198  8.101615 295.8639 327.4323
 [57,] 321.7930  9.087078 304.6034 339.4302
 [58,] 332.0661 10.523966 311.9421 351.9948
 [59,] 342.3393 12.254501 318.9539 365.8299
 [60,] 352.6125 14.171514 325.1742 379.8590
 [61,] 267.6933 12.622700 243.7128 292.7045
 [62,] 278.0536 10.810362 257.6274 299.5046
 [63,] 288.4140  9.291471 270.6830 306.6167
 [64,] 298.7743  8.230132 283.0119 315.0110
 [65,] 309.1346  7.815040 293.7252 324.7754
 [66,] 319.4950  8.145597 303.8305 335.4437
 [67,] 329.8553  9.141269 312.1504 348.2402
 [68,] 340.2156 10.616542 319.5158 361.9637
 [69,] 350.5760 12.401422 326.2000 375.5624
 [70,] 360.9363 14.381088 332.8132 389.5201
 [71,] 244.2619 12.283749 219.4840 267.6159
 [72,] 255.7752 10.583014 234.5359 276.1519
 [73,] 267.2884  9.184461 248.8617 285.0632
 [74,] 278.8016  8.243354 262.4369 294.4223
 [75,] 290.3149  7.924385 274.7656 305.3022
 [76,] 301.8281  8.299597 285.8670 317.7131
 [77,] 313.3414  9.285213 295.2617 331.2477
 [78,] 324.8546 10.714079 303.7969 345.7699
 [79,] 336.3679 12.434316 311.7947 360.4739
 [80,] 347.8811 14.341457 319.5002 375.6545
 [81,] 250.7765 13.504469 224.8293 277.9442
 [82,] 250.5267 11.513576 228.6512 273.3008
 [83,] 250.2768  9.804619 231.6556 269.3887
 [84,] 250.0270  8.548395 233.9349 266.5275
 [85,] 249.7771  7.962157 234.2228 265.4446
 [86,] 249.5273  8.191044 233.6352 265.5275
 [87,] 249.2774  9.174250 231.4301 267.3217
 [88,] 249.0276 10.705928 228.2178 270.5301
 [89,] 248.7777 12.587426 224.0339 273.9664
 [90,] 248.5279 14.684894 219.8365 277.7489
 [91,] 286.0506 13.332673 260.5420 312.8129
 [92,] 305.1828 11.388495 283.5085 327.8387
 [93,] 324.3151  9.723114 306.0522 343.3274
 [94,] 343.4474  8.501972 326.9463 360.0367
 [95,] 362.5796  7.932943 347.0608 378.1582
 [96,] 381.7119  8.153718 365.9657 397.7745
 [97,] 400.8441  9.107036 383.3079 418.7617
 [98,] 419.9764 10.597007 399.2174 440.4060
 [99,] 439.1087 12.432156 414.5021 462.5266
[100,] 458.2409 14.481847 429.7673 486.0971
[101,] 226.5213 13.472583 200.0528 252.1923
[102,] 238.0956 11.537986 215.0165 260.2879
[103,] 249.6698  9.874241 229.9729 268.6063
[104,] 261.2441  8.639274 244.4567 278.0753
[105,] 272.8184  8.033329 257.1994 288.7103
[106,] 284.3926  8.197108 268.6551 300.6307
[107,] 295.9669  9.089097 278.0426 314.1848
[108,] 307.5412 10.525762 287.0591 328.7514
[109,] 319.1154 12.317977 295.4917 343.8913
[110,] 330.6897 14.332981 303.3250 359.6209
[111,] 238.6379 13.297607 210.8868 264.1885
[112,] 255.6782 11.387555 231.7928 277.6340
[113,] 272.7185  9.761299 252.6748 291.6051
[114,] 289.7588  8.581724 272.6093 306.5735
[115,] 306.7991  8.047704 290.8273 322.3142
[116,] 323.8394  8.285022 307.8674 340.1867
[117,] 340.8797  9.234400 323.0897 359.0631
[118,] 357.9200 10.708090 337.4354 379.1894
[119,] 374.9602 12.522329 350.8928 400.1329
[120,] 392.0005 14.550284 363.9311 421.3681
[121,] 255.3977 12.623761 230.7377 280.4186
[122,] 262.9110 10.824418 241.8032 284.4007
[123,] 270.4244  9.298561 252.5094 289.1046
[124,] 277.9378  8.200303 262.0369 293.6642
[125,] 285.4511  7.714482 270.2372 300.5846
[126,] 292.9645  7.954120 277.2100 308.5555
[127,] 300.4778  8.860550 283.2516 317.8983
[128,] 307.9912 10.258518 288.0432 328.2088
[129,] 315.5045 11.977126 292.1763 338.9443
[130,] 323.0179 13.897930 296.2259 350.1317
[131,] 271.7896 12.664013 248.2950 297.3404
[132,] 285.8524 10.897515 265.4368 307.5626
[133,] 299.9152  9.410616 281.9472 318.4445
[134,] 313.9780  8.353967 297.5424 330.3529
[135,] 328.0408  7.902094 312.2967 343.6813
[136,] 342.1035  8.156141 325.7832 358.2695
[137,] 356.1663  9.056899 337.9940 374.2728
[138,] 370.2291 10.438268 349.5941 391.4516
[139,] 384.2919 12.137244 360.4728 408.9305
[140,] 398.3547 14.038988 370.8996 426.5351
[141,] 254.5737 12.191314 230.1960 278.4217
[142,] 265.9531 10.475483 245.0062 286.3889
[143,] 277.3325  9.045593 259.4399 294.8250
[144,] 288.7120  8.055384 273.1123 304.1039
[145,] 300.0914  7.676918 285.1052 314.8774
[146,] 311.4708  7.997521 295.7208 326.9669
[147,] 322.8503  8.942318 305.1063 340.4961
[148,] 334.2297 10.341623 313.2972 354.4066
[149,] 345.6091 12.037969 321.3506 368.8032
[150,] 356.9886 13.923205 329.3626 383.8337
[151,] 226.7932 13.441428 199.6175 251.7335
[152,] 241.9010 11.515498 218.8101 263.8045
[153,] 257.0087  9.858347 237.1813 276.0016
[154,] 272.1165  8.626295 255.1371 288.6801
[155,] 287.2242  8.017765 271.5626 302.9435
[156,] 302.3320  8.173236 286.1644 318.3442
[157,] 317.4398  9.053433 299.8596 335.2454
[158,] 332.5475 10.477269 312.3921 353.3607
[159,] 347.6553 12.256724 324.3786 371.4245
[160,] 362.7630 14.259280 335.1018 390.2531
[161,] 252.1722 12.534436 227.7661 276.6938
[162,] 261.6687 10.795162 240.2975 283.0182
[163,] 271.1652  9.356145 252.4291 289.5039
[164,] 280.6618  8.373640 264.1187 297.2796
[165,] 290.1583  8.017278 274.4965 306.1188
[166,] 299.6548  8.367444 283.5110 316.9005
[167,] 309.1513  9.345052 291.1509 327.9713
[168,] 318.6478 10.780740 297.8074 340.4237
[169,] 328.1444 12.517875 303.5246 353.1074
[170,] 337.6409 14.448132 309.3011 366.3691
[171,] 263.6493 12.117900 240.0486 287.5618
[172,] 275.4428 10.485720 255.3487 296.2952
[173,] 287.2363  9.150847 269.1551 305.3453
[174,] 299.0298  8.258724 282.5328 315.1829
[175,] 310.8233  7.959641 294.8595 326.5505
[176,] 322.6168  8.317818 305.9409 339.2979
[177,] 334.4103  9.257276 315.7628 352.7655
[178,] 346.2038 10.624927 325.0554 367.0876
[179,] 357.9973 12.278511 333.5389 382.3860
[180,] 369.7908 14.117912 341.7494 397.7292</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.16661337 13.371052  -30.36519062  21.8524255
  [2,]  -14.67004015 11.439892  -37.30868951   7.5463657
  [3,]  -42.22226693  9.785737  -61.36556074 -23.1970829
  [4,]    8.76880629  8.570509   -7.82161408  25.2858646
  [5,]   24.53277951  7.996875    8.86155687  40.1491811
  [6,]   62.72285273  8.200600   46.72468385  78.9412976
  [7,]   10.58842595  9.129792   -6.72351509  28.6971940
  [8,] -101.11490083 10.595273 -121.09265132 -79.7061421
  [9,]   19.67367239 12.408462   -4.24877879  44.6310070
 [10,]   35.79374561 14.438957    7.51620086  64.7119229
 [11,]   11.18418371 13.148866  -13.66804691  37.6262673
 [12,]   -8.04638126 11.268842  -29.51187986  14.5528023
 [13,]  -12.09684622  9.663131  -30.88278185   7.1426560
 [14,]  -12.13011118  8.488853  -28.91328062   4.6201544
 [15,]  -10.88347615  7.939795  -26.14504528   4.6639024
 [16,]   -4.40024111  8.143419  -20.34961407  11.4155629
 [17,]   -8.49420608  9.049055  -26.13631160   8.9568871
 [18,]   -6.15977104 10.476199  -26.71627078  14.6455466
 [19,]   -1.35373601 12.243826  -24.89546598  22.9248867
 [20,]    9.90229903 14.225577  -17.29260687  38.1951581
 [21,]  -14.00849787 13.294128  -38.99778987  12.2816548
 [22,]  -23.63144433 11.381946  -44.87737506  -0.7838564
 [23,]   11.45510922  9.736800   -7.15162025  31.0066115
 [24,]    5.07546276  8.514901  -11.98430874  22.1746466
 [25,]   -3.35998370  7.914766  -19.10860084  12.3680692
 [26,]  -17.11073016  8.076212  -33.03620998  -1.0789741
 [27,]   -7.04907662  8.958157  -24.65715026  10.7209373
 [28,]    8.37997693 10.378520  -11.50259124  29.0997687
 [29,]    8.74013047 12.149917  -14.57854594  33.3354655
 [30,]   -9.65831599 14.141039  -36.79044024  18.4946438
 [31,]   47.04350233 13.426758   20.10462063  72.8363889
 [32,]   20.14884824 11.518135   -2.67528095  42.5310772
 [33,]   -2.14710586  9.882550  -21.88229919  17.3590912
 [34,]   -6.62285995  8.675821  -23.45216561  10.7400248
 [35,]  -11.71081405  8.092136  -27.34710467   4.8693143
 [36,]   -5.67486814  8.264575  -21.46677370  11.1026441
 [37,]  -28.77302223  9.150490  -46.23114288 -10.6082803
 [38,]    3.49642367 10.572012  -16.96693934  24.1667276
 [39,]  -15.16763042 12.345491  -39.11378518   9.0857456
 [40,]   27.77931548 14.340941    0.26857094  55.6026290
 [41,]   14.77132780 13.209172  -11.34582721  39.6484573
 [42,]    4.64368647 11.354374  -17.66403424  26.2393429
 [43,]   13.94454515  9.776512   -5.03469996  32.7040937
 [44,]   24.71950383  8.628867    8.05848306  41.4222394
 [45,]   13.36176250  8.096500   -2.47779578  29.2234563
 [46,]  -17.11657882  8.298677  -33.28455989  -0.9284007
 [47,]  -27.88002014  9.187033  -45.74849248 -10.0407891
 [48,]    9.34293853 10.590274  -11.40238750  30.2111871
 [49,]  -39.24760279 12.333897  -63.09546578 -15.1341068
 [50,]   31.06685589 14.293876    3.21566888  59.2038571
 [51,]  -25.29324422 12.228782  -48.80934027  -2.1440191
 [52,]  -27.61523067 10.501504  -47.80068749  -7.9385555
 [53,]   -7.73891712  9.069737  -25.05541650   9.3812389
 [54,]   18.79539642  8.091894    3.41498819  34.0953376
 [55,]   16.21630997  7.741927    1.04009298  30.9821146
 [56,]   -1.52217648  8.101615  -17.43470209  14.1337392
 [57,]  132.36893706  9.087078  114.73169452 149.5584819
 [58,]   14.76495061 10.523966   -5.16372462  34.8890072
 [59,]  -12.03903584 12.254501  -35.52958704  11.3464235
 [60,]  -98.74812230 14.171514 -125.99457067 -71.3098352
 [61,]   16.14910213 12.622700   -8.86207444  40.1296337
 [62,]   11.50137049 10.810362   -9.94958518  31.9275514
 [63,]  -11.64466115  9.291471  -29.84744932   6.0862924
 [64,]    1.03540721  8.230132  -15.20127500  16.7977844
 [65,]  -11.96362443  7.815040  -27.60436844   3.4457901
 [66,]   18.67154393  8.145597    2.72277777  34.3359604
 [67,]    2.17121228  9.141269  -16.21369836  19.8760533
 [68,]    8.62428064 10.616542  -13.12378753  29.3240696
 [69,]  -17.21595100 12.401422  -42.20242466   7.1600110
 [70,]    1.10651736 14.381088  -27.47727901  29.2296230
 [71,]   21.21119264 12.283749   -2.14282251  45.9891226
 [72,]   20.42604713 10.583014    0.04929125  41.6653427
 [73,]  -23.92369837  9.184461  -41.69849607  -5.4970257
 [74,]  -24.12934388  8.243354  -39.74997581  -7.7645609
 [75,]  -11.29048938  7.924385  -26.27784910   4.2588109
 [76,]  -17.63693489  8.299597  -33.52190492  -1.6757810
 [77,]   -7.81658039  9.285213  -25.72294975  10.2630733
 [78,]    6.66827410 10.714079  -14.24699237  27.7259897
 [79,]   -0.62097140 12.434316  -24.72704585  23.9522125
 [80,]   29.41788309 14.341457    1.64447224  57.7988270
 [81,]   -9.16820409 13.504469  -36.33586007  16.7790279
 [82,]   23.42054257 11.513576    0.64638249  45.2959669
 [83,]    4.21388924  9.804619  -14.89803476  22.8350896
 [84,]   20.77513590  8.548395    4.27462938  36.8672314
 [85,]    1.67478257  7.962157  -13.99266397  17.2291449
 [86,]    5.10892924  8.191044  -10.89130003  21.0009791
 [87,]   -3.82512410  9.174250  -21.86937117  14.0222475
 [88,]  -13.71657743 10.705928  -35.21913930   7.0932490
 [89,]  -13.02363077 12.587426  -38.21226019  11.7201963
 [90,]  -11.28128410 14.684894  -40.50234025  17.4100810
 [91,]   26.31602360 13.332673   -0.44625288  51.8245971
 [92,]    8.62296271 11.388495  -14.03291542  30.2972606
 [93,]  -32.70389818  9.723114  -51.71620696 -14.4410205
 [94,]    2.67484093  8.501972  -13.91447251  19.1758545
 [95,]    3.15278004  7.932943  -12.42577010  18.6715568
 [96,]   10.12661916  8.153718   -5.93600556  25.8727897
 [97,]    3.41595827  9.107036  -14.50161301  20.9521702
 [98,]   -3.28410262 10.597007  -23.71366965  17.4749467
 [99,]   16.75563649 12.432156   -6.66231401  41.3621556
[100,]    0.67577560 14.481847  -27.18040600  29.1494079
[101,]    9.58187969 13.472583  -16.08911048  36.0503940
[102,]   -7.77888202 11.537986  -29.97119552  15.3002226
[103,]  -10.74424373  9.874241  -29.68073539   8.9526533
[104,]   -6.32210544  8.639274  -23.15328420  10.4653344
[105,]  -22.10806716  8.033329  -38.00000770  -6.4890953
[106,]  -14.61822887  8.197108  -30.85631770   1.1193084
[107,]  -14.40209058  9.089097  -32.62000545   3.5222281
[108,]    0.56084771 10.525762  -20.64936738  21.0429435
[109,]   17.16518600 12.317977   -7.61066029  40.7888698
[110,]   20.95542429 14.332981   -7.97581462  48.3200777
[111,]   17.65885313 13.297607   -7.89173361  45.4100057
[112,]  -12.22393395 11.387555  -34.17970818  11.6614757
[113,]  -16.51392103  9.761299  -35.40046168   3.5297723
[114,]  -34.23170810  8.581724  -51.04635401 -17.0822036
[115,]  -37.88259518  8.047704  -53.39765586 -21.9107505
[116,]    5.88531774  8.285022  -10.46204832  21.8573105
[117,]   38.56483066  9.234400   20.38137346  56.3547660
[118,]    4.99844359 10.708090  -16.27096021  25.4829839
[119,]   19.52695651 12.522329   -5.64565587  43.5944337
[120,]   -2.94783057 14.550284  -32.31538203  25.1216493
[121,]   -4.87118126 12.623761  -29.89214887  19.7888481
[122,]   37.14656218 10.824418   15.65694621  58.2543873
[123,]   -0.53049438  9.298561  -19.21065990  17.3845127
[124,]    2.65134905  8.200303  -13.07514322  18.5522406
[125,]  -13.62370751  7.714482  -28.75717682   1.5902199
[126,]   11.66913593  7.954120   -3.92191725  27.4236142
[127,]  -12.73122063  8.860550  -30.15168193   4.4949644
[128,]  -41.39567719 10.258518  -61.61334151 -21.4477273
[129,]    6.03726625 11.977126  -17.40249501  29.3655414
[130,]   24.54760969 13.897930   -2.56617073  51.3395536
[131,]  -50.11246692 12.664013  -75.66326724 -26.6179138
[132,]   12.34153689 10.897515   -9.36865847  32.7571240
[133,]   26.96334070  9.410616    8.43399882  44.9313421
[134,]   32.87754451  8.353967   16.50264102  49.3131349
[135,]   20.69944832  7.902094    5.05892080  36.4434856
[136,]   10.72515213  8.156141   -5.44078094  27.0455135
[137,]   -1.73974406  9.056899  -19.84618493  16.4326179
[138,]   -9.79654025 10.438268  -31.01896896  10.8385296
[139,]   -8.65133644 12.137244  -33.28990027  15.1678068
[140,]   -9.81303263 14.038988  -37.99339197  17.6421224
[141,]   17.34982575 12.191314   -6.49820941  41.7275427
[142,]    2.48379148 10.475483  -17.95199755  23.4307040
[143,]  -20.09014280  9.045593  -37.58257437  -2.1975162
[144,]  -11.05537708  8.055384  -26.44729587   4.5443333
[145,]   14.73078864  7.676918   -0.05515888  29.7169967
[146,]    5.74265437  7.997521   -9.75341054  21.4926613
[147,]  -24.71497991  8.942318  -42.36081921  -6.9709947
[148,]   13.89318581 10.341623   -6.28366542  34.8257289
[149,]   -5.32914847 12.037969  -28.52320123  18.9293794
[150,]    9.52451725 13.923205  -17.32060007  37.1505307
[151,]   -1.52920479 13.441428  -26.46947870  25.6465424
[152,]   -7.37746527 11.515498  -29.28095609  15.7133954
[153,]  -18.10792576  9.858347  -37.10075633   1.7194599
[154,]  -31.64348625  8.626295  -48.20714067 -14.6641235
[155,]  -19.68694674  8.017765  -35.40623976  -4.0253010
[156,]   41.86169277  8.173236   25.84952396  58.0293187
[157,]  -36.29166772  9.053433  -54.09734918 -18.7115155
[158,]   15.03797179 10.477269   -5.77522033  35.1934141
[159,]   17.50771131 12.256724   -6.26152382  40.7843834
[160,]    9.46575082 14.259280  -18.02430073  37.1270214
[161,]   17.70819781 12.534436   -6.81344118  42.1143221
[162,]   10.77407827 10.795162  -10.57543355  32.1452843
[163,]    6.73365873  9.356145  -11.60504568  25.4697785
[164,]    1.12773919  8.373640  -15.49013082  17.6708075
[165,]  -10.98778035  8.017278  -26.94832966   4.6740302
[166,]  -15.14279989  8.367444  -32.38853875   1.0009611
[167,]  -49.88551943  9.345052  -68.70549893 -31.8850621
[168,]  -14.01723897 10.780740  -35.79310967   6.8231903
[169,]   22.63634149 12.517875   -2.32669911  47.2560776
[170,]   31.82832195 14.448132    3.10013345  60.1680860
[171,]    5.76242373 12.117900  -18.15012369  29.3631060
[172,]   -1.96878172 10.485720  -22.82120173  18.1252919
[173,]   10.36051283  9.150847   -7.74851651  28.4416842
[174,]   11.60180739  8.258724   -4.55127918  28.0987558
[175,]  -23.65069806  7.959641  -39.37791918  -7.6868887
[176,]    6.99079649  8.317818   -9.69028010  23.6666605
[177,]    0.07149104  9.257276  -18.28367514  18.7190176
[178,]   -2.98391440 10.624927  -23.86774320  18.1644783
[179,]   11.14438015 12.278511  -13.24432692  35.6027799
[180,]   -5.66722530 14.117912  -33.60557115  22.3741725</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.6  3.3
looic      1770.3 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1348      
 (0.5, 0.7]   (ok)         2    1.1%   159       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.6 22.0
p_loo        33.3  8.0
looic      1721.2 43.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   850       
 (0.5, 0.7]   (ok)         5    2.8%   520       
   (0.7, 1]   (bad)        3    1.7%   29        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.5      11.3  
fit_sleep1 -92.6      20.7  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.6  3.3
looic      1770.3 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1348      
 (0.5, 0.7]   (ok)         2    1.1%   159       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.6 22.0
p_loo        33.3  8.0
looic      1721.2 43.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   850       
 (0.5, 0.7]   (ok)         5    2.8%   520       
   (0.7, 1]   (bad)        3    1.7%   29        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.6     22.0        33.3    8.0   1721.2
fit_sleep2  -24.5      11.3  -885.2     14.4        19.6    3.3   1770.3
fit_sleep1  -92.6      20.7  -953.2     10.5         3.1    0.5   1906.4
           se_looic
fit_sleep3   43.9  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.034020e-41 2.183321e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.85      1.56     0.26     5.43       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.15      1.56    -3.28     2.91       5.38      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0.1       tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
