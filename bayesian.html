<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.47      6.78    15.47    42.29 1.00     1931     2563
sd(Days)                6.48      1.48     4.11     9.87 1.00     1541     2003
cor(Intercept,Days)     0.10      0.30    -0.48     0.69 1.01      913     1372

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.07      7.30   237.00   265.83 1.00     2026     2574
Days         10.45      1.68     7.22    13.95 1.00     1485     1979

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.98      1.58    23.15    29.25 1.00     3252     3010

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.2608  13.27807 227.6575 279.7430
309 211.5332  13.94333 184.3137 238.3534
310 213.0925  13.22393 186.0393 238.6781
330 273.8543  13.12171 248.5109 300.1839
331 272.6169  13.13301 246.7492 298.5278
332 260.1021  12.24750 236.3940 284.8300
333 267.7038  12.39123 244.0382 292.6056
334 244.3693  12.07560 221.0108 267.4891
335 250.1588  13.85089 224.5613 277.7408
337 285.4485  13.24985 260.5707 311.5546
349 226.9234  13.23819 199.9445 251.6130
350 239.0711  13.22669 212.6108 263.2813
351 255.7604  12.22822 232.2139 279.8350
352 271.7468  12.73624 246.9133 297.3911
369 254.8496  12.36754 231.0690 279.2998
370 226.8348  13.57541 199.5131 252.2235
371 251.8541  12.25248 227.9433 276.1080
372 263.5299  12.24372 239.4483 288.0135

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5217557  2.531468 14.6384435 24.623539
309  1.7805585  2.608068 -3.2432111  6.936258
310  4.8978141  2.493850  0.0744115  9.916349
330  5.8785982  2.466731  0.8999781 10.719291
331  7.5462781  2.473788  2.6242356 12.310733
332 10.2374098  2.326798  5.5916181 14.626064
333 10.3065934  2.377680  5.4689960 14.830989
334 11.5004067  2.352389  6.9530701 16.287436
335 -0.1532823  2.629009 -5.5061299  4.827109
337 19.2380935  2.524902 14.1882165 24.237186
349 11.5333238  2.515973  6.7629062 16.361060
350 16.9307055  2.513348 12.2882698 21.901395
351  7.5288195  2.366076  2.8809395 12.124511
352 14.0915898  2.421015  9.2092884 18.766509
369 11.3386334  2.346497  6.7238616 15.947808
370 15.1119572  2.576152 10.1533077 20.268536
371  9.4916249  2.381855  4.7569071 14.191763
372 11.8208340  2.319089  7.2959401 16.356962</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.2608 13.278072 227.6575 279.7430
  [2,] 273.7826 11.344471 251.2740 295.5117
  [3,] 293.3043  9.690382 273.9853 312.0971
  [4,] 312.8261  8.480957 296.1581 329.3131
  [5,] 332.3478  7.922527 317.2574 347.9900
  [6,] 351.8696  8.150024 336.1542 368.0157
  [7,] 371.3913  9.104724 353.6794 389.5568
  [8,] 390.9131 10.591779 370.2346 411.8447
  [9,] 410.4348 12.421442 386.3175 434.7190
 [10,] 429.9566 14.464277 402.0977 458.6187
 [11,] 211.5332 13.943328 184.3137 238.3534
 [12,] 213.3138 11.921286 189.7792 236.5429
 [13,] 215.0944 10.169650 194.6415 234.7351
 [14,] 216.8749  8.850455 199.5296 234.0879
 [15,] 218.6555  8.175779 202.6202 234.8252
 [16,] 220.4360  8.304228 204.1869 236.9541
 [17,] 222.2166  9.202233 204.0994 240.6399
 [18,] 223.9971 10.677361 202.5499 245.3688
 [19,] 225.7777 12.527370 201.0936 250.9221
 [20,] 227.5583 14.610545 198.7546 256.8731
 [21,] 213.0925 13.223934 186.0393 238.6781
 [22,] 217.9903 11.352187 195.0107 240.4333
 [23,] 222.8881  9.762708 203.2163 242.2810
 [24,] 227.7860  8.613207 210.8346 244.7945
 [25,] 232.6838  8.093379 216.6529 248.4104
 [26,] 237.5816  8.322068 221.3869 253.9263
 [27,] 242.4794  9.243886 224.8322 260.6827
 [28,] 247.3772 10.680852 227.0448 268.1944
 [29,] 252.2750 12.455937 228.1297 276.2959
 [30,] 257.1728 14.445023 229.5442 285.2346
 [31,] 273.8543 13.121707 248.5109 300.1839
 [32,] 279.7329 11.256442 258.3573 302.4763
 [33,] 285.6115  9.664641 267.1887 305.0262
 [34,] 291.4901  8.501330 274.5724 308.3547
 [35,] 297.3687  7.956725 281.2980 313.1239
 [36,] 303.2473  8.155725 286.7844 319.3148
 [37,] 309.1259  9.049406 291.1555 326.6868
 [38,] 315.0045 10.461222 294.2196 335.3668
 [39,] 320.8831 12.212784 296.7221 344.9167
 [40,] 326.7617 14.178736 298.7204 354.6858
 [41,] 272.6169 13.133009 246.7492 298.5278
 [42,] 280.1632 11.279825 257.8178 302.2628
 [43,] 287.7094  9.707328 268.0559 306.5098
 [44,] 295.2557  8.571420 278.0749 311.6898
 [45,] 302.8020  8.058879 286.9178 318.2550
 [46,] 310.3483  8.286197 294.6381 326.0875
 [47,] 317.8946  9.198688 300.0926 335.8496
 [48,] 325.4408 10.621202 304.6365 346.3625
 [49,] 332.9871 12.379145 309.0082 357.5602
 [50,] 340.5334 14.349767 312.3559 368.5830
 [51,] 260.1021 12.247499 236.3940 284.8300
 [52,] 270.3395 10.576625 249.5580 291.4558
 [53,] 280.5769  9.195473 261.8957 298.8156
 [54,] 290.8143  8.250844 274.2011 307.3986
 [55,] 301.0517  7.900894 285.6369 316.5255
 [56,] 311.2891  8.221909 295.1782 327.1702
 [57,] 321.5265  9.143491 303.9223 339.4224
 [58,] 331.7639 10.508808 311.3470 351.9648
 [59,] 342.0014 12.169415 318.1081 365.5308
 [60,] 352.2388 14.020778 324.6653 379.1553
 [61,] 267.7038 12.391233 244.0382 292.6056
 [62,] 278.0104 10.678670 257.5482 299.2545
 [63,] 288.3170  9.264559 270.1023 306.8268
 [64,] 298.6236  8.302822 282.1057 315.3310
 [65,] 308.9301  7.959170 293.2884 324.3749
 [66,] 319.2367  8.310634 302.6982 335.4299
 [67,] 329.5433  9.278557 311.0794 347.6843
 [68,] 339.8499 10.696884 318.9930 360.6909
 [69,] 350.1565 12.412162 325.9826 374.2365
 [70,] 360.4631 14.318064 332.3519 388.1510
 [71,] 244.3693 12.075602 221.0108 267.4891
 [72,] 255.8697 10.418139 235.1840 276.1753
 [73,] 267.3701  9.073176 249.3292 285.1166
 [74,] 278.8705  8.196030 263.0037 295.1236
 [75,] 290.3709  7.943222 275.1065 305.9990
 [76,] 301.8713  8.371505 285.6800 318.3554
 [77,] 313.3717  9.388124 295.2147 332.0698
 [78,] 324.8721 10.828626 303.8195 346.4231
 [79,] 336.3725 12.547863 312.0727 361.1995
 [80,] 347.8729 14.446662 319.9699 376.2348
 [81,] 250.1588 13.850895 224.5613 277.7408
 [82,] 250.0055 11.825523 227.8819 274.1198
 [83,] 249.8522 10.082763 230.7206 270.3077
 [84,] 249.6989  8.792303 232.6014 267.5892
 [85,] 249.5457  8.171319 233.5848 266.0359
 [86,] 249.3924  8.370167 233.0048 265.9900
 [87,] 249.2391  9.336612 230.9675 267.3300
 [88,] 249.0858 10.867766 228.2321 270.5029
 [89,] 248.9325 12.761964 224.4928 273.8893
 [90,] 248.7793 14.881213 219.8854 277.4371
 [91,] 285.4485 13.249847 260.5707 311.5546
 [92,] 304.6866 11.320223 283.2433 327.0538
 [93,] 323.9246  9.668852 305.5585 342.9513
 [94,] 343.1627  8.460273 326.9968 359.4650
 [95,] 362.4008  7.900380 346.9108 377.9135
 [96,] 381.6389  8.124410 365.7927 397.4085
 [97,] 400.8770  9.074488 383.1348 418.4510
 [98,] 420.1151 10.556368 399.4937 440.9262
 [99,] 439.3532 12.380538 415.4817 463.7515
[100,] 458.5913 14.417656 430.2846 487.0259
[101,] 226.9234 13.238194 199.9445 251.6130
[102,] 238.4567 11.348474 215.2512 259.6211
[103,] 249.9900  9.746085 230.0696 268.7846
[104,] 261.5233  8.593296 244.2724 278.3743
[105,] 273.0567  8.084771 256.9693 288.8215
[106,] 284.5900  8.339217 267.8217 300.3585
[107,] 296.1233  9.294181 277.6970 313.5613
[108,] 307.6566 10.764818 286.2281 328.1274
[109,] 319.1899 12.571437 294.3747 343.4707
[110,] 330.7233 14.589757 302.1094 358.5446
[111,] 239.0711 13.226689 212.6108 263.2813
[112,] 256.0018 11.325268 233.4698 276.8957
[113,] 272.9325  9.706284 253.5852 291.4245
[114,] 289.8633  8.532060 273.2764 306.7787
[115,] 306.7940  8.000874 291.2801 322.8915
[116,] 323.7247  8.238067 307.9795 340.0809
[117,] 340.6554  9.184300 322.7405 358.9710
[118,] 357.5861 10.652268 337.1809 378.9523
[119,] 374.5168 12.458897 350.6771 398.8667
[120,] 391.4475 14.477957 363.9478 419.7910
[121,] 255.7604 12.228218 232.2139 279.8350
[122,] 263.2892 10.525601 243.0225 284.0037
[123,] 270.8181  9.123808 253.4238 288.6222
[124,] 278.3469  8.179004 262.6364 294.1546
[125,] 285.8757  7.857797 271.0095 301.1989
[126,] 293.4045  8.233497 277.8026 309.8683
[127,] 300.9333  9.221312 283.1529 319.2184
[128,] 308.4622 10.652293 287.5106 329.8426
[129,] 315.9910 12.373631 291.6123 340.5775
[130,] 323.5198 14.280713 295.4969 351.6924
[131,] 271.7468 12.736242 246.9133 297.3911
[132,] 285.8384 10.952634 264.6744 307.8949
[133,] 299.9300  9.456806 281.0962 318.9189
[134,] 314.0216  8.403855 297.3630 330.6087
[135,] 328.1132  7.971261 311.8906 343.7015
[136,] 342.2048  8.257109 325.6201 358.4545
[137,] 356.2964  9.194636 337.9878 374.3347
[138,] 370.3879 10.612513 349.3259 391.2916
[139,] 384.4795 12.346342 359.3433 408.9609
[140,] 398.5711 14.281510 369.3538 426.7570
[141,] 254.8496 12.367541 231.0690 279.2998
[142,] 266.1882 10.678139 245.8700 287.3471
[143,] 277.5268  9.279080 259.6540 295.5663
[144,] 288.8655  8.318179 272.5953 305.5570
[145,] 300.2041  7.955814 284.6789 316.0100
[146,] 311.5427  8.271030 295.0093 327.7962
[147,] 322.8814  9.194400 304.6659 340.7919
[148,] 334.2200 10.567693 313.5455 354.6573
[149,] 345.5586 12.240399 321.7689 369.0738
[150,] 356.8973 14.106406 329.3599 384.0469
[151,] 226.8348 13.575408 199.5131 252.2235
[152,] 241.9468 11.584188 218.8244 263.8646
[153,] 257.0587  9.867534 237.4552 275.4275
[154,] 272.1707  8.591633 255.2173 288.7504
[155,] 287.2826  7.971024 271.9308 303.0715
[156,] 302.3946  8.156679 286.5165 319.0650
[157,] 317.5066  9.099380 299.8005 335.2707
[158,] 332.6185 10.599016 311.9162 353.2553
[159,] 347.7305 12.456030 323.9911 371.5694
[160,] 362.8424 14.534076 334.6044 390.3753
[161,] 251.8541 12.252483 227.9433 276.1080
[162,] 261.3457 10.538173 240.8060 282.3460
[163,] 270.8373  9.128488 252.9469 288.7689
[164,] 280.3290  8.182418 263.9692 296.1442
[165,] 289.8206  7.868995 274.0721 305.1341
[166,] 299.3122  8.260550 283.1944 315.3800
[167,] 308.8038  9.268157 290.5535 327.0496
[168,] 318.2955 10.719480 297.1359 339.0478
[169,] 327.7871 12.460427 303.2675 352.2407
[170,] 337.2787 14.386232 308.8033 365.4380
[171,] 263.5299 12.243718 239.4483 288.0135
[172,] 275.3507 10.564642 254.9308 296.4427
[173,] 287.1716  9.169026 269.4629 305.4427
[174,] 298.9924  8.202851 283.0621 315.6117
[175,] 310.8132  7.826801 295.3711 326.4202
[176,] 322.6341  8.123252 306.4353 338.7751
[177,] 334.4549  9.026183 317.3044 352.4791
[178,] 346.2757 10.378491 326.0091 367.0102
[179,] 358.0966 12.029569 334.6365 382.1997
[180,] 369.9174 13.873151 342.9843 397.0961</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.70080219 13.278072  -30.18296525  21.9024893
  [2,]  -15.07785787 11.344471  -36.80699859   7.4307405
  [3,]  -42.50371355  9.690382  -61.29646325 -23.1847275
  [4,]    8.61373076  8.480957   -7.87330197  25.2817416
  [5,]   24.50407508  7.922527    8.86192877  39.5944590
  [6,]   62.82051940  8.150024   46.67439068  78.5358921
  [7,]   10.81246372  9.104724   -7.35297218  28.5244345
  [8,] -100.76449196 10.591779 -121.69611026 -80.0860056
  [9,]   20.15045236 12.421442   -4.13368505  44.2677564
 [10,]   36.39689667 14.464277    7.73475790  64.2558139
 [11,]   11.20066577 13.943328  -15.61951034  38.4202039
 [12,]   -8.04799276 11.921286  -31.27708118  15.4865928
 [13,]  -12.11655128 10.169650  -31.75730992   8.3362807
 [14,]  -12.16790981  8.850455  -29.38086157   5.1774296
 [15,]  -10.93936834  8.175779  -27.10906988   5.0959294
 [16,]   -4.47422687  8.304228  -20.99228658  11.7749011
 [17,]   -8.58628539  9.202233  -27.00964879   9.5309076
 [18,]   -6.26994392 10.677361  -27.64158184  15.1773393
 [19,]   -1.48200245 12.527370  -26.62642983  23.2021427
 [20,]    9.75593902 14.610545  -19.55890713  38.5595993
 [21,]  -14.03861053 13.223934  -39.62424035  13.0145759
 [22,]  -23.65812467 11.352187  -46.10109332  -0.6784892
 [23,]   11.43186119  9.762708   -7.96098184  31.1036656
 [24,]    5.05564704  8.613207  -11.95285455  22.0069915
 [25,]   -3.37636710  8.093379  -19.10299214  12.6544584
 [26,]  -17.12368124  8.322068  -33.46844237  -0.9290220
 [27,]   -7.05859539  9.243886  -25.26187596  10.5886422
 [28,]    8.37389047 10.680852  -12.44328328  28.7062822
 [29,]    8.73747633 12.455937  -15.28340955  32.8827600
 [30,]   -9.65753782 14.445023  -37.71926493  17.9711489
 [31,]   47.68828283 13.121707   21.35865464  73.0317268
 [32,]   20.66728464 11.256442   -2.07609963  42.0429460
 [33,]   -1.75501354  9.664641  -21.16969987  16.6678445
 [34,]   -6.35711173  8.501330  -23.22172123  10.5605998
 [35,]  -11.57140991  7.956725  -27.32662232   4.4992588
 [36,]   -5.66180810  8.155725  -21.72933212  10.8010684
 [37,]  -28.88630629  9.049406  -46.44720764 -10.9158726
 [38,]    3.25679553 10.461222  -17.10547115  24.0416926
 [39,]  -15.53360266 12.212784  -39.56723691   8.6273874
 [40,]   27.28699916 14.178736   -0.63711666  55.3282624
 [41,]   14.99101185 13.133009  -10.91992358  40.8587477
 [42,]    4.83683376 11.279825  -17.26275802  27.1822099
 [43,]   14.11115567  9.707328   -4.68919907  33.7647416
 [44,]   24.85957757  8.571420    8.42551150  42.0404143
 [45,]   13.47529948  8.058879   -1.97769901  29.3594560
 [46,]  -17.02957861  8.286197  -32.76879163  -1.3194342
 [47,]  -27.81955671  9.198688  -45.77464852 -10.0175815
 [48,]    9.37686520 10.621202  -11.54478934  30.1812204
 [49,]  -39.24021289 12.379145  -63.81334799 -15.2612750
 [50,]   31.04770902 14.349767    2.99814067  59.2251512
 [51,]  -25.24147837 12.247499  -49.96944642  -1.5334496
 [52,]  -27.52768814 10.576625  -48.64399684  -6.7462015
 [53,]   -7.61559790  9.195473  -25.85433791  11.0656458
 [54,]   18.95449233  8.250844    2.37019077  35.5676831
 [55,]   16.41118257  7.900894    0.93739386  31.8259527
 [56,]   -1.29152720  8.221909  -17.17258592  14.8194495
 [57,]  132.63536304  9.143491  114.73954055 150.2396485
 [58,]   15.06715327 10.508808   -5.13373453  35.4841273
 [59,]  -11.70105650 12.169415  -35.23054713  12.1922357
 [60,]  -98.37436626 14.020778 -125.29086560 -70.8009010
 [61,]   16.13862795 12.391233   -8.76319732  39.8041980
 [62,]   11.54463454 10.678670   -9.69945974  32.0068002
 [63,]  -11.54765887  9.264559  -30.05754801   6.6670484
 [64,]    1.18614772  8.302822  -15.52133561  17.7039961
 [65,]  -11.75914568  7.959170  -27.20394835   3.8825690
 [66,]   18.92976091  8.310634    2.73662420  35.4682674
 [67,]    2.48316750  9.278557  -15.65782480  20.9470935
 [68,]    8.98997409 10.696884  -11.85099411  29.8469308
 [69,]  -16.79651932 12.412162  -40.87651887   7.3774302
 [70,]    1.57968727 14.318064  -26.10817694  29.6908758
 [71,]   21.10381908 12.075602   -2.01596192  44.4623254
 [72,]   20.33151240 10.418139    0.02591836  41.0171879
 [73,]  -24.00539428  9.073176  -41.75194104  -5.9644693
 [74,]  -24.19820096  8.196030  -40.45125588  -8.3313645
 [75,]  -11.34650764  7.943222  -26.97460035   3.9178639
 [76,]  -17.68011432  8.371505  -34.16424926  -1.4888405
 [77,]   -7.84692100  9.388124  -26.54501886  10.3100857
 [78,]    6.65077233 10.828626  -14.90018139  27.7033738
 [79,]   -0.62563435 12.547863  -25.45259995  23.6741721
 [80,]   29.42605897 14.446662    1.06419448  57.3291077
 [81,]   -8.55049394 13.850895  -36.13253200  17.0470092
 [82,]   23.94168836 11.825523   -0.17262157  46.0652696
 [83,]    4.63847066 10.082763  -15.81702080  23.7701156
 [84,]   21.10315297  8.792303    3.21285811  38.2007209
 [85,]    1.90623527  8.171319  -14.58403343  17.8671235
 [86,]    5.24381757  8.370167  -11.35380840  21.6313801
 [87,]   -3.78680013  9.336612  -21.87768294  14.4847856
 [88,]  -13.77481783 10.867766  -35.19192821   7.0789319
 [89,]  -13.17843552 12.761964  -38.13522517  11.2612694
 [90,]  -11.53265322 14.881213  -40.19049725  17.3612019
 [91,]   26.91814273 13.249847    0.81195782  51.7959371
 [92,]    9.11924927 11.320223  -13.24795115  30.5625013
 [93,]  -32.31344418  9.668852  -51.34007557 -13.9473008
 [94,]    2.95946236  8.460273  -13.34281385  19.1253941
 [95,]    3.33156891  7.900380  -12.18112379  18.8216424
 [96,]   10.19957545  8.124410   -5.57002776  26.0458358
 [97,]    3.38308200  9.074488  -14.19094736  21.1253398
 [98,]   -3.42281146 10.556368  -24.23388242  17.1986327
 [99,]   16.51109509 12.380538   -7.88717180  40.3826489
[100,]    0.32540163 14.417656  -28.10915343  28.6321334
[101,]    9.17984420 13.238194  -15.50984254  36.1587153
[102,]   -8.13997957 11.348474  -29.30440547  15.0654523
[103,]  -11.06440333  9.746085  -29.85899093   8.8559790
[104,]   -6.60132710  8.593296  -23.45231312  10.6496255
[105,]  -22.34635086  8.084771  -38.11115482  -6.2589569
[106,]  -14.81557463  8.339217  -30.58411492   1.9526919
[107,]  -14.55849839  9.294181  -31.99653310   3.8677634
[108,]    0.44537785 10.764818  -20.02543822  21.8738798
[109,]   17.09065408 12.571437   -7.19010645  41.9059131
[110,]   20.92183032 14.589757   -6.89947324  49.5357487
[111,]   17.22566233 13.226689   -6.98448984  43.6860479
[112,]  -12.54754318 11.325268  -33.44143288   9.9844626
[113,]  -16.72794870  9.706284  -35.21988050   2.6193653
[114,]  -34.33615422  8.532060  -51.25161651 -17.7492918
[115,]  -37.87745974  8.000874  -53.97504402 -22.3636318
[116,]    6.00003475  8.238067  -10.35618207  21.7452024
[117,]   38.78912923  9.184300   20.47347244  56.7039703
[118,]    5.33232371 10.652268  -16.03394490  25.7374542
[119,]   19.97041819 12.458897   -4.37953090  43.8100788
[120,]   -2.39478732 14.477957  -30.73826193  25.1049418
[121,]   -5.23392031 12.228218  -29.30853967  18.3125686
[122,]   36.76836019 10.525601   16.05385045  57.0351224
[123,]   -0.92415931  9.123808  -18.72834895  16.4701053
[124,]    2.24222120  8.179004  -13.56551587  17.9526875
[125,]  -14.04829830  7.857797  -29.37147590   0.8179128
[126,]   11.22908220  8.233497   -5.23469802  26.8310291
[127,]  -13.18673730  9.221312  -31.47181242   4.5937082
[128,]  -41.86665679 10.652293  -63.24705080 -20.9150801
[129,]    5.55082371 12.373631  -19.03569657  29.9294839
[130,]   24.04570421 14.280713   -4.12687349  52.0686061
[131,]  -50.06971504 12.736242  -75.71404291 -25.2362285
[132,]   12.35549517 10.952634   -9.70095615  33.5195089
[133,]   26.94850538  9.456806    7.95962267  45.7823123
[134,]   32.83391560  8.403855   16.24682679  49.4924926
[135,]   20.62702581  7.971261    5.03869745  36.8495591
[136,]   10.62393603  8.257109   -5.62579349  27.2086238
[137,]   -1.86975376  9.194636  -19.90808435  16.4387903
[138,]   -9.95534354 10.612513  -30.85895075  11.1066652
[139,]   -8.83893333 12.346342  -33.32027566  16.2972997
[140,]  -10.02942312 14.281510  -38.21533006  19.1878739
[141,]   17.07391986 12.367541   -7.37627886  40.8544507
[142,]    2.24868647 10.678139  -18.91019250  22.5668928
[143,]  -20.28444692  9.279080  -38.32394438  -2.4116188
[144,]  -11.20888031  8.318179  -27.90044696   5.0613455
[145,]   14.61808631  7.955814   -1.18779183  30.1432803
[146,]    5.67075292  8.271030  -10.58272408  22.2042361
[147,]  -24.74608047  9.194400  -42.65659604  -6.5305796
[148,]   13.90288614 10.567693   -6.53444184  34.5773815
[149,]   -5.27864724 12.240399  -28.79376574  18.5111398
[150,]    9.61581937 14.106406  -17.53379867  37.1531952
[151,]   -1.57080951 13.575408  -26.95946940  25.7508516
[152,]   -7.42326668 11.584188  -29.34111757  15.6990584
[153,]  -18.15792386  9.867534  -36.52674918   1.4455653
[154,]  -31.69768103  8.591633  -48.27739487 -14.7442845
[155,]  -19.74533820  7.971024  -35.53424078  -4.3935122
[156,]   41.79910463  8.156679   25.12874696  57.6772132
[157,]  -36.35845255  9.099380  -54.12260838 -18.6523557
[158,]   14.96699028 10.599016   -5.66978887  35.6693404
[159,]   17.43253311 12.456030   -6.40636903  41.1719446
[160,]    9.38637593 14.534076  -18.14645290  37.6244294
[161,]   18.02630796 12.252483   -6.22761846  41.9371040
[162,]   11.09708301 10.538173   -9.90318206  31.6367547
[163,]    7.06155807  9.128488  -10.87002900  24.9520145
[164,]    1.46053312  8.182418  -14.35473455  17.8203193
[165,]  -10.65009183  7.868995  -25.96361514   5.0984175
[166,]  -14.80021678  8.260550  -30.86799303   1.3176422
[167,]  -49.53804172  9.268157  -67.78375602 -31.2876956
[168,]  -13.66486667 10.719480  -34.41723650   7.4947216
[169,]   22.99360838 12.460427   -1.45999652  47.5132431
[170,]   32.19048343 14.386232    4.03121540  60.6659490
[171,]    5.88179661 12.243718  -18.60175327  29.9633741
[172,]   -1.87673737 10.564642  -22.96870537  18.5431742
[173,]   10.42522865  9.169026   -7.84591393  28.1339122
[174,]   11.63919467  8.202851   -4.98010625  27.5695255
[175,]  -23.64063932  7.826801  -39.24762494  -8.1985490
[176,]    6.97352670  8.123252   -9.16754449  23.1722735
[177,]    0.02689272  9.026183  -17.99731673  17.1774005
[178,]   -3.05584126 10.378491  -23.79030081  17.2107744
[179,]   11.04512475 12.029569  -13.05804210  34.5051550
[180,]   -5.79380923 13.873151  -32.97246610  21.1392912</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.4 14.1
p_loo        18.7  3.0
looic      1768.9 28.2
------
Monte Carlo SE of elpd_loo is 0.1.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.5 22.2
p_loo        34.0  8.3
looic      1722.9 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   1068      
 (0.5, 0.7]   (ok)         6    3.3%   64        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   2    1.1%   13        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.0      11.6  
fit_sleep1 -91.7      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.4 14.1
p_loo        18.7  3.0
looic      1768.9 28.2
------
Monte Carlo SE of elpd_loo is 0.1.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.5 22.2
p_loo        34.0  8.3
looic      1722.9 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   1068      
 (0.5, 0.7]   (ok)         6    3.3%   64        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   2    1.1%   13        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.5     22.2        34.0    8.3   1722.9
fit_sleep2  -23.0      11.6  -884.4     14.1        18.7    3.0   1768.9
fit_sleep1  -91.7      20.8  -953.2     10.5         3.1    0.5   1906.4
           se_looic
fit_sleep3   44.3  
fit_sleep2   28.2  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.423925e-40 1.061657e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.93      1.58     0.36     5.42       0.04      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.07      1.58     -3.2     2.95       5.12      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.1-0     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_5.0.0           compiler_4.2.2      
 [22] cli_3.6.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.5          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.20      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.1   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.4          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.12       yaml_2.3.7          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.20        V8_4.2.2            
 [88] RcppParallel_5.1.6   vctrs_0.5.2          nloptr_2.0.3        
 [91] httpuv_1.6.8         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
