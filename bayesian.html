<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.05      7.12    15.47    43.27 1.00     1837     2020
sd(Days)                6.53      1.48     4.20     9.86 1.00     1472     1993
cor(Intercept,Days)     0.07      0.30    -0.50     0.65 1.00     1019     1651

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.30      7.53   236.57   266.14 1.00     1689     2485
Days         10.42      1.68     7.12    13.78 1.00     1314     1939

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.55    23.11    29.25 1.00     3732     3084

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7425  13.06971 228.1669 279.4588
309 211.4319  12.99290 186.1262 236.8041
310 213.0296  13.51924 185.8297 238.8156
330 274.6864  13.49505 249.5720 302.0022
331 273.2431  13.01038 248.2812 299.3386
332 260.3048  11.91095 236.8007 283.9945
333 267.6573  12.68700 242.8510 292.8874
334 244.4177  11.88633 220.2005 267.6779
335 250.9801  13.47993 225.5578 278.6704
337 285.9905  13.11531 260.4442 311.5359
349 226.5508  12.80817 201.1256 251.2130
350 238.9455  13.46483 211.7083 264.0827
351 255.7218  12.37374 232.0002 280.3303
352 272.0583  12.71727 247.5913 297.5112
369 254.9040  12.15064 231.7744 279.2225
370 226.4994  13.28472 199.6699 252.1252
371 252.2010  11.91933 228.7046 275.9640
372 263.4498  12.32577 240.1995 288.2259

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6276925  2.493895 14.9183844 24.482712
309  1.7240100  2.446528 -3.1580299  6.572288
310  4.8971007  2.519686  0.1358299  9.983847
330  5.7072832  2.564360  0.5963937 10.595774
331  7.4516039  2.429087  2.5852280 12.213959
332 10.2252302  2.302743  5.5790324 14.699339
333 10.3456711  2.433699  5.5595827 15.154532
334 11.5098219  2.303711  6.9621770 16.125691
335 -0.2424454  2.562064 -5.4302675  4.604235
337 19.1428383  2.521816 14.1886285 24.115224
349 11.5538119  2.422014  6.9509396 16.496893
350 16.9918410  2.522202 12.2408896 22.054314
351  7.5351077  2.376856  2.7909064 12.178218
352 14.0496028  2.422617  9.0915759 18.736628
369 11.3109733  2.312644  6.7576578 15.744763
370 15.1784015  2.513400 10.3920929 20.174187
371  9.5185251  2.294199  5.0422607 14.218191
372 11.7501067  2.370446  6.9582451 16.332835</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7425 13.069712 228.1669 279.4588
  [2,] 273.3702 11.183063 251.0870 294.9438
  [3,] 292.9979  9.578281 273.6661 311.6678
  [4,] 312.6256  8.418139 295.8547 328.6441
  [5,] 332.2533  7.900993 316.8288 347.5227
  [6,] 351.8810  8.150174 336.0750 367.7244
  [7,] 371.5087  9.102966 353.4073 389.4248
  [8,] 391.1363 10.570794 370.2585 412.0620
  [9,] 410.7640 12.371678 386.3433 434.8434
 [10,] 430.3917 14.381034 402.2463 458.1529
 [11,] 211.4319 12.992904 186.1262 236.8041
 [12,] 213.1559 11.196332 191.3562 235.0815
 [13,] 214.8799  9.688712 195.9872 233.9222
 [14,] 216.6039  8.622960 199.3180 233.3525
 [15,] 218.3280  8.173784 202.3114 234.4843
 [16,] 220.0520  8.440204 203.3727 236.7621
 [17,] 221.7760  9.361322 203.3299 239.7559
 [18,] 223.5000 10.770453 202.3702 244.4640
 [19,] 225.2240 12.503678 200.6882 249.6875
 [20,] 226.9480 14.444801 198.7840 255.3041
 [21,] 213.0296 13.519236 185.8297 238.8156
 [22,] 217.9267 11.591476 194.8143 240.4055
 [23,] 222.8238  9.932397 203.4132 242.1521
 [24,] 227.7209  8.697145 210.9049 244.5023
 [25,] 232.6180  8.082437 217.2506 248.4360
 [26,] 237.5151  8.228541 221.7241 254.2345
 [27,] 242.4122  9.098879 224.5768 260.3802
 [28,] 247.3093 10.515130 226.3249 268.1554
 [29,] 252.2064 12.289993 227.5256 275.9329
 [30,] 257.1035 14.290471 228.4613 284.4393
 [31,] 274.6864 13.495049 249.5720 302.0022
 [32,] 280.3937 11.549406 258.5274 303.8745
 [33,] 286.1010  9.890050 267.6067 306.2281
 [34,] 291.8083  8.682700 274.9236 309.1781
 [35,] 297.5155  8.131258 281.8928 313.5422
 [36,] 303.2228  8.366440 287.1579 319.7924
 [37,] 308.9301  9.328942 291.1464 327.6951
 [38,] 314.6374 10.826490 293.3748 336.8161
 [39,] 320.3447 12.670774 295.6836 346.0747
 [40,] 326.0520 14.732142 297.2156 355.8029
 [41,] 273.2431 13.010383 248.2812 299.3386
 [42,] 280.6947 11.195044 259.4669 302.9277
 [43,] 288.1463  9.653439 269.9723 307.1986
 [44,] 295.5979  8.535202 279.2276 312.4235
 [45,] 303.0495  8.019439 287.3622 318.7588
 [46,] 310.5011  8.220344 294.2498 326.5650
 [47,] 317.9527  9.090524 299.9306 335.5635
 [48,] 325.4043 10.464327 304.5335 346.2741
 [49,] 332.8559 12.172410 309.3907 357.0184
 [50,] 340.3075 14.093754 312.8817 368.6029
 [51,] 260.3048 11.910950 236.8007 283.9945
 [52,] 270.5300 10.270208 250.1489 290.9288
 [53,] 280.7552  8.926862 262.6167 298.0884
 [54,] 290.9805  8.031550 274.7364 306.7013
 [55,] 301.2057  7.741317 285.3625 315.8886
 [56,] 311.4309  8.121295 295.0998 327.0394
 [57,] 321.6561  9.087801 303.9328 339.3365
 [58,] 331.8814 10.479793 311.5662 352.1429
 [59,] 342.1066 12.151924 318.7438 365.6065
 [60,] 352.3318 14.004203 325.4179 379.5256
 [61,] 267.6573 12.686996 242.8510 292.8874
 [62,] 278.0030 10.885603 256.8096 299.4125
 [63,] 288.3487  9.374361 270.2938 306.6234
 [64,] 298.6944  8.313045 282.2602 314.6420
 [65,] 309.0400  7.885466 293.2612 324.4868
 [66,] 319.3857  8.191472 303.1334 335.5385
 [67,] 329.7314  9.157818 311.7819 347.9876
 [68,] 340.0770 10.605510 319.6000 360.8055
 [69,] 350.4227 12.366642 326.6790 374.5306
 [70,] 360.7684 14.326081 333.3251 388.6948
 [71,] 244.4177 11.886326 220.2005 267.6779
 [72,] 255.9275 10.245205 235.3106 276.1634
 [73,] 267.4373  8.902690 249.4477 284.9070
 [74,] 278.9471  8.010351 262.8171 294.7521
 [75,] 290.4569  7.725783 275.3038 305.2202
 [76,] 301.9668  8.113192 285.7381 317.9277
 [77,] 313.4766  9.087036 295.1898 331.4487
 [78,] 324.9864 10.485167 303.8213 345.3588
 [79,] 336.4962 12.162130 312.0134 359.9456
 [80,] 348.0061 14.018211 319.7646 375.7514
 [81,] 250.9801 13.479931 225.5578 278.6704
 [82,] 250.7377 11.498715 228.7271 274.1721
 [83,] 250.4952  9.790849 231.8781 269.9290
 [84,] 250.2528  8.522285 234.0891 267.1711
 [85,] 250.0103  7.907358 234.8203 265.1986
 [86,] 249.7679  8.096396 233.9296 265.4667
 [87,] 249.5255  9.039098 231.8959 267.4978
 [88,] 249.2830 10.535051 228.9030 270.4322
 [89,] 249.0406 12.385381 224.8341 273.4459
 [90,] 248.7981 14.454631 220.1466 276.8711
 [91,] 285.9905 13.115306 260.4442 311.5359
 [92,] 305.1333 11.231901 282.9489 327.1145
 [93,] 324.2762  9.644638 305.3381 343.0932
 [94,] 343.4190  8.520657 326.6119 360.2945
 [95,] 362.5619  8.056257 346.5807 378.2879
 [96,] 381.7047  8.362061 365.3168 397.9135
 [97,] 400.8475  9.362904 382.6600 419.5190
 [98,] 419.9904 10.868440 398.5931 441.5670
 [99,] 439.1332 12.700438 413.9303 463.6923
[100,] 458.2760 14.737652 429.0612 486.6320
[101,] 226.5508 12.808174 201.1256 251.2130
[102,] 238.1046 10.990017 216.7849 259.3711
[103,] 249.6584  9.446901 231.1727 267.9997
[104,] 261.2122  8.333049 244.5392 277.4046
[105,] 272.7660  7.833758 257.2092 288.1156
[106,] 284.3199  8.064003 268.5168 300.1244
[107,] 295.8737  8.967765 278.4141 313.6805
[108,] 307.4275 10.370429 287.0247 328.1910
[109,] 318.9813 12.099714 295.1386 342.8559
[110,] 330.5351 14.035407 302.2332 358.2455
[111,] 238.9455 13.464831 211.7083 264.0827
[112,] 255.9374 11.515558 232.6696 277.8509
[113,] 272.9292  9.830436 253.2994 291.7004
[114,] 289.9210  8.566789 273.0676 306.4771
[115,] 306.9129  7.928764 291.6714 322.3691
[116,] 323.9047  8.066208 308.3559 339.3128
[117,] 340.8966  8.943441 323.2793 358.1172
[118,] 357.8884 10.374467 337.2212 377.3321
[119,] 374.8802 12.165401 350.4799 397.7120
[120,] 391.8721 14.180530 363.3970 418.6905
[121,] 255.7218 12.373739 232.0002 280.3303
[122,] 263.2569 10.654284 242.7269 284.8212
[123,] 270.7920  9.231305 252.7015 289.3656
[124,] 278.3271  8.259486 262.3315 295.1436
[125,] 285.8622  7.906966 270.8484 301.5529
[126,] 293.3974  8.253483 277.5615 309.5534
[127,] 300.9325  9.220562 282.9544 318.9761
[128,] 308.4676 10.640320 287.6004 329.4183
[129,] 316.0027 12.357708 291.8137 340.3664
[130,] 323.5378 14.265636 295.3229 351.3590
[131,] 272.0583 12.717268 247.5913 297.5112
[132,] 286.1079 10.942146 265.1391 307.7729
[133,] 300.1575  9.458878 282.0108 319.0661
[134,] 314.2071  8.423082 297.5156 331.1958
[135,] 328.2567  8.010269 312.4439 343.9126
[136,] 342.3063  8.313762 325.4462 358.6929
[137,] 356.3559  9.263423 337.9712 374.7259
[138,] 370.4055 10.688382 349.5454 391.7976
[139,] 384.4551 12.426189 360.2359 409.4682
[140,] 398.5047 14.363738 370.3796 427.6470
[141,] 254.9040 12.150644 231.7744 279.2225
[142,] 266.2149 10.474224 245.9221 286.7441
[143,] 277.5259  9.081698 259.7873 295.6611
[144,] 288.8369  8.120452 272.7950 304.9688
[145,] 300.1479  7.752606 284.5975 315.0902
[146,] 311.4588  8.059820 295.3406 327.0916
[147,] 322.7698  8.973023 304.9432 340.1986
[148,] 334.0808 10.332775 313.9168 354.2974
[149,] 345.3917 11.988076 321.8369 368.8933
[150,] 356.7027 13.833234 329.5803 383.7947
[151,] 226.4994 13.284715 199.6699 252.1252
[152,] 241.6778 11.354625 218.8651 263.3964
[153,] 256.8562  9.695654 237.4633 275.5617
[154,] 272.0346  8.468664 255.2326 288.4694
[155,] 287.2130  7.878146 271.6898 302.5807
[156,] 302.3914  8.065138 286.4400 318.4410
[157,] 317.5698  8.981207 300.1311 335.3296
[158,] 332.7482 10.436094 312.4738 353.2966
[159,] 347.9266 12.239134 324.3711 372.0120
[160,] 363.1050 14.258860 335.5163 391.1948
[161,] 252.2010 11.919329 228.7046 275.9640
[162,] 261.7195 10.291785 241.5877 282.0005
[163,] 271.2380  8.960915 253.9692 289.0248
[164,] 280.7565  8.074766 265.2328 296.9451
[165,] 290.2751  7.786681 275.2264 305.7173
[166,] 299.7936  8.160248 283.7777 315.3842
[167,] 309.3121  9.114473 290.9077 326.8777
[168,] 318.8306 10.492105 297.5786 339.5550
[169,] 328.3492 12.149964 304.4133 352.2982
[170,] 337.8677 13.988770 310.1439 365.9935
[171,] 263.4498 12.325768 240.1995 288.2259
[172,] 275.1999 10.604711 255.2932 296.5655
[173,] 286.9500  9.177867 269.5838 305.5767
[174,] 298.7002  8.200282 282.8069 314.7850
[175,] 310.4503  7.841814 295.2020 325.4467
[176,] 322.2004  8.184222 306.1185 337.6555
[177,] 333.9505  9.149150 315.6765 351.4398
[178,] 345.7006 10.567423 325.0243 366.1787
[179,] 357.4507 12.282994 333.2923 381.0451
[180,] 369.2008 14.188428 340.8209 396.9926</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.1824991 13.069712  -29.89878512  21.3931129
  [2,]  -14.6654917 11.183063  -36.23912184   7.6177350
  [3,]  -42.1972842  9.578281  -60.86723726 -22.8655133
  [4,]    8.8142232  8.418139   -7.20433444  25.5850510
  [5,]   24.5986307  7.900993    9.32917568  40.0230525
  [6,]   62.8091381  8.150174   46.96567742  78.6151084
  [7,]   10.6951456  9.102966   -7.22104484  28.7964834
  [8,] -100.9877470 10.570794 -121.91343328 -80.1099132
  [9,]   19.8212605 12.371678   -4.25805866  44.2419663
 [10,]   35.9617679 14.381034    8.20057394  64.1072448
 [11,]   11.3019834 12.992904  -14.07017244  36.6077302
 [12,]   -7.8901266 11.196332  -29.81572658  13.9095756
 [13,]  -11.9021365  9.688712  -30.94440652   6.9906100
 [14,]  -11.8969465  8.622960  -28.64553089   5.3890465
 [15,]  -10.6118565  8.173784  -26.76816180   5.4046577
 [16,]   -4.0901664  8.440204  -20.80026235  12.5891046
 [17,]   -8.1456764  9.361322  -26.12562192  10.3003569
 [18,]   -5.7727863 10.770453  -26.73683024  15.3569728
 [19,]   -0.9282963 12.503678  -25.39180573  23.6074620
 [20,]   10.3661937 14.444801  -17.98986617  38.5301522
 [21,]  -13.9756570 13.519236  -39.76169423  13.2241736
 [22,]  -23.5944577 11.591476  -46.07325151  -0.4821335
 [23,]   11.4962416  9.932397   -7.83208450  30.9068182
 [24,]    5.1207408  8.697145  -11.66068235  21.9367087
 [25,]   -3.3105599  8.082437  -19.12862484  12.0568489
 [26,]  -17.0571607  8.228541  -33.77655331  -1.2661889
 [27,]   -6.9913614  9.098879  -24.95942230  10.8440457
 [28,]    8.4418378 10.515130  -12.40429652  29.4261931
 [29,]    8.8061371 12.289993  -14.92043624  33.4869222
 [30,]   -9.5881636 14.290471  -36.92396251  19.0539827
 [31,]   46.8561886 13.495049   19.54039924  71.9706131
 [32,]   20.0065054 11.549406   -3.47429701  41.8728347
 [33,]   -2.2444778  9.890050  -22.37156576  16.2498354
 [34,]   -6.6752611  8.682700  -24.04508299  10.2093596
 [35,]  -11.7182443  8.131258  -27.74491829   3.9044730
 [36,]   -5.6373275  8.366440  -22.20691372  10.4275627
 [37,]  -28.6905107  9.328942  -47.45546022 -10.9067927
 [38,]    3.6239061 10.826490  -18.55476419  24.8865259
 [39,]  -14.9951772 12.670774  -40.72515606   9.6659295
 [40,]   27.9967396 14.732142   -1.75421595  56.8330901
 [41,]   14.3648182 13.010383  -11.73073957  39.3267215
 [42,]    4.3053143 11.195044  -17.92771421  25.5330613
 [43,]   13.6743105  9.653439   -5.37796257  31.8482690
 [44,]   24.5174066  8.535202    7.69180611  40.8876709
 [45,]   13.2278027  8.019439   -2.48147452  28.9151123
 [46,]  -17.1824012  8.220344  -33.24626970  -0.9310858
 [47,]  -27.8777051  9.090524  -45.48852599  -9.8555936
 [48,]    9.4133910 10.464327  -11.45641445  30.2841509
 [49,]  -39.1090129 12.172410  -63.27146329 -15.6437549
 [50,]   31.2735832 14.093754    2.97816238  58.6994300
 [51,]  -25.4441641 11.910950  -49.13389401  -1.9400667
 [52,]  -27.7181943 10.270208  -48.11701047  -7.3371068
 [53,]   -7.7939245  8.926862  -25.12706018  10.3445817
 [54,]   18.7883453  8.031550    3.06752354  35.0323588
 [55,]   16.2572151  7.741317    1.57428520  32.1004220
 [56,]   -1.4333152  8.121295  -17.04176332  14.8977726
 [57,]  132.5057546  9.087801  114.82540563 150.2290636
 [58,]   14.9497244 10.479793   -5.31176914  35.2649369
 [59,]  -11.8063058 12.151924  -35.30615925  11.5564799
 [60,]  -98.4674360 14.004203 -125.66122365 -71.5534712
 [61,]   16.1850585 12.686996   -9.04504462  40.9913729
 [62,]   11.5519874 10.885603   -9.85751183  32.7453985
 [63,]  -11.5793837  9.374361  -29.85412951   6.4754995
 [64,]    1.1153452  8.313045  -14.83231440  17.5495197
 [65,]  -11.8690258  7.885466  -27.31575527   3.9097668
 [66,]   18.7808031  8.191472    2.62801683  35.0331444
 [67,]    2.2951320  9.157818  -15.96114945  20.2445918
 [68,]    8.7628609 10.605510  -11.96558160  29.2398918
 [69,]  -17.0627102 12.366642  -41.17057983   6.6810420
 [70,]    1.2744187 14.326081  -26.65201493  28.7177248
 [71,]   21.0554466 11.886326   -2.20478189  45.2726063
 [72,]   20.2737247 10.245205    0.03776569  40.8906237
 [73,]  -24.0725971  8.902690  -41.54228733  -6.0829921
 [74,]  -24.2748190  8.010351  -40.07984854  -8.1448220
 [75,]  -11.4325409  7.725783  -26.19577481   3.7206135
 [76,]  -17.7755627  8.113192  -33.73654302  -1.5468867
 [77,]   -7.9517846  9.087036  -25.92391555  10.3350272
 [78,]    6.5364936 10.485167  -13.83586227  27.7015590
 [79,]   -0.7493283 12.162130  -24.19868111  23.7334806
 [80,]   29.2929499 14.018211    1.54757793  57.5343711
 [81,]   -9.3718249 13.479931  -37.06214641  16.0505232
 [82,]   23.2095205 11.498715   -0.22487007  45.2201070
 [83,]    3.9954658  9.790849  -15.43825190  22.6125994
 [84,]   20.5493112  8.522285    3.63102937  36.7129596
 [85,]    1.4415566  7.907358  -13.74668027  16.6315598
 [86,]    4.8683019  8.096396  -10.83051305  20.7065546
 [87,]   -4.0731527  9.039098  -22.04547831  13.5564158
 [88,]  -13.9720073 10.535051  -35.12121902   6.4079936
 [89,]  -13.2864620 12.385381  -37.69182635  10.9199719
 [90,]  -11.5515166 14.454631  -39.62448869  17.0999619
 [91,]   26.3760969 13.115306    0.83073468  51.9223608
 [92,]    8.6724586 11.231901  -13.30873198  30.8569395
 [93,]  -32.6649797  9.644638  -51.48201231 -13.7268655
 [94,]    2.7031820  8.520657  -14.17226607  19.5102896
 [95,]    3.1705437  8.056257  -12.55547236  19.1516517
 [96,]   10.1338054  8.362061   -6.07504592  26.5217309
 [97,]    3.4125672  9.362904  -15.25891553  21.6000867
 [98,]   -3.2980711 10.868440  -24.87465941  18.0991760
 [99,]   16.7310906 12.700438   -7.82799658  41.9339824
[100,]    0.6406523 14.737652  -27.71529555  29.8555233
[101,]    9.5524068 12.808174  -15.10984760  34.9775537
[102,]   -7.7879051 10.990017  -29.05444548  13.5317874
[103,]  -10.7328169  9.446901  -29.07414911   7.7528699
[104,]   -6.2902288  8.333049  -22.48256383  10.3827641
[105,]  -22.0557407  7.833758  -37.40525438  -6.4989162
[106,]  -14.5454526  8.064003  -30.35001492   1.2576423
[107,]  -14.3088644  8.967765  -32.11571035   3.1507202
[108,]    0.6745237 10.370429  -20.08900060  21.0773138
[109,]   17.2993118 12.099714   -6.57529251  41.1419610
[110,]   21.1099999 14.035407   -6.60037814  49.4119483
[111,]   17.3512860 13.464831   -7.78594174  44.5884597
[112,]  -12.4830550 11.515558  -34.39655198  10.7846630
[113,]  -16.7245960  9.830436  -35.49579007   2.9051550
[114,]  -34.3939370  8.566789  -50.94995436 -17.5404612
[115,]  -37.9963780  7.928764  -53.45257386 -22.7548694
[116,]    5.8199810  8.066208   -9.58812524  21.3687568
[117,]   38.5479400  8.943441   21.32727911  56.1652064
[118,]    5.0299990 10.374467  -14.41373350  25.6972430
[119,]   19.6069579 12.165401   -3.22476682  44.0072695
[120,]   -2.8193831 14.180530  -29.63777573  25.6557105
[121,]   -5.1953157 12.373739  -29.80375015  18.5263145
[122,]   36.8006766 10.654284   15.23642400  57.3306515
[123,]   -0.8981311  9.231305  -19.47173718  17.1923703
[124,]    2.2619612  8.259486  -14.55446098  18.2575902
[125,]  -14.0348465  7.906966  -29.72552303   0.9789509
[126,]   11.2362458  8.253483   -4.91981383  27.0721359
[127,]  -13.1858619  9.220562  -31.22952672   4.7922044
[128,]  -41.8720696 10.640320  -62.82277219 -21.0048932
[129,]    5.5391227 12.357708  -18.82462365  29.7281011
[130,]   24.0277150 14.265636   -3.79351502  52.2425719
[131,]  -50.3811812 12.717268  -75.83409362 -25.9141972
[132,]   12.0860160 10.942146   -9.57897323  33.0547557
[133,]   26.7210132  9.458878    7.81238690  44.8677447
[134,]   32.6484105  8.423082   15.65972137  49.3399305
[135,]   20.4835077  8.010269    4.82764929  36.2962682
[136,]   10.5224049  8.313762   -5.86423332  27.3824940
[137,]   -1.9292978  9.263423  -20.29926339  16.4554070
[138,]   -9.9729006 10.688382  -31.36495581  10.8872358
[139,]   -8.8145034 12.426189  -33.82757218  15.4046515
[140,]   -9.9630061 14.363738  -39.10532958  18.1621200
[141,]   17.0195394 12.150644   -7.29898029  40.1491197
[142,]    2.2219661 10.474224  -18.30720976  22.5148222
[143,]  -20.2835071  9.081698  -38.41871781  -2.5449437
[144,]  -11.1802804  8.120452  -27.31222069   4.8615891
[145,]   14.6743463  7.752606   -0.26801874  30.2246585
[146,]    5.7546730  8.059820   -9.87805990  21.8729000
[147,]  -24.6345003  8.973023  -42.06325778  -6.8078962
[148,]   14.0421264 10.332775   -6.17452482  34.2060628
[149,]   -5.1117469 11.988076  -28.61327447  18.4431487
[150,]    9.8103798 13.833234  -17.28155869  36.9327901
[151,]   -1.2353781 13.284715  -26.86117470  25.5940568
[152,]   -7.1542796 11.354625  -28.87286708  15.6584369
[153,]  -17.9553810  9.695654  -36.66093642   1.4374755
[154,]  -31.5615825  8.468664  -47.99637716 -14.7596394
[155,]  -19.6756840  7.878146  -35.04339333  -4.1525397
[156,]   41.8023146  8.065138   25.75273571  57.7536570
[157,]  -36.4216869  8.981207  -54.18146763 -18.9829758
[158,]   14.8373116 10.436094   -5.71106152  35.1116821
[159,]   17.2364102 12.239134   -6.84898630  40.7919061
[160,]    9.1238087 14.258860  -18.96597755  36.7125031
[161,]   17.6794410 11.919329   -6.08359302  41.1758131
[162,]   10.7233158 10.291785   -9.55770515  30.8551038
[163,]    6.6608907  8.960915  -11.12592985  23.9297172
[164,]    1.0329656  8.074766  -15.15563285  16.5566539
[165,]  -11.1045596  7.786681  -26.54677332   3.9440941
[166,]  -15.2815847  8.160248  -30.87215380   0.7342902
[167,]  -50.0463099  9.114473  -67.61190349 -31.6418944
[168,]  -14.2000350 10.492105  -34.92443913   7.0520463
[169,]   22.4315399 12.149964   -1.51753514  46.3674466
[170,]   31.6015147 13.988770    3.47572024  59.3253314
[171,]    5.9618673 12.325768  -18.81419947  29.2122060
[172,]   -1.7259395 10.604711  -23.09145205  18.1807688
[173,]   10.6467538  9.177867   -7.97986669  28.0130085
[174,]   11.9314471  8.200282   -4.15336535  27.8247461
[175,]  -23.2776596  7.841814  -38.27414392  -8.0293535
[176,]    7.4072336  8.184222   -8.04789438  23.4891087
[177,]    0.5313269  9.149150  -16.95799127  18.8053261
[178,]   -2.4806798 10.567423  -22.95880715  18.1955748
[179,]   11.6910135 12.282994  -11.90343838  35.8493727
[180,]   -5.0771932 14.188428  -32.86901082  23.3027490</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.3
p_loo        19.2  3.3
looic      1769.6 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1579      
 (0.5, 0.7]   (ok)         2    1.1%   149       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.6
p_loo        34.5  8.6
looic      1723.1 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   1076      
 (0.5, 0.7]   (ok)         3    1.7%   291       
   (0.7, 1]   (bad)        3    1.7%   11        
   (1, Inf)   (very bad)   1    0.6%   9         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.2      11.9  
fit_sleep1 -91.7      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.3
p_loo        19.2  3.3
looic      1769.6 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1579      
 (0.5, 0.7]   (ok)         2    1.1%   149       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.6
p_loo        34.5  8.6
looic      1723.1 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   1076      
 (0.5, 0.7]   (ok)         3    1.7%   291       
   (0.7, 1]   (bad)        3    1.7%   11        
   (1, Inf)   (very bad)   1    0.6%   9         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.6     22.6        34.5    8.6   1723.1
fit_sleep2  -23.2      11.9  -884.8     14.3        19.2    3.3   1769.6
fit_sleep1  -91.7      21.2  -953.2     10.5         3.1    0.5   1906.5
           se_looic
fit_sleep3   45.1  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.530937e-40 8.079897e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.61     0.24     5.45       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.61    -3.32      2.9       5.44      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.25 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_0.63.0   compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.21      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.4      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.3         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.0          
 [52] processx_3.8.1       pkgbuild_1.4.0       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.0        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.0         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.1-3       
 [85] grid_4.3.0           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.31       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
