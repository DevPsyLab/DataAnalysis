<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.10      7.04    15.54    42.87 1.00     1712     2308
sd(Days)                6.58      1.51     4.19    10.15 1.00     1274     1965
cor(Intercept,Days)     0.08      0.30    -0.49     0.67 1.00      951     1497

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.03      7.40   236.40   265.96 1.01     1674     2381
Days         10.36      1.68     6.96    13.67 1.00     1492     1693

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.59    23.11    29.32 1.00     3634     2787

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7410  13.04390 227.9842 278.7248
309 211.6935  13.35214 185.1466 237.7132
310 212.8790  12.91087 187.0582 237.2471
330 274.5411  13.41360 248.7717 301.7283
331 272.9138  12.93944 248.6178 298.7098
332 260.2182  12.40746 236.2541 284.8731
333 267.7919  12.59189 243.9912 293.5899
334 244.4307  12.26688 219.7603 268.5163
335 250.8855  13.38083 225.4004 277.6589
337 286.0210  13.20708 260.1046 312.3827
349 226.4396  12.75493 201.0425 250.9891
350 238.6046  13.32386 212.2012 263.4223
351 255.9961  12.42644 231.3938 281.4941
352 271.9800  12.11836 247.7203 296.0283
369 254.3150  12.28910 229.8204 278.5613
370 226.1705  13.52722 198.5460 252.0538
371 252.2584  11.83368 229.0749 275.6726
372 263.7181  12.27133 240.1787 288.0957

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6147985  2.489969 14.92059703 24.614709
309  1.7296376  2.464820 -3.09225522  6.606994
310  4.9008424  2.497082  0.02104999 10.097128
330  5.7220138  2.544658  0.84281287 10.627259
331  7.5278111  2.419882  2.74504683 12.177487
332 10.2274016  2.395141  5.57276544 14.846023
333 10.3322094  2.419132  5.43740869 15.097123
334 11.4762507  2.340816  6.86325641 15.998960
335 -0.2468367  2.552628 -5.33757495  4.703039
337 19.1470406  2.496602 14.28534781 24.103437
349 11.5495169  2.434629  6.85779555 16.426299
350 17.0416797  2.504889 12.28940254 22.101698
351  7.4974777  2.360851  2.80888076 12.150035
352 14.0812673  2.329388  9.38152213 18.559503
369 11.3982299  2.340269  6.82681514 15.946776
370 15.2349295  2.561251 10.29955386 20.325599
371  9.4347904  2.294337  4.84598878 13.970319
372 11.7388947  2.354101  7.06553029 16.239113</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7410 13.043901 227.9842 278.7248
  [2,] 273.3558 11.152200 251.3171 294.7022
  [3,] 292.9706  9.539375 274.1081 311.4172
  [4,] 312.5854  8.368255 296.3414 328.9504
  [5,] 332.2002  7.839361 317.0433 347.5721
  [6,] 351.8150  8.079812 336.4263 367.9377
  [7,] 371.4298  9.028347 354.1574 389.0458
  [8,] 391.0446 10.494694 370.6688 411.4821
  [9,] 410.6594 12.294961 386.7576 434.8396
 [10,] 430.2742 14.303615 402.4150 457.9155
 [11,] 211.6935 13.352137 185.1466 237.7132
 [12,] 213.4231 11.470710 190.3006 235.8955
 [13,] 215.1527  9.850151 195.5053 234.4581
 [14,] 216.8824  8.638544 199.7050 233.7800
 [15,] 218.6120  8.023346 202.4232 234.3112
 [16,] 220.3417  8.140908 204.3319 236.3029
 [17,] 222.0713  8.962442 204.5068 239.4115
 [18,] 223.8009 10.321192 203.9053 244.2613
 [19,] 225.5306 12.036583 202.3079 249.6391
 [20,] 227.2602 13.977922 200.3482 255.3541
 [21,] 212.8790 12.910868 187.0582 237.2471
 [22,] 217.7799 11.045787 195.5779 239.0150
 [23,] 222.6807  9.476241 203.9357 241.7259
 [24,] 227.5815  8.370168 211.0362 244.2916
 [25,] 232.4824  7.924086 217.1687 248.3162
 [26,] 237.3832  8.245811 221.1394 253.5385
 [27,] 242.2841  9.255619 223.5442 260.4089
 [28,] 247.1849 10.761525 226.0622 268.3364
 [29,] 252.0858 12.586707 227.3877 276.4045
 [30,] 256.9866 14.612009 228.2441 285.8757
 [31,] 274.5411 13.413596 248.7717 301.7283
 [32,] 280.2631 11.449030 258.3500 302.9126
 [33,] 285.9851  9.756361 267.1564 305.1716
 [34,] 291.7071  8.499613 275.3099 308.1888
 [35,] 297.4291  7.889921 281.8477 312.5241
 [36,] 303.1511  8.075199 287.4386 318.6091
 [37,] 308.8732  9.006519 291.7379 326.3564
 [38,] 314.5952 10.486968 293.9862 334.9513
 [39,] 320.3172 12.320154 296.8994 344.3141
 [40,] 326.0392 14.371724 298.4383 354.3963
 [41,] 272.9138 12.939440 248.6178 298.7098
 [42,] 280.4416 11.139742 259.2901 302.1940
 [43,] 287.9694  9.616146 269.8129 307.0672
 [44,] 295.4972  8.518118 278.8838 312.4167
 [45,] 303.0250  8.022348 287.0119 318.4570
 [46,] 310.5528  8.238292 294.4718 326.4275
 [47,] 318.0806  9.115509 300.3288 335.9725
 [48,] 325.6084 10.489386 305.2879 346.1784
 [49,] 333.1362 12.193178 309.9276 357.0667
 [50,] 340.6641 14.107857 313.5842 368.2548
 [51,] 260.2182 12.407461 236.2541 284.8731
 [52,] 270.4456 10.626208 249.7779 291.6845
 [53,] 280.6730  9.130219 263.2781 299.2090
 [54,] 290.9004  8.079537 275.4099 307.1939
 [55,] 301.1278  7.659655 285.9582 316.5368
 [56,] 311.3552  7.970893 295.5964 327.3253
 [57,] 321.5826  8.937189 303.7183 339.6042
 [58,] 331.8100 10.377137 311.2381 352.6656
 [59,] 342.0374 12.123118 318.8326 366.2664
 [60,] 352.2648 14.061593 325.3627 380.2892
 [61,] 267.7919 12.591892 243.9912 293.5899
 [62,] 278.1241 10.834165 257.3314 299.8867
 [63,] 288.4563  9.375868 270.6017 306.8804
 [64,] 298.7885  8.374907 282.2052 315.1552
 [65,] 309.1207  8.004726 293.3996 324.6429
 [66,] 319.4530  8.349648 303.1965 335.7840
 [67,] 329.7852  9.330702 311.5682 347.7862
 [68,] 340.1174 10.775517 318.9054 361.2586
 [69,] 350.4496 12.524614 326.0893 375.1654
 [70,] 360.7818 14.468052 333.0165 389.3415
 [71,] 244.4307 12.266877 219.7603 268.5163
 [72,] 255.9069 10.559788 234.7767 276.7896
 [73,] 267.3832  9.137878 249.0095 285.1897
 [74,] 278.8594  8.151770 262.6670 295.2098
 [75,] 290.3357  7.769216 275.2318 305.9297
 [76,] 301.8119  8.076443 286.2525 317.7516
 [77,] 313.2882  9.003109 296.0694 331.0656
 [78,] 324.7644 10.384694 304.8703 345.3635
 [79,] 336.2407 12.065927 312.6501 359.8895
 [80,] 347.7169 13.938801 319.7894 375.2223
 [81,] 250.8855 13.380832 225.4004 277.6589
 [82,] 250.6386 11.415164 228.9694 273.4313
 [83,] 250.3918  9.726103 231.7469 269.8246
 [84,] 250.1450  8.480568 233.5651 266.7098
 [85,] 249.8981  7.891439 234.3296 265.2726
 [86,] 249.6513  8.103172 233.3408 265.4110
 [87,] 249.4045  9.059791 231.4146 267.3494
 [88,] 249.1576 10.560779 227.7041 270.1104
 [89,] 248.9108 12.410161 223.6477 273.1466
 [90,] 248.6639 14.475012 219.9536 277.3545
 [91,] 286.0210 13.207078 260.1046 312.3827
 [92,] 305.1681 11.351019 282.9338 327.5749
 [93,] 324.3151  9.784190 305.2474 343.2047
 [94,] 343.4622  8.664940 326.2064 360.6363
 [95,] 362.6092  8.179121 346.1106 378.7801
 [96,] 381.7562  8.436878 365.0270 397.9009
 [97,] 400.9033  9.377091 382.6234 418.8650
 [98,] 420.0503 10.823346 399.0942 441.0214
 [99,] 439.1974 12.602612 414.9114 463.5659
[100,] 458.3444 14.593591 430.2552 486.8032
[101,] 226.4396 12.754927 201.0425 250.9891
[102,] 237.9891 10.946916 216.3440 258.9534
[103,] 249.5386  9.425317 230.8835 267.8784
[104,] 261.0882  8.348238 244.7694 277.5811
[105,] 272.6377  7.899645 256.9755 288.4041
[106,] 284.1872  8.183553 267.8402 300.2108
[107,] 295.7367  9.131896 277.4992 313.5074
[108,] 307.2862 10.567277 286.2940 327.4092
[109,] 318.8357 12.320633 294.5065 342.8078
[110,] 330.3853 14.275276 302.2120 358.0289
[111,] 238.6046 13.323858 212.2012 263.4223
[112,] 255.6463 11.403574 233.1166 277.0527
[113,] 272.6880  9.752269 253.4439 291.3021
[114,] 289.7297  8.527656 273.1795 306.3536
[115,] 306.7713  7.929946 291.2541 322.4113
[116,] 323.8130  8.099141 308.3135 340.3800
[117,] 340.8547  8.992056 323.3558 359.4688
[118,] 357.8964 10.424346 337.6135 379.2709
[119,] 374.9381 12.207615 351.3463 399.3838
[120,] 391.9797 14.210336 364.8118 420.4689
[121,] 255.9961 12.426437 231.3938 281.4941
[122,] 263.4936 10.693060 242.5294 285.2495
[123,] 270.9911  9.241968 252.5636 289.6305
[124,] 278.4886  8.223967 262.0678 295.4046
[125,] 285.9861  7.810285 270.4780 301.2690
[126,] 293.4835  8.094116 277.4866 309.6125
[127,] 300.9810  9.009778 283.1333 319.5365
[128,] 308.4785 10.391571 287.9043 330.1353
[129,] 315.9760 12.080588 292.0662 340.7593
[130,] 323.4734 13.965805 296.3588 352.2026
[131,] 271.9800 12.118364 247.7203 296.0283
[132,] 286.0612 10.448518 265.3022 306.5976
[133,] 300.1425  9.074161 282.1032 317.8320
[134,] 314.2238  8.146250 298.2755 330.1538
[135,] 328.3050  7.825246 313.0193 343.2985
[136,] 342.3863  8.182888 326.6188 358.6188
[137,] 356.4676  9.139854 338.9423 374.7979
[138,] 370.5488 10.534055 350.4401 391.7444
[139,] 384.6301 12.216701 361.2310 408.9314
[140,] 398.7114 14.084792 371.3384 426.3969
[141,] 254.3150 12.289097 229.8204 278.5613
[142,] 265.7132 10.588822 244.6459 286.3070
[143,] 277.1114  9.174864 259.0757 294.9935
[144,] 288.5097  8.196756 272.5530 304.5987
[145,] 299.9079  7.819797 284.9229 315.1546
[146,] 311.3061  8.128059 295.8054 327.0430
[147,] 322.7044  9.051805 304.8160 340.0031
[148,] 334.1026 10.428746 313.2735 353.8201
[149,] 345.5008 12.105206 321.2790 368.5328
[150,] 356.8990 13.973797 329.0502 383.3326
[151,] 226.1705 13.527223 198.5460 252.0538
[152,] 241.4055 11.543550 217.9895 263.4999
[153,] 256.6404  9.830633 236.8791 275.9976
[154,] 271.8753  8.552728 255.0987 288.7384
[155,] 287.1103  7.923194 271.8522 302.5784
[156,] 302.3452  8.094742 286.5446 318.2222
[157,] 317.5801  9.021790 300.2221 335.3451
[158,] 332.8151 10.506216 312.3534 353.5528
[159,] 348.0500 12.348622 324.4772 372.4025
[160,] 363.2849 14.412369 335.5285 391.1839
[161,] 252.2584 11.833685 229.0749 275.6726
[162,] 261.6932 10.244578 241.7691 281.9044
[163,] 271.1280  8.966306 253.4581 288.5256
[164,] 280.5628  8.146525 264.4060 295.9128
[165,] 289.9976  7.928750 274.6429 305.5762
[166,] 299.4324  8.360158 283.1493 315.9521
[167,] 308.8672  9.351330 290.6843 327.5188
[168,] 318.3019 10.748510 297.0310 339.1492
[169,] 327.7367 12.415375 303.1983 351.7250
[170,] 337.1715 14.257649 309.2037 365.2219
[171,] 263.7181 12.271325 240.1787 288.0957
[172,] 275.4570 10.564438 254.9380 296.4934
[173,] 287.1959  9.149473 269.3604 305.1484
[174,] 298.9348  8.179362 282.8139 314.7998
[175,] 310.6737  7.821423 295.3368 325.5391
[176,] 322.4126  8.156650 306.5648 337.9215
[177,] 334.1515  9.108831 316.0436 351.4978
[178,] 345.8904 10.511625 325.1925 366.2214
[179,] 357.6293 12.210704 333.3401 381.6149
[180,] 369.3682 14.099359 341.4409 397.1142</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.1810219 13.043901  -29.16476818  21.5757664
  [2,]  -14.6511204 11.152200  -35.99753340   7.3875957
  [3,]  -42.1700188  9.539375  -60.61660758 -23.3075311
  [4,]    8.8543827  8.368255   -7.51059327  25.0983777
  [5,]   24.6516842  7.839361    9.27975232  39.8085750
  [6,]   62.8750857  8.079812   46.75235700  78.2637996
  [7,]   10.7739872  9.028347   -6.84198644  28.0464036
  [8,] -100.8960113 10.494694 -121.33350491 -80.5201597
  [9,]   19.9258902 12.294961   -4.25432839  43.8277203
 [10,]   36.0792917 14.303615    8.43800351  63.9385005
 [11,]   11.0404372 13.352137  -14.97929986  37.5873445
 [12,]   -8.1573004 11.470710  -30.62967185  14.9651914
 [13,]  -12.1749379  9.850151  -31.48031608   7.4725040
 [14,]  -12.1753755  8.638544  -29.07303647   5.0019861
 [15,]  -10.8959131  8.023346  -26.59514132   5.2929211
 [16,]   -4.3798506  8.140908  -20.34111557  11.6299397
 [17,]   -8.4409882  8.962442  -25.78118396   9.1235458
 [18,]   -6.0737258 10.321192  -26.53409006  13.8218680
 [19,]   -1.2348633 12.036583  -25.34339790  21.9878364
 [20,]   10.0539991 13.977922  -18.03987111  36.9660157
 [21,]  -13.8251203 12.910868  -38.19324612  11.9956655
 [22,]  -23.4476626 11.045787  -44.68284515  -1.2457048
 [23,]   11.6392950  9.476241   -7.40594341  30.3842629
 [24,]    5.2600526  8.370168  -11.45000748  21.8054315
 [25,]   -3.1749898  7.924086  -19.00876262  12.1387253
 [26,]  -16.9253322  8.245811  -33.08060843  -0.6815008
 [27,]   -6.8632746  9.255619  -24.98811410  11.8766399
 [28,]    8.5661831 10.761525  -12.58531177  29.6889213
 [29,]    8.9267407 12.586707  -15.39202779  33.6248489
 [30,]   -9.4713017 14.612009  -38.36036612  19.2712387
 [31,]   47.0015246 13.413596   19.81432696  72.7708921
 [32,]   20.1371107 11.449030   -2.51238684  42.0501534
 [33,]   -2.1286031  9.756361  -21.31511901  16.7000609
 [34,]   -6.5741169  8.499613  -23.05578696   9.8231133
 [35,]  -11.6318308  7.889921  -26.72675843   3.9495954
 [36,]   -5.5656446  8.075199  -21.02360359  10.1469337
 [37,]  -28.6335584  9.006519  -46.11676923 -11.4982774
 [38,]    3.6661277 10.486968  -16.69004660  24.2750760
 [39,]  -14.9676861 12.320154  -38.96461043   8.4500669
 [40,]   28.0095001 14.371724   -0.34764535  55.6104235
 [41,]   14.6941475 12.939440  -11.10193599  38.9901430
 [42,]    4.5584364 11.139742  -17.19400861  25.7098823
 [43,]   13.8512254  9.616146   -5.24662024  32.0077133
 [44,]   24.6181143  8.518118    7.69855621  41.2315373
 [45,]   13.2523032  8.022348   -2.17971209  29.2653904
 [46,]  -17.2341079  8.238292  -33.10877885  -1.1531403
 [47,]  -28.0056190  9.115509  -45.89750874 -10.2538103
 [48,]    9.2092699 10.489386  -11.36066480  29.5297574
 [49,]  -39.3893412 12.193178  -63.31976926 -16.1806582
 [50,]   30.9170477 14.107857    3.32629526  57.9968870
 [51,]  -25.3576279 12.407461  -50.01250488  -1.3934705
 [52,]  -27.6338295 10.626208  -48.87273047  -6.9661496
 [53,]   -7.7117310  9.130219  -26.24773869   9.6832436
 [54,]   18.8683674  8.079537    2.57494476  34.3589174
 [55,]   16.3350659  7.659655    0.92607365  31.5047165
 [56,]   -1.3576357  7.970893  -17.32774324  14.4011906
 [57,]  132.5792627  8.937189  114.55765102 150.4436496
 [58,]   15.0210612 10.377137   -5.83452898  35.5930077
 [59,]  -11.7371404 12.123118  -35.96613888  11.4676707
 [60,]  -98.4004420 14.061593 -126.42476050 -71.4983334
 [61,]   16.0504920 12.591892   -9.74745946  39.8512059
 [62,]   11.4308826 10.834165  -10.33169873  32.2235821
 [63,]  -11.6870268  9.375868  -30.11110228   6.1675946
 [64,]    1.0211637  8.374907  -15.34554759  17.6045441
 [65,]  -11.9497457  8.004726  -27.47193671   3.7714270
 [66,]   18.7135448  8.349648    2.38250227  34.9699710
 [67,]    2.2413354  9.330702  -15.75968897  20.4582955
 [68,]    8.7225260 10.775517  -12.41872796  29.9344775
 [69,]  -17.0895835 12.524614  -41.80542622   7.2706938
 [70,]    1.2610071 14.468052  -27.29867456  29.0262754
 [71,]   21.0424479 12.266877   -3.04320678  45.7128097
 [72,]   20.2942972 10.559788   -0.58843270  41.4244592
 [73,]  -24.0184535  9.137878  -41.82501676  -5.6448327
 [74,]  -24.1871041  8.151770  -40.53748962  -7.9947100
 [75,]  -11.3112548  7.769216  -26.90531357   3.7925739
 [76,]  -17.6207055  8.076443  -33.56044729  -2.0612994
 [77,]   -7.7633562  9.003109  -25.54081208   9.4554265
 [78,]    6.7584931 10.384694  -13.84063449  26.6525711
 [79,]   -0.4937575 12.065927  -24.14261540  23.0968473
 [80,]   29.5820918 13.938801    2.07670425  57.5095664
 [81,]   -9.2771731 13.380832  -36.05056458  16.2078950
 [82,]   23.3085636 11.415164    0.51591270  44.9778476
 [83,]    4.0989003  9.726103  -15.33388132  22.7437588
 [84,]   20.6571370  8.480568    4.09232127  37.2369670
 [85,]    1.5537737  7.891439  -13.82065066  17.1223424
 [86,]    4.9849104  8.103172  -10.77476458  21.2954141
 [87,]   -3.9521529  9.059791  -21.89707382  14.0376699
 [88,]  -13.8466162 10.560779  -34.79937768   7.6069292
 [89,]  -13.1566794 12.410161  -37.39247632  12.1063536
 [90,]  -11.4173427 14.475012  -40.10790643  17.2929675
 [91,]   26.3455614 13.207078   -0.01613702  52.2619915
 [92,]    8.6377208 11.351019  -13.76914818  30.8719816
 [93,]  -32.7039197  9.784190  -51.59350883 -13.6361569
 [94,]    2.6600397  8.664940  -14.51413848  19.9157546
 [95,]    3.1231992  8.179121  -13.04766147  19.6218432
 [96,]   10.0822586  8.436878   -6.06235192  26.8115473
 [97,]    3.3568181  9.377091  -14.60489977  21.6366725
 [98,]   -3.3580225 10.823346  -24.32905898  17.5981268
 [99,]   16.6669370 12.602612   -7.70160556  40.9529002
[100,]    0.5722964 14.593591  -27.88653968  28.6615425
[101,]    9.6635849 12.754927  -14.88589637  35.0607052
[102,]   -7.6724320 10.946916  -28.63666745  13.9727133
[103,]  -10.6130488  9.425317  -28.95278719   8.0420679
[104,]   -6.1661657  8.348238  -22.65908921  10.1526464
[105,]  -21.9273825  7.899645  -37.69379620  -6.2651671
[106,]  -14.4127994  8.183553  -30.43638068   1.9341697
[107,]  -14.1719162  9.131896  -31.94264581   4.0656168
[108,]    0.8157669 10.567277  -19.30722977  21.8079716
[109,]   17.4448500 12.320633   -6.52722273  41.7740546
[110,]   21.2598332 14.275276   -6.38380369  49.4331190
[111,]   17.6921732 13.323858   -7.12551054  44.0956211
[112,]  -12.1920064 11.403574  -33.59836288  10.3376667
[113,]  -16.4833861  9.752269  -35.09752828   2.7606979
[114,]  -34.2025658  8.527656  -50.82647633 -17.6524174
[115,]  -37.8548454  7.929946  -53.49481151 -22.3376198
[116,]    5.9116749  8.099141  -10.65532587  21.4112449
[117,]   38.5897952  8.992056   19.97572529  56.0886657
[118,]    5.0220156 10.424346  -16.35253945  25.3048834
[119,]   19.5491359 12.207615   -4.89659082  43.1408952
[120,]   -2.9270438 14.210336  -31.41623423  24.2409323
[121,]   -5.4696458 12.426437  -30.96763284  19.1326844
[122,]   36.5639765 10.693060   14.80812947  57.5282489
[123,]   -1.0972013  9.241968  -19.73662467  17.3303107
[124,]    2.1005210  8.223967  -14.81545684  18.5212885
[125,]  -14.1586567  7.810285  -29.44163032   1.3493554
[126,]   11.1500656  8.094116   -4.97891935  27.1469615
[127,]  -13.2344121  9.009778  -31.78990278   4.6132709
[128,]  -41.8829898 10.391571  -63.53976102 -21.3088007
[129,]    5.5658325 12.080588  -19.21751466  29.4755611
[130,]   24.0920548 13.965805   -4.63710986  51.2067125
[131,]  -50.3028696 12.118364  -74.35116434 -26.0431928
[132,]   12.1326631 10.448518   -8.40371772  32.8916749
[133,]   26.7359957  9.074161    9.04649167  44.7753106
[134,]   32.6317284  8.146250   16.70173493  48.5799911
[135,]   20.4351611  7.825246    5.44165702  35.7209288
[136,]   10.4423938  8.182888   -5.79014035  26.2099491
[137,]   -2.0409735  9.139854  -20.37130413  15.4843401
[138,]  -10.1162409 10.534055  -31.31183703   9.9924570
[139,]   -8.9895082 12.216701  -33.29075327  14.4096180
[140,]  -10.1696755 14.084792  -37.85519111  17.2033004
[141,]   17.6085270 12.289097   -6.63782245  42.1030874
[142,]    2.7236971 10.588822  -17.87011351  23.7909561
[143,]  -19.8690329  9.174864  -37.75112524  -1.8333418
[144,]  -10.8530628  8.196756  -26.94211347   5.1036205
[145,]   14.9143073  7.819797   -0.33238328  29.8992789
[146,]    5.9073774  8.128059   -9.82949684  21.4081469
[147,]  -24.5690526  9.051805  -41.86784146  -6.6806868
[148,]   14.0203175 10.428746   -5.69722197  34.8493989
[149,]   -5.2208124 12.105206  -28.25277786  19.0010379
[150,]    9.6140576 13.973797  -16.81948276  37.4629013
[151,]   -0.9065478 13.527223  -26.78983924  26.7179925
[152,]   -6.8819773 11.543550  -28.97637702  16.5340368
[153,]  -17.7396068  9.830633  -37.09680961   2.0216504
[154,]  -31.4023363  8.552728  -48.26540200 -14.6257040
[155,]  -19.5729658  7.923194  -35.04113972  -4.3149052
[156,]   41.8485047  8.094742   25.97148801  57.6491185
[157,]  -36.4320248  9.021790  -54.19698446 -19.0739967
[158,]   14.7704456 10.506216   -5.96728144  35.2320806
[159,]   17.1130161 12.348622   -7.23946493  40.6858223
[160,]    8.9438866 14.412369  -18.95513452  36.7003472
[161,]   17.6219861 11.833685   -5.79223852  40.8055182
[162,]   10.7495958 10.244578   -9.46158329  30.6736508
[163,]    6.7709054  8.966306  -10.62668881  24.4407573
[164,]    1.2267150  8.146525  -14.12331872  17.3835377
[165,]  -10.8270753  7.928750  -26.40574506   4.5276036
[166,]  -14.9203657  8.360158  -31.44009787   1.3627151
[167,]  -49.6013561  9.351330  -68.25301696 -31.4184985
[168,]  -13.6713465 10.748510  -34.51863172   7.5996400
[169,]   23.0439632 12.415375   -0.94432456  47.5824326
[170,]   32.2976728 14.257649    4.24727933  60.2654694
[171,]    5.6935599 12.271325  -18.68397924  29.2329575
[172,]   -1.9830348 10.564438  -23.01943511  18.5360116
[173,]   10.4008705  9.149473   -7.55160356  28.2364352
[174,]   11.6967757  8.179362   -4.16824463  27.8177278
[175,]  -23.5011190  7.821423  -38.36648261  -8.1641686
[176,]    7.1949863  8.156650   -8.31392159  23.0427753
[177,]    0.3302915  9.108831  -17.01595427  18.4381688
[178,]   -2.6705032 10.511625  -23.00153315  18.0273716
[179,]   11.5124020 12.210704  -12.47315561  35.8016416
[180,]   -5.2445927 14.099359  -32.99057521  22.6827092</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.4  3.3
looic      1770.0 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   200       
 (0.5, 0.7]   (ok)         1    0.6%   1624      
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.2
p_loo        33.8  8.3
looic      1721.4 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     169   93.9%   1009      
 (0.5, 0.7]   (ok)         7    3.9%   300       
   (0.7, 1]   (bad)        4    2.2%   13        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.4  
fit_sleep1 -92.5      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.4  3.3
looic      1770.0 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   200       
 (0.5, 0.7]   (ok)         1    0.6%   1624      
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.2
p_loo        33.8  8.3
looic      1721.4 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     169   93.9%   1009      
 (0.5, 0.7]   (ok)         7    3.9%   300       
   (0.7, 1]   (bad)        4    2.2%   13        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.7     22.2        33.8    8.3   1721.4
fit_sleep2  -24.3      11.4  -885.0     14.3        19.4    3.3   1770.0
fit_sleep1  -92.5      20.8  -953.2     10.5         3.1    0.5   1906.5
           se_looic
fit_sleep3   44.3  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.598041e-41 2.772836e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.87      1.63     0.19     5.46       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.13      1.63    -3.36     3.17       5.36      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.1-0     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_5.0.0           compiler_4.2.2      
 [22] cli_3.6.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.5          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.20      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.1   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.4          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.12       yaml_2.3.7          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.42           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.20        V8_4.2.2            
 [88] RcppParallel_5.1.6   vctrs_0.5.2          nloptr_2.0.3        
 [91] httpuv_1.6.8         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
