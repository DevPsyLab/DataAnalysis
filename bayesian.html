<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.90      6.61    15.85    41.67 1.00     1955     2704
sd(Days)                6.55      1.51     4.12    10.14 1.00     1479     2044
cor(Intercept,Days)     0.08      0.30    -0.49     0.68 1.00      881     1663

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.11      7.40   236.13   265.73 1.00     1919     2520
Days         10.45      1.72     7.04    13.83 1.01     1158     1511

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.54    23.13    29.14 1.00     3491     3089

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9313  13.08980 227.8584 279.4899
309 211.4819  13.42760 185.4879 237.4527
310 213.1210  12.91498 187.6198 238.0683
330 274.6278  13.67104 248.1994 302.2273
331 273.2750  13.29290 248.1627 300.3959
332 260.5675  12.37624 236.7773 285.5171
333 267.9180  12.74962 243.6324 293.7215
334 244.2908  12.11216 219.1850 267.4790
335 250.7434  13.44950 224.9523 277.8710
337 285.9547  13.19866 260.6340 311.6855
349 226.6302  13.28219 199.6710 251.0268
350 238.5464  13.19366 211.7702 264.1144
351 255.9953  12.58873 232.0612 280.9286
352 271.8458  12.53256 246.9245 296.0537
369 254.7913  11.74462 231.0503 277.5924
370 226.3250  13.95467 199.1757 252.3461
371 252.1419  12.54032 227.5700 276.8383
372 263.5187  12.15176 239.8226 287.2087

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6672001  2.518141 14.82065562 24.758896
309  1.7571304  2.530444 -3.16054887  6.745698
310  4.8669355  2.452199 -0.04508353  9.637174
330  5.7121195  2.587859  0.35323090 10.545539
331  7.4530991  2.487892  2.34718158 12.224712
332 10.1503675  2.375177  5.51373734 14.725772
333 10.2827644  2.407266  5.54457245 15.036287
334 11.5323943  2.321947  7.14614214 16.220191
335 -0.1877043  2.582876 -5.38621020  4.678702
337 19.1721712  2.500899 14.23054313 24.050124
349 11.5739994  2.477200  6.78128545 16.477170
350 17.0235524  2.510014 12.19354904 22.065002
351  7.4502851  2.437030  2.61715113 12.158819
352 14.0769121  2.382132  9.33587178 18.690864
369 11.3530451  2.256296  7.04175259 15.924706
370 15.2098951  2.614610 10.27315074 20.363150
371  9.4719282  2.380687  4.76055441 13.998305
372 11.7797366  2.306476  7.30258315 16.245749</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9313 13.089801 227.8584 279.4899
  [2,] 273.5985 11.178472 251.4902 295.6233
  [3,] 293.2657  9.552782 274.1739 312.4628
  [4,] 312.9329  8.380640 296.4258 329.6087
  [5,] 332.6001  7.867444 316.7363 348.2981
  [6,] 352.2673  8.138814 336.2071 368.6618
  [7,] 371.9345  9.125019 354.2268 390.0455
  [8,] 391.6017 10.628910 370.7558 412.8607
  [9,] 411.2689 12.464492 387.2836 436.2280
 [10,] 430.9361 14.506394 402.8981 460.0835
 [11,] 211.4819 13.427599 185.4879 237.4527
 [12,] 213.2390 11.521607 190.9879 235.9131
 [13,] 214.9961  9.899532 195.8914 234.3653
 [14,] 216.7533  8.721258 199.2357 233.7785
 [15,] 218.5104  8.180845 202.4830 234.4071
 [16,] 220.2675  8.402286 203.4550 236.3635
 [17,] 222.0246  9.331499 203.0967 239.7703
 [18,] 223.7818 10.787105 202.0646 244.4244
 [19,] 225.5389 12.587799 200.8613 249.7620
 [20,] 227.2960 14.606506 198.9092 255.6475
 [21,] 213.1210 12.914983 187.6198 238.0683
 [22,] 217.9880 11.071069 195.9180 239.0942
 [23,] 222.8549  9.506151 203.7850 241.3317
 [24,] 227.7218  8.378056 211.2263 244.2592
 [25,] 232.5888  7.876757 217.2470 248.2919
 [26,] 237.4557  8.119195 221.6004 253.4660
 [27,] 242.3226  9.045769 224.7010 260.0243
 [28,] 247.1896 10.476502 226.6692 267.4869
 [29,] 252.0565 12.235801 227.8670 276.0867
 [30,] 256.9235 14.202082 228.8092 284.8389
 [31,] 274.6278 13.671040 248.1994 302.2273
 [32,] 280.3399 11.671107 257.6524 303.7010
 [33,] 286.0520  9.946163 266.5812 305.5938
 [34,] 291.7641  8.662079 274.9345 308.9598
 [35,] 297.4763  8.033124 281.7775 313.3262
 [36,] 303.1884  8.211246 287.3757 319.2363
 [37,] 308.9005  9.149431 290.9693 326.5422
 [38,] 314.6126 10.648644 293.2845 335.3031
 [39,] 320.3247 12.508765 295.7712 345.1490
 [40,] 326.0369 14.592422 296.9719 355.2090
 [41,] 273.2750 13.292903 248.1627 300.3959
 [42,] 280.7281 11.401351 258.9856 303.4897
 [43,] 288.1811  9.780569 269.2419 307.3465
 [44,] 295.6342  8.585306 278.9222 312.5981
 [45,] 303.0873  8.008411 287.1365 319.0248
 [46,] 310.5404  8.181749 294.7538 326.9090
 [47,] 317.9935  9.062373 300.5001 335.9451
 [48,] 325.4466 10.473366 305.1321 346.0111
 [49,] 332.8997 12.232555 308.8769 357.0906
 [50,] 340.3528 14.211215 312.6585 368.6133
 [51,] 260.5675 12.376243 236.7773 285.5171
 [52,] 270.7178 10.622622 250.4019 292.0562
 [53,] 280.8682  9.153782 263.5154 299.4733
 [54,] 291.0186  8.125657 275.6148 307.0049
 [55,] 301.1689  7.716463 286.4521 316.3029
 [56,] 311.3193  8.021487 295.6241 327.1242
 [57,] 321.4697  8.968145 303.8876 339.4075
 [58,] 331.6200 10.382385 311.5266 352.2968
 [59,] 341.7704 12.101370 318.4301 365.6877
 [60,] 351.9208 14.013398 324.9775 379.5276
 [61,] 267.9180 12.749624 243.6324 293.7215
 [62,] 278.2008 10.974882 257.3100 300.5089
 [63,] 288.4836  9.483302 270.2268 307.6037
 [64,] 298.7663  8.426617 282.4076 315.9854
 [65,] 309.0491  7.979509 293.4663 325.0570
 [66,] 319.3319  8.241792 303.1423 335.9231
 [67,] 329.6146  9.152680 311.7251 347.9175
 [68,] 339.8974 10.545418 319.2897 361.1414
 [69,] 350.1802 12.256834 326.0865 374.9535
 [70,] 360.4629 14.171943 332.5103 388.9327
 [71,] 244.2908 12.112157 219.1850 267.4790
 [72,] 255.8232 10.464651 234.5344 275.9878
 [73,] 267.3555  9.115720 248.7912 285.1425
 [74,] 278.8879  8.213809 262.4510 295.1219
 [75,] 290.4203  7.913270 274.8470 305.6879
 [76,] 301.9527  8.279849 286.0211 317.6007
 [77,] 313.4851  9.234437 295.9489 330.6648
 [78,] 325.0175 10.619634 304.5997 344.8688
 [79,] 336.5499 12.290700 312.7414 359.3878
 [80,] 348.0823 14.146691 320.5865 374.7958
 [81,] 250.7434 13.449499 224.9523 277.8710
 [82,] 250.5557 11.469587 228.2711 273.6817
 [83,] 250.3680  9.775290 230.9736 269.7883
 [84,] 250.1803  8.538365 233.2107 267.1766
 [85,] 249.9926  7.974557 233.9816 266.0252
 [86,] 249.8048  8.223499 233.5605 266.2249
 [87,] 249.6171  9.219588 231.0683 267.7933
 [88,] 249.4294 10.757238 228.4007 270.1794
 [89,] 249.2417 12.640334 224.6446 273.5281
 [90,] 249.0540 14.737042 220.5116 277.4746
 [91,] 285.9547 13.198661 260.6340 311.6855
 [92,] 305.1269 11.308904 283.4440 327.3159
 [93,] 324.2990  9.699844 305.8050 343.5382
 [94,] 343.4712  8.531801 326.6101 360.3890
 [95,] 362.6434  8.000329 346.9179 378.8846
 [96,] 381.8156  8.229696 365.7834 398.4880
 [97,] 400.9877  9.162942 383.1936 419.5573
 [98,] 420.1599 10.616031 399.6745 441.3664
 [99,] 439.3321 12.407647 415.3618 464.0072
[100,] 458.5042 14.412089 430.5511 487.1439
[101,] 226.6302 13.282191 199.6710 251.0268
[102,] 238.2042 11.411727 214.9104 259.2407
[103,] 249.7782  9.813840 230.2728 268.3012
[104,] 261.3522  8.641091 244.3484 278.1456
[105,] 272.9262  8.080748 256.6737 288.5551
[106,] 284.5002  8.258424 267.9159 301.4294
[107,] 296.0742  9.131138 277.9496 314.7754
[108,] 307.6482 10.527433 286.7264 328.9748
[109,] 319.2222 12.269843 294.4704 343.7677
[110,] 330.7962 14.231805 302.1969 359.4223
[111,] 238.5464 13.193663 211.7702 264.1144
[112,] 255.5699 11.297859 232.9210 277.9239
[113,] 272.5935  9.685600 253.5252 291.7786
[114,] 289.6170  8.519413 273.1135 306.4945
[115,] 306.6406  7.996894 291.0712 323.0021
[116,] 323.6641  8.241393 307.7949 340.1842
[117,] 340.6877  9.191906 322.8942 358.9840
[118,] 357.7112 10.661241 336.7476 378.4086
[119,] 374.7348 12.467290 349.7957 399.2085
[120,] 391.7584 14.484645 363.4030 419.9589
[121,] 255.9953 12.588729 232.0612 280.9286
[122,] 263.4456 10.771925 243.2377 284.7392
[123,] 270.8959  9.245044 253.0792 289.3803
[124,] 278.3462  8.172243 262.3682 294.8175
[125,] 285.7965  7.744579 270.8439 301.1319
[126,] 293.2468  8.065338 277.9191 309.1489
[127,] 300.6970  9.055334 283.0762 318.4413
[128,] 308.1473 10.527427 287.1200 328.8455
[129,] 315.5976 12.309857 291.0093 339.6555
[130,] 323.0479 14.286941 294.8379 351.2981
[131,] 271.8458 12.532562 246.9245 296.0537
[132,] 285.9227 10.797757 264.5136 306.6609
[133,] 299.9996  9.352386 281.3135 317.8162
[134,] 314.0765  8.348160 297.8609 329.9710
[135,] 328.1534  7.953963 312.6286 343.3776
[136,] 342.2303  8.257626 325.6472 358.1639
[137,] 356.3072  9.190231 337.7002 374.2061
[138,] 370.3842 10.586851 348.9143 390.7992
[139,] 384.4611 12.290304 360.0500 408.4206
[140,] 398.5380 14.190520 370.4647 426.4584
[141,] 254.7913 11.744620 231.0503 277.5924
[142,] 266.1444 10.145539 245.8183 286.2030
[143,] 277.4974  8.837961 259.9408 294.9307
[144,] 288.8505  7.966738 273.2282 304.6778
[145,] 300.2035  7.681797 285.1079 315.6049
[146,] 311.5566  8.045672 295.6253 327.6402
[147,] 322.9096  8.979834 305.0693 340.3055
[148,] 334.2627 10.330719 313.6927 354.3916
[149,] 345.6157 11.957919 322.1276 369.1228
[150,] 356.9687 13.763781 330.1755 384.1674
[151,] 226.3250 13.954672 199.1757 252.3461
[152,] 241.5349 11.905013 218.5672 263.7887
[153,] 256.7448 10.119197 236.9974 275.6663
[154,] 271.9547  8.760100 254.8012 288.6256
[155,] 287.1646  8.046919 271.5507 302.6170
[156,] 302.3745  8.151003 286.2798 318.2454
[157,] 317.5844  9.044178 299.8511 334.6050
[158,] 332.7943 10.527479 312.0634 352.8795
[159,] 348.0042 12.390757 323.5499 371.8487
[160,] 363.2141 14.488143 334.9913 390.8393
[161,] 252.1419 12.540315 227.5700 276.8383
[162,] 261.6138 10.814905 240.2876 282.6898
[163,] 271.0858  9.380840 252.7661 289.0718
[164,] 280.5577  8.388892 264.1326 296.9276
[165,] 290.0296  8.005135 274.2292 305.7079
[166,] 299.5015  8.314218 282.7700 315.9121
[167,] 308.9735  9.246923 290.4158 326.9166
[168,] 318.4454 10.640503 296.9102 339.2730
[169,] 327.9173 12.339788 303.0477 351.8819
[170,] 337.3893 14.235721 308.9482 364.9895
[171,] 263.5187 12.151756 239.8226 287.2087
[172,] 275.2985 10.506352 254.4860 295.7881
[173,] 287.0782  9.151031 269.5307 305.1370
[174,] 298.8579  8.230369 282.4278 314.8330
[175,] 310.6377  7.897863 294.9811 325.4489
[176,] 322.4174  8.225155 305.9683 338.4167
[177,] 334.1971  9.141651 315.6210 351.7215
[178,] 345.9769 10.494096 324.5937 365.7688
[179,] 357.7566 12.137627 333.1181 380.7567
[180,] 369.5364 13.969881 341.1335 396.4234</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.3713118 13.089801  -29.9299149  21.7016489
  [2,]  -14.8938119 11.178472  -36.9185869   7.2144710
  [3,]  -42.4651119  9.552782  -61.6621873 -23.3732638
  [4,]    8.5068880  8.380640   -8.1688783  25.0139506
  [5,]   24.2517880  7.867444    8.5538165  40.1156199
  [6,]   62.4227879  8.138814   46.0282678  78.4829674
  [7,]   10.2692878  9.125019   -7.8416534  27.9770330
  [8,] -101.4531122 10.628910 -122.7121405 -80.6072475
  [9,]   19.3163877 12.464492   -5.6427309  43.3017354
 [10,]   35.4173877 14.506394    6.2700091  63.4553759
 [11,]   11.2520341 13.427599  -14.7188105  37.2460203
 [12,]   -7.9731963 11.521607  -30.6472852  14.2778818
 [13,]  -12.0183267  9.899532  -31.3875060   7.0863902
 [14,]  -12.0462571  8.721258  -29.0715356   5.4713118
 [15,]  -10.7942875  8.180845  -26.6909601   5.2331262
 [16,]   -4.3057179  8.402286  -20.4016615  12.5067972
 [17,]   -8.3943484  9.331499  -26.1399550  10.5335766
 [18,]   -6.0545788 10.787105  -26.6972418  15.6626126
 [19,]   -1.2432092 12.587799  -25.4663028  23.4343906
 [20,]   10.0181604 14.606506  -18.3332946  38.4050403
 [21,]  -14.0671346 12.914983  -39.0143647  11.4341445
 [22,]  -23.6557701 11.071069  -44.7620405  -1.5858485
 [23,]   11.4650945  9.506151   -7.0116947  30.5349992
 [24,]    5.1197590  8.378056  -11.4176273  21.6152973
 [25,]   -3.2813765  7.876757  -18.9844530  12.0603734
 [26,]  -16.9978120  8.119195  -33.0080788  -1.1425369
 [27,]   -6.9018474  9.045769  -24.6034864  10.7198475
 [28,]    8.5615171 10.476502  -11.7357564  29.0819469
 [29,]    8.9559816 12.235801  -15.0741623  33.1454534
 [30,]   -9.4081538 14.202082  -37.3235957  18.7061225
 [31,]   46.9148241 13.671040   19.3152813  73.3432489
 [32,]   20.0603046 11.671107   -3.3008252  42.7478028
 [33,]   -2.1955150  9.946163  -21.7373479  17.2752809
 [34,]   -6.6311345  8.662079  -23.8268319  10.1984511
 [35,]  -11.6789540  8.033124  -27.5289387   4.0197923
 [36,]   -5.6028736  8.211246  -21.6508182  10.2097862
 [37,]  -28.6608931  9.149431  -46.3026314 -10.7296725
 [38,]    3.6486873 10.648644  -17.0417817  24.9767644
 [39,]  -14.9752322 12.508765  -39.7995002   9.5782617
 [40,]   28.0118482 14.592422   -1.1603175  57.0768394
 [41,]   14.3329490 13.292903  -12.7879719  39.4452347
 [42,]    4.2719499 11.401351  -18.4896720  26.0143758
 [43,]   13.6394508  9.780569   -5.5258623  32.5786929
 [44,]   24.4810517  8.585306    7.5171967  41.1930661
 [45,]   13.1899526  8.008411   -2.7475447  29.1407700
 [46,]  -17.2217466  8.181749  -33.5902685  -1.4350794
 [47,]  -27.9185457  9.062373  -45.8700717 -10.4251358
 [48,]    9.3710552 10.473366  -11.1933786  29.6855592
 [49,]  -39.1528439 12.232555  -63.3437186 -15.1299807
 [50,]   31.2282570 14.211215    2.9677781  58.9225515
 [51,]  -25.7068614 12.376243  -50.6565398  -1.9167047
 [52,]  -27.9060289 10.622622  -49.2444279  -7.5900600
 [53,]   -7.9068963  9.153782  -26.5119760   9.4459182
 [54,]   18.7502362  8.125657    2.7639281  34.1539740
 [55,]   16.2939687  7.716463    1.1600169  31.0108460
 [56,]   -1.3216987  8.021487  -17.1266100  14.3734722
 [57,]  132.6922338  8.968145  114.7544487 150.2743424
 [58,]   15.2110663 10.382385   -5.4656544  35.3045288
 [59,]  -11.4701011 12.101370  -35.3874188  11.8701807
 [60,]  -98.0563686 14.013398 -125.6631912 -71.1131475
 [61,]   15.9243522 12.749624   -9.8791411  40.2100454
 [62,]   11.3541877 10.974882  -10.9538970  32.2449528
 [63,]  -11.7142767  9.483302  -30.8344327   6.5425327
 [64,]    1.0433589  8.426617  -16.1757180  17.4020539
 [65,]  -11.8781055  7.979509  -27.8860077   3.7046819
 [66,]   18.8346300  8.241792    2.2434180  35.0241650
 [67,]    2.4118656  9.152680  -15.8909960  20.3013936
 [68,]    8.9425012 10.545418  -12.3015014  29.5502035
 [69,]  -16.8201632 12.256834  -41.5935313   7.2734813
 [70,]    1.5798723 14.171943  -26.8898601  29.5324579
 [71,]   21.1823441 12.112157   -2.0059168  46.2881039
 [72,]   20.3780499 10.464651    0.2133749  41.6667651
 [73,]  -23.9908444  9.115720  -41.7777884  -5.4265374
 [74,]  -24.2156387  8.213809  -40.4495629  -7.7786798
 [75,]  -11.3959329  7.913270  -26.6634917   4.1774344
 [76,]  -17.7615272  8.279849  -33.4094830  -1.8299090
 [77,]   -7.9603215  9.234437  -25.1400020   9.5758619
 [78,]    6.5053843 10.619634  -13.3458870  26.9231946
 [79,]   -0.8030100 12.290700  -23.6408881  23.0055033
 [80,]   29.2166957 14.146691    2.5031598  56.7125464
 [81,]   -9.1350695 13.449499  -36.2626849  16.6559808
 [82,]   23.3915348 11.469587    0.2654851  45.6761237
 [83,]    4.1227391  9.775290  -15.2975905  23.5171064
 [84,]   20.6218435  8.538365    3.6254936  37.5914359
 [85,]    1.4593478  7.974557  -14.5733446  17.4702760
 [86,]    4.8313521  8.223499  -11.5887493  21.0757164
 [87,]   -4.1648436  9.219588  -22.3410156  14.3840162
 [88,]  -14.1184393 10.757238  -34.8683567   6.9103447
 [89,]  -13.4876350 12.640334  -37.7739850  11.1094782
 [90,]  -11.8074306 14.737042  -40.2279733  16.7349555
 [91,]   26.4118929 13.198661    0.6810681  51.7325688
 [92,]    8.6789217 11.308904  -13.5100855  30.3618123
 [93,]  -32.6878494  9.699844  -51.9269646 -14.1937940
 [94,]    2.6509794  8.531801  -14.2667583  19.5121395
 [95,]    3.0890082  8.000329  -13.1521960  18.8145108
 [96,]   10.0229371  8.229696   -6.6495231  26.0551282
 [97,]    3.2723659  9.162942  -15.2972242  21.0665106
 [98,]   -3.4676052 10.616031  -24.6740747  17.0177623
 [99,]   16.5322236 12.407647   -8.1429410  40.5024969
[100,]    0.4124524 14.412089  -28.2272123  28.3655930
[101,]    9.4730168 13.282191  -14.9235654  36.4321521
[102,]   -7.8874825 11.411727  -28.9239925  15.4063243
[103,]  -10.8525819  9.813840  -29.3756021   8.6528415
[104,]   -6.4301813  8.641091  -23.2236248  10.5736414
[105,]  -22.2158807  8.080748  -37.8447839  -5.9634086
[106,]  -14.7257801  8.258424  -31.6549866   1.8584545
[107,]  -14.5093794  9.131138  -33.2106488   3.6152175
[108,]    0.4538212 10.527433  -20.8728297  21.3756047
[109,]   17.0584218 12.269843   -7.4871025  41.8102468
[110,]   20.8489224 14.231805   -7.7771846  49.4481717
[111,]   17.7504203 13.193663   -7.8176066  44.5266248
[112,]  -12.1156321 11.297859  -34.4695673  10.5332552
[113,]  -16.3888846  9.685600  -35.5739738   2.6794462
[114,]  -34.0899370  8.519413  -50.9674197 -17.5864260
[115,]  -37.7240895  7.996894  -54.0855565 -22.1547102
[116,]    6.0605581  8.241393  -10.4595205  21.9298450
[117,]   38.7568056  9.191906   20.4604874  56.5503018
[118,]    5.2071532 10.661241  -15.4901673  26.1708175
[119,]   19.7524008 12.467290   -4.7213217  44.6915025
[120,]   -2.7056517 14.484645  -30.9061896  25.6497134
[121,]   -5.4688278 12.588729  -30.4020893  18.4652985
[122,]   36.6119871 10.771925   15.3184096  56.8199140
[123,]   -1.0019980  9.245044  -19.4863945  16.8146574
[124,]    2.2429169  8.172243  -14.2283916  18.2209258
[125,]  -13.9690682  7.744579  -29.3045405   0.9835192
[126,]   11.3868467  8.065338   -4.5152687  26.7145221
[127,]  -12.9504384  9.055334  -30.6947213   4.6704347
[128,]  -41.5518235 10.527427  -62.2499507 -20.5244788
[129,]    5.9441914 12.309857  -18.1136531  30.5325270
[130,]   24.5176063 14.286941   -3.7325781  52.7276137
[131,]  -50.1686695 12.532562  -74.3766477 -25.2473610
[132,]   12.2712184 10.797757   -8.4669565  33.6802702
[133,]   26.8789063  9.352386    9.0622888  45.5650320
[134,]   32.7789942  8.348160   16.8844794  48.9946014
[135,]   20.5867822  7.953963    5.3625808  36.1116056
[136,]   10.5983701  8.257626   -5.3351690  27.1814716
[137,]   -1.8806420  9.190231  -19.7794855  16.7264133
[138,]   -9.9515540 10.586851  -30.3665844  11.5183124
[139,]   -8.8204661 12.290304  -32.7800136  15.5906444
[140,]   -9.9962782 14.190520  -37.9167468  18.0769601
[141,]   17.1321629 11.744620   -5.6689227  40.8732452
[142,]    2.2925178 10.145539  -17.7660658  22.6186328
[143,]  -20.2550272  8.837961  -37.6882950  -2.6983524
[144,]  -11.1938723  7.966738  -27.0211936   4.4284319
[145,]   14.6186826  7.681797   -0.7826548  29.7143402
[146,]    5.6569375  8.045672  -10.4266533  21.5882253
[147,]  -24.7743076  8.979834  -42.1702192  -6.9339707
[148,]   13.8602473 10.330719   -6.2686781  34.4301512
[149,]   -5.3356977 11.957919  -28.8427801  18.1524072
[150,]    9.5443572 13.763781  -17.6542791  36.3376389
[151,]   -1.0610092 13.954672  -27.0821198  26.0882532
[152,]   -7.0114042 11.905013  -29.2652029  15.9563391
[153,]  -17.8439993 10.119197  -36.7654528   1.9034096
[154,]  -31.4816943  8.760100  -48.1525620 -14.3282338
[155,]  -19.6272894  8.046919  -35.0796876  -4.0133879
[156,]   41.8192155  8.151003   25.9482817  57.9138923
[157,]  -36.4362795  9.044178  -53.4569053 -18.7029873
[158,]   14.7912254 10.527479   -5.2939867  35.5221189
[159,]   17.1588303 12.390757   -6.6856998  41.6130893
[160,]    9.0147353 14.488143  -18.6105463  37.2375454
[161,]   17.7384950 12.540315   -6.9579375  42.3103530
[162,]   10.8289668 10.814905  -10.2469550  32.1552400
[163,]    6.8131386  9.380840  -11.1729303  25.1328212
[164,]    1.2318103  8.388892  -15.1380984  17.6569474
[165,]  -10.8591179  8.005135  -26.5373884   4.9413497
[166,]  -14.9895462  8.314218  -31.4000622   1.7420163
[167,]  -49.7076744  9.246923  -67.6508409 -31.1499898
[168,]  -13.8148026 10.640503  -34.6424494   7.7204091
[169,]   22.8633691 12.339788   -1.1011823  47.7329910
[170,]   32.0799409 14.235721    4.4796651  60.5210248
[171,]    5.8929707 12.151756  -17.7969810  29.5891055
[172,]   -1.8244660 10.506352  -22.3140804  18.9880043
[173,]   10.5185974  9.151031   -7.5402345  28.0661190
[174,]   11.7736607  8.230369   -4.2013527  28.2038170
[175,]  -23.4650759  7.897863  -38.2762661  -7.8084942
[176,]    7.1901874  8.225155   -8.8091172  23.6393300
[177,]    0.2846508  9.141651  -17.2397042  18.8608070
[178,]   -2.7569859 10.494096  -22.5489247  18.6261555
[179,]   11.3850775 12.137627  -11.6149856  36.0236050
[180,]   -5.4127592 13.969881  -32.2998259  22.9901226</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.2  3.3
looic      1769.4 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   433       
 (0.5, 0.7]   (ok)         1    0.6%   117       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.5
p_loo        34.6  8.7
looic      1723.3 45.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   894       
 (0.5, 0.7]   (ok)         7    3.9%   383       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   3    1.7%   11        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.1      11.8  
fit_sleep1 -91.8      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.2  3.3
looic      1769.4 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   433       
 (0.5, 0.7]   (ok)         1    0.6%   117       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.5
p_loo        34.6  8.7
looic      1723.3 45.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   894       
 (0.5, 0.7]   (ok)         7    3.9%   383       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   3    1.7%   11        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.6     22.5        34.6    8.7   1723.3
fit_sleep2  -23.1      11.8  -884.7     14.3        19.2    3.3   1769.4
fit_sleep1  -91.8      21.2  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   45.0  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.414106e-40 9.522900e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.87      1.53     0.32     5.28       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.13      1.53    -3.24      2.8       5.55      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.26 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.5      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.3         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.0          
 [52] processx_3.8.1       pkgbuild_1.4.0       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.0        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.0         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-1       
 [85] grid_4.3.0           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.31       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
