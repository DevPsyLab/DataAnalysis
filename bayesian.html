<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing
adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.92      6.86    15.47    42.55 1.00     2058     2541
sd(Days)                6.54      1.52     4.13    10.12 1.01     1519     2154
cor(Intercept,Days)     0.10      0.30    -0.44     0.69 1.00     1047     1901

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.28      7.37   236.51   265.53 1.00     1577     2523
Days         10.40      1.73     7.03    13.87 1.00     1492     2127

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.93      1.55    23.13    29.33 1.00     3315     3102

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.2299  13.03181 227.7122 279.5718
309 211.5198  13.59858 185.0577 238.0270
310 212.5733  13.15269 187.0566 238.4012
330 274.4353  13.33140 249.3076 300.7035
331 272.9740  13.38490 246.7766 299.2399
332 260.2670  12.36171 235.7152 284.6687
333 267.9267  12.39077 244.4125 293.0670
334 244.3699  12.33204 219.6775 267.6444
335 250.3798  13.73203 224.1202 278.5008
337 286.0900  12.85753 261.1048 310.9771
349 227.0440  12.66583 201.4875 251.1571
350 238.9997  13.45885 212.5442 264.9143
351 255.5987  12.26815 232.3321 280.3857
352 271.9889  12.64091 248.0130 297.1838
369 254.7336  12.39770 230.8601 279.4556
370 226.3166  13.59306 198.4714 251.6995
371 252.1301  11.92842 229.0077 276.2441
372 263.3521  12.09350 240.1139 287.2207

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5576760  2.509643 14.8774923 24.500804
309  1.7876142  2.510151 -3.0147764  6.707671
310  4.9464557  2.477227  0.1516044  9.818568
330  5.7732757  2.547479  0.7051303 10.631778
331  7.5225124  2.490369  2.6312393 12.324841
332 10.2011257  2.353903  5.5893605 14.835597
333 10.3161464  2.397802  5.4032309 15.034011
334 11.4795475  2.348002  6.9909458 16.145388
335 -0.1439188  2.607207 -5.3933780  4.898540
337 19.0697161  2.427011 14.3134414 23.880516
349 11.4667256  2.425557  6.9473912 16.321006
350 16.9863547  2.555012 12.1556135 22.070579
351  7.5246573  2.332483  2.8895004 12.020766
352 14.0452526  2.417589  9.2004086 18.693890
369 11.3433541  2.368151  6.6679732 15.985039
370 15.1473649  2.541717 10.3942908 20.204177
371  9.5208344  2.294016  4.8867012 13.965325
372 11.8120124  2.339623  7.1699037 16.362192</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.2299 13.031807 227.7122 279.5718
  [2,] 273.7875 11.161025 251.3616 295.5279
  [3,] 293.3452  9.586740 274.3459 311.5310
  [4,] 312.9029  8.475806 296.5838 329.2426
  [5,] 332.4606  8.023067 317.1111 347.9651
  [6,] 352.0182  8.336459 335.5268 367.9022
  [7,] 371.5759  9.339170 352.8847 389.6712
  [8,] 391.1336 10.841598 369.5113 412.4025
  [9,] 410.6913 12.667163 385.3324 435.5482
 [10,] 430.2489 14.695932 400.3673 459.0534
 [11,] 211.5198 13.598583 185.0577 238.0270
 [12,] 213.3075 11.671575 190.7730 236.4643
 [13,] 215.0951 10.006577 195.9292 234.7792
 [14,] 216.8827  8.754382 199.6766 233.5468
 [15,] 218.6703  8.108548 202.5328 234.1732
 [16,] 220.4579  8.213380 204.0743 236.1620
 [17,] 222.2455  9.042808 204.4717 239.7969
 [18,] 224.0331 10.425299 203.6476 244.7884
 [19,] 225.8208 12.173867 202.5740 249.5540
 [20,] 227.6084 14.153479 200.6817 254.9576
 [21,] 212.5733 13.152686 187.0566 238.4012
 [22,] 217.5198 11.307540 195.7395 239.8029
 [23,] 222.4663  9.746850 203.2734 241.6441
 [24,] 227.4127  8.626414 209.9719 244.2195
 [25,] 232.3592  8.130330 216.2054 248.4196
 [26,] 237.3056  8.370354 220.9931 253.6736
 [27,] 242.2521  9.289602 224.3080 260.5362
 [28,] 247.1985 10.714658 226.1156 268.2157
 [29,] 252.1450 12.473347 227.5395 276.8228
 [30,] 257.0914 14.444313 229.0809 285.9350
 [31,] 274.4353 13.331405 249.3076 300.7035
 [32,] 280.2086 11.352406 258.5201 302.3298
 [33,] 285.9819  9.644023 267.1749 304.9633
 [34,] 291.7551  8.373561 275.1135 307.8259
 [35,] 297.5284  7.759200 282.1129 312.6402
 [36,] 303.3017  7.954441 287.3968 318.6232
 [37,] 309.0750  8.906199 291.4500 326.6432
 [38,] 314.8482 10.408983 294.5750 335.1844
 [39,] 320.6215 12.261842 296.6561 344.6305
 [40,] 326.3948 14.329616 298.2245 354.4457
 [41,] 272.9740 13.384902 246.7766 299.2399
 [42,] 280.4966 11.455969 258.2398 303.1457
 [43,] 288.0191  9.784002 268.6936 307.7812
 [44,] 295.5416  8.521623 278.6512 312.5061
 [45,] 303.0641  7.868499 287.5946 318.3257
 [46,] 310.5866  7.975736 295.5311 326.4920
 [47,] 318.1091  8.815630 301.4502 335.2383
 [48,] 325.6316 10.208926 305.8871 345.9585
 [49,] 333.1541 11.963815 309.9444 356.8857
 [50,] 340.6767 13.944441 313.6603 367.8508
 [51,] 260.2670 12.361710 235.7152 284.6687
 [52,] 270.4681 10.681582 249.1665 291.9731
 [53,] 280.6692  9.298507 262.6153 299.3709
 [54,] 290.8703  8.361219 274.6976 307.1904
 [55,] 301.0715  8.027420 285.6350 316.4660
 [56,] 311.2726  8.369629 295.0573 327.6956
 [57,] 321.4737  9.313626 303.9231 339.7060
 [58,] 331.6749 10.701322 311.0932 352.4775
 [59,] 341.8760 12.384453 317.9792 365.9730
 [60,] 352.0771 14.258779 323.8677 379.4655
 [61,] 267.9267 12.390770 244.4125 293.0670
 [62,] 278.2429 10.605285 258.1949 299.3217
 [63,] 288.5590  9.105594 271.1237 306.4207
 [64,] 298.8752  8.052984 283.5595 314.9130
 [65,] 309.1913  7.634668 294.5254 324.3654
 [66,] 319.5075  7.951394 304.2275 335.0737
 [67,] 329.8236  8.925250 312.4731 347.5400
 [68,] 340.1398 10.372773 319.7390 360.9135
 [69,] 350.4559 12.125497 326.1937 373.7586
 [70,] 360.7721 14.069820 332.9748 388.2608
 [71,] 244.3699 12.332042 219.6775 267.6444
 [72,] 255.8495 10.623095 234.5776 275.9081
 [73,] 267.3290  9.200395 248.7753 284.6049
 [74,] 278.8086  8.214050 262.5460 294.4146
 [75,] 290.2881  7.830721 275.1770 305.5598
 [76,] 301.7677  8.136092 285.9661 317.9082
 [77,] 313.2472  9.060796 295.9729 330.8104
 [78,] 324.7268 10.441565 304.9723 344.8908
 [79,] 336.2063 12.123562 313.2266 359.5659
 [80,] 347.6859 13.998624 320.6406 374.7204
 [81,] 250.3798 13.732033 224.1202 278.5008
 [82,] 250.2358 11.690027 227.7732 273.4969
 [83,] 250.0919  9.916642 230.6904 269.4758
 [84,] 249.9480  8.580086 233.0881 266.8807
 [85,] 249.8041  7.905127 234.2527 265.1743
 [86,] 249.6602  8.059730 233.6360 265.5728
 [87,] 249.5162  9.001250 231.6519 267.4378
 [88,] 249.3723 10.520495 229.1232 270.2333
 [89,] 249.2284 12.407021 224.9213 273.2608
 [90,] 249.0845 14.518354 219.6898 277.3753
 [91,] 286.0900 12.857526 261.1048 310.9771
 [92,] 305.1597 11.048514 283.2810 327.2123
 [93,] 324.2294  9.518620 305.5971 343.2216
 [94,] 343.2991  8.421363 327.0068 360.2989
 [95,] 362.3689  7.938221 347.2492 378.3759
 [96,] 381.4386  8.178760 365.6269 397.4014
 [97,] 400.5083  9.085683 382.7227 418.1124
 [98,] 419.5780 10.487513 398.8926 439.4623
 [99,] 438.6477 12.215031 414.4891 461.6460
[100,] 457.7174 14.149446 429.9974 484.3248
[101,] 227.0440 12.665834 201.4875 251.1571
[102,] 238.5107 10.881694 216.6800 259.1435
[103,] 249.9775  9.389666 231.2875 267.8989
[104,] 261.4442  8.347877 245.3277 277.4364
[105,] 272.9109  7.935675 258.0376 288.5697
[106,] 284.3776  8.247998 268.5044 301.0786
[107,] 295.8444  9.211441 278.0479 314.2135
[108,] 307.3111 10.650750 286.6598 328.3240
[109,] 318.7778 12.401329 294.4631 342.9951
[110,] 330.2445 14.349707 302.6282 358.4138
[111,] 238.9997 13.458854 212.5442 264.9143
[112,] 255.9861 11.517873 233.3789 278.1639
[113,] 272.9724  9.860945 253.6212 291.5684
[114,] 289.9588  8.652817 272.5579 306.4339
[115,] 306.9451  8.096938 290.8319 322.4506
[116,] 323.9315  8.325008 307.4680 340.0027
[117,] 340.9179  9.279401 322.4539 359.1447
[118,] 357.9042 10.768703 336.6445 378.9164
[119,] 374.8906 12.604715 350.0945 399.8292
[120,] 391.8769 14.657724 363.1603 420.7097
[121,] 255.5987 12.268148 232.3321 280.3857
[122,] 263.1234 10.558030 243.0137 284.4293
[123,] 270.6480  9.127840 253.0144 289.1680
[124,] 278.1727  8.126740 262.1754 294.0808
[125,] 285.6973  7.723424 270.3401 300.3974
[126,] 293.2220  8.008720 277.5442 308.3763
[127,] 300.7466  8.916775 283.2874 317.6404
[128,] 308.2713 10.283924 288.1564 327.7346
[129,] 315.7960 11.953672 292.6197 338.9965
[130,] 323.3206 13.816743 296.8325 350.4750
[131,] 271.9889 12.640913 248.0130 297.1838
[132,] 286.0342 10.880918 265.2303 307.6345
[133,] 300.0794  9.417301 281.9036 318.9534
[134,] 314.1247  8.406320 297.6600 330.8758
[135,] 328.1699  8.020993 312.5414 343.7359
[136,] 342.2152  8.348409 325.8656 358.4274
[137,] 356.2604  9.313701 337.9412 374.5596
[138,] 370.3057 10.746328 349.4900 391.4219
[139,] 384.3509 12.486457 360.1770 408.5290
[140,] 398.3962 14.423214 370.3815 426.5313
[141,] 254.7336 12.397698 230.8601 279.4556
[142,] 266.0769 10.675421 245.0535 286.8118
[143,] 277.4203  9.243517 259.2149 295.3420
[144,] 288.7636  8.254505 272.2104 304.6046
[145,] 300.1070  7.877017 284.4381 315.2538
[146,] 311.4504  8.195987 295.3403 327.3836
[147,] 322.7937  9.138779 305.1905 340.6685
[148,] 334.1371 10.539290 313.3123 355.4237
[149,] 345.4804 12.241416 321.0354 369.9958
[150,] 356.8238 14.136626 328.9035 384.7489
[151,] 226.3166 13.593056 198.4714 251.6995
[152,] 241.4639 11.648552 217.9806 263.4807
[153,] 256.6113  9.976322 236.7788 275.8132
[154,] 271.7587  8.734180 254.4138 288.9143
[155,] 286.9060  8.121911 270.8465 303.1989
[156,] 302.0534  8.280436 285.8126 318.5103
[157,] 317.2008  9.169867 299.1597 335.2504
[158,] 332.3481 10.607920 311.2088 352.7592
[159,] 347.4955 12.405245 322.3246 371.7745
[160,] 362.6429 14.428198 333.5335 390.8855
[161,] 252.1301 11.928421 229.0077 276.2441
[162,] 261.6510 10.304174 241.4334 282.2355
[163,] 271.1718  8.977182 253.6689 288.8033
[164,] 280.6926  8.094975 264.4638 296.5446
[165,] 290.2135  7.809767 275.1783 305.5480
[166,] 299.7343  8.184212 283.9628 315.8272
[167,] 309.2551  9.137572 291.0606 327.3421
[168,] 318.7760 10.513521 297.6531 339.5092
[169,] 328.2968 12.169555 303.8694 352.2141
[170,] 337.8176 14.006678 309.7785 365.2231
[171,] 263.3521 12.093497 240.1139 287.2207
[172,] 275.1641 10.415182 255.2194 296.0254
[173,] 286.9761  9.035876 269.9359 304.9666
[174,] 298.7882  8.109608 283.0602 314.7603
[175,] 310.6002  7.799494 295.6438 325.7901
[176,] 322.4122  8.175949 306.5960 338.1363
[177,] 334.2242  9.154663 316.6399 351.8727
[178,] 346.0362 10.569638 325.0017 366.2094
[179,] 357.8482 12.270872 333.3282 381.3290
[180,] 369.6602 14.155530 341.2992 396.9174</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.6698652 13.031807  -30.0117803  21.8477673
  [2,]  -15.0828412 11.161025  -36.8231521   7.3431336
  [3,]  -42.5446171  9.586740  -60.7303673 -23.5453050
  [4,]    8.5369069  8.475806   -7.8027528  24.8560069
  [5,]   24.3913309  8.023067    8.8868187  39.7408110
  [6,]   62.6718550  8.336459   46.7879345  79.1632652
  [7,]   10.6278790  9.339170   -7.4674190  29.3191390
  [8,] -100.9849969 10.841598 -122.2539002 -79.3627092
  [9,]   19.8940271 12.667163   -4.9629152  45.2529019
 [10,]   36.1045511 14.695932    7.3000573  65.9862397
 [11,]   11.2140624 13.598583  -15.2931251  37.6761741
 [12,]   -8.0416518 11.671575  -31.1985127  14.4927677
 [13,]  -12.1172660 10.006577  -31.8014173   7.0486120
 [14,]  -12.1756802  8.754382  -28.8397931   5.0303594
 [15,]  -10.9541944  8.108548  -26.4571402   5.1832852
 [16,]   -4.4961086  8.213380  -20.2001757  11.8874614
 [17,]   -8.6152228  9.042808  -26.1665540   9.1585783
 [18,]   -6.3059370 10.425299  -27.0612232  14.0795723
 [19,]   -1.5250512 12.173867  -25.2582543  21.7216525
 [20,]    9.7058346 14.153479  -17.6433934  36.6325223
 [21,]  -13.5194400 13.152686  -39.3473145  11.9972556
 [22,]  -23.1875957 11.307540  -45.4706597  -1.4072703
 [23,]   11.8537486  9.746850   -7.3240526  31.0466199
 [24,]    5.4288929  8.626414  -11.3778767  22.8696511
 [25,]   -3.0517628  8.130330  -19.1121521  13.1019626
 [26,]  -16.8477185  8.370354  -33.2157260  -0.5351568
 [27,]   -6.8312742  9.289602  -25.1153647  11.1128303
 [28,]    8.5525701 10.714658  -12.4646113  29.6355135
 [29,]    8.8675144 12.473347  -15.8102924  33.4729616
 [30,]   -9.5761413 14.444313  -38.4196519  18.4344397
 [31,]   47.1072807 13.331405   20.8391498  72.2349829
 [32,]   20.1916049 11.352406   -1.9296341  41.8801322
 [33,]   -2.1253708  9.644023  -21.1068456  16.6815713
 [34,]   -6.6221465  8.373561  -22.6928996  10.0194609
 [35,]  -11.7311222  7.759200  -26.8428795   3.6843730
 [36,]   -5.7161980  7.954441  -21.0377452  10.1886666
 [37,]  -28.8353737  8.906199  -46.4035577 -11.2104361
 [38,]    3.4130506 10.408983  -16.9230575  23.6863048
 [39,]  -15.2720251 12.261842  -39.2809702   8.6934073
 [40,]   27.6538991 14.329616   -0.3970188  55.8242204
 [41,]   14.6338574 13.384902  -11.6320069  40.8313004
 [42,]    4.5034450 11.455969  -18.1456544  26.7601863
 [43,]   13.8015326  9.784002   -5.9605540  33.1269518
 [44,]   24.5737202  8.521623    7.6091978  41.4640561
 [45,]   13.2132078  7.868499   -2.0483721  28.6826722
 [46,]  -17.2679046  7.975736  -33.1733318  -2.2123572
 [47,]  -28.0341170  8.815630  -45.1633480 -11.3752039
 [48,]    9.1860706 10.208926  -11.1408340  28.9306060
 [49,]  -39.4072418 11.963815  -63.1387952 -16.1975267
 [50,]   30.9044458 13.944441    3.7302569  57.9208308
 [51,]  -25.4063723 12.361710  -49.8080623  -0.8545615
 [52,]  -27.6562980 10.681582  -49.1613496  -6.3547345
 [53,]   -7.7079237  9.298507  -26.4095547  10.3459900
 [54,]   18.8984506  8.361219    2.5783869  35.0711998
 [55,]   16.3914248  8.027420    0.9968950  31.8279148
 [56,]   -1.2750009  8.369629  -17.6980446  14.9403369
 [57,]  132.6881734  9.313626  114.4559393 150.2388189
 [58,]   15.1562476 10.701322   -5.6464217  35.7378845
 [59,]  -11.5756781 12.384453  -35.6727131  12.3210831
 [60,]  -98.2127038 14.258779 -125.6010629 -70.0032721
 [61,]   15.9156524 12.390770   -9.2245632  39.4298940
 [62,]   11.3121060 10.605285   -9.7666608  31.3600585
 [63,]  -11.7897403  9.105594  -29.6513560   5.6455545
 [64,]    0.9345133  8.052984  -15.1032990  16.2502136
 [65,]  -12.0203331  7.634668  -27.1943973   2.6456251
 [66,]   18.6590206  7.951394    3.0927552  33.9390221
 [67,]    2.2028742  8.925250  -15.5135285  19.5534124
 [68,]    8.7001279 10.372773  -12.0736102  29.1009337
 [69,]  -17.0959185 12.125497  -40.3986276   7.1663387
 [70,]    1.2707352 14.069820  -26.2180210  29.0679935
 [71,]   21.1031634 12.332042   -2.1712676  45.7956474
 [72,]   20.3517159 10.623095    0.2930669  41.6235588
 [73,]  -23.9643316  9.200395  -41.2402127  -5.4105623
 [74,]  -24.1362791  8.214050  -39.7423239  -7.8736541
 [75,]  -11.2637266  7.830721  -26.5354308   3.8474469
 [76,]  -17.5764742  8.136092  -33.7170229  -1.7748668
 [77,]   -7.7224217  9.060796  -25.2855588   9.5518726
 [78,]    6.7961308 10.441565  -13.3679118  26.5506303
 [79,]   -0.4594167 12.123562  -23.8190479  22.5203291
 [80,]   29.6131358 13.998624    2.5786160  56.6584077
 [81,]   -8.7714506 13.732033  -36.8925057  17.4880682
 [82,]   23.7113682 11.690027    0.4502840  46.1739623
 [83,]    4.3987870  9.916642  -14.9850964  23.8002964
 [84,]   20.8541058  8.580086    3.9213649  37.7139945
 [85,]    1.6478247  7.905127  -13.7223833  17.1991539
 [86,]    4.9760435  8.059730  -10.9366236  21.0002134
 [87,]   -4.0639377  9.001250  -21.9855375  13.8003937
 [88,]  -14.0613189 10.520495  -34.9222623   6.1877633
 [89,]  -13.4743001 12.407021  -37.5066702  10.8328278
 [90,]  -11.8378813 14.518354  -40.1286980  17.5567931
 [91,]   26.2766142 12.857526    1.3895250  51.2618215
 [92,]    8.6460981 11.048514  -13.4065065  30.5247599
 [93,]  -32.6182179  9.518620  -51.6104361 -13.9858683
 [94,]    2.8230660  8.421363  -14.1766750  19.1154406
 [95,]    3.3635500  7.938221  -12.6434657  18.4831971
 [96,]   10.3999339  8.178760   -5.5628749  26.2115700
 [97,]    3.7518179  9.085683  -13.8523002  21.5374388
 [98,]   -2.8856982 10.487513  -22.7700209  17.7997354
 [99,]   17.2165858 12.215031   -5.7816650  41.3751511
[100,]    1.1992697 14.149446  -25.4080579  28.9193249
[101,]    9.0591993 12.665834  -15.0539129  34.6156747
[102,]   -8.1940263 10.881694  -28.8267923  13.6366722
[103,]  -11.0518519  9.389666  -28.9732986   7.6381106
[104,]   -6.5221775  8.347877  -22.5143565   9.5942748
[105,]  -22.2006031  7.935675  -37.8594446  -7.3272652
[106,]  -14.6032286  8.247998  -31.3042064   1.2700457
[107,]  -14.2795542  9.211441  -32.6486943   3.5168514
[108,]    0.7909202 10.650750  -20.2220096  21.4421545
[109,]   17.5027946 12.401329   -6.7144669  41.8174811
[110,]   21.4005690 14.349707   -6.7686673  49.0169332
[111,]   17.2970714 13.458854   -8.6175185  43.7525512
[112,]  -12.5317833 11.517873  -34.7096247  10.0753769
[113,]  -16.7678380  9.860945  -35.3637686   2.5834236
[114,]  -34.4316927  8.652817  -50.9068337 -17.0307599
[115,]  -38.0286474  8.096938  -53.5340787 -21.9154191
[116,]    5.7931979  8.325008  -10.2780076  22.2567280
[117,]   38.5266432  9.279401   20.2998044  56.9906187
[118,]    5.0141885 10.768703  -15.9979658  26.2738618
[119,]   19.5966339 12.604715   -5.3419637  44.3926589
[120,]   -2.8242208 14.657724  -31.6569578  25.8924278
[121,]   -5.0721977 12.268148  -29.8592424  18.1944370
[122,]   36.9342451 10.558030   15.6283198  57.0439119
[123,]   -0.7541122  9.127840  -19.2740680  16.8795025
[124,]    2.4164305  8.126740  -13.4917348  18.4137104
[125,]  -13.8699267  7.723424  -28.5700438   1.4873487
[126,]   11.4116160  8.008720   -3.7426917  27.0893885
[127,]  -13.0000413  8.916775  -29.8938182   4.4591709
[128,]  -41.6757985 10.283924  -61.1391463 -21.5609254
[129,]    5.7458442 11.953672  -17.4546818  28.9221495
[130,]   24.2448869 13.816743   -2.9095492  50.7330260
[131,]  -50.3118201 12.640913  -75.5066705 -26.3359240
[132,]   12.1597274 10.880918   -9.4405741  32.9636361
[133,]   26.7990748  9.417301    7.9250829  44.9749176
[134,]   32.7308223  8.406320   15.9796930  49.1954510
[135,]   20.5702697  8.020993    5.0042842  36.1987857
[136,]   10.6135172  8.348409   -5.5987330  26.9630900
[137,]   -1.8338354  9.313701  -20.1330060  16.4853804
[138,]   -9.8730879 10.746328  -30.9892997  10.9425886
[139,]   -8.7103405 12.486457  -32.8884223  15.4635614
[140,]   -9.8544930 14.423214  -37.9896376  18.1602287
[141,]   17.1899207 12.397698   -7.5320931  41.0633623
[142,]    2.3599666 10.675421  -18.3748969  23.3833559
[143,]  -20.1778876  9.243517  -38.0995705  -1.9725071
[144,]  -11.1070417  8.254505  -26.9479951   5.4462352
[145,]   14.7152041  7.877017   -0.4315585  30.3841211
[146,]    5.7631500  8.195987  -10.1700509  21.8731643
[147,]  -24.6584041  9.138779  -42.5332290  -7.0552433
[148,]   13.9858417 10.539290   -7.3008484  34.8106227
[149,]   -5.2004124 12.241416  -29.7157940  19.2445508
[150,]    9.6893334 14.136626  -18.2357919  37.6095951
[151,]   -1.0525750 13.593056  -26.4355081  26.7925624
[152,]   -6.9404399 11.648552  -28.9571764  16.5428736
[153,]  -17.7105048  9.976322  -36.9123710   2.1219838
[154,]  -31.2856698  8.734180  -48.4412963 -13.9407901
[155,]  -19.3687347  8.121911  -35.6615780  -3.3092114
[156,]   42.1403003  8.280436   25.6833701  58.3810987
[157,]  -36.0526646  9.169867  -54.1023057 -18.0115890
[158,]   15.2373704 10.607920   -5.1737203  36.3766758
[159,]   17.6675055 12.405245   -6.6115148  42.8384350
[160,]    9.5859406 14.428198  -18.6566991  38.6953410
[161,]   17.7502692 11.928421   -6.3636912  40.8726641
[162,]   10.7918348 10.304174   -9.7927264  31.0094201
[163,]    6.7271004  8.977182  -10.9043565  24.2300174
[164,]    1.0968659  8.094975  -14.7551008  17.3257389
[165,]  -11.0429685  7.809767  -26.3774580   3.9922432
[166,]  -15.2223029  8.184212  -31.3152045   0.5491920
[167,]  -49.9893373  9.137572  -68.0762623 -31.7947569
[168,]  -14.1453717 10.513521  -34.8785873   6.9775278
[169,]   22.4838939 12.169555   -1.4334052  46.9113255
[170,]   31.6515595 14.006678    4.2460932  59.6906967
[171,]    6.0595795 12.093497  -17.8090085  29.2977628
[172,]   -1.6901328 10.415182  -22.5514244  18.2546330
[173,]   10.6206548  9.035876   -7.3698473  27.6608500
[174,]   11.8434424  8.109608   -4.1286590  27.5713970
[175,]  -23.4275699  7.799494  -38.6175019  -8.4711836
[176,]    7.1954177  8.175949   -8.5287293  23.0116269
[177,]    0.2576053  9.154663  -17.3909161  17.8418648
[178,]   -2.8163071 10.569638  -22.9894535  18.2182061
[179,]   11.2934806 12.270872  -12.1873439  35.8134593
[180,]   -5.5366318 14.155530  -32.7937880  22.8244295</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.4  3.3
looic      1769.8 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1350      
 (0.5, 0.7]   (ok)         2    1.1%   196       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.5 22.5
p_loo        34.4  8.6
looic      1723.0 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   781       
 (0.5, 0.7]   (ok)         4    2.2%   437       
   (0.7, 1]   (bad)        3    1.7%   23        
   (1, Inf)   (very bad)   1    0.6%   16        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.4      11.7  
fit_sleep1 -91.8      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.4  3.3
looic      1769.8 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1350      
 (0.5, 0.7]   (ok)         2    1.1%   196       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.5 22.5
p_loo        34.4  8.6
looic      1723.0 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   781       
 (0.5, 0.7]   (ok)         4    2.2%   437       
   (0.7, 1]   (bad)        3    1.7%   23        
   (1, Inf)   (very bad)   1    0.6%   16        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.5     22.5        34.4    8.6   1723.0
fit_sleep2  -23.4      11.7  -884.9     14.4        19.4    3.3   1769.8
fit_sleep1  -91.8      21.1  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.9  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.323061e-40 6.823702e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.87      1.64     0.11     5.46       0.05      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.13      1.64    -3.47     3.07       5.16      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-33         Matrix_1.5-4.1     

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.5      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.1       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.32       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
