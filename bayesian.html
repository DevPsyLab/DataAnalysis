<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.09      6.83    16.12    42.44 1.00     1883     2658
sd(Days)                6.57      1.53     4.12    10.05 1.00     1377     2049
cor(Intercept,Days)     0.11      0.30    -0.47     0.67 1.00     1096     2079

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.14      7.34   236.77   265.80 1.00     1655     2329
Days         10.44      1.67     7.06    13.59 1.00     1266     1773

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.88      1.51    23.15    29.03 1.00     3746     2841

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.3132  12.97809 228.5126 279.6774
309 211.1064  12.83183 185.5857 235.2285
310 212.8733  13.10363 186.3268 237.6249
330 274.2298  13.31587 248.9539 300.6808
331 273.0148  13.01730 248.7018 300.1781
332 260.3364  12.41737 236.0902 284.1921
333 267.7943  12.19484 244.1086 292.3164
334 244.4604  12.25592 220.2534 268.1761
335 250.3780  13.47769 225.5570 276.8621
337 286.2618  13.01889 261.4869 311.6700
349 226.6550  12.97206 201.0875 251.0604
350 238.7986  13.00622 213.3216 263.5175
351 255.8526  12.52754 231.0779 280.8484
352 272.1226  12.55318 247.8268 296.9909
369 254.5106  12.07227 231.0401 278.2477
370 226.3501  13.25835 199.5214 251.1072
371 252.1848  12.38352 228.2632 277.1408
372 263.8335  12.37422 240.1390 288.2848

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5838818  2.476307 14.7647117 24.546095
309  1.8133711  2.466939 -3.0948173  6.770917
310  4.9360447  2.467322  0.1672749  9.971339
330  5.7557467  2.524346  0.7921052 10.546066
331  7.5424416  2.431282  2.6319255 12.145505
332 10.2242288  2.356227  5.4263203 14.766184
333 10.3242619  2.328871  5.7322247 14.804297
334 11.4883505  2.361330  6.9491093 16.186049
335 -0.2012115  2.601405 -5.3679922  4.717945
337 19.0999022  2.470752 14.2000600 23.945394
349 11.5208903  2.467680  6.8794564 16.463827
350 16.9868847  2.488948 12.2804548 21.911180
351  7.4731021  2.411818  2.7117992 12.293545
352 14.0512413  2.410694  9.1991296 18.732715
369 11.3752813  2.311694  6.7983138 15.757270
370 15.1876119  2.515007 10.4488786 20.163300
371  9.5067259  2.395525  4.7818296 14.251802
372 11.7633107  2.366063  7.0274484 16.429133</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.3132 12.978089 228.5126 279.6774
  [2,] 273.8970 11.119394 251.8615 296.0978
  [3,] 293.4809  9.545431 274.9057 312.2910
  [4,] 313.0648  8.417468 297.0093 329.9222
  [5,] 332.6487  7.928208 317.3828 348.4585
  [6,] 352.2326  8.192886 336.1749 368.6314
  [7,] 371.8165  9.146283 354.0518 389.8952
  [8,] 391.4003 10.604234 370.5692 412.2870
  [9,] 410.9842 12.389886 386.8094 435.5276
 [10,] 430.5681 14.381688 402.3261 459.4298
 [11,] 211.1064 12.831833 185.5857 235.2285
 [12,] 212.9198 10.977076 190.9686 233.8633
 [13,] 214.7332  9.407871 196.3036 233.1092
 [14,] 216.5466  8.288031 200.2920 232.7668
 [15,] 218.3599  7.813223 203.0358 233.5134
 [16,] 220.1733  8.097716 204.1979 235.7511
 [17,] 221.9867  9.070344 203.8015 239.4755
 [18,] 223.8000 10.542336 202.9793 244.3024
 [19,] 225.6134 12.336212 201.0742 249.8418
 [20,] 227.4268 14.331608 198.4710 255.4478
 [21,] 212.8733 13.103632 186.3268 237.6249
 [22,] 217.8094 11.221306 195.2938 238.8890
 [23,] 222.7454  9.607581 203.3608 241.3421
 [24,] 227.6815  8.418365 210.9432 244.3332
 [25,] 232.6175  7.849044 217.5087 248.0257
 [26,] 237.5535  8.032525 222.2613 253.4539
 [27,] 242.4896  8.922488 225.5250 259.9914
 [28,] 247.4256 10.338060 227.4230 268.0246
 [29,] 252.3617 12.096096 228.5593 275.9489
 [30,] 257.2977 14.068793 229.9154 284.7233
 [31,] 274.2298 13.315865 248.9539 300.6808
 [32,] 279.9855 11.338698 258.4244 302.4778
 [33,] 285.7412  9.621046 267.2882 304.9475
 [34,] 291.4970  8.325120 275.1045 308.4014
 [35,] 297.2527  7.667813 282.1048 312.7928
 [36,] 303.0085  7.812024 287.4933 318.7353
 [37,] 308.7642  8.718070 291.6071 325.9405
 [38,] 314.5200 10.184616 294.5272 334.3460
 [39,] 320.2757 12.008026 297.3260 344.0041
 [40,] 326.0315 14.050040 299.0679 353.7911
 [41,] 273.0148 13.017298 248.7018 300.1781
 [42,] 280.5572 11.177037 259.5475 303.4963
 [43,] 288.0997  9.603360 269.8537 307.3846
 [44,] 295.6421  8.446606 279.3777 312.0212
 [45,] 303.1846  7.892278 287.7135 318.2633
 [46,] 310.7270  8.065557 294.8107 326.3277
 [47,] 318.2694  8.924161 300.4105 335.5877
 [48,] 325.8119 10.298074 305.0906 346.0864
 [49,] 333.3543 12.011756 309.3142 356.6504
 [50,] 340.8968 13.940463 313.0423 368.2484
 [51,] 260.3364 12.417373 236.0902 284.1921
 [52,] 270.5606 10.686415 249.6152 291.1294
 [53,] 280.7848  9.236416 262.2429 298.7947
 [54,] 291.0090  8.217476 274.3129 307.0934
 [55,] 301.2333  7.800389 285.3243 316.3984
 [56,] 311.4575  8.078913 295.0777 327.2911
 [57,] 321.6817  8.988616 303.4441 339.3362
 [58,] 331.9060 10.364613 310.9886 352.6911
 [59,] 342.1302 12.048187 318.1547 366.0819
 [60,] 352.3544 13.928246 324.5405 380.1177
 [61,] 267.7943 12.194841 244.1086 292.3164
 [62,] 278.1185 10.498613 257.7585 299.1088
 [63,] 288.4428  9.087073 270.9818 306.2503
 [64,] 298.7671  8.110252 282.7820 314.1826
 [65,] 309.0913  7.734648 293.5814 323.7213
 [66,] 319.4156  8.044914 302.9131 334.3686
 [67,] 329.7398  8.970161 311.5699 346.6565
 [68,] 340.0641 10.346701 319.6506 359.8448
 [69,] 350.3884 12.020480 326.4641 373.4869
 [70,] 360.7126 13.884414 333.1088 387.7007
 [71,] 244.4604 12.255919 220.2534 268.1761
 [72,] 255.9488 10.527249 235.0132 276.3531
 [73,] 267.4371  9.087913 249.2650 284.8470
 [74,] 278.9255  8.093770 262.8196 293.8809
 [75,] 290.4138  7.718796 274.7576 305.3593
 [76,] 301.9022  8.049986 286.0366 317.6565
 [77,] 313.3905  9.009799 295.4510 331.2119
 [78,] 324.8789 10.426047 303.6830 345.3096
 [79,] 336.3672 12.140025 311.7527 360.2846
 [80,] 347.8556 14.043137 320.0684 375.6261
 [81,] 250.3780 13.477690 225.5570 276.8621
 [82,] 250.1768 11.469219 228.7981 273.0597
 [83,] 249.9756  9.745381 231.9881 269.7530
 [84,] 249.7744  8.481541 233.5109 266.6387
 [85,] 249.5732  7.901597 234.1435 264.9753
 [86,] 249.3720  8.152825 233.5165 265.6361
 [87,] 249.1708  9.167141 231.2922 267.2254
 [88,] 248.9696 10.730285 227.6892 269.7826
 [89,] 248.7683 12.640260 223.6334 273.3690
 [90,] 248.5671 14.763060 219.6448 277.6441
 [91,] 286.2618 13.018888 261.4869 311.6700
 [92,] 305.3617 11.143931 284.2150 327.3987
 [93,] 324.4616  9.544223 306.0294 343.7054
 [94,] 343.5615  8.378926 327.4538 360.4636
 [95,] 362.6614  7.844097 347.4437 378.3823
 [96,] 381.7613  8.066135 366.2095 397.7325
 [97,] 400.8612  8.989130 383.6026 418.5222
 [98,] 419.9611 10.428595 400.0725 440.7845
 [99,] 439.0610 12.203113 416.0128 463.1555
[100,] 458.1609 14.187515 431.4125 486.0290
[101,] 226.6550 12.972063 201.0875 251.0604
[102,] 238.1759 11.164738 216.1192 259.3665
[103,] 249.6967  9.654388 230.6575 268.0470
[104,] 261.2176  8.598950 244.4718 277.7011
[105,] 272.7385  8.176525 257.0853 288.6486
[106,] 284.2594  8.482221 268.1429 300.7209
[107,] 295.7803  9.445606 277.6555 313.9683
[108,] 307.3012 10.893565 286.3517 328.3872
[109,] 318.8221 12.660922 294.7190 343.4863
[110,] 330.3430 14.632396 302.5325 358.9649
[111,] 238.7986 13.006223 213.3216 263.5175
[112,] 255.7855 11.113459 234.0052 277.2672
[113,] 272.7724  9.499781 254.1859 291.2996
[114,] 289.7593  8.329011 273.9660 306.3735
[115,] 306.7462  7.803123 292.1490 322.5087
[116,] 323.7331  8.049520 308.6140 339.8352
[117,] 340.7199  9.005029 323.6009 359.0511
[118,] 357.7068 10.477406 337.6623 378.6982
[119,] 374.6937 12.282153 351.0930 399.9849
[120,] 391.6806 14.293923 364.0551 420.4852
[121,] 255.8526 12.527535 231.0779 280.8484
[122,] 263.3257 10.762939 241.9206 284.8613
[123,] 270.7988  9.293887 252.2120 288.9985
[124,] 278.2719  8.279222 261.6209 294.5798
[125,] 285.7450  7.896103 269.9553 301.0089
[126,] 293.2181  8.233171 277.1863 309.0657
[127,] 300.6912  9.211705 282.8023 318.3313
[128,] 308.1643 10.656436 287.6432 328.7324
[129,] 315.6374 12.405543 291.5750 339.6362
[130,] 323.1105 14.348138 295.0288 351.0528
[131,] 272.1226 12.553178 247.8268 296.9909
[132,] 286.1738 10.792830 265.0530 307.4578
[133,] 300.2251  9.327965 282.0867 318.2812
[134,] 314.2763  8.316225 298.2635 330.2140
[135,] 328.3276  7.932915 313.1155 343.7487
[136,] 342.3788  8.265929 326.1529 358.4241
[137,] 356.4300  9.238122 338.2601 374.4768
[138,] 370.4813 10.676287 349.6056 391.6008
[139,] 384.5325 12.419590 359.8954 409.3853
[140,] 398.5838 14.357305 369.9195 427.0634
[141,] 254.5106 12.072267 231.0401 278.2477
[142,] 265.8859 10.421605 245.5987 286.2773
[143,] 277.2612  9.064654 259.8365 295.0542
[144,] 288.6365  8.149472 272.7883 304.5712
[145,] 300.0118  7.832477 284.2727 315.3321
[146,] 311.3870  8.183482 295.0274 327.6098
[147,] 322.7623  9.125728 304.6141 340.8692
[148,] 334.1376 10.501252 313.1243 354.5310
[149,] 345.5129 12.163945 320.9226 369.0956
[150,] 356.8882 14.011948 329.0941 384.2656
[151,] 226.3501 13.258355 199.5214 251.1072
[152,] 241.5377 11.336286 218.7231 262.7424
[153,] 256.7253  9.689650 237.6109 275.2407
[154,] 271.9130  8.480434 255.5699 288.3369
[155,] 287.1006  7.911809 271.6616 302.5234
[156,] 302.2882  8.119496 286.2118 317.9786
[157,] 317.4758  9.050205 299.3070 334.9931
[158,] 332.6634 10.513645 311.6206 352.8000
[159,] 347.8510 12.321435 323.5219 371.4489
[160,] 363.0386 14.343965 334.9752 390.4292
[161,] 252.1848 12.383518 228.2632 277.1408
[162,] 261.6915 10.580298 241.2156 282.8140
[163,] 271.1982  9.055990 253.5958 289.2071
[164,] 280.7050  7.972220 265.0943 296.8858
[165,] 290.2117  7.521882 275.7026 305.1798
[166,] 299.7184  7.815255 284.7148 315.0118
[167,] 309.2251  8.778086 292.4274 326.5010
[168,] 318.7319 10.222938 298.9944 339.1653
[169,] 328.2386 11.976611 304.9868 352.4402
[170,] 337.7453 13.922896 310.6301 365.8875
[171,] 263.8335 12.374223 240.1390 288.2848
[172,] 275.5969 10.669949 254.9929 296.5024
[173,] 287.3602  9.261249 269.3483 306.1361
[174,] 299.1235  8.300010 282.7733 316.2100
[175,] 310.8868  7.950226 295.5978 327.2050
[176,] 322.6501  8.289665 306.5347 339.1667
[177,] 334.4134  9.242700 316.3492 352.2911
[178,] 346.1767 10.645795 325.3694 366.9611
[179,] 357.9400 12.346454 334.0753 382.1083
[180,] 369.7033 14.238448 342.3410 397.6777</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.75316750 12.978089  -30.1173716  21.0473626
  [2,]  -15.19234928 11.119394  -37.3930616   6.8431953
  [3,]  -42.68033105  9.545431  -61.4903853 -24.1051227
  [4,]    8.37498718  8.417468   -8.4823639  24.4304982
  [5,]   24.20320541  7.928208    8.3933712  39.4690935
  [6,]   62.45752364  8.192886   46.0587471  78.5151957
  [7,]   10.38734187  9.146283   -7.6914210  28.1519514
  [8,] -101.25173990 10.604234 -122.1384326 -80.4205748
  [9,]   19.60107833 12.389886   -4.9422881  43.7758515
 [10,]   35.78539656 14.381688    6.9236727  64.0274434
 [11,]   11.62745844 12.831833  -12.4946093  37.1482218
 [12,]   -7.65401265 10.977076  -28.5975243  14.2972306
 [13,]  -11.75538373  9.407871  -30.1314083   6.6741716
 [14,]  -11.83955481  8.288031  -28.0597663   4.4150483
 [15,]  -10.64382589  7.813223  -25.7972952   4.6802882
 [16,]   -4.21149697  8.097716  -19.7892615  11.7638500
 [17,]   -8.35636805  9.070344  -25.8452064   9.8287545
 [18,]   -6.07283913 10.542336  -26.5752245  14.7479131
 [19,]   -1.31771022 12.336212  -25.5460798  23.2214796
 [20,]    9.88741870 14.331608  -18.1336275  38.8432298
 [21,]  -13.81942566 13.103632  -38.5710008  12.7271051
 [22,]  -23.47717041 11.221306  -44.5567531  -0.9615756
 [23,]   11.57458485  9.607581   -7.0221380  30.9591565
 [24,]    5.16014010  8.418365  -11.4916465  21.8984228
 [25,]   -3.31010465  7.849044  -18.7183353  11.7987304
 [26,]  -17.09564940  8.032525  -32.9959597  -1.8033599
 [27,]   -7.06879415  8.922488  -24.5705721   9.8958099
 [28,]    8.32546110 10.338060  -12.2734956  28.3280591
 [29,]    8.65081635 12.096096  -14.9364486  32.4532146
 [30,]   -9.78242839 14.068793  -37.2080279  17.5998521
 [31,]   47.31284798 13.315865   20.8618110  72.5886717
 [32,]   20.41470127 11.338698   -2.0776425  41.9758142
 [33,]   -1.88474544  9.621046  -21.0909910  16.5683413
 [34,]   -6.36399215  8.325120  -23.2684076  10.0284784
 [35,]  -11.45543886  7.667813  -26.9954964   3.6925486
 [36,]   -5.42298557  7.812024  -21.1498360  10.0922154
 [37,]  -28.52463228  8.718070  -45.7008632 -11.3675130
 [38,]    3.74132101 10.184616  -16.0846774  23.7340994
 [39,]  -14.92622570 12.008026  -38.6546157   8.0235202
 [40,]   28.01722758 14.050040    0.2575763  54.9808458
 [41,]   14.59310373 13.017298  -12.5702342  38.9060666
 [42,]    4.44276214 11.177037  -18.4963178  25.4524625
 [43,]   13.72092055  9.603360   -5.5639762  31.9668606
 [44,]   24.47317896  8.446606    8.0940813  40.7375989
 [45,]   13.09273737  7.892278   -1.9859621  28.5637983
 [46,]  -17.40830422  8.065557  -33.0090013  -1.4919901
 [47,]  -28.19444581  8.924161  -45.5126752 -10.3354661
 [48,]    9.00581260 10.298074  -11.2686890  29.7271120
 [49,]  -39.60742899 12.011756  -62.9035479 -15.5673470
 [50,]   30.68432943 13.940463    3.3327296  58.5388460
 [51,]  -25.47576028 12.417373  -49.3314926  -1.2295818
 [52,]  -27.74878910 10.686415  -48.3176296  -6.8034355
 [53,]   -7.82351792  9.236416  -25.8334258  10.7184351
 [54,]   18.75975326  8.217476    2.6753745  35.4559011
 [55,]   16.22962443  7.800389    1.0644617  32.1385642
 [56,]   -1.45990439  8.078913  -17.2934995  14.9198656
 [57,]  132.48016679  8.988616  114.8256772 150.7178253
 [58,]   14.92513797 10.364613   -5.8599834  35.8425080
 [59,]  -11.82989085 12.048187  -35.7815548  12.1455948
 [60,]  -98.49001967 13.928246 -126.2532556 -70.6760817
 [61,]   16.04813377 12.194841   -8.4739948  39.7338383
 [62,]   11.43647189 10.498613   -9.5537563  31.7965234
 [63,]  -11.67348998  9.087073  -29.4809890   5.7875288
 [64,]    1.04264814  8.110252  -14.3728557  17.0276702
 [65,]  -11.92031374  7.734648  -26.5502994   3.5896461
 [66,]   18.75092439  8.044914    3.7979162  35.2533798
 [67,]    2.28666251  8.970161  -14.6300383  20.4565736
 [68,]    8.77580063 10.346701  -11.0049316  29.1892510
 [69,]  -17.02836124 12.020480  -40.1269252   6.8959316
 [70,]    1.33017688 13.884414  -25.6579165  28.9339751
 [71,]   21.01269291 12.255919   -2.7029820  45.2197220
 [72,]   20.25244237 10.527249   -0.1518871  41.1879766
 [73,]  -24.07240817  9.087913  -41.4823011  -5.9002863
 [74,]  -24.25315870  8.093770  -39.2086313  -8.1472963
 [75,]  -11.38940924  7.718796  -26.3348805   4.2668062
 [76,]  -17.71095978  8.049986  -33.4652756  -1.8454122
 [77,]   -7.86571032  9.009799  -25.6870723  10.0737994
 [78,]    6.64403915 10.426047  -13.7867293  27.8399371
 [79,]   -0.62031139 12.140025  -24.5377061  23.9941567
 [80,]   29.44343807 14.043137    1.6729399  57.2305519
 [81,]   -8.76973426 13.477690  -35.2537897  16.0512584
 [82,]   23.77037728 11.469219    0.8874739  45.1490856
 [83,]    4.51508881  9.745381  -15.2622864  22.5025565
 [84,]   21.02770035  8.481541    4.1633819  37.2911857
 [85,]    1.87871189  7.901597  -13.5234181  17.3083505
 [86,]    5.26422342  8.152825  -10.9998619  21.1196517
 [87,]   -3.71846504  9.167141  -21.7731275  14.1601046
 [88,]  -13.65855351 10.730285  -34.4716436   7.6217630
 [89,]  -13.01424197 12.640260  -37.6148883  12.1207251
 [90,]  -11.32053043 14.763060  -40.3975402  17.6017958
 [91,]   26.10479031 13.018888    0.6965984  50.8796893
 [92,]    8.44408812 11.143931  -13.5928564  29.5908399
 [93,]  -32.85041407  9.544223  -52.0941756 -14.4181786
 [94,]    2.56068373  8.378926  -14.3413544  18.6684181
 [95,]    3.07098154  7.844097  -12.6498536  18.2886706
 [96,]   10.07717935  8.066135   -5.8939533  25.6290317
 [97,]    3.39887715  8.989130  -14.2621225  20.6575172
 [98,]   -3.26882504 10.428595  -24.0922411  16.6197726
 [99,]   16.80327277 12.203113   -7.2912193  39.8515126
[100,]    0.75577057 14.187515  -27.1122647  27.5041516
[101,]    9.44823110 12.972063  -14.9571518  35.0157064
[102,]   -7.85915918 11.164738  -29.0497930  14.1974822
[103,]  -10.77114947  9.654388  -29.1214231   8.2681047
[104,]   -6.29563975  8.598950  -22.7791487  10.4502446
[105,]  -22.02823004  8.176525  -37.9383439  -6.3750217
[106,]  -14.48502033  8.482221  -30.9464876   1.6314757
[107,]  -14.21551061  9.445606  -32.4034977   3.9093311
[108,]    0.80079910 10.893565  -20.2852416  21.7502885
[109,]   17.45850882 12.660922   -7.2057402  41.5616169
[110,]   21.30211853 14.632396   -7.3197548  49.1126179
[111,]   17.49816552 13.006223   -7.2206945  42.9751714
[112,]  -12.33121918 11.113459  -33.8128928   9.4490839
[113,]  -16.56780388  9.499781  -35.0949790   2.0186546
[114,]  -34.23218858  8.329011  -50.8463909 -18.4389298
[115,]  -37.82967328  7.803123  -53.5921818 -23.2325278
[116,]    5.99164202  8.049520  -10.1104521  21.1107197
[117,]   38.72455732  9.005029   20.3934408  55.8435517
[118,]    5.21157262 10.477406  -15.7798451  25.2561156
[119,]   19.79348792 12.282153   -5.4976636  43.3942395
[120,]   -2.62789678 14.293923  -31.4324863  24.9975501
[121,]   -5.32610389 12.527535  -30.3219211  19.4485632
[122,]   36.73189401 10.762939   15.1962841  58.1370446
[123,]   -0.90490810  9.293887  -19.1045959  17.6819218
[124,]    2.31718980  8.279222  -13.9906503  18.9682377
[125,]  -13.91761230  7.896103  -29.1815416   1.8720626
[126,]   11.41548560  8.233171   -4.4320886  27.4472689
[127,]  -12.94461651  9.211705  -30.5847159   4.9443434
[128,]  -41.56881861 10.656436  -62.1368859 -21.0477087
[129,]    5.90437929 12.405543  -18.0944455  29.9667727
[130,]   24.45497719 14.348138   -3.4872569  52.5366879
[131,]  -50.44549156 12.553178  -75.3137649 -26.1496762
[132,]   12.02006712 10.792830   -9.2638808  33.1408547
[133,]   26.65342580  9.327965    8.5972917  44.7918274
[134,]   32.57918448  8.316225   16.6415256  48.5919930
[135,]   20.41264316  7.932915    4.9914886  35.6247176
[136,]   10.44990184  8.265929   -5.5954119  26.6758495
[137,]   -2.00343948  9.238122  -20.0502416  16.1665245
[138,]  -10.04868080 10.676287  -31.1681862  10.8270033
[139,]   -8.89192212 12.419590  -33.7447040  15.7452458
[140,]  -10.04206344 14.357305  -38.5216653  18.6222215
[141,]   17.41287126 12.072267   -6.3242109  40.8833768
[142,]    2.55098998 10.421605  -17.8403665  22.8381913
[143,]  -20.01879130  9.064654  -37.8117546  -2.5941094
[144,]  -10.97987258  8.149472  -26.9145520   4.8683142
[145,]   14.81044614  7.832477   -0.5099147  30.5495457
[146,]    5.82646486  8.183482  -10.3962584  22.1860719
[147,]  -24.62701642  9.125728  -42.7339255  -6.4787784
[148,]   13.98530229 10.501252   -6.4081378  34.9985738
[149,]   -5.23287899 12.163945  -28.8155940  19.3573976
[150,]    9.62493973 14.011948  -17.7525244  37.4190000
[151,]   -1.08612167 13.258355  -25.8431777  25.7426419
[152,]   -7.01423356 11.336286  -28.2189001  15.8003529
[153,]  -17.82454545  9.689650  -36.3399461   1.2898712
[154,]  -31.43995734  8.480434  -47.8638685 -15.0968968
[155,]  -19.56326923  7.911809  -34.9861446  -4.1242885
[156,]   41.90551888  8.119496   26.2150571  57.9819236
[157,]  -36.32769301  9.050205  -53.8449591 -18.1588964
[158,]   14.92209510 10.513645   -5.2144583  35.9649248
[159,]   17.31198321 12.321435   -6.2858980  41.6410601
[160,]    9.19017133 14.343965  -18.2004167  37.2535741
[161,]   17.69561813 12.383518   -7.2603642  41.6172444
[162,]   10.75129226 10.580298  -10.3712045  31.2271985
[163,]    6.70066638  9.055990  -11.3082033  24.3030727
[164,]    1.08454050  7.972220  -15.0962916  16.6952438
[165,]  -11.04118538  7.521882  -26.0093018   3.4679393
[166,]  -15.20641125  7.815255  -30.4997968  -0.2027932
[167,]  -49.95933713  8.778086  -67.2351662 -33.1616158
[168,]  -14.10126301 10.222938  -34.5347170   5.6361821
[169,]   22.54211112 11.976611   -1.6594749  45.7938514
[170,]   31.72388524 13.922896    3.5817399  58.8390717
[171,]    5.57815177 12.374223  -18.8731362  29.2727070
[172,]   -2.12285894 10.669949  -23.0284408  18.4811268
[173,]   10.23663036  9.261249   -8.5392959  28.2485059
[174,]   11.50811966  8.300010   -5.5784362  27.8583188
[175,]  -23.71419104  7.950226  -40.0324492  -8.4251943
[176,]    6.95749825  8.289665   -9.5590561  23.0729323
[177,]    0.06838755  9.242700  -17.8092558  18.1326266
[178,]   -2.95682315 10.645795  -23.7411986  17.8505382
[179,]   11.20166614 12.346454  -12.9665746  35.0663655
[180,]   -5.57974456 14.238448  -33.5541365  21.7825662</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.6
p_loo        19.8  3.6
looic      1770.5 29.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   447       
 (0.5, 0.7]   (ok)         1    0.6%   3356      
   (0.7, 1]   (bad)        1    0.6%   43        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.5
p_loo        33.8  8.4
looic      1722.0 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   975       
 (0.5, 0.7]   (ok)         6    3.3%   329       
   (0.7, 1]   (bad)        2    1.1%   11        
   (1, Inf)   (very bad)   1    0.6%   15        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.6  
fit_sleep1 -92.3      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.6
p_loo        19.8  3.6
looic      1770.5 29.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   447       
 (0.5, 0.7]   (ok)         1    0.6%   3356      
   (0.7, 1]   (bad)        1    0.6%   43        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.5
p_loo        33.8  8.4
looic      1722.0 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   975       
 (0.5, 0.7]   (ok)         6    3.3%   329       
   (0.7, 1]   (bad)        2    1.1%   11        
   (1, Inf)   (very bad)   1    0.6%   15        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.0     22.5        33.8    8.4   1722.0
fit_sleep2  -24.3      11.6  -885.3     14.6        19.8    3.6   1770.5
fit_sleep1  -92.3      21.1  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.9  
fit_sleep2   29.1  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.199664e-41 2.838440e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88       1.6     0.23     5.38       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12       1.6    -3.38     2.94       5.16      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0.1       tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
