<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.76      6.57    15.63    41.11 1.00     1670     2391
sd(Days)                6.55      1.50     4.16     9.99 1.00     1286     2173
cor(Intercept,Days)     0.07      0.30    -0.50     0.64 1.00      973     1536

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.24      7.39   237.00   265.92 1.00     1621     2674
Days         10.41      1.66     7.20    13.69 1.00     1311     2136

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.59    23.04    29.28 1.00     3418     2660

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7240  12.94304 227.9864 278.7534
309 211.6996  13.49595 185.2789 236.9966
310 213.1164  13.30843 186.7346 238.4408
330 274.4772  13.35911 248.6029 300.4831
331 273.2657  13.17348 247.7659 299.7166
332 260.4147  12.38975 236.5638 285.2906
333 267.9136  12.18873 244.8000 292.4909
334 244.3683  12.08879 220.2899 267.9611
335 250.7259  13.80740 223.4551 278.7998
337 285.5351  13.13692 260.0270 311.0691
349 226.7320  13.11492 200.1624 251.1177
350 238.6511  12.98181 212.8276 263.3388
351 255.6716  12.50248 231.5253 279.9235
352 271.8816  12.64741 247.5250 297.1521
369 254.5515  12.41203 230.0869 278.8418
370 226.4714  13.60195 199.9258 252.6016
371 252.0369  12.31896 227.1530 276.2095
372 263.4324  12.24471 239.5973 287.4905

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6591286  2.516279 14.8203123 24.644164
309  1.7250326  2.540179 -3.1637838  6.746969
310  4.9145561  2.484940  0.1495002  9.827091
330  5.7638044  2.564141  0.5347949 10.624324
331  7.4370931  2.483143  2.5062851 12.292070
332 10.2316900  2.364284  5.5118089 14.762053
333 10.2745705  2.352848  5.6417814 14.746857
334 11.5067080  2.319332  7.0395300 16.213980
335 -0.2111774  2.639546 -5.3431694  4.914639
337 19.2052476  2.475537 14.4891895 24.158590
349 11.5426668  2.517986  6.7761518 16.595004
350 17.0106875  2.489550 12.1947471 21.986112
351  7.4598985  2.340809  2.7620256 12.006385
352 14.0354993  2.394768  9.3693084 18.734585
369 11.3423495  2.372748  6.6075112 16.051098
370 15.2177233  2.591063 10.1976365 20.292223
371  9.4929546  2.352757  4.9454979 14.125815
372 11.7792298  2.320277  7.2488987 16.427449</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7240 12.943037 227.9864 278.7534
  [2,] 273.3831 11.058750 251.4922 294.8204
  [3,] 293.0423  9.472752 274.5713 311.7960
  [4,] 312.7014  8.356639 296.3479 328.9745
  [5,] 332.3605  7.911835 317.0251 347.9346
  [6,] 352.0196  8.247676 336.0846 368.0043
  [7,] 371.6788  9.279792 353.6648 389.7938
  [8,] 391.3379 10.810561 370.0489 412.4246
  [9,] 410.9970 12.660380 386.3792 435.7397
 [10,] 430.6562 14.709370 402.0749 459.5605
 [11,] 211.6996 13.495953 185.2789 236.9966
 [12,] 213.4246 11.580457 191.2131 235.3093
 [13,] 215.1497  9.948780 196.1642 234.5381
 [14,] 216.8747  8.760964 200.0011 233.8478
 [15,] 218.5997  8.211929 202.0976 234.3736
 [16,] 220.3248  8.427460 203.4411 236.6300
 [17,] 222.0498  9.354860 202.8010 240.1071
 [18,] 223.7748 10.812481 201.8698 244.4771
 [19,] 225.4999 12.617889 200.2199 249.3994
 [20,] 227.2249 14.643001 198.0943 255.3340
 [21,] 213.1164 13.308434 186.7346 238.4408
 [22,] 218.0309 11.470904 195.6718 239.8364
 [23,] 222.9455  9.919614 203.7718 242.0199
 [24,] 227.8601  8.807139 210.8866 244.8329
 [25,] 232.7746  8.311589 216.9060 248.7538
 [26,] 237.6892  8.541030 220.6885 254.5071
 [27,] 242.6037  9.442760 223.7642 261.2245
 [28,] 247.5183 10.850443 226.0448 269.0526
 [29,] 252.4328 12.595569 228.1127 277.6046
 [30,] 257.3474 14.557282 229.1195 286.3440
 [31,] 274.4772 13.359107 248.6029 300.4831
 [32,] 280.2410 11.410434 258.0904 302.2624
 [33,] 286.0048  9.750892 267.0024 304.8110
 [34,] 291.7686  8.550522 275.1913 308.1680
 [35,] 297.5324  8.018266 282.1816 313.1289
 [36,] 303.2962  8.283923 286.9350 319.7147
 [37,] 309.0600  9.279214 290.8347 327.6046
 [38,] 314.8238 10.804345 293.7478 336.3574
 [39,] 320.5876 12.669395 295.9019 345.6956
 [40,] 326.3514 14.745945 297.4243 355.0591
 [41,] 273.2657 13.173482 247.7659 299.7166
 [42,] 280.7028 11.325051 258.6876 303.4142
 [43,] 288.1399  9.762425 268.7599 307.6955
 [44,] 295.5770  8.642055 278.1788 312.5315
 [45,] 303.0141  8.148452 286.7129 318.8456
 [46,] 310.4512  8.392938 293.7552 326.4978
 [47,] 317.8883  9.317594 299.5169 335.6125
 [48,] 325.3254 10.748288 303.8480 345.9375
 [49,] 332.7625 12.512626 308.2419 356.9864
 [50,] 340.1996 14.489236 311.7687 368.1286
 [51,] 260.4147 12.389752 236.5638 285.2906
 [52,] 270.6464 10.693992 249.6833 292.0923
 [53,] 280.8781  9.294981 262.7086 299.8482
 [54,] 291.1098  8.343353 275.3590 307.6418
 [55,] 301.3415  8.000380 285.7820 317.1140
 [56,] 311.5732  8.341481 295.0108 328.0389
 [57,] 321.8049  9.291620 303.1855 340.0831
 [58,] 332.0366 10.689611 310.8707 353.0907
 [59,] 342.2683 12.384710 318.2307 366.8838
 [60,] 352.5000 14.271439 325.0203 380.2188
 [61,] 267.9136 12.188733 244.8000 292.4909
 [62,] 278.1881 10.464389 258.3570 299.4088
 [63,] 288.4627  9.028481 270.9390 306.3012
 [64,] 298.7373  8.037119 282.6144 314.3092
 [65,] 309.0118  7.664782 293.8640 323.6921
 [66,] 319.2864  7.998392 303.7523 334.8282
 [67,] 329.5610  8.959433 311.9720 346.9131
 [68,] 339.8356 10.374990 319.2979 360.0959
 [69,] 350.1101 12.086405 326.3329 373.6024
 [70,] 360.3847 13.985483 332.9913 387.2203
 [71,] 244.3683 12.088789 220.2899 267.9611
 [72,] 255.8750 10.441612 235.4344 276.7797
 [73,] 267.3817  9.092541 249.4077 285.7013
 [74,] 278.8884  8.190234 262.4509 295.1820
 [75,] 290.3951  7.889497 274.7460 306.7331
 [76,] 301.9018  8.256332 285.7493 318.4231
 [77,] 313.4085  9.211322 295.4380 331.3536
 [78,] 324.9152 10.596627 304.3660 345.6690
 [79,] 336.4219 12.267320 312.5640 360.7484
 [80,] 347.9287 14.122478 320.5397 376.3861
 [81,] 250.7259 13.807400 223.4551 278.7998
 [82,] 250.5147 11.717671 227.5076 274.0478
 [83,] 250.3036  9.894328 231.0389 270.3609
 [84,] 250.0924  8.510349 233.5374 267.2064
 [85,] 249.8812  7.803126 234.7818 265.3314
 [86,] 249.6700  7.955243 234.3790 265.6141
 [87,] 249.4589  8.922860 232.1978 267.5736
 [88,] 249.2477 10.482527 228.9308 270.7285
 [89,] 249.0365 12.413046 224.6264 274.3058
 [90,] 248.8253 14.567720 220.1257 278.0114
 [91,] 285.5351 13.136925 260.0270 311.0691
 [92,] 304.7404 11.268573 282.8555 326.3950
 [93,] 323.9456  9.676737 305.1670 342.5517
 [94,] 343.1509  8.517882 326.4284 359.8991
 [95,] 362.3561  7.982854 346.8248 377.7348
 [96,] 381.5614  8.194765 365.1964 397.7773
 [97,] 400.7666  9.101590 382.7586 418.1785
 [98,] 419.9719 10.525222 399.3227 440.1003
 [99,] 439.1771 12.287319 415.4421 463.1480
[100,] 458.3824 14.262984 431.0634 486.4851
[101,] 226.7320 13.114925 200.1624 251.1177
[102,] 238.2746 11.216273 215.6798 259.0310
[103,] 249.8173  9.606707 230.7214 267.7206
[104,] 261.3600  8.453009 244.9402 277.4841
[105,] 272.9026  7.956030 257.3084 288.0763
[106,] 284.4453  8.235531 268.0426 300.4238
[107,] 295.9880  9.221174 277.9307 313.6334
[108,] 307.5306 10.719917 286.5050 328.2034
[109,] 319.0733 12.549251 294.3404 343.5999
[110,] 330.6160 14.585311 302.2284 359.2415
[111,] 238.6511 12.981812 212.8276 263.3388
[112,] 255.6618 11.117299 233.3126 276.9464
[113,] 272.6725  9.542377 253.6969 290.8689
[114,] 289.6832  8.421122 272.9515 306.2962
[115,] 306.6939  7.947914 291.1508 322.2583
[116,] 323.7045  8.235236 307.9158 339.6226
[117,] 340.7152  9.212198 323.1405 358.5286
[118,] 357.7259 10.691389 336.8057 378.3262
[119,] 374.7366 12.495707 350.6231 399.1174
[120,] 391.7473 14.504321 363.5422 420.1797
[121,] 255.6716 12.502476 231.5253 279.9235
[122,] 263.1315 10.786106 242.2668 283.9989
[123,] 270.5914  9.344893 252.4548 288.8020
[124,] 278.0513  8.323025 261.6817 294.2065
[125,] 285.5112  7.885255 269.5956 300.9436
[126,] 292.9711  8.126533 276.5983 308.7022
[127,] 300.4310  8.992363 282.5567 318.0335
[128,] 307.8909 10.326830 287.4424 327.9288
[129,] 315.3508 11.974265 291.7652 338.3072
[130,] 322.8107 13.823220 295.8444 349.0022
[131,] 271.8816 12.647411 247.5250 297.1521
[132,] 285.9171 10.873966 265.0940 307.3382
[133,] 299.9526  9.380784 281.7504 318.1076
[134,] 313.9881  8.320150 297.7358 330.0515
[135,] 328.0236  7.868959 312.2610 343.9020
[136,] 342.0591  8.129327 326.2148 358.3452
[137,] 356.0946  9.039980 338.7516 374.0849
[138,] 370.1301 10.431986 350.4485 390.5365
[139,] 384.1656 12.140892 360.8575 407.8051
[140,] 398.2011 14.051548 371.0752 425.6492
[141,] 254.5515 12.412029 230.0869 278.8418
[142,] 265.8938 10.695565 244.6194 286.6526
[143,] 277.2362  9.273168 258.9447 295.5286
[144,] 288.5785  8.297473 272.2066 304.8961
[145,] 299.9209  7.935006 284.5067 315.4034
[146,] 311.2632  8.266829 294.8413 327.4813
[147,] 322.6056  9.218269 304.3129 340.6888
[148,] 333.9479 10.624141 312.5434 354.8484
[149,] 345.2903 12.329968 319.9289 369.4759
[150,] 356.6326 14.228273 327.2311 384.4250
[151,] 226.4714 13.601947 199.9258 252.6016
[152,] 241.6891 11.591818 219.0588 264.0340
[153,] 256.9069  9.856711 237.2919 275.7652
[154,] 272.1246  8.565422 255.1018 288.6073
[155,] 287.3423  7.937593 271.8120 302.4987
[156,] 302.5600  8.128439 286.7646 318.1567
[157,] 317.7777  9.086522 299.9200 335.3684
[158,] 332.9955 10.605916 312.3019 353.3340
[159,] 348.2132 12.483319 324.0341 372.2731
[160,] 363.4309 14.581093 335.0732 391.7640
[161,] 252.0369 12.318957 227.1530 276.2095
[162,] 261.5298 10.586026 240.2156 282.2871
[163,] 271.0228  9.134664 252.7740 288.5776
[164,] 280.5158  8.117338 264.3935 296.1326
[165,] 290.0087  7.707865 274.7598 305.0885
[166,] 299.5017  8.000133 283.8027 315.3922
[167,] 308.9946  8.925469 291.8418 326.8241
[168,] 318.4876 10.314882 298.4483 339.2199
[169,] 327.9805 12.008351 304.2380 352.4539
[170,] 337.4735 13.895148 310.2299 365.9378
[171,] 263.4324 12.244715 239.5973 287.4905
[172,] 275.2117 10.591352 254.7608 296.3176
[173,] 286.9909  9.229724 269.4402 305.5519
[174,] 298.7701  8.304592 282.5205 315.2403
[175,] 310.5494  7.969445 294.8679 326.1778
[176,] 322.3286  8.296098 305.8495 338.3286
[177,] 334.1078  9.214434 315.6197 352.2196
[178,] 345.8870 10.571363 325.0261 366.5716
[179,] 357.6663 12.221661 333.8288 381.4983
[180,] 369.4455 14.062420 342.6407 397.0239</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.1639932 12.943037  -29.1934024  21.5736217
  [2,]  -14.6784218 11.058750  -36.1157345   7.2124795
  [3,]  -42.2416504  9.472752  -60.9954408 -23.7707066
  [4,]    8.7384209  8.356639   -7.5346970  25.0918879
  [5,]   24.4913923  7.911835    8.9173440  39.8267782
  [6,]   62.6704637  8.247676   46.6857546  78.6055360
  [7,]   10.5250351  9.279792   -7.5899702  28.5389989
  [8,] -101.1892935 10.810561 -122.2759763 -79.9002831
  [9,]   19.5882778 12.660380   -5.1544240  44.2061462
 [10,]   35.6973492 14.709370    6.7929558  64.2785545
 [11,]   11.0342958 13.495953  -14.2626591  37.4549703
 [12,]   -8.1588368 11.580457  -30.0435360  14.0526862
 [13,]  -12.1718695  9.948780  -31.5602669   6.8135818
 [14,]  -12.1677021  8.760964  -29.1407783   4.7059004
 [15,]  -10.8836348  8.211929  -26.6575196   5.6184726
 [16,]   -4.3629674  8.427460  -20.6681733  12.5207055
 [17,]   -8.4195000  9.354860  -26.4768021  10.8292591
 [18,]   -6.0476327 10.812481  -26.7499457  15.8573604
 [19,]   -1.2041653 12.617889  -25.1037238  24.0758177
 [20,]   10.0893020 14.643001  -18.0198106  39.2198662
 [21,]  -14.0624918 13.308434  -39.3869152  12.3192719
 [22,]  -23.6987479 11.470904  -45.5042442  -1.3396063
 [23,]   11.3744960  9.919614   -7.6998657  30.5482235
 [24,]    4.9815400  8.807139  -11.9912534  21.9549762
 [25,]   -3.4672161  8.311589  -19.4463714  12.4013553
 [26,]  -17.2312722  8.541030  -34.0491765  -0.2306258
 [27,]   -7.1829282  9.442760  -25.8036523  11.6566008
 [28,]    8.2328157 10.850443  -13.3015451  29.7063246
 [29,]    8.5796596 12.595569  -16.5921012  32.8998124
 [30,]   -9.8320964 14.557282  -38.8287213  18.3957990
 [31,]   47.0654455 13.359107   21.0594621  72.9396525
 [32,]   20.1592410 11.410434   -1.8622258  42.3097916
 [33,]   -2.1482634  9.750892  -20.9545108  16.8540603
 [34,]   -6.6355678  8.550522  -23.0350416   9.9417054
 [35,]  -11.7350722  8.018266  -27.3315924   3.6156822
 [36,]   -5.7106767  8.283923  -22.1292104  10.6505366
 [37,]  -28.8203811  9.279214  -47.3650050 -10.5951242
 [38,]    3.4375145 10.804345  -18.0961164  24.5135244
 [39,]  -15.2380900 12.669395  -40.3461155   9.4476094
 [40,]   27.6973056 14.745945   -1.0103555  56.6244157
 [41,]   14.3421607 13.173482  -12.1087381  39.8420176
 [42,]    4.2971676 11.325051  -18.4141774  26.3124028
 [43,]   13.6806745  9.762425   -5.8748666  33.0607131
 [44,]   24.5382814  8.642055    7.5838163  41.9364629
 [45,]   13.2631884  8.148452   -2.5682867  29.5644461
 [46,]  -17.1325047  8.392938  -33.1791236  -0.4364660
 [47,]  -27.8132978  9.317594  -45.5375264  -9.4418736
 [48,]    9.4923092 10.748288  -11.1197531  30.9697233
 [49,]  -39.0155839 12.512626  -63.2395173 -14.4950281
 [50,]   31.3815230 14.489236    3.4524929  59.8124178
 [51,]  -25.5541469 12.389752  -50.4300354  -1.7032468
 [52,]  -27.8346369 10.693992  -49.2804743  -6.8715292
 [53,]   -7.9168269  9.294981  -26.8868921  10.2526544
 [54,]   18.6589831  8.343353    2.1269727  34.4097778
 [55,]   16.1213930  8.000380    0.3488797  31.6808631
 [56,]   -1.5755970  8.341481  -18.0413409  14.9867731
 [57,]  132.3570130  9.291620  114.0788017 150.9763862
 [58,]   14.7945230 10.689611   -6.2596327  35.9604281
 [59,]  -11.9679670 12.384710  -36.5835019  12.0695967
 [60,]  -98.6355571 14.271439 -126.3544331 -71.1558870
 [61,]   15.9288406 12.188733   -8.6484977  39.0424090
 [62,]   11.3668702 10.464389   -9.8537553  31.1980278
 [63,]  -11.6934003  9.028481  -29.5319389   5.8302973
 [64,]    1.0724292  8.037119  -14.4994734  17.1952935
 [65,]  -11.8408412  7.664782  -26.5210994   3.3070064
 [66,]   18.8800883  7.998392    3.3382692  34.4142110
 [67,]    2.4655178  8.959433  -14.8865651  20.0545452
 [68,]    9.0043474 10.374990  -11.2559798  29.5420113
 [69,]  -16.7501231 12.086405  -40.2423579   7.0271328
 [70,]    1.6581064 13.985483  -25.1775048  29.0514717
 [71,]   21.1048176 12.088789   -2.4879536  45.1831737
 [72,]   20.3262096 10.441612   -0.5785263  40.7667831
 [73,]  -24.0169984  9.092541  -42.3365801  -6.0430084
 [74,]  -24.2161065  8.190234  -40.5096757  -7.7786041
 [75,]  -11.3707145  7.889497  -27.7087092   4.2784363
 [76,]  -17.7106225  8.256332  -34.2318834  -1.5580670
 [77,]   -7.8837306  9.211322  -25.8288131  10.0867666
 [78,]    6.6076614 10.596627  -14.1460563  27.1569033
 [79,]   -0.6750466 12.267320  -25.0014827  23.1828782
 [80,]   29.3703453 14.122478    0.9129403  56.7593309
 [81,]   -9.1176230 13.807400  -37.1914507  18.1532240
 [82,]   23.4324544 11.717671   -0.1006175  46.4396180
 [83,]    4.1871317  9.894328  -15.8701533  23.4518434
 [84,]   20.7097091  8.510349    3.5957203  37.2647210
 [85,]    1.5706865  7.803126  -13.8794580  16.6701443
 [86,]    4.9661639  7.955243  -10.9778655  20.2572491
 [87,]   -4.0065588  8.922860  -22.1212733  13.2545004
 [88,]  -13.9366814 10.482527  -35.4175487   6.3801734
 [89,]  -13.2824040 12.413046  -38.5517103  11.1277329
 [90,]  -11.5787266 14.567720  -40.7648355  17.1208907
 [91,]   26.8314673 13.136925    1.2974977  52.3395536
 [92,]    9.0654196 11.268573  -12.5892382  30.9502800
 [93,]  -32.3344280  9.676737  -50.9404810 -13.5558412
 [94,]    2.9713243  8.517882  -13.7768765  19.6937807
 [95,]    3.3762767  7.982854  -12.0023754  18.9075775
 [96,]   10.2771290  8.194765   -5.9387549  26.6420875
 [97,]    3.4934814  9.101590  -13.9183942  21.5015124
 [98,]   -3.2795662 10.525222  -23.4080381  17.3695577
 [99,]   16.6871861 12.287319   -7.2836964  40.4222167
[100,]    0.5343385 14.262984  -27.5683867  27.8533328
[101,]    9.3712437 13.114925  -15.0144790  35.9408330
[102,]   -7.9579232 11.216273  -28.7142867  14.6369255
[103,]  -10.8916900  9.606707  -28.7949930   8.2041585
[104,]   -6.4379568  8.453009  -22.5621028   9.9818228
[105,]  -22.1923237  7.956030  -37.3660037  -6.5980962
[106,]  -14.6708905  8.235531  -30.6494113   1.7318418
[107,]  -14.4231574  9.221174  -32.0686193   3.6340710
[108,]    0.5713758 10.719917  -20.1014047  21.5970332
[109,]   17.2073090 12.549251   -7.3193010  41.9401897
[110,]   21.0291421 14.585311   -7.5964218  49.4166924
[111,]   17.6456897 12.981812   -7.0420006  43.4691836
[112,]  -12.2074979 11.117299  -33.4921363  10.1417144
[113,]  -16.4678854  9.542377  -34.6642585   2.5077382
[114,]  -34.1560730  8.421122  -50.7690559 -17.4243771
[115,]  -37.7773605  7.947914  -53.3418166 -22.2342785
[116,]    6.0201519  8.235236   -9.8979037  21.8089003
[117,]   38.7292644  9.212198   20.9158902  56.3039910
[118,]    5.1924769 10.691389  -15.4077723  26.1126752
[119,]   19.7505893 12.495707   -4.6302325  43.8641074
[120,]   -2.6945982 14.504321  -31.1270100  25.5105005
[121,]   -5.1451048 12.502476  -29.3969691  19.0011708
[122,]   36.9260967 10.786106   16.0586957  57.7907574
[123,]   -0.6975018  9.344893  -18.9081084  17.4391244
[124,]    2.5377997  8.323025  -13.6174255  18.9073828
[125,]  -13.6837989  7.885255  -29.1161536   2.2317988
[126,]   11.6625026  8.126533   -4.0685572  28.0353349
[127,]  -12.6843959  8.992363  -30.2869139   5.1898995
[128,]  -41.2953944 10.326830  -61.3333206 -20.8468810
[129,]    6.1910071 11.974265  -16.7653543  29.7765736
[130,]   24.7548086 13.823220   -1.4367058  51.7210766
[131,]  -50.2044695 12.647411  -75.4749645 -25.8478833
[132,]   12.2768312 10.873966   -9.1443082  33.0999224
[133,]   26.9259319  9.380784    8.7709368  45.1281055
[134,]   32.8674325  8.320150   16.8040366  49.1197141
[135,]   20.7166332  7.868959    4.8382478  36.4791899
[136,]   10.7696339  8.129327   -5.5165120  26.6138806
[137,]   -1.6679654  9.039980  -19.6583041  15.6750232
[138,]   -9.6974647 10.431986  -30.1038930   9.9840795
[139,]   -8.5249640 12.140892  -32.1645232  14.7831006
[140,]   -9.6593633 14.051548  -37.1075347  17.4665124
[141,]   17.3720014 12.412029   -6.9182716  41.8366288
[142,]    2.5430519 10.695565  -18.2157472  23.8174938
[143,]  -19.9937976  9.273168  -38.2862074  -1.7022541
[144,]  -10.9219470  8.297473  -27.2395300   5.4499855
[145,]   14.9013035  7.935006   -0.5811803  30.3154505
[146,]    5.9502540  8.266829  -10.2677741  22.3721896
[147,]  -24.4702954  9.218269  -42.5534733  -6.1775663
[148,]   14.1749551 10.624141   -6.7254508  35.5794653
[149,]   -5.0102944 12.329968  -29.1958892  20.3511353
[150,]    9.8804562 14.228273  -17.9119417  39.2820415
[151,]   -1.2074077 13.601947  -27.3376100  25.3382410
[152,]   -7.1656310 11.591818  -29.5105342  15.4646800
[153,]  -18.0060543  9.856711  -36.8644364   1.6088778
[154,]  -31.6515775  8.565422  -48.1343384 -14.6287618
[155,]  -19.8050008  7.937593  -34.9613881  -4.2746790
[156,]   41.6336759  8.128439   26.0370335  57.4291486
[157,]  -36.6296474  9.086522  -54.2203064 -18.7719362
[158,]   14.5900294 10.605916   -5.7485166  35.2836445
[159,]   16.9498061 12.483319   -7.1101424  41.1289105
[160,]    8.7978828 14.581093  -19.5352025  37.1556496
[161,]   17.8435084 12.318957   -6.3291201  42.7274350
[162,]   10.9129538 10.586026   -9.8442827  32.2272294
[163,]    6.8760991  9.134664  -10.6786735  25.1248883
[164,]    1.2737445  8.117338  -14.3431401  17.3959814
[165,]  -10.8382102  7.707865  -25.9179829   4.4107224
[166,]  -14.9896648  8.000133  -30.8802133   0.7093366
[167,]  -49.7288194  8.925469  -67.5582605 -32.5759869
[168,]  -13.8569741 10.314882  -34.5893462   6.1822954
[169,]   22.8001713 12.008351   -1.6732411  46.5426588
[170,]   31.9957166 13.895148    3.5314474  59.2392670
[171,]    5.9792662 12.244715  -18.0787906  29.8143719
[172,]   -1.7376636 10.591352  -22.8435523  18.7132161
[173,]   10.6059066  9.229724   -7.9550816  28.1565954
[174,]   11.8614768  8.304592   -4.6086859  28.1110502
[175,]  -23.3767530  7.969445  -39.0051699  -7.6953192
[176,]    7.2790172  8.296098   -8.7209787  23.7580933
[177,]    0.3739875  9.214434  -17.7377655  18.8620941
[178,]   -2.6671423 10.571363  -23.3516866  18.1937551
[179,]   11.4754279 12.221661  -12.3566433  35.3128935
[180,]   -5.3219019 14.062420  -32.9003290  21.4829387</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.3
p_loo        19.6  3.3
looic      1770.2 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   535       
 (0.5, 0.7]   (ok)         1    0.6%   184       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.0 22.5
p_loo        34.9  8.7
looic      1723.9 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   1004      
 (0.5, 0.7]   (ok)         7    3.9%   399       
   (0.7, 1]   (bad)        2    1.1%   29        
   (1, Inf)   (very bad)   1    0.6%   15        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.1      11.9  
fit_sleep1 -91.3      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.3
p_loo        19.6  3.3
looic      1770.2 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   535       
 (0.5, 0.7]   (ok)         1    0.6%   184       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.0 22.5
p_loo        34.9  8.7
looic      1723.9 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   1004      
 (0.5, 0.7]   (ok)         7    3.9%   399       
   (0.7, 1]   (bad)        2    1.1%   29        
   (1, Inf)   (very bad)   1    0.6%   15        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.0     22.5        34.9    8.7   1723.9
fit_sleep2  -23.1      11.9  -885.1     14.3        19.6    3.3   1770.2
fit_sleep1  -91.3      21.2  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   45.1  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
2.260722e-40 9.005902e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.97      1.57     0.32     5.46       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.03      1.57    -3.24     2.95       5.21      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0.1       tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
