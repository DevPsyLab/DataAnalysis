<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.02      6.91    15.63    42.72 1.00     1859     2493
sd(Days)                6.60      1.54     4.14    10.34 1.00     1425     1925
cor(Intercept,Days)     0.10      0.30    -0.48     0.67 1.00      850     1564

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.16      7.25   237.32   265.26 1.00     1594     2564
Days         10.44      1.65     7.22    13.73 1.00     1357     2148

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.87      1.55    23.07    29.11 1.00     3366     2848

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9162  12.83468 227.8419 278.0633
309 211.2587  13.11893 185.1969 236.8599
310 212.9658  13.27902 185.7847 238.2349
330 274.3494  13.20281 249.7084 300.1025
331 272.9519  13.06286 248.4020 299.3090
332 260.3675  12.32039 236.4985 285.3475
333 267.7016  12.59677 243.4768 292.5212
334 244.2381  12.29280 219.4638 267.1708
335 250.8012  13.54564 223.7610 277.3415
337 286.1764  12.81810 260.9893 311.4002
349 226.5801  12.89285 200.8132 252.1089
350 238.6551  13.15259 212.1786 263.5576
351 255.8005  12.60608 231.0726 281.5745
352 271.9713  12.30464 247.7014 296.7151
369 254.4077  11.79925 231.5650 278.9696
370 226.1098  13.58292 199.5763 251.5721
371 252.0706  11.69150 228.7178 274.7288
372 263.3953  12.28555 239.3120 287.5994

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.5939029  2.500071 14.63810809 24.493229
309  1.8161064  2.415867 -2.99188340  6.481476
310  4.8915217  2.472305 -0.05211975  9.689210
330  5.7930505  2.467460  0.85374062 10.555463
331  7.5005892  2.436843  2.59693578 12.046809
332 10.2091379  2.364925  5.47117413 14.611864
333 10.3548424  2.381739  5.56400952 14.960915
334 11.5016189  2.329911  7.04871940 16.185181
335 -0.2191999  2.582474 -5.43723598  4.698736
337 19.1246727  2.418810 14.29905080 23.864243
349 11.5505463  2.444802  6.91152808 16.560298
350 17.0330466  2.504270 12.20808190 21.914920
351  7.4934608  2.392914  2.87260319 11.992182
352 14.0588956  2.327441  9.27078378 18.500210
369 11.3896555  2.288236  6.79826624 15.813923
370 15.2389137  2.576751 10.31249676 20.394878
371  9.4951368  2.280256  4.99833823 13.925046
372 11.7842986  2.335426  7.18598243 16.342751</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9162 12.834678 227.8419 278.0633
  [2,] 273.5101 10.947348 251.1025 294.3574
  [3,] 293.1040  9.352037 274.0872 310.9523
  [4,] 312.6979  8.220553 296.4434 328.6064
  [5,] 332.2918  7.758550 317.0290 347.6511
  [6,] 351.8857  8.081672 336.0528 367.7947
  [7,] 371.4796  9.106725 353.3068 389.0759
  [8,] 391.0735 10.632601 369.9963 411.7423
  [9,] 410.6674 12.476885 386.0260 434.7053
 [10,] 430.2613 14.518740 402.3132 458.4371
 [11,] 211.2587 13.118927 185.1969 236.8599
 [12,] 213.0749 11.291394 190.9374 235.2923
 [13,] 214.8910  9.724082 195.5909 233.8420
 [14,] 216.7071  8.561119 199.4938 233.3072
 [15,] 218.5232  7.981265 202.3728 233.8294
 [16,] 220.3393  8.110563 204.1610 235.7594
 [17,] 222.1554  8.918223 204.7371 239.2359
 [18,] 223.9715 10.245048 203.6308 244.1858
 [19,] 225.7876 11.918898 201.9310 248.8979
 [20,] 227.6037 13.814198 200.1350 254.8610
 [21,] 212.9658 13.279019 185.7847 238.2349
 [22,] 217.8573 11.430227 194.8538 239.6917
 [23,] 222.7488  9.858620 203.0037 241.4350
 [24,] 227.6403  8.715463 210.3833 244.6497
 [25,] 232.5319  8.182346 216.5009 248.9056
 [26,] 237.4234  8.376566 221.0709 254.2105
 [27,] 242.3149  9.252432 224.5652 260.8389
 [28,] 247.2064 10.642967 226.2771 268.3584
 [29,] 252.0980 12.375886 227.3084 276.1441
 [30,] 256.9895 14.327490 228.2166 284.5751
 [31,] 274.3494 13.202811 249.7084 300.1025
 [32,] 280.1424 11.291901 258.7042 302.6636
 [33,] 285.9355  9.637249 267.2971 304.9862
 [34,] 291.7285  8.391830 275.6950 308.2368
 [35,] 297.5216  7.755371 282.6940 312.9048
 [36,] 303.3146  7.876895 287.9826 318.8032
 [37,] 309.1077  8.724785 292.7458 326.4689
 [38,] 314.9007 10.118054 295.6091 334.9509
 [39,] 320.6938 11.866122 297.8246 344.2659
 [40,] 326.4868 13.835152 299.5238 354.2068
 [41,] 272.9519 13.062862 248.4020 299.3090
 [42,] 280.4525 11.205037 259.4645 302.7600
 [43,] 287.9531  9.609564 269.7276 307.2434
 [44,] 295.4537  8.426803 279.3764 312.2292
 [45,] 302.9543  7.845680 287.5708 318.6782
 [46,] 310.4549  7.998424 294.7291 326.2038
 [47,] 317.9555  8.847105 300.4685 335.5545
 [48,] 325.4561 10.219793 304.9455 345.4747
 [49,] 332.9566 11.937062 309.2033 355.9413
 [50,] 340.4572 13.871523 312.8618 367.0522
 [51,] 260.3675 12.320388 236.4985 285.3475
 [52,] 270.5767 10.598245 249.9106 291.9379
 [53,] 280.7858  9.167299 262.8397 298.9408
 [54,] 290.9949  8.181791 274.9279 306.7631
 [55,] 301.2041  7.812155 286.1664 316.3517
 [56,] 311.4132  8.142700 295.8128 327.4922
 [57,] 321.6223  9.097423 304.1553 339.9355
 [58,] 331.8315 10.507539 311.6813 352.9731
 [59,] 342.0406 12.216358 318.3897 366.1926
 [60,] 352.2498 14.115812 324.9789 380.1295
 [61,] 267.7016 12.596769 243.4768 292.5212
 [62,] 278.0564 10.842309 257.0761 299.4601
 [63,] 288.4113  9.368997 269.9767 306.8476
 [64,] 298.7661  8.327419 282.8000 315.1617
 [65,] 309.1210  7.890442 293.5716 324.2055
 [66,] 319.4758  8.155832 303.1492 335.1023
 [67,] 329.8307  9.062090 311.6248 347.1112
 [68,] 340.1855 10.443693 319.5347 360.3471
 [69,] 350.5403 12.139412 326.3144 373.8367
 [70,] 360.8952 14.035857 333.0670 388.1432
 [71,] 244.2381 12.292799 219.4638 267.1708
 [72,] 255.7397 10.590358 234.8887 275.6863
 [73,] 267.2413  9.168174 249.5580 284.9366
 [74,] 278.7430  8.173868 263.1021 294.4350
 [75,] 290.2446  7.773402 275.2287 305.2028
 [76,] 301.7462  8.055831 286.1808 316.9539
 [77,] 313.2478  8.956786 296.0375 330.4891
 [78,] 324.7494 10.315453 304.6393 345.1022
 [79,] 336.2510 11.977066 313.0346 360.2041
 [80,] 347.7527 13.832881 321.1995 375.4433
 [81,] 250.8012 13.545644 223.7610 277.3415
 [82,] 250.5820 11.550796 227.5995 273.1832
 [83,] 250.3628  9.833393 230.6276 269.5495
 [84,] 250.1436  8.562050 233.5048 266.8329
 [85,] 249.9244  7.953623 234.4298 265.5965
 [86,] 249.7052  8.157810 233.5633 265.7785
 [87,] 249.4860  9.120195 231.6850 267.4464
 [88,] 249.2668 10.636936 228.5285 270.1044
 [89,] 249.0476 12.507964 224.3247 273.6015
 [90,] 248.8284 14.597681 219.9772 277.4376
 [91,] 286.1764 12.818101 260.9893 311.4002
 [92,] 305.3010 11.006145 283.8551 327.1094
 [93,] 324.4257  9.469321 305.8697 343.1336
 [94,] 343.5504  8.360750 327.3385 359.9697
 [95,] 362.6751  7.863684 347.1499 377.6489
 [96,] 381.7997  8.091613 365.7792 397.1546
 [97,] 400.9244  8.989558 382.9374 418.2517
 [98,] 420.0491 10.385153 399.3206 440.0293
 [99,] 439.1737 12.107515 414.7571 462.0723
[100,] 458.2984 14.036871 430.3839 485.1196
[101,] 226.5801 12.892846 200.8132 252.1089
[102,] 238.1306 11.081342 216.1347 259.9578
[103,] 249.6812  9.556197 230.6785 268.7209
[104,] 261.2317  8.473475 244.5375 278.0446
[105,] 272.7822  8.014535 257.1102 288.8462
[106,] 284.3328  8.283711 267.9217 300.7531
[107,] 295.8833  9.217433 277.8168 314.4772
[108,] 307.4339 10.642199 286.9166 329.0362
[109,] 318.9844 12.389747 294.8843 344.1707
[110,] 330.5350 14.342572 303.1460 359.5997
[111,] 238.6551 13.152585 212.1786 263.5576
[112,] 255.6882 11.248969 233.3805 277.0115
[113,] 272.7212  9.624491 253.6260 291.2897
[114,] 289.7542  8.441865 273.1221 306.3026
[115,] 306.7873  7.902030 291.3155 321.9506
[116,] 323.8203  8.133990 307.7472 339.1911
[117,] 340.8534  9.078781 322.6325 358.0338
[118,] 357.8864 10.546537 336.5463 377.7059
[119,] 374.9195 12.352221 350.3629 398.0833
[120,] 391.9525 14.368995 363.7343 419.3401
[121,] 255.8005 12.606079 231.0726 281.5745
[122,] 263.2939 10.865239 242.0471 285.3851
[123,] 270.7874  9.415185 252.2144 289.4753
[124,] 278.2809  8.407739 261.7324 294.4121
[125,] 285.7743  8.011649 269.8453 301.1626
[126,] 293.2678  8.314749 276.9169 309.1235
[127,] 300.7612  9.248549 282.4936 318.2998
[128,] 308.2547 10.648396 287.5002 328.7580
[129,] 315.7482 12.356905 291.3664 339.3544
[130,] 323.2416 14.263588 295.2076 349.9627
[131,] 271.9713 12.304644 247.7014 296.7151
[132,] 286.0302 10.586354 265.4624 307.2077
[133,] 300.0891  9.141745 282.1904 317.9385
[134,] 314.1480  8.118254 298.2731 329.8730
[135,] 328.2069  7.685999 312.9180 343.4838
[136,] 342.2658  7.942107 326.4202 357.8723
[137,] 356.3247  8.826863 338.8451 373.9681
[138,] 370.3836 10.177618 350.0225 390.6256
[139,] 384.4425 11.835890 361.0972 407.9279
[140,] 398.5014 13.690384 371.2172 425.4147
[141,] 254.4077 11.799246 231.5650 278.9696
[142,] 265.7973 10.167398 246.5315 287.1093
[143,] 277.1870  8.831862 259.9443 295.7556
[144,] 288.5766  7.943528 273.2838 304.6398
[145,] 299.9663  7.659605 285.3089 315.2576
[146,] 311.3559  8.044347 295.9789 327.2953
[147,] 322.7456  9.012521 305.1921 340.4755
[148,] 334.1353 10.402480 313.3128 354.5746
[149,] 345.5249 12.069370 320.8882 369.2829
[150,] 356.9146 13.914017 328.5412 383.8745
[151,] 226.1098 13.582924 199.5763 251.5721
[152,] 241.3487 11.586406 219.0067 263.0013
[153,] 256.5876  9.862710 237.4519 275.4964
[154,] 271.8265  8.577914 254.8774 288.5768
[155,] 287.0654  7.947795 271.3382 302.3726
[156,] 302.3043  8.126105 286.3083 317.9986
[157,] 317.5432  9.065263 299.8050 335.2380
[158,] 332.7821 10.564266 312.0588 353.5031
[159,] 348.0211 12.422066 324.1873 372.6116
[160,] 363.2600 14.501415 335.3305 391.9760
[161,] 252.0706 11.691505 228.7178 274.7288
[162,] 261.5657 10.027081 241.6562 281.2516
[163,] 271.0609  8.648269 253.6708 288.1335
[164,] 280.5560  7.709857 265.1934 295.4637
[165,] 290.0511  7.381760 275.3120 303.8096
[166,] 299.5463  7.741964 284.2116 314.4923
[167,] 309.0414  8.705444 291.4312 325.5287
[168,] 318.5366 10.101022 298.2777 337.9282
[169,] 328.0317 11.776064 304.2558 350.4720
[170,] 337.5268 13.627907 309.7279 363.5561
[171,] 263.3953 12.285548 239.3120 287.5994
[172,] 275.1796 10.575284 254.4270 295.8930
[173,] 286.9639  9.145873 268.5139 305.0216
[174,] 298.7482  8.146520 282.1962 314.8868
[175,] 310.5325  7.745514 295.2875 325.8594
[176,] 322.3167  8.032972 306.6410 338.1407
[177,] 334.1010  8.942745 316.3852 351.5466
[178,] 345.8853 10.311410 325.3495 365.6630
[179,] 357.6696 11.982742 333.8905 380.6063
[180,] 369.4539 13.847579 341.9724 396.1258</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.3561678 12.834678  -28.5032781  21.7180879
  [2,]  -14.8053707 10.947348  -35.6527030   7.6022006
  [3,]  -42.3033736  9.352037  -60.1516573 -23.2866025
  [4,]    8.7419235  8.220553   -7.1665504  24.9964453
  [5,]   24.5601206  7.758550    9.2008353  39.8228640
  [6,]   62.8044176  8.081672   46.8954230  78.6373068
  [7,]   10.7242147  9.106725   -6.8720662  28.8969602
  [8,] -100.9248882 10.632601 -121.5937304 -79.8477202
  [9,]   19.9179089 12.476885   -4.1199645  44.5593260
 [10,]   36.0922060 14.518740    7.9164280  64.0403412
 [11,]   11.4751509 13.118927  -14.1260257  37.5370385
 [12,]   -7.8090556 11.291394  -30.0264636  14.3283692
 [13,]  -11.9131620  9.724082  -30.8642493   7.3868890
 [14,]  -12.0000685  8.561119  -28.6001565   5.2131564
 [15,]  -10.8070749  7.981265  -26.1133039   5.3433158
 [16,]   -4.3774814  8.110563  -19.7975865  11.8007624
 [17,]   -8.5250878  8.918223  -25.6056128   8.8932279
 [18,]   -6.2442943 10.245048  -26.4586113  14.0964080
 [19,]   -1.4919007 11.918898  -24.6021661  22.3646838
 [20,]    9.7104928 13.814198  -17.5468281  37.1791888
 [21,]  -13.9118813 13.279019  -39.1810206  13.2691863
 [22,]  -23.5251030 11.430227  -45.3595469  -0.5215867
 [23,]   11.5711753  9.858620   -7.1150122  31.3162617
 [24,]    5.2012536  8.715463  -11.8081120  22.4583380
 [25,]   -3.2244681  8.182346  -19.5981742  12.8065045
 [26,]  -16.9654898  8.376566  -33.7525824  -0.6130145
 [27,]   -6.8941115  9.252432  -25.4181023  10.8556199
 [28,]    8.5446668 10.642967  -12.6073344  29.4739577
 [29,]    8.9145452 12.375886  -15.1316404  33.7041255
 [30,]   -9.4741765 14.327490  -37.0598236  19.2986640
 [31,]   47.1932147 13.202811   21.4401479  71.8341509
 [32,]   20.2577642 11.291901   -2.2634057  41.6959864
 [33,]   -2.0789864  9.637249  -21.1296913  16.5594456
 [34,]   -6.5955369  8.391830  -23.1037835   9.4379846
 [35,]  -11.7242875  7.755371  -27.1074739   3.1033096
 [36,]   -5.7291380  7.876895  -21.2176739   9.6028738
 [37,]  -28.8680885  8.724785  -46.2292854 -12.5061626
 [38,]    3.3605609 10.118054  -16.6895792  22.6522186
 [39,]  -15.3442896 11.866122  -38.9164417   7.5249409
 [40,]   27.5618599 13.835152   -0.1581393  54.5248505
 [41,]   14.6559641 13.062862  -11.7010536  39.2059439
 [42,]    4.5474749 11.205037  -17.7600398  25.5354682
 [43,]   13.8674858  9.609564   -5.4227805  32.0930360
 [44,]   24.6615966  8.426803    7.8861485  40.7389021
 [45,]   13.3230075  7.845680   -2.4008531  28.7064501
 [46,]  -17.1361817  7.998424  -32.8850574  -1.4103834
 [47,]  -27.8804708  8.847105  -45.4794718 -10.3935164
 [48,]    9.3616400 10.219793  -10.6570352  29.8722162
 [49,]  -39.2097491 11.937062  -62.1943720 -15.4564118
 [50,]   31.1238617 13.871523    4.5289388  58.7192515
 [51,]  -25.5069125 12.320388  -50.4868851  -1.6379299
 [52,]  -27.7648504 10.598245  -49.1261226  -7.0988217
 [53,]   -7.8244883  9.167299  -25.9795291  10.1215738
 [54,]   18.7738738  8.181791    3.0057499  34.8409062
 [55,]   16.2588359  7.812155    1.1111827  31.2965099
 [56,]   -1.4156020  8.142700  -17.4945598  14.1847509
 [57,]  132.5395601  9.097423  114.2263715 150.0065938
 [58,]   14.9996222 10.507539   -6.1420465  35.1498277
 [59,]  -11.7403157 12.216358  -35.8922502  11.9106147
 [60,]  -98.3853536 14.115812 -126.2651030 -71.1145019
 [61,]   16.1407960 12.596769   -8.6788489  40.3655692
 [62,]   11.4985536 10.842309   -9.9050652  32.4788848
 [63,]  -11.6419888  9.368997  -30.0783368   6.7925613
 [64,]    1.0435688  8.327419  -15.3519922  17.0097038
 [65,]  -11.9499736  7.890442  -27.0344759   3.5993807
 [66,]   18.6906841  8.155832    3.0641956  35.0173370
 [67,]    2.1958417  9.062090  -15.0846908  20.4017067
 [68,]    8.6543993 10.443693  -11.5072377  29.3051602
 [69,]  -17.1803431 12.139412  -40.4766765   7.0455506
 [70,]    1.1476145 14.035857  -26.1003669  28.9758091
 [71,]   21.2350030 12.292799   -1.6977413  46.0092834
 [72,]   20.4614841 10.590358    0.5148697  41.3124915
 [73,]  -23.8766349  9.168174  -41.5719394  -6.1932613
 [74,]  -24.0706538  8.173868  -39.7627256  -8.4298265
 [75,]  -11.2201727  7.773402  -26.1783900   3.7956501
 [76,]  -17.5549917  8.055831  -32.7627242  -1.9895821
 [77,]   -7.7230106  8.956786  -24.9643019   9.4873472
 [78,]    6.7734704 10.315453  -13.5792773  26.8835644
 [79,]   -0.5041485 11.977066  -24.4572111  22.7122648
 [80,]   29.5463325 13.832881    1.8557417  56.0995209
 [81,]   -9.1928792 13.545644  -35.7332436  17.8472997
 [82,]   23.3652207 11.550796    0.7639553  46.3476945
 [83,]    4.1279207  9.833393  -15.0588228  23.8630821
 [84,]   20.6585206  8.562050    3.9691778  37.2973270
 [85,]    1.5275205  7.953623  -14.1446201  17.0220834
 [86,]    4.9310204  8.157810  -11.1422854  21.0729447
 [87,]   -4.0336797  9.120195  -21.9940772  13.7672824
 [88,]  -13.9557797 10.636936  -34.7934000   6.7824518
 [89,]  -13.2934798 12.507964  -37.8473958  11.4294214
 [90,]  -11.5817799 14.597681  -40.1909979  17.2694347
 [91,]   26.1902391 12.818101    0.9663856  51.3773325
 [92,]    8.5047664 11.006145  -13.3036469  29.9506890
 [93,]  -32.8145063  9.469321  -51.5224146 -14.2585395
 [94,]    2.5718210  8.360750  -13.8474730  18.7837372
 [95,]    3.0573483  7.863684  -11.9165090  18.5824922
 [96,]   10.0387756  8.091613   -5.3161402  26.0592956
 [97,]    3.3357029  8.989558  -13.9916249  21.3226859
 [98,]   -3.3567698 10.385153  -23.3369888  17.3717159
 [99,]   16.6905575 12.107515   -6.2080109  41.1071678
[100,]    0.6182848 14.036871  -26.2028889  28.5328071
[101,]    9.5231423 12.892846  -16.0057179  35.2900412
[102,]   -7.8139040 11.081342  -29.6410942  14.1819737
[103,]  -10.7555504  9.556197  -29.7952575   8.2471345
[104,]   -6.3096967  8.473475  -23.1225717  10.3844792
[105,]  -22.0719431  8.014535  -38.1358838  -6.3999301
[106,]  -14.5583894  8.283711  -30.9787381   1.8526829
[107,]  -14.3185358  9.217433  -32.9123785   3.7479833
[108,]    0.6681179 10.642199  -20.9342297  21.1854215
[109,]   17.2961716 12.389747   -7.8900621  41.3962735
[110,]   21.1101252 14.342572   -7.9545825  48.4991431
[111,]   17.6416963 13.152585   -7.2608129  44.1181830
[112,]  -12.2338503 11.248969  -33.5571562  10.0738095
[113,]  -16.5165969  9.624491  -35.0850879   2.5786001
[114,]  -34.2271435  8.441865  -50.7754761 -17.5950088
[115,]  -37.8707901  7.902030  -53.0341087 -22.3990242
[116,]    5.9043633  8.133990   -9.4664079  21.9774618
[117,]   38.5911167  9.078781   21.4107422  56.8119632
[118,]    5.0319702 10.546537  -14.7875365  26.3720744
[119,]   19.5677236 12.352221   -3.5960771  44.1243458
[120,]   -2.8998230 14.368995  -30.2874270  25.3183557
[121,]   -5.2739810 12.606079  -31.0480485  19.4539379
[122,]   36.7636582 10.865239   14.6725428  58.0105457
[123,]   -0.8935026  9.415185  -19.5813920  17.6795067
[124,]    2.3082366  8.407739  -13.8229595  18.8567411
[125,]  -13.9469242  8.011649  -29.3352316   1.9820862
[126,]   11.3658150  8.314749   -4.4899406  27.7166709
[127,]  -13.0146458  9.248549  -30.5531952   5.2529540
[128,]  -41.6592067 10.648396  -62.1625265 -20.9047060
[129,]    5.7936325 12.356905  -17.8125657  30.1754188
[130,]   24.3238717 14.263588   -2.3971622  52.3578617
[131,]  -50.2942299 12.304644  -75.0380021 -26.0242821
[132,]   12.1636745 10.586354   -9.0137729  32.7315293
[133,]   26.7893789  9.141745    8.9400305  44.6880533
[134,]   32.7074833  8.118254   16.9824806  48.5824246
[135,]   20.5332878  7.685999    5.2564194  35.8221879
[136,]   10.5628922  7.942107   -5.0435980  26.4085174
[137,]   -1.8981034  8.826863  -19.5414584  15.5815295
[138,]   -9.9509990 10.177618  -30.1929788  10.4101332
[139,]   -8.8018945 11.835890  -32.2873208  14.5433708
[140,]   -9.9596901 13.690384  -36.8729694  17.3244898
[141,]   17.5158295 11.799246   -7.0461133  40.3585411
[142,]    2.6395740 10.167398  -18.6723579  21.9053542
[143,]  -19.9445815  8.831862  -38.5131820  -2.7019113
[144,]  -10.9200370  7.943528  -26.9832299   4.3728221
[145,]   14.8559075  7.659605   -0.4354367  29.5132956
[146,]    5.8575520  8.044347  -10.0818193  21.2345868
[147,]  -24.6103035  9.012521  -42.3402181  -7.0568146
[148,]   13.9876410 10.402480   -6.4517477  34.8101202
[149,]   -5.2449144 12.069370  -29.0028817  19.3917553
[150,]    9.5985301 13.914017  -17.3614360  37.9719206
[151,]   -0.8457515 13.582924  -26.3080613  25.6876964
[152,]   -6.8251652 11.586406  -28.4777542  15.5168093
[153,]  -17.6867789  9.862710  -36.5955873   1.4489072
[154,]  -31.3534926  8.577914  -48.1037640 -14.4044335
[155,]  -19.5281063  7.947795  -34.8353127  -3.8009298
[156,]   41.8893799  8.126105   26.1951235  57.8854025
[157,]  -36.3951338  9.065263  -54.0899384 -18.6568835
[158,]   14.8033525 10.564266   -5.9176206  35.5267185
[159,]   17.1419388 12.422066   -7.4485578  40.9756940
[160,]    8.9688250 14.501415  -19.7472240  36.8983242
[161,]   17.8098005 11.691505   -4.8484422  41.1625980
[162,]   10.8770636 10.027081   -8.8087983  30.7865507
[163,]    6.8380268  8.648269  -10.2345518  24.2281315
[164,]    1.2334900  7.709857  -13.6742165  16.5961194
[165,]  -10.8806468  7.381760  -24.6391419   3.8584554
[166,]  -15.0342837  7.741964  -29.9803299   0.3004160
[167,]  -49.7756205  8.705444  -66.2629068 -32.1653791
[168,]  -13.9059573 10.101022  -33.2975876   6.3529281
[169,]   22.7490059 11.776064    0.3087075  46.5249416
[170,]   31.9423691 13.627907    5.9130978  59.7412708
[171,]    6.0164443 12.285548  -18.1876812  30.0996904
[172,]   -1.7055543 10.575284  -22.4189973  19.0470123
[173,]   10.6329471  9.145873   -7.4248110  29.0828707
[174,]   11.8834485  8.146520   -4.2552264  28.4354241
[175,]  -23.3598501  7.745514  -38.6868373  -8.1148778
[176,]    7.2908514  8.032972   -8.5330714  22.9665860
[177,]    0.3807528  8.942745  -17.0647682  18.0966214
[178,]   -2.6654458 10.311410  -22.4431070  17.8703806
[179,]   11.4720556 11.982742  -11.4645705  35.2511953
[180,]   -5.3303430 13.847579  -32.0022201  22.1512201</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.2 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   525       
 (0.5, 0.7]   (ok)         1    0.6%   94        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.6 22.2
p_loo        33.8  8.4
looic      1721.3 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1094      
 (0.5, 0.7]   (ok)         5    2.8%   641       
   (0.7, 1]   (bad)        3    1.7%   28        
   (1, Inf)   (very bad)   1    0.6%   23        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.5      11.5  
fit_sleep1 -92.6      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.2 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   525       
 (0.5, 0.7]   (ok)         1    0.6%   94        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.6 22.2
p_loo        33.8  8.4
looic      1721.3 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1094      
 (0.5, 0.7]   (ok)         5    2.8%   641       
   (0.7, 1]   (bad)        3    1.7%   28        
   (1, Inf)   (very bad)   1    0.6%   23        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.6     22.2        33.8    8.4   1721.3
fit_sleep2  -24.5      11.5  -885.1     14.4        19.6    3.4   1770.2
fit_sleep1  -92.6      20.9  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.5  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
5.813017e-41 2.324075e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.64     0.19     5.49       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.64    -3.48     3.01       5.01      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.3          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.3         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.3.1      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
