<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.95      6.88    15.62    42.69 1.00     1649     2582
sd(Days)                6.61      1.54     4.23    10.30 1.00     1587     1961
cor(Intercept,Days)     0.09      0.30    -0.48     0.68 1.00      953     1445

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.19      7.32   236.38   265.45 1.00     2005     2547
Days         10.49      1.71     7.02    13.96 1.00     1472     1685

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.57    23.11    29.22 1.00     3999     3106

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9219  12.98319 228.4722 279.5984
309 211.5292  13.35195 184.4296 237.7061
310 212.6485  12.73022 187.2188 236.9152
330 274.4180  13.66516 248.3957 301.5592
331 273.0639  12.91818 248.1002 298.4364
332 260.4802  12.05239 237.0990 284.3211
333 267.8320  12.58218 244.1000 292.8358
334 244.5653  12.13134 220.0487 267.8828
335 250.6686  13.11770 225.9891 276.7771
337 285.6429  13.02394 259.6489 311.7963
349 226.9852  13.07813 201.0008 251.7906
350 238.6668  13.26755 212.1476 263.8301
351 255.7617  12.22556 231.8682 279.4981
352 272.1253  12.77845 247.4048 298.0236
369 254.7777  12.40628 230.3949 278.9590
370 226.0974  13.42424 198.9292 251.7172
371 252.1368  12.41585 226.7625 276.6225
372 263.2807  12.38877 238.7728 287.9952

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6498732  2.438307 14.9571180 24.542381
309  1.6958762  2.512489 -3.1024505  6.699096
310  4.9509727  2.391543  0.2090198  9.605635
330  5.7396104  2.560963  0.5848726 10.753814
331  7.4665318  2.437551  2.5939605 12.140567
332 10.2039701  2.331349  5.4845867 14.714088
333 10.2991580  2.403147  5.5843443 14.991500
334 11.4935043  2.323929  7.0049963 16.016608
335 -0.2708222  2.539814 -5.3527369  4.626537
337 19.2202414  2.462750 14.5247720 23.958592
349 11.5320009  2.464283  6.8107926 16.533516
350 17.0355343  2.529437 12.2342147 22.050936
351  7.5107009  2.328085  2.9401078 12.128984
352 14.0347659  2.410771  9.3465049 18.849836
369 11.2682129  2.372686  6.6268358 15.890786
370 15.2326005  2.530144 10.3507231 20.186356
371  9.5294706  2.372788  4.7493763 14.126174
372 11.8533419  2.387574  7.1429164 16.520735</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9219 12.983194 228.4722 279.5984
  [2,] 273.5718 11.135144 251.7300 295.4582
  [3,] 293.2217  9.555638 274.3093 311.8419
  [4,] 312.8715  8.397599 296.3660 329.3096
  [5,] 332.5214  7.849829 317.2766 347.8241
  [6,] 352.1713  8.038074 336.6204 368.5184
  [7,] 371.8212  8.915836 354.7225 389.5700
  [8,] 391.4710 10.308458 371.7935 411.7573
  [9,] 411.1209 12.038570 388.0525 434.8056
 [10,] 430.7708 13.981442 403.6582 458.3121
 [11,] 211.5292 13.351949 184.4296 237.7061
 [12,] 213.2250 11.441468 190.0724 235.3111
 [13,] 214.9209  9.806377 195.2622 233.7177
 [14,] 216.6168  8.605119 199.4364 233.1913
 [15,] 218.3127  8.034694 202.3719 233.7142
 [16,] 220.0085  8.227378 203.5474 235.8415
 [17,] 221.7044  9.135008 203.3483 239.6681
 [18,] 223.4003 10.575075 202.8559 244.5311
 [19,] 225.0962 12.362897 200.6439 249.5920
 [20,] 226.7920 14.369254 198.4720 254.9288
 [21,] 212.6485 12.730220 187.2188 236.9152
 [22,] 217.5995 10.947746 195.8540 238.6516
 [23,] 222.5505  9.438578 204.2740 241.0316
 [24,] 227.5015  8.352205 211.4219 243.8149
 [25,] 232.4524  7.865803 217.3763 248.0029
 [26,] 237.4034  8.088346 221.7642 253.2061
 [27,] 242.3544  8.967206 224.8740 259.4249
 [28,] 247.3054 10.336304 227.0428 266.8371
 [29,] 252.2563 12.029402 228.3390 275.2246
 [30,] 257.2073 13.928849 229.3350 284.1698
 [31,] 274.4180 13.665163 248.3957 301.5592
 [32,] 280.1576 11.701709 257.6525 303.2452
 [33,] 285.8972 10.012012 266.5602 305.7736
 [34,] 291.6368  8.756016 274.5291 309.2495
 [35,] 297.3764  8.137095 281.3822 313.8224
 [36,] 303.1161  8.299029 286.8223 319.9296
 [37,] 308.8557  9.200680 290.8443 327.5008
 [38,] 314.5953 10.655901 293.9910 336.3519
 [39,] 320.3349 12.472409 296.0372 345.7358
 [40,] 326.0745 14.515192 297.7632 354.8917
 [41,] 273.0639 12.918184 248.1002 298.4364
 [42,] 280.5305 11.077148 259.1855 302.2914
 [43,] 287.9970  9.508430 269.4437 306.6523
 [44,] 295.4635  8.366636 278.8689 311.7414
 [45,] 302.9301  7.840553 287.6792 318.3064
 [46,] 310.3966  8.051785 294.4986 326.3208
 [47,] 317.8631  8.948269 300.2341 335.3771
 [48,] 325.3297 10.353507 304.8296 345.9593
 [49,] 332.7962 12.091403 309.3210 356.4532
 [50,] 340.2627 14.038954 312.9072 367.6809
 [51,] 260.4802 12.052385 237.0990 284.3211
 [52,] 270.6842 10.397049 250.4024 290.8574
 [53,] 280.8881  9.044757 263.5669 298.5915
 [54,] 291.0921  8.147823 275.5684 307.1120
 [55,] 301.2961  7.863637 286.2768 316.7736
 [56,] 311.5001  8.255721 295.4706 327.8202
 [57,] 321.7040  9.238369 303.7942 339.8537
 [58,] 331.9080 10.649336 310.8511 353.3837
 [59,] 342.1120 12.342595 317.8372 366.8883
 [60,] 352.3159 14.217641 324.4909 380.2465
 [61,] 267.8320 12.582177 244.1000 292.8358
 [62,] 278.1312 10.837306 257.5962 299.8050
 [63,] 288.4303  9.387942 270.6283 307.3916
 [64,] 298.7295  8.388679 282.7228 315.3289
 [65,] 309.0286  8.009784 293.5241 324.8950
 [66,] 319.3278  8.336281 303.0853 335.8842
 [67,] 329.6270  9.294124 311.2059 347.9637
 [68,] 339.9261 10.715323 318.9332 360.9743
 [69,] 350.2253 12.442097 326.3095 374.8700
 [70,] 360.5244 14.364666 332.7422 389.1773
 [71,] 244.5653 12.131343 220.0487 267.8828
 [72,] 256.0588 10.433230 235.2682 275.9651
 [73,] 267.5523  9.018669 249.5520 284.9120
 [74,] 279.0458  8.038766 263.0859 294.3957
 [75,] 290.5393  7.662143 275.3775 305.3673
 [76,] 302.0328  7.974735 286.5509 317.8228
 [77,] 313.5263  8.904248 295.9820 331.3316
 [78,] 325.0198 10.284755 304.7411 345.3465
 [79,] 336.5133 11.961104 313.1743 360.2783
 [80,] 348.0068 13.826103 321.3757 375.4989
 [81,] 250.6686 13.117703 225.9891 276.7771
 [82,] 250.3978 11.182665 228.7690 272.3228
 [83,] 250.1270  9.535783 231.6303 268.6377
 [84,] 249.8561  8.349349 233.7919 265.8789
 [85,] 249.5853  7.835394 234.6134 264.6221
 [86,] 249.3145  8.122592 233.2386 264.8226
 [87,] 249.0437  9.135694 230.6655 266.7507
 [88,] 248.7729 10.669893 227.8775 269.5359
 [89,] 248.5020 12.535296 223.7260 272.8373
 [90,] 248.2312 14.605546 219.1490 276.3454
 [91,] 285.6429 13.023936 259.6489 311.7963
 [92,] 304.8631 11.188932 282.3904 326.9365
 [93,] 324.0833  9.638039 304.8543 343.0207
 [94,] 343.3036  8.527699 326.3812 359.8496
 [95,] 362.5238  8.042499 346.4961 378.2227
 [96,] 381.7441  8.292901 365.6069 398.2323
 [97,] 400.9643  9.219160 383.0335 418.9405
 [98,] 420.1845 10.646308 399.6325 440.6928
 [99,] 439.4048 12.402626 415.5448 462.9230
[100,] 458.6250 14.367904 430.8899 486.0710
[101,] 226.9852 13.078134 201.0008 251.7906
[102,] 238.5172 11.219014 215.9509 259.8615
[103,] 250.0492  9.635368 230.3599 268.5708
[104,] 261.5812  8.482910 244.5430 278.2159
[105,] 273.1132  7.951388 257.5010 288.9329
[106,] 284.6452  8.163012 268.6625 300.9121
[107,] 296.1772  9.065889 278.8884 314.2228
[108,] 307.7092 10.482905 287.4439 328.7534
[109,] 319.2412 12.236733 295.3533 343.6151
[110,] 330.7732 14.203146 303.3392 358.6357
[111,] 238.6668 13.267549 212.1476 263.8301
[112,] 255.7023 11.341118 233.5148 277.4142
[113,] 272.7379  9.695884 253.5932 291.4114
[114,] 289.7734  8.496792 272.9092 306.1164
[115,] 306.8089  7.948389 290.8998 322.3830
[116,] 323.8445  8.182568 307.7024 339.3974
[117,] 340.8800  9.139368 323.3835 358.4650
[118,] 357.9155 10.625337 337.0748 378.4932
[119,] 374.9511 12.452455 350.3917 398.8434
[120,] 391.9866 14.492260 363.8522 420.1364
[121,] 255.7617 12.225555 231.8682 279.4981
[122,] 263.2724 10.510472 242.9882 283.8747
[123,] 270.7831  9.072805 253.5829 288.5804
[124,] 278.2938  8.062352 262.4786 293.6082
[125,] 285.8045  7.650307 270.5871 300.2379
[126,] 293.3152  7.930500 277.2033 308.2086
[127,] 300.8259  8.837332 282.9481 317.3392
[128,] 308.3366 10.205096 288.0756 327.8452
[129,] 315.8473 11.875584 292.3516 338.6343
[130,] 323.3580 13.738812 296.6799 349.8404
[131,] 272.1253 12.778450 247.4048 298.0236
[132,] 286.1601 10.994999 265.0430 308.3947
[133,] 300.1949  9.492884 281.8982 318.9101
[134,] 314.2296  8.423974 297.6874 330.4574
[135,] 328.2644  7.964638 312.8516 343.7641
[136,] 342.2992  8.217739 326.2216 357.9142
[137,] 356.3339  9.124178 338.5482 373.9000
[138,] 370.3687 10.516353 349.8366 390.6512
[139,] 384.4035 12.229487 360.4405 407.9390
[140,] 398.4382 14.147461 370.6418 425.8635
[141,] 254.7777 12.406278 230.3949 278.9590
[142,] 266.0460 10.685451 245.2517 287.1434
[143,] 277.3142  9.257497 259.4626 295.7367
[144,] 288.5824  8.275442 272.6983 305.2297
[145,] 299.8506  7.907205 284.7406 315.5041
[146,] 311.1188  8.235540 295.1118 326.9798
[147,] 322.3870  9.186056 304.0316 340.0585
[148,] 333.6552 10.592564 312.2124 354.1582
[149,] 344.9234 12.299613 320.2351 368.7026
[150,] 356.1917 14.199219 328.1397 383.5760
[151,] 226.0974 13.424243 198.9292 251.7172
[152,] 241.3300 11.514077 218.4548 263.6204
[153,] 256.5626  9.886401 236.8182 276.0667
[154,] 271.7952  8.701215 254.6929 289.1097
[155,] 287.0278  8.153809 271.1729 303.2351
[156,] 302.2604  8.370265 285.6041 319.1283
[157,] 317.4930  9.297382 298.9435 336.1983
[158,] 332.7256 10.752886 311.2532 353.7370
[159,] 347.9582 12.554324 322.7339 372.3819
[160,] 363.1908 14.573977 333.9529 391.4522
[161,] 252.1368 12.415854 226.7625 276.6225
[162,] 261.6663 10.701726 239.5883 282.6249
[163,] 271.1957  9.282278 251.9473 289.3912
[164,] 280.7252  8.309915 263.8879 296.8529
[165,] 290.2547  7.950405 274.4073 305.8910
[166,] 299.7841  8.283927 283.0623 316.0948
[167,] 309.3136  9.235702 290.9603 327.7200
[168,] 318.8431 10.641109 298.1464 340.3307
[169,] 328.3726 12.346191 304.0960 353.3736
[170,] 337.9020 14.243733 309.9968 366.4271
[171,] 263.2807 12.388768 238.7728 287.9952
[172,] 275.1340 10.659269 253.8870 296.5061
[173,] 286.9874  9.228189 268.5441 305.7394
[174,] 298.8407  8.252269 282.6847 315.3390
[175,] 310.6940  7.901990 295.3975 326.4918
[176,] 322.5474  8.257358 306.0677 338.7179
[177,] 334.4007  9.237289 315.9405 352.4519
[178,] 346.2541 10.671086 325.0615 367.4642
[179,] 358.1074 12.402325 333.2235 382.8865
[180,] 369.9607 14.323556 341.7365 398.2302</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error         Q2.5      Q97.5
  [1,]   -4.36192354 12.983194  -30.0384350  21.087836
  [2,]  -14.86709669 11.135144  -36.7534790   6.974663
  [3,]  -42.42106984  9.555638  -61.0412819 -23.508743
  [4,]    8.56825700  8.397599   -7.8697977  25.073795
  [5,]   24.33048385  7.849829    9.0278297  39.575284
  [6,]   62.51881070  8.038074   46.1717160  78.069713
  [7,]   10.38263755  8.915836   -7.3661706  27.481285
  [8,] -101.32243561 10.308458 -121.6087492 -81.644869
  [9,]   19.46439124 12.038570   -4.2203355  42.532828
 [10,]   35.58271809 13.981442    8.0414363  62.695325
 [11,]   11.20473725 13.351949  -14.9722430  38.304283
 [12,]   -7.95923895 11.441468  -30.0452616  15.193428
 [13,]  -11.94311515  9.806377  -30.7398694   7.715589
 [14,]  -11.90979134  8.605119  -28.4842947   5.270649
 [15,]  -10.59656754  8.034694  -25.9981077   5.344247
 [16,]   -4.04674374  8.227378  -19.8796722  12.414445
 [17,]   -8.07411994  9.135008  -26.0378244  10.282036
 [18,]   -5.67309613 10.575075  -26.8038660  14.871320
 [19,]   -0.80047233 12.362897  -25.2963029  23.651848
 [20,]   10.52215147 14.369254  -17.6145794  38.842200
 [21,]  -13.59464693 12.730220  -37.8612765  11.835113
 [22,]  -23.26731960 10.947746  -44.3193543  -1.521820
 [23,]   11.76950774  9.438578   -6.7116452  30.046025
 [24,]    5.34013508  8.352205  -10.9732527  21.419708
 [25,]   -3.14503758  7.865803  -18.6955045  11.931106
 [26,]  -16.94551025  8.088346  -32.7482255  -1.306342
 [27,]   -6.93358291  8.967206  -24.0041382  10.546823
 [28,]    8.44574443 10.336304  -11.0859767  28.708261
 [29,]    8.75617176 12.029402  -14.2120870  32.673499
 [30,]   -9.69200090 13.928849  -36.6544733  18.180270
 [31,]   47.12460132 13.665163   19.9833932  73.146930
 [32,]   20.24259091 11.701709   -2.8450465  42.747659
 [33,]   -2.04071950 10.012012  -21.9170932  17.296333
 [34,]   -6.50382991  8.756016  -24.1165493  10.603918
 [35,]  -11.57914033  8.137095  -28.0251423   4.415126
 [36,]   -5.53055074  8.299029  -22.3440614  10.763223
 [37,]  -28.61606115  9.200680  -47.2612128 -10.604707
 [38,]    3.66602844 10.655901  -18.0906110  24.270322
 [39,]  -14.98538198 12.472409  -40.3863067   9.312250
 [40,]   27.97420761 14.515192   -0.8429783  56.285512
 [41,]   14.54395635 12.918184  -10.8284919  39.507740
 [42,]    4.46952459 11.077148  -17.2913781  25.814550
 [43,]   13.82359283  9.508430   -4.8317121  32.376932
 [44,]   24.65176107  8.366636    8.3739073  41.246417
 [45,]   13.34722931  7.840553   -2.0290561  28.598144
 [46,]  -17.07790245  8.051785  -33.0020999  -1.179900
 [47,]  -27.78813422  8.948269  -45.3020758 -10.159074
 [48,]    9.48803402 10.353507  -11.1416450  29.988098
 [49,]  -39.04929774 12.091403  -62.7062573 -15.574103
 [50,]   31.31837050 14.038954    3.9001796  58.673873
 [51,]  -25.61960927 12.052385  -49.4604665  -2.238384
 [52,]  -27.87237934 10.397049  -48.0455726  -7.590631
 [53,]   -7.92684942  9.044757  -25.6301537   9.394374
 [54,]   18.67668051  8.147823    2.6568340  34.200356
 [55,]   16.16681044  7.863637    0.6893281  31.186051
 [56,]   -1.50245963  8.255721  -17.8225984  14.526966
 [57,]  132.45787030  9.238369  114.3082182 150.367709
 [58,]   14.92310023 10.649336   -6.5525834  35.979954
 [59,]  -11.81166985 12.342595  -36.5880369  12.463135
 [60,]  -98.45153992 14.217641 -126.3820614 -70.626465
 [61,]   16.01038236 12.582177   -8.9933845  39.742429
 [62,]   11.42382436 10.837306  -10.2500020  31.958763
 [63,]  -11.66103365  9.387942  -30.6223181   6.141009
 [64,]    1.08020835  8.388679  -15.5191797  17.086939
 [65,]  -11.85764965  8.009784  -27.7240166   3.646857
 [66,]   18.83869234  8.336281    2.2822685  35.081151
 [67,]    2.39953434  9.294124  -15.9372247  20.820570
 [68,]    8.91377633 10.715323  -12.1343647  29.906689
 [69,]  -16.86528167 12.442097  -41.5100435   7.050548
 [70,]    1.51836033 14.364666  -27.1344692  29.300605
 [71,]   20.90780385 12.131343   -2.4097166  45.424425
 [72,]   20.14239950 10.433230    0.2361485  40.933027
 [73,]  -24.18760485  9.018669  -41.5472743  -6.187254
 [74,]  -24.37350919  8.038766  -39.7233650  -8.413554
 [75,]  -11.51491354  7.662143  -26.3429347   3.646878
 [76,]  -17.84161788  7.974735  -33.6316153  -2.359733
 [77,]   -8.00152223  8.904248  -25.8067515   9.542775
 [78,]    6.50307342 10.284755  -13.8236126  26.781772
 [79,]   -0.76643092 11.961104  -24.5314198  22.572554
 [80,]   29.29216473 13.826103    1.8001060  55.923312
 [81,]   -9.06030734 13.117703  -35.1687704  15.619235
 [82,]   23.54941489 11.182665    1.6243608  45.178233
 [83,]    4.36373712  9.535783  -14.1470438  22.860380
 [84,]   20.94595935  8.349349    4.9231873  37.010150
 [85,]    1.86658158  7.835394  -13.1701826  16.838454
 [86,]    5.32170381  8.122592  -10.1864276  21.397600
 [87,]   -3.59137396  9.135694  -21.2984216  14.786812
 [88,]  -13.46185174 10.669893  -34.2249368   7.433479
 [89,]  -12.74792951 12.535296  -37.0832201  12.028129
 [90,]  -10.98460728 14.605546  -39.0988261  18.097582
 [91,]   26.72374530 13.023936    0.5702882  52.717667
 [92,]    8.94270386 11.188932  -13.1307484  31.415410
 [93,]  -32.47213757  9.638039  -51.4094521 -13.243086
 [94,]    2.81862099  8.527699  -13.7274437  19.740984
 [95,]    3.20857955  8.042499  -12.4902616  19.236344
 [96,]   10.09443811  8.292901   -6.3938060  26.231581
 [97,]    3.29579667  9.219160  -14.6803696  21.226618
 [98,]   -3.49224476 10.646308  -24.0004682  17.059811
 [99,]   16.45951380 12.402626   -7.0587360  40.319455
[100,]    0.29167236 14.367904  -27.1543229  28.026772
[101,]    9.11801438 13.078134  -15.6873705  35.102429
[102,]   -8.20048653 11.219014  -29.5448460  14.365839
[103,]  -11.12358745  9.635368  -29.6451820   8.565694
[104,]   -6.65918836  8.482910  -23.2939500  10.379030
[105,]  -22.40288927  7.951388  -38.2225710  -6.790693
[106,]  -14.87079019  8.163012  -31.1377064   1.111916
[107,]  -14.61239110  9.065889  -32.6579619   2.676381
[108,]    0.39280799 10.482905  -20.6513682  20.658055
[109,]   17.03940707 12.236733   -7.3345032  40.927333
[110,]   20.87190616 14.203146   -6.9905682  48.305876
[111,]   17.63000952 13.267549   -7.5333333  44.149217
[112,]  -12.24802476 11.341118  -33.9599127   9.939522
[113,]  -16.53325904  9.695884  -35.2068457   2.611385
[114,]  -34.24629332  8.496792  -50.5893252 -17.382083
[115,]  -37.89242760  7.948389  -53.4664746 -21.983316
[116,]    5.88023813  8.182568   -9.6727083  22.022308
[117,]   38.56450385  9.139368   20.9795379  56.061018
[118,]    5.00286957 10.625337  -15.5747686  25.843553
[119,]   19.53613529 12.452455   -4.3562106  44.095461
[120,]   -2.93389899 14.492260  -31.0836525  25.200534
[121,]   -5.23521927 12.225555  -28.9716055  18.658345
[122,]   36.78517980 10.510472   16.1828768  57.069373
[123,]   -0.88922114  9.072805  -18.6864854  16.311026
[124,]    2.29527793  8.062352  -13.0190686  18.110534
[125,]  -13.97712301  7.650307  -28.4105438   1.240338
[126,]   11.31837605  7.930500   -3.5750002  27.430299
[127,]  -13.07932488  8.837332  -29.5925962   4.798536
[128,]  -41.74112582 10.205096  -61.2497119 -21.480119
[129,]    5.69447325 11.875584  -17.0924779  29.190160
[130,]   24.20747231 13.738812   -2.2749373  50.885591
[131,]  -50.44823153 12.778450  -76.3464873 -25.727735
[132,]   12.03380254 10.994999  -10.2008456  33.150897
[133,]   26.68363661  9.492884    7.9684332  44.980272
[134,]   32.62587068  8.423974   16.3980588  49.168093
[135,]   20.47580474  7.964638    4.9761386  35.888570
[136,]   10.52953881  8.217739   -5.0854691  26.607075
[137,]   -1.90732712  9.124178  -19.4733917  15.878361
[138,]   -9.93609305 10.516353  -30.2186003  10.596045
[139,]   -8.76285898 12.229487  -32.2984079  15.200084
[140,]   -9.89652491 14.147461  -37.3218488  17.899942
[141,]   17.14575370 12.406278   -7.0354822  41.528597
[142,]    2.39094081 10.685451  -18.7065449  23.185234
[143,]  -20.07177208  9.257497  -38.4942644  -2.220213
[144,]  -10.92578497  8.275442  -27.5730693   4.958306
[145,]   14.97160214  7.907205   -0.6819493  30.081639
[146,]    6.09468924  8.235540   -9.7663317  22.101682
[147,]  -24.25172365  9.186056  -41.9231523  -5.896283
[148,]   14.46766346 10.592564   -6.0352841  35.910475
[149,]   -4.64344943 12.299613  -28.4225831  20.044889
[150,]   10.32143768 14.199219  -17.0628778  38.373365
[151,]   -0.83341422 13.424243  -26.4531669  26.334771
[152,]   -6.80651469 11.514077  -29.0968524  16.068713
[153,]  -17.66181516  9.886401  -37.1659477   2.082632
[154,]  -31.32221562  8.701215  -48.6366863 -14.219876
[155,]  -19.49051609  8.153809  -35.6978256  -3.635619
[156,]   41.93328344  8.370265   25.0654018  58.589583
[157,]  -36.34491702  9.297382  -55.0502466 -17.795352
[158,]   14.85988251 10.752886   -6.1514970  36.332337
[159,]   17.20478204 12.554324   -7.2189091  42.429086
[160,]    9.03798157 14.573977  -19.2233560  38.275897
[161,]   17.74360615 12.415854   -6.7421494  43.117896
[162,]   10.77653551 10.701726  -10.1820903  32.854462
[163,]    6.70316486  9.282278  -11.4923281  25.951559
[164,]    1.06429422  8.309915  -15.0634301  17.901600
[165,]  -11.08417642  7.950405  -26.7205159   4.763156
[166,]  -15.27214706  8.283927  -31.5827562   1.449659
[167,]  -50.04781771  9.235702  -68.4542375 -31.694458
[168,]  -14.21248835 10.641109  -35.7001068   6.484241
[169,]   22.40814101 12.346191   -2.5929379  46.684693
[170,]   31.56717037 14.243733    3.0420656  59.472446
[171,]    6.13103108 12.388768  -18.5834663  30.638854
[172,]   -1.66001081 10.659269  -23.0320838  19.587017
[173,]   10.60944730  9.228189   -8.1425920  29.052707
[174,]   11.79090541  8.252269   -4.7074171  27.946919
[175,]  -23.52143648  7.901990  -39.3192400  -8.224893
[176,]    7.06022164  8.257358   -9.1103055  23.539907
[177,]    0.08107975  9.237289  -17.9700807  18.541284
[178,]   -3.03416214 10.671086  -24.2443431  18.158431
[179,]   11.03429597 12.402325  -13.7447642  35.918168
[180,]   -5.83714592 14.323556  -34.1066068  22.387141</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.6  3.4
looic      1770.4 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   400       
 (0.5, 0.7]   (ok)         1    0.6%   1481      
   (0.7, 1]   (bad)        1    0.6%   83        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.4 23.3
p_loo        35.5  9.5
looic      1724.8 46.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   858       
 (0.5, 0.7]   (ok)         5    2.8%   335       
   (0.7, 1]   (bad)        1    0.6%   57        
   (1, Inf)   (very bad)   2    1.1%   4         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -22.8      12.4  
fit_sleep1 -90.9      21.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.6  3.4
looic      1770.4 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   400       
 (0.5, 0.7]   (ok)         1    0.6%   1481      
   (0.7, 1]   (bad)        1    0.6%   83        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.4 23.3
p_loo        35.5  9.5
looic      1724.8 46.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   858       
 (0.5, 0.7]   (ok)         5    2.8%   335       
   (0.7, 1]   (bad)        1    0.6%   57        
   (1, Inf)   (very bad)   2    1.1%   4         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.4     23.3        35.5    9.5   1724.8
fit_sleep2  -22.8      12.4  -885.2     14.4        19.6    3.4   1770.4
fit_sleep1  -90.9      21.8  -953.3     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   46.5  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
3.209988e-40 1.265843e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.87      1.53     0.34      5.4       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.13      1.53    -3.15     2.89       5.54      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.5.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.19      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.0   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.19        V8_4.2.2            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.7         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
