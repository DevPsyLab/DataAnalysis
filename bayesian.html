<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.88      6.89    15.43    42.85 1.00     1790     2197
sd(Days)                6.58      1.55     4.11    10.22 1.00     1441     1648
cor(Intercept,Days)     0.08      0.29    -0.46     0.65 1.00     1072     1487

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.28      7.32   236.83   266.04 1.00     1613     2066
Days         10.46      1.76     7.01    14.03 1.00     1269     1528

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.53    23.12    29.18 1.00     3473     2820

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6344  13.07971 227.9299 279.0047
309 211.5917  13.19961 184.5876 236.9645
310 212.8041  13.24315 185.5455 238.7269
330 274.7893  13.64003 249.4458 302.7272
331 273.1067  13.02820 248.4375 298.8835
332 260.7927  12.05643 237.4387 285.1032
333 267.9933  12.67954 244.1119 293.6147
334 243.9077  12.48045 218.7457 267.7729
335 250.8948  13.43236 225.2748 278.3325
337 286.0334  12.97178 260.9586 312.4450
349 226.8490  12.88055 200.9104 251.6990
350 238.8158  12.82378 212.6592 263.6738
351 256.0013  12.39993 232.6063 280.6050
352 272.0850  12.78879 247.7428 298.1065
369 255.0689  12.20041 231.4971 278.8245
370 226.2138  13.74172 198.3756 251.7835
371 251.9419  12.32535 227.5609 276.0298
372 263.7722  12.23270 239.6288 287.8560

, , Days

      Estimate Est.Error         Q2.5     Q97.5
308 19.6543813  2.546353 14.844843544 24.684572
309  1.7557250  2.455554 -3.041868873  6.632318
310  4.9575872  2.511971 -0.001215007  9.972558
330  5.7126433  2.538615  0.651372421 10.577432
331  7.5248562  2.518238  2.448304862 12.586515
332 10.1812777  2.362118  5.467443393 14.860729
333 10.2767645  2.419090  5.587276689 14.961975
334 11.6187816  2.400072  6.943371452 16.535832
335 -0.2753787  2.566830 -5.406106823  4.637024
337 19.1556216  2.447919 14.199256632 23.952110
349 11.5209678  2.447116  6.927040070 16.382338
350 17.0145145  2.448074 12.262896508 21.987515
351  7.4706722  2.343206  2.842155513 11.939948
352 13.9972358  2.399430  9.360756787 18.644105
369 11.2783144  2.321014  6.672205367 15.807885
370 15.1946725  2.588907 10.258410535 20.320610
371  9.5383305  2.366083  4.969265328 14.162054
372 11.7615266  2.345651  7.142312251 16.396576</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6344 13.079710 227.9299 279.0047
  [2,] 273.2888 11.119913 251.3861 295.0056
  [3,] 292.9431  9.444255 274.0760 311.1078
  [4,] 312.5975  8.228198 296.0759 328.5023
  [5,] 332.2519  7.692879 316.8042 347.0545
  [6,] 351.9063  7.976549 336.1883 367.0505
  [7,] 371.5607  9.002118 353.8123 388.8854
  [8,] 391.2150 10.555508 370.2295 411.6461
  [9,] 410.8694 12.440546 386.1142 434.6297
 [10,] 430.5238 14.528711 402.2942 458.1384
 [11,] 211.5917 13.199610 184.5876 236.9645
 [12,] 213.3474 11.350604 190.3160 235.1104
 [13,] 215.1032  9.772524 195.3260 233.8865
 [14,] 216.8589  8.615551 199.5742 233.7758
 [15,] 218.6146  8.063045 202.4898 234.3551
 [16,] 220.3703  8.237546 203.8512 236.4980
 [17,] 222.1261  9.097314 204.0878 240.0650
 [18,] 223.8818 10.474950 203.1635 243.9762
 [19,] 225.6375 12.196209 201.8797 249.0242
 [20,] 227.3932 14.136121 199.8368 254.7491
 [21,] 212.8041 13.243149 185.5455 238.7269
 [22,] 217.7617 11.315314 194.8191 239.8915
 [23,] 222.7193  9.659797 203.2694 241.5121
 [24,] 227.6769  8.438424 211.0387 244.2048
 [25,] 232.6344  7.856356 217.4799 248.0763
 [26,] 237.5920  8.053425 221.9978 253.8141
 [27,] 242.5496  8.978472 225.3423 260.3585
 [28,] 247.5072 10.439745 227.3025 267.9183
 [29,] 252.4648 12.246778 228.4404 276.6317
 [30,] 257.4224 14.268807 229.1405 285.5397
 [31,] 274.7893 13.640027 249.4458 302.7272
 [32,] 280.5019 11.702339 258.6448 304.2300
 [33,] 286.2146 10.036347 267.1347 306.3056
 [34,] 291.9272  8.797779 274.4983 308.9951
 [35,] 297.6399  8.183074 281.4369 313.8312
 [36,] 303.3525  8.331484 286.8826 319.9052
 [37,] 309.0652  9.206176 290.9034 327.4841
 [38,] 314.7778 10.629339 293.7941 335.8957
 [39,] 320.4904 12.413749 296.2377 345.2061
 [40,] 326.2031 14.425970 297.9700 354.5464
 [41,] 273.1067 13.028199 248.4375 298.8835
 [42,] 280.6316 11.118113 259.5046 302.6352
 [43,] 288.1564  9.495998 270.0431 307.1498
 [44,] 295.6813  8.331779 279.4731 312.2923
 [45,] 303.2062  7.832379 287.9122 318.6717
 [46,] 310.7310  8.121380 294.6808 326.8156
 [47,] 318.2559  9.124172 300.1278 336.1157
 [48,] 325.7807 10.640830 304.9929 346.5596
 [49,] 333.3056 12.485474 309.2060 357.2193
 [50,] 340.8304 14.533751 312.5012 368.6358
 [51,] 260.7927 12.056430 237.4387 285.1032
 [52,] 270.9740 10.337299 250.8337 291.7263
 [53,] 281.1552  8.917465 263.9316 298.7807
 [54,] 291.3365  7.958759 275.7680 306.7012
 [55,] 301.5178  7.636864 286.6002 316.3400
 [56,] 311.6991  8.028746 295.7360 327.4163
 [57,] 321.8804  9.042070 303.7470 340.0337
 [58,] 332.0616 10.498405 310.9487 353.1477
 [59,] 342.2429 12.240637 317.6412 366.6463
 [60,] 352.4242 14.163654 324.1068 380.9243
 [61,] 267.9933 12.679539 244.1119 293.6147
 [62,] 278.2701 10.925678 257.7124 300.0832
 [63,] 288.5469  9.469645 270.6868 307.4373
 [64,] 298.8236  8.466515 282.3680 315.8597
 [65,] 309.1004  8.086630 293.1362 325.0448
 [66,] 319.3772  8.414825 302.7527 336.1258
 [67,] 329.6539  9.377045 311.1902 348.0488
 [68,] 339.9307 10.805214 318.2688 361.0583
 [69,] 350.2075 12.541145 325.0093 374.6784
 [70,] 360.4842 14.474529 331.5396 389.1578
 [71,] 243.9077 12.480453 218.7457 267.7729
 [72,] 255.5265 10.687547 234.1447 276.3950
 [73,] 267.1452  9.176400 248.8895 285.1283
 [74,] 278.7640  8.106149 262.8790 294.8940
 [75,] 290.3828  7.663790 275.5951 305.8948
 [76,] 302.0016  7.954772 287.0348 318.3678
 [77,] 313.6204  8.907513 296.5104 331.4896
 [78,] 325.2391 10.340690 304.5335 345.9296
 [79,] 336.8579 12.084562 312.9998 360.6212
 [80,] 348.4767 14.023698 320.7460 376.3155
 [81,] 250.8948 13.432360 225.2748 278.3325
 [82,] 250.6195 11.448465 228.6423 274.1186
 [83,] 250.3441  9.740822 231.1975 270.1369
 [84,] 250.0687  8.478037 233.3882 267.2843
 [85,] 249.7933  7.877045 234.4556 265.3954
 [86,] 249.5180  8.086766 233.3373 265.5362
 [87,] 249.2426  9.051021 231.7313 267.3938
 [88,] 248.9672 10.565197 228.5527 269.9085
 [89,] 248.6918 12.429924 224.3966 273.0005
 [90,] 248.4164 14.510682 219.7913 276.4994
 [91,] 286.0334 12.971777 260.9586 312.4450
 [92,] 305.1890 11.122292 283.6393 327.7060
 [93,] 324.3447  9.546118 305.8950 343.5842
 [94,] 343.5003  8.398570 327.0161 360.1722
 [95,] 362.6559  7.869447 346.8547 377.9492
 [96,] 381.8115  8.081153 365.3975 397.3790
 [97,] 400.9671  8.981452 382.7285 418.0007
 [98,] 420.1228 10.392908 399.2447 439.9825
 [99,] 439.2784 12.138502 414.9466 462.9425
[100,] 458.4340 14.094627 430.3846 486.1518
[101,] 226.8490 12.880546 200.9104 251.6990
[102,] 238.3699 11.047108 216.3472 259.9473
[103,] 249.8909  9.494498 230.8187 268.3379
[104,] 261.4119  8.380283 245.0888 277.6751
[105,] 272.9328  7.892373 257.3780 288.2316
[106,] 284.4538  8.144121 268.2757 300.1898
[107,] 295.9748  9.074174 277.7678 313.6963
[108,] 307.4957 10.503871 286.2639 328.1121
[109,] 319.0167 12.259639 294.3785 342.7596
[110,] 330.5377 14.221214 302.2636 357.8052
[111,] 238.8158 12.823783 212.6592 263.6738
[112,] 255.8303 11.018541 233.1873 277.7124
[113,] 272.8448  9.505431 253.9448 291.9482
[114,] 289.8593  8.443004 272.9620 306.8104
[115,] 306.8738  8.012587 290.9159 322.4064
[116,] 323.8884  8.312936 307.4217 339.7147
[117,] 340.9029  9.273316 322.5520 358.8408
[118,] 357.9174 10.717743 336.2463 379.0672
[119,] 374.9319 12.479253 349.9308 399.8574
[120,] 391.9464 14.442287 363.5689 420.4665
[121,] 256.0013 12.399933 232.6063 280.6050
[122,] 263.4720 10.672781 242.9251 284.9019
[123,] 270.9426  9.221682 253.2435 289.5066
[124,] 278.4133  8.194621 262.4152 294.9740
[125,] 285.8840  7.761793 270.6416 300.9600
[126,] 293.3546  8.019993 278.0525 308.7967
[127,] 300.8253  8.909341 283.3696 318.3746
[128,] 308.2960 10.267116 288.3947 328.2707
[129,] 315.7667 11.934497 292.8959 339.0431
[130,] 323.2373 13.799710 296.3214 350.1170
[131,] 272.0850 12.788791 247.7428 298.1065
[132,] 286.0823 11.036755 264.6560 308.6433
[133,] 300.0795  9.569810 281.3153 319.2997
[134,] 314.0767  8.536222 297.0872 330.9906
[135,] 328.0740  8.103544 312.0953 343.8540
[136,] 342.0712  8.365543 325.8239 358.3146
[137,] 356.0684  9.263461 338.1096 373.7840
[138,] 370.0657 10.637463 349.1393 390.0817
[139,] 384.0629 12.329399 359.9944 407.4699
[140,] 398.0602 14.226280 370.4571 424.9384
[141,] 255.0689 12.200412 231.4971 278.8245
[142,] 266.3472 10.544793 245.9315 287.2271
[143,] 277.6255  9.182019 259.7968 295.8848
[144,] 288.9038  8.258359 272.8957 305.5935
[145,] 300.1822  7.928792 284.5270 316.0166
[146,] 311.4605  8.264695 295.2444 327.5646
[147,] 322.7388  9.193413 304.5515 340.3958
[148,] 334.0171 10.559674 312.6769 354.5976
[149,] 345.2954 12.217561 320.4367 369.3344
[150,] 356.5737 14.064320 328.1664 384.1061
[151,] 226.2138 13.741720 198.3756 251.7835
[152,] 241.4085 11.752500 218.0560 263.7706
[153,] 256.6031 10.040543 236.6300 275.8089
[154,] 271.7978  8.769757 254.3410 288.7300
[155,] 286.9925  8.149212 271.3569 302.9701
[156,] 302.1872  8.325596 285.9993 318.3796
[157,] 317.3818  9.253449 299.1053 335.5292
[158,] 332.5765 10.739738 311.1737 353.5713
[159,] 347.7712 12.588189 322.5956 372.7770
[160,] 362.9658 14.662466 333.8514 391.7940
[161,] 251.9419 12.325349 227.5609 276.0298
[162,] 261.4802 10.582253 240.7629 282.3189
[163,] 271.0185  9.124179 253.3903 288.8567
[164,] 280.5569  8.106411 265.1844 296.1675
[165,] 290.0952  7.705444 275.0008 305.1807
[166,] 299.6335  8.014395 283.9900 315.2985
[167,] 309.1718  8.960128 291.8244 326.4205
[168,] 318.7102 10.369859 298.8293 338.9502
[169,] 328.2485 12.082249 304.8696 351.4878
[170,] 337.7868 13.986573 310.5428 365.1515
[171,] 263.7722 12.232698 239.6288 287.8560
[172,] 275.5337 10.540287 254.4439 296.2298
[173,] 287.2952  9.141147 269.1826 305.2125
[174,] 299.0568  8.187042 282.8326 314.6144
[175,] 310.8183  7.842123 295.4261 325.8673
[176,] 322.5798  8.183783 306.4542 338.5732
[177,] 334.3414  9.135309 316.2502 352.2073
[178,] 346.1029 10.532691 325.4005 366.5271
[179,] 357.8644 12.223971 333.5696 381.9579
[180,] 369.6259 14.103812 341.6940 397.2336</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.0743700 13.079710  -29.44469350  21.6300773
  [2,]  -14.5840513 11.119913  -36.30086535   7.3185729
  [3,]  -42.1425326  9.444255  -60.30718844 -23.2753611
  [4,]    8.8422860  8.228198   -7.06252225  25.3638781
  [5,]   24.6000047  7.692879    9.79741222  40.0477216
  [6,]   62.7838234  7.976549   47.63959834  78.5018207
  [7,]   10.6431420  9.002118   -6.68163672  28.3915496
  [8,] -101.0664393 10.555508 -121.49750989 -80.0809149
  [9,]   19.7158794 12.440546   -4.04443183  44.4711319
 [10,]   35.8296980 14.528711    8.21511265  64.0592996
 [11,]   11.1421956 13.199610  -14.23062758  38.1462702
 [12,]   -8.0816295 11.350604  -29.84462403  14.9497786
 [13,]  -12.1253545  9.772524  -30.90870192   7.6517529
 [14,]  -12.1518795  8.615551  -29.06882263   5.1328372
 [15,]  -10.8985045  8.063045  -26.63899242   5.2262808
 [16,]   -4.4085295  8.237546  -20.53620163  12.1105749
 [17,]   -8.4957545  9.097314  -26.43473735   9.5424849
 [18,]   -6.1545795 10.474950  -26.24898749  14.5636829
 [19,]   -1.3418045 12.196209  -24.72846973  22.4160470
 [20,]    9.9209705 14.136121  -17.43485534  37.4774451
 [21,]  -13.7501887 13.243149  -39.67299489  13.5083503
 [22,]  -23.4294759 11.315314  -45.55932492  -0.4868730
 [23,]   11.6007370  9.659797   -7.19212733  31.0505980
 [24,]    5.1647498  8.438424  -11.36322576  21.8028892
 [25,]   -3.3270374  7.856356  -18.76887353  11.8275021
 [26,]  -17.1341245  8.053425  -33.35618359  -1.5399112
 [27,]   -7.1288117  8.978472  -24.93765506  10.0785430
 [28,]    8.2439011 10.439745  -12.16715996  28.4486310
 [29,]    8.5477139 12.246778  -15.61924327  32.5721033
 [30,]   -9.9070732 14.268807  -38.02444186  18.3747636
 [31,]   46.7533053 13.640027   18.81543472  72.0967956
 [32,]   19.8982619 11.702339   -3.82975296  41.7554384
 [33,]   -2.3580814 10.036347  -22.44910568  16.7218109
 [34,]   -6.7942248  8.797779  -23.86208358  10.6347042
 [35,]  -11.8425681  8.183074  -28.03393995   4.3604044
 [36,]   -5.7670115  8.331484  -22.31972598  10.7028525
 [37,]  -28.8255548  9.206176  -47.24451770 -10.6638279
 [38,]    3.4835018 10.629339  -17.63443765  24.4672488
 [39,]  -15.1409415 12.413749  -39.85662547   9.1117553
 [40,]   27.8456151 14.425970   -0.49766604  56.0786574
 [41,]   14.5011726 13.028199  -11.27556645  39.1704256
 [42,]    4.3684163 11.118113  -17.63524853  25.4953793
 [43,]   13.6641601  9.495998   -5.32915336  31.7775441
 [44,]   24.4340039  8.331779    7.82301460  40.6421639
 [45,]   13.0711477  7.832379   -2.39444547  28.3650534
 [46,]  -17.4123085  8.121380  -33.49687864  -1.3620559
 [47,]  -28.1808647  9.124172  -46.04073524 -10.0528233
 [48,]    9.0369790 10.640830  -11.74193906  29.8248049
 [49,]  -39.5586772 12.485474  -63.47239177 -15.4590900
 [50,]   30.7506666 14.533751    2.94525594  59.0798638
 [51,]  -25.9320847 12.056430  -50.24259411  -2.5781357
 [52,]  -28.1621624 10.337299  -48.91453659  -8.0219447
 [53,]   -8.1939402  8.917465  -25.81941143   9.0296791
 [54,]   18.4322821  7.958759    3.06757114  34.0008467
 [55,]   15.9451043  7.636864    1.12289728  30.8626583
 [56,]   -1.7014734  8.028746  -17.41871539  14.2616293
 [57,]  132.2815489  9.042070  114.12817226 150.4148549
 [58,]   14.7694711 10.498405   -6.31659577  35.8823699
 [59,]  -11.9426066 12.240637  -36.34599874  12.6591233
 [60,]  -98.5597844 14.163654 -127.05986143 -70.2423826
 [61,]   15.8490547 12.679539   -9.77228382  39.7304555
 [62,]   11.2848902 10.925678  -10.52822420  31.8425709
 [63,]  -11.7775743  9.469645  -30.66796362   6.0824547
 [64,]    0.9860613  8.466515  -16.05004585  17.4417142
 [65,]  -11.9294032  8.086630  -27.87380681   4.0347873
 [66,]   18.7893323  8.414825    2.04066423  35.4137550
 [67,]    2.3725678  9.377045  -16.02225866  20.8362898
 [68,]    8.9092034 10.805214  -12.21841951  30.5710501
 [69,]  -16.8474611 12.541145  -41.31839470   8.3507035
 [70,]    1.5585744 14.474529  -27.11495639  30.5031681
 [71,]   21.5654217 12.480453   -2.29977355  46.7273862
 [72,]   20.6747401 10.687547   -0.19384671  42.0565277
 [73,]  -23.7805415  9.176400  -41.76355118  -5.5248325
 [74,]  -24.0917231  8.106149  -40.22167874  -8.2067312
 [75,]  -11.3584047  7.663790  -26.87044755   3.4293125
 [76,]  -17.8103863  7.954772  -34.17660710  -2.8435537
 [77,]   -8.0955679  8.907513  -25.96478362   9.0144469
 [78,]    6.2837505 10.340690  -14.40669623  26.9893967
 [79,]   -1.1110311 12.084562  -24.87427206  22.7471042
 [80,]   28.8222873 14.023698    0.98352950  56.5529838
 [81,]   -9.2865442 13.432360  -36.72422544  16.3334603
 [82,]   23.3277345 11.448465   -0.17140100  45.3048934
 [83,]    4.1466132  9.740822  -15.64618512  23.2931754
 [84,]   20.7333918  8.478037    3.51779494  37.4138674
 [85,]    1.6585705  7.877045  -13.94353195  16.9962539
 [86,]    5.1182491  8.086766  -10.89999012  21.2988656
 [87,]   -3.7902722  9.051021  -21.94146986  13.7209950
 [88,]  -13.6561936 10.565197  -34.59745512   6.7583232
 [89,]  -12.9377149 12.429924  -37.24636898  11.3575219
 [90,]  -11.1698362 14.510682  -39.25277493  17.4553065
 [91,]   26.3331802 12.971777   -0.07840242  51.4080098
 [92,]    8.6167587 11.122292  -13.90016102  30.1665124
 [93,]  -32.7334629  9.546118  -51.97301284 -14.2838362
 [94,]    2.6219155  8.398570  -14.04995539  19.1061275
 [95,]    3.0764939  7.869447  -12.21678464  18.8777112
 [96,]   10.0269724  8.081153   -5.54048189  26.4409940
 [97,]    3.2929508  8.981452  -13.74064411  21.5315575
 [98,]   -3.4304708 10.392908  -23.29016000  17.4475914
 [99,]   16.5859076 12.138502   -7.07820736  40.9176962
[100,]    0.4826861 14.094627  -27.23514356  28.5321219
[101,]    9.2542331 12.880546  -15.59579652  35.1927968
[102,]   -8.0532347 11.047108  -29.63064981  13.9695261
[103,]  -10.9653026  9.494498  -29.41232063   8.1068688
[104,]   -6.4898704  8.380283  -22.75308223   9.8332400
[105,]  -22.2225383  7.892373  -37.52128113  -6.6677255
[106,]  -14.6794061  8.144121  -30.41541470   1.4986514
[107,]  -14.4099740  9.074174  -32.13151590   3.7970354
[108,]    0.6062582 10.503871  -20.01011970  21.8380609
[109,]   17.2638903 12.259639   -6.47898995  41.9020641
[110,]   21.1074225 14.221214   -6.16006875  49.3815287
[111,]   17.4810128 12.823783   -7.37703159  43.6375949
[112,]  -12.3760017 11.018541  -34.25812090  10.2669912
[113,]  -16.6402161  9.505431  -35.74363996   2.2598156
[114,]  -34.3322306  8.443004  -51.28325273 -17.4349434
[115,]  -37.9573450  8.012587  -53.48994994 -21.9994016
[116,]    5.8363405  8.312936   -9.99004366  22.3030288
[117,]   38.5416261  9.273316   20.60368440  56.8925349
[118,]    5.0010116 10.717743  -16.14876730  26.6721430
[119,]   19.5552971 12.479253   -5.37023831  44.5564362
[120,]   -2.8937173 14.442287  -31.41383446  25.4838193
[121,]   -5.4747852 12.399933  -30.07851303  17.9201938
[122,]   36.5856426 10.672781   15.15574600  57.1325372
[123,]   -1.0487297  9.221682  -19.61269263  16.6503795
[124,]    2.1757981  8.194621  -14.38486629  18.1739267
[125,]  -14.0565741  7.761793  -29.13261497   1.1857846
[126,]   11.2789537  8.019993   -4.16310682  26.5811115
[127,]  -13.0787185  8.909341  -30.62803068   4.3770138
[128,]  -41.7004907 10.267116  -61.67522975 -21.7991940
[129,]    5.7751371 11.934497  -17.50126835  28.6459123
[130,]   24.3281649 13.799710   -2.55148932  51.2440846
[131,]  -50.4079311 12.788791  -76.42936208 -26.0656814
[132,]   12.1116331 11.036755  -10.44938288  33.5378682
[133,]   26.7989973  9.569810    7.57882414  45.5631537
[134,]   32.7787615  8.536222   15.86487987  49.7683453
[135,]   20.6662257  8.103544    4.88619105  36.6448837
[136,]   10.7574900  8.365543   -5.48593496  27.0047604
[137,]   -1.6418458  9.263461  -19.35742145  16.3170053
[138,]   -9.6330816 10.637463  -29.64905723  11.2932671
[139,]   -8.4223174 12.329399  -31.82932925  15.6462236
[140,]   -9.5184532 14.226280  -36.39672143  18.0845617
[141,]   16.8546043 12.200412   -6.90104692  40.4263532
[142,]    2.0896899 10.544793  -18.79019708  22.5054114
[143,]  -20.3831245  9.182019  -38.64238290  -2.5544299
[144,]  -11.2472389  8.258359  -27.93691278   4.7608884
[145,]   14.6400467  7.928792   -1.19441008  30.2952022
[146,]    5.7530322  8.264695  -10.35105632  21.9691407
[147,]  -24.6034822  9.193413  -42.26051146  -6.4161542
[148,]   14.1058034 10.559674   -6.47465521  35.4459773
[149,]   -5.0154110 12.217561  -29.05440749  19.8433217
[150,]    9.9393745 14.064320  -17.59303639  38.3467327
[151,]   -0.9497932 13.741720  -26.51947582  26.8884157
[152,]   -6.8849657 11.752500  -29.24714575  16.4675240
[153,]  -17.7023383 10.040543  -36.90812985   2.2708267
[154,]  -31.3248108  8.769757  -48.25695071 -13.8679789
[155,]  -19.4551834  8.149212  -35.43279437  -3.8196437
[156,]   42.0065441  8.325596   25.81405618  58.1943901
[157,]  -36.2337285  9.253449  -54.38108941 -17.9571843
[158,]   15.0089990 10.739738   -5.98582272  36.4117926
[159,]   17.3918265 12.588189   -7.61401012  42.5674125
[160,]    9.2629539 14.662466  -19.56523473  38.3774070
[161,]   17.9385407 12.325349   -6.14937543  42.3195406
[162,]   10.9626103 10.582253   -9.87614845  31.6798735
[163,]    6.8803798  9.124179  -10.95783314  24.5086318
[164,]    1.2326493  8.106411  -14.37800197  16.6050711
[165,]  -10.9246812  7.705444  -26.01016658   4.1696807
[166,]  -15.1215116  8.014395  -30.78652605   0.5220119
[167,]  -49.9060421  8.960128  -67.15469745 -32.5586026
[168,]  -14.0795726 10.369859  -34.31955977   5.8012721
[169,]   22.5321970 12.082249   -0.70707997  45.9110809
[170,]   31.6823665 13.986573    4.31770757  58.9264319
[171,]    5.6395098 12.232698  -18.44426717  29.7829212
[172,]   -2.0597168 10.540287  -22.75577236  19.0300827
[173,]   10.3015565  9.141147   -7.61567194  28.4142018
[174,]   11.5748299  8.187042   -3.98276590  27.7990048
[175,]  -23.6456968  7.842123  -38.69467793  -8.2535397
[176,]    7.0277766  8.183783   -8.96557414  23.1534362
[177,]    0.1404499  9.135309  -17.72546954  18.2316316
[178,]   -2.8829767 10.532691  -23.30724434  17.8194226
[179,]   11.2772967 12.223971  -12.81619258  35.5720605
[180,]   -5.5023300 14.103812  -33.10997495  22.4296406</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.7  3.4
looic      1770.5 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1264      
 (0.5, 0.7]   (ok)         3    1.7%   177       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.4
p_loo        34.1  8.5
looic      1722.1 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   1007      
 (0.5, 0.7]   (ok)         4    2.2%   272       
   (0.7, 1]   (bad)        2    1.1%   34        
   (1, Inf)   (very bad)   1    0.6%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.2      11.6  
fit_sleep1 -92.4      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.7  3.4
looic      1770.5 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1264      
 (0.5, 0.7]   (ok)         3    1.7%   177       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.4
p_loo        34.1  8.5
looic      1722.1 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   1007      
 (0.5, 0.7]   (ok)         4    2.2%   272       
   (0.7, 1]   (bad)        2    1.1%   34        
   (1, Inf)   (very bad)   1    0.6%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.0     22.4        34.1    8.5   1722.1
fit_sleep2  -24.2      11.6  -885.2     14.4        19.7    3.4   1770.5
fit_sleep1  -92.4      21.0  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   44.8  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
7.541933e-41 3.125021e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88      1.55     0.28     5.42       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12      1.55    -3.28      2.9       5.27      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.1-0     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_5.0.0           compiler_4.2.2      
 [22] cli_3.6.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.5          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.20      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.1   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.4          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.12       yaml_2.3.7          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.42           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.20        V8_4.2.2            
 [88] RcppParallel_5.1.6   vctrs_0.5.2          nloptr_2.0.3        
 [91] httpuv_1.6.8         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
