<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing
adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.99      6.83    15.70    42.26 1.00     1762     2233
sd(Days)                6.63      1.52     4.20    10.08 1.00     1466     1999
cor(Intercept,Days)     0.07      0.30    -0.49     0.68 1.00     1023     1450

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   250.83      7.42   236.48   265.50 1.00     1653     2475
Days         10.42      1.75     6.83    13.86 1.00     1262     1647

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.57    23.06    29.15 1.00     3345     2892

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6237  12.98438 228.2894 279.0160
309 211.5866  13.31557 185.4113 237.3852
310 212.7493  13.64434 185.6387 238.9416
330 274.4972  13.47510 249.4511 301.5007
331 273.2765  13.21798 248.7523 300.0779
332 259.8917  12.30085 236.3674 284.5804
333 267.7297  12.62976 243.6695 292.2787
334 244.2902  12.36979 220.1068 268.5973
335 251.2414  13.39356 225.7888 277.9166
337 285.8741  12.86781 261.0943 311.3431
349 226.5759  13.01304 199.8917 251.8698
350 238.2853  13.02161 212.4438 263.0582
351 255.9745  12.28099 232.7388 280.7873
352 271.8411  12.34867 247.7658 295.9092
369 254.4743  12.36810 230.1017 278.7918
370 226.2555  13.65480 198.8871 252.0020
371 252.5794  12.19543 228.6066 276.2876
372 263.5621  11.96233 240.1168 287.1775

, , Days

      Estimate Est.Error         Q2.5     Q97.5
308 19.6948017  2.475594 14.775096742 24.548847
309  1.7204683  2.530305 -3.152054292  6.609718
310  4.9227747  2.532012  0.006224881 10.017705
330  5.7655998  2.557642  0.656170249 10.671467
331  7.4987403  2.478146  2.539283044 12.170501
332 10.2692957  2.329654  5.465845192 14.832205
333 10.2856488  2.406394  5.459446971 14.911253
334 11.5226402  2.365006  6.764356500 16.284069
335 -0.3311052  2.596098 -5.517885917  4.600562
337 19.2115712  2.463953 14.323356306 24.076564
349 11.6106775  2.452508  6.806757779 16.422854
350 17.1036555  2.477031 12.345638155 21.965686
351  7.4682612  2.349910  2.825078997 11.990784
352 14.0816057  2.371051  9.339776320 18.606476
369 11.3286198  2.389015  6.567069995 16.214105
370 15.2143703  2.546873 10.198129081 20.198004
371  9.4345713  2.287062  5.007959538 13.994095
372 11.7611257  2.308492  7.222892988 16.211144</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6237 12.984383 228.2894 279.0160
  [2,] 273.3185 11.125261 251.0880 294.6732
  [3,] 293.0133  9.550174 273.6462 311.8595
  [4,] 312.7081  8.420054 296.2584 329.3914
  [5,] 332.4029  7.927543 317.2296 348.0127
  [6,] 352.0977  8.188510 336.3995 368.5363
  [7,] 371.7925  9.138631 353.9291 389.5270
  [8,] 391.4873 10.594082 370.5200 411.8746
  [9,] 411.1821 12.377872 386.9261 435.2009
 [10,] 430.8769 14.368228 402.7405 458.7045
 [11,] 211.5866 13.315567 185.4113 237.3852
 [12,] 213.3071 11.376131 190.9184 235.2193
 [13,] 215.0276  9.712532 195.8333 234.1182
 [14,] 216.7480  8.488526 199.9477 233.4512
 [15,] 218.4685  7.910863 202.9331 234.2742
 [16,] 220.1890  8.118702 204.3819 236.4512
 [17,] 221.9094  9.058134 204.4483 239.8573
 [18,] 223.6299 10.535233 203.3708 244.4129
 [19,] 225.3504 12.358696 201.5727 249.6995
 [20,] 227.0708 14.397516 199.2690 255.3613
 [21,] 212.7493 13.644344 185.6387 238.9416
 [22,] 217.6721 11.691382 194.0825 240.0290
 [23,] 222.5949 10.001545 202.7158 241.8421
 [24,] 227.5176  8.729005 210.3219 244.6386
 [25,] 232.4404  8.073558 216.4356 248.2743
 [26,] 237.3632  8.184821 221.7835 254.1247
 [27,] 242.2860  9.034513 225.2218 260.2900
 [28,] 247.2087 10.443933 227.1528 267.5467
 [29,] 252.1315 12.220933 228.5294 275.9432
 [30,] 257.0543 14.228451 229.2208 285.1939
 [31,] 274.4972 13.475102 249.4511 301.5007
 [32,] 280.2628 11.496335 258.4144 303.4707
 [33,] 286.0284  9.789593 267.3122 305.9391
 [34,] 291.7940  8.519953 275.2732 308.6308
 [35,] 297.5596  7.901021 281.9581 312.9278
 [36,] 303.3252  8.083671 287.2482 318.8546
 [37,] 309.0908  9.019335 291.0244 326.2823
 [38,] 314.8564 10.508765 294.0492 334.6883
 [39,] 320.6220 12.353256 296.7196 344.0625
 [40,] 326.3876 14.417170 298.5573 354.3927
 [41,] 273.2765 13.217983 248.7523 300.0779
 [42,] 280.7753 11.318764 259.4919 303.3461
 [43,] 288.2740  9.684842 269.7276 307.7879
 [44,] 295.7728  8.471148 279.3060 312.5683
 [45,] 303.2715  7.874448 287.5865 318.7240
 [46,] 310.7702  8.033427 294.9933 326.3720
 [47,] 318.2690  8.907715 300.7550 335.8711
 [48,] 325.7677 10.317036 305.8744 346.2568
 [49,] 333.2665 12.075492 309.7884 357.0694
 [50,] 340.7652 14.052622 313.2013 368.5364
 [51,] 259.8917 12.300854 236.3674 284.5804
 [52,] 270.1610 10.574727 249.8845 291.0787
 [53,] 280.4303  9.121033 262.9419 298.6137
 [54,] 290.6996  8.088030 274.9241 306.6346
 [55,] 300.9689  7.648123 286.2507 315.9059
 [56,] 311.2382  7.901007 296.0442 326.8174
 [57,] 321.5074  8.787072 304.4513 338.3791
 [58,] 331.7767 10.141692 311.7905 351.4636
 [59,] 342.0460 11.804652 318.2738 364.9980
 [60,] 352.3153 13.663830 324.6881 378.6865
 [61,] 267.7297 12.629763 243.6695 292.2787
 [62,] 278.0154 10.857900 257.3047 299.5490
 [63,] 288.3010  9.373287 270.1459 306.5074
 [64,] 298.5867  8.330936 281.8279 314.4716
 [65,] 308.8723  7.907714 292.5241 324.1284
 [66,] 319.1580  8.200052 302.2354 334.9983
 [67,] 329.4436  9.139542 310.5317 347.7602
 [68,] 339.7293 10.554765 318.0077 360.5976
 [69,] 350.0149 12.282360 325.0282 374.4088
 [70,] 360.3006 14.208840 331.9350 388.1754
 [71,] 244.2902 12.369788 220.1068 268.5973
 [72,] 255.8129 10.645271 234.8548 276.5654
 [73,] 267.3355  9.209693 249.2112 285.0312
 [74,] 278.8582  8.215936 262.6866 294.5192
 [75,] 290.3808  7.833981 274.9331 305.4166
 [76,] 301.9034  8.150303 285.9037 317.7161
 [77,] 313.4261  9.092310 295.5719 331.3661
 [78,] 324.9487 10.492821 303.9159 346.0143
 [79,] 336.4714 12.194875 311.6935 360.8806
 [80,] 347.9940 14.089612 319.4382 376.4998
 [81,] 251.2414 13.393556 225.7888 277.9166
 [82,] 250.9103 11.401443 229.1483 273.6940
 [83,] 250.5791  9.699376 232.1147 269.9259
 [84,] 250.2480  8.464180 233.4380 267.2033
 [85,] 249.9169  7.917464 233.9143 265.5659
 [86,] 249.5858  8.198145 232.8105 265.3925
 [87,] 249.2547  9.231056 231.0951 267.0444
 [88,] 248.9236 10.802529 227.9560 270.1943
 [89,] 248.5925 12.714414 223.7744 273.4740
 [90,] 248.2614 14.835683 219.1491 277.4007
 [91,] 285.8741 12.867807 261.0943 311.3431
 [92,] 305.0857 11.025369 283.9368 326.8121
 [93,] 324.2973  9.469910 306.1062 342.5437
 [94,] 343.5088  8.363118 327.3404 359.7111
 [95,] 362.7204  7.895975 347.1817 378.1201
 [96,] 381.9320  8.178828 365.6359 398.2533
 [97,] 401.1436  9.142327 382.9588 419.5684
 [98,] 420.3551 10.602509 399.1826 441.6925
 [99,] 439.5667 12.384925 415.0338 463.7729
[100,] 458.7783 14.370166 430.6788 487.0956
[101,] 226.5759 13.013035 199.8917 251.8698
[102,] 238.1866 11.176266 215.5046 259.8131
[103,] 249.7972  9.618126 230.5495 268.5480
[104,] 261.4079  8.493372 244.4541 277.8110
[105,] 273.0186  7.987238 257.1395 288.7440
[106,] 284.6293  8.214874 268.3260 300.8602
[107,] 296.2400  9.121510 278.2223 314.2298
[108,] 307.8506 10.533248 287.3547 328.6668
[109,] 319.4613 12.277063 295.4675 343.4731
[110,] 331.0720 14.231403 303.7512 359.1177
[111,] 238.2853 13.021615 212.4438 263.0582
[112,] 255.3889 11.132433 233.2956 276.6892
[113,] 272.4926  9.516881 253.6917 290.7661
[114,] 289.5962  8.335609 273.0983 305.7583
[115,] 306.6999  7.788779 291.3094 321.9717
[116,] 323.8035  8.007444 307.7552 339.7338
[117,] 340.9072  8.935580 323.0767 358.7550
[118,] 358.0109 10.384671 337.1606 378.8163
[119,] 375.1145 12.170028 350.2608 399.5121
[120,] 392.2182 14.165067 363.9517 420.6350
[121,] 255.9745 12.280985 232.7388 280.7873
[122,] 263.4428 10.608615 243.3015 284.7920
[123,] 270.9110  9.236177 253.1955 289.1876
[124,] 278.3793  8.313566 262.1522 294.6138
[125,] 285.8476  7.997996 270.1738 301.6520
[126,] 293.3158  8.358509 276.9421 309.9325
[127,] 300.7841  9.316949 282.0050 319.2889
[128,] 308.2523 10.714036 286.5554 329.3106
[129,] 315.7206 12.402409 290.6570 340.0476
[130,] 323.1889 14.279114 294.3748 351.2840
[131,] 271.8411 12.348673 247.7658 295.9092
[132,] 285.9227 10.594937 265.2408 306.7681
[133,] 300.0043  9.124660 282.2073 317.4430
[134,] 314.0859  8.093820 298.3064 329.5034
[135,] 328.1675  7.681417 312.9914 342.8115
[136,] 342.2491  7.983871 326.2114 357.5592
[137,] 356.3307  8.928828 338.6179 373.8390
[138,] 370.4123 10.341640 349.8989 390.8315
[139,] 384.4939 12.058972 360.9418 408.1466
[140,] 398.5755 13.968961 371.1233 425.8451
[141,] 254.4743 12.368099 230.1017 278.7918
[142,] 265.8029 10.612301 244.9929 287.0679
[143,] 277.1316  9.148047 259.2351 295.3916
[144,] 288.4602  8.134335 272.8548 304.6258
[145,] 299.7888  7.750021 284.6083 314.8855
[146,] 311.1174  8.085360 295.3521 326.8147
[147,] 322.4460  9.060797 304.4902 340.0155
[148,] 333.7747 10.499421 312.9422 354.0254
[149,] 345.1033 12.238971 321.0179 368.8809
[150,] 356.4319 14.169043 328.5275 384.0125
[151,] 226.2555 13.654797 198.8871 252.0020
[152,] 241.4699 11.716787 217.6475 263.5881
[153,] 256.6842 10.054146 236.2508 275.4906
[154,] 271.8986  8.823929 254.4973 288.7837
[155,] 287.1130  8.222573 271.1002 303.3420
[156,] 302.3274  8.386467 286.3868 319.0457
[157,] 317.5417  9.275132 299.4885 335.5988
[158,] 332.7561 10.709643 311.7268 353.7202
[159,] 347.9705 12.503517 323.6034 372.4623
[160,] 363.1848 14.524206 335.1239 391.6548
[161,] 252.5794 12.195432 228.6066 276.2876
[162,] 262.0139 10.539629 241.3814 282.5520
[163,] 271.4485  9.159710 253.2953 288.7763
[164,] 280.8831  8.196226 264.8817 296.5198
[165,] 290.3177  7.804950 275.2330 305.4441
[166,] 299.7522  8.069552 283.8770 315.3085
[167,] 309.1868  8.931932 291.9274 326.3166
[168,] 318.6214 10.242189 299.1034 338.6318
[169,] 328.0559 11.852712 305.5332 351.2308
[170,] 337.4905 13.657687 311.5686 364.0886
[171,] 263.5621 11.962327 240.1168 287.1775
[172,] 275.3232 10.312386 255.3295 295.4342
[173,] 287.0844  8.958326 269.8134 304.7888
[174,] 298.8455  8.050850 283.0436 314.9964
[175,] 310.6066  7.748486 295.2421 326.4395
[176,] 322.3677  8.119124 306.0903 338.6371
[177,] 334.1289  9.080725 316.4458 352.1889
[178,] 345.8900 10.471736 325.4566 366.9281
[179,] 357.6511 12.145501 333.9438 381.9998
[180,] 369.4122 14.000979 341.7868 397.0475</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.0636560 12.984383  -29.4560247  21.2706266
  [2,]  -14.6137577 11.125261  -35.9684901   7.6166990
  [3,]  -42.2126595  9.550174  -61.0589500 -22.8455813
  [4,]    8.7317388  8.420054   -7.9516047  25.1814067
  [5,]   24.4490371  7.927543    8.8391837  39.6223361
  [6,]   62.5924353  8.188510   46.1537891  78.2906145
  [7,]   10.4113336  9.138631   -7.3231601  28.2747033
  [8,] -101.3386681 10.594082 -121.7260089 -80.3713732
  [9,]   19.4032301 12.377872   -4.6156408  43.6591900
 [10,]   35.4766284 14.368228    7.6489932  63.6130067
 [11,]   11.1472684 13.315567  -14.6512607  37.3225918
 [12,]   -8.0412999 11.376131  -29.9535339  14.3474132
 [13,]  -12.0497681  9.712532  -31.1404088   7.1444527
 [14,]  -12.0410364  8.488526  -28.7441601   4.7593462
 [15,]  -10.7524046  7.910863  -26.5581300   4.7829753
 [16,]   -4.2271729  8.118702  -20.4894054  11.5799158
 [17,]   -8.2791411  9.058134  -26.2270223   9.1819514
 [18,]   -5.9027094 10.535233  -26.6857025  14.3564215
 [19,]   -1.0546776 12.358696  -25.4037950  22.7229907
 [20,]   10.2433541 14.397516  -18.0470991  38.0451656
 [21,]  -13.6954048 13.644344  -39.8876507  13.4152114
 [22,]  -23.3398795 11.691382  -45.6968400   0.2496824
 [23,]   11.7251459 10.001545   -7.5220943  31.6042088
 [24,]    5.3239712  8.729005  -11.7970248  22.5197291
 [25,]   -3.1330035  8.073558  -18.9668799  12.8717656
 [26,]  -16.9052781  8.184821  -33.6667968  -1.3256221
 [27,]   -6.8651528  9.034513  -24.8691938  10.1990303
 [28,]    8.5423726 10.443933  -11.7956061  28.5982600
 [29,]    8.8809979 12.220933  -14.9307397  32.4830676
 [30,]   -9.5389768 14.228451  -37.6785708  18.2945106
 [31,]   47.0454009 13.475102   20.0418847  72.0915022
 [32,]   20.1374011 11.496335   -3.0704865  41.9857680
 [33,]   -2.1718986  9.789593  -22.0826426  16.5443293
 [34,]   -6.6609984  8.519953  -23.4978382   9.8597673
 [35,]  -11.7622982  7.901021  -27.1305217   3.8391578
 [36,]   -5.7396980  8.083671  -21.2691362  10.3372638
 [37,]  -28.8511978  9.019335  -46.0426994 -10.7847991
 [38,]    3.4049024 10.508765  -16.4270074  24.2121037
 [39,]  -15.2724974 12.353256  -38.7130011   8.6299067
 [40,]   27.6611028 14.417170   -0.3439824  55.4913960
 [41,]   14.3313559 13.217983  -12.4699633  38.8556452
 [42,]    4.2247155 11.318764  -18.3460996  25.5081381
 [43,]   13.5465752  9.684842   -5.9672943  32.0929831
 [44,]   24.3425348  8.471148    7.5469980  40.8093041
 [45,]   13.0057945  7.874448   -2.4466988  28.6908401
 [46,]  -17.4515459  8.033427  -33.0533289  -1.6745652
 [47,]  -28.1939862  8.907715  -45.7961144 -10.6799569
 [48,]    9.0499734 10.317036  -11.4390915  28.9433237
 [49,]  -39.5195669 12.075492  -63.3225363 -16.0415026
 [50,]   30.8158927 14.052622    3.0447377  58.3797563
 [51,]  -25.0310714 12.300854  -49.7197601  -1.5067867
 [52,]  -27.3491672 10.574727  -48.2668527  -7.0726954
 [53,]   -7.4689629  9.121033  -25.6524244  10.0194236
 [54,]   19.0692414  8.088030    3.1342353  34.8446995
 [55,]   16.4940456  7.648123    1.5569867  31.2121903
 [56,]   -1.2405501  7.901007  -16.8198157  13.9533605
 [57,]  132.6544541  8.787072  115.7827715 149.7105985
 [58,]   15.0543584 10.141692   -4.6325101  35.0405506
 [59,]  -11.7457374 11.804652  -34.6976787  12.0264665
 [60,]  -98.4509331 13.663830 -124.8220919 -70.8237024
 [61,]   16.1126680 12.629763   -8.4363215  40.1729173
 [62,]   11.5396192 10.857900   -9.9940101  32.2503267
 [63,]  -11.5317297  9.373287  -29.7381371   6.6234496
 [64,]    1.2230215  8.330936  -14.6619236  17.9818055
 [65,]  -11.7013273  7.907714  -26.9574026   4.6469171
 [66,]   19.0085239  8.200052    3.1682438  35.9310750
 [67,]    2.5828751  9.139542  -15.7337003  21.4948087
 [68,]    9.1106263 10.554765  -11.7577094  30.8322194
 [69,]  -16.6549225 12.282360  -41.0487685   8.3317884
 [70,]    1.7422286 14.208840  -26.1325958  30.1077971
 [71,]   21.1828556 12.369788   -3.1242275  45.3662531
 [72,]   20.3883154 10.645271   -0.3642008  41.3463857
 [73,]  -23.9708249  9.209693  -41.6665391  -5.8464741
 [74,]  -24.1858651  8.215936  -39.8468911  -8.0143225
 [75,]  -11.3564053  7.833981  -26.3922062   4.0912606
 [76,]  -17.7122455  8.150303  -33.5248743  -1.7125438
 [77,]   -7.9012858  9.092310  -25.8412779   9.9529202
 [78,]    6.5741740 10.492821  -14.4913922  27.6070494
 [79,]   -0.7244662 12.194875  -25.1336601  24.0533686
 [80,]   29.3049935 14.089612    0.7992451  57.8607533
 [81,]   -9.6330583 13.393556  -36.3082591  15.8194576
 [82,]   23.0369469 11.401443    0.2532244  44.7989174
 [83,]    3.9115521  9.699376  -15.4352226  22.3760314
 [84,]   20.5540573  8.464180    3.5987890  37.3641331
 [85,]    1.5349626  7.917464  -14.1140102  17.5375843
 [86,]    5.0503678  8.198145  -10.7562930  21.8256984
 [87,]   -3.8024270  9.231056  -21.5920769  14.3572198
 [88,]  -13.6126218 10.802529  -34.8833300   7.3549837
 [89,]  -12.8384166 12.714414  -37.7198654  11.9797189
 [90,]  -11.0148114 14.835683  -40.1540819  18.0974833
 [91,]   26.4924715 12.867807    1.0234771  51.2723453
 [92,]    8.7201003 11.025369  -13.0062749  29.8690038
 [93,]  -32.6860709  9.469910  -50.9325054 -14.4950006
 [94,]    2.6133580  8.363118  -13.5889491  18.7817723
 [95,]    3.0119868  7.895975  -12.3876856  18.5506911
 [96,]    9.9065156  8.178828   -6.4148033  26.2026432
 [97,]    3.1165444  9.142327  -15.3083077  21.3013448
 [98,]   -3.6628267 10.602509  -25.0002200  17.5097177
 [99,]   16.2976021 12.384925   -7.9086106  40.8305005
[100,]    0.1384309 14.370166  -28.1789478  28.2379230
[101,]    9.5273081 13.013035  -15.7665650  36.2114977
[102,]   -7.8698693 11.176266  -29.4963624  14.8120994
[103,]  -10.8716468  9.618126  -29.6224074   8.3761468
[104,]   -6.4859243  8.493372  -22.8889572  10.4678732
[105,]  -22.3083017  7.987238  -38.0337390  -6.4291779
[106,]  -14.8548792  8.214874  -31.0857909   1.4483875
[107,]  -14.6751566  9.121510  -32.6649760   3.3425244
[108,]    0.2513659 10.533248  -20.5647807  20.7472621
[109,]   16.8192885 12.277063   -7.1924629  40.8131363
[110,]   20.5731110 14.231403   -7.4726319  47.8938721
[111,]   18.0115314 13.021615   -6.7613970  43.8529730
[112,]  -11.9346241 11.132433  -33.2349324  10.1586675
[113,]  -16.2879796  9.516881  -34.5614646   2.5128845
[114,]  -34.0691352  8.335609  -50.2311791 -17.5712021
[115,]  -37.7833907  7.788779  -53.0552435 -22.3928531
[116,]    5.9211538  8.007444  -10.0091084  21.9695329
[117,]   38.5372982  8.935580   20.6895252  56.3678405
[118,]    4.9075427 10.384671  -15.8979184  25.7578283
[119,]   19.3726872 12.170028   -5.0248523  44.2263559
[120,]   -3.1654683 14.165067  -31.5823100  25.1009875
[121,]   -5.4480103 12.280985  -30.2607554  17.7877024
[122,]   36.6148284 10.608615   15.2656253  56.7560638
[123,]   -1.0171328  9.236177  -19.2936619  16.6983770
[124,]    2.2098060  8.313566  -14.0246879  18.4368921
[125,]  -14.0201553  7.997996  -29.8245504   1.6535771
[126,]   11.3177835  8.358509   -5.2989314  27.6915192
[127,]  -13.0374777  9.316949  -31.5422853   5.7416094
[128,]  -41.6568389 10.714036  -62.7150654 -19.9598998
[129,]    5.8211998 12.402409  -18.5057571  30.8847531
[130,]   24.3766386 14.279114   -3.7184535  53.1907268
[131,]  -50.1639596 12.348673  -74.2320537 -26.0886662
[132,]   12.2712348 10.594937   -8.5741892  32.9530859
[133,]   26.8742291  9.124660    9.4354777  44.6711891
[134,]   32.7696235  8.093820   17.3521393  48.5491310
[135,]   20.5727178  7.681417    5.9287439  35.7488127
[136,]   10.5796122  7.983871   -4.7305274  26.6173183
[137,]   -1.9040935  8.928828  -19.4123548  15.8087007
[138,]   -9.9796992 10.341640  -30.3988963  10.5336623
[139,]   -8.8533048 12.058972  -32.5060167  14.6987722
[140,]  -10.0338105 13.968961  -37.3033750  17.4183902
[141,]   17.4491752 12.368099   -6.8682831  41.8217517
[142,]    2.6339555 10.612301  -18.6309510  23.4440104
[143,]  -19.8891643  9.148047  -38.1492169  -1.9927111
[144,]  -10.8035840  8.134335  -26.9692432   4.8017897
[145,]   15.0333962  7.750021   -0.0632874  30.2139200
[146,]    6.0960764  8.085360   -9.6012421  21.8613733
[147,]  -24.3107433  9.060797  -41.8801769  -6.3549269
[148,]   14.3482369 10.499421   -5.9025257  35.1807366
[149,]   -4.8232828 12.238971  -28.6009063  19.2621002
[150,]   10.0811974 14.169043  -17.4994149  37.9856362
[151,]   -0.9915050 13.654797  -26.7380225  26.3769301
[152,]   -6.9463752 11.716787  -29.0646283  16.8760298
[153,]  -17.7834455 10.054146  -36.5898026   2.6499553
[154,]  -31.4256158  8.823929  -48.3106990 -14.0243295
[155,]  -19.5756861  8.222573  -35.8046731  -3.5629088
[156,]   41.8663436  8.386467   25.1480450  57.8069439
[157,]  -36.3936267  9.275132  -54.4506778 -18.3404222
[158,]   14.8294030 10.709643   -6.1346608  35.8586895
[159,]   17.1925327 12.503517   -7.2992690  41.5596228
[160,]    9.0439624 14.524206  -19.4260484  37.1048587
[161,]   17.3010246 12.195432   -6.4071762  41.2737639
[162,]   10.4288533 10.539629  -10.1092036  31.0614019
[163,]    6.4503820  9.159710  -10.8773820  24.6035893
[164,]    0.9064106  8.196226  -14.7303026  16.9078494
[165,]  -11.1471607  7.804950  -26.2736297   3.9375188
[166,]  -15.2402320  8.069552  -30.7965378   0.6350314
[167,]  -49.9210033  8.931932  -67.0507770 -32.6615777
[168,]  -13.9907746 10.242189  -34.0012378   5.5271504
[169,]   22.7247540 11.852712   -0.4501263  45.2475108
[170,]   31.9786827 13.657687    5.3805717  57.9006215
[171,]    5.8495870 11.962327  -17.7657585  29.2949103
[172,]   -1.8492386 10.312386  -21.9601982  18.1445058
[173,]   10.5124357  8.958326   -7.1919909  27.7834163
[174,]   11.7861100  8.050850   -4.3647736  27.5880050
[175,]  -23.4340157  7.748486  -39.2669194  -8.0695050
[176,]    7.2398586  8.119124   -9.0294963  23.5172553
[177,]    0.3529330  9.080725  -17.7070956  18.0359744
[178,]   -2.6700927 10.471736  -23.7081527  17.7632654
[179,]   11.4905816 12.145501  -12.8581479  35.1978824
[180,]   -5.2886441 14.000979  -32.9239109  22.3368053</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.5
p_loo        19.6  3.5
looic      1770.0 29.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1496      
 (0.5, 0.7]   (ok)         2    1.1%   356       
   (0.7, 1]   (bad)        1    0.6%   64        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.5 22.3
p_loo        33.5  8.2
looic      1721.1 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   957       
 (0.5, 0.7]   (ok)         6    3.3%   350       
   (0.7, 1]   (bad)        2    1.1%   21        
   (1, Inf)   (very bad)   1    0.6%   13        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.4      11.5  
fit_sleep1 -92.8      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.5
p_loo        19.6  3.5
looic      1770.0 29.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1496      
 (0.5, 0.7]   (ok)         2    1.1%   356       
   (0.7, 1]   (bad)        1    0.6%   64        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.5 22.3
p_loo        33.5  8.2
looic      1721.1 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   957       
 (0.5, 0.7]   (ok)         6    3.3%   350       
   (0.7, 1]   (bad)        2    1.1%   21        
   (1, Inf)   (very bad)   1    0.6%   13        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.5     22.3        33.5    8.2   1721.1
fit_sleep2  -24.4      11.5  -885.0     14.5        19.6    3.5   1770.0
fit_sleep1  -92.8      20.9  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.5  
fit_sleep2   29.0  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
5.140023e-41 2.425256e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.56     0.46     5.45       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.56    -3.11     3.02       5.67      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.15      
[4] StanHeaders_2.26.15 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.0         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
