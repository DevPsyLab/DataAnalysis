<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.00      6.66    15.72    42.00 1.00     1937     3129
sd(Days)                6.55      1.51     4.13    10.02 1.00     1348     1517
cor(Intercept,Days)     0.08      0.29    -0.49     0.65 1.00     1032     1783

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.14      7.35   236.76   265.57 1.00     1767     2511
Days         10.41      1.67     7.23    13.84 1.00     1585     1824

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.53    23.19    29.09 1.00     3663     3025

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9192  12.90328 228.0009 278.4658
309 211.2332  13.04372 185.8048 236.6465
310 212.8691  13.05637 187.5316 238.3009
330 274.6763  13.24593 250.4075 301.7787
331 273.3550  13.16157 248.1596 299.0776
332 260.4355  12.36135 236.5433 284.5794
333 268.1258  12.53369 244.2173 293.0076
334 244.0406  12.21634 219.8339 267.7923
335 250.8962  13.38218 224.5216 277.9367
337 285.9716  13.22198 260.9275 312.3313
349 226.5252  12.77502 200.6543 250.7202
350 238.5682  13.06423 212.8863 263.2342
351 255.7079  12.37155 231.2641 280.5766
352 272.3558  12.76375 247.7279 298.6471
369 254.6768  12.40923 230.7724 278.8038
370 226.1169  13.28575 200.0402 251.9414
371 252.2527  12.08292 228.1779 275.3470
372 263.5710  12.20258 239.9655 287.9352

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6110858  2.437813 14.9386470 24.380487
309  1.7524508  2.473337 -3.1492958  6.365598
310  4.9275956  2.478958 -0.0210206  9.595872
330  5.7053526  2.499558  0.7453320 10.326347
331  7.4472798  2.466963  2.5994949 12.246767
332 10.2225839  2.350511  5.5398561 14.735189
333 10.2993349  2.371884  5.6551470 14.911899
334 11.5350687  2.330730  6.9799537 16.160479
335 -0.2349072  2.605936 -5.5066578  4.717552
337 19.1439467  2.485516 14.2746846 24.032062
349 11.5797456  2.416806  7.0254261 16.473216
350 16.9958204  2.494009 12.3016190 21.917972
351  7.4560142  2.412697  2.6598995 12.035673
352 14.0239533  2.427055  9.1419612 18.687313
369 11.3561926  2.395346  6.6583164 16.033265
370 15.2528169  2.538768 10.3187715 20.246952
371  9.4542057  2.323467  4.8074554 14.122432
372 11.8442151  2.297562  7.3183085 16.307494</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9192 12.903283 228.0009 278.4658
  [2,] 273.5303 11.052328 251.5136 294.3560
  [3,] 293.1414  9.470957 274.3391 311.2906
  [4,] 312.7525  8.314444 296.3593 329.0895
  [5,] 332.3636  7.774753 317.3336 347.5952
  [6,] 351.9746  7.978061 336.4020 367.2019
  [7,] 371.5857  8.873443 354.0601 388.8292
  [8,] 391.1968 10.281653 370.9222 410.9331
  [9,] 410.8079 12.023837 386.7861 433.9137
 [10,] 430.4190 13.975649 402.9041 457.4951
 [11,] 211.2332 13.043723 185.8048 236.6465
 [12,] 212.9857 11.192559 191.0207 234.6232
 [13,] 214.7381  9.625115 196.0500 233.7239
 [14,] 216.4906  8.499830 199.7409 233.0854
 [15,] 218.2430  8.005384 202.4910 233.5620
 [16,] 219.9955  8.255908 204.0033 235.6661
 [17,] 221.7479  9.190684 203.6409 239.1868
 [18,] 223.5004 10.630715 202.6440 243.4523
 [19,] 225.2528 12.401224 200.4327 248.9417
 [20,] 227.0053 14.380660 198.3062 254.5502
 [21,] 212.8691 13.056367 187.5316 238.3009
 [22,] 217.7967 11.172641 196.2074 239.6524
 [23,] 222.7243  9.564390 204.1988 241.4481
 [24,] 227.6519  8.391524 211.5089 244.1443
 [25,] 232.5795  7.851642 217.6870 247.5391
 [26,] 237.5071  8.072753 221.8844 253.7732
 [27,] 242.4347  8.998937 225.0286 260.4522
 [28,] 247.3623 10.444275 226.9370 267.8038
 [29,] 252.2899 12.226011 227.9458 275.8204
 [30,] 257.2175 14.218238 228.8351 284.3636
 [31,] 274.6763 13.245928 250.4075 301.7787
 [32,] 280.3816 11.339313 259.7074 303.4051
 [33,] 286.0870  9.705721 267.9852 305.4309
 [34,] 291.7923  8.503976 275.3452 308.2155
 [35,] 297.4977  7.932829 281.8383 312.8746
 [36,] 303.2030  8.126348 287.1635 318.9912
 [37,] 308.9084  9.035534 290.9660 326.4765
 [38,] 314.6137 10.475676 293.7735 334.9718
 [39,] 320.3191 12.261089 296.5604 344.3638
 [40,] 326.0245 14.262692 298.6082 353.4330
 [41,] 273.3550 13.161568 248.1596 299.0776
 [42,] 280.8023 11.287341 259.2852 302.9042
 [43,] 288.2495  9.682616 269.6614 307.2733
 [44,] 295.6968  8.501403 279.6192 312.4323
 [45,] 303.1441  7.935141 287.7864 318.6035
 [46,] 310.5914  8.113623 294.6428 326.8013
 [47,] 318.0387  8.992614 300.7274 336.1578
 [48,] 325.4859 10.395919 305.7109 345.9236
 [49,] 332.9332 12.143104 309.0816 357.3108
 [50,] 340.3805 14.106971 312.7132 368.8082
 [51,] 260.4355 12.361346 236.5433 284.5794
 [52,] 270.6580 10.621069 250.1224 291.3459
 [53,] 280.8806  9.157572 262.8923 299.0469
 [54,] 291.1032  8.121881 274.7124 306.7133
 [55,] 301.3258  7.688861 285.8484 316.5546
 [56,] 311.5484  7.957513 295.3890 327.4664
 [57,] 321.7710  8.864268 303.9438 339.6921
 [58,] 331.9935 10.241010 311.8219 352.5157
 [59,] 342.2161 11.926069 318.4229 366.1215
 [60,] 352.4387 13.807018 325.1263 379.6604
 [61,] 268.1258 12.533685 244.2173 293.0076
 [62,] 278.4252 10.793845 257.6729 299.8215
 [63,] 288.7245  9.336626 270.7093 307.1300
 [64,] 299.0238  8.312025 282.9287 315.1869
 [65,] 309.3232  7.890411 294.2064 324.7329
 [66,] 319.6225  8.165726 304.0096 335.8253
 [67,] 329.9219  9.074760 312.5114 347.8076
 [68,] 340.2212 10.453473 319.9260 360.8263
 [69,] 350.5205 12.142924 326.9807 374.4096
 [70,] 360.8199 14.031315 333.6891 388.1651
 [71,] 244.0406 12.216336 219.8339 267.7923
 [72,] 255.5757 10.519240 234.5121 275.8287
 [73,] 267.1108  9.106841 249.2645 284.6140
 [74,] 278.6458  8.128918 262.5921 294.4155
 [75,] 290.1809  7.751688 275.0905 305.6777
 [76,] 301.7160  8.059940 286.2619 317.6538
 [77,] 313.2510  8.983385 296.0093 330.9028
 [78,] 324.7861 10.358784 305.0198 345.5283
 [79,] 336.3212 12.032132 313.2069 360.6148
 [80,] 347.8563 13.896208 321.1848 375.7258
 [81,] 250.8962 13.382184 224.5216 277.9367
 [82,] 250.6613 11.359435 228.5917 273.3962
 [83,] 250.4264  9.621460 231.5883 269.4950
 [84,] 250.1914  8.348056 233.8817 266.2864
 [85,] 249.9565  7.771061 234.4145 265.2356
 [86,] 249.7216  8.041799 233.8722 265.3752
 [87,] 249.4867  9.084795 231.6622 267.0709
 [88,] 249.2518 10.676061 227.9793 269.9739
 [89,] 249.0169 12.609712 223.9479 273.2767
 [90,] 248.7820 14.751720 219.3856 277.2939
 [91,] 285.9716 13.221978 260.9275 312.3313
 [92,] 305.1155 11.339302 283.3750 327.7135
 [93,] 324.2595  9.731107 305.7779 344.1661
 [94,] 343.4034  8.553636 327.0607 361.1032
 [95,] 362.5474  7.999407 347.1151 378.5756
 [96,] 381.6913  8.195848 365.8347 397.9795
 [97,] 400.8353  9.094444 382.9503 418.7231
 [98,] 419.9792 10.516724 399.4178 440.5507
 [99,] 439.1232 12.282086 414.9835 463.1813
[100,] 458.2671 14.263708 430.5899 486.3892
[101,] 226.5252 12.775022 200.6543 250.7202
[102,] 238.1050 10.984322 215.9044 259.2411
[103,] 249.6847  9.475832 230.6130 267.8524
[104,] 261.2644  8.402936 244.7242 277.2871
[105,] 272.8442  7.944129 257.2817 287.9422
[106,] 284.4239  8.203105 268.0935 300.2769
[107,] 296.0037  9.118913 277.8761 313.8711
[108,] 307.5834 10.521413 286.8689 328.2025
[109,] 319.1632 12.244492 294.9141 342.8415
[110,] 330.7429 14.171694 302.7997 358.2224
[111,] 238.5682 13.064228 212.8863 263.2342
[112,] 255.5640 11.174129 233.5019 276.7970
[113,] 272.5598  9.564959 253.8111 290.9278
[114,] 289.5556  8.399755 273.1974 305.8685
[115,] 306.5515  7.878038 291.6421 322.0314
[116,] 323.5473  8.124731 307.9646 340.2090
[117,] 340.5431  9.077400 323.1274 358.7883
[118,] 357.5389 10.546435 337.0741 378.6817
[119,] 374.5347 12.348909 350.5832 398.9901
[120,] 391.5306 14.359804 364.1597 420.0518
[121,] 255.7079 12.371550 231.2641 280.5766
[122,] 263.1639 10.576291 242.6421 284.3824
[123,] 270.6200  9.072090 252.8648 288.5834
[124,] 278.0760  8.024333 262.1532 293.7626
[125,] 285.5320  7.623596 270.5618 300.2900
[126,] 292.9880  7.968108 277.7674 307.9424
[127,] 300.4440  8.972428 282.9289 317.3507
[128,] 307.9000 10.447986 287.6201 327.7731
[129,] 315.3560 12.225324 291.3932 338.7769
[130,] 322.8120 14.191509 294.9135 349.5572
[131,] 272.3558 12.763753 247.7279 298.6471
[132,] 286.3797 10.986015 265.0878 308.7628
[133,] 300.4037  9.500151 282.0381 319.1104
[134,] 314.4276  8.461347 297.9109 330.8957
[135,] 328.4516  8.044695 312.8112 344.0678
[136,] 342.4755  8.343922 326.2343 358.5131
[137,] 356.4995  9.290110 338.3119 374.4947
[138,] 370.5234 10.713191 349.5851 391.2062
[139,] 384.5474 12.450701 359.6937 408.3981
[140,] 398.5713 14.389186 369.5248 426.3963
[141,] 254.6768 12.409234 230.7724 278.8038
[142,] 266.0330 10.675972 245.3032 286.2791
[143,] 277.3892  9.243325 259.5134 295.1241
[144,] 288.7454  8.269044 272.3191 304.8433
[145,] 300.1015  7.924045 284.5597 315.7872
[146,] 311.4577  8.287295 295.5825 327.7221
[147,] 322.8139  9.275958 304.9982 341.2027
[148,] 334.1701 10.718344 313.1455 355.4725
[149,] 345.5263 12.457840 320.8081 369.7145
[150,] 356.8825 14.387079 328.4706 384.9910
[151,] 226.1169 13.285754 200.0402 251.9414
[152,] 241.3697 11.352649 219.4454 264.0484
[153,] 256.6225  9.702820 238.1930 276.4446
[154,] 271.8754  8.502792 255.7199 288.9856
[155,] 287.1282  7.958701 271.9375 303.1171
[156,] 302.3810  8.202137 286.6110 318.6347
[157,] 317.6338  9.170597 299.7415 335.6439
[158,] 332.8866 10.668427 311.6953 353.5313
[159,] 348.1394 12.506859 323.0517 372.3746
[160,] 363.3923 14.557417 333.8864 391.1894
[161,] 252.2527 12.082918 228.1779 275.3470
[162,] 261.7069 10.406551 241.1000 281.7943
[163,] 271.1611  9.021789 253.3668 288.6917
[164,] 280.6153  8.079978 264.5651 296.5581
[165,] 290.0695  7.744444 275.0272 304.8780
[166,] 299.5237  8.090969 283.7282 315.2531
[167,] 308.9780  9.041468 291.3254 326.3613
[168,] 318.4322 10.432137 297.7586 339.2444
[169,] 327.8864 12.112301 304.3036 351.7720
[170,] 337.3406 13.977954 309.7346 364.7717
[171,] 263.5710 12.202580 239.9655 287.9352
[172,] 275.4152 10.581458 254.8518 296.5733
[173,] 287.2594  9.251439 269.4361 305.9585
[174,] 299.1036  8.352759 282.7674 316.1856
[175,] 310.9478  8.031539 295.6158 327.2519
[176,] 322.7921  8.354654 306.5633 339.4340
[177,] 334.6363  9.254860 316.3530 352.5684
[178,] 346.4805 10.585945 325.5589 366.5511
[179,] 358.3247 12.207768 334.4415 381.7383
[180,] 370.1689 14.019791 342.8490 397.2367</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.3592070 12.903283  -28.90583624  21.5590704
  [2,]  -14.8255928 11.052328  -35.65134019   7.1910691
  [3,]  -42.3407785  9.470957  -60.49003416 -23.5384900
  [4,]    8.6873357  8.314444   -7.64972967  25.0805237
  [5,]   24.4883499  7.774753    9.25667658  39.5183174
  [6,]   62.7154641  7.978061   47.48815985  78.2880793
  [7,]   10.6180784  8.873443   -6.62542598  28.1436575
  [8,] -101.0482074 10.281653 -120.78447965 -80.7735806
  [9,]   19.7774068 12.023837   -3.32836963  43.7991513
 [10,]   35.9345210 13.975649    8.85838263  63.4494345
 [11,]   11.5006722 13.043723  -13.91259811  36.9290623
 [12,]   -7.7198786 11.192559  -29.35739511  14.2451488
 [13,]  -11.7603294  9.625115  -30.74608354   6.9277841
 [14,]  -11.7835802  8.499830  -28.37844578   4.9661275
 [15,]  -10.5269310  8.005384  -25.84591550   5.2251329
 [16,]   -4.0336818  8.255908  -19.70426423  11.9584560
 [17,]   -8.1176326  9.190684  -25.55646784   9.9894134
 [18,]   -5.7731834 10.630715  -25.72513682  15.0832305
 [19,]   -0.9571342 12.401224  -24.64603251  23.8629537
 [20,]   10.3089150 14.380660  -17.23602109  39.0079936
 [21,]  -13.8152430 13.056367  -39.24702820  11.5223251
 [22,]  -23.4645387 11.172641  -45.32024921  -1.8751888
 [23,]   11.5956657  9.564390   -7.12810465  30.1211643
 [24,]    5.1896701  8.391524  -11.30266407  21.3327348
 [25,]   -3.2721255  7.851642  -18.23173224  11.6203998
 [26,]  -17.0492212  8.072753  -33.31533495  -1.4264979
 [27,]   -7.0139168  8.998937  -25.03135106  10.3922141
 [28,]    8.3887876 10.444275  -12.05265575  28.8140839
 [29,]    8.7225920 12.226011  -14.80793588  33.0666950
 [30,]   -9.7022036 14.218238  -36.84833861  18.6802032
 [31,]   46.8663202 13.245928   19.76389330  71.1351264
 [32,]   20.0185676 11.339313   -3.00490060  40.6927561
 [33,]   -2.2304851  9.705721  -21.57438612  15.8712948
 [34,]   -6.6593377  8.503976  -23.08253925   9.7878333
 [35,]  -11.7003903  7.932829  -27.07726643   3.9590264
 [36,]   -5.6175430  8.126348  -21.40572100  10.4220177
 [37,]  -28.6687956  9.035534  -46.23693763 -10.7264232
 [38,]    3.6475517 10.475676  -16.71048918  24.4878103
 [39,]  -14.9696009 12.261089  -39.01432105   8.7891358
 [40,]   28.0242464 14.262692    0.61571018  55.4405404
 [41,]   14.2529265 13.161568  -11.46972700  39.4483285
 [42,]    4.1977467 11.287341  -17.90420018  25.7148090
 [43,]   13.5710669  9.682616   -5.45268331  32.1591555
 [44,]   24.4184871  8.501403    7.68302181  40.4961245
 [45,]   13.1332073  7.935141   -2.32622218  28.4909115
 [46,]  -17.2726724  8.113623  -33.48262444  -1.3240915
 [47,]  -27.9636522  8.992614  -46.08276230 -10.6524234
 [48,]    9.3317680 10.395919  -11.10588832  29.1067711
 [49,]  -39.1863118 12.143104  -63.56386191 -15.3347464
 [50,]   31.2006084 14.106971    2.77293269  58.8678812
 [51,]  -25.5748623 12.361346  -49.71883496  -1.6827112
 [52,]  -27.8462462 10.621069  -48.53410446  -7.3105609
 [53,]   -7.9193301  9.157572  -26.08561986  10.0690415
 [54,]   18.6655859  8.121881    3.05551268  35.0564229
 [55,]   16.1371020  7.688861    0.90828963  31.6144637
 [56,]   -1.5507819  7.957513  -17.46883098  14.6085793
 [57,]  132.3909341  8.864268  114.46980223 150.2180953
 [58,]   14.8375502 10.241010   -5.68461286  35.0091557
 [59,]  -11.9158337 11.926069  -35.82116337  11.8773950
 [60,]  -98.5743177 13.807018 -125.79601423 -71.2619430
 [61,]   15.7165567 12.533685   -9.16517879  39.6250588
 [62,]   11.1298218 10.793845  -10.26653341  31.8821246
 [63,]  -11.9552130  9.336626  -30.36070460   6.0599530
 [64,]    0.7858521  8.312025  -15.37721484  16.8810443
 [65,]  -12.1521828  7.890411  -27.56187829   2.9645746
 [66,]   18.5439824  8.165726    2.34115289  34.1569284
 [67,]    2.1046475  9.074760  -15.78109161  19.5150772
 [68,]    8.6187126 10.453473  -11.98637341  28.9138688
 [69,]  -17.1605222 12.142924  -41.04956839   6.3793119
 [70,]    1.2229429 14.031315  -26.12228136  28.3537188
 [71,]   21.4324649 12.216336   -2.31922601  45.6392252
 [72,]   20.6254962 10.519240    0.37246459  41.6890977
 [73,]  -23.7460725  9.106841  -41.24928290  -5.8997753
 [74,]  -23.9735412  8.128918  -39.74316219  -7.9198433
 [75,]  -11.1565099  7.751688  -26.65333502   3.9338787
 [76,]  -17.5247786  8.059940  -33.46263344  -2.0707173
 [77,]   -7.7262473  8.983385  -25.37803502   9.5155311
 [78,]    6.7367840 10.358784  -14.00537980  26.5031395
 [79,]   -0.5742846 12.032132  -24.86792998  22.5399869
 [80,]   29.4427467 13.896208    1.57324898  56.1141738
 [81,]   -9.2878688 13.382184  -36.32836283  17.0867077
 [82,]   23.2859384 11.359435    0.55104153  45.3554834
 [83,]    4.0643456  9.621460  -15.00425657  22.9023809
 [84,]   20.6106528  8.348056    4.51570937  36.9204354
 [85,]    1.4953600  7.771061  -13.78371239  17.0373968
 [86,]    4.9145673  8.041799  -10.73897686  20.7640327
 [87,]   -4.0344255  9.084795  -21.61860258  13.7900589
 [88,]  -13.9408183 10.676061  -34.66289977   7.3317290
 [89,]  -13.2628111 12.609712  -37.52264631  11.8061671
 [90,]  -11.5354039 14.751720  -40.04728133  17.8610321
 [91,]   26.3949999 13.221978    0.03526874  51.4391192
 [92,]    8.6902533 11.339302  -13.90773853  30.4307638
 [93,]  -32.6482934  9.731107  -52.55489953 -14.1666895
 [94,]    2.7187599  8.553636  -14.98104713  19.0615039
 [95,]    3.1850133  7.999407  -12.84319479  18.6173426
 [96,]   10.1471666  8.195848   -6.14096791  26.0037797
 [97,]    3.4248199  9.094444  -14.46299963  21.3098129
 [98,]   -3.2869267 10.516724  -23.85843460  17.2745169
 [99,]   16.7411266 12.282086   -7.31703049  40.8807559
[100,]    0.6495799 14.263708  -27.47247773  28.3268150
[101,]    9.5779928 12.775022  -14.61696652  35.4488850
[102,]   -7.7882528 10.984322  -28.92440326  14.4122662
[103,]  -10.7590985  9.475832  -28.92678858   8.3125516
[104,]   -6.3424441  8.402936  -22.36505396  10.1977558
[105,]  -22.1338898  7.944129  -37.23190263  -6.5714109
[106,]  -14.6495354  8.203105  -30.50254135   1.6809324
[107,]  -14.4388811  9.118913  -32.30625651   3.6887374
[108,]    0.5185733 10.521413  -20.10050732  21.2331392
[109,]   17.1174277 12.244492   -6.56086923  41.3665328
[110,]   20.9021820 14.171694   -6.57732619  48.8454243
[111,]   17.7286141 13.064228   -6.93744888  43.4105106
[112,]  -12.1097063 11.174129  -33.34274885   9.9524023
[113,]  -16.3552268  9.564959  -34.72321886   2.3934809
[114,]  -34.0285472  8.399755  -50.34135240 -17.6702724
[115,]  -37.6349677  7.878038  -53.11486508 -22.7255787
[116,]    6.1774119  8.124731  -10.48425149  21.7601076
[117,]   38.9013914  9.077400   20.65623865  56.3170647
[118,]    5.3794710 10.546435  -15.76330698  25.8443201
[119,]   19.9524505 12.348909   -4.50291945  43.9039832
[120,]   -2.4778699 14.359804  -30.99906587  24.8930465
[121,]   -5.1814219 12.371550  -30.05012593  19.2624277
[122,]   36.8936639 10.576291   15.67521224  57.4154665
[123,]   -0.7260504  9.072090  -18.68945707  17.0291099
[124,]    2.5131354  8.024333  -13.17350902  18.4359121
[125,]  -13.7045788  7.623596  -28.46257727   1.2656378
[126,]   11.6456069  7.968108   -3.30877058  26.8662039
[127,]  -12.6974073  8.972428  -29.60407816   4.8176801
[128,]  -41.3045215 10.447986  -61.17758765 -21.0245943
[129,]    6.1857642 12.225324  -17.23506876  30.1485755
[130,]   24.7534500 14.191509   -1.99170643  52.6520044
[131,]  -50.6786577 12.763753  -76.97001323 -26.0507767
[132,]   11.8141890 10.986015  -10.56888749  33.1061220
[133,]   26.4748357  9.500151    7.76808094  44.8403920
[134,]   32.4278824  8.461347   15.95977251  48.9445644
[135,]   20.2886292  8.044695    4.67241582  35.9289642
[136,]   10.3531759  8.343922   -5.68435810  26.5944285
[137,]   -2.0728774  9.290110  -20.06805010  16.1146714
[138,]  -10.0908307 10.713191  -30.77364842  10.8474527
[139,]   -8.9067839 12.450701  -32.75747704  15.9469186
[140,]  -10.0296372 14.389186  -37.85459118  19.0168696
[141,]   17.2467207 12.409234   -6.88027860  41.1511181
[142,]    2.4039281 10.675972  -17.84221527  23.1337216
[143,]  -20.1467645  9.243325  -37.88174305  -2.2710239
[144,]  -11.0887571  8.269044  -27.18673323   5.3375080
[145,]   14.7206503  7.924045   -0.96504240  30.2624963
[146,]    5.7557577  8.287295  -10.50862548  21.6310373
[147,]  -24.6786349  9.275958  -43.06741264  -6.8628729
[148,]   13.9527725 10.718344   -7.34957635  34.9773674
[149,]   -5.2463200 12.457840  -29.43445645  19.4719358
[150,]    9.6305874 14.387079  -18.47793729  38.0424659
[151,]   -0.8529067 13.285754  -26.67738554  25.2238393
[152,]   -6.8462235 11.352649  -29.52494233  15.0780584
[153,]  -17.7217404  9.702820  -37.54381948   0.7077662
[154,]  -31.4023573  8.502792  -48.51258491 -15.2469277
[155,]  -19.5908741  7.958701  -35.57981721  -4.4001608
[156,]   41.8127090  8.202137   25.55901267  57.5827069
[157,]  -36.4857079  9.170597  -54.49575628 -18.5934404
[158,]   14.6988753 10.668427   -5.94577173  35.8901857
[159,]   17.0235584 12.506859   -7.21159699  42.1112559
[160,]    8.8365415 14.557417  -18.96061748  38.3423810
[161,]   17.6276838 12.082918   -5.46663940  41.7025063
[162,]   10.7358781 10.406551   -9.35149350  31.3428233
[163,]    6.7377724  9.021789  -10.79277841  24.5320896
[164,]    1.1741668  8.079978  -14.76860669  17.2243524
[165,]  -10.8990389  7.744444  -25.70752351   4.1433488
[166,]  -15.0117445  8.090969  -30.74114410   0.7837715
[167,]  -49.7121502  9.041468  -67.09551732 -32.0595811
[168,]  -13.8015558 10.432137  -34.61377816   6.8719827
[169,]   22.8943385 12.112301   -0.99133315  46.4771350
[170,]   32.1286329 13.977954    4.69752056  59.7345845
[171,]    5.8407109 12.202580  -18.52352988  29.4462195
[172,]   -1.9412042 10.581458  -23.09931197  18.6222218
[173,]   10.3373807  9.251439   -8.36167281  28.1607172
[174,]   11.5279656  8.352759   -5.55403713  27.8641802
[175,]  -23.7752495  8.031539  -40.07925845  -8.4431628
[176,]    6.8155354  8.354654   -9.82643812  23.0443012
[177,]   -0.1544797  9.254860  -18.08658830  18.1288379
[178,]   -3.2605948 10.585945  -23.33124248  17.6610299
[179,]   10.8169901 12.207768  -12.59662335  34.7002233
[180,]   -6.0453250 14.019791  -33.11311575  21.2746082</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.1  3.3
looic      1769.3 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   213       
 (0.5, 0.7]   (ok)         3    1.7%   585       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.3
p_loo        33.7  8.4
looic      1721.4 44.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   615       
 (0.5, 0.7]   (ok)         5    2.8%   918       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   3    1.7%   9         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.0      11.6  
fit_sleep1 -92.6      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.1  3.3
looic      1769.3 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   213       
 (0.5, 0.7]   (ok)         3    1.7%   585       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.3
p_loo        33.7  8.4
looic      1721.4 44.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   615       
 (0.5, 0.7]   (ok)         5    2.8%   918       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   3    1.7%   9         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.7     22.3        33.7    8.4   1721.4
fit_sleep2  -24.0      11.6  -884.7     14.3        19.1    3.3   1769.3
fit_sleep1  -92.6      21.0  -953.3     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.6  
fit_sleep2   28.7  
fit_sleep1   21.1  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
5.944286e-41 3.929847e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.86      1.63     0.14     5.37       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.14      1.63    -3.41     2.91       4.93      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.3.5         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.0       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
