<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing
adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.76      6.62    15.42    41.65 1.00     1946     2691
sd(Days)                6.56      1.55     4.09    10.07 1.00     1721     2067
cor(Intercept,Days)     0.10      0.30    -0.48     0.69 1.00      990     1507

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.12      7.26   236.47   265.41 1.00     1991     2585
Days         10.46      1.73     6.95    13.95 1.00     1338     1585

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.97      1.60    23.01    29.39 1.00     3789     2850

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.2492  13.40549 227.8116 280.5318
309 211.1591  13.43809 184.5866 237.1965
310 213.1345  13.23199 186.3077 239.0381
330 274.3045  13.52781 248.1274 301.4027
331 272.9678  13.11962 248.4262 300.1298
332 259.8759  12.46666 235.7022 284.3746
333 267.6452  12.38538 244.3710 293.1144
334 244.5040  12.54809 220.4609 268.5333
335 250.4120  13.67380 223.5753 276.7967
337 285.7404  13.33909 259.8659 312.1736
349 226.4957  12.93942 200.8011 250.5726
350 239.0022  13.43862 210.9927 263.9849
351 255.7899  12.62399 232.0412 281.7692
352 271.9670  12.44350 248.0325 296.8966
369 254.8354  12.24875 230.7962 279.1557
370 226.6338  13.48458 198.4848 251.4804
371 252.1399  12.41272 227.7165 277.0563
372 263.3292  12.30257 240.0511 288.1169

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6128720  2.532933 14.6578080 24.682495
309  1.7780350  2.524491 -3.1215372  6.737421
310  4.9146764  2.477583  0.0127971  9.750241
330  5.7974953  2.528043  0.6682272 10.704092
331  7.5065619  2.518143  2.4364015 12.273772
332 10.2489544  2.378926  5.6036082 14.988105
333 10.3493141  2.389873  5.5422748 14.912694
334 11.5081737  2.394197  6.8111481 16.121493
335 -0.1351589  2.607625 -5.1831106  4.831410
337 19.1852735  2.486961 14.3322401 24.108293
349 11.5675910  2.434555  6.8585782 16.456662
350 16.9686021  2.551803 12.1646775 22.187742
351  7.4707987  2.422312  2.6638463 12.236161
352 14.0268496  2.382996  9.3108457 18.463062
369 11.3264587  2.293523  6.7567095 15.770589
370 15.0842800  2.558619 10.1754285 20.248916
371  9.4922581  2.372177  4.7210530 14.178990
372 11.8247233  2.342487  7.1930780 16.385117</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.2492 13.405485 227.8116 280.5318
  [2,] 273.8620 11.472386 251.0367 296.3025
  [3,] 293.4749  9.816096 273.7268 312.3874
  [4,] 313.0878  8.598102 296.0602 329.8529
  [5,] 332.7007  8.020628 316.2569 348.3586
  [6,] 352.3135  8.219799 335.7589 368.4477
  [7,] 371.9264  9.145010 353.7394 389.7400
  [8,] 391.5393 10.607960 370.3864 412.2021
  [9,] 411.1521 12.420062 386.7764 435.1813
 [10,] 430.7650 14.450556 402.4820 459.2334
 [11,] 211.1591 13.438094 184.5866 237.1965
 [12,] 212.9372 11.536603 190.1635 235.1407
 [13,] 214.7152  9.917164 195.3294 234.0867
 [14,] 216.4932  8.738032 199.3492 233.4034
 [15,] 218.2713  8.191602 202.0324 234.3401
 [16,] 220.0493  8.402239 203.6967 236.5286
 [17,] 221.8273  9.318744 203.5892 239.9168
 [18,] 223.6054 10.762271 202.5123 244.5201
 [19,] 225.3834 12.552293 200.6324 249.8850
 [20,] 227.1615 14.561585 198.1353 255.7635
 [21,] 213.1345 13.231987 186.3077 239.0381
 [22,] 218.0492 11.322712 195.4671 240.2393
 [23,] 222.9639  9.674656 203.6121 242.2526
 [24,] 227.8786  8.442214 211.3767 244.1070
 [25,] 232.7932  7.824310 217.6265 248.1270
 [26,] 237.7079  7.965269 222.2305 253.2046
 [27,] 242.6226  8.828818 225.0737 259.3425
 [28,] 247.5373 10.233640 227.1712 266.8841
 [29,] 252.4520 11.990979 228.4449 275.1456
 [30,] 257.3666 13.968415 229.4908 283.4614
 [31,] 274.3045 13.527806 248.1274 301.4027
 [32,] 280.1020 11.594200 258.0216 303.5552
 [33,] 285.8995  9.931335 266.8828 305.8884
 [34,] 291.6970  8.695940 274.9558 308.5766
 [35,] 297.4945  8.086367 281.6461 313.2601
 [36,] 303.2920  8.242651 287.1329 319.1807
 [37,] 309.0894  9.125529 291.2116 326.8466
 [38,] 314.8869 10.554205 294.6281 335.6204
 [39,] 320.6844 12.340552 296.6986 344.7590
 [40,] 326.4819 14.351628 298.4039 354.1161
 [41,] 272.9678 13.119622 248.4262 300.1298
 [42,] 280.4744 11.236464 259.2629 303.4141
 [43,] 287.9809  9.647478 269.8131 307.6173
 [44,] 295.4875  8.518899 279.2505 313.0244
 [45,] 302.9940  8.046833 287.5914 319.0324
 [46,] 310.5006  8.343471 294.5995 326.5230
 [47,] 318.0072  9.335822 299.9557 336.0755
 [48,] 325.5137 10.834377 304.2155 346.2671
 [49,] 333.0203 12.660646 307.9552 357.3291
 [50,] 340.5269 14.692934 311.4448 368.7056
 [51,] 259.8759 12.466661 235.7022 284.3746
 [52,] 270.1249 10.764090 249.2930 291.2039
 [53,] 280.3738  9.361208 262.0334 298.8969
 [54,] 290.6228  8.409362 274.1018 306.9793
 [55,] 300.8717  8.069765 285.1637 316.2264
 [56,] 311.1207  8.416854 294.7650 328.1297
 [57,] 321.3696  9.374665 303.3209 340.4708
 [58,] 331.6186 10.781643 310.8352 353.7158
 [59,] 341.8676 12.486869 317.9952 367.2600
 [60,] 352.1165 14.384664 324.5201 381.2688
 [61,] 267.6452 12.385381 244.3710 293.1144
 [62,] 277.9945 10.643624 257.9093 299.7530
 [63,] 288.3438  9.197759 270.6203 306.9326
 [64,] 298.6931  8.205718 282.3926 314.5426
 [65,] 309.0424  7.841673 293.5545 324.2969
 [66,] 319.3918  8.189801 302.9264 335.0205
 [67,] 329.7411  9.169342 311.6974 347.3392
 [68,] 340.0904 10.606781 319.4123 360.1392
 [69,] 350.4397 12.343167 326.2103 374.0752
 [70,] 360.7890 14.269784 332.7603 388.3640
 [71,] 244.5040 12.548086 220.4609 268.5333
 [72,] 256.0122 10.790693 235.5033 276.9930
 [73,] 267.5204  9.321373 249.3098 285.7427
 [74,] 279.0286  8.294654 262.9451 295.2214
 [75,] 290.5367  7.885362 275.0476 306.0823
 [76,] 302.0449  8.186632 285.9282 318.0958
 [77,] 313.5531  9.128380 295.4559 331.2402
 [78,] 325.0612 10.540306 304.4394 345.1372
 [79,] 336.5694 12.261041 312.1698 359.8751
 [80,] 348.0776 14.178596 319.6554 374.9666
 [81,] 250.4120 13.673804 223.5753 276.7967
 [82,] 250.2768 11.655546 227.2609 273.1597
 [83,] 250.1417  9.916149 230.7498 269.4859
 [84,] 250.0065  8.625990 233.3392 267.0866
 [85,] 249.8713  8.005298 234.4318 265.8718
 [86,] 249.7362  8.207394 233.7371 266.1993
 [87,] 249.6010  9.178085 232.0264 268.0370
 [88,] 249.4659 10.710397 228.8533 270.8263
 [89,] 249.3307 12.601086 224.5227 273.9367
 [90,] 249.1955 14.712633 220.0734 278.0627
 [91,] 285.7404 13.339092 259.8659 312.1736
 [92,] 304.9256 11.455457 282.5573 327.9307
 [93,] 324.1109  9.843454 304.9889 343.9492
 [94,] 343.2962  8.656190 327.0127 360.5676
 [95,] 362.4814  8.083045 347.1959 378.7842
 [96,] 381.6667  8.252973 365.8212 398.2256
 [97,] 400.8520  9.124553 383.1627 418.9816
 [98,] 420.0373 10.524890 399.6856 440.7158
 [99,] 439.2225 12.274328 415.8984 463.3698
[100,] 458.4078 14.244820 430.7812 486.2623
[101,] 226.4957 12.939417 200.8011 250.5726
[102,] 238.0633 11.121304 216.2229 258.8291
[103,] 249.6309  9.580836 230.6491 267.5803
[104,] 261.1985  8.470864 244.4962 277.4398
[105,] 272.7660  7.973254 257.1150 288.4204
[106,] 284.3336  8.200251 267.9396 300.7864
[107,] 295.9012  9.097779 277.6402 313.7869
[108,] 307.4688 10.495197 286.4241 327.7770
[109,] 319.0364 12.222227 295.1689 342.4402
[110,] 330.6040 14.158765 303.0217 357.6602
[111,] 239.0022 13.438617 210.9927 263.9849
[112,] 255.9708 11.466329 232.5622 277.5553
[113,] 272.9394  9.766286 253.4070 291.3867
[114,] 289.9080  8.503376 273.4419 306.1857
[115,] 306.8766  7.890364 291.1688 322.0856
[116,] 323.8453  8.076613 307.6055 339.6206
[117,] 340.8139  9.012707 322.4953 358.6274
[118,] 357.7825 10.499977 336.3162 378.5454
[119,] 374.7511 12.340726 349.9134 398.9755
[120,] 391.7197 14.400032 363.1609 420.1795
[121,] 255.7899 12.623992 232.0412 281.7692
[122,] 263.2607 10.849779 242.6369 285.4568
[123,] 270.7315  9.370454 252.3730 289.9138
[124,] 278.2023  8.344357 261.5183 294.6863
[125,] 285.6731  7.948986 269.8689 301.5035
[126,] 293.1439  8.275243 277.1767 309.7662
[127,] 300.6146  9.247060 282.4893 319.4964
[128,] 308.0854 10.689797 287.3471 329.9903
[129,] 315.5562 12.440683 291.3888 341.0102
[130,] 323.0270 14.387655 295.2295 351.9380
[131,] 271.9670 12.443496 248.0325 296.8966
[132,] 285.9938 10.672261 265.3722 307.3885
[133,] 300.0207  9.182106 282.1401 318.1866
[134,] 314.0475  8.129102 297.6960 330.0694
[135,] 328.0744  7.694861 312.2900 342.7922
[136,] 342.1012  7.981028 326.0786 357.8842
[137,] 356.1281  8.918523 338.3483 373.9962
[138,] 370.1549 10.331537 349.5735 390.5264
[139,] 384.1818 12.053986 360.1856 408.0407
[140,] 398.2086 13.971895 370.4312 425.8923
[141,] 254.8354 12.248751 230.7962 279.1557
[142,] 266.1619 10.608225 245.1801 287.1215
[143,] 277.4883  9.249727 259.2006 295.7027
[144,] 288.8148  8.312699 272.5117 305.4101
[145,] 300.1413  7.947639 284.7642 315.9954
[146,] 311.4677  8.231005 295.5527 327.8480
[147,] 322.7942  9.102441 305.3693 340.8344
[148,] 334.1206 10.415369 314.3525 354.5151
[149,] 345.4471 12.026050 322.6268 369.4809
[150,] 356.7735 13.830847 330.3473 384.2694
[151,] 226.6338 13.484575 198.4848 251.4804
[152,] 241.7181 11.526392 217.3666 263.2545
[153,] 256.8024  9.847574 236.4678 275.3086
[154,] 271.8867  8.613059 254.8063 288.4550
[155,] 286.9709  8.030437 271.3047 302.6196
[156,] 302.0552  8.239181 285.9348 318.2658
[157,] 317.1395  9.185497 298.8406 335.0932
[158,] 332.2238 10.675002 310.7415 353.2026
[159,] 347.3081 12.515232 322.6883 372.1882
[160,] 362.3923 14.573931 333.5437 390.9258
[161,] 252.1399 12.412715 227.7165 277.0563
[162,] 261.6321 10.680648 240.3918 282.5175
[163,] 271.1244  9.237502 252.7786 288.8915
[164,] 280.6166  8.236569 264.1500 296.6758
[165,] 290.1089  7.848895 274.9220 305.4566
[166,] 299.6011  8.162332 283.5264 315.6282
[167,] 309.0934  9.104759 290.6903 326.9917
[168,] 318.5857 10.508285 297.2761 339.1770
[169,] 328.0779 12.214987 303.1614 352.2167
[170,] 337.5702 14.115318 308.6619 365.6800
[171,] 263.3292 12.302566 240.0511 288.1169
[172,] 275.1539 10.603404 254.6303 296.5057
[173,] 286.9787  9.191611 269.1020 305.4581
[174,] 298.8034  8.216675 282.4421 314.9072
[175,] 310.6281  7.843231 295.0110 326.0908
[176,] 322.4528  8.154342 306.4880 338.2856
[177,] 334.2776  9.079912 316.8096 352.0009
[178,] 346.1023 10.458050 325.8814 366.5634
[179,] 357.9270 12.135539 334.5611 381.7866
[180,] 369.7517 14.005224 342.7295 397.4049</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error       Q2.5      Q97.5
  [1,]   -4.7251800  29.06229  -63.05024  51.641047
  [2,]  -14.4790069  28.61020  -69.49376  42.617639
  [3,]  -42.6725899  27.65875  -96.11385  13.393821
  [4,]    7.6900554  27.99063  -47.19693  63.752140
  [5,]   24.6096245  26.53478  -27.01552  76.722992
  [6,]   62.5399720  27.33903   10.98207 116.258981
  [7,]    9.8300123  27.60492  -43.63666  63.690153
  [8,] -100.5980033  28.01614 -157.17363 -46.855655
  [9,]   18.6002839  28.76089  -38.33460  75.762956
 [10,]   35.8321865  29.43596  -21.56812  95.163331
 [11,]   12.5073066  28.67496  -43.31459  69.688403
 [12,]   -7.8702944  28.64262  -65.99212  47.846478
 [13,]  -11.7352710  28.04122  -65.36833  43.827505
 [14,]  -12.2080393  27.89239  -68.31091  41.006140
 [15,]  -11.2132767  27.46002  -64.72274  43.199745
 [16,]   -3.4163611  27.74000  -56.15445  50.786354
 [17,]   -7.8722880  27.88182  -64.67810  45.350866
 [18,]   -6.0871405  28.04912  -62.02477  47.588303
 [19,]   -1.5643933  28.74761  -57.20734  54.679701
 [20,]    9.7079205  30.55337  -48.80078  69.984037
 [21,]  -14.1038618  29.60878  -71.08956  45.667987
 [22,]  -23.6560709  28.56152  -78.19070  32.385173
 [23,]   12.2744799  27.30264  -41.62599  65.602412
 [24,]    4.8838003  27.04392  -48.00386  58.673201
 [25,]   -3.0122541  26.65303  -54.66168  48.676387
 [26,]  -17.3241594  27.04515  -71.30827  34.816197
 [27,]   -7.2157966  27.63435  -61.73479  47.834604
 [28,]    8.5796234  28.10774  -44.71651  63.098244
 [29,]    8.1989957  28.50366  -47.36808  65.188342
 [30,]  -10.1035757  29.61154  -66.47663  48.210641
 [31,]   47.2314305  29.31773  -10.47619 104.961334
 [32,]   19.9227340  28.42648  -36.79243  75.116974
 [33,]   -2.7271692  28.14369  -58.00881  52.422104
 [34,]   -6.3878003  27.56320  -59.61840  46.799286
 [35,]  -11.5827264  27.61221  -64.25483  41.866097
 [36,]   -5.3304740  27.57914  -58.43696  49.665352
 [37,]  -28.7584242  27.72647  -81.84316  26.898035
 [38,]    3.3690923  28.42835  -52.17092  57.029892
 [39,]  -14.9418260  28.68154  -70.17950  41.248284
 [40,]   27.6266228  29.67057  -31.12303  84.506012
 [41,]   14.4793814  29.63486  -44.66741  72.978762
 [42,]    4.1549497  28.11845  -50.74048  58.910173
 [43,]   14.1052962  28.36666  -42.68011  68.015601
 [44,]   24.1424874  27.51637  -29.69513  76.128514
 [45,]   13.4921214  27.49577  -39.81735  69.400642
 [46,]  -16.9760384  27.52206  -70.38373  37.152964
 [47,]  -27.7805816  27.79821  -81.19234  28.130099
 [48,]    9.1659921  27.86505  -45.30960  62.291083
 [49,]  -39.5960986  29.12404  -96.67253  17.135208
 [50,]   31.6075699  30.14086  -26.89090  91.810118
 [51,]  -25.2475772  28.82213  -82.19041  30.031331
 [52,]  -26.9269521  28.22668  -83.80121  29.240564
 [53,]   -7.4240226  27.34377  -60.50179  48.496189
 [54,]   19.0660604  26.72608  -32.71795  71.563506
 [55,]   16.1976340  27.08583  -34.86494  70.036896
 [56,]   -0.8213139  26.77145  -52.29080  52.699136
 [57,]  132.7459805  27.98618   79.88116 188.158283
 [58,]   15.0273007  27.96266  -38.33016  69.634491
 [59,]  -11.2383632  28.86391  -68.46040  45.677381
 [60,]  -97.9884152  29.41425 -155.23258 -41.941274
 [61,]   15.8090877  28.62264  -39.55617  70.779241
 [62,]   12.6704577  28.65944  -44.56258  69.316166
 [63,]  -11.4542708  27.54841  -64.28056  43.329441
 [64,]    0.5241829  27.48717  -51.68888  53.909078
 [65,]  -11.4154331  27.00803  -63.47499  41.552512
 [66,]   19.3029443  28.17366  -37.00025  74.156885
 [67,]    2.3855699  27.70076  -53.10162  57.137783
 [68,]    9.0835132  28.48334  -47.45673  64.249586
 [69,]  -17.3438480  28.17865  -72.29667  37.907500
 [70,]    1.3472069  29.88255  -58.41578  60.104367
 [71,]   21.3475314  29.20855  -35.87123  78.213648
 [72,]   20.1703276  27.82962  -34.12834  76.840642
 [73,]  -24.5577755  27.82159  -79.63587  29.857449
 [74,]  -24.2652513  27.76953  -79.76657  29.027572
 [75,]  -11.3011518  27.11646  -65.46184  41.119202
 [76,]  -17.9878367  27.11566  -71.06829  34.845499
 [77,]   -8.7656732  26.59326  -60.39948  43.787320
 [78,]    6.0092104  28.12715  -49.85725  62.532807
 [79,]   -0.3011365  28.58762  -56.43548  54.792612
 [80,]   28.9042787  29.65783  -28.12396  84.613129
 [81,]   -8.6076923  28.99831  -66.57641  48.990508
 [82,]   23.9426927  28.52893  -31.45644  79.131074
 [83,]    4.4686943  28.26819  -52.57956  58.955676
 [84,]   20.4757069  27.58442  -33.20654  73.734901
 [85,]    2.1856543  26.94939  -51.23870  56.572372
 [86,]    4.5321692  26.82755  -48.23159  56.622469
 [87,]   -3.9384789  27.35927  -57.83823  50.190856
 [88,]  -13.7767339  27.98541  -69.74541  40.175094
 [89,]  -12.8343751  28.68364  -69.32605  42.215325
 [90,]  -12.0379103  30.31837  -72.36417  46.854233
 [91,]   25.8597175  29.20153  -31.01045  81.393647
 [92,]    8.5803176  28.54496  -46.17712  66.086748
 [93,]  -32.0023022  28.08703  -87.77672  23.577365
 [94,]    3.2405524  27.05869  -49.29311  54.964720
 [95,]    3.1399435  26.98422  -49.86931  54.947162
 [96,]    8.9883205  26.70910  -43.14390  61.305103
 [97,]    3.2519872  27.89910  -52.96406  57.059918
 [98,]   -2.6929962  28.25668  -57.49851  52.978059
 [99,]   16.5590451  28.92765  -39.89911  73.313267
[100,]    0.9634630  29.62379  -55.46885  58.837616
[101,]    8.6010520  29.44238  -49.91512  67.035402
[102,]   -7.9301337  28.07993  -64.26834  48.548906
[103,]  -11.0552705  27.70849  -65.20507  44.771106
[104,]   -6.2341047  26.87761  -59.11434  46.821363
[105,]  -22.7353980  26.58836  -76.69625  28.203703
[106,]  -14.2729540  27.76376  -70.08366  39.811008
[107,]  -13.9675377  27.56993  -68.11903  41.366401
[108,]    0.4209853  28.14542  -53.86270  55.292131
[109,]   17.6098028  28.38823  -36.77654  73.839833
[110,]   21.1957881  29.44051  -35.78879  80.919021
[111,]   17.1946605  28.77462  -37.93084  75.420270
[112,]  -12.6319723  28.28292  -69.04951  42.605454
[113,]  -16.1975056  27.47107  -72.36778  36.714960
[114,]  -34.7325984  27.29841  -86.71623  20.177511
[115,]  -38.0407467  27.45140  -93.95696  14.794537
[116,]    5.7280886  27.20762  -47.57113  60.497648
[117,]   38.7548190  27.93443  -17.41684  94.034112
[118,]    5.1581832  28.20213  -48.53353  59.570331
[119,]   19.1982618  28.57209  -36.70466  75.208953
[120,]   -2.5204615  30.27164  -61.22515  57.264048
[121,]   -5.0368551  28.59449  -61.60876  49.457684
[122,]   36.4968323  27.99957  -19.23159  92.207714
[123,]   -0.8215822  27.48432  -53.99100  51.466399
[124,]    2.4998416  26.88247  -49.01860  54.791167
[125,]  -13.5816273  26.94704  -66.27027  40.174100
[126,]   11.7628307  27.46725  -39.95776  64.426292
[127,]  -12.6747712  27.88934  -66.01113  41.959176
[128,]  -41.5492465  28.38086  -97.95519  13.856013
[129,]    5.7994314  29.09468  -50.44492  62.161937
[130,]   24.3359839  29.81530  -34.32463  82.454090
[131,]  -50.2710803  28.67249 -104.66365   7.774124
[132,]   12.4341343  28.09378  -43.66569  66.471539
[133,]   26.4717440  27.33627  -26.03516  79.781460
[134,]   32.7604368  26.70148  -19.76899  84.333637
[135,]   20.9201755  26.87090  -33.35591  72.015494
[136,]   10.8658526  27.47758  -43.50789  64.028618
[137,]   -1.1413051  27.54752  -56.27744  50.644739
[138,]  -10.2207358  27.97808  -65.61559  44.475001
[139,]   -8.4718789  28.43837  -63.75338  46.162767
[140,]   -9.9572708  29.80509  -67.96553  49.891158
[141,]   17.1669884  29.31742  -39.29623  74.139726
[142,]    2.2820528  27.92221  -51.99252  57.060470
[143,]  -20.0560392  27.91371  -75.25410  34.036293
[144,]  -10.6499150  27.66991  -63.53950  45.098126
[145,]   14.6161651  26.56718  -37.55006  66.947237
[146,]    6.0824944  27.01521  -47.50549  58.488814
[147,]  -25.1466573  27.55440  -79.17124  27.326528
[148,]   13.9632162  28.49935  -43.36697  69.637487
[149,]   -5.2773233  28.81819  -61.71090  51.586855
[150,]   10.1165603  29.07709  -48.74924  65.691461
[151,]   -0.8350391  29.32814  -57.72355  56.927605
[152,]   -7.6492626  27.94883  -64.74616  46.296515
[153,]  -17.4966392  28.02030  -71.68834  37.323640
[154,]  -30.6466168  27.62279  -84.44498  25.673794
[155,]  -20.1903658  27.39720  -74.92141  32.929729
[156,]   41.8368921  27.26326  -11.00347  95.467949
[157,]  -35.3461847  27.33174  -88.76480  17.838721
[158,]   14.6831458  28.30525  -40.27206  68.688003
[159,]   18.5086911  28.30154  -36.47609  74.580082
[160,]   10.2437656  29.89362  -48.62918  67.573491
[161,]   17.8927224  28.72191  -40.31349  72.285503
[162,]   11.0336148  28.74892  -46.88254  67.341872
[163,]    7.1435915  27.74602  -44.85051  62.460477
[164,]    0.4498292  27.16350  -53.31149  54.822987
[165,]  -10.5246283  27.21640  -63.37599  42.245345
[166,]  -14.8709630  27.52886  -69.00393  38.612499
[167,]  -50.1143044  27.20609 -103.62607   1.822146
[168,]  -14.8025629  27.96758  -68.94844  39.608129
[169,]   22.7189143  28.57943  -32.65692  79.873803
[170,]   31.7548499  29.32920  -25.23891  89.897077
[171,]    6.3778728  29.16174  -49.65791  64.324446
[172,]   -1.8783164  28.02745  -57.07092  53.617102
[173,]   10.7659834  27.97424  -45.69777  64.613944
[174,]   10.8340850  26.98231  -42.73654  64.521094
[175,]  -24.2579589  27.00160  -77.58845  28.109814
[176,]    7.1922399  27.26434  -44.86523  59.921978
[177,]   -0.8957582  27.33748  -54.27193  53.071688
[178,]   -2.3378172  28.22581  -57.57930  52.672556
[179,]   11.2955044  28.68908  -45.22775  65.985473
[180,]   -5.2917678  29.89668  -62.96525  53.027920</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.6
p_loo        19.9  3.6
looic      1770.5 29.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1493      
 (0.5, 0.7]   (ok)         1    0.6%   473       
   (0.7, 1]   (bad)        1    0.6%   36        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.9 22.5
p_loo        34.6  8.7
looic      1723.7 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   471       
 (0.5, 0.7]   (ok)         4    2.2%   1195      
   (0.7, 1]   (bad)        3    1.7%   11        
   (1, Inf)   (very bad)   1    0.6%   9         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.4      11.6  
fit_sleep1 -91.5      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.6
p_loo        19.9  3.6
looic      1770.5 29.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1493      
 (0.5, 0.7]   (ok)         1    0.6%   473       
   (0.7, 1]   (bad)        1    0.6%   36        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.9 22.5
p_loo        34.6  8.7
looic      1723.7 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   471       
 (0.5, 0.7]   (ok)         4    2.2%   1195      
   (0.7, 1]   (bad)        3    1.7%   11        
   (1, Inf)   (very bad)   1    0.6%   9         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.9     22.5        34.6    8.7   1723.7
fit_sleep2  -23.4      11.6  -885.3     14.6        19.9    3.6   1770.5
fit_sleep1  -91.5      21.2  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   45.1  
fit_sleep2   29.1  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.787142e-40 6.836548e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(
  set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
  set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
  set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))

bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0      2.9      1.57     0.29     5.38       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0     -0.1      1.57    -3.26     2.98       5.44      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.20.1         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-1       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.3       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.1       rmarkdown_2.24      
 [22] markdown_1.8         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.40            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.1          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.1         tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.2          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.5         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.29              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.3        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.3.0   mvtnorm_1.2-3       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.3          V8_4.3.3            
 [94] gtable_0.3.4         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.6     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoCiAgc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogIHNldF9wcmlvcigibGtqKDIpIiwgY2xhc3MgPSAiY29yIikpCgpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
