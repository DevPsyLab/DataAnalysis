<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.85      6.95    15.36    43.04 1.00     1523     2323
sd(Days)                6.57      1.49     4.16    10.03 1.00     1389     1628
cor(Intercept,Days)     0.08      0.30    -0.49     0.67 1.01     1117     1511

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.48      7.45   236.71   265.86 1.00     1987     2287
Days         10.36      1.68     6.94    13.65 1.00     1564     1923

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.56    23.08    29.15 1.00     3603     2665

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9647  13.17165 227.5527 278.3159
309 211.1512  13.61972 185.0505 237.5492
310 212.9339  12.87293 187.3619 238.0067
330 274.6703  13.19654 249.5541 301.6196
331 273.0719  13.33539 247.9036 300.0900
332 260.4624  12.28960 237.2281 285.2857
333 267.9867  12.70588 243.6949 294.2606
334 244.4722  11.95181 221.1837 266.5337
335 250.6717  13.17481 225.0537 276.7823
337 285.6087  13.50223 259.6284 312.5970
349 226.8060  12.82598 200.5460 250.9083
350 238.7826  13.52098 211.6275 264.7079
351 255.7867  11.84120 232.3495 279.9894
352 271.9064  12.29025 248.8946 296.0623
369 254.5489  12.12476 230.7459 278.6211
370 226.8023  13.62530 199.7832 253.2386
371 252.5459  12.56095 227.6862 277.4929
372 263.6121  12.39981 239.5672 289.1256

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5901298  2.529244 14.8751582 24.704107
309  1.8139375  2.560352 -3.1903466  7.064386
310  4.9377959  2.469996  0.1178956  9.733913
330  5.7423732  2.487160  0.8157250 10.466268
331  7.4754197  2.533366  2.3187432 12.420532
332 10.1745638  2.335272  5.5043417 14.638800
333 10.2932423  2.399610  5.5099599 15.059020
334 11.4752579  2.305348  7.0499950 16.054967
335 -0.2469107  2.552823 -5.1633559  4.727811
337 19.1476107  2.575219 13.9674871 24.042296
349 11.5107246  2.428197  6.8381382 16.262284
350 17.0224556  2.562467 12.1760824 22.192685
351  7.4896957  2.279751  3.0661978 11.874027
352 14.0474794  2.332694  9.5349782 18.629313
369 11.3698176  2.322569  6.7700651 16.045111
370 15.0878119  2.532579 10.0723607 20.041196
371  9.3996401  2.388583  4.7492075 14.107847
372 11.7611177  2.394297  7.0217138 16.567966</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9647 13.171653 227.5527 278.3159
  [2,] 273.5548 11.233966 251.3788 294.4856
  [3,] 293.1450  9.576309 274.1950 311.2203
  [4,] 312.7351  8.366812 296.2360 328.5354
  [5,] 332.3252  7.816363 316.9966 347.3618
  [6,] 351.9154  8.061121 336.0100 367.3006
  [7,] 371.5055  9.036700 353.7351 388.8045
  [8,] 391.0956 10.542124 370.4319 411.7360
  [9,] 410.6857 12.385676 386.5881 434.8892
 [10,] 430.2759 14.438410 402.2724 459.1603
 [11,] 211.1512 13.619717 185.0505 237.5492
 [12,] 212.9651 11.641662 190.4400 235.1625
 [13,] 214.7790  9.933313 195.3474 233.9915
 [14,] 216.5930  8.655860 199.5424 233.3354
 [15,] 218.4069  8.017976 202.6044 234.0664
 [16,] 220.2208  8.170848 204.0474 235.9461
 [17,] 222.0348  9.074601 204.0040 239.7262
 [18,] 223.8487 10.537780 203.0044 244.2342
 [19,] 225.6627 12.363335 201.2174 249.8413
 [20,] 227.4766 14.414232 199.0540 256.0167
 [21,] 212.9339 12.872935 187.3619 238.0067
 [22,] 217.8717 11.029464 196.0363 239.6370
 [23,] 222.8095  9.475625 204.0814 241.6332
 [24,] 227.7473  8.374223 211.0651 244.3920
 [25,] 232.6851  7.916409 217.3368 248.3042
 [26,] 237.6229  8.210554 221.7698 253.8327
 [27,] 242.5607  9.184695 224.8304 260.9018
 [28,] 247.4985 10.653911 226.5446 268.5149
 [29,] 252.4363 12.444065 227.7423 276.7025
 [30,] 257.3740 14.436255 228.5882 285.3560
 [31,] 274.6703 13.196540 249.5541 301.6196
 [32,] 280.4127 11.321972 258.6437 303.4132
 [33,] 286.1551  9.726117 267.3563 305.3226
 [34,] 291.8975  8.566189 275.0873 308.7383
 [35,] 297.6398  8.033291 281.8074 313.3113
 [36,] 303.3822  8.249840 287.4190 319.3558
 [37,] 309.1246  9.162854 291.3142 326.7829
 [38,] 314.8670 10.593766 293.9492 335.0961
 [39,] 320.6093 12.364052 296.6051 344.2442
 [40,] 326.3517 14.348645 298.4173 353.7377
 [41,] 273.0719 13.335386 247.9036 300.0900
 [42,] 280.5473 11.365112 259.0957 303.6091
 [43,] 288.0227  9.661000 269.9994 307.6881
 [44,] 295.4981  8.386892 279.5955 311.9611
 [45,] 302.9736  7.757633 288.0707 318.1031
 [46,] 310.4490  7.928284 295.5184 325.9456
 [47,] 317.9244  8.852705 300.8497 335.5258
 [48,] 325.3998 10.330487 305.4961 345.8509
 [49,] 332.8752 12.161556 309.3172 357.4409
 [50,] 340.3507 14.209989 312.9497 369.2407
 [51,] 260.4624 12.289605 237.2281 285.2857
 [52,] 270.6369 10.556461 250.4985 291.6363
 [53,] 280.8115  9.096723 263.4061 299.1720
 [54,] 290.9861  8.060325 275.4708 307.2692
 [55,] 301.1606  7.621963 286.5059 316.5356
 [56,] 311.3352  7.882055 296.1059 326.7904
 [57,] 321.5098  8.778739 304.2903 338.8089
 [58,] 331.6843 10.144591 312.0139 351.4821
 [59,] 341.8589 11.818045 319.1826 364.9828
 [60,] 352.0334 13.686732 325.5835 378.8045
 [61,] 267.9867 12.705879 243.6949 294.2606
 [62,] 278.2800 10.902981 257.4223 300.3725
 [63,] 288.5732  9.371602 270.8004 307.5631
 [64,] 298.8665  8.264084 283.0918 315.4700
 [65,] 309.1597  7.763989 293.8303 324.7334
 [66,] 319.4530  7.986251 303.7885 335.3752
 [67,] 329.7462  8.876776 312.1358 347.2395
 [68,] 340.0394 10.263058 319.5904 360.6918
 [69,] 350.3327 11.974131 326.5803 373.8858
 [70,] 360.6259 13.890484 333.5699 387.5276
 [71,] 244.4722 11.951813 221.1837 266.5337
 [72,] 255.9474 10.292146 235.5617 274.9142
 [73,] 267.4227  8.924123 249.7617 284.1086
 [74,] 278.8980  7.998808 263.0315 293.8607
 [75,] 290.3732  7.677965 275.2046 305.0615
 [76,] 301.8485  8.034341 286.0393 317.3209
 [77,] 313.3237  8.987734 295.7920 330.6804
 [78,] 324.7990 10.374843 304.0486 344.9990
 [79,] 336.2743 12.046769 312.0209 359.7081
 [80,] 347.7495 13.901121 320.0455 374.9858
 [81,] 250.6717 13.174810 225.0537 276.7823
 [82,] 250.4248 11.229742 228.5815 272.6893
 [83,] 250.1779  9.574571 231.4149 268.9681
 [84,] 249.9310  8.382811 233.4775 266.5949
 [85,] 249.6841  7.867938 234.2380 265.0625
 [86,] 249.4372  8.159117 233.4671 265.2501
 [87,] 249.1902  9.179964 231.2948 266.9228
 [88,] 248.9433 10.724090 228.0321 269.6990
 [89,] 248.6964 12.600566 224.0229 273.1023
 [90,] 248.4495 14.682515 219.4067 277.3341
 [91,] 285.6087 13.502233 259.6284 312.5970
 [92,] 304.7564 11.536266 282.6783 327.3536
 [93,] 323.9040  9.855155 304.9119 343.4828
 [94,] 343.0516  8.627064 326.5295 360.4102
 [95,] 362.1992  8.061756 346.4481 378.0646
 [96,] 381.3468  8.295847 365.1941 397.4895
 [97,] 400.4944  9.268968 382.4523 418.3137
 [98,] 419.6420 10.782855 398.5664 440.2903
 [99,] 438.7896 12.644749 413.9561 462.8847
[100,] 457.9372 14.723209 428.9764 486.3965
[101,] 226.8060 12.825976 200.5460 250.9083
[102,] 238.3167 11.003408 216.0674 259.0319
[103,] 249.8274  9.457093 230.9789 267.6901
[104,] 261.3382  8.342093 244.8202 277.2889
[105,] 272.8489  7.844534 257.5708 287.8807
[106,] 284.3596  8.079307 268.9335 299.9894
[107,] 295.8703  8.989213 278.4640 313.5097
[108,] 307.3811 10.398510 287.2503 327.8348
[109,] 318.8918 12.134428 295.0105 342.3970
[110,] 330.4025 14.076646 302.8063 357.7797
[111,] 238.7826 13.520981 211.6275 264.7079
[112,] 255.8051 11.538355 232.2465 277.7710
[113,] 272.8275  9.827657 252.8078 291.8971
[114,] 289.8500  8.553625 272.5803 306.5251
[115,] 306.8724  7.929606 291.1214 322.6912
[116,] 323.8949  8.107113 307.8266 339.7195
[117,] 340.9173  9.039048 323.2341 358.4876
[118,] 357.9398 10.526916 337.5503 378.3630
[119,] 374.9623 12.371743 350.9231 399.0369
[120,] 391.9847 14.437332 363.9523 420.2260
[121,] 255.7867 11.841200 232.3495 279.9894
[122,] 263.2764 10.212270 242.7961 284.1879
[123,] 270.7661  8.874764 253.0850 288.5592
[124,] 278.2558  7.976649 262.3755 294.0006
[125,] 285.7455  7.673785 270.5299 300.7776
[126,] 293.2352  8.033775 277.5960 309.4435
[127,] 300.7249  8.977229 282.9136 318.9555
[128,] 308.2146 10.345736 288.2761 328.8914
[129,] 315.7043 11.994683 292.4089 339.5563
[130,] 323.1940 13.824077 296.4076 350.5143
[131,] 271.9064 12.290251 248.8946 296.0623
[132,] 285.9539 10.607526 265.8548 307.1689
[133,] 300.0014  9.212592 282.2069 318.3353
[134,] 314.0488  8.252699 298.0618 330.5500
[135,] 328.0963  7.888291 312.6019 343.4527
[136,] 342.1438  8.199156 325.6109 358.3324
[137,] 356.1913  9.116474 338.1604 374.4024
[138,] 370.2388 10.482221 349.5579 391.2149
[139,] 384.2862 12.146059 360.4246 408.5236
[140,] 398.3337 14.002123 371.1597 425.8343
[141,] 254.5489 12.124756 230.7459 278.6211
[142,] 265.9187 10.441654 245.4126 286.7428
[143,] 277.2885  9.046282 259.5044 295.2620
[144,] 288.6584  8.088941 272.5151 304.3272
[145,] 300.0282  7.734038 284.7860 314.8366
[146,] 311.3980  8.061537 295.6143 326.7616
[147,] 322.7678  8.997226 304.7681 340.1555
[148,] 334.1376 10.377881 313.5518 354.2941
[149,] 345.5074 12.051531 321.9085 369.3719
[150,] 356.8773 13.912837 329.5532 384.2587
[151,] 226.8023 13.625296 199.7832 253.2386
[152,] 241.8901 11.686182 218.7091 264.9224
[153,] 256.9779 10.015634 237.3941 277.0113
[154,] 272.0658  8.768518 255.0097 289.5944
[155,] 287.1536  8.141794 271.6138 302.8688
[156,] 302.2414  8.277597 286.0190 318.2288
[157,] 317.3292  9.142009 299.3818 335.1480
[158,] 332.4170 10.557555 311.4498 353.0594
[159,] 347.5048 12.335944 322.6782 371.4909
[160,] 362.5926 14.342837 333.6612 390.3701
[161,] 252.5459 12.560946 227.6862 277.4929
[162,] 261.9456 10.802013 240.9252 283.5283
[163,] 271.3452  9.327393 253.5378 289.8791
[164,] 280.7448  8.290216 264.7239 297.4861
[165,] 290.1445  7.865479 274.8756 305.7486
[166,] 299.5441  8.149508 283.5632 314.7611
[167,] 308.9438  9.076005 291.0185 326.2728
[168,] 318.3434 10.475873 297.7671 338.4960
[169,] 327.7430 12.187067 303.6161 351.6770
[170,] 337.1427 14.096665 309.3910 364.4743
[171,] 263.6121 12.399806 239.5672 289.1256
[172,] 275.3732 10.651201 254.8269 296.8993
[173,] 287.1343  9.198169 269.7329 305.9536
[174,] 298.8954  8.199382 283.0609 315.1027
[175,] 310.6566  7.830628 295.5140 325.7152
[176,] 322.4177  8.177586 306.3937 338.1896
[177,] 334.1788  9.159280 316.4402 352.6555
[178,] 345.9399 10.600813 325.3863 366.9153
[179,] 357.7010 12.342097 333.6613 382.6126
[180,] 369.4622 14.273851 342.1909 398.3396</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.4047100 13.171653  -28.75589681  22.0072830
  [2,]  -14.8501398 11.233966  -35.78091472   7.3259110
  [3,]  -42.3443696  9.576309  -60.41974485 -23.3944192
  [4,]    8.7047007  8.366812   -7.09564977  25.2037734
  [5,]   24.5266709  7.816363    9.49006752  39.8553009
  [6,]   62.7747411  8.061121   47.38948214  78.6800803
  [7,]   10.6983114  9.036700   -6.60073667  28.4687164
  [8,] -100.9470184 10.542124 -121.58744543 -80.2833130
  [9,]   19.8995519 12.385676   -4.30394904  43.9972474
 [10,]   36.0776221 14.438410    7.19318607  64.0811201
 [11,]   11.5827436 13.619717  -14.81526919  37.6833698
 [12,]   -7.6992939 11.641662  -29.89673218  14.8257813
 [13,]  -11.8012315  9.933313  -31.01366079   7.6304384
 [14,]  -11.8859690  8.655860  -28.62837425   5.1646154
 [15,]  -10.6908066  8.017976  -26.35030750   5.1117409
 [16,]   -4.2590441  8.170848  -19.98426407  11.9144443
 [17,]   -8.4044816  9.074601  -26.09589784   9.6263216
 [18,]   -6.1215192 10.537780  -26.50702538  14.7227751
 [19,]   -1.3669567 12.363335  -25.54564756  23.0783496
 [20,]    9.8376057 14.414232  -18.70254634  38.2602479
 [21,]  -13.8799842 12.872935  -38.95275278  11.6919814
 [22,]  -23.5394800 11.029464  -45.30481349  -1.7041052
 [23,]   11.5105241  9.475625   -7.31319375  30.2385637
 [24,]    5.0943282  8.374223  -11.55036012  21.7765348
 [25,]   -3.3776677  7.916409  -18.99680894  11.9706249
 [26,]  -17.1649636  8.210554  -33.37481488  -1.3118849
 [27,]   -7.1398594  9.184695  -25.48098917  10.5904191
 [28,]    8.2526447 10.653911  -12.76375027  29.2064883
 [29,]    8.5762488 12.444065  -15.68998507  33.2701651
 [30,]   -9.8587471 14.436255  -37.84070513  18.9271028
 [31,]   46.8722622 13.196540   19.92296036  71.9884635
 [32,]   19.9874890 11.321972   -3.01297623  41.7564853
 [33,]   -2.2985842  9.726117  -21.46607668  16.5002245
 [34,]   -6.7644574  8.566189  -23.60531896  10.0456811
 [35,]  -11.8425306  8.033291  -27.51398435   3.9898728
 [36,]   -5.7967038  8.249840  -21.77031953  10.1665097
 [37,]  -28.8849770  9.162854  -46.54325862 -11.0745916
 [38,]    3.3943498 10.593766  -16.83484942  24.3121334
 [39,]  -15.2598234 12.364052  -38.89470732   8.7443545
 [40,]   27.6970034 14.348645    0.31101328  55.6313562
 [41,]   14.5360243 13.335386  -12.48208045  39.7043437
 [42,]    4.4527047 11.365112  -18.60914458  25.9043300
 [43,]   13.7978850  9.661000   -5.86753773  31.8211798
 [44,]   24.6171654  8.386892    8.15419823  40.5198093
 [45,]   13.3037457  7.757633   -1.82582896  28.2066273
 [46,]  -17.1302740  7.928284  -32.62687344  -2.1996899
 [47,]  -27.8493936  8.852705  -45.45081326 -10.7746849
 [48,]    9.4178867 10.330487  -11.03317984  29.3216229
 [49,]  -39.1283330 12.161556  -63.69397619 -15.5702765
 [50,]   31.2304474 14.209989    2.34041140  58.6313789
 [51,]  -25.6017729 12.289605  -50.42505861  -2.3675079
 [52,]  -27.8251368 10.556461  -48.82454516  -7.6866652
 [53,]   -7.8502006  9.096723  -26.21073709   9.5552442
 [54,]   18.7827356  8.060325    2.49956072  34.2979836
 [55,]   16.3022717  7.621963    0.92726277  30.9570011
 [56,]   -1.3375921  7.882055  -16.79275028  13.8917192
 [57,]  132.6521440  8.778739  115.35297959 149.8715548
 [58,]   15.1467802 10.144591   -4.65099536  34.8172201
 [59,]  -11.5585836 11.818045  -34.68248081  11.1177098
 [60,]  -98.1690475 13.686732 -124.94012313 -71.7191392
 [61,]   15.8556561 12.705879  -10.41824580  40.1475478
 [62,]   11.2750138 10.902981  -10.81752673  32.1327283
 [63,]  -11.8039285  9.371602  -30.79375696   5.9688844
 [64,]    0.9432292  8.264084  -15.66027538  16.7178883
 [65,]  -11.9887131  7.763989  -27.56239260   3.3406863
 [66,]   18.7135446  7.986251    2.79125654  34.3779797
 [67,]    2.2803023  8.876776  -15.21299662  19.8907173
 [68,]    8.8004600 10.263058  -11.85186461  29.2494508
 [69,]  -16.9726823 11.974131  -40.52578216   6.7796855
 [70,]    1.4168753 13.890484  -25.48479609  28.4728539
 [71,]   21.0009099 11.951813   -1.06061525  44.2894376
 [72,]   20.2537519 10.292146    1.28704591  40.6395166
 [73,]  -24.0580060  8.924123  -40.74387791  -6.3969789
 [74,]  -24.2256639  7.998808  -39.18835434  -8.3591944
 [75,]  -11.3488218  7.677965  -26.03714277   3.8198245
 [76,]  -17.6572797  8.034341  -33.12967550  -1.8481371
 [77,]   -7.7989376  8.987734  -25.15562764   9.7328225
 [78,]    6.7239044 10.374843  -13.47612081  27.4743102
 [79,]   -0.5273535 12.046769  -23.96118913  23.7260244
 [80,]   29.5494886 13.901121    2.31316347  57.2535225
 [81,]   -9.0634049 13.174810  -35.17401541  16.5546289
 [82,]   23.5224058 11.229742    1.25790793  45.3657094
 [83,]    4.3128164  9.574571  -14.47743622  23.0757579
 [84,]   20.8711271  8.382811    4.20717460  37.3246304
 [85,]    1.7678378  7.867938  -13.61061494  17.2139091
 [86,]    5.1990485  8.159117  -10.61394979  21.1690812
 [87,]   -3.7379409  9.179964  -21.47054923  14.1574622
 [88,]  -13.6323302 10.724090  -34.38796279   7.2788880
 [89,]  -12.9423195 12.600566  -37.34824536  11.7311708
 [90,]  -11.2029088 14.682515  -40.08750312  17.8399117
 [91,]   26.7578528 13.502233   -0.23044635  52.7381804
 [92,]    9.0494421 11.536266  -13.54784820  31.1274737
 [93,]  -32.2927686  9.855155  -51.87163841 -13.3007026
 [94,]    3.0706207  8.627064  -14.28800864  19.5926570
 [95,]    3.5332100  8.061756  -12.33220032  19.2843422
 [96,]   10.4916993  8.295847   -5.65095847  26.6443694
 [97,]    3.7656886  9.268968  -14.05364575  21.8078245
 [98,]   -2.9497221 10.782855  -23.59802060  18.1259002
 [99,]   17.0746671 12.644749   -7.02043603  41.9082339
[100,]    0.9794564 14.723209  -27.47983915  29.9403143
[101,]    9.2972144 12.825976  -14.80511816  35.5571582
[102,]   -8.0000103 11.003408  -28.71519158  14.2492827
[103,]  -10.9018349  9.457093  -28.76450781   7.9467333
[104,]   -6.4161595  8.342093  -22.36689173  10.1018338
[105,]  -22.1385841  7.844534  -37.17044566  -6.8604517
[106,]  -14.5852087  8.079307  -30.21495712   0.8408733
[107,]  -14.3055333  8.989213  -31.94489754   3.1007785
[108,]    0.7209421 10.398510  -19.73284438  20.8517307
[109,]   17.3888175 12.134428   -6.11639369  41.2701492
[110,]   21.2425929 14.076646   -6.13462054  48.8388088
[111,]   17.5141950 13.520981   -8.41106605  44.6693302
[112,]  -12.3507606 11.538355  -34.31673103  11.2077701
[113,]  -16.6229163  9.827657  -35.69248985   3.3968452
[114,]  -34.3228719  8.553625  -50.99800903 -17.0531840
[115,]  -37.9559276  7.929606  -53.77470793 -22.2048699
[116,]    5.8298168  8.107113   -9.99476987  21.8980602
[117,]   38.5271611  9.039048   20.95687162  56.2103755
[118,]    4.9786055 10.526916  -15.44464719  25.3680983
[119,]   19.5249498 12.371743   -4.54968109  43.5641254
[120,]   -2.9320058 14.437332  -31.17328474  25.1004074
[121,]   -5.2602018 11.841200  -29.46292788  18.1770156
[122,]   36.7812025 10.212270   15.86969577  57.2615282
[123,]   -0.8721931  8.874764  -18.66529237  16.8089095
[124,]    2.3333112  7.976649  -13.41148024  18.2136106
[125,]  -13.9180845  7.673785  -28.95023114   1.2974873
[126,]   11.3984198  8.033775   -4.80987243  27.0376002
[127,]  -12.9782759  8.977229  -31.20889930   4.8330405
[128,]  -41.6190716 10.345736  -62.29589567 -21.6805620
[129,]    5.8375327 11.994683  -18.01453087  29.1328578
[130,]   24.3715370 13.824077   -2.94877746  51.1579302
[131,]  -50.2292996 12.290251  -74.38523184 -27.2175031
[132,]   12.2400210 10.607526   -8.97504721  32.3391102
[133,]   26.8771416  9.212592    8.54322542  44.6716218
[134,]   32.8066622  8.252699   16.30553425  48.7937116
[135,]   20.6438828  7.888291    5.28752444  36.1382858
[136,]   10.6849034  8.199156   -5.50374687  27.2177863
[137,]   -1.7646760  9.116474  -19.97584715  16.2662183
[138,]   -9.8061554 10.482221  -30.78227526  10.8747023
[139,]   -8.6456348 12.146059  -32.88299983  15.2159754
[140,]   -9.7920142 14.002123  -37.29256711  17.3819588
[141,]   17.3745905 12.124756   -6.69759373  41.1775792
[142,]    2.5181730 10.441654  -18.30589008  23.0243166
[143,]  -20.0461446  9.046282  -38.01960264  -2.2619714
[144,]  -11.0017621  8.088941  -26.67061043   5.1415337
[145,]   14.7940203  7.734038   -0.01442479  30.0361516
[146,]    5.8155027  8.061537   -9.54813360  21.5991963
[147,]  -24.6325148  8.997226  -42.02019239  -6.6327984
[148,]   13.9852676 10.377881   -6.17116357  34.5711415
[149,]   -5.2274499 12.051531  -29.09194061  18.3714583
[150,]    9.6358325 13.912837  -17.74564288  36.9599024
[151,]   -1.5383154 13.625296  -27.97459752  25.4807716
[152,]   -7.3666272 11.686182  -30.39888012  15.8144328
[153,]  -18.0771391 10.015634  -38.11045307   1.5066901
[154,]  -31.5927509  8.768518  -49.12142182 -14.5367119
[155,]  -19.6162628  8.141794  -35.33147862  -4.0765485
[156,]   41.9523254  8.277597   25.96490529  58.1746572
[157,]  -36.1810865  9.142009  -53.99987357 -18.2336605
[158,]   15.1685016 10.557555   -5.47387762  36.1357088
[159,]   17.6581898 12.335944   -6.32792378  42.4848425
[160,]    9.6361779 14.342837  -18.14126182  38.5675958
[161,]   17.3344780 12.560946   -7.61251423  42.1941736
[162,]   10.4972379 10.802013  -11.08547770  31.5176373
[163,]    6.5536977  9.327393  -11.98015575  24.3610692
[164,]    1.0446576  8.290216  -15.69659217  17.0656166
[165,]  -10.9739825  7.865479  -26.57809779   4.2948517
[166,]  -15.0321226  8.149508  -30.24905068   0.9487566
[167,]  -49.6779627  9.076005  -67.00698528 -31.7526708
[168,]  -13.7128029 10.475873  -33.86536501   6.8634745
[169,]   23.0376570 12.187067   -0.89626983  47.1646480
[170,]   32.3265169 14.096665    4.99493972  60.0781842
[171,]    5.7996053 12.399806  -19.71394081  29.8444925
[172,]   -1.8992124 10.651201  -23.42526526  18.6471473
[173,]   10.4624699  9.198169   -8.35681102  27.8638683
[174,]   11.7361523  8.199382   -4.47108600  27.5707026
[175,]  -23.4839654  7.830628  -38.54260623  -8.3413661
[176,]    7.1899170  8.177586   -8.58204488  23.2139280
[177,]    0.3029993  9.159280  -18.17365486  18.0416002
[178,]   -2.7200184 10.600813  -23.69538220  17.8336493
[179,]   11.4406640 12.342097  -13.47085943  35.4804189
[180,]   -5.3385537 14.273851  -34.21604262  21.9327393</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.3
p_loo        19.3  3.2
looic      1769.6 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.1 21.9
p_loo        32.8  7.8
looic      1720.2 43.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   805       
 (0.5, 0.7]   (ok)         6    3.3%   973       
   (0.7, 1]   (bad)        4    2.2%   35        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.7      11.2  
fit_sleep1 -93.2      20.5  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.3
p_loo        19.3  3.2
looic      1769.6 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.1 21.9
p_loo        32.8  7.8
looic      1720.2 43.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   805       
 (0.5, 0.7]   (ok)         6    3.3%   973       
   (0.7, 1]   (bad)        4    2.2%   35        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.1     21.9        32.8    7.8   1720.2
fit_sleep2  -24.7      11.2  -884.8     14.3        19.3    3.2   1769.6
fit_sleep1  -93.2      20.5  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   43.8  
fit_sleep2   28.7  
fit_sleep1   21.1  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
3.265243e-41 1.826805e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.96      1.56     0.32     5.43       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.04      1.56    -3.27     2.94       5.11      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.5      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.3         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.1       pkgbuild_1.4.1       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.0        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.0         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.0           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.31       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
