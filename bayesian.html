<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.94      6.83    15.54    41.92 1.00     1756     2204
sd(Days)                6.44      1.46     4.12     9.74 1.00     1541     2421
cor(Intercept,Days)     0.10      0.30    -0.46     0.68 1.00     1000     1775

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.09      7.50   236.15   266.50 1.00     1806     2607
Days         10.36      1.67     7.02    13.56 1.00     1493     2367

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.93      1.54    23.15    29.22 1.00     3304     2842

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.1894  13.04668 228.9480 279.9090
309 211.2060  12.97327 186.1599 236.9767
310 212.6624  13.03187 186.5338 237.6987
330 274.2159  13.27439 249.7350 300.5534
331 273.1027  12.87799 248.9766 298.8046
332 260.5365  12.07011 237.2616 284.6576
333 267.9408  12.28292 244.0881 292.3502
334 244.1802  12.05979 219.7851 267.0329
335 250.0018  13.35416 224.5556 276.8729
337 286.1633  13.10942 260.7245 312.1127
349 226.7161  13.00768 199.9913 251.0481
350 238.9700  12.84230 213.7852 263.2098
351 255.4386  12.61228 231.1108 280.4886
352 271.9277  12.66898 247.9508 297.6604
369 254.7810  12.38017 229.9725 279.4763
370 226.3241  13.71904 199.6335 252.8723
371 252.3133  12.24832 228.2065 276.8513
372 263.3675  12.58512 238.0505 288.4485

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6006958  2.488730 14.9047161 24.564188
309  1.8214827  2.488071 -3.1265964  6.760000
310  4.9946586  2.476258  0.1247685  9.908121
330  5.7688878  2.557015  0.5162270 10.569108
331  7.4551372  2.477480  2.4890475 12.228982
332 10.1961216  2.305857  5.7225975 14.686972
333 10.3121533  2.345542  5.6102886 14.885964
334 11.5758416  2.312246  7.1927467 16.239989
335 -0.1216092  2.601590 -5.3033951  4.903384
337 19.1086806  2.492851 14.2529337 24.048933
349 11.5469282  2.453238  6.7992700 16.499907
350 16.9652758  2.469329 12.2736343 21.811548
351  7.5772433  2.407827  2.7124501 12.245415
352 14.0954544  2.360688  9.5162232 18.629001
369 11.2898976  2.349650  6.6540890 16.010954
370 15.1516069  2.570244 10.2695338 20.231817
371  9.4571690  2.342411  4.8084378 14.104164
372 11.8330610  2.402976  7.0160340 16.456277</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.1894 13.046681 228.9480 279.9090
  [2,] 273.7901 11.173981 251.9249 295.9428
  [3,] 293.3908  9.585791 274.6644 312.5167
  [4,] 312.9915  8.444197 296.3300 329.9563
  [5,] 332.5922  7.944124 317.0124 348.2815
  [6,] 352.1929  8.203737 336.2324 367.7925
  [7,] 371.7936  9.158659 353.7358 389.2430
  [8,] 391.3943 10.623010 370.8366 411.9057
  [9,] 410.9949 12.417858 386.6363 435.4249
 [10,] 430.5956 14.420319 403.1483 459.2791
 [11,] 211.2060 12.973274 186.1599 236.9767
 [12,] 213.0275 11.139318 191.4024 234.9702
 [13,] 214.8490  9.604372 196.1637 233.4542
 [14,] 216.6705  8.531384 200.0912 233.4385
 [15,] 218.4920  8.105928 202.6284 234.4875
 [16,] 220.3134  8.426662 203.9980 236.7882
 [17,] 222.1349  9.417652 203.7356 240.5633
 [18,] 223.9564 10.897556 202.6506 245.0192
 [19,] 225.7779 12.696545 201.0144 250.7567
 [20,] 227.5994 14.697918 198.5694 256.4729
 [21,] 212.6624 13.031869 186.5338 237.6987
 [22,] 217.6570 11.178864 195.5628 239.2027
 [23,] 222.6517  9.610833 204.1283 241.0862
 [24,] 227.6463  8.487220 211.1919 244.3611
 [25,] 232.6410  7.997588 216.6201 248.5856
 [26,] 237.6357  8.255522 221.0852 253.8867
 [27,] 242.6303  9.198345 224.1249 260.3224
 [28,] 247.6250 10.645618 225.8687 267.9997
 [29,] 252.6196 12.422259 227.4084 276.6674
 [30,] 257.6143 14.406927 228.7652 285.8559
 [31,] 274.2159 13.274393 249.7350 300.5534
 [32,] 279.9848 11.327175 258.8815 302.2350
 [33,] 285.7537  9.668348 267.5615 304.8660
 [34,] 291.5226  8.469100 275.5187 308.2090
 [35,] 297.2915  7.940467 281.3441 312.2961
 [36,] 303.0604  8.212980 286.6790 318.4064
 [37,] 308.8293  9.215840 290.4831 326.7956
 [38,] 314.5982 10.746489 293.4732 335.8561
 [39,] 320.3670 12.614238 295.7756 345.3430
 [40,] 326.1359 14.691073 297.1164 355.1108
 [41,] 273.1027 12.877990 248.9766 298.8046
 [42,] 280.5579 11.026318 260.0207 302.7511
 [43,] 288.0130  9.465335 270.0196 306.8624
 [44,] 295.4681  8.359501 279.2618 312.1181
 [45,] 302.9233  7.902264 287.1555 318.7780
 [46,] 310.3784  8.202810 294.0326 326.3031
 [47,] 317.8336  9.187068 299.5718 335.7437
 [48,] 325.2887 10.667434 304.6749 345.8431
 [49,] 332.7438 12.468437 307.7543 356.6260
 [50,] 340.1990 14.470849 310.9217 367.8747
 [51,] 260.5365 12.070109 237.2616 284.6576
 [52,] 270.7327 10.439478 250.2554 291.6146
 [53,] 280.9288  9.105594 263.1857 298.8449
 [54,] 291.1249  8.214312 275.2170 307.1697
 [55,] 301.3210  7.916563 286.1656 316.6399
 [56,] 311.5172  8.276652 295.3695 327.6431
 [57,] 321.7133  9.217805 303.6873 340.0608
 [58,] 331.9094 10.586162 311.1073 352.9275
 [59,] 342.1055 12.239269 318.0455 366.3089
 [60,] 352.3016 14.077163 324.3717 379.7719
 [61,] 267.9408 12.282917 244.0881 292.3502
 [62,] 278.2529 10.576696 257.7977 299.1892
 [63,] 288.5651  9.157842 270.6461 306.3502
 [64,] 298.8772  8.177333 282.6919 314.8531
 [65,] 309.1894  7.802219 293.5392 324.2902
 [66,] 319.5015  8.116871 303.2644 335.4754
 [67,] 329.8137  9.049624 312.0145 347.5388
 [68,] 340.1258 10.436040 319.6201 360.7042
 [69,] 350.4380 12.121440 326.4712 373.7976
 [70,] 360.7501 13.998243 333.3890 387.7426
 [71,] 244.1802 12.059795 219.7851 267.0329
 [72,] 255.7560 10.420273 234.9108 275.6833
 [73,] 267.3319  9.078464 249.3129 284.6879
 [74,] 278.9077  8.182168 262.5579 294.4797
 [75,] 290.4835  7.884810 274.7930 305.9479
 [76,] 302.0594  8.251396 285.2220 318.2319
 [77,] 313.6352  9.202924 295.3921 331.8684
 [78,] 325.2111 10.582772 304.4662 346.2961
 [79,] 336.7869 12.247011 312.7419 361.0515
 [80,] 348.3628 14.095264 320.7408 376.3259
 [81,] 250.0018 13.354160 224.5556 276.8729
 [82,] 249.8802 11.386815 228.2954 272.7113
 [83,] 249.7585  9.722245 231.3306 269.1410
 [84,] 249.6369  8.539385 233.4024 266.8264
 [85,] 249.5153  8.053365 233.8874 265.4363
 [86,] 249.3937  8.386228 233.1320 265.8431
 [87,] 249.2721  9.451852 230.4454 267.7276
 [88,] 249.1505 11.040051 227.3134 270.0704
 [89,] 249.0289 12.960111 223.7914 273.7691
 [90,] 248.9073 15.085847 219.4818 278.1037
 [91,] 286.1633 13.109423 260.7245 312.1127
 [92,] 305.2719 11.214946 283.3431 327.4453
 [93,] 324.3806  9.598003 305.8248 343.2611
 [94,] 343.4893  8.420031 327.1936 359.9585
 [95,] 362.5980  7.880405 347.2925 377.8447
 [96,] 381.7067  8.107606 365.6379 397.5369
 [97,] 400.8153  9.044024 382.7344 418.1883
 [98,] 419.9240 10.501622 399.5811 440.3608
 [99,] 439.0327 12.296438 415.0723 463.1868
[100,] 458.1414 14.302074 430.2700 486.0165
[101,] 226.7161 13.007678 199.9913 251.0481
[102,] 238.2630 11.146847 215.6428 259.4134
[103,] 249.8099  9.557272 230.8133 267.8836
[104,] 261.3568  8.394488 244.9480 277.2231
[105,] 272.9038  7.850489 257.3508 288.0008
[106,] 284.4507  8.051687 268.7069 299.9256
[107,] 295.9976  8.947956 278.0662 313.0474
[108,] 307.5446 10.360449 286.7340 327.6214
[109,] 319.0915 12.109857 295.0275 343.1419
[110,] 330.6384 14.071074 302.7064 358.9568
[111,] 238.9700 12.842300 213.7852 263.2098
[112,] 255.9353 10.987917 234.2897 277.0096
[113,] 272.9006  9.420145 254.4751 290.9241
[114,] 289.8659  8.302959 273.7489 306.1222
[115,] 306.8311  7.831622 291.5814 322.0701
[116,] 323.7964  8.119399 308.1104 339.6323
[117,] 340.7617  9.094512 323.2577 358.1945
[118,] 357.7270 10.568388 337.0551 378.3067
[119,] 374.6923 12.363927 350.2981 398.5857
[120,] 391.6575 14.360979 363.1183 419.4024
[121,] 255.4386 12.612282 231.1108 280.4886
[122,] 263.0158 10.855474 241.8852 284.4407
[123,] 270.5931  9.391923 252.6649 289.1591
[124,] 278.1703  8.376777 262.2233 294.2828
[125,] 285.7476  7.982972 270.6703 301.2177
[126,] 293.3248  8.299431 277.4845 309.7629
[127,] 300.9020  9.253568 283.1491 319.4024
[128,] 308.4793 10.675756 287.5834 329.9030
[129,] 316.0565 12.406058 291.7344 340.9120
[130,] 323.6338 14.333319 295.6488 352.0602
[131,] 271.9277 12.668978 247.9508 297.6604
[132,] 286.0232 10.904964 265.6966 307.7538
[133,] 300.1186  9.406337 282.1920 318.6757
[134,] 314.2141  8.317800 298.1397 330.9380
[135,] 328.3095  7.812689 313.3302 344.0817
[136,] 342.4050  8.002257 327.0091 358.3288
[137,] 356.5004  8.841936 339.1845 374.1334
[138,] 370.5959 10.171982 351.0742 391.0516
[139,] 384.6913 11.828115 362.1726 408.1644
[140,] 398.7868 13.692520 372.4990 425.6735
[141,] 254.7810 12.380171 229.9725 279.4763
[142,] 266.0709 10.681407 244.8662 286.7492
[143,] 277.3608  9.271352 259.1922 295.4500
[144,] 288.6507  8.298506 272.6407 304.9984
[145,] 299.9406  7.925537 284.3189 315.5503
[146,] 311.2305  8.234366 294.9232 327.1036
[147,] 322.5204  9.156263 304.2448 339.9821
[148,] 333.8103 10.531440 312.8695 353.9852
[149,] 345.1002 12.207662 320.9798 368.3533
[150,] 356.3901 14.077802 328.5841 383.9554
[151,] 226.3241 13.719037 199.6335 252.8723
[152,] 241.4757 11.752882 218.4377 264.4642
[153,] 256.6273 10.062843 236.9669 276.4290
[154,] 271.7789  8.809296 254.7425 288.8454
[155,] 286.9305  8.195053 271.3366 302.9049
[156,] 302.0821  8.362200 285.8028 318.4238
[157,] 317.2337  9.268560 299.3061 335.5543
[158,] 332.3854 10.728388 311.6702 353.8756
[159,] 347.5370 12.550010 323.2022 372.7925
[160,] 362.6886 14.598612 334.5922 391.8227
[161,] 252.3133 12.248318 228.2065 276.8513
[162,] 261.7705 10.547107 240.9915 282.9805
[163,] 271.2277  9.134299 253.5417 289.2563
[164,] 280.6848  8.161075 264.7015 296.7221
[165,] 290.1420  7.793886 274.9999 305.4089
[166,] 299.5992  8.115414 283.8852 315.5682
[167,] 309.0563  9.052570 291.2193 326.8377
[168,] 318.5135 10.440875 298.1956 339.5015
[169,] 327.9707 12.126356 304.4240 351.9780
[170,] 337.4278 14.002104 310.1751 364.9280
[171,] 263.3675 12.585121 238.0505 288.4485
[172,] 275.2005 10.791662 253.7080 297.2337
[173,] 287.0336  9.278108 268.4704 305.8626
[174,] 298.8667  8.200925 282.7577 315.5134
[175,] 310.6997  7.744395 295.7667 326.2532
[176,] 322.5328  8.015280 306.7114 338.0969
[177,] 334.3658  8.947757 317.0224 351.7518
[178,] 346.1989 10.364777 326.4209 366.5723
[179,] 358.0320 12.097248 334.7683 381.5728
[180,] 369.8650 14.028786 342.9404 396.9123</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.6293827 13.046681  -30.3489581  20.6119781
  [2,]  -15.0853785 11.173981  -37.2381362   6.7798350
  [3,]  -42.5901743  9.585791  -61.7161465 -23.8638294
  [4,]    8.4483299  8.444197   -8.5165325  25.1097706
  [5,]   24.2597341  7.944124    8.5704451  39.8394638
  [6,]   62.4972383  8.203737   46.8975851  78.4576556
  [7,]   10.4102424  9.158659   -7.0392314  28.4679588
  [8,] -101.2456534 10.623010 -121.7571306 -80.6880094
  [9,]   19.5903508 12.417858   -4.8396396  43.9489576
 [10,]   35.7578550 14.420319    7.0744061  63.2051939
 [11,]   11.5278805 12.973274  -14.2428243  36.5739802
 [12,]   -7.7617022 11.139318  -29.7043694  13.8634197
 [13,]  -11.8711849  9.604372  -30.4764447   6.8140668
 [14,]  -11.9634676  8.531384  -28.7315098   4.6157829
 [15,]  -10.7758503  8.105928  -26.7713995   5.0877482
 [16,]   -4.3516330  8.426662  -20.8264192  11.9637529
 [17,]   -8.5046157  9.417652  -26.9329696   9.8947054
 [18,]   -6.2291984 10.897556  -27.2919543  15.0766461
 [19,]   -1.4821811 12.696545  -26.4609699  23.2812976
 [20,]    9.7148362 14.697918  -19.1587009  38.7448319
 [21,]  -13.6084623 13.031869  -38.6448226  12.5200646
 [22,]  -23.3248209 11.178864  -44.8705327  -1.2305626
 [23,]   11.6683205  9.610833   -6.7661911  30.1917123
 [24,]    5.1952620  8.487220  -11.5195461  21.6497282
 [25,]   -3.3335966  7.997588  -19.2782273  12.6872561
 [26,]  -17.1777552  8.255522  -33.4287864  -0.6272684
 [27,]   -7.2095138  9.198345  -24.9015774  11.2958896
 [28,]    8.1261276 10.645618  -12.2486365  29.8824227
 [29,]    8.3928690 12.422259  -15.6549417  33.6040893
 [30,]  -10.0989896 14.406927  -38.3406248  18.7500647
 [31,]   47.3266545 13.274393   20.9891819  71.8076463
 [32,]   20.4153667 11.327175   -1.8347853  41.5186994
 [33,]   -1.8972212  9.668348  -21.0095063  16.2949807
 [34,]   -6.3896090  8.469100  -23.0759719   9.6143096
 [35,]  -11.4941969  7.940467  -26.4988399   4.4532017
 [36,]   -5.4748847  8.212980  -20.8209396  10.9065031
 [37,]  -28.5896726  9.215840  -46.5559889 -10.2435256
 [38,]    3.6631396 10.746489  -17.5947902  24.7881215
 [39,]  -15.0175483 12.614238  -39.9934855   9.5738698
 [40,]   27.9127639 14.691073   -1.0621094  56.9323167
 [41,]   14.5051721 12.877990  -11.1967359  38.6312599
 [42,]    4.4421348 11.026318  -17.7510923  24.9793373
 [43,]   13.8075976  9.465335   -5.0418499  31.8009825
 [44,]   24.6471603  8.359501    7.9971720  40.8535002
 [45,]   13.3540231  7.902264   -2.5006806  29.1217600
 [46,]  -17.0597142  8.202810  -32.9844142  -0.7138850
 [47,]  -27.7585514  9.187068  -45.6687150  -9.4967900
 [48,]    9.5290113 10.667434  -11.0253536  30.1428236
 [49,]  -38.9969259 12.468437  -62.8791267 -14.0074391
 [50,]   31.3821368 14.470849    3.7063755  60.6594080
 [51,]  -25.6759445 12.070109  -49.7969884  -2.4009634
 [52,]  -27.9208661 10.439478  -48.8027569  -7.4436280
 [53,]   -7.9674876  9.105594  -25.8836444   9.7756330
 [54,]   18.6438908  8.214312    2.5991191  34.5518425
 [55,]   16.1418693  7.916563    0.8229859  31.2972559
 [56,]   -1.5195523  8.276652  -17.6454990  14.6280515
 [57,]  132.4486262  9.217805  114.1011056 150.4746012
 [58,]   14.9217046 10.586162   -6.0963902  35.7237526
 [59,]  -11.8052169 12.239269  -36.0086352  12.2547959
 [60,]  -98.4372385 14.077163 -125.9074948 -70.5073397
 [61,]   15.9016351 12.282917   -8.5078452  39.7543145
 [62,]   11.3020818 10.576696   -9.6341955  31.7572550
 [63,]  -11.7957715  9.157842  -29.5809483   6.1232205
 [64,]    0.9324752  8.177333  -15.0433742  17.1178350
 [65,]  -12.0183781  7.802219  -27.1191750   3.6317805
 [66,]   18.6649686  8.116871    2.6910701  34.9020678
 [67,]    2.2128153  9.049624  -15.5122519  20.0120217
 [68,]    8.7140620 10.436040  -11.8642729  29.2197626
 [69,]  -17.0779913 12.121440  -40.4375632   6.8888358
 [70,]    1.2926555 13.998243  -25.6998024  28.6537935
 [71,]   21.2929189 12.059795   -1.5597678  45.6880114
 [72,]   20.4451774 10.420273    0.5178586  41.2904060
 [73,]  -23.9671642  9.078464  -41.3231729  -5.9481986
 [74,]  -24.2354057  8.182168  -39.8074441  -7.8856148
 [75,]  -11.4591473  7.884810  -26.9234690   4.2314294
 [76,]  -17.8681888  8.251396  -34.0406847  -1.0307645
 [77,]   -8.1104304  9.202924  -26.3436099  10.1326926
 [78,]    6.3118281 10.582772  -14.7732137  27.0566724
 [79,]   -1.0400135 12.247011  -25.3045763  23.0049936
 [80,]   28.9362450 14.095264    0.9730566  56.5581674
 [81,]   -8.3934679 13.354160  -35.2645789  17.0526924
 [82,]   24.0670412 11.386815    1.2358500  45.6517684
 [83,]    4.7321504  9.722245  -14.6502709  23.1601412
 [84,]   21.1651595  8.539385    3.9757451  37.3997169
 [85,]    1.9365687  8.053365  -13.9844025  17.5645196
 [86,]    5.2424778  8.386228  -11.2069300  21.5042209
 [87,]   -3.8198130  9.451852  -22.2752709  15.0068648
 [88,]  -13.8395039 11.040051  -34.7594359   7.9975954
 [89,]  -13.2747947 12.960111  -38.0150198  11.9627000
 [90,]  -11.6606855 15.085847  -40.8571051  17.7647896
 [91,]   26.2033436 13.109423    0.2539211  51.6421266
 [92,]    8.5338630 11.214946  -13.6395053  30.4627105
 [93,]  -32.7694177  9.598003  -51.6499060 -14.2135772
 [94,]    2.6329017  8.420031  -13.8362621  18.9286413
 [95,]    3.1344211  7.880405  -12.1123240  18.4398851
 [96,]   10.1318405  8.107606   -5.6984233  26.2006304
 [97,]    3.4447598  9.044024  -13.9282346  21.5257285
 [98,]   -3.2317208 10.501622  -23.6685082  17.1112407
 [99,]   16.8315986 12.296438   -7.3225416  40.7919700
[100,]    0.7753179 14.302074  -27.0998383  28.6467148
[101,]    9.3871429 13.007678  -14.9448869  36.1119371
[102,]   -7.9462853 11.146847  -29.0967015  14.6738772
[103,]  -10.8843134  9.557272  -28.9579715   8.1122696
[104,]   -6.4348416  8.394488  -22.3010569   9.9739978
[105,]  -22.1934698  7.850489  -37.2905482  -6.6404992
[106,]  -14.6762980  8.051687  -30.1512397   1.0674502
[107,]  -14.4328262  8.947956  -31.4825567   3.4986051
[108,]    0.5574456 10.360449  -19.5193772  21.3680461
[109,]   17.1891174 12.109857   -6.8612554  41.2530962
[110,]   21.0066893 14.071074   -7.3116619  48.9386744
[111,]   17.3267550 12.842300   -6.9129721  42.5116478
[112,]  -12.4810208 10.987917  -33.5552955   9.1645648
[113,]  -16.6959966  9.420145  -34.7194700   1.7295407
[114,]  -34.3387724  8.302959  -50.5951441 -18.2217682
[115,]  -37.9146481  7.831622  -53.1535675 -22.6648693
[116,]    5.9282761  8.119399   -9.9075978  21.6142902
[117,]   38.6828003  9.094512   21.2499787  56.1867575
[118,]    5.1914245 10.568388  -15.3882999  25.8632768
[119,]   19.7949487 12.363927   -4.0985230  44.1890808
[120,]   -2.6048270 14.360979  -30.3497023  25.9343683
[121,]   -4.9120876 12.612282  -29.9621189  19.4156642
[122,]   37.0417690 10.855474   15.6168730  58.1723541
[123,]   -0.6991743  9.391923  -19.2652298  17.2289569
[124,]    2.4187824  8.376777  -13.6936813  18.3658176
[125,]  -13.9201609  7.982972  -29.3902771   1.1570565
[126,]   11.3087958  8.299431   -5.1292818  27.1491148
[127,]  -13.1554475  9.253568  -31.6558368   4.5975239
[128,]  -41.8837908 10.675756  -63.3075458 -20.9878561
[129,]    5.4852658 12.406058  -19.3702017  29.8074235
[130,]   23.9317225 14.333319   -4.4946554  51.9167433
[131,]  -50.2505974 12.668978  -75.9832784 -26.2737077
[132,]   12.1707482 10.904964   -9.5598953  32.4972504
[133,]   26.7598938  9.406337    8.2027703  44.6865168
[134,]   32.6414393  8.317800   15.9174937  48.7157549
[135,]   20.4306849  7.812689    4.6584515  35.4099577
[136,]   10.4237305  8.002257   -5.5000582  25.8196144
[137,]   -2.0738240  8.841936  -19.7068319  15.2420792
[138,]  -10.1632784 10.171982  -30.6189589   9.3584348
[139,]   -9.0507328 11.828115  -32.5237939  13.4679969
[140,]  -10.2450873 13.692520  -37.1318039  16.0426555
[141,]   17.1424995 12.380171   -7.5528103  41.9510271
[142,]    2.3660019 10.681407  -18.3122913  23.5707409
[143,]  -20.1183957  9.271352  -38.2076307  -1.9497745
[144,]  -10.9940934  8.298506  -27.3418339   5.0158947
[145,]   14.8816090  7.925537   -0.7281415  30.5032503
[146,]    5.9830113  8.234366   -9.8901037  22.2902719
[147,]  -24.3850863  9.156263  -41.8467783  -6.1095445
[148,]   14.3126160 10.531440   -5.8623266  35.2534480
[149,]   -4.8201816 12.207662  -28.0733455  19.3002273
[150,]   10.1230208 14.077802  -17.4423476  37.9289728
[151,]   -1.0601034 13.719037  -27.6083257  25.6305333
[152,]   -6.9522102 11.752882  -29.9406757  16.0858456
[153,]  -17.7265171 10.062843  -37.5282278   1.9338893
[154,]  -31.3059239  8.809296  -48.3724132 -14.2694739
[155,]  -19.3932308  8.195053  -35.3676465  -3.7992766
[156,]   42.1115623  8.362200   25.7699487  58.3908547
[157,]  -36.0856445  9.268560  -54.4061727 -18.1579719
[158,]   15.2001486 10.728388   -6.2901442  35.9153187
[159,]   17.6260418 12.550010   -7.6294911  41.9608088
[160,]    9.5402349 14.598612  -19.5939188  37.6366179
[161,]   17.5670790 12.248318   -6.9708570  41.6738967
[162,]   10.6723099 10.547107  -10.5377331  31.4513214
[163,]    6.6712409  9.134299  -11.3574284  24.3572384
[164,]    1.1046719  8.161075  -14.9325800  17.0880240
[165,]  -10.9714972  7.793886  -26.2383890   4.1706135
[166,]  -15.0871662  8.115414  -31.0561826   0.6267567
[167,]  -49.7905353  9.052570  -67.5719421 -31.9534830
[168,]  -13.8829043 10.440875  -34.8709482   6.4350474
[169,]   22.8100267 12.126356   -1.1973438  46.3567409
[170,]   32.0413576 14.002104    4.5411945  59.2941012
[171,]    6.0442185 12.585121  -19.0368491  31.3612060
[172,]   -1.7265425 10.791662  -23.7596985  19.7659915
[173,]   10.5631965  9.278108   -8.2658224  29.1263927
[174,]   11.7649355  8.200925   -4.8818287  27.8739072
[175,]  -23.5271254  7.744395  -39.0805752  -8.5940797
[176,]    7.0748136  8.015280   -8.4892782  22.8961971
[177,]    0.1159526  8.947757  -17.2699593  17.4593516
[178,]   -2.9790084 10.364777  -23.3524236  16.7990395
[179,]   11.1097306 12.097248  -12.4310936  34.3733505
[180,]   -5.7414304 14.028786  -32.7887123  21.1832201</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.2
p_loo        19.0  3.2
looic      1769.5 28.4
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   292       
 (0.5, 0.7]   (ok)         2    1.1%   547       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.3 22.3
p_loo        34.2  8.6
looic      1722.5 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   890       
 (0.5, 0.7]   (ok)         5    2.8%   452       
   (0.7, 1]   (bad)        2    1.1%   61        
   (1, Inf)   (very bad)   2    1.1%   12        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.5      11.7  
fit_sleep1 -92.0      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.2
p_loo        19.0  3.2
looic      1769.5 28.4
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   292       
 (0.5, 0.7]   (ok)         2    1.1%   547       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.3 22.3
p_loo        34.2  8.6
looic      1722.5 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   890       
 (0.5, 0.7]   (ok)         5    2.8%   452       
   (0.7, 1]   (bad)        2    1.1%   61        
   (1, Inf)   (very bad)   2    1.1%   12        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.3     22.3        34.2    8.6   1722.5
fit_sleep2  -23.5      11.7  -884.7     14.2        19.0    3.2   1769.5
fit_sleep1  -92.0      21.0  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.7  
fit_sleep2   28.4  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.080196e-40 6.383456e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88      1.62     0.14     5.47       0.05      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12      1.62    -3.45     2.94       5.21      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.16      
[4] StanHeaders_2.26.16 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.13.0          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.4.0      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.1        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.1         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.7  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.9        
 [91] gtable_0.3.1         cachem_1.0.7         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
