<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.86      6.92    15.35    42.09 1.00     1619     2567
sd(Days)                6.59      1.57     4.13    10.20 1.00     1415     1681
cor(Intercept,Days)     0.08      0.30    -0.48     0.68 1.00      966     1487

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.26      7.43   236.62   266.27 1.00     1653     1982
Days         10.44      1.73     6.96    13.81 1.00     1214     1603

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.88      1.56    23.11    29.21 1.00     3715     2998

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7765  12.71445 228.3520 277.6369
309 211.7746  13.46501 184.8461 237.9068
310 212.8801  13.45592 186.6202 238.2267
330 274.5898  13.53905 249.0388 301.5087
331 273.2544  13.02359 248.6186 299.4630
332 260.0687  12.43836 235.8887 285.4697
333 267.8765  12.51613 243.5272 293.1938
334 244.2871  12.41859 219.5116 268.7845
335 250.7323  13.32687 224.6529 277.7314
337 286.1086  13.02195 261.0898 312.0853
349 226.5052  13.06285 200.0702 251.1569
350 238.8863  13.24633 212.6321 264.2482
351 255.7425  12.10718 232.8286 279.0895
352 271.8426  12.67857 247.4325 296.5935
369 254.5783  12.19022 230.7573 278.1171
370 226.3923  13.38979 199.8632 251.8588
371 251.9865  12.45935 227.9191 276.4407
372 263.6383  12.15275 240.2268 287.6751

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6359194  2.458359 14.92859388 24.480705
309  1.7042687  2.482729 -3.00520726  6.470605
310  4.8969503  2.538833  0.04365763  9.974389
330  5.7721540  2.530923  0.74126215 10.531837
331  7.4560207  2.465933  2.48321575 12.089730
332 10.2616747  2.348760  5.58157394 14.819375
333 10.2694128  2.393470  5.70840968 14.851614
334 11.5491903  2.401359  6.94416544 16.486023
335 -0.2114065  2.601080 -5.36657014  4.818148
337 19.1251997  2.436476 14.32269723 23.813706
349 11.5686297  2.475450  6.82287470 16.527002
350 16.9829197  2.479339 12.26158824 21.823268
351  7.4928637  2.346456  2.77050524 12.020944
352 14.0416852  2.394881  9.25486112 18.765708
369 11.3093405  2.317935  6.76104902 16.023812
370 15.2065596  2.538195 10.30045590 20.204978
371  9.4902330  2.329335  4.99385485 13.994162
372 11.7597873  2.317194  7.27311062 16.385988</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7765 12.714451 228.3520 277.6369
  [2,] 273.4124 10.887909 251.7266 294.5246
  [3,] 293.0483  9.355369 274.5606 311.3666
  [4,] 312.6842  8.281689 296.3492 329.1230
  [5,] 332.3201  7.857281 316.8244 348.1208
  [6,] 351.9561  8.183791 336.2592 368.1960
  [7,] 371.5920  9.181451 353.9480 389.6896
  [8,] 391.2279 10.663524 370.3442 411.7859
  [9,] 410.8638 12.458310 386.8187 434.5773
 [10,] 430.4997 14.449751 402.4607 458.4453
 [11,] 211.7746 13.465010 184.8461 237.9068
 [12,] 213.4789 11.550746 190.3963 235.7076
 [13,] 215.1831  9.892464 195.3057 234.2875
 [14,] 216.8874  8.638857 199.3287 233.3628
 [15,] 218.5917  7.982904 202.3937 234.1144
 [16,] 220.2959  8.071651 204.4450 236.5147
 [17,] 222.0002  8.882805 204.3026 239.6659
 [18,] 223.7045 10.246209 203.5076 243.7161
 [19,] 225.4087 11.974692 201.9311 249.0999
 [20,] 227.1130 13.933040 200.1046 255.0164
 [21,] 212.8801 13.455923 186.6202 238.2267
 [22,] 217.7770 11.532804 194.9943 239.2964
 [23,] 222.6740  9.891443 203.1132 241.5251
 [24,] 227.5709  8.692930 210.2592 244.3458
 [25,] 232.4679  8.135403 216.1530 248.3668
 [26,] 237.3648  8.348286 220.4972 253.4173
 [27,] 242.2618  9.278702 223.2835 260.1455
 [28,] 247.1587 10.741792 225.5394 267.9782
 [29,] 252.0557 12.552658 227.3035 276.7273
 [30,] 256.9526 14.582308 227.7869 286.0388
 [31,] 274.5898 13.539047 249.0388 301.5087
 [32,] 280.3619 11.592740 258.5194 303.0347
 [33,] 286.1341  9.914060 267.1756 305.5943
 [34,] 291.9062  8.660063 275.0367 308.8277
 [35,] 297.6784  8.032182 282.1835 313.1166
 [36,] 303.4505  8.175960 287.6275 319.2524
 [37,] 309.2227  9.054714 291.6117 326.9471
 [38,] 314.9948 10.485252 294.8591 335.9140
 [39,] 320.7670 12.276168 297.1758 345.1062
 [40,] 326.5391 14.292629 298.9256 354.6141
 [41,] 273.2544 13.023589 248.6186 299.4630
 [42,] 280.7104 11.157224 259.6970 302.9353
 [43,] 288.1665  9.566353 269.7490 307.5159
 [44,] 295.6225  8.408818 279.5043 312.6233
 [45,] 303.0785  7.878006 288.1433 318.9603
 [46,] 310.5345  8.098110 294.7115 326.9346
 [47,] 317.9905  9.014292 300.1990 336.1727
 [48,] 325.4466 10.444959 304.8773 346.1395
 [49,] 332.9026 12.210592 308.9655 356.6952
 [50,] 340.3586 14.186669 312.3931 367.8865
 [51,] 260.0687 12.438357 235.8887 285.4697
 [52,] 270.3304 10.744998 249.4520 291.9619
 [53,] 280.5921  9.339732 262.8024 299.0800
 [54,] 290.8538  8.368963 274.9511 307.5716
 [55,] 301.1154  7.992612 285.5550 317.0177
 [56,] 311.3771  8.292013 295.1661 327.7561
 [57,] 321.6388  9.201439 303.6388 339.8774
 [58,] 331.9005 10.564508 311.2646 353.3721
 [59,] 342.1621 12.230475 318.4071 366.7872
 [60,] 352.4238 14.092323 325.0744 380.5960
 [61,] 267.8765 12.516133 243.5272 293.1938
 [62,] 278.1460 10.792575 257.6183 299.7028
 [63,] 288.4154  9.368201 270.1271 306.7870
 [64,] 298.6848  8.396671 281.9684 315.1983
 [65,] 308.9542  8.043780 293.0934 324.6576
 [66,] 319.2236  8.387973 302.7474 335.6269
 [67,] 329.4930  9.352604 311.1176 347.6464
 [68,] 339.7624 10.772265 318.8442 360.6471
 [69,] 350.0318 12.492782 326.1117 374.0963
 [70,] 360.3013 14.406765 332.9161 388.1779
 [71,] 244.2871 12.418595 219.5116 268.7845
 [72,] 255.8363 10.633529 234.6954 276.6569
 [73,] 267.3855  9.135395 249.3967 285.2055
 [74,] 278.9346  8.085294 263.3284 294.9796
 [75,] 290.4838  7.669523 275.5710 305.7104
 [76,] 302.0330  7.987755 286.0205 317.6366
 [77,] 313.5822  8.962139 295.8311 331.4842
 [78,] 325.1314 10.410028 304.7689 345.8053
 [79,] 336.6806 12.163490 312.8961 361.2054
 [80,] 348.2298 14.109052 320.6505 377.0723
 [81,] 250.7323 13.326867 224.6529 277.7314
 [82,] 250.5209 11.343481 228.5124 273.4799
 [83,] 250.3095  9.657898 231.6536 269.3278
 [84,] 250.0981  8.450246 233.3849 266.7134
 [85,] 249.8867  7.941634 234.0446 265.3263
 [86,] 249.6752  8.262184 233.6604 265.8662
 [87,] 249.4638  9.326793 231.1369 268.0142
 [88,] 249.2524 10.919966 227.8709 270.7892
 [89,] 249.0410 12.846537 223.2399 274.0853
 [90,] 248.8296 14.978404 218.5307 278.1095
 [91,] 286.1086 13.021948 261.0898 312.0853
 [92,] 305.2338 11.178967 284.1002 327.6165
 [93,] 324.3590  9.604183 305.9377 343.5494
 [94,] 343.4842  8.448915 327.5524 360.3487
 [95,] 362.6094  7.899420 347.5006 378.3434
 [96,] 381.7346  8.080244 366.1657 397.7650
 [97,] 400.8598  8.947216 383.6068 418.6360
 [98,] 419.9850 10.328980 400.0089 440.4658
 [99,] 439.1102 12.049722 415.5273 462.6293
[100,] 458.2354 13.984871 430.9784 485.5356
[101,] 226.5052 13.062848 200.0702 251.1569
[102,] 238.0739 11.179513 215.5383 259.2852
[103,] 249.6425  9.569782 230.4726 267.9915
[104,] 261.2111  8.392594 244.5231 277.4290
[105,] 272.7798  7.845141 257.0935 288.1210
[106,] 284.3484  8.056833 267.9840 300.0636
[107,] 295.9170  8.974105 277.8589 312.9956
[108,] 307.4856 10.412122 286.6945 327.6529
[109,] 319.0543 12.187933 294.5001 342.8593
[110,] 330.6229 14.175148 302.2202 358.7214
[111,] 238.8863 13.246329 212.6321 264.2482
[112,] 255.8692 11.361992 233.3010 277.5929
[113,] 272.8522  9.747755 253.7307 291.5721
[114,] 289.8351  8.557852 272.7856 306.6204
[115,] 306.8180  7.984309 291.0547 322.7883
[116,] 323.8009  8.158172 307.5438 340.2409
[117,] 340.7838  9.036404 322.9475 358.2346
[118,] 357.7668 10.442780 337.4300 378.3127
[119,] 374.7497 12.195941 351.1615 398.4749
[120,] 391.7326 14.167728 364.2222 419.4055
[121,] 255.7425 12.107181 232.8286 279.0895
[122,] 263.2353 10.427854 243.1680 283.4117
[123,] 270.7282  9.050312 252.9363 288.2049
[124,] 278.2211  8.129444 261.9678 293.5070
[125,] 285.7139  7.828109 270.4972 300.6587
[126,] 293.2068  8.214769 276.8745 309.2389
[127,] 300.6997  9.203112 282.6561 319.3034
[128,] 308.1925 10.626562 287.1446 329.6291
[129,] 315.6854 12.335400 291.1050 340.6530
[130,] 323.1783 14.227159 294.7234 351.9740
[131,] 271.8426 12.678570 247.4325 296.5935
[132,] 285.8843 10.894557 264.9721 307.2320
[133,] 299.9259  9.386561 281.6491 318.3787
[134,] 313.9676  8.306297 297.7455 330.5971
[135,] 328.0093  7.832786 312.4362 343.2963
[136,] 342.0510  8.073501 325.4836 357.5878
[137,] 356.0927  8.971131 338.1152 373.1992
[138,] 370.1344 10.356249 349.5762 389.6460
[139,] 384.1761 12.062069 360.4269 407.0564
[140,] 398.2177 13.971614 370.5817 425.2940
[141,] 254.5783 12.190216 230.7573 278.1171
[142,] 265.8876 10.509849 245.3156 286.7720
[143,] 277.1969  9.113622 258.8078 295.4064
[144,] 288.5063  8.148923 272.1813 304.7094
[145,] 299.8156  7.778010 284.2015 315.0805
[146,] 311.1250  8.083042 294.7776 326.6808
[147,] 322.4343  8.995518 304.2931 339.5107
[148,] 333.7436 10.356099 313.2968 353.9438
[149,] 345.0530 12.013486 321.1540 368.4867
[150,] 356.3623 13.861622 328.8369 383.4476
[151,] 226.3923 13.389793 199.8632 251.8588
[152,] 241.5988 11.445984 219.1666 263.4262
[153,] 256.8054  9.778519 237.9100 275.6623
[154,] 272.0120  8.550624 255.6124 288.6419
[155,] 287.2185  7.968174 271.9085 302.3119
[156,] 302.4251  8.170390 286.3333 318.1937
[157,] 317.6316  9.105143 299.4855 335.2634
[158,] 332.8382 10.580022 311.8505 353.4442
[159,] 348.0448 12.403829 323.6929 372.6712
[160,] 363.2513 14.444997 335.3768 391.7416
[161,] 251.9865 12.459350 227.9191 276.4407
[162,] 261.4767 10.797800 240.6803 282.9002
[163,] 270.9670  9.423437 252.6311 289.6834
[164,] 280.4572  8.477113 264.0186 297.4093
[165,] 289.9474  8.110077 274.0709 306.0327
[166,] 299.4377  8.398622 282.9087 315.9252
[167,] 308.9279  9.281808 291.0505 327.1210
[168,] 318.4181 10.612194 297.7748 339.0919
[169,] 327.9084 12.244876 304.7687 351.9856
[170,] 337.3986 14.075046 310.7233 365.0599
[171,] 263.6383 12.152745 240.2268 287.6751
[172,] 275.3981 10.502142 254.9905 296.1413
[173,] 287.1579  9.145465 269.4997 305.3486
[174,] 298.9177  8.229390 283.3533 315.6183
[175,] 310.6775  7.908537 295.3534 326.2877
[176,] 322.4373  8.252625 306.2753 338.7202
[177,] 334.1970  9.187245 316.0665 351.9056
[178,] 345.9568 10.556699 325.4366 366.1881
[179,] 357.7166 12.215608 333.7592 381.2187
[180,] 369.4764 14.061901 341.7184 396.4454</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5        Q97.5
  [1,]   -4.2164608 12.714451  -28.0769073  21.20801388
  [2,]  -14.7076803 10.887909  -35.8198861   6.97810548
  [3,]  -42.2476997  9.355369  -60.5660480 -23.76000763
  [4,]    8.7555808  8.281689   -7.6831565  25.09063459
  [5,]   24.5317614  7.857281    8.7310581  40.02753444
  [6,]   62.7340419  8.183791   46.4940560  78.43087591
  [7,]   10.6118225  9.181451   -7.4858056  28.25582024
  [8,] -101.0792969 10.663524 -121.6373204 -80.19558428
  [9,]   19.7214836 12.458310   -3.9919705  43.76658625
 [10,]   35.8537642 14.449751    7.9082429  63.89280185
 [11,]   10.9593093 13.465010  -15.1729321  37.88782338
 [12,]   -8.2130594 11.550746  -30.4418435  14.86954686
 [13,]  -12.2053280  9.892464  -31.3096573   7.67207119
 [14,]  -12.1803967  8.638857  -28.6557621   5.37828122
 [15,]  -10.8755653  7.982904  -26.3983292   5.32238784
 [16,]   -4.3341340  8.071651  -20.5528803  11.51676379
 [17,]   -8.3699026  8.882805  -26.0355719   9.32771985
 [18,]   -5.9772713 10.246209  -25.9889464  14.21957253
 [19,]   -1.1130399 11.974692  -24.8042177  22.36461138
 [20,]   10.2011914 13.933040  -17.7022355  37.20955458
 [21,]  -13.8261530 13.455923  -39.1727732  12.43367100
 [22,]  -23.4448033 11.532804  -44.9641559  -0.66205980
 [23,]   11.6460463  9.891443   -7.2051071  31.20683544
 [24,]    5.2706960  8.692930  -11.5041723  22.58235284
 [25,]   -3.1604543  8.135403  -19.0594324  13.15435714
 [26,]  -16.9069046  8.348286  -32.9593788  -0.03934405
 [27,]   -6.8409550  9.278702  -24.7247291  12.13727735
 [28,]    8.5923947 10.741792  -12.2271321  30.21168630
 [29,]    8.9568444 12.552658  -15.7147738  33.70902450
 [30,]   -9.4373060 14.582308  -38.5234871  19.72838370
 [31,]   46.9528432 13.539047   20.0338665  72.50377466
 [32,]   20.0382891 11.592740   -2.6344653  41.88081519
 [33,]   -2.2775649  9.914060  -21.7378485  16.68089982
 [34,]   -6.7732190  8.660063  -23.6947403  10.09630211
 [35,]  -11.8810730  8.032182  -27.3192554   3.61382960
 [36,]   -5.8650271  8.175960  -21.6669371   9.95797596
 [37,]  -28.9830811  9.054714  -46.7074682 -11.37208448
 [38,]    3.2664649 10.485252  -17.6526876  23.40220859
 [39,]  -15.4174892 12.276168  -39.7567424   8.17374644
 [40,]   27.5095568 14.292629   -0.5654206  55.12314666
 [41,]   14.3534808 13.023589  -11.8551416  38.98928358
 [42,]    4.2895600 11.157224  -17.9353136  25.30298735
 [43,]   13.6541393  9.566353   -5.6953422  32.07164245
 [44,]   24.4928186  8.408818    7.4919531  40.61095568
 [45,]   13.1987979  7.878006   -2.6830389  28.13402080
 [46,]  -17.2158229  8.098110  -33.6159364  -1.39284148
 [47,]  -27.9155436  9.014292  -46.0977283 -10.12397410
 [48,]    9.3711357 10.444959  -11.3218093  29.94044320
 [49,]  -39.1556850 12.210592  -62.9482657 -15.21856800
 [50,]   31.2224942 14.186669    3.6946084  59.18804673
 [51,]  -25.2081358 12.438357  -50.6090806  -1.02811425
 [52,]  -27.5186106 10.744998  -49.1501186  -6.64015935
 [53,]   -7.6307853  9.339732  -26.1186652  10.15894731
 [54,]   18.9150400  8.368963    2.1972276  34.81771058
 [55,]   16.3474652  7.992612    0.4451890  31.90787089
 [56,]   -1.3795095  8.292013  -17.7585052  14.83147154
 [57,]  132.5231157  9.201439  114.2844832 150.52314638
 [58,]   14.9306410 10.564508   -6.5410337  35.56653808
 [59,]  -11.8618338 12.230475  -36.4868613  11.89324857
 [60,]  -98.5594085 14.092323 -126.7315736 -71.20996788
 [61,]   15.9658626 12.516133   -9.3514114  40.31519623
 [62,]   11.4090498 10.792575  -10.1478247  31.93669605
 [63,]  -11.6460630  9.368201  -30.0176971   6.64220077
 [64,]    1.1249242  8.396671  -15.3886262  17.84132762
 [65,]  -11.7831886  8.043780  -27.4866330   4.07764707
 [66,]   18.9428987  8.387973    2.5396011  35.41913812
 [67,]    2.5334859  9.352604  -15.6198504  20.90889128
 [68,]    9.0774731 10.772265  -11.8072079  29.99569961
 [69,]  -16.6718397 12.492782  -40.7362635   7.24831779
 [70,]    1.7415476 14.406765  -26.1350508  29.12672738
 [71,]   21.1860256 12.418595   -3.3113578  45.96145019
 [72,]   20.3649354 10.633529   -0.4557045  41.50582533
 [73,]  -24.0207549  9.135395  -41.8407900  -6.03198035
 [74,]  -24.2623452  8.085294  -40.3073234  -8.65613732
 [75,]  -11.4594355  7.669523  -26.6859543   3.45340540
 [76,]  -17.8418258  7.987755  -33.4453532  -1.82934534
 [77,]   -8.0574161  8.962139  -25.9593584   9.69374963
 [78,]    6.3914937 10.410028  -14.2823951  26.75397167
 [79,]   -0.9336966 12.163490  -25.4584828  22.85084268
 [80,]   29.0692131 14.109052    0.2266874  56.64850929
 [81,]   -9.1239808 13.326867  -36.1231115  16.95543281
 [82,]   23.4263257 11.343481    0.4673359  45.43484532
 [83,]    4.1812321  9.657898  -14.8370576  22.83711622
 [84,]   20.7040386  8.450246    4.0886997  37.41723796
 [85,]    1.5652451  7.941634  -13.8744263  17.40727262
 [86,]    4.9609516  8.262184  -11.2299585  20.97583477
 [87,]   -4.0115419  9.326793  -22.5618584  14.31539887
 [88,]  -13.9414355 10.919966  -35.4781818   7.44007898
 [89,]  -13.2869290 12.846537  -38.3311795  12.51415141
 [90,]  -11.5830225 14.978404  -40.8629447  18.71594929
 [91,]   26.2580096 13.021948    0.2812988  51.27678181
 [92,]    8.5720099 11.178967  -13.8107418  29.70555559
 [93,]  -32.7477898  9.604183  -51.9381706 -14.32651955
 [94,]    2.6380105  8.448915  -14.2265335  18.56982415
 [95,]    3.1230109  7.899420  -12.6110073  18.23180351
 [96,]   10.1039112  8.080244   -5.9264763  25.67282653
 [97,]    3.4003115  8.947216  -14.3759000  20.65329975
 [98,]   -3.2926881 10.328980  -23.7735327  16.68338199
 [99,]   16.7541122 12.049722   -6.7649516  40.33703104
[100,]    0.6813125 13.984871  -26.6188541  27.93825165
[101,]    9.5979579 13.062848  -15.0537448  36.03298094
[102,]   -7.7571718 11.179513  -28.9684970  14.77840618
[103,]  -10.7169014  9.569782  -29.0658507   8.45295998
[104,]   -6.2891311  8.392594  -22.5069776  10.39891876
[105,]  -22.0694608  7.845141  -37.4107011  -6.38324832
[106,]  -14.5739904  8.056833  -30.2892087   1.79037617
[107,]  -14.3522201  8.974105  -31.4308045   3.70589643
[108,]    0.6163502 10.412122  -19.5509339  21.40748524
[109,]   17.2263205 12.187933   -6.5787065  41.78049915
[110,]   21.0221909 14.175148   -7.0763138  49.42486477
[111,]   17.4104834 13.246329   -7.9513555  43.66468615
[112,]  -12.4149363 11.361992  -34.1385594  10.15330194
[113,]  -16.6475560  9.747755  -35.3674846   2.47394550
[114,]  -34.3079757  8.557852  -51.0932653 -17.25849418
[115,]  -37.9014954  7.984309  -53.8717666 -22.13821812
[116,]    5.9237849  8.158172  -10.5161636  22.18090091
[117,]   38.6606653  9.036404   21.2099235  56.49695760
[118,]    5.1516456 10.442780  -15.3942722  25.48838045
[119,]   19.7375259 12.195941   -3.9877181  43.32569107
[120,]   -2.6798938 14.167728  -30.3528414  24.83051592
[121,]   -5.2159773 12.107181  -28.5630458  17.69791196
[122,]   36.8222590 10.427854   16.6458711  56.88958845
[123,]   -0.8343047  9.050312  -18.3110257  16.95761559
[124,]    2.3680316  8.129444  -12.9178755  18.62128948
[125,]  -13.8865320  7.828109  -28.8313379   1.33020521
[126,]   11.4268043  8.214769   -4.6052672  27.75905729
[127,]  -12.9530594  9.203112  -31.5567903   5.09049303
[128,]  -41.5970230 10.626562  -63.0336443 -20.54912254
[129,]    5.8564133 12.335400  -19.1112191  30.43680880
[130,]   24.3872496 14.227159   -4.4085479  52.84205249
[131,]  -50.1654768 12.678570  -74.9164090 -25.75535719
[132,]   12.3096380 10.894557   -9.0381030  33.22178659
[133,]   26.9525527  9.386561    8.4997584  45.22938186
[134,]   32.8878675  8.306297   16.2584363  49.11002982
[135,]   20.7308823  7.832786    5.4439373  36.30395908
[136,]   10.7776970  8.073501   -4.7590915  27.34507848
[137,]   -1.6660882  8.971131  -18.7726195  16.31135747
[138,]   -9.7017735 10.356249  -29.2134433  10.85643991
[139,]   -8.5354587 12.062069  -31.4157652  15.21369611
[140,]   -9.6760439 13.971614  -36.7522824  17.95995493
[141,]   17.3452363 12.190216   -6.1935849  41.16615988
[142,]    2.5492958 10.509849  -18.3350985  23.12129774
[143,]  -19.9545447  9.113622  -38.1639529  -1.56537477
[144,]  -10.8496852  8.148923  -27.0527795   5.47526302
[145,]   15.0065743  7.778010   -0.2583474  30.62074597
[146,]    6.0885338  8.083042   -9.4672719  22.43589956
[147,]  -24.2990067  8.995518  -41.3753642  -6.15780727
[148,]   14.3792527 10.356099   -5.8209456  34.82610134
[149,]   -4.7729878 12.013486  -28.2066718  19.12602431
[150,]   10.1507717 13.861622  -16.9345084  37.67620788
[151,]   -1.1282846 13.389793  -26.5947843  25.40076977
[152,]   -7.0753442 11.445984  -28.9027018  15.35693695
[153,]  -17.9046038  9.778519  -36.7614918   0.99083692
[154,]  -31.5389633  8.550624  -48.1688555 -15.13942099
[155,]  -19.6812229  7.968174  -34.7746185  -4.37124448
[156,]   41.7686175  8.170390   25.9999770  57.86040548
[157,]  -36.4835420  9.105143  -54.1152865 -18.33739129
[158,]   14.7472984 10.580022   -5.8586796  35.73503303
[159,]   17.1182388 12.403829   -7.5082232  41.47014095
[160,]    8.9774792 14.444997  -19.5127814  36.85199801
[161,]   17.8939067 12.459350   -6.5603220  41.96132448
[162,]   10.9660737 10.797800  -10.4573574  31.76254866
[163,]    6.9319406  9.423437  -11.7844748  25.26776659
[164,]    1.3323076  8.477113  -15.6198046  17.77087850
[165,]  -10.7769254  8.110077  -26.8622322   5.09958451
[166,]  -14.9256585  8.398622  -31.4131672   1.60327418
[167,]  -49.6620915  9.281808  -67.8552459 -31.78466530
[168,]  -13.7875245 10.612194  -34.4613023   6.85584066
[169,]   22.8723425 12.244876   -1.2049201  46.01199903
[170,]   32.0706094 14.075046    4.4092961  58.74586704
[171,]    5.7733850 12.152745  -18.2633939  29.18490573
[172,]   -1.9241023 10.502142  -22.6673390  18.48349314
[173,]   10.4389104  9.145465   -7.7518469  28.09707764
[174,]   11.7139232  8.229390   -4.9866770  27.27833551
[175,]  -23.5048641  7.908537  -39.1151300  -8.18075933
[176,]    7.1703487  8.252625   -9.1126390  23.33230731
[177,]    0.2847614  9.187245  -17.4237714  18.41532658
[178,]   -2.7369258 10.556699  -22.9681994  17.78334579
[179,]   11.4250869 12.215608  -12.0769913  35.38246690
[180,]   -5.3528004 14.061901  -32.3217893  22.40524246</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.4  3.4
looic      1770.1 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   491       
 (0.5, 0.7]   (ok)         1    0.6%   152       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.8 22.7
p_loo        34.9  8.8
looic      1723.6 45.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   899       
 (0.5, 0.7]   (ok)         7    3.9%   506       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   3    1.7%   11        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.2      12.0  
fit_sleep1 -91.6      21.3  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.4  3.4
looic      1770.1 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   491       
 (0.5, 0.7]   (ok)         1    0.6%   152       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.8 22.7
p_loo        34.9  8.8
looic      1723.6 45.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   899       
 (0.5, 0.7]   (ok)         7    3.9%   506       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   3    1.7%   11        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.8     22.7        34.9    8.8   1723.6
fit_sleep2  -23.2      12.0  -885.0     14.3        19.4    3.4   1770.1
fit_sleep1  -91.6      21.3  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   45.5  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.661767e-40 8.108736e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88      1.57     0.32     5.46       0.04      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12      1.57     -3.3     2.91        5.1      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.26 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.5      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.3         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.0          
 [52] processx_3.8.1       pkgbuild_1.4.0       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.0        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.0         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-1       
 [85] grid_4.3.0           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.31       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
