<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing
adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.96      6.94    15.75    42.68 1.00     1939     2536
sd(Days)                6.60      1.54     4.14    10.21 1.00     1089     1851
cor(Intercept,Days)     0.09      0.29    -0.45     0.66 1.00     1196     2034

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.27      7.42   236.55   265.67 1.00     1631     2045
Days         10.45      1.74     7.05    14.08 1.00     1403     1445

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.89      1.54    23.09    29.21 1.00     4022     2730

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9615  12.82300 228.6886 278.2276
309 211.4927  13.23211 185.0228 237.5857
310 212.8692  13.11559 186.3866 237.8872
330 274.6955  13.25969 249.3885 301.2496
331 273.1688  13.03876 247.1001 299.1711
332 260.2503  12.32641 237.0162 284.3569
333 268.0797  12.57916 243.8012 293.6810
334 244.5169  12.11128 220.1169 267.9572
335 250.5674  13.20907 225.8922 277.0168
337 285.9791  13.05402 260.9824 312.1713
349 226.6887  12.78751 201.0407 250.4196
350 238.7244  13.07422 213.2023 264.2702
351 255.9004  12.39747 232.0205 280.3495
352 272.0848  12.61395 247.8874 297.2547
369 254.9824  12.29453 231.0473 279.1343
370 226.6526  13.57245 199.8555 252.4826
371 252.1252  12.35413 228.5764 276.7926
372 263.7755  12.04456 240.8103 287.9390

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6570529  2.491090 14.96029787 24.545407
309  1.7887076  2.513050 -3.12850684  6.723236
310  4.9517502  2.485850  0.01774272  9.820534
330  5.7343997  2.526081  0.66895743 10.577650
331  7.5446656  2.472841  2.59329204 12.329399
332 10.2269817  2.381271  5.55404318 14.844701
333 10.2664732  2.401359  5.44367559 14.890195
334 11.5095034  2.313879  7.03016833 15.966730
335 -0.2342379  2.594216 -5.52188712  4.849120
337 19.1383161  2.467835 14.21659544 23.857477
349 11.5493632  2.464638  6.92317221 16.551883
350 17.0058492  2.506090 12.12987829 21.959505
351  7.4823155  2.357622  2.82449818 12.090983
352 14.0540184  2.343713  9.35652129 18.527736
369 11.2911722  2.319091  6.83467607 15.801651
370 15.1679079  2.606798 10.22182492 20.416413
371  9.4632307  2.371099  4.92280970 14.053594
372 11.7573727  2.249846  7.36695914 16.189265</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9615 12.822997 228.6886 278.2276
  [2,] 273.6186 10.966943 252.2716 294.1389
  [3,] 293.2756  9.409010 274.7749 310.8515
  [4,] 312.9327  8.318424 296.7341 328.8823
  [5,] 332.5897  7.891384 316.9762 347.7775
  [6,] 352.2468  8.231815 336.0845 368.3003
  [7,] 371.9038  9.255412 353.9490 390.0578
  [8,] 391.5609 10.769104 371.2646 412.8861
  [9,] 411.2180 12.597444 387.2792 436.2428
 [10,] 430.8750 14.622882 402.8151 459.7818
 [11,] 211.4927 13.232110 185.0228 237.5857
 [12,] 213.2814 11.327339 190.6346 235.7312
 [13,] 215.0702  9.703573 195.6108 234.2183
 [14,] 216.8589  8.522962 199.6112 233.3517
 [15,] 218.6476  7.984564 202.5823 233.7774
 [16,] 220.4363  8.215625 204.0347 236.3043
 [17,] 222.2250  9.158088 204.1413 240.5561
 [18,] 224.0137 10.624287 203.3365 245.0016
 [19,] 225.8024 12.430254 201.9509 250.2479
 [20,] 227.5911 14.449145 199.6999 255.8350
 [21,] 212.8692 13.115593 186.3866 237.8872
 [22,] 217.8209 11.240279 195.1513 239.1490
 [23,] 222.7727  9.645094 203.0115 241.5574
 [24,] 227.7244  8.489447 210.7308 244.3387
 [25,] 232.6762  7.966963 216.9973 248.2885
 [26,] 237.6279  8.199584 221.8379 253.6095
 [27,] 242.5797  9.129772 224.7824 260.5095
 [28,] 247.5314 10.575028 227.3496 268.5331
 [29,] 252.4832 12.355913 228.8643 276.9037
 [30,] 257.4349 14.347992 229.5592 285.7447
 [31,] 274.6955 13.259694 249.3885 301.2496
 [32,] 280.4299 11.348467 258.8747 303.2601
 [33,] 286.1643  9.722041 267.4983 305.5021
 [34,] 291.8987  8.544626 275.3377 309.0147
 [35,] 297.6331  8.016567 281.8721 313.6937
 [36,] 303.3675  8.263307 287.1393 319.9498
 [37,] 309.1019  9.222868 291.0785 327.4542
 [38,] 314.8363 10.705256 294.2858 335.6389
 [39,] 320.5707 12.526209 296.1059 344.5613
 [40,] 326.3051 14.559240 297.3589 354.3808
 [41,] 273.1688 13.038763 247.1001 299.1711
 [42,] 280.7135 11.166225 258.5866 302.8697
 [43,] 288.2582  9.570251 269.3454 307.2281
 [44,] 295.8028  8.409798 278.9824 312.3169
 [45,] 303.3475  7.879695 287.8138 318.6934
 [46,] 310.8922  8.104589 294.8229 326.4501
 [47,] 318.4368  9.028235 300.6856 336.5214
 [48,] 325.9815 10.467261 305.4707 346.9088
 [49,] 333.5262 12.241241 309.4414 358.6434
 [50,] 341.0708 14.225410 313.0648 369.8532
 [51,] 260.2503 12.326414 237.0162 284.3569
 [52,] 270.4773 10.610092 250.2663 291.2822
 [53,] 280.7043  9.195027 263.0700 298.6585
 [54,] 290.9313  8.237954 274.9036 306.6199
 [55,] 301.1583  7.906968 285.4134 316.5437
 [56,] 311.3853  8.277519 294.8403 327.2076
 [57,] 321.6122  9.265818 303.3728 339.4626
 [58,] 331.8392 10.702072 310.7773 352.5264
 [59,] 342.0662 12.431984 317.7624 366.0090
 [60,] 352.2932 14.349738 324.3090 379.7379
 [61,] 268.0797 12.579163 243.8012 293.6810
 [62,] 278.3462 10.803981 257.0325 300.5398
 [63,] 288.6126  9.313954 270.6073 307.4994
 [64,] 298.8791  8.264775 282.8908 314.9038
 [65,] 309.1456  7.835582 293.7207 324.1029
 [66,] 319.4121  8.125222 303.3133 335.1168
 [67,] 329.6785  9.065052 311.9506 347.2453
 [68,] 339.9450 10.481611 319.1189 360.4665
 [69,] 350.2115 12.210086 326.5439 374.4626
 [70,] 360.4780 14.136524 333.5269 388.7070
 [71,] 244.5169 12.111279 220.1169 267.9572
 [72,] 256.0264 10.472996 235.1500 276.0776
 [73,] 267.5359  9.131939 249.5017 285.2776
 [74,] 279.0454  8.234624 262.7860 294.9557
 [75,] 290.5549  7.933085 274.8536 306.0668
 [76,] 302.0645  8.292569 285.3586 318.1847
 [77,] 313.5740  9.236213 295.1096 331.4064
 [78,] 325.0835 10.609272 303.7526 345.5586
 [79,] 336.5930 12.268404 311.8879 360.5467
 [80,] 348.1025 14.113075 319.5145 375.8018
 [81,] 250.5674 13.209068 225.8922 277.0168
 [82,] 250.3332 11.223172 229.0150 272.7168
 [83,] 250.0990  9.534129 231.8150 268.8549
 [84,] 249.8647  8.324635 233.8616 266.1702
 [85,] 249.6305  7.820447 234.5226 265.2960
 [86,] 249.3962  8.153475 233.4927 265.3890
 [87,] 249.1620  9.233570 231.2440 267.6694
 [88,] 248.9278 10.839667 227.4348 270.4904
 [89,] 248.6935 12.774892 223.1809 274.2049
 [90,] 248.4593 14.911649 218.5707 278.2210
 [91,] 285.9791 13.054021 260.9824 312.1713
 [92,] 305.1175 11.197717 283.7206 327.6127
 [93,] 324.2558  9.620327 305.9251 343.4972
 [94,] 343.3941  8.478970 327.3860 360.2202
 [95,] 362.5324  7.963391 347.0418 378.1900
 [96,] 381.6707  8.192598 365.5106 397.6635
 [97,] 400.8090  9.110551 382.5905 418.5836
 [98,] 419.9474 10.538788 399.4827 440.7089
 [99,] 439.0857 12.300828 414.9394 463.1005
[100,] 458.2240 14.273581 430.1078 486.0696
[101,] 226.6887 12.787505 201.0407 250.4196
[102,] 238.2381 10.928679 216.3988 258.7008
[103,] 249.7875  9.354177 231.2028 267.3511
[104,] 261.3368  8.228859 245.3031 277.1880
[105,] 272.8862  7.750903 257.6463 288.2752
[106,] 284.4355  8.036651 268.7376 300.2335
[107,] 295.9849  9.013762 278.5775 313.9522
[108,] 307.5343 10.490802 287.0174 328.0735
[109,] 319.0836 12.288809 295.3030 343.2494
[110,] 330.6330 14.287114 303.1998 358.9206
[111,] 238.7244 13.074218 213.2023 264.2702
[112,] 255.7302 11.187798 233.7782 277.4335
[113,] 272.7361  9.589548 253.7820 291.2721
[114,] 289.7419  8.444702 273.3708 306.3858
[115,] 306.7478  7.951575 291.5228 322.1054
[116,] 323.7536  8.228187 307.7688 339.6521
[117,] 340.7594  9.205409 322.9686 358.6246
[118,] 357.7653 10.692849 337.0831 378.8970
[119,] 374.7711 12.509814 350.3640 399.3803
[120,] 391.7770 14.533233 363.0826 420.3338
[121,] 255.9004 12.397465 232.0205 280.3495
[122,] 263.3828 10.662271 242.5944 284.5603
[123,] 270.8651  9.208022 252.8709 288.7018
[124,] 278.3474  8.185845 262.0806 294.0173
[125,] 285.8297  7.768219 270.2966 301.0600
[126,] 293.3120  8.049791 277.6670 309.0973
[127,] 300.7943  8.964921 283.7462 318.7361
[128,] 308.2767 10.346847 288.7019 329.2759
[129,] 315.7590 12.035840 292.5041 340.3189
[130,] 323.2413 13.920575 296.1437 351.2122
[131,] 272.0848 12.613948 247.8874 297.2547
[132,] 286.1388 10.872324 264.8422 307.8557
[133,] 300.1929  9.396231 282.0151 319.2117
[134,] 314.2469  8.328077 298.0206 330.7032
[135,] 328.3009  7.836489 313.0651 343.5456
[136,] 342.3549  8.028089 326.4079 357.9048
[137,] 356.4089  8.858661 338.9876 373.2961
[138,] 370.4630 10.172880 350.2827 389.7949
[139,] 384.5170 11.810381 360.8562 406.9186
[140,] 398.5710 13.655354 371.1137 424.7490
[141,] 254.9824 12.294528 231.0473 279.1343
[142,] 266.2736 10.621020 245.2362 287.1494
[143,] 277.5647  9.231094 259.1214 295.6017
[144,] 288.8559  8.269008 272.2940 305.1750
[145,] 300.1471  7.892797 284.7950 315.7565
[146,] 311.4382  8.183665 295.5223 327.4876
[147,] 322.7294  9.077713 305.2677 340.9095
[148,] 334.0206 10.420832 313.7805 354.7037
[149,] 345.3118 12.063953 321.5338 369.0564
[150,] 356.6029 13.901100 329.2563 384.1170
[151,] 226.6526 13.572449 199.8555 252.4826
[152,] 241.8205 11.553682 219.0407 263.7811
[153,] 256.9884  9.816035 237.6255 275.8867
[154,] 272.1563  8.533013 255.1779 289.1344
[155,] 287.3242  7.928486 272.1068 303.4350
[156,] 302.4921  8.154769 287.1628 318.9244
[157,] 317.6600  9.150432 299.9517 335.2007
[158,] 332.8279 10.702867 312.0121 353.2475
[159,] 347.9958 12.608058 323.2683 372.8423
[160,] 363.1638 14.729754 334.1913 392.5001
[161,] 252.1252 12.354132 228.5764 276.7926
[162,] 261.5884 10.581398 241.5037 282.5715
[163,] 271.0516  9.085790 254.0182 289.0351
[164,] 280.5149  8.023803 264.9803 296.3145
[165,] 289.9781  7.579938 274.8868 304.9499
[166,] 299.4413  7.859626 283.8515 314.8132
[167,] 308.9046  8.794101 291.6320 326.3387
[168,] 318.3678 10.205043 298.4759 338.7468
[169,] 327.8310 11.924505 304.5629 351.7981
[170,] 337.2943 13.837954 309.8198 364.5804
[171,] 263.7755 12.044557 240.8103 287.9390
[172,] 275.5329 10.412871 255.2875 296.2138
[173,] 287.2903  9.050307 269.5924 305.0758
[174,] 299.0476  8.093937 283.2977 314.5472
[175,] 310.8050  7.696701 296.1919 325.7756
[176,] 322.5624  7.942934 307.3258 338.1456
[177,] 334.3197  8.778656 317.5147 351.8034
[178,] 346.0771 10.057983 326.8003 365.9423
[179,] 357.8345 11.635500 335.3643 380.7137
[180,] 369.5919 13.406353 343.8228 395.3109</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.4015310 12.822997  -28.6675605  20.8713936
  [2,]  -14.9138839 10.966943  -35.4342300   6.4330857
  [3,]  -42.4750368  9.409010  -60.0508642 -23.9742607
  [4,]    8.5071103  8.318424   -7.4424776  24.7057322
  [5,]   24.2621574  7.891384    9.0744321  39.8757389
  [6,]   62.4433046  8.231815   46.3897838  78.6055810
  [7,]   10.2999517  9.255412   -7.8539613  28.2547505
  [8,] -101.4123012 10.769104 -122.7374931 -81.1160315
  [9,]   19.3673459 12.597444   -5.6574674  43.3061169
 [10,]   35.4784930 14.622882    6.5716537  63.5383851
 [11,]   11.2411585 13.232110  -14.8518260  37.7110948
 [12,]   -8.0156491 11.327339  -30.4653857  14.6311522
 [13,]  -12.0923567  9.703573  -31.2404776   7.3669753
 [14,]  -12.1518643  8.522962  -28.6446630   5.0957596
 [15,]  -10.9314719  7.984564  -26.0612552   5.1337845
 [16,]   -4.4744796  8.215625  -20.3425177  11.9271350
 [17,]   -8.5946872  9.158088  -26.9258410   9.4890387
 [18,]   -6.2864948 10.624287  -27.2744183  14.3906670
 [19,]   -1.5067024 12.430254  -25.9521716  22.3447780
 [20,]    9.7230900 14.449145  -18.5207783  37.6143488
 [21,]  -13.8152670 13.115593  -38.8332753  12.6673140
 [22,]  -23.4887172 11.240279  -44.8167580  -0.8191120
 [23,]   11.5473326  9.645094   -7.2374426  31.3085059
 [24,]    5.1171824  8.489447  -11.4970535  22.1108444
 [25,]   -3.3687679  7.966963  -18.9811245  12.3101183
 [26,]  -17.1700181  8.199584  -33.1516055  -1.3799912
 [27,]   -7.1588683  9.129772  -25.0887169  10.6384000
 [28,]    8.2196815 10.575028  -12.7820344  28.4015223
 [29,]    8.5293313 12.355913  -15.8912183  32.1482237
 [30,]   -9.9196189 14.347992  -38.2293850  17.9560622
 [31,]   46.8471079 13.259694   20.2930369  72.1540903
 [32,]   19.9703082 11.348467   -2.8599457  41.5255470
 [33,]   -2.3077915  9.722041  -21.6456169  16.3581877
 [34,]   -6.7656912  8.544626  -23.8816571   9.7952604
 [35,]  -11.8357909  8.016567  -27.8964400   3.9251620
 [36,]   -5.7819906  8.263307  -22.3643289  10.4461937
 [37,]  -28.8622903  9.222868  -47.2145590 -10.8388902
 [38,]    3.4250100 10.705256  -17.3776492  23.9755377
 [39,]  -15.2211897 12.526209  -39.2117872   9.2435600
 [40,]   27.7436106 14.559240   -0.3320742  56.6898113
 [41,]   14.4390530 13.038763  -11.5631635  40.5078369
 [42,]    4.2864874 11.166225  -17.8696883  26.4134354
 [43,]   13.5624218  9.570251   -5.4074539  32.4751706
 [44,]   24.3124562  8.409798    7.7983574  41.1328978
 [45,]   12.9297906  7.879695   -2.4160850  28.4634956
 [46,]  -17.5734750  8.104589  -33.1314239  -1.5042079
 [47,]  -28.3618406  9.028235  -46.4463543 -10.6105844
 [48,]    8.8361938 10.467261  -12.0911333  29.3469541
 [49,]  -39.7792717 12.241241  -64.8964523 -15.6944643
 [50,]   30.5102627 14.225410    1.7279183  58.5162826
 [51,]  -25.3897418 12.326414  -49.4962898  -2.1556390
 [52,]  -27.6655235 10.610092  -48.4703551  -7.4544950
 [53,]   -7.7430053  9.195027  -25.6971940   9.8912978
 [54,]   18.8375130  8.237954    3.1489398  34.8651796
 [55,]   16.3046313  7.906968    0.9191517  32.0495129
 [56,]   -1.3876505  8.277519  -17.2099821  15.1572842
 [57,]  132.5496678  9.265818  114.6993291 150.7891010
 [58,]   14.9918861 10.702072   -5.6953139  36.0538346
 [59,]  -11.7658957 12.431984  -35.7087186  12.5378823
 [60,]  -98.4287774 14.349738 -125.8735306 -70.4445766
 [61,]   15.7627053 12.579163   -9.8385703  40.0412492
 [62,]   11.2088321 10.803981  -10.9847777  32.5225341
 [63,]  -11.8433412  9.313954  -30.7301389   6.1620159
 [64,]    0.9305856  8.264775  -15.0941206  16.9189465
 [65,]  -11.9745876  7.835582  -26.9319154   3.4503033
 [66,]   18.7544391  8.125222    3.0496977  34.8532423
 [67,]    2.3479659  9.065052  -15.2187699  20.0759118
 [68,]    8.8948927 10.481611  -11.6265822  29.7210282
 [69,]  -16.8514805 12.210086  -41.1025967   6.8161358
 [70,]    1.5648462 14.136524  -26.6641633  28.5159143
 [71,]   20.9561667 12.111279   -2.4840672  45.3561598
 [72,]   20.1747633 10.472996    0.1236222  41.0511582
 [73,]  -24.1712400  9.131939  -41.9128513  -6.1370312
 [74,]  -24.3731434  8.234624  -40.2834469  -8.1136586
 [75,]  -11.5305467  7.933085  -27.0424241   4.1707971
 [76,]  -17.8732501  8.292569  -33.9935285  -1.1673515
 [77,]   -8.0491535  9.236213  -25.8816049  10.4151892
 [78,]    6.4394432 10.609272  -14.0356853  27.7703062
 [79,]   -0.8460602 12.268404  -24.7998397  23.8590300
 [80,]   29.1965365 14.113075    1.4972130  57.7844729
 [81,]   -8.9591374 13.209068  -35.4084903  15.7161036
 [82,]   23.6140005 11.223172    1.2304092  44.9322419
 [83,]    4.3917384  9.534129  -14.3642123  22.6756845
 [84,]   20.9373764  8.324635    4.6319450  36.9405094
 [85,]    1.8214143  7.820447  -13.8441198  16.9293052
 [86,]    5.2399522  8.153475  -10.7527783  21.1434703
 [87,]   -3.7097099  9.233570  -22.2171062  14.2082963
 [88,]  -13.6167719 10.839667  -35.1794157   7.8761614
 [89,]  -12.9394340 12.774892  -38.4508235  12.5732413
 [90,]  -11.2126961 14.911649  -40.9743537  18.6758519
 [91,]   26.3874552 13.054021    0.1953012  51.3842484
 [92,]    8.6883392 11.197717  -13.8068629  30.0852477
 [93,]  -32.6445769  9.620327  -51.8859952 -14.3138687
 [94,]    2.7281070  8.478970  -14.0979689  18.7362479
 [95,]    3.1999910  7.963391  -12.4576274  18.6906249
 [96,]   10.1677749  8.192598   -5.8249605  26.3279006
 [97,]    3.4510588  9.110551  -14.3235231  21.6696113
 [98,]   -3.2550572 10.538788  -24.0165540  17.2096271
 [99,]   16.7786267 12.300828   -7.2362432  40.9248785
[100,]    0.6927106 14.273581  -27.1529495  28.8089380
[101,]    9.4144751 12.787505  -14.3163644  35.0624771
[102,]   -7.9213881 10.928679  -28.3841069  13.9179186
[103,]  -10.8618513  9.354177  -28.4254501   7.7228188
[104,]   -6.4148145  8.228859  -22.2659990   9.6188948
[105,]  -22.1758776  7.750903  -37.5648665  -6.9360411
[106,]  -14.6611408  8.036651  -30.4591171   1.0367724
[107,]  -14.4201040  9.013762  -32.3873751   2.9872566
[108,]    0.5677328 10.490802  -19.9714937  21.0845563
[109,]   17.1969696 12.288809   -6.9688174  40.9776264
[110,]   21.0121064 14.287114   -7.2755067  48.4452681
[111,]   17.5724453 13.074218   -7.9733740  43.0945145
[112,]  -12.2759039 11.187798  -33.9791645   9.6760693
[113,]  -16.5314531  9.589548  -35.0675444   2.4226273
[114,]  -34.2148023  8.444702  -50.8587251 -17.8437404
[115,]  -37.8312515  7.951575  -53.1889106 -22.6063470
[116,]    5.9710993  8.228187   -9.9274075  21.9558862
[117,]   38.6850500  9.205409   20.8199438  56.4758931
[118,]    5.1531008 10.692849  -15.9786316  25.8353287
[119,]   19.7160516 12.509814   -4.8931020  44.1232296
[120,]   -2.7242976 14.533233  -31.2811020  25.9701159
[121,]   -5.3739474 12.397465  -29.8229779  18.5059805
[122,]   36.6748371 10.662271   15.4973411  57.4632051
[123,]   -0.9711784  9.208022  -18.8079029  17.0230192
[124,]    2.2417060  8.185845  -13.4282294  18.5085355
[125,]  -14.0023095  7.768219  -29.2326028   1.5308345
[126,]   11.3215750  8.049791   -4.4636816  26.9665925
[127,]  -13.0477406  8.964921  -30.9895328   4.0003975
[128,]  -41.6811561 10.346847  -62.6803830 -22.1064088
[129,]    5.7828284 12.035840  -18.7770741  29.0376737
[130,]   24.3242128 13.920575   -3.6466934  51.4218454
[131,]  -50.4077259 12.613948  -75.5775990 -26.2103416
[132,]   12.0550557 10.872324   -9.6617550  33.3516965
[133,]   26.6856372  9.396231    7.6667958  44.8634114
[134,]   32.6086188  8.328077   16.1522879  48.8349041
[135,]   20.4393004  7.836489    5.1946447  35.6750577
[136,]   10.4737819  8.028089   -5.0761423  26.4207736
[137,]   -1.9823365  8.858661  -18.8694651  15.4389548
[138,]  -10.0303550 10.172880  -29.3623423  10.1499378
[139,]   -8.8763734 11.810381  -31.2780361  14.7843551
[140,]  -10.0292918 13.655354  -36.2072623  17.4280168
[141,]   16.9411183 12.294528   -7.2107567  40.8761962
[142,]    2.1633461 10.621020  -18.7125001  23.2006911
[143,]  -20.3223261  9.231094  -38.3592931  -1.8790035
[144,]  -11.1992983  8.269008  -27.5183714   5.3625905
[145,]   14.6751294  7.892797   -0.9343405  30.0271666
[146,]    5.7752572  8.183665  -10.2740526  21.6912336
[147,]  -24.5941150  9.077713  -42.7741883  -7.1324394
[148,]   14.1023128 10.420832   -6.5807839  34.3424238
[149,]   -5.0317594 12.063953  -28.7764441  18.7461579
[150,]    9.9101684 13.901100  -17.6038749  37.2567739
[151,]   -1.3885827 13.572449  -27.2185539  25.4085288
[152,]   -7.2969906 11.553682  -29.2575888  15.4827937
[153,]  -18.0875985  9.816035  -36.9858514   1.2753033
[154,]  -31.6833064  8.533013  -48.6613869 -14.7048564
[155,]  -19.7869143  7.928486  -35.8977062  -4.5695397
[156,]   41.7015778  8.154769   25.2693457  57.0309480
[157,]  -36.5119300  9.150432  -54.0525988 -18.8035508
[158,]   14.7575621 10.702867   -5.6620155  35.5734046
[159,]   17.1671542 12.608058   -7.6793221  41.8946890
[160,]    9.0650463 14.729754  -20.2712636  38.0375066
[161,]   17.7552185 12.354132   -6.9122155  41.3040078
[162,]   10.8543878 10.581398  -10.1287252  30.9390933
[163,]    6.8472571  9.085790  -11.1361921  23.8807440
[164,]    1.2746265  8.023803  -14.5250196  16.8092387
[165,]  -10.8076042  7.579938  -25.7793898   4.2837054
[166,]  -14.9293349  7.859626  -30.3012204   0.6605034
[167,]  -49.6387656  8.794101  -67.0729447 -32.3662328
[168,]  -13.7371963 10.205043  -34.1161803   6.1546925
[169,]   22.9496730 11.924505   -1.0173771  46.2178486
[170,]   32.1749423 13.837954    4.8888378  59.6493524
[171,]    5.6361894 12.044557  -18.5272652  28.6014064
[172,]   -2.0588833 10.412871  -22.7398048  18.1865405
[173,]   10.3065440  9.050307   -7.4790372  28.0044109
[174,]   11.5839713  8.093937   -3.9155790  27.3338857
[175,]  -23.6324014  7.696701  -38.6030374  -9.0192928
[176,]    7.0452259  7.942934   -8.5379865  22.2817524
[177,]    0.1620532  8.778656  -17.3215560  16.9671243
[178,]   -2.8572195 10.057983  -22.7224140  16.4195795
[179,]   11.3072078 11.635500  -11.5720014  33.7773807
[180,]   -5.4682649 13.406353  -31.1872879  20.3007654</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.4  3.2
looic      1769.9 28.5
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   516       
 (0.5, 0.7]   (ok)         3    1.7%   146       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.8 23.5
p_loo        36.0  9.8
looic      1725.5 46.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1179      
 (0.5, 0.7]   (ok)         6    3.3%   433       
   (0.7, 1]   (bad)        1    0.6%   62        
   (1, Inf)   (very bad)   2    1.1%   3         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -22.2      12.7  
fit_sleep1 -90.5      22.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.4  3.2
looic      1769.9 28.5
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   516       
 (0.5, 0.7]   (ok)         3    1.7%   146       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.8 23.5
p_loo        36.0  9.8
looic      1725.5 46.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1179      
 (0.5, 0.7]   (ok)         6    3.3%   433       
   (0.7, 1]   (bad)        1    0.6%   62        
   (1, Inf)   (very bad)   2    1.1%   3         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.8     23.5        36.0    9.8   1725.5
fit_sleep2  -22.2      12.7  -885.0     14.3        19.4    3.2   1769.9
fit_sleep1  -90.5      22.0  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   46.9  
fit_sleep2   28.5  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
4.823303e-40 2.315963e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0      2.9      1.58     0.25     5.37       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0     -0.1      1.58    -3.38     2.92       5.52      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.25 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_0.63.0   compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.21      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.4      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.42           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.2         tidyselect_1.2.0    
 [46] abind_1.4-5          yaml_2.3.7           codetools_0.2-19    
 [49] miniUI_0.1.1.1       curl_5.0.0           processx_3.8.1      
 [52] pkgbuild_1.4.0       lattice_0.21-8       tibble_3.2.1        
 [55] plyr_1.8.8           shiny_1.7.4          withr_2.5.0         
 [58] bridgesampling_1.1-2 posterior_1.4.1      coda_0.19-4         
 [61] evaluate_0.21        RcppParallel_5.1.7   xts_0.13.1          
 [64] pillar_1.9.0         tensorA_0.36.2       checkmate_2.2.0     
 [67] DT_0.28              stats4_4.3.0         shinyjs_2.1.0       
 [70] distributional_0.3.2 generics_0.1.3       ggplot2_3.4.2       
 [73] rstantools_2.3.1     munsell_0.5.0        scales_1.2.1        
 [76] minqa_1.2.5          gtools_3.9.4         xtable_1.8-4        
 [79] glue_1.6.2           tools_4.3.0          shinystan_2.6.0     
 [82] colourpicker_1.2.0   mvtnorm_1.1-3        grid_4.3.0          
 [85] crosstalk_1.2.0      colorspace_2.1-0     nlme_3.1-162        
 [88] cli_3.6.1            fansi_1.0.4          Brobdingnag_1.2-9   
 [91] dplyr_1.1.2          V8_4.3.0             gtable_0.3.3        
 [94] sass_0.4.6           digest_0.6.31        htmlwidgets_1.6.2   
 [97] farver_2.1.1         htmltools_0.5.5      lifecycle_1.0.3     
[100] mime_0.12            shinythemes_1.2.0    MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
