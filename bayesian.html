<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.91      6.85    15.40    42.85 1.00     1784     2545
sd(Days)                6.53      1.52     4.09    10.12 1.01     1176     1899
cor(Intercept,Days)     0.09      0.29    -0.48     0.67 1.00      991     1649

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.22      7.56   236.26   266.10 1.00     1477     2223
Days         10.51      1.69     7.33    13.89 1.01     1174     1848

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.87      1.57    23.02    29.06 1.00     3654     3034

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9098  13.15555 227.6852 279.8963
309 211.3510  13.47514 184.5350 237.6099
310 212.7193  13.33551 186.0969 238.1736
330 274.5285  13.28272 249.3115 300.4020
331 273.3202  12.85579 248.6504 299.2664
332 260.2454  12.41577 236.1675 284.2245
333 268.2195  12.39015 244.0903 293.0611
334 244.3160  12.75978 219.3934 268.8210
335 250.6707  13.27364 224.6735 277.2477
337 286.0204  12.87877 260.9581 311.4358
349 226.4016  13.14133 200.3726 252.0473
350 239.0900  12.84179 213.0886 262.9425
351 255.6636  12.45555 231.1861 281.0947
352 271.8557  12.47006 247.9830 296.1234
369 254.6920  12.16796 231.1337 279.4443
370 226.5343  13.37062 199.8336 252.2766
371 251.9368  12.02338 228.4277 275.9036
372 263.2458  12.49351 238.8367 287.9962

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6283168  2.496898 14.88664604 24.643935
309  1.8224362  2.503991 -3.16932915  6.608630
310  4.9068422  2.474735  0.03223676  9.699498
330  5.7994981  2.519151  0.67254891 10.538582
331  7.4647974  2.403512  2.72403934 11.959431
332 10.2038489  2.332665  5.70397148 14.822793
333 10.2249925  2.408491  5.38108036 14.808615
334 11.5145927  2.362491  6.92299124 16.213636
335 -0.1960576  2.547816 -5.16794095  4.772730
337 19.1814110  2.453124 14.43338089 23.992348
349 11.6172368  2.470043  6.84811601 16.513332
350 16.9303999  2.464609 12.33703095 21.816838
351  7.5567105  2.404344  2.81291030 12.269536
352 14.0758699  2.401357  9.38659809 18.847039
369 11.3102867  2.335100  6.72627623 15.835956
370 15.1808401  2.568241 10.25060124 20.233743
371  9.4936879  2.317405  4.96386580 13.994587
372 11.8405344  2.377670  7.26130056 16.477181</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9098 13.155549 227.6852 279.8963
  [2,] 273.5382 11.303116 251.2370 295.9686
  [3,] 293.1665  9.742760 273.9696 312.7090
  [4,] 312.7948  8.634311 295.9561 330.3641
  [5,] 332.4231  8.163961 316.8058 349.0752
  [6,] 352.0514  8.439088 335.8751 368.9152
  [7,] 371.6797  9.394420 353.4878 390.3681
  [8,] 391.3081 10.851777 370.5907 412.9900
  [9,] 410.9364 12.638670 386.5428 436.2140
 [10,] 430.5647 14.634886 402.4049 459.8795
 [11,] 211.3510 13.475144 184.5350 237.6099
 [12,] 213.1734 11.589903 190.4811 235.8097
 [13,] 214.9959  9.980587 195.6919 234.8238
 [14,] 216.8183  8.799906 199.9399 234.6053
 [15,] 218.6407  8.234350 202.4280 235.0543
 [16,] 220.4632  8.408962 204.4730 237.1126
 [17,] 222.2856  9.282063 204.0226 240.1041
 [18,] 224.1081 10.683759 202.7696 244.7278
 [19,] 225.9305 12.436586 201.5127 249.9360
 [20,] 227.7529 14.413000 199.5661 255.6581
 [21,] 212.7193 13.335514 186.0969 238.1736
 [22,] 217.6261 11.462804 194.7747 239.0654
 [23,] 222.5330  9.859233 202.8929 241.2775
 [24,] 227.4398  8.675350 210.5447 244.0722
 [25,] 232.3467  8.097379 216.6244 248.2716
 [26,] 237.2535  8.253607 221.0323 253.5887
 [27,] 242.1603  9.106324 224.5161 259.9739
 [28,] 247.0672 10.486987 226.5521 267.8806
 [29,] 251.9740 12.217907 227.6313 276.0863
 [30,] 256.8809 14.171318 228.4469 284.4809
 [31,] 274.5285 13.282718 249.3115 300.4020
 [32,] 280.3280 11.383656 258.2092 302.3091
 [33,] 286.1275  9.769182 267.2389 305.1320
 [34,] 291.9270  8.601072 274.8835 308.8127
 [35,] 297.7265  8.075407 281.5632 313.5187
 [36,] 303.5260  8.314938 286.8090 319.8102
 [37,] 309.3255  9.260477 290.9112 327.8002
 [38,] 315.1250 10.726924 294.2357 336.6971
 [39,] 320.9245 12.532742 296.3427 346.2399
 [40,] 326.7240 14.552133 297.6918 355.7440
 [41,] 273.3202 12.855789 248.6504 299.2664
 [42,] 280.7850 11.048144 259.5450 303.4230
 [43,] 288.2498  9.508175 270.1732 307.5194
 [44,] 295.7146  8.384691 279.4145 312.3227
 [45,] 303.1794  7.858399 288.0599 318.8635
 [46,] 310.6442  8.047333 294.5776 326.6343
 [47,] 318.1090  8.906089 300.6221 335.7145
 [48,] 325.5738 10.267961 305.7317 345.8115
 [49,] 333.0386 11.962331 309.7692 356.1435
 [50,] 340.5034 13.867856 312.9731 367.1347
 [51,] 260.2454 12.415769 236.1675 284.2245
 [52,] 270.4493 10.715006 249.3104 291.3848
 [53,] 280.6531  9.292687 262.4144 298.8062
 [54,] 290.8570  8.293332 274.1963 307.1187
 [55,] 301.0608  7.879552 285.3240 316.1835
 [56,] 311.2647  8.141129 294.9971 327.4291
 [57,] 321.4685  9.019494 303.3581 339.5169
 [58,] 331.6724 10.358920 311.0335 352.2058
 [59,] 341.8762 12.006075 317.9676 365.8940
 [60,] 352.0801 13.851609 324.9022 380.0439
 [61,] 268.2195 12.390148 244.0903 293.0611
 [62,] 278.4445 10.585042 257.6540 299.3733
 [63,] 288.6695  9.064884 271.1274 306.9196
 [64,] 298.8945  7.993922 283.4640 314.6084
 [65,] 309.1195  7.565390 294.4463 324.3849
 [66,] 319.3445  7.884739 303.9979 335.4526
 [67,] 329.5694  8.871570 312.3972 347.3123
 [68,] 339.7944 10.336444 320.0044 359.8399
 [69,] 350.0194 12.107065 326.8694 373.4362
 [70,] 360.2444 14.068463 333.0721 387.6573
 [71,] 244.3160 12.759780 219.3934 268.8210
 [72,] 255.8305 11.008595 234.2884 277.1062
 [73,] 267.3451  9.525181 248.8419 285.8280
 [74,] 278.8597  8.451727 262.5766 295.5373
 [75,] 290.3743  7.955944 274.7270 306.2181
 [76,] 301.8889  8.144023 285.8905 317.8465
 [77,] 313.4035  8.973066 295.7363 331.1447
 [78,] 324.9181 10.289288 304.6877 344.6624
 [79,] 336.4327 11.932548 312.7809 359.7289
 [80,] 347.9473 13.786394 320.6777 374.8917
 [81,] 250.6707 13.273642 224.6735 277.2477
 [82,] 250.4746 11.343851 228.3499 273.1016
 [83,] 250.2786  9.703560 231.1190 269.2958
 [84,] 250.0825  8.521616 233.4519 266.4168
 [85,] 249.8864  8.003719 234.2604 265.3833
 [86,] 249.6904  8.275496 233.3268 265.8391
 [87,] 249.4943  9.267734 231.0969 267.8815
 [88,] 249.2983 10.783352 227.5964 270.3326
 [89,] 249.1022 12.635394 224.1404 273.5785
 [90,] 248.9061 14.697225 220.2751 277.4600
 [91,] 286.0204 12.878773 260.9581 311.4358
 [92,] 305.2018 11.049046 284.0563 326.7466
 [93,] 324.3832  9.504508 306.0478 342.9720
 [94,] 343.5646  8.403902 327.0977 360.2770
 [95,] 362.7461  7.934173 347.0718 378.5852
 [96,] 381.9275  8.204406 365.8361 397.8067
 [97,] 401.1089  9.149267 382.9766 418.6272
 [98,] 420.2903 10.589691 399.3246 440.7771
 [99,] 439.4717 12.353528 415.1670 463.3088
[100,] 458.6531 14.321780 430.3747 486.4439
[101,] 226.4016 13.141334 200.3726 252.0473
[102,] 238.0188 11.241636 216.3791 260.3370
[103,] 249.6361  9.605014 231.2658 268.7789
[104,] 261.2533  8.386922 245.1660 278.2311
[105,] 272.8705  7.786324 257.8460 288.5782
[106,] 284.4878  7.944523 269.3226 300.3585
[107,] 296.1050  8.820786 279.0654 313.3181
[108,] 307.7223 10.232269 287.9110 327.7641
[109,] 319.3395 11.991439 296.2668 343.2282
[110,] 330.9567 13.967538 303.8133 358.7641
[111,] 239.0900 12.841791 213.0886 262.9425
[112,] 256.0204 10.949572 233.8304 276.9315
[113,] 272.9508  9.328625 254.3404 290.9718
[114,] 289.8812  8.142601 273.5083 305.6683
[115,] 306.8116  7.597977 291.6829 321.5827
[116,] 323.7420  7.829761 307.6915 338.7613
[117,] 340.6724  8.776653 322.4266 357.2614
[118,] 357.6028 10.242203 336.7010 377.3344
[119,] 374.5332 12.038455 349.7939 398.1543
[120,] 391.4636 14.039040 362.9338 418.8302
[121,] 255.6636 12.455548 231.1861 281.0947
[122,] 263.2203 10.691302 242.2278 284.8942
[123,] 270.7770  9.221114 252.2773 289.0225
[124,] 278.3337  8.204614 262.3720 294.7222
[125,] 285.8904  7.820753 270.4098 301.5336
[126,] 293.4471  8.159315 277.5476 309.9087
[127,] 301.0039  9.140372 283.2571 319.1533
[128,] 308.5606 10.586790 287.6440 329.8380
[129,] 316.1173 12.335947 291.5911 340.7752
[130,] 323.6740 14.277003 295.1616 351.9582
[131,] 271.8557 12.470061 247.9830 296.1234
[132,] 285.9315 10.704495 265.4841 306.8109
[133,] 300.0074  9.230549 282.0802 318.2924
[134,] 314.0833  8.206880 297.7935 330.1897
[135,] 328.1591  7.812539 312.8876 343.7762
[136,] 342.2350  8.139513 326.3943 358.3713
[137,] 356.3109  9.110467 338.4949 374.3136
[138,] 370.3868 10.549056 349.5348 391.1038
[139,] 384.4626 12.292176 359.9375 408.4031
[140,] 398.5385 14.228338 370.0808 426.2564
[141,] 254.6920 12.167963 231.1337 279.4443
[142,] 266.0023 10.454734 245.7009 287.3261
[143,] 277.3126  9.024910 259.6926 295.1262
[144,] 288.6229  8.031309 272.7112 304.3540
[145,] 299.9332  7.645930 284.5532 314.6114
[146,] 311.2435  7.957634 295.2300 326.4086
[147,] 322.5538  8.893425 305.1315 339.8068
[148,] 333.8640 10.284332 313.9865 353.7200
[149,] 345.1743 11.972775 321.8495 368.3353
[150,] 356.4846 13.850363 329.3284 383.6153
[151,] 226.5343 13.370619 199.8336 252.2766
[152,] 241.7152 11.409378 218.9490 263.4936
[153,] 256.8960  9.734787 237.6247 275.7206
[154,] 272.0768  8.517628 255.2224 288.7153
[155,] 287.2577  7.970296 271.1428 302.9041
[156,] 302.4385  8.227573 286.5299 318.4653
[157,] 317.6194  9.222366 299.8780 335.7776
[158,] 332.8002 10.751875 311.6011 353.8407
[159,] 347.9810 12.623206 323.3307 372.5324
[160,] 363.1619 14.706447 334.4883 391.4940
[161,] 251.9368 12.023383 228.4277 275.9036
[162,] 261.4305 10.371462 240.9331 281.8970
[163,] 270.9242  9.017396 253.6266 288.4582
[164,] 280.4179  8.111744 264.8406 296.1624
[165,] 289.9116  7.812046 274.6642 305.0200
[166,] 299.4053  8.185138 283.2548 315.2856
[167,] 308.8990  9.149078 290.8253 326.7236
[168,] 318.3926 10.543031 298.0528 339.0405
[169,] 327.8863 12.220725 304.3543 351.7876
[170,] 337.3800 14.081103 310.0527 365.1174
[171,] 263.2458 12.493510 238.8367 287.9962
[172,] 275.0863 10.734820 253.8900 296.2846
[173,] 286.9268  9.256973 268.9162 305.3120
[174,] 298.7674  8.213001 283.0194 315.0492
[175,] 310.6079  7.779577 295.6800 326.3857
[176,] 322.4484  8.055861 306.8930 338.5955
[177,] 334.2890  8.976558 317.0119 352.5594
[178,] 346.1295 10.371447 325.9285 366.5270
[179,] 357.9700 12.077328 334.2354 381.7751
[180,] 369.8106 13.980824 342.4808 397.5769</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.3498430 13.155549  -30.3363007  21.8747765
  [2,]  -14.8334597 11.303116  -37.2639084   7.4676651
  [3,]  -42.3658765  9.742760  -61.9084194 -23.1690255
  [4,]    8.6450067  8.634311   -8.9242992  25.4837182
  [5,]   24.4287899  8.163961    7.7767242  40.0461365
  [6,]   62.6386732  8.439088   45.7748609  78.8149795
  [7,]   10.5240564  9.394420   -8.1643123  28.7160061
  [8,] -101.1594604 10.851777 -122.8414271 -80.4420898
  [9,]   19.6489228 12.638670   -5.6287318  44.0424763
 [10,]   35.7888061 14.634886    6.4739662  63.9485816
 [11,]   11.3829003 13.475144  -14.8760376  38.1989144
 [12,]   -7.9076359 11.589903  -30.5438721  14.7847125
 [13,]  -12.0180721  9.980587  -31.8459635   7.2858921
 [14,]  -12.1113084  8.799906  -29.8983195   4.7670682
 [15,]  -10.9246446  8.234350  -27.3381797   5.2881244
 [16,]   -4.5013808  8.408962  -21.1507712  11.4888187
 [17,]   -8.6553170  9.282063  -26.4737642   9.6076577
 [18,]   -6.3808533 10.683759  -27.0005557  14.9575588
 [19,]   -1.6347895 12.436586  -25.6402834  22.7830334
 [20,]    9.5612743 14.413000  -18.3439237  37.7481428
 [21,]  -13.6653898 13.335514  -39.1197468  12.9569769
 [22,]  -23.2939321 11.462804  -44.7332408  -0.4425386
 [23,]   11.7870257  9.859233   -6.9575002  31.4271440
 [24,]    5.4017835  8.675350  -11.2306049  22.2968679
 [25,]   -3.0392588  8.097379  -18.9641613  12.6829821
 [26,]  -16.7956010  8.253607  -33.1307675  -0.5743714
 [27,]   -6.7395432  9.106324  -24.5531308  10.9046847
 [28,]    8.6839146 10.486987  -12.1295261  29.1989873
 [29,]    9.0384723 12.217907  -15.0737746  33.3811930
 [30,]   -9.3655699 14.171318  -36.9655765  19.0684141
 [31,]   47.0141148 13.282718   21.1405716  72.2311322
 [32,]   20.0722167 11.383656   -1.9088632  42.1910162
 [33,]   -2.2709814  9.769182  -21.2754626  16.6175635
 [34,]   -6.7939795  8.601072  -23.6796978  10.2495034
 [35,]  -11.9291776  8.075407  -27.7213806   4.2340818
 [36,]   -5.9404757  8.314938  -22.2246902  10.7765153
 [37,]  -29.0858738  9.260477  -47.5605660 -10.6716405
 [38,]    3.1363281 10.726924  -18.4358257  24.0255931
 [39,]  -15.5749700 12.532742  -40.8904279   9.0067944
 [40,]   27.3247318 14.552133   -1.6952789  56.3569246
 [41,]   14.2876530 12.855789  -11.6584802  38.9575179
 [42,]    4.2149556 11.048144  -18.4230319  25.4549839
 [43,]   13.5707582  9.508175   -5.6987891  31.6473784
 [44,]   24.4006608  8.384691    7.7926412  40.7008253
 [45,]   13.0978635  7.858399   -2.5862182  28.2174111
 [46,]  -17.3255339  8.047333  -33.3155595  -1.2589445
 [47,]  -28.0340313  8.906089  -45.6394909 -10.5470754
 [48,]    9.2438713 10.267961  -10.9938478  29.0860319
 [49,]  -39.2917260 11.962331  -62.3966172 -16.0222901
 [50,]   31.0776766 13.867856    4.4463998  58.6079536
 [51,]  -25.3848207 12.415769  -49.3638913  -1.3069037
 [52,]  -27.6374696 10.715006  -48.5729861  -6.4986165
 [53,]   -7.6918185  9.292687  -25.8448921  10.5468907
 [54,]   18.9118326  8.293332    2.6501400  35.5724620
 [55,]   16.4020837  7.879552    1.2794141  32.1388769
 [56,]   -1.2670652  8.141129  -17.4315333  15.0004698
 [57,]  132.6933859  9.019494  114.6450038 150.8037527
 [58,]   15.1587370 10.358920   -5.3746715  35.7975990
 [59,]  -11.5759119 12.006075  -35.5936577  12.3326983
 [60,]  -98.2156608 13.851609 -126.1795475 -71.0377870
 [61,]   15.6229057 12.390148   -9.2186807  39.7520551
 [62,]   11.1105132 10.585042   -9.8182603  31.9009506
 [63,]  -11.9001793  9.064884  -30.1503178   5.6419451
 [64,]    0.9152281  7.993922  -14.7986904  16.3457317
 [65,]  -11.9484644  7.565390  -27.2139091   2.7247490
 [66,]   18.8220431  7.884739    2.7138786  34.1686156
 [67,]    2.4570505  8.871570  -15.2858111  19.6292529
 [68,]    9.0454580 10.336444  -10.9999672  28.8355202
 [69,]  -16.6594345 12.107065  -40.0761858   6.4905690
 [70,]    1.7983730 14.068463  -25.6144883  28.9706623
 [71,]   21.1571443 12.759780   -3.3478516  46.0797349
 [72,]   20.3706515 11.008595   -0.9049714  41.9128169
 [73,]  -23.9804412  9.525181  -42.4632877  -5.4771639
 [74,]  -24.1874340  8.451727  -40.8650229  -7.9042945
 [75,]  -11.3499267  7.955944  -27.1936595   4.2973683
 [76,]  -17.6977194  8.144023  -33.6553272  -1.6993062
 [77,]   -7.8787122  8.973066  -25.6199140   9.7885090
 [78,]    6.6047951 10.289288  -13.1394820  26.8351980
 [79,]   -0.6857977 11.932548  -23.9820074  22.9659543
 [80,]   29.3517096 13.786394    2.4072606  56.6212941
 [81,]   -9.0623662 13.273642  -35.6394209  16.9347616
 [82,]   23.4725914 11.343851    0.8455633  45.5973121
 [83,]    4.2121489  9.703560  -14.8050569  23.3716940
 [84,]   20.7196065  8.521616    4.3852985  37.3501647
 [85,]    1.5654641  8.003719  -13.9314200  17.1914860
 [86,]    4.9458217  8.275496  -11.2029427  21.3093602
 [87,]   -4.0420208  9.267734  -22.4291557  14.3553704
 [88,]  -13.9872632 10.783352  -35.0216053   7.7145529
 [89,]  -13.3481056 12.635394  -37.8243913  11.6137223
 [90,]  -11.6595480 14.697225  -40.2134259  16.9714598
 [91,]   26.3461895 12.878773    0.9307857  51.4085140
 [92,]    8.6039785 11.049046  -12.9407821  29.7495216
 [93,]  -32.7720325  9.504508  -51.3607725 -14.4365623
 [94,]    2.5575564  8.403902  -14.1547823  19.0244844
 [95,]    2.9863454  7.934173  -12.8528180  18.6605905
 [96,]    9.9110343  8.204406   -5.9682356  26.0023703
 [97,]    3.1512233  9.149267  -14.3671452  21.2835447
 [98,]   -3.5979878 10.589691  -24.0848475  17.3677348
 [99,]   16.3926012 12.353528   -7.4445380  40.6973061
[100,]    0.2635901 14.321780  -27.5271697  28.5420026
[101,]    9.7016064 13.141334  -15.9441124  35.7305990
[102,]   -7.7021304 11.241636  -30.0203017  13.9376379
[103,]  -10.7104672  9.605014  -29.8533024   7.6597586
[104,]   -6.3313040  8.386922  -23.3091227   9.7560391
[105,]  -22.1602407  7.786324  -37.8678801  -7.1357181
[106,]  -14.7133775  7.944523  -30.5841445   0.4517931
[107,]  -14.5402143  8.820786  -31.7533139   2.4994160
[108,]    0.3797489 10.232269  -19.6620896  20.1909913
[109,]   16.9411122 11.991439   -6.9475575  40.0137587
[110,]   20.6883754 13.967538   -7.1189956  47.8318351
[111,]   17.2067829 12.841791   -6.6456965  43.2082233
[112,]  -12.5661170 10.949572  -33.4771924   9.6238968
[113,]  -16.7462169  9.328625  -34.7672113   1.8642299
[114,]  -34.3541168  8.142601  -50.1411517 -17.9811991
[115,]  -37.8951167  7.597977  -52.6662316 -22.7664051
[116,]    5.9826834  7.829761   -9.0365614  22.0332207
[117,]   38.7720835  8.776653   22.1830879  57.0178531
[118,]    5.3155836 10.242203  -14.4160048  26.2173784
[119,]   19.9539837 12.038455   -3.6671248  44.6933341
[120,]   -2.4109162 14.039040  -29.7774733  26.1188954
[121,]   -5.1370934 12.455548  -30.5681582  19.3403685
[122,]   36.8372961 10.691302   15.1634295  57.8297840
[123,]   -0.8831144  9.221114  -19.1285915  17.6165837
[124,]    2.2553751  8.204614  -14.1330829  18.2170864
[125,]  -14.0630354  7.820753  -29.7061638   1.4175722
[126,]   11.1864541  8.159315   -5.2750650  27.0860148
[127,]  -13.2572564  9.140372  -31.4067089   4.4894766
[128,]  -41.9650669 10.586790  -63.2425180 -21.0485231
[129,]    5.4245226 12.335947  -19.2334162  29.9506650
[130,]   23.8915121 14.277003   -4.3927329  52.4039375
[131,]  -50.1785638 12.470061  -74.4462833 -26.3059343
[132,]   12.2623663 10.704495   -8.6169717  32.7098436
[133,]   26.8710964  9.230549    8.5860624  44.7983303
[134,]   32.7722266  8.206880   16.6658279  49.0619826
[135,]   20.5810567  7.812539    4.9639906  35.8526283
[136,]   10.5936869  8.139513   -5.5425584  26.4343636
[137,]   -1.8842830  9.110467  -19.8870465  15.9317212
[138,]   -9.9541528 10.549056  -30.6712367  10.8977836
[139,]   -8.8220227 12.292176  -32.7625249  15.7030501
[140,]   -9.9967926 14.228338  -37.7147467  18.4608658
[141,]   17.2314596 12.167963   -7.5208075  40.7898121
[142,]    2.4345728 10.454734  -18.8891958  22.7360347
[143,]  -20.0702139  9.024910  -37.8837573  -2.4502084
[144,]  -10.9663007  8.031309  -26.6973534   4.9453725
[145,]   14.8890126  7.645930    0.2108121  30.2689973
[146,]    5.9700258  7.957634   -9.1950809  21.9834600
[147,]  -24.4184609  8.893425  -41.6714544  -6.9962382
[148,]   14.2588524 10.284332   -5.5971366  34.1364347
[149,]   -4.8943344 11.972775  -28.0552711  18.4305231
[150,]   10.0284789 13.850363  -17.1022201  37.1847484
[151,]   -1.2703165 13.370619  -27.0125617  25.4303602
[152,]   -7.1916565 11.409378  -28.9700865  15.5745020
[153,]  -17.9951966  9.734787  -36.8198182   1.2760963
[154,]  -31.6038367  8.517628  -48.2422544 -14.7494174
[155,]  -19.7203767  7.970296  -35.3668230  -3.6055499
[156,]   41.7551832  8.227573   25.7284457  57.6637736
[157,]  -36.4712569  9.222366  -54.6294988 -18.7298858
[158,]   14.7853031 10.751875   -6.2551523  35.9844020
[159,]   17.1819630 12.623206   -7.3693880  41.8323203
[160,]    9.0669229 14.706447  -19.2651786  37.7405277
[161,]   17.9435650 12.023383   -6.0232371  41.4526797
[162,]   11.0122772 10.371462   -9.4542086  31.5097244
[163,]    6.9746893  9.017396  -10.5593016  24.2722550
[164,]    1.3716015  8.111744  -14.3728663  16.9489456
[165,]  -10.7410864  7.812046  -25.8494721   4.5063179
[166,]  -14.8932742  8.185138  -30.7736447   1.2571802
[167,]  -49.6331621  9.149078  -67.4577985 -31.5595481
[168,]  -13.7620499 10.543031  -34.4098826   6.5777523
[169,]   22.8943622 12.220725   -1.0068724  46.4264303
[170,]   32.0891744 14.081103    4.3517986  59.4164681
[171,]    6.1659299 12.493510  -18.5844604  30.5749565
[172,]   -1.6123044 10.734820  -22.8106173  19.5839903
[173,]   10.6699612  9.256973   -7.7151763  28.6806108
[174,]   11.8642269  8.213001   -4.4176192  27.6122427
[175,]  -23.4353075  7.779577  -39.2130763  -8.5073684
[176,]    7.1591582  8.055861   -8.9878793  22.7145736
[177,]    0.1928238  8.976558  -18.0775764  17.4698934
[178,]   -2.9096105 10.371447  -23.3070646  17.2914013
[179,]   11.1716551 12.077328  -12.6334271  34.9063014
[180,]   -5.6869792 13.980824  -33.4532735  21.6428323</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.3 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.7  3.4
looic      1770.5 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1291      
 (0.5, 0.7]   (ok)         2    1.1%   112       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.1 23.0
p_loo        35.2  9.1
looic      1724.2 46.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     169   93.9%   657       
 (0.5, 0.7]   (ok)         7    3.9%   754       
   (0.7, 1]   (bad)        2    1.1%   32        
   (1, Inf)   (very bad)   2    1.1%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.1      12.2  
fit_sleep1 -91.1      21.6  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.3 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.7  3.4
looic      1770.5 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1291      
 (0.5, 0.7]   (ok)         2    1.1%   112       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.1 23.0
p_loo        35.2  9.1
looic      1724.2 46.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     169   93.9%   657       
 (0.5, 0.7]   (ok)         7    3.9%   754       
   (0.7, 1]   (bad)        2    1.1%   32        
   (1, Inf)   (very bad)   2    1.1%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.1     23.0        35.2    9.1   1724.2
fit_sleep2  -23.1      12.2  -885.2     14.4        19.7    3.4   1770.5
fit_sleep1  -91.1      21.6  -953.2     10.5         3.1    0.5   1906.3
           se_looic
fit_sleep3   46.1  
fit_sleep2   28.9  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
2.809010e-40 8.872352e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88      1.52     0.32     5.29       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12      1.52    -3.21     2.73       5.48      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.3.5         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.0       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
