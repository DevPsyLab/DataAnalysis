<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing
adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.85      6.70    16.03    42.72 1.00     1886     2828
sd(Days)                6.59      1.59     4.14    10.25 1.00     1362     1520
cor(Intercept,Days)     0.09      0.30    -0.50     0.66 1.01      961     1323

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.39      7.28   237.06   266.09 1.00     2213     2752
Days         10.43      1.73     7.10    13.89 1.00     1541     1664

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.50    23.14    28.90 1.00     3063     3154

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9908  12.74828 228.4241 278.6487
309 211.1300  13.69449 184.1451 237.9738
310 212.9980  13.10526 186.6929 238.4209
330 274.6327  13.35997 249.1034 301.9748
331 273.4938  13.11033 248.8734 298.9871
332 260.2807  12.29062 236.6192 284.8655
333 267.8658  12.71595 243.2445 293.1092
334 244.1079  12.26616 219.1638 267.5999
335 250.7024  13.37802 225.0382 277.2043
337 285.9288  13.31570 259.7698 312.4161
349 226.5739  12.82559 200.3874 251.5889
350 238.9771  13.19643 211.9345 263.8112
351 256.0183  12.34888 232.4188 281.1625
352 271.9786  12.56465 247.7174 296.7927
369 254.7018  12.45584 229.9509 278.9730
370 226.3734  13.22975 199.9722 251.5800
371 252.4005  12.50222 227.9318 277.6183
372 263.6252  12.10899 240.6556 287.7210

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6227047  2.497914 14.8031288 24.510124
309  1.8512623  2.555657 -3.1011713  6.817004
310  4.9492672  2.482222  0.1676861  9.834249
330  5.7345748  2.588036  0.3983948 10.641702
331  7.4160229  2.467276  2.6954274 12.259861
332 10.2329315  2.354445  5.5370432 14.787162
333 10.2792891  2.409512  5.4993183 14.930814
334 11.5427365  2.317161  6.9979133 15.995695
335 -0.2339863  2.623432 -5.3180618  4.898666
337 19.1953517  2.523806 14.1037127 24.086914
349 11.5108903  2.449005  6.7447089 16.501707
350 16.9635456  2.530504 12.1289412 22.044915
351  7.4521950  2.366955  2.7526493 12.102188
352 14.0626775  2.393602  9.3661205 18.641436
369 11.3429846  2.372070  6.6894884 15.917566
370 15.1612701  2.541086 10.2138267 20.123577
371  9.4412462  2.398365  4.8052990 14.138910
372 11.7598235  2.317266  7.0711398 16.240598</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9908 12.748282 228.4241 278.6487
  [2,] 273.6135 10.847973 251.8653 294.6879
  [3,] 293.2362  9.236746 275.1259 311.4308
  [4,] 312.8589  8.089226 297.4280 329.3060
  [5,] 332.4816  7.617929 318.1499 348.1019
  [6,] 352.1043  7.944133 337.1134 367.9937
  [7,] 371.7270  8.981360 354.2938 389.1485
  [8,] 391.3497 10.521385 370.4855 411.3378
  [9,] 410.9724 12.377941 386.7519 434.2625
 [10,] 430.5951 14.429360 402.6159 458.0554
 [11,] 211.1300 13.694486 184.1451 237.9738
 [12,] 212.9813 11.717617 190.0726 236.0769
 [13,] 214.8325 10.006444 195.3590 234.7998
 [14,] 216.6838  8.718834 200.1220 233.9670
 [15,] 218.5351  8.060396 203.5219 234.6406
 [16,] 220.3863  8.184415 205.0007 236.8820
 [17,] 222.2376  9.058813 205.0477 240.9131
 [18,] 224.0888 10.497728 204.3257 245.3645
 [19,] 225.9401 12.304684 203.1580 250.7523
 [20,] 227.7914 14.341234 200.9446 256.6206
 [21,] 212.9980 13.105258 186.6929 238.4209
 [22,] 217.9472 11.225794 195.6059 239.7895
 [23,] 222.8965  9.623512 203.7820 241.4634
 [24,] 227.8458  8.457443 211.3005 244.3113
 [25,] 232.7950  7.922598 217.1378 248.0352
 [26,] 237.7443  8.144300 221.8152 253.4311
 [27,] 242.6936  9.067223 224.7580 260.5826
 [28,] 247.6428 10.508202 226.8040 268.4966
 [29,] 252.5921 12.286290 228.5149 276.4621
 [30,] 257.5414 14.276077 229.9316 285.2194
 [31,] 274.6327 13.359971 249.1034 301.9748
 [32,] 280.3673 11.395337 258.2036 303.3470
 [33,] 286.1018  9.726996 266.9385 305.2184
 [34,] 291.8364  8.530594 275.0486 308.1412
 [35,] 297.5710  8.020192 282.0102 313.1300
 [36,] 303.3056  8.322966 287.2551 319.4138
 [37,] 309.0401  9.360338 290.9474 327.2209
 [38,] 314.7747 10.925014 293.4729 336.2573
 [39,] 320.5093 12.825436 295.1755 345.8113
 [40,] 326.2439 14.933972 296.8930 355.3681
 [41,] 273.4938 13.110327 248.8734 298.9871
 [42,] 280.9098 11.250638 259.7514 302.7592
 [43,] 288.3258  9.666847 270.0680 307.0200
 [44,] 295.7419  8.514336 279.3175 312.2255
 [45,] 303.1579  7.982155 287.4672 318.7000
 [46,] 310.5739  8.192105 294.3834 326.2291
 [47,] 317.9899  9.092925 299.7627 335.3728
 [48,] 325.4060 10.508420 304.4502 345.6005
 [49,] 332.8220 12.261623 308.9566 356.6239
 [50,] 340.2380 14.228239 312.1670 368.3489
 [51,] 260.2807 12.290617 236.6192 284.8655
 [52,] 270.5136 10.567325 249.6472 291.8028
 [53,] 280.7465  9.130403 262.4067 298.7711
 [54,] 290.9795  8.133080 274.9903 306.6027
 [55,] 301.2124  7.747035 285.9133 316.3973
 [56,] 311.4453  8.060579 295.5507 327.2418
 [57,] 321.6783  9.000897 304.3235 339.3047
 [58,] 331.9112 10.399336 311.8160 352.7105
 [59,] 342.1441 12.098060 318.5925 366.3163
 [60,] 352.3771 13.988093 324.8438 380.3174
 [61,] 267.8658 12.715950 243.2445 293.1092
 [62,] 278.1451 10.914215 257.1930 299.7582
 [63,] 288.4244  9.389159 269.8949 306.7034
 [64,] 298.7036  8.294818 282.6561 314.9703
 [65,] 308.9829  7.814294 293.6473 324.5070
 [66,] 319.2622  8.058157 303.1249 335.2051
 [67,] 329.5415  8.967501 311.4648 347.0079
 [68,] 339.8208 10.368692 318.9714 359.8663
 [69,] 350.1001 12.091937 326.0454 374.1147
 [70,] 360.3794 14.018974 332.4771 387.7376
 [71,] 244.1079 12.266159 219.1638 267.5999
 [72,] 255.6506 10.577319 234.3759 276.0203
 [73,] 267.1933  9.167287 248.6711 285.0502
 [74,] 278.7361  8.181510 262.4666 294.9221
 [75,] 290.2788  7.782900 274.7212 305.4092
 [76,] 301.8215  8.059058 285.8115 317.7060
 [77,] 313.3643  8.947724 295.8858 330.7539
 [78,] 324.9070 10.291433 305.0144 345.1433
 [79,] 336.4498 11.937499 312.9883 359.7755
 [80,] 347.9925 13.777977 320.9044 374.6588
 [81,] 250.7024 13.378024 225.0382 277.2043
 [82,] 250.4684 11.357455 228.8409 272.9919
 [83,] 250.2344  9.632075 231.7494 269.6232
 [84,] 250.0004  8.386103 233.6679 266.9409
 [85,] 249.7665  7.851202 234.4310 265.6107
 [86,] 249.5325  8.168282 233.8033 266.1234
 [87,] 249.2985  9.250139 231.5160 267.8133
 [88,] 249.0645 10.870791 228.3477 270.6217
 [89,] 248.8305 12.827624 224.5112 274.1066
 [90,] 248.5965 14.989549 219.8544 277.9625
 [91,] 285.9288 13.315699 259.7698 312.4161
 [92,] 305.1241 11.404423 282.7929 327.4077
 [93,] 324.3195  9.775127 305.1019 342.8834
 [94,] 343.5148  8.589792 327.0132 359.8102
 [95,] 362.7102  8.047058 346.8201 378.3633
 [96,] 381.9055  8.274356 365.2396 398.2482
 [97,] 401.1009  9.214878 382.7978 419.0077
 [98,] 420.2962 10.681862 399.3899 440.7302
 [99,] 439.4916 12.491179 414.7407 463.1661
[100,] 458.6869 14.515376 429.8312 486.5194
[101,] 226.5739 12.825590 200.3874 251.5889
[102,] 238.0847 11.006645 215.5944 259.5401
[103,] 249.5956  9.475862 230.5078 267.9130
[104,] 261.1065  8.392434 244.4817 277.4480
[105,] 272.6174  7.941610 256.8961 288.1543
[106,] 284.1283  8.228041 268.1243 300.2704
[107,] 295.6392  9.182994 277.8192 313.7312
[108,] 307.1501 10.627764 286.8991 328.2067
[109,] 318.6610 12.392199 294.7169 342.9536
[110,] 330.1719 14.358937 302.3504 358.8018
[111,] 238.9771 13.196434 211.9345 263.8112
[112,] 255.9407 11.256356 233.0785 277.3889
[113,] 272.9042  9.595424 253.8223 291.6979
[114,] 289.8678  8.381269 273.4547 306.4161
[115,] 306.8313  7.824711 291.5161 322.1490
[116,] 323.7949  8.063090 307.9830 339.1788
[117,] 340.7584  9.033695 322.9724 358.0751
[118,] 357.7220 10.536071 336.7666 377.7066
[119,] 374.6855 12.378078 349.7676 398.0701
[120,] 391.6490 14.430238 362.7637 419.3295
[121,] 256.0183 12.348884 232.4188 281.1625
[122,] 263.4705 10.622830 242.8272 285.3640
[123,] 270.9227  9.186896 252.9303 289.6670
[124,] 278.3749  8.195031 262.3816 294.7631
[125,] 285.8271  7.818117 270.3683 301.6186
[126,] 293.2793  8.142010 277.2526 309.2019
[127,] 300.7315  9.092120 282.6859 318.2606
[128,] 308.1837 10.499805 287.1641 328.7573
[129,] 315.6359 12.207790 290.9284 339.2367
[130,] 323.0881 14.107420 294.0570 350.4762
[131,] 271.9786 12.564647 247.7174 296.7927
[132,] 286.0412 10.805747 265.1544 307.3821
[133,] 300.1039  9.333629 281.9413 318.5949
[134,] 314.1666  8.302275 297.9495 330.7149
[135,] 328.2293  7.886543 313.3173 343.9467
[136,] 342.2920  8.180832 326.4690 358.3163
[137,] 356.3546  9.116640 338.6994 374.2631
[138,] 370.4173 10.524206 349.7864 390.7266
[139,] 384.4800 12.241869 360.3452 408.0287
[140,] 398.5427 14.157205 370.7122 425.9941
[141,] 254.7018 12.455844 229.9509 278.9730
[142,] 266.0448 10.734418 244.5513 286.9424
[143,] 277.3878  9.303809 259.1142 295.1421
[144,] 288.7308  8.315492 272.5362 304.7761
[145,] 300.0738  7.936460 284.3495 315.4631
[146,] 311.4168  8.251110 295.0760 327.5432
[147,] 322.7597  9.188453 304.5037 340.6468
[148,] 334.1027 10.584326 313.6080 354.8939
[149,] 345.4457 12.283390 321.8745 370.3069
[150,] 356.7887 14.177052 329.2497 384.9630
[151,] 226.3734 13.229753 199.9722 251.5800
[152,] 241.5346 11.254621 219.1866 262.8373
[153,] 256.6959  9.550962 237.8439 274.9628
[154,] 271.8572  8.287912 255.8225 288.0054
[155,] 287.0184  7.685853 272.1130 302.5329
[156,] 302.1797  7.897431 286.8091 317.5808
[157,] 317.3410  8.864577 300.2185 334.6182
[158,] 332.5022 10.378163 312.2852 352.4936
[159,] 347.6635 12.237077 323.5303 370.9585
[160,] 362.8248 14.307344 334.6483 390.2218
[161,] 252.4005 12.502218 227.9318 277.6183
[162,] 261.8418 10.759032 240.9044 283.1238
[163,] 271.2830  9.311950 253.1272 289.2397
[164,] 280.7243  8.316992 264.3430 296.9119
[165,] 290.1655  7.945855 274.3917 305.6557
[166,] 299.6068  8.282825 283.1253 315.6629
[167,] 309.0480  9.250842 290.8111 326.9919
[168,] 318.4893 10.679667 297.7607 339.2649
[169,] 327.9305 12.411156 303.8745 352.2203
[170,] 337.3718 14.336061 309.4448 365.1503
[171,] 263.6252 12.108991 240.6556 287.7210
[172,] 275.3850 10.436538 255.4712 296.4767
[173,] 287.1448  9.052868 270.0797 304.9755
[174,] 298.9046  8.107216 283.4686 315.1512
[175,] 310.6645  7.761375 295.5675 325.9200
[176,] 322.4243  8.092612 306.5116 337.9402
[177,] 334.1841  9.026696 316.6809 351.7692
[178,] 345.9439 10.402479 325.0648 366.2338
[179,] 357.7038 12.069852 333.2463 381.0357
[180,] 369.4636 13.924458 341.4631 396.6718</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5      Q97.5
  [1,]   -4.4307500 12.748282  -29.08868357  21.135865
  [2,]  -14.9087547 10.847973  -35.98315390   6.839363
  [3,]  -42.4355594  9.236746  -60.63020296 -24.325312
  [4,]    8.5809359  8.089226   -7.86616623  24.011753
  [5,]   24.3703312  7.617929    8.74996725  38.702037
  [6,]   62.5858266  7.944133   46.69641013  77.576710
  [7,]   10.4768219  8.981360   -6.94471385  27.910010
  [8,] -101.2010828 10.521385 -121.18921206 -80.336873
  [9,]   19.6129125 12.377941   -3.67715985  43.833352
 [10,]   35.7584078 14.429360    8.29809582  63.737554
 [11,]   11.6038922 13.694486  -15.23991851  38.588832
 [12,]   -7.7154701 11.717617  -30.81110642  15.193198
 [13,]  -11.8547324 10.006444  -31.82200394   7.618756
 [14,]  -11.9767947  8.718834  -29.25998092   4.585031
 [15,]  -10.8189570  8.060396  -26.92446158   4.194207
 [16,]   -4.4245193  8.184415  -20.92020209  10.961110
 [17,]   -8.6072816  9.058813  -27.28277094   8.582593
 [18,]   -6.3616439 10.497728  -27.63733345  13.401520
 [19,]   -1.6444062 12.304684  -26.45662259  21.137666
 [20,]    9.5228315 14.341234  -19.30640204  36.369613
 [21,]  -13.9440663 13.105258  -39.36703210  12.361007
 [22,]  -23.6150335 11.225794  -45.45731252  -1.273713
 [23,]   11.4234993  9.623512   -7.14341901  30.537986
 [24,]    4.9958321  8.457443  -11.46967903  21.541058
 [25,]   -3.4876351  7.922598  -18.72784830  12.169581
 [26,]  -17.2864023  8.144300  -32.97320775  -1.357265
 [27,]   -7.2727695  9.067223  -25.16178730  10.662827
 [28,]    8.1082634 10.508202  -12.74550433  28.947113
 [29,]    8.4203962 12.286290  -15.44957739  32.497623
 [30,]  -10.0260710 14.276077  -37.70408930  17.583687
 [31,]   46.9099224 13.359971   19.56783737  72.439222
 [32,]   20.0329476 11.395337   -2.94675582  42.196594
 [33,]   -2.2453272  9.726996  -21.36189370  16.918032
 [34,]   -6.7034021  8.530594  -23.00820314  10.084438
 [35,]  -11.7736769  8.020192  -27.33271954   3.787066
 [36,]   -5.7200518  8.322966  -21.82834643  10.330353
 [37,]  -28.8005266  9.360338  -46.98127557 -10.707781
 [38,]    3.4865985 10.925014  -17.99603502  24.788370
 [39,]  -15.1597763 12.825436  -40.46182427  10.173974
 [40,]   27.8048489 14.933972   -1.31943326  57.155676
 [41,]   14.1141017 13.110327  -11.37921813  38.734486
 [42,]    4.0901788 11.250638  -17.75922637  25.248590
 [43,]   13.4947559  9.666847   -5.19938203  31.752585
 [44,]   24.3734329  8.514336    7.88984957  40.797815
 [45,]   13.1194100  7.982155   -2.42271614  28.810087
 [46,]  -17.2552129  8.192105  -32.91037427  -1.064668
 [47,]  -27.9149358  9.092925  -45.29782164  -9.687714
 [48,]    9.4117413 10.508420  -10.78282514  30.367513
 [49,]  -39.0750816 12.261623  -62.87697976 -15.209657
 [50,]   31.3430954 14.228239    3.23223292  59.414063
 [51,]  -25.4200720 12.290617  -50.00487056  -1.758617
 [52,]  -27.7018035 10.567325  -48.99100871  -6.835405
 [53,]   -7.7852350  9.130403  -25.80983670  10.554575
 [54,]   18.7893336  8.133080    3.16611779  34.778529
 [55,]   16.2505021  7.747035    1.06562523  31.549555
 [56,]   -1.4477294  8.060579  -17.24422643  14.446924
 [57,]  132.4836392  9.000897  114.85720758 149.838365
 [58,]   14.9199077 10.399336   -5.87943516  35.015124
 [59,]  -11.8438238 12.098060  -36.01602209  11.707785
 [60,]  -98.5126553 13.988093 -126.45301188 -70.979404
 [61,]   15.9766271 12.715950   -9.26679773  40.597866
 [62,]   11.4099380 10.914215  -10.20315541  32.361986
 [63,]  -11.6550510  9.389159  -29.93409978   6.874387
 [64,]    1.1060599  8.294818  -15.16058108  17.153584
 [65,]  -11.8119291  7.814294  -27.33603439   3.523750
 [66,]   18.9042818  8.058157    2.96139098  35.041632
 [67,]    2.4849928  8.967501  -14.98139041  20.561700
 [68,]    9.0191037 10.368692  -11.02638947  29.868529
 [69,]  -16.7400853 12.091937  -40.75468808   7.314614
 [70,]    1.6634256 14.018974  -25.69483201  29.565734
 [71,]   21.3652332 12.266159   -2.12676118  46.309347
 [72,]   20.5505967 10.577319    0.18085278  41.825284
 [73,]  -23.8286398  9.167287  -41.68552517  -5.306418
 [74,]  -24.0637762  8.181510  -40.24984238  -7.794281
 [75,]  -11.2544127  7.782900  -26.38480257   4.303227
 [76,]  -17.6303492  8.059058  -33.51479124  -1.620298
 [77,]   -7.8394857  8.947724  -25.22909472   9.639013
 [78,]    6.6158779 10.291433  -13.62044335  26.508516
 [79,]   -0.7028586 11.937499  -24.02856018  22.758641
 [80,]   29.3065049 13.777977    2.64018928  56.394606
 [81,]   -9.0941085 13.378024  -35.59599351  16.570051
 [82,]   23.4787778 11.357455    0.95534909  45.106321
 [83,]    4.2562640  9.632075  -15.13253363  22.741287
 [84,]   20.8016503  8.386103    3.86122549  37.134178
 [85,]    1.6854366  7.851202  -14.15879640  17.020870
 [86,]    5.1037229  8.168282  -11.48721772  20.832930
 [87,]   -3.8461908  9.250139  -22.36099568  13.936257
 [88,]  -13.7535045 10.870791  -35.31073880   6.963338
 [89,]  -13.0764183 12.827624  -38.35249221  11.242935
 [90,]  -11.3499320 14.989549  -40.71588733  17.392214
 [91,]   26.4378452 13.315699   -0.04952594  52.596770
 [92,]    8.6816934 11.404423  -13.60189342  31.012941
 [93,]  -32.7082583  9.775127  -51.27217074 -13.490746
 [94,]    2.6073900  8.589792  -13.68803913  19.108964
 [95,]    3.0222383  8.047058  -12.63093214  18.912308
 [96,]    9.9329865  8.274356   -6.40971863  26.598946
 [97,]    3.1592348  9.214878  -14.74760416  21.462312
 [98,]   -3.6039169 10.681862  -24.03789027  17.302406
 [99,]   16.3727314 12.491179   -7.30179008  41.123564
[100,]    0.2297797 14.515376  -27.60274810  29.085454
[101,]    9.5293462 12.825590  -15.48572833  35.715812
[102,]   -7.7680441 11.006645  -29.22343363  14.722272
[103,]  -10.6700344  9.475862  -28.98738603   8.417778
[104,]   -6.1845248  8.392434  -22.52603298  10.440252
[105,]  -21.9071151  7.941610  -37.44396420  -6.185758
[106,]  -14.3539054  8.228041  -30.49597215   1.650136
[107,]  -14.0743958  9.182994  -32.16635465   3.745602
[108,]    0.9519139 10.627764  -20.10467708  21.202865
[109,]   17.6196235 12.392199   -6.67295886  41.563746
[110,]   21.4732332 14.358937   -7.15665816  49.294748
[111,]   17.3196639 13.196434   -7.51443697  44.362296
[112,]  -12.4863817 11.256356  -33.93460050  10.375841
[113,]  -16.6996273  9.595424  -35.49333945   2.382266
[114,]  -34.3406730  8.381269  -50.88899731 -17.927577
[115,]  -37.9148186  7.824711  -53.23250575 -22.599567
[116,]    5.9298358  8.063090   -9.45410984  21.741741
[117,]   38.6860901  9.033695   21.36935601  56.472079
[118,]    5.1964445 10.536071  -14.78823557  26.151770
[119,]   19.8016988 12.378078   -3.58286337  44.719600
[120,]   -2.5963468 14.430238  -30.27683509  26.289048
[121,]   -5.4918449 12.348884  -30.63599396  18.107730
[122,]   36.5870601 10.622830   14.69357180  57.230415
[123,]   -1.0288349  9.186896  -19.77305747  16.963592
[124,]    2.2141701  8.195031  -14.17399332  18.207466
[125,]  -13.9997249  7.818117  -29.79117213   1.459086
[126,]   11.3542801  8.142010   -4.56828169  27.380980
[127,]  -12.9849149  9.092120  -30.51397486   5.060746
[128,]  -41.5882099 10.499805  -62.16175316 -20.568571
[129,]    5.9058951 12.207790  -17.69494593  30.613383
[130,]   24.4774001 14.107420   -2.91073374  53.508451
[131,]  -50.3014652 12.564647  -75.11557478 -26.040281
[132,]   12.1526574 10.805747   -9.18822795  33.039535
[133,]   26.7745799  9.333629    8.28355049  44.937213
[134,]   32.6889024  8.302275   16.14058428  48.906050
[135,]   20.5109249  7.886543    4.79350664  35.422882
[136,]   10.5367474  8.180832   -5.48762137  26.359748
[137,]   -1.9280301  9.116640  -19.83651922  15.727215
[138,]   -9.9847076 10.524206  -30.29401136  10.646158
[139,]   -8.8393851 12.241869  -32.38811272  15.295400
[140,]  -10.0009625 14.157205  -37.45242705  17.829542
[141,]   17.2216706 12.455844   -7.04951498  41.972619
[142,]    2.3920860 10.734418  -18.50552395  23.885606
[143,]  -20.1453986  9.303809  -37.89967655  -1.871772
[144,]  -11.0741832  8.315492  -27.11952150   5.120416
[145,]   14.7484321  7.936460   -0.64094681  30.472711
[146,]    5.7967475  8.251110  -10.32970633  22.137456
[147,]  -24.6244371  9.188453  -42.51147082  -6.368412
[148,]   14.0201783 10.584326   -6.77102871  34.514853
[149,]   -5.1657063 12.283390  -30.02686461  18.405519
[150,]    9.7244091 14.177052  -18.44985518  37.263398
[151,]   -1.1093554 13.229753  -26.31598083  25.291759
[152,]   -7.0111255 11.254621  -28.31379956  15.336913
[153,]  -17.7950956  9.550962  -36.06195534   1.056874
[154,]  -31.3841656  8.287912  -47.53239274 -15.349496
[155,]  -19.4811357  7.685853  -34.99564503  -4.575686
[156,]   42.0139942  7.897431   26.61288371  57.384622
[157,]  -36.1928759  8.864577  -53.47011458 -19.070390
[158,]   15.0832540 10.378163   -4.90806707  35.300334
[159,]   17.4994839 12.237077   -5.79552039  41.632670
[160,]    9.4040138 14.307344  -17.99300126  37.580546
[161,]   17.4798623 12.502218   -7.73791108  41.948618
[162,]   10.6010161 10.759032  -10.68104642  31.538405
[163,]    6.6158699  9.311950  -11.34079981  24.771686
[164,]    1.0652238  8.316992  -15.12235988  17.446506
[165,]  -10.9950224  7.945855  -26.48516736   4.778763
[166,]  -15.0947686  8.282825  -31.15088492   1.386748
[167,]  -49.7822147  9.250842  -67.72610308 -31.545285
[168,]  -13.8586609 10.679667  -34.63434567   6.869922
[169,]   22.8501929 12.411156   -1.43957944  46.906206
[170,]   32.0974468 14.336061    4.31885178  60.024429
[171,]    5.7865217 12.108991  -18.30932601  28.756091
[172,]   -1.9110018 10.436538  -23.00268984  18.002750
[173,]   10.4519747  9.052868   -7.37871759  27.517135
[174,]   11.7269512  8.107216   -4.51959619  27.162954
[175,]  -23.4918723  7.761375  -38.74743378  -8.394929
[176,]    7.1833041  8.092612   -8.33261937  23.096000
[177,]    0.2976806  9.026696  -17.28737870  17.800853
[178,]   -2.7240429 10.402479  -23.01390221  18.155101
[179,]   11.4379336 12.069852  -11.89398086  35.895444
[180,]   -5.3399900 13.924458  -32.54819935  22.660458</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.3
p_loo        19.6  3.3
looic      1770.2 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   526       
 (0.5, 0.7]   (ok)         1    0.6%   223       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.2
p_loo        33.4  8.1
looic      1721.3 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   711       
 (0.5, 0.7]   (ok)         6    3.3%   676       
   (0.7, 1]   (bad)        3    1.7%   21        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.4      11.5  
fit_sleep1 -92.7      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.3
p_loo        19.6  3.3
looic      1770.2 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   526       
 (0.5, 0.7]   (ok)         1    0.6%   223       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.2
p_loo        33.4  8.1
looic      1721.3 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   711       
 (0.5, 0.7]   (ok)         6    3.3%   676       
   (0.7, 1]   (bad)        3    1.7%   21        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.7     22.2        33.4    8.1   1721.3
fit_sleep2  -24.4      11.5  -885.1     14.3        19.6    3.3   1770.2
fit_sleep1  -92.7      20.8  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   44.3  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
5.360338e-41 2.429222e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.99      1.54     0.41     5.51       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.01      1.54     -3.1     2.97       5.55      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.15      
[4] StanHeaders_2.26.15 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.0         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
