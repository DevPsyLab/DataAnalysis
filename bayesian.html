<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.09      6.97    15.51    43.24 1.00     1514     1901
sd(Days)                6.61      1.52     4.20    10.10 1.00     1555     2385
cor(Intercept,Days)     0.08      0.30    -0.47     0.67 1.00      973     1427

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.36      7.51   236.31   266.32 1.00     1732     2212
Days         10.27      1.73     6.77    13.66 1.00     1289     1955

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.88      1.56    23.06    29.16 1.00     3736     2768

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.8646  13.44635 227.1092 279.9393
309 211.8786  13.59554 185.2067 238.1634
310 212.8530  12.97628 187.5086 238.1260
330 274.7542  13.19846 250.0243 301.6530
331 273.5593  13.01521 249.0428 299.9678
332 260.5337  12.37735 236.3908 285.1298
333 267.7664  12.47293 243.0983 292.9066
334 244.1127  12.33775 219.1408 268.2613
335 250.8161  13.60184 224.1891 277.8818
337 286.1834  13.20588 259.5516 312.2947
349 226.9889  12.93846 201.2038 251.9193
350 238.5185  13.25241 211.6007 263.2621
351 255.9725  12.19916 231.6736 280.7069
352 272.0735  12.69491 248.1687 297.6623
369 254.4179  12.29611 230.6293 278.3807
370 226.0209  13.52132 199.6308 252.4078
371 252.3617  12.21285 227.9063 276.1421
372 263.5528  12.30912 238.9281 287.8749

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6225554  2.545389 14.6543532 24.741214
309  1.7166781  2.570278 -3.4114350  6.781411
310  4.9369557  2.455615  0.1555840  9.961506
330  5.6952042  2.511906  0.8546772 10.478305
331  7.4043539  2.503773  2.4106862 12.160661
332 10.1673579  2.352480  5.5051925 14.799020
333 10.3128214  2.349840  5.6737759 14.961124
334 11.5339510  2.368029  7.0169995 16.208533
335 -0.2881807  2.623288 -5.4957755  4.825706
337 19.0921761  2.488148 14.3483471 23.925596
349 11.5512882  2.460170  6.8980324 16.430837
350 17.0219044  2.504541 12.3205699 22.051352
351  7.4204831  2.315332  2.8173961 11.951980
352 14.0594801  2.416683  9.1626865 18.754631
369 11.3627767  2.359570  6.7094732 15.989850
370 15.2597879  2.549135 10.3452952 20.418104
371  9.4744667  2.305513  4.8682328 13.918878
372 11.7926270  2.341181  7.1641822 16.347408</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.8646 13.446347 227.1092 279.9393
  [2,] 273.4871 11.490557 250.3996 295.9503
  [3,] 293.1097  9.809157 273.5822 312.1994
  [4,] 312.7323  8.565294 295.8344 329.6116
  [5,] 332.3548  7.966615 317.1851 347.7333
  [6,] 351.9774  8.156449 336.1003 367.9169
  [7,] 371.5999  9.085504 353.7407 389.5494
  [8,] 391.2225 10.560451 370.4773 411.8583
  [9,] 410.8450 12.387811 386.7911 435.0090
 [10,] 430.4676 14.434356 402.5394 458.3216
 [11,] 211.8786 13.595540 185.2067 238.1634
 [12,] 213.5953 11.647185 190.7503 236.7653
 [13,] 215.3119  9.984378 195.4418 235.4800
 [14,] 217.0286  8.771052 199.4797 234.8229
 [15,] 218.7453  8.208993 202.5610 235.1043
 [16,] 220.4620  8.429498 203.9927 237.0237
 [17,] 222.1786  9.377525 203.7093 240.2872
 [18,] 223.8953 10.864261 202.8841 245.2364
 [19,] 225.6120 12.701929 200.8182 250.8649
 [20,] 227.3287 14.760031 198.3555 256.7896
 [21,] 212.8530 12.976284 187.5086 238.1260
 [22,] 217.7900 11.111331 196.2667 239.7658
 [23,] 222.7270  9.518377 204.1341 241.5729
 [24,] 227.6639  8.354485 211.7126 244.0316
 [25,] 232.6009  7.813797 217.7472 247.6746
 [26,] 237.5378  8.023310 222.1930 253.2273
 [27,] 242.4748  8.930380 225.2253 260.0469
 [28,] 247.4117 10.353259 226.6975 267.9433
 [29,] 252.3487 12.111496 228.2516 276.2793
 [30,] 257.2856 14.080014 229.1941 285.2495
 [31,] 274.7542 13.198457 250.0243 301.6530
 [32,] 280.4494 11.324283 259.0674 303.5059
 [33,] 286.1446  9.741603 267.6905 305.6514
 [34,] 291.8398  8.612642 275.2666 308.6533
 [35,] 297.5350  8.128698 281.2055 313.1341
 [36,] 303.2303  8.401977 286.1199 319.2795
 [37,] 308.9255  9.366431 290.2710 327.2792
 [38,] 314.6207 10.839105 293.3781 336.0064
 [39,] 320.3159 12.643642 295.6448 345.2953
 [40,] 326.0111 14.657985 297.7260 354.5829
 [41,] 273.5593 13.015214 249.0428 299.9678
 [42,] 280.9637 11.121780 259.7869 303.1728
 [43,] 288.3680  9.514724 269.8499 307.4095
 [44,] 295.7724  8.360844 279.3717 312.2289
 [45,] 303.1767  7.862265 287.7442 318.2395
 [46,] 310.5811  8.140298 294.5276 326.0659
 [47,] 317.9855  9.124224 299.8798 335.2473
 [48,] 325.3898 10.619616 304.5335 345.5282
 [49,] 332.7942 12.443422 308.4456 356.3453
 [50,] 340.1985 14.472009 311.5351 367.6303
 [51,] 260.5337 12.377353 236.3908 285.1298
 [52,] 270.7011 10.658357 250.0037 292.0165
 [53,] 280.8685  9.223372 263.1122 299.0164
 [54,] 291.0358  8.222467 275.4131 307.0107
 [55,] 301.2032  7.824042 286.2270 316.6749
 [56,] 311.3705  8.117305 295.6374 327.4182
 [57,] 321.5379  9.035152 304.0839 339.3973
 [58,] 331.7052 10.413723 311.3014 352.4395
 [59,] 341.8726 12.096512 318.6370 365.4778
 [60,] 352.0400 13.974044 325.2642 379.1761
 [61,] 267.7664 12.472927 243.0983 292.9066
 [62,] 278.0792 10.744823 257.1224 299.7165
 [63,] 288.3921  9.293655 270.4182 306.7427
 [64,] 298.7049  8.266579 282.3803 314.4261
 [65,] 309.0177  7.832249 293.2515 323.8181
 [66,] 319.3305  8.086743 303.2746 334.6131
 [67,] 329.6433  8.971633 312.1787 346.9491
 [68,] 339.9562 10.326107 319.9734 359.8306
 [69,] 350.2690 11.992091 326.9600 373.8478
 [70,] 360.5818 13.857688 333.5597 387.7901
 [71,] 244.1127 12.337751 219.1408 268.2613
 [72,] 255.6466 10.573888 234.3525 276.5449
 [73,] 267.1806  9.088962 249.2009 285.1974
 [74,] 278.7145  8.039059 263.0732 294.5697
 [75,] 290.2485  7.606500 275.3309 305.0396
 [76,] 301.7824  7.893436 286.2872 317.0933
 [77,] 313.3164  8.830003 296.0824 330.4010
 [78,] 324.8503 10.239467 305.3891 344.3673
 [79,] 336.3843 11.955732 313.2322 359.5152
 [80,] 347.9182 13.865335 321.4777 374.9322
 [81,] 250.8161 13.601844 224.1891 277.8818
 [82,] 250.5279 11.560361 228.0852 273.3466
 [83,] 250.2397  9.799848 231.0127 269.3383
 [84,] 249.9515  8.496787 233.2499 266.2141
 [85,] 249.6633  7.881434 234.2374 264.8870
 [86,] 249.3752  8.111838 233.4091 265.1702
 [87,] 249.0870  9.124149 231.4018 267.1038
 [88,] 248.7988 10.698670 227.9672 270.1474
 [89,] 248.5106 12.626808 223.9497 273.4393
 [90,] 248.2224 14.770724 219.6920 277.1594
 [91,] 286.1834 13.205878 259.5516 312.2947
 [92,] 305.2756 11.331624 282.6150 327.4554
 [93,] 324.3678  9.736424 305.3488 343.6252
 [94,] 343.4600  8.577411 326.5151 360.3625
 [95,] 362.5521  8.045356 346.6221 378.1238
 [96,] 381.6443  8.262282 365.5932 397.2975
 [97,] 400.7365  9.175216 382.8797 418.5259
 [98,] 419.8287 10.605926 399.4563 440.7321
 [99,] 438.9208 12.376125 414.5807 463.3909
[100,] 458.0130 14.360817 429.4978 486.5509
[101,] 226.9889 12.938459 201.2038 251.9193
[102,] 238.5402 11.083209 216.4894 260.0173
[103,] 250.0914  9.506639 230.8942 268.5358
[104,] 261.6427  8.367779 245.1457 278.2931
[105,] 273.1940  7.859271 257.9326 288.7736
[106,] 284.7453  8.100705 269.2324 301.2094
[107,] 296.2966  9.032142 278.9196 314.8635
[108,] 307.8479 10.471038 288.1175 328.6573
[109,] 319.3992 12.239712 296.4248 343.5730
[110,] 330.9505 14.215602 304.0423 359.1849
[111,] 238.5185 13.252410 211.6007 263.2621
[112,] 255.5404 11.355133 232.4563 276.6378
[113,] 272.5623  9.736384 252.7706 290.9361
[114,] 289.5842  8.555743 272.5700 306.1368
[115,] 306.6061  8.009355 291.1099 322.6034
[116,] 323.6280  8.224613 307.7331 339.9557
[117,] 340.6499  9.147906 323.4962 358.5400
[118,] 357.6718 10.595734 337.6620 378.9520
[119,] 374.6937 12.385492 350.9338 399.5617
[120,] 391.7157 14.390160 363.7557 421.0137
[121,] 255.9725 12.199161 231.6736 280.7069
[122,] 263.3930 10.492907 242.4413 284.4119
[123,] 270.8135  9.061138 252.3643 288.3368
[124,] 278.2340  8.051637 262.1769 293.5136
[125,] 285.6544  7.633808 270.9416 300.0384
[126,] 293.0749  7.902070 278.0134 308.4148
[127,] 300.4954  8.793858 283.7444 317.8958
[128,] 307.9159 10.146068 288.4077 328.1144
[129,] 315.3364 11.801482 292.6941 338.5891
[130,] 322.7569 13.650230 296.7063 349.9252
[131,] 272.0735 12.694911 248.1687 297.6623
[132,] 286.1329 10.913057 265.5144 308.1775
[133,] 300.1924  9.418576 282.2104 318.9455
[134,] 314.2519  8.366902 297.8698 330.8044
[135,] 328.3114  7.936072 312.9858 343.8819
[136,] 342.3709  8.224241 326.3298 358.5233
[137,] 356.4303  9.163829 338.4421 374.4361
[138,] 370.4898 10.582726 348.9733 390.9668
[139,] 384.5493 12.316377 359.5066 408.2248
[140,] 398.6088 14.250365 369.5582 425.8579
[141,] 254.4179 12.296114 230.6293 278.3807
[142,] 265.7807 10.607664 245.3425 286.7884
[143,] 277.1435  9.218773 259.3919 295.7109
[144,] 288.5063  8.281556 272.5691 305.3241
[145,] 299.8691  7.957242 284.5404 315.8448
[146,] 311.2318  8.317834 295.1328 327.7282
[147,] 322.5946  9.283866 304.4922 340.6716
[148,] 333.9574 10.692479 313.0517 354.8368
[149,] 345.3202 12.393676 321.0393 369.2435
[150,] 356.6829 14.283292 328.5781 384.7281
[151,] 226.0209 13.521319 199.6308 252.4078
[152,] 241.2807 11.536674 218.6615 263.6555
[153,] 256.5405  9.816304 237.3581 275.4383
[154,] 271.8003  8.521795 255.1773 288.5317
[155,] 287.0601  7.866278 271.7831 302.4282
[156,] 302.3199  8.008236 287.1072 317.9338
[157,] 317.5797  8.909632 300.5432 334.6157
[158,] 332.8395 10.374363 312.8050 352.7940
[159,] 348.0992 12.201208 324.3255 372.0232
[160,] 363.3590 14.251586 335.1003 391.2529
[161,] 252.3617 12.212848 227.9063 276.1421
[162,] 261.8362 10.526310 240.3606 282.6548
[163,] 271.3107  9.115016 252.8062 289.5032
[164,] 280.7851  8.123707 264.9730 296.7438
[165,] 290.2596  7.715989 274.8182 304.9848
[166,] 299.7341  7.981801 283.8003 315.0723
[167,] 309.2085  8.860732 291.3899 326.1109
[168,] 318.6830 10.195429 298.1176 338.2452
[169,] 328.1575 11.832657 304.6585 350.7743
[170,] 337.6319 13.664096 310.6057 363.9521
[171,] 263.5528 12.309117 238.9281 287.8749
[172,] 275.3454 10.579165 254.4396 296.0834
[173,] 287.1380  9.126082 269.0891 305.2933
[174,] 298.9307  8.100264 283.2371 314.9118
[175,] 310.7233  7.674987 295.8553 325.8183
[176,] 322.5159  7.947253 306.9310 337.8591
[177,] 334.3085  8.852937 316.9101 351.6158
[178,] 346.1012 10.225088 325.5147 366.0335
[179,] 357.8938 11.903470 334.0711 381.2852
[180,] 369.6864 13.776612 342.3621 396.9797</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.3045922 13.446347 -3.037927e+01  22.4508037
  [2,]  -14.7824476 11.490557 -3.724563e+01   8.3051367
  [3,]  -42.3091031  9.809157 -6.139879e+01 -22.7816420
  [4,]    8.7075415  8.565294 -8.171795e+00  25.6054121
  [5,]   24.4970860  7.966615  9.118567e+00  39.6667810
  [6,]   62.7127306  8.156449  4.677321e+01  78.5898248
  [7,]   10.6038751  9.085504 -7.345584e+00  28.4630887
  [8,] -101.0738803 10.560451 -1.217097e+02 -80.3286967
  [9,]   19.7402642 12.387811 -4.423693e+00  43.7941699
 [10,]   35.8859088 14.434356  8.031875e+00  63.8141290
 [11,]   10.8553207 13.595540 -1.542955e+01  37.5272199
 [12,]   -8.3294574 11.647185 -3.149947e+01  14.5154885
 [13,]  -12.3341355  9.984378 -3.250224e+01   7.5359664
 [14,]  -12.3216137  8.771052 -3.011585e+01   5.2273426
 [15,]  -11.0291918  8.208993 -2.738818e+01   5.1550731
 [16,]   -4.5001699  8.429498 -2.106189e+01  11.9690758
 [17,]   -8.5483480  9.377525 -2.665690e+01   9.9209982
 [18,]   -6.1681262 10.864261 -2.750915e+01  14.8430979
 [19,]   -1.3163043 12.701929 -2.656921e+01  23.4774623
 [20,]    9.9855176 14.760031 -1.947536e+01  38.9587332
 [21,]  -13.7991398 12.976284 -3.907209e+01  11.5453254
 [22,]  -23.4577955 11.111331 -4.543355e+01  -1.9345142
 [23,]   11.5930488  9.518377 -7.252862e+00  30.1859478
 [24,]    5.1776931  8.354485 -1.119003e+01  21.1289579
 [25,]   -3.2934625  7.813797 -1.836723e+01  11.5601605
 [26,]  -17.0799182  8.023310 -3.276944e+01  -1.7351449
 [27,]   -7.0539739  8.930380 -2.462610e+01  10.1955181
 [28,]    8.3393704 10.353259 -1.219218e+01  29.0536177
 [29,]    8.6638147 12.111496 -1.526683e+01  32.7609103
 [30,]   -9.7703410 14.080014 -3.773418e+01  18.3211848
 [31,]   46.7883690 13.198457  1.988959e+01  71.5182612
 [32,]   19.9507648 11.324283 -3.105738e+00  41.3327753
 [33,]   -2.2881395  9.741603 -2.179491e+01  16.1660251
 [34,]   -6.7068437  8.612642 -2.352033e+01   9.8663954
 [35,]  -11.7377479  8.128698 -2.733681e+01   4.5918448
 [36,]   -5.6447522  8.401977 -2.169404e+01  11.4655693
 [37,]  -28.6858564  9.366431 -4.703963e+01 -10.0313978
 [38,]    3.6406394 10.839105 -1.774507e+01  24.8832307
 [39,]  -14.9663649 12.643642 -3.994582e+01   9.7046841
 [40,]   28.0376309 14.657985 -5.342432e-01  56.3226862
 [41,]   14.0485721 13.015214 -1.235986e+01  38.5650570
 [42,]    4.0363182 11.121780 -1.817282e+01  25.2130568
 [43,]   13.4525643  9.514724 -5.588907e+00  31.9707063
 [44,]   24.3429104  8.360844  7.886433e+00  40.7435568
 [45,]   13.1005565  7.862265 -1.962161e+00  28.5331341
 [46,]  -17.2623974  8.140298 -3.274724e+01  -1.2089034
 [47,]  -27.9104513  9.124224 -4.517226e+01  -9.8047720
 [48,]    9.4278948 10.619616 -1.071046e+01  30.2841926
 [49,]  -39.0472591 12.443422 -6.259841e+01 -14.6986729
 [50,]   31.3825870 14.472009  3.950835e+00  60.0460029
 [51,]  -25.6731415 12.377353 -5.026921e+01  -1.5302220
 [52,]  -27.8892994 10.658357 -4.920469e+01  -7.1918985
 [53,]   -7.9071572  9.223372 -2.605509e+01   9.8491363
 [54,]   18.7329849  8.222467  2.758093e+00  34.3557127
 [55,]   16.2597270  7.824042  7.880048e-01  31.2359016
 [56,]   -1.3729308  8.117305 -1.742060e+01  14.3602196
 [57,]  132.6240113  9.035152  1.147646e+02 150.0779666
 [58,]   15.1258535 10.413723 -5.608412e+00  35.5297010
 [59,]  -11.5723044 12.096512 -3.517752e+01  11.6632547
 [60,]  -98.1755623 13.974044 -1.253117e+02 -71.3998485
 [61,]   16.0759888 12.472927 -9.064187e+00  40.7440644
 [62,]   11.4757674 10.744823 -1.016147e+01  32.4326477
 [63,]  -11.6227540  9.293655 -2.997339e+01   6.3511458
 [64,]    1.1048246  8.266579 -1.461644e+01  17.4294425
 [65,]  -11.8466968  7.832249 -2.664715e+01   3.9194513
 [66,]   18.8359818  8.086743  3.553415e+00  34.8919440
 [67,]    2.3831604  8.971633 -1.492264e+01  19.8478265
 [68,]    8.8837389 10.326107 -1.099072e+01  28.8664938
 [69,]  -16.9089825 11.992091 -4.048776e+01   6.4000217
 [70,]    1.4609961 13.857688 -2.574735e+01  28.4831101
 [71,]   21.3604121 12.337751 -2.788191e+00  46.3322891
 [72,]   20.5545611 10.573888 -3.437183e-01  41.8487191
 [73,]  -23.8158899  9.088962 -4.183275e+01  -5.8361885
 [74,]  -24.0422410  8.039059 -3.989738e+01  -8.4008841
 [75,]  -11.2240920  7.606500 -2.601520e+01   3.6935329
 [76,]  -17.5912430  7.893436 -3.290207e+01  -2.0960376
 [77,]   -7.7915941  8.830003 -2.487624e+01   9.4424244
 [78,]    6.6725549 10.239467 -1.284442e+01  26.1338469
 [79,]   -0.6373961 11.955732 -2.376831e+01  22.5147107
 [80,]   29.3807528 13.865335  2.366752e+00  55.8212745
 [81,]   -9.2077639 13.601844 -3.627352e+01  17.4192381
 [82,]   23.4193168 11.560361  6.006300e-01  45.8619716
 [83,]    4.2509975  9.799848 -1.484759e+01  23.4779513
 [84,]   20.8505783  8.496787  4.588023e+00  37.5522271
 [85,]    1.7885590  7.881434 -1.343511e+01  17.2145345
 [86,]    5.2610397  8.111838 -1.053402e+01  21.2271438
 [87,]   -3.6346795  9.124149 -2.165152e+01  14.0504571
 [88,]  -13.4877988 10.698670 -3.483641e+01   7.3437831
 [89,]  -12.7565181 12.626808 -3.768517e+01  11.8044321
 [90,]  -10.9758374 14.770724 -3.991278e+01  17.5546401
 [91,]   26.1831690 13.205878  7.191764e-02  52.8150437
 [92,]    8.5301929 11.331624 -1.364961e+01  31.1907554
 [93,]  -32.7565832  9.736424 -5.201397e+01 -13.7376490
 [94,]    2.6622407  8.577411 -1.424034e+01  19.6071491
 [95,]    3.1802646  8.045356 -1.239143e+01  19.1102820
 [96,]   10.1941885  8.262282 -5.458997e+00  26.2452502
 [97,]    3.5236124  9.175216 -1.426580e+01  21.3803795
 [98,]   -3.1363637 10.605926 -2.403980e+01  17.2360189
 [99,]   16.9434602 12.376125 -7.526560e+00  41.2836186
[100,]    0.9036841 14.360817 -2.763419e+01  29.4189344
[101,]    9.1143313 12.938459 -1.581612e+01  34.8993943
[102,]   -8.2234569 11.083209 -2.970062e+01  13.8272756
[103,]  -11.1658451  9.506639 -2.961023e+01   8.0314093
[104,]   -6.7207333  8.367779 -2.337111e+01   9.7763153
[105,]  -22.4837215  7.859271 -3.806326e+01  -7.2223362
[106,]  -14.9709097  8.100705 -3.143504e+01   0.5420147
[107,]  -14.7317980  9.032142 -3.329874e+01   2.6451955
[108,]    0.2541138 10.471038 -2.055525e+01  19.9845123
[109,]   16.8814256 12.239712 -7.292425e+00  39.8558158
[110,]   20.6946374 14.215602 -7.539819e+00  47.6027956
[111,]   17.7782862 13.252410 -6.965259e+00  44.6961112
[112,]  -12.0861182 11.355133 -3.318346e+01  10.9979650
[113,]  -16.3577225  9.736384 -3.473145e+01   3.4339602
[114,]  -34.0571269  8.555743 -5.060970e+01 -17.0428958
[115,]  -37.6896313  8.009355 -5.368687e+01 -22.1934118
[116,]    6.0966644  8.224613 -1.023101e+01  21.9915584
[117,]   38.7945600  9.147906  2.090452e+01  55.9482810
[118,]    5.2465557 10.595734 -1.603364e+01  25.2563938
[119,]   19.7934513 12.385492 -5.074490e+00  43.5534355
[120,]   -2.6629531 14.390160 -3.196102e+01  25.2970321
[121,]   -5.4460164 12.199161 -3.018044e+01  18.8529452
[122,]   36.6646004 10.492907  1.564574e+01  57.6162972
[123,]   -0.9195827  9.061138 -1.844295e+01  17.5296409
[124,]    2.3551342  8.051637 -1.292452e+01  18.4121643
[125,]  -13.8270489  7.633808 -2.821097e+01   0.8857529
[126,]   11.5586680  7.902070 -3.781233e+00  26.6202453
[127,]  -12.7488151  8.793858 -3.014924e+01   4.0022312
[128,]  -41.3203982 10.146068 -6.151893e+01 -21.8122475
[129,]    6.2054187 11.801482 -1.704734e+01  28.8477241
[130,]   24.8086355 13.650230 -2.359720e+00  50.8591617
[131,]  -50.3963537 12.694911 -7.598518e+01 -26.4916074
[132,]   12.0609662 10.913057 -9.983588e+00  32.6795076
[133,]   26.6860861  9.418576  7.932971e+00  44.6680955
[134,]   32.6036060  8.366902  1.605106e+01  48.9856546
[135,]   20.4288259  7.936072  4.858348e+00  35.7544337
[136,]   10.4578458  8.224241 -5.694634e+00  26.4989000
[137,]   -2.0037343  9.163829 -2.000951e+01  15.9844975
[138,]  -10.0572144 10.582726 -3.053416e+01  11.4592640
[139,]   -8.9086946 12.316377 -3.258421e+01  16.1339676
[140,]  -10.0670747 14.250365 -3.731619e+01  18.9835312
[141,]   17.5055521 12.296114 -6.457169e+00  41.2942052
[142,]    2.6561755 10.607664 -1.835155e+01  23.0944095
[143,]  -19.9011012  9.218773 -3.846847e+01  -2.1494900
[144,]  -10.8496779  8.281556 -2.766748e+01   5.0875406
[145,]   14.9531455  7.957242 -1.022632e+00  30.2818438
[146,]    5.9816688  8.317834 -1.051468e+01  22.0806968
[147,]  -24.4593078  9.283866 -4.253627e+01  -6.3568794
[148,]   14.1655155 10.692479 -6.713876e+00  35.0711870
[149,]   -5.0401612 12.393676 -2.896351e+01  19.2407109
[150,]    9.8301622 14.283292 -1.821500e+01  37.9350405
[151,]   -0.7569362 13.521319 -2.714381e+01  25.6331549
[152,]   -6.7572241 11.536674 -2.913202e+01  15.8619826
[153,]  -17.6397120  9.816304 -3.653751e+01   1.5427317
[154,]  -31.3273000  8.521795 -4.805867e+01 -14.7043381
[155,]  -19.5227879  7.866278 -3.489091e+01  -4.2458215
[156,]   41.8738241  8.008236  2.625993e+01  57.0865435
[157,]  -36.4315638  8.909632 -5.346759e+01 -19.3950955
[158,]   14.7460483 10.374363 -5.208461e+00  34.7805337
[159,]   17.0637603 12.201208 -6.860177e+00  40.8375144
[160,]    8.8697724 14.251586 -1.902414e+01  37.1284536
[161,]   17.5186823 12.212848 -6.261689e+00  41.9741417
[162,]   10.6066157 10.526310 -1.021199e+01  32.0822470
[163,]    6.5882490  9.115016 -1.160427e+01  25.0926779
[164,]    1.0043823  8.123707 -1.495427e+01  16.8165019
[165,]  -11.0890843  7.715989 -2.581434e+01   4.3523103
[166,]  -15.2220510  7.981801 -3.056027e+01   0.7117025
[167,]  -49.9427176  8.860732 -6.684509e+01 -32.1240948
[168,]  -14.0523843 10.195429 -3.361458e+01   6.5130463
[169,]   22.6232491 11.832657  6.444925e-03  46.1221866
[170,]   31.8372824 13.664096  5.517098e+00  58.8634776
[171,]    5.8589239 12.309117 -1.846321e+01  30.4836354
[172,]   -1.8714031 10.579165 -2.260941e+01  19.0344156
[173,]   10.4587699  9.126082 -7.696532e+00  28.5077454
[174,]   11.7009429  8.100264 -4.280184e+00  27.3944751
[175,]  -23.5506841  7.674987 -3.864566e+01  -8.6826896
[176,]    7.0916890  7.947253 -8.251530e+00  22.6766314
[177,]    0.1732620  8.852937 -1.713404e+01  17.5717323
[178,]   -2.8812650 10.225088 -2.281363e+01  17.7052446
[179,]   11.2479080 11.903470 -1.214345e+01  35.0705856
[180,]   -5.5628190 13.776612 -3.285610e+01  21.7615228</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 5 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.3
p_loo        19.4  3.3
looic      1769.8 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   567       
 (0.5, 0.7]   (ok)         1    0.6%   96        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.2
p_loo        33.7  8.2
looic      1721.3 44.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     168   93.3%   1329      
 (0.5, 0.7]   (ok)         7    3.9%   448       
   (0.7, 1]   (bad)        3    1.7%   81        
   (1, Inf)   (very bad)   2    1.1%   13        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.2      11.5  
fit_sleep1 -92.7      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 5 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.3
p_loo        19.4  3.3
looic      1769.8 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   567       
 (0.5, 0.7]   (ok)         1    0.6%   96        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.2
p_loo        33.7  8.2
looic      1721.3 44.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     168   93.3%   1329      
 (0.5, 0.7]   (ok)         7    3.9%   448       
   (0.7, 1]   (bad)        3    1.7%   81        
   (1, Inf)   (very bad)   2    1.1%   13        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.7     22.2        33.7    8.2   1721.3
fit_sleep2  -24.2      11.5  -884.9     14.3        19.4    3.3   1769.8
fit_sleep1  -92.7      20.8  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.4  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
5.439439e-41 3.008762e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.94      1.61     0.28     5.58       0.04      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.06      1.61    -3.21     3.05       5.22      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.62.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.2          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        ggridges_0.5.4       callr_3.7.3         
 [34] stringr_1.4.1        digest_0.6.30        minqa_1.2.5         
 [37] rmarkdown_2.18       base64enc_0.1-3      pkgconfig_2.0.3     
 [40] htmltools_0.5.3      highr_0.9            fastmap_1.1.0       
 [43] htmlwidgets_1.5.4    rlang_1.0.6          shiny_1.7.3         
 [46] jquerylib_0.1.4      farver_2.1.1         generics_0.1.3      
 [49] zoo_1.8-11           jsonlite_1.8.3       gtools_3.9.3        
 [52] crosstalk_1.2.0      dplyr_1.0.10         distributional_0.3.1
 [55] inline_0.3.19        magrittr_2.0.3       loo_2.5.1           
 [58] bayesplot_1.9.0      munsell_0.5.0        fansi_1.0.3         
 [61] abind_1.4-5          lifecycle_1.0.3      stringi_1.7.8       
 [64] yaml_2.3.6           MASS_7.3-58.1        plyr_1.8.8          
 [67] pkgbuild_1.3.1       grid_4.2.2           parallel_4.2.2      
 [70] promises_1.2.0.1     crayon_1.5.2         miniUI_0.1.1.1      
 [73] lattice_0.20-45      splines_4.2.2        knitr_1.40          
 [76] ps_1.7.2             pillar_1.8.1         igraph_1.3.5        
 [79] boot_1.3-28          markdown_1.3         shinystan_2.6.0     
 [82] reshape2_1.4.4       codetools_0.2-18     stats4_4.2.2        
 [85] rstantools_2.2.0     glue_1.6.2           evaluate_0.18       
 [88] V8_4.2.1             RcppParallel_5.1.5   vctrs_0.5.0         
 [91] nloptr_2.0.3         httpuv_1.6.6         gtable_0.3.1        
 [94] assertthat_0.2.1     cachem_1.0.6         ggplot2_3.4.0       
 [97] xfun_0.34            mime_0.12            xtable_1.8-4        
[100] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[103] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
