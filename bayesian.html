<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.82      6.83    15.69    42.35 1.00     1681     2415
sd(Days)                6.46      1.46     4.11     9.88 1.00     1508     2085
cor(Intercept,Days)     0.09      0.30    -0.48     0.66 1.00     1002     1330

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.10      7.69   235.59   265.96 1.00     1602     1830
Days         10.35      1.66     7.03    13.53 1.00     1417     1937

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.58    23.10    29.32 1.00     3662     2845

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0925  13.36823 227.7809 279.3805
309 211.6774  13.07483 186.3974 237.3478
310 213.1058  13.07890 187.5692 238.1755
330 274.1682  13.56393 247.9976 301.1823
331 273.1223  12.85789 248.7721 298.7093
332 260.2522  12.48316 235.9080 284.5650
333 267.8896  12.39745 244.3792 293.1720
334 244.5427  12.23839 219.4491 267.7177
335 250.3762  13.55459 224.5003 278.1647
337 286.3273  12.96791 260.8845 312.4651
349 227.0721  13.05901 201.0200 251.5262
350 239.2491  12.97158 213.1090 263.0239
351 255.9184  12.40529 231.8392 280.6799
352 272.1287  12.23747 248.2956 296.5181
369 254.6254  12.03193 230.8523 278.3078
370 226.6322  13.64693 199.4851 252.4680
371 252.2835  12.22660 227.1932 276.7369
372 263.4022  12.35678 239.5687 287.6533

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5960841  2.594810 14.5170296 24.757103
309  1.7401506  2.477574 -3.1074691  6.642922
310  4.9487394  2.449674  0.2425254  9.708204
330  5.8457208  2.556061  0.5995415 10.739792
331  7.4831898  2.485537  2.5583163 12.432336
332 10.2274486  2.336637  5.6605684 14.757360
333 10.2892984  2.371975  5.4439358 14.941140
334 11.4789121  2.345193  7.0018620 16.307396
335 -0.1456873  2.626791 -5.3503637  4.978646
337 19.1226925  2.453493 14.2350051 24.047105
349 11.4665387  2.448061  6.7175993 16.300717
350 16.9174112  2.481316 12.2509832 21.819074
351  7.4888601  2.376698  2.7724902 12.114391
352 14.0114180  2.383271  9.3123347 18.717491
369 11.3591667  2.353759  6.7483068 16.141436
370 15.1682415  2.544489 10.3690182 20.216161
371  9.4848456  2.310065  5.0344791 14.116521
372 11.7737969  2.327822  7.1053593 16.323172</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0925 13.368227 227.7809 279.3805
  [2,] 273.6886 11.391864 251.3571 295.3002
  [3,] 293.2847  9.711113 274.3775 312.0317
  [4,] 312.8808  8.503115 296.3656 329.8095
  [5,] 332.4768  7.985379 317.0624 348.2130
  [6,] 352.0729  8.288286 335.9297 368.6448
  [7,] 371.6690  9.332264 352.9785 389.8694
  [8,] 391.2651 10.906545 369.6225 412.4276
  [9,] 410.8612 12.817190 385.3970 435.8870
 [10,] 430.4573 14.935665 400.3933 459.4813
 [11,] 211.6774 13.074827 186.3974 237.3478
 [12,] 213.4176 11.221466 191.5679 235.5946
 [13,] 215.1577  9.652371 196.3942 234.6184
 [14,] 216.8979  8.525958 200.4053 233.9105
 [15,] 218.6380  8.030716 202.8960 234.6403
 [16,] 220.3782  8.280675 204.0101 236.7765
 [17,] 222.1183  9.215395 204.1467 240.1220
 [18,] 223.8585 10.656180 203.2421 244.6343
 [19,] 225.5986 12.428258 201.4476 250.0908
 [20,] 227.3388 14.409918 199.0179 255.7786
 [21,] 213.1058 13.078897 187.5692 238.1755
 [22,] 218.0546 11.245324 196.4083 239.5583
 [23,] 223.0033  9.688079 204.4137 241.5324
 [24,] 227.9521  8.559337 211.6401 244.5143
 [25,] 232.9008  8.041605 217.5287 248.8884
 [26,] 237.8495  8.250721 222.0643 254.3460
 [27,] 242.7983  9.136913 225.1627 260.8386
 [28,] 247.7470 10.530611 227.2777 268.1374
 [29,] 252.6958 12.259942 228.5580 276.1594
 [30,] 257.6445 14.202830 229.6990 284.6566
 [31,] 274.1682 13.563927 247.9976 301.1823
 [32,] 280.0140 11.582612 257.2096 303.1661
 [33,] 285.8597  9.869174 266.6799 305.6191
 [34,] 291.7054  8.585522 274.3850 308.4725
 [35,] 297.5511  7.942838 281.4731 312.9982
 [36,] 303.3968  8.095249 287.2444 318.9372
 [37,] 309.2426  9.002463 291.0653 325.7848
 [38,] 315.0883 10.470077 294.3320 334.4048
 [39,] 320.9340 12.299089 296.1854 343.6163
 [40,] 326.7797 14.351989 297.8549 353.1691
 [41,] 273.1223 12.857890 248.7721 298.7093
 [42,] 280.6055 10.978964 259.8153 302.3603
 [43,] 288.0887  9.386467 270.1401 306.3642
 [44,] 295.5719  8.248009 279.5937 311.9758
 [45,] 303.0551  7.765909 287.8466 318.1216
 [46,] 310.5383  8.058834 295.1214 326.5560
 [47,] 318.0215  9.051854 300.5225 336.4891
 [48,] 325.5047 10.549081 305.2094 347.2533
 [49,] 332.9878 12.368749 309.1739 358.5615
 [50,] 340.4710 14.389043 312.8696 370.3868
 [51,] 260.2522 12.483162 235.9080 284.5650
 [52,] 270.4797 10.761357 249.4051 291.4779
 [53,] 280.7071  9.311499 262.5141 299.1583
 [54,] 290.9346  8.277740 274.6219 307.7682
 [55,] 301.1620  7.826729 285.9721 316.4516
 [56,] 311.3895  8.056931 295.3246 327.0181
 [57,] 321.6169  8.915735 303.8179 338.6162
 [58,] 331.8444 10.246280 311.5294 351.6117
 [59,] 342.0718 11.891255 318.5009 365.2315
 [60,] 352.2992 13.738172 325.2845 379.6333
 [61,] 267.8896 12.397449 244.3792 293.1720
 [62,] 278.1789 10.661170 257.5775 299.4687
 [63,] 288.4682  9.212864 270.1711 306.8272
 [64,] 298.7575  8.206444 282.1287 314.9928
 [65,] 309.0468  7.814546 293.1363 324.6835
 [66,] 319.3361  8.126565 302.9300 335.6771
 [67,] 329.6254  9.070144 311.5381 347.9180
 [68,] 339.9147 10.475997 318.8271 361.5123
 [69,] 350.2040 12.185157 325.8384 375.1130
 [70,] 360.4933 14.087659 331.8654 389.1012
 [71,] 244.5427 12.238388 219.4491 267.7177
 [72,] 256.0217 10.539961 234.4218 276.1422
 [73,] 267.5006  9.132538 248.7694 285.2713
 [74,] 278.9795  8.167962 262.5789 294.8873
 [75,] 290.4584  7.812029 274.7240 305.5814
 [76,] 301.9373  8.144929 285.5731 318.0992
 [77,] 313.4162  9.091303 295.2806 331.7045
 [78,] 324.8951 10.486352 304.3422 345.7876
 [79,] 336.3740 12.176832 312.8922 360.2582
 [80,] 347.8530 14.056555 320.8537 375.7476
 [81,] 250.3762 13.554590 224.5003 278.1647
 [82,] 250.2305 11.527857 228.0074 273.3057
 [83,] 250.0848  9.790614 231.3239 269.4724
 [84,] 249.9392  8.521785 234.0127 266.9017
 [85,] 249.7935  7.948935 234.5608 265.8296
 [86,] 249.6478  8.218904 234.0928 266.1588
 [87,] 249.5021  9.258253 231.8344 268.2126
 [88,] 249.3564 10.848049 228.6210 270.9104
 [89,] 249.2107 12.784567 224.7235 275.3221
 [90,] 249.0650 14.933526 220.4822 279.2134
 [91,] 286.3273 12.967908 260.8845 312.4651
 [92,] 305.4500 11.148743 283.5091 327.5535
 [93,] 324.5727  9.615694 305.6952 343.9083
 [94,] 343.6954  8.524549 326.7811 360.8838
 [95,] 362.8181  8.056894 346.8383 378.6267
 [96,] 381.9408  8.318558 365.5116 398.2404
 [97,] 401.0635  9.247839 383.2906 419.1451
 [98,] 420.1862 10.671734 399.2990 441.4746
 [99,] 439.3089 12.421294 415.0066 464.1368
[100,] 458.4316 14.378123 430.6879 486.8371
[101,] 227.0721 13.059005 201.0200 251.5262
[102,] 238.5386 11.206408 216.1408 259.6240
[103,] 250.0052  9.623696 230.7950 268.5353
[104,] 261.4717  8.463657 245.0226 277.9648
[105,] 272.9382  7.914384 258.1223 288.4788
[106,] 284.4048  8.101077 268.7759 299.9990
[107,] 295.8713  8.977942 278.4006 313.1268
[108,] 307.3378 10.371376 287.2507 327.8304
[109,] 318.8044 12.104274 294.9793 342.4836
[110,] 330.2709 14.051600 302.8217 357.7291
[111,] 239.2491 12.971581 213.1090 263.0239
[112,] 256.1665 11.099786 233.8866 276.7420
[113,] 273.0839  9.511176 254.2725 291.3160
[114,] 290.0013  8.368604 273.4445 306.2303
[115,] 306.9187  7.868828 291.8667 322.5277
[116,] 323.8362  8.131250 307.9030 340.3621
[117,] 340.7536  9.090097 323.0584 358.6254
[118,] 357.6710 10.557290 337.3273 378.3355
[119,] 374.5884 12.353005 350.6221 398.5615
[120,] 391.5058 14.354474 364.0776 419.4005
[121,] 255.9184 12.405290 231.8392 280.6799
[122,] 263.4073 10.674757 242.7291 284.9425
[123,] 270.8962  9.236182 252.8947 289.5848
[124,] 278.3850  8.243849 262.3572 295.1257
[125,] 285.8739  7.868444 270.4628 301.7098
[126,] 293.3627  8.195192 277.5818 309.9935
[127,] 300.8516  9.149169 283.1250 319.0074
[128,] 308.3405 10.561762 287.6795 329.0580
[129,] 315.8293 12.275656 291.9015 339.6924
[130,] 323.3182 14.182031 295.3921 350.7994
[131,] 272.1287 12.237467 248.2956 296.5181
[132,] 286.1402 10.488693 266.0381 306.9826
[133,] 300.1516  9.034917 282.6448 318.2721
[134,] 314.1630  8.037831 298.6874 330.3912
[135,] 328.1744  7.677480 313.4379 343.7144
[136,] 342.1858  8.039940 326.4677 358.3286
[137,] 356.1973  9.038669 338.2332 374.4492
[138,] 370.2087 10.493540 349.3473 391.1357
[139,] 384.2201 12.243007 360.1661 408.7946
[140,] 398.2315 14.178434 370.2159 426.1066
[141,] 254.6254 12.031926 230.8523 278.3078
[142,] 265.9845 10.322700 245.2271 286.1024
[143,] 277.3437  8.912317 259.7814 294.5759
[144,] 288.7029  7.961219 273.1475 303.8983
[145,] 300.0620  7.642839 284.9884 315.2082
[146,] 311.4212  8.032766 295.6197 327.6321
[147,] 322.7804  9.039804 305.0634 341.0623
[148,] 334.1395 10.487666 313.3151 355.3072
[149,] 345.4987 12.220662 321.4357 370.0187
[150,] 356.8579 14.134298 329.6423 385.0310
[151,] 226.6322 13.646931 199.4851 252.4680
[152,] 241.8005 11.677555 218.2532 263.8054
[153,] 256.9687  9.971996 236.9144 275.8287
[154,] 272.1370  8.687058 254.7825 288.7482
[155,] 287.3052  8.027334 271.5236 302.9406
[156,] 302.4734  8.146168 286.4628 318.3622
[157,] 317.6417  9.012817 299.9965 335.4334
[158,] 332.8099 10.442726 312.6493 353.3685
[159,] 347.9782 12.240059 324.5124 371.4844
[160,] 363.1464 14.266619 335.8141 390.5875
[161,] 252.2835 12.226598 227.1932 276.7369
[162,] 261.7683 10.531689 240.6920 282.8602
[163,] 271.2532  9.111314 253.3230 289.2941
[164,] 280.7380  8.111006 264.7334 296.7074
[165,] 290.2229  7.696336 274.9188 305.0398
[166,] 299.7077  7.959370 283.9024 315.1657
[167,] 309.1925  8.839815 291.6502 326.5027
[168,] 318.6774 10.178698 298.9967 338.5890
[169,] 328.1622 11.821263 305.5172 351.5715
[170,] 337.6471 13.658383 311.4785 364.6531
[171,] 263.4022 12.356775 239.5687 287.6533
[172,] 275.1760 10.693127 254.2067 296.1300
[173,] 286.9498  9.318451 268.6693 305.4583
[174,] 298.7236  8.376252 282.5235 315.1843
[175,] 310.4974  8.020422 294.8606 326.2058
[176,] 322.2712  8.326479 305.9734 338.5849
[177,] 334.0450  9.228805 315.5907 351.9220
[178,] 345.8188 10.575866 324.3964 366.9257
[179,] 357.5926 12.221479 333.6130 381.7764
[180,] 369.3664 14.061211 341.7137 397.2192</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.5324988 13.368227  -29.82046098  21.7790938
  [2,]  -14.9838830 11.391864  -36.59551287   7.3476472
  [3,]  -42.4840671  9.711113  -61.23105559 -23.5769074
  [4,]    8.5590488  8.503115   -8.36967013  25.0742019
  [5,]   24.3750646  7.985379    8.63889384  39.7894703
  [6,]   62.6171805  8.288286   46.04533442  78.7604013
  [7,]   10.5347964  9.332264   -7.66563004  29.2252812
  [8,] -101.1164877 10.906545 -122.27899222 -79.4739290
  [9,]   19.7241281 12.817190   -5.30166215  45.1883266
 [10,]   35.8962440 14.935665    6.87223962  65.9601949
 [11,]   11.0564906 13.074827  -14.61386560  36.3364744
 [12,]   -8.1517600 11.221466  -30.32881055  13.6979087
 [13,]  -12.1799106  9.652371  -31.64058370   6.5835990
 [14,]  -12.1908612  8.525958  -29.20347580   4.3017210
 [15,]  -10.9219118  8.030716  -26.92416980   4.8200544
 [16,]   -4.4163623  8.280675  -20.81465010  11.9516647
 [17,]   -8.4880129  9.215395  -26.49172307   9.4836017
 [18,]   -6.1312635 10.656180  -26.90713346  14.4850551
 [19,]   -1.3029141 12.428258  -25.79505973  22.8480903
 [20,]    9.9754353 14.409918  -18.46444748  38.2963431
 [21,]  -14.0519372 13.078897  -39.12157800  11.4846863
 [22,]  -23.7223766 11.245324  -45.22608730  -2.0761219
 [23,]   11.3166840  9.688079   -7.21236847  29.9062582
 [24,]    4.8895447  8.559337  -11.67273639  21.2014569
 [25,]   -3.5933947  8.041605  -19.58096165  11.7786585
 [26,]  -17.3916341  8.250721  -33.88814281  -1.6064261
 [27,]   -7.3774735  9.136913  -25.41778914  10.2580588
 [28,]    8.0040871 10.530611  -12.38633920  28.4733658
 [29,]    8.3167477 12.259942  -15.14692569  32.4545267
 [30,]  -10.1291916 14.202830  -37.14134799  17.8163164
 [31,]   47.3743624 13.563927   20.36026406  73.5450326
 [32,]   20.3862416 11.582612   -2.76587495  43.1905993
 [33,]   -2.0031792  9.869174  -21.76262631  17.1766273
 [34,]   -6.5724000  8.585522  -23.33948048  10.7480108
 [35,]  -11.7538208  7.942838  -27.20085031   4.3241860
 [36,]   -5.8113416  8.095249  -21.35174745  10.3411184
 [37,]  -29.0029624  9.002463  -45.54520614 -10.8257390
 [38,]    3.1730169 10.470077  -16.14345394  23.9292548
 [39,]  -15.5845039 12.299089  -38.26680701   9.1641167
 [40,]   27.2689753 14.351989    0.87963667  56.1938022
 [41,]   14.4855717 12.857890  -11.10144536  38.8358150
 [42,]    4.3944819 10.978964  -17.36031597  25.1846666
 [43,]   13.7318921  9.386467   -4.54359066  31.6805179
 [44,]   24.5434022  8.248009    8.13945215  40.5216047
 [45,]   13.2222124  7.765909   -1.84426612  28.4306820
 [46,]  -17.2195774  8.058834  -33.23733088  -1.8026906
 [47,]  -27.9464672  9.051854  -46.41414643 -10.4475094
 [48,]    9.3130430 10.549081  -12.43562406  29.6082673
 [49,]  -39.2409468 12.368749  -64.81456299 -15.4270093
 [50,]   31.1100634 14.389043    1.19426729  58.7114569
 [51,]  -25.3916127 12.483162  -49.70439822  -1.0474205
 [52,]  -27.6678612 10.761357  -48.66609765  -6.5932529
 [53,]   -7.7458098  9.311499  -26.19698840  10.4471646
 [54,]   18.8342416  8.277740    2.00064185  35.1469359
 [55,]   16.3008931  7.826729    1.01134660  31.4908314
 [56,]   -1.3918555  8.056931  -17.02052544  14.6730138
 [57,]  132.5449959  8.915735  115.54567175 150.3439790
 [58,]   14.9867474 10.246280   -4.78061323  35.3017200
 [59,]  -11.7715012 11.891255  -34.93116025  11.7994090
 [60,]  -98.4348498 13.738172 -125.76889732 -71.4200881
 [61,]   15.9528253 12.397449   -9.32964075  39.4631940
 [62,]   11.3761269 10.661170   -9.91370241  31.9775324
 [63,]  -11.6988715  9.212864  -30.05792485   6.5982312
 [64,]    1.0522301  8.206444  -15.18313844  17.6810038
 [65,]  -11.8757682  7.814546  -27.51251615   4.0347152
 [66,]   18.8304334  8.126565    2.48944012  35.2365175
 [67,]    2.4011350  9.070144  -15.89153593  20.4884104
 [68,]    8.9252366 10.475997  -12.67244549  30.0127584
 [69,]  -16.8439617 12.185157  -41.75300555   7.5216433
 [70,]    1.5495399 14.087659  -27.05840558  30.1774101
 [71,]   20.9303568 12.238388   -2.24459113  46.0239524
 [72,]   20.1795447 10.539961    0.05899966  41.7793866
 [73,]  -24.1358674  9.132538  -41.90655044  -5.4046800
 [74,]  -24.3071795  8.167962  -40.21498319  -7.9065985
 [75,]  -11.4339916  7.812029  -26.55699547   4.3004291
 [76,]  -17.7461037  8.144929  -33.90798325  -1.3818688
 [77,]   -7.8914158  9.091303  -26.17971005  10.2442435
 [78,]    6.6277722 10.486352  -14.26466846  27.1807387
 [79,]   -0.6271399 12.176832  -24.51129109  22.8547221
 [80,]   29.4460480 14.056555    1.55143572  56.4453225
 [81,]   -8.7679217 13.554590  -36.55639447  17.1079938
 [82,]   23.7166656 11.527857    0.64146733  45.9398472
 [83,]    4.4058529  9.790614  -14.98168707  23.1667615
 [84,]   20.8629402  8.521785    3.90040062  36.7893660
 [85,]    1.6584275  7.948935  -14.37769131  16.8910874
 [86,]    4.9884148  8.218904  -11.52258833  20.5433927
 [87,]   -4.0497979  9.258253  -22.76032730  13.6179344
 [88,]  -14.0454106 10.848049  -35.59943792   6.6899724
 [89,]  -13.4566232 12.784567  -39.56801205  11.0305968
 [90,]  -11.8184359 14.933526  -41.96683667  16.7643792
 [91,]   26.0392779 12.967908   -0.09848959  51.4821125
 [92,]    8.3557854 11.148743  -13.74769230  30.2966766
 [93,]  -32.9615071  9.615694  -52.29706014 -14.0840226
 [94,]    2.4268005  8.524549  -14.76162845  19.3411150
 [95,]    2.9143080  8.056894  -12.89429620  18.8940713
 [96,]    9.8977156  8.318558   -6.40187333  26.3269203
 [97,]    3.1966231  9.247839  -14.88499605  20.9694884
 [98,]   -3.4938694 10.671734  -24.78228923  17.3933427
 [99,]   16.5554382 12.421294   -8.27250322  40.8576896
[100,]    0.4851457 14.378123  -27.92036093  28.2287739
[101,]    9.0311214 13.059005  -15.42296478  35.0831925
[102,]   -8.2219172 11.206408  -29.30731874  14.1758998
[103,]  -11.0795559  9.623696  -29.60972642   8.1305791
[104,]   -6.5496945  8.463657  -23.04283469   9.8994081
[105,]  -22.2279332  7.914384  -37.76845448  -7.4120240
[106,]  -14.6303719  8.101077  -30.22457512   0.9985423
[107,]  -14.3065105  8.977942  -31.56202594   3.1641713
[108,]    0.7641508 10.371376  -19.72840225  20.8512691
[109,]   17.4762122 12.104274   -6.20301021  41.3012877
[110,]   21.3741735 14.051600   -6.08399346  48.8233864
[111,]   17.0476988 12.971581   -6.72707231  43.1878377
[112,]  -12.7122124 11.099786  -33.28766286   9.5676521
[113,]  -16.8793236  9.511176  -35.11143073   1.9321128
[114,]  -34.4742348  8.368604  -50.70320499 -17.9173732
[115,]  -38.0022460  7.868828  -53.61119419 -22.9502399
[116,]    5.8885429  8.131250  -10.63735118  21.8216505
[117,]   38.6909317  9.090097   20.81912902  56.3860936
[118,]    5.2474205 10.557290  -15.41714404  25.5911136
[119,]   19.8988093 12.353005   -4.07433988  43.8650514
[120,]   -2.4531019 14.354474  -30.34781557  24.9750501
[121,]   -5.3919416 12.405290  -30.15342639  18.6872985
[122,]   36.6502983 10.674757   15.11511947  57.3285362
[123,]   -1.0022618  9.236182  -19.69090529  16.9991789
[124,]    2.2040780  8.243849  -14.53663361  18.2319160
[125,]  -14.0464821  7.868444  -29.88242567   1.3646308
[126,]   11.2708578  8.195192   -5.35992127  27.0518187
[127,]  -13.1050024  9.149169  -31.26077403   4.6215515
[128,]  -41.7449625 10.561762  -62.46252957 -21.0839693
[129,]    5.7124773 12.275656  -18.15063684  29.6402683
[130,]   24.2473172 14.182031   -3.23387754  52.1733970
[131,]  -50.4516439 12.237467  -74.84099421 -26.6185485
[132,]   12.0537381 10.488693   -8.78867741  32.1558126
[133,]   26.7269201  9.034917    8.60639007  44.2337197
[134,]   32.6925021  8.037831   16.46433614  48.1681327
[135,]   20.5657842  7.677480    5.02578111  35.3023023
[136,]   10.6428662  8.039940   -5.49994052  26.3610068
[137,]   -1.7706518  9.038669  -20.02257314  16.1934318
[138,]   -9.7760698 10.493540  -30.70308825  11.0852693
[139,]   -8.5794878 12.243007  -33.15396530  15.4745019
[140,]   -9.6898057 14.178434  -37.56485464  18.3257888
[141,]   17.2981238 12.031926   -6.38432913  41.0711667
[142,]    2.4523570 10.322700  -17.66553060  23.2097847
[143,]  -20.1013097  8.912317  -37.33351349  -2.5390210
[144,]  -11.0462764  7.961219  -26.24167491   4.5090854
[145,]   14.7601569  7.642839   -0.38600515  29.8338303
[146,]    5.7922902  8.032766  -10.41863193  21.5937519
[147,]  -24.6450766  9.039804  -42.92703923  -6.9280902
[148,]   13.9833567 10.487666   -7.18432372  34.8078303
[149,]   -5.2187100 12.220662  -29.73872931  18.8443418
[150,]    9.6552233 14.134298  -18.51792652  36.8708132
[151,]   -1.3682277 13.646931  -27.20402256  25.7788790
[152,]   -7.2769692 11.677555  -29.28190868  16.2702700
[153,]  -18.0679106  9.971996  -36.92794102   1.9863639
[154,]  -31.6639521  8.687058  -48.27520687 -14.3094626
[155,]  -19.7678936  8.027334  -35.40333126  -3.9863257
[156,]   41.7202650  8.146168   25.83149628  57.7309450
[157,]  -36.4935765  9.012817  -54.28534944 -18.8484367
[158,]   14.7755820 10.442726   -5.78295605  34.9362103
[159,]   17.1848406 12.240059   -6.32136931  40.6505527
[160,]    9.0823991 14.266619  -18.35871880  36.4146608
[161,]   17.5969272 12.226598   -6.85653092  42.6871795
[162,]   10.6744816 10.531689  -10.41740823  31.7507682
[163,]    6.6457360  9.111314  -11.39524977  24.5759309
[164,]    1.0514904  8.111006  -14.91793454  17.0560984
[165,]  -11.0523551  7.696336  -25.86933172   4.2516603
[166,]  -15.1957007  7.959370  -30.65367809   0.6096192
[167,]  -49.9267463  8.839815  -67.23692710 -32.3843793
[168,]  -14.0467918 10.178698  -33.95842613   5.6339111
[169,]   22.6184626 11.821263   -0.79083815  45.2635418
[170,]   31.8221170 13.658383    4.81612726  57.9907224
[171,]    6.0095172 12.356775  -18.24158542  29.8429624
[172,]   -1.7019797 10.693127  -22.65597518  19.2673375
[173,]   10.6470234  9.318451   -7.86146661  28.9274931
[174,]   11.9080264  8.376252   -4.55269021  28.1081459
[175,]  -23.3247705  8.020422  -39.03318209  -7.6879509
[176,]    7.3364326  8.326479   -8.97734688  23.6341550
[177,]    0.4368357  9.228805  -17.44017576  18.8911424
[178,]   -2.5988612 10.575866  -23.70583443  18.8235492
[179,]   11.5491418 12.221479  -12.63474635  35.5287166
[180,]   -5.2427551 14.061211  -33.09558666  22.4099303</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.1  0.5
looic      1906.5 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.3
p_loo        19.3  3.2
looic      1769.8 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   580       
 (0.5, 0.7]   (ok)         1    0.6%   236       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.6
p_loo        34.6  8.7
looic      1723.4 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   958       
 (0.5, 0.7]   (ok)         7    3.9%   444       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   3    1.7%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.2      12.0  
fit_sleep1 -91.6      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.1  0.5
looic      1906.5 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.3
p_loo        19.3  3.2
looic      1769.8 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   580       
 (0.5, 0.7]   (ok)         1    0.6%   236       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.6
p_loo        34.6  8.7
looic      1723.4 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   958       
 (0.5, 0.7]   (ok)         7    3.9%   444       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   3    1.7%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.7     22.6        34.6    8.7   1723.4
fit_sleep2  -23.2      12.0  -884.9     14.3        19.3    3.2   1769.8
fit_sleep1  -91.6      21.2  -953.3     10.5         3.1    0.5   1906.5
           se_looic
fit_sleep3   45.1  
fit_sleep2   28.6  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.698944e-40 8.202320e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.56     0.27     5.34       0.04      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.56     -3.3     2.86       5.45      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.3.5         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.0       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
