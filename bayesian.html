<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.93      6.70    15.89    42.41 1.00     1851     2552
sd(Days)                6.54      1.51     4.13    10.05 1.00     1508     2028
cor(Intercept,Days)     0.10      0.30    -0.48     0.68 1.00      966     1708

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.26      7.44   236.36   266.18 1.00     2099     2648
Days         10.35      1.68     7.05    13.61 1.00     1276     1926

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.94      1.54    23.09    29.19 1.00     3201     2648

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.1382  13.00891 227.0091 278.7391
309 211.5247  13.09950 186.1592 237.3708
310 213.0943  13.23158 186.4412 238.5893
330 274.3670  13.20130 248.7927 300.1113
331 273.2236  12.68344 248.2611 298.9433
332 260.1372  12.18710 236.5561 284.6936
333 268.2305  12.84495 243.1908 293.7206
334 244.4828  12.46329 220.2374 268.8222
335 250.5213  13.50857 224.8786 277.8420
337 286.0137  13.02395 260.5724 311.8752
349 226.6228  12.90366 200.8867 251.3577
350 238.9042  13.37050 212.5838 263.9406
351 255.8304  12.42089 232.3132 280.1739
352 271.9861  12.77521 246.7393 297.6056
369 254.5592  12.13336 231.0142 277.7411
370 226.6577  13.54319 199.7046 251.8551
371 251.9133  12.25914 227.9884 276.5795
372 263.6505  12.16090 240.2735 287.8345

, , Days

     Estimate Est.Error       Q2.5     Q97.5
308 19.571530  2.495609 14.8304459 24.676252
309  1.799462  2.505248 -3.1414810  6.651142
310  4.913125  2.474975  0.1947502  9.946570
330  5.771493  2.518811  0.8304110 10.623543
331  7.478774  2.434728  2.7537864 12.081610
332 10.243826  2.346487  5.5384701 14.688226
333 10.247282  2.455176  5.2577328 14.990908
334 11.509964  2.369409  6.9107527 16.192136
335 -0.223058  2.569753 -5.3510675  4.709812
337 19.142396  2.480305 14.3423850 23.996048
349 11.526482  2.453601  6.7658045 16.443867
350 16.987278  2.509053 12.1257514 21.982436
351  7.490071  2.353794  2.7757270 11.947342
352 14.024084  2.406960  9.2948691 18.656159
369 11.343609  2.319034  6.7818578 15.908978
370 15.170592  2.555900 10.1441385 20.167591
371  9.492986  2.344686  4.8149033 14.160604
372 11.795323  2.321995  7.2990775 16.180138</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.1382 13.008911 227.0091 278.7391
  [2,] 273.7098 11.107630 250.7496 294.8863
  [3,] 293.2813  9.485950 273.7373 311.4386
  [4,] 312.8528  8.309224 296.3068 328.8635
  [5,] 332.4244  7.781984 317.0631 347.6093
  [6,] 351.9959  8.033149 336.2949 368.2045
  [7,] 371.5674  8.997767 354.4556 389.7168
  [8,] 391.1389 10.480662 371.1508 412.4956
  [9,] 410.7105 12.295726 387.3193 435.2753
 [10,] 430.2820 14.317178 402.8094 458.8307
 [11,] 211.5247 13.099503 186.1592 237.3708
 [12,] 213.3241 11.198834 191.4862 235.1045
 [13,] 215.1236  9.580361 195.7987 233.8182
 [14,] 216.9231  8.408643 200.3287 233.5239
 [15,] 218.7225  7.885415 203.1123 234.4640
 [16,] 220.5220  8.136755 204.8359 237.0662
 [17,] 222.3214  9.098700 204.8355 240.1959
 [18,] 224.1209 10.579150 203.8039 244.8919
 [19,] 225.9204 12.393669 202.1567 250.0148
 [20,] 227.7198 14.416663 199.8906 255.7235
 [21,] 213.0943 13.231577 186.4412 238.5893
 [22,] 218.0074 11.372381 195.5665 240.0458
 [23,] 222.9205  9.789714 203.7323 241.9869
 [24,] 227.8337  8.636953 210.9831 244.8276
 [25,] 232.7468  8.099778 217.0764 248.5566
 [26,] 237.6599  8.298606 221.5416 253.9971
 [27,] 242.5730  9.185768 224.5692 260.8777
 [28,] 247.4862 10.589655 226.8219 268.5540
 [29,] 252.3993 12.335083 228.8654 276.7201
 [30,] 257.3124 14.297509 230.0942 285.8813
 [31,] 274.3670 13.201297 248.7927 300.1113
 [32,] 280.1385 11.294416 257.9774 302.3218
 [33,] 285.9100  9.671724 266.8252 304.7152
 [34,] 291.6815  8.497616 275.0099 308.3196
 [35,] 297.4530  7.972798 281.8271 313.3682
 [36,] 303.2245  8.222553 286.7933 319.4386
 [37,] 308.9959  9.183901 290.5454 326.9747
 [38,] 314.7674 10.666140 293.2063 335.1821
 [39,] 320.5389 12.485105 295.5591 344.6915
 [40,] 326.3104 14.514750 297.5196 355.0431
 [41,] 273.2236 12.683445 248.2611 298.9433
 [42,] 280.7024 10.873513 259.6918 302.2672
 [43,] 288.1812  9.351610 269.8768 306.6691
 [44,] 295.6599  8.278148 279.6418 311.8059
 [45,] 303.1387  7.839557 287.7974 318.1886
 [46,] 310.6175  8.139126 294.4509 326.3675
 [47,] 318.0963  9.104280 300.1417 335.9404
 [48,] 325.5750 10.553968 305.2303 346.2587
 [49,] 333.0538 12.318294 309.1636 356.8354
 [50,] 340.5326 14.281117 312.5390 368.2837
 [51,] 260.1372 12.187098 236.5561 284.6936
 [52,] 270.3811 10.493914 249.3990 291.7505
 [53,] 280.6249  9.095665 262.3582 298.5351
 [54,] 290.8687  8.145675 274.8934 306.6720
 [55,] 301.1126  7.809283 285.7430 316.2063
 [56,] 311.3564  8.162708 295.0901 327.3609
 [57,] 321.6002  9.126155 303.6032 339.7873
 [58,] 331.8440 10.533547 311.3117 352.8555
 [59,] 342.0879 12.232601 317.5946 366.4426
 [60,] 352.3317 14.118408 324.6007 379.5841
 [61,] 268.2305 12.844954 243.1908 293.7206
 [62,] 278.4778 10.992472 257.0608 300.4224
 [63,] 288.7251  9.419755 270.5603 307.3363
 [64,] 298.9724  8.287637 282.9176 315.1289
 [65,] 309.2197  7.790625 294.1713 324.3443
 [66,] 319.4669  8.047268 303.3170 334.8905
 [67,] 329.7142  8.993275 312.1114 347.0342
 [68,] 339.9615 10.442952 319.4346 360.1899
 [69,] 350.2088 12.218317 326.2575 373.6607
 [70,] 360.4561 14.197713 332.6926 387.9799
 [71,] 244.4828 12.463289 220.2374 268.8222
 [72,] 255.9927 10.686632 234.9880 276.6735
 [73,] 267.5027  9.181656 249.1243 285.3065
 [74,] 279.0127  8.101218 263.0875 294.7989
 [75,] 290.5226  7.627899 275.7969 305.4309
 [76,] 302.0326  7.871985 286.3281 317.2625
 [77,] 313.5426  8.773805 296.2079 330.3350
 [78,] 325.0525 10.159693 304.9100 344.4986
 [79,] 336.5625 11.861167 313.8131 359.5876
 [80,] 348.0724 13.761663 321.4278 375.0401
 [81,] 250.5213 13.508569 224.8786 277.8420
 [82,] 250.2983 11.525893 228.0039 273.7170
 [83,] 250.0752  9.819280 231.2664 269.6988
 [84,] 249.8521  8.555558 233.4105 266.3095
 [85,] 249.6291  7.948846 234.3262 264.9979
 [86,] 249.4060  8.147269 233.4680 265.2770
 [87,] 249.1830  9.098302 231.8692 267.0306
 [88,] 248.9599 10.601296 228.9896 269.8269
 [89,] 248.7369 12.458054 224.6378 272.9581
 [90,] 248.5138 14.533617 220.6262 277.0945
 [91,] 286.0137 13.023954 260.5724 311.8752
 [92,] 305.1561 11.161059 283.6713 327.4685
 [93,] 324.2985  9.582218 305.9787 343.7643
 [94,] 343.4409  8.448218 326.8287 360.6292
 [95,] 362.5833  7.951712 346.7501 378.6249
 [96,] 381.7257  8.209194 365.5307 398.0633
 [97,] 400.8681  9.157284 382.7128 419.3120
 [98,] 420.0105 10.612476 398.7039 441.3073
 [99,] 439.1529 12.397471 414.4855 463.7793
[100,] 458.2953 14.390057 429.8873 486.8583
[101,] 226.6228 12.903663 200.8867 251.3577
[102,] 238.1493 11.013037 216.1587 259.0627
[103,] 249.6757  9.386680 230.8447 267.6944
[104,] 261.2022  8.183694 244.9507 277.1028
[105,] 272.7287  7.607645 257.7112 287.8408
[106,] 284.2552  7.798718 268.7756 299.4808
[107,] 295.7817  8.706552 278.4775 313.1057
[108,] 307.3081 10.140435 287.5190 327.6794
[109,] 318.8346 11.911890 295.0085 342.3490
[110,] 330.3611 13.892377 302.5197 358.0269
[111,] 238.9042 13.370503 212.5838 263.9406
[112,] 255.8914 11.490225 233.4978 277.5046
[113,] 272.8787  9.892971 253.6100 291.6749
[114,] 289.8660  8.735399 272.9195 306.6150
[115,] 306.8533  8.205742 290.4422 322.8581
[116,] 323.8406  8.423295 307.2447 340.2096
[117,] 340.8278  9.335967 322.3942 358.7309
[118,] 357.8151 10.768443 336.4192 378.3012
[119,] 374.8024 12.543888 349.7538 398.6410
[120,] 391.7897 14.537180 362.8168 419.5138
[121,] 255.8304 12.420892 232.3132 280.1739
[122,] 263.3205 10.709510 242.9644 284.0588
[123,] 270.8106  9.283820 253.0885 288.7259
[124,] 278.3006  8.292511 262.0530 294.5249
[125,] 285.7907  7.900814 270.2087 301.2382
[126,] 293.2808  8.195161 277.1934 309.2144
[127,] 300.7709  9.109291 282.7830 318.9356
[128,] 308.2609 10.482289 286.9551 328.8907
[129,] 315.7510 12.159700 291.4516 339.7088
[130,] 323.2411 14.032779 295.1444 350.5570
[131,] 271.9861 12.775212 246.7393 297.6056
[132,] 286.0102 10.997698 264.3722 307.8659
[133,] 300.0343  9.501558 281.4593 318.7452
[134,] 314.0584  8.437817 296.9379 330.4526
[135,] 328.0825  7.981279 312.0123 343.5089
[136,] 342.1066  8.233578 325.2892 358.2729
[137,] 356.1307  9.136175 337.8288 374.0402
[138,] 370.1547 10.523047 349.2336 390.6120
[139,] 384.1788 12.230546 359.9109 407.5953
[140,] 398.2029 14.143016 370.4128 425.2535
[141,] 254.5592 12.133361 231.0142 277.7411
[142,] 265.9028 10.481880 245.4409 285.7973
[143,] 277.2464  9.125625 259.0599 294.6966
[144,] 288.5900  8.212191 272.3336 304.5350
[145,] 299.9336  7.896770 283.9958 315.5369
[146,] 311.2772  8.248255 295.0267 327.7294
[147,] 322.6208  9.190445 304.8071 340.7110
[148,] 333.9644 10.566489 313.4536 354.7462
[149,] 345.3080 12.230820 321.6127 369.3658
[150,] 356.6516 14.081586 329.1632 384.3341
[151,] 226.6577 13.543187 199.7046 251.8551
[152,] 241.8283 11.596828 218.8785 263.5096
[153,] 256.9989  9.930769 237.1254 275.7146
[154,] 272.1695  8.707420 255.1658 288.7927
[155,] 287.3400  8.129171 271.3989 303.3259
[156,] 302.5106  8.331443 286.4961 318.8101
[157,] 317.6812  9.263245 300.0313 336.0262
[158,] 332.8518 10.736280 312.0033 353.9697
[159,] 348.0224 12.561568 323.0816 372.6228
[160,] 363.1930 14.607652 333.8666 391.6134
[161,] 251.9133 12.259142 227.9884 276.5795
[162,] 261.4063 10.554955 240.6662 282.4006
[163,] 270.8993  9.139074 252.7432 289.3106
[164,] 280.3923  8.162927 263.9346 296.6297
[165,] 289.8853  7.793535 274.3394 304.7499
[166,] 299.3783  8.114192 283.0728 314.9977
[167,] 308.8712  9.051857 290.8298 326.4000
[168,] 318.3642 10.441611 298.1050 338.1622
[169,] 327.8572 12.129034 304.4800 351.2610
[170,] 337.3502 14.006955 310.0403 364.7495
[171,] 263.6505 12.160901 240.2735 287.8345
[172,] 275.4459 10.516348 255.0361 296.1672
[173,] 287.2412  9.169676 269.6336 305.4671
[174,] 299.0365  8.267749 282.7923 315.6200
[175,] 310.8318  7.963147 295.3400 326.3469
[176,] 322.6271  8.321722 306.4063 338.8183
[177,] 334.4225  9.266808 316.0029 352.7013
[178,] 346.2178 10.643294 325.0055 367.1398
[179,] 358.0131 12.307275 333.9528 381.9680
[180,] 369.8084 14.157742 342.4103 397.4285</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.57823260 13.008911  -29.1791486  22.5509438
  [2,]  -15.00506262 11.107630  -36.1816095   7.9551280
  [3,]  -42.48069265  9.485950  -60.6380031 -22.9366791
  [4,]    8.58697732  8.309224   -7.4237199  25.1329737
  [5,]   24.42754729  7.781984    9.2426083  39.7888433
  [6,]   62.69421726  8.033149   46.4856381  78.3951827
  [7,]   10.63638724  8.997767   -7.5130018  27.7481960
  [8,] -100.99034279 10.480662 -122.3470208 -81.0022180
  [9,]   19.87482718 12.295726   -4.6900470  43.2659873
 [10,]   36.07149715 14.317178    7.5227657  63.5440547
 [11,]   11.20922080 13.099503  -14.6368911  36.5747185
 [12,]   -8.05834098 11.198834  -29.8386519  13.7796410
 [13,]  -12.14580276  9.580361  -30.8404192   7.1790878
 [14,]  -12.21606454  8.408643  -28.8169362   4.3782819
 [15,]  -11.00642632  7.885415  -26.7479255   4.6037526
 [16,]   -4.56018811  8.136755  -21.1043808  11.1259413
 [17,]   -8.69114989  9.098700  -26.5655741   8.7948160
 [18,]   -6.39371167 10.579150  -27.1646861  13.9232880
 [19,]   -1.62467345 12.393669  -25.7191289  22.1390211
 [20,]    9.59436477 14.416663  -18.4092640  37.4236423
 [21,]  -14.04039367 13.231577  -39.5353577  12.6127204
 [22,]  -23.67521895 11.372381  -45.7136491  -1.2342950
 [23,]   11.39945578  9.789714   -7.6668737  30.5877149
 [24,]    5.00793051  8.636953  -11.9860141  21.8585361
 [25,]   -3.43939477  8.099778  -19.2491942  12.2309548
 [26,]  -17.20202004  8.298606  -33.5392369  -1.0836557
 [27,]   -7.15224532  9.185768  -25.4568715  10.8515951
 [28,]    8.26492941 10.589655  -12.8029242  28.9292027
 [29,]    8.61320413 12.335083  -15.7076019  32.1471061
 [30,]   -9.79712114 14.297509  -38.3659571  17.4210837
 [31,]   47.17560713 13.201297   21.4313024  72.7498656
 [32,]   20.26171451 11.294416   -1.9215908  42.4227612
 [33,]   -2.05347811  9.671724  -20.8587196  17.0313095
 [34,]   -6.54847073  8.497616  -23.1865956  10.1230510
 [35,]  -11.65566335  7.972798  -27.5708711   3.9701647
 [36,]   -5.63895597  8.222553  -21.8531076  10.7922005
 [37,]  -28.75634859  9.183901  -46.7351090 -10.3058148
 [38,]    3.49385878 10.666140  -16.9208371  25.0549842
 [39,]  -15.18943384 12.485105  -39.3419532   9.7904167
 [40,]   27.73827354 14.514750   -0.9943619  56.5291308
 [41,]   14.38427565 12.683445  -11.3354270  39.3468243
 [42,]    4.29760173 10.873513  -17.2672328  25.3082387
 [43,]   13.63942781  9.351610   -4.8484676  31.9437720
 [44,]   24.45535389  8.278148    8.3094100  40.4735317
 [45,]   13.13857998  7.839557   -1.9113427  28.4799193
 [46,]  -17.29879394  8.139126  -33.0487658  -1.1321868
 [47,]  -28.02126786  9.104280  -45.8653544 -10.0666808
 [48,]    9.24265822 10.553968  -11.4410068  29.5874129
 [49,]  -39.30691570 12.318294  -63.0885051 -15.4166838
 [50,]   31.04851038 14.281117    3.2974363  59.0420684
 [51,]  -25.27664899 12.187098  -49.8329542  -1.6955398
 [52,]  -27.56927535 10.493914  -48.9387468  -6.5871570
 [53,]   -7.66360171  9.095665  -25.5738423  10.6030549
 [54,]   18.90007192  8.145675    3.0967873  34.8754040
 [55,]   16.35034556  7.809283    1.2566069  31.7199439
 [56,]   -1.35878080  8.162708  -17.3633319  14.9074593
 [57,]  132.56169283  9.126155  114.3746026 150.5586746
 [58,]   14.98706647 10.533547   -6.0244462  35.5194350
 [59,]  -11.78755990 12.232601  -36.1423073  12.7056683
 [60,]  -98.46728626 14.118408 -125.7196828 -70.7363132
 [61,]   15.61187137 12.844954   -9.8782388  40.6515633
 [62,]   11.07718961 10.992472  -10.8673875  32.4941878
 [63,]  -11.95579216  9.419755  -30.5670092   6.2090423
 [64,]    0.83732608  8.287637  -15.3191806  16.8921067
 [65,]  -12.04865568  7.790625  -27.1732686   2.9996924
 [66,]   18.69956256  8.047268    3.2759519  34.8494524
 [67,]    2.31228080  8.993275  -15.0077072  19.9150803
 [68,]    8.87839904 10.442952  -11.3500015  29.4053410
 [69,]  -16.84878272 12.218317  -40.3007067   7.1024999
 [70,]    1.58673552 14.197713  -25.9371161  29.3502349
 [71,]   20.99032849 12.463289   -3.3491231  45.2357493
 [72,]   20.20846432 10.686632   -0.4722949  41.2131712
 [73,]  -24.13799985  9.181656  -41.9417761  -5.7596325
 [74,]  -24.34036403  8.101218  -40.1266016  -8.4151685
 [75,]  -11.49822820  7.627899  -26.4065349   3.2275329
 [76,]  -17.84139237  7.871985  -33.0713372  -2.1368526
 [77,]   -8.01775654  8.773805  -24.8101746   9.3168798
 [78,]    6.47037929 10.159693  -12.9757116  26.6129065
 [79,]   -0.81558489 11.861167  -23.8406961  21.9337552
 [80,]   29.22655094 13.761663    2.2588575  55.8712362
 [81,]   -8.91301786 13.508569  -36.2337419  16.7297430
 [82,]   23.64894017 11.525893    0.2301533  45.9432726
 [83,]    4.41549820  9.819280  -15.2081168  23.2242971
 [84,]   20.94995623  8.555558    4.4926355  37.3915805
 [85,]    1.82281426  7.948846  -13.5460292  17.1257154
 [86,]    5.23017229  8.147269  -10.6407880  21.1681731
 [87,]   -3.73066968  9.098302  -21.5782520  13.5830535
 [88,]  -13.64891165 10.601296  -34.5158809   6.3214313
 [89,]  -12.98275361 12.458054  -37.2040341  11.1163448
 [90,]  -11.26719558 14.533617  -39.8479159  16.6203890
 [91,]   26.35290942 13.023954    0.4913773  51.7941932
 [92,]    8.64971358 11.161059  -13.6627161  30.1345463
 [93,]  -32.68728226  9.582218  -52.1531374 -14.3675317
 [94,]    2.68132189  8.448218  -14.5070023  19.2934826
 [95,]    3.14912605  7.951712  -12.8925278  18.9822881
 [96,]   10.11283021  8.209194   -6.2248414  26.3078375
 [97,]    3.39203436  9.157284  -15.0518525  21.5473197
 [98,]   -3.31816148 10.612476  -24.6149735  17.9884051
 [99,]   16.71144268 12.397471   -7.9150306  41.3788396
[100,]    0.62144684 14.390057  -27.9415625  29.0294256
[101,]    9.48042903 12.903663  -15.2545074  35.2164811
[102,]   -7.83255256 11.013037  -28.7460253  14.1579935
[103,]  -10.75013416  9.386680  -28.7687830   8.0809231
[104,]   -6.28021575  8.183694  -22.1808242   9.9712815
[105,]  -22.01839734  7.607645  -37.1304747  -7.0009253
[106,]  -14.48077893  7.798718  -29.7063716   0.9987712
[107,]  -14.21686053  8.706552  -31.5408813   3.0872783
[108,]    0.79385788 10.140435  -19.5774418  20.5830352
[109,]   17.44597629 11.911890   -6.0683870  41.2721325
[110,]   21.28399469 13.892377   -6.3817863  49.1253529
[111,]   17.39263372 13.370503   -7.6437680  43.7129713
[112,]  -12.43714442 11.490225  -34.0502656   9.9565296
[113,]  -16.67412255  9.892971  -35.4702864   2.5946072
[114,]  -34.33890069  8.735399  -51.0879202 -17.3923564
[115,]  -37.93677882  8.205742  -53.9415904 -21.5257354
[116,]    5.88414304  8.423295  -10.4849487  22.4799603
[117,]   38.61666491  9.335967   20.7135988  57.0503041
[118,]    5.10328677 10.768443  -15.3828081  26.4992279
[119,]   19.68480864 12.543888   -4.1538232  44.7334197
[120,]   -2.73696950 14.537180  -30.4611126  26.2358843
[121,]   -5.30392867 12.420892  -29.6473967  18.2133467
[122,]   36.73710015 10.709510   15.9988213  57.0931580
[123,]   -0.91667103  9.283820  -18.8320427  16.8053611
[124,]    2.28845780  8.292511  -13.9357820  18.5360683
[125,]  -13.96331338  7.900814  -29.4107870   1.6186662
[126,]   11.35281545  8.195161   -4.5808053  27.4401608
[127,]  -13.02425573  9.109291  -31.1890419   4.9636252
[128,]  -41.66542691 10.482289  -62.2951833 -20.3596246
[129,]    5.79080192 12.159700  -18.1669930  30.0902004
[130,]   24.32443074 14.032779   -2.9914709  52.4210860
[131,]  -50.30904645 12.775212  -75.9284719 -25.0621896
[132,]   12.18366913 10.997698   -9.6720339  33.8217262
[133,]   26.84418470  9.501558    8.1332908  45.4192198
[134,]   32.79710028  8.437817   16.4029047  49.9176215
[135,]   20.65771585  7.981279    5.2313349  36.7278866
[136,]   10.72213143  8.233578   -5.4441545  27.5394891
[137,]   -1.70405300  9.136175  -19.6136018  16.5978072
[138,]   -9.72213742 10.523047  -30.1793917  11.1990161
[139,]   -8.53822185 12.230546  -31.9547031  15.7296955
[140,]   -9.66120627 14.143016  -36.7117535  18.1289271
[141,]   17.36434629 12.133361   -5.8176340  40.9092714
[142,]    2.53413694 10.481880  -17.3603689  22.9959709
[143,]  -20.00397241  9.125625  -37.4542426  -1.8175458
[144,]  -10.93338175  8.212191  -26.8784061   5.3229589
[145,]   14.88860890  7.896770   -0.7146983  30.8264263
[146,]    5.93629956  8.248255  -10.5158692  22.1867870
[147,]  -24.48550979  9.190445  -42.5756597  -6.6717615
[148,]   14.15848086 10.566489   -6.6233305  34.6693493
[149,]   -5.02802848 12.230820  -29.0858097  18.6672602
[150,]    9.86146217 14.081586  -17.8209542  37.3499090
[151,]   -1.39368163 13.543187  -26.5910627  25.5594318
[152,]   -7.30477339 11.596828  -28.9860850  15.6450369
[153,]  -18.09806515  9.930769  -36.8138289   1.7754318
[154,]  -31.69645690  8.707420  -48.3197419 -14.6928010
[155,]  -19.80274866  8.129171  -35.7885501  -3.8616024
[156,]   41.68305958  8.331443   25.3835661  57.6975754
[157,]  -36.53313217  9.263245  -54.8781494 -18.8831750
[158,]   14.73367607 10.736280   -6.3841822  35.5821534
[159,]   17.14058432 12.561568   -7.4598342  42.0814207
[160,]    9.03579256 14.607652  -19.3845565  38.3621677
[161,]   17.96708181 12.259142   -6.6990978  41.8919895
[162,]   11.03649544 10.554955   -9.9578463  31.7765519
[163,]    6.99960906  9.139074  -11.4117153  25.1556525
[164,]    1.39722269  8.162927  -14.8401538  17.8548545
[165,]  -10.71476368  7.793535  -25.5793710   4.8310663
[166,]  -14.86625005  8.114192  -30.4856746   1.4391620
[167,]  -49.60543642  9.051857  -67.1341769 -31.5639961
[168,]  -13.73362280 10.441611  -33.5316166   6.5256099
[169,]   22.92349083 12.129034   -0.4802678  46.3006992
[170,]   32.11900446 14.006955    4.7197407  59.4289067
[171,]    5.76117323 12.160901  -18.4227807  29.1382124
[172,]   -1.97185004 10.516348  -22.6931870  18.4378679
[173,]   10.35562668  9.169676   -7.8702774  27.9632070
[174,]   11.59510341  8.267749   -4.9883556  27.8392614
[175,]  -23.65921987  7.963147  -39.1742755  -8.1673645
[176,]    6.98045686  8.321722   -9.2107023  23.2013061
[177,]    0.05933358  9.266808  -18.2194626  18.4788677
[178,]   -2.99788969 10.643294  -23.9198796  18.2144369
[179,]   11.12858703 12.307275  -12.8263109  35.1888640
[180,]   -5.68483624 14.157742  -33.3048697  21.7132535</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.4 14.2
p_loo        18.9  3.1
looic      1768.8 28.4
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   586       
 (0.5, 0.7]   (ok)         1    0.6%   226       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.2
p_loo        33.5  8.3
looic      1721.5 44.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   871       
 (0.5, 0.7]   (ok)         5    2.8%   343       
   (0.7, 1]   (bad)        1    0.6%   62        
   (1, Inf)   (very bad)   2    1.1%   20        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.7      11.6  
fit_sleep1 -92.5      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.4 14.2
p_loo        18.9  3.1
looic      1768.8 28.4
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   586       
 (0.5, 0.7]   (ok)         1    0.6%   226       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.2
p_loo        33.5  8.3
looic      1721.5 44.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   871       
 (0.5, 0.7]   (ok)         5    2.8%   343       
   (0.7, 1]   (bad)        1    0.6%   62        
   (1, Inf)   (very bad)   2    1.1%   20        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.8     22.2        33.5    8.3   1721.5
fit_sleep2  -23.7      11.6  -884.4     14.2        18.9    3.1   1768.8
fit_sleep1  -92.5      20.9  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   44.4  
fit_sleep2   28.4  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.598568e-41 5.320921e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.86      1.56     0.22     5.34       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.14      1.56    -3.27      2.9       5.46      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.5-4.1     

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.32       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
