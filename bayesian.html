<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.88      7.00    15.33    43.16 1.00     2111     2823
sd(Days)                6.57      1.50     4.16    10.08 1.00     1565     1993
cor(Intercept,Days)     0.09      0.29    -0.46     0.64 1.00     1126     1919

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.25      7.40   236.63   266.26 1.00     1743     2028
Days         10.44      1.68     7.01    13.75 1.00     1328     1728

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.53    23.01    29.03 1.00     3917     2915

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.1023  13.09538 227.9254 279.3630
309 211.2734  13.16473 185.2065 236.1977
310 212.7184  13.28540 185.9131 237.8226
330 274.3435  13.18973 249.0767 299.9350
331 273.4284  13.22948 247.4694 299.8418
332 260.1664  12.61447 235.6096 285.0438
333 268.0302  12.44084 243.7045 292.3611
334 244.5109  12.39859 219.9239 269.8440
335 250.6206  13.08808 225.6378 277.3036
337 286.0482  13.45060 260.0597 312.7400
349 227.1012  12.87894 200.8571 252.2678
350 238.7429  12.95784 212.2101 262.7872
351 255.9158  12.44497 232.2361 280.7713
352 272.1902  12.38140 248.5115 296.6167
369 254.4642  12.52650 229.5641 279.0986
370 226.5124  13.57718 199.8590 253.5803
371 252.0748  12.37418 226.6313 276.6689
372 263.5767  12.35520 239.5995 288.2291

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5908555  2.538028 14.5618080 24.627629
309  1.7940669  2.474678 -3.0817192  6.572533
310  4.9373500  2.472054  0.0727696  9.764164
330  5.7994072  2.568932  0.7775524 10.722826
331  7.4296391  2.505172  2.2174457 12.097748
332 10.2573596  2.411618  5.4708932 14.869189
333 10.2962039  2.395688  5.5502271 15.015039
334 11.4909403  2.367982  6.6435568 16.161778
335 -0.2090447  2.554434 -5.3401515  4.691814
337 19.1600516  2.535937 14.3485985 24.083310
349 11.5165373  2.467704  6.8729455 16.430542
350 17.0512235  2.478005 12.3590606 22.042720
351  7.4481595  2.438019  2.5607891 12.021638
352 14.0408831  2.338427  9.4911963 18.586656
369 11.3951779  2.375695  6.7145867 16.132297
370 15.1406798  2.546947 10.2396914 20.268488
371  9.5061403  2.349191  4.8154720 14.179800
372 11.8336241  2.363332  7.2015798 16.385165</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.1023 13.095378 227.9254 279.3630
  [2,] 273.6931 11.155678 251.2345 295.5064
  [3,] 293.2840  9.502239 274.7395 311.9676
  [4,] 312.8748  8.307776 296.7017 329.3938
  [5,] 332.4657  7.786456 317.3102 348.0379
  [6,] 352.0565  8.069810 336.0272 368.2174
  [7,] 371.6474  9.082838 353.4283 389.1320
  [8,] 391.2382 10.618721 370.0190 412.0330
  [9,] 410.8291 12.485981 386.1920 435.4820
 [10,] 430.4200 14.557656 401.6552 459.1339
 [11,] 211.2734 13.164727 185.2065 236.1977
 [12,] 213.0675 11.291695 190.9426 234.2494
 [13,] 214.8616  9.692409 195.7611 232.9791
 [14,] 216.6556  8.522398 199.4108 233.0885
 [15,] 218.4497  7.972941 202.4784 233.8736
 [16,] 220.2438  8.170213 204.1424 236.4710
 [17,] 222.0378  9.065595 204.1988 239.5756
 [18,] 223.8319 10.481685 202.9333 243.9067
 [19,] 225.6260 12.239055 201.3250 249.0915
 [20,] 227.4200 14.211660 199.4407 254.6600
 [21,] 212.7184 13.285401 185.9131 237.8226
 [22,] 217.6557 11.447874 194.8188 239.4991
 [23,] 222.5931  9.890798 203.2502 241.8956
 [24,] 227.5304  8.764932 210.1102 244.9173
 [25,] 232.4678  8.248775 216.0862 248.4879
 [26,] 237.4051  8.454741 220.8493 253.9355
 [27,] 242.3425  9.335154 223.7717 260.4187
 [28,] 247.2798 10.725188 225.8675 268.1276
 [29,] 252.2172 12.455373 227.2281 276.8999
 [30,] 257.1545 14.403648 228.9026 285.5037
 [31,] 274.3435 13.189733 249.0767 299.9350
 [32,] 280.1429 11.242901 258.7651 302.4399
 [33,] 285.9424  9.593509 267.2481 305.2245
 [34,] 291.7418  8.418244 275.1092 308.4703
 [35,] 297.5412  7.930767 282.0506 313.0311
 [36,] 303.3406  8.253856 286.8379 319.4424
 [37,] 309.1400  9.303442 290.7124 327.2976
 [38,] 314.9394 10.871097 293.9592 336.1877
 [39,] 320.7388 12.767392 295.7330 345.6728
 [40,] 326.5382 14.867100 297.3618 355.9590
 [41,] 273.4284 13.229481 247.4694 299.8418
 [42,] 280.8580 11.340507 259.0468 303.2343
 [43,] 288.2877  9.733797 269.4156 307.7642
 [44,] 295.7173  8.569613 278.8217 312.6868
 [45,] 303.1469  8.042482 287.5565 318.9001
 [46,] 310.5766  8.275055 294.5045 326.6882
 [47,] 318.0062  9.209958 299.8178 335.8192
 [48,] 325.4358 10.664047 304.4167 345.6201
 [49,] 332.8655 12.456815 308.8767 356.9453
 [50,] 340.2951 14.462861 311.7719 368.5068
 [51,] 260.1664 12.614466 235.6096 285.0438
 [52,] 270.4237 10.829825 249.1745 291.7846
 [53,] 280.6811  9.331521 262.3587 298.9489
 [54,] 290.9385  8.276549 274.5705 306.6993
 [55,] 301.1958  7.845830 285.7004 316.6176
 [56,] 311.4532  8.139081 295.6009 327.3618
 [57,] 321.7105  9.086476 303.8342 339.5625
 [58,] 331.9679 10.512623 311.2390 352.7626
 [59,] 342.2253 12.251460 318.4556 366.5523
 [60,] 352.4826 14.188484 324.7216 380.4550
 [61,] 268.0302 12.440836 243.7045 292.3611
 [62,] 278.3264 10.671419 257.3080 298.9802
 [63,] 288.6226  9.190354 270.7255 306.0817
 [64,] 298.9189  8.156266 283.0640 314.9207
 [65,] 309.2151  7.750185 294.0938 324.6667
 [66,] 319.5113  8.067510 303.4417 335.3719
 [67,] 329.8075  9.032314 312.1639 347.5360
 [68,] 340.1037 10.467059 319.2693 360.7053
 [69,] 350.3999 12.207153 325.9444 374.7735
 [70,] 360.6961 14.140314 332.2680 388.6837
 [71,] 244.5109 12.398594 219.9239 269.8440
 [72,] 256.0019 10.644699 234.9419 277.0985
 [73,] 267.4928  9.171084 249.3455 285.7302
 [74,] 278.9838  8.131581 263.1214 294.8678
 [75,] 290.4747  7.703968 275.6253 305.5044
 [76,] 301.9656  7.987134 286.5356 317.4305
 [77,] 313.4566  8.913594 295.9109 330.9210
 [78,] 324.9475 10.311386 304.1043 345.1057
 [79,] 336.4385 12.017150 312.2210 359.7975
 [80,] 347.9294 13.918109 319.6040 375.2960
 [81,] 250.6206 13.088083 225.6378 277.3036
 [82,] 250.4116 11.141028 229.0801 272.8984
 [83,] 250.2026  9.486694 231.7957 268.7483
 [84,] 249.9935  8.301957 233.6177 266.4741
 [85,] 249.7845  7.803709 234.3510 264.9644
 [86,] 249.5754  8.119330 233.4734 264.8778
 [87,] 249.3664  9.165120 231.1533 266.9034
 [88,] 249.1573 10.729660 227.9350 270.0005
 [89,] 248.9483 12.621492 224.0634 273.6831
 [90,] 248.7392 14.714916 219.8205 277.4208
 [91,] 286.0482 13.450600 260.0597 312.7400
 [92,] 305.2082 11.525879 282.7999 327.7666
 [93,] 324.3683  9.881046 305.0697 343.6276
 [94,] 343.5283  8.676763 326.7276 360.4760
 [95,] 362.6884  8.111677 346.8320 378.2828
 [96,] 381.8484  8.317111 365.2894 398.0106
 [97,] 401.0085  9.241825 382.5695 419.2021
 [98,] 420.1685 10.700947 399.2417 441.2886
 [99,] 439.3286 12.508844 414.8288 463.6308
[100,] 458.4886 14.535956 430.3469 487.0169
[101,] 227.1012 12.878943 200.8571 252.2678
[102,] 238.6177 11.008649 216.1611 260.0342
[103,] 250.1343  9.417678 231.2466 268.3875
[104,] 261.6508  8.268862 245.0406 277.5221
[105,] 273.1673  7.761097 257.6993 288.0604
[106,] 284.6839  8.017125 268.9016 300.4211
[107,] 296.2004  8.971794 278.9378 313.3291
[108,] 307.7170 10.435085 287.5041 328.0743
[109,] 319.2335 12.225712 295.5627 343.0405
[110,] 330.7500 14.220555 302.7712 358.8245
[111,] 238.7429 12.957835 212.2101 262.7872
[112,] 255.7941 11.134862 233.1398 276.7275
[113,] 272.8453  9.609674 253.2326 291.1593
[114,] 289.8966  8.543275 272.8803 306.3834
[115,] 306.9478  8.118513 291.1244 322.4825
[116,] 323.9990  8.432911 307.2091 340.8084
[117,] 341.0502  9.412690 322.1022 359.4771
[118,] 358.1015 10.879545 335.6784 379.1089
[119,] 375.1527 12.665358 349.6215 400.0224
[120,] 392.2039 14.653978 362.9344 420.9080
[121,] 255.9158 12.444971 232.2361 280.7713
[122,] 263.3640 10.667394 242.7785 284.5132
[123,] 270.8122  9.197672 252.8645 288.6729
[124,] 278.2603  8.202982 261.9674 294.1620
[125,] 285.7085  7.865656 270.4207 300.9638
[126,] 293.1566  8.266561 276.9417 309.1975
[127,] 300.6048  9.310822 281.7076 318.8987
[128,] 308.0530 10.813633 286.3268 329.1704
[129,] 315.5011 12.612128 290.4619 339.9043
[130,] 322.9493 14.597423 293.7440 351.3237
[131,] 272.1902 12.381403 248.5115 296.6167
[132,] 286.2311 10.712486 265.5744 307.3855
[133,] 300.2719  9.335527 282.3767 318.8423
[134,] 314.3128  8.395431 298.5373 330.7217
[135,] 328.3537  8.046796 313.3274 344.1345
[136,] 342.3946  8.363915 325.9067 358.3955
[137,] 356.4355  9.278778 338.1097 373.9273
[138,] 370.4764 10.638272 349.5356 390.8864
[139,] 384.5172 12.295789 360.3860 407.6797
[140,] 398.5581 14.146961 370.6945 425.3567
[141,] 254.4642 12.526500 229.5641 279.0986
[142,] 265.8593 10.790087 244.4418 287.4098
[143,] 277.2545  9.339518 258.3365 295.9036
[144,] 288.6497  8.325567 271.6528 305.1730
[145,] 300.0449  7.917789 284.2436 315.5184
[146,] 311.4401  8.207043 295.0351 327.5371
[147,] 322.8352  9.127298 304.4472 340.6754
[148,] 334.2304 10.514154 313.1071 354.8834
[149,] 345.6256 12.209634 321.5758 369.3335
[150,] 357.0208 14.102862 329.8013 384.4536
[151,] 226.5124 13.577181 199.8590 253.5803
[152,] 241.6530 11.577176 218.9302 264.6997
[153,] 256.7937  9.833414 237.6542 276.5374
[154,] 271.9344  8.504995 255.4632 288.6889
[155,] 287.0751  7.806903 271.9512 302.6859
[156,] 302.2158  7.907869 286.6130 317.9888
[157,] 317.3564  8.780372 299.9858 334.7773
[158,] 332.4971 10.228848 311.8672 352.6758
[159,] 347.6378 12.047308 323.6289 371.4083
[160,] 362.7785 14.093253 335.2387 390.6215
[161,] 252.0748 12.374181 226.6313 276.6689
[162,] 261.5809 10.647270 240.0253 282.5129
[163,] 271.0870  9.200312 252.6260 289.0993
[164,] 280.5932  8.183185 264.1810 297.0513
[165,] 290.0993  7.766640 274.9924 305.3583
[166,] 299.6055  8.044517 283.7186 315.5232
[167,] 309.1116  8.952387 291.6376 326.8450
[168,] 318.6177 10.325385 298.1320 339.0142
[169,] 328.1239 12.004971 304.5072 352.1346
[170,] 337.6300 13.880291 309.8873 365.2401
[171,] 263.5767 12.355197 239.5995 288.2291
[172,] 275.4103 10.618247 254.8227 296.3377
[173,] 287.2439  9.165920 269.3490 305.5364
[174,] 299.0776  8.151791 283.3134 315.2676
[175,] 310.9112  7.749838 295.9251 326.3224
[176,] 322.7448  8.052264 306.9977 338.9557
[177,] 334.5784  8.988247 317.1808 352.9269
[178,] 346.4121 10.387921 326.3821 367.0805
[179,] 358.2457 12.091315 334.7209 382.1014
[180,] 370.0793 13.987908 342.3983 397.8803</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.54225792 13.095378  -29.8030145  21.6346129
  [2,]  -14.98841343 11.155678  -36.8016984   7.4702493
  [3,]  -42.48336894  9.502239  -61.1669693 -23.9388642
  [4,]    8.56497555  8.307776   -7.9539602  24.7381326
  [5,]   24.38622004  7.786456    8.8140500  39.5417232
  [6,]   62.63356452  8.069810   46.4727364  78.6628572
  [7,]   10.55640901  9.082838   -6.9282455  28.7754969
  [8,] -101.08964650 10.618721 -121.8843723 -79.8703760
  [9,]   19.75619799 12.485981   -4.8967328  44.3933086
 [10,]   35.93354247 14.557656    7.2196429  64.6983370
 [11,]   11.46045853 13.164727  -13.4638448  37.5273834
 [12,]   -7.80170832 11.291695  -28.9835973  14.3231653
 [13,]  -11.88377518  9.692409  -30.0013125   7.2166741
 [14,]  -11.94864204  8.522398  -28.3814701   5.2961709
 [15,]  -10.73360890  7.972941  -26.1575412   5.2376509
 [16,]   -4.28197576  8.170213  -20.5092201  11.8193567
 [17,]   -8.40754262  9.065595  -25.9452979   9.4314820
 [18,]   -6.10470947 10.481685  -26.1795118  14.7938708
 [19,]   -1.33027633 12.239055  -24.7957610  22.9707039
 [20,]    9.89415681 14.211660  -17.3457570  37.8734764
 [21,]  -13.66447264 13.285401  -38.7687285  13.1408286
 [22,]  -23.32352259 11.447874  -45.1669034  -0.4866132
 [23,]   11.72692745  9.890798   -7.5755680  31.0697812
 [24,]    5.31117750  8.764932  -12.0757120  22.7314473
 [25,]   -3.16037245  8.248775  -19.1805033  13.2212185
 [26,]  -16.94722240  8.454741  -33.4776161  -0.3913740
 [27,]   -6.92167235  9.335154  -24.9978721  11.6491082
 [28,]    8.47127769 10.725188  -12.3765462  29.8835895
 [29,]    8.79532774 12.455373  -15.8874182  33.7844348
 [30,]   -9.63922221 14.403648  -37.9884417  18.6126513
 [31,]   47.19905731 13.189733   21.6076360  72.4659069
 [32,]   20.25725012 11.242901   -2.0396962  41.6350660
 [33,]   -2.08585708  9.593509  -21.3679926  16.6083796
 [34,]   -6.60876428  8.418244  -23.3373061  10.0238362
 [35,]  -11.74387147  7.930767  -27.2337702   3.7467469
 [36,]   -5.75507867  8.253856  -21.8569044  10.7475643
 [37,]  -28.90038587  9.303442  -47.0580487 -10.4728349
 [38,]    3.32190693 10.871097  -17.9264197  24.3021110
 [39,]  -15.38930026 12.767392  -40.3233156   9.6164969
 [40,]   27.51049254 14.867100   -1.9103366  56.6868640
 [41,]   14.17952735 13.229481  -12.2338785  40.1384554
 [42,]    4.14198830 11.340507  -18.2342785  25.9532004
 [43,]   13.53294925  9.733797   -5.9436215  32.4050468
 [44,]   24.39801020  8.569613    7.4284932  41.2935825
 [45,]   13.13037114  8.042482   -2.6228327  28.7208021
 [46,]  -17.25786791  8.275055  -33.3695202  -1.1858470
 [47,]  -27.93120696  9.209958  -45.7441877  -9.7427811
 [48,]    9.38185399 10.664047  -10.8024152  30.4010110
 [49,]  -39.11858507 12.456815  -63.1983891 -15.1297822
 [50,]   31.28597588 14.462861    3.0743385  59.8092245
 [51,]  -25.30578508 12.614466  -50.1832053  -0.7490489
 [52,]  -27.61194466 10.829825  -48.9728108  -6.3627330
 [53,]   -7.71980424  9.331521  -25.9875944  10.6025710
 [54,]   18.83033617  8.276549    3.0695067  35.1983376
 [55,]   16.26707659  7.845830    0.8453279  31.7624951
 [56,]   -1.45558299  8.139081  -17.3641943  14.3967444
 [57,]  132.45135742  9.086476  114.5994026 150.3277310
 [58,]   14.86319784 10.512623   -5.9314888  35.5921381
 [59,]  -11.92496174 12.251460  -36.2519671  11.8446639
 [60,]  -98.61822133 14.188484 -126.5906061 -70.8572340
 [61,]   15.81216051 12.440836   -8.5187486  40.1378588
 [62,]   11.22855657 10.671419   -9.4251922  32.2469695
 [63,]  -11.85334738  9.190354  -29.3124037   6.0437842
 [64,]    0.89084867  8.156266  -15.1109698  16.7457476
 [65,]  -12.04405528  7.750185  -27.4957178   3.0772047
 [66,]   18.65524078  8.067510    2.7946445  34.7248287
 [67,]    2.21903683  9.032314  -15.5095431  19.8625507
 [68,]    8.73623288 10.467059  -11.8654044  29.5706454
 [69,]  -17.03987106 12.207153  -41.4134521   7.4155808
 [70,]    1.34672499 14.140314  -26.6409374  29.7748350
 [71,]   20.96215246 12.398594   -4.3709184  45.5492074
 [72,]   20.19931221 10.644699   -0.8972683  41.2592533
 [73,]  -24.12812804  9.171084  -42.3654787  -5.9808361
 [74,]  -24.31146829  8.131581  -40.1955149  -8.4491253
 [75,]  -11.45030855  7.703968  -26.4800421   3.3990715
 [76,]  -17.77444880  7.987134  -33.2393233  -2.3444051
 [77,]   -7.93178905  8.913594  -25.3961848   9.6138597
 [78,]    6.57537070 10.311386  -13.5828398  27.4185661
 [79,]   -0.69156955 12.017150  -24.0505767  23.5258504
 [80,]   29.36959019 13.918109    2.0029673  57.6949615
 [81,]   -9.01234446 13.088083  -35.6952559  15.9704921
 [82,]   23.53560019 11.141028    1.0488195  44.8671263
 [83,]    4.28814485  9.486694  -14.2575678  22.6950360
 [84,]   20.80858951  8.301957    4.3280329  37.1843614
 [85,]    1.66743417  7.803709  -13.5125144  17.1008512
 [86,]    5.06077883  8.119330  -10.2416115  21.1628000
 [87,]   -3.91407652  9.165120  -21.4511208  14.2990290
 [88,]  -13.84633186 10.729660  -34.6894803   7.3760139
 [89,]  -13.19418720 12.621492  -37.9289677  11.6907241
 [90,]  -11.49264254 14.714916  -40.1742112  17.4261347
 [91,]   26.31843771 13.450600   -0.3733511  52.3069210
 [92,]    8.59758609 11.525879  -13.9608283  31.0059371
 [93,]  -32.75706554  9.881046  -52.0164255 -13.4585037
 [94,]    2.59388284  8.676763  -14.3537934  19.3946047
 [95,]    3.04403121  8.111677  -12.5503809  18.9003933
 [96,]    9.99007959  8.317111   -6.1721147  26.5491484
 [97,]    3.25162796  9.241825  -14.9419788  21.6906081
 [98,]   -3.47622366 10.700947  -24.5962824  17.4505922
 [99,]   16.53572471 12.508844   -7.7664930  41.0355029
[100,]    0.42807309 14.535956  -28.1002125  28.5698272
[101,]    9.00200463 12.878943  -16.1645895  35.2460893
[102,]   -8.30103265 11.008649  -29.7175035  14.1556236
[103,]  -11.20866993  9.417678  -29.4618697   7.6789579
[104,]   -6.72880721  8.268862  -22.6001065   9.8813908
[105,]  -22.45704449  7.761097  -37.3500561  -6.9889809
[106,]  -14.90948178  8.017125  -30.6467335   0.8728286
[107,]  -14.63561906  8.971794  -31.7643318   2.6269750
[108,]    0.38504366 10.435085  -19.9723145  20.5979486
[109,]   17.04710638 12.225712   -6.7598504  40.7178959
[110,]   20.89506910 14.220555   -7.1793543  48.8738521
[111,]   17.55390767 12.957835   -6.4904015  44.0866933
[112,]  -12.33981580 11.134862  -33.2732374  10.3144931
[113,]  -16.64073928  9.609674  -34.9546940   2.9719561
[114,]  -34.36946275  8.543275  -50.8562669 -17.3531825
[115,]  -38.03128623  8.118513  -53.5660461 -22.2079494
[116,]    5.72569030  8.432911  -11.0837370  22.5156173
[117,]   38.39426682  9.412690   19.9674330  57.3422929
[118,]    4.81694334 10.879545  -16.1905200  27.2400475
[119,]   19.33451987 12.665358   -5.5352371  44.8657069
[120,]   -3.15120361 14.653978  -31.8553053  26.1183051
[121,]   -5.38934867 12.444971  -30.2448420  18.2903991
[122,]   36.69359186 10.667394   15.5444407  57.2790798
[123,]   -0.91826762  9.197672  -18.7790143  17.0294381
[124,]    2.32877291  8.202982  -13.5729483  18.6217102
[125,]  -13.88108656  7.865656  -29.1363748   1.4066657
[126,]   11.47695396  8.266561   -4.5639030  27.6918851
[127,]  -12.85820551  9.310822  -31.1521494   6.0390093
[128,]  -41.45746499 10.813633  -62.5749042 -19.7312784
[129,]    6.04067554 12.612128  -18.3624744  31.0798708
[130,]   24.61621606 14.597423   -3.7581874  53.8214812
[131,]  -50.51307134 12.381403  -74.9395554 -26.8343863
[132,]   11.96284560 10.712486   -9.1915529  32.6195371
[133,]   26.60656255  9.335527    8.0361526  44.5017811
[134,]   32.54267949  8.395431   16.1338328  48.3181559
[135,]   20.38649643  8.046796    4.6056749  35.4127563
[136,]   10.43411337  8.363915   -5.5667900  26.9219683
[137,]   -2.00886969  9.278778  -19.5007165  16.3169012
[138,]  -10.04375275 10.638272  -30.4537639  10.8969681
[139,]   -8.87663580 12.295789  -32.0391350  15.2546318
[140,]  -10.01641886 14.146961  -36.8149730  17.8472253
[141,]   17.45933828 12.526500   -7.1751425  42.3594406
[142,]    2.57756034 10.790087  -18.9728617  23.9950804
[143,]  -20.01211760  9.339518  -38.6612374  -1.0941193
[144,]  -10.99309554  8.325567  -27.5163728   6.0038189
[145,]   14.77732653  7.917789   -0.6961666  30.5786489
[146,]    5.77344859  8.207043  -10.3236381  22.1784493
[147,]  -24.69992935  9.127298  -42.5401450  -6.3119129
[148,]   13.89249272 10.514154   -6.7605227  35.0157741
[149,]   -5.34558522 12.209634  -29.0535360  18.7042155
[150,]    9.49233684 14.102862  -17.9405010  36.7118364
[151,]   -1.24835937 13.577181  -28.3163110  25.4050409
[152,]   -7.12953913 11.577176  -30.1762317  15.5933406
[153,]  -17.89291890  9.833414  -37.6365868   1.2465820
[154,]  -31.46139866  8.504995  -48.2158599 -14.9901563
[155,]  -19.53777842  7.806903  -35.1485708  -4.4138577
[156,]   41.97794181  7.907869   26.2048799  57.5806847
[157,]  -36.20833795  8.780372  -53.6292429 -18.8376629
[158,]   15.08838228 10.228848   -5.0903398  35.7182515
[159,]   17.52520252 12.047308   -6.2453044  41.5341259
[160,]    9.45032275 14.093253  -18.3927477  36.9900714
[161,]   17.80563324 12.374181   -6.7884771  43.2491181
[162,]   10.86189291 10.647270  -10.0700718  32.4174813
[163,]    6.81185259  9.200312  -11.2004328  25.2728651
[164,]    1.19631226  8.183185  -15.2618067  17.6084535
[165,]  -10.92882807  7.766640  -26.1878420   4.1781148
[166,]  -15.09346840  8.044517  -31.0112342   0.7933978
[167,]  -49.84580872  8.952387  -67.5791791 -32.3718402
[168,]  -13.98714905 10.325385  -34.3836060   6.4985935
[169,]   22.65681062 12.004971   -1.3539453  46.2735081
[170,]   31.83917029 13.880291    4.2290560  59.5819499
[171,]    5.83500110 12.355197  -18.8173676  29.8122446
[172,]   -1.93632301 10.618247  -22.8636632  18.6513235
[173,]   10.35285289  9.165920   -7.9396460  28.2478421
[174,]   11.55402879  8.151791   -4.6359745  27.3182001
[175,]  -23.73859532  7.749838  -39.1498454  -8.7524969
[176,]    6.86278058  8.052264   -9.3480704  22.6099435
[177,]   -0.09664352  8.988247  -18.4450575  17.3010242
[178,]   -3.19216762 10.387921  -23.8605618  16.8378103
[179,]   10.89600827 12.091315  -12.9596520  34.4207587
[180,]   -5.95571583 13.987908  -33.7566612  21.7252506</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.3
looic      1769.5 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   710       
 (0.5, 0.7]   (ok)         1    0.6%   105       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.0 22.6
p_loo        34.8  8.8
looic      1723.9 45.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   1240      
 (0.5, 0.7]   (ok)         7    3.9%   491       
   (0.7, 1]   (bad)        2    1.1%   21        
   (1, Inf)   (very bad)   1    0.6%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -22.8      11.9  
fit_sleep1 -91.3      21.3  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.3
looic      1769.5 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   710       
 (0.5, 0.7]   (ok)         1    0.6%   105       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.0 22.6
p_loo        34.8  8.8
looic      1723.9 45.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   1240      
 (0.5, 0.7]   (ok)         7    3.9%   491       
   (0.7, 1]   (bad)        2    1.1%   21        
   (1, Inf)   (very bad)   1    0.6%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.0     22.6        34.8    8.8   1723.9
fit_sleep2  -22.8      11.9  -884.8     14.4        19.3    3.3   1769.5
fit_sleep1  -91.3      21.3  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   45.3  
fit_sleep2   28.7  
fit_sleep1   21.1  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
2.156958e-40 1.259243e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.91      1.62     0.29      5.5       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.09      1.62    -3.48     3.04       5.38      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.15      
[4] StanHeaders_2.26.15 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.0         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
