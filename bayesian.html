<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.94      6.77    15.68    42.74 1.00     2004     2411
sd(Days)                6.59      1.57     4.15    10.29 1.00     1452     1884
cor(Intercept,Days)     0.08      0.29    -0.47     0.66 1.00      985     1697

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.25      7.40   236.41   265.92 1.00     1889     2547
Days         10.40      1.77     6.84    13.98 1.00     1300     1691

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.87      1.55    23.01    29.14 1.00     3184     2637

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7567  12.71272 228.5129 277.6753
309 211.5687  13.33725 184.9729 237.6515
310 212.9782  13.12079 186.6438 238.2243
330 274.5074  13.20063 249.3028 300.1049
331 273.2613  12.77962 248.9336 299.3348
332 260.3202  12.42526 236.2981 285.5484
333 267.9407  12.54616 244.0257 292.4222
334 244.4011  12.50392 220.0018 268.8873
335 250.9580  13.31387 225.6969 277.7104
337 286.1049  13.06340 260.0124 311.4471
349 226.6890  12.99564 200.7123 251.6747
350 238.5196  12.98388 212.4125 263.1404
351 255.9608  12.40233 232.3034 280.5314
352 272.0067  12.34307 248.2855 295.7333
369 254.6756  12.30353 230.4480 278.6599
370 225.8671  13.42752 199.3402 251.7018
371 252.5285  12.21328 227.9638 275.7916
372 263.6996  12.45833 240.0697 288.4439

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6280707  2.437940 14.9814955 24.406722
309  1.7563893  2.498100 -3.0289172  6.819900
310  4.9456662  2.465812  0.1560109  9.805632
330  5.6820749  2.511655  0.6899978 10.389869
331  7.4709580  2.397841  2.6284802 12.175947
332 10.2276476  2.337178  5.4403178 14.787611
333 10.2991518  2.385871  5.4972756 14.936916
334 11.5142748  2.391972  6.8175177 16.158808
335 -0.3028164  2.536679 -5.2929567  4.577350
337 19.0869723  2.484769 14.3242444 23.921316
349 11.5617193  2.436728  6.7710526 16.315711
350 17.0407267  2.524953 12.2138454 22.168290
351  7.4282870  2.333057  2.8601568 12.053643
352 14.0631633  2.376630  9.3886274 18.647781
369 11.3471795  2.361741  6.4513403 15.875418
370 15.2746486  2.554125 10.3101722 20.296078
371  9.3856518  2.360130  4.8401264 14.025758
372 11.7462618  2.407648  6.9953862 16.445146</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7567 12.712720 228.5129 277.6753
  [2,] 273.3848 10.887108 251.9775 294.1327
  [3,] 293.0128  9.345165 274.5095 311.2293
  [4,] 312.6409  8.247557 296.2774 328.9082
  [5,] 332.2690  7.784560 316.7538 347.7971
  [6,] 351.8970  8.066206 336.0436 367.6351
  [7,] 371.5251  9.023030 354.0302 389.0512
  [8,] 391.1532 10.471560 370.5242 411.3961
  [9,] 410.7813 12.238431 386.2744 434.1693
 [10,] 430.4093 14.205347 402.1335 457.4137
 [11,] 211.5687 13.337250 184.9729 237.6515
 [12,] 213.3251 11.444331 190.5387 235.9755
 [13,] 215.0815  9.825690 195.8432 234.7303
 [14,] 216.8378  8.636937 200.2089 233.9857
 [15,] 218.5942  8.070328 203.0361 234.4288
 [16,] 220.3506  8.254981 204.3061 236.6515
 [17,] 222.1070  9.145504 204.1714 240.0422
 [18,] 223.8634 10.564884 203.0952 244.5474
 [19,] 225.6198 12.331842 201.9068 249.7187
 [20,] 227.3762 14.318272 199.9320 255.7735
 [21,] 212.9782 13.120793 186.6438 238.2243
 [22,] 217.9238 11.257404 195.7183 239.5751
 [23,] 222.8695  9.667654 203.6081 242.0887
 [24,] 227.8152  8.506374 211.2055 244.5007
 [25,] 232.7608  7.963272 217.0286 248.9081
 [26,] 237.7065  8.162688 221.8474 254.2079
 [27,] 242.6522  9.055701 224.9011 260.6097
 [28,] 247.5978 10.466251 226.8807 268.0996
 [29,] 252.5435 12.216364 228.2266 276.7623
 [30,] 257.4892 14.180873 229.3659 285.1835
 [31,] 274.5074 13.200626 249.3028 300.1049
 [32,] 280.1895 11.283796 258.3362 302.4254
 [33,] 285.8716  9.644086 267.0083 304.9012
 [34,] 291.5536  8.444500 274.7024 308.1215
 [35,] 297.2357  7.888446 281.5894 312.8476
 [36,] 302.9178  8.109403 287.1228 319.0732
 [37,] 308.5999  9.050639 290.5087 326.4130
 [38,] 314.2819 10.520577 293.5868 334.8539
 [39,] 319.9640 12.331579 295.9361 343.6940
 [40,] 325.6461 14.355137 297.5766 352.8890
 [41,] 273.2613 12.779623 248.9336 299.3348
 [42,] 280.7323 10.974366 259.6434 302.4512
 [43,] 288.2032  9.436840 270.0677 306.8310
 [44,] 295.6742  8.316878 279.6945 311.8786
 [45,] 303.1451  7.796554 287.8653 318.2593
 [46,] 310.6161  7.993831 294.8615 325.8093
 [47,] 318.0871  8.860909 301.0571 335.0975
 [48,] 325.5580 10.228849 305.5328 345.5125
 [49,] 333.0290 11.926537 309.7727 356.4457
 [50,] 340.4999 13.833094 313.5030 367.2876
 [51,] 260.3202 12.425264 236.2981 285.5484
 [52,] 270.5478 10.723915 250.0376 292.3082
 [53,] 280.7755  9.302813 263.1706 299.9186
 [54,] 291.0031  8.307051 275.0633 307.6481
 [55,] 301.2308  7.899156 285.8015 316.4659
 [56,] 311.4584  8.167683 295.4350 326.9037
 [57,] 321.6861  9.052637 303.7601 339.2147
 [58,] 331.9137 10.397799 311.1631 351.8136
 [59,] 342.1414 12.050022 318.0706 364.9152
 [60,] 352.3690 13.900239 324.2998 378.8172
 [61,] 267.9407 12.546157 244.0257 292.4222
 [62,] 278.2398 10.809663 257.4654 299.7022
 [63,] 288.5390  9.363564 270.4242 307.2982
 [64,] 298.8381  8.359941 282.4741 315.6505
 [65,] 309.1373  7.967788 293.4160 324.9496
 [66,] 319.4364  8.274505 303.2413 335.6907
 [67,] 329.7356  9.210537 311.2101 347.7195
 [68,] 340.0347 10.610621 318.9524 360.6896
 [69,] 350.3339 12.317522 325.6439 374.2974
 [70,] 360.6330 14.221187 332.9447 388.4046
 [71,] 244.4011 12.503920 220.0018 268.8873
 [72,] 255.9154 10.748784 235.0994 276.7809
 [73,] 267.4296  9.282660 249.0428 285.5195
 [74,] 278.9439  8.260886 262.6317 295.1989
 [75,] 290.4582  7.858738 274.9059 306.0146
 [76,] 301.9725  8.168252 285.9267 318.0040
 [77,] 313.4867  9.117235 295.6829 331.3331
 [78,] 325.0010 10.534262 303.9888 345.5491
 [79,] 336.5153 12.258076 312.4111 360.2564
 [80,] 348.0296 14.177208 320.3254 375.7676
 [81,] 250.9580 13.313865 225.6969 277.7104
 [82,] 250.6552 11.336420 228.8927 273.5521
 [83,] 250.3524  9.624931 232.0151 269.8306
 [84,] 250.0495  8.344678 234.3401 266.4981
 [85,] 249.7467  7.713462 234.8584 265.1255
 [86,] 249.4439  7.888652 234.2828 265.0079
 [87,] 249.1411  8.822337 232.4770 266.7070
 [88,] 248.8383 10.310477 229.0881 269.4000
 [89,] 248.5355 12.151037 225.3699 272.7881
 [90,] 248.2326 14.207708 220.9123 276.3950
 [91,] 286.1049 13.063398 260.0124 311.4471
 [92,] 305.1919 11.174190 283.2774 326.6636
 [93,] 324.2788  9.561425 305.4157 342.5930
 [94,] 343.3658  8.386138 327.2653 359.5708
 [95,] 362.4528  7.847416 347.2817 377.8088
 [96,] 381.5398  8.073704 365.8405 397.4864
 [97,] 400.6267  9.007531 383.1941 417.8915
 [98,] 419.7137 10.461104 399.1434 439.6900
 [99,] 438.8007 12.250792 414.9380 462.5149
[100,] 457.8876 14.250519 430.2807 485.3234
[101,] 226.6890 12.995644 200.7123 251.6747
[102,] 238.2507 11.171445 215.7708 259.7122
[103,] 249.8124  9.622417 230.6509 268.2642
[104,] 261.3741  8.500348 244.6125 277.9190
[105,] 272.9358  7.987252 257.3653 288.8492
[106,] 284.4976  8.198278 268.0770 300.9939
[107,] 296.0593  9.083095 277.9894 314.0224
[108,] 307.6210 10.472285 286.3774 328.1307
[109,] 319.1827 12.194678 294.4972 343.0285
[110,] 330.7444 14.128937 302.1317 357.9772
[111,] 238.5196 12.983883 212.4125 263.1404
[112,] 255.5603 11.072982 233.1512 276.5203
[113,] 272.6010  9.454705 253.7030 291.0065
[114,] 289.6418  8.301971 273.1020 305.8421
[115,] 306.6825  7.823348 291.2893 321.6162
[116,] 323.7232  8.138648 307.4547 339.6650
[117,] 340.7639  9.166307 322.2380 358.4465
[118,] 357.8047 10.703062 336.6724 378.1240
[119,] 374.8454 12.563466 350.2263 398.9142
[120,] 391.8861 14.624520 363.2135 420.0862
[121,] 255.9608 12.402327 232.3034 280.5314
[122,] 263.3891 10.668985 242.6956 284.7187
[123,] 270.8174  9.204513 252.8247 289.3377
[124,] 278.2457  8.155071 262.3108 294.2630
[125,] 285.6740  7.692439 270.4674 300.9732
[126,] 293.1023  7.920124 277.6737 308.7194
[127,] 300.5305  8.784613 283.3271 318.0201
[128,] 307.9588 10.124070 288.2852 328.1959
[129,] 315.3871 11.777541 292.6727 339.0458
[130,] 322.8154 13.631230 296.7168 350.1420
[131,] 272.0067 12.343074 248.2855 295.7333
[132,] 286.0699 10.616372 265.6375 306.8099
[133,] 300.1331  9.184768 282.5276 318.3127
[134,] 314.1962  8.204226 298.4509 330.7147
[135,] 328.2594  7.845726 313.0645 344.1102
[136,] 342.3225  8.191352 326.3108 358.2874
[137,] 356.3857  9.161758 338.4377 374.1086
[138,] 370.4489 10.586506 349.4285 391.1297
[139,] 384.5120 12.308824 359.8335 408.6036
[140,] 398.5752 14.221003 370.0075 426.6748
[141,] 254.6756 12.303535 230.4480 278.6599
[142,] 266.0228 10.578869 244.8483 286.6760
[143,] 277.3700  9.143502 259.0639 295.0264
[144,] 288.7171  8.151712 272.6770 304.6297
[145,] 300.0643  7.775141 284.6074 315.4274
[146,] 311.4115  8.100054 295.8311 327.4589
[147,] 322.7587  9.051219 304.9286 340.7773
[148,] 334.1059 10.459154 313.5670 355.2548
[149,] 345.4530 12.166301 321.5562 369.7652
[150,] 356.8002 14.064120 329.1026 384.8380
[151,] 225.8671 13.427524 199.3402 251.7018
[152,] 241.1418 11.505020 218.6117 263.6577
[153,] 256.4164  9.873180 237.0612 275.7487
[154,] 271.6911  8.697182 254.8328 288.8358
[155,] 286.9657  8.176147 271.2912 303.0520
[156,] 302.2404  8.432372 285.8813 318.9175
[157,] 317.5150  9.402527 299.0885 335.7279
[158,] 332.7897 10.897580 311.2143 354.0581
[159,] 348.0643 12.733974 323.0983 372.9836
[160,] 363.3390 14.785061 334.5022 392.6339
[161,] 252.5285 12.213278 227.9638 275.7916
[162,] 261.9142 10.507220 240.9817 281.9809
[163,] 271.2998  9.098331 253.0835 288.8664
[164,] 280.6855  8.142358 264.1889 296.6423
[165,] 290.0711  7.807484 274.3190 305.6524
[166,] 299.4568  8.170437 283.1575 315.6451
[167,] 308.8424  9.148535 290.5184 327.2433
[168,] 318.2281 10.572407 297.0952 339.2400
[169,] 327.6137 12.288055 303.1150 352.2559
[170,] 336.9994 14.190041 308.9997 365.4524
[171,] 263.6996 12.458333 240.0697 288.4439
[172,] 275.4459 10.677791 254.8551 296.4903
[173,] 287.1922  9.187704 269.3300 305.5175
[174,] 298.9384  8.148996 283.4639 314.9395
[175,] 310.6847  7.745444 296.2534 326.0912
[176,] 322.4309  8.072869 306.7944 338.6088
[177,] 334.1772  9.052296 316.4860 351.9465
[178,] 345.9235 10.502878 324.9410 366.4201
[179,] 357.6697 12.258482 333.5136 381.6106
[180,] 369.4160 14.206472 341.8120 396.7045</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5      Q97.5
  [1,]   -4.1966954 12.712720  -28.1153314  21.047094
  [2,]  -14.6800661 10.887108  -35.4280360   6.727250
  [3,]  -42.2122367  9.345165  -60.4287380 -23.708922
  [4,]    8.7988926  8.247557   -7.4684432  25.162415
  [5,]   24.5829219  7.784560    9.0547962  40.098128
  [6,]   62.7930513  8.066206   47.0549692  78.646483
  [7,]   10.6786806  9.023030   -6.8473531  28.173617
  [8,] -101.0045901 10.471560 -121.2475094 -80.375580
  [9,]   19.8040393 12.238431   -3.5840162  44.310943
 [10,]   35.9441686 14.205347    8.9397696  64.220039
 [11,]   11.1652193 13.337250  -14.9175793  37.761032
 [12,]   -8.0592700 11.444331  -30.7096700  14.727127
 [13,]  -12.1036592  9.825690  -31.7524681   7.134557
 [14,]  -12.1308485  8.636937  -29.2786539   4.498067
 [15,]  -10.8781378  8.070328  -26.7127411   4.680023
 [16,]   -4.3888270  8.254981  -20.6896731  11.655709
 [17,]   -8.4767163  9.145504  -26.4118623   9.458857
 [18,]   -6.1362056 10.564884  -26.8201840  14.631955
 [19,]   -1.3240948 12.331842  -25.4230102  22.388907
 [20,]    9.9380159 14.318272  -18.4593033  37.382201
 [21,]  -13.9242813 13.120793  -39.1703591  12.410063
 [22,]  -23.5916475 11.257404  -45.2428741  -1.386111
 [23,]   11.4504863  9.667654   -7.7686726  30.711924
 [24,]    5.0264201  8.506374  -11.6590870  21.636109
 [25,]   -3.4534460  7.963272  -19.6007374  12.278793
 [26,]  -17.2486122  8.162688  -33.7500422  -1.389543
 [27,]   -7.2313784  9.055701  -25.1889417  10.519710
 [28,]    8.1532554 10.466251  -12.3484666  28.870372
 [29,]    8.4689892 12.216364  -15.7497761  32.785888
 [30,]   -9.9738770 14.180873  -37.6681996  18.149427
 [31,]   47.0351805 13.200626   21.4376503  72.239752
 [32,]   20.2107056 11.283796   -2.0251649  42.063951
 [33,]   -2.0150693  9.644086  -21.0446879  16.848214
 [34,]   -6.4206442  8.444500  -22.9885159  10.430618
 [35,]  -11.4384191  7.888446  -27.0503241   4.207887
 [36,]   -5.3322940  8.109403  -21.4876742  10.462708
 [37,]  -28.3602689  9.050639  -46.1734443 -10.269104
 [38,]    3.9793562 10.520577  -16.5925607  24.674467
 [39,]  -14.6145187 12.331579  -38.3445414   9.413384
 [40,]   28.4026064 14.355137    1.1596562  56.472138
 [41,]   14.3465911 12.779623  -11.7269282  38.674282
 [42,]    4.2677330 10.974366  -17.4511581  25.356562
 [43,]   13.6173750  9.436840   -5.0103611  31.752890
 [44,]   24.4411170  8.316878    8.2366787  40.420782
 [45,]   13.1321590  7.796554   -1.9819988  28.411982
 [46,]  -17.2973991  7.993831  -32.4906356  -1.542803
 [47,]  -28.0120571  8.860909  -45.0225352 -10.982125
 [48,]    9.2596849 10.228849  -10.6947917  29.284906
 [49,]  -39.2820731 11.926537  -62.6987604 -16.025841
 [50,]   31.0811688 13.833094    4.2934951  58.078129
 [51,]  -25.4595782 12.425264  -50.6878150  -1.437526
 [52,]  -27.7360258 10.723915  -49.4964447  -7.225761
 [53,]   -7.8141735  9.302813  -26.9573200   9.790699
 [54,]   18.7656789  8.307051    2.1206721  34.705485
 [55,]   16.2321312  7.899156    0.9970486  31.661377
 [56,]   -1.4608164  8.167683  -16.9060931  14.562631
 [57,]  132.4758360  9.052637  114.9472370 150.401806
 [58,]   14.9173883 10.397799   -4.9824731  35.667952
 [59,]  -11.8410593 12.050022  -34.6148665  12.229692
 [60,]  -98.5046070 13.900239 -124.9528426 -70.435353
 [61,]   15.9017208 12.546157   -8.5798143  39.816703
 [62,]   11.3151691 10.809663  -10.1472060  32.089620
 [63,]  -11.7696827  9.363564  -30.5289040   6.345073
 [64,]    0.9715656  8.359941  -15.8408028  17.335581
 [65,]  -11.9662862  7.967788  -27.7785751   3.754993
 [66,]   18.7300621  8.274505    2.4758182  34.925155
 [67,]    2.2909103  9.210537  -15.6930116  20.816424
 [68,]    8.8051585 10.610621  -11.8496805  29.887510
 [69,]  -16.9738932 12.317522  -40.9373798   7.716069
 [70,]    1.4097550 14.221187  -26.3617900  29.098085
 [71,]   21.0720047 12.503920   -3.4141816  45.471271
 [72,]   20.2858299 10.748784   -0.5796992  41.101795
 [73,]  -24.0649449  9.282660  -42.1547900  -5.678105
 [74,]  -24.2716197  8.260886  -40.5266412  -7.959360
 [75,]  -11.4337945  7.858738  -26.9901848   4.118522
 [76,]  -17.7812693  8.168252  -33.8127941  -1.735547
 [77,]   -7.9619441  9.117235  -25.8083350   9.841946
 [78,]    6.5218811 10.534262  -14.0261947  27.534055
 [79,]   -0.7683938 12.258076  -24.5095344  23.335835
 [80,]   29.2694314 14.177208    1.5313729  56.973643
 [81,]   -9.3496846 13.313865  -36.1020524  15.911422
 [82,]   23.2920318 11.336420    0.3950823  45.054484
 [83,]    4.1383482  9.624931  -15.3398938  22.475573
 [84,]   20.7525646  8.344678    4.3039634  36.462011
 [85,]    1.7051810  7.713462  -13.6735876  16.593472
 [86,]    5.1922974  7.888652  -10.3716506  20.353448
 [87,]   -3.6887861  8.822337  -21.2546648  12.975285
 [88,]  -13.5272697 10.310477  -34.0890158   6.222897
 [89,]  -12.7813533 12.151037  -37.0339763  10.384185
 [90,]  -10.9860369 14.207708  -39.1484396  16.334276
 [91,]   26.2617114 13.063398    0.9194621  52.354207
 [92,]    8.6139391 11.174190  -12.8577903  30.528395
 [93,]  -32.6676333  9.561425  -50.9817837 -13.804474
 [94,]    2.7563944  8.386138  -13.4486344  18.856851
 [95,]    3.2796221  7.847416  -12.0764152  18.450712
 [96,]   10.2987498  8.073704   -5.6478579  25.998047
 [97,]    3.6333775  9.007531  -13.6313613  21.065980
 [98,]   -3.0213948 10.461104  -22.9976719  17.548908
 [99,]   17.0636329 12.250792   -6.6506318  40.926288
[100,]    1.0290606 14.250519  -26.4066551  28.635972
[101,]    9.4142316 12.995644  -15.5714688  35.390866
[102,]   -7.9339877 11.171445  -29.3955335  14.545906
[103,]  -10.8868070  9.622417  -29.3386252   8.274684
[104,]   -6.4521263  8.500348  -22.9970487  10.309527
[105,]  -22.2255456  7.987252  -38.1388961  -6.655020
[106,]  -14.7231649  8.198278  -31.2195277   1.697385
[107,]  -14.4944842  9.083095  -32.4575960   3.575407
[108,]    0.4809965 10.472285  -20.0287285  21.724559
[109,]   17.0978772 12.194678   -6.7478676  41.783441
[110,]   20.9006579 14.128937   -6.3320648  49.513378
[111,]   17.7772270 12.983883   -6.8436255  43.884316
[112,]  -12.1059997 11.072982  -33.0659793  10.303142
[113,]  -16.3964265  9.454705  -34.8018728   2.501608
[114,]  -34.1146532  8.301971  -50.3149664 -17.574917
[115,]  -37.7659799  7.823348  -52.6996898 -22.372781
[116,]    6.0014933  8.138648   -9.9403407  22.269985
[117,]   38.6805666  9.166307   20.9980477  57.206504
[118,]    5.1137399 10.703062  -15.2055941  26.245989
[119,]   19.6418131 12.563466   -4.4269712  44.260903
[120,]   -2.8334136 14.624520  -31.0334707  25.839189
[121,]   -5.4343149 12.402327  -30.0048579  18.223092
[122,]   36.6684981 10.668985   15.3389087  57.361995
[123,]   -0.9234890  9.204513  -19.4437990  17.069240
[124,]    2.3434240  8.155071  -13.6739034  18.278330
[125,]  -13.8465630  7.692439  -29.1457784   1.359990
[126,]   11.5313500  7.920124   -4.0858467  26.959851
[127,]  -12.7839370  8.784613  -30.2734998   4.419513
[128,]  -41.3633240 10.124070  -61.6003994 -21.689748
[129,]    6.1546889 11.777541  -17.5040378  28.869050
[130,]   24.7501019 13.631230   -2.5765138  50.848651
[131,]  -50.3296282 12.343074  -74.0562498 -26.608372
[132,]   12.1240085 10.616372   -8.6160181  32.556440
[133,]   26.7454453  9.184768    8.5657744  44.350914
[134,]   32.6592820  8.204226   16.1407789  48.404598
[135,]   20.4808187  7.845726    4.6299770  35.675727
[136,]   10.5061554  8.191352   -5.4586996  26.517858
[137,]   -1.9591078  9.161758  -19.6820012  15.988920
[138,]  -10.0162711 10.586506  -30.6971314  11.004113
[139,]   -8.8714344 12.308824  -32.9629951  15.807072
[140,]  -10.0334976 14.221003  -38.1330581  18.534157
[141,]   17.2478962 12.303535   -6.7363649  41.475548
[142,]    2.4141167 10.578869  -18.2391294  23.588552
[143,]  -20.1275627  9.143502  -37.7839527  -1.821531
[144,]  -11.0605422  8.151712  -26.9731102   4.979609
[145,]   14.7578783  7.775141   -0.6052308  30.214828
[146,]    5.8019989  8.100054  -10.2454140  21.382367
[147,]  -24.6233806  9.051219  -42.6420427  -6.793319
[148,]   14.0170399 10.459154   -7.1319274  34.555902
[149,]   -5.1730396 12.166301  -29.4851826  18.723767
[150,]    9.7128810 14.064120  -18.3249349  37.410471
[151,]   -0.6031156 13.427524  -26.4377558  25.923772
[152,]   -6.6182642 11.505020  -29.1342256  15.911810
[153,]  -17.5156127  9.873180  -36.8478598   1.839630
[154,]  -31.2180613  8.697182  -48.3628167 -14.359800
[155,]  -19.4284099  8.176147  -35.5146820  -3.753877
[156,]   41.9533416  8.432372   25.2761736  58.312356
[157,]  -36.3669070  9.402527  -54.5798457 -17.940412
[158,]   14.7958444 10.897580   -6.4726232  36.371187
[159,]   17.0986959 12.733974   -7.8206254  42.064664
[160,]    8.8898473 14.785061  -20.4051290  37.726581
[161,]   17.3518676 12.213278   -5.9112159  41.916559
[162,]   10.5286157 10.507220   -9.5381123  31.461078
[163,]    6.5990639  9.098331  -10.9674579  24.815370
[164,]    1.1040120  8.142358  -14.8528210  17.600642
[165,]  -10.9006398  7.807484  -26.4819129   4.851453
[166,]  -14.9447917  8.170437  -31.1331234   1.354485
[167,]  -49.5766435  9.148535  -67.9774825 -31.252634
[168,]  -13.5974954 10.572407  -34.6093905   7.535411
[169,]   23.1669528 12.288055   -1.4752021  47.665669
[170,]   32.4698009 14.190041    4.0167571  60.469536
[171,]    5.7120595 12.458333  -19.0322307  29.342030
[172,]   -1.9719023 10.677791  -23.0162873  18.618880
[173,]   10.4046360  9.187704   -7.9206738  28.266819
[174,]   11.6931742  8.148996   -4.3079021  27.167653
[175,]  -23.5120876  7.745444  -38.9185771  -9.080833
[176,]    7.1766507  8.072869   -9.0011630  22.813193
[177,]    0.3045889  9.052296  -17.4646724  17.995761
[178,]   -2.7035728 10.502878  -23.2001924  18.278901
[179,]   11.4719654 12.258482  -12.4689139  35.628145
[180,]   -5.2923964 14.206472  -32.5808509  22.311618</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.4 14.6
p_loo        20.0  3.6
looic      1770.8 29.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   750       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   48        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.7
p_loo        34.3  8.7
looic      1722.5 45.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   1238      
 (0.5, 0.7]   (ok)         3    1.7%   309       
   (0.7, 1]   (bad)        1    0.6%   75        
   (1, Inf)   (very bad)   2    1.1%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.1      11.7  
fit_sleep1 -92.1      21.3  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.4 14.6
p_loo        20.0  3.6
looic      1770.8 29.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   750       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   48        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.7
p_loo        34.3  8.7
looic      1722.5 45.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   1238      
 (0.5, 0.7]   (ok)         3    1.7%   309       
   (0.7, 1]   (bad)        1    0.6%   75        
   (1, Inf)   (very bad)   2    1.1%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.2     22.7        34.3    8.7   1722.5
fit_sleep2  -24.1      11.7  -885.4     14.6        20.0    3.6   1770.8
fit_sleep1  -92.1      21.3  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   45.5  
fit_sleep2   29.2  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
9.821921e-41 3.294119e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.96      1.54     0.37     5.36       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.04      1.54    -3.08     2.81       5.05      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.62.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.2          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        ggridges_0.5.4       callr_3.7.3         
 [34] stringr_1.4.1        digest_0.6.30        minqa_1.2.5         
 [37] rmarkdown_2.18       base64enc_0.1-3      pkgconfig_2.0.3     
 [40] htmltools_0.5.3      highr_0.9            fastmap_1.1.0       
 [43] htmlwidgets_1.5.4    rlang_1.0.6          shiny_1.7.3         
 [46] jquerylib_0.1.4      farver_2.1.1         generics_0.1.3      
 [49] zoo_1.8-11           jsonlite_1.8.3       gtools_3.9.3        
 [52] crosstalk_1.2.0      dplyr_1.0.10         distributional_0.3.1
 [55] inline_0.3.19        magrittr_2.0.3       loo_2.5.1           
 [58] bayesplot_1.9.0      munsell_0.5.0        fansi_1.0.3         
 [61] abind_1.4-5          lifecycle_1.0.3      stringi_1.7.8       
 [64] yaml_2.3.6           MASS_7.3-58.1        plyr_1.8.8          
 [67] pkgbuild_1.3.1       grid_4.2.2           parallel_4.2.2      
 [70] promises_1.2.0.1     crayon_1.5.2         miniUI_0.1.1.1      
 [73] lattice_0.20-45      splines_4.2.2        knitr_1.40          
 [76] ps_1.7.2             pillar_1.8.1         igraph_1.3.5        
 [79] boot_1.3-28          markdown_1.3         shinystan_2.6.0     
 [82] reshape2_1.4.4       codetools_0.2-18     stats4_4.2.2        
 [85] rstantools_2.2.0     glue_1.6.2           evaluate_0.18       
 [88] V8_4.2.1             RcppParallel_5.1.5   vctrs_0.5.0         
 [91] nloptr_2.0.3         httpuv_1.6.6         gtable_0.3.1        
 [94] assertthat_0.2.1     cachem_1.0.6         ggplot2_3.4.0       
 [97] xfun_0.34            mime_0.12            xtable_1.8-4        
[100] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[103] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
