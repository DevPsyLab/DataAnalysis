<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing adapt_delta
above 0.8 may help. See http://mc-stan.org/misc/warnings.html#divergent-
transitions-after-warmup</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.99      6.95    15.20    43.41 1.00     1571     2056
sd(Days)                6.51      1.50     4.16    10.15 1.00     1373     1842
cor(Intercept,Days)     0.10      0.29    -0.45     0.67 1.00      991     1444

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.14      7.42   236.59   265.67 1.00     1855     2518
Days         10.39      1.66     7.03    13.61 1.00     1450     1633

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.58    23.02    29.30 1.00     2868     2303

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.2532  12.81570 228.8082 279.6506
309 211.6171  13.29071 185.9147 237.3300
310 212.7778  13.09863 186.3058 237.6519
330 274.5614  13.62470 248.6787 302.2900
331 273.1369  12.90348 248.6873 299.5707
332 260.2482  12.66365 236.2065 285.6238
333 267.8651  12.59999 243.4537 293.2415
334 244.4069  12.19957 220.7644 267.9439
335 250.4691  13.56000 224.1218 277.5575
337 286.2624  13.34844 260.4594 312.5834
349 226.6202  13.10957 199.8135 250.9309
350 238.9083  13.05058 212.7148 264.2589
351 255.4247  12.14793 232.3002 279.5850
352 272.2573  12.40682 247.7763 296.1867
369 254.5378  11.99868 231.4982 278.2085
370 226.7591  13.65754 199.4908 253.0828
371 252.1649  12.36019 227.9817 276.7999
372 263.4925  12.69982 238.1892 289.3803

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5759073  2.507254 14.6820865 24.528541
309  1.7236642  2.527574 -3.2174866  6.738417
310  4.9403591  2.463681  0.1939083  9.811554
330  5.7219977  2.557229  0.6553561 10.563853
331  7.4931600  2.446117  2.5510195 12.250327
332 10.2341127  2.422324  5.4079109 14.950902
333 10.3444591  2.378789  5.7399628 14.907524
334 11.4801815  2.298396  7.1732632 16.043845
335 -0.1989336  2.613689 -5.4351587  4.746747
337 19.1320165  2.451175 14.2528705 23.937221
349 11.5493649  2.469437  6.9195648 16.655838
350 16.9719490  2.493372 12.2877142 21.885963
351  7.5394974  2.338182  3.0099371 12.128280
352 14.0085176  2.324045  9.3998632 18.642457
369 11.3460759  2.313980  6.7893476 15.928911
370 15.1528943  2.524801 10.2646271 20.339237
371  9.5254062  2.319694  4.9640408 14.178850
372 11.8070633  2.370162  7.2476854 16.586687</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.2532 12.815705 228.8082 279.6506
  [2,] 273.8291 10.921269 252.2342 295.5743
  [3,] 293.4050  9.320869 275.0818 311.7877
  [4,] 312.9810  8.188756 296.8320 328.8603
  [5,] 332.5569  7.733401 317.2047 347.6790
  [6,] 352.1328  8.070187 336.2082 368.2169
  [7,] 371.7087  9.111694 353.8691 389.8743
  [8,] 391.2846 10.653200 370.8117 412.4169
  [9,] 410.8605 12.511236 387.0260 435.8260
 [10,] 430.4364 14.565165 402.4831 459.5007
 [11,] 211.6171 13.290708 185.9147 237.3300
 [12,] 213.3407 11.381600 191.0780 235.4431
 [13,] 215.0644  9.757868 196.1050 233.9195
 [14,] 216.7881  8.583030 200.3032 233.5191
 [15,] 218.5117  8.055936 203.1258 234.4821
 [16,] 220.2354  8.300906 204.4746 236.6473
 [17,] 221.9590  9.256849 204.2465 240.2798
 [18,] 223.6827 10.735489 202.2934 244.6191
 [19,] 225.4064 12.553464 200.7053 249.4563
 [20,] 227.1300 14.584425 198.2463 255.2354
 [21,] 212.7778 13.098629 186.3058 237.6519
 [22,] 217.7182 11.255889 195.7320 238.9824
 [23,] 222.6585  9.693062 203.6787 241.1473
 [24,] 227.5989  8.564771 210.7611 244.0596
 [25,] 232.5392  8.055718 216.4366 248.0186
 [26,] 237.4796  8.280902 221.2301 253.5626
 [27,] 242.4200  9.186486 224.2491 260.4531
 [28,] 247.3603 10.599489 226.5700 267.4002
 [29,] 252.3007 12.346913 228.0388 275.5305
 [30,] 257.2410 14.306739 229.4887 284.5285
 [31,] 274.5614 13.624705 248.6787 302.2900
 [32,] 280.2834 11.655518 258.0058 304.0898
 [33,] 286.0054  9.957331 266.7746 306.1186
 [34,] 291.7274  8.690491 274.8288 308.7880
 [35,] 297.4494  8.060997 281.6051 312.7474
 [36,] 303.1714  8.216663 287.0946 318.9537
 [37,] 308.8934  9.117361 291.1711 327.0296
 [38,] 314.6154 10.574395 294.0069 335.7914
 [39,] 320.3374 12.393072 296.5673 345.2440
 [40,] 326.0594 14.437364 298.0999 354.7335
 [41,] 273.1369 12.903478 248.6873 299.5707
 [42,] 280.6301 11.031656 259.5178 303.4667
 [43,] 288.1233  9.426670 269.8296 307.2628
 [44,] 295.6164  8.245832 279.4571 311.9993
 [45,] 303.1096  7.687155 287.8065 318.4386
 [46,] 310.6027  7.884030 295.1320 326.2246
 [47,] 318.0959  8.785812 300.9572 335.3836
 [48,] 325.5891 10.207351 305.8167 345.8298
 [49,] 333.0822 11.964804 309.6121 357.0395
 [50,] 340.5754 13.931619 313.8091 368.4815
 [51,] 260.2482 12.663652 236.2065 285.6238
 [52,] 270.4823 10.883175 249.6671 292.3838
 [53,] 280.7164  9.394372 262.7416 299.4239
 [54,] 290.9505  8.354654 274.8857 307.3061
 [55,] 301.1847  7.942391 285.2688 316.6960
 [56,] 311.4188  8.252165 295.3954 327.4382
 [57,] 321.6529  9.211415 303.5863 339.4242
 [58,] 331.8870 10.646005 310.8015 352.6674
 [59,] 342.1211 12.391931 317.8981 366.3120
 [60,] 352.3552 14.335893 324.5717 380.2524
 [61,] 267.8651 12.599987 243.4537 293.2415
 [62,] 278.2095 10.834687 257.4252 300.3456
 [63,] 288.5540  9.345507 270.7885 307.4172
 [64,] 298.8984  8.282742 283.1322 315.3356
 [65,] 309.2429  7.822175 293.9185 324.7516
 [66,] 319.5874  8.067607 303.3418 335.5064
 [67,] 329.9318  8.961218 312.0555 347.1421
 [68,] 340.2763 10.336239 319.4742 359.9734
 [69,] 350.6207 12.028695 326.7735 373.5736
 [70,] 360.9652 13.923306 333.0063 387.6074
 [71,] 244.4069 12.199570 220.7644 267.9439
 [72,] 255.8871 10.541225 235.2295 276.2721
 [73,] 267.3673  9.163547 249.8036 285.1362
 [74,] 278.8474  8.209081 263.2532 295.1636
 [75,] 290.3276  7.834071 275.1463 305.9142
 [76,] 301.8078  8.119210 286.1795 317.9571
 [77,] 313.2880  9.001984 295.7869 331.0715
 [78,] 324.7682 10.330301 304.9343 344.7735
 [79,] 336.2484 11.956578 313.6266 359.4803
 [80,] 347.7285 13.775691 321.4657 374.4537
 [81,] 250.4691 13.559996 224.1218 277.5575
 [82,] 250.2701 11.541415 227.9271 272.9865
 [83,] 250.0712  9.808046 230.9809 269.2692
 [84,] 249.8723  8.535455 233.3227 266.5874
 [85,] 249.6733  7.948142 233.8188 265.1808
 [86,] 249.4744  8.194796 232.8135 265.4353
 [87,] 249.2755  9.208644 230.8612 267.2631
 [88,] 249.0765 10.775264 227.6930 270.0305
 [89,] 248.8776 12.691581 223.8286 272.9477
 [90,] 248.6787 14.822580 219.3556 276.6551
 [91,] 286.2624 13.348438 260.4594 312.5834
 [92,] 305.3944 11.490519 283.3124 328.3022
 [93,] 324.5264  9.894432 305.2958 344.4132
 [94,] 343.6584  8.705404 326.2851 360.8803
 [95,] 362.7904  8.104618 346.7640 378.6688
 [96,] 381.9225  8.222052 365.8232 398.1932
 [97,] 401.0545  9.029726 383.0079 418.5309
 [98,] 420.1865 10.367560 399.6819 440.2303
 [99,] 439.3185 12.060396 415.6172 462.8160
[100,] 458.4505 13.979861 431.4193 486.2714
[101,] 226.6202 13.109569 199.8135 250.9309
[102,] 238.1695 11.205142 215.0329 259.1776
[103,] 249.7189  9.562731 230.3699 267.9988
[104,] 261.2683  8.338627 244.5531 277.3198
[105,] 272.8176  7.734068 257.8101 287.9658
[106,] 284.3670  7.892728 269.1514 299.8788
[107,] 295.9163  8.773297 279.0335 312.8885
[108,] 307.4657 10.190317 287.8879 327.2844
[109,] 319.0151 11.954523 295.8081 342.0241
[110,] 330.5644 13.934666 303.6630 357.7808
[111,] 238.9083 13.050576 212.7148 264.2589
[112,] 255.8803 11.182624 233.4550 277.8849
[113,] 272.8522  9.603043 253.8726 291.6869
[114,] 289.8242  8.474644 272.8978 306.1664
[115,] 306.7961  7.990905 290.7367 322.8051
[116,] 323.7681  8.265793 307.1767 340.2370
[117,] 340.7400  9.231788 322.5418 359.0646
[118,] 357.7120 10.703378 336.8419 378.6062
[119,] 374.6839 12.503300 350.5903 399.6671
[120,] 391.6559 14.509877 364.0812 420.2589
[121,] 255.4247 12.147925 232.3002 279.5850
[122,] 262.9642 10.460231 242.6573 283.8140
[123,] 270.5037  9.066144 252.6733 288.4379
[124,] 278.0432  8.118355 262.1540 294.0012
[125,] 285.5827  7.781683 270.2542 300.9014
[126,] 293.1222  8.132385 277.1684 308.7737
[127,] 300.6617  9.091257 282.3689 318.0946
[128,] 308.2012 10.492875 287.4859 328.2978
[129,] 315.7407 12.185404 291.1019 339.2336
[130,] 323.2802 14.064207 295.0283 350.3384
[131,] 272.2573 12.406823 247.7763 296.1867
[132,] 286.2658 10.717034 265.6028 307.3725
[133,] 300.2744  9.304986 281.9827 318.4016
[134,] 314.2829  8.313427 297.9323 330.6310
[135,] 328.2914  7.902262 312.5470 343.9424
[136,] 342.2999  8.159705 325.8927 358.5199
[137,] 356.3084  9.028743 338.6121 374.1412
[138,] 370.3169 10.356543 349.8968 390.6636
[139,] 384.3255 11.991669 360.9775 407.7488
[140,] 398.3340 13.825506 371.1447 425.6989
[141,] 254.5378 11.998684 231.4982 278.2085
[142,] 265.8838 10.312828 245.9830 285.8285
[143,] 277.2299  8.913440 259.7082 294.4529
[144,] 288.5760  7.953202 272.4023 303.9434
[145,] 299.9221  7.600424 284.6933 314.3438
[146,] 311.2681  7.936527 295.5651 326.4805
[147,] 322.6142  8.883664 304.8009 339.5824
[148,] 333.9603 10.274216 313.7914 353.9179
[149,] 345.3064 11.954437 322.0742 368.3645
[150,] 356.6524 13.819067 329.6877 383.4391
[151,] 226.7591 13.657539 199.4908 253.0828
[152,] 241.9120 11.699490 218.8852 264.6179
[153,] 257.0649  9.998849 237.7322 276.9187
[154,] 272.2178  8.707764 255.0749 289.3585
[155,] 287.3707  8.026366 271.8793 303.1487
[156,] 302.5235  8.109820 286.9821 318.6819
[157,] 317.6764  8.936725 300.2091 335.0207
[158,] 332.8293 10.330062 312.4206 352.7829
[159,] 347.9822 12.095641 324.2780 371.8224
[160,] 363.1351 14.094258 335.1754 390.6349
[161,] 252.1649 12.360190 227.9817 276.7999
[162,] 261.6903 10.657979 241.0442 283.0493
[163,] 271.2157  9.228906 253.1820 289.7950
[164,] 280.7411  8.216742 264.4914 297.2212
[165,] 290.2665  7.785817 275.3595 305.5613
[166,] 299.7919  8.030256 283.9273 315.5879
[167,] 309.3173  8.894550 292.0888 326.5204
[168,] 318.8427 10.222670 299.0653 338.6022
[169,] 328.3681 11.859802 305.2963 351.3670
[170,] 337.8935 13.695575 310.8811 364.2624
[171,] 263.4925 12.699817 238.1892 289.3803
[172,] 275.2995 10.958706 253.7045 297.2073
[173,] 287.1066  9.494022 268.0472 306.3437
[174,] 298.9137  8.450739 282.4082 316.0413
[175,] 310.7207  7.995554 295.2832 326.7124
[176,] 322.5278  8.226669 306.5940 339.1586
[177,] 334.3349  9.091899 316.9539 352.6104
[178,] 346.1419 10.434678 326.4968 366.5234
[179,] 357.9490 12.097012 334.7888 381.7536
[180,] 369.7560 13.965251 342.9645 397.2330</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.6932294 12.815705  -30.09059967  20.7518459
  [2,]  -15.1244367 10.921269  -36.86961683   6.4705439
  [3,]  -42.6044440  9.320869  -60.98714655 -24.2811945
  [4,]    8.4588486  8.188756   -7.42050476  24.6078090
  [5,]   24.2950413  7.733401    9.17286967  39.6471883
  [6,]   62.5573340  8.070187   46.47322774  78.4819279
  [7,]   10.4951266  9.111694   -7.67051890  28.3346881
  [8,] -101.1359807 10.653200 -122.26831963 -80.6630798
  [9,]   19.7248120 12.511236   -5.24067207  43.5593384
 [10,]   35.9171046 14.565165    6.85284127  63.8704442
 [11,]   11.1168363 13.290708  -14.59608333  36.8192156
 [12,]   -8.0749279 11.381600  -30.17725238  14.1878274
 [13,]  -12.0865921  9.757868  -30.94167140   6.8728246
 [14,]  -12.0810563  8.583030  -28.81209057   4.4037615
 [15,]  -10.7956204  8.055936  -26.76604924   4.5903072
 [16,]   -4.2735846  8.300906  -20.68548232  11.4871826
 [17,]   -8.3287488  9.256849  -26.64953767   9.3838082
 [18,]   -5.9555130 10.735489  -26.89189289  15.4337671
 [19,]   -1.1106772 12.553464  -25.16058299  23.5903762
 [20,]   10.1841586 14.584425  -17.92122535  39.0678602
 [21,]  -13.7238995 13.098629  -38.59798489  12.7480503
 [22,]  -23.3859586 11.255889  -44.65023164  -1.3997981
 [23,]   11.6614823  9.693062   -6.82729624  30.6413190
 [24,]    5.2427232  8.564771  -11.21795552  22.0804954
 [25,]   -3.2318359  8.055718  -18.71115048  12.8708179
 [26,]  -17.0216950  8.280902  -33.10467321  -0.7722126
 [27,]   -6.9991541  9.186486  -25.03228290  11.1716824
 [28,]    8.3907868 10.599489  -11.64905964  29.1811315
 [29,]    8.7118277 12.346913  -14.51803622  32.9736849
 [30,]   -9.7257314 14.306739  -37.01319127  18.0265993
 [31,]   46.9811664 13.624705   19.25259589  72.8639451
 [32,]   20.1167687 11.655518   -3.68964103  42.3944166
 [33,]   -2.1489291  9.957331  -22.26210140  17.0819412
 [34,]   -6.5944268  8.690491  -23.65498087  10.3041976
 [35,]  -11.6521245  8.060997  -26.95012072   4.1922224
 [36,]   -5.5859223  8.216663  -21.36821298  10.4908707
 [37,]  -28.6538200  9.117361  -46.79003070 -10.9314602
 [38,]    3.6458823 10.574395  -17.53005701  24.2543743
 [39,]  -14.9879155 12.393072  -39.89449554   8.7822059
 [40,]   27.9892868 14.437364   -0.68481044  55.9488420
 [41,]   14.4709609 12.903478  -11.96278884  38.9206309
 [42,]    4.3699009 11.031656  -18.46672998  25.4822448
 [43,]   13.6973409  9.426670   -5.44222155  31.9910151
 [44,]   24.4988809  8.245832    8.11596690  40.6582326
 [45,]   13.1677209  7.687155   -2.16131567  28.4707714
 [46,]  -17.2840392  7.884030  -32.90593085  -1.8133447
 [47,]  -28.0208992  8.785812  -45.30856271 -10.8821570
 [48,]    9.2286408 10.207351  -11.01210849  29.0009683
 [49,]  -39.3353192 11.964804  -63.29262405 -15.8652110
 [50,]   31.0057208 13.931619    3.09958422  57.7720384
 [51,]  -25.3876087 12.663652  -50.76318808  -1.3458632
 [52,]  -27.6705215 10.883175  -49.57203147  -6.8553381
 [53,]   -7.7551342  9.394372  -26.46263170  10.2196554
 [54,]   18.8182531  8.354654    2.46268518  34.8831353
 [55,]   16.2782404  7.942391    0.76686051  32.1940937
 [56,]   -1.4211723  8.252165  -17.44062014  14.6022192
 [57,]  132.5090150  9.211415  114.73773031 150.5756449
 [58,]   14.9441022 10.646005   -5.83632090  36.0295881
 [59,]  -11.8208105 12.391931  -36.01165614  12.4022116
 [60,]  -98.4908232 14.335893 -126.38799580 -70.7072788
 [61,]   15.9773286 12.599987   -9.39913677  40.3886682
 [62,]   11.3454695 10.834687  -10.79064244  32.1298378
 [63,]  -11.7846895  9.345507  -30.64792409   5.9807668
 [64,]    0.9112514  8.282742  -15.52589356  16.6775199
 [65,]  -12.0719076  7.822175  -27.58057952   3.2524803
 [66,]   18.5791333  8.067607    2.66011204  34.8246842
 [67,]    2.0946743  8.961218  -15.11563063  19.9710349
 [68,]    8.5636152 10.336239  -11.13352699  29.3657134
 [69,]  -17.2607438 12.028695  -40.21362569   6.5864964
 [70,]    1.0775971 13.923306  -25.56456426  29.0365062
 [71,]   21.0662011 12.199570   -2.47077754  44.7086601
 [72,]   20.3141196 10.541225   -0.07089409  40.9716952
 [73,]  -24.0025619  9.163547  -41.77145459  -6.4388610
 [74,]  -24.1751434  8.209081  -40.49126523  -8.5809084
 [75,]  -11.3032249  7.834071  -26.88984021   3.8780672
 [76,]  -17.6166064  8.119210  -33.76586234  -1.9882636
 [77,]   -7.7631879  9.001984  -25.54667592   9.7378677
 [78,]    6.7547306 10.330301  -13.25057326  26.5885773
 [79,]   -0.5014508 11.956578  -23.73335116  22.1202905
 [80,]   29.5704677 13.775691    2.84528571  55.8333442
 [81,]   -8.8607557 13.559996  -35.94916067  17.4864820
 [82,]   23.6770779 11.541415    0.96066838  46.0200887
 [83,]    4.4195115  9.808046  -14.77852496  23.5097911
 [84,]   20.9298450  8.535455    4.21470607  37.4793648
 [85,]    1.7785786  7.948142  -13.72887945  17.6331096
 [86,]    5.1618121  8.194796  -10.79907632  21.8226614
 [87,]   -3.8231543  9.208644  -21.81078929  14.5910522
 [88,]  -13.7655208 10.775264  -34.71950714   7.6180344
 [89,]  -13.1234872 12.691581  -37.19364094  11.9255073
 [90,]  -11.4320536 14.822580  -39.40851174  17.8910277
 [91,]   26.1042297 13.348438   -0.21682478  51.9071799
 [92,]    8.4114132 11.490519  -14.49638988  30.4934122
 [93,]  -32.9152033  9.894432  -52.80197039 -13.6846005
 [94,]    2.4637801  8.705404  -14.75812527  19.8371021
 [95,]    2.9419636  8.104618  -12.93639221  18.9683774
 [96,]    9.9160471  8.222052   -6.35471726  26.0153029
 [97,]    3.2056305  9.029726  -14.27079299  21.2522281
 [98,]   -3.4941860 10.367560  -23.53803481  17.0104398
 [99,]   16.5457975 12.060396   -6.95172891  40.2471171
[100,]    0.4661810 13.979861  -27.35469442  27.4974108
[101,]    9.4830438 13.109569  -14.82769871  36.2897385
[102,]   -7.8528210 11.205142  -28.86094615  15.2837621
[103,]  -10.7932859  9.562731  -29.07316688   8.5556800
[104,]   -6.3462508  8.338627  -22.39780350  10.3688943
[105,]  -22.1073156  7.734068  -37.25553456  -7.0997524
[106,]  -14.5925805  7.892728  -30.10443596   0.6230233
[107,]  -14.3515454  8.773297  -31.32373292   2.5312966
[108,]    0.6362898 10.190317  -19.18237951  20.2140939
[109,]   17.2655249 11.954523   -5.74353449  40.4724563
[110,]   21.0806600 13.934666   -6.13565993  47.9821151
[111,]   17.3884845 13.050576   -7.96209370  43.5819879
[112,]  -12.4259645 11.182624  -34.43063179   9.9993280
[113,]  -16.6476135  9.603043  -35.48230744   2.3319856
[114,]  -34.2970624  8.474644  -50.63930902 -17.3706761
[115,]  -37.8796114  7.990905  -53.88857031 -21.8201830
[116,]    5.9566396  8.265793  -10.51232695  22.5479626
[117,]   38.7044906  9.231788   20.37987792  56.9026957
[118,]    5.2064417 10.703378  -15.68780820  26.0765148
[119,]   19.8032927 12.503300   -5.17987255  43.8968870
[120,]   -2.6031563 14.509877  -31.20623290  24.9714785
[121,]   -4.8982332 12.147925  -29.05853919  18.2263446
[122,]   37.0933695 10.460231   16.24356115  57.4002777
[123,]   -0.6098279  9.066144  -18.54395165  17.2205843
[124,]    2.5458748  8.118355  -13.41212265  18.4350822
[125,]  -13.7553226  7.781683  -29.07402951   1.5732194
[126,]   11.5113801  8.132385   -4.14013357  27.4651766
[127,]  -12.9151173  9.091257  -30.34801609   5.3776986
[128,]  -41.6057146 10.492875  -61.70231693 -20.8903871
[129,]    5.8010880 12.185404  -17.69178347  30.4399175
[130,]   24.2852907 14.064207   -2.77291364  52.5372268
[131,]  -50.5802211 12.406823  -74.50956646 -26.0992486
[132,]   11.9280613 10.717034   -9.17859065  32.5910741
[133,]   26.6041436  9.304986    8.47685451  44.8957505
[134,]   32.5726260  8.313427   16.22448162  48.9231907
[135,]   20.4488084  7.902262    4.79779131  36.1932427
[136,]   10.5287907  8.159705   -5.69120969  26.9360015
[137,]   -1.8818269  9.028743  -19.71463381  15.8144753
[138,]   -9.8843445 10.356543  -30.23099627  10.5358199
[139,]   -8.6848622 11.991669  -32.10816594  14.6631016
[140,]   -9.7922798 13.825506  -37.15722228  17.3970409
[141,]   17.3857462 11.998684   -6.28502801  40.4253230
[142,]    2.5530703 10.312828  -17.39156013  22.4539082
[143,]  -19.9875056  8.913440  -37.21050848  -2.4657693
[144,]  -10.9193815  7.953202  -26.28676018   5.2542868
[145,]   14.9001426  7.600424    0.47843495  30.1289131
[146,]    5.9453667  7.936527   -9.26701597  21.6483631
[147,]  -24.4789092  8.883664  -41.44711204  -6.6655645
[148,]   14.1626149 10.274216   -5.79498658  34.3315235
[149,]   -5.0263609 11.954437  -28.08451864  18.2058381
[150,]    9.8606632 13.819067  -16.92595337  36.8254135
[151,]   -1.4950732 13.657539  -27.81881748  25.7731526
[152,]   -7.3884674 11.699490  -30.09440408  15.6382856
[153,]  -18.1640617  9.998849  -38.01785627   1.1686441
[154,]  -31.7447560  8.707764  -48.88552105 -14.6018795
[155,]  -19.8333503  8.026366  -35.61138422  -4.3419961
[156,]   41.6701554  8.109820   25.51184476  57.2116001
[157,]  -36.5283389  8.936725  -53.87258167 -19.0610496
[158,]   14.7561668 10.330062   -5.19738482  35.1649469
[159,]   17.1807725 12.095641   -6.65940860  40.8849962
[160,]    9.0936783 14.094258  -18.40606645  37.0533960
[161,]   17.7155206 12.360190   -6.91946467  41.8986578
[162,]   10.7525144 10.657979  -10.60648440  31.3985638
[163,]    6.6832083  9.228906  -11.89612148  24.7168832
[164,]    1.0484021  8.216742  -15.43172537  17.2981027
[165,]  -11.0960041  7.785817  -26.39080679   3.8110164
[166,]  -15.2799102  8.030256  -31.07585698   0.5847277
[167,]  -50.0515164  8.894550  -67.25463553 -32.8229880
[168,]  -14.2121225 10.222670  -33.97162223   5.5652629
[169,]   22.4125713 11.859802   -0.58630365  45.4843949
[170,]   31.5756652 13.695575    5.20682664  58.5881237
[171,]    5.9192223 12.699817  -19.96863389  31.2225393
[172,]   -1.8255410 10.958706  -23.73325526  19.7694938
[173,]   10.4901957  9.494022   -8.74689576  29.5496296
[174,]   11.7179324  8.450739   -5.40967896  28.2234342
[175,]  -23.5481309  7.995554  -39.53984236  -8.1106470
[176,]    7.0798058  8.226669   -9.55101509  23.0136016
[177,]    0.1469425  9.091899  -18.12859128  17.5279040
[178,]   -2.9220208 10.434678  -23.30353274  16.7231230
[179,]   11.1927159 12.097012  -12.61193975  34.3528639
[180,]   -5.6324474 13.965251  -33.10943396  21.1591014</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.4
p_loo        19.2  3.3
looic      1769.4 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   579       
 (0.5, 0.7]   (ok)         1    0.6%   145       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.8 22.9
p_loo        34.8  9.1
looic      1723.7 45.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     166   92.2%   968       
 (0.5, 0.7]   (ok)        11    6.1%   503       
   (0.7, 1]   (bad)        2    1.1%   13        
   (1, Inf)   (very bad)   1    0.6%   4         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -22.9      12.1  
fit_sleep1 -91.4      21.5  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.4
p_loo        19.2  3.3
looic      1769.4 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   579       
 (0.5, 0.7]   (ok)         1    0.6%   145       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.8 22.9
p_loo        34.8  9.1
looic      1723.7 45.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     166   92.2%   968       
 (0.5, 0.7]   (ok)        11    6.1%   503       
   (0.7, 1]   (bad)        2    1.1%   13        
   (1, Inf)   (very bad)   1    0.6%   4         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.8     22.9        34.8    9.1   1723.7
fit_sleep2  -22.9      12.1  -884.7     14.4        19.2    3.3   1769.4
fit_sleep1  -91.4      21.5  -953.2     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   45.7  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.996022e-40 1.160719e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.58      0.3     5.48       0.04      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.58    -3.26     3.07       5.04      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.62.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.2          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        ggridges_0.5.4       callr_3.7.3         
 [34] stringr_1.4.1        digest_0.6.30        minqa_1.2.5         
 [37] rmarkdown_2.18       base64enc_0.1-3      pkgconfig_2.0.3     
 [40] htmltools_0.5.3      highr_0.9            fastmap_1.1.0       
 [43] htmlwidgets_1.5.4    rlang_1.0.6          shiny_1.7.3         
 [46] jquerylib_0.1.4      farver_2.1.1         generics_0.1.3      
 [49] zoo_1.8-11           jsonlite_1.8.3       gtools_3.9.3        
 [52] crosstalk_1.2.0      dplyr_1.0.10         distributional_0.3.1
 [55] inline_0.3.19        magrittr_2.0.3       loo_2.5.1           
 [58] bayesplot_1.9.0      munsell_0.5.0        fansi_1.0.3         
 [61] abind_1.4-5          lifecycle_1.0.3      stringi_1.7.8       
 [64] yaml_2.3.6           MASS_7.3-58.1        plyr_1.8.8          
 [67] pkgbuild_1.3.1       grid_4.2.2           parallel_4.2.2      
 [70] promises_1.2.0.1     crayon_1.5.2         miniUI_0.1.1.1      
 [73] lattice_0.20-45      splines_4.2.2        knitr_1.40          
 [76] ps_1.7.2             pillar_1.8.1         igraph_1.3.5        
 [79] boot_1.3-28          markdown_1.3         shinystan_2.6.0     
 [82] reshape2_1.4.4       codetools_0.2-18     stats4_4.2.2        
 [85] rstantools_2.2.0     glue_1.6.2           evaluate_0.18       
 [88] V8_4.2.1             RcppParallel_5.1.5   vctrs_0.5.0         
 [91] nloptr_2.0.3         httpuv_1.6.6         gtable_0.3.1        
 [94] assertthat_0.2.1     cachem_1.0.6         ggplot2_3.4.0       
 [97] xfun_0.34            mime_0.12            xtable_1.8-4        
[100] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[103] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
