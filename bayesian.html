<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.83      6.78    15.58    41.89 1.00     1696     2433
sd(Days)                6.60      1.51     4.18    10.11 1.00     1484     2382
cor(Intercept,Days)     0.07      0.30    -0.49     0.65 1.00      961     1364

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.23      7.32   236.56   265.74 1.00     1944     2845
Days         10.45      1.70     7.11    13.61 1.00     1268     2180

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.88      1.57    22.99    29.19 1.00     3704     3067

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7535  13.20333 227.9181 279.6325
309 211.6413  13.53880 185.0596 238.5906
310 213.0217  13.17319 187.8019 238.5589
330 274.6806  13.22523 249.6770 300.3560
331 273.2495  13.06932 248.3893 298.8036
332 260.4096  12.27543 236.5255 284.4846
333 267.5564  12.92775 242.7783 293.1162
334 244.4728  12.32779 220.1243 268.1745
335 250.5128  13.26027 225.0949 277.6812
337 285.9396  13.08652 260.7067 313.3776
349 226.7080  12.88297 200.8213 251.6278
350 238.7222  13.26077 212.1569 263.0729
351 255.6215  12.31928 231.3609 279.3545
352 272.0134  12.64253 247.2675 297.1751
369 254.6686  12.26195 230.9171 279.4842
370 226.2134  13.96848 198.4105 253.1164
371 252.2532  12.29814 228.4989 276.8266
372 263.5835  12.18984 240.6423 288.0577

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6798279  2.489057 14.7822550 24.580736
309  1.7310125  2.497862 -3.1594645  6.616711
310  4.9087352  2.426070  0.1097479  9.572144
330  5.7342577  2.525797  0.8078448 10.570917
331  7.4462100  2.476267  2.6579805 12.149986
332 10.2028730  2.329290  5.4524183 14.765917
333 10.3455874  2.455183  5.3929367 15.136542
334 11.4886239  2.369194  6.9485249 16.179794
335 -0.2434788  2.550320 -5.4872098  4.618669
337 19.1729080  2.482238 14.1873038 23.907692
349 11.5484331  2.421332  6.8855991 16.379781
350 17.0602631  2.552886 12.1755069 22.147336
351  7.5369058  2.348478  2.9044673 12.072804
352 14.0709143  2.418593  9.2276193 18.787589
369 11.3777271  2.333973  6.7885450 15.954995
370 15.2369649  2.613798 10.0810825 20.408882
371  9.4787096  2.368603  4.7043838 14.044081
372 11.7607588  2.325377  7.1241089 16.199220</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7535 13.203327 227.9181 279.6325
  [2,] 273.4333 11.301649 251.7288 295.5188
  [3,] 293.1131  9.670445 274.5662 311.9986
  [4,] 312.7930  8.467501 296.3814 329.1071
  [5,] 332.4728  7.891162 317.4856 347.9769
  [6,] 352.1526  8.076702 336.4851 367.9973
  [7,] 371.8325  8.977005 354.4794 389.2595
  [8,] 391.5123 10.408214 371.2348 411.7167
  [9,] 411.1921 12.184664 387.3676 434.7078
 [10,] 430.8719 14.177164 402.7694 458.1665
 [11,] 211.6413 13.538799 185.0596 238.5906
 [12,] 213.3723 11.623204 190.4568 236.4155
 [13,] 215.1033  9.968816 195.8399 234.7343
 [14,] 216.8343  8.725500 199.9710 234.2376
 [15,] 218.5653  8.085174 202.9501 234.4973
 [16,] 220.2963  8.190504 204.6882 236.7198
 [17,] 222.0273  9.015393 204.2696 239.7553
 [18,] 223.7584 10.389845 203.3787 244.3599
 [19,] 225.4894 12.128442 201.7947 249.8699
 [20,] 227.2204 14.097090 199.6352 255.3983
 [21,] 213.0217 13.173188 187.8019 238.5589
 [22,] 217.9304 11.342586 196.4775 240.2631
 [23,] 222.8391  9.774829 204.1997 241.9872
 [24,] 227.7479  8.614635 210.9662 244.5969
 [25,] 232.6566  8.040412 216.4180 248.5040
 [26,] 237.5654  8.176561 221.5548 253.8543
 [27,] 242.4741  8.990868 225.1509 260.5558
 [28,] 247.3828 10.324093 227.3490 267.9890
 [29,] 252.2916 12.004571 228.7195 276.0038
 [30,] 257.2003 13.906984 229.6444 284.6422
 [31,] 274.6806 13.225233 249.6770 300.3560
 [32,] 280.4148 11.298244 258.8282 302.0244
 [33,] 286.1491  9.651587 267.6535 304.7012
 [34,] 291.8834  8.450755 275.5287 308.1739
 [35,] 297.6176  7.901688 282.1764 312.8619
 [36,] 303.3519  8.137407 287.8897 319.2487
 [37,] 309.0861  9.097110 291.5393 327.0972
 [38,] 314.8204 10.585684 294.5823 335.8932
 [39,] 320.5546 12.414319 297.1564 344.8802
 [40,] 326.2889 14.454523 298.8910 354.1880
 [41,] 273.2495 13.069322 248.3893 298.8036
 [42,] 280.6957 11.189896 259.2413 302.6372
 [43,] 288.1419  9.585622 269.4629 306.9400
 [44,] 295.5881  8.415363 279.0735 311.9137
 [45,] 303.0343  7.875043 287.4871 318.3056
 [46,] 310.4805  8.091852 294.6638 326.1972
 [47,] 317.9267  9.011305 300.7931 335.3494
 [48,] 325.3729 10.449544 305.5107 345.6685
 [49,] 332.8192 12.224815 309.2274 356.6983
 [50,] 340.2654 14.211370 313.3611 368.2951
 [51,] 260.4096 12.275435 236.5255 284.4846
 [52,] 270.6124 10.554166 249.8291 291.2962
 [53,] 280.8153  9.107455 262.5678 298.6111
 [54,] 291.0182  8.084073 274.6914 306.4997
 [55,] 301.2211  7.655712 286.1923 316.2670
 [56,] 311.4239  7.919520 295.8087 327.0369
 [57,] 321.6268  8.813562 304.5135 339.1906
 [58,] 331.8297 10.173009 312.0558 352.0951
 [59,] 342.0326 11.838604 318.7565 365.3592
 [60,] 352.2354 13.699130 325.4772 378.6533
 [61,] 267.5564 12.927753 242.7783 293.1162
 [62,] 277.9020 11.129841 256.4288 299.9468
 [63,] 288.2476  9.626827 269.5004 307.3557
 [64,] 298.5932  8.575202 282.1320 315.4182
 [65,] 308.9388  8.151577 292.9285 325.2730
 [66,] 319.2844  8.450929 302.6271 336.0302
 [67,] 329.6299  9.404469 311.2403 348.1246
 [68,] 339.9755 10.840928 318.6722 361.4257
 [69,] 350.3211 12.596160 325.4371 375.7969
 [70,] 360.6667 14.555296 331.4588 389.7422
 [71,] 244.4728 12.327791 220.1243 268.1745
 [72,] 255.9614 10.575883 234.6442 276.6935
 [73,] 267.4500  9.107708 249.4418 285.4002
 [74,] 278.9387  8.079451 263.1777 294.7882
 [75,] 290.4273  7.670128 275.4441 305.3923
 [76,] 301.9159  7.975611 286.2607 317.7539
 [77,] 313.4045  8.922781 296.2979 331.1416
 [78,] 324.8932 10.336722 305.0342 345.6910
 [79,] 336.3818 12.054285 312.8516 360.5803
 [80,] 347.8704 13.963879 320.5457 375.7369
 [81,] 250.5128 13.260268 225.0949 277.6812
 [82,] 250.2693 11.313955 228.6465 273.2053
 [83,] 250.0259  9.653222 231.2783 270.0692
 [84,] 249.7824  8.448199 233.3069 267.0570
 [85,] 249.5389  7.909976 233.8364 265.4168
 [86,] 249.2954  8.171390 233.2666 265.7098
 [87,] 249.0520  9.164267 231.0429 267.3626
 [88,] 248.8085 10.686637 228.1467 270.0080
 [89,] 248.5650 12.547227 224.0129 272.9478
 [90,] 248.3215 14.617451 220.0578 276.4549
 [91,] 285.9396 13.086520 260.7067 313.3776
 [92,] 305.1125 11.191841 283.6924 328.1200
 [93,] 324.2854  9.569776 305.8172 343.6794
 [94,] 343.4583  8.380150 327.2808 359.8993
 [95,] 362.6312  7.822803 347.3691 377.9155
 [96,] 381.8041  8.030478 365.7599 397.1984
 [97,] 400.9770  8.950079 383.0707 418.1694
 [98,] 420.1499 10.394338 399.5431 440.2215
 [99,] 439.3228 12.177997 415.4101 463.1430
[100,] 458.4957 14.173496 430.6890 485.8858
[101,] 226.7080 12.882965 200.8213 251.6278
[102,] 238.2565 11.069572 216.1726 259.7550
[103,] 249.8049  9.530255 230.8486 268.4432
[104,] 261.3533  8.416755 244.6575 277.7638
[105,] 272.9018  7.910973 257.8064 288.4243
[106,] 284.4502  8.127171 268.9231 300.4436
[107,] 295.9986  9.013547 278.6597 313.7808
[108,] 307.5471 10.400136 288.0060 327.8479
[109,] 319.0955 12.116408 295.9086 342.5457
[110,] 330.6439 14.041993 303.9583 358.5387
[111,] 238.7222 13.260773 212.1569 263.0729
[112,] 255.7825 11.333148 232.7160 276.5697
[113,] 272.8427  9.698806 253.1765 291.3012
[114,] 289.9030  8.528064 272.9752 306.2685
[115,] 306.9633  8.026417 291.3826 322.4194
[116,] 324.0235  8.315847 307.9675 340.5009
[117,] 341.0838  9.322968 323.1044 359.4377
[118,] 358.1441 10.849727 337.0716 379.7087
[119,] 375.2043 12.710228 350.7457 400.4042
[120,] 392.2646 14.778960 363.4837 421.5793
[121,] 255.6215 12.319277 231.3609 279.3545
[122,] 263.1584 10.584598 242.4579 283.3854
[123,] 270.6953  9.128722 252.6440 288.2857
[124,] 278.2322  8.103338 262.1749 293.8917
[125,] 285.7691  7.682794 270.3535 300.6287
[126,] 293.3060  7.963496 277.5911 308.5024
[127,] 300.8429  8.879183 283.1700 318.0198
[128,] 308.3798 10.261249 288.3553 328.2757
[129,] 315.9167 11.948944 292.6151 339.1740
[130,] 323.4536 13.830835 296.6143 350.0863
[131,] 272.0134 12.642531 247.2675 297.1751
[132,] 286.0843 10.810283 265.3791 307.2540
[133,] 300.1552  9.251487 282.5624 318.3937
[134,] 314.2261  8.125085 298.5518 330.2727
[135,] 328.2970  7.625168 313.2886 343.1895
[136,] 342.3680  7.872010 326.7138 357.9998
[137,] 356.4389  8.803016 339.3846 373.8207
[138,] 370.5098 10.233123 350.8024 390.6421
[139,] 384.5807 11.984979 361.2331 408.4817
[140,] 398.6516 13.937784 371.6080 426.4838
[141,] 254.6686 12.261946 230.9171 279.4842
[142,] 266.0463 10.553517 245.5320 287.3852
[143,] 277.4241  9.126498 259.5881 295.5692
[144,] 288.8018  8.130442 272.8015 304.8277
[145,] 300.1795  7.733697 284.8001 315.3365
[146,] 311.5573  8.025640 295.7794 327.0657
[147,] 322.9350  8.939049 305.6006 340.3516
[148,] 334.3127 10.310051 314.5194 354.5387
[149,] 345.6904 11.982595 323.1072 369.5337
[150,] 357.0682 13.847847 331.0400 384.4877
[151,] 226.2134 13.968483 198.4105 253.1164
[152,] 241.4504 11.941853 217.5998 264.4086
[153,] 256.6873 10.186319 236.8440 276.6967
[154,] 271.9243  8.864435 255.0470 289.2320
[155,] 287.1612  8.188969 271.3510 303.5536
[156,] 302.3982  8.318900 286.0590 318.8673
[157,] 317.6352  9.220241 299.1972 336.1558
[158,] 332.8721 10.699789 311.7633 354.3994
[159,] 348.1091 12.554761 323.2627 373.1655
[160,] 363.3461 14.643170 334.1547 392.1987
[161,] 252.2532 12.298142 228.4989 276.8266
[162,] 261.7319 10.597559 241.2252 282.5884
[163,] 271.2106  9.197433 253.4614 289.2783
[164,] 280.6893  8.252142 264.9329 296.8887
[165,] 290.1681  7.926127 275.1068 305.5469
[166,] 299.6468  8.292749 283.5649 315.8545
[167,] 309.1255  9.270192 291.4125 327.6151
[168,] 318.6042 10.692230 298.1504 340.0138
[169,] 328.0829 12.406920 304.3794 352.7502
[170,] 337.5616 14.309441 309.5857 365.3397
[171,] 263.5835 12.189838 240.6423 288.0577
[172,] 275.3443 10.485662 255.4380 296.5013
[173,] 287.1050  9.062054 269.6621 305.1243
[174,] 298.8658  8.068908 283.0281 315.1029
[175,] 310.6265  7.675187 295.3436 325.5761
[176,] 322.3873  7.970224 306.5620 337.8904
[177,] 334.1480  8.885674 316.3203 351.4009
[178,] 345.9088 10.256739 325.5283 365.7552
[179,] 357.6696 11.927318 334.2207 380.7605
[180,] 369.4303 13.788978 341.9999 396.2876</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.1934923 13.203327  -30.0725119  21.6418816
  [2,]  -14.7286202 11.301649  -36.8141353   6.9758941
  [3,]  -42.3125481  9.670445  -61.1980326 -23.7656456
  [4,]    8.6468239  8.467501   -7.6672527  25.0584135
  [5,]   24.3790960  7.891162    8.8749614  39.3663258
  [6,]   62.5374681  8.076702   46.6927585  78.2049845
  [7,]   10.3713402  8.977005   -7.0556830  27.7244122
  [8,] -101.3636877 10.408214 -121.5680976 -81.0861991
  [9,]   19.3931844 12.184664   -4.1225117  43.2177174
 [10,]   35.4815565 14.177164    8.1869606  63.5841011
 [11,]   11.0926353 13.538799  -15.8566810  37.6742643
 [12,]   -8.1064772 11.623204  -31.1496662  14.8090123
 [13,]  -12.1254897  9.968816  -31.7564690   7.1379458
 [14,]  -12.1273021  8.725500  -29.5305994   4.7359818
 [15,]  -10.8492146  8.085174  -26.7812074   4.7660325
 [16,]   -4.3345270  8.190504  -20.7579785  11.2735996
 [17,]   -8.3970395  9.015393  -26.1250402   9.3606836
 [18,]   -6.0311519 10.389845  -26.6327117  14.3485373
 [19,]   -1.1936644 12.128442  -25.5741531  22.5009993
 [20,]   10.0938232 14.097090  -18.0841194  37.6790287
 [21,]  -13.9677766 13.173188  -39.5049780  11.2520358
 [22,]  -23.5982118 11.342586  -45.9308535  -2.1452590
 [23,]   11.4808530  9.774829   -7.6671725  30.1202827
 [24,]    5.0937178  8.614635  -11.7553389  21.8753512
 [25,]   -3.3492175  8.040412  -19.1965746  12.8893843
 [26,]  -17.1074527  8.176561  -33.3964186  -1.0969449
 [27,]   -7.0532879  8.990868  -25.1349702  10.2699278
 [28,]    8.3682769 10.324093  -12.2379440  28.4020711
 [29,]    8.7209416 12.004571  -14.9913260  32.2930385
 [30,]   -9.6849936 13.906984  -37.1268747  17.8709353
 [31,]   46.8620165 13.225233   21.1866394  71.8656214
 [32,]   19.9853588 11.298244   -1.6241768  41.5719721
 [33,]   -2.2925989  9.651587  -20.8446694  16.2029941
 [34,]   -6.7503566  8.450755  -23.0409229   9.6043146
 [35,]  -11.8203143  7.901688  -27.0645874   3.6208711
 [36,]   -5.7663720  8.137407  -21.6631592   9.6957791
 [37,]  -28.8465298  9.097110  -46.8576283 -11.2996872
 [38,]    3.4409125 10.585684  -17.6318747  23.6789588
 [39,]  -15.2051452 12.414319  -39.5306848   8.1930930
 [40,]   27.7597971 14.454523   -0.1393218  55.1577473
 [41,]   14.3584244 13.069322  -11.1957253  39.2186204
 [42,]    4.3043144 11.189896  -17.6371962  25.7586660
 [43,]   13.6787044  9.585622   -5.1193836  32.3577115
 [44,]   24.5271943  8.415363    8.2016339  41.0418301
 [45,]   13.2429843  7.875043   -2.0283259  28.7902121
 [46,]  -17.1618258  8.091852  -32.8785334  -1.3450783
 [47,]  -27.8517358  9.011305  -45.2743743 -10.7181416
 [48,]    9.4447542 10.449544  -10.8507944  29.3069702
 [49,]  -39.0722559 12.224815  -62.9514221 -15.4804624
 [50,]   31.3157341 14.211370    3.2859714  58.2199700
 [51,]  -25.5489764 12.275435  -49.6239888  -1.6648855
 [52,]  -27.8006494 10.554166  -48.4844076  -7.0172747
 [53,]   -7.8540225  9.107455  -25.6497937  10.3934629
 [54,]   18.7506045  8.084073    3.2691419  35.0773595
 [55,]   16.2418315  7.655712    1.1959240  31.2705812
 [56,]   -1.4263416  7.919520  -17.0393004  14.1888724
 [57,]  132.5350854  8.813562  114.9713179 149.6483585
 [58,]   15.0014124 10.173009   -5.2640428  34.7753469
 [59,]  -11.7322606 11.838604  -35.0589466  11.5437671
 [60,]  -98.3710337 13.699130 -124.7888902 -71.6127969
 [61,]   16.2859791 12.927753   -9.2738328  41.0640895
 [62,]   11.6529918 11.129841  -10.3918400  33.1261984
 [63,]  -11.4782956  9.626827  -30.5863982   7.2689205
 [64,]    1.2165170  8.575202  -15.6084907  17.6776923
 [65,]  -11.7677704  8.151577  -28.1020198   4.2425018
 [66,]   18.8821422  8.450929    2.1363391  35.5393692
 [67,]    2.3965548  9.404469  -16.0981276  20.7861677
 [68,]    8.8643675 10.840928  -12.5858305  30.1676580
 [69,]  -16.9611199 12.596160  -42.4368661   7.9229454
 [70,]    1.3760927 14.555296  -27.6994077  30.5839599
 [71,]   21.0003102 12.327791   -2.7014143  45.3488159
 [72,]   20.2397864 10.575883   -0.4923236  41.5569831
 [73,]  -24.0853375  9.107708  -42.0355011  -6.0771061
 [74,]  -24.2663613  8.079451  -40.1158766  -8.5054012
 [75,]  -11.4028852  7.670128  -26.3679179   3.5803375
 [76,]  -17.7247091  7.975611  -33.5626674  -2.0694984
 [77,]   -7.8797329  8.922781  -25.6168493   9.2268911
 [78,]    6.6297432 10.336722  -14.1681433  26.4887143
 [79,]   -0.6348807 12.054285  -24.8334276  22.8952810
 [80,]   29.4285955 13.963879    1.5620760  56.7532872
 [81,]   -8.9045285 13.260268  -36.0728976  16.5134428
 [82,]   23.6778503 11.313955    0.7418893  45.3007199
 [83,]    4.4648291  9.653222  -15.5785253  23.2123535
 [84,]   21.0197080  8.448199    3.7451146  37.4951977
 [85,]    1.9129868  7.909976  -13.9648864  17.6154793
 [86,]    5.3407657  8.171390  -11.0735849  21.3695569
 [87,]   -3.5996555  9.164267  -21.9102907  14.4093974
 [88,]  -13.4974767 10.686637  -34.6970242   7.1643425
 [89,]  -12.8108978 12.547227  -37.1937110  11.7412213
 [90,]  -11.0749190 14.617451  -39.2083384  17.1888435
 [91,]   26.4270270 13.086520   -1.0109960  51.6599249
 [92,]    8.6933190 11.191841  -14.3141714  30.1133781
 [93,]  -32.6741889  9.569776  -52.0682240 -14.2060049
 [94,]    2.6639031  8.380150  -13.7770630  18.8413627
 [95,]    3.1011951  7.822803  -12.1831448  18.3632814
 [96,]   10.0343872  8.030478   -5.3598893  26.0785579
 [97,]    3.2830792  8.950079  -13.9092500  21.1893728
 [98,]   -3.4576287 10.394338  -23.5292285  17.1491786
 [99,]   16.5414633 12.177997   -7.2787073  40.4541523
[100,]    0.4209553 14.173496  -26.9690873  28.2277323
[101,]    9.3951745 12.882965  -15.5246130  35.2818974
[102,]   -7.9397586 11.069572  -29.4383020  14.1441416
[103,]  -10.8792916  9.530255  -29.5175669   8.0769708
[104,]   -6.4313247  8.416755  -22.8417620  10.2645055
[105,]  -22.1914578  7.910973  -37.7140032  -7.0960920
[106,]  -14.6757909  8.127171  -30.6691905   0.8512927
[107,]  -14.4338240  9.013547  -32.2160386   2.9051424
[108,]    0.5549429 10.400136  -19.7458635  20.0960134
[109,]   17.1851098 12.116408   -6.2651408  40.3719623
[110,]   21.0011767 14.041993   -6.8935806  47.6868002
[111,]   17.5745783 13.260773   -6.7760623  44.1398880
[112,]  -12.3281848 11.333148  -33.1154340  10.7383497
[113,]  -16.6381479  9.698806  -35.0965733   3.0281435
[114,]  -34.3759110  8.528064  -50.7414485 -17.4481408
[115,]  -38.0467740  8.026417  -53.5028759 -22.4660899
[116,]    5.7011629  8.315847  -10.7761942  21.7571849
[117,]   38.3606998  9.322968   20.0068034  56.3401171
[118,]    4.7743367 10.849727  -16.7902902  25.8467713
[119,]   19.2828737 12.710228   -5.9170211  43.7415125
[120,]   -3.2118894 14.778960  -32.5266378  25.5690354
[121,]   -5.0949693 12.319277  -28.8280264  19.1655500
[122,]   36.8992248 10.584598   16.6722091  57.5997067
[123,]   -0.8013810  9.128722  -18.3918139  17.2498734
[124,]    2.3569131  8.103338  -13.3025815  18.4142155
[125,]  -13.9416927  7.682794  -28.8013305   1.4738664
[126,]   11.3276014  7.963496   -3.8688162  27.0425110
[127,]  -13.0963044  8.879183  -30.2731509   4.5765943
[128,]  -41.7843103 10.261249  -61.6802107 -21.7598297
[129,]    5.6250839 11.948944  -17.6322167  28.9266928
[130,]   24.1118780 13.830835   -2.5208225  50.9511574
[131,]  -50.3362850 12.642531  -75.4979700 -25.5904301
[132,]   12.1096007 10.810283   -9.0601182  32.8148092
[133,]   26.7232864  9.251487    8.4848154  44.3161221
[134,]   32.6293722  8.125085   16.5828425  48.3036623
[135,]   20.4431579  7.625168    5.5506551  35.4516484
[136,]   10.4607436  7.872010   -5.1710883  26.1148712
[137,]   -2.0122706  8.803016  -19.3941162  15.0420238
[138,]  -10.0771849 10.233123  -30.2094844   9.6302488
[139,]   -8.9400991 11.984979  -32.8410846  14.4074936
[140,]  -10.1099134 13.937784  -37.9420901  16.9337349
[141,]   17.2548826 12.261946   -7.5606501  41.0063911
[142,]    2.3905556 10.553517  -18.9483128  22.9048738
[143,]  -20.1816715  9.126498  -38.3268435  -2.3457294
[144,]  -11.1451986  8.130442  -27.1710922   4.8551118
[145,]   14.6426743  7.733697   -0.5142996  30.0221194
[146,]    5.6562473  8.025640   -9.8522361  21.4340768
[147,]  -24.7996798  8.939049  -42.2163129  -7.4653023
[148,]   13.8101931 10.310051   -6.4157882  33.6034821
[149,]   -5.4104340 11.982595  -29.2536921  17.1728249
[150,]    9.4449390 13.847847  -17.9745957  35.4730589
[151,]   -0.9493877 13.968483  -27.8524042  26.8534788
[152,]   -6.9268525 11.941853  -29.8851452  16.9236988
[153,]  -17.7865174 10.186319  -37.7959324   2.0568279
[154,]  -31.4512823  8.864435  -48.7589949 -14.5739650
[155,]  -19.6239471  8.188969  -36.0163404  -3.8136616
[156,]   41.7954880  8.318900   25.3263600  58.1347306
[157,]  -36.4870769  9.220241  -55.0076550 -18.0491451
[158,]   14.7133583 10.699789   -6.8139315  35.8222116
[159,]   17.0538934 12.554761   -8.0025399  41.9003357
[160,]    8.8827285 14.643170  -19.9699297  38.0740867
[161,]   17.6271848 12.298142   -6.9461759  41.3814537
[162,]   10.7108753 10.597559  -10.1456367  31.2176325
[163,]    6.6882657  9.197433  -11.3794423  24.4374582
[164,]    1.1001561  8.252142  -15.0991890  16.8566242
[165,]  -10.9975535  7.926127  -26.3763532   4.0637278
[166,]  -15.1347631  8.292749  -31.3424805   0.9471403
[167,]  -49.8596727  9.270192  -68.3493299 -32.1467371
[168,]  -13.9735822 10.692230  -35.3831697   6.4802094
[169,]   22.6978082 12.406920   -1.9695333  46.4013183
[170,]   31.9075986 14.309441    4.1295156  59.8834879
[171,]    5.8282064 12.189838  -18.6460454  28.7693598
[172,]   -1.8702524 10.485662  -23.0273125  18.0359611
[173,]   10.4917888  9.062054   -7.5275314  27.9347058
[174,]   11.7658300  8.068908   -4.4713253  27.6034876
[175,]  -23.4539288  7.675187  -38.4034865  -8.1709800
[176,]    7.2203124  7.970224   -8.2828498  23.0455717
[177,]    0.3337536  8.885674  -16.9190648  18.1614952
[178,]   -2.6889052 10.256739  -22.5353189  17.6916445
[179,]   11.4721359 11.927318  -11.6188445  34.9209620
[180,]   -5.3067229 13.788978  -32.1640358  22.1236887</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.5  3.4
looic      1770.0 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1373      
 (0.5, 0.7]   (ok)         2    1.1%   184       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.4
p_loo        33.7  8.3
looic      1721.5 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   913       
 (0.5, 0.7]   (ok)         5    2.8%   1209      
   (0.7, 1]   (bad)        3    1.7%   35        
   (1, Inf)   (very bad)   1    0.6%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.7  
fit_sleep1 -92.7      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.5  3.4
looic      1770.0 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1373      
 (0.5, 0.7]   (ok)         2    1.1%   184       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.4
p_loo        33.7  8.3
looic      1721.5 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   913       
 (0.5, 0.7]   (ok)         5    2.8%   1209      
   (0.7, 1]   (bad)        3    1.7%   35        
   (1, Inf)   (very bad)   1    0.6%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.7     22.4        33.7    8.3   1721.5
fit_sleep2  -24.3      11.7  -885.0     14.3        19.5    3.4   1770.0
fit_sleep1  -92.7      21.0  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   44.8  
fit_sleep2   28.7  
fit_sleep1   21.1  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
5.688539e-41 2.922116e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.86      1.52     0.37     5.31       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.14      1.52    -3.09     2.73        5.3      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.5.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.19      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.6.0   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.19        V8_4.2.2            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.7         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
