<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.81      6.99    15.30    43.24 1.00     1709     1762
sd(Days)                6.60      1.60     4.08    10.46 1.00     1163     1533
cor(Intercept,Days)     0.08      0.31    -0.49     0.69 1.00      866     1459

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.19      7.40   236.87   266.18 1.00     1911     2462
Days         10.41      1.80     6.79    13.94 1.00     1619     2021

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.95      1.57    23.17    29.28 1.00     2660     2325

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6791  13.42396 226.6349 278.9762
309 211.5560  13.37258 184.5725 237.6471
310 213.2773  13.36779 187.8182 239.4473
330 274.5893  13.49219 248.7192 301.5269
331 273.2329  12.86849 248.9584 299.3610
332 260.2731  12.10572 236.4758 284.3845
333 267.9379  12.80345 243.8420 293.7256
334 244.0480  12.36870 219.9003 268.3132
335 250.3094  13.81681 223.6850 278.3927
337 285.9196  13.45612 260.2297 312.5405
349 226.6314  12.94463 200.4400 251.2042
350 238.9893  12.97799 212.3523 263.9344
351 255.7746  12.27124 231.8857 280.1263
352 272.0028  12.67591 247.8574 298.2604
369 254.8196  12.45888 229.2899 279.3872
370 226.4045  13.52050 198.7431 252.1379
371 252.2939  12.23864 227.1335 276.7617
372 263.6357  12.70237 239.2142 288.8252

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6313260  2.546078 14.7369531 24.639224
309  1.7276368  2.547920 -3.2464205  6.839905
310  4.8776391  2.508197 -0.0150622  9.797497
330  5.7275843  2.535095  0.6115973 10.533559
331  7.5053349  2.424981  2.6991271 12.164111
332 10.2051295  2.312794  5.6054098 14.674098
333 10.3405394  2.404103  5.4979885 14.910053
334 11.5275142  2.350864  6.9147932 16.195860
335 -0.1688021  2.624986 -5.4344163  5.062661
337 19.1529816  2.494957 14.2522305 23.931914
349 11.5485487  2.454465  6.8769010 16.441315
350 16.9804883  2.453890 12.1786004 21.812984
351  7.4568414  2.374981  2.7587268 11.985205
352 14.0594628  2.395883  9.2123759 18.652324
369 11.3489244  2.369777  6.7247956 16.054119
370 15.1703644  2.562987 10.2914923 20.413864
371  9.4730919  2.345370  4.7942126 14.109736
372 11.7732073  2.447857  6.8583594 16.451833</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6791 13.423958 226.6349 278.9762
  [2,] 273.3105 11.472489 250.1471 295.2695
  [3,] 292.9418  9.797877 273.2164 311.9549
  [4,] 312.5731  8.564099 295.5696 329.1771
  [5,] 332.2044  7.978360 316.6165 347.7448
  [6,] 351.8358  8.181057 335.5346 367.9768
  [7,] 371.4671  9.119769 353.2405 389.1598
  [8,] 391.0984 10.600741 369.6672 411.5977
  [9,] 410.7298 12.431664 385.9323 434.7286
 [10,] 430.3611 14.480395 401.8209 458.6038
 [11,] 211.5560 13.372583 184.5725 237.6471
 [12,] 213.2836 11.422160 190.4880 235.0887
 [13,] 215.0113  9.751374 195.4656 233.8697
 [14,] 216.7389  8.526232 199.7462 233.4536
 [15,] 218.4665  7.955360 202.6722 233.8249
 [16,] 220.1942  8.176961 204.4075 236.2571
 [17,] 221.9218  9.133532 204.5018 239.9947
 [18,] 223.6494 10.628448 203.4492 244.8555
 [19,] 225.3771 12.469571 201.5689 250.0437
 [20,] 227.1047 14.525849 199.0756 255.4619
 [21,] 213.2773 13.367792 187.8182 239.4473
 [22,] 218.1549 11.448618 196.1291 240.5988
 [23,] 223.0325  9.799283 203.9211 242.6659
 [24,] 227.9102  8.576897 211.3587 245.2275
 [25,] 232.7878  7.980130 217.3284 248.7868
 [26,] 237.6654  8.147632 221.9427 253.9354
 [27,] 242.5431  9.037004 224.7510 260.6362
 [28,] 247.4207 10.465806 226.8284 268.0101
 [29,] 252.2984 12.246667 228.0410 276.1390
 [30,] 257.1760 14.248183 229.0902 284.6835
 [31,] 274.5893 13.492191 248.7192 301.5269
 [32,] 280.3169 11.543178 257.9643 303.3085
 [33,] 286.0445  9.864285 267.0467 305.2629
 [34,] 291.7720  8.614912 275.0387 308.7975
 [35,] 297.4996  7.998918 281.9548 313.0415
 [36,] 303.2272  8.161011 287.2450 319.3669
 [37,] 308.9548  9.059521 291.3877 326.6793
 [38,] 314.6824 10.507196 294.1538 335.2185
 [39,] 320.4100 12.311816 296.2806 344.4032
 [40,] 326.1376 14.339242 297.7283 353.8733
 [41,] 273.2329 12.868489 248.9584 299.3610
 [42,] 280.7382 11.053649 259.8094 302.9001
 [43,] 288.2436  9.514692 269.9557 306.8670
 [44,] 295.7489  8.404561 279.1750 311.8694
 [45,] 303.2542  7.906009 287.6704 318.2749
 [46,] 310.7596  8.132305 295.1651 326.3651
 [47,] 318.2649  9.029110 300.5788 335.8744
 [48,] 325.7702 10.424795 305.2365 345.7168
 [49,] 333.2756 12.148619 309.8506 356.7143
 [50,] 340.7809 14.080574 313.5635 368.0531
 [51,] 260.2731 12.105725 236.4758 284.3845
 [52,] 270.4782 10.456588 250.1777 291.0372
 [53,] 280.6833  9.101094 262.7587 298.3770
 [54,] 290.8885  8.186429 274.8325 306.6147
 [55,] 301.0936  7.867868 285.8200 316.6391
 [56,] 311.2987  8.215055 295.3536 327.3411
 [57,] 321.5038  9.152536 303.7850 339.4831
 [58,] 331.7090 10.523723 311.5170 352.4824
 [59,] 341.9141 12.183046 318.4693 366.1330
 [60,] 352.1192 14.028632 325.0388 379.6183
 [61,] 267.9379 12.803452 243.8420 293.7256
 [62,] 278.2784 11.034046 257.4524 300.3299
 [63,] 288.6189  9.546275 270.8298 307.5441
 [64,] 298.9595  8.489521 282.8296 315.5053
 [65,] 309.3000  8.035671 293.8570 325.0001
 [66,] 319.6405  8.284410 303.4866 335.7316
 [67,] 329.9811  9.178797 311.7720 347.6126
 [68,] 340.3216 10.555975 319.2615 360.6583
 [69,] 350.6622 12.254237 325.8927 374.3557
 [70,] 361.0027 14.158511 332.2045 388.8420
 [71,] 244.0480 12.368696 219.9003 268.3132
 [72,] 255.5755 10.670934 234.7520 276.4066
 [73,] 267.1030  9.263162 248.7078 285.4481
 [74,] 278.6305  8.294373 262.0406 294.8450
 [75,] 290.1580  7.927181 274.4293 305.5173
 [76,] 301.6855  8.242385 285.2841 317.6993
 [77,] 313.2131  9.169882 294.9220 331.0097
 [78,] 324.7406 10.549392 304.1230 345.1655
 [79,] 336.2681 12.228890 312.0194 360.1182
 [80,] 347.7956 14.101594 319.8623 375.3937
 [81,] 250.3094 13.816815 223.6850 278.3927
 [82,] 250.1406 11.769760 227.6995 273.8883
 [83,] 249.9718  9.996561 230.7939 269.8141
 [84,] 249.8030  8.666966 232.8833 266.6250
 [85,] 249.6342  8.005154 233.8279 264.9378
 [86,] 249.4654  8.174949 233.0841 265.4930
 [87,] 249.2966  9.130070 231.0738 267.0311
 [88,] 249.1278 10.661504 227.9668 270.1024
 [89,] 248.9590 12.560186 224.1332 273.7745
 [90,] 248.7902 14.684344 220.0465 277.8721
 [91,] 285.9196 13.456121 260.2297 312.5405
 [92,] 305.0726 11.574095 282.9544 328.0413
 [93,] 324.2256  9.965026 304.6124 343.9272
 [94,] 343.3786  8.780288 325.8931 360.4359
 [95,] 362.5316  8.205777 346.0506 378.3797
 [96,] 381.6845  8.368137 364.8475 398.2565
 [97,] 400.8375  9.228557 382.9136 418.7333
 [98,] 419.9905 10.618684 399.2601 440.7319
 [99,] 439.1435 12.361078 414.7494 463.1611
[100,] 458.2965 14.327793 430.5480 486.1594
[101,] 226.6314 12.944634 200.4400 251.2042
[102,] 238.1800 11.090018 215.9229 259.4124
[103,] 249.7285  9.511164 230.9497 268.1282
[104,] 261.2771  8.365691 244.6076 277.9494
[105,] 272.8256  7.845771 257.5610 288.4680
[106,] 284.3742  8.073182 268.6091 300.0802
[107,] 295.9227  8.991396 278.2388 312.9502
[108,] 307.4713 10.419354 286.8571 327.2340
[109,] 319.0198 12.179058 294.7807 342.6165
[110,] 330.5684 14.147254 302.6150 358.0502
[111,] 238.9893 12.977987 212.3523 263.9344
[112,] 255.9698 11.103793 233.4160 277.5956
[113,] 272.9503  9.497549 254.0170 290.9968
[114,] 289.9308  8.315997 273.4259 305.9452
[115,] 306.9113  7.755729 291.3095 322.0467
[116,] 323.8918  7.949214 307.9055 339.5249
[117,] 340.8723  8.847137 323.3566 358.1462
[118,] 357.8528 10.266294 337.4741 377.9436
[119,] 374.8332 12.023515 350.7711 398.0335
[120,] 391.8137 13.992005 364.0217 419.2200
[121,] 255.7746 12.271240 231.8857 280.1263
[122,] 263.2314 10.545865 242.3740 284.1033
[123,] 270.6883  9.117471 252.8468 288.7042
[124,] 278.1451  8.143854 262.4557 294.0602
[125,] 285.6019  7.797276 270.2943 300.8477
[126,] 293.0588  8.158047 276.8277 308.6753
[127,] 300.5156  9.142813 282.4841 317.9489
[128,] 307.9725 10.578723 287.2688 328.3543
[129,] 315.4293 12.308892 291.6980 339.3151
[130,] 322.8861 14.226360 295.0565 350.1394
[131,] 272.0028 12.675911 247.8574 298.2604
[132,] 286.0622 10.931928 265.0781 308.6082
[133,] 300.1217  9.477124 281.5327 319.2152
[134,] 314.1812  8.461987 297.4867 330.6851
[135,] 328.2406  8.054507 312.0456 343.7453
[136,] 342.3001  8.344186 326.0379 358.7124
[137,] 356.3595  9.265869 338.3851 374.9062
[138,] 370.4190 10.656815 349.4373 391.4151
[139,] 384.4785 12.359596 359.8893 408.7176
[140,] 398.5379 14.262960 370.0765 425.8813
[141,] 254.8196 12.458883 229.2899 279.3872
[142,] 266.1685 10.744291 244.4996 287.3060
[143,] 277.5174  9.321346 258.7011 295.9399
[144,] 288.8664  8.340676 272.5022 305.2586
[145,] 300.2153  7.967305 284.6449 315.6263
[146,] 311.5642  8.283762 295.4011 327.4049
[147,] 322.9131  9.219282 304.7558 340.4031
[148,] 334.2621 10.611377 313.4847 354.8892
[149,] 345.6110 12.306061 321.6049 369.6145
[150,] 356.9599 14.195375 329.3226 385.1892
[151,] 226.4045 13.520495 198.7431 252.1379
[152,] 241.5748 11.569639 218.5209 263.3151
[153,] 256.7452  9.901874 237.1666 275.5446
[154,] 271.9156  8.681906 255.0094 288.5656
[155,] 287.0859  8.114288 271.3053 302.9703
[156,] 302.2563  8.333406 286.2864 318.6460
[157,] 317.4267  9.283720 299.3061 335.6577
[158,] 332.5970 10.773442 311.1219 353.7767
[159,] 347.7674 12.612869 322.6462 372.2408
[160,] 362.9377 14.671050 333.8400 391.3371
[161,] 252.2939 12.238637 227.1335 276.7617
[162,] 261.7670 10.558753 240.6651 282.7075
[163,] 271.2401  9.175611 252.9661 289.5544
[164,] 280.7132  8.240019 264.4978 297.2239
[165,] 290.1862  7.912366 275.1254 305.6388
[166,] 299.6593  8.265268 283.6979 315.3147
[167,] 309.1324  9.220917 291.2467 326.8182
[168,] 318.6055 10.617791 298.2119 339.0643
[169,] 328.0786 12.306550 304.3600 352.0603
[170,] 337.5517 14.183314 310.1789 365.5394
[171,] 263.6357 12.702366 239.2142 288.8252
[172,] 275.4090 10.918436 254.0964 297.2909
[173,] 287.1822  9.437074 268.8528 306.2404
[174,] 298.9554  8.419532 282.9583 315.7873
[175,] 310.7286  8.043797 295.0939 326.3910
[176,] 322.5018  8.396476 306.1195 338.8954
[177,] 334.2750  9.395902 315.7115 352.6611
[178,] 346.0482 10.865042 324.7212 367.5264
[179,] 357.8214 12.641175 333.0508 382.6640
[180,] 369.5946 14.612785 340.7975 398.1053</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.1191457 13.423958  -29.41617395  22.9251371
  [2,]  -14.6057716 11.472489  -36.56478022   8.5575652
  [3,]  -42.1411976  9.797877  -61.15433900 -22.4157506
  [4,]    8.8666764  8.564099   -7.73727987  25.8702055
  [5,]   24.6474505  7.978360    9.10713825  40.2354270
  [6,]   62.8543245  8.181057   46.71330892  79.1555077
  [7,]   10.7366985  9.119769   -6.95604541  28.9633005
  [8,] -100.9498274 10.600741 -121.44905280 -79.5185986
  [9,]   19.8555466 12.431664   -4.14325473  44.6530425
 [10,]   35.9924206 14.480395    7.74966638  64.5325870
 [11,]   11.1779082 13.372583  -14.91316012  38.1614336
 [12,]   -8.0178286 11.422160  -29.82294840  14.7778190
 [13,]  -12.0334654  9.751374  -30.89188441   7.5121849
 [14,]  -12.0319022  8.526232  -28.74661568   4.9607558
 [15,]  -10.7504391  7.955360  -26.10876883   5.0439323
 [16,]   -4.2323759  8.176961  -20.29531969  11.5542874
 [17,]   -8.2915127  9.133532  -26.36438652   9.1285081
 [18,]   -5.9222495 10.628448  -27.12834410  14.2780199
 [19,]   -1.0813863 12.469571  -25.74800656  22.7268175
 [20,]   10.2094768 14.525849  -18.14769769  38.2386310
 [21,]  -14.2233512 13.367792  -40.39344728  11.2357134
 [22,]  -23.8226903 11.448618  -46.26655960  -1.7968547
 [23,]   11.2874705  9.799283   -8.34590810  30.3988685
 [24,]    4.9314314  8.576897  -12.38586518  21.4829482
 [25,]   -3.4804077  7.980130  -19.47941864  11.9789687
 [26,]  -17.2075468  8.147632  -33.47750664  -1.4847973
 [27,]   -7.1222859  9.037004  -25.21540886  10.6697503
 [28,]    8.3303750 10.465806  -12.25902615  28.9226784
 [29,]    8.7141359 12.246667  -15.12653102  32.9714777
 [30,]   -9.6607032 14.248183  -37.16822554  18.4251479
 [31,]   46.9533047 13.492191   20.01573475  72.8233762
 [32,]   20.0833203 11.543178   -2.90832865  42.4359350
 [33,]   -2.1879640  9.864285  -21.40639467  16.8097645
 [34,]   -6.6390483  8.614912  -23.66454488  10.0942631
 [35,]  -11.7023326  7.998918  -27.24421940   3.8424991
 [36,]   -5.6417169  8.161011  -21.78141290  10.3404840
 [37,]  -28.7152012  9.059521  -46.43969423 -11.1481470
 [38,]    3.5789145 10.507196  -16.95721316  24.1075267
 [39,]  -15.0604699 12.311816  -39.05371864   9.0688824
 [40,]   27.9111458 14.339242    0.17535661  56.3204371
 [41,]   14.3750043 12.868489  -11.75310127  38.6495410
 [42,]    4.2617694 11.053649  -17.90009152  25.1906268
 [43,]   13.5770346  9.514692   -5.04641928  31.8648718
 [44,]   24.3663997  8.404561    8.24588564  40.9402559
 [45,]   13.0230648  7.906009   -1.99762093  28.6068988
 [46,]  -17.4408701  8.132305  -33.04636251  -1.8464002
 [47,]  -28.1899050  9.029110  -45.79937666 -10.5037776
 [48,]    9.0474601 10.424795  -10.89914393  29.5812111
 [49,]  -39.5286747 12.148619  -62.96744777 -16.1036933
 [50,]   30.8001904 14.080574    3.52796425  58.0175541
 [51,]  -25.4124686 12.105725  -49.52394971  -1.6152152
 [52,]  -27.6663981 10.456588  -48.22539042  -7.3658997
 [53,]   -7.7220276  9.101094  -25.41572621  10.2026184
 [54,]   18.8803429  8.186429    3.15405191  34.9362796
 [55,]   16.3693134  7.867868    0.82383455  31.6428726
 [56,]   -1.3011161  8.215055  -17.34349459  14.6439884
 [57,]  132.6580544  9.152536  114.67882310 150.3769327
 [58,]   15.1221249 10.523723   -5.65132584  35.3141099
 [59,]  -11.6138046 12.183046  -35.83269928  11.8309885
 [60,]  -98.2548340 14.028632 -125.75394698 -71.1743863
 [61,]   15.9045472 12.803452   -9.88318049  40.0003990
 [62,]   11.2766079 11.034046  -10.77485981  32.1025842
 [63,]  -11.8496315  9.546275  -30.77475550   5.9394928
 [64,]    0.8502291  8.489521  -15.69555041  16.9800850
 [65,]  -12.1290102  8.035671  -27.82910818   3.3139985
 [66,]   18.5259504  8.284410    2.43492489  34.6799302
 [67,]    2.0454111  9.178797  -15.58614936  20.2544562
 [68,]    8.5182717 10.555975  -11.81844608  29.5784329
 [69,]  -17.3021676 12.254237  -40.99566088   7.4673429
 [70,]    1.0400930 14.158511  -26.79918690  29.8382840
 [71,]   21.4251330 12.368696   -2.84008037  45.5728373
 [72,]   20.6257188 10.670934   -0.20542192  41.4492437
 [73,]  -23.7382954  9.263162  -42.08338987  -5.3431374
 [74,]  -23.9582096  8.294373  -40.17273553  -7.3682623
 [75,]  -11.1336238  7.927181  -26.49285184   4.5951356
 [76,]  -17.4943380  8.242385  -33.50813740  -1.0928523
 [77,]   -7.6882522  9.169882  -25.48487539  10.6028132
 [78,]    6.7823336 10.549392  -13.64259398  27.3998702
 [79,]   -0.5211806 12.228890  -24.37127097  23.7275315
 [80,]   29.5034051 14.101594    1.90527746  57.4367098
 [81,]   -8.7011032 13.816815  -36.78443242  17.9233232
 [82,]   23.8065989 11.769760    0.05890384  46.2477072
 [83,]    4.5189010  9.996561  -15.32338831  23.6968150
 [84,]   20.9991032  8.666966    4.17713442  37.9187933
 [85,]    1.8177053  8.005154  -13.48590067  17.6240367
 [86,]    5.1708074  8.174949  -10.85681019  21.5520628
 [87,]   -3.8442904  9.130070  -21.57875180  14.3785129
 [88,]  -13.8167883 10.661504  -34.79144982   7.3441814
 [89,]  -13.2048862 12.560186  -38.02039315  11.6209239
 [90,]  -11.5435841 14.684344  -40.62546721  17.2001090
 [91,]   26.4469583 13.456121   -0.17386051  52.1368922
 [92,]    8.7331766 11.574095  -14.23553651  30.8513505
 [93,]  -32.6144050  9.965026  -52.31595093 -13.0011633
 [94,]    2.7436134  8.780288  -14.31367013  20.2290562
 [95,]    3.2008317  8.205777  -12.64733534  19.6818117
 [96,]   10.1539501  8.368137   -6.41800808  26.9910228
 [97,]    3.4225685  9.228557  -14.47319945  21.3465377
 [98,]   -3.2982132 10.618684  -24.03960020  17.4322169
 [99,]   16.7208052 12.361078   -7.29679811  41.1148794
[100,]    0.6202236 14.327793  -27.24272401  28.3687217
[101,]    9.4717745 12.944634  -15.10097524  35.6631977
[102,]   -7.8632742 11.090018  -29.09572518  14.3938213
[103,]  -10.8029228  9.511164  -29.20264148   7.9758911
[104,]   -6.3550715  8.365691  -23.02735459  10.3143561
[105,]  -22.1153202  7.845771  -37.75768288  -6.8507198
[106,]  -14.5997688  8.073182  -30.30579591   1.1653450
[107,]  -14.3579175  8.991396  -31.38540398   3.3260437
[108,]    0.6307338 10.419354  -19.13200003  21.2448990
[109,]   17.2607852 12.179058   -6.33591869  41.4999013
[110,]   21.0767365 14.147254   -6.40510721  49.0300992
[111,]   17.3074621 12.977987   -7.63757577  43.9445038
[112,]  -12.5155262 11.103793  -34.14131863  10.0383089
[113,]  -16.7457146  9.497549  -34.79221812   2.1876164
[114,]  -34.4037029  8.315997  -50.41813356 -17.8988073
[115,]  -37.9947912  7.755729  -53.13016944 -22.3929751
[116,]    5.8329205  7.949214   -9.80017512  21.8192379
[117,]   38.5722322  8.847137   21.29825821  56.0878798
[118,]    5.0656439 10.266294  -15.02524087  25.4442669
[119,]   19.6539556 12.023515   -3.54625312  43.7160548
[120,]   -2.7610327 13.992005  -30.16728104  25.0310091
[121,]   -5.2480696 12.271240  -29.59979252  18.6408156
[122,]   36.8261890 10.545865   15.95427821  57.6836173
[123,]   -0.7943524  9.117471  -18.81026762  17.0471421
[124,]    2.4440062  8.143854  -13.47105902  18.1334133
[125,]  -13.7745352  7.797276  -29.02027707   1.5330888
[126,]   11.5748234  8.158047   -4.04174026  27.8058631
[127,]  -12.7690180  9.142813  -30.20232115   5.2625443
[128,]  -41.3769594 10.578723  -61.75879409 -20.6733239
[129,]    6.1124992 12.308892  -17.77325755  29.8437542
[130,]   24.6793578 14.226360   -2.57389163  52.5089990
[131,]  -50.3256660 12.675911  -76.58331251 -26.1803032
[132,]   12.1316711 10.931928  -10.41431732  33.1157820
[133,]   26.7568083  9.477124    7.66329555  45.3458006
[134,]   32.6743455  8.461987   16.17040813  49.3687886
[135,]   20.4995827  8.054507    4.99485122  36.6946295
[136,]   10.5286199  8.344186   -5.88373848  26.7908126
[137,]   -1.9329429  9.265869  -20.47962276  16.0414598
[138,]   -9.9864057 10.656815  -30.98250616  10.9953169
[139,]   -8.8378685 12.359596  -33.07701921  15.7512741
[140,]   -9.9962313 14.262960  -37.33956320  18.4651914
[141,]   17.1039031 12.458883   -7.46367959  42.6336232
[142,]    2.2683787 10.744291  -18.86911728  23.9373128
[143,]  -20.2750457  9.321346  -38.69749977  -1.4587181
[144,]  -11.2097701  8.340676  -27.60203537   5.1544453
[145,]   14.6069056  7.967305   -0.80405965  30.1773045
[146,]    5.6492812  8.283762  -10.19143276  21.8123535
[147,]  -24.7778432  9.219282  -42.26782983  -6.6205457
[148,]   13.8608324 10.611377   -6.76629018  34.6381999
[149,]   -5.3309920 12.306061  -29.33445700  18.6750843
[150,]    9.5531836 14.195375  -18.67609027  37.1904912
[151,]   -1.1404639 13.520495  -26.87385220  26.5209375
[152,]   -7.0513283 11.569639  -28.79164340  16.0025614
[153,]  -17.8443927  9.901874  -36.64383899   1.7341650
[154,]  -31.4425570  8.681906  -48.09258204 -14.5364499
[155,]  -19.5486214  8.114288  -35.43297985  -3.7679743
[156,]   41.9374142  8.333406   25.54766407  57.9072546
[157,]  -36.2785501  9.283720  -54.50957844 -18.1580128
[158,]   14.9884855 10.773442   -6.19122289  36.4635616
[159,]   17.3956211 12.612869   -7.07776750  42.5167839
[160,]    9.2910567 14.671050  -19.10825127  38.3887865
[161,]   17.5865216 12.238637   -6.88130115  42.7468791
[162,]   10.6758298 10.558753  -10.26474868  31.7776638
[163,]    6.6588379  9.175611  -11.65550637  24.9328247
[164,]    1.0763460  8.240019  -15.43440529  17.2916989
[165,]  -11.0157458  7.912366  -26.46830206   4.0450624
[166,]  -15.1473377  8.265268  -30.80268684   0.8141292
[167,]  -49.8666296  9.220917  -67.55236268 -31.9808506
[168,]  -13.9749214 10.617791  -34.43368067   6.4187257
[169,]   22.7020867 12.306550   -1.27964507  46.4207191
[170,]   31.9174949 14.183314    3.92984034  59.2902590
[171,]    5.7759565 12.702366  -19.41348656  30.1974798
[172,]   -1.9349508 10.918436  -23.81692868  19.3776140
[173,]   10.4146418  9.437074   -8.64355880  28.7439913
[174,]   11.6762345  8.419532   -5.15566413  27.6733189
[175,]  -23.5559729  8.043797  -39.21838457  -7.9212533
[176,]    7.1058198  8.396476   -9.28778542  23.4880849
[177,]    0.2068125  9.395902  -18.17932330  18.7703222
[178,]   -2.8282949 10.865042  -24.30646216  18.4986912
[179,]   11.3202978 12.641175  -13.52227894  36.0908545
[180,]   -5.4710096 14.612785  -33.98170240  23.3260636</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.4 14.6
p_loo        19.9  3.6
looic      1770.7 29.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   487       
 (0.5, 0.7]   (ok)         1    0.6%   1190      
   (0.7, 1]   (bad)        1    0.6%   33        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.1
p_loo        33.8  8.2
looic      1722.1 44.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   781       
 (0.5, 0.7]   (ok)         7    3.9%   546       
   (0.7, 1]   (bad)        3    1.7%   25        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.3  
fit_sleep1 -92.3      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.4 14.6
p_loo        19.9  3.6
looic      1770.7 29.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   487       
 (0.5, 0.7]   (ok)         1    0.6%   1190      
   (0.7, 1]   (bad)        1    0.6%   33        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.1
p_loo        33.8  8.2
looic      1722.1 44.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   781       
 (0.5, 0.7]   (ok)         7    3.9%   546       
   (0.7, 1]   (bad)        3    1.7%   25        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.0     22.1        33.8    8.2   1722.1
fit_sleep2  -24.3      11.3  -885.4     14.6        19.9    3.6   1770.7
fit_sleep1  -92.3      20.8  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.2  
fit_sleep2   29.1  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.128599e-41 2.733600e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.84      1.56     0.26     5.42       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.16      1.56    -3.27     2.92       5.57      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.16      
[4] StanHeaders_2.26.16 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.13.0          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.4.0      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.1        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.1         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.7  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.9        
 [91] gtable_0.3.1         cachem_1.0.7         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
