<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.81      6.83    15.47    42.07 1.00     1533     2272
sd(Days)                6.55      1.54     4.09    10.24 1.00     1369     1740
cor(Intercept,Days)     0.09      0.30    -0.47     0.67 1.00      700     1415

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.31      7.65   235.67   266.03 1.00     1534     1706
Days         10.42      1.78     6.77    13.99 1.00     1341     1589

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.93      1.58    23.05    29.27 1.00     3505     2971

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0614  13.08331 228.1609 279.5959
309 211.4661  13.30552 184.9353 236.5642
310 212.7689  13.25669 186.9399 238.3329
330 274.2391  13.70783 247.2812 301.1702
331 273.2660  12.93299 248.4510 299.2996
332 260.0422  11.98708 236.2593 283.2389
333 267.9253  12.59341 243.9379 292.6331
334 244.4892  12.50612 220.3854 269.4726
335 250.6136  13.09530 226.2644 276.9224
337 285.9234  12.74939 260.5539 311.5463
349 226.7695  13.15473 200.4877 251.5765
350 239.0114  13.58919 211.2577 263.9233
351 255.9858  12.64924 231.2373 281.5578
352 272.2238  12.84436 246.5407 297.5402
369 254.8204  12.26453 231.0986 279.5402
370 226.6842  13.70822 198.7819 252.6740
371 252.0834  12.44029 227.4842 277.6020
372 263.5454  12.35910 239.1389 288.0391

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6250161  2.524078 14.8745629 24.716710
309  1.8332351  2.463565 -2.8549802  6.716150
310  4.9494108  2.471758  0.2414408  9.746714
330  5.7940456  2.533042  0.5690092 10.654343
331  7.4812302  2.432308  2.6957156 12.208681
332 10.2540176  2.295981  5.7627443 14.759402
333 10.3161253  2.352034  5.6590100 14.816015
334 11.4534314  2.405033  6.7589006 16.143318
335 -0.1999352  2.538739 -5.2326303  4.692008
337 19.1762318  2.474385 14.2397329 23.945081
349 11.5322656  2.442416  6.9587586 16.365334
350 16.9642622  2.581663 11.9374718 22.133002
351  7.4249514  2.403118  2.6941554 12.008155
352 14.0262131  2.425196  9.2708539 18.683037
369 11.3333675  2.356395  6.7327631 15.925609
370 15.1315752  2.597838 10.1796824 20.286257
371  9.4775230  2.348093  4.6976117 14.110228
372 11.7910983  2.357786  7.1981437 16.297196</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0614 13.083313 228.1609 279.5959
  [2,] 273.6864 11.171070 251.3302 295.4142
  [3,] 293.3114  9.547484 274.4915 311.9415
  [4,] 312.9364  8.382008 296.4186 329.0430
  [5,] 332.5615  7.880584 317.3804 347.9113
  [6,] 352.1865  8.166461 336.1319 368.0495
  [7,] 371.8115  9.166271 353.5296 389.3630
  [8,] 391.4365 10.681381 369.8935 411.6709
  [9,] 411.0615 12.526181 386.1778 435.1746
 [10,] 430.6865 14.576024 401.9066 458.5432
 [11,] 211.4661 13.305524 184.9353 236.5642
 [12,] 213.2994 11.422920 190.6511 235.0095
 [13,] 215.1326  9.801404 195.7822 233.9502
 [14,] 216.9658  8.590126 200.2153 233.7336
 [15,] 218.7991  7.978176 203.5752 234.4163
 [16,] 220.6323  8.102508 204.5041 236.7113
 [17,] 222.4655  8.932428 204.8842 240.1792
 [18,] 224.2988 10.298748 203.9470 244.7467
 [19,] 226.1320 12.019918 202.2285 249.6621
 [20,] 227.9652 13.965349 200.0322 254.5777
 [21,] 212.7689 13.256688 186.9399 238.3329
 [22,] 217.7183 11.388756 194.8796 239.5464
 [23,] 222.6677  9.792187 203.1579 241.9697
 [24,] 227.6171  8.619121 210.5865 244.3497
 [25,] 232.5665  8.056721 216.7819 248.3439
 [26,] 237.5159  8.231126 221.4638 253.7106
 [27,] 242.4653  9.100071 224.9407 260.2740
 [28,] 247.4147 10.492393 227.2376 267.8936
 [29,] 252.3641 12.230639 229.0980 276.6328
 [30,] 257.3136 14.188231 230.5260 285.6667
 [31,] 274.2391 13.707827 247.2812 301.1702
 [32,] 280.0331 11.755382 256.5832 302.8653
 [33,] 285.8272 10.065093 265.8910 304.9907
 [34,] 291.6212  8.789528 274.5371 308.3392
 [35,] 297.4152  8.126383 280.9710 313.2926
 [36,] 303.2093  8.225145 286.5116 319.1299
 [37,] 309.0033  9.060934 290.4044 326.5611
 [38,] 314.7974 10.458521 293.8274 334.8967
 [39,] 320.5914 12.226749 295.8911 344.7740
 [40,] 326.3855 14.228096 297.9073 354.3739
 [41,] 273.2660 12.932987 248.4510 299.2996
 [42,] 280.7473 11.112945 259.3594 303.3190
 [43,] 288.2285  9.568970 269.7531 307.6149
 [44,] 295.7097  8.453702 278.9856 312.7223
 [45,] 303.1910  7.949668 287.5181 318.6826
 [46,] 310.6722  8.170777 294.6124 326.5953
 [47,] 318.1534  9.064118 300.3976 335.9058
 [48,] 325.6346 10.458830 305.4562 346.3522
 [49,] 333.1159 12.183934 309.7602 357.1290
 [50,] 340.5971 14.118839 313.2867 368.5690
 [51,] 260.0422 11.987081 236.2593 283.2389
 [52,] 270.2962 10.346796 249.9397 290.3520
 [53,] 280.5502  8.998073 262.6952 298.3491
 [54,] 290.8043  8.088110 274.7785 306.8385
 [55,] 301.0583  7.772566 285.9507 316.4623
 [56,] 311.3123  8.121028 295.7447 327.5125
 [57,] 321.5663  9.057178 303.8677 339.4486
 [58,] 331.8203 10.423862 311.2234 352.4841
 [59,] 342.0743 12.075777 318.1617 365.5283
 [60,] 352.3284 13.911684 324.9500 379.6928
 [61,] 267.9253 12.593413 243.9379 292.6331
 [62,] 278.2414 10.832660 257.5788 299.7046
 [63,] 288.5576  9.336119 270.6470 306.8635
 [64,] 298.8737  8.248869 282.7952 315.3050
 [65,] 309.1898  7.745236 294.2451 324.4714
 [66,] 319.5059  7.937106 304.2537 335.0163
 [67,] 329.8221  8.778994 313.0504 346.9617
 [68,] 340.1382 10.109795 320.7039 359.7397
 [69,] 350.4543 11.764748 327.5463 373.3226
 [70,] 360.7704 13.626253 334.2669 387.4967
 [71,] 244.4892 12.506115 220.3854 269.4726
 [72,] 255.9427 10.701126 235.1281 276.9150
 [73,] 267.3961  9.175710 249.3593 285.4602
 [74,] 278.8495  8.089596 263.1919 294.4750
 [75,] 290.3029  7.632683 275.5782 305.2525
 [76,] 301.7564  7.914702 286.8069 317.6523
 [77,] 313.2098  8.865412 296.3457 330.8721
 [78,] 324.6632 10.301307 305.2704 345.2896
 [79,] 336.1167 12.050173 313.2009 360.4580
 [80,] 347.5701 13.995171 320.7896 375.7355
 [81,] 250.6136 13.095298 226.2644 276.9224
 [82,] 250.4137 11.141984 229.7761 272.9295
 [83,] 250.2138  9.470544 232.4063 269.2249
 [84,] 250.0138  8.254028 233.9580 266.4105
 [85,] 249.8139  7.710847 234.4563 265.1273
 [86,] 249.6140  7.979707 233.9215 266.0087
 [87,] 249.4140  8.988030 232.0216 267.7283
 [88,] 249.2141 10.525400 229.0960 270.3678
 [89,] 249.0141 12.396523 225.6070 274.0231
 [90,] 248.8142 14.472523 221.1785 277.7596
 [91,] 285.9234 12.749389 260.5539 311.5463
 [92,] 305.0997 10.895352 283.5108 326.9803
 [93,] 324.2759  9.333576 305.9451 343.2347
 [94,] 343.4521  8.232118 327.1726 359.9239
 [95,] 362.6284  7.788777 347.3689 377.4237
 [96,] 381.8046  8.112182 366.0645 397.1979
 [97,] 400.9808  9.121135 383.5101 418.2138
 [98,] 420.1571 10.622047 399.1717 440.7149
 [99,] 439.3333 12.438080 414.4503 463.5904
[100,] 458.5095 14.450915 430.1390 486.5069
[101,] 226.7695 13.154729 200.4877 251.5765
[102,] 238.3018 11.307763 215.6717 259.9687
[103,] 249.8340  9.727018 230.5117 268.4216
[104,] 261.3663  8.561252 244.2537 277.8966
[105,] 272.8986  7.994123 256.8392 288.6974
[106,] 284.4308  8.151548 268.4433 301.1832
[107,] 295.9631  8.995570 277.9709 314.0788
[108,] 307.4954 10.359710 286.8814 328.3049
[109,] 319.0276 12.068873 295.0694 343.4251
[110,] 330.5599 13.997236 302.9828 358.4490
[111,] 239.0114 13.589193 211.2577 263.9233
[112,] 255.9757 11.600092 232.3875 277.5253
[113,] 272.9399  9.888786 253.3103 291.7803
[114,] 289.9042  8.622297 272.6189 306.5376
[115,] 306.8685  8.014356 290.9229 322.6185
[116,] 323.8327  8.212537 307.9856 340.0639
[117,] 340.7970  9.164694 323.2388 358.6588
[118,] 357.7612 10.670868 337.5911 378.7308
[119,] 374.7255 12.532885 350.4879 399.1620
[120,] 391.6898 14.615367 363.6041 420.1890
[121,] 255.9858 12.649239 231.2373 281.5578
[122,] 263.4108 10.862452 242.5037 285.0314
[123,] 270.8357  9.355876 252.4981 289.7882
[124,] 278.2607  8.283836 262.1983 294.6547
[125,] 285.6856  7.826966 270.4748 301.2696
[126,] 293.1106  8.090168 277.1055 309.0928
[127,] 300.5355  9.010559 282.6893 317.9335
[128,] 307.9605 10.415349 287.3430 328.5951
[129,] 315.3854 12.137494 291.7417 339.3306
[130,] 322.8104 14.060868 295.5121 350.9686
[131,] 272.2238 12.844359 246.5407 297.5402
[132,] 286.2500 11.048750 263.9989 307.6473
[133,] 300.2762  9.536003 281.3861 318.6827
[134,] 314.3024  8.459254 297.1650 330.8870
[135,] 328.3286  7.996608 312.2003 343.5834
[136,] 342.3548  8.252010 326.1140 358.0971
[137,] 356.3811  9.165628 338.4527 373.8289
[138,] 370.4073 10.568111 349.4713 390.8117
[139,] 384.4335 12.293264 360.3161 408.4514
[140,] 398.4597 14.224165 370.5990 426.0075
[141,] 254.8204 12.264534 231.0986 279.5402
[142,] 266.1537 10.531359 246.1228 287.1526
[143,] 277.4871  9.083252 260.0886 294.7344
[144,] 288.8205  8.075060 273.0659 304.2275
[145,] 300.1538  7.681986 285.2944 314.9436
[146,] 311.4872  7.995274 295.9077 326.5910
[147,] 322.8206  8.940979 305.2837 340.4147
[148,] 334.1539 10.347125 314.1249 354.5243
[149,] 345.4873 12.053633 321.9397 369.0289
[150,] 356.8207 13.950711 329.5791 384.3319
[151,] 226.6842 13.708217 198.7819 252.6740
[152,] 241.8158 11.689126 218.1003 264.1270
[153,] 256.9474  9.942516 237.0595 276.1940
[154,] 272.0790  8.635342 255.0262 289.1340
[155,] 287.2105  7.986373 271.7879 302.7434
[156,] 302.3421  8.154305 286.1935 318.4641
[157,] 317.4737  9.093996 299.5782 335.8261
[158,] 332.6053 10.602187 311.7383 353.8548
[159,] 347.7368 12.474354 323.6256 372.3009
[160,] 362.8684 14.570867 335.0900 391.6440
[161,] 252.0834 12.440285 227.4842 277.6020
[162,] 261.5609 10.708030 240.3145 283.5301
[163,] 271.0385  9.251496 252.9417 289.9324
[164,] 280.5160  8.218609 264.3828 296.7247
[165,] 289.9935  7.779972 274.6696 305.5551
[166,] 299.4710  8.033522 283.7425 315.6220
[167,] 308.9485  8.920430 290.8849 326.5061
[168,] 318.4261 10.278023 298.1492 339.0145
[169,] 327.9036 11.946903 304.3138 351.7192
[170,] 337.3811 13.814715 309.6111 364.5060
[171,] 263.5454 12.359101 239.1389 288.0391
[172,] 275.3365 10.637017 254.7705 296.3677
[173,] 287.1276  9.201259 269.1626 305.0711
[174,] 298.9187  8.203568 282.8490 314.9378
[175,] 310.7098  7.813591 295.7664 326.0775
[176,] 322.5009  8.119371 306.8103 338.4434
[177,] 334.2920  9.050662 316.7096 352.1235
[178,] 346.0831 10.441413 325.6046 366.8056
[179,] 357.8742 12.134662 334.3634 381.8703
[180,] 369.6653 14.021243 342.5177 397.5191</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.5013980 13.083313  -30.0358827  21.3991003
  [2,]  -14.9817141 11.171070  -36.7095331   7.3745180
  [3,]  -42.5108302  9.547484  -61.1408587 -23.6909351
  [4,]    8.5033537  8.382008   -7.6032124  25.0212183
  [5,]   24.2904377  7.880584    8.9405867  39.4715327
  [6,]   62.5036216  8.166461   46.6406298  78.5581582
  [7,]   10.3923055  9.166271   -7.1591971  28.6742217
  [8,] -101.2879105 10.681381 -121.5222700 -79.7448509
  [9,]   19.5237734 12.526181   -4.5892883  44.4074844
 [10,]   35.6669573 14.576024    7.8103163  64.4468699
 [11,]   11.2677836 13.305524  -13.8303122  37.7985746
 [12,]   -8.0335515 11.422920  -29.7436853  14.6146748
 [13,]  -12.1547866  9.801404  -30.9723865   7.1956311
 [14,]  -12.2588216  8.590126  -29.0265817   4.4916967
 [15,]  -11.0829567  7.978176  -26.7002033   4.1409058
 [16,]   -4.6704918  8.102508  -20.7495139  11.4576925
 [17,]   -8.8352269  8.932428  -26.5489079   8.7461369
 [18,]   -6.5715620 10.298748  -27.0195481  13.7801524
 [19,]   -1.8362971 12.019918  -25.3664402  22.0671865
 [20,]    9.3489678 13.965349  -17.2635217  37.2820423
 [21,]  -13.7149603 13.256688  -39.2790106  12.1139983
 [22,]  -23.3860711 11.388756  -45.2141975  -0.5474326
 [23,]   11.6523180  9.792187   -7.6497275  31.1621247
 [24,]    5.2245072  8.619121  -11.5081153  22.2551393
 [25,]   -3.2591036  8.056721  -19.0365307  12.5254891
 [26,]  -17.0580145  8.231126  -33.2526827  -1.0058787
 [27,]   -7.0445253  9.100071  -24.8531917  10.4800634
 [28,]    8.3363639 10.492393  -12.1424996  28.5135005
 [29,]    8.6483531 12.230639  -15.6202753  31.9145468
 [30,]   -9.7982578 14.188231  -38.1513787  16.9893488
 [31,]   47.3035371 13.707827   20.3723919  74.2614339
 [32,]   20.3670915 11.755382   -2.4650506  43.8170215
 [33,]   -1.9706540 10.065093  -21.1341870  17.9654983
 [34,]   -6.4881996  8.789528  -23.2062477  10.5958845
 [35,]  -11.6179452  8.126383  -27.4952934   4.8262924
 [36,]   -5.6237907  8.225145  -21.5444180  11.0739142
 [37,]  -28.7637363  9.060934  -46.3214907 -10.1647589
 [38,]    3.4639181 10.458521  -16.6354442  24.4338605
 [39,]  -15.2419274 12.226749  -39.4244631   9.4584096
 [40,]   27.6632270 14.228096   -0.3252319  56.1413716
 [41,]   14.3418664 12.932987  -11.6917040  39.1569408
 [42,]    4.2527362 11.112945  -18.3189671  25.6406315
 [43,]   13.5921060  9.568970   -5.7943172  32.0674650
 [44,]   24.4055758  8.453702    7.3929920  41.1296527
 [45,]   13.0863456  7.949668   -2.4053051  28.7591625
 [46,]  -17.3534845  8.170777  -33.2765945  -1.2937069
 [47,]  -28.0784147  9.064118  -45.8308070 -10.3225984
 [48,]    9.1830551 10.458830  -11.5345025  29.3614609
 [49,]  -39.3689751 12.183934  -63.3820796 -16.0133189
 [50,]   30.9839947 14.118839    3.0121245  58.2944288
 [51,]  -25.1816023 11.987081  -48.3783248  -1.3987455
 [52,]  -27.4844199 10.346796  -47.5402213  -7.1279298
 [53,]   -7.5889375  8.998073  -25.3877534  10.2660576
 [54,]   18.9645449  8.088110    2.9302785  34.9903256
 [55,]   16.4046273  7.772566    1.0006040  31.5121505
 [56,]   -1.3146903  8.121028  -17.5149220  14.2529307
 [57,]  132.5955921  9.057178  114.7132564 150.2941706
 [58,]   15.0107745 10.423862   -5.6529813  35.6077162
 [59,]  -11.7740431 12.075777  -35.2279886  12.1386262
 [60,]  -98.4639607 13.911684 -125.8284332 -71.0855945
 [61,]   15.9170947 12.593413   -8.7907105  39.9045179
 [62,]   11.3135694 10.832660  -10.1495978  31.9761730
 [63,]  -11.7882559  9.336119  -30.0942495   6.1222816
 [64,]    0.9360188  8.248869  -15.4952897  17.0144659
 [65,]  -12.0188065  7.745236  -27.3003863   2.9258965
 [66,]   18.6605682  7.937106    3.1501793  33.9127581
 [67,]    2.2044429  8.778994  -14.9352496  18.9761174
 [68,]    8.7017176 10.109795  -10.8998365  28.1359870
 [69,]  -17.0943077 11.764748  -39.9626379   5.8136595
 [70,]    1.2723670 13.626253  -25.4539270  27.7759302
 [71,]   20.9838809 12.506115   -3.9994850  45.0876720
 [72,]   20.2585495 10.701126   -0.7137694  41.0731285
 [73,]  -24.0313819  9.175710  -42.0954687  -5.9946251
 [74,]  -24.1772134  8.089596  -39.8026813  -8.5195664
 [75,]  -11.2785448  7.632683  -26.2281373   3.4461667
 [76,]  -17.5651762  7.914702  -33.4610696  -2.6157463
 [77,]   -7.6850077  8.865412  -25.3472855   9.1790949
 [78,]    6.8596609 10.301307  -13.7667017  26.2525071
 [79,]   -0.3697705 12.050173  -24.7111499  22.5460261
 [80,]   29.7288980 13.995171    1.5634817  56.5094456
 [81,]   -9.0053264 13.095298  -35.3140570  15.3438813
 [82,]   23.5335088 11.141984    1.0176755  44.1710933
 [83,]    4.2769441  9.470544  -14.7342101  22.0843860
 [84,]   20.7882793  8.254028    4.3916486  36.8441080
 [85,]    1.6380145  7.710847  -13.6753990  16.9955559
 [86,]    5.0222498  7.979707  -11.3724986  20.7147382
 [87,]   -3.9617150  8.988030  -22.2760051  13.4306825
 [88,]  -13.9030798 10.525400  -35.0567525   6.2149892
 [89,]  -13.2600446 12.396523  -38.2689716  10.1471420
 [90,]  -11.5676093 14.472523  -40.5130030  16.0680958
 [91,]   26.4431719 12.749389    0.8203266  51.8126629
 [92,]    8.7061401 10.895352  -13.1744761  30.2949722
 [93,]  -32.6646917  9.333576  -51.6235321 -14.3338834
 [94,]    2.6700765  8.232118  -13.8017146  18.9495710
 [95,]    3.1040447  7.788777  -11.6912961  18.3634940
 [96,]   10.0339129  8.112182   -5.3593755  25.7740392
 [97,]    3.2792811  9.121135  -13.9537385  20.7500094
 [98,]   -3.4647506 10.622047  -24.0225908  17.5206322
 [99,]   16.5310176 12.438080   -7.7260647  41.4140248
[100,]    0.4071858 14.450915  -27.5902044  28.7776726
[101,]    9.3336953 13.154729  -15.4732829  35.6154559
[102,]   -7.9850703 11.307763  -29.6519977  14.6449734
[103,]  -10.9084360  9.727018  -29.4959644   8.4139000
[104,]   -6.4443016  8.561252  -22.9745934  10.6683021
[105,]  -22.1882672  7.994123  -37.9871400  -6.1288884
[106,]  -14.6564329  8.151548  -31.4088398   1.3310738
[107,]  -14.3982985  8.995570  -32.5139719   3.5939134
[108,]    0.6066359 10.359710  -20.2028885  21.2205725
[109,]   17.2529702 12.068873   -7.1445324  41.2112230
[110,]   21.0852046 13.997236   -6.8038501  48.6623097
[111,]   17.2853955 13.589193   -7.6265451  45.0390635
[112,]  -12.5213667 11.600092  -34.0710342  11.0667764
[113,]  -16.7353289  9.888786  -35.5757015   2.8942944
[114,]  -34.3770911  8.622297  -51.0104810 -17.0917698
[115,]  -37.9519533  8.014356  -53.7019713 -22.0063508
[116,]    5.8919845  8.212537  -10.3391899  21.7391331
[117,]   38.6475223  9.164694   20.7856904  56.2056908
[118,]    5.1571601 10.670868  -15.8124199  25.3273144
[119,]   19.7616979 12.532885   -4.6748485  43.9992983
[120,]   -2.6370643 14.615367  -31.1362961  25.4485735
[121,]   -5.4593135 12.649239  -31.0312661  19.2892183
[122,]   36.6468352 10.862452   15.0262284  57.5538761
[123,]   -0.9418162  9.355876  -19.8943180  17.3957761
[124,]    2.3284324  8.283836  -14.0655729  18.3907545
[125,]  -13.8582190  7.826966  -29.4421906   1.3526307
[126,]   11.5230296  8.090168   -4.4592474  27.5280952
[127,]  -12.7889218  9.010559  -30.1868720   5.0572808
[128,]  -41.3649732 10.415349  -61.9996430 -20.7474771
[129,]    6.1563754 12.137494  -17.7888204  29.8001074
[130,]   24.7551240 14.060868   -3.4031297  52.0533569
[131,]  -50.5466741 12.844359  -75.8630683 -24.8636028
[132,]   11.9439128 11.048750   -9.4534301  34.1949649
[133,]   26.6022996  9.536003    8.1957719  45.4923948
[134,]   32.5530865  8.459254   15.9684908  49.6904690
[135,]   20.4115734  7.996608    5.1567873  36.5398809
[136,]   10.4738603  8.252010   -5.2683655  26.7147180
[137,]   -1.9544529  9.165628  -19.4023268  15.9738646
[138,]   -9.9746660 10.568111  -30.3791269  10.9612858
[139,]   -8.7928791 12.293264  -32.8107670  15.3245464
[140,]   -9.9179922 14.224165  -37.4658039  17.9426913
[141,]   17.1031254 12.264534   -7.6167389  40.8249130
[142,]    2.2831579 10.531359  -18.7156608  22.3140681
[143,]  -20.2447095  9.083252  -37.4919651  -2.8461979
[144,]  -11.1638770  8.075060  -26.5709396   4.5907379
[145,]   14.6683555  7.681986   -0.1214012  29.5278438
[146,]    5.7262880  7.995274   -9.3774681  21.3057722
[147,]  -24.6852795  8.940979  -42.2794146  -7.1484083
[148,]   13.9689531 10.347125   -6.4013603  33.9979541
[149,]   -5.2073144 12.053633  -28.7488606  18.3402605
[150,]    9.6924181 13.950711  -17.8187582  36.9340341
[151,]   -1.4202468 13.708217  -27.4099922  26.4820786
[152,]   -7.2923219 11.689126  -29.6035318  16.4231665
[153,]  -18.0465971  9.942516  -37.2931511   1.8413311
[154,]  -31.6059723  8.635342  -48.6609752 -14.5532456
[155,]  -19.6732475  7.986373  -35.2060547  -4.2505632
[156,]   41.8515774  8.154305   25.7295597  58.0002272
[157,]  -36.3255978  9.093996  -54.6780120 -18.4300511
[158,]   14.9802270 10.602187   -6.2692504  35.8471665
[159,]   17.4261519 12.474354   -7.1379038  41.5374142
[160,]    9.3603767 14.570867  -19.4152363  37.1388033
[161,]   17.7969958 12.440285   -7.7216244  42.3962009
[162,]   10.8818728 10.708030  -11.0873373  32.1282503
[163,]    6.8604498  9.251496  -12.0334875  24.9571804
[164,]    1.2735268  8.218609  -14.9352441  17.4067320
[165,]  -10.8229962  7.779972  -26.3845658   4.5009030
[166,]  -14.9590192  8.033522  -31.1099554   0.7695197
[167,]  -49.6827422  8.920430  -67.2403350 -31.6191174
[168,]  -13.7954652 10.278023  -34.3838710   6.4813740
[169,]   22.8771118 11.946903   -0.9384577  46.4669497
[170,]   32.0880888 13.814715    4.9632133  59.8581198
[171,]    5.8662520 12.359101  -18.6273800  30.2727785
[172,]   -1.8625463 10.637017  -22.8937486  18.7035288
[173,]   10.4691555  9.201259   -7.4743151  28.4342359
[174,]   11.7128572  8.203568   -4.3062230  27.7825800
[175,]  -23.5372411  7.813591  -38.9048821  -8.5937849
[176,]    7.1066607  8.119371   -8.8357508  22.7973419
[177,]    0.1897624  9.050662  -17.6417036  17.7721507
[178,]   -2.8632359 10.441413  -23.5856784  17.6152847
[179,]   11.2674658 12.134662  -12.7285952  34.7782662
[180,]   -5.5417324 14.021243  -33.3955241  21.6059302</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.7  3.3
looic      1770.4 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   632       
 (0.5, 0.7]   (ok)         3    1.7%   120       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.9 22.3
p_loo        33.9  8.4
looic      1721.8 44.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   834       
 (0.5, 0.7]   (ok)         5    2.8%   521       
   (0.7, 1]   (bad)        2    1.1%   36        
   (1, Inf)   (very bad)   1    0.6%   22        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.6  
fit_sleep1 -92.4      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.7  3.3
looic      1770.4 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   632       
 (0.5, 0.7]   (ok)         3    1.7%   120       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.9 22.3
p_loo        33.9  8.4
looic      1721.8 44.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   834       
 (0.5, 0.7]   (ok)         5    2.8%   521       
   (0.7, 1]   (bad)        2    1.1%   36        
   (1, Inf)   (very bad)   1    0.6%   22        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.9     22.3        33.9    8.4   1721.8
fit_sleep2  -24.3      11.6  -885.2     14.4        19.7    3.3   1770.4
fit_sleep1  -92.4      21.0  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   44.6  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
7.783895e-41 2.761139e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0      2.9      1.62     0.13     5.54       0.05      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0     -0.1      1.62    -3.42     3.08       5.04      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-33         Matrix_1.5-4.1     

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.1       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.32       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
