<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.79      6.77    15.62    41.83 1.00     1953     2674
sd(Days)                6.53      1.46     4.15     9.87 1.00     1672     2311
cor(Intercept,Days)     0.08      0.30    -0.49     0.65 1.00     1118     1728

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.33      7.52   236.56   266.46 1.00     2015     2313
Days         10.46      1.71     7.06    13.79 1.00     1535     2074

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.89      1.53    23.12    29.12 1.00     3539     3163

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6760  13.12034 227.7715 278.9007
309 211.1711  13.55611 184.3833 237.1411
310 213.0513  12.98522 187.5162 238.5078
330 274.4709  13.37543 248.7971 300.8832
331 273.0557  13.18171 248.5858 299.9419
332 260.3996  12.33651 236.1792 284.9451
333 267.8504  12.57132 244.0997 293.3594
334 244.3142  12.31299 220.2082 268.3334
335 250.8192  13.07566 225.6950 276.3480
337 285.9599  13.29440 259.4576 311.9190
349 226.5768  13.10705 199.8046 251.1920
350 238.7757  13.30864 211.8736 264.5830
351 255.7950  12.35057 232.2538 280.8114
352 271.8690  12.56396 248.0029 296.6892
369 254.7250  12.54227 229.9185 279.2194
370 226.2017  13.26289 198.9879 251.1686
371 252.2015  12.30513 227.8721 276.6350
372 263.5075  12.47711 238.5803 287.6842

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6414352  2.508439 14.8173208 24.605265
309  1.8220825  2.524892 -3.0293766  6.794314
310  4.9235500  2.453261  0.1013962  9.699060
330  5.7808435  2.544916  0.9368135 10.616109
331  7.5325047  2.524619  2.4231776 12.398084
332 10.1917346  2.364401  5.4782800 14.834309
333 10.3151807  2.391521  5.5869302 15.000091
334 11.5302562  2.320688  6.9543834 16.110582
335 -0.2260962  2.541353 -5.3373913  4.645421
337 19.1692154  2.533176 14.2187048 24.094085
349 11.5444857  2.468259  6.8885952 16.503738
350 17.0253773  2.516198 12.1855098 21.984176
351  7.4943548  2.401830  2.7559384 12.163966
352 14.0581248  2.357290  9.3817015 18.709884
369 11.2914465  2.375306  6.5229579 15.962359
370 15.2150549  2.533297 10.3720774 20.524813
371  9.4778801  2.346175  4.8995558 14.145895
372 11.7950204  2.367063  7.1412089 16.532002</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6760 13.120337 227.7715 278.9007
  [2,] 273.3175 11.207803 250.9672 294.7599
  [3,] 292.9589  9.574498 274.1872 311.6225
  [4,] 312.6003  8.385208 296.1210 329.0249
  [5,] 332.2418  7.844549 317.2370 347.6379
  [6,] 351.8832  8.083731 336.2544 368.2852
  [7,] 371.5246  9.041074 353.9327 389.8097
  [8,] 391.1661 10.522350 370.7220 412.0291
  [9,] 410.8075 12.340309 386.7329 435.4445
 [10,] 430.4489 14.367712 402.4543 458.8867
 [11,] 211.1711 13.556106 184.3833 237.1411
 [12,] 212.9932 11.618433 190.0971 235.1359
 [13,] 214.8153  9.947768 195.4873 234.1289
 [14,] 216.6374  8.699331 199.8618 233.2627
 [15,] 218.4595  8.071480 202.6068 233.7711
 [16,] 220.2815  8.207885 204.2830 236.1858
 [17,] 222.1036  9.074145 204.3557 239.4853
 [18,] 223.9257 10.490996 203.5394 244.4444
 [19,] 225.7478 12.269150 201.9818 249.4337
 [20,] 227.5699 14.274216 199.7916 255.1957
 [21,] 213.0513 12.985222 187.5162 238.5078
 [22,] 217.9749 11.147691 196.1311 239.5394
 [23,] 222.8984  9.589735 203.8749 241.4502
 [24,] 227.8220  8.467113 210.8690 244.2395
 [25,] 232.7455  7.966050 216.8895 248.2239
 [26,] 237.6691  8.201273 221.4082 253.6637
 [27,] 242.5926  9.115963 224.6446 260.1981
 [28,] 247.5162 10.534594 226.6609 268.1907
 [29,] 252.4397 12.283791 228.1090 276.1064
 [30,] 257.3633 14.242273 229.4655 284.8154
 [31,] 274.4709 13.375434 248.7971 300.8832
 [32,] 280.2518 11.412485 258.7534 303.2844
 [33,] 286.0326  9.723199 267.8696 305.7451
 [34,] 291.8134  8.472872 275.8504 309.0703
 [35,] 297.5943  7.873483 282.4501 313.2450
 [36,] 303.3751  8.071375 287.9096 319.3938
 [37,] 309.1560  9.014191 291.5569 326.8304
 [38,] 314.9368 10.503208 294.5074 335.5324
 [39,] 320.7177 12.342298 296.8386 344.4292
 [40,] 326.4985 14.397932 298.4597 353.9814
 [41,] 273.0557 13.181708 248.5858 299.9419
 [42,] 280.5882 11.290175 259.0933 303.4477
 [43,] 288.1207  9.691546 269.4544 307.5915
 [44,] 295.6532  8.551695 278.9328 312.5725
 [45,] 303.1857  8.067485 287.1163 318.6717
 [46,] 310.7182  8.353714 293.9814 326.9554
 [47,] 318.2507  9.339817 300.0787 336.4082
 [48,] 325.7832 10.836384 304.8212 346.8981
 [49,] 333.3157 12.663715 308.2036 357.6955
 [50,] 340.8482 14.698963 311.5933 369.4509
 [51,] 260.3996 12.336508 236.1792 284.9451
 [52,] 270.5913 10.661086 249.7836 291.5903
 [53,] 280.7831  9.290257 262.9513 299.1120
 [54,] 290.9748  8.374949 275.1685 307.6427
 [55,] 301.1665  8.071644 285.6524 317.2868
 [56,] 311.3583  8.446532 295.2174 328.0290
 [57,] 321.5500  9.418979 303.3325 340.3271
 [58,] 331.7418 10.829183 310.4322 352.7722
 [59,] 341.9335 12.530204 317.0586 366.5280
 [60,] 352.1252 14.419488 323.4298 380.7139
 [61,] 267.8504 12.571324 244.0997 293.3594
 [62,] 278.1656 10.818432 257.7813 300.0479
 [63,] 288.4808  9.352940 270.9167 307.7960
 [64,] 298.7960  8.327980 283.0218 315.6604
 [65,] 309.1111  7.916550 293.6993 324.6843
 [66,] 319.4263  8.211396 303.2652 335.7013
 [67,] 329.7415  9.144454 311.7409 347.7266
 [68,] 340.0567 10.547691 319.2682 360.6977
 [69,] 350.3719 12.260721 325.7123 373.9860
 [70,] 360.6870 14.171645 332.1673 388.4797
 [71,] 244.3142 12.312991 220.2082 268.3334
 [72,] 255.8444 10.624510 234.8276 276.3487
 [73,] 267.3747  9.215305 249.3467 285.2659
 [74,] 278.9049  8.230108 263.1469 294.7243
 [75,] 290.4352  7.830625 275.0768 305.4405
 [76,] 301.9654  8.103942 285.8614 317.3969
 [77,] 313.4957  8.988897 295.4581 330.5853
 [78,] 325.0259 10.329464 304.3810 344.8562
 [79,] 336.5562 11.973578 312.7306 359.6068
 [80,] 348.0865 13.813273 320.7232 374.6079
 [81,] 250.8192 13.075655 225.6950 276.3480
 [82,] 250.5931 11.169153 229.0954 272.6914
 [83,] 250.3670  9.562644 231.6507 269.4832
 [84,] 250.1409  8.429429 233.4290 266.4697
 [85,] 249.9148  7.973916 234.3013 265.2122
 [86,] 249.6887  8.308329 233.3717 265.6598
 [87,] 249.4626  9.348277 231.2666 267.2448
 [88,] 249.2365 10.893539 228.0128 270.2148
 [89,] 249.0104 12.761858 223.7556 274.0326
 [90,] 248.7843 14.831649 219.0906 278.2164
 [91,] 285.9599 13.294397 259.4576 311.9190
 [92,] 305.1292 11.389645 282.3097 327.8601
 [93,] 324.2984  9.774506 305.0433 343.3209
 [94,] 343.4676  8.613472 326.8770 360.3707
 [95,] 362.6368  8.104122 347.4247 378.8240
 [96,] 381.8060  8.366341 365.9100 398.0452
 [97,] 400.9752  9.335335 383.3928 419.4658
 [98,] 420.1444 10.822905 399.9100 441.9652
 [99,] 439.3137 12.647372 415.7096 464.5202
[100,] 458.4829 14.683690 430.8396 487.8452
[101,] 226.5768 13.107050 199.8046 251.1920
[102,] 238.1213 11.278586 215.2856 259.6599
[103,] 249.6658  9.736676 230.4638 268.2283
[104,] 261.2103  8.636193 244.3889 277.9292
[105,] 272.7547  8.157782 256.9542 288.8938
[106,] 284.2992  8.408305 267.8479 301.0985
[107,] 295.8437  9.329222 277.3151 314.2141
[108,] 307.3882 10.749595 286.2059 328.2552
[109,] 318.9327 12.500312 294.3586 343.0536
[110,] 330.4772 14.461896 302.3069 358.3299
[111,] 238.7757 13.308640 211.8736 264.5830
[112,] 255.8010 11.364772 233.3951 277.7548
[113,] 272.8264  9.688069 253.8995 291.7920
[114,] 289.8518  8.439303 272.9971 306.4613
[115,] 306.8772  7.826079 291.5026 322.6173
[116,] 323.9026  7.995979 308.3515 339.8381
[117,] 340.9279  8.904289 323.9822 358.3229
[118,] 357.9533 10.358549 338.0505 377.7266
[119,] 374.9787 12.164507 351.4523 398.5527
[120,] 392.0041 14.188497 364.4479 419.9677
[121,] 255.7950 12.350575 232.2538 280.8114
[122,] 263.2894 10.599018 242.7112 284.5205
[123,] 270.7837  9.147636 253.0001 289.0960
[124,] 278.2781  8.158240 262.4319 294.7146
[125,] 285.7724  7.808462 270.6084 301.2893
[126,] 293.2668  8.180761 277.4249 309.3119
[127,] 300.7611  9.187775 282.8954 318.6326
[128,] 308.2555 10.650968 287.1569 329.1894
[129,] 315.7499 12.410020 291.2509 340.3586
[130,] 323.2442 14.356589 294.5757 351.5118
[131,] 271.8690 12.563957 248.0029 296.6892
[132,] 285.9271 10.813885 264.9966 307.1161
[133,] 299.9852  9.334924 282.0245 318.4115
[134,] 314.0434  8.273763 297.9708 330.4559
[135,] 328.1015  7.802765 312.9643 343.6788
[136,] 342.1596  8.026504 326.5493 357.8369
[137,] 356.2177  8.892695 339.3217 373.4397
[138,] 370.2758 10.239576 350.8914 390.4165
[139,] 384.3340 11.905101 361.4409 407.5765
[140,] 398.3921 13.774164 372.2142 425.0824
[141,] 254.7250 12.542265 229.9185 279.2194
[142,] 266.0165 10.766582 245.1057 286.9063
[143,] 277.3079  9.263602 259.4492 295.4647
[144,] 288.5994  8.184957 272.6445 304.7231
[145,] 299.8908  7.710828 285.1093 314.9690
[146,] 311.1823  7.950118 295.8614 326.7339
[147,] 322.4737  8.845114 305.3586 339.3269
[148,] 333.7651 10.225061 313.2231 353.3756
[149,] 345.0566 11.922745 321.3836 367.9775
[150,] 356.3480 13.821577 328.7640 382.8100
[151,] 226.2017 13.262889 198.9879 251.1686
[152,] 241.4167 11.329402 218.2041 262.8859
[153,] 256.6318  9.676861 237.2181 275.6907
[154,] 271.8468  8.471313 255.3586 288.6120
[155,] 287.0619  7.919585 271.4083 303.0359
[156,] 302.2770  8.155471 286.5268 318.6673
[157,] 317.4920  9.118046 299.9359 335.7649
[158,] 332.7071 10.611363 312.2772 353.6943
[159,] 347.9221 12.445822 323.7147 372.7419
[160,] 363.1372 14.492451 334.9864 392.4525
[161,] 252.2015 12.305134 227.8721 276.6350
[162,] 261.6794 10.569836 240.7611 282.6270
[163,] 271.1573  9.112387 253.1160 288.9342
[164,] 280.6352  8.084482 264.8362 296.5638
[165,] 290.1130  7.661015 275.0544 305.2936
[166,] 299.5909  7.939303 284.0386 315.5737
[167,] 309.0688  8.853417 291.8336 326.7802
[168,] 318.5467 10.234379 298.2025 338.7921
[169,] 328.0246 11.921036 304.6502 351.4635
[170,] 337.5024 13.801766 310.2733 364.7104
[171,] 263.5075 12.477108 238.5803 287.6842
[172,] 275.3026 10.728174 253.9149 296.0155
[173,] 287.0976  9.258249 268.8406 305.3980
[174,] 298.8926  8.218432 282.7399 314.8615
[175,] 310.6876  7.783060 295.2770 325.8520
[176,] 322.4826  8.050802 306.6262 338.0795
[177,] 334.2777  8.958837 316.6523 351.5671
[178,] 346.0727 10.339830 325.8109 366.3783
[179,] 357.8677 12.032015 334.1343 381.6221
[180,] 369.6627 13.922380 342.2434 396.9789</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.1160158 13.120337  -29.34071099  21.7884801
  [2,]  -14.6127510 11.207803  -36.05522428   7.7374660
  [3,]  -42.1582862  9.574498  -60.82189553 -23.3865867
  [4,]    8.8394786  8.385208   -7.58509629  25.3188198
  [5,]   24.6101434  7.844549    9.21397029  39.6149443
  [6,]   62.8069082  8.083731   46.40486492  78.4356736
  [7,]   10.6791730  9.041074   -7.60587258  28.2710873
  [8,] -101.0174622 10.522350 -121.88054086 -80.5734410
  [9,]   19.7778026 12.340309   -4.85922121  43.8523777
 [10,]   35.9045674 14.367712    7.46680938  63.8992224
 [11,]   11.5627766 13.556106  -14.40722122  38.3505517
 [12,]   -7.7274059 11.618433  -29.87008667  15.1686650
 [13,]  -11.8374885  9.947768  -31.15114687   7.4904858
 [14,]  -11.9303710  8.699331  -28.55565127   4.8451972
 [15,]  -10.7433535  8.071480  -26.05497527   5.1093235
 [16,]   -4.3197360  8.207885  -20.22402788  11.6788024
 [17,]   -8.4733185  9.074145  -25.85496124   9.2746346
 [18,]   -6.1985010 10.490996  -26.71721046  14.1877802
 [19,]   -1.4520835 12.269150  -25.13803312  22.3138696
 [20,]    9.7443340 14.274216  -17.88151843  37.5226153
 [21,]  -13.9974230 12.985222  -39.45386694  11.5377326
 [22,]  -23.6426730 11.147691  -45.20715174  -1.7989384
 [23,]   11.4215770  9.589735   -7.13024942  30.4450793
 [24,]    5.0196271  8.467113  -11.39794199  21.9726103
 [25,]   -3.4381229  7.966050  -18.91652676  12.4178955
 [26,]  -17.2111729  8.201273  -33.20578016  -0.9503406
 [27,]   -7.1718228  9.115963  -24.77734497  10.7762023
 [28,]    8.2349272 10.534594  -12.43957113  29.0901949
 [29,]    8.5727772 12.283791  -15.09387991  32.9034730
 [30,]   -9.8479727 14.242273  -37.30014509  18.0497540
 [31,]   47.0716837 13.375434   20.65943973  72.7455358
 [32,]   20.1484402 11.412485   -2.88420981  41.6467551
 [33,]   -2.1761033  9.723199  -21.88856052  15.9868930
 [34,]   -6.6804468  8.472872  -23.93728100   9.2825848
 [35,]  -11.7969903  7.873483  -27.44769987   3.3472274
 [36,]   -5.7896338  8.071375  -21.80830949   9.6759342
 [37,]  -28.9163773  9.014191  -46.59083842 -11.3173177
 [38,]    3.3244792 10.503208  -17.27107625  23.7539422
 [39,]  -15.3681643 12.342298  -39.07969310   8.5108567
 [40,]   27.5501922 14.397932    0.06734624  55.5890280
 [41,]   14.5522449 13.181708  -12.33397783  39.0220923
 [42,]    4.4118402 11.290175  -18.44769101  25.9067386
 [43,]   13.6999355  9.691546   -5.77091067  32.3661941
 [44,]   24.4621308  8.551695    7.54284660  41.1824985
 [45,]   13.0916261  8.067485   -2.39437043  29.1609913
 [46,]  -17.3994786  8.353714  -33.63673018  -0.6627379
 [47,]  -28.1756833  9.339817  -46.33324429 -10.0036885
 [48,]    9.0345120 10.836384  -12.08040008  29.9964583
 [49,]  -39.5687927 12.663715  -63.94860607 -14.4567354
 [50,]   30.7329026 14.698963    2.13017321  59.9878273
 [51,]  -25.5390091 12.336508  -50.08453474  -1.3185682
 [52,]  -27.7795436 10.661086  -48.77848632  -6.9717777
 [53,]   -7.8217782  9.290257  -26.15072394  10.0099598
 [54,]   18.7939873  8.374949    2.12605741  34.6003272
 [55,]   16.2963527  8.071644    0.17610843  31.8105007
 [56,]   -1.3606818  8.446532  -18.03139771  14.7801645
 [57,]  132.6118836  9.418979  113.83480437 150.8293884
 [58,]   15.0893491 10.829183   -5.94113596  36.3989068
 [59,]  -11.6331855 12.530204  -36.22769326  13.2417245
 [60,]  -98.2608201 14.419488 -126.84952486 -69.5653658
 [61,]   15.9919810 12.571324   -9.51704686  39.7426800
 [62,]   11.3894003 10.818432  -10.49286049  31.7737381
 [63,]  -11.7114804  9.352940  -31.02671505   5.8526284
 [64,]    1.0137389  8.327980  -15.85066760  16.7879338
 [65,]  -11.9401418  7.916550  -27.51325435   3.4716691
 [66,]   18.7401775  8.211396    2.46521017  34.9013379
 [67,]    2.2849968  9.144454  -15.70006734  20.2856033
 [68,]    8.7832161 10.547691  -11.85775055  29.5717282
 [69,]  -17.0118646 12.260721  -40.62604747   7.6476723
 [70,]    1.3557546 14.171645  -26.43692467  29.8754988
 [71,]   21.1589449 12.312991   -2.86032995  45.2649071
 [72,]   20.3567887 10.624510   -0.14751590  41.3735706
 [73,]  -24.0099675  9.215305  -41.90122963  -5.9820380
 [74,]  -24.2326236  8.230108  -40.05202896  -8.4745855
 [75,]  -11.4107798  7.830625  -26.41610391   3.9475739
 [76,]  -17.7742360  8.103942  -33.20571138  -1.6702198
 [77,]   -7.9708922  8.988897  -25.06046862  10.0666565
 [78,]    6.4969517 10.329464  -13.33329182  27.1419282
 [79,]   -0.8093045 11.973578  -23.85987120  23.0162888
 [80,]   29.2125393 13.813273    2.69105979  56.5757582
 [81,]   -9.2109124 13.075655  -34.73971265  15.9133353
 [82,]   23.3540838 11.169153    1.25575410  44.8517733
 [83,]    4.1236800  9.562644  -14.99253841  22.8399887
 [84,]   20.6611762  8.429429    4.33236678  37.3730515
 [85,]    1.5370724  7.973916  -13.76029377  17.1505895
 [86,]    4.9474686  8.308329  -11.02358894  21.2645070
 [87,]   -4.0103352  9.348277  -21.79247260  14.1857179
 [88,]  -13.9255390 10.893539  -34.90384128   7.2982499
 [89,]  -13.2563428 12.761858  -38.27845811  11.9984819
 [90,]  -11.5377466 14.831649  -40.96976646  18.1560026
 [91,]   26.4066592 13.294397    0.44756866  52.9090223
 [92,]    8.6766438 11.389645  -14.05427634  31.4960538
 [93,]  -32.6871717  9.774506  -51.70972687 -13.4320571
 [94,]    2.6546129  8.613472  -14.24852572  19.2451801
 [95,]    3.0955974  8.104122  -13.09163000  18.3077060
 [96,]   10.0324820  8.366341   -6.20669570  25.9284912
 [97,]    3.2848665  9.335335  -15.20566722  20.8672912
 [98,]   -3.4521489 10.822905  -25.27288996  16.7823356
 [99,]   16.5506356 12.647372   -8.65594308  40.1547498
[100,]    0.4338202 14.683690  -28.92852504  28.0770870
[101,]    9.5263959 13.107050  -15.08875764  36.2985756
[102,]   -7.8045898 11.278586  -29.34316584  15.0310627
[103,]  -10.7401754  9.736676  -29.30274445   8.4617568
[104,]   -6.2882611  8.636193  -23.00723695  10.5330757
[105,]  -22.0444467  8.157782  -38.18347992  -6.2439012
[106,]  -14.5248324  8.408305  -31.32413397   1.9264561
[107,]  -14.2789181  9.329222  -32.64930287   4.2497466
[108,]    0.7137963 10.749595  -20.15319991  21.8961418
[109,]   17.3479106 12.500312   -6.77295473  41.9219933
[110,]   21.1679250 14.461896   -6.68479696  49.3381722
[111,]   17.5211361 13.308640   -8.28616346  44.4231767
[112,]  -12.3467412 11.364772  -34.30052156  10.0591591
[113,]  -16.6218185  9.688069  -35.58737619   2.3051479
[114,]  -34.3246958  8.439303  -50.93421423 -17.4700008
[115,]  -37.9606731  7.826079  -53.70078528 -22.5861010
[116,]    5.8221496  7.995979  -10.11338480  21.3732389
[117,]   38.5165723  8.904289   21.12159464  55.4622661
[118,]    4.9650950 10.358549  -14.80819646  24.8678701
[119,]   19.5085177 12.164507   -4.06554229  43.0348765
[120,]   -2.9513596 14.188497  -30.91501344  24.6048059
[121,]   -5.2685178 12.350575  -30.28486869  18.2727460
[122,]   36.7682273 10.599018   15.53712167  57.3464165
[123,]   -0.8898275  9.147636  -19.20205323  16.8938295
[124,]    2.3110176  8.158240  -14.12546818  18.1572105
[125,]  -13.9450372  7.808462  -29.46192101   1.2189871
[126,]   11.3668080  8.180761   -4.67826587  27.2087261
[127,]  -13.0145469  9.187775  -30.88599935   4.8511561
[128,]  -41.6600017 10.650968  -62.59387695 -20.5613578
[129,]    5.7919434 12.410020  -18.81675112  30.2909020
[130,]   24.3212886 14.356589   -3.94630130  52.9898328
[131,]  -50.1918760 12.563957  -75.01214633 -26.3258148
[132,]   12.2667992 10.813885   -8.92219703  33.1972587
[133,]   26.8932745  9.334924    8.46703896  44.8539613
[134,]   32.8121497  8.273763   16.39962172  48.8847428
[135,]   20.6387249  7.802765    5.06141891  35.7759242
[136,]   10.6691002  8.026504   -5.00818755  26.2794141
[137,]   -1.7911246  8.892695  -19.01310221  15.1049156
[138,]   -9.8432493 10.239576  -29.98390853   9.5411772
[139,]   -8.6933741 11.905101  -31.93585795  14.1997178
[140,]   -9.8503989 13.774164  -36.54074481  16.3275121
[141,]   17.1984774 12.542265   -7.29585715  42.0050023
[142,]    2.4204309 10.766582  -18.46940134  23.3311989
[143,]  -20.0655156  9.263602  -38.22234999  -2.2068402
[144,]  -10.9427621  8.184957  -27.06645422   5.0121451
[145,]   14.9313914  7.710828   -0.14675602  29.7128803
[146,]    6.0312449  7.950118   -9.52041144  21.3520900
[147,]  -24.3384015  8.845114  -41.19161454  -7.2233462
[148,]   14.3577520 10.225061   -5.25265642  34.8997743
[149,]   -4.7765945 11.922745  -27.69753734  18.8964007
[150,]   10.1650590 13.821577  -16.29687184  37.7491314
[151,]   -0.9376777 13.262889  -25.90456775  26.2761337
[152,]   -6.8932325 11.329402  -28.36241912  16.3194372
[153,]  -17.7309874  9.676861  -36.78985222   1.6826508
[154,]  -31.3738422  8.471313  -48.13901814 -14.8856082
[155,]  -19.5245971  7.919585  -35.49858900  -3.8709750
[156,]   41.9167481  8.155471   25.52635963  57.6668978
[157,]  -36.3439068  9.118046  -54.61680245 -18.7878076
[158,]   14.8784384 10.611363   -6.10884977  35.3082899
[159,]   17.2408835 12.445822   -7.57885221  41.4483280
[160,]    9.0916287 14.492451  -20.22371283  37.2423926
[161,]   17.6788785 12.305134   -6.75458433  42.0082504
[162,]   10.7633985 10.569836  -10.18423157  31.6817129
[163,]    6.7416184  9.112387  -11.03528624  24.7828932
[164,]    1.1543383  8.084482  -14.77425952  16.9533136
[165,]  -10.9425417  7.661015  -26.12307814   4.1161298
[166,]  -15.0789218  7.939303  -31.06169263   0.4733846
[167,]  -49.8030019  8.853417  -67.51435858 -32.5678008
[168,]  -13.9160819 10.234379  -34.16145213   6.4280576
[169,]   22.7561380 11.921036   -0.68276646  46.1304987
[170,]   31.9667579 13.801766    4.75875973  59.1959449
[171,]    5.9041691 12.477108  -18.27246753  30.8313876
[172,]   -1.8285513 10.728174  -22.54148385  19.5590602
[173,]   10.4992283  9.258249   -7.80122754  28.7562497
[174,]   11.7390078  8.218432   -4.22989020  27.8916820
[175,]  -23.5150126  7.783060  -38.67941893  -8.1044289
[176,]    7.1249670  8.050802   -8.47191810  22.9813570
[177,]    0.2041465  8.958837  -17.08527752  17.8295068
[178,]   -2.8527739 10.339830  -23.15841047  17.4089933
[179,]   11.2740057 12.032015  -12.48043880  35.0073589
[180,]   -5.5391148 13.922380  -32.85533129  21.8802019</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.6  3.4
looic      1770.0 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   621       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   146       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.4 22.7
p_loo        34.4  8.8
looic      1722.8 45.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   805       
 (0.5, 0.7]   (ok)         5    2.8%   570       
   (0.7, 1]   (bad)        1    0.6%   75        
   (1, Inf)   (very bad)   2    1.1%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.6      11.8  
fit_sleep1 -91.9      21.3  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.6  3.4
looic      1770.0 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   621       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   146       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.4 22.7
p_loo        34.4  8.8
looic      1722.8 45.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   805       
 (0.5, 0.7]   (ok)         5    2.8%   570       
   (0.7, 1]   (bad)        1    0.6%   75        
   (1, Inf)   (very bad)   2    1.1%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.4     22.7        34.4    8.8   1722.8
fit_sleep2  -23.6      11.8  -885.0     14.4        19.6    3.4   1770.0
fit_sleep1  -91.9      21.3  -953.3     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   45.4  
fit_sleep2   28.8  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.184664e-40 5.654720e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.83      1.57     0.22     5.37       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.17      1.57    -3.37     2.83       5.29      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.62.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.2          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        ggridges_0.5.4       callr_3.7.3         
 [34] stringr_1.4.1        digest_0.6.30        minqa_1.2.5         
 [37] rmarkdown_2.18       base64enc_0.1-3      pkgconfig_2.0.3     
 [40] htmltools_0.5.3      highr_0.9            fastmap_1.1.0       
 [43] htmlwidgets_1.5.4    rlang_1.0.6          shiny_1.7.3         
 [46] jquerylib_0.1.4      farver_2.1.1         generics_0.1.3      
 [49] zoo_1.8-11           jsonlite_1.8.3       gtools_3.9.3        
 [52] crosstalk_1.2.0      dplyr_1.0.10         distributional_0.3.1
 [55] inline_0.3.19        magrittr_2.0.3       loo_2.5.1           
 [58] bayesplot_1.9.0      munsell_0.5.0        fansi_1.0.3         
 [61] abind_1.4-5          lifecycle_1.0.3      stringi_1.7.8       
 [64] yaml_2.3.6           MASS_7.3-58.1        plyr_1.8.8          
 [67] pkgbuild_1.3.1       grid_4.2.2           parallel_4.2.2      
 [70] promises_1.2.0.1     crayon_1.5.2         miniUI_0.1.1.1      
 [73] lattice_0.20-45      splines_4.2.2        knitr_1.40          
 [76] ps_1.7.2             pillar_1.8.1         igraph_1.3.5        
 [79] boot_1.3-28          markdown_1.3         shinystan_2.6.0     
 [82] reshape2_1.4.4       codetools_0.2-18     stats4_4.2.2        
 [85] rstantools_2.2.0     glue_1.6.2           evaluate_0.18       
 [88] V8_4.2.1             RcppParallel_5.1.5   vctrs_0.5.0         
 [91] nloptr_2.0.3         httpuv_1.6.6         gtable_0.3.1        
 [94] assertthat_0.2.1     cachem_1.0.6         ggplot2_3.4.0       
 [97] xfun_0.34            mime_0.12            xtable_1.8-4        
[100] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[103] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
