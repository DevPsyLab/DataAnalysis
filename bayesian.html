<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.76      6.87    15.24    42.33 1.00     2049     2606
sd(Days)                6.51      1.48     4.10     9.96 1.00     1488     2464
cor(Intercept,Days)     0.10      0.30    -0.47     0.69 1.00      831     1372

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.07      7.39   236.75   265.90 1.00     1758     2843
Days         10.42      1.78     6.87    13.86 1.00     1350     1617

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.95      1.54    23.21    29.20 1.00     4395     2758

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0370  12.78757 228.5173 278.2524
309 211.5640  13.36160 185.2165 237.0308
310 213.1358  13.30085 187.0108 238.9065
330 274.1680  13.36740 248.6330 301.5293
331 272.9651  13.31571 247.0618 300.9608
332 260.5610  12.44133 235.6512 285.2417
333 267.7410  12.66728 243.3381 293.8425
334 244.5067  12.48388 219.3893 268.3237
335 250.5403  13.41203 225.0069 276.8824
337 285.7158  13.17647 259.2970 311.6833
349 226.9931  12.84192 201.3850 251.5583
350 238.7158  13.12446 212.1353 263.5692
351 255.8276  12.23063 232.5995 280.0401
352 271.6898  12.60786 247.0074 296.2461
369 254.5490  12.55792 229.7518 279.7268
370 226.0639  13.55112 199.0610 251.1909
371 252.0718  12.19364 227.1510 275.4070
372 263.4835  12.30357 239.4769 287.6597

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6381525  2.489063 14.9053024 24.617951
309  1.7812606  2.516411 -3.0838020  6.689852
310  4.9021649  2.507508  0.0949546  9.790885
330  5.8515596  2.509714  0.7756671 10.686427
331  7.5620536  2.473836  2.6454456 12.324599
332 10.1742009  2.344651  5.6048576 14.880979
333 10.3054983  2.413697  5.4322093 14.861413
334 11.4571686  2.390580  6.8997557 16.260679
335 -0.1864577  2.578730 -5.1178909  4.786313
337 19.1866008  2.448737 14.3259816 23.963908
349 11.4825664  2.474224  6.7515940 16.435088
350 16.9848917  2.494066 12.2655504 22.097615
351  7.4839780  2.327644  2.8367732 11.997379
352 14.0802988  2.369707  9.4720688 18.789248
369 11.3745281  2.418807  6.5865525 16.122172
370 15.1933693  2.574473 10.3209391 20.397501
371  9.4830963  2.312286  5.0771671 14.097115
372 11.7814965  2.377708  7.2122819 16.318255</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0370 12.787573 228.5173 278.2524
  [2,] 273.6752 10.900685 252.1192 294.5301
  [3,] 293.3133  9.301544 274.7004 311.1160
  [4,] 312.9515  8.161088 296.6835 328.7368
  [5,] 332.5896  7.686278 317.2048 347.3827
  [6,] 352.2278  7.996577 336.6632 367.8181
  [7,] 371.8659  9.011242 354.2722 389.6574
  [8,] 391.5041 10.528561 371.2096 412.3819
  [9,] 411.1422 12.364852 387.4610 435.5802
 [10,] 430.7804 14.398590 403.1516 459.5347
 [11,] 211.5640 13.361600 185.2165 237.0308
 [12,] 213.3453 11.468873 190.6756 235.4235
 [13,] 215.1266  9.859128 195.6817 233.9750
 [14,] 216.9078  8.691053 199.7350 233.8907
 [15,] 218.6891  8.156657 202.8850 234.6451
 [16,] 220.4703  8.378087 203.8575 236.8774
 [17,] 222.2516  9.301519 203.8210 240.4648
 [18,] 224.0329 10.747504 202.8555 245.1290
 [19,] 225.8141 12.536509 201.3053 250.4286
 [20,] 227.5954 14.542486 198.9842 256.0754
 [21,] 213.1358 13.300847 187.0108 238.9065
 [22,] 218.0380 11.397029 195.5521 240.2621
 [23,] 222.9401  9.769709 203.5588 242.1241
 [24,] 227.8423  8.577723 211.0408 244.8767
 [25,] 232.7445  8.017646 217.0157 248.9280
 [26,] 237.6466  8.219682 221.5089 254.1284
 [27,] 242.5488  9.133394 224.5536 260.5700
 [28,] 247.4510 10.575906 226.4713 268.3374
 [29,] 252.3531 12.363490 227.8949 276.6493
 [30,] 257.2553 14.367922 228.9899 285.5113
 [31,] 274.1680 13.367404 248.6330 301.5293
 [32,] 280.0196 11.454163 257.8126 303.4467
 [33,] 285.8711  9.813539 266.8058 305.8284
 [34,] 291.7227  8.602939 274.7547 309.0640
 [35,] 297.5743  8.019533 281.8778 313.3163
 [36,] 303.4258  8.198329 287.2596 319.5417
 [37,] 309.2774  9.094483 291.4521 327.3483
 [38,] 315.1289 10.526346 294.7947 335.6894
 [39,] 320.9805 12.308357 297.3319 344.7792
 [40,] 326.8321 14.310299 299.1867 354.5738
 [41,] 272.9651 13.315708 247.0618 300.9608
 [42,] 280.5272 11.446490 258.5979 304.4041
 [43,] 288.0893  9.847635 269.1058 308.2459
 [44,] 295.6513  8.670031 278.7534 312.9784
 [45,] 303.2134  8.099548 287.3798 319.5872
 [46,] 310.7754  8.262909 294.2495 326.9020
 [47,] 318.3375  9.120766 300.2693 335.7595
 [48,] 325.8995 10.504324 304.9214 346.1195
 [49,] 333.4616 12.236543 308.8731 357.4243
 [50,] 341.0236 14.190310 312.5773 368.7977
 [51,] 260.5610 12.441327 235.6512 285.2417
 [52,] 270.7352 10.722570 249.5065 292.1665
 [53,] 280.9094  9.281981 262.9346 299.6347
 [54,] 291.0836  8.266294 274.8455 307.6487
 [55,] 301.2578  7.842374 285.8804 316.9540
 [56,] 311.4320  8.103630 295.5401 327.2285
 [57,] 321.6062  8.990527 304.0276 339.3221
 [58,] 331.7804 10.343361 311.5058 352.5648
 [59,] 341.9546 12.005641 318.5690 365.7225
 [60,] 352.1288 13.866525 325.3600 379.8569
 [61,] 267.7410 12.667278 243.3381 293.8425
 [62,] 278.0465 10.915406 257.1748 300.2085
 [63,] 288.3520  9.459604 270.3875 307.1412
 [64,] 298.6575  8.454229 282.1301 315.5899
 [65,] 308.9630  8.069433 293.1447 325.1655
 [66,] 319.2685  8.391029 302.8468 335.9478
 [67,] 329.5740  9.346381 311.3985 347.5774
 [68,] 339.8795 10.768110 318.4444 360.8384
 [69,] 350.1850 12.498057 325.1781 374.1604
 [70,] 360.4905 14.425758 331.5429 388.0680
 [71,] 244.5067 12.483885 219.3893 268.3237
 [72,] 255.9638 10.728600 234.2936 276.8612
 [73,] 267.4210  9.262186 249.3080 285.9393
 [74,] 278.8782  8.240331 262.6006 295.3236
 [75,] 290.3354  7.838863 275.3260 305.7740
 [76,] 301.7925  8.149983 285.8845 318.2191
 [77,] 313.2497  9.100902 295.5614 331.5767
 [78,] 324.7069 10.519523 304.1700 345.8333
 [79,] 336.1640 12.244347 312.5672 360.8671
 [80,] 347.6212 14.163949 320.3808 375.9545
 [81,] 250.5403 13.412035 225.0069 276.8824
 [82,] 250.3539 11.448937 228.2017 272.7412
 [83,] 250.1674  9.776162 230.8845 269.2797
 [84,] 249.9810  8.565525 232.9456 266.6610
 [85,] 249.7945  8.028872 234.0600 265.3516
 [86,] 249.6080  8.298016 233.4191 265.7100
 [87,] 249.4216  9.303281 231.4345 267.6115
 [88,] 249.2351 10.841804 227.8566 270.5076
 [89,] 249.0487 12.721560 223.9101 274.2726
 [90,] 248.8622 14.813209 219.2317 277.9249
 [91,] 285.7158 13.176465 259.2970 311.6833
 [92,] 304.9024 11.357580 282.2671 326.9379
 [93,] 324.0890  9.816448 304.8488 343.0163
 [94,] 343.2756  8.701914 326.6360 360.3973
 [95,] 362.4622  8.190029 347.2051 378.7480
 [96,] 381.6488  8.391810 365.5257 398.2016
 [97,] 400.8354  9.260724 382.4983 418.7657
 [98,] 420.0221 10.634480 397.8911 440.9597
 [99,] 439.2087 12.345686 414.0585 463.8266
[100,] 458.3953 14.273485 430.2185 486.7378
[101,] 226.9931 12.841920 201.3850 251.5583
[102,] 238.4756 11.002960 216.9554 259.4070
[103,] 249.9582  9.458274 231.3260 267.8858
[104,] 261.4408  8.372355 245.1563 277.6358
[105,] 272.9233  7.935822 257.2954 288.3261
[106,] 284.4059  8.252381 268.1844 300.9538
[107,] 295.8885  9.244993 277.2883 314.2697
[108,] 307.3710 10.727607 285.6625 328.4535
[109,] 318.8536 12.527442 293.8743 343.4140
[110,] 330.3362 14.527065 301.5654 358.8298
[111,] 238.7158 13.124462 212.1353 263.5692
[112,] 255.7007 11.257939 233.0125 276.7913
[113,] 272.6856  9.678408 252.9148 291.0860
[114,] 289.6705  8.546503 272.5704 306.2471
[115,] 306.6554  8.053234 290.5451 322.6657
[116,] 323.6402  8.313073 306.9920 340.3763
[117,] 340.6251  9.262856 322.3278 358.9191
[118,] 357.6100 10.720754 336.6550 378.9088
[119,] 374.5949 12.510370 349.7943 399.0174
[120,] 391.5798 14.509475 363.0439 420.0823
[121,] 255.8276 12.230629 232.5995 280.0401
[122,] 263.3116 10.543556 243.1862 284.1659
[123,] 270.7955  9.142249 253.1423 288.6168
[124,] 278.2795  8.175006 262.1351 294.2993
[125,] 285.7635  7.804908 270.3365 300.8047
[126,] 293.2475  8.114081 277.0009 309.0717
[127,] 300.7315  9.033044 282.5771 318.0262
[128,] 308.2154 10.401410 287.3467 328.4679
[129,] 315.6994 12.067254 291.9818 339.3428
[130,] 323.1834 13.924215 296.0270 350.2101
[131,] 271.6898 12.607860 247.0074 296.2461
[132,] 285.7701 10.873467 264.5392 306.9261
[133,] 299.8504  9.420055 281.3894 317.9707
[134,] 313.9307  8.394857 297.4490 329.9097
[135,] 328.0110  7.964975 312.3695 342.9339
[136,] 342.0913  8.224297 326.0100 357.6775
[137,] 356.1716  9.114181 338.0679 373.5994
[138,] 370.2519 10.475141 349.9258 390.2960
[139,] 384.3322 12.149892 360.7874 407.6303
[140,] 398.4124 14.026481 371.2416 425.6841
[141,] 254.5490 12.557921 229.7518 279.7268
[142,] 265.9236 10.774880 244.9450 287.4374
[143,] 277.2981  9.284177 259.7728 295.3317
[144,] 288.6726  8.245915 272.8700 304.6441
[145,] 300.0472  7.841908 285.1585 315.5840
[146,] 311.4217  8.166835 296.0032 327.3663
[147,] 322.7962  9.143310 305.4223 340.6425
[148,] 334.1707 10.592652 313.7829 354.9088
[149,] 345.5453 12.349482 321.6784 369.5576
[150,] 356.9198 14.300923 329.2582 384.9596
[151,] 226.0639 13.551123 199.0610 251.1909
[152,] 241.2573 11.550334 218.0994 263.0418
[153,] 256.4506  9.820556 236.9280 275.1273
[154,] 271.6440  8.528319 254.6887 287.9598
[155,] 286.8374  7.891575 271.2214 301.9125
[156,] 302.0307  8.067063 285.9812 317.4216
[157,] 317.2241  9.007434 299.3483 334.7721
[158,] 332.4175 10.509332 311.8906 352.8974
[159,] 347.6108 12.369885 323.7675 371.8444
[160,] 362.8042 14.451224 335.1033 391.5318
[161,] 252.0718 12.193639 227.1510 275.4070
[162,] 261.5549 10.519451 240.3816 281.8694
[163,] 271.0380  9.128318 252.7250 288.4671
[164,] 280.5211  8.166201 263.8763 296.1890
[165,] 290.0042  7.793641 274.7872 305.3702
[166,] 299.4873  8.092475 283.7198 315.4104
[167,] 308.9704  8.996044 291.5942 327.1295
[168,] 318.4535 10.347115 298.4290 339.0291
[169,] 327.9366 11.995420 304.7403 351.8499
[170,] 337.4197 13.835127 310.6423 365.0372
[171,] 263.4835 12.303572 239.4769 287.6597
[172,] 275.2650 10.586554 254.2227 295.9806
[173,] 287.0465  9.169480 268.7849 305.3215
[174,] 298.8280  8.209177 282.8916 315.2977
[175,] 310.6095  7.874567 295.3419 326.0036
[176,] 322.3910  8.242208 306.3040 338.5977
[177,] 334.1725  9.228552 316.3919 352.1873
[178,] 345.9540 10.663271 325.0800 366.8594
[179,] 357.7355 12.391590 333.2167 381.8898
[180,] 369.5170 14.307503 340.9323 397.2547</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.4770166 12.787573  -28.6924116  21.0427100
  [2,]  -14.9704691 10.900685  -35.8254385   6.5854546
  [3,]  -42.5127217  9.301544  -60.3154234 -23.8998231
  [4,]    8.4883258  8.161088   -7.2970181  24.7562728
  [5,]   24.2622732  7.686278    9.4692072  39.6470819
  [6,]   62.4623207  7.996577   46.8720112  78.0268933
  [7,]   10.3378681  9.011242   -7.4536496  27.9315843
  [8,] -101.3554844 10.528561 -122.2332647 -81.0609780
  [9,]   19.4430630 12.364852   -4.9949037  43.1242814
 [10,]   35.5731105 14.398590    6.8188281  63.2019294
 [11,]   11.1698618 13.361600  -14.2968727  37.5174205
 [12,]   -8.0794988 11.468873  -30.1576990  14.5901811
 [13,]  -12.1487594  9.859128  -30.9971500   7.2961257
 [14,]  -12.2008200  8.691053  -29.1836808   4.9719640
 [15,]  -10.9729805  8.156657  -26.9290049   4.8311088
 [16,]   -4.5085411  8.378087  -20.9156338  12.1042545
 [17,]   -8.6213017  9.301519  -26.8345161   9.8092975
 [18,]   -6.3056623 10.747504  -27.4017585  14.8717434
 [19,]   -1.5184229 12.536509  -26.1329207  22.9904335
 [20,]    9.7188165 14.542486  -18.7612191  38.3299819
 [21,]  -14.0818978 13.300847  -39.8526159  12.0431457
 [22,]  -23.7057628 11.397029  -45.9298588  -1.2198609
 [23,]   11.3798723  9.769709   -7.8041144  30.7611968
 [24,]    4.9993073  8.577723  -12.0350852  21.8007761
 [25,]   -3.4370576  8.017646  -19.6206268  12.2917204
 [26,]  -17.1887225  8.219682  -33.6705430  -1.0509782
 [27,]   -7.1279875  9.133394  -25.1491716  10.8672031
 [28,]    8.3001476 10.575906  -12.5862858  29.2798002
 [29,]    8.6593826 12.363490  -15.6367699  33.1175692
 [30,]   -9.7399823 14.367922  -37.9960474  18.5253603
 [31,]   47.3745752 13.367404   20.0133471  72.9096440
 [32,]   20.3806156 11.454163   -3.0465124  42.5876247
 [33,]   -2.0146440  9.813539  -21.9718936  17.0507414
 [34,]   -6.5897036  8.602939  -23.9309582  10.3782516
 [35,]  -11.7769632  8.019533  -27.5190309   3.9195060
 [36,]   -5.8403227  8.198329  -21.9562339  10.3259270
 [37,]  -29.0377823  9.094483  -47.1087274 -11.2124878
 [38,]    3.1323581 10.526346  -17.4281033  23.4665647
 [39,]  -15.6310015 12.308357  -39.4296935   8.0175967
 [40,]   27.2166389 14.310299   -0.5251489  54.8620371
 [41,]   14.6427527 13.315708  -13.3529160  40.5460913
 [42,]    4.4727991 11.446490  -19.4041112  26.4021200
 [43,]   13.7313455  9.847635   -6.4253024  32.7148084
 [44,]   24.4639918  8.670031    7.1368574  41.3618916
 [45,]   13.0639382  8.099548   -3.3099165  28.8975252
 [46,]  -17.4567155  8.262909  -33.5832718  -0.9307694
 [47,]  -28.2624691  9.120766  -45.6844943 -10.1942892
 [48,]    8.9181773 10.504324  -11.3017773  29.8963208
 [49,]  -39.7146764 12.236543  -63.6773886 -15.1262024
 [50,]   30.5574700 14.190310    2.7833841  59.0038188
 [51,]  -25.7003689 12.441327  -50.3811348  -0.7905591
 [52,]  -27.9233698 10.722570  -49.3546817  -6.6946713
 [53,]   -7.9480706  9.281981  -26.6733980  10.0267077
 [54,]   18.6852285  8.266294    2.1201348  34.9232762
 [55,]   16.2051276  7.842374    0.5089181  31.5825489
 [56,]   -1.4343732  8.103630  -17.2309047  14.4575497
 [57,]  132.5557259  8.990527  114.8397932 150.1342710
 [58,]   15.0507251 10.343361   -5.7337050  35.3252679
 [59,]  -11.6542758 12.005641  -35.4221636  11.7312807
 [60,]  -98.2643767 13.866525 -125.9924771 -71.4955749
 [61,]   16.1013901 12.667278  -10.0000754  40.5042782
 [62,]   11.5084918 10.915406  -10.6535423  32.3802362
 [63,]  -11.5827065  9.459604  -30.3718914   6.3818074
 [64,]    1.1521952  8.454229  -15.7802141  17.6795727
 [65,]  -11.7920030  8.069433  -27.9944682   4.0263426
 [66,]   18.8979987  8.391029    2.2187372  35.3197437
 [67,]    2.4525004  9.346381  -15.5509499  20.6280257
 [68,]    8.9604021 10.768110  -11.9984998  30.3955189
 [69,]  -16.8249962 12.498057  -40.8003687   8.1818916
 [70,]    1.5523055 14.425758  -26.0251704  30.4998520
 [71,]   20.9664209 12.483885   -2.8506381  46.0837717
 [72,]   20.2373522 10.728600   -0.6599990  41.9075709
 [73,]  -24.0563164  9.262186  -42.5746444  -5.9432674
 [74,]  -24.2058851  8.240331  -40.6513476  -7.9283296
 [75,]  -11.3109537  7.838863  -26.7496098   3.6983780
 [76,]  -17.6013224  8.149983  -34.0278776  -1.6932748
 [77,]   -7.7248910  9.100902  -26.0519056   9.9633949
 [78,]    6.8160404 10.519523  -14.3104323  27.3528761
 [79,]   -0.4171283 12.244347  -25.1202372  23.1797451
 [80,]   29.6778031 14.163949    1.3444834  56.9182450
 [81,]   -8.9320270 13.412035  -35.2740836  16.6014216
 [82,]   23.5933308 11.448937    1.2059699  45.7454916
 [83,]    4.3232885  9.776162  -14.7889513  23.6061564
 [84,]   20.8211462  8.565525    4.1411247  37.8565249
 [85,]    1.6574039  8.028872  -13.8997100  17.3919460
 [86,]    5.0281616  8.298016  -11.0737664  21.2170899
 [87,]   -3.9692806  9.303281  -22.1591730  14.0178112
 [88,]  -13.9241229 10.841804  -35.1965668   7.4543809
 [89,]  -13.2945652 12.721560  -38.5184506  11.8439985
 [90,]  -11.6156075 14.813209  -40.6783305  18.0149103
 [91,]   26.6507549 13.176465    0.6833247  53.0696358
 [92,]    8.9033541 11.357580  -13.1320513  31.5387488
 [93,]  -32.4778466  9.816448  -51.4051352 -13.2375999
 [94,]    2.8465526  8.701914  -14.2750690  19.4862457
 [95,]    3.2701519  8.190029  -13.0155878  18.5272949
 [96,]   10.1896511  8.391810   -6.3630621  26.3127662
 [97,]    3.4246504  9.260724  -14.5056436  21.7618243
 [98,]   -3.3297504 10.634480  -24.2674425  18.8011943
 [99,]   16.6556488 12.345686   -7.9623026  41.8058426
[100,]    0.5214481 14.273485  -27.8211039  28.6981883
[101,]    9.1101474 12.841920  -15.4550721  34.7181977
[102,]   -8.1589190 11.002960  -29.0902836  13.3613422
[103,]  -11.0325854  9.458274  -28.9601809   7.5995789
[104,]   -6.5187518  8.372355  -22.7138191   9.7656601
[105,]  -22.2130182  7.935822  -37.6157530  -6.5850763
[106,]  -14.6314846  8.252381  -31.1794338   1.5900058
[107,]  -14.3236510  9.244993  -32.7049225   4.2765082
[108,]    0.7309826 10.727607  -20.3514863  22.4394513
[109,]   17.4270162 12.527442   -7.1333614  42.4062615
[110,]   21.3089498 14.527065   -7.1847152  50.0796594
[111,]   17.5810107 13.124462   -7.2723791  44.1615397
[112,]  -12.2463810 11.257939  -33.3370483  10.4417542
[113,]  -16.4809727  9.678408  -34.8813535   3.2898421
[114,]  -34.1433643  8.546503  -50.7199637 -17.0433112
[115,]  -37.7388560  8.053234  -53.7492086 -21.6285863
[116,]    6.0844523  8.313073  -10.6515759  22.7326507
[117,]   38.8193606  9.262856   20.5253787  57.1167001
[118,]    5.3083690 10.720754  -15.9904329  26.2634492
[119,]   19.8922773 12.510370   -4.5301712  44.6928805
[120,]   -2.5271144 14.509475  -31.0296335  26.0087577
[121,]   -5.3010898 12.230629  -29.5136456  17.9269610
[122,]   36.7460322 10.543556   15.8917449  56.8714410
[123,]   -0.9016458  9.142249  -18.7228732  16.7515936
[124,]    2.3095761  8.175006  -13.7102111  18.4540282
[125,]  -13.9361019  7.804908  -28.9773408   1.4908842
[126,]   11.3861201  8.114081   -4.4380517  27.6326529
[127,]  -12.9848579  9.033044  -30.2796301   5.1695095
[128,]  -41.6199360 10.401410  -61.8724141 -20.7512039
[129,]    5.8423860 12.067254  -17.8010062  29.5599817
[130,]   24.3821080 13.924215   -2.6445543  51.5384712
[131,]  -50.0126594 12.607860  -74.5689720 -25.3302625
[132,]   12.4238418 10.873467   -8.7322255  33.6547106
[133,]   27.0281429  9.420055    8.9078498  45.4890886
[134,]   32.9248441  8.394857   16.9458258  49.4064899
[135,]   20.7292453  7.964975    5.8062764  36.3707479
[136,]   10.7374464  8.224297   -4.8487901  26.8187491
[137,]   -1.7449524  9.114181  -19.1728465  16.3586569
[138,]   -9.8192512 10.475141  -29.8634056  10.5067853
[139,]   -8.6915501 12.149892  -31.9896625  14.8531657
[140,]   -9.8707489 14.026481  -37.1424350  17.3000782
[141,]   17.3744547 12.557921   -7.8033451  42.1717172
[142,]    2.5133266 10.774880  -19.0004966  23.4918906
[143,]  -20.0557016  9.284177  -38.0892820  -2.5303792
[144,]  -11.0160297  8.245915  -26.9874904   4.7866389
[145,]   14.7750422  7.841908   -0.7618229  29.6636952
[146,]    5.7918141  8.166835  -10.1527663  21.2102925
[147,]  -24.6609140  9.143310  -42.5071934  -7.2869801
[148,]   13.9521578 10.592652   -6.7858563  34.3399573
[149,]   -5.2652703 12.349482  -29.2775550  18.6016194
[150,]    9.5933016 14.300923  -18.4464731  37.2548734
[151,]   -0.7998820 13.551123  -25.9269061  26.2029959
[152,]   -6.7337514 11.550334  -28.5182941  16.4241469
[153,]  -17.5498207  9.820556  -36.2265137   1.9728365
[154,]  -31.1709900  8.528319  -47.4867823 -14.2157018
[155,]  -19.3000593  7.891575  -34.3751694  -3.6841201
[156,]   42.1629713  8.067063   26.7721271  58.2125241
[157,]  -36.0759980  9.007434  -53.6240256 -18.2001616
[158,]   15.1680327 10.509332   -5.3118516  35.6948643
[159,]   17.5521634 12.369885   -6.6813831  41.3954900
[160,]    9.4245940 14.451224  -19.3029703  37.1255161
[161,]   17.8085636 12.193639   -5.5265877  42.7293885
[162,]   10.8878673 10.519451   -9.4265944  32.0611636
[163,]    6.8608710  9.128318  -10.5681888  25.1739270
[164,]    1.2683746  8.166201  -14.3994942  17.9131634
[165,]  -10.8337217  7.793641  -26.1997259   4.3833124
[166,]  -14.9753180  8.092475  -30.8984127   0.7921812
[167,]  -49.7046144  8.996044  -67.8636897 -32.3283978
[168,]  -13.8229107 10.347115  -34.3985272   6.2015828
[169,]   22.8440930 11.995420   -1.0692383  46.0403779
[170,]   32.0494966 13.835127    4.4319724  58.8268765
[171,]    5.9281758 12.303572  -18.2480288  29.9347682
[172,]   -1.7910208 10.586554  -22.5066359  19.2513172
[173,]   10.5502827  9.169480   -7.7247207  28.8118586
[174,]   11.8035862  8.209177   -4.6660750  27.7400021
[175,]  -23.4369104  7.874567  -38.8310230  -8.1693331
[176,]    7.2165931  8.242208   -8.9901107  23.3036433
[177,]    0.3092965  9.228552  -17.7055124  18.0899036
[178,]   -2.7341000 10.663271  -23.6394516  18.1399164
[179,]   11.4062035 12.391590  -12.7480800  35.9250027
[180,]   -5.3933931 14.307503  -33.1311116  23.1913245</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 5 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.3 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   504       
 (0.5, 0.7]   (ok)         1    0.6%   2021      
   (0.7, 1]   (bad)        1    0.6%   99        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.9 22.6
p_loo        34.5  8.7
looic      1723.8 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   1060      
 (0.5, 0.7]   (ok)         5    2.8%   617       
   (0.7, 1]   (bad)        2    1.1%   195       
   (1, Inf)   (very bad)   3    1.7%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.3      11.9  
fit_sleep1 -91.5      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 5 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.3 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   504       
 (0.5, 0.7]   (ok)         1    0.6%   2021      
   (0.7, 1]   (bad)        1    0.6%   99        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.9 22.6
p_loo        34.5  8.7
looic      1723.8 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   1060      
 (0.5, 0.7]   (ok)         5    2.8%   617       
   (0.7, 1]   (bad)        2    1.1%   195       
   (1, Inf)   (very bad)   3    1.7%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.9     22.6        34.5    8.7   1723.8
fit_sleep2  -23.3      11.9  -885.1     14.4        19.6    3.4   1770.3
fit_sleep1  -91.5      21.2  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   45.1  
fit_sleep2   28.8  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.827657e-40 7.851273e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.87      1.55     0.27     5.32       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.13      1.55    -3.34     2.83       5.55      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.1-0     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_5.0.0           compiler_4.2.2      
 [22] cli_3.6.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.5          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.20      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.1   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.4          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.12       yaml_2.3.7          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.42           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.20        V8_4.2.2            
 [88] RcppParallel_5.1.6   vctrs_0.5.2          nloptr_2.0.3        
 [91] httpuv_1.6.8         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
