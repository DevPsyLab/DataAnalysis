<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.98      6.96    15.84    42.98 1.00     1874     2401
sd(Days)                6.52      1.52     4.22     9.99 1.00     1552     2028
cor(Intercept,Days)     0.09      0.30    -0.49     0.67 1.00     1187     2154

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.17      7.22   236.76   265.46 1.00     1940     2422
Days         10.49      1.62     7.37    13.64 1.00     1692     2314

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.58    23.11    29.21 1.00     3490     3042

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7596  12.81395 229.2770 278.3486
309 210.9536  13.32145 183.7366 236.7873
310 212.8600  13.57666 186.0189 239.3531
330 274.5962  13.37583 249.2701 301.7176
331 273.0875  13.10640 248.1934 298.8933
332 260.0066  11.93644 236.9607 283.9889
333 267.7996  12.30414 244.2954 292.9401
334 244.3151  12.53198 219.4740 268.9969
335 250.6642  13.20457 224.9025 276.8276
337 285.9876  12.84867 262.2330 312.1634
349 226.8440  13.29947 200.7415 252.0495
350 238.6141  13.10507 212.6041 263.3661
351 255.8291  12.67772 231.4915 281.0445
352 272.0969  12.52166 247.4014 296.5883
369 254.7049  12.01823 231.2294 278.2738
370 226.2771  13.49390 199.7509 251.5445
371 252.0350  11.95629 228.4654 276.1488
372 263.7340  12.52919 239.6814 288.4454

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6566126  2.486178 14.8945694 24.558214
309  1.8458743  2.508562 -3.0617196  6.833537
310  4.9405911  2.522572  0.1741031  9.905768
330  5.7198126  2.541397  0.5729838 10.445040
331  7.4708717  2.513027  2.3966831 12.315541
332 10.2777242  2.284374  5.6700838 14.557414
333 10.3355119  2.365857  5.6495326 14.993719
334 11.5182969  2.381493  7.0542675 16.316745
335 -0.2325757  2.565440 -5.3699026  4.708065
337 19.1280591  2.415419 14.3305964 23.735501
349 11.5398010  2.501224  6.7217180 16.628943
350 16.9888388  2.517877 12.1766459 22.039104
351  7.4696925  2.424758  2.6307149 12.181972
352 14.0252157  2.410001  9.3056091 18.732297
369 11.3302378  2.343187  6.7740800 15.943305
370 15.2037854  2.528188 10.4455088 20.196590
371  9.5019274  2.331951  4.8861439 14.020650
372 11.7869892  2.372811  7.2141182 16.402790</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7596 12.813954 229.2770 278.3486
  [2,] 273.4162 10.961366 252.3296 294.4516
  [3,] 293.0729  9.405735 274.9879 311.1612
  [4,] 312.7295  8.315427 296.5496 329.1854
  [5,] 332.3861  7.885871 316.8782 347.7759
  [6,] 352.0427  8.221300 335.9834 368.0810
  [7,] 371.6993  9.238763 353.4149 389.6211
  [8,] 391.3559 10.746249 369.9838 412.6058
  [9,] 411.0125 12.568658 386.0395 435.4367
 [10,] 430.6691 14.588441 401.5266 459.1648
 [11,] 210.9536 13.321454 183.7366 236.7873
 [12,] 212.7994 11.396229 190.0809 234.8610
 [13,] 214.6453  9.740261 195.6872 233.4780
 [14,] 216.4912  8.512174 199.7260 233.1603
 [15,] 218.3371  7.913740 203.1073 234.0545
 [16,] 220.1829  8.085990 204.5483 236.4273
 [17,] 222.0288  8.984706 205.0133 240.1079
 [18,] 223.8747 10.423647 203.8643 244.3054
 [19,] 225.7206 12.213339 202.0570 249.0614
 [20,] 227.5664 14.221977 200.1714 255.4711
 [21,] 212.8600 13.576662 186.0189 239.3531
 [22,] 217.8006 11.634371 195.1284 240.7546
 [23,] 222.7412  9.955811 203.3350 242.1153
 [24,] 227.6818  8.695085 211.1676 244.4673
 [25,] 232.6224  8.050937 217.4576 248.1934
 [26,] 237.5630  8.170520 221.6621 253.3181
 [27,] 242.5036  9.023522 224.7509 260.0514
 [28,] 247.4441 10.431551 227.2664 267.5279
 [29,] 252.3847 12.203987 228.5802 276.2115
 [30,] 257.3253 14.205072 229.7317 284.8585
 [31,] 274.5962 13.375831 249.2701 301.7176
 [32,] 280.3160 11.429988 258.5927 303.1146
 [33,] 286.0358  9.761853 267.4345 305.2303
 [34,] 291.7556  8.535827 275.2329 308.4906
 [35,] 297.4755  7.958913 282.1355 313.1241
 [36,] 303.1953  8.169801 287.1601 319.2429
 [37,] 308.9151  9.113967 291.3855 327.2336
 [38,] 314.6349 10.597195 294.5921 335.4913
 [39,] 320.3547 12.427956 296.4191 345.1812
 [40,] 326.0745 14.474979 297.5000 354.3380
 [41,] 273.0875 13.106402 248.1934 298.8933
 [42,] 280.5583 11.218713 259.1598 302.8349
 [43,] 288.0292  9.621428 269.3888 306.9501
 [44,] 295.5001  8.480262 278.8782 312.5737
 [45,] 302.9709  7.993023 287.6191 319.0000
 [46,] 310.4418  8.276026 294.3046 327.0314
 [47,] 317.9127  9.258910 299.8566 336.4288
 [48,] 325.3836 10.751410 303.9744 346.2084
 [49,] 332.8544 12.573339 308.1619 356.9960
 [50,] 340.3253 14.601900 311.7516 368.2837
 [51,] 260.0066 11.936438 236.9607 283.9889
 [52,] 270.2844 10.263425 250.4515 290.6760
 [53,] 280.5621  8.867580 263.2082 298.2834
 [54,] 290.8398  7.897265 275.2934 306.4059
 [55,] 301.1175  7.519065 286.6612 316.0793
 [56,] 311.3952  7.819375 296.1827 326.7896
 [57,] 321.6730  8.728438 304.5295 338.5460
 [58,] 331.9507 10.082925 312.3696 351.6451
 [59,] 342.2284 11.729529 318.9005 364.9917
 [60,] 352.5061 13.562266 325.2352 378.4957
 [61,] 267.7996 12.304142 244.2954 292.9401
 [62,] 278.1351 10.559090 258.0144 299.6539
 [63,] 288.4706  9.098979 270.8798 306.7926
 [64,] 298.8061  8.079790 283.1395 315.0435
 [65,] 309.1416  7.679138 294.1320 324.4335
 [66,] 319.4771  7.990612 303.5456 335.0461
 [67,] 329.8126  8.940087 312.2721 347.1038
 [68,] 340.1481 10.353502 319.7074 360.1184
 [69,] 350.4836 12.068944 326.5480 373.6758
 [70,] 360.8192 13.975635 333.2693 388.0690
 [71,] 244.3151 12.531978 219.4740 268.9969
 [72,] 255.8334 10.769491 234.5588 277.2734
 [73,] 267.3517  9.287432 249.1701 285.8730
 [74,] 278.8700  8.238561 262.5981 295.2658
 [75,] 290.3883  7.799641 275.2008 305.8960
 [76,] 301.9066  8.070807 286.3594 317.7829
 [77,] 313.4249  8.988018 296.1383 330.7214
 [78,] 324.9432 10.381427 304.4667 344.7908
 [79,] 336.4615 12.087457 312.5528 359.6821
 [80,] 347.9798 13.992219 320.3616 374.9143
 [81,] 250.6642 13.204567 224.9025 276.8276
 [82,] 250.4316 11.266132 228.6111 272.4490
 [83,] 250.1990  9.625686 231.4934 268.8177
 [84,] 249.9664  8.458423 233.2379 266.6437
 [85,] 249.7339  7.974895 233.9745 265.9985
 [86,] 249.5013  8.295538 233.2462 265.6393
 [87,] 249.2687  9.337875 231.2732 267.5909
 [88,] 249.0361 10.896735 227.9846 270.0836
 [89,] 248.8036 12.784550 223.9183 273.8164
 [90,] 248.5710 14.876611 219.4193 277.2858
 [91,] 285.9876 12.848669 262.2330 312.1634
 [92,] 305.1157 11.070332 284.6868 327.6969
 [93,] 324.2438  9.575212 306.3022 343.6479
 [94,] 343.3718  8.513849 327.1456 360.0643
 [95,] 362.4999  8.059471 346.5313 378.3550
 [96,] 381.6279  8.312221 364.7620 398.1930
 [97,] 400.7560  9.214090 382.2752 418.6155
 [98,] 419.8840 10.600679 398.9783 440.7368
 [99,] 439.0121 12.309258 414.9361 462.8540
[100,] 458.1402 14.224267 429.9492 485.6855
[101,] 226.8440 13.299472 200.7415 252.0495
[102,] 238.3838 11.399304 215.5679 259.9670
[103,] 249.9236  9.773666 230.5113 268.4374
[104,] 261.4634  8.580047 244.2852 277.5517
[105,] 273.0032  8.013870 257.0647 288.3176
[106,] 284.5430  8.206051 268.5138 300.4721
[107,] 296.0828  9.108714 277.9834 314.2026
[108,] 307.6226 10.540888 286.7755 328.6886
[109,] 319.1624 12.319262 294.8646 343.3159
[110,] 330.7022 14.315389 302.7091 359.0676
[111,] 238.6141 13.105072 212.6041 263.3661
[112,] 255.6029 11.174696 233.4851 276.7750
[113,] 272.5918  9.522822 253.7085 290.8501
[114,] 289.5806  8.317082 273.5967 305.7030
[115,] 306.5694  7.768075 291.5396 321.6596
[116,] 323.5583  8.011961 307.8702 339.2799
[117,] 340.5471  8.984401 323.1233 358.1280
[118,] 357.5360 10.484599 336.9179 378.1615
[119,] 374.5248 12.321265 350.4445 398.8034
[120,] 391.5136 14.365922 363.5058 419.8732
[121,] 255.8291 12.677717 231.4915 281.0445
[122,] 263.2988 10.888748 242.4256 285.2777
[123,] 270.7685  9.389572 252.8109 289.8784
[124,] 278.2382  8.337996 262.1038 294.8501
[125,] 285.7078  7.914494 270.0879 300.9822
[126,] 293.1775  8.216759 276.9036 308.8854
[127,] 300.6472  9.173329 282.2111 318.2022
[128,] 308.1169 10.608661 286.8996 328.4077
[129,] 315.5866 12.357035 290.9800 339.2374
[130,] 323.0563 14.304120 294.5161 350.7324
[131,] 272.0969 12.521661 247.4014 296.5883
[132,] 286.1221 10.755839 264.9985 307.6270
[133,] 300.1473  9.284416 281.6791 318.7520
[134,] 314.1725  8.266128 297.9725 330.6548
[135,] 328.1978  7.878679 312.5088 343.7335
[136,] 342.2230  8.211852 325.8272 358.6727
[137,] 356.2482  9.187582 337.9279 374.4090
[138,] 370.2734 10.630381 348.5461 391.2983
[139,] 384.2986 12.377987 359.1638 408.3221
[140,] 398.3238 14.319230 369.5229 425.8407
[141,] 254.7049 12.018226 231.2294 278.2738
[142,] 266.0351 10.331801 246.0940 286.3033
[143,] 277.3654  8.946257 260.3066 295.2352
[144,] 288.6956  8.019100 273.3275 304.7978
[145,] 300.0259  7.717348 284.7486 315.7216
[146,] 311.3561  8.111103 295.4067 327.6082
[147,] 322.6863  9.110630 305.0636 340.4854
[148,] 334.0166 10.545057 313.7417 354.4806
[149,] 345.3468 12.262704 321.8569 369.7411
[150,] 356.6770 14.160884 329.7292 384.7908
[151,] 226.2771 13.493898 199.7509 251.5445
[152,] 241.4808 11.550767 218.3845 262.8598
[153,] 256.6846  9.876164 237.0138 275.4076
[154,] 271.8884  8.627889 254.9713 288.4011
[155,] 287.0922  8.007859 271.1546 302.6847
[156,] 302.2960  8.160553 286.4181 318.3988
[157,] 317.4998  9.046928 299.5243 335.0778
[158,] 332.7036 10.482493 312.0374 353.0301
[159,] 347.9073 12.276069 324.2789 372.0777
[160,] 363.1111 14.293515 335.3659 391.1513
[161,] 252.0350 11.956291 228.4654 276.1488
[162,] 261.5370 10.311327 240.9765 282.1454
[163,] 271.0389  8.976082 253.4135 288.1090
[164,] 280.5408  8.105098 264.6546 295.9610
[165,] 290.0428  7.854373 275.1602 305.1285
[166,] 299.5447  8.280442 283.6454 315.7465
[167,] 309.0466  9.290655 291.4456 327.0984
[168,] 318.5485 10.721138 297.9134 339.3071
[169,] 328.0505 12.427604 303.7424 351.9068
[170,] 337.5524 14.311669 309.5007 364.9530
[171,] 263.7340 12.529194 239.6814 288.4454
[172,] 275.5210 10.790626 255.0258 296.7873
[173,] 287.3080  9.335684 269.2288 306.1230
[174,] 299.0950  8.314616 283.0591 315.5576
[175,] 310.8820  7.897540 295.5935 326.7427
[176,] 322.6690  8.177403 306.6771 338.7835
[177,] 334.4560  9.090058 316.8516 352.3264
[178,] 346.2429 10.471335 326.0246 367.1497
[179,] 358.0299 12.162608 334.6311 382.6408
[180,] 369.8169 14.052390 342.8870 398.2281</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.19963039 12.813954  -28.7885939  20.2830114
  [2,]  -14.71154298 10.961366  -35.7469277   6.3751064
  [3,]  -42.27225556  9.405735  -60.3605530 -24.1873473
  [4,]    8.71033186  8.315427   -7.7455649  24.8902442
  [5,]   24.46581928  7.885871    9.0760334  39.9737387
  [6,]   62.64740670  8.221300   46.6090806  78.7066894
  [7,]   10.50449412  9.238763   -7.4173038  28.7889373
  [8,] -101.20731846 10.746249 -122.4572306 -79.8351731
  [9,]   19.57276896 12.568658   -4.8513514  44.5457808
 [10,]   35.68435638 14.588441    7.1886804  64.8268808
 [11,]   11.78032580 13.321454  -14.0534265  38.9972534
 [12,]   -7.53364851 11.396229  -29.5951502  15.1849123
 [13,]  -11.66752282  9.740261  -30.5001647   7.2905841
 [14,]  -11.78419713  8.512174  -28.4533256   4.9810011
 [15,]  -10.62097144  7.913740  -26.3383728   4.6087726
 [16,]   -4.22114576  8.085990  -20.4654503  11.4135272
 [17,]   -8.39852007  8.984706  -26.4776398   8.6170048
 [18,]   -6.14749438 10.423647  -26.5782252  13.8629366
 [19,]   -1.42486869 12.213339  -24.7657147  22.2386583
 [20,]    9.74775700 14.221977  -18.1568919  37.1427566
 [21,]  -13.80610465 13.576662  -40.2992110  13.0350245
 [22,]  -23.46839573 11.634371  -46.4224167  -0.7961843
 [23,]   11.57881319  9.955811   -7.7952868  30.9849828
 [24,]    5.15982212  8.695085  -11.6256691  21.6739527
 [25,]   -3.31496896  8.050937  -18.8859585  11.8497591
 [26,]  -17.10506003  8.170520  -32.8602429  -1.2042469
 [27,]   -7.08275111  9.023522  -24.6306380  10.6699131
 [28,]    8.30695781 10.431551  -11.7767646  28.4847423
 [29,]    8.62776674 12.203987  -15.1990265  32.4323025
 [30,]   -9.81002434 14.205072  -37.3431916  17.7835814
 [31,]   46.94639470 13.375831   19.8249854  72.2725386
 [32,]   20.08418213 11.429988   -2.7143500  41.8074808
 [33,]   -2.17933044  9.761853  -21.3737775  16.4219992
 [34,]   -6.62264301  8.535827  -23.3575609   9.9000801
 [35,]  -11.67815558  7.958913  -27.3268424   3.6617583
 [36,]   -5.60976815  8.169801  -21.6574090  10.4254138
 [37,]  -28.67548072  9.113967  -46.9940127 -11.1458598
 [38,]    3.62640671 10.597195  -17.2300371  23.6692463
 [39,]  -15.00520586 12.427956  -39.8316831   8.9304152
 [40,]   27.97418157 14.474979   -0.2892823  56.5487286
 [41,]   14.52043843 13.106402  -11.2854296  39.4145074
 [42,]    4.44166677 11.218713  -17.8348936  25.8402334
 [43,]   13.79139510  9.621428   -5.1294698  32.4318240
 [44,]   24.61522344  8.480262    7.5415964  41.2371442
 [45,]   13.30635177  7.993023   -2.7227086  28.6581982
 [46,]  -17.12311989  8.276026  -33.7126533  -0.9859236
 [47,]  -27.83769156  9.258910  -46.3537596  -9.7816073
 [48,]    9.43413678 10.751410  -11.3906930  30.8433241
 [49,]  -39.10753489 12.573339  -63.2490520 -14.4150100
 [50,]   31.25579345 14.601900    3.2974129  59.8295032
 [51,]  -25.14602706 11.936438  -49.1282980  -2.1001225
 [52,]  -27.47255128 10.263425  -47.8641938  -7.6397040
 [53,]   -7.60077551  8.867580  -25.3220770   9.7530915
 [54,]   18.92900027  7.897265    3.3628988  34.4753794
 [55,]   16.34537604  7.519065    1.3835868  30.8017352
 [56,]   -1.39764819  7.819375  -16.7920322  13.8148678
 [57,]  132.48892759  8.728438  115.6158933 149.6324117
 [58,]   14.88040336 10.082925   -4.8140288  34.4615133
 [59,]  -11.92812086 11.729529  -34.6914274  11.3997521
 [60,]  -98.64174509 13.562266 -124.6312954 -71.3707736
 [61,]   16.04284888 12.304142   -9.0977240  39.5470114
 [62,]   11.41993699 10.559090  -10.0988793  31.5405650
 [63,]  -11.70127489  9.098979  -30.0232886   5.8895404
 [64,]    1.00361323  8.079790  -15.2338317  16.6702234
 [65,]  -11.97059865  7.679138  -27.2625270   3.0389849
 [66,]   18.68938947  7.990612    3.1203516  34.6208734
 [67,]    2.21387758  8.940087  -15.0772784  19.7544027
 [68,]    8.69176570 10.353502  -11.2784915  29.1324586
 [69,]  -17.12364618 12.068944  -40.3157733   6.8120268
 [70,]    1.22364194 13.975635  -26.0262351  28.7734653
 [71,]   21.15801355 12.531978   -3.5237675  45.9991230
 [72,]   20.36781669 10.769491   -1.0722250  41.6423873
 [73,]  -23.98698018  9.287432  -42.5083134  -5.8053833
 [74,]  -24.19767704  8.238561  -40.5935430  -7.9257955
 [75,]  -11.36387391  7.799641  -26.8716231   3.8235703
 [76,]  -17.71537077  8.070807  -33.5917055  -2.1681914
 [77,]   -7.90006763  8.988018  -25.1966342   9.3865430
 [78,]    6.57973550 10.381427  -13.2678810  27.0562382
 [79,]   -0.71456136 12.087457  -23.9351972  23.1940688
 [80,]   29.31924177 13.992219    2.3847150  56.9374042
 [81,]   -9.05586466 13.204567  -35.2193486  16.7057626
 [82,]   23.51561102 11.266132    1.4982106  45.3361271
 [83,]    4.29168671  9.625686  -14.3270060  22.9973415
 [84,]   20.83566239  8.458423    4.1583757  37.5641739
 [85,]    1.71803808  7.974895  -14.5465948  17.4773769
 [86,]    5.13491376  8.295538  -11.0031203  21.3900054
 [87,]   -3.81641055  9.337875  -22.1385854  14.1790953
 [88,]  -13.72513487 10.896735  -34.7726230   7.3264400
 [89,]  -13.04945918 12.784550  -38.0623453  11.8358026
 [90,]  -11.32438350 14.876611  -40.0392124  17.8272542
 [91,]   26.37896667 12.848669    0.2032384  50.1336079
 [92,]    8.69010754 11.070332  -13.8911412  29.1190173
 [93,]  -32.63255159  9.575212  -52.0367020 -14.6909532
 [94,]    2.75038928  8.513849  -13.9421157  18.9765544
 [95,]    3.23253015  8.059471  -12.6225907  19.2011452
 [96,]   10.21057102  8.312221   -6.3545486  27.0765221
 [97,]    3.50411189  9.214090  -14.3554009  21.9849020
 [98,]   -3.19174724 10.600679  -24.0444662  17.7139992
 [99,]   16.85219363 12.309258   -6.9897472  40.9282378
[100,]    0.77653450 14.224267  -26.7687607  28.9675191
[101,]    9.25917226 13.299472  -15.9463235  35.3616944
[102,]   -8.06712874 11.399304  -29.6502551  14.7487627
[103,]  -10.99802974  9.773666  -29.5118290   8.4143425
[104,]   -6.54143073  8.580047  -22.6296556  10.6367525
[105,]  -22.29293173  8.013870  -37.6073480  -6.3544266
[106,]  -14.76863273  8.206051  -30.6976542   1.2606201
[107,]  -14.51803373  9.108714  -32.6377815   3.5814358
[108,]    0.47936528 10.540888  -20.5866017  21.3265483
[109,]   17.11816428 12.319262   -7.0352918  41.4159977
[110,]   20.94286328 14.315389   -7.4225206  48.9359779
[111,]   17.68272073 13.105072   -7.0692880  43.6927200
[112,]  -12.14861809 11.174696  -33.3207481   9.9692377
[113,]  -16.38715690  9.522822  -34.6454620   2.4960929
[114,]  -34.05349572  8.317082  -50.1758935 -18.0696390
[115,]  -37.65293454  7.768075  -52.7431274 -22.6230586
[116,]    6.16642664  8.011961   -9.5551654  21.8545015
[117,]   38.89738782  8.984401   21.3164736  56.3212390
[118,]    5.38244901 10.484599  -15.2430909  26.0004888
[119,]   19.96241019 12.321265   -4.3162442  44.0427365
[120,]   -2.46092863 14.365922  -30.8204760  25.5468584
[121,]   -5.30257383 12.677717  -30.5180041  19.0350374
[122,]   36.75883363 10.888748   14.7799294  57.6320060
[123,]   -0.87455891  9.389572  -19.9845259  17.0830209
[124,]    2.35094856  8.337996  -14.2609558  18.4853223
[125,]  -13.88044398  7.914494  -29.1547936   1.7394941
[126,]   11.45606348  8.216759   -4.2517600  27.7299571
[127,]  -12.90062906  9.173329  -30.4556122   5.5354780
[128,]  -41.52142159 10.608661  -61.8121717 -20.3040580
[129,]    5.95518587 12.357035  -17.6956109  30.5618114
[130,]   24.50919333 14.304120   -3.1669263  53.0493721
[131,]  -50.41980137 12.521661  -74.9111761 -25.7243246
[132,]   12.07178295 10.755839   -9.4331486  33.1953932
[133,]   26.73116726  9.284416    8.1264995  45.1994457
[134,]   32.68295158  8.266128   16.2007429  48.8830163
[135,]   20.54243589  7.878679    5.0066699  36.2313952
[136,]   10.60572021  8.211852   -5.8439797  27.0015128
[137,]   -1.82159547  9.187582  -19.9824034  16.4987047
[138,]   -9.84081116 10.630381  -30.8657007  11.8864859
[139,]   -8.65802684 12.377987  -32.6814998  16.4767809
[140,]   -9.78214252 14.319230  -37.2990227  19.0187736
[141,]   17.21859905 12.018226   -6.3502911  40.6941409
[142,]    2.40176126 10.331801  -17.8664479  22.3429271
[143,]  -20.12297653  8.946257  -37.9927669  -3.0642286
[144,]  -11.03901433  8.019100  -27.1412313   4.3291492
[145,]   14.79634788  7.717348   -0.8993638  30.0735972
[146,]    5.85741009  8.111103  -10.3947271  21.8068487
[147,]  -24.55102770  9.110630  -42.3500525  -6.9283447
[148,]   14.10633450 10.545057   -6.3576830  34.3811669
[149,]   -5.06680329 12.262704  -29.4610595  18.4230760
[150,]    9.83605892 14.160884  -18.2777089  36.7839359
[151,]   -1.01305377 13.493898  -26.2805498  25.5130921
[152,]   -6.95733917 11.550767  -28.3362887  16.1390033
[153,]  -17.78382457  9.876164  -36.5067583   1.8869819
[154,]  -31.41540997  8.627889  -47.9281443 -14.4983124
[155,]  -19.55489536  8.007859  -35.1473839  -3.6172784
[156,]   41.89771924  8.160553   25.7948905  57.7756043
[157,]  -36.35166616  9.046928  -53.9297148 -18.3761643
[158,]   14.88194844 10.482493   -5.4445832  35.5480843
[159,]   17.25566305 12.276069   -6.9147266  40.8841202
[160,]    9.11767765 14.293515  -18.9225273  36.8629345
[161,]   17.84535875 11.956291   -6.2683622  41.4149561
[162,]   10.90583140 10.311327   -9.7025814  31.4663441
[163,]    6.86000404  8.976082  -10.2100625  24.4853915
[164,]    1.24867668  8.105098  -14.1714797  17.1348771
[165,]  -10.87225067  7.854373  -25.9580045   4.0103337
[166,]  -15.03267803  8.280442  -31.2344510   0.8666247
[167,]  -49.78080539  9.290655  -67.8326256 -32.1797710
[168,]  -13.91793275 10.721138  -34.6765338   6.7172155
[169,]   22.73023990 12.427604   -1.1260573  47.0382761
[170,]   31.91681254 14.311669    4.5161800  59.9684524
[171,]    5.67767506 12.529194  -19.0336735  29.7303349
[172,]   -2.04701416 10.790626  -23.3132508  18.4482359
[173,]   10.28879662  9.335684   -8.5262061  28.3680111
[174,]   11.53660740  8.314616   -4.9259961  27.5724631
[175,]  -23.70938182  7.897540  -39.5700570  -8.4208698
[176,]    6.93862896  8.177403   -9.1759003  22.9305017
[177,]    0.02583974  9.090058  -17.8446356  17.6301764
[178,]   -3.02304948 10.471335  -23.9297827  17.1952583
[179,]   11.11176130 12.162608  -13.4991086  34.5105578
[180,]   -5.69332792 14.052390  -34.1045352  21.2366205</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1769.9 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   476       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   67        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.9 22.3
p_loo        33.8  8.3
looic      1721.8 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   977       
 (0.5, 0.7]   (ok)         7    3.9%   506       
   (0.7, 1]   (bad)        1    0.6%   26        
   (1, Inf)   (very bad)   2    1.1%   18        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.1      11.6  
fit_sleep1 -92.3      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1769.9 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   476       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   67        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.9 22.3
p_loo        33.8  8.3
looic      1721.8 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   977       
 (0.5, 0.7]   (ok)         7    3.9%   506       
   (0.7, 1]   (bad)        1    0.6%   26        
   (1, Inf)   (very bad)   2    1.1%   18        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.9     22.3        33.8    8.3   1721.8
fit_sleep2  -24.1      11.6  -885.0     14.4        19.5    3.4   1769.9
fit_sleep1  -92.3      21.0  -953.2     10.5         3.1    0.5   1906.4
           se_looic
fit_sleep3   44.7  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
7.977000e-41 3.486738e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.98      1.61     0.32     5.58       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.02      1.61    -3.23     3.21       5.02      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0.1       tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
