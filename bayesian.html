<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing
adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.80      6.91    15.23    43.25 1.00     1422     1991
sd(Days)                6.59      1.54     4.26    10.10 1.00     1201     1618
cor(Intercept,Days)     0.08      0.30    -0.48     0.68 1.00     1014     1753

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.12      7.34   236.51   265.35 1.00     1946     2503
Days         10.42      1.76     6.95    13.84 1.00     1225     1598

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.97      1.57    23.17    29.27 1.00     3165     2931

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0286  13.18468 227.2877 278.8433
309 211.6678  13.45421 185.3167 238.3674
310 213.2194  13.20083 186.8866 238.6048
330 274.2905  13.32562 248.7472 300.3464
331 273.1910  13.28102 247.8653 299.4163
332 260.4456  12.38999 236.6963 285.3028
333 267.9947  12.46162 244.1160 292.8331
334 244.5290  12.06761 220.0291 268.2779
335 250.9943  13.32537 225.9314 277.5494
337 285.9453  12.82387 260.9280 311.2201
349 226.8990  12.98727 200.9651 252.3633
350 239.1042  13.32138 212.1984 264.0936
351 255.7900  12.40601 231.5958 280.4698
352 271.9815  12.58696 247.7410 297.3914
369 254.4299  12.36777 230.2313 279.6856
370 226.3953  13.81309 198.3784 252.8080
371 252.2438  12.61218 227.6710 276.8433
372 263.6405  12.48950 239.5901 288.2834

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5843138  2.552898 14.7226951 24.719708
309  1.6928105  2.525060 -3.3065604  6.604926
310  4.8834092  2.502962 -0.1480285  9.723829
330  5.7868423  2.522396  0.8713240 10.573212
331  7.4790616  2.500636  2.4690058 12.370016
332 10.1766539  2.331048  5.4870526 14.802156
333 10.2631217  2.384927  5.4039518 14.813979
334 11.4607973  2.338936  6.8756740 16.182865
335 -0.2418143  2.573668 -5.3450054  4.716798
337 19.1564696  2.424271 14.4736425 23.851982
349 11.5290505  2.460232  6.6537968 16.352431
350 16.9774502  2.544858 12.2724405 22.076980
351  7.4883956  2.398346  2.6714847 12.066689
352 14.0114372  2.410753  9.2039163 18.741918
369 11.3986971  2.355980  6.7307534 16.087707
370 15.2104621  2.567955 10.3478242 20.358637
371  9.5368933  2.434755  4.7421491 14.415516
372 11.7609405  2.384767  7.0501620 16.546253</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0286 13.184677 227.2877 278.8433
  [2,] 273.6129 11.239207 250.6869 294.7420
  [3,] 293.1973  9.583235 273.8064 311.7534
  [4,] 312.7816  8.389969 295.6801 328.9668
  [5,] 332.3659  7.872696 316.8446 347.8173
  [6,] 351.9502  8.160986 335.6038 367.9967
  [7,] 371.5345  9.179249 353.2810 389.5927
  [8,] 391.1188 10.721478 369.9638 411.9272
  [9,] 410.7031 12.596673 385.8298 434.7958
 [10,] 430.2875 14.677765 401.2635 458.0233
 [11,] 211.6678 13.454209 185.3167 238.3674
 [12,] 213.3606 11.512063 190.6357 236.3024
 [13,] 215.0534  9.838257 195.4028 234.7009
 [14,] 216.7462  8.591091 199.7958 233.5706
 [15,] 218.4390  7.973347 202.9464 233.7291
 [16,] 220.1318  8.129792 204.1612 236.2393
 [17,] 221.8246  9.020234 204.2813 239.4572
 [18,] 223.5174 10.458853 203.4174 243.6878
 [19,] 225.2103 12.254078 201.0784 248.7148
 [20,] 226.9031 14.271969 198.9374 254.3954
 [21,] 213.2194 13.200832 186.8866 238.6048
 [22,] 218.1028 11.300921 195.8129 239.9379
 [23,] 222.9862  9.679325 203.5280 241.9224
 [24,] 227.8696  8.496909 210.8244 244.8413
 [25,] 232.7530  7.952059 216.4706 248.3154
 [26,] 237.6364  8.173289 221.6374 253.9675
 [27,] 242.5199  9.104928 224.6980 260.4440
 [28,] 247.4033 10.560606 227.0142 268.1853
 [29,] 252.2867 12.356486 228.3426 276.9030
 [30,] 257.1701 14.365539 229.2859 285.9068
 [31,] 274.2905 13.325620 248.7472 300.3464
 [32,] 280.0773 11.403283 258.3583 303.0243
 [33,] 285.8642  9.758204 266.9500 305.5001
 [34,] 291.6510  8.551912 274.7980 308.6277
 [35,] 297.4379  7.985787 281.6668 313.3903
 [36,] 303.2247  8.193618 287.1300 319.6995
 [37,] 309.0115  9.122659 291.2677 326.9976
 [38,] 314.7984 10.584678 294.3323 335.6330
 [39,] 320.5852 12.392452 296.5673 344.8517
 [40,] 326.3721 14.416494 298.4125 355.2110
 [41,] 273.1910 13.281015 247.8653 299.4163
 [42,] 280.6701 11.394713 258.7229 302.9086
 [43,] 288.1491  9.787747 269.0445 307.2370
 [44,] 295.6282  8.617821 278.6207 312.9741
 [45,] 303.1072  8.077131 287.1496 319.2011
 [46,] 310.5863  8.289730 294.2818 327.6108
 [47,] 318.0654  9.203563 300.0709 336.6986
 [48,] 325.5444 10.639448 304.8105 347.0985
 [49,] 333.0235 12.417589 308.5588 357.8275
 [50,] 340.5026 14.411855 311.7656 369.2641
 [51,] 260.4456 12.389992 236.6963 285.3028
 [52,] 270.6222 10.677764 250.0053 292.1347
 [53,] 280.7989  9.240398 263.2331 299.2037
 [54,] 290.9755  8.223311 275.3415 307.2261
 [55,] 301.1522  7.792835 286.2160 316.5238
 [56,] 311.3288  8.043712 295.5243 327.2198
 [57,] 321.5055  8.918625 304.1021 339.2961
 [58,] 331.6821 10.259143 311.7142 352.0212
 [59,] 341.8588 11.909061 318.5982 365.4192
 [60,] 352.0354 13.757508 325.1573 379.0969
 [61,] 267.9947 12.461619 244.1160 292.8331
 [62,] 278.2579 10.677415 257.6093 299.5066
 [63,] 288.5210  9.170505 270.6360 306.5762
 [64,] 298.7841  8.097216 282.9601 314.8229
 [65,] 309.0472  7.642473 293.8685 323.9315
 [66,] 319.3103  7.913636 303.8868 334.8369
 [67,] 329.5735  8.844187 312.2482 346.8018
 [68,] 339.8366 10.256188 319.5579 359.8890
 [69,] 350.0997 11.980606 326.1316 373.9646
 [70,] 360.3628 13.901661 332.7728 388.1345
 [71,] 244.5290 12.067615 220.0291 268.2779
 [72,] 255.9898 10.346044 235.6911 276.2320
 [73,] 267.4506  8.910397 249.8781 284.9716
 [74,] 278.9114  7.917763 263.3752 294.6854
 [75,] 290.3722  7.545064 275.4453 305.3482
 [76,] 301.8330  7.880752 286.5956 317.4441
 [77,] 313.2938  8.844533 295.9223 330.7954
 [78,] 324.7546 10.260921 304.8968 345.1167
 [79,] 336.2153 11.970317 312.9092 360.0473
 [80,] 347.6761 13.864765 320.8091 374.8077
 [81,] 250.9943 13.325368 225.9314 277.5494
 [82,] 250.7524 11.357785 229.2620 273.1232
 [83,] 250.5106  9.678877 231.8176 269.6689
 [84,] 250.2688  8.462244 233.6440 266.6422
 [85,] 250.0270  7.923763 234.7435 265.4791
 [86,] 249.7852  8.198171 233.5834 265.7675
 [87,] 249.5434  9.213118 230.9943 267.4797
 [88,] 249.3016 10.761069 227.6728 270.4210
 [89,] 249.0597 12.647815 223.5066 273.9405
 [90,] 248.8179 14.743858 219.3100 277.3940
 [91,] 285.9453 12.823871 260.9280 311.2201
 [92,] 305.1018 11.029298 283.7118 327.1195
 [93,] 324.2583  9.518053 305.8644 342.9966
 [94,] 343.4147  8.443663 327.1411 360.0103
 [95,] 362.5712  7.984468 347.4243 378.7978
 [96,] 381.7277  8.243918 365.9808 398.5928
 [97,] 400.8841  9.161159 383.0471 419.1442
 [98,] 420.0406 10.566250 399.3514 440.9085
 [99,] 439.1971 12.293032 415.2082 463.5489
[100,] 458.3535 14.224831 430.4735 486.3320
[101,] 226.8990 12.987266 200.9651 252.3633
[102,] 238.4281 11.134170 216.0435 260.1394
[103,] 249.9571  9.559074 231.0094 268.6988
[104,] 261.4862  8.419474 244.8998 277.5532
[105,] 273.0152  7.905989 257.6889 288.4156
[106,] 284.5443  8.138014 268.8978 300.3678
[107,] 296.0733  9.058441 278.8886 313.2535
[108,] 307.6024 10.487561 287.0322 327.3349
[109,] 319.1314 12.248592 295.0483 341.9638
[110,] 330.6605 14.218740 302.8518 356.8993
[111,] 239.1042 13.321380 212.1984 264.0936
[112,] 256.0817 11.391595 233.4082 277.7418
[113,] 273.0591  9.748348 254.1607 291.9593
[114,] 290.0366  8.558314 273.4008 306.4521
[115,] 307.0140  8.025696 291.1184 322.4194
[116,] 323.9915  8.278373 307.8023 339.9986
[117,] 340.9689  9.252228 323.0783 359.4401
[118,] 357.9464 10.753073 337.6435 379.4151
[119,] 374.9238 12.593889 351.0383 400.0996
[120,] 391.9013 14.647051 364.6192 421.1471
[121,] 255.7900 12.406011 231.5958 280.4698
[122,] 263.2784 10.637998 242.8523 284.2903
[123,] 270.7668  9.161278 253.0678 289.0138
[124,] 278.2552  8.136041 262.5117 294.6875
[125,] 285.7436  7.743736 270.4837 300.9832
[126,] 293.2320  8.077118 277.3582 309.0154
[127,] 300.7204  9.056399 282.7148 318.1515
[128,] 308.2088 10.502429 287.7980 328.2096
[129,] 315.6972 12.251032 291.8123 338.8673
[130,] 323.1856 14.190796 295.1813 350.0485
[131,] 271.9815 12.586957 247.7410 297.3914
[132,] 285.9929 10.832965 265.0085 308.0665
[133,] 300.0044  9.375405 281.7891 319.0798
[134,] 314.0158  8.370591 297.8355 330.8065
[135,] 328.0272  7.991171 312.2237 343.9279
[136,] 342.0387  8.323117 325.6452 358.5969
[137,] 356.0501  9.290491 338.0943 374.3709
[138,] 370.0616 10.722668 349.2897 391.1778
[139,] 384.0730 12.460396 360.2074 408.9453
[140,] 398.0844 14.393428 370.6845 426.3833
[141,] 254.4299 12.367773 230.2313 279.6856
[142,] 265.8286 10.661964 245.1483 287.6140
[143,] 277.2273  9.246320 258.9197 295.9441
[144,] 288.6260  8.271195 272.2369 305.2639
[145,] 300.0246  7.901405 284.7336 315.3778
[146,] 311.4233  8.219064 295.8076 327.5933
[147,] 322.8220  9.152875 305.2241 340.8845
[148,] 334.2207 10.540328 313.4254 355.0138
[149,] 345.6194 12.227968 321.8327 369.8763
[150,] 357.0181 14.108479 329.3281 384.9609
[151,] 226.3953 13.813086 198.3784 252.8080
[152,] 241.6058 11.825197 217.7618 263.9473
[153,] 256.8162 10.102377 236.2034 276.0192
[154,] 272.0267  8.801679 254.4171 288.7219
[155,] 287.2372  8.128337 271.3086 302.6621
[156,] 302.4476  8.237655 286.4703 318.2606
[157,] 317.6581  9.101475 300.2111 335.4068
[158,] 332.8685 10.535821 312.5764 353.4436
[159,] 348.0790 12.343378 324.3227 372.1771
[160,] 363.2895 14.384132 335.8594 391.4634
[161,] 252.2438 12.612182 227.6710 276.8433
[162,] 261.7807 10.828771 240.6754 283.2236
[163,] 271.3176  9.344168 252.8582 289.7193
[164,] 280.8545  8.319900 264.5884 297.4053
[165,] 290.3914  7.936250 275.1658 306.2365
[166,] 299.9283  8.282719 284.0803 316.3114
[167,] 309.4652  9.277871 291.6782 327.4270
[168,] 319.0021 10.742922 298.2622 339.6901
[169,] 328.5390 12.513910 304.1476 352.5208
[170,] 338.0758 14.479004 309.8708 366.3099
[171,] 263.6405 12.489502 239.5901 288.2834
[172,] 275.4014 10.764788 254.0956 296.3042
[173,] 287.1624  9.335304 268.7225 305.2812
[174,] 298.9233  8.354003 282.3341 315.4813
[175,] 310.6842  7.987806 294.8444 326.2416
[176,] 322.4452  8.318351 306.1058 338.7700
[177,] 334.2061  9.271413 316.3074 352.6840
[178,] 345.9671 10.681641 325.2969 367.0127
[179,] 357.7280 12.393952 333.3850 382.0978
[180,] 369.4889 14.300239 341.6773 397.4440</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.4686340 13.184677  -29.28332753  22.2722572
  [2,]  -14.9082478 11.239207  -36.03733474   8.0177585
  [3,]  -42.3966616  9.583235  -60.95275158 -23.0057867
  [4,]    8.6582247  8.389969   -7.52703570  25.7597445
  [5,]   24.4860109  7.872696    9.03459446  40.0072659
  [6,]   62.7398971  8.160986   46.69338111  79.0863399
  [7,]   10.6692833  9.179249   -7.38890839  28.9228116
  [8,] -100.9702304 10.721478 -121.77856533 -79.8151949
  [9,]   19.8821558 12.596673   -4.21052491  44.7554838
 [10,]   36.0660420 14.677765    8.33022845  65.0900443
 [11,]   11.0661266 13.454209  -15.63354902  37.4171940
 [12,]   -8.0947838 11.512063  -31.03655432  14.6301255
 [13,]  -12.0755943  9.838257  -31.72308108   7.5749882
 [14,]  -12.0392048  8.591091  -28.86359478   4.9111913
 [15,]  -10.7229152  7.973347  -26.01304125   4.7696604
 [16,]   -4.1700257  8.129792  -20.27753077  11.8005784
 [17,]   -8.1943362  9.020234  -25.82688931   9.3490042
 [18,]   -5.7902466 10.458853  -25.96055373  14.3097872
 [19,]   -0.9145571 12.254078  -24.41913269  23.2172658
 [20,]   10.4111324 14.271969  -17.08118005  38.3768053
 [21,]  -14.1655026 13.200832  -39.55093466  12.1673400
 [22,]  -23.7706119 11.300921  -45.60571136  -1.4806735
 [23,]   11.3337789  9.679325   -7.60238719  30.7920127
 [24,]    4.9719697  8.496909  -11.99967423  22.0171597
 [25,]   -3.4456396  7.952059  -19.00799782  12.8367684
 [26,]  -17.1785488  8.173289  -33.50956143  -1.1795165
 [27,]   -7.0990580  9.104928  -25.02320434  10.7228462
 [28,]    8.3478328 10.560606  -12.43419503  28.7369350
 [29,]    8.7258235 12.356486  -15.89049997  32.6699324
 [30,]   -9.6547857 14.365539  -38.39146696  18.2293979
 [31,]   47.2521182 13.325620   21.19616975  72.7954379
 [32,]   20.3228759 11.403283   -2.62412316  42.0419071
 [33,]   -2.0076664  9.758204  -21.64358219  16.9064958
 [34,]   -6.5180087  8.551912  -23.49465832  10.3349594
 [35,]  -11.6405510  7.985787  -27.59295963   4.1304664
 [36,]   -5.6391933  8.193618  -22.11395394  10.4554614
 [37,]  -28.7719356  9.122659  -46.75797901 -11.0280699
 [38,]    3.4629221 10.584678  -17.37171998  23.9289897
 [39,]  -15.2357202 12.392452  -39.50218070   8.7821736
 [40,]   27.6766375 14.416494   -1.16231674  55.6361818
 [41,]   14.4168968 13.281015  -11.80837528  39.7425688
 [42,]    4.3299352 11.394713  -17.90864788  26.2771026
 [43,]   13.6714737  9.787747   -5.41638180  32.7761103
 [44,]   24.4871121  8.617821    7.14116521  41.4945531
 [45,]   13.1700505  8.077131   -2.92377008  29.1277035
 [46,]  -17.2676111  8.289730  -34.29211433  -0.9630939
 [47,]  -27.9903726  9.203563  -46.62358042  -9.9959456
 [48,]    9.2732658 10.639448  -12.28081856  30.0072436
 [49,]  -39.2765958 12.417589  -64.08058050 -14.8119078
 [50,]   31.0785427 14.411855    2.31696782  59.8155201
 [51,]  -25.5849562 12.389992  -50.44219345  -1.8357492
 [52,]  -27.8104101 10.677764  -49.32285595  -7.1935331
 [53,]   -7.8375640  9.240398  -26.24242599   9.7281788
 [54,]   18.7932821  8.223311    2.54265735  34.4273337
 [55,]   16.3107282  7.792835    0.93906504  31.2469473
 [56,]   -1.3312256  8.043712  -17.22222722  14.4732884
 [57,]  132.6564205  8.918625  114.86584691 150.0597568
 [58,]   15.1489666 10.259143   -5.19006201  35.1168771
 [59,]  -11.5584873 11.909061  -35.11889393  11.7021082
 [60,]  -98.1710412 13.757508 -125.23249501 -71.2929022
 [61,]   15.8476715 12.461619   -8.99065077  39.7263992
 [62,]   11.2971498 10.677415   -9.95162045  31.9456557
 [63,]  -11.7516719  9.170505  -29.80688770   6.1332599
 [64,]    1.0256064  8.097216  -15.01317354  16.8496125
 [65,]  -11.8762152  7.642473  -26.76047750   3.3025331
 [66,]   18.8561631  7.913636    3.32960729  34.2796884
 [67,]    2.4530414  8.844187  -14.77533260  19.7783471
 [68,]    9.0033197 10.256188  -11.04914024  29.2820017
 [69,]  -16.7397020 11.980606  -40.60455117   7.2284293
 [70,]    1.6799763 13.901661  -26.09170710  29.2700068
 [71,]   20.9441289 12.067615   -2.80483609  45.4440330
 [72,]   20.2114316 10.346044   -0.03080992  40.5100906
 [73,]  -24.0858657  8.910397  -41.60685834  -6.5133512
 [74,]  -24.2390629  7.917763  -40.01313869  -8.7028900
 [75,]  -11.3477602  7.545064  -26.32375471   3.5790922
 [76,]  -17.6417575  7.880752  -33.25286041  -2.4044033
 [77,]   -7.7689548  8.844533  -25.27060191   9.6024986
 [78,]    6.7683479 10.260921  -13.59380126  26.6261214
 [79,]   -0.4684494 11.970317  -24.30041545  22.8377234
 [80,]   29.6228533 13.864765    2.49134607  56.4898579
 [81,]   -9.3859525 13.325368  -35.94111349  15.6768559
 [82,]   23.1947618 11.357785    0.82401356  44.6851967
 [83,]    3.9800761  9.678877  -15.17816681  22.6730626
 [84,]   20.5332905  8.462244    4.15994205  37.1581386
 [85,]    1.4249048  7.923763  -14.02719928  16.7083985
 [86,]    4.8510191  8.198171  -11.13130112  21.0527503
 [87,]   -4.0910666  9.213118  -22.02743962  14.4580267
 [88,]  -13.9905523 10.761069  -35.10998208   7.6382101
 [89,]  -13.3056380 12.647815  -38.18644898  12.2475447
 [90,]  -11.5713236 14.743858  -40.14740264  17.9366147
 [91,]   26.4212867 12.823871    1.14652234  51.4386185
 [92,]    8.7040172 11.029298  -13.31367748  30.0939868
 [93,]  -32.6470524  9.518053  -51.38542197 -14.2531626
 [94,]    2.7074781  8.443663  -13.88813419  18.9810719
 [95,]    3.1612085  7.984468  -13.06535942  18.3080915
 [96,]   10.1108389  8.243918   -6.75431887  25.8576528
 [97,]    3.3759694  9.161159  -14.88412183  21.2130080
 [98,]   -3.3483002 10.566250  -24.21619414  17.3408971
 [99,]   16.6672303 12.293032   -7.68464343  40.6561103
[100,]    0.5631607 14.224831  -27.41527142  28.4431631
[101,]    9.2041708 12.987266  -16.26013463  35.1380554
[102,]   -8.1113796 11.134170  -29.82272623  14.2732223
[103,]  -11.0315301  9.559074  -29.77319425   7.9161979
[104,]   -6.5641806  8.419474  -22.63120479  10.0221509
[105,]  -22.3049311  7.905989  -37.70528767  -6.9785574
[106,]  -14.7698816  8.138014  -30.59338019   0.8766461
[107,]  -14.5085321  9.058441  -31.68872378   2.6761604
[108,]    0.4996174 10.487561  -19.23286459  21.0698428
[109,]   17.1491670 12.248592   -5.68318603  41.2322803
[110,]   20.9846165 14.218740   -5.25420330  48.7932674
[111,]   17.1925547 13.321380   -7.79679736  44.0984243
[112,]  -12.6273955 11.391595  -34.28748283  10.0461093
[113,]  -16.8545457  9.748348  -35.75470864   2.0438764
[114,]  -34.5094959  8.558314  -50.92498567 -17.8737027
[115,]  -38.0975461  8.025696  -53.50290569 -22.2019323
[116,]    5.7332037  8.278373  -10.27389497  21.9224356
[117,]   38.4755535  9.252228   20.00440215  56.3661736
[118,]    4.9720033 10.753073  -16.49667631  25.2749124
[119,]   19.5633531 12.593889   -5.61240017  43.4489062
[120,]   -2.8485971 14.647051  -32.09437757  24.4334773
[121,]   -5.2635050 12.406011  -29.94327832  18.9306663
[122,]   36.7791994 10.637998   15.76734485  57.2052799
[123,]   -0.8728963  9.161278  -19.11994537  16.8261465
[124,]    2.3339081  8.136041  -14.09836585  18.0773769
[125,]  -13.9161875  7.743736  -29.15582257   1.3437209
[126,]   11.4016168  8.077118   -4.38182420  27.2754328
[127,]  -12.9737788  9.056399  -30.40485492   5.0318261
[128,]  -41.6132744 10.502429  -61.61405532 -21.2025166
[129,]    5.8446299 12.251032  -17.32553810  29.7294928
[130,]   24.3799343 14.190796   -2.48300383  52.3842060
[131,]  -50.3043984 12.586957  -75.71426297 -26.0638713
[132,]   12.2009644 10.832965   -9.87256757  33.1854382
[133,]   26.8741273  9.375405    7.79868241  45.0893847
[134,]   32.8396901  8.370591   16.04900440  49.0199658
[135,]   20.7129530  7.991171    4.81226911  36.5164693
[136,]   10.7900158  8.323117   -5.76822329  27.1834838
[137,]   -1.6235214  9.290491  -19.94426930  16.3322761
[138,]   -9.6289585 10.722668  -30.74518623  11.1429488
[139,]   -8.4323957 12.460396  -33.30473192  15.4331543
[140,]   -9.5427328 14.393428  -37.84156900  17.8571555
[141,]   17.4936399 12.367773   -7.76208859  41.6921727
[142,]    2.6083428 10.661964  -19.17707290  23.2886262
[143,]  -19.9848543  9.246320  -38.70174599  -1.6773160
[144,]  -10.9693513  8.271195  -27.60726162   5.4197441
[145,]   14.7975516  7.901405   -0.55560762  30.0885531
[146,]    5.7901545  8.219064  -10.37978069  21.4059306
[147,]  -24.6867425  9.152875  -42.74924544  -7.0887914
[148,]   13.9021604 10.540328   -6.89086929  34.6974592
[149,]   -5.3394367 12.227968  -29.59626286  18.4472941
[150,]    9.4949662 14.108479  -18.44777860  37.1850297
[151,]   -1.1313153 13.813086  -27.54399981  26.8856109
[152,]   -7.0822773 11.825197  -29.42378889  16.7617254
[153,]  -17.9154394 10.102377  -37.11835174   2.6974450
[154,]  -31.5537015  8.801679  -48.24888420 -13.9440656
[155,]  -19.6998636  8.128337  -35.12483758  -3.7713493
[156,]   41.7460743  8.237655   25.93308902  57.7234077
[157,]  -36.5099878  9.101475  -54.25865361 -19.0629710
[158,]   14.7169502 10.535821   -5.85814373  35.0091476
[159,]   17.0839881 12.343378   -7.01413093  40.8403231
[160,]    8.9393260 14.384132  -19.23455632  36.3693984
[161,]   17.6365908 12.612182   -6.96294855  42.2093770
[162,]   10.6620974 10.828771  -10.78076590  31.7673682
[163,]    6.5813041  9.344168  -11.82041641  25.0406568
[164,]    0.9350107  8.319900  -15.61577124  17.2010685
[165,]  -11.2208826  7.936250  -27.06595702   4.0046798
[166,]  -15.4162759  8.282719  -31.79941132   0.4316817
[167,]  -50.1993693  9.277871  -68.16115337 -32.4124020
[168,]  -14.3714626 10.742922  -35.05952040   6.3684441
[169,]   22.2417440 12.513910   -1.74010524  46.6330643
[170,]   31.3933507 14.479004    3.15928664  59.5983526
[171,]    5.7712244 12.489502  -18.87167863  29.8215864
[172,]   -1.9274161 10.764788  -22.83023706  19.3784474
[173,]   10.4344435  9.335304   -7.68442857  28.8742630
[174,]   11.7083030  8.354003   -4.84974372  28.2975253
[175,]  -23.5116375  7.987806  -39.06900339  -7.6718407
[176,]    7.1624220  8.318351   -9.16237692  23.5017564
[177,]    0.2756815  9.271413  -18.20218127  18.1743695
[178,]   -2.7471590 10.681641  -23.79277198  17.9229812
[179,]   11.4137005 12.393952  -12.95607333  35.7566581
[180,]   -5.3653400 14.300239  -33.32038119  22.4462847</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.5  3.3
looic      1769.8 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   637       
 (0.5, 0.7]   (ok)         2    1.1%   142       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.2
p_loo        33.7  8.2
looic      1722.1 44.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   775       
 (0.5, 0.7]   (ok)         6    3.3%   479       
   (0.7, 1]   (bad)        3    1.7%   54        
   (1, Inf)   (very bad)   1    0.6%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.9      11.4  
fit_sleep1 -92.3      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.5  3.3
looic      1769.8 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   637       
 (0.5, 0.7]   (ok)         2    1.1%   142       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.2
p_loo        33.7  8.2
looic      1722.1 44.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   775       
 (0.5, 0.7]   (ok)         6    3.3%   479       
   (0.7, 1]   (bad)        3    1.7%   54        
   (1, Inf)   (very bad)   1    0.6%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.1     22.2        33.7    8.2   1722.1
fit_sleep2  -23.9      11.4  -884.9     14.4        19.5    3.3   1769.8
fit_sleep1  -92.3      20.8  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.4  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.173381e-41 4.288321e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88      1.56     0.34     5.36       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12      1.56    -3.21     2.75       5.86      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.15      
[4] StanHeaders_2.26.15 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.13.0          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.4.0      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.1         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.9        
 [91] gtable_0.3.1         cachem_1.0.7         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
