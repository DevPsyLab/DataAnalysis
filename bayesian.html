<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.77      6.82    15.66    42.93 1.00     2091     2302
sd(Days)                6.53      1.54     4.10     9.94 1.00     1571     1901
cor(Intercept,Days)     0.08      0.29    -0.47     0.64 1.00      990     1331

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.04      7.46   236.04   265.74 1.00     2061     2527
Days         10.42      1.70     7.01    13.75 1.00     1534     2046

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.57    23.08    29.18 1.00     4100     2810

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.5253  13.07855 226.9314 278.4681
309 211.3967  13.41593 184.7708 237.0964
310 212.6565  13.68407 185.8754 239.3910
330 274.2041  13.15204 249.2632 300.7331
331 273.2309  13.03400 248.7183 299.5304
332 260.3639  12.41259 236.5974 285.9391
333 267.8335  12.51856 243.7652 293.1295
334 244.3758  12.51697 219.9022 268.6545
335 250.5353  13.45879 224.8089 277.6658
337 285.8711  13.18184 260.0466 311.6284
349 226.5097  12.88786 200.5522 250.8608
350 238.7917  12.88253 212.2263 262.8957
351 255.7362  12.67197 230.6588 281.3305
352 272.2016  12.45776 248.2824 297.0046
369 254.6666  12.07384 230.4785 278.3582
370 226.2013  13.38441 199.0629 251.6052
371 252.1359  12.36342 228.0372 277.3626
372 263.4134  12.15426 240.1772 287.7114

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6425815  2.499874 14.97849833 24.721202
309  1.7702753  2.530950 -3.13742380  6.569286
310  4.9901795  2.526633  0.05175896 10.041130
330  5.7664100  2.498009  0.84797613 10.622360
331  7.4367128  2.430787  2.56132883 11.961353
332 10.2341766  2.330234  5.57087640 14.713343
333 10.2958910  2.387529  5.59786492 14.820166
334 11.4820602  2.371587  6.82100455 16.271867
335 -0.2219949  2.608983 -5.41164990  4.846268
337 19.1803713  2.524172 14.16080635 24.127290
349 11.5340470  2.447131  6.83362359 16.370625
350 17.0152990  2.463197 12.43693947 21.830519
351  7.5004708  2.410177  2.57076240 12.031948
352 13.9638209  2.407473  9.31938822 18.644937
369 11.3603646  2.328046  6.93304829 15.937405
370 15.1958315  2.526088 10.49434529 20.356128
371  9.4908157  2.361342  4.78964036 14.022726
372 11.7471906  2.338392  7.17919771 16.373302</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.5253 13.078553 226.9314 278.4681
  [2,] 273.1679 11.194427 250.3786 294.6170
  [3,] 292.8105  9.595862 273.6219 311.3169
  [4,] 312.4530  8.446579 295.6718 329.2197
  [5,] 332.0956  7.944026 316.4571 347.3781
  [6,] 351.7382  8.207871 335.9369 367.4466
  [7,] 371.3808  9.172213 353.7551 389.4417
  [8,] 391.0234 10.648406 370.5324 412.6290
  [9,] 410.6660 12.455776 387.0390 435.7776
 [10,] 430.3085 14.470760 403.0921 459.5483
 [11,] 211.3967 13.415930 184.7708 237.0964
 [12,] 213.1670 11.500188 190.2000 235.5299
 [13,] 214.9372  9.865744 195.4038 234.0279
 [14,] 216.7075  8.673113 199.9424 233.8596
 [15,] 218.4778  8.119378 202.9541 234.5957
 [16,] 220.2481  8.332893 204.1188 236.6510
 [17,] 222.0183  9.260741 203.9652 240.2139
 [18,] 223.7886 10.719000 203.1518 244.3922
 [19,] 225.5589 12.523738 201.7877 249.8967
 [20,] 227.3292 14.546562 199.4790 255.3876
 [21,] 212.6565 13.684069 185.8754 239.3910
 [22,] 217.6467 11.746274 194.6989 240.7108
 [23,] 222.6368 10.072931 202.5912 242.2068
 [24,] 227.6270  8.815932 210.2140 244.7597
 [25,] 232.6172  8.169770 216.8686 248.8138
 [26,] 237.6074  8.278730 221.5142 254.4419
 [27,] 242.5976  9.115774 225.0721 261.3039
 [28,] 247.5877 10.508333 227.1055 269.0600
 [29,] 252.5779 12.268681 228.6983 277.4824
 [30,] 257.5681 14.261268 230.1206 286.4818
 [31,] 274.2041 13.152038 249.2632 300.7331
 [32,] 279.9705 11.226775 258.8392 302.6806
 [33,] 285.7369  9.570001 267.9095 305.4942
 [34,] 291.5033  8.343230 275.7325 308.3402
 [35,] 297.2697  7.753332 282.4524 312.5447
 [36,] 303.0361  7.943483 287.4948 318.7410
 [37,] 308.8025  8.863622 291.3167 326.3235
 [38,] 314.5689 10.320308 294.3265 334.9480
 [39,] 320.3353 12.121626 296.7978 344.3440
 [40,] 326.1018 14.136442 298.7543 353.6842
 [41,] 273.2309 13.033997 248.7183 299.5304
 [42,] 280.6676 11.227214 259.2398 303.2125
 [43,] 288.1043  9.697065 269.3046 307.6630
 [44,] 295.5410  8.592628 278.5441 312.3924
 [45,] 302.9777  8.090172 286.8605 318.9377
 [46,] 310.4144  8.299757 294.3477 326.3639
 [47,] 317.8511  9.172705 300.1051 335.8931
 [48,] 325.2878 10.545544 304.4416 346.1369
 [49,] 332.7246 12.251365 308.2906 356.5910
 [50,] 340.1613 14.170421 311.9966 367.5639
 [51,] 260.3639 12.412586 236.5974 285.9391
 [52,] 270.5980 10.699203 250.5340 292.2081
 [53,] 280.8322  9.259243 262.9500 299.4500
 [54,] 291.0664  8.237366 275.1239 307.8754
 [55,] 301.3006  7.799666 286.0788 317.2443
 [56,] 311.5348  8.042099 295.6518 327.8161
 [57,] 321.7689  8.909315 304.2565 339.6030
 [58,] 332.0031 10.243848 312.0509 351.9481
 [59,] 342.2373 11.889362 319.3913 365.2951
 [60,] 352.4715 13.734534 325.6892 379.4668
 [61,] 267.8335 12.518556 243.7652 293.1295
 [62,] 278.1294 10.786164 257.3185 299.5310
 [63,] 288.4253  9.347141 270.3725 306.7732
 [64,] 298.7212  8.354480 282.1519 314.9869
 [65,] 309.0171  7.976604 293.3714 324.2494
 [66,] 319.3130  8.297933 303.2429 335.4989
 [67,] 329.6089  9.245852 311.6836 347.7394
 [68,] 339.9048 10.654410 319.4047 360.8187
 [69,] 350.2007 12.367203 326.3772 374.2733
 [70,] 360.4965 14.275138 332.6680 388.1743
 [71,] 244.3758 12.516975 219.9022 268.6545
 [72,] 255.8578 10.755552 234.7159 276.6634
 [73,] 267.3399  9.270275 249.2273 285.8288
 [74,] 278.8219  8.212365 262.8889 295.5146
 [75,] 290.3040  7.758656 274.9933 306.0840
 [76,] 301.7861  8.012453 286.2874 317.7602
 [77,] 313.2681  8.913524 296.1718 331.1024
 [78,] 324.7502 10.293264 304.9374 344.9710
 [79,] 336.2322 11.987514 313.0927 359.4057
 [80,] 347.7143 13.881591 321.1139 374.5978
 [81,] 250.5353 13.458786 224.8089 277.6658
 [82,] 250.3133 11.438212 228.3831 273.0656
 [83,] 250.0913  9.702581 231.5489 268.9789
 [84,] 249.8693  8.429772 233.3146 266.6666
 [85,] 249.6473  7.848286 234.1034 265.3994
 [86,] 249.4253  8.108250 233.3859 265.6163
 [87,] 249.2033  9.138131 231.3234 267.5182
 [88,] 248.9813 10.718243 227.9170 270.1776
 [89,] 248.7593 12.643956 224.2692 273.7818
 [90,] 248.5373 14.780801 219.9310 277.3835
 [91,] 285.8711 13.181843 260.0466 311.6284
 [92,] 305.0515 11.259957 283.0715 327.6571
 [93,] 324.2318  9.620559 305.5775 343.4648
 [94,] 343.4122  8.430100 327.0693 360.0973
 [95,] 362.5926  7.894357 347.1280 377.9221
 [96,] 381.7729  8.143590 366.0502 397.4634
 [97,] 400.9533  9.113623 383.0078 418.5227
 [98,] 420.1337 10.608538 399.2204 440.6578
 [99,] 439.3141 12.440536 414.9669 463.5841
[100,] 458.4944 14.482253 430.0617 486.5225
[101,] 226.5097 12.887856 200.5522 250.8608
[102,] 238.0438 11.056313 216.0967 259.1144
[103,] 249.5778  9.506007 230.9364 267.7849
[104,] 261.1119  8.394235 244.6656 277.3136
[105,] 272.6459  7.908168 257.1218 288.2792
[106,] 284.1800  8.160389 268.3065 300.3889
[107,] 295.7140  9.089647 277.9468 313.0833
[108,] 307.2481 10.518000 286.3335 327.6002
[109,] 318.7821 12.272403 294.1749 342.7307
[110,] 330.3162 14.232791 301.6993 358.0602
[111,] 238.7917 12.882532 212.2263 262.8957
[112,] 255.8070 11.055291 233.3470 276.9757
[113,] 272.8223  9.519138 253.6515 290.6388
[114,] 289.8376  8.434641 272.9683 305.6805
[115,] 306.8529  7.987932 291.0152 322.0214
[116,] 323.8682  8.282851 307.5343 340.0248
[117,] 340.8835  9.248722 322.8814 358.9593
[118,] 357.8988 10.705456 337.1217 378.8133
[119,] 374.9141 12.482364 350.7562 398.9791
[120,] 391.9294 14.461905 363.8334 419.4516
[121,] 255.7362 12.671973 230.6588 281.3305
[122,] 263.2367 10.926373 241.7000 284.8740
[123,] 270.7371  9.476827 252.0696 289.5814
[124,] 278.2376  8.476603 261.7622 294.7175
[125,] 285.7381  8.094026 269.8823 301.4621
[126,] 293.2386  8.413776 276.7492 309.6927
[127,] 300.7390  9.364183 282.3452 318.9937
[128,] 308.2395 10.779708 287.4086 329.4585
[129,] 315.7400 12.503368 291.4844 340.3928
[130,] 323.2404 14.425125 294.7201 351.3335
[131,] 272.2016 12.457764 248.2824 297.0046
[132,] 286.1654 10.663555 265.9641 307.3536
[133,] 300.1292  9.155259 282.4950 317.8121
[134,] 314.0930  8.094318 298.5704 330.2766
[135,] 328.0569  7.668706 312.8927 343.3962
[136,] 342.0207  7.980725 326.0655 358.2195
[137,] 355.9845  8.953589 338.1606 373.3784
[138,] 369.9483 10.403527 349.5146 390.3113
[139,] 383.9121 12.161080 360.2474 407.4679
[140,] 397.8760 14.111775 370.9819 425.3996
[141,] 254.6666 12.073835 230.4785 278.3582
[142,] 266.0269 10.416695 245.3453 286.1265
[143,] 277.3873  9.059644 259.1917 295.1867
[144,] 288.7476  8.153918 272.8176 304.7077
[145,] 300.1080  7.857175 284.9892 315.7926
[146,] 311.4684  8.235508 295.7922 328.2048
[147,] 322.8287  9.206063 305.0411 341.5143
[148,] 334.1891 10.607506 313.7420 355.4362
[149,] 345.5495 12.293347 322.3363 370.3202
[150,] 356.9098 14.162385 330.1666 385.4175
[151,] 226.2013 13.384415 199.0629 251.6052
[152,] 241.3971 11.442071 218.1477 263.4193
[153,] 256.5930  9.770448 237.1935 275.5130
[154,] 271.7888  8.530215 255.0055 288.4239
[155,] 286.9846  7.926519 271.4209 302.6570
[156,] 302.1805  8.102907 286.0211 318.1911
[157,] 317.3763  9.013696 299.8582 335.5363
[158,] 332.5721 10.468934 312.1613 353.6260
[159,] 347.7680 12.276509 324.3470 372.1561
[160,] 362.9638 14.303461 335.3634 391.6774
[161,] 252.1359 12.363423 228.0372 277.3626
[162,] 261.6267 10.621210 240.3370 283.2048
[163,] 271.1175  9.160668 252.9845 289.6534
[164,] 280.6084  8.134953 264.6514 297.0050
[165,] 290.0992  7.719388 274.8481 305.0626
[166,] 299.5900  8.009514 283.7304 315.1885
[167,] 309.0808  8.936865 291.1190 326.5232
[168,] 318.5716 10.331247 298.2217 338.9819
[169,] 328.0624 12.031361 304.7850 351.8882
[170,] 337.5532 13.925678 309.9652 365.0664
[171,] 263.4134 12.154262 240.1772 287.7114
[172,] 275.1605 10.461136 255.2966 295.9298
[173,] 286.9077  9.059845 269.3400 304.7784
[174,] 298.6549  8.103233 282.7421 314.5487
[175,] 310.4021  7.757586 295.3678 325.3953
[176,] 322.1493  8.101484 306.3842 337.4603
[177,] 333.8965  9.056716 316.1195 351.2457
[178,] 345.6437 10.457070 324.8274 365.4389
[179,] 357.3909 12.149597 333.2737 380.4225
[180,] 369.1381 14.028943 341.0901 395.7614</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -3.9653025 13.078553  -28.9080662  22.6285980
  [2,]  -14.4631840 11.194427  -35.9122935   8.3260828
  [3,]  -42.0098655  9.595862  -60.5163406 -22.8213293
  [4,]    8.9867530  8.446579   -7.7799312  25.7680217
  [5,]   24.7562714  7.944026    9.4737611  40.3947552
  [6,]   62.9518899  8.207871   47.2434679  78.7531989
  [7,]   10.8230084  9.172213   -7.2379293  28.4487355
  [8,] -100.8747731 10.648406 -122.4803604 -80.3838198
  [9,]   19.9193454 12.455776   -5.1923354  43.5462551
 [10,]   36.0449638 14.470760    6.8051788  63.2614303
 [11,]   11.3372137 13.415930  -14.3624724  37.9630758
 [12,]   -7.9011617 11.500188  -30.2641433  15.0658500
 [13,]  -11.9594370  9.865744  -31.0500895   7.5739732
 [14,]  -12.0005124  8.673113  -29.1525966   4.7645925
 [15,]  -10.7616877  8.119378  -26.8795908   4.7620297
 [16,]   -4.2862631  8.332893  -20.6891502  11.8429643
 [17,]   -8.3880384  9.260741  -26.5836372   9.6650550
 [18,]   -6.0614138 10.719000  -26.6650270  14.5753755
 [19,]   -1.2631891 12.523738  -25.6009544  22.5080061
 [20,]    9.9850355 14.546562  -18.0734467  37.8352487
 [21,]  -13.6025830 13.684069  -40.3371087  13.1784824
 [22,]  -23.3144625 11.746274  -46.3785720  -0.3666572
 [23,]   11.6831580 10.072931   -7.8868305  31.7287666
 [24,]    5.2145785  8.815932  -11.9181203  22.6275583
 [25,]   -3.3098010  8.169770  -19.5064481  12.4387753
 [26,]  -17.1494806  8.278730  -33.9840313  -1.0563219
 [27,]   -7.1767601  9.115774  -25.8830541  10.3486826
 [28,]    8.1633604 10.508333  -13.3089136  28.6456077
 [29,]    8.4345809 12.268681  -16.4698905  32.3142097
 [30,]  -10.0527986 14.261268  -38.9664661  17.3946590
 [31,]   47.3385382 13.152038   20.8094722  72.2793676
 [32,]   20.4297282 11.226775   -2.2803676  41.5609711
 [33,]   -1.8803818  9.570001  -21.6376599  15.9469840
 [34,]   -6.3702917  8.343230  -23.2072249   9.4004715
 [35,]  -11.4724017  7.753332  -26.7473564   3.3449379
 [36,]   -5.4506117  7.943483  -21.1554958  10.0907141
 [37,]  -28.5629216  8.863622  -46.0838607 -11.0771144
 [38,]    3.6923684 10.320308  -16.6867243  23.9347600
 [39,]  -14.9858416 12.121626  -38.9944697   8.5517108
 [40,]   27.9469485 14.136442    0.3644671  55.2943706
 [41,]   14.3770419 13.033997  -11.9225085  38.8896107
 [42,]    4.3324290 11.227214  -18.2125371  25.7601516
 [43,]   13.7163162  9.697065   -5.8424249  32.5159972
 [44,]   24.5743034  8.592628    7.7228594  41.5711903
 [45,]   13.2995905  8.090172   -2.6604415  29.4167782
 [46,]  -17.0957223  8.299757  -33.0452249  -1.0289623
 [47,]  -27.7761352  9.172705  -45.8180754 -10.0300512
 [48,]    9.5298520 10.545544  -11.3191872  30.3760691
 [49,]  -38.9776609 12.251365  -62.8440978 -14.5436841
 [50,]   31.4198263 14.170421    4.0172103  59.5845442
 [51,]  -25.5032683 12.412586  -51.0784742  -1.7368182
 [52,]  -27.7862448 10.699203  -49.3962691  -7.7222031
 [53,]   -7.8709214  9.259243  -26.4886706  10.0112906
 [54,]   18.7024021  8.237366    1.8933911  34.6448868
 [55,]   16.1623255  7.799666    0.2185520  31.3840749
 [56,]   -1.5371510  8.042099  -17.8184997  14.3458254
 [57,]  132.3929724  8.909315  114.5589019 149.9053662
 [58,]   14.8279958 10.243848   -5.1169748  34.7801772
 [59,]  -11.9369807 11.889362  -34.9947941  10.9090249
 [60,]  -98.6070573 13.734534 -125.6024299 -71.8247538
 [61,]   16.0088763 12.518556   -9.2870983  40.0772012
 [62,]   11.4255854 10.786164   -9.9760204  32.2364955
 [63,]  -11.6560056  9.347141  -30.0039114   6.3968363
 [64,]    1.0885034  8.354480  -15.1771734  17.6577604
 [65,]  -11.8460876  7.976604  -27.0784210   3.7996049
 [66,]   18.8535214  8.297933    2.6675785  34.9235970
 [67,]    2.4176304  9.245852  -15.7129052  20.3428549
 [68,]    8.9351394 10.654410  -11.9787745  29.4351956
 [69,]  -16.8406516 12.367203  -40.9133166   6.9827511
 [70,]    1.5462575 14.275138  -26.1315449  29.3747605
 [71,]   21.0973467 12.516975   -3.1814295  45.5709315
 [72,]   20.3433865 10.755552   -0.4621549  41.4853136
 [73,]  -23.9751737  9.270275  -42.4641338  -5.8625524
 [74,]  -24.1496339  8.212365  -40.8422751  -8.2166230
 [75,]  -11.2795942  7.758656  -27.0595556   4.0310991
 [76,]  -17.5948544  8.012453  -33.5690091  -2.0962157
 [77,]   -7.7433146  8.913524  -25.5776002   9.3529873
 [78,]    6.7727252 10.293264  -13.4481266  26.5855237
 [79,]   -0.4853350 11.987514  -23.6587519  22.6542461
 [80,]   29.5847048 13.881591    2.7012023  56.1850916
 [81,]   -8.9269824 13.458786  -36.0575204  16.7994045
 [82,]   23.6339125 11.438212    0.8816252  45.5641492
 [83,]    4.3994074  9.702581  -14.4882344  22.9418026
 [84,]   20.9328023  8.429772    4.1355162  37.4874552
 [85,]    1.8045971  7.848286  -13.9474605  17.3485446
 [86,]    5.2108920  8.108250  -10.9800863  21.2503095
 [87,]   -3.7510131  9.138131  -22.0658808  14.1288711
 [88,]  -13.6703182 10.718243  -34.8665814   7.3940426
 [89,]  -13.0052233 12.643956  -38.0276940  11.4849383
 [90,]  -11.2907285 14.780801  -40.1368577  17.3156311
 [91,]   26.4955068 13.181843    0.7382353  52.3200249
 [92,]    8.7543355 11.259957  -13.8512959  30.7342853
 [93,]  -32.6206357  9.620559  -51.8536192 -13.9663021
 [94,]    2.7099930  8.430100  -13.9750725  19.0528798
 [95,]    3.1398218  7.894357  -12.1896544  18.6044386
 [96,]   10.0655505  8.143590   -5.6249382  25.7883079
 [97,]    3.3067792  9.113623  -14.2625757  21.2522978
 [98,]   -3.4413920 10.608538  -23.9654753  17.4719066
 [99,]   16.5502367 12.440536   -7.7197519  40.8974069
[100,]    0.4222655 14.482253  -27.6058294  28.8549993
[101,]    9.5934523 12.887856  -14.7575513  35.5510478
[102,]   -7.7270947 11.056313  -28.7976949  14.2199512
[103,]  -10.6522417  9.506007  -28.8593407   7.9892309
[104,]   -6.1898887  8.394235  -22.3915765  10.2563543
[105,]  -21.9356356  7.908168  -37.5689134  -6.4114844
[106,]  -14.4055826  8.160389  -30.6145301   1.4678883
[107,]  -14.1492296  9.089647  -31.5185306   3.6180076
[108,]    0.8539234 10.518000  -19.4982425  21.7685145
[109,]   17.4984764 12.272403   -6.4501055  42.1057460
[110,]   21.3289294 14.232791   -6.4151026  49.9457811
[111,]   17.5050950 12.882532   -6.5988987  44.0704844
[112,]  -12.3527040 11.055291  -33.5214011  10.1072775
[113,]  -16.6177030  9.519138  -34.4341814   2.5530542
[114,]  -34.3105020  8.434641  -50.1533601 -17.4411666
[115,]  -37.9364010  7.987932  -53.1048851 -22.0987308
[116,]    5.8565001  8.282851  -10.3001183  22.1903818
[117,]   38.5610011  9.248722   20.4851730  56.5631063
[118,]    5.0196021 10.705456  -15.8948651  25.7966666
[119,]   19.5731031 12.482364   -4.4919085  43.7310095
[120,]   -2.8766959 14.461905  -30.3988585  25.2193289
[121,]   -5.2097070 12.671973  -30.8040243  19.8677498
[122,]   36.8209222 10.926373   15.1836429  58.3575906
[123,]   -0.8432486  9.476827  -19.6874560  17.8242506
[124,]    2.3514806  8.476603  -14.1283506  18.8269290
[125,]  -13.9106902  8.094026  -29.6346753   1.9451202
[126,]   11.3950390  8.413776   -5.0590912  27.8844457
[127,]  -12.9924318  9.364183  -31.2470769   5.4013501
[128,]  -41.6440026 10.779708  -62.8630096 -20.8131299
[129,]    5.8018266 12.503368  -18.8510424  30.0573943
[130,]   24.3250558 14.425125   -3.7680227  52.8454388
[131,]  -50.5244753 12.457764  -75.3275427 -26.6052600
[132,]   12.0285038 10.663555   -9.1596516  32.2297985
[133,]   26.7492829  9.155259    9.0664147  44.3835307
[134,]   32.7624621  8.094318   16.5789124  48.2851415
[135,]   20.6833412  7.668706    5.3440118  35.8475324
[136,]   10.8080203  7.980725   -5.3908166  26.7631854
[137,]   -1.5579006  8.953589  -18.9518206  16.2659926
[138,]   -9.5157215 10.403527  -29.8787359  10.9179661
[139,]   -8.2715424 12.161080  -31.8272847  15.3931757
[140,]   -9.3342633 14.111775  -36.8579301  17.5597756
[141,]   17.2569486 12.073835   -6.4347370  41.4450005
[142,]    2.4099840 10.416695  -17.6895728  23.0916425
[143,]  -20.1448806  9.059644  -37.9442708  -1.9492848
[144,]  -11.0910452  8.153918  -27.0510704   4.8389592
[145,]   14.7141901  7.857175   -0.9703873  29.8329988
[146,]    5.7451255  8.235508  -10.9912784  21.4213030
[147,]  -24.6934391  9.206063  -43.3790451  -6.9057871
[148,]   13.9337963 10.607506   -7.3133234  34.3808585
[149,]   -5.2694683 12.293347  -30.0401573  17.9437019
[150,]    9.6032671 14.162385  -18.9043910  36.3464532
[151,]   -0.9373029 13.384415  -26.3411887  26.2010883
[152,]   -6.8736344 11.442071  -28.8957777  16.3757754
[153,]  -17.6921658  9.770448  -36.6121650   1.7072956
[154,]  -31.3157973  8.530215  -47.9509069 -14.5324808
[155,]  -19.4473288  7.926519  -35.1197308  -3.8836473
[156,]   42.0132397  8.102907   26.0025581  58.1725957
[157,]  -36.2281918  9.013696  -54.3881976 -18.7100559
[158,]   15.0133767 10.468934   -6.0405363  35.4241708
[159,]   17.3950452 12.276509   -6.9931071  40.8160437
[160,]    9.2650137 14.303461  -19.4486129  36.8653648
[161,]   17.7444918 12.363423   -7.4821707  41.8432293
[162,]   10.8160762 10.621210  -10.7619758  32.1058016
[163,]    6.7813605  9.160668  -11.7544598  24.9143967
[164,]    1.1811448  8.134953  -15.2154837  17.1380560
[165,]  -10.9286708  7.719388  -25.8920890   4.3224270
[166,]  -15.0779865  8.009514  -30.6764912   0.7816130
[167,]  -49.8150022  8.936865  -67.2574326 -31.8531894
[168,]  -13.9410178 10.331247  -34.3512568   6.4088531
[169,]   22.7182665 12.031361   -1.1074527  45.9956654
[170,]   31.9159509 13.925678    4.4028450  59.5040113
[171,]    5.9983429 12.154262  -18.2996998  29.2344681
[172,]   -1.6865477 10.461136  -22.4558029  18.1774351
[173,]   10.6890617  9.059845   -7.1816024  28.2567749
[174,]   11.9766711  8.103233   -3.9170845  27.8894646
[175,]  -23.2295194  7.757586  -38.2227151  -8.1951595
[176,]    7.4582900  8.101484   -7.8527462  23.2234029
[177,]    0.5852994  9.056716  -16.7638953  18.3622690
[178,]   -2.4237912 10.457070  -22.2190345  18.3925187
[179,]   11.7508183 12.149597  -11.2807647  35.8679763
[180,]   -5.0144723 14.028943  -31.6378494  23.0334567</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.3
p_loo        19.4  3.2
looic      1769.9 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   610       
 (0.5, 0.7]   (ok)         1    0.6%   194       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.2
p_loo        33.8  8.2
looic      1722.0 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   818       
 (0.5, 0.7]   (ok)         5    2.8%   575       
   (0.7, 1]   (bad)        2    1.1%   48        
   (1, Inf)   (very bad)   1    0.6%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.0      11.6  
fit_sleep1 -92.4      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.3
p_loo        19.4  3.2
looic      1769.9 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   610       
 (0.5, 0.7]   (ok)         1    0.6%   194       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.2
p_loo        33.8  8.2
looic      1722.0 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   818       
 (0.5, 0.7]   (ok)         5    2.8%   575       
   (0.7, 1]   (bad)        2    1.1%   48        
   (1, Inf)   (very bad)   1    0.6%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.0     22.2        33.8    8.2   1722.0
fit_sleep2  -24.0      11.6  -884.9     14.3        19.4    3.2   1769.9
fit_sleep1  -92.4      20.9  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.3  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
7.671599e-41 3.919964e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.57     0.25     5.47       0.04      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.57     -3.3     2.99       5.58      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.62.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.2          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        ggridges_0.5.4       callr_3.7.3         
 [34] stringr_1.4.1        digest_0.6.30        minqa_1.2.5         
 [37] rmarkdown_2.18       base64enc_0.1-3      pkgconfig_2.0.3     
 [40] htmltools_0.5.3      highr_0.9            fastmap_1.1.0       
 [43] htmlwidgets_1.5.4    rlang_1.0.6          shiny_1.7.3         
 [46] jquerylib_0.1.4      farver_2.1.1         generics_0.1.3      
 [49] zoo_1.8-11           jsonlite_1.8.3       gtools_3.9.3        
 [52] crosstalk_1.2.0      dplyr_1.0.10         distributional_0.3.1
 [55] inline_0.3.19        magrittr_2.0.3       loo_2.5.1           
 [58] bayesplot_1.9.0      munsell_0.5.0        fansi_1.0.3         
 [61] abind_1.4-5          lifecycle_1.0.3      stringi_1.7.8       
 [64] yaml_2.3.6           MASS_7.3-58.1        plyr_1.8.7          
 [67] pkgbuild_1.3.1       grid_4.2.2           parallel_4.2.2      
 [70] promises_1.2.0.1     crayon_1.5.2         miniUI_0.1.1.1      
 [73] lattice_0.20-45      splines_4.2.2        knitr_1.40          
 [76] ps_1.7.2             pillar_1.8.1         igraph_1.3.5        
 [79] boot_1.3-28          markdown_1.3         shinystan_2.6.0     
 [82] reshape2_1.4.4       codetools_0.2-18     stats4_4.2.2        
 [85] rstantools_2.2.0     glue_1.6.2           evaluate_0.18       
 [88] V8_4.2.1             RcppParallel_5.1.5   vctrs_0.5.0         
 [91] nloptr_2.0.3         httpuv_1.6.6         gtable_0.3.1        
 [94] assertthat_0.2.1     cachem_1.0.6         ggplot2_3.4.0       
 [97] xfun_0.34            mime_0.12            xtable_1.8-4        
[100] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[103] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
