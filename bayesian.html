<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.74      6.67    15.53    41.68 1.00     1711     2187
sd(Days)                6.58      1.61     4.12    10.30 1.00     1202     1355
cor(Intercept,Days)     0.08      0.29    -0.45     0.64 1.00     1092     1785

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.13      7.24   236.76   265.10 1.00     1783     2482
Days         10.38      1.75     7.01    13.93 1.00      983     1051

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.53    23.15    29.02 1.00     3218     2865

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6633  12.85315 227.9805 277.5713
309 211.6491  13.39033 185.8470 236.9381
310 212.9116  13.34280 186.3186 238.3809
330 274.6915  13.53867 249.2798 302.0607
331 273.4100  13.06306 248.3077 299.6436
332 260.7336  12.40094 236.1270 285.6215
333 267.8731  12.62158 244.1223 293.6331
334 244.3661  12.56045 219.0491 268.9979
335 251.1726  13.09480 226.1445 277.5421
337 285.9177  13.01109 260.6053 311.6826
349 226.5738  13.12523 200.1287 251.6316
350 238.6761  13.12153 211.8946 263.1998
351 255.7061  12.70569 231.5443 281.3536
352 272.1452  12.56972 247.6427 296.6866
369 254.8491  12.53408 230.8167 278.8816
370 226.3909  13.40782 199.8601 252.1493
371 252.1250  12.40045 227.8614 276.1268
372 263.7087  12.60427 239.3066 289.3885

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6313630  2.461960 14.9192977 24.509893
309  1.7552715  2.502692 -3.1242611  6.817434
310  4.9146108  2.482544  0.2437679  9.845817
330  5.6802081  2.590383  0.4115351 10.705754
331  7.4817674  2.486204  2.5347439 12.335182
332 10.1569804  2.351619  5.5386992 14.796272
333 10.3132274  2.414110  5.5249629 14.996110
334 11.5492163  2.384891  6.9719761 16.331922
335 -0.2718485  2.532062 -5.3725790  4.489581
337 19.1433660  2.503743 14.3174955 24.130911
349 11.6079240  2.501932  6.9523103 16.639780
350 17.0062312  2.515764 12.1808955 21.888466
351  7.5333458  2.424539  2.6186089 12.332278
352 14.0075240  2.437259  9.1362403 18.787146
369 11.3372855  2.410963  6.7356716 16.031538
370 15.1960420  2.534093 10.3416330 20.421170
371  9.4875637  2.421434  4.8708205 14.220364
372 11.7534688  2.404913  6.9779325 16.550649</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6633 12.853152 227.9805 277.5713
  [2,] 273.2946 11.013029 251.3028 294.1496
  [3,] 292.9260  9.460052 273.8583 311.2578
  [4,] 312.5573  8.355888 295.7633 328.5671
  [5,] 332.1887  7.891238 316.0106 347.3258
  [6,] 351.8201  8.175873 334.9829 367.1766
  [7,] 371.4514  9.140058 353.0596 388.7984
  [8,] 391.0828 10.599948 369.8819 411.3620
  [9,] 410.7142 12.381423 385.9334 434.9123
 [10,] 430.3455 14.365336 401.6427 458.9361
 [11,] 211.6491 13.390330 185.8470 236.9381
 [12,] 213.4044 11.479539 191.4299 234.9522
 [13,] 215.1597  9.837968 196.2360 233.9377
 [14,] 216.9149  8.620810 200.0878 233.5523
 [15,] 218.6702  8.023593 202.7589 234.4885
 [16,] 220.4255  8.183193 204.3500 236.4514
 [17,] 222.1807  9.059702 204.2464 239.5392
 [18,] 223.9360 10.474668 203.1759 244.1437
 [19,] 225.6913 12.242798 201.6514 249.3083
 [20,] 227.4466 14.233076 199.5132 255.2670
 [21,] 212.9116 13.342800 186.3186 238.3809
 [22,] 217.8262 11.452846 195.0306 239.8712
 [23,] 222.7408  9.830112 203.1554 242.0739
 [24,] 227.6554  8.626736 210.7472 244.8953
 [25,] 232.5700  8.033436 216.8685 248.7255
 [26,] 237.4846  8.183988 221.7478 254.0413
 [27,] 242.3993  9.041310 224.8879 260.5774
 [28,] 247.3139 10.432591 226.7300 268.0591
 [29,] 252.2285 12.176153 228.4941 276.1655
 [30,] 257.1431 14.142294 229.9593 285.2053
 [31,] 274.6915 13.538671 249.2798 302.0607
 [32,] 280.3717 11.536244 258.7625 303.7248
 [33,] 286.0519  9.812971 267.5263 306.1513
 [34,] 291.7321  8.539558 275.3200 308.8001
 [35,] 297.4123  7.935607 282.0440 313.2027
 [36,] 303.0925  8.151308 287.1083 319.0212
 [37,] 308.7727  9.128743 290.7108 326.8127
 [38,] 314.4529 10.660406 293.1933 335.6442
 [39,] 320.1331 12.544908 295.2663 344.7765
 [40,] 325.8134 14.646684 296.9533 354.4313
 [41,] 273.4100 13.063059 248.3077 299.6436
 [42,] 280.8918 11.184248 259.2790 303.3065
 [43,] 288.3736  9.586121 269.0582 307.1272
 [44,] 295.8553  8.429854 278.7508 312.4611
 [45,] 303.3371  7.911612 287.5193 318.6480
 [46,] 310.8189  8.153968 295.0519 326.7114
 [47,] 318.3006  9.096329 300.9258 336.5610
 [48,] 325.7824 10.552802 305.6837 347.1070
 [49,] 333.2642 12.342710 309.8887 358.1751
 [50,] 340.7459 14.341750 313.4148 369.4610
 [51,] 260.7336 12.400943 236.1270 285.6215
 [52,] 270.8906 10.686372 249.8525 292.1856
 [53,] 281.0476  9.256023 262.9564 299.3914
 [54,] 291.2045  8.258910 275.3366 307.7104
 [55,] 301.3615  7.861644 286.2469 317.2126
 [56,] 311.5185  8.152394 295.9715 327.6024
 [57,] 321.6755  9.065200 304.5576 340.0091
 [58,] 331.8325 10.438122 312.3691 353.0565
 [59,] 341.9894 12.115740 319.2357 366.4829
 [60,] 352.1464 13.988858 325.8608 379.9578
 [61,] 267.8731 12.621578 244.1223 293.6331
 [62,] 278.1863 10.834830 257.8656 300.5361
 [63,] 288.4995  9.334812 270.9537 307.4353
 [64,] 298.8127  8.278873 283.1101 315.4510
 [65,] 309.1260  7.848350 294.1758 324.9262
 [66,] 319.4392  8.143053 303.5189 335.3681
 [67,] 329.7524  9.092738 312.0642 347.6450
 [68,] 340.0657 10.521516 319.3381 360.6341
 [69,] 350.3789 12.263058 326.7819 374.7085
 [70,] 360.6921 14.202771 333.2981 388.7453
 [71,] 244.3661 12.560448 219.0491 268.9979
 [72,] 255.9153 10.814194 234.4249 277.1718
 [73,] 267.4645  9.354365 248.8825 285.6739
 [74,] 279.0138  8.332881 262.5180 294.9514
 [75,] 290.5630  7.921178 274.9173 305.6187
 [76,] 302.1122  8.211495 285.5012 317.7757
 [77,] 313.6614  9.137156 295.3048 331.3493
 [78,] 325.2106 10.531952 303.8032 345.9299
 [79,] 336.7598 12.236495 312.4789 361.2314
 [80,] 348.3091 14.139202 320.2709 376.1844
 [81,] 251.1726 13.094803 226.1445 277.5421
 [82,] 250.9008 11.191704 229.3656 272.9981
 [83,] 250.6289  9.584220 232.2934 269.1589
 [84,] 250.3571  8.442926 234.1709 266.4255
 [85,] 250.0853  7.970658 234.1701 265.5882
 [86,] 249.8134  8.282660 232.8688 266.3826
 [87,] 249.5416  9.300334 230.9387 267.7392
 [88,] 249.2697 10.826479 227.8724 270.5743
 [89,] 248.9979 12.678791 224.0440 273.8214
 [90,] 248.7260 14.734773 219.2304 277.6867
 [91,] 285.9177 13.011087 260.6053 311.6826
 [92,] 305.0611 11.146897 283.3247 326.8941
 [93,] 324.2044  9.578921 304.9828 342.7395
 [94,] 343.3478  8.473228 326.5500 360.0951
 [95,] 362.4912  8.023273 346.9929 378.1547
 [96,] 381.6345  8.335929 365.6628 398.2586
 [97,] 400.7779  9.334879 382.8917 418.8201
 [98,] 419.9213 10.831883 398.8979 441.0199
 [99,] 439.0646 12.651358 414.3836 463.8010
[100,] 458.2080 14.673838 429.7204 486.9834
[101,] 226.5738 13.125232 200.1287 251.6316
[102,] 238.1817 11.231570 215.5528 259.7938
[103,] 249.7897  9.619975 230.5513 268.6537
[104,] 261.3976  8.453343 244.5717 278.1150
[105,] 273.0055  7.930537 257.2594 288.4742
[106,] 284.6134  8.176011 268.1831 300.5679
[107,] 296.2214  9.127992 277.6697 313.4382
[108,] 307.8293 10.597766 286.0661 327.7906
[109,] 319.4372 12.402595 294.2289 343.2516
[110,] 331.0451 14.417192 301.7814 358.9232
[111,] 238.6761 13.121533 211.8946 263.1998
[112,] 255.6824 11.204913 232.8189 276.8243
[113,] 272.6886  9.569936 253.3278 290.8014
[114,] 289.6948  8.383043 273.0754 305.2975
[115,] 306.7011  7.850177 290.9286 321.3059
[116,] 323.7073  8.101437 307.4319 339.1126
[117,] 340.7135  9.071902 322.6492 358.0365
[118,] 357.7197 10.565211 337.0245 378.0464
[119,] 374.7260 12.393792 350.2439 398.9591
[120,] 391.7322 14.430752 363.3820 419.9320
[121,] 255.7061 12.705693 231.5443 281.3536
[122,] 263.2394 10.898346 242.2774 285.2253
[123,] 270.7728  9.373902 252.7505 289.4832
[124,] 278.3061  8.289928 262.4429 294.9311
[125,] 285.8395  7.831510 270.5879 301.0905
[126,] 293.3728  8.105490 277.7130 309.1698
[127,] 300.9061  9.045561 283.1767 318.6605
[128,] 308.4395 10.473880 287.5396 329.1965
[129,] 315.9728 12.220431 291.4430 340.2359
[130,] 323.5062 14.168009 295.2678 351.5511
[131,] 272.1452 12.569724 247.6427 296.6866
[132,] 286.1527 10.779076 265.5316 306.7176
[133,] 300.1602  9.287598 282.2828 317.7652
[134,] 314.1677  8.258990 298.2123 329.7660
[135,] 328.1753  7.876728 312.6639 342.9982
[136,] 342.1828  8.231356 325.8269 357.7103
[137,] 356.1903  9.238402 337.9822 373.4772
[138,] 370.1978 10.715474 349.3164 390.4683
[139,] 384.2053 12.497007 359.8840 408.5539
[140,] 398.2129 14.470986 370.2577 426.8552
[141,] 254.8491 12.534076 230.8167 278.8816
[142,] 266.1864 10.757158 245.1177 286.7561
[143,] 277.5236  9.271211 259.1846 295.7863
[144,] 288.8609  8.235274 272.5406 305.1482
[145,] 300.1982  7.830045 284.9595 315.6627
[146,] 311.5355  8.150151 295.6866 327.1191
[147,] 322.8728  9.119529 304.9272 340.3560
[148,] 334.2101 10.560878 313.7310 355.1817
[149,] 345.5474 12.309507 321.7374 369.7459
[150,] 356.8846 14.252764 329.2016 384.7636
[151,] 226.3909 13.407815 199.8601 252.1493
[152,] 241.5869 11.451544 218.8389 263.7545
[153,] 256.7830  9.764706 237.7333 276.0094
[154,] 271.9790  8.509075 255.3333 289.0510
[155,] 287.1751  7.893192 271.8089 303.0687
[156,] 302.3711  8.064977 286.6306 318.1784
[157,] 317.5672  8.979337 299.4609 335.1425
[158,] 332.7632 10.443006 311.9445 353.1201
[159,] 347.9592 12.260812 323.6425 372.4787
[160,] 363.1553 14.298318 334.5863 392.3465
[161,] 252.1250 12.400446 227.8614 276.1268
[162,] 261.6126 10.590668 240.7746 281.9259
[163,] 271.1002  9.070839 253.2906 288.4053
[164,] 280.5877  8.007789 264.8421 296.1065
[165,] 290.0753  7.595784 275.2473 305.0953
[166,] 299.5629  7.936868 284.0881 315.4322
[167,] 309.0504  8.945306 291.5466 326.9071
[168,] 318.5380 10.429276 298.0794 339.1999
[169,] 328.0255 12.216702 304.4718 351.8358
[170,] 337.5131 14.193396 309.9257 365.2153
[171,] 263.7087 12.604274 239.3066 289.3885
[172,] 275.4622 10.842527 254.4825 297.5162
[173,] 287.2156  9.371247 268.9958 306.1646
[174,] 298.9691  8.345500 282.3691 315.6259
[175,] 310.7226  7.939878 295.1692 326.2418
[176,] 322.4761  8.246404 306.1080 338.1418
[177,] 334.2295  9.194124 315.9660 351.7554
[178,] 345.9830 10.612627 324.9006 366.6237
[179,] 357.7365 12.340624 333.5052 381.8722
[180,] 369.4899 14.266092 341.3442 397.4986</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.1032565 12.853152  -28.0112992  21.5795418
  [2,]  -14.5899196 11.013029  -35.4448585   7.4018600
  [3,]  -42.1253826  9.460052  -60.4571541 -23.0577000
  [4,]    8.8824543  8.355888   -7.1272620  25.6765153
  [5,]   24.6631913  7.891238    9.5260766  40.8413419
  [6,]   62.8700282  8.175873   47.5135152  79.7072208
  [7,]   10.7523652  9.140058   -6.5946178  29.1442032
  [8,] -100.9341978 10.599948 -121.2134057 -79.7333090
  [9,]   19.8711391 12.381423   -4.3269549  44.6519348
 [10,]   36.0079761 14.365336    7.4174165  64.7107909
 [11,]   11.0847889 13.390330  -14.2042413  36.8868738
 [12,]   -8.1385826 11.479539  -29.6864413  13.8358788
 [13,]  -12.1818541  9.837968  -30.9599445   6.7418220
 [14,]  -12.2079256  8.620810  -28.8452781   4.6191749
 [15,]  -10.9540970  8.023593  -26.7723715   4.9572045
 [16,]   -4.4636685  8.183193  -20.4895672  11.6118085
 [17,]   -8.5504400  9.059702  -25.9088643   9.3838893
 [18,]   -6.2088115 10.474668  -26.4164789  14.5513444
 [19,]   -1.3955830 12.242798  -25.0126105  22.6442634
 [20,]    9.8676455 14.233076  -17.9527877  37.8010229
 [21,]  -13.8576896 13.342800  -39.3270027  12.7353029
 [22,]  -23.4940005 11.452846  -45.5390336  -0.6984346
 [23,]   11.5791887  9.830112   -7.7539247  31.1645907
 [24,]    5.1861779  8.626736  -12.0536511  22.0943536
 [25,]   -3.2626329  8.033436  -19.4181025  12.4388535
 [26,]  -17.0267437  8.183988  -33.5834340  -1.2899229
 [27,]   -6.9784545  9.041310  -25.1566385  10.5328597
 [28,]    8.4372347 10.432591  -12.3079602  29.0210618
 [29,]    8.7840239 12.176153  -15.1529618  32.5183929
 [30,]   -9.6277869 14.142294  -37.6900389  17.5559976
 [31,]   46.8511152 13.538671   19.4819445  72.2627950
 [32,]   20.0285072 11.536244   -3.3245581  41.6377238
 [33,]   -2.1954009  9.812971  -22.2947839  16.3301988
 [34,]   -6.5991089  8.539558  -23.6671456   9.8130185
 [35,]  -11.6150170  7.935607  -27.4054462   3.7533235
 [36,]   -5.5070250  8.151308  -21.4356696  10.4772452
 [37,]  -28.5331331  9.128743  -46.5731370 -10.4711910
 [38,]    3.8083589 10.660406  -17.3829075  25.0680353
 [39,]  -14.7836492 12.544908  -39.4269975  10.0831818
 [40,]   28.2353428 14.646684   -0.3825734  57.0954235
 [41,]   14.1978770 13.063059  -12.0357064  39.3002339
 [42,]    4.1082096 11.184248  -18.3064850  25.7209889
 [43,]   13.4470422  9.586121   -5.3066434  32.7624299
 [44,]   24.2599748  8.429854    7.6542301  41.3645352
 [45,]   12.9402073  7.911612   -2.3707455  28.7579507
 [46,]  -17.5001601  8.153968  -33.3926514  -1.7331674
 [47,]  -28.2256275  9.096329  -46.4860405 -10.8508435
 [48,]    9.0353051 10.552802  -12.2892891  29.1340475
 [49,]  -39.5172623 12.342710  -64.4282490 -16.1418100
 [50,]   30.8351703 14.341750    2.1201100  58.1663099
 [51,]  -25.8729993 12.400943  -50.7609117  -1.2663718
 [52,]  -28.0787797 10.686372  -49.3738188  -7.0407264
 [53,]   -8.0862601  9.256023  -26.4300875  10.0048590
 [54,]   18.5642595  8.258910    2.0584069  34.4322057
 [55,]   16.1013791  7.861644    0.2502919  31.2160401
 [56,]   -1.5209013  8.152394  -17.6047639  14.0260586
 [57,]  132.4864182  9.065200  114.1527984 149.6042509
 [58,]   14.9986378 10.438122   -6.2253900  34.4620372
 [59,]  -11.6891426 12.115740  -36.1825671  11.0645616
 [60,]  -98.2820230 13.988858 -126.0934330 -71.9964033
 [61,]   15.9693343 12.621578   -9.7906562  39.7200931
 [62,]   11.3687068 10.834830  -10.9810976  31.6893898
 [63,]  -11.7302206  9.334812  -30.6659710   5.8156429
 [64,]    0.9969519  8.278873  -15.6413085  16.6996317
 [65,]  -11.9549755  7.848350  -27.7551997   2.9951938
 [66,]   18.7272971  8.143053    2.7984051  34.6475987
 [67,]    2.2740696  9.092738  -15.6185378  19.9622551
 [68,]    8.7742422 10.521516  -11.7942178  29.5018038
 [69,]  -17.0188852 12.263058  -41.3484530   6.5781063
 [70,]    1.3506873 14.202771  -26.7025294  28.7447444
 [71,]   21.1069870 12.560448   -3.5247924  46.4240071
 [72,]   20.2858707 10.814194   -0.9705578  41.7763027
 [73,]  -24.0998457  9.354365  -42.3091936  -5.5178349
 [74,]  -24.3414620  8.332881  -40.2791042  -7.8456769
 [75,]  -11.5385784  7.921178  -26.5942958   4.1071358
 [76,]  -17.9209947  8.211495  -33.5845122  -1.3100188
 [77,]   -8.1366111  9.137156  -25.8244544  10.2200446
 [78,]    6.3122726 10.531952  -14.4070201  27.7197455
 [79,]   -1.0129438 12.236495  -25.4844781  23.2679847
 [80,]   28.9899399 14.139202    1.1146253  57.0280536
 [81,]   -9.5643461 13.094803  -35.9338357  15.4637607
 [82,]   23.0464024 11.191704    0.9490526  44.5815865
 [83,]    3.8617509  9.584220  -14.6681925  22.1973297
 [84,]   20.4449994  8.442926    4.3765584  36.6312381
 [85,]    1.3666479  7.970658  -14.1363157  17.2817733
 [86,]    4.8227964  8.282660  -11.7464392  21.7674142
 [87,]   -4.0892551  9.300334  -22.2868776  14.5136127
 [88,]  -13.9587066 10.826479  -35.2632533   7.4386456
 [89,]  -13.2437581 12.678791  -38.0672595  11.7100859
 [90,]  -11.4794096 14.734773  -40.4400503  18.0161917
 [91,]   26.4488925 13.011087    0.6839810  51.7612830
 [92,]    8.7447266 11.146897  -13.0883151  30.4810518
 [93,]  -32.5932394  9.578921  -51.1283060 -13.3715802
 [94,]    2.7743947  8.473228  -13.9728587  19.5721838
 [95,]    3.2412287  8.023273  -12.4222856  18.7395221
 [96,]   10.2039627  8.335929   -6.4201140  26.1757119
 [97,]    3.4821968  9.334879  -14.5600422  21.3684406
 [98,]   -3.2289692 10.831883  -24.3275836  17.7943812
 [99,]   16.7996649 12.651358   -7.9366645  41.4807086
[100,]    0.7086989 14.673838  -28.0666889  29.1962970
[101,]    9.5293865 13.125232  -15.5283787  35.9745352
[102,]   -7.8650374 11.231570  -29.4770572  14.7638773
[103,]  -10.8640614  9.619975  -29.7281108   8.3743267
[104,]   -6.4755854  8.453343  -23.1929885  10.3503445
[105,]  -22.2952094  7.930537  -37.7638906  -6.5490896
[106,]  -14.8390334  8.176011  -30.7935497   1.5913370
[107,]  -14.6565574  9.127992  -31.8734376   3.8950737
[108,]    0.2727186 10.597766  -19.6886157  22.0358951
[109,]   16.8433947 12.402595   -6.9710119  42.0517429
[110,]   20.5999707 14.417192   -7.2781249  49.8637010
[111,]   17.6206689 13.121533   -6.9030267  44.4021635
[112,]  -12.2280623 11.204913  -33.3699843  10.6353820
[113,]  -16.4839935  9.569936  -34.5967573   2.8768161
[114,]  -34.1677248  8.383043  -49.7703522 -17.5483380
[115,]  -37.7845560  7.850177  -52.3893506 -22.0120543
[116,]    6.0174128  8.101437   -9.3878873  22.2928466
[117,]   38.7309816  9.071902   21.4079796  56.7952912
[118,]    5.1986504 10.565211  -15.1279935  25.8938842
[119,]   19.7612192 12.393792   -4.4719475  44.2433216
[120,]   -2.6795120 14.430752  -30.8793354  25.6706508
[121,]   -5.1795685 12.705693  -30.8270794  18.9822360
[122,]   36.8181858 10.898346   14.8322901  57.7801610
[123,]   -0.8788600  9.373902  -19.5893259  17.1433608
[124,]    2.2829943  8.289928  -14.3419725  18.1461522
[125,]  -14.0120515  7.831510  -29.2631076   1.2394960
[126,]   11.2608027  8.105490   -4.5361916  26.9206160
[127,]  -13.1595430  9.045561  -30.9139098   4.5698795
[128,]  -41.8439888 10.473880  -62.6010029 -20.9440926
[129,]    5.5689654 12.220431  -18.6941059  30.0987816
[130,]   24.0593197 14.168009   -3.9856371  52.2976975
[131,]  -50.4680567 12.569724  -75.0094939 -25.9655727
[132,]   12.0412193 10.779076   -8.5236588  32.6622997
[133,]   26.7182953  9.287598    9.1132929  44.5956907
[134,]   32.6877714  8.258990   17.0894602  48.6431700
[135,]   20.5649474  7.876728    5.7419709  36.0762844
[136,]   10.6459234  8.231356   -4.8816047  27.0018345
[137,]   -1.7637006  9.238402  -19.0506461  16.4444217
[138,]   -9.7652246 10.715474  -30.0357046  11.1161816
[139,]   -8.5647486 12.497007  -32.9132914  15.7566307
[140,]   -9.6711725 14.470986  -38.3135340  18.2840252
[141,]   17.0744306 12.534076   -6.9581158  41.1067786
[142,]    2.2505450 10.757158  -18.3191727  23.3191890
[143,]  -20.2812405  9.271211  -38.5438752  -1.9421633
[144,]  -11.2043260  8.235274  -27.4916390   5.1160154
[145,]   14.6239885  7.830045   -0.8405056  29.8627356
[146,]    5.6780029  8.150151   -9.9055904  21.5269102
[147,]  -24.7374826  9.119529  -42.2207143  -6.7919176
[148,]   13.9128319 10.560878   -7.0587693  34.3919153
[149,]   -5.2673536 12.309507  -29.4658905  18.5426433
[150,]    9.6284608 14.252764  -18.2505262  37.3115010
[151,]   -1.1269038 13.407815  -26.8852675  25.4038869
[152,]   -7.0634458 11.451544  -29.2309780  15.6846041
[153,]  -17.8821878  9.764706  -37.1085630   1.1674904
[154,]  -31.5060298  8.509075  -48.5779854 -14.8603342
[155,]  -19.6377717  7.893192  -35.5313987  -4.2716300
[156,]   41.8225863  8.064977   26.0152963  57.5630719
[157,]  -36.4190557  8.979337  -53.9943577 -18.3128318
[158,]   14.8223023 10.443006   -5.5346426  35.6409788
[159,]   17.2037603 12.260812   -7.3157049  41.5204976
[160,]    9.0735183 14.298318  -20.1176790  37.6424940
[161,]   17.7553675 12.400446   -6.2464194  42.0189966
[162,]   10.8302038 10.590668   -9.4831288  31.6681529
[163,]    6.7987401  9.070839  -10.5064119  24.6082903
[164,]    1.2017764  8.007789  -14.3170264  16.9474407
[165,]  -10.9047873  7.595784  -25.9248066   3.9231556
[166,]  -15.0508511  7.936868  -30.9202450   0.4238843
[167,]  -49.7846148  8.945306  -67.6413419 -32.2807604
[168,]  -13.9073785 10.429276  -34.5693263   6.5512038
[169,]   22.7551578 12.216702   -1.0550585  46.3089387
[170,]   31.9560941 14.193396    4.2539271  59.5434669
[171,]    5.7029928 12.604274  -19.9767951  30.1050748
[172,]   -1.9881760 10.842527  -24.0421738  18.9915399
[173,]   10.3811552  9.371247   -8.5677856  28.6009733
[174,]   11.6624864  8.345500   -4.9943114  28.2624937
[175,]  -23.5499824  7.939878  -39.0692427  -7.9966322
[176,]    7.1315488  8.246404   -8.5342006  23.4996224
[177,]    0.2522800  9.194124  -17.2735614  18.5157624
[178,]   -2.7630888 10.612627  -23.4038318  18.3192706
[179,]   11.4052424 12.340624  -12.7305291  35.6364639
[180,]   -5.3663264 14.266092  -33.3750063  22.7794347</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.5
p_loo        19.4  3.4
looic      1769.7 29.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1691      
 (0.5, 0.7]   (ok)         1    0.6%   403       
   (0.7, 1]   (bad)        1    0.6%   97        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.6 22.0
p_loo        33.5  8.1
looic      1721.3 44.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1115      
 (0.5, 0.7]   (ok)         6    3.3%   410       
   (0.7, 1]   (bad)        2    1.1%   58        
   (1, Inf)   (very bad)   1    0.6%   21        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.2      11.3  
fit_sleep1 -92.6      20.7  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.5
p_loo        19.4  3.4
looic      1769.7 29.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1691      
 (0.5, 0.7]   (ok)         1    0.6%   403       
   (0.7, 1]   (bad)        1    0.6%   97        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.6 22.0
p_loo        33.5  8.1
looic      1721.3 44.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1115      
 (0.5, 0.7]   (ok)         6    3.3%   410       
   (0.7, 1]   (bad)        2    1.1%   58        
   (1, Inf)   (very bad)   1    0.6%   21        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.6     22.0        33.5    8.1   1721.3
fit_sleep2  -24.2      11.3  -884.8     14.5        19.4    3.4   1769.7
fit_sleep1  -92.6      20.7  -953.2     10.5         3.1    0.5   1906.5
           se_looic
fit_sleep3   44.0  
fit_sleep2   29.0  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.100958e-41 3.145472e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.83      1.58     0.14      5.3       0.05      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.17      1.58    -3.39      2.8       5.87      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.6.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.19      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.1   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.19        V8_4.2.2            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.7         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
