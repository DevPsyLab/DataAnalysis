<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.97      6.81    15.45    42.17 1.00     1479     2327
sd(Days)                6.56      1.50     4.14    10.18 1.00     1316     1938
cor(Intercept,Days)     0.07      0.30    -0.49     0.66 1.00      723     1509

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.24      7.33   236.57   265.27 1.00     1950     2376
Days         10.41      1.69     6.87    13.64 1.01     1392     1403

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.55    23.11    29.12 1.00     3616     2698

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6352  13.15160 227.3344 278.8503
309 211.5237  13.70278 184.8093 237.8582
310 212.7651  13.29437 186.6261 238.7636
330 274.7734  13.43435 249.7375 301.4836
331 273.4785  12.87681 249.3529 299.6107
332 260.3022  12.22559 236.4385 284.3109
333 267.8685  12.51694 243.8219 292.3766
334 244.6577  12.17290 220.0646 268.3922
335 251.0379  13.25251 225.8348 277.8329
337 286.0406  13.08694 260.5291 311.7967
349 226.4741  12.90266 200.8278 251.1742
350 238.2830  13.26287 212.2989 263.4517
351 255.8413  12.11317 232.7333 279.7166
352 272.1139  12.34814 248.7768 296.7514
369 254.6185  12.52890 230.1484 278.9198
370 226.1645  13.76810 198.5962 253.0211
371 252.2119  12.24210 228.1766 275.6732
372 263.6204  12.53337 238.9901 288.5153

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6395734  2.511249 14.7339705 24.803021
309  1.7563253  2.581546 -3.4997732  6.692158
310  4.9794634  2.494199  0.1186662  9.866413
330  5.6859871  2.576758  0.4656226 10.464445
331  7.4639685  2.450405  2.5676680 12.137435
332 10.2242329  2.342217  5.6257127 14.739456
333 10.2488689  2.351341  5.6615659 14.856744
334 11.4238640  2.357520  6.8738412 16.043426
335 -0.2752595  2.586566 -5.3371717  4.770843
337 19.1516858  2.459414 14.3259505 23.964014
349 11.5603017  2.415128  7.0017108 16.506573
350 17.0992932  2.542717 12.2478773 22.072699
351  7.4761625  2.340162  2.8208889 12.023980
352 14.0016848  2.344026  9.3349722 18.527484
369 11.3630281  2.389722  6.6333880 16.009616
370 15.2182642  2.620679 10.1380274 20.305106
371  9.4929809  2.338459  5.0190920 14.127144
372 11.7888594  2.409599  7.0888853 16.505834</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6352 13.151602 227.3344 278.8503
  [2,] 273.2748 11.243371 250.7929 294.8045
  [3,] 292.9143  9.616386 274.3381 311.4646
  [4,] 312.5539  8.434994 296.4283 328.6925
  [5,] 332.1935  7.901651 316.9514 348.0567
  [6,] 351.8330  8.144679 336.5192 368.0969
  [7,] 371.4726  9.102101 354.0282 389.3909
  [8,] 391.1122 10.581750 370.4403 411.8055
  [9,] 410.7518 12.398039 387.0921 434.9159
 [10,] 430.3913 14.424356 402.5353 458.6210
 [11,] 211.5237 13.702775 184.8093 237.8582
 [12,] 213.2800 11.717141 189.9469 235.9661
 [13,] 215.0364 10.007274 194.8144 234.3631
 [14,] 216.7927  8.736613 199.1042 233.4987
 [15,] 218.5490  8.114188 202.5853 234.2851
 [16,] 220.3053  8.287366 204.2113 236.5256
 [17,] 222.0617  9.211384 203.9919 240.1109
 [18,] 223.8180 10.693340 202.5246 244.7035
 [19,] 225.5743 12.536913 200.8441 249.6222
 [20,] 227.3306 14.605808 198.5153 255.3585
 [21,] 212.7651 13.294369 186.6261 238.7636
 [22,] 217.7445 11.410781 195.5812 240.1380
 [23,] 222.7240  9.803756 203.5801 241.6995
 [24,] 227.7034  8.629219 210.7491 244.6844
 [25,] 232.6829  8.078073 216.2742 248.7862
 [26,] 237.6624  8.275817 221.2166 253.8340
 [27,] 242.6418  9.174154 223.9332 260.6959
 [28,] 247.6213 10.596372 226.2743 268.2061
 [29,] 252.6008 12.362976 227.8479 276.5877
 [30,] 257.5802 14.347309 229.1524 285.5626
 [31,] 274.7734 13.434349 249.7375 301.4836
 [32,] 280.4594 11.478416 259.2328 303.1903
 [33,] 286.1454  9.813547 267.5691 305.3198
 [34,] 291.8314  8.610269 275.1394 308.5025
 [35,] 297.5173  8.077568 281.6917 313.3173
 [36,] 303.2033  8.344870 286.5549 319.7830
 [37,] 308.8893  9.343765 290.6894 327.2616
 [38,] 314.5753 10.874484 293.2208 335.7061
 [39,] 320.2613 12.746851 295.6630 345.2387
 [40,] 325.9473 14.832040 297.2391 354.8693
 [41,] 273.4785 12.876811 249.3529 299.6107
 [42,] 280.9425 11.022783 260.1940 303.4437
 [43,] 288.4065  9.444586 270.2028 307.1163
 [44,] 295.8705  8.301062 279.6441 312.2037
 [45,] 303.3344  7.786144 288.0377 317.9930
 [46,] 310.7984  8.021809 295.2134 326.2815
 [47,] 318.2624  8.948953 301.0218 335.4472
 [48,] 325.7263 10.383982 305.2210 345.6116
 [49,] 333.1903 12.148226 309.4398 355.9123
 [50,] 340.6543 14.118805 313.4219 367.5655
 [51,] 260.3022 12.225594 236.4385 284.3109
 [52,] 270.5265 10.543161 250.0924 291.3478
 [53,] 280.7507  9.155506 263.1586 299.3626
 [54,] 290.9749  8.213421 275.0305 307.1070
 [55,] 301.1992  7.878405 286.0058 316.3263
 [56,] 311.4234  8.224974 295.7722 326.9867
 [57,] 321.6476  9.176225 304.1344 338.9576
 [58,] 331.8719 10.570145 311.6097 352.1853
 [59,] 342.0961 12.256623 318.1344 366.0281
 [60,] 352.3203 14.131298 324.7571 379.9055
 [61,] 267.8685 12.516937 243.8219 292.3766
 [62,] 278.1173 10.788197 257.0741 299.0088
 [63,] 288.3662  9.335646 270.0295 306.5095
 [64,] 298.6151  8.305480 282.0597 314.7935
 [65,] 308.8639  7.865450 292.9530 324.1429
 [66,] 319.1128  8.112165 303.0475 334.7105
 [67,] 329.3617  8.989258 311.4084 347.0526
 [68,] 339.6105 10.337499 319.2826 360.2815
 [69,] 349.8594 11.999109 326.5017 374.1136
 [70,] 360.1083 13.861853 333.0335 387.9439
 [71,] 244.6577 12.172898 220.0646 268.3922
 [72,] 256.0816 10.496698 234.6306 276.4136
 [73,] 267.5054  9.126758 249.3235 285.4584
 [74,] 278.9293  8.217697 262.7820 294.9435
 [75,] 290.3532  7.929639 274.7496 306.1590
 [76,] 301.7770  8.327281 284.9743 318.3870
 [77,] 313.2009  9.323295 294.6229 331.5959
 [78,] 324.6247 10.752667 303.3918 345.6517
 [79,] 336.0486 12.467224 311.8018 360.5418
 [80,] 347.4725 14.365211 319.5079 375.1647
 [81,] 251.0379 13.252508 225.8348 277.8329
 [82,] 250.7626 11.290271 228.9379 273.4715
 [83,] 250.4874  9.627675 231.9602 269.5855
 [84,] 250.2121  8.443617 233.7932 266.9195
 [85,] 249.9368  7.954739 234.6046 265.8835
 [86,] 249.6616  8.285031 233.9938 265.8557
 [87,] 249.3863  9.348061 231.5381 267.8993
 [88,] 249.1111 10.932127 227.7606 271.3887
 [89,] 248.8358 12.845902 223.9282 274.5497
 [90,] 248.5605 14.963410 219.0670 278.6093
 [91,] 286.0406 13.086939 260.5291 311.7967
 [92,] 305.1923 11.251214 283.2567 327.1988
 [93,] 324.3440  9.695829 305.3084 343.4325
 [94,] 343.4957  8.574720 326.8298 360.0889
 [95,] 362.6473  8.070934 346.6404 378.3911
 [96,] 381.7990  8.297685 365.0858 398.0836
 [97,] 400.9507  9.201120 382.9820 418.7538
 [98,] 420.1024 10.609764 399.7039 441.1676
 [99,] 439.2541 12.351963 415.4364 463.7709
[100,] 458.4058 14.306374 430.6525 486.8296
[101,] 226.4741 12.902661 200.8278 251.1742
[102,] 238.0344 11.109007 215.8482 259.4107
[103,] 249.5947  9.592033 230.4855 268.1143
[104,] 261.1550  8.501167 244.1717 277.8453
[105,] 272.7153  8.012382 257.1440 288.6232
[106,] 284.2756  8.233613 268.2419 300.9533
[107,] 295.8359  9.113297 278.2327 314.1618
[108,] 307.3962 10.487024 287.2161 328.3641
[109,] 318.9565 12.188882 295.1474 343.5878
[110,] 330.5168 14.100557 303.2443 358.6892
[111,] 238.2830 13.262872 212.2989 263.4517
[112,] 255.3823 11.314244 233.1321 276.3475
[113,] 272.4816  9.646310 253.7105 290.7943
[114,] 289.5809  8.427413 273.0585 305.6420
[115,] 306.6802  7.869060 290.9440 322.1378
[116,] 323.7795  8.108868 307.5440 339.5361
[117,] 340.8788  9.083843 323.0558 358.7321
[118,] 357.9781 10.592898 337.4332 378.8664
[119,] 375.0774 12.443215 350.9824 399.3587
[120,] 392.1767 14.504776 363.7385 420.5828
[121,] 255.8413 12.113170 232.7333 279.7166
[122,] 263.3174 10.454067 243.6491 284.2628
[123,] 270.7936  9.099386 253.2151 288.9185
[124,] 278.2698  8.201395 261.9643 294.2888
[125,] 285.7459  7.917047 270.1285 301.4028
[126,] 293.2221  8.309579 276.3282 309.3933
[127,] 300.6983  9.293615 282.1123 318.6964
[128,] 308.1744 10.707295 287.0571 328.7109
[129,] 315.6506 12.404587 291.4539 339.4836
[130,] 323.1267 14.284751 294.8455 350.5187
[131,] 272.1139 12.348136 248.7768 296.7514
[132,] 286.1156 10.616079 265.9755 307.0418
[133,] 300.1173  9.160498 282.5148 318.3155
[134,] 314.1190  8.131250 298.2378 330.2356
[135,] 328.1206  7.701211 313.0259 343.3088
[136,] 342.1223  7.967997 326.5917 357.7158
[137,] 356.1240  8.868947 338.8249 373.4647
[138,] 370.1257 10.237987 350.0002 390.0074
[139,] 384.1274 11.914842 360.7124 407.0284
[140,] 398.1291 13.787655 371.1133 424.9074
[141,] 254.6185 12.528905 230.1484 278.9198
[142,] 265.9815 10.763404 244.8534 286.4584
[143,] 277.3446  9.281692 258.9016 295.0969
[144,] 288.7076  8.238343 272.5276 304.7611
[145,] 300.0706  7.811040 284.8057 315.6121
[146,] 311.4336  8.097897 295.7112 328.0476
[147,] 322.7967  9.031117 305.4417 340.8616
[148,] 334.1597 10.438762 313.7826 354.5831
[149,] 345.5227 12.157137 322.3460 369.5051
[150,] 356.8858 14.072873 330.1280 383.9538
[151,] 226.1645 13.768097 198.5962 253.0211
[152,] 241.3827 11.722114 217.7089 264.4203
[153,] 256.6010  9.949439 236.6024 276.6167
[154,] 271.8193  8.620361 254.6605 289.1281
[155,] 287.0375  7.960266 271.6865 302.9160
[156,] 302.2558  8.133692 286.6331 318.7213
[157,] 317.4740  9.093073 300.4204 336.2444
[158,] 332.6923 10.627649 312.2473 354.7079
[159,] 347.9106 12.527800 323.4361 373.3085
[160,] 363.1288 14.651980 334.2054 392.7591
[161,] 252.2119 12.242098 228.1766 275.6732
[162,] 261.7048 10.551617 241.1199 282.0382
[163,] 271.1978  9.151015 253.2252 288.7152
[164,] 280.6908  8.190378 265.0688 296.7724
[165,] 290.1838  7.833281 275.0676 305.1532
[166,] 299.6768  8.159355 283.7434 315.4289
[167,] 309.1697  9.095418 291.3503 326.8455
[168,] 318.6627 10.479264 298.3208 339.0908
[169,] 328.1557 12.158951 304.5176 352.3628
[170,] 337.6487 14.028613 310.0743 365.5356
[171,] 263.6204 12.533368 238.9901 288.5153
[172,] 275.4092 10.805293 254.0840 296.8092
[173,] 287.1981  9.382736 268.8264 305.8173
[174,] 298.9870  8.421963 282.3749 315.8021
[175,] 310.7758  8.089222 295.0551 326.5288
[176,] 322.5647  8.458955 305.8570 338.8971
[177,] 334.3535  9.449055 315.6234 352.5837
[178,] 346.1424 10.891636 324.6390 367.0198
[179,] 357.9313 12.632622 333.1930 381.8861
[180,] 369.7201 14.565401 341.3926 397.3692</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.0751795 13.151602  -29.2903402  22.2255520
  [2,]  -14.5700528 11.243371  -36.0997816   7.9117779
  [3,]  -42.1137262  9.616386  -60.6640357 -23.5374682
  [4,]    8.8859004  8.434994   -7.2526823  25.0114886
  [5,]   24.6584271  7.901651    8.7952227  39.9005404
  [6,]   62.8570537  8.144679   46.5931746  78.1708515
  [7,]   10.7311803  9.102101   -7.1870536  28.1755633
  [8,] -100.9635930 10.581750 -121.6569458 -80.2916836
  [9,]   19.8335336 12.398039   -4.3306200  43.4932167
 [10,]   35.9621602 14.424356    7.7325097  63.8181825
 [11,]   11.2101813 13.702775  -15.1242649  37.9246132
 [12,]   -8.0142440 11.717141  -30.7003136  15.3189083
 [13,]  -12.0585693 10.007274  -31.3852668   8.1634113
 [14,]  -12.0856946  8.736613  -28.7917282   5.6027795
 [15,]  -10.8329200  8.114188  -26.5690134   5.1308123
 [16,]   -4.3435453  8.287366  -20.5637784  11.7505429
 [17,]   -8.4313706  9.211384  -26.4806022   9.6384411
 [18,]   -6.0907959 10.693340  -26.9763112  15.2026010
 [19,]   -1.2786213 12.536913  -25.3264758  23.4516112
 [20,]    9.9835534 14.605808  -18.0442797  38.7989164
 [21,]  -13.7111581 13.294369  -39.7096660  12.4277667
 [22,]  -23.4123215 11.410781  -45.8058389  -1.2489742
 [23,]   11.5960151  9.803756   -7.3795044  30.7399181
 [24,]    5.1381518  8.629219  -11.8428452  22.0925376
 [25,]   -3.3755116  8.078073  -19.4788321  13.0331694
 [26,]  -17.2044750  8.275817  -33.3760739  -0.7586646
 [27,]   -7.2210384  9.174154  -25.2751067  11.4875901
 [28,]    8.1297983 10.596372  -12.4550495  29.4768491
 [29,]    8.4117349 12.362976  -15.5751736  33.1646429
 [30,]  -10.0649285 14.347309  -38.0472563  18.3629300
 [31,]   46.7692095 13.434349   20.0589611  71.8051285
 [32,]   19.9408224 11.478416   -2.7900523  41.1674261
 [33,]   -2.2888646  9.813547  -21.4632900  16.2874218
 [34,]   -6.6983517  8.610269  -23.3695260   9.9935702
 [35,]  -11.7200388  8.077568  -27.5199632   4.1056265
 [36,]   -5.6178259  8.344870  -22.1974511  11.0306320
 [37,]  -28.6497130  9.343765  -47.0219831 -10.4498426
 [38,]    3.6860000 10.874484  -17.4447558  25.0404792
 [39,]  -14.9117871 12.746851  -39.8891951   9.6864606
 [40,]   28.1014258 14.832040   -0.8205700  56.8096222
 [41,]   14.1293552 12.876811  -12.0028032  38.2550078
 [42,]    4.0574867 11.022783  -18.4436650  24.8060115
 [43,]   13.4141182  9.444586   -5.2957422  31.6178191
 [44,]   24.2448497  8.301062    7.9115974  40.4711971
 [45,]   12.9428813  7.786144   -1.7156783  28.2396181
 [46,]  -17.4796872  8.021809  -32.9627769  -1.8947320
 [47,]  -28.1873557  8.948953  -45.3722341 -10.9467709
 [48,]    9.0913759 10.383982  -10.7939489  29.5966825
 [49,]  -39.4433926 12.148226  -62.1653974 -15.6929171
 [50,]   30.9268389 14.118805    4.0156195  58.1592099
 [51,]  -25.4416406 12.225594  -49.4503160  -1.5778891
 [52,]  -27.7146734 10.543161  -48.5360454  -7.2806059
 [53,]   -7.7894063  9.155506  -26.4013114   9.8027390
 [54,]   18.7938608  8.213421    2.6618429  34.7383046
 [55,]   16.2637279  7.878405    1.1366086  31.4570875
 [56,]   -1.4258050  8.224974  -16.9890747  14.2254338
 [57,]  132.5142621  9.176225  115.2043492 150.0274776
 [58,]   14.9592292 10.570145   -5.3542396  35.2214263
 [59,]  -11.7958037 12.256623  -35.7277802  12.1659158
 [60,]  -98.4559366 14.131298 -126.0410986 -70.8927309
 [61,]   15.9739442 12.516937   -8.5341975  40.0205236
 [62,]   11.4376753 10.788197   -9.4538061  32.4808979
 [63,]  -11.5968937  9.335646  -29.7402090   6.7398161
 [64,]    1.1946374  8.305480  -14.9838280  17.7500174
 [65,]  -11.6929315  7.865450  -26.9719416   4.2179557
 [66,]   19.0536996  8.112165    3.4559728  35.1189747
 [67,]    2.6648307  8.989258  -15.0261249  20.6180818
 [68,]    9.2293618 10.337499  -11.4416373  29.5573365
 [69,]  -16.4994072 11.999109  -40.7535612   6.8582924
 [70,]    1.9345239 13.861853  -25.9011116  29.0093040
 [71,]   20.8154023 12.172898   -2.9190742  45.4084624
 [72,]   20.1196383 10.496698   -0.2124396  41.5706460
 [73,]  -24.1407257  9.126758  -42.0936817  -5.9587893
 [74,]  -24.2569896  8.217697  -40.2711733  -8.1097377
 [75,]  -11.3287536  7.929639  -27.1346091   4.2748411
 [76,]  -17.5858176  8.327281  -34.1958329  -0.7830711
 [77,]   -7.6760815  9.323295  -26.0710529  10.9018702
 [78,]    6.8981545 10.752667  -14.1288358  28.1311292
 [79,]   -0.3017095 12.467224  -24.7949262  23.9450747
 [80,]   29.8265266 14.365211    2.1342622  57.7910605
 [81,]   -9.4295719 13.252508  -36.2246035  15.7734648
 [82,]   23.1845876 11.290271    0.4757236  45.0092609
 [83,]    4.0033471  9.627675  -15.0947938  22.5305178
 [84,]   20.5900066  8.443617    3.8826430  37.0088664
 [85,]    1.5150660  7.954739  -14.4316148  16.8473256
 [86,]    4.9746255  8.285031  -11.2195206  20.6423791
 [87,]   -3.9340150  9.348061  -22.4469559  13.9141731
 [88,]  -13.8000555 10.932127  -36.0777031   7.5503921
 [89,]  -13.0816961 12.845902  -38.7955524  11.8258729
 [90,]  -11.3139366 14.963410  -41.3626753  18.1796085
 [91,]   26.3259954 13.086939    0.5699235  51.8375497
 [92,]    8.6135096 11.251214  -13.3930143  30.5491472
 [93,]  -32.7327762  9.695829  -51.8213140 -13.6971646
 [94,]    2.6265380  8.574720  -13.9667135  19.2924186
 [95,]    3.0850521  8.070934  -12.6586664  19.0920032
 [96,]   10.0394663  8.297685   -6.2450974  26.7527136
 [97,]    3.3093805  9.201120  -14.4937027  21.2780840
 [98,]   -3.4101053 10.609764  -24.4753216  16.9883718
 [99,]   16.6102088 12.351963   -7.9065980  40.4279441
[100,]    0.5109230 14.306374  -27.9128765  28.2642080
[101,]    9.6291457 12.902661  -15.0710016  35.2754195
[102,]   -7.7176560 11.109007  -29.0940289  14.4684725
[103,]  -10.6690576  9.592033  -29.1886793   8.4400601
[104,]   -6.2329593  8.501167  -22.9233081  10.7503386
[105,]  -22.0049609  8.012382  -37.9128891  -6.4336819
[106,]  -14.5011626  8.233613  -31.1788680   1.5324925
[107,]  -14.2710642  9.113297  -32.5969546   3.3321464
[108,]    0.7058341 10.487024  -20.2621128  20.8859018
[109,]   17.3241324 12.188882   -7.3071907  41.1332093
[110,]   21.1283308 14.100557   -7.0441191  48.4007761
[111,]   18.0137770 13.262872   -7.1548733  43.9978801
[112,]  -11.9280162 11.314244  -32.8931640  10.3221666
[113,]  -16.2770095  9.646310  -34.5896679   2.4940509
[114,]  -34.0538027  8.427413  -50.1148700 -17.5313694
[115,]  -37.7636959  7.869060  -53.2212662 -22.0274838
[116,]    5.9452108  8.108868   -9.8113789  22.1806578
[117,]   38.5657176  9.083843   20.7123984  56.3886576
[118,]    4.9403244 10.592898  -15.9479551  25.4852099
[119,]   19.4098312 12.443215   -4.8714911  43.5048445
[120,]   -3.1239621 14.504776  -31.5301162  25.3141833
[121,]   -5.3147757 12.113170  -29.1901059  17.7931854
[122,]   36.7401618 10.454067   15.7947818  56.4085115
[123,]   -0.8997006  9.099386  -19.0245575  16.6787778
[124,]    2.3193369  8.201395  -13.6996889  18.6248467
[125,]  -13.9185256  7.917047  -29.5754219   1.6988514
[126,]   11.4115119  8.309579   -4.7597107  28.3053783
[127,]  -12.9516506  9.293615  -30.9497534   5.6343001
[128,]  -41.5789131 10.707295  -62.1154398 -20.4616244
[129,]    5.8912244 12.404587  -17.9417683  30.0878529
[130,]   24.4387619 14.284751   -2.9531517  52.7199701
[131,]  -50.4368002 12.348136  -75.0742872 -27.0997432
[132,]   12.0783149 10.616079   -8.8479298  32.2183629
[133,]   26.7612301  9.160498    8.5630269  44.3637348
[134,]   32.7365452  8.131250   16.6198641  48.6177041
[135,]   20.6195604  7.701211    5.4313986  35.7143076
[136,]   10.7063755  7.967997   -4.8871191  26.2370295
[137,]   -1.6974093  8.868947  -19.0380525  15.6016780
[138,]   -9.6930941 10.237987  -29.5747994  10.4324012
[139,]   -8.4867790 11.914842  -31.3877838  14.9281826
[140,]   -9.5873638 13.787655  -36.3656526  17.4283649
[141,]   17.3049981 12.528905   -6.9962845  41.7751244
[142,]    2.4553700 10.763404  -18.0215051  23.5834707
[143,]  -20.1021581  9.281692  -37.8544932  -1.6591617
[144,]  -11.0509862  8.238343  -27.1044949   5.1289532
[145,]   14.7515857  7.811040   -0.7899390  30.0165287
[146,]    5.7798576  8.097897  -10.8341069  21.5022822
[147,]  -24.6613705  9.031117  -42.7262588  -7.3064016
[148,]   13.9632014 10.438762   -6.4602326  34.3402842
[149,]   -5.2427267 12.157137  -29.2250508  17.9339827
[150,]    9.6273452 14.072873  -17.4406954  36.3850970
[151,]   -0.9004642 13.768097  -27.7571393  26.6677616
[152,]   -6.8592283 11.722114  -29.8967750  16.8145993
[153,]  -17.7001925  9.949439  -37.7159474   2.2984410
[154,]  -31.3462567  8.620361  -48.6551487 -14.1875416
[155,]  -19.5002209  7.960266  -35.3786936  -4.1491569
[156,]   41.9379150  8.133692   25.4724424  57.5606373
[157,]  -36.3259492  9.093073  -55.0962987 -19.2723373
[158,]   14.8931866 10.627649   -7.1223659  35.3382006
[159,]   17.2524224 12.527800   -8.1455479  41.7269069
[160,]    9.0999583 14.651980  -20.5303378  38.0233680
[161,]   17.6685394 12.242098   -5.7927868  41.7038320
[162,]   10.7379585 10.551617   -9.5953964  31.3229447
[163,]    6.7010776  9.151015  -10.8162569  24.6737478
[164,]    1.0986968  8.190378  -14.9829247  16.7206892
[165,]  -11.0132841  7.833281  -25.9827468   4.1029150
[166,]  -15.1647649  8.159355  -30.9169297   0.7685711
[167,]  -49.9039458  9.095418  -67.5796560 -32.0844721
[168,]  -14.0321266 10.479264  -34.4602320   6.3097659
[169,]   22.6249925 12.158951   -1.5821450  46.2630892
[170,]   31.8205116 14.028613    3.9336005  59.3949020
[171,]    5.7913120 12.533368  -19.1036020  30.4215639
[172,]   -1.9352474 10.805293  -23.3352327  19.3900390
[173,]   10.3986932  9.382736   -8.2204818  28.7704104
[174,]   11.6446338  8.421963   -5.1705347  28.2567292
[175,]  -23.6032257  8.089222  -39.3562251  -7.8824976
[176,]    7.0429149  8.458955   -9.2895472  23.7506342
[177,]    0.1282555  9.449055  -18.1018876  18.8584309
[178,]   -2.9225039 10.891636  -23.7998672  18.5808617
[179,]   11.2104366 12.632622  -12.7443733  35.9487078
[180,]   -5.5965228 14.565401  -33.2455735  22.7309640</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.5
p_loo        19.7  3.5
looic      1770.1 29.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   418       
 (0.5, 0.7]   (ok)         1    0.6%   1055      
   (0.7, 1]   (bad)        1    0.6%   89        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.6
p_loo        34.5  8.7
looic      1723.3 45.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   861       
 (0.5, 0.7]   (ok)         6    3.3%   447       
   (0.7, 1]   (bad)        3    1.7%   26        
   (1, Inf)   (very bad)   1    0.6%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.4      11.8  
fit_sleep1 -91.7      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.

Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.5
p_loo        19.7  3.5
looic      1770.1 29.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   418       
 (0.5, 0.7]   (ok)         1    0.6%   1055      
   (0.7, 1]   (bad)        1    0.6%   89        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.6
p_loo        34.5  8.7
looic      1723.3 45.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   861       
 (0.5, 0.7]   (ok)         6    3.3%   447       
   (0.7, 1]   (bad)        3    1.7%   26        
   (1, Inf)   (very bad)   1    0.6%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.7     22.6        34.5    8.7   1723.3
fit_sleep2  -23.4      11.8  -885.1     14.5        19.7    3.5   1770.1
fit_sleep1  -91.7      21.2  -953.3     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   45.3  
fit_sleep2   29.0  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.509101e-40 6.787482e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88       1.6     0.25     5.43       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12       1.6    -3.33     2.89        5.4      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.2            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
