<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.41      6.71    15.27    41.71 1.00     1711     2304
sd(Days)                6.56      1.52     4.14    10.04 1.00     1414     1734
cor(Intercept,Days)     0.08      0.30    -0.47     0.68 1.00      920     1448

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.33      7.25   237.01   265.81 1.00     1804     2458
Days         10.41      1.70     7.10    13.69 1.00     1247     1693

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    26.01      1.61    23.06    29.44 1.00     4121     3061

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9612  12.95297 228.4963 279.7150
309 211.8512  13.77399 184.9144 239.3450
310 213.1559  13.29720 186.9997 238.2412
330 274.2677  13.31441 248.9016 300.7478
331 272.7663  13.28127 247.7067 298.6955
332 260.2511  12.16421 236.1149 284.1773
333 267.9649  12.77688 243.7680 294.3259
334 244.2681  12.53619 218.1627 267.9566
335 250.6582  13.52981 224.9063 277.9014
337 285.4730  13.11061 260.9473 312.4264
349 227.0151  12.97173 201.2070 251.0657
350 238.8687  13.11934 212.4143 263.4471
351 255.5414  12.44502 231.2551 279.5896
352 271.8579  12.50798 247.1136 296.4847
369 254.4439  12.04896 230.9426 278.6366
370 226.8879  13.69605 199.5133 253.0108
371 251.9856  12.39910 227.8894 276.6456
372 263.4311  12.42537 238.4756 288.3958

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.5941415  2.518156 14.67586451 24.617998
309  1.7121895  2.582578 -3.60761875  6.672971
310  4.9568935  2.521249  0.07461242  9.926829
330  5.7845835  2.556372  0.81537372 10.644086
331  7.5309488  2.523748  2.54611226 12.406757
332 10.2343888  2.365109  5.58225077 14.841816
333 10.2832320  2.376760  5.50369885 14.778756
334 11.5108966  2.372325  6.90336836 16.219127
335 -0.2354972  2.589900 -5.46560646  4.653090
337 19.2168005  2.521673 14.21053529 24.089298
349 11.5312802  2.474999  6.62638640 16.425494
350 16.9776857  2.497711 12.27409329 21.867790
351  7.5385510  2.378402  2.84982559 12.076973
352 14.0874094  2.388684  9.30319574 18.829803
369 11.4212608  2.294158  6.96540852 15.995203
370 15.1385247  2.554657 10.22784423 20.282281
371  9.5276730  2.363530  4.83901664 14.090054
372 11.8269023  2.414977  7.17184062 16.685536</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9612 12.952970 228.4963 279.7150
  [2,] 273.5553 11.058492 251.9038 295.3427
  [3,] 293.1495  9.459561 274.7429 311.9233
  [4,] 312.7436  8.328178 296.4866 329.1337
  [5,] 332.3377  7.868674 316.8251 347.9578
  [6,] 351.9319  8.194859 335.8520 368.0412
  [7,] 371.5260  9.223753 353.2981 389.5165
  [8,] 391.1202 10.755544 369.8603 412.1469
  [9,] 410.7143 12.608254 385.8109 435.7959
 [10,] 430.3085 14.660716 401.2851 459.4244
 [11,] 211.8512 13.773986 184.9144 239.3450
 [12,] 213.5633 11.785028 190.7495 237.0193
 [13,] 215.2755 10.069284 195.4605 235.4327
 [14,] 216.9877  8.788260 199.7574 234.5287
 [15,] 218.6999  8.149599 203.1044 235.1315
 [16,] 220.4121  8.302882 204.7074 236.9340
 [17,] 222.1243  9.208645 204.5093 240.5538
 [18,] 223.8365 10.677072 203.4232 245.0328
 [19,] 225.5487 12.511595 201.4512 251.1016
 [20,] 227.2609 14.574621 198.7260 256.5832
 [21,] 213.1559 13.297204 186.9997 238.2412
 [22,] 218.1128 11.396956 195.3527 239.6135
 [23,] 223.0697  9.781563 203.6707 241.9875
 [24,] 228.0265  8.612824 211.1286 244.5373
 [25,] 232.9834  8.086772 217.1695 248.5407
 [26,] 237.9403  8.326130 221.9618 253.9455
 [27,] 242.8972  9.271806 225.1682 260.7200
 [28,] 247.8541 10.738795 226.6868 268.9089
 [29,] 252.8110 12.545535 228.1300 277.7186
 [30,] 257.7679 14.566145 229.3684 286.6033
 [31,] 274.2677 13.314411 248.9016 300.7478
 [32,] 280.0523 11.376931 258.4282 302.8280
 [33,] 285.8369  9.729627 267.3388 305.3090
 [34,] 291.6215  8.542060 275.2525 308.9084
 [35,] 297.4061  8.021098 281.9337 313.2103
 [36,] 303.1907  8.293330 287.3040 319.4941
 [37,] 308.9752  9.289279 291.1448 327.2134
 [38,] 314.7598 10.810742 294.2065 335.7642
 [39,] 320.5444 12.669794 296.5833 345.5275
 [40,] 326.3290 14.739243 297.9153 355.1310
 [41,] 272.7663 13.281272 247.7067 298.6955
 [42,] 280.2973 11.366235 258.5582 302.2518
 [43,] 287.8282  9.732883 269.1090 306.3375
 [44,] 295.3592  8.544317 278.7118 312.0966
 [45,] 302.8901  8.001268 287.3492 319.1483
 [46,] 310.4211  8.232488 294.6227 327.2841
 [47,] 317.9520  9.179653 300.4742 336.6063
 [48,] 325.4830 10.653488 304.3756 346.7096
 [49,] 333.0139 12.468609 308.1216 358.0162
 [50,] 340.5449 14.497386 311.4945 369.4825
 [51,] 260.2511 12.164206 236.1149 284.1773
 [52,] 270.4855 10.501818 249.8039 291.2480
 [53,] 280.7199  9.154012 262.7617 298.6726
 [54,] 290.9543  8.275940 274.5513 306.9679
 [55,] 301.1887  8.023335 285.4673 316.5068
 [56,] 311.4231  8.452462 294.9477 327.8324
 [57,] 321.6574  9.471103 303.0336 340.3757
 [58,] 331.8918 10.915446 310.6640 353.5186
 [59,] 342.1262 12.640397 317.3863 367.1174
 [60,] 352.3606 14.546469 324.1701 380.5998
 [61,] 267.9649 12.776878 243.7680 294.3259
 [62,] 278.2482 11.016706 257.5479 301.0590
 [63,] 288.5314  9.528114 270.5440 307.6939
 [64,] 298.8146  8.455773 282.6099 316.0677
 [65,] 309.0979  7.969517 293.4564 324.6736
 [66,] 319.3811  8.174612 303.1142 335.2839
 [67,] 329.6643  9.024042 312.0810 347.1565
 [68,] 339.9476 10.360520 319.5227 360.0110
 [69,] 350.2308 12.022702 326.9019 373.5640
 [70,] 360.5140 13.894184 333.1218 387.2244
 [71,] 244.2681 12.536195 218.1627 267.9566
 [72,] 255.7789 10.803068 233.2652 275.9327
 [73,] 267.2898  9.354797 248.2240 284.8587
 [74,] 278.8007  8.341104 262.2307 294.9341
 [75,] 290.3116  7.930427 274.7093 305.7987
 [76,] 301.8225  8.213719 286.2481 317.7748
 [77,] 313.3334  9.126584 295.5620 331.1897
 [78,] 324.8443 10.506176 304.0611 345.7130
 [79,] 336.3552 12.195114 312.3111 360.4546
 [80,] 347.8661 14.082532 320.3335 375.4585
 [81,] 250.6582 13.529810 224.9063 277.9014
 [82,] 250.4227 11.524943 228.7404 273.4771
 [83,] 250.1872  9.798368 231.7823 269.7935
 [84,] 249.9517  8.520968 233.7918 267.0441
 [85,] 249.7162  7.913340 234.6388 265.6838
 [86,] 249.4807  8.127125 233.4641 265.6418
 [87,] 249.2452  9.104644 231.4524 267.6555
 [88,] 249.0097 10.637390 228.1675 270.3828
 [89,] 248.7742 12.523130 224.1833 273.7864
 [90,] 248.5387 14.625958 219.8284 277.6778
 [91,] 285.4730 13.110613 260.9473 312.4264
 [92,] 304.6898 11.213294 283.7512 327.6339
 [93,] 323.9066  9.607570 305.6236 343.7368
 [94,] 343.1234  8.461117 326.9567 359.7364
 [95,] 362.3402  7.974539 346.9600 378.3662
 [96,] 381.5570  8.265211 365.6783 398.0716
 [97,] 400.7738  9.260227 383.0308 419.3047
 [98,] 419.9906 10.766038 399.3197 441.7589
 [99,] 439.2074 12.600833 414.5792 464.3131
[100,] 458.4242 14.641451 430.1400 487.9868
[101,] 227.0151 12.971730 201.2070 251.0657
[102,] 238.5464 11.114153 216.2132 259.2896
[103,] 250.0777  9.541187 230.6022 268.3146
[104,] 261.6089  8.413997 244.9305 278.0707
[105,] 273.1402  7.925129 257.5888 288.3912
[106,] 284.6715  8.189704 268.7156 300.7721
[107,] 296.2028  9.142542 278.2655 314.1115
[108,] 307.7341 10.599629 287.0395 328.5046
[109,] 319.2653 12.384242 294.8165 343.3863
[110,] 330.7966 14.374908 302.3189 358.4920
[111,] 238.8687 13.119344 212.4143 263.4471
[112,] 255.8464 11.234682 233.1954 277.1929
[113,] 272.8241  9.633074 253.4948 291.1409
[114,] 289.8018  8.476512 272.6467 306.0478
[115,] 306.7795  7.961377 291.0062 322.5121
[116,] 323.7572  8.209319 307.5889 339.5594
[117,] 340.7349  9.158572 322.3723 358.5352
[118,] 357.7125 10.622763 336.7171 378.4947
[119,] 374.6902 12.421105 350.1592 398.7851
[120,] 391.6679 14.429197 362.8972 419.7785
[121,] 255.5414 12.445018 231.2551 279.5896
[122,] 263.0800 10.743490 241.8578 283.8967
[123,] 270.6185  9.342391 252.2910 288.8833
[124,] 278.1571  8.393543 261.6857 294.3734
[125,] 285.6956  8.058314 269.6817 301.1511
[126,] 293.2342  8.410404 276.9379 309.4809
[127,] 300.7727  9.372670 282.2248 319.2441
[128,] 308.3113 10.782977 286.9463 329.5271
[129,] 315.8498 12.490469 291.6590 340.3162
[130,] 323.3884 14.389741 295.5059 351.7044
[131,] 271.8579 12.507977 247.1136 296.4847
[132,] 285.9453 10.750332 264.8461 307.0453
[133,] 300.0328  9.279084 281.7670 318.0715
[134,] 314.1202  8.248926 297.9263 330.0965
[135,] 328.2076  7.835803 312.9627 343.7653
[136,] 342.2950  8.134276 326.1650 358.5914
[137,] 356.3824  9.074398 338.6969 374.7123
[138,] 370.4698 10.484970 349.8199 391.5056
[139,] 384.5572 12.203938 360.7418 408.9939
[140,] 398.6446 14.119109 370.9166 427.0094
[141,] 254.4439 12.048964 230.9426 278.6366
[142,] 265.8652 10.401407 245.1957 286.5062
[143,] 277.2864  9.040316 259.6299 295.3219
[144,] 288.7077  8.111208 272.7838 304.3917
[145,] 300.1289  7.770610 284.6305 315.3357
[146,] 311.5502  8.093170 295.4342 327.3479
[147,] 322.9715  9.007926 304.8123 340.5602
[148,] 334.3927 10.359170 313.7398 354.6554
[149,] 345.8140 12.000349 322.1888 369.4325
[150,] 357.2353 13.828618 330.4482 384.9182
[151,] 226.8879 13.696054 199.5133 253.0108
[152,] 242.0264 11.753315 218.3485 264.4868
[153,] 257.1649 10.087195 236.9886 276.3697
[154,] 272.3034  8.855232 255.0140 289.3251
[155,] 287.4420  8.254169 271.1687 303.4823
[156,] 302.5805  8.420216 285.8225 318.9427
[157,] 317.7190  9.312427 299.2588 335.8545
[158,] 332.8575 10.751517 311.5120 353.8234
[159,] 347.9961 12.550756 323.0611 372.6504
[160,] 363.1346 14.577393 334.0917 391.5242
[161,] 251.9856 12.399103 227.8894 276.6456
[162,] 261.5133 10.679294 240.8159 282.5905
[163,] 271.0409  9.248211 252.8185 289.0578
[164,] 280.5686  8.257364 263.9845 296.4101
[165,] 290.0963  7.874723 274.2971 304.9322
[166,] 299.6240  8.186026 283.2451 314.9805
[167,] 309.1516  9.120489 291.1295 326.5194
[168,] 318.6793 10.513238 297.8010 338.7578
[169,] 328.2070 12.208423 303.7648 351.7667
[170,] 337.7346 14.097360 309.6980 365.1930
[171,] 263.4311 12.425371 238.4756 288.3958
[172,] 275.2580 10.657212 254.1441 296.5355
[173,] 287.0849  9.188400 268.9225 305.3527
[174,] 298.9118  8.181776 282.6689 315.2208
[175,] 310.7387  7.817957 295.4610 326.2589
[176,] 322.5656  8.183133 306.4487 338.8407
[177,] 334.3925  9.190817 316.4373 352.4213
[178,] 346.2194 10.660337 325.6535 366.8173
[179,] 358.0463 12.428946 334.3495 382.2039
[180,] 369.8732 14.386759 342.3978 397.9995</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error          Q2.5      Q97.5
  [1,]   -4.40118068 12.952970  -30.15499451  21.063708
  [2,]  -14.85062222 11.058492  -36.63803193   6.800870
  [3,]  -42.34886376  9.459561  -61.12272909 -23.942263
  [4,]    8.69619471  8.328178   -7.69392269  24.953184
  [5,]   24.51415317  7.868674    8.89409192  40.026850
  [6,]   62.75821163  8.194859   46.64894750  78.838064
  [7,]   10.67777010  9.223753   -7.31271614  28.905663
  [8,] -100.97157144 10.755544 -121.99828586 -79.711703
  [9,]   19.87098702 12.608254   -5.21059370  44.774379
 [10,]   36.04504549 14.660716    6.92913680  65.068359
 [11,]   10.88274421 13.773986  -16.61110502  37.819542
 [12,]   -8.29754526 11.785028  -31.75349646  14.516336
 [13,]  -12.29773473 10.069284  -32.45490791   7.517292
 [14,]  -12.28072420  8.788260  -29.82166791   4.949571
 [15,]  -10.98381366  8.149599  -27.41542673   4.611738
 [16,]   -4.45030313  8.302882  -20.97222346  11.254423
 [17,]   -8.49399260  9.208645  -26.92347065   9.120957
 [18,]   -6.10928206 10.677072  -27.30555878  14.303956
 [19,]   -1.25297153 12.511595  -26.80592390  22.844515
 [20,]   10.05333900 14.574621  -19.26902122  38.588169
 [21,]  -14.10196619 13.297204  -39.18725142  12.054189
 [22,]  -23.78055973 11.396956  -45.28131303  -1.020523
 [23,]   11.25034673  9.781563   -7.66748596  30.649334
 [24,]    4.81505319  8.612824  -11.69565310  21.712983
 [25,]   -3.67604034  8.086772  -19.23333298  12.137856
 [26,]  -17.48243388  8.326130  -33.48759547  -1.503910
 [27,]   -7.47642742  9.271806  -25.29918279  10.252622
 [28,]    7.89697905 10.738795  -13.15779092  29.064329
 [29,]    8.20148551 12.545535  -16.70612191  32.882540
 [30,]  -10.25260803 14.566145  -39.08802105  18.146888
 [31,]   47.27485946 13.314411   20.79479502  72.640950
 [32,]   20.34787596 11.376931   -2.42777517  41.972023
 [33,]   -1.98040755  9.729627  -21.45253116  16.517651
 [34,]   -6.48849105  8.542060  -23.77536905   9.880502
 [35,]  -11.60877456  8.021098  -27.41304632   3.863582
 [36,]   -5.60515806  8.293330  -21.90861157  10.281489
 [37,]  -28.73564157  9.289279  -46.97382685 -10.905234
 [38,]    3.50147493 10.810742  -17.50285053  24.054758
 [39,]  -15.19490858 12.669794  -40.17804271   8.766164
 [40,]   27.71970792 14.739243   -1.08233447  56.133374
 [41,]   14.84157746 13.281272  -11.08762482  39.901176
 [42,]    4.70272864 11.366235  -17.25175860  26.441813
 [43,]   13.99237982  9.732883   -4.51686290  32.711568
 [44,]   24.75613100  8.544317    8.01866281  41.403501
 [45,]   13.38718218  8.001268   -2.87095159  28.928115
 [46,]  -17.10236663  8.232488  -33.96540484  -1.303989
 [47,]  -27.87701545  9.179653  -46.53133827 -10.399202
 [48,]    9.33473573 10.653488  -11.89186180  30.442067
 [49,]  -39.26701309 12.468609  -64.26933786 -14.374663
 [50,]   31.03623809 14.497386    2.09864667  60.086642
 [51,]  -25.39050943 12.164206  -49.31672860  -1.254290
 [52,]  -27.67369821 10.501818  -48.43623697  -6.992112
 [53,]   -7.75858699  9.154012  -25.71134166  10.199591
 [54,]   18.81452423  8.275940    2.80093774  35.217538
 [55,]   16.27423546  8.023335    0.95607439  31.995556
 [56,]   -1.42545332  8.452462  -17.83477573  15.049908
 [57,]  132.50445790  9.471103  113.78622003 151.128297
 [58,]   14.93926912 10.915446   -6.68747430  36.167080
 [59,]  -11.82591965 12.640397  -36.81707747  12.914038
 [60,]  -98.49620843 14.546469 -126.73535244 -70.305709
 [61,]   15.87746735 12.776878  -10.48350049  40.074399
 [62,]   11.30683532 11.016706  -11.50398786  32.007093
 [63,]  -11.76209670  9.528114  -30.92464129   6.225349
 [64,]    0.99507128  8.455773  -16.25802127  17.199834
 [65,]  -11.92686075  7.969517  -27.50257200   3.714628
 [66,]   18.78540723  8.174612    2.88256345  35.052268
 [67,]    2.36217521  9.024042  -15.13000848  19.945530
 [68,]    8.89234318 10.360520  -11.17110209  29.317152
 [69,]  -16.87078884 12.022702  -40.20403545   6.458069
 [70,]    1.52877914 13.894184  -25.18155479  28.920951
 [71,]   21.20504986 12.536195   -2.48352556  47.310426
 [72,]   20.42225331 10.803068    0.26851424  42.935963
 [73,]  -23.92514324  9.354797  -41.49402185  -4.859318
 [74,]  -24.12843980  8.341104  -40.26181877  -7.558412
 [75,]  -11.28723635  7.930427  -26.77433523   4.315084
 [76,]  -17.63133290  8.213719  -33.58359483  -2.056931
 [77,]   -7.80862945  9.126584  -25.66485116   9.962813
 [78,]    6.67857400 10.506176  -14.19010863  27.461768
 [79,]   -0.60832256 12.195114  -24.70771725  23.435788
 [80,]   29.43288089 14.082532    1.84051180  56.965475
 [81,]   -9.04985600 13.529810  -36.29306147  16.702005
 [82,]   23.52454115 11.524943    0.47014606  45.206847
 [83,]    4.30353830  9.798368  -15.30280377  22.708394
 [84,]   20.85043545  8.520968    3.75799913  37.010340
 [85,]    1.73573260  7.913340  -14.23186243  16.813080
 [86,]    5.15552975  8.127125  -11.00558964  21.172054
 [87,]   -3.79287310  9.104644  -22.20317465  13.999895
 [88,]  -13.69867595 10.637390  -35.07176098   7.143468
 [89,]  -13.02007879 12.523130  -38.03227633  11.570772
 [90,]  -11.29208164 14.625958  -40.43118547  17.418178
 [91,]   26.89363149 13.110613   -0.05983529  51.419307
 [92,]    9.11603102 11.213294  -13.82806397  30.054617
 [93,]  -32.29536946  9.607570  -52.12556794 -14.012363
 [94,]    2.99883007  8.461117  -13.61422855  19.165461
 [95,]    3.39222959  7.974539  -12.63377760  18.772360
 [96,]   10.28152911  8.265211   -6.23313462  26.160238
 [97,]    3.48632864  9.260227  -15.04457323  21.229339
 [98,]   -3.29827184 10.766038  -25.06663342  17.372601
 [99,]   16.65692769 12.600833   -8.44880043  41.285120
[100,]    0.49252721 14.641451  -29.07006883  28.776723
[101,]    9.08810242 12.971730  -14.96249367  34.896233
[102,]   -8.22967780 11.114153  -28.97292801  14.103507
[103,]  -11.15205803  9.541187  -29.38896921   8.323356
[104,]   -6.68693825  8.413997  -23.14874629   9.991471
[105,]  -22.42991848  7.925129  -37.68094888  -6.878463
[106,]  -14.89709870  8.189704  -30.99772144   1.058835
[107,]  -14.63797893  9.142542  -32.54666082   3.299341
[108,]    0.36794085 10.599629  -20.40258060  21.062543
[109,]   17.01526062 12.384242   -7.10573753  41.464121
[110,]   20.84848040 14.374908   -6.84694058  49.326206
[111,]   17.42805380 13.119344   -7.15029045  43.882530
[112,]  -12.39213188 11.234682  -33.73858583  10.258948
[113,]  -16.61951757  9.633074  -34.93633571   2.709848
[114,]  -34.27470325  8.476512  -50.52066661 -17.119557
[115,]  -37.86298894  7.961377  -53.59564989 -22.089687
[116,]    5.96752538  8.209319   -9.83469600  22.135776
[117,]   38.70963969  9.158572   20.90926516  57.072247
[118,]    5.20585401 10.622763  -15.57625836  26.201341
[119,]   19.79696832 12.421105   -4.29792888  44.328046
[120,]   -2.61521736 14.429197  -30.72580617  26.155488
[121,]   -5.01492612 12.445018  -29.06305376  19.271445
[122,]   36.97762286 10.743490   16.16088260  58.199827
[123,]   -0.72462816  9.342391  -18.98935541  17.602907
[124,]    2.43202082  8.393543  -13.78428832  18.903430
[125,]  -13.86823020  8.058314  -29.32374604   2.145658
[126,]   11.39941878  8.410404   -4.84730024  27.695664
[127,]  -13.02613223  9.372670  -31.49753962   5.521779
[128,]  -41.71578325 10.782977  -62.93155622 -20.350805
[129,]    5.69196573 12.490469  -18.77442154  29.882778
[130,]   24.17711471 14.389741   -4.13893881  52.059570
[131,]  -50.18084020 12.507977  -74.80763302 -25.436533
[132,]   12.24855040 10.750332   -8.85139461  33.347807
[133,]   26.84574099  9.279084    8.80696775  45.111510
[134,]   32.73533159  8.248926   16.75899601  48.929243
[135,]   20.53262218  7.835803    4.97491050  35.777501
[136,]   10.53371278  8.134276   -5.76266151  26.663694
[137,]   -1.95579663  9.074398  -20.28572782  15.729741
[138,]  -10.03720603 10.484970  -31.07295229  10.612731
[139,]   -8.91661544 12.203938  -33.35330048  14.898763
[140,]  -10.10292484 14.119109  -38.46769049  17.625079
[141,]   17.47959364 12.048964   -6.71305685  40.980875
[142,]    2.57173286 10.401407  -18.06927321  23.241180
[143,]  -20.04402793  9.040316  -38.07954648  -2.387486
[144,]  -11.05108871  8.111208  -26.73514278   4.872802
[145,]   14.69325050  7.770610   -0.51345383  30.191654
[146,]    5.66328972  8.093170  -10.13443666  21.779261
[147,]  -24.83617106  9.007926  -42.42489496  -6.676993
[148,]   13.73016815 10.359170   -6.53254469  34.383091
[149,]   -5.53399263 12.000349  -29.15250897  18.091162
[150,]    9.27784658 13.828618  -18.40506053  36.064860
[151,]   -1.62386826 13.696054  -27.74680901  25.750703
[152,]   -7.50289300 11.753315  -29.96334385  16.174998
[153,]  -18.26411774 10.087195  -37.46888347   1.912171
[154,]  -31.83044249  8.855232  -48.85210059 -14.540956
[155,]  -19.90466723  8.254169  -35.94498299  -3.631439
[156,]   41.61320803  8.420216   25.25099954  58.371166
[157,]  -36.57091672  9.312427  -54.70635548 -18.110684
[158,]   14.72795854 10.751517   -6.23785146  36.073516
[159,]   17.16693380 12.550756   -7.48743604  42.101857
[160,]    9.09420905 14.577393  -19.29537590  38.137058
[161,]   17.89481222 12.399103   -6.76519195  41.990991
[162,]   10.92953922 10.679294  -10.14773213  31.626862
[163,]    6.85796622  9.248211  -11.15889176  25.080432
[164,]    1.22089321  8.257364  -14.62059397  17.804969
[165,]  -10.92577979  7.874723  -25.76166668   4.873358
[166,]  -15.11195279  8.186026  -30.46850485   1.266893
[167,]  -49.88582579  9.120489  -67.25356997 -31.863685
[168,]  -14.04869880 10.513238  -34.12715568   6.829644
[169,]   22.57372820 12.208423   -0.98602171  47.015880
[170,]   31.73455520 14.097360    4.27619618  59.771192
[171,]    5.98062516 12.425371  -18.98409753  30.936145
[172,]   -1.78397718 10.657212  -23.06154750  19.329936
[173,]   10.51192049  9.188400   -7.75590055  28.674302
[174,]   11.71981816  8.181776   -4.58923325  27.962714
[175,]  -23.56608418  7.817957  -39.08630912  -8.288369
[176,]    7.04201349  8.183133   -9.23309655  23.158867
[177,]    0.08931116  9.190817  -17.93951496  18.044506
[178,]   -2.99949118 10.660337  -23.59744986  17.566364
[179,]   11.09540649 12.428946  -13.06216278  34.792228
[180,]   -5.74959584 14.386759  -33.87586746  21.725797</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.2  3.3
looic      1769.4 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   715       
 (0.5, 0.7]   (ok)         1    0.6%   201       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.2 22.6
p_loo        34.9  8.9
looic      1724.5 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   1040      
 (0.5, 0.7]   (ok)         5    2.8%   528       
   (0.7, 1]   (bad)        1    0.6%   30        
   (1, Inf)   (very bad)   2    1.1%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -22.5      11.8  
fit_sleep1 -91.1      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.2  3.3
looic      1769.4 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   715       
 (0.5, 0.7]   (ok)         1    0.6%   201       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.2 22.6
p_loo        34.9  8.9
looic      1724.5 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   1040      
 (0.5, 0.7]   (ok)         5    2.8%   528       
   (0.7, 1]   (bad)        1    0.6%   30        
   (1, Inf)   (very bad)   2    1.1%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.2     22.6        34.9    8.9   1724.5
fit_sleep2  -22.5      11.8  -884.7     14.3        19.2    3.3   1769.4
fit_sleep1  -91.1      21.2  -953.3     10.5         3.2    0.5   1906.7
           se_looic
fit_sleep3   45.2  
fit_sleep2   28.6  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
2.708885e-40 1.728068e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.87      1.59     0.25      5.4       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.13      1.59    -3.21     2.96       5.21      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.26 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.5      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.3         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.1       pkgbuild_1.4.0       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.0        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.0         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.0           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.31       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
