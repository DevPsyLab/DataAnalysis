<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.04      6.76    15.86    42.80 1.00     1759     2639
sd(Days)                6.61      1.54     4.12    10.16 1.00     1415     1805
cor(Intercept,Days)     0.08      0.31    -0.48     0.68 1.00      864     1358

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.54      7.31   237.02   266.06 1.00     2060     2733
Days         10.43      1.69     7.14    13.67 1.00     1565     1938

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.55    23.09    29.18 1.00     3187     3152

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0297  13.20115 228.1861 279.8235
309 211.5006  13.13689 184.9783 236.9882
310 213.0258  13.37142 186.7297 238.9311
330 274.7986  13.50587 248.6553 301.7512
331 273.3536  13.20482 247.9828 300.0312
332 260.0827  12.48045 235.9670 284.9758
333 268.2161  12.61810 244.2400 293.3587
334 244.3576  12.27048 219.7786 267.9775
335 250.6777  13.36495 225.3941 276.8364
337 286.3687  12.99684 260.4310 312.0661
349 226.7282  13.06202 200.6917 251.1206
350 238.6360  12.93695 213.7378 263.6515
351 255.7580  12.51500 231.5812 280.5810
352 271.8524  12.53744 247.7762 297.1605
369 254.7267  12.20050 230.2591 279.6105
370 226.1106  13.71321 198.0120 251.8009
371 252.3303  12.22822 227.6248 276.6012
372 263.5077  12.22362 239.3373 287.8913

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6017224  2.547700 14.7895160 24.739877
309  1.8026770  2.469049 -3.1785359  6.615960
310  4.9479264  2.486668  0.1167361  9.831445
330  5.7518477  2.596753  0.5001198 10.661834
331  7.4197045  2.534181  2.2401053 12.260585
332 10.2535185  2.381515  5.6108963 14.812485
333 10.2736457  2.450492  5.3945894 15.008553
334 11.5374187  2.363479  6.9712986 16.408350
335 -0.2100786  2.550352 -5.2814457  4.618151
337 19.1339088  2.486387 14.2985193 24.125345
349 11.5304258  2.485174  6.9269220 16.416271
350 17.0116400  2.498462 12.2239882 21.973278
351  7.4697280  2.360456  2.8365378 11.981009
352 14.0678185  2.383832  9.3576155 18.599798
369 11.3453419  2.327094  6.8622400 16.065035
370 15.2594414  2.542060 10.3942209 20.385669
371  9.4589713  2.370257  4.6702955 14.035413
372 11.8149600  2.331769  7.2031147 16.317055</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0297 13.201150 228.1861 279.8235
  [2,] 273.6314 11.249299 251.8797 295.6410
  [3,] 293.2332  9.581475 275.0486 312.2709
  [4,] 312.8349  8.369237 296.8351 329.7944
  [5,] 332.4366  7.827206 317.5634 347.8573
  [6,] 352.0383  8.091214 336.5049 368.2272
  [7,] 371.6400  9.091308 354.1473 389.6124
  [8,] 391.2418 10.621562 370.7404 412.2151
  [9,] 410.8435 12.488588 386.8509 435.6466
 [10,] 430.4452 14.563434 402.8794 459.6155
 [11,] 211.5006 13.136891 184.9783 236.9882
 [12,] 213.3033 11.269505 190.3329 235.3266
 [13,] 215.1060  9.675639 195.5126 233.7446
 [14,] 216.9086  8.510385 199.9587 233.1732
 [15,] 218.7113  7.964151 203.1250 234.2869
 [16,] 220.5140  8.162178 204.4074 236.7579
 [17,] 222.3167  9.055772 204.8821 240.3292
 [18,] 224.1194 10.468298 203.8027 244.6309
 [19,] 225.9220 12.221126 202.1766 249.6205
 [20,] 227.7247 14.188692 199.7164 255.3668
 [21,] 213.0258 13.371420 186.7297 238.9311
 [22,] 217.9737 11.491589 195.4113 240.2251
 [23,] 222.9216  9.883592 203.5645 242.2404
 [24,] 227.8696  8.699495 210.8596 244.9415
 [25,] 232.8175  8.126750 216.9101 248.8567
 [26,] 237.7654  8.293007 221.2969 254.2058
 [27,] 242.7133  9.158105 224.3075 260.7141
 [28,] 247.6613 10.551532 226.8147 268.4710
 [29,] 252.6092 12.294951 228.6066 276.8119
 [30,] 257.5571 14.260569 229.5729 285.6745
 [31,] 274.7986 13.505874 248.6553 301.7512
 [32,] 280.5505 11.515651 258.0916 303.5752
 [33,] 286.3023  9.813157 267.2060 305.5295
 [34,] 292.0542  8.571589 275.5734 308.5773
 [35,] 297.8060  8.008274 282.5743 313.8752
 [36,] 303.5579  8.263113 287.4365 319.8682
 [37,] 309.3097  9.268865 290.8722 327.6473
 [38,] 315.0616 10.818083 293.7000 336.3772
 [39,] 320.8134 12.713624 295.7777 345.7048
 [40,] 326.5653 14.823218 296.7659 355.4291
 [41,] 273.3536 13.204818 247.9828 300.0312
 [42,] 280.7733 11.266416 258.9690 303.5944
 [43,] 288.1930  9.609433 269.4070 307.2933
 [44,] 295.6127  8.402047 279.2930 312.1323
 [45,] 303.0324  7.854409 287.4302 318.2288
 [46,] 310.4521  8.101434 294.7036 325.8820
 [47,] 317.8718  9.078483 300.3074 335.6261
 [48,] 325.2915 10.585303 305.1443 345.7551
 [49,] 332.7112 12.430710 309.0307 356.5629
 [50,] 340.1310 14.485876 312.2730 367.9741
 [51,] 260.0827 12.480447 235.9670 284.9758
 [52,] 270.3362 10.747806 249.3069 291.6425
 [53,] 280.5897  9.306574 262.1841 298.9640
 [54,] 290.8432  8.309786 274.1643 307.0684
 [55,] 301.0968  7.926916 285.1410 316.4584
 [56,] 311.3503  8.243948 295.0569 327.3882
 [57,] 321.6038  9.188720 303.2991 339.6689
 [58,] 331.8573 10.594608 310.6232 353.1263
 [59,] 342.1108 12.304555 317.5541 366.8556
 [60,] 352.3644 14.209211 323.9949 380.8695
 [61,] 268.2161 12.618103 244.2400 293.3587
 [62,] 278.4898 10.804728 258.2463 300.0199
 [63,] 288.7634  9.288572 271.3968 307.1227
 [64,] 299.0371  8.235462 283.4066 315.1942
 [65,] 309.3107  7.834405 294.2516 324.6918
 [66,] 319.5844  8.181858 303.5216 335.9812
 [67,] 329.8580  9.193342 311.6528 347.9440
 [68,] 340.1316 10.681858 319.1265 361.2404
 [69,] 350.4053 12.477839 325.9864 374.5762
 [70,] 360.6789 14.467227 332.1636 389.2332
 [71,] 244.3576 12.270476 219.7786 267.9775
 [72,] 255.8950 10.548508 234.8064 276.2603
 [73,] 267.4324  9.118635 248.9550 285.0496
 [74,] 278.9698  8.136343 262.4446 295.2802
 [75,] 290.5073  7.773206 274.6689 305.4321
 [76,] 302.0447  8.112795 285.4787 318.0457
 [77,] 313.5821  9.076575 295.3343 331.4391
 [78,] 325.1195 10.493954 304.2893 345.6095
 [79,] 336.6569 12.207948 312.4866 360.6413
 [80,] 348.1944 14.110882 320.2790 376.2290
 [81,] 250.6777 13.364952 225.3941 276.8364
 [82,] 250.4676 11.388817 229.0587 272.4775
 [83,] 250.2575  9.684882 231.5724 269.3304
 [84,] 250.0474  8.420056 233.3902 266.2691
 [85,] 249.8374  7.810654 234.4171 265.4043
 [86,] 249.6273  8.007740 234.3757 265.5839
 [87,] 249.4172  8.958241 232.6881 267.3353
 [88,] 249.2071 10.458721 229.6471 269.9487
 [89,] 248.9970 12.309679 225.8009 273.1039
 [90,] 248.7870 14.376375 221.4743 276.5118
 [91,] 286.3687 12.996844 260.4310 312.0661
 [92,] 305.5026 11.131963 283.2862 327.6488
 [93,] 324.6365  9.554449 305.6350 343.8855
 [94,] 343.7704  8.427255 326.7805 360.5183
 [95,] 362.9043  7.944432 347.1806 378.5104
 [96,] 382.0382  8.220316 365.9260 398.2892
 [97,] 401.1721  9.186808 383.4073 419.3373
 [98,] 420.3061 10.657651 399.8030 441.5017
 [99,] 439.4400 12.455435 415.3888 464.0669
[100,] 458.5739 14.458714 430.8904 487.1650
[101,] 226.7282 13.062017 200.6917 251.1206
[102,] 238.2587 11.176358 216.1008 259.2424
[103,] 249.7891  9.568586 231.0480 268.0009
[104,] 261.3195  8.399814 244.9093 277.3704
[105,] 272.8500  7.868170 257.5849 288.0128
[106,] 284.3804  8.100091 268.2527 300.1659
[107,] 295.9108  9.036982 277.8011 313.2717
[108,] 307.4412 10.491653 286.2495 328.0933
[109,] 318.9717 12.281478 294.3628 343.0052
[110,] 330.5021 14.280994 302.7211 358.3705
[111,] 238.6360 12.936947 213.7378 263.6515
[112,] 255.6477 10.998293 234.1412 277.1345
[113,] 272.6593  9.329787 254.3915 290.9269
[114,] 289.6709  8.100125 274.2402 305.7551
[115,] 306.6826  7.527533 292.0837 321.2892
[116,] 323.6942  7.758873 308.4214 338.4292
[117,] 340.7059  8.730469 323.2029 358.0263
[118,] 357.7175 10.233607 337.2371 378.3224
[119,] 374.7291 12.071327 350.9333 399.1983
[120,] 391.7408 14.113533 364.2326 419.9395
[121,] 255.7580 12.514997 231.5812 280.5810
[122,] 263.2277 10.740557 242.4174 284.4325
[123,] 270.6974  9.232416 252.9011 289.0307
[124,] 278.1671  8.139958 262.4019 294.3171
[125,] 285.6369  7.643550 270.8377 300.8560
[126,] 293.1066  7.856989 278.0577 308.6643
[127,] 300.5763  8.728357 283.7039 317.7547
[128,] 308.0461 10.088590 288.5192 327.8671
[129,] 315.5158 11.769392 292.5457 338.8833
[130,] 322.9855 13.652876 296.0097 349.7984
[131,] 271.8524 12.537440 247.7762 297.1605
[132,] 285.9202 10.763497 265.2545 307.5621
[133,] 299.9880  9.267344 282.4232 318.5294
[134,] 314.0558  8.202424 298.3753 330.3228
[135,] 328.1236  7.748623 313.1153 343.2837
[136,] 342.1915  8.010485 326.5363 358.3887
[137,] 356.2593  8.925239 339.0334 374.1123
[138,] 370.3271 10.320718 350.2461 390.8934
[139,] 384.3949 12.030788 361.0845 407.8380
[140,] 398.4627 13.940150 371.1678 425.7869
[141,] 254.7267 12.200497 230.2591 279.6105
[142,] 266.0721 10.513955 245.0343 287.1752
[143,] 277.4174  9.114005 259.9387 295.4265
[144,] 288.7627  8.149702 273.3299 304.9722
[145,] 300.1081  7.784661 285.3991 315.3002
[146,] 311.4534  8.100307 295.6291 327.3291
[147,] 322.7988  9.025504 305.2460 340.5055
[148,] 334.1441 10.398808 313.7475 354.6256
[149,] 345.4895 12.068198 322.0643 369.0380
[150,] 356.8348 13.927611 330.4560 383.5742
[151,] 226.1106 13.713211 198.0120 251.8009
[152,] 241.3700 11.760299 217.6605 263.5619
[153,] 256.6294 10.073790 236.7394 275.6132
[154,] 271.8889  8.808064 254.3716 288.7223
[155,] 287.1483  8.161304 271.1980 303.1635
[156,] 302.4078  8.279849 285.8380 318.6817
[157,] 317.6672  9.133950 299.3845 335.4040
[158,] 332.9267 10.546389 311.5517 353.1493
[159,] 348.1861 12.326708 323.5844 371.4854
[160,] 363.4455 14.338525 334.8637 391.0858
[161,] 252.3303 12.228217 227.6248 276.6012
[162,] 261.7893 10.496253 240.8410 282.3095
[163,] 271.2483  9.058124 252.9217 288.8754
[164,] 280.7072  8.072430 264.5371 296.5777
[165,] 290.1662  7.714589 274.7998 305.2253
[166,] 299.6252  8.068573 283.7964 315.3180
[167,] 309.0842  9.051248 291.1379 326.6095
[168,] 318.5431 10.487352 297.6675 338.7638
[169,] 328.0021 12.218030 304.1464 351.3382
[170,] 337.4611 14.135494 309.9859 364.6684
[171,] 263.5077 12.223617 239.3373 287.8913
[172,] 275.3226 10.532045 254.3655 296.3344
[173,] 287.1376  9.127181 268.7889 305.3201
[174,] 298.9526  8.158503 282.6487 315.0435
[175,] 310.7675  7.790457 295.0216 325.8552
[176,] 322.5825  8.105280 306.8067 338.4805
[177,] 334.3974  9.031844 316.2649 351.9969
[178,] 346.2124 10.408032 325.6113 366.5128
[179,] 358.0274 12.081157 333.9306 381.5518
[180,] 369.8423 13.944744 342.1445 396.8633</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.46971535 13.201150  -30.26353952  21.3739479
  [2,]  -14.92673779 11.249299  -36.93626866   6.8250497
  [3,]  -42.43256024  9.581475  -61.47028886 -24.2480388
  [4,]    8.60491732  8.369237   -8.35457471  24.6046725
  [5,]   24.41529488  7.827206    8.99456657  39.2884959
  [6,]   62.65177244  8.091214   46.46292393  78.1851943
  [7,]   10.56375000  9.091308   -7.40860843  28.0564680
  [8,] -101.09317244 10.621562 -122.06654137 -80.5918411
  [9,]   19.74180512 12.488588   -5.06125695  43.7344041
 [10,]   35.90828268 14.563434    6.73796485  63.4740783
 [11,]   11.23328448 13.136891  -14.25428730  37.7555890
 [12,]   -8.03749248 11.269505  -30.06075198  14.9328871
 [13,]  -12.12816945  9.675639  -30.76680671   7.4651541
 [14,]  -12.20164641  8.510385  -28.46615647   4.7483182
 [15,]  -10.99522338  7.964151  -26.57075773   4.5911394
 [16,]   -4.55220034  8.162178  -20.79608386  11.5544117
 [17,]   -8.68637731  9.055772  -26.69887287   8.7482070
 [18,]   -6.39215427 10.468298  -26.90365338  13.9245307
 [19,]   -1.62633123 12.221126  -25.32475182  22.1191176
 [20,]    9.58949180 14.188692  -18.05258902  37.5978498
 [21,]  -13.97187490 13.371420  -39.87717864  12.3242398
 [22,]  -23.64150126 11.491589  -45.89291475  -1.0791275
 [23,]   11.39837238  9.883592   -7.92044944  30.7554600
 [24,]    4.97204602  8.699495  -12.09986341  21.9820387
 [25,]   -3.51008034  8.126750  -19.54929649  12.3973219
 [26,]  -17.30750671  8.293007  -33.74791077  -0.8390246
 [27,]   -7.29253307  9.158105  -25.29329333  11.1133109
 [28,]    8.08984057 10.551532  -12.71987467  28.9363706
 [29,]    8.40331421 12.294951  -15.79935077  32.4059251
 [30,]  -10.04181215 14.260569  -38.15915644  17.9423838
 [31,]   46.74397441 13.505874   19.79135081  72.8873398
 [32,]   19.84972669 11.515651   -3.17500036  42.3086288
 [33,]   -2.44582104  9.813157  -21.67295481  16.6504527
 [34,]   -6.92116876  8.571589  -23.44431581   9.5595770
 [35,]  -12.00871649  8.008274  -28.07791957   3.2230180
 [36,]   -5.97236421  8.263113  -22.28271144  10.1490419
 [37,]  -29.07011194  9.268865  -47.40773327 -10.6326093
 [38,]    3.19974034 10.818083  -18.11585611  24.5613119
 [39,]  -15.46390739 12.713624  -40.35530748   9.5718481
 [40,]   27.48344489 14.823218   -1.38036536  57.2827687
 [41,]   14.25428842 13.204818  -12.42333334  39.6250747
 [42,]    4.22668393 11.266416  -18.59442947  26.0309655
 [43,]   13.62757944  9.609433   -5.47267126  32.4135801
 [44,]   24.50257496  8.402047    7.98296486  40.8223182
 [45,]   13.24487047  7.854409   -1.95151559  28.8470978
 [46,]  -17.13343402  8.101434  -32.56329248  -1.3849053
 [47,]  -27.79683850  9.078483  -45.55112544 -10.2324131
 [48,]    9.52615701 10.585303  -10.93738014  29.6734497
 [49,]  -38.96434748 12.430710  -62.81598977 -15.2837723
 [50,]   31.45014804 14.485876    3.60699203  59.3080579
 [51,]  -25.22208604 12.480447  -50.11523035  -1.1064462
 [52,]  -27.52440456 10.747806  -48.83065271  -6.4950758
 [53,]   -7.62842309  9.306574  -26.00272412  10.7771512
 [54,]   18.92555839  8.309786    2.70043815  35.6045237
 [55,]   16.36613987  7.926916    1.00451053  32.3218783
 [56,]   -1.35267866  8.243948  -17.39056701  14.9407113
 [57,]  132.55810282  9.188720  114.49298635 150.8628065
 [58,]   14.97378430 10.594608   -6.29523514  36.2078739
 [59,]  -11.81053423 12.304555  -36.55530348  12.7461903
 [60,]  -98.49995275 14.209211 -127.00508364 -70.1304934
 [61,]   15.62627224 12.618103   -9.51627398  39.6023807
 [62,]   11.06522652 10.804728  -10.46493504  31.3087233
 [63,]  -11.99411920  9.288572  -30.35338990   5.3724653
 [64,]    0.77263508  8.235462  -15.38451951  16.4031186
 [65,]  -12.13971064  7.834405  -27.52076808   2.9193873
 [66,]   18.58214363  8.181858    2.18532211  34.6449412
 [67,]    2.16849791  9.193342  -15.91747481  20.3737083
 [68,]    8.70825219 10.681858  -12.40048501  29.7133904
 [69,]  -17.04529353 12.477839  -41.21622159   7.3736395
 [70,]    1.36386075 14.467227  -27.19040593  29.8791864
 [71,]   21.11551256 12.270476   -2.50444477  45.6944969
 [72,]   20.30619382 10.548508   -0.05906839  41.3948250
 [73,]  -24.06772491  9.118635  -41.68491888  -5.5902805
 [74,]  -24.29754365  8.136343  -40.60790727  -7.7722825
 [75,]  -11.48286238  7.773206  -26.40768276   4.3554844
 [76,]  -17.85348112  8.112795  -33.85450496  -1.2874896
 [77,]   -8.05729985  9.076575  -25.91431087  10.1905436
 [78,]    6.40338141 10.493954  -14.08655652  27.2335883
 [79,]   -0.91003732 12.207948  -24.89440356  23.2603192
 [80,]   29.10464394 14.110882    1.07002805  57.0200489
 [81,]   -9.06937375 13.364952  -35.22813337  16.2142035
 [82,]   23.47960482 11.388817    1.46972148  44.8885092
 [83,]    4.23318339  9.684882  -14.83965859  22.9183473
 [84,]   20.75466196  8.420056    4.53304406  37.4119494
 [85,]    1.61454053  7.810654  -13.95239924  17.0347810
 [86,]    5.00891910  8.007740  -10.94771253  20.2605011
 [87,]   -3.96490233  8.958241  -21.88300914  12.7642097
 [88,]  -13.89612376 10.458721  -34.63767454   5.6638572
 [89,]  -13.24294519 12.309679  -37.34976642   9.9532337
 [90,]  -11.54036662 14.376375  -39.26520594  15.7722675
 [91,]   25.99790461 12.996844    0.30048265  51.9356241
 [92,]    8.30319585 11.131963  -13.84298549  30.5196209
 [93,]  -33.02531291  9.554449  -52.27427194 -14.0237753
 [94,]    2.35177833  8.427255  -14.39605427  19.3416529
 [95,]    2.82806957  7.944432  -12.77804785  18.5518418
 [96,]    9.80026080  8.220316   -6.45074960  25.9124799
 [97,]    3.08795204  9.186808  -15.07722521  20.8528465
 [98,]   -3.61375672 10.657651  -24.80944586  16.8893327
 [99,]   16.42433452 12.455435   -8.20256078  40.4755004
[100,]    0.34282576 14.458714  -28.24827219  28.0262772
[101,]    9.37495219 13.062017  -15.01739443  35.4115245
[102,]   -7.94197357 11.176358  -28.92572896  14.2158568
[103,]  -10.86349933  9.568586  -29.07527436   7.8775952
[104,]   -6.39752509  8.399814  -22.44842297  10.0126583
[105,]  -22.13965084  7.868170  -37.30249120  -6.8746279
[106,]  -14.60597660  8.100091  -30.39148127   1.5216811
[107,]  -14.34600236  9.036982  -31.70688803   3.7637200
[108,]    0.66077188 10.491653  -19.99132859  21.8525491
[109,]   17.30894612 12.281478   -6.72463285  41.9177657
[110,]   21.14302036 14.280994   -6.72543732  48.9239756
[111,]   17.66077904 12.936947   -7.35467432  42.5589733
[112,]  -12.19336096 10.998293  -33.68020562   9.3130761
[113,]  -16.45470097  9.329787  -34.72230678   1.8130540
[114,]  -34.14384097  8.100125  -50.22803270 -18.7130796
[115,]  -37.76608098  7.527533  -52.37268959 -23.1672461
[116,]    6.03047901  7.758873   -8.70449793  21.3033403
[117,]   38.73863901  8.730469   21.41819661  56.2415571
[118,]    5.20089900 10.233607  -15.40395102  25.6813191
[119,]   19.75805900 12.071327   -4.71111793  43.5538613
[120,]   -2.68808101 14.113533  -30.88680513  24.8200759
[121,]   -5.23146482 12.514997  -30.05453014  18.9452643
[122,]   36.82990717 10.740557   15.62513332  57.6401876
[123,]   -0.80352084  9.232416  -19.13678483  16.9927716
[124,]    2.42195115  8.139958  -13.72800327  18.1872421
[125,]  -13.80947686  7.643550  -29.02858036   0.9897287
[126,]   11.52699513  7.856989   -4.03068397  26.5759427
[127,]  -12.82973288  8.728357  -30.00805885   4.0426955
[128,]  -41.45056089 10.088590  -61.27160334 -21.9237024
[129,]    6.02601110 11.769392  -17.34149289  28.9961334
[130,]   24.57998309 13.652876   -2.23288092  51.5557539
[131,]  -50.17525931 12.537440  -75.48338619 -26.0991014
[132,]   12.27372220 10.763497   -9.36823919  32.9393836
[133,]   26.89050371  9.267344    8.34909107  44.4552848
[134,]   32.79968522  8.202424   16.53270767  48.4801921
[135,]   20.61656673  7.748623    5.45647207  35.6248739
[136,]   10.63724824  8.010485   -5.55999733  26.2923642
[137,]   -1.83267025  8.925239  -19.68568933  15.3932126
[138,]   -9.89448874 10.320718  -30.46079602  10.1864963
[139,]   -8.75430723 12.030788  -32.19742925  14.5561199
[140,]   -9.92102572 13.940150  -37.24519576  17.3738763
[141,]   17.19677823 12.200497   -7.68695481  41.6643588
[142,]    2.36483635 10.513955  -18.73829206  23.4026317
[143,]  -20.17500552  9.114005  -38.18407490  -2.6962573
[144,]  -11.10614740  8.149702  -27.31560839   4.3267127
[145,]   14.71411073  7.784661   -0.47801403  29.4231495
[146,]    5.76006885  8.100307  -10.11556506  21.5844264
[147,]  -24.66347302  9.025504  -42.37016585  -7.1107207
[148,]   13.97878510 10.398808   -6.50270637  34.3753818
[149,]   -5.20945677 12.068198  -28.75803774  18.2157123
[150,]    9.67830135 13.927611  -17.06114004  36.0571489
[151,]   -0.84656388 13.713211  -26.53688897  27.2520188
[152,]   -6.84650530 11.760299  -29.03843715  16.8630324
[153,]  -17.72864672 10.073790  -36.71235274   2.1613867
[154,]  -31.41588814  8.808064  -48.24926618 -13.8986284
[155,]  -19.61102956  8.161304  -35.62621830  -3.6607425
[156,]   41.78592902  8.279849   25.51203515  58.3556873
[157,]  -36.51911240  9.133950  -54.25588321 -18.2363833
[158,]   14.65884618 10.546389   -5.56382066  36.0338299
[159,]   16.97690476 12.326708   -6.32241869  41.5785603
[160,]    8.78326335 14.338525  -18.85697743  37.3651123
[161,]   17.55006870 12.228217   -6.72083945  42.2555570
[162,]   10.65349737 10.496253   -9.86670657  31.6018236
[163,]    6.65062604  9.058124  -10.97648301  24.9771939
[164,]    1.08225471  8.072430  -14.78820201  17.2524433
[165,]  -10.99571662  7.714589  -26.05478921   4.3707009
[166,]  -15.11318795  8.068573  -30.80604554   0.7155826
[167,]  -49.81835928  9.051248  -67.34373742 -31.8721382
[168,]  -13.91253061 10.487352  -34.13324428   6.9631424
[169,]   22.77859806 12.218030   -0.55746226  46.6343442
[170,]   32.00812673 14.135494    4.80078411  59.4833070
[171,]    5.90402828 12.223617  -18.47955171  30.0743781
[172,]   -1.84863171 10.532045  -22.86035275  19.1084642
[173,]   10.45920831  9.127181   -7.72328140  28.8078505
[174,]   11.67904833  8.158503   -4.41194547  27.9829344
[175,]  -23.59491166  7.790457  -38.68257325  -7.8489788
[176,]    7.02512836  8.105280   -8.87285153  22.8009087
[177,]    0.08436837  9.031844  -17.51509137  18.2169006
[178,]   -2.99249161 10.408032  -23.29287725  17.6086288
[179,]   11.11434841 12.081157  -12.41010388  35.2110705
[180,]   -5.71871158 13.944744  -32.73970647  21.9791347</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.3 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   512       
 (0.5, 0.7]   (ok)         1    0.6%   208       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.4
p_loo        33.8  8.5
looic      1721.6 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   714       
 (0.5, 0.7]   (ok)         4    2.2%   279       
   (0.7, 1]   (bad)        2    1.1%   25        
   (1, Inf)   (very bad)   1    0.6%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.6  
fit_sleep1 -92.5      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.6  3.4
looic      1770.3 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   512       
 (0.5, 0.7]   (ok)         1    0.6%   208       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.4
p_loo        33.8  8.5
looic      1721.6 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   714       
 (0.5, 0.7]   (ok)         4    2.2%   279       
   (0.7, 1]   (bad)        2    1.1%   25        
   (1, Inf)   (very bad)   1    0.6%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.8     22.4        33.8    8.5   1721.6
fit_sleep2  -24.3      11.6  -885.1     14.4        19.6    3.4   1770.3
fit_sleep1  -92.5      21.0  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.8  
fit_sleep2   28.7  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.738251e-41 2.668618e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92       1.6     0.28      5.5       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08       1.6    -3.27     3.02       5.18      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.25 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_0.63.0   compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.21      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.4      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.42           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.2         tidyselect_1.2.0    
 [46] abind_1.4-5          yaml_2.3.7           codetools_0.2-19    
 [49] miniUI_0.1.1.1       curl_5.0.0           processx_3.8.1      
 [52] pkgbuild_1.4.0       lattice_0.21-8       tibble_3.2.1        
 [55] plyr_1.8.8           shiny_1.7.4          withr_2.5.0         
 [58] bridgesampling_1.1-2 posterior_1.4.1      coda_0.19-4         
 [61] evaluate_0.21        RcppParallel_5.1.7   xts_0.13.1          
 [64] pillar_1.9.0         tensorA_0.36.2       checkmate_2.2.0     
 [67] DT_0.28              stats4_4.3.0         shinyjs_2.1.0       
 [70] distributional_0.3.2 generics_0.1.3       ggplot2_3.4.2       
 [73] rstantools_2.3.1     munsell_0.5.0        scales_1.2.1        
 [76] minqa_1.2.5          gtools_3.9.4         xtable_1.8-4        
 [79] glue_1.6.2           tools_4.3.0          shinystan_2.6.0     
 [82] colourpicker_1.2.0   mvtnorm_1.1-3        grid_4.3.0          
 [85] crosstalk_1.2.0      colorspace_2.1-0     nlme_3.1-162        
 [88] cli_3.6.1            fansi_1.0.4          Brobdingnag_1.2-9   
 [91] dplyr_1.1.2          V8_4.3.0             gtable_0.3.3        
 [94] sass_0.4.6           digest_0.6.31        htmlwidgets_1.6.2   
 [97] farver_2.1.1         htmltools_0.5.5      lifecycle_1.0.3     
[100] mime_0.12            shinythemes_1.2.0    MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
