<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.10      7.08    15.88    44.52 1.00     2135     2432
sd(Days)                6.57      1.50     4.12     9.98 1.00     1697     2424
cor(Intercept,Days)     0.09      0.30    -0.47     0.67 1.00     1198     1928

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.27      7.42   236.72   265.87 1.00     2314     2892
Days         10.40      1.72     6.95    13.78 1.00     1804     2348

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.53    23.19    29.17 1.00     3204     2142

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6886  12.77260 228.6268 278.8050
309 211.5418  13.34661 184.7841 236.9673
310 212.6805  13.56794 185.4730 239.2098
330 274.3686  13.29980 248.6895 300.5990
331 272.9469  13.15047 247.7323 299.5936
332 260.1516  12.33618 236.5273 285.3268
333 268.0489  12.39720 244.2981 293.4499
334 244.2547  12.45201 219.4802 268.0333
335 250.8278  13.47415 224.7010 278.4059
337 286.0037  13.17710 260.8286 312.3713
349 226.9723  12.63958 201.5093 251.3038
350 238.6363  13.04949 212.7705 263.9846
351 255.6476  12.38688 231.5119 280.6014
352 271.9709  12.72188 247.5187 296.9490
369 254.7079  12.33680 230.2475 279.1261
370 226.1988  13.36322 199.5866 252.0727
371 252.0381  12.54451 227.5544 276.9968
372 263.8706  12.24411 240.5501 288.6435

, , Days

     Estimate Est.Error         Q2.5     Q97.5
308 19.664547  2.470207 14.788073077 24.518062
309  1.718041  2.549296 -3.330222374  6.800235
310  4.946742  2.537588 -0.006394759  9.943351
330  5.765204  2.533223  0.638619919 10.695886
331  7.507169  2.509600  2.507496579 12.421181
332 10.215263  2.389228  5.413482458 14.806834
333 10.265586  2.360584  5.547686852 14.775052
334 11.479768  2.317918  7.084972293 16.152216
335 -0.225847  2.567287 -5.356399327  4.805589
337 19.150953  2.505704 14.206875039 23.972399
349 11.511374  2.412348  6.796807794 16.220581
350 17.031573  2.519056 12.098150274 22.038245
351  7.511014  2.343619  2.801841073 12.077522
352 14.065719  2.414264  9.293137677 18.688363
369 11.340849  2.357053  6.742254636 16.021755
370 15.186428  2.509847 10.440379524 20.145436
371  9.547517  2.373751  4.858240558 14.212739
372 11.703296  2.323489  7.167387822 16.229210</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6886 12.772603 228.6268 278.8050
  [2,] 273.3531 10.924068 251.7909 294.9796
  [3,] 293.0176  9.366695 274.5759 311.3540
  [4,] 312.6822  8.266711 296.5848 328.9669
  [5,] 332.3467  7.819585 317.2188 348.0827
  [6,] 352.0113  8.133704 336.1942 368.3911
  [7,] 371.6758  9.130838 353.7770 389.9672
  [8,] 391.3404 10.620316 370.4536 412.3932
  [9,] 411.0049 12.426337 386.6309 435.5610
 [10,] 430.6695 14.430539 402.3363 459.0026
 [11,] 211.5418 13.346612 184.7841 236.9673
 [12,] 213.2599 11.397205 190.1488 235.1202
 [13,] 214.9779  9.729252 195.4878 233.6238
 [14,] 216.6959  8.509890 199.8500 233.3174
 [15,] 218.4140  7.948329 203.2178 233.9766
 [16,] 220.1320  8.181165 204.4327 236.4854
 [17,] 221.8501  9.147940 204.1069 240.3397
 [18,] 223.5681 10.650633 202.7643 244.8762
 [19,] 225.2861 12.497399 200.7942 250.2117
 [20,] 227.0042 14.557877 198.4826 255.9248
 [21,] 212.6805 13.567937 185.4730 239.2098
 [22,] 217.6272 11.628745 194.5645 240.6113
 [23,] 222.5739  9.962189 202.8071 242.5420
 [24,] 227.5207  8.725906 210.3186 245.1652
 [25,] 232.4674  8.118889 216.7972 248.8958
 [26,] 237.4142  8.280700 221.2786 253.8498
 [27,] 242.3609  9.170733 224.3993 260.3097
 [28,] 247.3076 10.607233 226.2045 268.0933
 [29,] 252.2544 12.401740 227.9676 276.7993
 [30,] 257.2011 14.421222 228.9881 285.4286
 [31,] 274.3686 13.299798 248.6895 300.5990
 [32,] 280.1338 11.375095 257.8710 302.5161
 [33,] 285.8990  9.733211 266.6396 305.1980
 [34,] 291.6643  8.538878 274.9628 308.6807
 [35,] 297.4295  7.995243 281.5495 313.1938
 [36,] 303.1947  8.232243 287.4432 319.7159
 [37,] 308.9599  9.189678 291.6089 327.3339
 [38,] 314.7251 10.675438 294.3011 335.6929
 [39,] 320.4903 12.502569 296.0616 345.3388
 [40,] 326.2555 14.542967 297.6072 355.0844
 [41,] 272.9469 13.150469 247.7323 299.5936
 [42,] 280.4541 11.204107 258.8917 303.1542
 [43,] 287.9613  9.524987 269.6674 307.3445
 [44,] 295.4684  8.277375 279.4681 312.4273
 [45,] 302.9756  7.674677 288.0074 318.6363
 [46,] 310.4828  7.866549 294.9322 325.9148
 [47,] 317.9899  8.801176 300.5564 335.5882
 [48,] 325.4971 10.277888 305.2303 345.6591
 [49,] 333.0043 12.099812 309.2886 356.6808
 [50,] 340.5114 14.134076 312.9675 367.9353
 [51,] 260.1516 12.336183 236.5273 285.3268
 [52,] 270.3669 10.601678 249.3999 291.7125
 [53,] 280.5822  9.166599 262.3930 298.8885
 [54,] 290.7974  8.189892 274.3331 307.1681
 [55,] 301.0127  7.844676 285.3393 316.0972
 [56,] 311.2280  8.210992 294.9625 326.5958
 [57,] 321.4432  9.204273 303.4702 338.5976
 [58,] 331.6585 10.650527 310.5055 351.6322
 [59,] 341.8737 12.392160 317.5361 365.5293
 [60,] 352.0890 14.321813 323.7482 379.3257
 [61,] 268.0489 12.397196 244.2981 293.4499
 [62,] 278.3145 10.654487 257.7423 299.8087
 [63,] 288.5801  9.191869 270.7062 307.0028
 [64,] 298.8457  8.161343 282.7144 314.8801
 [65,] 309.1112  7.737525 293.7614 324.1579
 [66,] 319.3768  8.017219 303.8807 335.0605
 [67,] 329.6424  8.934596 312.4194 347.3496
 [68,] 339.9080 10.320995 319.7751 360.5038
 [69,] 350.1736 12.015139 327.0080 374.0423
 [70,] 360.4392 13.904997 333.7933 388.1085
 [71,] 244.2547 12.452005 219.4802 268.0333
 [72,] 255.7345 10.745105 234.9756 276.1416
 [73,] 267.2142  9.306322 249.2517 285.2751
 [74,] 278.6940  8.276682 262.4448 294.8569
 [75,] 290.1738  7.819513 275.0646 305.4089
 [76,] 301.6536  8.033156 285.8208 317.5601
 [77,] 313.1333  8.869267 295.6350 330.6402
 [78,] 324.6131 10.175544 304.6337 344.5397
 [79,] 336.0929 11.796821 312.8648 359.0166
 [80,] 347.5726 13.621078 320.9949 374.1912
 [81,] 250.8278 13.474146 224.7010 278.4059
 [82,] 250.6020 11.476357 228.3673 273.9962
 [83,] 250.3761  9.748993 231.3971 270.2870
 [84,] 250.1503  8.459366 233.7093 267.1961
 [85,] 249.9244  7.826928 234.7660 265.4892
 [86,] 249.6986  8.008911 234.1606 265.5931
 [87,] 249.4727  8.955804 231.9666 267.2690
 [88,] 249.2469 10.461937 228.9449 269.6532
 [89,] 249.0211 12.323950 224.9959 272.8459
 [90,] 248.7952 14.404488 220.7339 276.5740
 [91,] 286.0037 13.177097 260.8286 312.3713
 [92,] 305.1547 11.286420 283.5670 327.2785
 [93,] 324.3056  9.679243 305.2396 343.5093
 [94,] 343.4566  8.517590 326.6788 360.4689
 [95,] 362.6075  7.998001 346.9608 378.3126
 [96,] 381.7585  8.242804 365.4755 397.4079
 [97,] 400.9095  9.191121 382.7890 418.5007
 [98,] 420.0604 10.656769 399.1363 441.0632
 [99,] 439.2114 12.458484 414.6805 463.7941
[100,] 458.3623 14.471283 430.0666 486.7628
[101,] 226.9723 12.639581 201.5093 251.3038
[102,] 238.4837 10.845273 217.2176 259.4713
[103,] 249.9951  9.333794 231.6074 268.4724
[104,] 261.5065  8.261861 244.9793 278.2987
[105,] 273.0178  7.812542 257.1041 289.1384
[106,] 284.5292  8.090250 268.4899 301.0537
[107,] 296.0406  9.028140 278.1041 314.0007
[108,] 307.5520 10.449944 286.7017 327.5467
[109,] 319.0633 12.187461 294.5301 342.0619
[110,] 330.5747 14.124657 301.4619 357.5015
[111,] 238.6363 13.049494 212.7705 263.9846
[112,] 255.6679 11.130657 233.7821 277.3526
[113,] 272.6994  9.496580 253.7717 290.8419
[114,] 289.7310  8.316841 273.1922 305.7721
[115,] 306.7626  7.800380 291.2915 321.8836
[116,] 323.7942  8.075475 307.8989 339.7721
[117,] 340.8257  9.070390 322.9781 358.4054
[118,] 357.8573 10.584041 337.2033 378.2398
[119,] 374.8889 12.428321 350.5807 398.4314
[120,] 391.9204 14.477420 363.7361 419.9331
[121,] 255.6476 12.386881 231.5119 280.6014
[122,] 263.1586 10.653745 242.3745 284.1848
[123,] 270.6696  9.195371 252.7385 288.4480
[124,] 278.1806  8.160423 262.2081 294.2055
[125,] 285.6916  7.721092 270.6572 300.9406
[126,] 293.2027  7.976410 277.5601 309.2482
[127,] 300.7137  8.866571 283.7041 318.7729
[128,] 308.2247 10.227127 288.4215 328.6831
[129,] 315.7357 11.897784 292.6895 339.3549
[130,] 323.2467 13.766100 296.4144 350.4551
[131,] 271.9709 12.721875 247.5187 296.9490
[132,] 286.0366 10.947185 265.1050 307.7180
[133,] 300.1023  9.460072 281.8842 318.8707
[134,] 314.1680  8.414416 297.8696 330.7970
[135,] 328.2337  7.985561 312.6019 343.6162
[136,] 342.2994  8.270024 326.0401 358.3448
[137,] 356.3652  9.201890 338.4105 374.6405
[138,] 370.4309 10.611955 349.8468 391.1389
[139,] 384.4966 12.337331 360.3083 408.7072
[140,] 398.5623 14.264054 370.0895 426.7185
[141,] 254.7079 12.336798 230.2475 279.1261
[142,] 266.0487 10.649568 244.9484 287.1383
[143,] 277.3896  9.259666 259.1926 295.6721
[144,] 288.7304  8.317507 272.4602 305.0475
[145,] 300.0713  7.983221 284.1369 315.3982
[146,] 311.4121  8.330313 294.9208 327.6949
[147,] 322.7530  9.282662 303.9776 340.7454
[148,] 334.0938 10.679556 312.4705 355.0854
[149,] 345.4347 12.371313 320.3251 370.1091
[150,] 356.7755 14.253325 328.1362 385.0196
[151,] 226.1988 13.363217 199.5866 252.0727
[152,] 241.3852 11.426508 218.4187 263.5607
[153,] 256.5717  9.754654 237.4101 275.3476
[154,] 271.7581  8.505300 254.8961 288.2770
[155,] 286.9445  7.881982 271.3417 302.1745
[156,] 302.1310  8.031800 286.1242 317.9742
[157,] 317.3174  8.915865 299.8711 334.2819
[158,] 332.5038 10.347664 312.0879 352.1572
[159,] 347.6902 12.134838 323.8200 370.8556
[160,] 362.8767 14.143307 335.2908 390.0284
[161,] 252.0381 12.544508 227.5544 276.9968
[162,] 261.5856 10.790727 240.6302 282.9585
[163,] 271.1331  9.315808 252.8968 289.4013
[164,] 280.6806  8.270317 264.6018 296.8915
[165,] 290.2281  7.828244 275.4577 305.4732
[166,] 299.7757  8.089131 284.3292 315.4392
[167,] 309.3232  8.992001 291.6061 326.7132
[168,] 318.8707 10.370511 298.5036 339.2364
[169,] 328.4182 12.062682 304.7427 351.8907
[170,] 337.9657 13.954873 310.3311 364.9396
[171,] 263.8706 12.244106 240.5501 288.6435
[172,] 275.5739 10.565747 255.6021 296.7032
[173,] 287.2772  9.173282 269.9467 305.6680
[174,] 298.9805  8.213428 283.3295 315.7398
[175,] 310.6838  7.846585 295.0400 326.2794
[176,] 322.3871  8.153195 306.2909 338.6338
[177,] 334.0904  9.065180 315.7745 351.8199
[178,] 345.7937 10.424855 324.9660 366.1419
[179,] 357.4970 12.082008 333.2861 380.9609
[180,] 369.2003 13.930880 341.7858 396.4899</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.1285504 12.772603 -2.924505e+01  20.9331845
  [2,]  -14.6483972 10.924068 -3.627493e+01   6.9137736
  [3,]  -42.2170441  9.366695 -6.055343e+01 -23.7753026
  [4,]    8.7576091  8.266711 -7.527129e+00  24.8549944
  [5,]   24.5051622  7.819585  8.769222e+00  39.6330934
  [6,]   62.6788153  8.133704  4.629905e+01  78.4959241
  [7,]   10.5279685  9.130838 -7.763397e+00  28.4267585
  [8,] -101.1917784 10.620316 -1.222446e+02 -80.3050023
  [9,]   19.5803747 12.426337 -4.975709e+00  43.9543555
 [10,]   35.6840279 14.430539  7.350891e+00  64.0172056
 [11,]   11.1920851 13.346612 -1.423343e+01  37.9497653
 [12,]   -7.9940562 11.397205 -2.985442e+01  15.1169695
 [13,]  -12.0000974  9.729252 -3.064600e+01   7.4900224
 [14,]  -11.9889387  8.509890 -2.861042e+01   4.8569573
 [15,]  -10.6978799  7.948329 -2.626051e+01   4.4983242
 [16,]   -4.1702212  8.181165 -2.052363e+01  11.5291231
 [17,]   -8.2197624  9.147940 -2.670944e+01   9.5233786
 [18,]   -5.8409037 10.650633 -2.714899e+01  14.9629216
 [19,]   -0.9904449 12.497399 -2.591603e+01  23.5015176
 [20,]   10.3100138 14.557877 -1.861057e+01  38.8315732
 [21,]  -13.6265531 13.567937 -4.015588e+01  13.5809198
 [22,]  -23.2949951 11.628745 -4.627908e+01  -0.2322514
 [23,]   11.7460629  9.962189 -8.222041e+00  31.5128791
 [24,]    5.3209209  8.725906 -1.232360e+01  22.5230446
 [25,]   -3.1600211  8.118889 -1.958837e+01  12.5101686
 [26,]  -16.9562631  8.280700 -3.339187e+01  -0.8206671
 [27,]   -6.9401051  9.170733 -2.488894e+01  11.0214616
 [28,]    8.4434529 10.607233 -1.234223e+01  29.5465592
 [29,]    8.7581110 12.401740 -1.578684e+01  33.0449472
 [30,]   -9.6858310 14.421222 -3.791327e+01  18.5272017
 [31,]   47.1739600 13.299798  2.094362e+01  72.8531003
 [32,]   20.2663557 11.375095 -2.115907e+00  42.5291637
 [33,]   -2.0425485  9.733211 -2.134152e+01  17.2169246
 [34,]   -6.5312528  8.538878 -2.354767e+01  10.1701813
 [35,]  -11.6321570  7.995243 -2.739655e+01   4.2478449
 [36,]   -5.6091613  8.232243 -2.213039e+01  10.1422833
 [37,]  -28.7202655  9.189678 -4.709433e+01 -11.3692745
 [38,]    3.5362302 10.675438 -1.743157e+01  23.9601601
 [39,]  -15.1407741 12.502569 -3.998925e+01   9.2878814
 [40,]   27.7932217 14.542967 -1.035728e+00  56.4414541
 [41,]   14.6609776 13.150469 -1.198569e+01  39.8755606
 [42,]    4.5459091 11.204107 -1.815425e+01  26.1083464
 [43,]   13.8593406  9.524987 -5.523913e+00  32.1531973
 [44,]   24.6468721  8.277375  7.687961e+00  40.6471845
 [45,]   13.3017036  7.674677 -2.359035e+00  28.2698734
 [46,]  -17.1640650  7.866549 -3.259608e+01  -1.6135052
 [47,]  -27.9149335  8.801176 -4.551324e+01 -10.4813834
 [48,]    9.3205980 10.277888 -1.084137e+01  29.5874203
 [49,]  -39.2573705 12.099812 -6.293392e+01 -15.5416730
 [50,]   31.0696609 14.134076  3.645817e+00  58.6136109
 [51,]  -25.2910408 12.336183 -5.046624e+01  -1.6667330
 [52,]  -27.5551040 10.601678 -4.890071e+01  -6.5880523
 [53,]   -7.6208672  9.166599 -2.592721e+01  10.5683472
 [54,]   18.9713696  8.189892  2.600690e+00  35.4357280
 [55,]   16.4502064  7.844676  1.365743e+00  32.1235881
 [56,]   -1.2303568  8.210992 -1.659823e+01  15.0350856
 [57,]  132.7186800  9.204273  1.155643e+02 150.6917367
 [58,]   15.1726168 10.650527 -4.801134e+00  36.3255781
 [59,]  -11.5734464 12.392160 -3.522903e+01  12.7641789
 [60,]  -98.2246097 14.321813 -1.254613e+02 -69.8838371
 [61,]   15.7934984 12.397196 -9.607467e+00  39.5443260
 [62,]   11.2405127 10.654487 -1.025368e+01  31.8127078
 [63,]  -11.8107730  9.191869 -3.023345e+01   6.0630540
 [64,]    0.9640412  8.161343 -1.507037e+01  17.0953061
 [65,]  -11.9402445  7.737525 -2.698688e+01   3.4096394
 [66,]   18.7896698  8.017219  3.106001e+00  34.2858275
 [67,]    2.3840841  8.934596 -1.532314e+01  19.6071239
 [68,]    8.9318983 10.320995 -1.166395e+01  29.0647773
 [69,]  -16.8135874 12.015139 -4.068233e+01   6.3520066
 [70,]    1.6036269 13.904997 -2.606566e+01  28.2494985
 [71,]   21.2183874 12.452005 -2.560189e+00  45.9929257
 [72,]   20.4667195 10.745105  5.960855e-02  41.2256274
 [73,]  -23.8495483  9.306322 -4.191042e+01  -5.8869789
 [74,]  -24.0217162  8.276682 -4.018463e+01  -7.7724772
 [75,]  -11.1493841  7.819513 -2.638446e+01   3.9597583
 [76,]  -17.4623519  8.033156 -3.336886e+01  -1.6295620
 [77,]   -7.6085198  8.869267 -2.511539e+01   9.8898288
 [78,]    6.9098123 10.175544 -1.301675e+01  26.8892481
 [79,]   -0.3459556 11.796821 -2.326966e+01  22.8820509
 [80,]   29.7263766 13.621078  3.107811e+00  56.3041030
 [81,]   -9.2195312 13.474146 -3.679760e+01  16.9073040
 [82,]   23.3452158 11.476357 -4.898901e-02  45.5798827
 [83,]    4.1145628  9.748993 -1.579626e+01  23.0936261
 [84,]   20.6518098  8.459366  3.606042e+00  37.0927578
 [85,]    1.5274568  7.826928 -1.403728e+01  16.6858647
 [86,]    4.9376039  8.008911 -1.095695e+01  20.4755714
 [87,]   -4.0204491  8.955804 -2.181670e+01  13.4857044
 [88,]  -13.9359021 10.461937 -3.434217e+01   6.3661143
 [89,]  -13.2669551 12.323950 -3.709180e+01  10.7581972
 [90,]  -11.5486081 14.404488 -3.932740e+01  16.5127449
 [91,]   26.3628647 13.177097 -4.748878e-03  51.5379769
 [92,]    8.6511114 11.286420 -1.347266e+01  30.2388009
 [93,]  -32.6944419  9.679243 -5.189808e+01 -13.6283818
 [94,]    2.6656048  8.517590 -1.434671e+01  19.4434477
 [95,]    3.1248515  7.998001 -1.258021e+01  18.7716119
 [96,]   10.0799982  8.242804 -5.569435e+00  26.3629625
 [97,]    3.3506450  9.191121 -1.424061e+01  21.4710785
 [98,]   -3.3681083 10.656769 -2.437090e+01  17.5559821
 [99,]   16.6529384 12.458484 -7.929807e+00  41.1837734
[100,]    0.5543851 14.471283 -2.784614e+01  28.8500867
[101,]    9.1308613 12.639581 -1.520059e+01  34.5939389
[102,]   -8.1670130 10.845273 -2.915458e+01  13.0990502
[103,]  -11.0694873  9.333794 -2.954681e+01   7.3182332
[104,]   -6.5844616  8.261861 -2.337669e+01   9.9426676
[105,]  -22.3075359  7.812542 -3.842810e+01  -6.3937925
[106,]  -14.7548102  8.090250 -3.127932e+01   1.2845004
[107,]  -14.4757845  9.028140 -3.243588e+01   3.4607037
[108,]    0.5500412 10.449944 -1.944470e+01  21.4003416
[109,]   17.2172669 12.187461 -5.781260e+00  41.7504926
[110,]   21.0703926 14.124657 -5.856394e+00  50.1832480
[111,]   17.6605131 13.049494 -7.687768e+00  43.5262749
[112,]  -12.2135598 11.130657 -3.389830e+01   9.6722352
[113,]  -16.4948327  9.496580 -3.463732e+01   2.4328778
[114,]  -34.2039056  8.316841 -5.024505e+01 -17.6651023
[115,]  -37.8460785  7.800380 -5.296709e+01 -22.3750215
[116,]    5.9305486  8.075475 -1.004744e+01  21.8258210
[117,]   38.6187757  9.070390  2.103911e+01  56.4663847
[118,]    5.0611029 10.584041 -1.532138e+01  25.7151154
[119,]   19.5983300 12.428321 -3.944205e+00  43.9064774
[120,]   -2.8677429 14.477420 -3.088037e+01  25.3165741
[121,]   -5.1210907 12.386881 -3.007489e+01  19.0146011
[122,]   36.8989958 10.653745  1.587283e+01  57.6830977
[123,]   -0.7757177  9.195371 -1.855415e+01  17.1554056
[124,]    2.4084687  8.160423 -1.361640e+01  18.3809606
[125,]  -13.8642448  7.721092 -2.911317e+01   1.1701573
[126,]   11.4309416  7.976410 -4.614640e+00  27.0734788
[127,]  -12.9670719  8.866571 -3.102626e+01   4.0425184
[128,]  -41.6291854 10.227127 -6.208758e+01 -21.8259886
[129,]    5.8061010 11.897784 -1.781309e+01  28.8523170
[130,]   24.3187875 13.766100 -2.889615e+00  51.1510916
[131,]  -50.2937565 12.721875 -7.527186e+01 -25.8416363
[132,]   12.1573250 10.947185 -9.524101e+00  33.0888899
[133,]   26.7762065  9.460072  8.007820e+00  44.9942850
[134,]   32.6874880  8.414416  1.605846e+01  48.9858856
[135,]   20.5064695  7.985561  5.124029e+00  36.1383155
[136,]   10.5292510  8.270024 -5.516079e+00  26.7886271
[137,]   -1.9385675  9.201890 -2.021386e+01  16.0161303
[138,]   -9.9982860 10.611955 -3.070634e+01  10.5858439
[139,]   -8.8560045 12.337331 -3.306658e+01  15.3322529
[140,]  -10.0206231 14.264054 -3.817675e+01  18.4522044
[141,]   17.2156224 12.336798 -7.202579e+00  41.6760246
[142,]    2.3881735 10.649568 -1.870139e+01  23.4884872
[143,]  -20.1471755  9.259666 -3.842974e+01  -1.9501514
[144,]  -11.0738245  8.317507 -2.739092e+01   5.1964428
[145,]   14.7509265  7.983221 -5.759539e-01  30.6852604
[146,]    5.8013776  8.330313 -1.048135e+01  22.2926981
[147,]  -24.6176714  9.282662 -4.261008e+01  -5.8423367
[148,]   14.0290796 10.679556 -6.962517e+00  35.6523679
[149,]   -5.1546694 12.371313 -2.982912e+01  19.9549033
[150,]    9.7375817 14.253325 -1.850649e+01  38.3768856
[151,]   -0.9348160 13.363217 -2.680867e+01  25.6773963
[152,]   -6.8617435 11.426508 -2.903717e+01  16.1047861
[153,]  -17.6708711  9.754654 -3.644680e+01   1.4907487
[154,]  -31.2850986  8.505300 -4.780405e+01 -14.4231099
[155,]  -19.4072261  7.881982 -3.463720e+01  -3.8043685
[156,]   42.0627463  8.031800  2.621951e+01  58.0694718
[157,]  -36.1692812  8.915865 -5.313378e+01 -18.7229787
[158,]   15.0816913 10.347664 -4.571672e+00  35.4976013
[159,]   17.4727638 12.134838 -5.692575e+00  41.3429942
[160,]    9.3521362 14.143307 -1.779964e+01  36.9380293
[161,]   17.8423241 12.544508 -7.116357e+00  42.3260180
[162,]   10.8572073 10.790727 -1.051568e+01  31.8126062
[163,]    6.7657905  9.315808 -1.150244e+01  25.0021148
[164,]    1.1088737  8.270317 -1.510197e+01  17.1877340
[165,]  -11.0576431  7.828244 -2.630274e+01   3.7127529
[166,]  -15.2636599  8.089131 -3.092716e+01   0.1827693
[167,]  -50.0573767  8.992001 -6.744742e+01 -32.3402806
[168,]  -14.2400935 10.370511 -3.460581e+01   6.1269651
[169,]   22.3624897 12.062682 -1.110028e+00  46.0380399
[170,]   31.5034730 13.954873  4.529625e+00  59.1380742
[171,]    5.5410858 12.244106 -1.923175e+01  28.8615752
[172,]   -2.0999101 10.565747 -2.322924e+01  17.8718703
[173,]   10.3195941  9.173282 -8.071248e+00  27.6501426
[174,]   11.6510982  8.213428 -5.108169e+00  27.3021310
[175,]  -23.5111976  7.846585 -3.910680e+01  -7.8673911
[176,]    7.2205065  8.153195 -9.026153e+00  23.3166760
[177,]    0.3914106  9.065180 -1.733811e+01  18.7073267
[178,]   -2.5737852 10.424855 -2.292204e+01  18.2538633
[179,]   11.6447189 12.082008 -1.181919e+01  35.8556263
[180,]   -5.0766770 13.930880 -3.236631e+01  22.3378341</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.3
p_loo        19.3  3.3
looic      1769.6 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   740       
 (0.5, 0.7]   (ok)         1    0.6%   195       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.1 21.9
p_loo        33.1  8.0
looic      1720.3 43.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     175   97.2%   783       
 (0.5, 0.7]   (ok)         3    1.7%   86        
   (0.7, 1]   (bad)        1    0.6%   78        
   (1, Inf)   (very bad)   1    0.6%   16        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.7      11.3  
fit_sleep1 -93.1      20.6  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.3
p_loo        19.3  3.3
looic      1769.6 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   740       
 (0.5, 0.7]   (ok)         1    0.6%   195       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.1 21.9
p_loo        33.1  8.0
looic      1720.3 43.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     175   97.2%   783       
 (0.5, 0.7]   (ok)         3    1.7%   86        
   (0.7, 1]   (bad)        1    0.6%   78        
   (1, Inf)   (very bad)   1    0.6%   16        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.1     21.9        33.1    8.0   1720.3
fit_sleep2  -24.7      11.3  -884.8     14.3        19.3    3.3   1769.6
fit_sleep1  -93.1      20.6  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   43.9  
fit_sleep2   28.6  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
3.525550e-41 1.952496e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.98      1.56     0.38     5.51       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.02      1.56    -3.19     2.99       5.58      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.15      
[4] StanHeaders_2.26.15 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.0         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
