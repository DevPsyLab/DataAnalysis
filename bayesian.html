<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.83      6.86    15.05    42.51 1.00     1530     2094
sd(Days)                6.55      1.52     4.12     9.98 1.00     1432     1778
cor(Intercept,Days)     0.08      0.30    -0.49     0.67 1.01     1008     1893

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.46      7.52   236.57   266.06 1.00     2093     2650
Days         10.48      1.68     7.19    13.95 1.00     1481     2052

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.56    23.09    29.28 1.00     3426     2334

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.1547  12.88459 228.3401 278.8081
309 211.1747  13.61647 184.2749 237.8654
310 213.0851  12.91759 186.7946 237.8730
330 274.2998  13.34197 249.1111 300.8469
331 272.9108  13.08593 248.7401 299.7561
332 260.0071  12.37502 236.2385 284.9170
333 267.7870  12.31451 243.9467 292.3712
334 244.0654  12.22178 219.3681 268.0067
335 250.9527  13.07495 225.6192 277.5350
337 285.9089  13.15161 260.4548 312.2523
349 226.5862  13.08775 199.5955 250.7671
350 238.9026  13.30546 212.8789 264.4147
351 255.6626  12.18267 232.0787 280.2141
352 272.1355  12.38408 247.8983 296.7771
369 254.9012  12.39651 230.6021 278.9290
370 226.3700  13.48738 199.2803 251.7638
371 252.2457  11.77047 228.8865 274.6547
372 263.5637  12.29735 239.3169 288.8752

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.5606444  2.428516 15.00303376 24.407077
309  1.8246123  2.504613 -3.05860650  6.720151
310  4.9200664  2.447188  0.06416137  9.786982
330  5.7809453  2.501537  0.87275477 10.635287
331  7.5099789  2.456224  2.66965861 12.242365
332 10.2582528  2.351440  5.68692326 14.942722
333 10.3550566  2.363433  5.48497861 14.899402
334 11.5566541  2.296872  7.05993000 16.105187
335 -0.2369081  2.496189 -5.25246546  4.501006
337 19.1347406  2.529122 14.09879557 24.144147
349 11.5907578  2.480976  6.77340993 16.637095
350 16.9496530  2.538737 12.02877239 21.866311
351  7.5021347  2.351848  2.84809117 12.081491
352 14.0189343  2.312504  9.40696151 18.511823
369 11.2703194  2.396548  6.54490449 15.932330
370 15.1490965  2.560380 10.13670254 20.229316
371  9.4880966  2.280064  5.06646979 13.874261
372 11.7497731  2.363890  7.04187758 16.554732</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.1547 12.884592 228.3401 278.8081
  [2,] 273.7153 11.044172 251.6521 295.4146
  [3,] 293.2760  9.472600 274.7262 311.8035
  [4,] 312.8366  8.323577 296.7376 329.2022
  [5,] 332.3973  7.786469 317.7775 347.8554
  [6,] 351.9579  7.985714 336.7557 367.9334
  [7,] 371.5185  8.871840 354.2124 388.8277
  [8,] 391.0792 10.268536 371.3535 411.2640
  [9,] 410.6398 11.998812 387.1835 434.2567
 [10,] 430.2005 13.938993 402.9933 458.1724
 [11,] 211.1747 13.616470 184.2749 237.8654
 [12,] 212.9993 11.698703 189.9223 235.8332
 [13,] 214.8239 10.042770 195.0934 234.4033
 [14,] 216.6485  8.797782 199.5764 233.9536
 [15,] 218.4731  8.154195 202.6635 234.8014
 [16,] 220.2978  8.253907 204.3613 236.5413
 [17,] 222.1224  9.072444 204.1846 239.9194
 [18,] 223.9470 10.442111 203.2548 244.4422
 [19,] 225.7716 12.178353 202.1516 249.3901
 [20,] 227.5962 14.146839 200.2258 254.6872
 [21,] 213.0851 12.917591 186.7946 237.8730
 [22,] 218.0051 11.085179 195.2845 239.4115
 [23,] 222.9252  9.532875 203.7654 241.5200
 [24,] 227.8453  8.417106 211.1921 244.2337
 [25,] 232.7653  7.924463 217.5184 248.4032
 [26,] 237.6854  8.168476 221.9284 253.6464
 [27,] 242.6055  9.090015 225.2694 260.3388
 [28,] 247.5255 10.512383 227.5442 268.3549
 [29,] 252.4456 12.262523 228.7449 277.0699
 [30,] 257.3657 14.219923 229.4681 286.2486
 [31,] 274.2998 13.341967 249.1111 300.8469
 [32,] 280.0807 11.454428 257.9013 302.8042
 [33,] 285.8617  9.844548 266.7508 305.4095
 [34,] 291.6426  8.668431 274.9196 308.7412
 [35,] 297.4236  8.116873 281.5535 313.6481
 [36,] 303.2045  8.315103 286.9359 319.2864
 [37,] 308.9855  9.214859 290.5135 326.9073
 [38,] 314.7664 10.639628 293.9875 335.5640
 [39,] 320.5474 12.409879 296.4712 344.4178
 [40,] 326.3283 14.398746 298.5750 354.2568
 [41,] 272.9108 13.085930 248.7401 299.7561
 [42,] 280.4207 11.247249 259.5119 303.4491
 [43,] 287.9307  9.686368 270.0418 307.8624
 [44,] 295.4407  8.556689 279.2306 312.4643
 [45,] 302.9507  8.042028 287.1772 318.6356
 [46,] 310.4607  8.258182 294.0993 326.5888
 [47,] 317.9706  9.153524 300.1086 335.6643
 [48,] 325.4806 10.556633 304.6176 345.4830
 [49,] 332.9906 12.294881 308.5075 356.8355
 [50,] 340.5006 14.246114 311.9077 367.8622
 [51,] 260.0071 12.375024 236.2385 284.9170
 [52,] 270.2654 10.675438 249.6781 291.7268
 [53,] 280.5236  9.265380 262.6741 298.8191
 [54,] 290.7819  8.293859 274.3529 307.1514
 [55,] 301.0401  7.923854 285.5222 315.9368
 [56,] 311.2984  8.236830 295.0143 327.2923
 [57,] 321.5566  9.163068 303.2871 339.5022
 [58,] 331.8149 10.542143 310.8398 353.2231
 [59,] 342.0732 12.221714 317.6700 366.4817
 [60,] 352.3314 14.094763 324.3376 380.6922
 [61,] 267.7870 12.314513 243.9467 292.3712
 [62,] 278.1421 10.577032 257.7374 298.7494
 [63,] 288.4971  9.125327 270.7793 306.2421
 [64,] 298.8522  8.114260 283.1754 315.0025
 [65,] 309.2073  7.718968 293.7874 324.4500
 [66,] 319.5623  8.030899 303.4046 335.5967
 [67,] 329.9174  8.976628 312.0738 347.6784
 [68,] 340.2724 10.384410 319.1393 360.7485
 [69,] 350.6275 12.093954 325.7168 374.1996
 [70,] 360.9825 13.995111 332.7300 387.9201
 [71,] 244.0654 12.221777 219.3681 268.0067
 [72,] 255.6220 10.578494 234.5955 277.0638
 [73,] 267.1787  9.218919 249.0992 285.5688
 [74,] 278.7353  8.283939 262.9210 294.7715
 [75,] 290.2920  7.925280 275.0976 305.7373
 [76,] 301.8486  8.218742 285.7948 317.8921
 [77,] 313.4053  9.101463 295.8321 331.2129
 [78,] 324.9620 10.424814 304.8700 345.0385
 [79,] 336.5186 12.044423 313.1706 359.4093
 [80,] 348.0753 13.856794 321.3591 374.9561
 [81,] 250.9527 13.074954 225.6192 277.5350
 [82,] 250.7158 11.194393 228.9925 273.0834
 [83,] 250.4789  9.598769 231.7615 269.5126
 [84,] 250.2420  8.451048 233.7907 266.5037
 [85,] 250.0051  7.947703 234.1530 265.0869
 [86,] 249.7682  8.208146 233.4655 265.7291
 [87,] 249.5313  9.167512 231.4803 267.5440
 [88,] 249.2944 10.638365 227.9495 269.9659
 [89,] 249.0575 12.440589 224.7454 273.0511
 [90,] 248.8206 14.450731 220.6907 276.9143
 [91,] 285.9089 13.151609 260.4548 312.2523
 [92,] 305.0437 11.250609 283.3907 328.0815
 [93,] 324.1784  9.642639 305.7592 343.8209
 [94,] 343.3131  8.495744 326.7585 360.3228
 [95,] 362.4479  8.010479 346.6407 378.2505
 [96,] 381.5826  8.303662 365.2613 397.8220
 [97,] 400.7174  9.301974 382.5591 419.2131
 [98,] 419.8521 10.811825 399.0304 441.5326
 [99,] 438.9868 12.651376 414.4924 464.4209
[100,] 458.1216 14.697346 429.1587 487.3712
[101,] 226.5862 13.087748 199.5955 250.7671
[102,] 238.1770 11.243431 215.1573 258.8645
[103,] 249.7677  9.687662 230.3434 267.9823
[104,] 261.3585  8.578888 244.5691 277.7128
[105,] 272.9492  8.102736 257.2190 288.4210
[106,] 284.5400  8.367905 267.9539 301.1472
[107,] 296.1307  9.311273 277.5266 314.6975
[108,] 307.7215 10.755848 286.0382 329.2742
[109,] 319.3123 12.529453 293.7666 344.1581
[110,] 330.9030 14.511947 301.4521 359.6120
[111,] 238.9026 13.305459 212.8789 264.4147
[112,] 255.8522 11.376259 233.3436 277.8102
[113,] 272.8019  9.731067 253.7602 291.9352
[114,] 289.7516  8.535715 273.0903 306.6848
[115,] 306.7012  7.994597 291.5229 322.7619
[116,] 323.6509  8.237662 308.2143 340.1959
[117,] 340.6005  9.202986 323.0813 358.8631
[118,] 357.5502 10.696784 337.2600 378.5517
[119,] 374.4998 12.531472 350.2163 399.4991
[120,] 391.4495 14.578915 362.8805 420.4378
[121,] 255.6626 12.182666 232.0787 280.2141
[122,] 263.1647 10.471585 242.6201 283.8713
[123,] 270.6669  9.052801 252.9888 288.3036
[124,] 278.1690  8.081751 262.5746 293.6972
[125,] 285.6711  7.729073 270.2998 300.5031
[126,] 293.1733  8.076189 277.4602 308.9959
[127,] 300.6754  9.042868 282.9997 317.9481
[128,] 308.1775 10.458703 287.5719 328.0991
[129,] 315.6797 12.167902 291.6856 339.2628
[130,] 323.1818 14.063911 295.6550 350.4549
[131,] 272.1355 12.384081 247.8983 296.7771
[132,] 286.1544 10.682781 265.1473 307.4606
[133,] 300.1734  9.250595 282.1997 318.4002
[134,] 314.1923  8.229250 298.0116 330.6279
[135,] 328.2112  7.782220 313.2724 343.7250
[136,] 342.2302  8.006291 326.7685 357.7726
[137,] 356.2491  8.850638 339.0192 373.2564
[138,] 370.2680 10.161804 350.6518 389.8347
[139,] 384.2870 11.784993 361.3126 407.1616
[140,] 398.3059 13.609012 371.9328 424.6510
[141,] 254.9012 12.396507 230.6021 278.9290
[142,] 266.1715 10.641435 245.3734 287.1149
[143,] 277.4418  9.181165 259.7137 295.3915
[144,] 288.7121  8.175225 272.8679 304.7007
[145,] 299.9825  7.801392 284.7866 314.8991
[146,] 311.2528  8.147147 294.9566 326.8168
[147,] 322.5231  9.131111 304.4657 340.0890
[148,] 333.7934 10.576636 313.4907 353.9128
[149,] 345.0637 12.322344 320.8883 368.8255
[150,] 356.3341 14.258401 328.0774 383.3178
[151,] 226.3700 13.487378 199.2803 251.7638
[152,] 241.5191 11.512078 218.6180 262.9725
[153,] 256.6682  9.811095 236.8151 275.3091
[154,] 271.8173  8.549756 254.8218 288.3373
[155,] 286.9664  7.940413 271.5098 302.4798
[156,] 302.1154  8.130994 286.7248 318.4675
[157,] 317.2645  9.071222 300.3277 335.4133
[158,] 332.4136 10.562772 312.3545 353.1570
[159,] 347.5627 12.408397 324.0440 371.8941
[160,] 362.7118 14.473271 334.9547 390.9568
[161,] 252.2457 11.770472 228.8865 274.6547
[162,] 261.7338 10.184151 241.3756 281.1643
[163,] 271.2219  8.904339 253.5486 288.5416
[164,] 280.7100  8.078055 264.8936 296.5923
[165,] 290.1981  7.849844 274.6436 305.4975
[166,] 299.6862  8.269373 283.5735 315.6142
[167,] 309.1743  9.248913 291.4534 327.4178
[168,] 318.6624 10.634832 298.5224 339.8276
[169,] 328.1505 12.290414 304.4182 352.1956
[170,] 337.6386 14.121129 310.3739 365.2716
[171,] 263.5637 12.297347 239.3169 288.8752
[172,] 275.3135 10.571556 254.5699 297.0290
[173,] 287.0633  9.136016 268.9545 305.7946
[174,] 298.8130  8.145657 283.1403 315.1400
[175,] 310.5628  7.772557 295.4230 325.9080
[176,] 322.3126  8.102438 306.4496 338.1720
[177,] 334.0624  9.058825 316.4287 351.7773
[178,] 345.8121 10.471441 325.3176 366.2276
[179,] 357.5619 12.182602 333.5580 381.1272
[180,] 369.3117 14.083908 341.6777 396.5853</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error        Q2.5     Q97.5
  [1,]   -5.1384111  29.37773  -64.676850  51.71360
  [2,]  -14.8708781  27.83581  -69.046761  38.09189
  [3,]  -41.7575510  27.92938  -96.965420  13.57221
  [4,]    8.5801607  27.22644  -45.993628  62.43100
  [5,]   23.9074487  27.17999  -30.898791  77.28855
  [6,]   62.9933302  27.47906    8.211916 117.01438
  [7,]   10.6197495  27.08934  -43.088511  63.63881
  [8,] -100.9801726  28.16813 -156.344478 -43.96195
  [9,]   20.1926944  28.84083  -36.833662  78.21695
 [10,]   36.9817630  29.64246  -21.738763  96.08448
 [11,]   11.9104021  29.32792  -45.111937  69.08140
 [12,]   -7.8802056  28.70051  -63.256525  47.86849
 [13,]  -11.5260650  28.98816  -68.186719  45.54226
 [14,]  -11.5843057  28.45766  -66.567110  45.54807
 [15,]  -11.4716792  27.09628  -64.081562  41.91720
 [16,]   -4.2975617  26.71321  -57.925261  48.86967
 [17,]   -7.9497675  27.60107  -61.556182  45.94597
 [18,]   -5.8427128  27.26573  -58.468588  47.78406
 [19,]   -1.1731270  29.01576  -58.328052  57.02869
 [20,]    9.6436630  30.17993  -47.709268  68.90899
 [21,]  -14.5480364  28.93375  -70.476104  43.34626
 [22,]  -23.4136482  27.96206  -78.018548  30.42560
 [23,]   11.2931919  28.02069  -42.783161  66.00835
 [24,]    4.9510527  27.35582  -48.231792  58.77551
 [25,]   -3.2133199  27.08805  -56.117018  49.96188
 [26,]  -16.3622677  27.60535  -71.784091  37.76204
 [27,]   -7.5083769  27.77699  -62.117068  46.89639
 [28,]    8.5267511  28.04337  -48.823996  63.48007
 [29,]    9.1868519  28.05184  -45.103076  64.49319
 [30,]   -9.3952248  29.71556  -69.235294  49.11765
 [31,]   47.3354180  29.37970   -8.693707 105.29688
 [32,]   21.0761415  28.12488  -33.159055  75.33793
 [33,]   -2.2571341  27.38237  -55.976915  51.31987
 [34,]   -5.9194168  27.25840  -60.234231  48.73864
 [35,]  -11.3487121  27.38690  -65.435907  42.22804
 [36,]   -5.9015032  27.41686  -59.717615  47.20958
 [37,]  -29.2290290  27.56213  -83.383479  23.84779
 [38,]    3.1816584  27.89764  -52.380532  57.08920
 [39,]  -15.2274138  28.36176  -69.369160  39.64954
 [40,]   27.7405057  29.55731  -29.740435  85.99417
 [41,]   14.8056741  29.49615  -43.772759  69.68992
 [42,]    3.6673196  28.27180  -52.436047  58.92665
 [43,]   14.5001557  27.57405  -40.604749  66.66603
 [44,]   25.0482595  27.05455  -28.481493  77.30584
 [45,]   13.5890844  27.09252  -40.034278  66.32099
 [46,]  -17.3856496  27.78759  -72.056399  38.01934
 [47,]  -28.1379946  27.46842  -81.273484  24.98662
 [48,]    9.4599926  27.86910  -45.792400  64.02728
 [49,]  -39.5099176  29.02934  -96.340478  19.06926
 [50,]   30.8025176  29.62879  -27.588019  88.77229
 [51,]  -25.7716444  29.41647  -85.015902  31.79746
 [52,]  -27.3069853  27.90138  -80.939383  27.53029
 [53,]   -7.6684966  27.72867  -63.727500  45.84728
 [54,]   18.2231639  27.20330  -34.190367  72.36246
 [55,]   16.2489277  27.83315  -37.902333  71.46032
 [56,]   -0.8298416  27.45877  -54.541164  52.82801
 [57,]  132.5672211  27.29886   79.140706 184.76542
 [58,]   15.6428179  27.90750  -38.950908  70.13309
 [59,]  -11.2055820  28.50114  -66.986984  44.87924
 [60,]  -98.2357258  29.62820 -156.785894 -42.04944
 [61,]   16.0066137  28.61022  -39.426352  72.14810
 [62,]   11.5560423  28.08841  -44.898000  66.25564
 [63,]  -11.9168521  27.32614  -66.572178  41.53350
 [64,]    1.2337446  26.79774  -50.699292  55.04876
 [65,]  -11.7933485  28.09682  -66.923138  41.60871
 [66,]   19.3850038  27.39413  -33.814818  71.17411
 [67,]    2.1251062  28.04165  -52.786724  56.10627
 [68,]    7.7574863  28.20311  -47.705011  61.45888
 [69,]  -17.5504498  28.78695  -74.031424  38.13223
 [70,]    1.0545265  29.77773  -57.080885  60.38098
 [71,]   21.5720943  28.16595  -34.501317  75.79007
 [72,]   20.2006310  27.75537  -33.415065  73.50657
 [73,]  -23.3071576  27.72364  -76.773525  32.33192
 [74,]  -24.3096042  27.56590  -79.068209  29.84957
 [75,]  -10.9240270  27.38942  -65.654125  41.55168
 [76,]  -18.3110377  27.07210  -70.575268  34.81406
 [77,]   -7.6431845  27.46001  -62.458348  46.09342
 [78,]    6.9359674  28.28445  -48.187933  61.21309
 [79,]   -0.8297865  28.28675  -54.602819  54.49616
 [80,]   29.7518455  28.92751  -26.155421  85.98803
 [81,]   -8.9006089  28.84354  -65.743543  47.46215
 [82,]   23.1175520  28.14273  -31.360415  77.72312
 [83,]    4.6477229  27.26267  -48.212891  59.25989
 [84,]   20.7884975  27.63429  -32.824043  75.65719
 [85,]    0.7640547  27.18940  -53.295098  53.36595
 [86,]    5.0534275  27.15981  -48.754024  57.46561
 [87,]   -3.9395024  27.80989  -57.974172  51.19550
 [88,]  -13.6416687  27.66685  -67.103913  40.09539
 [89,]  -12.7017164  28.85214  -68.639144  43.89621
 [90,]  -11.3613606  29.55389  -69.461691  47.21369
 [91,]   26.2450597  29.39258  -29.772876  84.17413
 [92,]    9.2768589  28.53794  -46.500213  64.99135
 [93,]  -33.0581446  28.31882  -88.429243  22.02078
 [94,]    2.6496709  27.10507  -50.292856  55.56569
 [95,]    3.9659105  27.46587  -49.320453  58.16338
 [96,]   10.0951403  27.38788  -42.645729  63.31023
 [97,]    2.9263248  27.58475  -50.814601  57.58969
 [98,]   -2.7769723  28.09161  -58.114259  51.99359
 [99,]   16.7447122  28.59021  -40.185904  73.79326
[100,]    0.2838078  29.64176  -57.576775  57.77061
[101,]    9.6099039  29.13823  -48.383628  67.04868
[102,]   -8.0803317  28.19808  -61.755574  48.09059
[103,]  -11.3411995  27.32909  -64.553887  42.57332
[104,]   -6.6559868  27.36723  -60.463797  47.64647
[105,]  -22.4391311  27.07910  -74.946836  30.81401
[106,]  -14.5061841  27.26382  -68.863212  38.86447
[107,]  -15.0747827  27.54262  -69.471610  37.81837
[108,]    0.4269159  28.12337  -55.121158  56.72658
[109,]   17.0861504  28.96711  -38.775873  73.10679
[110,]   20.5084674  30.18716  -38.642433  77.82101
[111,]   16.8548609  29.23665  -41.808336  73.59938
[112,]  -12.7556015  28.82469  -69.959562  42.91005
[113,]  -17.0327200  27.62867  -72.175526  35.10024
[114,]  -34.2657134  27.43615  -87.776821  19.89309
[115,]  -37.9753144  27.03566  -91.626130  13.76066
[116,]    6.2887928  27.18401  -47.800916  58.76101
[117,]   38.8240574  27.13799  -14.810099  91.76897
[118,]    5.7887511  28.23235  -50.156758  60.23253
[119,]   19.3783039  28.97701  -36.664495  77.54635
[120,]   -2.1350042  29.54064  -60.147605  56.48492
[121,]   -5.9214724  28.96057  -62.495198  50.02114
[122,]   37.7696517  27.78378  -17.729925  92.44957
[123,]   -1.1715055  27.48312  -54.112734  53.84075
[124,]    2.4958186  27.25214  -51.313647  56.22558
[125,]  -13.5164864  27.22484  -67.994093  39.75636
[126,]   11.8051273  27.54098  -41.094466  65.92674
[127,]  -13.2416653  27.39488  -67.765350  40.94212
[128,]  -41.2328730  27.79301  -96.782088  13.68907
[129,]    5.7173179  28.57734  -50.489369  60.23714
[130,]   24.7337382  29.58545  -33.300420  83.76461
[131,]  -50.5637454  28.55374 -107.064242   4.29583
[132,]   11.7992971  28.37384  -42.172575  67.83253
[133,]   26.6465528  28.03667  -28.507274  81.35075
[134,]   32.2117251  27.13381  -22.663399  83.61345
[135,]   20.4382126  27.28253  -33.701877  73.37505
[136,]   11.0846408  26.72046  -38.330710  65.22063
[137,]   -2.3664810  27.43935  -57.375352  51.07876
[138,]   -9.7448432  28.08475  -65.542924  43.48499
[139,]   -9.2235224  28.59619  -65.099941  46.81440
[140,]   -9.8944371  29.29072  -68.355593  46.70358
[141,]   18.1440337  28.98405  -38.639519  74.78587
[142,]    2.5367712  28.10685  -51.799409  57.35914
[143,]  -20.2232799  27.26032  -74.596551  33.16040
[144,]  -11.5715681  27.39990  -65.908159  42.72588
[145,]   14.9289188  26.84341  -37.416495  67.15120
[146,]    5.2764536  27.16804  -48.719152  58.37789
[147,]  -24.3837792  27.75299  -79.407394  31.26454
[148,]   14.2804539  28.03196  -40.623980  69.48642
[149,]   -4.5582421  28.76251  -59.433413  50.79138
[150,]    9.7145073  29.62783  -48.482151  68.31208
[151,]   -1.1005562  29.63646  -58.044136  56.67143
[152,]   -6.9695549  28.12152  -62.447264  48.74613
[153,]  -17.2044569  28.43111  -72.529896  37.96883
[154,]  -30.8038984  27.92899  -84.935056  25.26601
[155,]  -19.7991407  26.98953  -72.044031  32.76488
[156,]   42.4398066  27.08685  -10.858287  96.48381
[157,]  -36.2009115  27.78622  -91.696553  19.38480
[158,]   15.4684550  27.76548  -39.308508  70.33519
[159,]   18.1023083  29.14358  -39.518711  75.52449
[160,]    9.9142705  29.97489  -47.793199  68.58619
[161,]   18.0521250  28.87069  -39.009697  74.24339
[162,]   11.2231057  28.48520  -43.793235  65.33465
[163,]    6.3844414  27.83543  -48.238625  60.90777
[164,]    0.8290475  26.97880  -52.621872  54.62592
[165,]  -11.6851348  27.00315  -65.199542  39.68970
[166,]  -15.1080677  27.70196  -69.495449  39.83208
[167,]  -49.4800519  27.04366 -101.901032   3.29530
[168,]  -13.4529797  28.16206  -68.662369  41.52542
[169,]   21.9264668  28.21278  -33.878270  77.24635
[170,]   31.6613793  29.86076  -24.558940  89.37976
[171,]    6.3302094  28.67673  -50.952557  62.11116
[172,]   -1.9558781  27.84869  -56.793739  51.99742
[173,]   10.4571062  27.74648  -44.111217  64.14705
[174,]   11.7179512  26.92018  -41.409250  63.26219
[175,]  -23.7041029  26.68588  -75.226094  29.55655
[176,]    7.2299502  27.29001  -47.704707  60.87888
[177,]    0.5748087  27.72879  -53.061348  54.74626
[178,]   -2.3999806  28.04558  -57.447025  52.35988
[179,]   12.1543154  29.02228  -44.076313  68.39477
[180,]   -4.6813652  29.08916  -61.476031  53.44920</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.1  3.3
looic      1769.4 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1436      
 (0.5, 0.7]   (ok)         2    1.1%   188       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.7
p_loo        34.5  8.9
looic      1723.4 45.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   855       
 (0.5, 0.7]   (ok)         3    1.7%   365       
   (0.7, 1]   (bad)        1    0.6%   65        
   (1, Inf)   (very bad)   2    1.1%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.0      12.0  
fit_sleep1 -91.6      21.3  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.1  3.3
looic      1769.4 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1436      
 (0.5, 0.7]   (ok)         2    1.1%   188       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.7
p_loo        34.5  8.9
looic      1723.4 45.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   855       
 (0.5, 0.7]   (ok)         3    1.7%   365       
   (0.7, 1]   (bad)        1    0.6%   65        
   (1, Inf)   (very bad)   2    1.1%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.7     22.7        34.5    8.9   1723.4
fit_sleep2  -23.0      12.0  -884.7     14.3        19.1    3.3   1769.4
fit_sleep1  -91.6      21.3  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   45.5  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.669852e-40 1.049566e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(
  set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
  set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
  set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))

bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.83      1.57     0.21     5.32       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.17      1.57    -3.43     2.84       5.22      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.20.1         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-1       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.3       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.1       rmarkdown_2.24      
 [22] markdown_1.8         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.40            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.1          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.1         tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.2          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.5         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.29              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.3        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.3.0   mvtnorm_1.2-3       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.3            
 [94] gtable_0.3.4         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.6     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoCiAgc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogIHNldF9wcmlvcigibGtqKDIpIiwgY2xhc3MgPSAiY29yIikpCgpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
