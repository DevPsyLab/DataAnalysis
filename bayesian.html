<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.94      6.76    16.01    42.20 1.00     2074     2561
sd(Days)                6.55      1.54     4.12    10.18 1.00     1313     1524
cor(Intercept,Days)     0.08      0.30    -0.48     0.67 1.00      830     1265

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.04      7.40   236.89   265.76 1.00     1783     2368
Days         10.37      1.72     6.98    13.63 1.00     1242     1360

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.50    23.18    29.02 1.00     3961     2937

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6677  12.63209 227.7891 277.3234
309 211.2879  13.19799 184.5692 235.6052
310 212.6596  13.06183 186.7031 237.9205
330 274.0912  13.41906 247.8307 301.5485
331 273.0324  13.05215 248.3228 299.4845
332 260.0931  12.28088 236.3225 284.5718
333 267.8174  12.50609 243.1931 293.2988
334 244.3659  12.09025 220.0655 267.3709
335 250.8064  13.40963 225.3797 278.0482
337 285.9432  13.20650 259.9346 311.8116
349 226.4106  13.04429 200.4193 250.9046
350 238.7525  13.35318 211.7820 263.5117
351 255.8594  12.05483 232.8060 279.4266
352 271.9531  12.71499 247.1986 297.5019
369 254.7168  12.30999 230.8049 279.5528
370 226.3048  13.47717 199.4102 251.9463
371 251.9676  12.41291 227.4689 276.5240
372 263.7758  12.17122 239.9241 288.6750

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6314508  2.493910 14.8656751 24.797149
309  1.8204201  2.466669 -2.9809379  6.721902
310  4.9428245  2.453319  0.1152115  9.826772
330  5.8222703  2.503759  0.6980743 10.622097
331  7.4898096  2.459589  2.5642517 12.174633
332 10.2724491  2.309843  5.6840213 14.708540
333 10.2944515  2.371247  5.5673971 14.861845
334 11.4968117  2.354664  6.9680820 16.246236
335 -0.2181274  2.567918 -5.3241685  4.785527
337 19.1303177  2.472756 14.3750061 23.969155
349 11.5778674  2.455221  6.9078907 16.435997
350 17.0362378  2.544675 12.1984333 22.224003
351  7.4528475  2.321945  2.8545904 11.936484
352 14.0172508  2.374095  9.2794693 18.698928
369 11.3203078  2.337199  6.5598111 15.939867
370 15.1789593  2.533846 10.3565363 20.131362
371  9.4986242  2.389907  4.8247248 14.311954
372 11.7234572  2.333746  7.0194346 16.314042</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6677 12.632088 227.7891 277.3234
  [2,] 273.2992 10.787067 251.3175 293.4404
  [3,] 292.9306  9.251550 274.3143 310.7368
  [4,] 312.5621  8.201262 296.1633 328.5658
  [5,] 332.1935  7.833862 316.6660 347.3910
  [6,] 351.8250  8.241194 335.1823 367.1952
  [7,] 371.4564  9.322249 353.0068 388.9682
  [8,] 391.0879 10.877985 369.3387 411.6135
  [9,] 410.7193 12.735618 385.4111 435.1360
 [10,] 430.3508 14.781764 401.1106 459.0696
 [11,] 211.2879 13.197986 184.5692 235.6052
 [12,] 213.1083 11.364893 190.6994 234.2213
 [13,] 214.9287  9.813444 195.6761 234.0134
 [14,] 216.7492  8.695717 199.9049 234.0449
 [15,] 218.5696  8.191227 202.7477 235.1379
 [16,] 220.3900  8.411053 204.3298 237.1438
 [17,] 222.2104  9.303997 203.9839 240.9102
 [18,] 224.0308 10.702888 203.1475 245.4510
 [19,] 225.8513 12.438174 201.1928 250.3105
 [20,] 227.6717 14.388656 198.9998 255.7315
 [21,] 212.6596 13.061827 186.7031 237.9205
 [22,] 217.6024 11.243725 195.4511 239.1956
 [23,] 222.5453  9.709219 203.5537 240.9980
 [24,] 227.4881  8.611275 210.7264 243.6933
 [25,] 232.4309  8.128759 216.4859 248.0294
 [26,] 237.3737  8.368808 220.9221 254.0430
 [27,] 242.3165  9.275490 224.2824 260.8216
 [28,] 247.2594 10.680358 226.4059 268.4779
 [29,] 252.2022 12.415430 227.4641 276.7937
 [30,] 257.1450 14.361523 228.6792 285.3445
 [31,] 274.0912 13.419064 247.8307 301.5485
 [32,] 279.9135 11.487383 257.7240 303.2377
 [33,] 285.7357  9.817651 266.6581 304.9684
 [34,] 291.5580  8.564472 275.1178 307.9924
 [35,] 297.3803  7.927908 282.1384 312.4727
 [36,] 303.2025  8.055488 287.7356 319.1550
 [37,] 309.0248  8.914463 291.7112 326.9600
 [38,] 314.8471 10.323858 294.7763 335.3687
 [39,] 320.6694 12.092727 297.1386 344.7703
 [40,] 326.4916 14.086294 298.3506 354.0961
 [41,] 273.0324 13.052150 248.3228 299.4845
 [42,] 280.5222 11.195124 259.1381 302.7346
 [43,] 288.0120  9.612603 269.5740 307.2643
 [44,] 295.5018  8.460062 279.2105 312.1661
 [45,] 302.9916  7.927314 287.4722 318.4975
 [46,] 310.4814  8.137022 294.3402 326.4487
 [47,] 317.9712  9.037649 300.0597 335.7020
 [48,] 325.4611 10.452092 304.8585 346.3301
 [49,] 332.9509 12.202972 308.9522 356.8746
 [50,] 340.4407 14.166086 312.6825 368.0541
 [51,] 260.0931 12.280883 236.3225 284.5718
 [52,] 270.3656 10.590908 249.4527 291.0749
 [53,] 280.6380  9.175256 262.3973 298.6579
 [54,] 290.9105  8.177656 274.5359 307.0848
 [55,] 301.1829  7.761028 285.8793 316.5592
 [56,] 311.4554  8.016470 295.9086 326.9511
 [57,] 321.7278  8.886214 304.5551 339.0327
 [58,] 332.0003 10.214526 312.0942 352.0643
 [59,] 342.2727 11.848167 318.9781 365.8523
 [60,] 352.5452 13.678169 325.4016 379.6766
 [61,] 267.8174 12.506090 243.1931 293.2988
 [62,] 278.1119 10.753697 257.2477 299.9732
 [63,] 288.4063  9.280482 270.3209 306.8986
 [64,] 298.7008  8.237616 282.5063 314.7685
 [65,] 308.9952  7.799674 293.3005 324.0990
 [66,] 319.2897  8.065800 303.4303 334.8600
 [67,] 329.5841  8.973571 312.0644 347.0657
 [68,] 339.8786 10.355600 319.6848 360.4814
 [69,] 350.1730 12.049795 326.9502 374.2028
 [70,] 360.4675 13.942822 333.4330 388.3813
 [71,] 244.3659 12.090248 220.0655 267.3709
 [72,] 255.8627 10.395971 235.4806 275.6594
 [73,] 267.3595  9.003732 249.9098 284.5721
 [74,] 278.8563  8.071373 263.1108 294.6799
 [75,] 290.3531  7.766326 275.4532 305.7425
 [76,] 301.8500  8.159257 286.4965 318.1430
 [77,] 313.3468  9.160786 295.7482 331.6306
 [78,] 324.8436 10.599784 304.6474 345.7878
 [79,] 336.3404 12.323950 311.9557 361.1204
 [80,] 347.8372 14.230001 319.8734 375.8777
 [81,] 250.8064 13.409630 225.3797 278.0482
 [82,] 250.5882 11.450207 228.9096 273.7935
 [83,] 250.3701  9.776744 231.7758 270.0855
 [84,] 250.1520  8.558657 233.6983 266.7972
 [85,] 249.9339  8.006553 233.9779 265.4213
 [86,] 249.7157  8.255154 233.0174 265.8331
 [87,] 249.4976  9.240058 231.4672 267.2582
 [88,] 249.2795 10.760955 228.2648 270.3352
 [89,] 249.0614 12.625611 223.5237 273.8537
 [90,] 248.8432 14.703821 218.4770 278.1174
 [91,] 285.9432 13.206499 259.9346 311.8116
 [92,] 305.0735 11.348212 282.5418 327.3347
 [93,] 324.2038  9.766332 304.7837 343.5564
 [94,] 343.3342  8.614500 326.5535 360.2370
 [95,] 362.4645  8.078801 346.6062 378.6126
 [96,] 381.5948  8.279703 365.6229 398.4758
 [97,] 400.7251  9.168914 382.9148 418.8378
 [98,] 419.8554 10.574191 399.3145 440.5475
 [99,] 438.9858 12.320191 414.7019 462.9557
[100,] 458.1161 14.282497 429.9680 486.0511
[101,] 226.4106 13.044294 200.4193 250.9046
[102,] 237.9885 11.233982 215.5930 259.3748
[103,] 249.5664  9.711196 230.1092 268.0816
[104,] 261.1442  8.629516 244.2684 278.4469
[105,] 272.7221  8.166148 256.6939 288.8333
[106,] 284.3000  8.423753 267.9688 300.7830
[107,] 295.8778  9.342884 277.7672 314.5170
[108,] 307.4557 10.755258 286.2073 328.5262
[109,] 319.0336 12.494715 294.4939 343.0367
[110,] 330.6114 14.443560 302.3089 358.2575
[111,] 238.7525 13.353184 211.7820 263.5117
[112,] 255.7887 11.421236 232.6436 276.8414
[113,] 272.8250  9.774072 252.9850 291.2026
[114,] 289.8612  8.577358 272.4766 306.6186
[115,] 306.8974  8.034948 291.0879 322.8685
[116,] 323.9337  8.276500 308.0212 340.1899
[117,] 340.9699  9.240738 323.3928 358.8375
[118,] 358.0061 10.734653 337.3933 378.9815
[119,] 375.0424 12.570801 350.6800 399.8063
[120,] 392.0786 14.620809 363.3755 420.7881
[121,] 255.8594 12.054825 232.8060 279.4266
[122,] 263.3122 10.369840 243.1879 283.7199
[123,] 270.7651  8.973919 253.3177 288.3648
[124,] 278.2179  8.019459 262.8147 294.2125
[125,] 285.6708  7.673009 271.0007 300.9083
[126,] 293.1236  8.013818 277.3320 309.1742
[127,] 300.5765  8.963836 283.2475 318.8628
[128,] 308.0293 10.356751 288.0210 329.3342
[129,] 315.4822 12.039812 292.2090 340.2668
[130,] 322.9350 13.908081 295.9688 350.9695
[131,] 271.9531 12.714993 247.1986 297.5019
[132,] 285.9704 10.918351 264.7531 308.1037
[133,] 299.9876  9.382025 282.0448 318.9275
[134,] 314.0049  8.252700 297.9052 330.5143
[135,] 328.0221  7.711315 312.7826 343.2086
[136,] 342.0394  7.879997 326.1126 357.8093
[137,] 356.0566  8.717625 338.9870 373.1712
[138,] 370.0739 10.058443 350.2704 389.9882
[139,] 384.0911 11.731165 360.8641 407.1766
[140,] 398.1084 13.613994 371.1534 425.2679
[141,] 254.7168 12.309989 230.8049 279.5528
[142,] 266.0371 10.618113 245.5923 287.3066
[143,] 277.3575  9.212916 259.8371 295.6539
[144,] 288.6778  8.242349 273.0162 305.1159
[145,] 299.9981  7.868915 284.6199 315.8050
[146,] 311.3184  8.174859 295.0991 327.3143
[147,] 322.6387  9.091855 304.5758 339.8036
[148,] 333.9590 10.460418 313.1797 354.1334
[149,] 345.2793 12.128638 321.5091 368.9264
[150,] 356.5996 13.989724 328.8844 384.2728
[151,] 226.3048 13.477175 199.4102 251.9463
[152,] 241.4837 11.529429 218.7338 263.5125
[153,] 256.6627  9.852005 237.3973 276.0312
[154,] 271.8416  8.604475 254.9009 289.1427
[155,] 287.0206  7.990791 271.7960 303.1612
[156,] 302.1996  8.155319 286.6759 318.2744
[157,] 317.3785  9.055743 299.2590 334.9748
[158,] 332.5575 10.504498 311.5007 353.1263
[159,] 347.7364 12.309476 323.4805 371.3928
[160,] 362.9154 14.336760 334.5561 390.4730
[161,] 251.9676 12.412907 227.4689 276.5240
[162,] 261.4662 10.687468 240.3728 282.2417
[163,] 270.9648  9.262127 252.5719 288.9483
[164,] 280.4635  8.293089 264.2282 296.5002
[165,] 289.9621  7.949024 274.1513 305.3940
[166,] 299.4607  8.307945 283.0179 315.6091
[167,] 308.9593  9.288715 290.5547 326.7346
[168,] 318.4580 10.722025 296.8879 339.4010
[169,] 327.9566 12.452579 303.4217 352.5895
[170,] 337.4552 14.373411 309.2888 365.4579
[171,] 263.7758 12.171222 239.9241 288.6750
[172,] 275.4993 10.468117 254.9720 296.8749
[173,] 287.2227  9.050803 269.4266 305.5568
[174,] 298.9462  8.071266 283.1881 314.7874
[175,] 310.6696  7.698465 295.8788 325.4578
[176,] 322.3931  8.017490 306.6169 338.0651
[177,] 334.1166  8.954701 316.4539 351.4019
[178,] 345.8400 10.343401 325.6639 365.8751
[179,] 357.5635 12.028214 333.9227 381.1487
[180,] 369.2869 13.901895 341.8862 396.4164</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.1077366 12.632088  -27.76339155  21.7708782
  [2,]  -14.5944874 10.787067  -34.73573391   7.3872102
  [3,]  -42.1300382  9.251550  -59.93615669 -23.5137191
  [4,]    8.8777110  8.201262   -7.12602410  25.2764791
  [5,]   24.6583602  7.833862    9.46089896  40.1859179
  [6,]   62.8651094  8.241194   47.49485524  79.5077687
  [7,]   10.7473586  9.322249   -6.76444265  29.1970370
  [8,] -100.9392922 10.877985 -121.46490449 -79.1900661
  [9,]   19.8659570 12.735618   -4.55069007  45.1742391
 [10,]   36.0027062 14.781764    7.28390632  65.2429240
 [11,]   11.4460001 13.197986  -12.87134536  38.1647101
 [12,]   -7.8425201 11.364893  -28.95550809  14.5663572
 [13,]  -11.9509402  9.813444  -31.03559820   7.3017066
 [14,]  -12.0421603  8.695717  -29.33793777   4.8020622
 [15,]  -10.8534805  8.191227  -27.42181124   4.9683931
 [16,]   -4.4282006  8.411053  -21.18197292  11.6320323
 [17,]   -8.5801207  9.303997  -27.27986237   9.6463847
 [18,]   -6.3036409 10.702888  -27.72382541  14.5796880
 [19,]   -1.5555610 12.438174  -26.01481410  23.1028504
 [20,]    9.6425189 14.388656  -18.41728314  38.3143785
 [21,]  -13.6057028 13.061827  -38.86660934  12.3507535
 [22,]  -23.2702273 11.243725  -44.86335459  -1.1188869
 [23,]   11.7747483  9.709219   -6.67796714  30.7663355
 [24,]    5.3535238  8.611275  -10.85170221  22.1151569
 [25,]   -3.1235006  8.128759  -18.72202866  12.8215147
 [26,]  -16.9158251  8.368808  -33.58513724  -0.4642057
 [27,]   -6.8957495  9.275490  -25.40077512  11.1383725
 [28,]    8.4917260 10.680358  -12.72682087  29.3451790
 [29,]    8.8103015 12.415430  -15.78121615  33.5484147
 [30,]   -9.6297229 14.361523  -37.82923769  18.8361088
 [31,]   47.4514079 13.419064   19.99412079  73.7118688
 [32,]   20.4867376 11.487383   -2.83749663  42.6761654
 [33,]   -1.8792327  9.817651  -21.11190558  17.1984048
 [34,]   -6.4250029  8.564472  -22.85940398  10.0151992
 [35,]  -11.5829732  7.927908  -26.67541008   3.6589212
 [36,]   -5.6170435  8.055488  -21.56950214   9.8498998
 [37,]  -28.7852137  8.914463  -46.72042269 -11.4715870
 [38,]    3.4142160 10.323858  -17.10740093  23.4849961
 [39,]  -15.3198543 12.092727  -39.42083356   8.2108683
 [40,]   27.5570755 14.086294   -0.04735358  55.6980781
 [41,]   14.5755080 13.052150  -11.87664609  39.2851135
 [42,]    4.4777985 11.195124  -17.73460802  25.8619199
 [43,]   13.8085889  9.612603   -5.44373531  32.2466312
 [44,]   24.6134794  8.460062    7.94917720  40.9047640
 [45,]   13.2856698  7.927314   -2.22018384  28.8050991
 [46,]  -17.1627398  8.137022  -33.13002869  -1.0214713
 [47,]  -27.8962493  9.037649  -45.62703751  -9.9846980
 [48,]    9.3566411 10.452092  -11.51236282  29.9592140
 [49,]  -39.2039685 12.202972  -63.12770864 -15.2052777
 [50,]   31.1404220 14.166086    3.52699403  58.8986030
 [51,]  -25.2325305 12.280883  -49.71119641  -1.4619450
 [52,]  -27.5537796 10.590908  -48.26312890  -6.6409198
 [53,]   -7.6767287  9.175256  -25.69657344  10.5640276
 [54,]   18.8583222  8.177656    2.68397750  35.2328865
 [55,]   16.2799730  7.761028    0.90374115  31.5835625
 [56,]   -1.4577761  8.016470  -16.95352798  14.0890071
 [57,]  132.4340748  8.886214  115.12919957 149.6068218
 [58,]   14.8308257 10.214526   -5.23316083  34.7369113
 [59,]  -11.9724235 11.848167  -35.55204495  11.3221622
 [60,]  -98.6807726 13.678169 -125.81219457 -71.5372253
 [61,]   16.0249627 12.506090   -9.45635813  40.6492791
 [62,]   11.4431113 10.753697  -10.41816888  32.3073068
 [63,]  -11.6370402  9.280482  -30.12934090   6.4484036
 [64,]    1.1089084  8.237616  -14.95881792  17.3034186
 [65,]  -11.8242431  7.799674  -26.92795312   3.8704516
 [66,]   18.8768054  8.065800    3.30651055  34.7362147
 [67,]    2.4423540  8.973571  -15.03923750  19.9620728
 [68,]    8.9613025 10.355600  -11.64152084  29.1551387
 [69,]  -16.8130490 12.049795  -40.84280918   6.4097587
 [70,]    1.5752996 13.942822  -26.33849896  28.6097770
 [71,]   21.1072008 12.090248   -1.89780240  45.4076402
 [72,]   20.3384891 10.395971    0.54175659  40.7206315
 [73,]  -23.9948226  9.003732  -41.20741245  -6.5451330
 [74,]  -24.1840344  8.071373  -40.00760967  -8.4385255
 [75,]  -11.3287461  7.766326  -26.71809147   3.5712108
 [76,]  -17.6587578  8.159257  -33.95179256  -2.3053428
 [77,]   -7.8219695  9.160786  -26.10576331   9.7766291
 [78,]    6.6793188 10.599784  -14.26493033  26.8755279
 [79,]   -0.5934929 12.323950  -25.37347286  23.7911714
 [80,]   29.4617953 14.230001    1.42130993  57.4255836
 [81,]   -9.1980772 13.409630  -36.43990770  16.2285653
 [82,]   23.3589502 11.450207    0.15370650  45.0375834
 [83,]    4.1205776  9.776744  -15.59479796  22.7148836
 [84,]   20.6501049  8.558657    4.00487155  37.1038033
 [85,]    1.5180323  8.006553  -13.96935016  17.4740371
 [86,]    4.9204596  8.255154  -11.19688527  21.6188211
 [87,]   -4.0453130  9.240058  -21.80589052  13.9850573
 [88,]  -13.9684857 10.760955  -35.02419573   7.0462424
 [89,]  -13.3072583 12.625611  -38.09956649  12.2303931
 [90,]  -11.5966309 14.703821  -40.87082357  18.7696400
 [91,]   26.4233900 13.206499    0.55503642  52.4319889
 [92,]    8.7322723 11.348212  -13.52894347  31.2639525
 [93,]  -32.5926454  9.766332  -51.94522283 -13.1725241
 [94,]    2.7880369  8.614500  -14.11478361  19.5687031
 [95,]    3.2679192  8.078801  -12.88021194  19.1262375
 [96,]   10.2437016  8.279703   -6.63732110  26.2156294
 [97,]    3.5349839  9.168914  -14.57769700  21.3452956
 [98,]   -3.1631338 10.574191  -23.85516559  17.3777713
 [99,]   16.8785485 12.320191   -7.09137235  41.1624112
[100,]    0.8006308 14.282497  -27.13439773  28.9487283
[101,]    9.6925795 13.044294  -14.80140905  35.6838914
[102,]   -7.6717879 11.233982  -29.05811036  14.7236558
[103,]  -10.6407554  9.711196  -29.15600949   8.8164487
[104,]   -6.2222228  8.629516  -23.52489314  10.6536334
[105,]  -22.0117902  8.166148  -38.12299223  -5.9835737
[106,]  -14.5255576  8.423753  -31.00862477   1.8055928
[107,]  -14.3130250  9.342884  -32.95215589   3.7976184
[108,]    0.6463076 10.755258  -20.42415903  21.8947076
[109,]   17.2470402 12.494715   -6.75610186  41.7866505
[110,]   21.0336727 14.443560   -6.61235071  49.3362099
[111,]   17.5443227 13.353184   -7.21486298  44.5147750
[112,]  -12.3344151 11.421236  -33.38706983  10.8107356
[113,]  -16.6203529  9.774072  -34.99797832   3.2195888
[114,]  -34.3340907  8.577358  -51.09153238 -16.9494823
[115,]  -37.9809285  8.034948  -53.95202137 -22.1713886
[116,]    5.7910337  8.276500  -10.46515601  21.7035432
[117,]   38.4745959  9.240738   20.60703474  56.0516715
[118,]    4.9122581 10.734653  -16.06313662  25.5251341
[119,]   19.4448203 12.570801   -5.31913864  43.8072402
[120,]   -3.0259176 14.620809  -31.73541360  25.6772442
[121,]   -5.3328938 12.054825  -28.90010521  17.7204915
[122,]   36.7453587 10.369840   16.33766116  56.8697479
[123,]   -0.8711889  8.973919  -18.47087356  16.5761550
[124,]    2.3711636  8.019459  -13.62340248  17.7744263
[125,]  -13.8433839  7.673009  -29.08087646   0.8267239
[126,]   11.5099685  8.013818   -4.54055380  27.3015986
[127,]  -12.8298790  8.963836  -31.11623922   4.4991192
[128,]  -41.4338265 10.356751  -62.73873482 -21.4254530
[129,]    6.0596259 12.039812  -18.72502692  29.3327744
[130,]   24.6304784 13.908081   -3.40396651  51.5966846
[131,]  -50.2760174 12.714993  -75.82479690 -25.5215248
[132,]   12.2235318 10.918351   -9.90978989  33.4408441
[133,]   26.8908810  9.382025    7.95096189  44.8337474
[134,]   32.8506302  8.252700   16.34115202  48.9502725
[135,]   20.7180795  7.711315    5.53163878  35.9576416
[136,]   10.7893287  7.879997   -4.98057227  26.7160535
[137,]   -1.6300221  8.717625  -18.74462751  15.4395875
[138,]   -9.6412729 10.058443  -29.55559927  10.1622389
[139,]   -8.4505236 11.731165  -31.53604836  14.7764626
[140,]   -9.5666744 13.613994  -36.72620890  17.3883311
[141,]   17.2066655 12.309989   -7.62933752  41.1186458
[142,]    2.3997577 10.618113  -18.86973567  22.8446062
[143,]  -20.1150501  9.212916  -38.41149498  -2.5946680
[144,]  -11.0211579  8.242349  -27.45934188   4.6404005
[145,]   14.8241343  7.868915   -0.98283503  30.2023255
[146,]    5.8951266  8.174859  -10.10081567  22.1143765
[147,]  -24.5033812  9.091855  -41.66828175  -6.4405196
[148,]   14.1639110 10.460418   -6.01050597  34.9431924
[149,]   -4.9992968 12.128638  -28.64636874  18.7709181
[150,]    9.9134955 13.989724  -17.75971006  37.6286958
[151,]   -1.0407533 13.477175  -26.68229237  25.8538119
[152,]   -6.9602126 11.529429  -28.98900822  15.7896546
[153,]  -17.7618720  9.852005  -37.13035793   1.5034973
[154,]  -31.3686313  8.604475  -48.66970173 -14.4278818
[155,]  -19.4832907  7.990791  -35.62386800  -4.2587264
[156,]   41.9941500  8.155319   25.91933856  57.5177851
[157,]  -36.2304093  9.055743  -53.82672324 -18.1108888
[158,]   15.0280313 10.504498   -5.54084891  36.0847880
[159,]   17.4265720 12.309476   -6.22983540  41.6825121
[160,]    9.3134126 14.336760  -18.24418212  37.6727326
[161,]   17.9128188 12.412907   -6.64355739  42.4114998
[162,]   10.9765946 10.687468   -9.79886898  32.0700052
[163,]    6.9340703  9.262127  -11.04935279  25.3269995
[164,]    1.3260461  8.293089  -14.71073526  17.5612819
[165,]  -10.7915781  7.949024  -26.22348060   5.0192475
[166,]  -14.9487023  8.307945  -31.09710026   1.4940801
[167,]  -49.6935265  9.288715  -67.46881103 -31.2888817
[168,]  -13.8273507 10.722025  -34.77035180   7.7427340
[169,]   22.8241251 12.452579   -1.80875114  47.3590460
[170,]   32.0140009 14.373411    4.01127104  60.1803726
[171,]    5.6358912 12.171222  -19.26328175  29.4876413
[172,]   -2.0252660 10.468117  -23.40088805  18.5020158
[173,]   10.3740768  9.050803   -7.95996380  28.1701558
[174,]   11.6854197  8.071266   -4.15582809  27.4434708
[175,]  -23.4970375  7.698465  -38.28520677  -8.7061536
[176,]    7.2145053  8.017490   -8.45752556  22.9907465
[177,]    0.3652481  8.954701  -16.92008620  18.0279355
[178,]   -2.6201091 10.343401  -22.65515714  17.5559647
[179,]   11.5782338 12.028214  -12.00703055  35.2189942
[180,]   -5.1633234 13.901895  -32.29283889  22.2374014</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.3
looic      1769.6 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1536      
 (0.5, 0.7]   (ok)         2    1.1%   206       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.3
p_loo        33.9  8.3
looic      1722.0 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   929       
 (0.5, 0.7]   (ok)         4    2.2%   371       
   (0.7, 1]   (bad)        1    0.6%   44        
   (1, Inf)   (very bad)   2    1.1%   15        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.8      11.6  
fit_sleep1 -92.3      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.3
looic      1769.6 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1536      
 (0.5, 0.7]   (ok)         2    1.1%   206       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.3
p_loo        33.9  8.3
looic      1722.0 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   929       
 (0.5, 0.7]   (ok)         4    2.2%   371       
   (0.7, 1]   (bad)        1    0.6%   44        
   (1, Inf)   (very bad)   2    1.1%   15        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.0     22.3        33.9    8.3   1722.0
fit_sleep2  -23.8      11.6  -884.8     14.4        19.3    3.3   1769.6
fit_sleep1  -92.3      21.0  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.7  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.243474e-41 4.724011e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.85      1.54     0.29     5.31       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.15      1.54    -3.27      2.8       5.92      0.86
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.3          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.3         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.3.1      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
