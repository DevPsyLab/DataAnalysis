<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.61      6.58    15.66    41.73 1.00     1708     2417
sd(Days)                6.59      1.50     4.20    10.07 1.00     1647     2266
cor(Intercept,Days)     0.09      0.30    -0.46     0.68 1.00      995     1597

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.14      7.34   236.49   265.35 1.00     1752     2207
Days         10.44      1.73     6.97    13.96 1.00     1282     1784

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.53    22.99    29.03 1.00     3617     2856

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.5164  13.17790 226.5364 278.3303
309 211.4491  13.13659 185.5145 236.8471
310 213.0148  13.40782 186.3333 237.5645
330 274.1125  13.49117 247.9667 300.4638
331 273.2835  13.05876 248.3989 299.5033
332 260.0189  12.23748 236.2101 284.0182
333 267.8250  12.59680 243.7836 293.7294
334 243.8072  12.30270 219.6382 267.5711
335 250.7422  13.40725 224.8544 276.9732
337 285.4835  13.15558 260.0491 311.0715
349 226.5297  13.17596 200.8432 251.1063
350 238.6929  13.38623 211.0664 263.7196
351 255.3286  12.36643 231.2239 280.4522
352 271.6672  12.44618 247.4997 295.8671
369 254.5643  12.14501 230.6216 278.7088
370 226.5233  13.49727 199.1817 252.8868
371 252.1655  11.96969 228.7789 275.9906
372 263.1659  12.44489 238.9856 288.3761

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.7004739  2.497605 14.88834898 24.826566
309  1.7661633  2.496476 -3.36275776  6.625081
310  4.8799906  2.497982  0.06857666  9.802122
330  5.8190934  2.527970  0.88379699 10.569249
331  7.4721685  2.469634  2.67976237 12.114655
332 10.2729466  2.319259  5.78563039 14.706543
333 10.2904634  2.425114  5.41775094 14.849066
334 11.6281184  2.310667  7.30246021 16.278971
335 -0.2658092  2.563921 -5.37909006  4.523455
337 19.2418857  2.471440 14.38039731 24.116402
349 11.6092996  2.492667  6.78679659 16.590860
350 17.0131891  2.522763 12.25459820 22.049530
351  7.5331493  2.387789  2.68382452 12.106181
352 14.1170702  2.371646  9.35715731 18.705402
369 11.3625770  2.324490  6.71778469 15.865463
370 15.1670670  2.537358 10.20791669 20.182030
371  9.4947962  2.305929  4.97942035 14.016299
372 11.8138761  2.384884  7.11314865 16.428550</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.5164 13.177896 226.5364 278.3303
  [2,] 273.2169 11.256350 250.2394 295.0555
  [3,] 292.9174  9.603644 273.7126 311.5686
  [4,] 312.6178  8.380370 295.6747 328.9005
  [5,] 332.3183  7.791488 317.2485 347.3354
  [6,] 352.0188  7.978724 336.3305 367.2712
  [7,] 371.7193  8.893191 354.2426 389.1459
  [8,] 391.4197 10.343777 371.1261 411.9201
  [9,] 411.1202 12.139797 387.3429 435.2088
 [10,] 430.8207 14.150324 403.6965 459.0511
 [11,] 211.4491 13.136594 185.5145 236.8471
 [12,] 213.2152 11.256695 191.0758 234.9988
 [13,] 214.9814  9.660282 196.0095 233.6836
 [14,] 216.7476  8.508449 200.1584 232.7829
 [15,] 218.5137  7.995695 202.8207 234.0248
 [16,] 220.2799  8.242169 204.0067 236.5780
 [17,] 222.0461  9.186966 204.3198 240.4835
 [18,] 223.8122 10.645757 203.2892 245.1875
 [19,] 225.5784 12.438999 201.1856 250.3722
 [20,] 227.3446 14.442647 199.1344 256.0900
 [21,] 213.0148 13.407819 186.3333 237.5645
 [22,] 217.8948 11.497936 194.4897 239.2740
 [23,] 222.7748  9.854709 203.0574 241.1790
 [24,] 227.6548  8.631795 210.4348 244.1165
 [25,] 232.5348  8.023734 216.7410 247.7663
 [26,] 237.4148  8.169000 221.4660 253.0668
 [27,] 242.2947  9.031314 224.7537 259.8540
 [28,] 247.1747 10.434392 226.5359 267.3196
 [29,] 252.0547 12.192960 227.3382 275.8757
 [30,] 256.9347 14.175325 228.4440 284.4629
 [31,] 274.1125 13.491168 247.9667 300.4638
 [32,] 279.9316 11.529323 257.4785 302.6396
 [33,] 285.7507  9.829559 266.5862 304.6816
 [34,] 291.5698  8.549645 274.7074 307.7647
 [35,] 297.3889  7.896447 281.7732 312.5278
 [36,] 303.2079  8.024500 287.2940 318.3799
 [37,] 309.0270  8.900145 291.5706 326.0995
 [38,] 314.8461 10.335077 294.2817 334.8936
 [39,] 320.6652 12.132449 296.3212 344.1765
 [40,] 326.4843 14.154861 298.2469 354.3164
 [41,] 273.2835 13.058762 248.3989 299.5033
 [42,] 280.7557 11.198971 259.1776 303.0457
 [43,] 288.2278  9.617733 269.5254 307.3166
 [44,] 295.7000  8.472475 278.9633 312.7193
 [45,] 303.1722  7.953808 287.4677 318.7305
 [46,] 310.6443  8.181776 294.3152 326.6520
 [47,] 318.1165  9.100442 300.2911 335.8986
 [48,] 325.5887 10.530566 304.8149 346.0524
 [49,] 333.0609 12.294949 309.0766 357.1591
 [50,] 340.5330 14.270140 312.7764 368.5166
 [51,] 260.0189 12.237481 236.2101 284.0182
 [52,] 270.2918 10.535394 249.9534 290.9729
 [53,] 280.5648  9.109941 262.9141 298.1204
 [54,] 290.8377  8.108358 275.1120 306.3818
 [55,] 301.1107  7.697910 285.7733 315.8416
 [56,] 311.3836  7.970451 295.7993 326.8521
 [57,] 321.6566  8.863199 304.1225 338.6978
 [58,] 331.9295 10.214814 311.8448 351.6734
 [59,] 342.2024 11.869561 318.9659 364.9081
 [60,] 352.4754 13.718179 325.7494 378.6178
 [61,] 267.8250 12.596798 243.7836 293.7294
 [62,] 278.1155 10.806602 257.1176 300.3958
 [63,] 288.4059  9.308509 270.0883 307.3845
 [64,] 298.6964  8.262953 282.3970 314.9516
 [65,] 308.9869  7.852822 293.7997 324.4990
 [66,] 319.2773  8.174324 303.5888 334.8233
 [67,] 329.5678  9.150667 311.7810 347.1425
 [68,] 339.8583 10.602461 318.7743 360.4133
 [69,] 350.1487 12.363334 325.8276 374.2256
 [70,] 360.4392 14.319714 332.0343 388.7145
 [71,] 243.8072 12.302696 219.6382 267.5711
 [72,] 255.4354 10.640031 234.4214 276.1555
 [73,] 267.0635  9.259726 248.6397 285.1752
 [74,] 278.6916  8.303805 262.3623 294.8934
 [75,] 290.3197  7.927306 274.8050 305.7049
 [76,] 301.9478  8.210331 286.0386 317.7856
 [77,] 313.5760  9.091493 295.8201 330.9819
 [78,] 325.2041 10.420141 304.9579 345.3840
 [79,] 336.8322 12.049140 313.2624 360.8325
 [80,] 348.4603 13.873088 321.4718 376.2984
 [81,] 250.7422 13.407247 224.8544 276.9732
 [82,] 250.4764 11.435661 228.1974 273.5710
 [83,] 250.2106  9.743808 230.8618 269.9083
 [84,] 249.9448  8.500390 233.3180 266.7678
 [85,] 249.6790  7.919522 233.9573 265.2228
 [86,] 249.4132  8.144226 233.6611 265.4132
 [87,] 249.1474  9.115119 231.2380 266.8016
 [88,] 248.8815 10.629663 228.1610 269.3099
 [89,] 248.6157 12.491655 224.4336 272.8612
 [90,] 248.3499 14.568478 219.9976 276.5371
 [91,] 285.4835 13.155579 260.0491 311.0715
 [92,] 304.7254 11.309634 282.6629 326.7778
 [93,] 323.9672  9.744866 305.1099 342.7504
 [94,] 343.2091  8.615860 326.5741 360.1072
 [95,] 362.4510  8.106769 346.9138 378.0635
 [96,] 381.6929  8.332010 365.7925 397.9823
 [97,] 400.9348  9.238026 382.9721 419.1341
 [98,] 420.1767 10.652506 399.7668 441.2227
 [99,] 439.4186 12.402689 415.0255 463.5737
[100,] 458.6604 14.366402 430.1445 486.5924
[101,] 226.5297 13.175957 200.8432 251.1063
[102,] 238.1390 11.298459 216.2590 259.7015
[103,] 249.7483  9.702130 230.8262 268.4972
[104,] 261.3576  8.546007 244.4597 277.7579
[105,] 272.9669  8.022713 257.2059 288.4148
[106,] 284.5762  8.253507 268.3025 300.9404
[107,] 296.1855  9.181701 278.1769 314.3417
[108,] 307.7948 10.626084 287.0220 328.6920
[109,] 319.4041 12.407678 295.1268 343.6652
[110,] 331.0134 14.401877 302.9253 359.3714
[111,] 238.6929 13.386226 211.0664 263.7196
[112,] 255.7061 11.438595 232.3571 277.2818
[113,] 272.7193  9.758101 252.9655 291.1594
[114,] 289.7325  8.504603 272.9018 305.9688
[115,] 306.7457  7.884458 291.3915 322.0564
[116,] 323.7589  8.045480 307.9827 339.6007
[117,] 340.7721  8.945584 322.7520 358.1096
[118,] 357.7852 10.394512 337.0031 377.9177
[119,] 374.7984 12.198236 350.6456 398.6588
[120,] 391.8116 14.222401 363.7180 419.4385
[121,] 255.3286 12.366425 231.2239 280.4522
[122,] 262.8618 10.612267 242.2325 284.3545
[123,] 270.3949  9.149591 252.7627 288.6510
[124,] 277.9281  8.137130 262.1640 293.9384
[125,] 285.4612  7.753311 270.4311 300.9680
[126,] 292.9944  8.088131 277.3329 309.1491
[127,] 300.5275  9.062282 282.3271 318.3920
[128,] 308.0607 10.499291 286.9207 328.6079
[129,] 315.5938 12.237171 291.0156 339.6386
[130,] 323.1270 14.165615 294.6635 350.7323
[131,] 271.6672 12.446179 247.4997 295.8671
[132,] 285.7843 10.713672 264.9119 306.6792
[133,] 299.9013  9.268633 282.0411 318.0662
[134,] 314.0184  8.263278 297.7206 330.0207
[135,] 328.1355  7.867996 312.6595 343.2608
[136,] 342.2525  8.171804 326.1461 358.1173
[137,] 356.3696  9.104987 338.3754 374.0404
[138,] 370.4867 10.501076 349.5902 390.9294
[139,] 384.6038 12.202206 360.4469 408.4044
[140,] 398.7208 14.098385 370.8048 425.9146
[141,] 254.5643 12.145009 230.6216 278.7088
[142,] 265.9269 10.427247 245.3772 286.6540
[143,] 277.2895  8.986668 259.5651 295.2906
[144,] 288.6521  7.974927 272.8452 304.4110
[145,] 300.0146  7.566057 285.1156 314.7364
[146,] 311.3772  7.854775 295.9618 326.3196
[147,] 322.7398  8.772472 305.6174 339.7754
[148,] 334.1024 10.149954 313.9615 353.7876
[149,] 345.4650 11.827653 321.5925 368.4280
[150,] 356.8275 13.695681 328.7743 383.0705
[151,] 226.5233 13.497267 199.1817 252.8868
[152,] 241.6904 11.568948 218.6273 264.0527
[153,] 256.8575  9.918733 237.4429 276.4020
[154,] 272.0245  8.706224 255.1378 289.3675
[155,] 287.1916  8.129685 271.2941 303.5146
[156,] 302.3587  8.322355 286.0874 318.9822
[157,] 317.5257  9.236220 299.9614 335.8438
[158,] 332.6928 10.687858 312.0055 353.6383
[159,] 347.8599 12.491165 323.4782 372.1627
[160,] 363.0269 14.515664 334.5823 391.1217
[161,] 252.1655 11.969689 228.7789 275.9906
[162,] 261.6603 10.330283 241.2346 282.0844
[163,] 271.1551  8.988363 253.4035 288.8117
[164,] 280.6499  8.093281 264.3325 296.5387
[165,] 290.1447  7.800407 274.5124 305.6204
[166,] 299.6395  8.174724 283.4311 315.7386
[167,] 309.1343  9.134576 291.0637 326.9377
[168,] 318.6291 10.520907 297.6468 339.1136
[169,] 328.1239 12.189056 304.2665 351.3386
[170,] 337.6187 14.038921 310.1740 364.6179
[171,] 263.1659 12.444894 238.9856 288.3761
[172,] 274.9798 10.711734 254.0555 296.2673
[173,] 286.7937  9.272673 268.7525 305.1807
[174,] 298.6075  8.282453 282.3250 315.2836
[175,] 310.4214  7.911442 294.7761 326.5015
[176,] 322.2353  8.243673 306.1856 338.2800
[177,] 334.0492  9.203299 316.4270 352.1334
[178,] 345.8630 10.621611 325.1481 366.5379
[179,] 357.6769 12.341470 333.6661 381.7843
[180,] 369.4908 14.254139 341.4261 397.3424</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -3.9564070 13.177896  -28.77034503  23.0236015
  [2,]  -14.5121808 11.256350  -36.35081740   8.4653433
  [3,]  -42.1167547  9.603644  -60.76800992 -22.9119858
  [4,]    8.8219714  8.380370   -7.46068856  25.7650844
  [5,]   24.5335975  7.791488    9.51654242  39.6034207
  [6,]   62.6713236  7.978724   47.41887529  78.3595643
  [7,]   10.4845498  8.893191   -6.94214118  27.9612020
  [8,] -101.2711241 10.343777 -121.77148176 -80.9775181
  [9,]   19.4651020 12.139797   -4.62347505  43.2423581
 [10,]   35.5328281 14.150324    7.30244952  62.6569838
 [11,]   11.2848193 13.136594  -14.11315134  37.2193578
 [12,]   -7.9494440 11.256695  -29.73303776  14.1900245
 [13,]  -12.0036073  9.660282  -30.70584216   6.9683498
 [14,]  -12.0405705  8.508449  -28.07592243   4.5485662
 [15,]  -10.7976338  7.995695  -26.30874201   4.8954496
 [16,]   -4.3180971  8.242169  -20.61616878  11.9550958
 [17,]   -8.4157603  9.186966  -26.85318238   9.3105496
 [18,]   -6.0850236 10.645757  -27.46025871  14.4380264
 [19,]   -1.2826869 12.438999  -26.07646731  23.1101200
 [20,]    9.9696499 14.442647  -18.77582620  38.1797730
 [21,]  -13.9609060 13.407819  -38.51064878  12.7206482
 [22,]  -23.5625966 11.497936  -44.94178968  -0.1574612
 [23,]   11.5452128  9.854709   -6.85904143  31.2625658
 [24,]    5.1868223  8.631795  -11.27489772  22.4067547
 [25,]   -3.2273683  8.023734  -18.45892967  12.5663528
 [26,]  -16.9568589  8.169000  -32.60885557  -1.0080763
 [27,]   -6.8739495  9.031314  -24.43322764  10.6670570
 [28,]    8.5763600 10.434392  -11.56845114  29.2152464
 [29,]    8.9577694 12.192960  -14.86321207  33.6743151
 [30,]   -9.4194212 14.175325  -36.94763706  19.0712778
 [31,]   47.4301228 13.491168   21.07884474  73.5759136
 [32,]   20.4686294 11.529323   -2.23941602  42.9217216
 [33,]   -1.8941639  9.829559  -20.82514667  17.2703105
 [34,]   -6.4367573  8.549645  -22.63166661  10.4256342
 [35,]  -11.5915506  7.896447  -26.73049489   4.0240706
 [36,]   -5.6224440  8.024500  -20.79440475  10.2914846
 [37,]  -28.7874373  8.900145  -45.85990951 -11.3309519
 [38,]    3.4151693 10.335077  -16.63231252  23.9795534
 [39,]  -15.3157241 12.132449  -38.82695079   9.0282569
 [40,]   27.5643826 14.154861   -0.26768619  55.8018405
 [41,]   14.3243942 13.058762  -11.89539965  39.2090234
 [42,]    4.2443257 11.198971  -18.04571194  25.8223995
 [43,]   13.5927572  9.617733   -5.49604567  32.2952430
 [44,]   24.4152887  8.472475    7.39600380  41.1519815
 [45,]   13.1051202  7.953808   -2.45318917  28.8095785
 [46,]  -17.3256483  8.181776  -33.33328409  -0.9965383
 [47,]  -28.0415168  9.100442  -45.82363350 -10.2160849
 [48,]    9.2290147 10.530566  -11.23469979  30.0028173
 [49,]  -39.3139538 12.294949  -63.41216004 -15.3297374
 [50,]   31.0480777 14.270140    3.06452952  58.8046872
 [51,]  -25.1582743 12.237481  -49.15764575  -1.3494667
 [52,]  -27.4800209 10.535394  -48.16113532  -7.1416122
 [53,]   -7.6034675  9.109941  -25.15913220  10.0471677
 [54,]   18.9310859  8.108358    3.38697253  34.6568465
 [55,]   16.3522392  7.697910    1.62130486  31.6895824
 [56,]   -1.3860074  7.970451  -16.85451877  14.1982765
 [57,]  132.5053460  8.863199  115.46407953 150.0393949
 [58,]   14.9015994 10.214814   -4.84232084  34.9862934
 [59,]  -11.9021472 11.869561  -34.60783893  11.3343994
 [60,]  -98.6109938 13.718179 -124.75342119 -71.8849629
 [61,]   16.0173882 12.596798   -9.88702154  40.0588013
 [62,]   11.4395248 10.806602  -10.84082925  32.4373996
 [63,]  -11.6366386  9.308509  -30.61515123   6.6809753
 [64,]    1.1132980  8.262953  -15.14194651  17.4127442
 [65,]  -11.8158653  7.852822  -27.32802344   3.3713202
 [66,]   18.8891713  8.174324    3.34321743  34.5776850
 [67,]    2.4587079  9.150667  -15.11604580  20.2455411
 [68,]    8.9816445 10.602461  -11.57344732  30.0655584
 [69,]  -16.7887189 12.363334  -40.86559521   7.5324443
 [70,]    1.6036178 14.319714  -26.67165897  30.0084892
 [71,]   21.6658561 12.302696   -2.09796669  45.8348769
 [72,]   20.7658377 10.640031    0.04571767  41.7797875
 [73,]  -23.6987807  9.259726  -41.81053425  -5.2749899
 [74,]  -24.0192991  8.303805  -40.22114066  -7.6899851
 [75,]  -11.2953176  7.927306  -26.68052385   4.2193762
 [76,]  -17.7566360  8.210331  -33.59444297  -1.8473671
 [77,]   -8.0511544  9.091493  -25.45705673   9.7047097
 [78,]    6.3188271 10.420141  -13.86105744  26.5649758
 [79,]   -1.0852913 12.049140  -25.08559836  22.4845100
 [80,]   28.8386903 13.873088    1.00061078  55.8271866
 [81,]   -9.1339083 13.407247  -35.36491847  16.7539069
 [82,]   23.4708009 11.435661    0.37623078  45.7498368
 [83,]    4.2801101  9.743808  -15.41759189  23.6288787
 [84,]   20.8573193  8.500390    4.03428182  37.4841108
 [85,]    1.7729285  7.919522  -13.77085808  17.4946087
 [86,]    5.2230377  8.144226  -10.77701238  20.9751273
 [87,]   -3.6950531  9.115119  -21.34925278  14.2142682
 [88,]  -13.5705439 10.629663  -33.99889902   7.1500183
 [89,]  -12.8616347 12.491655  -37.10711890  11.3205048
 [90,]  -11.1033255 14.568478  -39.29054618  17.2490426
 [91,]   26.8831295 13.155579    1.29513553  52.3175057
 [92,]    9.0804438 11.309634  -12.97200241  31.1429262
 [93,]  -32.3560419  9.744866  -51.13920528 -13.4987484
 [94,]    2.9130724  8.615860  -13.98500030  19.5480769
 [95,]    3.2813867  8.106769  -12.33107202  18.8185762
 [96,]   10.1456010  8.332010   -6.14375684  26.0460494
 [97,]    3.3253153  9.238026  -14.87404523  21.2880447
 [98,]   -3.4843703 10.652506  -24.53039997  16.9255445
 [99,]   16.4457440 12.402689   -7.70943980  40.8387767
[100,]    0.2562583 14.366402  -27.67574351  28.7721948
[101,]    9.5734581 13.175957  -15.00306644  35.2599778
[102,]   -7.8223415 11.298459  -29.38477346  14.0577466
[103,]  -10.8227411  9.702130  -29.57158444   8.0994277
[104,]   -6.4356407  8.546007  -22.83592129  10.4622687
[105,]  -22.2566403  8.022713  -37.70452527  -6.4956035
[106,]  -14.8018400  8.253507  -31.16600684   1.4718906
[107,]  -14.6207396  9.181701  -32.77686156   3.3879371
[108,]    0.3071608 10.626084  -20.59000472  21.0799712
[109,]   16.8764612 12.407678   -7.38458005  41.1537613
[110,]   20.6316616 14.401877   -7.72630110  48.7198239
[111,]   17.6038840 13.386226   -7.42280872  45.2304411
[112,]  -12.2518050 11.438595  -33.82749310  11.0971807
[113,]  -16.5146941  9.758101  -34.95484979   3.2391023
[114,]  -34.2053832  8.504603  -50.44172817 -17.3747277
[115,]  -37.8291722  7.884458  -53.13991459 -22.4750225
[116,]    5.9658387  8.045480   -9.87596696  21.7420136
[117,]   38.6724496  8.945584   21.33492170  56.6925183
[118,]    5.1331605 10.394512  -14.99928370  25.9153095
[119,]   19.6887715 12.198236   -4.17162722  43.8416105
[120,]   -2.7589176 14.222401  -30.38580177  25.3346926
[121,]   -4.8021369 12.366425  -29.92574721  19.3026360
[122,]   37.1958137 10.612267   15.70306674  57.8251181
[123,]   -0.5010356  9.149591  -18.75712720  17.1312210
[124,]    2.6610151  8.137130  -13.34929383  18.4251291
[125,]  -13.6338343  7.753311  -29.14056391   1.3963152
[126,]   11.6392164  8.088131   -4.51550540  27.3007132
[127,]  -12.7809330  9.062282  -30.64541135   5.4194754
[128,]  -41.4651823 10.499291  -62.01237726 -20.3251719
[129,]    5.9479683 12.237171  -18.09682996  30.5261947
[130,]   24.4385190 14.165615   -3.16680675  52.9019935
[131,]  -49.9900933 12.446179  -74.19004554 -25.8225889
[132,]   12.4096364 10.713672   -8.48533719  33.2819919
[133,]   26.9771662  9.268633    8.81227658  44.8373583
[134,]   32.8370960  8.263278   16.83477989  49.1348888
[135,]   20.6047257  7.867996    5.47938394  36.0806600
[136,]   10.5761555  8.171804   -5.28860603  26.6826277
[137,]   -1.9430148  9.104987  -19.61383789  16.0512373
[138,]  -10.0540850 10.501076  -30.49680436  10.8423589
[139,]   -8.9631552 12.202206  -32.76381264  15.1937410
[140,]  -10.1791255 14.098385  -37.37293569  17.7369125
[141,]   17.3591657 12.145009   -6.78525717  41.3018955
[142,]    2.5099887 10.427247  -18.21712124  23.0597279
[143,]  -20.0470883  8.986668  -38.04819023  -2.3226608
[144,]  -10.9954653  7.974927  -26.75441592   4.8114375
[145,]   14.8075577  7.566057    0.08579904  29.7065766
[146,]    5.8362806  7.854775   -9.10607563  21.2517037
[147,]  -24.6044964  8.772472  -41.64008115  -7.4820758
[148,]   14.0205266 10.149954   -5.66467327  34.1614061
[149,]   -5.1849504 11.827653  -28.14799224  18.6875211
[150,]    9.6855726 13.695681  -16.55740414  37.7388426
[151,]   -1.2593320 13.497267  -27.62279424  26.0823487
[152,]   -7.1668990 11.568948  -29.52919857  15.8961715
[153,]  -17.9566661  9.918733  -37.50124804   1.4579389
[154,]  -31.5515331  8.706224  -48.89446723 -14.6647963
[155,]  -19.6543001  8.129685  -35.97728711  -3.7567864
[156,]   41.8350329  8.322355   25.21152671  58.1062992
[157,]  -36.3776341  9.236220  -54.69572111 -18.8133138
[158,]   14.8926988 10.687858   -6.05284271  35.5799853
[159,]   17.3031318 12.491165   -6.99972348  41.6847586
[160,]    9.2018648 14.515664  -18.89288838  37.6464995
[161,]   17.7149130 11.969689   -6.11017171  41.1014648
[162,]   10.7825168 10.330283   -9.64159207  31.2082308
[163,]    6.7438206  8.988363  -10.91280695  24.4953662
[164,]    1.1396244  8.093281  -14.74918136  17.4569940
[165,]  -10.9741718  7.800407  -26.44985672   4.6581303
[166,]  -15.1274680  8.174724  -31.22661609   1.0809145
[167,]  -49.8684643  9.134576  -67.67186256 -31.7979308
[168,]  -13.9984605 10.520907  -34.48296104   6.9837560
[169,]   22.6568433 12.189056   -0.55785693  46.5142127
[170,]   31.8505471 14.038921    4.85130778  59.2951543
[171,]    6.2457891 12.444894  -18.96443601  30.4260560
[172,]   -1.5057870 10.711734  -22.79325796  19.4184956
[173,]   10.8031370  9.272673   -7.58387521  28.8443179
[174,]   12.0240609  8.282453   -4.65201905  28.3065577
[175,]  -23.2488151  7.911442  -39.32886414  -7.6034544
[176,]    7.3723088  8.243673   -8.67239843  23.4220001
[177,]    0.4326328  9.203299  -17.65157687  18.0547717
[178,]   -2.6431433 10.621611  -23.31800897  18.0717734
[179,]   11.4647806 12.341470  -12.64258263  35.4756372
[180,]   -5.3671954 14.254139  -33.21884706  22.6974728</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.6 14.4
p_loo        19.1  3.4
looic      1769.1 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   593       
 (0.5, 0.7]   (ok)         1    0.6%   125       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.2
p_loo        33.4  8.1
looic      1721.5 44.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     165   91.7%   1311      
 (0.5, 0.7]   (ok)        13    7.2%   72        
   (0.7, 1]   (bad)        1    0.6%   12        
   (1, Inf)   (very bad)   1    0.6%   22        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.8      11.4  
fit_sleep1 -92.5      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.6 14.4
p_loo        19.1  3.4
looic      1769.1 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   593       
 (0.5, 0.7]   (ok)         1    0.6%   125       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.2
p_loo        33.4  8.1
looic      1721.5 44.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     165   91.7%   1311      
 (0.5, 0.7]   (ok)        13    7.2%   72        
   (0.7, 1]   (bad)        1    0.6%   12        
   (1, Inf)   (very bad)   1    0.6%   22        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.8     22.2        33.4    8.1   1721.5
fit_sleep2  -23.8      11.4  -884.6     14.4        19.1    3.4   1769.1
fit_sleep1  -92.5      20.8  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.4  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.594180e-41 4.622692e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.89      1.57     0.28     5.38       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.11      1.57    -3.36     2.93       5.55      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.26 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_0.63.0   compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.21      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.4      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.3         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.0          
 [52] processx_3.8.1       pkgbuild_1.4.0       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.0        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.0         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.1-3       
 [85] grid_4.3.0           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.31       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
