<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.77      6.86    15.53    42.38 1.00     1931     2441
sd(Days)                6.60      1.54     4.18    10.13 1.00     1514     2144
cor(Intercept,Days)     0.09      0.31    -0.49     0.71 1.01      831     1322

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.23      7.39   236.44   265.50 1.00     1696     2440
Days         10.36      1.75     6.80    13.61 1.00     1196     1945

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.57    23.01    29.22 1.00     3510     2679

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9228  13.19415 228.0334 278.7468
309 211.5726  13.45815 185.0675 237.7035
310 213.1196  13.31640 185.3715 238.7686
330 273.9963  13.67522 248.4442 301.3298
331 272.8133  12.99168 248.0544 298.8505
332 260.2178  12.24058 236.1074 284.8738
333 267.7555  12.73054 243.4105 293.7759
334 244.5754  12.60553 218.8841 268.7383
335 250.7576  13.31982 224.5892 276.7378
337 285.6642  12.92345 261.2244 310.2952
349 226.8720  12.56367 201.9261 250.2346
350 239.0659  13.13255 212.1611 263.9309
351 255.5138  12.24757 231.8489 279.5832
352 271.7249  12.22701 248.0239 296.7370
369 254.4018  12.30773 230.8603 278.9986
370 226.6942  13.50297 199.2408 251.6570
371 251.9215  12.17922 228.5990 276.1640
372 263.3164  12.53098 239.2343 288.9970

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6492395  2.533558 14.9023456 24.621864
309  1.7511416  2.509800 -3.0949995  6.573591
310  4.8987484  2.490693  0.1512787  9.882469
330  5.8500859  2.599707  0.6773364 10.789319
331  7.5549720  2.481582  2.6151133 12.309691
332 10.2374107  2.364693  5.5506199 14.873517
333 10.3288510  2.428095  5.3963256 15.029199
334 11.4808235  2.394486  6.6741132 16.139553
335 -0.2178027  2.598293 -5.4061439  4.749637
337 19.2108131  2.471434 14.3364896 24.045903
349 11.5405610  2.375852  7.0049832 16.286819
350 16.9456909  2.482653 12.1922984 21.913180
351  7.4910497  2.400146  2.8475321 12.198530
352 14.1346924  2.361002  9.4155766 18.751366
369 11.3733471  2.317748  6.8149035 15.894044
370 15.1498696  2.533731 10.2700816 20.264421
371  9.4859759  2.338093  4.7719315 13.970771
372 11.7985742  2.370649  7.0047384 16.393827</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9228 13.194149 228.0334 278.7468
  [2,] 273.5720 11.255326 251.6508 294.7951
  [3,] 293.2213  9.597759 274.4422 311.6682
  [4,] 312.8705  8.389840 296.3986 329.1153
  [5,] 332.5197  7.842174 317.4036 347.8206
  [6,] 352.1690  8.089983 336.3962 367.9266
  [7,] 371.8182  9.068284 354.0508 389.8743
  [8,] 391.4675 10.576274 370.7298 412.1954
  [9,] 411.1167 12.422528 386.7437 435.1710
 [10,] 430.7659 14.478213 402.6996 458.5906
 [11,] 211.5726 13.458152 185.0675 237.7035
 [12,] 213.3237 11.551135 190.6309 235.5434
 [13,] 215.0748  9.916338 195.5737 234.0443
 [14,] 216.8260  8.708445 200.0842 233.5131
 [15,] 218.5771  8.120249 202.3531 234.3705
 [16,] 220.3283  8.284809 203.6655 236.5024
 [17,] 222.0794  9.161653 203.8205 240.0264
 [18,] 223.8306 10.575060 203.3392 244.5771
 [19,] 225.5817 12.342045 201.9243 249.5243
 [20,] 227.3328 14.332427 199.5602 254.8326
 [21,] 213.1196 13.316402 185.3715 238.7686
 [22,] 218.0183 11.412407 194.6117 240.0470
 [23,] 222.9171  9.775817 203.1893 241.6211
 [24,] 227.8158  8.561383 211.2241 244.2194
 [25,] 232.7146  7.964614 217.4888 248.5775
 [26,] 237.6133  8.122805 222.0247 253.7513
 [27,] 242.5121  8.996220 225.6917 260.9736
 [28,] 247.4108 10.406300 227.8915 268.4128
 [29,] 252.3096 12.167880 229.4550 276.6053
 [30,] 257.2083 14.150287 230.4950 285.4180
 [31,] 273.9963 13.675221 248.4442 301.3298
 [32,] 279.8464 11.678367 257.8167 302.8573
 [33,] 285.6965  9.963623 266.3658 304.8866
 [34,] 291.5465  8.699441 274.4031 308.7396
 [35,] 297.3966  8.099612 281.1381 312.9343
 [36,] 303.2467  8.309278 287.0391 319.0747
 [37,] 309.0968  9.273696 291.1257 327.4078
 [38,] 314.9469 10.792392 293.8230 336.7032
 [39,] 320.7970 12.667556 296.0906 345.6966
 [40,] 326.6471 14.763982 298.2791 355.3374
 [41,] 272.8133 12.991681 248.0544 298.8505
 [42,] 280.3682 11.148653 258.8400 302.7726
 [43,] 287.9232  9.597794 269.5167 307.3144
 [44,] 295.4782  8.500548 279.3406 312.0416
 [45,] 303.0332  8.044719 287.5633 318.9691
 [46,] 310.5881  8.336197 294.5278 327.3705
 [47,] 318.1431  9.305017 299.8197 336.7510
 [48,] 325.6981 10.769912 304.3133 347.1600
 [49,] 333.2530 12.558470 308.3449 358.2668
 [50,] 340.8080 14.551832 312.1236 369.4824
 [51,] 260.2178 12.240584 236.1074 284.8738
 [52,] 270.4552 10.515513 249.7261 291.7475
 [53,] 280.6926  9.083154 262.9832 298.9175
 [54,] 290.9300  8.100301 274.8933 306.8131
 [55,] 301.1674  7.740130 286.1997 316.3701
 [56,] 311.4048  8.086278 296.0091 327.2310
 [57,] 321.6422  9.058130 304.2311 339.7342
 [58,] 331.8796 10.483086 311.6627 353.0849
 [59,] 342.1170 12.203442 318.5212 366.7116
 [60,] 352.3545 14.111571 325.1177 380.8248
 [61,] 267.7555 12.730536 243.4105 293.7759
 [62,] 278.0843 10.936647 257.0453 300.6820
 [63,] 288.4132  9.431078 270.3616 307.6316
 [64,] 298.7420  8.370873 282.8430 315.1124
 [65,] 309.0709  7.936566 293.5764 324.7508
 [66,] 319.3997  8.227877 303.3628 335.8869
 [67,] 329.7286  9.175953 312.3294 347.8919
 [68,] 340.0574 10.606111 319.7166 361.0913
 [69,] 350.3863 12.352017 326.5204 374.3859
 [70,] 360.7151 14.298475 333.0640 389.0886
 [71,] 244.5754 12.605528 218.8841 268.7383
 [72,] 256.0562 10.836961 234.4791 277.0363
 [73,] 267.5370  9.351322 249.0062 285.7751
 [74,] 279.0178  8.301919 262.7598 294.8081
 [75,] 290.4986  7.865342 274.8695 305.5470
 [76,] 301.9795  8.140791 285.7561 317.6226
 [77,] 313.4603  9.063580 295.3434 331.1533
 [78,] 324.9411 10.463823 304.2226 345.9325
 [79,] 336.4219 12.177925 312.5328 360.4849
 [80,] 347.9028 14.091814 320.5670 375.6461
 [81,] 250.7576 13.319817 224.5892 276.7378
 [82,] 250.5398 11.309137 228.5229 272.4244
 [83,] 250.3220  9.585296 231.9397 269.4801
 [84,] 250.1042  8.328354 233.7790 266.7535
 [85,] 249.8864  7.768354 234.6178 265.0448
 [86,] 249.6686  8.052044 233.4278 265.3344
 [87,] 249.4508  9.100866 231.3870 267.0929
 [88,] 249.2330 10.691976 228.1749 269.6037
 [89,] 249.0152 12.621934 223.9974 273.4885
 [90,] 248.7974 14.758399 218.9710 277.7773
 [91,] 285.6642 12.923451 261.2244 310.2952
 [92,] 304.8750 11.071109 283.5737 326.4193
 [93,] 324.0858  9.504698 305.7808 342.8297
 [94,] 343.2967  8.386006 326.9478 359.8012
 [95,] 362.5075  7.907394 347.0359 378.0193
 [96,] 381.7183  8.181971 365.4890 397.6891
 [97,] 400.9291  9.142122 382.3876 418.2970
 [98,] 420.1399 10.603212 398.5530 440.1536
 [99,] 439.3507 12.389261 413.9721 462.8705
[100,] 458.5615 14.379689 429.2728 485.8619
[101,] 226.8720 12.563667 201.9261 250.2346
[102,] 238.4125 10.785811 216.9000 258.8404
[103,] 249.9531  9.279605 231.9266 267.8755
[104,] 261.4937  8.196203 245.7708 277.6096
[105,] 273.0342  7.715814 257.9227 288.5242
[106,] 284.5748  7.948532 269.4321 300.2654
[107,] 296.1153  8.838206 279.0408 313.1273
[108,] 307.6559 10.214596 287.7997 328.0386
[109,] 319.1965 11.910138 295.5671 343.4231
[110,] 330.7370 13.807757 303.3705 358.8380
[111,] 239.0659 13.132549 212.1611 263.9309
[112,] 256.0116 11.251442 232.9949 277.4308
[113,] 272.9573  9.646408 253.3453 291.7412
[114,] 289.9030  8.475762 273.0526 306.7529
[115,] 306.8487  7.934169 291.6404 322.4697
[116,] 323.7944  8.148046 307.7911 339.7729
[117,] 340.7401  9.064072 322.8000 358.5506
[118,] 357.6857 10.500061 336.8640 378.4307
[119,] 374.6314 12.274865 350.4037 398.7936
[120,] 391.5771 14.262554 363.6126 419.5287
[121,] 255.5138 12.247572 231.8489 279.5832
[122,] 263.0048 10.494292 242.8452 283.6362
[123,] 270.4959  9.043157 252.6433 288.1406
[124,] 277.9869  8.059072 261.9535 293.7694
[125,] 285.4780  7.722692 270.3905 300.7893
[126,] 292.9690  8.114969 277.0237 308.9434
[127,] 300.4601  9.142586 282.3467 318.2166
[128,] 307.9511 10.622732 287.4370 328.7593
[129,] 315.4422 12.394329 290.9380 339.9192
[130,] 322.9332 14.349834 295.2166 351.2730
[131,] 271.7249 12.227008 248.0239 296.7370
[132,] 285.8596 10.533079 265.3758 307.0276
[133,] 299.9943  9.140046 282.3411 318.2823
[134,] 314.1290  8.202669 298.2558 330.6279
[135,] 328.2637  7.885162 312.8412 344.0221
[136,] 342.3984  8.259324 326.0917 358.6933
[137,] 356.5331  9.241524 338.3495 374.7290
[138,] 370.6678 10.665071 349.5856 391.5556
[139,] 384.8025 12.378626 360.4445 409.1762
[140,] 398.9372 14.278154 370.8844 427.0517
[141,] 254.4018 12.307734 230.8603 278.9986
[142,] 265.7751 10.624480 245.1730 287.0691
[143,] 277.1484  9.220778 259.2010 295.5458
[144,] 288.5218  8.240742 272.4928 304.6646
[145,] 299.8951  7.844796 284.2060 315.4258
[146,] 311.2685  8.118851 295.2123 327.6756
[147,] 322.6418  9.001920 304.7537 340.6752
[148,] 334.0152 10.339114 313.9115 354.6500
[149,] 345.3885 11.979313 321.8042 369.3623
[150,] 356.7619 13.815010 329.8394 383.8328
[151,] 226.6942 13.502973 199.2408 251.6570
[152,] 241.8441 11.542230 218.5715 263.2278
[153,] 256.9939  9.846595 237.3791 275.2579
[154,] 272.1438  8.574810 254.8575 288.1920
[155,] 287.2937  7.933405 271.3540 302.8781
[156,] 302.4435  8.074035 286.5276 318.2075
[157,] 317.5934  8.959953 300.1875 335.1292
[158,] 332.7433 10.402454 312.8601 352.9264
[159,] 347.8931 12.205775 324.6639 371.5597
[160,] 363.0430 14.233426 335.6133 390.4989
[161,] 251.9215 12.179216 228.5990 276.1640
[162,] 261.4075 10.465987 241.5644 282.1148
[163,] 270.8935  9.037358 253.5324 289.1057
[164,] 280.3794  8.046375 265.2388 296.7471
[165,] 289.8654  7.664713 275.0297 305.3907
[166,] 299.3514  7.980280 283.4901 315.2854
[167,] 308.8374  8.919376 291.8565 326.4688
[168,] 318.3233 10.313051 298.3638 338.3258
[169,] 327.8093 12.004006 304.4916 351.0566
[170,] 337.2953 13.884043 309.9957 364.0455
[171,] 263.3164 12.530979 239.2343 288.9970
[172,] 275.1149 10.791168 254.5265 297.1472
[173,] 286.9135  9.333441 269.0547 305.8743
[174,] 298.7121  8.307641 282.7529 315.3465
[175,] 310.5106  7.884201 295.7335 325.9499
[176,] 322.3092  8.157470 306.3226 338.1305
[177,] 334.1078  9.064655 316.4221 351.5253
[178,] 345.9064 10.441818 325.4888 366.0112
[179,] 357.7049 12.129926 334.1090 380.9607
[180,] 369.5035 14.017083 342.4425 396.4248</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.3627872 13.194149  -29.1868011  21.5266303
  [2,]  -14.8673267 11.255326  -36.0904379   7.0538801
  [3,]  -42.4206662  9.597759  -60.8676451 -23.6415506
  [4,]    8.5692943  8.389840   -7.6754874  25.0412065
  [5,]   24.3321549  7.842174    9.0312642  39.4482890
  [6,]   62.5211154  8.089983   46.7634528  78.2939307
  [7,]   10.3855759  9.068284   -7.6704501  28.1530089
  [8,] -101.3188636 10.576274 -122.0468236 -80.5812182
  [9,]   19.4685969 12.422528   -4.5857390  43.8415879
 [10,]   35.5875574 14.478213    7.7628904  63.6538679
 [11,]   11.1613394 13.458152  -14.9695614  37.6663654
 [12,]   -8.0579023 11.551135  -30.2775913  14.6348565
 [13,]  -12.0970439  9.916338  -31.0665496   7.4041390
 [14,]  -12.1189855  8.708445  -28.8060960   4.6228305
 [15,]  -10.8610272  8.120249  -26.6543685   5.3630113
 [16,]   -4.3664688  8.284809  -20.5406174  12.2962539
 [17,]   -8.4491104  9.161653  -26.3961383   9.8098355
 [18,]   -6.1033521 10.575060  -26.8498535  14.3880387
 [19,]   -1.2859937 12.342045  -25.2286049  22.3713646
 [20,]    9.9813647 14.332427  -17.5183607  37.7540310
 [21,]  -14.0656909 13.316402  -39.7147116  13.6824478
 [22,]  -23.6861393 11.412407  -45.7147514  -0.2794625
 [23,]   11.4029123  9.775817   -7.3011377  31.1307235
 [24,]    5.0257639  8.561383  -11.3778157  21.6174987
 [25,]   -3.4071845  7.964614  -19.2700830  11.8186259
 [26,]  -17.1554329  8.122805  -33.2934107  -1.5667650
 [27,]   -7.0912813  8.996220  -25.5527698   9.7290708
 [28,]    8.3402703 10.406300  -12.6617299  27.8596399
 [29,]    8.7029219 12.167880  -15.5927689  31.5574734
 [30,]   -9.6930265 14.150287  -37.9026557  17.0202575
 [31,]   47.5463079 13.675221   20.2128298  73.0984186
 [32,]   20.5538219 11.678367   -2.4571260  42.5835468
 [33,]   -1.8399640  9.963623  -21.0300825  17.4907492
 [34,]   -6.4135500  8.699441  -23.6066023  10.7299224
 [35,]  -11.5993359  8.099612  -27.1370243   4.6592214
 [36,]   -5.6612219  8.309278  -21.4892333  10.5464317
 [37,]  -28.8572078  9.273696  -47.1682267 -10.8861161
 [38,]    3.3144063 10.792392  -18.4418797  24.4383434
 [39,]  -15.4474797 12.667556  -40.3471274   9.2588615
 [40,]   27.4016344 14.763982   -1.2886916  55.7695956
 [41,]   14.7946355 12.991681  -11.2425547  39.5535011
 [42,]    4.6317635 11.148653  -17.7725845  26.1599600
 [43,]   13.8973915  9.597794   -5.4938120  32.3038962
 [44,]   24.6371195  8.500548    8.0737421  40.7747342
 [45,]   13.2441476  8.044719   -2.6917554  28.7140354
 [46,]  -17.2694244  8.336197  -34.0518167  -1.2090564
 [47,]  -28.0680964  9.305017  -46.6760051  -9.7446527
 [48,]    9.1196316 10.769912  -12.3422904  30.5044440
 [49,]  -39.5061403 12.558470  -64.5198769 -14.5979601
 [50,]   30.7730877 14.551832    2.0986985  59.4574937
 [51,]  -25.3571545 12.240584  -50.0131645  -1.2468049
 [52,]  -27.6433651 10.515513  -48.9356604  -6.9143337
 [53,]   -7.7312758  9.083154  -25.9562316   9.9780522
 [54,]   18.8388135  8.100301    2.9557428  34.8755183
 [55,]   16.2955029  7.740130    1.0928213  31.2631994
 [56,]   -1.4072078  8.086278  -17.2333670  13.9884769
 [57,]  132.5196815  9.058130  114.4276583 149.9308140
 [58,]   14.9514709 10.483086   -6.2537788  35.1683932
 [59,]  -11.8167398 12.203442  -36.4113358  11.7790934
 [60,]  -98.4900505 14.111571 -126.9604255 -71.2533444
 [61,]   16.0869096 12.730536   -9.9335332  40.4319491
 [62,]   11.4706586 10.936647  -11.1270199  32.5097076
 [63,]  -11.6438924  9.431078  -30.8623037   6.4077351
 [64,]    1.0676566  8.370873  -15.3026644  16.9666736
 [65,]  -11.8998944  7.936566  -27.5797869   3.5945559
 [66,]   18.7667546  8.227877    2.2796306  34.8037431
 [67,]    2.2979035  9.175953  -15.8653826  19.6971166
 [68,]    8.7824525 10.606111  -12.2514087  29.1232658
 [69,]  -17.0262985 12.352017  -41.0258845   6.8396307
 [70,]    1.3276505 14.298475  -27.0457819  28.9787595
 [71,]   20.8977469 12.605528   -3.2652003  46.5890025
 [72,]   20.1450234 10.836961   -0.8350977  41.7221029
 [73,]  -24.1723001  9.351322  -42.4103641  -5.6414775
 [74,]  -24.3455235  8.301919  -40.1357576  -8.0874649
 [75,]  -11.4742470  7.865342  -26.5225505   4.1548916
 [76,]  -17.7882705  8.140791  -33.4314198  -1.5649240
 [77,]   -7.9354940  9.063580  -25.6284974  10.1814439
 [78,]    6.5817826 10.463823  -14.4096251  27.3003224
 [79,]   -0.6750409 12.177925  -24.7380406  23.2141194
 [80,]   29.3962356 14.091814    1.6528600  56.7319790
 [81,]   -9.1492797 13.319817  -35.1294738  17.0191392
 [82,]   23.4074230 11.309137    1.5228462  45.4243232
 [83,]    4.1687256  9.585296  -14.9894336  22.5509513
 [84,]   20.6979283  8.328354    4.0486114  37.0231321
 [85,]    1.5655310  7.768354  -13.5929480  16.8340984
 [86,]    4.9676337  8.052044  -10.6982387  21.2083912
 [87,]   -3.9984636  9.100866  -21.6405960  14.0652555
 [88,]  -13.9219609 10.691976  -34.2927028   7.1360689
 [89,]  -13.2610583 12.621934  -37.7344116  11.7567429
 [90,]  -11.5507556 14.758399  -40.5306601  18.2756228
 [91,]   26.7023863 12.923451    2.0714004  51.1421928
 [92,]    8.9307732 11.071109  -12.6134873  30.2320642
 [93,]  -32.4746399  9.504698  -51.2185091 -14.1696200
 [94,]    2.8255469  8.386006  -13.6790441  19.1743685
 [95,]    3.2249338  7.907394  -12.2869115  18.6964938
 [96,]   10.1202207  8.181971   -5.8506446  26.3495077
 [97,]    3.3310075  9.142122  -14.0368513  21.8725326
 [98,]   -3.4476056 10.603212  -23.4613101  18.1393086
 [99,]   16.5135812 12.389261   -7.0061669  41.8921630
[100,]    0.3551681 14.379689  -26.9452185  29.6439013
[101,]    9.2312271 12.563667  -14.1314311  34.1770657
[102,]   -8.0958338 10.785811  -28.5237207  13.4167055
[103,]  -11.0274948  9.279605  -28.9498577   6.9989984
[104,]   -6.5716558  8.196203  -22.6875549   9.1512489
[105,]  -22.3239167  7.715814  -37.8139408  -7.2123939
[106,]  -14.8003777  7.948532  -30.4909669   0.3423468
[107,]  -14.5505386  8.838206  -31.5625199   2.5239828
[108,]    0.4461004 10.214596  -19.9366337  20.3022829
[109,]   17.0841395 11.910138   -7.1424932  40.7134616
[110,]   20.9080785 13.807757   -7.1928925  48.2745782
[111,]   17.2308898 13.132549   -7.6340763  44.1356632
[112,]  -12.5573011 11.251442  -33.9764619  10.4593888
[113,]  -16.7526919  9.646408  -35.5366402   2.8593034
[114,]  -34.3758828  8.475762  -51.2257719 -17.5254695
[115,]  -37.9321737  7.934169  -53.5531653 -22.7239069
[116,]    5.9303354  8.148046  -10.0482135  21.9336014
[117,]   38.7044446  9.064072   20.8938774  56.6445063
[118,]    5.2326537 10.500061  -15.5122591  26.0544080
[119,]   19.8557628 12.274865   -4.3063509  44.0835433
[120,]   -2.5244281 14.262554  -30.4759663  25.4400906
[121,]   -4.9873001 12.247572  -29.0566535  18.6775842
[122,]   37.0527503 10.494292   16.4214299  57.2123616
[123,]   -0.6019994  9.043157  -18.2466776  17.2506247
[124,]    2.6021510  8.059072  -13.1803126  18.6355590
[125,]  -13.6505987  7.722692  -28.9618568   1.4369408
[126,]   11.6645517  8.114969   -4.3098155  27.6098619
[127,]  -12.7134980  9.142586  -30.4700384   5.3998669
[128,]  -41.3556476 10.622732  -62.1637767 -20.8414868
[129,]    6.0996027 12.394329  -18.3774222  30.6037544
[130,]   24.6322531 14.349834   -3.7075280  52.3488848
[131,]  -50.0478420 12.227008  -75.0598852 -26.3467687
[132,]   12.3342656 10.533079   -8.8337058  32.8181041
[133,]   26.8841733  9.140046    8.5962272  44.5373543
[134,]   32.7264809  8.202669   16.2275919  48.5997233
[135,]   20.4764885  7.885162    4.7181291  35.8989629
[136,]   10.4302962  8.259324   -5.8646484  26.7370023
[137,]   -2.1064962  9.241524  -20.3023850  16.0771479
[138,]  -10.2351886 10.665071  -31.1230212  10.8470442
[139,]   -9.1618809 12.378626  -33.5355743  15.1961212
[140,]  -10.3954733 14.278154  -38.5100092  17.6573495
[141,]   17.5217461 12.307734   -7.0751435  41.0631691
[142,]    2.6617989 10.624480  -18.6322241  23.2639074
[143,]  -19.9060482  9.220778  -38.3033596  -1.9586023
[144,]  -10.8651953  8.240742  -27.0079647   5.1637589
[145,]   14.9270575  7.844796   -0.6035931  30.6161647
[146,]    5.9450104  8.118851  -10.4620991  22.0011526
[147,]  -24.5065368  9.001920  -42.5398619  -6.6184323
[148,]   14.1077161 10.339114   -6.5271177  34.2114384
[149,]   -5.1085310 11.979313  -29.0822868  18.4758287
[150,]    9.7512218 13.815010  -17.3197298  36.6737123
[151,]   -1.4301904 13.502973  -26.3929911  26.0231936
[152,]   -7.3205600 11.542230  -28.7043042  15.9520229
[153,]  -18.0931296  9.846595  -36.3570908   1.5216930
[154,]  -31.6707992  8.574810  -47.7189654 -14.3844525
[155,]  -19.7563688  7.933405  -35.3407727  -3.8167318
[156,]   41.7501616  8.074035   25.9862452  57.6661303
[157,]  -36.4453080  8.959953  -53.9810862 -19.0394476
[158,]   14.8422224 10.402454   -5.3409230  34.7254210
[159,]   17.2698528 12.205775   -6.3966606  40.4990565
[160,]    9.1857832 14.233426  -18.2700671  36.6155409
[161,]   17.9588837 12.179216   -6.2836034  41.2813847
[162,]   11.0353078 10.465987   -9.6720291  30.8784266
[163,]    7.0054319  9.037358  -11.2068152  24.3665450
[164,]    1.4100559  8.046375  -14.9575629  16.5507476
[165,]  -10.6949200  7.664713  -26.2202087   4.1408377
[166,]  -14.8393959  7.980280  -30.7734061   1.0218531
[167,]  -49.5715718  8.919376  -67.2030456 -32.5907107
[168,]  -13.6927478 10.313051  -33.6952253   6.2667521
[169,]   22.9713763 12.004006   -0.2759074  46.2891416
[170,]   32.1739004 13.884043    5.4237473  59.4735417
[171,]    6.0953483 12.530979  -19.5852884  30.1774170
[172,]   -1.6409259 10.791168  -23.6732318  18.9474826
[173,]   10.6832999  9.333441   -8.2775316  28.5420769
[174,]   11.9195257  8.307641   -4.7148616  27.8786633
[175,]  -23.3380485  7.884201  -38.7773109  -8.5609046
[176,]    7.2983772  8.157470   -8.5229013  23.2850085
[177,]    0.3740030  9.064655  -17.0434813  18.0597311
[178,]   -2.6864712 10.441818  -22.7913283  17.7310614
[179,]   11.4367546 12.129926  -11.8190380  35.0326695
[180,]   -5.3799196 14.017083  -32.3011663  21.6811286</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.3
looic      1769.6 28.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   515       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   147       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.7
p_loo        34.5  8.8
looic      1723.3 45.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1045      
 (0.5, 0.7]   (ok)         6    3.3%   493       
   (0.7, 1]   (bad)        1    0.6%   37        
   (1, Inf)   (very bad)   2    1.1%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.2      11.9  
fit_sleep1 -91.7      21.3  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.3
looic      1769.6 28.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   515       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   147       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.7
p_loo        34.5  8.8
looic      1723.3 45.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1045      
 (0.5, 0.7]   (ok)         6    3.3%   493       
   (0.7, 1]   (bad)        1    0.6%   37        
   (1, Inf)   (very bad)   2    1.1%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.6     22.7        34.5    8.8   1723.3
fit_sleep2  -23.2      11.9  -884.8     14.4        19.3    3.3   1769.6
fit_sleep1  -91.7      21.3  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   45.4  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.474384e-40 8.725159e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.52     0.41     5.41       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.52     -3.1     2.92       5.81      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.3 (2023-03-15)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.21      
[4] StanHeaders_2.26.21 lme4_1.1-32         Matrix_1.5-3       

loaded via a namespace (and not attached):
  [1] nlme_3.1-162         matrixStats_0.63.0   xts_0.13.0          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.3         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.3       cli_3.6.1           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.4.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.5      highr_0.10          
 [40] fastmap_1.1.1        htmlwidgets_1.6.2    rlang_1.1.0         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.1         
 [52] distributional_0.3.2 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.2       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.3          
 [67] parallel_4.2.3       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.3       
 [73] knitr_1.42           ps_1.7.3             pillar_1.9.0        
 [76] igraph_1.4.1         boot_1.3-28.1        markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-19    
 [82] stats4_4.2.3         rstantools_2.3.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.7  
 [88] vctrs_0.6.1          nloptr_2.0.3         httpuv_1.6.9        
 [91] gtable_0.3.3         cachem_1.0.7         ggplot2_3.4.1       
 [94] xfun_0.38            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.2.1        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
