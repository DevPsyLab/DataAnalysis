<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.10      6.91    15.49    42.47 1.00     1962     2764
sd(Days)                6.68      1.58     4.22    10.42 1.00     1357      836
cor(Intercept,Days)     0.08      0.30    -0.48     0.68 1.00      931     1533

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.41      7.32   236.69   265.90 1.00     1895     2136
Days         10.47      1.66     7.27    13.85 1.00     1290     2147

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.49    23.12    28.94 1.00     3470     3024

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9219  12.78631 228.2260 278.3557
309 211.5240  13.44929 184.6237 236.9774
310 212.7944  13.10934 186.7956 238.3803
330 274.8153  13.64566 248.9350 302.2741
331 273.0867  13.06700 248.6245 299.1405
332 260.3514  12.32335 235.9567 284.9663
333 267.9897  12.72564 243.3790 293.5194
334 244.5069  12.44413 219.8442 269.5900
335 250.6879  13.48565 224.2989 277.5236
337 285.9364  13.15053 260.3152 311.4183
349 226.3762  13.05948 199.4860 250.6473
350 238.2086  13.15633 211.9202 262.2243
351 255.7969  12.26186 231.7593 279.9791
352 271.8141  12.58007 247.3030 296.9106
369 254.4188  12.26772 229.8290 278.9276
370 226.0076  13.55452 198.5488 252.1007
371 252.0536  12.56033 227.7522 276.4582
372 263.4805  12.23228 238.7427 287.4175

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6350264  2.495609 14.8457720 24.522559
309  1.7374578  2.533581 -3.2251311  6.679108
310  4.9200195  2.470150  0.2366030  9.809781
330  5.6587902  2.608457  0.4187142 10.622489
331  7.4910284  2.446566  2.6996046 12.136149
332 10.2180769  2.353324  5.5505106 14.878544
333 10.2938207  2.381580  5.7240114 14.917294
334 11.5247550  2.362854  6.8065376 16.072750
335 -0.2298106  2.608813 -5.4691187  4.936994
337 19.1531893  2.457464 14.3317662 24.000595
349 11.5953584  2.464902  6.9109572 16.816246
350 17.1162513  2.489067 12.3878010 22.033956
351  7.4929002  2.355661  2.8611122 12.091959
352 14.1017286  2.392132  9.4356623 18.789764
369 11.3959387  2.366348  6.8272832 16.091395
370 15.2278597  2.570591 10.3250757 20.329375
371  9.5245424  2.371809  4.8908047 14.191614
372 11.7719669  2.321480  7.2663594 16.329429</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9219 12.786314 228.2260 278.3557
  [2,] 273.5570 10.932703 252.0739 294.9241
  [3,] 293.1920  9.381593 275.1360 311.6021
  [4,] 312.8270  8.304258 297.0886 329.2177
  [5,] 332.4620  7.897040 317.5250 348.4179
  [6,] 352.0971  8.259656 336.2031 368.2692
  [7,] 371.7321  9.302512 353.8685 389.9950
  [8,] 391.3671 10.830866 370.3703 412.9422
  [9,] 411.0021 12.670229 386.2992 435.6388
 [10,] 430.6372 14.704349 402.1191 459.3358
 [11,] 211.5240 13.449291 184.6237 236.9774
 [12,] 213.2614 11.501445 190.1687 235.1903
 [13,] 214.9989  9.824515 195.5130 233.3396
 [14,] 216.7363  8.578870 199.8336 233.2891
 [15,] 218.4738  7.969378 202.9737 233.8329
 [16,] 220.2112  8.140211 204.0508 236.6367
 [17,] 221.9487  9.047272 204.3547 239.8970
 [18,] 223.6862 10.501490 203.4429 243.8029
 [19,] 225.4236 12.310464 201.6436 249.1167
 [20,] 227.1611 14.340565 198.9025 255.0607
 [21,] 212.7944 13.109339 186.7956 238.3803
 [22,] 217.7144 11.245607 195.0303 239.5602
 [23,] 222.6345  9.657942 203.2334 241.5861
 [24,] 227.5545  8.502429 210.6599 244.1234
 [25,] 232.4745  7.969319 216.7112 247.9830
 [26,] 237.3945  8.181202 221.3995 253.4212
 [27,] 242.3145  9.086109 224.4268 260.1295
 [28,] 247.2346 10.506472 226.1500 267.7974
 [29,] 252.1546 12.264495 227.7643 276.1882
 [30,] 257.0746 14.235624 228.9789 285.2021
 [31,] 274.8153 13.645664 248.9350 302.2741
 [32,] 280.4740 11.626006 258.2471 303.7175
 [33,] 286.1328  9.885949 267.1156 305.9555
 [34,] 291.7916  8.596979 275.1343 309.0845
 [35,] 297.4504  7.980738 282.0397 313.2034
 [36,] 303.1092  8.190508 287.0824 319.1404
 [37,] 308.7680  9.169774 290.8637 326.8432
 [38,] 314.4268 10.709489 293.0965 335.7309
 [39,] 320.0856 12.605938 295.4849 344.3883
 [40,] 325.7444 14.721898 296.9658 354.1185
 [41,] 273.0867 13.066999 248.6245 299.1405
 [42,] 280.5778 11.219244 259.4448 303.2564
 [43,] 288.0688  9.641980 269.5438 307.2688
 [44,] 295.5598  8.487373 279.0000 312.1461
 [45,] 303.0509  7.941952 287.4709 318.6892
 [46,] 310.5419  8.129273 294.6223 326.1533
 [47,] 318.0329  9.003717 300.4882 335.2994
 [48,] 325.5239 10.393274 305.6033 345.3792
 [49,] 333.0150 12.122077 309.4723 355.9293
 [50,] 340.5060 14.065586 313.2096 367.2200
 [51,] 260.3514 12.323348 235.9567 284.9663
 [52,] 270.5695 10.595058 249.5276 291.4402
 [53,] 280.7876  9.149965 262.6710 298.5913
 [54,] 291.0056  8.140315 274.6694 307.0579
 [55,] 301.2237  7.738468 286.2917 316.0928
 [56,] 311.4418  8.036125 295.7613 326.8247
 [57,] 321.6599  8.963872 304.2572 338.9845
 [58,] 331.8779 10.353694 311.5572 352.0016
 [59,] 342.0960 12.046710 318.3997 365.8664
 [60,] 352.3141 13.932829 325.1119 379.8807
 [61,] 267.9897 12.725638 243.3790 293.5194
 [62,] 278.2835 10.950182 256.8794 300.5347
 [63,] 288.5773  9.445367 269.9731 307.5845
 [64,] 298.8712  8.358665 282.4588 315.5509
 [65,] 309.1650  7.865332 293.4701 324.8995
 [66,] 319.4588  8.074866 303.4678 335.0127
 [67,] 329.7526  8.937971 311.9604 347.4874
 [68,] 340.0465 10.291504 320.0505 360.4776
 [69,] 350.3403 11.970239 326.9105 374.1672
 [70,] 360.6341 13.856479 333.4150 388.0600
 [71,] 244.5069 12.444130 219.8442 269.5900
 [72,] 256.0316 10.702204 235.2265 277.5810
 [73,] 267.5564  9.240353 249.6003 286.0225
 [74,] 279.0812  8.209581 263.3718 295.7006
 [75,] 290.6059  7.783090 275.6298 306.2338
 [76,] 302.1307  8.057413 286.7273 318.4356
 [77,] 313.6554  8.968472 296.5084 331.7536
 [78,] 325.1802 10.349455 305.3254 345.6681
 [79,] 336.7049 12.039730 313.2678 360.0068
 [80,] 348.2297 13.927137 321.0243 375.2389
 [81,] 250.6879 13.485646 224.2989 277.5236
 [82,] 250.4581 11.471714 227.8234 273.2461
 [83,] 250.2283  9.744208 230.9844 269.5417
 [84,] 249.9985  8.480022 233.2632 266.5693
 [85,] 249.7687  7.904668 234.1806 265.2546
 [86,] 249.5389  8.165084 233.1741 265.5668
 [87,] 249.3091  9.190496 231.2694 267.0841
 [88,] 249.0793 10.764463 227.9994 269.8993
 [89,] 248.8495 12.684396 224.7297 273.7345
 [90,] 248.6196 14.816409 220.4883 278.0137
 [91,] 285.9364 13.150529 260.3152 311.4183
 [92,] 305.0896 11.284381 283.1248 327.2365
 [93,] 324.2428  9.685883 305.7889 343.3307
 [94,] 343.3960  8.507272 327.1074 360.3176
 [95,] 362.5492  7.937839 347.2118 378.5563
 [96,] 381.7024  8.106982 365.7869 397.9295
 [97,] 400.8556  8.973031 383.1474 418.7700
 [98,] 420.0088 10.362707 399.7166 440.6077
 [99,] 439.1619 12.096874 415.8982 463.3720
[100,] 458.3151 14.048533 431.1518 485.8095
[101,] 226.3762 13.059485 199.4860 250.6473
[102,] 237.9716 11.222971 214.6400 259.2948
[103,] 249.5669  9.670135 230.1745 267.9460
[104,] 261.1623  8.556835 244.7699 277.4141
[105,] 272.7577  8.067144 257.1807 288.6332
[106,] 284.3530  8.312021 267.9752 300.6544
[107,] 295.9484  9.233203 278.0195 314.2773
[108,] 307.5437 10.656730 286.5452 329.2323
[109,] 319.1391 12.410931 294.8296 344.2649
[110,] 330.7345 14.375257 302.4358 360.3743
[111,] 238.2086 13.156331 211.9202 262.2243
[112,] 255.3249 11.225286 232.9741 276.0471
[113,] 272.4411  9.555938 253.7904 290.3167
[114,] 289.5574  8.307573 273.0647 305.6577
[115,] 306.6736  7.688075 291.6160 322.0081
[116,] 323.7899  7.847811 308.5604 339.6747
[117,] 340.9061  8.744181 323.9864 358.3924
[118,] 358.0224 10.184506 338.0494 377.9785
[119,] 375.1386 11.974077 351.8594 397.9354
[120,] 392.2549 13.979407 365.2813 418.9245
[121,] 255.7969 12.261857 231.7593 279.9791
[122,] 263.2898 10.570720 242.7590 284.4223
[123,] 270.7827  9.177438 253.1438 289.4564
[124,] 278.2756  8.234615 262.6581 295.0332
[125,] 285.7685  7.905105 270.8344 301.8188
[126,] 293.2614  8.262613 277.5832 310.0264
[127,] 300.7543  9.227629 282.7624 319.3492
[128,] 308.2472 10.636060 287.4933 329.2092
[129,] 315.7401 12.336964 291.7464 340.1178
[130,] 323.2330 14.225818 294.8674 350.9443
[131,] 271.8141 12.580070 247.3030 296.9106
[132,] 285.9158 10.775506 265.1855 307.5667
[133,] 300.0175  9.241725 282.4765 318.4767
[134,] 314.1193  8.133390 298.5205 329.8934
[135,] 328.2210  7.638008 313.6226 343.2362
[136,] 342.3227  7.872159 327.6367 357.7357
[137,] 356.4244  8.777653 339.2002 373.6582
[138,] 370.5262 10.176841 350.7799 390.3641
[139,] 384.6279 11.896789 361.2414 407.6398
[140,] 398.7296 13.818237 371.3874 425.3068
[141,] 254.4188 12.267725 229.8290 278.9276
[142,] 265.8147 10.571765 245.0650 286.8705
[143,] 277.2107  9.177503 259.2418 295.1995
[144,] 288.6066  8.239546 272.6781 304.5825
[145,] 300.0025  7.921671 284.7844 315.5539
[146,] 311.3985  8.295470 295.2638 327.5726
[147,] 322.7944  9.277714 304.9595 340.7082
[148,] 334.1903 10.702165 313.5656 355.5269
[149,] 345.5863 12.417564 321.7085 370.5276
[150,] 356.9822 14.319729 329.0654 385.0985
[151,] 226.0076 13.554522 198.5488 252.1007
[152,] 241.2355 11.595199 217.4757 263.3194
[153,] 256.4634  9.919078 236.1597 275.6812
[154,] 271.6912  8.691573 254.2969 288.6984
[155,] 286.9191  8.118784 271.0625 302.6965
[156,] 302.1469  8.336771 285.8252 318.1749
[157,] 317.3748  9.290034 299.0382 335.5170
[158,] 332.6026 10.785342 311.7650 353.4373
[159,] 347.8305 12.631640 323.1781 372.1725
[160,] 363.0584 14.697243 334.2112 391.6441
[161,] 252.0536 12.560325 227.7522 276.4582
[162,] 261.5782 10.799283 240.8127 282.6405
[163,] 271.1027  9.313336 252.9328 289.5863
[164,] 280.6272  8.252447 264.6603 297.2241
[165,] 290.1518  7.792207 275.1012 305.5983
[166,] 299.6763  8.036483 284.1517 315.3089
[167,] 309.2009  8.927630 291.9546 326.4585
[168,] 318.7254 10.299080 298.7240 339.0240
[169,] 328.2500 11.987097 304.4187 351.9409
[170,] 337.7745 13.876631 310.4957 365.7836
[171,] 263.4805 12.232282 238.7427 287.4175
[172,] 275.2524 10.551069 254.4595 295.7369
[173,] 287.0244  9.154229 268.9605 305.0194
[174,] 298.7964  8.188609 282.9387 314.9104
[175,] 310.5683  7.815705 295.6851 325.7718
[176,] 322.3403  8.117619 306.5639 338.1345
[177,] 334.1123  9.026891 316.5357 351.7531
[178,] 345.8842 10.385197 325.2349 366.2467
[179,] 357.6562 12.041529 333.6755 381.2427
[180,] 369.4282 13.889675 341.4030 396.8907</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.3619258 12.786314  -28.79570135  21.3339972
  [2,]  -14.8522522 10.932703  -36.21943256   6.6308305
  [3,]  -42.3913785  9.381593  -60.80148471 -24.3354061
  [4,]    8.6127951  8.304258   -7.77789821  24.3512374
  [5,]   24.3898688  7.897040    8.43404148  39.3269232
  [6,]   62.5930424  8.259656   46.42094365  78.4870169
  [7,]   10.4717161  9.302512   -7.79122719  28.3352716
  [8,] -101.2185103 10.830866 -122.79356244 -80.2216949
  [9,]   19.5831634 12.670229   -5.05347373  44.2861128
 [10,]   35.7163370 14.704349    7.01767637  64.2343850
 [11,]   11.2099434 13.449291  -14.24353873  38.1102456
 [12,]   -7.9956144 11.501445  -29.92445538  15.0970611
 [13,]  -12.0210723  9.824515  -30.36179990   7.4647712
 [14,]  -12.0293301  8.578870  -28.58210389   4.8734440
 [15,]  -10.7576879  7.969378  -26.11679023   4.7424010
 [16,]   -4.2494458  8.140211  -20.67494196  11.9109556
 [17,]   -8.3184036  9.047272  -26.26668587   9.2756146
 [18,]   -5.9589615 10.501490  -26.07569712  14.2843099
 [19,]   -1.1279193 12.310464  -24.82102384  22.6520742
 [20,]   10.1531229 14.340565  -17.74653976  38.4116754
 [21,]  -13.7405246 13.109339  -39.32640414  12.2583407
 [22,]  -23.3822442 11.245607  -45.22800198  -0.6980852
 [23,]   11.6855363  9.657942   -7.26605924  31.0865592
 [24,]    5.2871167  8.502429  -11.28181024  22.1817369
 [25,]   -3.1671028  7.969319  -18.67562341  12.5961733
 [26,]  -16.9366223  8.181202  -32.96326040  -0.9416064
 [27,]   -6.8937419  9.086109  -24.70872582  10.9939676
 [28,]    8.5165386 10.506472  -12.04627294  29.6011090
 [29,]    8.8579191 12.264495  -15.17573609  33.2482181
 [30,]   -9.5593005 14.235624  -37.68684495  18.5363862
 [31,]   46.7273458 13.645664   19.26850324  72.6076153
 [32,]   19.9261557 11.626006   -3.31732985  42.1530820
 [33,]   -2.2763345  9.885949  -22.09901061  16.7409190
 [34,]   -6.6586246  8.596979  -23.95153672   9.9986928
 [35,]  -11.6531148  7.980738  -27.40612182   3.7575553
 [36,]   -5.5237049  8.190508  -21.55485261  10.5030571
 [37,]  -28.5283951  9.169774  -46.60358562 -10.6241060
 [38,]    3.8345147 10.709489  -17.46964569  25.1647524
 [39,]  -14.7360754 12.605938  -39.03879848   9.8645547
 [40,]   28.3043344 14.721898   -0.06984167  57.0828713
 [41,]   14.5211559 13.066999  -11.53255436  38.9833808
 [42,]    4.4222276 11.219244  -18.25641726  25.5552261
 [43,]   13.7517992  9.641980   -5.44817886  32.2767555
 [44,]   24.5554708  8.487373    7.96919041  41.1152968
 [45,]   13.2264424  7.941952   -2.41194344  28.8063650
 [46,]  -17.2231860  8.129273  -32.83463066  -1.3036013
 [47,]  -27.9579143  9.003717  -45.22435656 -10.4131922
 [48,]    9.2937573 10.393274  -10.56147742  29.2144021
 [49,]  -39.2680711 12.122077  -62.18236927 -15.7253960
 [50,]   31.0751005 14.065586    4.36111741  58.3714941
 [51,]  -25.4908085 12.323348  -50.10573575  -1.0961001
 [52,]  -27.7576854 10.595058  -48.62837255  -6.7157548
 [53,]   -7.8262623  9.149965  -25.63001413  10.2903268
 [54,]   18.7631608  8.140315    2.71090857  35.0993581
 [55,]   16.2391838  7.738468    1.37006530  31.1712369
 [56,]   -1.4441931  8.036125  -16.82713400  14.2363411
 [57,]  132.5020300  8.963872  115.17738670 149.9046829
 [58,]   14.9531531 10.353694   -5.17050526  35.2739120
 [59,]  -11.7957238 12.046710  -35.56611934  11.9006290
 [60,]  -98.4497007 13.932829 -126.01631444 -71.2474538
 [61,]   15.8526921 12.725638   -9.67702276  40.4634454
 [62,]   11.2714714 10.950182  -10.97965717  32.6756240
 [63,]  -11.8080493  9.445367  -30.81517126   6.7962046
 [64,]    0.9385300  8.358665  -15.74118272  17.3509403
 [65,]  -11.9939907  7.865332  -27.72850582   3.7009198
 [66,]   18.7076886  8.074866    3.15384017  34.6986987
 [67,]    2.2738679  8.937971  -15.46085316  20.0660748
 [68,]    8.7934472 10.291504  -11.63774637  28.7894148
 [69,]  -16.9802735 11.970239  -40.80716235   6.4495071
 [70,]    1.4087058 13.856479  -26.01719209  28.6278018
 [71,]   20.9662081 12.444130   -4.11686387  45.6289192
 [72,]   20.1695531 10.702204   -1.37983522  40.9747139
 [73,]  -24.1917019  9.240353  -42.65784088  -6.2355832
 [74,]  -24.4088569  8.209581  -41.02829055  -8.6994802
 [75,]  -11.5815119  7.783090  -27.20936590   3.3946401
 [76,]  -17.9394668  8.057413  -34.24441511  -2.5360899
 [77,]   -8.1306218  8.968472  -26.22875606   9.0163570
 [78,]    6.3427232 10.349455  -14.14523094  26.1975141
 [79,]   -0.9580318 12.039730  -24.25992526  22.4790943
 [80,]   29.0693132 13.927137    2.06005968  56.2747391
 [81,]   -9.0796441 13.485646  -35.91530873  17.3093997
 [82,]   23.4890665 11.471714    0.70111251  46.1237653
 [83,]    4.2623771  9.744208  -15.05096029  23.5063348
 [84,]   20.8035877  8.480022    4.23279369  37.5389276
 [85,]    1.6831983  7.904668  -13.80265483  17.2712956
 [86,]    5.0973088  8.165084  -10.93058575  21.4621220
 [87,]   -3.8567806  9.190496  -21.63175804  14.1828625
 [88,]  -13.7682700 10.764463  -34.58825679   7.3115638
 [89,]  -13.0953594 12.684396  -37.98042460  11.0244354
 [90,]  -11.3730488 14.816409  -40.76708767  16.7583223
 [91,]   26.4301650 13.150529    0.94832675  52.0513518
 [92,]    8.7161757 11.284381  -13.43073978  30.6810398
 [93,]  -32.6316136  9.685883  -51.71947863 -14.1777393
 [94,]    2.7261971  8.507272  -14.19538449  19.0147933
 [95,]    3.1832079  7.937839  -12.82391882  18.5205562
 [96,]   10.1361186  8.106982   -6.09097382  26.0516017
 [97,]    3.4045293  8.973031  -14.50985779  21.1126543
 [98,]   -3.3164600 10.362707  -23.91536844  16.9757131
 [99,]   16.7023507 12.096874   -7.50766618  39.9660660
[100,]    0.6015614 14.048533  -26.89276302  27.7648552
[101,]    9.7269718 13.059485  -14.54413202  36.6172339
[102,]   -7.6548866 11.222971  -28.97813279  15.6766880
[103,]  -10.6413451  9.670135  -29.02037939   8.7510535
[104,]   -6.2403035  8.556835  -22.49206229  10.1521334
[105,]  -22.0473619  8.067144  -37.92293099  -6.4703920
[106,]  -14.5786204  8.312021  -30.87995787   1.7991535
[107,]  -14.3835788  9.233203  -32.71250037   3.5452536
[108,]    0.5582628 10.656730  -21.13026594  21.5567557
[109,]   17.1415043 12.410931   -7.98425703  41.4510406
[110,]   20.9106459 14.375257   -8.72924814  49.2093074
[111,]   18.0881822 13.156331   -5.92754268  44.3765870
[112,]  -11.8705692 11.225286  -32.59284747  10.4801772
[113,]  -16.2365205  9.555938  -34.11205550   2.4142072
[114,]  -34.0302718  8.307573  -50.13063801 -17.5375890
[115,]  -37.7571231  7.688075  -53.09162670 -22.6994631
[116,]    5.9348256  7.847811   -9.94999692  21.1642559
[117,]   38.5383743  8.744181   21.05213131  55.4580606
[118,]    4.8960230 10.184506  -15.06009546  24.8690066
[119,]   19.3485717 11.974077   -3.44817413  42.6278293
[120,]   -3.2021796 13.979407  -29.87178373  23.7714249
[121,]   -5.2703979 12.261857  -29.45263320  18.7672259
[122,]   36.7678019 10.570720   15.63525571  57.2986296
[123,]   -0.8887983  9.177438  -19.56253926  16.7501468
[124,]    2.3135015  8.234615  -14.44409119  17.9310347
[125,]  -13.9410987  7.905105  -29.99136385   0.9930485
[126,]   11.3722010  8.262613   -5.39277142  27.0504235
[127,]  -13.0076992  9.227629  -31.60262708   4.9842307
[128,]  -41.6516994 10.636060  -62.61366420 -20.8978218
[129,]    5.8017004 12.336964  -18.57598541  29.7953879
[130,]   24.3325002 14.225818   -3.37880448  52.6980775
[131,]  -50.1369754 12.580070  -75.23350469 -25.6259119
[132,]   12.2780960 10.775506   -9.37284931  33.0083950
[133,]   26.8609673  9.241725    8.40181542  44.4019936
[134,]   32.7362387  8.133390   16.96210416  48.3350248
[135,]   20.5192101  7.638008    5.50401623  35.1176291
[136,]   10.5059814  7.872159   -4.90699287  25.1920174
[137,]   -1.9978472  8.777653  -19.23161572  15.2263851
[138,]  -10.0935758 10.176841  -29.93149612   9.6526604
[139,]   -8.9873045 11.896789  -31.99923120  14.3991693
[140,]  -10.1879331 13.818237  -36.76506355  17.1543323
[141,]   17.5047253 12.267725   -7.00406128  42.0944982
[142,]    2.6221866 10.571765  -18.43355062  23.3718978
[143,]  -19.9682520  9.177503  -37.95712854  -1.9993538
[144,]  -10.9499907  8.239546  -26.92587871   4.9785370
[145,]   14.8196707  7.921671   -0.73166878  30.0377909
[146,]    5.8150320  8.295470  -10.35908987  21.9497421
[147,]  -24.6591067  9.277714  -42.57290784  -6.8242280
[148,]   13.9325547 10.702165   -7.40397336  34.5573207
[149,]   -5.3062840 12.417564  -30.24763256  18.5714965
[150,]    9.5308774 14.319729  -18.58543911  37.4476869
[151,]   -0.7436307 13.554522  -26.83665590  26.7151619
[152,]   -6.7119905 11.595199  -28.79591963  17.0478248
[153,]  -17.5625502  9.919078  -36.78036302   2.7410711
[154,]  -31.2182100  8.691573  -48.22539407 -13.8239079
[155,]  -19.3817697  8.118784  -35.15922277  -3.5251953
[156,]   42.0467705  8.336771   26.01878852  58.3684548
[157,]  -36.2266892  9.290034  -54.36887455 -17.8901200
[158,]   14.9828510 10.785342   -5.85184963  35.8205268
[159,]   17.3324913 12.631640   -7.00951064  41.9848560
[160,]    9.1704315 14.697243  -19.41525609  38.0175892
[161,]   17.8267882 12.560325   -6.57782619  42.1282088
[162,]   10.8646458 10.799283  -10.19773572  31.6301369
[163,]    6.7962034  9.313336  -11.68741543  24.9660996
[164,]    1.1622610  8.252447  -15.43460073  17.1292064
[165,]  -10.9812814  7.792207  -26.42782835   4.0692662
[166,]  -15.1643238  8.036483  -30.79694765   0.3602547
[167,]  -49.9350662  8.927630  -67.19268100 -32.6888112
[168,]  -14.0948087 10.299080  -34.39344433   5.9065839
[169,]   22.5307489 11.987097   -1.16020103  46.3620315
[170,]   31.6947065 13.876631    3.68555292  58.9735053
[171,]    5.9312460 12.232282  -18.00580786  30.6690003
[172,]   -1.7784208 10.551069  -22.26289885  19.0145454
[173,]   10.5724123  9.154229   -7.42257558  28.6362737
[174,]   11.8352455  8.188609   -4.27882097  27.6929060
[175,]  -23.3957214  7.815705  -38.59915436  -8.5124656
[176,]    7.2673117  8.117619   -8.52694675  23.0436560
[177,]    0.3695449  9.026891  -17.27129939  17.9461411
[178,]   -2.6643220 10.385197  -23.02679945  17.9849609
[179,]   11.4855112 12.041529  -12.10095274  35.4662054
[180,]   -5.3045557 13.889675  -32.76708755  22.7205753</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.3
p_loo        19.2  3.3
looic      1769.5 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   548       
 (0.5, 0.7]   (ok)         1    0.6%   247       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.9 22.3
p_loo        33.7  8.3
looic      1721.7 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   706       
 (0.5, 0.7]   (ok)         7    3.9%   691       
   (0.7, 1]   (bad)        2    1.1%   19        
   (1, Inf)   (very bad)   1    0.6%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.9      11.7  
fit_sleep1 -92.5      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.3
p_loo        19.2  3.3
looic      1769.5 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   548       
 (0.5, 0.7]   (ok)         1    0.6%   247       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.9 22.3
p_loo        33.7  8.3
looic      1721.7 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   706       
 (0.5, 0.7]   (ok)         7    3.9%   691       
   (0.7, 1]   (bad)        2    1.1%   19        
   (1, Inf)   (very bad)   1    0.6%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.9     22.3        33.7    8.3   1721.7
fit_sleep2  -23.9      11.7  -884.8     14.3        19.2    3.3   1769.5
fit_sleep1  -92.5      21.0  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.5  
fit_sleep2   28.6  
fit_sleep1   21.1  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.722580e-41 4.099719e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.87      1.57     0.21     5.42       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.13      1.57    -3.39     2.92       5.68      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0.1       tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
