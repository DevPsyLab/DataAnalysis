<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing
adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.03      6.99    15.79    43.56 1.00     1512     2613
sd(Days)                6.62      1.56     4.18    10.20 1.00     1523     1703
cor(Intercept,Days)     0.08      0.30    -0.48     0.66 1.00      981     1801

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.12      7.36   236.44   265.64 1.00     2050     2444
Days         10.33      1.74     6.90    13.75 1.00     1398     2017

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.58    22.99    29.08 1.00     2972     2503

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7522  12.98836 227.1833 278.1756
309 211.5384  13.33437 184.9311 237.6542
310 212.5893  13.27112 185.7329 237.9545
330 274.6179  13.64889 249.1008 301.3916
331 273.2298  12.94986 248.6132 299.0317
332 260.2704  12.38404 236.3672 284.8320
333 267.9567  12.44077 243.7987 293.2623
334 244.2838  12.28695 219.7981 268.0521
335 250.8055  13.55315 225.0546 278.2264
337 285.9261  13.23654 260.2608 312.4475
349 226.4551  13.05488 200.2166 251.9564
350 238.9178  13.25931 212.2173 264.1370
351 255.6122  12.63886 231.3420 280.9670
352 272.2906  12.84921 246.9815 297.8783
369 254.5619  12.30849 229.5040 278.3091
370 225.9596  13.29121 199.2902 250.6431
371 252.2380  12.14834 227.7964 275.8153
372 263.3998  12.32318 239.3659 287.4031

, , Days

      Estimate Est.Error         Q2.5     Q97.5
308 19.6878887  2.504642 14.900103034 24.629371
309  1.7214711  2.516512 -3.298361228  6.706882
310  4.9904389  2.473671 -0.004896135  9.807717
330  5.7090454  2.571229  0.635777220 10.602118
331  7.4214276  2.440220  2.603109872 12.152319
332 10.1943237  2.346150  5.525085702 14.685607
333 10.2944616  2.371006  5.562565388 15.039372
334 11.5033042  2.375905  6.845290200 16.212914
335 -0.2841996  2.596303 -5.465642552  4.806938
337 19.1456689  2.486614 14.218755268 24.103342
349 11.5715982  2.470838  6.742815625 16.606159
350 16.9967953  2.522485 12.068978032 22.017854
351  7.4872208  2.382772  2.760307759 12.082380
352 14.0075937  2.433271  9.203001997 18.737067
369 11.3434877  2.330867  6.878810007 15.952231
370 15.2685169  2.529606 10.517239836 20.477780
371  9.5039607  2.342410  4.799717094 14.092773
372 11.8157946  2.362842  7.081132441 16.437376</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7522 12.988363 227.1833 278.1756
  [2,] 273.4401 11.115200 251.1122 294.6741
  [3,] 293.1280  9.536468 274.2378 311.7328
  [4,] 312.8159  8.419456 296.6800 329.5095
  [5,] 332.5038  7.960949 317.1312 348.1745
  [6,] 352.1916  8.271194 336.1540 368.1395
  [7,] 371.8795  9.273351 353.4499 389.7823
  [8,] 391.5674 10.776080 370.2979 412.5225
  [9,] 411.2553 12.601555 386.8147 435.6032
 [10,] 430.9432 14.629456 402.6441 459.0334
 [11,] 211.5384 13.334368 184.9311 237.6542
 [12,] 213.2598 11.403838 189.7884 235.7301
 [13,] 214.9813  9.744501 195.0123 233.8004
 [14,] 216.7028  8.516383 199.2578 233.0140
 [15,] 218.4242  7.922620 202.6814 233.6543
 [16,] 220.1457  8.103870 203.8176 235.6101
 [17,] 221.8672  9.013500 204.0392 239.1866
 [18,] 223.5887 10.463237 202.9001 243.9889
 [19,] 225.3101 12.262998 201.1256 249.3319
 [20,] 227.0316 14.281058 198.8382 254.7557
 [21,] 212.5893 13.271115 185.7329 237.9545
 [22,] 217.5797 11.408997 194.7771 239.3473
 [23,] 222.5701  9.820694 203.1602 241.0694
 [24,] 227.5606  8.658231 210.3966 244.0076
 [25,] 232.5510  8.106909 216.8017 248.1706
 [26,] 237.5415  8.289576 221.6413 253.4946
 [27,] 242.5319  9.162438 224.7307 260.3194
 [28,] 247.5223 10.555642 226.6416 267.9929
 [29,] 252.5128 12.293534 227.8717 276.5370
 [30,] 257.5032 14.250560 228.7039 284.9755
 [31,] 274.6179 13.648890 249.1008 301.3916
 [32,] 280.3270 11.674918 258.3614 303.2862
 [33,] 286.0360  9.976856 266.8339 305.9289
 [34,] 291.7451  8.717455 274.6594 309.0445
 [35,] 297.4541  8.103878 281.6586 313.5265
 [36,] 303.1632  8.280947 287.0731 319.3625
 [37,] 308.8722  9.203138 290.9774 326.8370
 [38,] 314.5813 10.679132 293.9807 335.5587
 [39,] 320.2903 12.514488 296.2179 345.2402
 [40,] 325.9994 14.574066 297.5471 354.6378
 [41,] 273.2298 12.949860 248.6132 299.0317
 [42,] 280.6513 11.120998 259.1937 302.6495
 [43,] 288.0727  9.568890 269.6399 307.0566
 [44,] 295.4941  8.447489 279.1030 312.1799
 [45,] 302.9156  7.941400 287.7028 318.5377
 [46,] 310.3370  8.165840 294.3149 326.7041
 [47,] 317.7584  9.066720 300.0643 335.7545
 [48,] 325.1798 10.470875 304.5047 346.1401
 [49,] 332.6013 12.205834 308.2116 356.8420
 [50,] 340.0227 14.150437 311.5999 368.1310
 [51,] 260.2704 12.384041 236.3672 284.8320
 [52,] 270.4647 10.658262 249.7219 291.8140
 [53,] 280.6590  9.210943 262.6975 299.2190
 [54,] 290.8533  8.191046 274.8079 307.2036
 [55,] 301.0476  7.768773 286.0708 316.0252
 [56,] 311.2420  8.038861 295.3455 326.9322
 [57,] 321.4363  8.938768 303.3688 338.8525
 [58,] 331.6306 10.304790 310.5829 351.5031
 [59,] 341.8249 11.978508 317.9563 365.0062
 [60,] 352.0193 13.848807 324.4081 378.5583
 [61,] 267.9567 12.440772 243.7987 293.2623
 [62,] 278.2512 10.707534 257.6271 299.7385
 [63,] 288.5456  9.261379 270.5260 306.9449
 [64,] 298.8401  8.254593 282.6705 315.2976
 [65,] 309.1345  7.857915 293.9872 324.2813
 [66,] 319.4290  8.160802 303.1839 335.0335
 [67,] 329.7235  9.093618 311.4681 347.5144
 [68,] 340.0179 10.489634 319.2218 360.4087
 [69,] 350.3124 12.190746 326.5824 374.1053
 [70,] 360.6069 14.086856 333.6168 387.8943
 [71,] 244.2838 12.286949 219.7981 268.0521
 [72,] 255.7872 10.593175 235.0698 276.3002
 [73,] 267.2905  9.206054 249.1130 285.0169
 [74,] 278.7938  8.281145 262.5533 294.7552
 [75,] 290.2971  7.980799 274.7571 305.7525
 [76,] 301.8004  8.372502 285.6315 318.2731
 [77,] 313.3037  9.369860 295.2631 331.9022
 [78,] 324.8070 10.806462 304.0742 346.1099
 [79,] 336.3103 12.532152 312.2921 361.4753
 [80,] 347.8136 14.443679 319.9744 376.8814
 [81,] 250.8055 13.553155 225.0546 278.2264
 [82,] 250.5213 11.524125 228.6456 273.4076
 [83,] 250.2371  9.767522 231.5583 269.2685
 [84,] 249.9529  8.454887 233.4121 266.5583
 [85,] 249.6687  7.813277 234.3609 265.1009
 [86,] 249.3845  8.005690 233.9615 265.2435
 [87,] 249.1003  8.978665 231.7563 266.9396
 [88,] 248.8161 10.517763 228.3774 269.6987
 [89,] 248.5319 12.414179 224.1953 273.4694
 [90,] 248.2477 14.528659 219.7707 277.3165
 [91,] 285.9261 13.236537 260.2608 312.4475
 [92,] 305.0718 11.378798 283.0192 327.5818
 [93,] 324.2175  9.803811 305.4259 343.4932
 [94,] 343.3631  8.667114 326.3068 360.4769
 [95,] 362.5088  8.154110 346.2118 378.6084
 [96,] 381.6545  8.380135 364.9272 398.2646
 [97,] 400.8001  9.291412 382.3274 419.0963
 [98,] 419.9458 10.714499 398.5628 441.0220
 [99,] 439.0915 12.475462 414.4187 463.6960
[100,] 458.2371 14.451309 429.4419 486.6422
[101,] 226.4551 13.054884 200.2166 251.9564
[102,] 238.0267 11.169075 215.3972 259.6529
[103,] 249.5983  9.553876 230.4623 267.9629
[104,] 261.1699  8.367492 244.7209 277.4688
[105,] 272.7415  7.807906 257.2951 288.2396
[106,] 284.3131  8.007619 268.0912 299.9696
[107,] 295.8847  8.915750 278.5173 313.3920
[108,] 307.4563 10.347431 287.4379 327.7308
[109,] 319.0279 12.118503 295.5225 342.9925
[110,] 330.5995 14.101667 303.0479 358.3448
[111,] 238.9178 13.259308 212.2173 264.1370
[112,] 255.9146 11.330207 232.7923 277.3589
[113,] 272.9114  9.678005 253.2429 291.5553
[114,] 289.9082  8.466395 272.8043 306.1786
[115,] 306.9050  7.900744 291.1669 321.9535
[116,] 323.9018  8.117237 308.0849 339.3755
[117,] 340.8986  9.059977 322.8775 358.2042
[118,] 357.8954 10.535781 336.6366 378.2767
[119,] 374.8922 12.355082 350.1667 399.0673
[120,] 391.8890 14.388165 363.0940 420.0574
[121,] 255.6122 12.638857 231.3420 280.9670
[122,] 263.0995 10.874363 241.9463 284.7103
[123,] 270.5867  9.387121 252.3912 289.4027
[124,] 278.0739  8.327035 261.4382 294.3340
[125,] 285.5611  7.868684 270.0278 301.0922
[126,] 293.0484  8.114683 277.3999 309.0909
[127,] 300.5356  9.007507 283.4240 318.5555
[128,] 308.0228 10.381594 287.8839 328.4531
[129,] 315.5100 12.073732 291.8742 339.1027
[130,] 322.9972 13.968812 295.7629 350.0358
[131,] 272.2906 12.849214 246.9815 297.8783
[132,] 286.2982 11.057163 264.3092 308.5099
[133,] 300.3058  9.553063 281.5946 319.5519
[134,] 314.3134  8.491336 297.8707 331.0010
[135,] 328.3210  8.048986 312.8950 344.1121
[136,] 342.3286  8.325334 326.4611 358.9607
[137,] 356.3362  9.256232 338.2021 374.6520
[138,] 370.3438 10.671742 349.5775 391.6375
[139,] 384.3514 12.407092 360.1885 408.9959
[140,] 398.3590 14.346687 370.3275 427.0482
[141,] 254.5619 12.308495 229.5040 278.3091
[142,] 265.9054 10.616816 244.7425 286.6343
[143,] 277.2488  9.208713 258.8680 295.5527
[144,] 288.5923  8.231032 272.4394 304.5201
[145,] 299.9358  7.846353 284.5605 315.7479
[146,] 311.2793  8.139196 295.1425 327.4279
[147,] 322.6228  9.043984 304.9225 340.2656
[148,] 333.9663 10.402243 314.0309 354.4668
[149,] 345.3098 12.061739 322.0201 369.0000
[150,] 356.6533 13.915111 330.0912 384.2649
[151,] 225.9596 13.291213 199.2902 250.6431
[152,] 241.2281 11.367095 218.6900 262.3342
[153,] 256.4966  9.724359 237.4359 274.6952
[154,] 271.7651  8.527208 255.6343 288.2350
[155,] 287.0337  7.978798 271.9548 302.4037
[156,] 302.3022  8.210174 286.3454 318.1850
[157,] 317.5707  9.162451 299.6882 335.0494
[158,] 332.8392 10.643865 312.3007 353.6445
[159,] 348.1077 12.467198 324.3473 372.5873
[160,] 363.3762 14.504069 335.4547 392.0879
[161,] 252.2380 12.148337 227.7964 275.8153
[162,] 261.7420 10.414134 240.7608 282.3368
[163,] 271.2460  8.961029 253.5529 288.9439
[164,] 280.7499  7.944788 265.2221 295.8891
[165,] 290.2539  7.544074 275.4168 304.3649
[166,] 299.7578  7.853674 284.0791 314.8581
[167,] 309.2618  8.798927 291.8928 326.4230
[168,] 318.7658 10.204694 298.3180 338.7319
[169,] 328.2697 11.908998 304.5761 351.7077
[170,] 337.7737 13.801683 310.5727 364.8216
[171,] 263.3998 12.323182 239.3659 287.4031
[172,] 275.2156 10.606953 254.2209 296.0011
[173,] 287.0314  9.182601 268.7201 304.8400
[174,] 298.8472  8.203590 282.6090 314.5463
[175,] 310.6630  7.838601 295.1120 326.0347
[176,] 322.4788  8.170341 306.7868 338.6489
[177,] 334.2946  9.123120 316.6344 352.4536
[178,] 346.1104 10.529683 325.5710 367.0439
[179,] 357.9262 12.234507 334.0848 382.4541
[180,] 369.7420 14.130043 342.1633 397.7390</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.1921986 12.988363  -28.61559257  22.3767463
  [2,]  -14.7353872 11.115200  -35.96940690   7.5924885
  [3,]  -42.3273759  9.536468  -60.93224761 -23.4371594
  [4,]    8.6239354  8.419456   -8.06968408  24.7597561
  [5,]   24.3481467  7.960949    8.67740807  39.7206886
  [6,]   62.4984581  8.271194   46.55064628  78.5361328
  [7,]   10.3242694  9.273351   -7.57852642  28.7538857
  [8,] -101.4188193 10.776080 -122.37388217 -80.1492872
  [9,]   19.3299921 12.601555   -5.01793121  43.7706179
 [10,]   35.4103034 14.629456    7.32013370  63.7094013
 [11,]   11.1955362 13.334368  -14.92033313  37.8027761
 [12,]   -7.9940349 11.403838  -30.46427767  15.4774085
 [13,]  -12.0035061  9.744501  -30.82257092   7.9655137
 [14,]  -11.9957772  8.516383  -28.30698587   5.4492042
 [15,]  -10.7081484  7.922620  -25.93823936   5.0346888
 [16,]   -4.1839195  8.103870  -19.64825852  12.1442315
 [17,]   -8.2368907  9.013500  -25.55631742   9.5910896
 [18,]   -5.8614618 10.463237  -26.26169648  14.8270653
 [19,]   -1.0144330 12.262998  -25.03616527  23.1701251
 [20,]   10.2825959 14.281058  -17.44154463  38.4760445
 [21,]  -13.5353604 13.271115  -38.90064365  13.3209938
 [22,]  -23.2474993 11.408997  -45.01513360  -0.4448987
 [23,]   11.7498618  9.820694   -6.74940106  31.1598379
 [24,]    5.2810229  8.658231  -11.16603875  22.4449604
 [25,]   -3.2436159  8.106909  -18.86317980  12.5056577
 [26,]  -17.0835548  8.289576  -33.03669885  -1.1833536
 [27,]   -7.1110937  9.162438  -24.89860197  10.6901046
 [28,]    8.2287674 10.555642  -12.24178756  29.1095194
 [29,]    8.4997285 12.293534  -15.52452054  33.1407888
 [30,]   -9.9879104 14.250560  -37.46019607  18.8113823
 [31,]   46.9246545 13.648890   20.15103127  72.4417993
 [32,]   20.0732091 11.674918   -2.88596945  42.0387648
 [33,]   -2.1795363  9.976856  -22.07244152  17.0226486
 [34,]   -6.6120817  8.717455  -23.91154749  10.4735618
 [35,]  -11.6568272  8.103878  -27.72918763   4.1387230
 [36,]   -5.5776726  8.280947  -21.77700726  10.5123799
 [37,]  -28.6326180  9.203138  -46.59743738 -10.7378258
 [38,]    3.6800366 10.679132  -17.29743713  24.2805544
 [39,]  -14.9408088 12.514488  -39.89065732   9.1315994
 [40,]   28.0493457 14.574066   -0.58910077  56.5015614
 [41,]   14.3780601 12.949860  -11.42377839  38.9946686
 [42,]    4.3487325 11.120998  -17.64947529  25.8063201
 [43,]   13.7479049  9.568890   -5.23604155  32.1806967
 [44,]   24.6211772  8.447489    7.93536811  41.0123018
 [45,]   13.3617496  7.941400   -2.26036547  28.5745145
 [46,]  -17.0182780  8.165840  -33.38543407  -0.9962090
 [47,]  -27.6834056  9.066720  -45.67948045  -9.9892889
 [48,]    9.6378668 10.470875  -11.32240731  30.3130293
 [49,]  -38.8543609 12.205834  -63.09509809 -14.4646720
 [50,]   31.5584115 14.150437    3.45011891  59.9812280
 [51,]  -25.4097508 12.384041  -49.97140184  -1.5066343
 [52,]  -27.6528746 10.658262  -49.00215805  -6.9101094
 [53,]   -7.6976983  9.210943  -26.25768625  10.2637724
 [54,]   18.9154780  8.191046    2.56518269  34.9608792
 [55,]   16.4152543  7.768773    1.43771714  31.3921298
 [56,]   -1.2443694  8.038861  -16.93455954  14.6521426
 [57,]  132.7256068  8.938768  115.30944373 150.7930698
 [58,]   15.2004831 10.304790   -4.67196512  36.2482306
 [59,]  -11.5246406 11.978508  -34.70585541  12.3440268
 [60,]  -98.1548643 13.848807 -124.69386984 -70.5436885
 [61,]   15.8857031 12.440772   -9.41992527  40.0437346
 [62,]   11.3038416 10.707534  -10.18346724  31.9278636
 [63,]  -11.7763200  9.261379  -30.17557720   6.2433328
 [64,]    0.9696184  8.254593  -15.48786321  17.1392167
 [65,]  -11.9635431  7.857915  -27.11026132   3.1837533
 [66,]   18.7374953  8.160802    3.13295332  34.9825787
 [67,]    2.3030337  9.093618  -15.48792952  20.5583743
 [68,]    8.8219722 10.489634  -11.56875176  29.6180651
 [69,]  -16.9523894 12.190746  -40.74527179   6.7775679
 [70,]    1.4359490 14.086856  -25.85152609  28.4260170
 [71,]   21.1892502 12.286949   -2.57902264  45.6749905
 [72,]   20.4140460 10.593175   -0.09897911  41.1314451
 [73,]  -23.9257582  9.206054  -41.65221198  -5.7483494
 [74,]  -24.1214625  8.281145  -40.08289796  -7.8810123
 [75,]  -11.2726667  7.980799  -26.72807850   4.2673128
 [76,]  -17.6091709  8.372502  -34.08188341  -1.4402937
 [77,]   -7.7788752  9.369860  -26.37738579  10.2616523
 [78,]    6.7159206 10.806462  -14.58698724  27.4486943
 [79,]   -0.5633836 12.532152  -25.72844603  23.4548218
 [80,]   29.4854121 14.443679    0.41760111  57.3245668
 [81,]   -9.1971509 13.553155  -36.61809639  16.5536999
 [82,]   23.4259487 11.524125    0.53959815  45.3016461
 [83,]    4.2536483  9.767522  -14.77784492  22.9323924
 [84,]   20.8492479  8.454887    4.24375796  37.3899503
 [85,]    1.7832476  7.813277  -13.64902663  17.0909585
 [86,]    5.2517472  8.005690  -10.60734195  20.6747256
 [87,]   -3.6479532  8.978665  -21.48726335  13.6959523
 [88,]  -13.5050535 10.517763  -34.38769924   6.9336276
 [89,]  -12.7777539 12.414179  -37.71531754  11.5588271
 [90,]  -11.0010543 14.528659  -40.06994931  17.4758813
 [91,]   26.4404823 13.236537   -0.08089168  52.1057527
 [92,]    8.7340134 11.378798  -13.77600832  30.7865785
 [93,]  -32.6062555  9.803811  -51.88197691 -13.8146907
 [94,]    2.7590756  8.667114  -14.35465272  19.8154309
 [95,]    3.2236067  8.154110  -12.87603759  19.5206171
 [96,]   10.1840378  8.380135   -6.42610134  26.9113094
 [97,]    3.4599689  9.291412  -14.83621007  21.9327430
 [98,]   -3.2535000 10.714499  -24.32971542  18.1294621
 [99,]   16.7728311 12.475462   -7.83171794  41.4455751
[100,]    0.6795622 14.451309  -27.72550479  29.4748153
[101,]    9.6480698 13.054884  -15.85324079  35.8866118
[102,]   -7.7100284 11.169075  -29.33619140  14.9194919
[103,]  -10.6727266  9.553876  -29.03731908   8.4632719
[104,]   -6.2479249  8.367492  -22.54677938  10.2010726
[105,]  -22.0312231  7.807906  -37.52934198  -6.5848262
[106,]  -14.5387213  8.007619  -30.19519431   1.6832231
[107,]  -14.3199196  8.915750  -31.82715606   3.0474844
[108,]    0.6456822 10.347431  -19.62877082  20.6641267
[109,]   17.2526840 12.118503   -6.71187823  40.7581131
[110,]   21.0455857 14.101667   -6.69968372  48.5972333
[111,]   17.3789527 13.259308   -7.84015530  44.0795240
[112,]  -12.4603426 11.330207  -33.90463816  10.6620051
[113,]  -16.7068379  9.678005  -35.35074389   2.9617045
[114,]  -34.3811331  8.466395  -50.65150618 -17.2772099
[115,]  -37.9885284  7.900744  -53.03702461 -22.2503707
[116,]    5.8228763  8.117237   -9.65078191  21.6397814
[117,]   38.5458810  9.059977   21.24027988  56.5669625
[118,]    5.0229858 10.535781  -15.35830032  26.2818469
[119,]   19.5949905 12.355082   -4.58005578  44.3204608
[120,]   -2.8363048 14.388165  -31.00470497  25.9587213
[121,]   -5.0857479 12.638857  -30.44053976  19.1844536
[122,]   36.9581314 10.874363   15.34727518  58.1112988
[123,]   -0.6927894  9.387121  -19.50881233  17.5026899
[124,]    2.5151898  8.327035  -13.74485050  19.1508517
[125,]  -13.7337310  7.868684  -29.26478400   1.7995697
[126,]   11.5852482  8.114683   -4.45725918  27.2336896
[127,]  -12.7889725  9.007507  -30.80885233   4.3226260
[128,]  -41.4272933 10.381594  -61.85762322 -21.2883956
[129,]    6.0317859 12.073732  -17.56092786  29.6675954
[130,]   24.5682651 13.968812   -2.47032724  51.8025891
[131,]  -50.6135320 12.849214  -76.20121537 -25.3043611
[132,]   11.8956743 11.057163  -10.31603116  33.8847228
[133,]   26.5726805  9.553063    7.32660038  45.2838871
[134,]   32.5420868  8.491336   15.85446222  48.9847917
[135,]   20.4191931  8.048986    4.62808423  35.8451676
[136,]   10.5000993  8.325334   -6.13204434  26.3676215
[137,]   -1.9095944  9.256232  -20.22541910  16.2244985
[138,]   -9.9111881 10.671742  -31.20489357  10.8550860
[139,]   -8.7107819 12.407092  -33.35530677  15.4520816
[140,]   -9.8172756 14.346687  -38.50645413  18.2142037
[141,]   17.3616363 12.308495   -6.38564221  42.4195026
[142,]    2.5315485 10.616816  -18.19742473  23.6944049
[143,]  -20.0064392  9.208713  -38.31028262  -1.6256081
[144,]  -10.9357269  8.231032  -26.86354562   5.2171775
[145,]   14.8863853  7.846353   -0.92574953  30.2617168
[146,]    5.9341976  8.139196  -10.21439376  22.0709847
[147,]  -24.4874901  9.043984  -42.13032778  -6.7871772
[148,]   14.1566221 10.402243   -6.34385277  34.0919696
[149,]   -5.0297656 12.061739  -28.72000561  18.2599214
[150,]    9.8598466 13.915111  -17.75179141  36.4218525
[151,]   -0.6955894 13.291213  -25.37910039  25.9737976
[152,]   -6.7046063 11.367095  -27.81065630  15.8334927
[153,]  -17.5958233  9.724359  -35.79435026   1.4649257
[154,]  -31.2921402  8.527208  -47.76200132 -15.1613411
[155,]  -19.4963572  7.978798  -34.86638793  -4.4174555
[156,]   41.8915259  8.210174   26.00869938  57.8482632
[157,]  -36.4225911  9.162451  -53.90132139 -18.5401330
[158,]   14.7462920 10.643865   -6.05900155  35.2847838
[159,]   17.0552751 12.467198   -7.42433912  40.8156580
[160,]    8.8525581 14.504069  -19.85905592  36.7740759
[161,]   17.6423701 12.148337   -5.93488194  42.0839969
[162,]   10.7008094 10.414134   -9.89403731  31.6819837
[163,]    6.6529487  8.961029  -11.04500169  24.3459604
[164,]    1.0395880  7.944788  -14.09955450  16.5674031
[165,]  -11.0833727  7.544074  -25.19435198   3.7536707
[166,]  -15.2458334  7.853674  -30.34608771   0.4328785
[167,]  -49.9959941  8.798927  -67.15715885 -32.6270311
[168,]  -14.1351547 10.204694  -34.10132532   6.3125663
[169,]   22.5109846 11.908998   -0.92697737  46.2045745
[170,]   31.6955239 13.801683    4.64763109  58.8965297
[171,]    6.0118908 12.323182  -17.99138144  30.0458384
[172,]   -1.7416039 10.606953  -22.52714905  19.2531245
[173,]   10.5654015  9.182601   -7.24320762  28.8766949
[174,]   11.7844069  8.203590   -3.91468658  28.0226453
[175,]  -23.4903878  7.838601  -38.86206275  -7.9394319
[176,]    7.1288176  8.170341   -9.04134596  22.8208243
[177,]    0.1872230  9.123120  -17.97178373  17.8474216
[178,]   -2.8904716 10.529683  -23.82401779  17.6489146
[179,]   11.2155337 12.234507  -13.31238540  35.0568797
[180,]   -5.6183609 14.130043  -33.61540127  21.9603148</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.3
p_loo        19.3  3.2
looic      1769.7 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   651       
 (0.5, 0.7]   (ok)         1    0.6%   287       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.3 22.5
p_loo        34.4  8.5
looic      1722.7 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   976       
 (0.5, 0.7]   (ok)         7    3.9%   52        
   (0.7, 1]   (bad)        2    1.1%   27        
   (1, Inf)   (very bad)   1    0.6%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.5      11.9  
fit_sleep1 -92.0      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.3
p_loo        19.3  3.2
looic      1769.7 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   651       
 (0.5, 0.7]   (ok)         1    0.6%   287       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.3 22.5
p_loo        34.4  8.5
looic      1722.7 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   976       
 (0.5, 0.7]   (ok)         7    3.9%   52        
   (0.7, 1]   (bad)        2    1.1%   27        
   (1, Inf)   (very bad)   1    0.6%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.3     22.5        34.4    8.5   1722.7
fit_sleep2  -23.5      11.9  -884.9     14.3        19.3    3.2   1769.7
fit_sleep1  -92.0      21.2  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   45.1  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.073196e-40 6.081141e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.57      0.2     5.34       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.57    -3.27     2.96       5.19      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.1       rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.40            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.1          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.1         tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.5         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.6     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
