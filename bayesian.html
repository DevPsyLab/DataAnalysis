<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.69      6.78    15.31    42.08 1.00     1967     2121
sd(Days)                6.52      1.49     4.17    10.02 1.00     1784     2322
cor(Intercept,Days)     0.09      0.29    -0.46     0.67 1.00     1128     2026

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.64      7.32   237.23   266.00 1.00     1841     2232
Days         10.47      1.67     7.23    13.86 1.00     1495     1939

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.57    23.15    29.26 1.00     3539     2939

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0420  13.30796 227.9181 280.0853
309 211.6424  13.31565 185.1003 237.2802
310 213.0388  12.90388 187.5590 238.3132
330 274.5069  13.22319 249.1302 300.9733
331 273.0674  13.01380 247.9409 299.0784
332 260.2305  12.89810 235.5139 285.6869
333 267.9218  12.69162 243.2521 293.1740
334 244.1384  12.51564 219.2689 268.1643
335 250.8718  13.22016 224.7747 277.4807
337 286.1345  12.88940 260.6614 311.0810
349 227.0496  12.74223 201.6086 251.0821
350 238.7125  13.13923 213.0557 263.9738
351 256.0754  12.27466 232.0341 280.2412
352 271.7296  12.74723 246.9582 297.0902
369 254.7166  12.30511 230.5529 279.1929
370 226.3244  13.72278 198.6065 252.5247
371 252.1169  11.83201 228.9812 275.4708
372 263.5794  12.50737 239.3332 287.7091

, , Days

     Estimate Est.Error       Q2.5     Q97.5
308 19.590572  2.550086 14.6654517 24.521044
309  1.735623  2.504230 -3.1802488  6.773923
310  4.919676  2.438767  0.1548032  9.832435
330  5.734096  2.490152  0.7876624 10.423619
331  7.477171  2.495497  2.6047885 12.286146
332 10.235732  2.451150  5.3907620 15.125261
333 10.269363  2.424763  5.5161397 15.001518
334 11.573822  2.401110  6.9877375 16.393687
335 -0.294585  2.554642 -5.3563947  4.589264
337 19.142282  2.457791 14.3467155 23.944247
349 11.514640  2.441704  6.8980466 16.261688
350 16.985397  2.519755 12.0727602 21.931205
351  7.448242  2.394265  2.7359290 12.085777
352 14.048175  2.410066  9.1641972 18.762252
369 11.351085  2.322964  6.8139501 15.886270
370 15.190245  2.585719 10.2137196 20.227480
371  9.500227  2.313146  4.8909070 14.102641
372 11.754557  2.366276  7.0591103 16.429230</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0420 13.307956 227.9181 280.0853
  [2,] 273.6326 11.361525 251.5299 296.0630
  [3,] 293.2232  9.699108 274.0341 312.3576
  [4,] 312.8138  8.489230 296.3285 329.7268
  [5,] 332.4043  7.941487 317.1324 347.9328
  [6,] 351.9949  8.189829 335.8984 367.6710
  [7,] 371.5855  9.169801 353.5463 388.9425
  [8,] 391.1760 10.681905 370.2890 411.5017
  [9,] 410.7666 12.535023 385.9488 434.8185
 [10,] 430.3572 14.599876 401.3006 458.4707
 [11,] 211.6424 13.315646 185.1003 237.2802
 [12,] 213.3781 11.426602 190.6138 235.5182
 [13,] 215.1137  9.816841 195.4784 234.1974
 [14,] 216.8493  8.643832 200.0306 233.6243
 [15,] 218.5849  8.099607 203.1135 234.5867
 [16,] 220.3206  8.308656 204.6790 236.8974
 [17,] 222.0562  9.219883 204.1386 240.4953
 [18,] 223.7918 10.654626 202.8266 244.7096
 [19,] 225.5274 12.432948 200.8681 249.6648
 [20,] 227.2630 14.428364 198.3381 254.9342
 [21,] 213.0388 12.903884 187.5590 238.3132
 [22,] 217.9585 11.095019 196.5869 240.0549
 [23,] 222.8782  9.569943 204.6027 242.0431
 [24,] 227.7978  8.483122 211.2444 244.2669
 [25,] 232.7175  8.014867 217.3457 248.2919
 [26,] 237.6372  8.270912 221.6138 254.0248
 [27,] 242.5569  9.190922 224.7105 260.7290
 [28,] 247.4765 10.603456 227.0660 268.5069
 [29,] 252.3962 12.340530 228.6593 276.7577
 [30,] 257.3159 14.284231 230.0983 285.8016
 [31,] 274.5069 13.223193 249.1302 300.9733
 [32,] 280.2410 11.345767 258.5745 302.6119
 [33,] 285.9751  9.746885 267.0848 305.1682
 [34,] 291.7092  8.583636 274.6954 308.6446
 [35,] 297.4433  8.047210 281.2026 313.0171
 [36,] 303.1774  8.260634 286.9867 319.2238
 [37,] 308.9115  9.171711 290.8170 326.7936
 [38,] 314.6456 10.602085 294.3792 335.8499
 [39,] 320.3797 12.372948 296.7170 344.5593
 [40,] 326.1138 14.358872 298.1366 354.1516
 [41,] 273.0674 13.013797 247.9409 299.0784
 [42,] 280.5445 11.165519 258.8975 302.3841
 [43,] 288.0217  9.614246 269.2820 307.1413
 [44,] 295.4989  8.523711 278.8952 312.2937
 [45,] 302.9760  8.082609 287.6409 319.0012
 [46,] 310.4532  8.393957 294.3141 327.2064
 [47,] 317.9304  9.383147 299.9608 336.4410
 [48,] 325.4075 10.866619 304.5991 346.7256
 [49,] 332.8847 12.671952 308.1469 358.1636
 [50,] 340.3619 14.680883 311.3010 369.7770
 [51,] 260.2305 12.898099 235.5139 285.6869
 [52,] 270.4663 11.061453 249.3633 292.3201
 [53,] 280.7020  9.506145 262.2528 299.4383
 [54,] 290.9377  8.390120 274.3466 307.3834
 [55,] 301.1735  7.901754 285.7558 316.6591
 [56,] 311.4092  8.154606 295.4452 327.3713
 [57,] 321.6449  9.087010 303.9483 339.4463
 [58,] 331.8807 10.519800 311.6170 352.3840
 [59,] 342.1164 12.279043 318.0814 366.1412
 [60,] 352.3521 14.244293 324.4839 379.7353
 [61,] 267.9218 12.691620 243.2521 293.1740
 [62,] 278.1912 10.897230 257.2250 299.8211
 [63,] 288.4606  9.390474 270.2755 306.9756
 [64,] 298.7299  8.328944 282.9773 315.2142
 [65,] 308.9993  7.894339 293.7106 324.5236
 [66,] 319.2687  8.187113 303.2154 335.3873
 [67,] 329.5380  9.137615 311.5950 347.6012
 [68,] 339.8074 10.569870 318.8841 360.7006
 [69,] 350.0767 12.316950 325.4916 374.4528
 [70,] 360.3461 14.263636 331.9482 388.5475
 [71,] 244.1384 12.515645 219.2689 268.1643
 [72,] 255.7122 10.727239 234.2706 276.2092
 [73,] 267.2860  9.221530 249.0549 284.7743
 [74,] 278.8599  8.156607 262.2806 294.7534
 [75,] 290.4337  7.717157 275.1407 305.1219
 [76,] 302.0075  8.006839 286.3924 316.9595
 [77,] 313.5813  8.955170 296.3166 330.7432
 [78,] 325.1552 10.383224 304.7694 345.0865
 [79,] 336.7290 12.122635 312.8987 360.2988
 [80,] 348.3028 14.058303 320.6095 375.7687
 [81,] 250.8718 13.220161 224.7747 277.4807
 [82,] 250.5772 11.263028 228.4047 273.4542
 [83,] 250.2827  9.591212 231.4071 269.2675
 [84,] 249.9881  8.377307 233.3788 266.2825
 [85,] 249.6935  7.837066 234.2615 264.7886
 [86,] 249.3989  8.106315 233.6653 265.3812
 [87,] 249.1043  9.113587 231.7019 267.0066
 [88,] 248.8097 10.651525 228.0919 269.7883
 [89,] 248.5151 12.526168 223.9558 273.4727
 [90,] 248.2206 14.608463 219.6536 277.3480
 [91,] 286.1345 12.889405 260.6614 311.0810
 [92,] 305.2768 11.067745 283.4193 327.0243
 [93,] 324.4191  9.535968 305.3993 343.1794
 [94,] 343.5614  8.453158 326.7224 359.9872
 [95,] 362.7036  8.003657 346.7181 378.2721
 [96,] 381.8459  8.291119 364.9419 397.8916
 [97,] 400.9882  9.247067 382.4694 418.8138
 [98,] 420.1305 10.693704 398.9459 441.4455
 [99,] 439.2728 12.461294 414.9100 464.1567
[100,] 458.4150 14.432390 429.9550 486.7402
[101,] 227.0496 12.742228 201.6086 251.0821
[102,] 238.5642 10.900955 216.7079 259.4874
[103,] 250.0789  9.339224 231.3974 268.1309
[104,] 261.5935  8.217981 245.5283 277.5785
[105,] 273.1081  7.731310 258.0755 288.2762
[106,] 284.6228  7.995933 269.2287 300.1457
[107,] 296.1374  8.945421 278.9273 313.3065
[108,] 307.6521 10.393748 287.7440 327.5761
[109,] 319.1667 12.164016 295.9588 342.2870
[110,] 330.6813 14.135785 303.7322 357.4003
[111,] 238.7125 13.139226 213.0557 263.9738
[112,] 255.6979 11.223503 234.0702 277.2946
[113,] 272.6833  9.591305 254.1272 291.2987
[114,] 289.6687  8.409374 273.3427 306.4339
[115,] 306.6541  7.882915 291.5361 322.5679
[116,] 323.6395  8.140114 307.8185 339.9892
[117,] 340.6249  9.114872 323.0129 358.7819
[118,] 357.6103 10.611252 336.7539 378.7059
[119,] 374.5957 12.442458 350.2618 399.3846
[120,] 391.5811 14.482030 362.5625 420.3727
[121,] 256.0754 12.274657 232.0341 280.2412
[122,] 263.5236 10.543411 242.7059 284.2210
[123,] 270.9718  9.117282 252.6195 288.7285
[124,] 278.4201  8.157889 262.4272 294.3182
[125,] 285.8683  7.838526 270.4822 301.1045
[126,] 293.3166  8.234004 276.6503 309.2355
[127,] 300.7648  9.253117 282.0985 318.8523
[128,] 308.2131 10.719447 286.7878 329.3971
[129,] 315.6613 12.476294 291.2505 340.5085
[130,] 323.1095 14.417846 295.0329 351.7981
[131,] 271.7296 12.747229 246.9582 297.0902
[132,] 285.7778 10.963320 264.3832 307.5011
[133,] 299.8259  9.461170 281.1444 318.7200
[134,] 313.8741  8.393446 297.2909 330.7083
[135,] 327.9223  7.937441 312.4365 343.5898
[136,] 341.9705  8.195903 325.7284 358.1522
[137,] 356.0186  9.108212 338.3028 374.1042
[138,] 370.0668 10.505382 349.3406 391.1306
[139,] 384.1150 12.222251 360.0969 408.2272
[140,] 398.1632 14.142864 370.5659 425.7381
[141,] 254.7166 12.305113 230.5529 279.1929
[142,] 266.0677 10.612409 245.5759 287.4256
[143,] 277.4188  9.199074 259.6310 295.7494
[144,] 288.7699  8.210665 273.2313 305.3581
[145,] 300.1210  7.810212 284.8787 315.6211
[146,] 311.4721  8.085551 295.5132 327.6812
[147,] 322.8232  8.974696 305.2416 340.8024
[148,] 334.1742 10.320201 313.6799 354.4155
[149,] 345.5253 11.969137 321.8730 369.0770
[150,] 356.8764 13.813264 329.4498 384.2842
[151,] 226.3244 13.722777 198.6065 252.5247
[152,] 241.5146 11.701987 217.8788 263.8015
[153,] 256.7048  9.946370 236.7772 275.2981
[154,] 271.8951  8.619509 254.5996 288.2290
[155,] 287.0853  7.939362 271.6015 302.6914
[156,] 302.2756  8.071115 286.8837 318.0280
[157,] 317.4658  8.979098 299.9036 334.9387
[158,] 332.6561 10.463145 311.7995 353.2092
[159,] 347.8463 12.316756 323.2463 371.8211
[160,] 363.0366 14.397897 334.4696 390.6277
[161,] 252.1169 11.832008 228.9812 275.4708
[162,] 261.6171 10.199736 241.3841 281.4332
[163,] 271.1174  8.875478 253.3961 288.3729
[164,] 280.6176  8.013420 264.7938 296.4953
[165,] 290.1178  7.768976 274.8251 305.3610
[166,] 299.6180  8.197583 283.8088 315.2529
[167,] 309.1183  9.205706 291.3915 326.8361
[168,] 318.6185 10.629722 298.1333 339.3326
[169,] 328.1187 12.326323 304.1845 352.1835
[170,] 337.6189 14.198126 310.1095 365.7182
[171,] 263.5794 12.507371 239.3332 287.7091
[172,] 275.3340 10.805491 254.2774 296.2761
[173,] 287.0885  9.395822 268.7369 305.0651
[174,] 298.8431  8.426317 282.1212 314.9480
[175,] 310.5976  8.057463 294.6578 326.2525
[176,] 322.3522  8.369056 306.0405 338.7105
[177,] 334.1068  9.292902 316.1626 352.2965
[178,] 345.8613 10.671151 325.0691 366.7620
[179,] 357.6159 12.352629 333.4633 381.8610
[180,] 369.3704 14.230247 341.6828 397.3297</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.4820428 13.307956 -3.052533e+01  21.6418996
  [2,]  -14.9279146 11.361525 -3.735830e+01   7.1747731
  [3,]  -42.4225863  9.699108 -6.155702e+01 -23.2335127
  [4,]    8.6260419  8.489230 -8.286979e+00  25.1113198
  [5,]   24.4475702  7.941487  8.919056e+00  39.7194924
  [6,]   62.6951984  8.189829  4.701907e+01  78.7916630
  [7,]   10.6183267  9.169801 -6.738663e+00  28.6574790
  [8,] -101.0274451 10.681905 -1.213531e+02 -80.1403668
  [9,]   19.8186832 12.535023 -4.233206e+00  44.6365025
 [10,]   35.9963114 14.599876  7.882813e+00  65.0529454
 [11,]   11.0914579 13.315646 -1.454634e+01  37.6335779
 [12,]   -8.1122646 11.426602 -3.025235e+01  14.6520472
 [13,]  -12.1358872  9.816841 -3.121960e+01   7.4994141
 [14,]  -12.1423098  8.643832 -2.891734e+01   4.6763821
 [15,]  -10.8688323  8.099607 -2.687059e+01   4.6025923
 [16,]   -4.3587549  8.308656 -2.093561e+01  11.2827944
 [17,]   -8.4258774  9.219883 -2.686503e+01   9.4917263
 [18,]   -6.0646000 10.654626 -2.698241e+01  14.9006453
 [19,]   -1.2317225 12.432948 -2.536915e+01  23.4276064
 [20,]   10.0511549 14.428364 -1.761998e+01  38.9760809
 [21,]  -13.9849202 12.903884 -3.925934e+01  11.4949091
 [22,]  -23.6262957 11.095019 -4.572272e+01  -2.2547197
 [23,]   11.4418288  9.569943 -7.723128e+00  29.7172917
 [24,]    5.0437533  8.483122 -1.142534e+01  21.5971560
 [25,]   -3.4101223  8.014867 -1.898453e+01  11.9616518
 [26,]  -17.1792978  8.270912 -3.356686e+01  -1.1559261
 [27,]   -7.1360733  9.190922 -2.530816e+01  10.7103191
 [28,]    8.2745512 10.603456 -1.275584e+01  28.6851039
 [29,]    8.6162757 12.340530 -1.574524e+01  32.3531639
 [30,]   -9.8005998 14.284231 -3.828631e+01  17.4170164
 [31,]   47.0357067 13.223193  2.056929e+01  72.4124079
 [32,]   20.1592104 11.345767 -2.211700e+00  41.8256596
 [33,]   -2.1185859  9.746885 -2.131166e+01  16.7717379
 [34,]   -6.5761822  8.583636 -2.351163e+01  10.4376366
 [35,]  -11.6459785  8.047210 -2.721979e+01   4.5946802
 [36,]   -5.5918749  8.260634 -2.163828e+01  10.5988280
 [37,]  -28.6718712  9.171711 -4.655396e+01 -10.5774399
 [38,]    3.6157325 10.602085 -1.758864e+01  23.8820514
 [39,]  -15.0301638 12.372948 -3.920980e+01   8.6324810
 [40,]   27.9349399 14.358872 -1.029378e-01  55.9121484
 [41,]   14.5405477 13.013797 -1.147045e+01  39.6669969
 [42,]    4.4554766 11.165519 -1.738411e+01  26.1024628
 [43,]   13.7989056  9.614246 -5.320716e+00  32.5386066
 [44,]   24.6164345  8.523711  7.821560e+00  41.2200960
 [45,]   13.3012635  8.082609 -2.723907e+00  28.6364187
 [46,]  -17.1345076  8.393957 -3.388770e+01  -0.9954463
 [47,]  -27.8553786  9.383147 -4.636600e+01  -9.8857956
 [48,]    9.4101503 10.866619 -1.190789e+01  30.2185869
 [49,]  -39.1378207 12.671952 -6.441673e+01 -14.4000488
 [50,]   31.2192082 14.680883  1.804131e+00  60.2801212
 [51,]  -25.3699304 12.898099 -5.082628e+01  -0.6533044
 [52,]  -27.6544623 11.061453 -4.950829e+01  -6.5515324
 [53,]   -7.7406942  9.506145 -2.647695e+01  10.7085309
 [54,]   18.8310739  8.390120  2.385390e+00  35.4222335
 [55,]   16.2894420  7.901754  8.038377e-01  31.7070674
 [56,]   -1.4115899  8.154606 -1.737373e+01  14.5523735
 [57,]  132.5169782  9.087010  1.147156e+02 150.2136264
 [58,]   14.9504463 10.519800 -5.552858e+00  35.2141015
 [59,]  -11.8160856 12.279043 -3.584094e+01  12.2188546
 [60,]  -98.4877175 14.244293 -1.258709e+02 -70.6194775
 [61,]   15.9205631 12.691620 -9.331564e+00  40.5902928
 [62,]   11.3637999 10.897230 -1.026608e+01  32.3300260
 [63,]  -11.6912634  9.390474 -3.020629e+01   6.4937508
 [64,]    1.0797734  8.328944 -1.540451e+01  16.8324038
 [65,]  -11.8282899  7.894339 -2.735263e+01   3.4604197
 [66,]   18.8978469  8.187113  2.779174e+00  34.9510854
 [67,]    2.4884836  9.137615 -1.557474e+01  20.4315395
 [68,]    9.0325203 10.569870 -1.186069e+01  29.9558114
 [69,]  -16.7167429 12.316950 -4.109283e+01   7.8683900
 [70,]    1.6966938 14.263636 -2.650468e+01  30.0946491
 [71,]   21.3347012 12.515645 -2.691194e+00  46.2042329
 [72,]   20.4889795 10.727239 -8.027132e-03  41.9306138
 [73,]  -23.9213422  9.221530 -4.140964e+01  -5.6902007
 [74,]  -24.1875639  8.156607 -4.008109e+01  -7.6082904
 [75,]  -11.4092856  7.717157 -2.609746e+01   3.8837461
 [76,]  -17.8163073  8.006839 -3.276830e+01  -2.2012089
 [77,]   -8.0565290  8.955170 -2.521844e+01   9.2082119
 [78,]    6.3677493 10.383224 -1.356357e+01  26.7535306
 [79,]   -0.9820724 12.122635 -2.455186e+01  22.8482033
 [80,]   28.9962059 14.058303  1.530305e+00  56.6894633
 [81,]   -9.2635270 13.220161 -3.587242e+01  16.8336229
 [82,]   23.3699580 11.263028  4.930435e-01  45.5424641
 [83,]    4.2080430  9.591212 -1.477682e+01  23.0836063
 [84,]   20.8140280  8.377307  4.519646e+00  37.4233347
 [85,]    1.7584131  7.837066 -1.333670e+01  17.1904071
 [86,]    5.2372981  8.106315 -1.074502e+01  20.9708711
 [87,]   -3.6520169  9.113587 -2.155427e+01  13.7504291
 [88,]  -13.4987319 10.651525 -3.447730e+01   7.2191205
 [89,]  -12.7610468 12.526168 -3.771863e+01  11.7983269
 [90,]  -10.9739618 14.608463 -4.010136e+01  17.5930388
 [91,]   26.2320899 12.889405  1.285587e+00  51.7052348
 [92,]    8.5290082 11.067745 -1.321853e+01  30.3864512
 [93,]  -32.8078735  9.535968 -5.156816e+01 -13.7880531
 [94,]    2.5608448  8.453158 -1.386499e+01  19.3997625
 [95,]    3.0287631  8.003657 -1.253973e+01  19.0142710
 [96,]    9.9925814  8.291119 -6.053090e+00  26.8965921
 [97,]    3.2718998  9.247067 -1.455372e+01  21.7906714
 [98,]   -3.4381819 10.693704 -2.475325e+01  17.7464083
 [99,]   16.5915364 12.461294 -8.292391e+00  40.9543297
[100,]    0.5016547 14.432390 -2.782353e+01  28.9616997
[101,]    9.0536183 12.742228 -1.497890e+01  34.4946483
[102,]   -8.2475219 10.900955 -2.917074e+01  13.6087895
[103,]  -11.1532621  9.339224 -2.920534e+01   7.5282223
[104,]   -6.6715023  8.217981 -2.265655e+01   9.3937262
[105,]  -22.3978425  7.731310 -3.756594e+01  -7.3651733
[106,]  -14.8483827  7.995933 -3.037131e+01   0.5456614
[107,]  -14.5726229  8.945421 -3.174170e+01   2.6374965
[108,]    0.4499369 10.393748 -1.947408e+01  20.3580127
[109,]   17.1138966 12.164016 -6.006395e+00  40.3218307
[110,]   20.9637564 14.135785 -5.755169e+00  47.9128520
[111,]   17.5842624 13.139226 -7.677041e+00  43.2410748
[112,]  -12.2436341 11.223503 -3.384029e+01   9.3840702
[113,]  -16.4787307  9.591305 -3.509409e+01   2.0774320
[114,]  -34.1416272  8.409374 -5.090676e+01 -17.8155941
[115,]  -37.7376237  7.882915 -5.365140e+01 -22.6196487
[116,]    6.0851798  8.140114 -1.026445e+01  21.9061996
[117,]   38.8195832  9.114872  2.066264e+01  56.4316315
[118,]    5.3080867 10.611252 -1.578753e+01  26.1645465
[119,]   19.8914902 12.442458 -4.897434e+00  44.2253564
[120,]   -2.5284063 14.482030 -3.132001e+01  26.4902410
[121,]   -5.5488567 12.274657 -2.971470e+01  18.4923715
[122,]   36.5340011 10.543411  1.583661e+01  57.3517103
[123,]   -1.0779411  9.117282 -1.883463e+01  17.2744337
[124,]    2.1690167  8.157889 -1.372908e+01  18.1618966
[125,]  -14.0409255  7.838526 -2.927708e+01   1.3451920
[126,]   11.3170323  8.234004 -4.601949e+00  27.9832970
[127,]  -13.0182099  9.253117 -3.110571e+01   5.6481024
[128,]  -41.6175521 10.719447 -6.280164e+01 -20.1923450
[129,]    5.8805057 12.476294 -1.896668e+01  30.2912944
[130,]   24.4559635 14.417846 -4.232557e+00  52.5325609
[131,]  -50.0524803 12.747229 -7.541313e+01 -25.2810620
[132,]   12.4161449 10.963320 -9.307242e+00  33.8107069
[133,]   27.0525701  9.461170  8.158473e+00  45.7341456
[134,]   32.9813952  8.393446  1.614723e+01  49.5646360
[135,]   20.8179204  7.937441  5.150358e+00  36.3037055
[136,]   10.8582456  8.195903 -5.323474e+00  27.1003307
[137,]   -1.5920293  9.108212 -1.967764e+01  16.1237998
[138,]   -9.6342041 10.505382 -3.069795e+01  11.0919944
[139,]   -8.4743789 12.222251 -3.258660e+01  15.5437122
[140,]   -9.6214538 14.142864 -3.719639e+01  17.9757653
[141,]   17.2068544 12.305113 -7.269406e+00  41.3706413
[142,]    2.3691696 10.612409 -1.898873e+01  22.8609750
[143,]  -20.1764152  9.199074 -3.850699e+01  -2.3885547
[144,]  -11.1133000  8.210665 -2.770146e+01   4.4252822
[145,]   14.7012153  7.810212 -7.989426e-01  29.9435287
[146,]    5.7414305  8.085551 -1.046766e+01  21.7002538
[147,]  -24.6878543  8.974696 -4.266708e+01  -7.1063479
[148,]   13.9486609 10.320201 -6.292597e+00  34.4430467
[149,]   -5.2453238 11.969137 -2.879698e+01  18.4070014
[150,]    9.6366914 13.813264 -1.777107e+01  37.0633186
[151,]   -1.0603598 13.722777 -2.726066e+01  26.6574521
[152,]   -6.9911047 11.701987 -2.927800e+01  16.6446706
[153,]  -17.8040497  9.946370 -3.639730e+01   2.1236122
[154,]  -31.4220946  8.619509 -4.775595e+01 -14.1266040
[155,]  -19.5480396  7.939362 -3.515410e+01  -4.0642197
[156,]   41.9181155  8.071115  2.616570e+01  57.3100312
[157,]  -36.3177294  8.979098 -5.379061e+01 -18.7554561
[158,]   14.9294256 10.463145 -5.623705e+00  35.7860100
[159,]   17.3166807 12.316756 -6.658074e+00  41.9166501
[160,]    9.1922357 14.397897 -1.839892e+01  37.7591572
[161,]   17.7635031 11.832008 -5.590446e+00  40.8992033
[162,]   10.8256757 10.199736 -8.990401e+00  31.0587362
[163,]    6.7815482  8.875478 -1.047397e+01  24.5028372
[164,]    1.1719207  8.013420 -1.470580e+01  16.9957319
[165,]  -10.9473067  7.768976 -2.619047e+01   4.3453716
[166,]  -15.1060342  8.197583 -3.074091e+01   0.7031641
[167,]  -49.8524616  9.205706 -6.757032e+01 -32.1257480
[168,]  -13.9878891 10.629722 -3.470201e+01   6.4973308
[169,]   22.6619835 12.326323 -1.402797e+00  46.5962158
[170,]   31.8502560 14.198126  3.750969e+00  59.3597358
[171,]    5.8322777 12.507371 -1.829740e+01  30.0784566
[172,]   -1.8599789 10.805491 -2.280211e+01  19.1965905
[173,]   10.5082645  9.395822 -7.468258e+00  28.8598719
[174,]   11.7885078  8.426317 -4.316382e+00  28.5104294
[175,]  -23.4250488  8.057463 -3.907986e+01  -7.4851864
[176,]    7.2553946  8.369056 -9.102942e+00  23.5670683
[177,]    0.3750380  9.292902 -1.781472e+01  18.3192055
[178,]   -2.6414186 10.671151 -2.354208e+01  18.1507659
[179,]   11.5258247 12.352629 -1.271926e+01  35.6784471
[180,]   -5.2468319 14.230247 -3.320605e+01  22.4408171</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.3
p_loo        19.2  3.2
looic      1769.6 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   588       
 (0.5, 0.7]   (ok)         1    0.6%   212       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.4
p_loo        34.8  8.8
looic      1723.4 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   944       
 (0.5, 0.7]   (ok)         4    2.2%   356       
   (0.7, 1]   (bad)        3    1.7%   60        
   (1, Inf)   (very bad)   1    0.6%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.1      11.8  
fit_sleep1 -91.7      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.3
p_loo        19.2  3.2
looic      1769.6 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   588       
 (0.5, 0.7]   (ok)         1    0.6%   212       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.4
p_loo        34.8  8.8
looic      1723.4 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   944       
 (0.5, 0.7]   (ok)         4    2.2%   356       
   (0.7, 1]   (bad)        3    1.7%   60        
   (1, Inf)   (very bad)   1    0.6%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.7     22.4        34.8    8.8   1723.4
fit_sleep2  -23.1      11.8  -884.8     14.3        19.2    3.2   1769.6
fit_sleep1  -91.7      21.1  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.9  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.506482e-40 9.034668e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.85      1.59     0.21      5.4       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.15      1.59    -3.38     2.88       5.44      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.15      
[4] StanHeaders_2.26.15 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.0         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
