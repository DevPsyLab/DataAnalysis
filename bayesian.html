<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.75      6.98    15.60    43.34 1.00     1989     2343
sd(Days)                6.56      1.52     4.17    10.10 1.00     1435     1787
cor(Intercept,Days)     0.07      0.30    -0.49     0.67 1.00      891     1185

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   250.83      7.43   236.19   265.72 1.00     1832     2364
Days         10.53      1.73     7.04    13.80 1.00     1505     2036

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.95      1.57    23.07    29.16 1.00     3411     2683

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6019  12.81384 228.4266 278.1589
309 211.8855  13.27897 186.0339 237.5468
310 213.2193  13.41675 186.4671 239.7341
330 274.1330  13.56156 247.8977 300.7510
331 273.0997  13.09593 247.4752 298.8516
332 260.1616  12.31330 236.0405 284.0523
333 267.8801  12.57926 244.0176 293.1075
334 244.3711  12.60727 218.8826 268.6801
335 250.6285  13.49132 223.6938 276.9561
337 285.6724  13.21921 259.9077 312.1366
349 226.5689  13.07955 200.4574 251.1714
350 238.7643  13.08440 212.2421 263.7120
351 255.7480  12.38106 232.3698 280.8007
352 272.1870  12.54224 248.5696 296.9161
369 254.6562  12.06900 231.5527 278.1528
370 226.2703  13.41635 199.5609 251.5804
371 252.4262  12.26646 228.2233 276.5214
372 263.5559  12.44365 238.3315 288.1432

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6727841  2.462528 14.90488821 24.545555
309  1.7458759  2.491199 -3.21011224  6.507735
310  4.8823630  2.494409 -0.01028825  9.804334
330  5.8085810  2.588109  0.78689131 10.742688
331  7.4718718  2.452439  2.58428110 12.246393
332 10.2354315  2.357270  5.63138213 14.830899
333 10.3282912  2.391118  5.56474648 14.885517
334 11.5017029  2.408107  6.76076241 16.228682
335 -0.1988599  2.634644 -5.45496377  4.999356
337 19.2263905  2.532411 14.29275915 24.124771
349 11.5997609  2.491855  6.84828658 16.513209
350 16.9474760  2.515118 12.02814336 22.047087
351  7.4954623  2.402097  2.82130468 12.167548
352 13.9958232  2.378699  9.29246069 18.609412
369 11.3096293  2.342527  6.72118327 15.856991
370 15.2150960  2.512980 10.26067051 20.233848
371  9.4209950  2.332992  4.71425069 13.943989
372 11.7454465  2.376002  7.05115984 16.470581</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6019 12.813839 228.4266 278.1589
  [2,] 273.2747 10.971842 251.6535 294.4151
  [3,] 292.9475  9.417868 274.5392 310.8006
  [4,] 312.6203  8.315001 296.3997 328.5201
  [5,] 332.2931  7.855593 316.4775 347.1537
  [6,] 351.9659  8.149203 336.0618 367.5325
  [7,] 371.6386  9.123419 353.4151 388.7081
  [8,] 391.3114 10.592079 369.9267 411.3474
  [9,] 410.9842 12.380451 386.2293 434.3260
 [10,] 430.6570 14.369659 401.8565 458.2545
 [11,] 211.8855 13.278970 186.0339 237.5468
 [12,] 213.6314 11.383147 191.4434 235.9816
 [13,] 215.3773  9.758748 195.9768 234.3017
 [14,] 217.1231  8.561684 200.0530 233.3843
 [15,] 218.8690  7.986479 203.1490 234.1843
 [16,] 220.6149  8.165624 204.7332 236.7143
 [17,] 222.3608  9.054453 204.7457 240.2794
 [18,] 224.1066 10.473823 203.4458 245.0241
 [19,] 225.8525 12.240546 201.7292 250.2449
 [20,] 227.5984 14.225791 199.2853 255.9480
 [21,] 213.2193 13.416746 186.4671 239.7341
 [22,] 218.1016 11.520670 195.3061 240.7979
 [23,] 222.9840  9.893773 203.1908 242.1963
 [24,] 227.8663  8.688602 210.7125 244.3960
 [25,] 232.7487  8.095740 216.9281 248.5136
 [26,] 237.6311  8.248294 221.6453 254.0475
 [27,] 242.5134  9.108888 224.7878 260.3462
 [28,] 247.3958 10.504927 226.8933 267.8098
 [29,] 252.2782 12.254766 228.3466 276.2143
 [30,] 257.1605 14.228465 229.1697 284.8965
 [31,] 274.1330 13.561557 247.8977 300.7510
 [32,] 279.9416 11.561624 257.7677 302.7500
 [33,] 285.7502  9.839872 267.0212 305.1476
 [34,] 291.5588  8.565724 275.0785 308.5425
 [35,] 297.3673  7.957185 281.4707 313.0443
 [36,] 303.1759  8.164471 287.1119 319.4077
 [37,] 308.9845  9.132196 291.1571 326.7047
 [38,] 314.7931 10.655141 294.2118 335.2307
 [39,] 320.6017 12.532505 296.2055 344.8435
 [40,] 326.4102 14.628464 298.0758 354.5511
 [41,] 273.0997 13.095928 247.4752 298.8516
 [42,] 280.5716 11.269764 258.5298 303.3007
 [43,] 288.0435  9.723207 269.0457 307.1478
 [44,] 295.5153  8.608301 278.6890 312.8084
 [45,] 302.9872  8.105174 287.2594 319.0179
 [46,] 310.4591  8.325488 294.2929 326.9593
 [47,] 317.9309  9.217514 299.9274 336.2999
 [48,] 325.4028 10.613214 304.6022 346.3466
 [49,] 332.8747 12.342891 308.6092 357.1057
 [50,] 340.3466 14.285745 312.3314 367.9079
 [51,] 260.1616 12.313296 236.0405 284.0523
 [52,] 270.3970 10.597894 249.5991 290.5323
 [53,] 280.6324  9.172071 262.2988 298.0148
 [54,] 290.8679  8.188520 274.6875 306.5216
 [55,] 301.1033  7.816028 285.5953 316.2483
 [56,] 311.3387  8.138929 295.5345 327.3714
 [57,] 321.5742  9.083363 303.5776 339.7374
 [58,] 331.8096 10.482664 310.7487 352.6899
 [59,] 342.0450 12.181069 317.6866 366.1002
 [60,] 352.2804 14.070682 324.6832 379.6001
 [61,] 267.8801 12.579258 244.0176 293.1075
 [62,] 278.2084 10.780387 257.7773 299.8142
 [63,] 288.5367  9.253683 270.9969 306.8786
 [64,] 298.8650  8.153492 283.4012 315.1956
 [65,] 309.1933  7.665709 294.5205 324.2295
 [66,] 319.5216  7.904534 304.0410 335.0777
 [67,] 329.8499  8.811078 312.8387 347.2638
 [68,] 340.1782 10.208987 320.3520 360.1333
 [69,] 350.5064 11.926720 327.3512 374.0633
 [70,] 360.8347 13.845748 333.9719 388.2004
 [71,] 244.3711 12.607267 218.8826 268.6801
 [72,] 255.8728 10.826891 233.8879 276.8492
 [73,] 267.3746  9.332627 248.1046 285.6333
 [74,] 278.8763  8.280837 261.7233 294.9809
 [75,] 290.3780  7.851404 274.6941 305.7684
 [76,] 301.8797  8.143390 285.4688 317.8605
 [77,] 313.3814  9.087519 295.6478 331.3166
 [78,] 324.8831 10.509480 304.1831 345.4265
 [79,] 336.3848 12.243909 312.1995 360.1511
 [80,] 347.8865 14.176580 319.3309 375.6958
 [81,] 250.6285 13.491319 223.6938 276.9561
 [82,] 250.4297 11.480452 227.5721 273.1009
 [83,] 250.2308  9.770801 230.6664 269.5060
 [84,] 250.0319  8.545117 232.9290 266.7621
 [85,] 249.8331  8.028212 233.9262 265.7078
 [86,] 249.6342  8.352728 233.0983 266.1211
 [87,] 249.4354  9.432212 230.8829 268.3824
 [88,] 249.2365 11.047528 227.0482 271.0843
 [89,] 249.0376 13.000455 222.7326 274.3382
 [90,] 248.8388 15.161084 218.0203 278.2546
 [91,] 285.6724 13.219208 259.9077 312.1366
 [92,] 304.8988 11.291081 283.2016 327.7919
 [93,] 324.1252  9.646543 305.4673 343.4569
 [94,] 343.3516  8.452768 326.7879 360.0340
 [95,] 362.5780  7.916375 346.6646 377.8519
 [96,] 381.8044  8.167920 365.4968 397.5709
 [97,] 401.0308  9.142596 382.9567 418.6607
 [98,] 420.2572 10.643562 399.3636 440.9090
 [99,] 439.4836 12.482387 415.0716 463.3553
[100,] 458.7100 14.531372 430.2581 486.5613
[101,] 226.5689 13.079549 200.4574 251.1714
[102,] 238.1687 11.209872 216.0887 259.5840
[103,] 249.7684  9.626345 230.6664 267.9432
[104,] 261.3682  8.490612 244.6397 277.7507
[105,] 272.9679  7.995821 256.8881 288.2990
[106,] 284.5677  8.257996 267.7936 300.5260
[107,] 296.1675  9.212737 277.7176 313.6834
[108,] 307.7672 10.675825 286.6415 328.2122
[109,] 319.3670 12.469588 295.1923 342.8184
[110,] 330.9667 14.471582 303.1701 358.2451
[111,] 238.7643 13.084402 212.2421 263.7120
[112,] 255.7118 11.190111 233.3826 277.3388
[113,] 272.6593  9.585782 253.7244 291.1122
[114,] 289.6067  8.438453 272.6350 305.8003
[115,] 306.5542  7.948546 291.1036 322.2423
[116,] 323.5017  8.234253 307.7352 340.2578
[117,] 340.4492  9.223779 322.6568 359.2899
[118,] 357.3966 10.724033 336.3993 378.7580
[119,] 374.3441 12.553220 349.5986 399.4458
[120,] 391.2916 14.588125 362.8057 420.5284
[121,] 255.7480 12.381058 232.3698 280.8007
[122,] 263.2434 10.616039 243.1853 284.6476
[123,] 270.7389  9.146043 253.2346 289.0191
[124,] 278.2343  8.132654 262.5159 294.5583
[125,] 285.7298  7.756942 270.6645 301.2598
[126,] 293.2253  8.108045 277.5878 309.5407
[127,] 300.7207  9.102240 282.8459 318.5245
[128,] 308.2162 10.559417 287.7627 328.8310
[129,] 315.7117 12.316328 292.4495 339.9988
[130,] 323.2071 14.262634 296.1684 351.4398
[131,] 272.1870 12.542239 248.5696 296.9161
[132,] 286.1828 10.808561 265.4905 307.4644
[133,] 300.1786  9.362619 282.3974 318.8208
[134,] 314.1744  8.355161 298.0057 331.0484
[135,] 328.1703  7.954572 312.5991 344.1301
[136,] 342.1661  8.249735 325.7867 358.5929
[137,] 356.1619  9.173738 338.3903 374.8849
[138,] 370.1577 10.562824 349.3970 391.3453
[139,] 384.1536 12.259911 360.2361 408.5987
[140,] 398.1494 14.154647 370.2323 426.3985
[141,] 254.6562 12.068996 231.5527 278.1528
[142,] 265.9658 10.369615 245.9539 286.2421
[143,] 277.2755  8.965046 259.7894 294.6679
[144,] 288.5851  8.011868 272.7759 304.2927
[145,] 299.8947  7.680031 284.4979 314.9156
[146,] 311.2044  8.046775 294.9877 327.0803
[147,] 322.5140  9.027356 304.7232 340.1717
[148,] 333.8236 10.450387 313.1454 354.1282
[149,] 345.1332 12.161533 321.1041 368.9960
[150,] 356.4429 14.055961 328.5837 383.7112
[151,] 226.2703 13.416351 199.5609 251.5804
[152,] 241.4854 11.503730 218.6243 263.6083
[153,] 256.7005  9.864243 237.3008 275.6027
[154,] 271.9156  8.654530 255.2660 288.5728
[155,] 287.1307  8.070231 271.9354 303.0113
[156,] 302.3458  8.245394 286.4982 318.5557
[157,] 317.5609  9.136440 299.6851 335.4395
[158,] 332.7760 10.563744 311.8680 353.2587
[159,] 347.9911 12.342648 323.5250 372.1418
[160,] 363.2062 14.342921 335.0240 391.0581
[161,] 252.4262 12.266460 228.2233 276.5214
[162,] 261.8472 10.578268 241.0517 282.3888
[163,] 271.2682  9.177101 253.0231 289.0213
[164,] 280.6892  8.211230 264.4557 296.5420
[165,] 290.1102  7.843157 274.3193 305.2999
[166,] 299.5312  8.154240 283.4194 315.2135
[167,] 308.9522  9.074902 291.0771 326.6460
[168,] 318.3732 10.445179 297.7789 338.8188
[169,] 327.7942 12.113438 303.9034 351.3103
[170,] 337.2152 13.973357 309.6548 364.7059
[171,] 263.5559 12.443654 238.3315 288.1432
[172,] 275.3013 10.711655 253.2014 296.2546
[173,] 287.0468  9.269593 268.2838 305.1383
[174,] 298.7922  8.270546 282.2657 314.9249
[175,] 310.5377  7.884750 294.8600 325.9044
[176,] 322.2831  8.199232 305.8259 338.1750
[177,] 334.0286  9.142007 316.1124 351.7952
[178,] 345.7740 10.545897 325.2234 366.5960
[179,] 357.5195 12.253423 333.3356 381.7346
[180,] 369.2649 14.155125 341.4236 397.4033</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.0419311 12.813839  -28.59890748  21.1333888
  [2,]  -14.5700152 10.971842  -35.71044332   7.0511996
  [3,]  -42.1468993  9.417868  -60.00002906 -23.7385920
  [4,]    8.8195167  8.315001   -7.08026639  25.0401384
  [5,]   24.5588326  7.855593    9.69816309  40.3743691
  [6,]   62.7242485  8.149203   47.15761835  78.6283058
  [7,]   10.5651645  9.123419   -6.50430288  28.7886971
  [8,] -101.1628196 10.592079 -121.19875337 -79.7781430
  [9,]   19.6010963 12.380451   -3.74067415  44.3559966
 [10,]   35.6965123 14.369659    8.09898635  64.4969918
 [11,]   10.8483891 13.278970  -14.81293352  36.7000071
 [12,]   -8.3655868 11.383147  -30.71580104  13.8223773
 [13,]  -12.3994627  9.758748  -31.32392843   7.0009709
 [14,]  -12.4161386  8.561684  -28.67734405   4.6539537
 [15,]  -11.1529146  7.986479  -26.46817557   4.5671404
 [16,]   -4.6530905  8.165624  -20.75252042  11.2285524
 [17,]   -8.7304664  9.054453  -26.64910062   8.8845741
 [18,]   -6.3794423 10.473823  -27.29694303  14.2813914
 [19,]   -1.5568182 12.240546  -25.94919470  22.5665158
 [20,]    9.7158058 14.225791  -18.63376937  38.0288681
 [21,]  -14.1653583 13.416746  -40.68016831  12.5867796
 [22,]  -23.7694213 11.520670  -46.46570603  -0.9739279
 [23,]   11.3360158  9.893773   -7.87631511  31.1291729
 [24,]    4.9752528  8.688602  -11.55443115  22.1291017
 [25,]   -3.4413102  8.095740  -19.20615628  12.3792933
 [26,]  -17.1731732  8.248294  -33.58960202  -1.1874328
 [27,]   -7.0926362  9.108888  -24.92537392  10.6330447
 [28,]    8.3553008 10.504927  -12.05871941  28.8578339
 [29,]    8.7343378 12.254766  -15.20175919  32.6659218
 [30,]   -9.6452252 14.228465  -37.38115112  18.3456133
 [31,]   47.4095876 13.561557   20.79158793  73.6448623
 [32,]   20.4586067 11.561624   -2.34983884  42.6325125
 [33,]   -1.8936743  9.839872  -21.29113936  16.8353059
 [34,]   -6.4257553  8.565724  -23.40950730  10.0545248
 [35,]  -11.5700363  7.957185  -27.24695605   4.3266233
 [36,]   -5.5904173  8.164471  -21.82222066  10.4736411
 [37,]  -28.7448983  9.132196  -46.46510877 -10.9174653
 [38,]    3.4682207 10.655141  -16.96941261  24.0494595
 [39,]  -15.2521602 12.532505  -39.49399748   9.1439663
 [40,]   27.6384588 14.628464   -0.50244731  55.9729382
 [41,]   14.5081933 13.095928  -11.24371674  40.1326797
 [42,]    4.4284215 11.269764  -18.30068323  26.4702022
 [43,]   13.7771497  9.723207   -5.32723028  32.7749303
 [44,]   24.5999779  8.608301    7.30687053  41.4262873
 [45,]   13.2901061  8.105174   -2.74063272  29.0178813
 [46,]  -17.1403657  8.325488  -33.64064755  -0.9742049
 [47,]  -27.8559375  9.217514  -46.22493588  -9.8523813
 [48,]    9.4148907 10.613214  -11.52892514  30.2155190
 [49,]  -39.1277811 12.342891  -63.35882915 -14.8622783
 [50,]   31.2345471 14.285745    3.67320935  59.2497305
 [51,]  -25.3009640 12.313296  -49.19166767  -1.1799467
 [52,]  -27.5851954 10.597894  -47.72052059  -6.7873386
 [53,]   -7.6711269  9.172071  -25.05347939  10.6624925
 [54,]   18.9009416  8.188520    3.24719542  35.0813080
 [55,]   16.3596102  7.816028    1.21464012  31.8676071
 [56,]   -1.3411213  8.138929  -17.37381094  14.4631082
 [57,]  132.5877472  9.083363  114.42447650 150.5842786
 [58,]   15.0215158 10.482664   -5.85878134  36.0824258
 [59,]  -11.7447157 12.181069  -35.79991432  12.6136509
 [60,]  -98.4160472 14.070682 -125.73567042 -70.8188148
 [61,]   15.9622810 12.579258   -9.26512056  39.8248064
 [62,]   11.3465898 10.780387  -10.25923317  31.7776914
 [63,]  -11.7674014  9.253683  -30.10929219   5.7724413
 [64,]    0.9447074  8.153492  -15.38586580  16.4085400
 [65,]  -12.0222838  7.665709  -27.05850896   2.6505431
 [66,]   18.6449249  7.904534    3.08879755  34.1254851
 [67,]    2.1766337  8.811078  -15.23731958  19.1877911
 [68,]    8.6617425 10.208987  -11.29337790  28.4878713
 [69,]  -17.1464487 11.926720  -40.70327938   6.0087609
 [70,]    1.2080601 13.845748  -26.15762533  28.0709330
 [71,]   21.1019546 12.607267   -3.20703199  46.5905171
 [72,]   20.3283517 10.826891   -0.64803884  42.3132767
 [73,]  -24.0098513  9.332627  -42.26859455  -4.7398738
 [74,]  -24.2039542  8.280837  -40.30856974  -7.0509640
 [75,]  -11.3535572  7.851404  -26.74396687   4.3302657
 [76,]  -17.6884601  8.143390  -33.66934610  -1.2775863
 [77,]   -7.8565631  9.087519  -25.79181505   9.8770389
 [78,]    6.6398340 10.509480  -13.90360824  27.3398273
 [79,]   -0.6378690 12.243909  -24.40418517  23.5474191
 [80,]   29.4125281 14.176580    1.60322921  57.9681152
 [81,]   -9.0202129 13.491319  -35.34775392  17.9145126
 [82,]   23.5175470 11.480452    0.84625449  46.3750511
 [83,]    4.2599069  9.770801  -15.01526072  23.8242609
 [84,]   20.7701668  8.545117    4.04004342  37.8730618
 [85,]    1.6188267  8.028212  -14.25587554  17.5256852
 [86,]    5.0019866  8.352728  -11.48487451  21.5379312
 [87,]   -3.9830535  9.432212  -22.93013228  14.5693902
 [88,]  -13.9254936 11.047528  -35.77327326   8.2627768
 [89,]  -13.2835337 13.000455  -38.58406883  13.0214788
 [90,]  -11.5921738 15.161084  -41.00804853  19.2263067
 [91,]   26.6941602 13.219208    0.22999185  52.4588607
 [92,]    8.9069697 11.291081  -13.98613034  30.6042426
 [93,]  -32.5140208  9.646543  -51.84567835 -13.8561380
 [94,]    2.7705887  8.452768  -13.91180289  19.3342812
 [95,]    3.1543982  7.916375  -12.11952429  19.0678000
 [96,]   10.0341077  8.167920   -5.73240079  26.3417487
 [97,]    3.2293172  9.142596  -14.40057989  21.3033610
 [98,]   -3.5648733 10.643562  -24.21669646  17.3287261
 [99,]   16.3807362 12.482387   -7.49100527  40.7927362
[100,]    0.2067457 14.531372  -27.64459972  28.6585808
[101,]    9.5343066 13.079549  -15.06816275  35.6457923
[102,]   -7.8519543 11.209872  -29.26729961  14.2279535
[103,]  -10.8428152  9.626345  -29.01755055   8.2592477
[104,]   -6.4461761  8.490612  -22.82870489  10.2823163
[105,]  -22.2576370  7.995821  -37.58873336  -6.1777826
[106,]  -14.7932979  8.257996  -30.75160926   1.9808198
[107,]  -14.6026588  9.212737  -32.11858721   3.8471528
[108,]    0.3347803 10.675825  -20.11015610  21.4605254
[109,]   16.9136194 12.469588   -6.53776528  41.0883070
[110,]   20.6783585 14.471582   -6.59999254  48.4749848
[111,]   17.5324995 13.084402   -7.41523368  44.0546546
[112,]  -12.2574765 11.190111  -33.88453382  10.0717448
[113,]  -16.4546524  9.585782  -34.90763573   2.4802076
[114,]  -34.0796284  8.438453  -50.27319765 -17.1078967
[115,]  -37.6377044  7.948546  -53.32583580 -22.1871088
[116,]    6.2230196  8.234253  -10.53307523  21.9894865
[117,]   38.9953436  9.223779   20.15463248  56.7877293
[118,]    5.5217676 10.724033  -15.83961632  26.5191358
[119,]   20.1430916 12.553220   -4.95861957  44.8885582
[120,]   -2.2388843 14.588125  -31.47567970  26.2469837
[121,]   -5.2214618 12.381058  -30.27416534  18.1567203
[122,]   36.8141759 10.616039   15.41000343  56.8722621
[123,]   -0.8449864  9.146043  -19.12517642  16.6593103
[124,]    2.3547514  8.132654  -13.96916457  18.0731964
[125,]  -13.9024109  7.756942  -29.43240071   1.1628967
[126,]   11.4083269  8.108045   -4.90714435  27.0457967
[127,]  -12.9741354  9.102240  -30.77787963   4.9007333
[128,]  -41.6206976 10.559417  -62.23554461 -21.1672333
[129,]    5.8301401 12.316328  -18.45701294  29.0923309
[130,]   24.3583778 14.262634   -3.87434461  51.3971210
[131,]  -50.5098769 12.542239  -75.23903162 -26.8924748
[132,]   12.0110999 10.808561   -9.27054808  32.7033748
[133,]   26.6998767  9.362619    8.05769815  44.4811043
[134,]   32.6810535  8.355161   15.80714409  48.8498147
[135,]   20.5699303  7.954572    4.61010789  36.1411043
[136,]   10.6626071  8.249735   -5.76424010  27.0419725
[137,]   -1.7353161  9.173738  -20.45834099  16.0362788
[138,]   -9.7251393 10.562824  -30.91266294  11.0355787
[139,]   -8.5129624 12.259911  -32.95805761  15.4044833
[140,]   -9.6076856 14.154647  -37.85679527  18.3094393
[141,]   17.2672885 12.068996   -6.22934824  40.3707877
[142,]    2.4710591 10.369615  -17.80518924  22.4830129
[143,]  -20.0330702  8.965046  -37.42545966  -2.5469843
[144,]  -10.9284995  8.011868  -26.63614915   4.8806955
[145,]   14.9274711  7.680031   -0.09338979  30.3243266
[146,]    6.0091418  8.046775   -9.86678022  22.2258404
[147,]  -24.3786876  9.027356  -42.03644738  -6.5878757
[148,]   14.2992831 10.450387   -6.00527141  34.9775101
[149,]   -4.8532462 12.161533  -28.71601181  19.1758517
[150,]   10.0702244 14.055961  -17.19806946  37.9293770
[151,]   -1.0063094 13.416351  -26.31639459  25.7031077
[152,]   -6.9619054 11.503730  -29.08475759  15.8992152
[153,]  -17.7997014  9.864243  -36.70187141   1.6000296
[154,]  -31.4425974  8.654530  -48.09979281 -14.7929607
[155,]  -19.5933933  8.070231  -35.47401562  -4.3980955
[156,]   41.8479107  8.245394   25.63803671  57.6955214
[157,]  -36.4127853  9.136440  -54.29141883 -18.5369788
[158,]   14.8095187 10.563744   -5.67323843  35.7175190
[159,]   17.1719227 12.342648   -6.97884081  41.6379689
[160,]    9.0226268 14.342921  -18.82934535  37.2047985
[161,]   17.4541855 12.266460   -6.64096273  41.6570788
[162,]   10.5955905 10.578268   -9.94599841  31.3911300
[163,]    6.6306955  9.177101  -11.12235200  24.8758049
[164,]    1.1003004  8.211230  -14.75246249  17.3337502
[165,]  -10.9396946  7.843157  -26.12938609   4.8512381
[166,]  -15.0191896  8.154240  -30.70153520   1.0926441
[167,]  -49.6863846  9.074902  -67.38020242 -31.8112697
[168,]  -13.7425797 10.445179  -34.18821700   6.8516521
[169,]   22.9865253 12.113438   -0.52955818  46.8773082
[170,]   32.2540303 13.973357    4.76328106  59.8143943
[171,]    5.8558035 12.443654  -18.73150071  31.0801531
[172,]   -1.8273429 10.711655  -22.78061260  20.2725919
[173,]   10.5500106  9.269593   -7.54154957  29.3130413
[174,]   11.8393642  8.270546   -4.29330956  28.3658697
[175,]  -23.3650823  7.884750  -38.73178413  -7.6874247
[176,]    7.3244712  8.199232   -8.56738237  23.7817147
[177,]    0.4532248  9.142007  -17.31335655  18.3693910
[178,]   -2.5541217 10.545897  -23.37611833  17.9964864
[179,]   11.6222318 12.253423  -12.59286664  35.8060896
[180,]   -5.1413146 14.155125  -33.27967227  22.6999909</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.3
looic      1769.5 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     175   97.2%   1278      
 (0.5, 0.7]   (ok)         5    2.8%   166       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.4
p_loo        34.3  8.6
looic      1723.1 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   761       
 (0.5, 0.7]   (ok)         6    3.3%   296       
   (0.7, 1]   (bad)        2    1.1%   44        
   (1, Inf)   (very bad)   2    1.1%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.2      11.7  
fit_sleep1 -91.7      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.3
looic      1769.5 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     175   97.2%   1278      
 (0.5, 0.7]   (ok)         5    2.8%   166       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.4
p_loo        34.3  8.6
looic      1723.1 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   761       
 (0.5, 0.7]   (ok)         6    3.3%   296       
   (0.7, 1]   (bad)        2    1.1%   44        
   (1, Inf)   (very bad)   2    1.1%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.6     22.4        34.3    8.6   1723.1
fit_sleep2  -23.2      11.7  -884.8     14.4        19.3    3.3   1769.5
fit_sleep1  -91.7      21.1  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   44.9  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.521637e-40 8.494290e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0      2.9      1.58     0.28      5.5       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0     -0.1      1.58    -3.24     3.05        5.5      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.26 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.5      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.3         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.1       pkgbuild_1.4.1       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.0        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.0         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.0           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.31       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
