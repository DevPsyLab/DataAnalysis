<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.87      6.80    15.92    42.64 1.00     1752     2567
sd(Days)                6.55      1.53     4.13    10.07 1.00     1478     1996
cor(Intercept,Days)     0.10      0.30    -0.47     0.69 1.00      982     1654

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   250.87      7.34   235.95   265.02 1.00     1535     2416
Days         10.41      1.70     7.00    13.76 1.00     1354     1874

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.94      1.59    23.01    29.24 1.00     3658     2846

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.2078  12.95673 228.8888 279.5825
309 211.1094  13.28236 184.6633 236.8319
310 212.7664  12.92287 187.8107 237.7827
330 274.1126  13.64937 247.8587 301.3370
331 272.7560  13.23889 248.0747 299.9324
332 259.7511  12.43500 235.6077 284.2978
333 268.2527  12.39392 243.9090 292.7537
334 244.2343  12.47304 219.6222 268.8109
335 250.5064  13.50465 225.2355 277.6162
337 286.1572  12.79756 260.9548 311.1111
349 226.5177  13.05076 199.7462 251.1270
350 238.9966  13.13857 212.3227 263.5770
351 255.7174  12.19560 231.9521 280.3734
352 271.8883  12.59283 247.2617 297.0042
369 254.6702  12.23528 230.8444 279.3658
370 226.1729  13.82329 198.5931 252.2784
371 252.0007  12.07914 227.9693 275.8282
372 263.8039  12.10466 241.1348 287.9572

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5792246  2.517474 14.6781089 24.587217
309  1.8414078  2.542545 -3.2580216  6.851680
310  4.9756654  2.422208  0.2010200  9.674959
330  5.8161807  2.570526  0.6463599 10.779523
331  7.5634220  2.504778  2.5826027 12.516754
332 10.3520449  2.357115  5.7750781 15.006225
333 10.2569576  2.348663  5.5680168 14.930052
334 11.4935517  2.365483  6.8744114 16.128996
335 -0.1917566  2.572489 -5.3032789  4.642338
337 19.1403422  2.445868 14.4847930 23.899691
349 11.5456709  2.474256  6.8730099 16.482638
350 16.9559007  2.488923 12.2051294 21.803637
351  7.5050627  2.358483  2.8385083 12.054571
352 14.0831017  2.375005  9.3616466 18.814361
369 11.3110234  2.328522  6.6883108 15.892029
370 15.2092186  2.594863 10.2425804 20.438261
371  9.4774122  2.315843  4.9281514 14.007907
372 11.7562532  2.289506  7.1755443 16.317078</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.2078 12.956726 228.8888 279.5825
  [2,] 273.7870 11.077158 251.7663 295.4141
  [3,] 293.3662  9.497656 274.9372 311.8292
  [4,] 312.9454  8.389449 296.6428 329.4101
  [5,] 332.5247  7.952081 317.0547 347.9407
  [6,] 352.1039  8.292387 335.9754 367.9494
  [7,] 371.6831  9.325616 353.2941 389.6083
  [8,] 391.2623 10.855685 370.0015 412.1840
  [9,] 410.8416 12.704332 385.7431 435.4423
 [10,] 430.4208 14.752272 401.2418 459.3469
 [11,] 211.1094 13.282360 184.6633 236.8319
 [12,] 212.9508 11.346913 190.5744 234.5090
 [13,] 214.7922  9.696023 195.8574 233.6011
 [14,] 216.6336  8.497196 200.0933 233.4353
 [15,] 218.4751  7.957444 202.9993 234.3089
 [16,] 220.3165  8.207835 204.1718 236.4830
 [17,] 222.1579  9.183967 203.9751 239.8691
 [18,] 223.9993 10.688828 202.6380 244.2563
 [19,] 225.8407 12.533391 200.4283 250.0462
 [20,] 227.6821 14.589373 198.7495 256.1196
 [21,] 212.7664 12.922868 187.8107 237.7827
 [22,] 217.7420 11.154952 196.1137 239.6615
 [23,] 222.7177  9.674687 203.9735 241.8267
 [24,] 227.6934  8.631360 211.0555 244.9275
 [25,] 232.6690  8.193618 216.5870 249.1911
 [26,] 237.6447  8.456036 220.8162 254.9381
 [27,] 242.6204  9.359910 223.9227 261.3838
 [28,] 247.5960 10.744555 226.3071 268.8042
 [29,] 252.5717 12.450590 228.0092 276.6795
 [30,] 257.5474 14.363951 229.1655 285.2261
 [31,] 274.1126 13.649370 247.8587 301.3370
 [32,] 279.9287 11.688043 257.4017 303.3516
 [33,] 285.7449 10.006528 266.3597 305.6767
 [34,] 291.5611  8.767329 274.4521 308.8012
 [35,] 297.3773  8.174150 281.5533 313.3751
 [36,] 303.1935  8.365561 286.8527 319.5750
 [37,] 309.0096  9.293207 290.7583 327.1364
 [38,] 314.8258 10.768473 293.8954 335.8264
 [39,] 320.6420 12.600457 295.9253 345.3614
 [40,] 326.4582 14.655996 297.4735 355.1533
 [41,] 272.7560 13.238891 248.0747 299.9324
 [42,] 280.3195 11.357762 258.8749 303.6312
 [43,] 287.8829  9.760998 269.3558 307.5584
 [44,] 295.4463  8.608324 278.9669 312.5654
 [45,] 303.0097  8.091799 287.2672 318.8630
 [46,] 310.5731  8.330607 294.1447 327.0347
 [47,] 318.1366  9.266534 299.8886 336.1819
 [48,] 325.7000 10.718493 304.8807 346.6109
 [49,] 333.2634 12.508052 309.1717 357.1669
 [50,] 340.8268 14.510840 312.8836 368.7019
 [51,] 259.7511 12.434998 235.6077 284.2978
 [52,] 270.1032 10.726062 249.1713 291.6691
 [53,] 280.4552  9.304817 262.3854 298.8226
 [54,] 290.8073  8.320024 274.3153 306.8970
 [55,] 301.1593  7.935866 285.5181 316.4530
 [56,] 311.5113  8.236814 295.2774 327.4819
 [57,] 321.8634  9.155558 303.8109 339.8301
 [58,] 332.2154 10.531635 311.6560 353.3288
 [59,] 342.5675 12.211406 318.9066 366.9180
 [60,] 352.9195 14.086642 325.8290 380.8139
 [61,] 268.2527 12.393919 243.9090 292.7537
 [62,] 278.5096 10.675205 257.6008 299.8185
 [63,] 288.7666  9.238139 270.7225 307.3028
 [64,] 299.0236  8.231577 283.3659 315.4768
 [65,] 309.2805  7.823486 294.2081 324.6896
 [66,] 319.5375  8.104780 303.7208 335.4185
 [67,] 329.7944  9.011127 312.1757 347.7057
 [68,] 340.0514 10.380068 319.9621 360.8000
 [69,] 350.3084 12.055025 326.7266 374.1279
 [70,] 360.5653 13.926015 333.4883 387.7317
 [71,] 244.2343 12.473037 219.6222 268.8109
 [72,] 255.7279 10.754696 234.5335 276.9554
 [73,] 267.2214  9.324234 248.9224 285.7410
 [74,] 278.7150  8.331279 262.3062 295.0685
 [75,] 290.2085  7.941670 274.4471 305.5460
 [76,] 301.7021  8.241422 285.3902 317.7833
 [77,] 313.1956  9.163132 294.9488 331.1184
 [78,] 324.6892 10.544949 303.8921 345.1054
 [79,] 336.1827 12.231923 312.0225 359.9922
 [80,] 347.6763 14.115061 319.5777 375.0900
 [81,] 250.5064 13.504650 225.2355 277.6162
 [82,] 250.3147 11.514106 228.5962 273.4609
 [83,] 250.1229  9.798424 231.2784 270.0039
 [84,] 249.9312  8.525198 233.3156 266.9582
 [85,] 249.7394  7.911022 234.3419 265.4478
 [86,] 249.5477  8.107093 233.2452 265.5054
 [87,] 249.3559  9.060962 231.1802 266.9093
 [88,] 249.1641 10.569414 228.3203 270.0684
 [89,] 248.9724 12.432191 224.0496 273.5001
 [90,] 248.7806 14.513499 219.5847 277.1349
 [91,] 286.1572 12.797564 260.9548 311.1111
 [92,] 305.2975 10.980321 283.8637 326.4627
 [93,] 324.4379  9.451021 305.9295 342.9116
 [94,] 343.5782  8.369031 327.1326 360.0600
 [95,] 362.7186  7.919856 347.1446 378.3180
 [96,] 381.8589  8.208051 365.8858 397.8229
 [97,] 400.9992  9.164312 382.6459 418.5916
 [98,] 420.1396 10.609509 399.1795 440.8063
 [99,] 439.2799 12.373491 415.3212 462.9737
[100,] 458.4203 14.339088 430.7233 485.8977
[101,] 226.5177 13.050759 199.7462 251.1270
[102,] 238.0634 11.217291 214.8256 259.1483
[103,] 249.6090  9.673510 229.7589 268.1026
[104,] 261.1547  8.577288 244.0416 277.5077
[105,] 272.7004  8.112141 256.5931 288.5659
[106,] 284.2461  8.383775 267.2403 300.6502
[107,] 295.7917  9.328045 276.9178 314.1985
[108,] 307.3374 10.769450 285.2871 328.8389
[109,] 318.8831 12.537686 293.8113 343.3788
[110,] 330.4287 14.513786 301.8270 359.4045
[111,] 238.9966 13.138570 212.3227 263.5770
[112,] 255.9525 11.247190 232.9244 277.1062
[113,] 272.9084  9.631512 253.1911 291.1906
[114,] 289.8643  8.451168 272.9012 306.5145
[115,] 306.8202  7.903666 291.1627 322.5614
[116,] 323.7761  8.118073 307.8330 340.2746
[117,] 340.7320  9.040340 322.9173 359.0318
[118,] 357.6879 10.485317 337.2527 378.6175
[119,] 374.6438 12.269697 350.6895 398.8885
[120,] 391.5997 14.266693 363.8774 419.6024
[121,] 255.7174 12.195603 231.9521 280.3734
[122,] 263.2224 10.498205 243.0929 284.4248
[123,] 270.7275  9.100372 253.1997 288.8152
[124,] 278.2326  8.157580 262.4674 294.4103
[125,] 285.7376  7.835837 270.4320 301.2356
[126,] 293.2427  8.208499 277.4323 309.7710
[127,] 300.7478  9.191488 283.3251 319.0339
[128,] 308.2528 10.616606 288.1435 329.4158
[129,] 315.7579 12.331508 291.8458 340.3121
[130,] 323.2629 14.231821 295.8508 351.2629
[131,] 271.8883 12.592830 247.2617 297.0042
[132,] 285.9714 10.833115 264.9760 307.5951
[133,] 300.0545  9.349582 281.9624 319.0397
[134,] 314.1376  8.291821 298.2459 330.8086
[135,] 328.2207  7.834232 313.4487 343.7830
[136,] 342.3038  8.079444 326.3594 358.3897
[137,] 356.3869  8.970001 338.5461 374.1863
[138,] 370.4700 10.340490 350.1193 390.2625
[139,] 384.5531 12.027961 360.7446 407.7644
[140,] 398.6362 13.917588 370.9748 425.7990
[141,] 254.6702 12.235278 230.8444 279.3658
[142,] 265.9812 10.542870 245.8756 287.3687
[143,] 277.2922  9.134891 260.0479 295.6610
[144,] 288.6033  8.159925 273.2841 304.9090
[145,] 299.9143  7.782451 284.6626 315.0007
[146,] 311.2253  8.086578 294.9980 327.0364
[147,] 322.5363  9.003498 304.6624 339.9307
[148,] 333.8474 10.371945 313.5834 353.7894
[149,] 345.1584 12.038918 321.7442 368.8542
[150,] 356.4694 13.897405 329.2863 383.9612
[151,] 226.1729 13.823285 198.5931 252.2784
[152,] 241.3822 11.793845 218.0231 263.7941
[153,] 256.5914 10.028608 236.6417 275.6600
[154,] 271.8006  8.690098 255.0079 288.5470
[155,] 287.0098  7.995578 271.6465 302.5067
[156,] 302.2190  8.112172 287.0363 317.7719
[157,] 317.4283  9.008443 300.2248 334.8760
[158,] 332.6375 10.486343 312.5743 352.8635
[159,] 347.8467 12.338613 323.5716 371.4104
[160,] 363.0559 14.421718 334.7393 390.9000
[161,] 252.0007 12.079139 227.9693 275.8282
[162,] 261.4781 10.392109 241.2093 282.0322
[163,] 270.9555  8.989577 253.2270 288.7222
[164,] 280.4329  8.022176 264.4351 296.2526
[165,] 289.9103  7.656656 274.5364 304.6836
[166,] 299.3877  7.976197 283.5818 314.9900
[167,] 308.8652  8.907373 291.3210 326.4402
[168,] 318.3426 10.285385 298.1891 338.8959
[169,] 327.8200 11.956723 304.6839 351.9468
[170,] 337.2974 13.815338 310.4938 364.9603
[171,] 263.8039 12.104661 241.1348 287.9572
[172,] 275.5601 10.453873 255.8936 296.4488
[173,] 287.3164  9.084480 270.2190 305.2499
[174,] 299.0727  8.139764 283.4621 314.9610
[175,] 310.8289  7.776081 295.6399 326.2778
[176,] 322.5852  8.072348 306.6505 338.3725
[177,] 334.3414  8.963360 316.2912 351.9194
[178,] 346.0977 10.295851 325.5833 366.5418
[179,] 357.8539 11.922707 334.1581 381.7812
[180,] 369.6102 13.739760 342.1512 397.4338</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.6477707 12.956726  -30.0224759  20.6712274
  [2,]  -15.0822953 11.077158  -36.7093841   6.9384262
  [3,]  -42.5656199  9.497656  -61.0286144 -24.1365843
  [4,]    8.4943555  8.389449   -7.9702964  24.7970212
  [5,]   24.3272308  7.952081    8.9112083  39.7971675
  [6,]   62.5862062  8.292387   46.7407474  78.7146572
  [7,]   10.5206816  9.325616   -7.4044834  28.9097083
  [8,] -101.1137430 10.855685 -122.0353671 -79.8529053
  [9,]   19.7437324 12.704332   -4.8569777  44.8422138
 [10,]   35.9327078 14.752272    7.0066076  65.1116645
 [11,]   11.6244770 13.282360  -14.0980159  38.0706141
 [12,]   -7.6850307 11.346913  -29.2432381  14.6913635
 [13,]  -11.8144385  9.696023  -30.6233066   7.1204154
 [14,]  -11.9266462  8.497196  -28.7282865   4.6136982
 [15,]  -10.7589540  7.957444  -26.5927814   4.7167798
 [16,]   -4.3546617  8.207835  -20.5212382  11.7899879
 [17,]   -8.5275695  9.183967  -26.2387502   9.6552176
 [18,]   -6.2720772 10.688828  -26.5291451  15.0892242
 [19,]   -1.5449850 12.533391  -25.7504747  23.8674026
 [20,]    9.6321073 14.589373  -18.8054309  38.5647191
 [21,]  -13.7124822 12.922868  -38.7287817  11.2432406
 [22,]  -23.4098476 11.154952  -45.3293024  -1.7814967
 [23,]   11.6022870  9.674687   -7.5067455  30.3464816
 [24,]    5.1482216  8.631360  -12.0858763  21.7861111
 [25,]   -3.3616438  8.193618  -19.8837303  12.7203841
 [26,]  -17.1868092  8.456036  -34.4801565  -0.3582974
 [27,]   -7.1995746  9.359910  -25.9629580  11.4981147
 [28,]    8.1550600 10.744555  -13.0531436  29.4439725
 [29,]    8.4407946 12.450590  -15.6670456  33.0032712
 [30,]  -10.0320708 14.363951  -37.7108496  18.3497933
 [31,]   47.4300487 13.649370   20.2056460  73.6838969
 [32,]   20.4714680 11.688043   -2.9513677  42.9984719
 [33,]   -1.8884127 10.006528  -21.8201805  17.4968145
 [34,]   -6.4280935  8.767329  -23.6681588  10.6809420
 [35,]  -11.5799742  8.174150  -27.5778428   4.2440140
 [36,]   -5.6079549  8.365561  -21.9894882  10.7327698
 [37,]  -28.7700356  9.293207  -46.8968310 -10.5187038
 [38,]    3.4354837 10.768473  -17.5651299  24.3659271
 [39,]  -15.2924971 12.600457  -40.0119372   9.4241754
 [40,]   27.5905222 14.655996   -1.1046260  56.5751997
 [41,]   14.8518708 13.238891  -12.3245130  39.5331685
 [42,]    4.6805488 11.357762  -18.6312140  26.1250975
 [43,]   13.9377268  9.760998   -5.7377632  32.4648304
 [44,]   24.6690047  8.608324    7.5499225  41.1484084
 [45,]   13.2675827  8.091799   -2.5857449  29.0100944
 [46,]  -17.2544393  8.330607  -33.7159934  -0.8260264
 [47,]  -28.0615613  9.266534  -46.1069167  -9.8135549
 [48,]    9.1177166 10.718493  -11.7932304  29.9370228
 [49,]  -39.5165054 12.508052  -63.4199721 -15.4248405
 [50,]   30.7542726 14.510840    2.8792049  58.6975485
 [51,]  -24.8905210 12.434998  -49.4372361  -0.7470539
 [52,]  -27.2913658 10.726062  -48.8573002  -6.3595012
 [53,]   -7.4939107  9.304817  -25.8612716  10.5758707
 [54,]   18.9615444  8.320024    2.8717826  35.4535185
 [55,]   16.3035995  7.935866    1.0098911  31.9448000
 [56,]   -1.5137454  8.236814  -17.4842915  14.7202265
 [57,]  132.2985098  9.155558  114.3318327 150.3510149
 [58,]   14.6156649 10.531635   -6.4977336  35.1751056
 [59,]  -12.2671800 12.211406  -36.6177013  11.3936860
 [60,]  -99.0551249 14.086642 -126.9495091 -71.9645658
 [61,]   15.5897091 12.393919   -8.9113270  39.9334263
 [62,]   11.0453515 10.675205  -10.2634721  31.9542383
 [63,]  -11.9973061  9.238139  -30.5334710   6.0468420
 [64,]    0.7861364  8.231577  -15.6671414  16.4438436
 [65,]  -12.1095212  7.823486  -27.5185505   2.9628775
 [66,]   18.6290212  8.104780    2.7479947  34.4457274
 [67,]    2.2320636  9.011127  -15.6791725  19.8507538
 [68,]    8.7885061 10.380068  -11.9601012  28.8778308
 [69,]  -16.9483515 12.055025  -40.7678660   6.6334498
 [70,]    1.4774909 13.926015  -25.6888818  28.5545059
 [71,]   21.2387774 12.473037   -3.3378498  45.8508756
 [72,]   20.4733257 10.754696   -0.7542148  41.6676524
 [73,]  -23.8567260  9.324234  -42.3763315  -5.5576742
 [74,]  -24.0426777  8.331279  -40.3961707  -7.6339454
 [75,]  -11.1841294  7.941670  -26.5216315   4.5773437
 [76,]  -17.5108811  8.241422  -33.5920976  -1.1990490
 [77,]   -7.6708328  9.163132  -25.5936149  10.5760347
 [78,]    6.8337154 10.544949  -13.5825269  27.6308068
 [79,]   -0.4358363 12.231923  -24.2452837  23.7244472
 [80,]   29.6227120 14.115061    2.2089800  57.7212690
 [81,]   -8.8981386 13.504650  -36.0079090  16.3728299
 [82,]   23.6325180 11.514106    0.4862983  45.3510314
 [83,]    4.3677746  9.798424  -15.5131750  23.2123307
 [84,]   20.8709312  8.525198    3.8439198  37.4865044
 [85,]    1.7124877  7.911022  -13.9958709  17.1099710
 [86,]    5.0885443  8.107093  -10.8691808  21.3909533
 [87,]   -3.9035991  9.060962  -21.4569841  14.2720927
 [88,]  -13.8531425 10.569414  -34.7573504   6.9907145
 [89,]  -13.2182859 12.432191  -37.7459749  11.7045291
 [90,]  -11.5340294 14.513499  -39.8883144  17.6619436
 [91,]   26.2094081 12.797564    1.2554973  51.4117569
 [92,]    8.5082659 10.980321  -12.6569201  29.9421279
 [93,]  -32.8266762  9.451021  -51.3004134 -14.3183078
 [94,]    2.5439816  8.369031  -13.9377834  18.9896455
 [95,]    3.0138394  7.919856  -12.5856076  18.5877821
 [96,]    9.9795973  8.208051   -5.9844024  25.9526918
 [97,]    3.2608551  9.164312  -14.3315234  21.6142454
 [98,]   -3.4472871 10.609509  -24.1139542  17.5127668
 [99,]   16.5843708 12.373491   -7.1093752  40.5431431
[100,]    0.4964286 14.339088  -26.9810064  28.1934081
[101,]    9.5855043 13.050759  -15.0237673  36.3569887
[102,]   -7.7466665 11.217291  -28.8316371  15.4911049
[103,]  -10.6834374  9.673510  -29.1770032   9.1666537
[104,]   -6.2327083  8.577288  -22.5857149  10.8803524
[105,]  -21.9900792  8.112141  -37.8555917  -5.8827731
[106,]  -14.4716501  8.383775  -30.8758093   2.5340553
[107,]  -14.2269210  9.328045  -32.6337236   4.6470172
[108,]    0.7646081 10.769450  -20.7369287  22.8149205
[109,]   17.3975373 12.537686   -7.0981960  42.4693079
[110,]   21.2163664 14.513786   -7.7593829  49.8181241
[111,]   17.3002135 13.138570   -7.2802177  43.9741211
[112,]  -12.4981872 11.247190  -33.6518870  10.5299162
[113,]  -16.7037879  9.631512  -34.9860088   3.0134923
[114,]  -34.3371885  8.451168  -50.9874032 -17.3740874
[115,]  -37.9036892  7.903666  -53.6449406 -22.2462495
[116,]    5.9486101  8.118073  -10.5498517  21.8917283
[117,]   38.7125094  9.040340   20.4126541  56.5272241
[118,]    5.2305087 10.485317  -15.6990635  25.6656976
[119,]   19.8434081 12.269697   -4.4013002  43.7977324
[120,]   -2.5469926 14.266693  -30.5497303  25.1753258
[121,]   -5.1908852 12.195603  -29.8468620  18.5744463
[122,]   36.8351522 10.498205   15.6328284  56.9646658
[123,]   -0.8336105  9.100372  -18.9212976  16.6941501
[124,]    2.3565268  8.157580  -13.8212161  18.1216813
[125,]  -13.9102359  7.835837  -29.4082234   1.3954475
[126,]   11.3909014  8.208499   -5.1374014  27.2013360
[127,]  -13.0011612  9.191488  -31.2872655   4.4215461
[128,]  -41.6573239 10.616606  -62.8202623 -21.5479793
[129,]    5.7839134 12.331508  -18.7702936  29.6959815
[130,]   24.3025507 14.231821   -3.6973854  51.7146586
[131,]  -50.2112249 12.592830  -75.3270761 -25.5845618
[132,]   12.2224734 10.833115   -9.4011811  33.2179403
[133,]   26.8239717  9.349582    7.8388252  44.9161158
[134,]   32.7178701  8.291821   16.0468709  48.6095535
[135,]   20.5194684  7.834232    4.9571763  35.2915106
[136,]   10.5248667  8.079444   -5.5610088  26.4692673
[137,]   -1.9603349  8.970001  -19.7596989  15.8805416
[138,]  -10.0374366 10.340490  -29.8298575  10.3132728
[139,]   -8.9125382 12.027961  -32.1237806  14.8960261
[140,]  -10.0945399 13.917588  -37.2573269  17.5669494
[141,]   17.2533112 12.235278   -7.4422979  41.0790811
[142,]    2.4556877 10.542870  -18.9318207  22.5613432
[143,]  -20.0498357  9.134891  -38.4186191  -2.8055316
[144,]  -10.9466591  8.159925  -27.2524106   4.3725267
[145,]   14.9079174  7.782451   -0.1785483  30.1595901
[146,]    5.9881940  8.086578   -9.8228768  22.2155222
[147,]  -24.4010295  9.003498  -41.7954034  -6.5271347
[148,]   14.2755471 10.371945   -5.6665330  34.5395260
[149,]   -4.8783763 12.038918  -28.5742203  18.5357899
[150,]   10.0437002 13.897405  -17.4481355  37.2268494
[151,]   -0.9089433 13.823285  -27.0144054  26.6708550
[152,]   -6.8586619 11.793845  -29.2705531  16.5004499
[153,]  -17.6905806 10.028608  -36.7592321   2.2591317
[154,]  -31.3275992  8.690098  -48.0740120 -14.5348765
[155,]  -19.4725178  7.995578  -34.9693676  -4.1091533
[156,]   41.9746635  8.112172   26.4218111  57.1573676
[157,]  -36.2801551  9.008443  -53.7278861 -19.0766527
[158,]   14.9480262 10.486343   -5.2779639  35.0112055
[159,]   17.3163076 12.338613   -6.2474109  41.5914394
[160,]    9.1728889 14.421718  -18.6712043  37.4895456
[161,]   17.8797196 12.079139   -5.9477613  41.9110505
[162,]   10.9647074 10.392109   -9.5894387  31.2335373
[163,]    6.9433952  8.989577  -10.8233223  24.6718941
[164,]    1.3565829  8.022176  -14.4631068  17.3544036
[165,]  -10.7398293  7.656656  -25.5130791   4.6341394
[166,]  -14.8757415  7.976197  -30.4779752   0.9301549
[167,]  -49.5993537  8.907373  -67.1743998 -32.0552230
[168,]  -13.7119659 10.285385  -34.2652616   6.4414612
[169,]   22.9607219 11.956723   -1.1660861  46.0967612
[170,]   32.1718096 13.815338    4.5088772  58.9754280
[171,]    5.6078040 12.104661  -18.5454502  28.2769348
[172,]   -2.0861491 10.453873  -22.9748043  17.5803965
[173,]   10.2803977  9.084480   -7.6531111  27.3778095
[174,]   11.5589446  8.139764   -4.3293924  27.1695279
[175,]  -23.6563086  7.776081  -39.1052059  -8.4673201
[176,]    7.0224383  8.072348   -8.7649211  22.9571278
[177,]    0.1403851  8.963360  -17.4375762  18.1906384
[178,]   -2.8777680 10.295851  -23.3218975  17.6366018
[179,]   11.2877788 11.922707  -12.6394769  34.9836022
[180,]   -5.4865743 13.739760  -33.3101636  21.9724334</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.3
p_loo        19.5  3.3
looic      1770.3 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   479       
 (0.5, 0.7]   (ok)         1    0.6%   166       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.4 22.4
p_loo        34.4  8.6
looic      1722.8 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   953       
 (0.5, 0.7]   (ok)         5    2.8%   534       
   (0.7, 1]   (bad)        2    1.1%   30        
   (1, Inf)   (very bad)   1    0.6%   33        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.7      11.7  
fit_sleep1 -91.8      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.3
p_loo        19.5  3.3
looic      1770.3 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   479       
 (0.5, 0.7]   (ok)         1    0.6%   166       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.4 22.4
p_loo        34.4  8.6
looic      1722.8 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   953       
 (0.5, 0.7]   (ok)         5    2.8%   534       
   (0.7, 1]   (bad)        2    1.1%   30        
   (1, Inf)   (very bad)   1    0.6%   33        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.4     22.4        34.4    8.6   1722.8
fit_sleep2  -23.7      11.7  -885.1     14.3        19.5    3.3   1770.3
fit_sleep1  -91.8      21.1  -953.2     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   44.9  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.318453e-40 4.959354e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88      1.56     0.28     5.42       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12      1.56    -3.22     2.93       5.26      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.5-4.1     

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0         tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
