<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.72      6.72    15.45    41.22 1.00     1726     2409
sd(Days)                6.54      1.49     4.06     9.93 1.00     1154     1844
cor(Intercept,Days)     0.10      0.31    -0.47     0.70 1.01      654     1462

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.13      7.26   237.11   265.58 1.00     1965     2432
Days         10.50      1.66     7.11    13.86 1.00     1568     1952

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.98      1.54    23.16    29.19 1.00     3331     3058

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7774  12.85997 227.7700 277.5051
309 211.4369  13.39956 184.7157 237.3081
310 213.0872  13.04843 187.7022 238.0756
330 274.5116  13.45450 249.1054 301.1658
331 272.4872  13.11093 247.2299 299.4621
332 260.3068  11.94127 236.9409 284.6870
333 267.7706  12.68617 244.1140 294.1044
334 244.4685  12.51768 219.4231 268.3916
335 250.2955  13.49562 223.6576 276.8933
337 285.5970  13.32305 259.9464 312.4502
349 226.8339  13.13962 200.2476 251.9183
350 238.7792  12.95995 212.5360 262.8931
351 255.6431  12.50628 230.6791 279.5347
352 271.6974  12.53097 247.1228 296.6709
369 254.5916  12.32290 230.3317 278.6177
370 226.7456  13.52817 198.9269 251.7218
371 252.2120  12.38855 227.9352 277.0038
372 263.2417  12.48826 238.8749 287.8175

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6477578  2.526143 14.7637492 24.621640
309  1.7731572  2.533134 -3.1364033  6.851344
310  4.8913065  2.459500  0.1275732  9.760571
330  5.7741672  2.556725  0.6622031 10.689133
331  7.5743729  2.520471  2.3415955 12.552782
332 10.2078104  2.249938  5.6186524 14.565146
333 10.3085330  2.427606  5.3806908 15.055432
334 11.4684108  2.373362  6.6933556 16.175871
335 -0.1443177  2.620830 -5.3384869  5.110976
337 19.2118566  2.504930 14.3250687 24.122822
349 11.5840467  2.470823  6.8511774 16.509351
350 16.9936333  2.519643 12.0757192 21.871657
351  7.5017912  2.391393  2.8428005 12.209965
352 14.0759276  2.387908  9.3671035 18.666831
369 11.3697508  2.328050  6.7320737 15.960924
370 15.1241424  2.575377 10.2749478 20.278915
371  9.4438964  2.395107  4.6399934 14.085230
372 11.8126186  2.381605  7.0279388 16.364192</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7774 12.859969 227.7700 277.5051
  [2,] 273.4251 10.926792 251.2437 294.0327
  [3,] 293.0729  9.282972 274.1782 310.4285
  [4,] 312.7206  8.106489 296.3201 327.7818
  [5,] 332.3684  7.617057 317.3272 347.1232
  [6,] 352.0162  7.942717 336.2222 367.7087
  [7,] 371.6639  8.995373 353.6704 389.1636
  [8,] 391.3117 10.559808 370.1000 411.9532
  [9,] 410.9594 12.444482 386.1042 435.4570
 [10,] 430.6072 14.525272 402.0168 459.4676
 [11,] 211.4369 13.399561 184.7157 237.3081
 [12,] 213.2100 11.455044 190.3604 235.7216
 [13,] 214.9832  9.783729 195.6915 234.1859
 [14,] 216.7564  8.547411 200.2884 234.0509
 [15,] 218.5295  7.951643 203.3672 234.4151
 [16,] 220.3027  8.138340 204.7983 236.5489
 [17,] 222.0758  9.059252 204.7765 240.3564
 [18,] 223.8490 10.523358 203.4099 245.0357
 [19,] 225.6221 12.338785 201.6746 250.1999
 [20,] 227.3953 14.373020 199.6325 255.9431
 [21,] 213.0872 13.048429 187.7022 238.0756
 [22,] 217.9785 11.213368 196.2732 239.6298
 [23,] 222.8698  9.660022 204.2166 241.8960
 [24,] 227.7611  8.543460 211.3637 244.7956
 [25,] 232.6524  8.047589 216.7796 248.6652
 [26,] 237.5437  8.284620 221.4126 253.9060
 [27,] 242.4350  9.198069 224.5319 260.6764
 [28,] 247.3264 10.614720 226.7107 268.8395
 [29,] 252.2177 12.362782 228.3245 277.1239
 [30,] 257.1090 14.321409 229.4300 285.6660
 [31,] 274.5116 13.454499 249.1054 301.1658
 [32,] 280.2858 11.470216 258.7353 302.9706
 [33,] 286.0599  9.756119 267.7234 305.1640
 [34,] 291.8341  8.477709 275.9089 308.7547
 [35,] 297.6083  7.850792 282.6132 312.8660
 [36,] 303.3824  8.029446 287.4636 319.1536
 [37,] 309.1566  8.965643 291.1946 326.6922
 [38,] 314.9308 10.457878 294.2541 334.9493
 [39,] 320.7049 12.305501 296.7462 344.5403
 [40,] 326.4791 14.372097 298.3122 354.2266
 [41,] 272.4872 13.110928 247.2299 299.4621
 [42,] 280.0616 11.226686 258.2260 302.9724
 [43,] 287.6359  9.637741 269.1888 307.2936
 [44,] 295.2103  8.511122 278.4684 312.0429
 [45,] 302.7847  8.043499 286.6782 318.5236
 [46,] 310.3590  8.346383 293.7993 326.7721
 [47,] 317.9334  9.345153 299.4067 336.2274
 [48,] 325.5078 10.849295 304.1526 347.1562
 [49,] 333.0822 12.680224 307.9018 358.3434
 [50,] 340.6565 14.716470 311.6522 369.7977
 [51,] 260.3068 11.941272 236.9409 284.6870
 [52,] 270.5147 10.374904 250.0700 291.2970
 [53,] 280.7225  9.099874 263.1387 298.8275
 [54,] 290.9303  8.252348 274.5722 307.0959
 [55,] 301.1381  7.969896 284.9438 316.4295
 [56,] 311.3459  8.310335 294.4148 327.1563
 [57,] 321.5537  9.204811 303.0594 339.1291
 [58,] 331.7615 10.512843 310.7121 351.9832
 [59,] 341.9693 12.101059 318.1309 365.6833
 [60,] 352.1771 13.873566 324.7476 379.0808
 [61,] 267.7706 12.686169 244.1140 294.1044
 [62,] 278.0791 10.859868 257.8577 300.4963
 [63,] 288.3877  9.312418 270.8918 307.5020
 [64,] 298.6962  8.203176 283.0358 315.5138
 [65,] 309.0047  7.723315 294.3166 324.1782
 [66,] 319.3133  7.987092 303.6002 334.8971
 [67,] 329.6218  8.928842 311.8543 347.0563
 [68,] 339.9303 10.365393 319.5615 360.4329
 [69,] 350.2389 12.122089 326.2083 374.2813
 [70,] 360.5474 14.079605 332.1310 388.2647
 [71,] 244.4685 12.517682 219.4231 268.3916
 [72,] 255.9370 10.789127 234.4142 276.5702
 [73,] 267.4054  9.347932 248.6856 285.4934
 [74,] 278.8738  8.344346 262.7302 294.9764
 [75,] 290.3422  7.945947 275.0513 306.1930
 [76,] 301.8106  8.240979 285.9980 318.1129
 [77,] 313.2790  9.162700 295.4700 331.4301
 [78,] 324.7474 10.548086 303.8043 345.1870
 [79,] 336.2158 12.240705 312.1200 360.1592
 [80,] 347.6842 14.130580 319.7353 375.3835
 [81,] 250.2955 13.495619 223.6576 276.8933
 [82,] 250.1512 11.487785 227.2888 273.1069
 [83,] 250.0069  9.774670 230.3715 269.1297
 [84,] 249.8626  8.535610 232.9997 266.6739
 [85,] 249.7183  7.994160 233.8404 265.2133
 [86,] 249.5740  8.288187 233.2247 265.7090
 [87,] 249.4296  9.339111 231.1031 267.8555
 [88,] 249.2853 10.930756 228.0507 271.2139
 [89,] 249.1410 12.863956 224.0060 274.7973
 [90,] 248.9967 15.007292 220.0338 278.5465
 [91,] 285.5970 13.323050 259.9464 312.4502
 [92,] 304.8088 11.426485 282.6093 327.8784
 [93,] 324.0207  9.806876 305.3030 343.5854
 [94,] 343.2325  8.621741 326.4709 360.4129
 [95,] 362.4444  8.064947 346.4992 378.2685
 [96,] 381.6562  8.264483 365.1841 397.7405
 [97,] 400.8681  9.171114 382.4409 419.3414
 [98,] 420.0799 10.605015 398.8121 441.1675
 [99,] 439.2918 12.384374 414.7404 463.8843
[100,] 458.5037 14.381531 430.0491 486.8073
[101,] 226.8339 13.139615 200.2476 251.9183
[102,] 238.4180 11.308679 215.1148 260.0080
[103,] 250.0020  9.763857 230.1799 268.7509
[104,] 261.5861  8.659648 244.3258 278.2060
[105,] 273.1701  8.176554 256.7751 289.1107
[106,] 284.7542  8.422144 267.8267 301.2303
[107,] 296.3382  9.339107 277.3956 314.6587
[108,] 307.9223 10.757103 286.5059 329.3126
[109,] 319.5063 12.506860 294.3331 344.6006
[110,] 331.0903 14.468509 302.5501 360.1433
[111,] 238.7792 12.959947 212.5360 262.8931
[112,] 255.7729 11.061170 233.6198 276.6293
[113,] 272.7665  9.457057 253.4688 290.6473
[114,] 289.7601  8.319830 272.9660 305.9367
[115,] 306.7538  7.854962 291.3456 322.4250
[116,] 323.7474  8.177927 307.9355 340.4948
[117,] 340.7410  9.206181 322.7957 359.1319
[118,] 357.7347 10.739005 336.1901 379.4205
[119,] 374.7283 12.593487 349.3417 400.0772
[120,] 391.7219 14.647962 362.2143 420.9775
[121,] 255.6431 12.506284 230.6791 279.5347
[122,] 263.1449 10.765155 241.9770 284.2440
[123,] 270.6466  9.317056 252.0955 288.9594
[124,] 278.1484  8.316490 261.3265 294.7906
[125,] 285.6502  7.934608 269.9174 301.5729
[126,] 293.1520  8.257695 276.9820 309.6231
[127,] 300.6538  9.211872 282.8914 319.0102
[128,] 308.1556 10.628507 287.3227 329.2424
[129,] 315.6574 12.349464 291.4285 339.9519
[130,] 323.1592 14.265023 295.7808 351.1809
[131,] 271.6974 12.530972 247.1228 296.6709
[132,] 285.7733 10.796704 264.7867 307.1494
[133,] 299.8492  9.355029 281.3119 318.0805
[134,] 313.9252  8.358740 297.1485 329.9112
[135,] 328.0011  7.976511 311.8313 343.7061
[136,] 342.0770  8.293679 325.5498 358.1238
[137,] 356.1529  9.238491 338.2214 373.8428
[138,] 370.2289 10.645117 349.6597 390.6861
[139,] 384.3048 12.356842 360.4331 407.6824
[140,] 398.3807 14.264248 370.5918 425.6960
[141,] 254.5916 12.322896 230.3317 278.6177
[142,] 265.9613 10.617765 245.0309 286.4230
[143,] 277.3311  9.190198 259.2383 295.2669
[144,] 288.7008  8.186708 272.5619 304.7017
[145,] 300.0706  7.773303 285.0847 315.2224
[146,] 311.4403  8.041514 295.9326 326.9660
[147,] 322.8101  8.930132 305.2779 340.5005
[148,] 334.1798 10.279505 313.8936 354.6816
[149,] 345.5496 11.934354 322.4437 368.9352
[150,] 356.9193 13.785101 330.3237 384.1664
[151,] 226.7456 13.528167 198.9269 251.7218
[152,] 241.8697 11.569572 218.3492 263.5116
[153,] 256.9939  9.897667 237.0514 275.6918
[154,] 272.1180  8.679732 255.0546 288.9090
[155,] 287.2421  8.122612 271.5963 303.0555
[156,] 302.3663  8.359488 285.7495 318.7165
[157,] 317.4904  9.330079 298.8073 335.8358
[158,] 332.6146 10.839042 311.0155 353.3474
[159,] 347.7387 12.695843 322.3665 372.6089
[160,] 362.8628 14.769874 333.5227 391.3784
[161,] 252.2120 12.388546 227.9352 277.0038
[162,] 261.6559 10.661924 240.7824 282.9103
[163,] 271.0998  9.238519 252.9014 289.3829
[164,] 280.5437  8.276288 264.1803 296.4553
[165,] 289.9876  7.944603 274.5171 305.6057
[166,] 299.4315  8.319229 283.3642 315.6255
[167,] 308.8754  9.315337 290.5401 326.7408
[168,] 318.3193 10.761714 297.0659 338.9765
[169,] 327.7632 12.503063 303.2228 351.9468
[170,] 337.2071 14.433008 309.0752 364.9564
[171,] 263.2417 12.488257 238.8749 287.8175
[172,] 275.0543 10.771663 254.1428 296.2448
[173,] 286.8669  9.351202 268.7663 305.4241
[174,] 298.6795  8.378862 282.3847 315.4685
[175,] 310.4921  8.019336 295.4032 326.3421
[176,] 322.3048  8.352141 306.4211 338.4115
[177,] 334.1174  9.303272 315.6433 352.2782
[178,] 345.9300 10.709228 323.9503 366.2809
[179,] 357.7426 12.416454 332.1277 381.3175
[180,] 369.5552 14.317583 339.7521 396.6975</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.2173666 12.859969  -27.94514430  21.7899654
  [2,]  -14.7204244 10.926792  -35.32795185   7.4610449
  [3,]  -42.2722822  9.282972  -59.62790181 -23.3775876
  [4,]    8.7191600  8.106489   -6.34201019  25.1197347
  [5,]   24.4835022  7.617057    9.72869290  39.5246637
  [6,]   62.6739444  7.942717   46.98138114  78.4679118
  [7,]   10.5398867  8.995373   -6.95983604  28.5334418
  [8,] -101.1630711 10.559808 -121.80462155 -79.9514205
  [9,]   19.6258711 12.444482   -4.87167504  44.4811302
 [10,]   35.7463133 14.525272    6.88594926  64.3366503
 [11,]   11.2970186 13.399561  -14.57424139  38.0181558
 [12,]   -7.9442385 11.455044  -30.45576215  14.9054269
 [13,]  -12.0053957  9.783729  -31.20806412   7.2862879
 [14,]  -12.0493529  8.547411  -29.34392751   4.4185873
 [15,]  -10.8134101  7.951643  -26.69901507   4.3489323
 [16,]   -4.3408673  8.138340  -20.58705167  11.1635123
 [17,]   -8.4455244  9.059252  -26.72614710   8.8537758
 [18,]   -6.1217816 10.523358  -27.30851299  14.3172520
 [19,]   -1.3264388 12.338785  -25.90418784  22.6211334
 [20,]    9.9189040 14.373020  -18.62889573  37.6817486
 [21,]  -14.0333083 13.048429  -39.02174315  11.3517044
 [22,]  -23.6463148 11.213368  -45.29763002  -1.9409716
 [23,]   11.4501786  9.660022   -7.57601239  30.1033726
 [24,]    5.0804721  8.543460  -11.95395853  21.4778682
 [25,]   -3.3450344  8.047589  -19.35784627  12.5278236
 [26,]  -17.0858409  8.284620  -33.44806150  -0.9546990
 [27,]   -7.0142475  9.198069  -25.25558889  10.8889486
 [28,]    8.4247460 10.614720  -13.08841131  29.0404225
 [29,]    8.7948395 12.362782  -16.11143501  32.6879544
 [30,]   -9.5936670 14.321409  -38.15067132  18.0853340
 [31,]   47.0310149 13.454499   20.37675561  72.4371956
 [32,]   20.1144476 11.470216   -2.57043808  41.6649166
 [33,]   -2.2034196  9.756119  -21.30745778  16.1331055
 [34,]   -6.7010868  8.477709  -23.62167443   9.2240663
 [35,]  -11.8109541  7.850792  -27.06869476   3.1841395
 [36,]   -5.7969213  8.029446  -21.56805132  10.1218569
 [37,]  -28.9169886  8.965643  -46.45264662 -10.9550267
 [38,]    3.3305442 10.457878  -16.68795273  24.0071772
 [39,]  -15.3554231 12.305501  -39.19076586   8.6032829
 [40,]   27.5696097 14.372097   -0.17789591  55.7364547
 [41,]   15.1207196 13.110928  -11.85424875  40.3779818
 [42,]    4.9384467 11.226686  -17.97243498  26.7739749
 [43,]   14.1846739  9.637741   -5.47296193  32.6317838
 [44,]   24.9050010  8.511122    8.07242117  41.6468847
 [45,]   13.4926281  8.043499   -2.24630180  29.5991130
 [46,]  -17.0403447  8.346383  -33.45344281  -0.4806237
 [47,]  -27.8584176  9.345153  -46.15243279  -9.3317490
 [48,]    9.3099095 10.849295  -12.33854346  30.6650611
 [49,]  -39.3352633 12.680224  -64.59647536 -14.1548673
 [50,]   30.9245638 14.716470    1.78341789  59.9288827
 [51,]  -25.4462468 11.941272  -49.82636104  -2.0802698
 [52,]  -27.7028572 10.374904  -48.48517079  -7.2582368
 [53,]   -7.7611676  9.099874  -25.86620716   9.8226362
 [54,]   18.8385220  8.252348    2.67285333  35.1965987
 [55,]   16.3248116  7.969896    1.03343021  32.5191299
 [56,]   -1.3482988  8.310335  -17.15870787  15.5828131
 [57,]  132.6081908  9.204811  115.03284312 151.1024936
 [58,]   15.0695804 10.512843   -5.15208860  36.1190370
 [59,]  -11.6690300 12.101059  -35.38304064  12.1693992
 [60,]  -98.3127404 13.873566 -125.21640842 -70.8831937
 [61,]   16.0717924 12.686169  -10.26201427  39.7283690
 [62,]   11.4758595 10.859868  -10.94128533  31.6972590
 [63,]  -11.6183735  9.312418  -30.73265117   5.8775484
 [64,]    1.1134935  8.203176  -15.70414726  16.7739142
 [65,]  -11.8337394  7.723315  -27.00717878   2.8543612
 [66,]   18.8532276  7.987092    3.26942535  34.5663277
 [67,]    2.4046946  8.928842  -15.02984855  20.1721779
 [68,]    8.9095617 10.365393  -11.59299468  29.2784291
 [69,]  -16.8788713 12.122089  -40.92130650   7.1517241
 [70,]    1.4953957 14.079605  -26.22186013  29.9117630
 [71,]   21.0045536 12.517682   -2.91850106  46.0499568
 [72,]   20.2642428 10.789127   -0.36898740  41.7870218
 [73,]  -24.0406680  9.347932  -42.12870139  -5.3208943
 [74,]  -24.2014788  8.344346  -40.30405117  -8.0578755
 [75,]  -11.3177896  7.945947  -27.16863326   3.9730658
 [76,]  -17.6194004  8.240979  -33.92168284  -1.8068318
 [77,]   -7.7542112  9.162700  -25.90534297  10.0547909
 [78,]    6.7754780 10.548086  -13.66406624  27.7185501
 [79,]   -0.4689327 12.240705  -24.41233217  23.6269240
 [80,]   29.6147565 14.130580    1.91546447  57.5637090
 [81,]   -8.6872484 13.495619  -35.28495512  17.9506821
 [82,]   23.7959693 11.487785    0.84030619  46.6584186
 [83,]    4.4837870  9.774670  -14.63903355  24.1192129
 [84,]   20.9395047  8.535610    4.12820478  37.8024146
 [85,]    1.7336225  7.994160  -13.76136219  17.6115188
 [86,]    5.0622402  8.288187  -11.07283972  21.4115124
 [87,]   -3.9773421  9.339111  -22.40316248  14.3492321
 [88,]  -13.9743244 10.930756  -35.90286652   7.2603235
 [89,]  -13.3869067 12.863956  -39.04316994  11.7481302
 [90,]  -11.7500889 15.007292  -41.29985743  17.2128388
 [91,]   26.7696468 13.323050   -0.08360995  52.4202403
 [92,]    8.9969902 11.426485  -14.07261914  31.1965227
 [93,]  -32.4094665  9.806876  -51.97423871 -13.6917540
 [94,]    2.8896769  8.621741  -14.29074134  19.6513290
 [95,]    3.2880202  8.064947  -12.53609918  19.2331618
 [96,]   10.1822636  8.264483   -5.90195185  26.6544419
 [97,]    3.3920069  9.171114  -15.08130818  21.8191872
 [98,]   -3.3876497 10.605015  -24.47519017  17.8802060
 [99,]   16.5724936 12.384374   -8.01996691  41.1238692
[100,]    0.4130370 14.381531  -27.89062592  28.8675745
[101,]    9.2692766 13.139615  -15.81506501  35.8556419
[102,]   -8.1012701 11.308679  -29.69133050  15.2019443
[103,]  -11.0764167  9.763857  -29.82528073   8.7457180
[104,]   -6.6640634  8.659648  -23.28402263  10.5961850
[105,]  -22.4598101  8.176554  -38.40042369  -6.0647625
[106,]  -14.9797567  8.422144  -31.45588541   1.9476918
[107,]  -14.7734034  9.339107  -33.09388719   4.1691722
[108,]    0.1797499 10.757103  -21.21058463  21.5960723
[109,]   16.7743033 12.506860   -8.32000481  41.9475420
[110,]   20.5547566 14.468509   -8.49816919  49.0950398
[111,]   17.5175674 12.959947   -6.59632063  43.7608080
[112,]  -12.3185660 11.061170  -33.17496996   9.8345036
[113,]  -16.5618993  9.457057  -34.44272951   2.7357975
[114,]  -34.2330327  8.319830  -50.40960780 -17.4388570
[115,]  -37.8372660  7.854962  -53.50852116 -22.4290612
[116,]    5.9773006  8.177927  -10.77010094  21.7892026
[117,]   38.7034673  9.206181   20.31257557  56.6487822
[118,]    5.1837339 10.739005  -16.50207852  26.7283051
[119,]   19.7589006 12.593487   -5.58999549  45.1455450
[120,]   -2.6692327 14.647962  -31.92476997  26.8383746
[121,]   -5.1165602 12.506284  -29.00821608  19.8474446
[122,]   36.9127486 10.765155   15.81362955  58.0806062
[123,]   -0.7527426  9.317056  -19.06545422  17.7984213
[124,]    2.4406661  8.316490  -14.20154853  19.2625859
[125,]  -13.8228251  7.934608  -29.74550298   1.9100164
[126,]   11.4815836  8.257695   -4.98948929  27.6516322
[127,]  -12.9072076  9.211872  -31.26360847   4.8552436
[128,]  -41.5600988 10.628507  -62.64691312 -20.7271836
[129,]    5.8844099 12.349464  -18.41010636  30.1133300
[130,]   24.4063187 14.265023   -3.61536989  51.7846741
[131,]  -50.0202766 12.530972  -74.99382841 -25.4456518
[132,]   12.4205958 10.796704   -8.95548448  33.4071621
[133,]   27.0292682  9.355029    8.79800805  45.5666206
[134,]   32.9303405  8.358740   16.94434884  49.7070123
[135,]   20.7391129  7.976511    5.03413626  36.9088715
[136,]   10.7516853  8.293679   -5.29512054  27.2789062
[137,]   -1.7263424  9.238491  -19.41616581  16.2052123
[138,]   -9.7962700 10.645117  -30.25354091  10.7728518
[139,]   -8.6641976 12.356842  -32.04182548  15.2074868
[140,]   -9.8390253 14.264248  -37.15426817  17.9499475
[141,]   17.3319422 12.322896   -6.69415136  41.5917730
[142,]    2.4755914 10.617765  -17.98606489  23.4059901
[143,]  -20.0886594  9.190198  -38.02454374  -1.9958905
[144,]  -11.0442103  8.186708  -27.04509568   5.0947368
[145,]   14.7516389  7.773303   -0.40016368  29.7374722
[146,]    5.7731881  8.041514   -9.75245226  21.2808952
[147,]  -24.6747627  8.930132  -42.36517479  -7.1425871
[148,]   13.9430864 10.279505   -6.55872565  34.2293097
[149,]   -5.2695644 11.934354  -28.65520990  17.8363261
[150,]    9.5937848 13.785101  -17.65330542  36.1894156
[151,]   -1.4815654 13.528167  -26.45783235  26.3371457
[152,]   -7.3462078 11.569572  -28.98811743  16.1743428
[153,]  -18.0930502  9.897667  -36.79095516   1.8494260
[154,]  -31.6449926  8.679732  -48.43595866 -14.5816036
[155,]  -19.7048349  8.122612  -35.51821583  -4.0589995
[156,]   41.8274227  8.359488   25.47716176  58.4442222
[157,]  -36.3423197  9.330079  -54.68767018 -17.6591519
[158,]   14.9709379 10.839042   -5.76194988  36.5699878
[159,]   17.4242955 12.695843   -7.44588132  42.7965393
[160,]    9.3659531 14.769874  -19.14960858  38.7061291
[161,]   17.6684060 12.388546   -7.12336361  41.9452363
[162,]   10.7869096 10.661924  -10.46751841  31.6603624
[163,]    6.7991132  9.238519  -11.48404177  24.9974825
[164,]    1.2458168  8.276288  -14.66580890  17.6091802
[165,]  -10.8170796  7.944603  -26.43519712   4.6533913
[166,]  -14.9194760  8.319229  -31.11346335   1.1478442
[167,]  -49.6095724  9.315337  -67.47504425 -31.2742947
[168,]  -13.6886688 10.761714  -34.34589934   7.5647231
[169,]   23.0175348 12.503063   -1.16610283  47.5579357
[170,]   32.2621384 14.433008    4.51280429  60.3940480
[171,]    6.1700311 12.488257  -18.40582808  30.5368235
[172,]   -1.5802874 10.771663  -22.77083100  19.3312293
[173,]   10.7298940  9.351202   -7.82727680  28.8305475
[174,]   11.9520754  8.378862   -4.83685899  28.2468533
[175,]  -23.3195432  8.019336  -39.16946966  -8.2306098
[176,]    7.3028382  8.352141   -8.80387555  23.1865149
[177,]    0.3644197  9.303272  -17.79642939  18.8385453
[178,]   -2.7100989 10.709228  -23.06095009  19.2695728
[179,]   11.3990825 12.416454  -12.17576651  37.0140144
[180,]   -5.4316361 14.317583  -32.57390007  24.3715164</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.5  3.4
looic      1770.4 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1433      
 (0.5, 0.7]   (ok)         3    1.7%   123       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.1 22.6
p_loo        34.7  8.7
looic      1724.2 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     175   97.2%   721       
 (0.5, 0.7]   (ok)         2    1.1%   670       
   (0.7, 1]   (bad)        1    0.6%   28        
   (1, Inf)   (very bad)   2    1.1%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.1      11.9  
fit_sleep1 -91.3      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.4
p_loo        19.5  3.4
looic      1770.4 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1433      
 (0.5, 0.7]   (ok)         3    1.7%   123       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.1 22.6
p_loo        34.7  8.7
looic      1724.2 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     175   97.2%   721       
 (0.5, 0.7]   (ok)         2    1.1%   670       
   (0.7, 1]   (bad)        1    0.6%   28        
   (1, Inf)   (very bad)   2    1.1%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.1     22.6        34.7    8.7   1724.2
fit_sleep2  -23.1      11.9  -885.2     14.4        19.5    3.4   1770.4
fit_sleep1  -91.3      21.2  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   45.1  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
2.274440e-40 9.574401e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.86      1.57     0.19     5.36       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.14      1.57    -3.32     2.92       5.34      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>recompiling to avoid crashing R session</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.21.8       
[4] ggplot2_3.4.2       StanHeaders_2.26.27 lme4_1.1-33        
[7] Matrix_1.5-4.1     

loaded via a namespace (and not attached):
  [1] tidyselect_1.2.0     dplyr_1.1.2          farver_2.1.1        
  [4] loo_2.6.0            fastmap_1.1.1        tensorA_0.36.2      
  [7] shinystan_2.6.0      shinyjs_2.1.0        promises_1.2.0.1    
 [10] digest_0.6.32        mime_0.12            lifecycle_1.0.3     
 [13] ellipsis_0.3.2       processx_3.8.1       magrittr_2.0.3      
 [16] posterior_1.4.1      compiler_4.3.1       rlang_1.1.1         
 [19] sass_0.4.6           tools_4.3.1          igraph_1.5.0        
 [22] utf8_1.2.3           yaml_2.3.7           knitr_1.43          
 [25] labeling_0.4.2       prettyunits_1.1.1    bridgesampling_1.1-2
 [28] htmlwidgets_1.6.2    pkgbuild_1.4.2       plyr_1.8.8          
 [31] dygraphs_1.1.1.6     abind_1.4-5          miniUI_0.1.1.1      
 [34] withr_2.5.0          grid_4.3.1           stats4_4.3.1        
 [37] fansi_1.0.4          xts_0.13.1           xtable_1.8-4        
 [40] colorspace_2.1-0     inline_0.3.19        gtools_3.9.4        
 [43] scales_1.2.1         MASS_7.3-60          cli_3.6.1           
 [46] mvtnorm_1.2-2        rmarkdown_2.22       crayon_1.5.2        
 [49] generics_0.1.3       RcppParallel_5.1.7   rstudioapi_0.14     
 [52] reshape2_1.4.4       minqa_1.2.5          cachem_1.0.8        
 [55] stringr_1.5.0        shinythemes_1.2.0    splines_4.3.1       
 [58] bayesplot_1.10.0     parallel_4.3.1       base64enc_0.1-3     
 [61] matrixStats_1.0.0    vctrs_0.6.3          boot_1.3-28.1       
 [64] jsonlite_1.8.5       callr_3.7.3          crosstalk_1.2.0     
 [67] jquerylib_0.1.4      glue_1.6.2           nloptr_2.0.3        
 [70] codetools_0.2-19     ps_1.7.5             DT_0.28             
 [73] distributional_0.3.2 stringi_1.7.12       gtable_0.3.3        
 [76] later_1.3.1          munsell_0.5.0        tibble_3.2.1        
 [79] colourpicker_1.2.0   pillar_1.9.0         htmltools_0.5.5     
 [82] Brobdingnag_1.2-9    R6_2.5.1             evaluate_0.21       
 [85] shiny_1.7.4          lattice_0.21-8       highr_0.10          
 [88] markdown_1.7         threejs_0.3.3        backports_1.4.1     
 [91] httpuv_1.6.11        bslib_0.5.0          rstantools_2.3.1    
 [94] coda_0.19-4          gridExtra_2.3        nlme_3.1-162        
 [97] checkmate_2.2.0      xfun_0.39            zoo_1.8-12          
[100] pkgconfig_2.0.3     </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
