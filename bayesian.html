<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.69      6.68    15.52    41.37 1.00     1927     2521
sd(Days)                6.62      1.58     4.13    10.19 1.00     1428     1641
cor(Intercept,Days)     0.09      0.31    -0.48     0.67 1.00      905     1419

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.06      7.55   236.46   266.45 1.00     1814     2395
Days         10.36      1.69     6.96    13.90 1.00     1208     1542

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.56    23.05    29.21 1.00     3186     2247

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.8685  13.04014 227.5357 279.1388
309 211.5695  13.29343 185.6881 237.2288
310 213.0298  13.34167 186.7358 238.9493
330 274.2442  13.48593 249.3554 301.1688
331 272.9168  13.16717 248.5353 299.1853
332 259.8450  12.38769 235.8744 284.6972
333 267.6095  12.09158 244.8532 292.1504
334 244.3275  12.44506 220.2403 268.5294
335 250.6781  13.53736 225.0456 277.9472
337 285.8195  13.18831 260.3872 312.9497
349 226.8626  13.05765 200.8281 251.2652
350 238.8072  13.20372 211.6819 263.7470
351 255.5624  12.31579 232.1067 279.7091
352 272.1054  12.39018 247.8966 296.4484
369 254.6573  12.34937 230.2962 279.4187
370 226.5379  13.60787 198.0967 252.1180
371 252.0666  12.28559 228.0660 275.8338
372 263.7548  12.60099 240.0379 288.7258

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5997942  2.506257 14.7897235 24.605896
309  1.7200254  2.478191 -2.9852725  6.507447
310  4.9285209  2.509929  0.2103693  9.720949
330  5.7578570  2.536076  0.7811460 10.627035
331  7.5464735  2.468584  2.4238724 12.133912
332 10.2863596  2.377187  5.4967671 15.022542
333 10.2991535  2.335164  5.6613626 14.717398
334 11.5123910  2.397906  6.9837989 16.213309
335 -0.2075454  2.587764 -5.3914509  4.749495
337 19.1417531  2.488059 14.2436140 24.104258
349 11.5317326  2.480574  6.8528003 16.481161
350 17.0044861  2.505719 12.2263431 22.037304
351  7.5448733  2.334667  2.9713270 12.113018
352 14.0378126  2.355046  9.3073935 18.599563
369 11.3536836  2.319921  6.7509200 15.762288
370 15.1825191  2.553899 10.3312301 20.319421
371  9.5119237  2.382423  4.7684890 14.273124
372 11.6959646  2.365608  7.0287503 16.313806</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.8685 13.040141 227.5357 279.1388
  [2,] 273.4683 11.143662 250.9628 295.1538
  [3,] 293.0681  9.533088 274.1623 311.4332
  [4,] 312.6679  8.375021 296.2666 329.0028
  [5,] 332.2677  7.871774 316.5986 348.0041
  [6,] 351.8675  8.145633 336.1247 367.8302
  [7,] 371.4673  9.126910 353.9987 389.1063
  [8,] 391.0671 10.621313 370.5306 412.0294
  [9,] 410.6669 12.445351 386.6278 435.0830
 [10,] 430.2667 14.474939 402.3326 458.5246
 [11,] 211.5695 13.293429 185.6881 237.2288
 [12,] 213.2896 11.412704 191.0291 235.0929
 [13,] 215.0096  9.801390 195.8661 233.7531
 [14,] 216.7296  8.612057 199.8734 233.2342
 [15,] 218.4496  8.034344 202.7419 234.3278
 [16,] 220.1697  8.198579 204.4193 236.2291
 [17,] 221.8897  9.064523 204.3031 239.8849
 [18,] 223.6097 10.459317 203.0480 244.4162
 [19,] 225.3297 12.202947 201.5795 249.4766
 [20,] 227.0498 14.167194 199.4182 255.4548
 [21,] 213.0298 13.341667 186.7358 238.9493
 [22,] 217.9583 11.465839 195.4467 240.0682
 [23,] 222.8868  9.875746 203.5705 241.7348
 [24,] 227.8154  8.728959 210.9671 245.1416
 [25,] 232.7439  8.213318 217.0259 249.4464
 [26,] 237.6724  8.445231 221.6379 254.6248
 [27,] 242.6009  9.369352 224.2325 261.3647
 [28,] 247.5294 10.809582 226.2730 268.8542
 [29,] 252.4580 12.590030 227.7760 277.4825
 [30,] 257.3865 14.586643 228.4340 285.9330
 [31,] 274.2442 13.485927 249.3554 301.1688
 [32,] 280.0021 11.535901 258.3456 303.2480
 [33,] 285.7599  9.856325 267.0427 305.7449
 [34,] 291.5178  8.607012 274.5854 308.7366
 [35,] 297.2757  7.992342 281.6139 313.1512
 [36,] 303.0335  8.157069 286.9738 318.6816
 [37,] 308.7914  9.058774 290.6940 326.5262
 [38,] 314.5492 10.509442 293.8496 335.2998
 [39,] 320.3071 12.316604 295.7153 344.5595
 [40,] 326.0649 14.346165 297.1144 354.6088
 [41,] 272.9168 13.167169 248.5353 299.1853
 [42,] 280.4633 11.305122 259.4299 302.9295
 [43,] 288.0098  9.717256 269.2234 307.4330
 [44,] 295.5563  8.557578 279.0066 312.6356
 [45,] 303.1027  8.014178 287.1714 319.1438
 [46,] 310.6492  8.210346 294.1013 327.1233
 [47,] 318.1957  9.098370 300.1655 336.0881
 [48,] 325.7422 10.504223 304.8699 346.2160
 [49,] 333.2886 12.250913 308.7482 356.5435
 [50,] 340.8351 14.213334 312.1316 367.7464
 [51,] 259.8450 12.387687 235.8744 284.6972
 [52,] 270.1314 10.656225 249.8612 291.7449
 [53,] 280.4177  9.217239 262.8710 298.7328
 [54,] 290.7041  8.225686 274.7191 306.7999
 [55,] 300.9904  7.852920 285.4755 316.2584
 [56,] 311.2768  8.183937 294.7967 327.1114
 [57,] 321.5632  9.142611 303.2331 338.9323
 [58,] 331.8495 10.559351 310.7680 351.8674
 [59,] 342.1359 12.276582 317.8216 365.5770
 [60,] 352.4222 14.185595 323.9280 379.6824
 [61,] 267.6095 12.091577 244.8532 292.1504
 [62,] 277.9086 10.407984 257.9249 299.0213
 [63,] 288.2078  9.019535 270.8233 306.5218
 [64,] 298.5069  8.079842 282.7499 314.8508
 [65,] 308.8061  7.753817 293.8625 324.4595
 [66,] 319.1052  8.115756 303.4305 335.1046
 [67,] 329.4044  9.083792 311.9824 347.5406
 [68,] 339.7035 10.491475 319.1182 360.7314
 [69,] 350.0027 12.187404 326.5870 374.3005
 [70,] 360.3018 14.067712 333.0411 388.0059
 [71,] 244.3275 12.445056 220.2403 268.5294
 [72,] 255.8399 10.700958 234.9133 276.9306
 [73,] 267.3522  9.254268 249.3385 285.3355
 [74,] 278.8646  8.262709 262.9122 294.9303
 [75,] 290.3770  7.899566 275.0613 305.6018
 [76,] 301.8894  8.248263 285.3398 317.6673
 [77,] 313.4018  9.228458 294.8424 331.4376
 [78,] 324.9142 10.667472 303.7755 345.7508
 [79,] 336.4266 12.406666 312.3220 360.8249
 [80,] 347.9390 14.337213 319.9181 375.8761
 [81,] 250.6781 13.537364 225.0456 277.9472
 [82,] 250.4705 11.535701 228.3914 273.7543
 [83,] 250.2630  9.812115 231.2524 270.3392
 [84,] 250.0554  8.536736 233.5879 266.9087
 [85,] 249.8479  7.928881 234.7274 265.2397
 [86,] 249.6404  8.139503 233.7564 265.4445
 [87,] 249.4328  9.112020 231.5873 267.4355
 [88,] 249.2253 10.639518 227.9272 270.3260
 [89,] 249.0177 12.520496 223.4783 274.1648
 [90,] 248.8102 14.619144 219.5059 278.4436
 [91,] 285.8195 13.188312 260.3872 312.9497
 [92,] 304.9613 11.293131 283.1104 327.8312
 [93,] 324.1030  9.670516 305.1316 343.2146
 [94,] 343.2448  8.478434 326.6274 359.9103
 [95,] 362.3865  7.913892 346.8831 378.0683
 [96,] 381.5283  8.109031 365.5286 397.9350
 [97,] 400.6700  9.014653 382.4416 418.7930
 [98,] 419.8118 10.447603 399.0578 440.8210
 [99,] 438.9535 12.223818 414.9504 463.2361
[100,] 458.0953 14.215201 429.9387 486.7218
[101,] 226.8626 13.057648 200.8281 251.2652
[102,] 238.3944 11.185386 215.8169 259.4049
[103,] 249.9261  9.593228 230.4196 268.0533
[104,] 261.4578  8.441191 244.5357 277.6486
[105,] 272.9896  7.923627 257.3140 288.2431
[106,] 284.5213  8.162139 268.5431 300.5150
[107,] 296.0530  9.097454 278.3909 313.9401
[108,] 307.5848 10.545772 287.1235 327.9757
[109,] 319.1165 12.327588 295.4915 343.2840
[110,] 330.6482 14.318941 303.1668 358.7868
[111,] 238.8072 13.203719 211.6819 263.7470
[112,] 255.8117 11.311189 232.5166 277.3274
[113,] 272.8162  9.700777 253.5038 291.3833
[114,] 289.8207  8.533720 272.8669 306.3522
[115,] 306.8252  8.006307 291.3851 322.4457
[116,] 323.8296  8.242256 307.5571 340.0153
[117,] 340.8341  9.182911 322.6128 358.9903
[118,] 357.8386 10.643035 336.8975 378.7191
[119,] 374.8431 12.441052 350.2274 399.4024
[120,] 391.8476 14.451388 362.9820 420.4086
[121,] 255.5624 12.315787 232.1067 279.7091
[122,] 263.1072 10.643528 242.8841 283.9178
[123,] 270.6521  9.262404 252.9310 288.8360
[124,] 278.1970  8.318707 262.0412 294.4849
[125,] 285.7418  7.969379 270.1812 301.1008
[126,] 293.2867  8.289900 277.3093 309.2075
[127,] 300.8316  9.210604 282.9042 318.5207
[128,] 308.3765 10.575885 287.7741 328.5068
[129,] 315.9213 12.237843 291.9120 339.1676
[130,] 323.4662 14.091899 295.6238 350.2210
[131,] 272.1054 12.390177 247.8966 296.4484
[132,] 286.1432 10.661916 265.1697 307.3505
[133,] 300.1811  9.215686 281.9526 318.3062
[134,] 314.2189  8.202060 298.0465 330.5459
[135,] 328.2567  7.791738 312.9851 343.5459
[136,] 342.2945  8.077193 326.6447 357.9926
[137,] 356.3323  8.992408 338.7181 374.1607
[138,] 370.3701 10.371993 349.5967 390.5893
[139,] 384.4079 12.057593 360.8577 407.8644
[140,] 398.4457 13.938628 370.6273 425.7498
[141,] 254.6573 12.349371 230.2962 279.4187
[142,] 266.0110 10.699570 244.9125 287.1859
[143,] 277.3646  9.339095 258.9995 296.0764
[144,] 288.7183  8.409557 272.2375 305.3758
[145,] 300.0720  8.061431 284.2621 315.6554
[146,] 311.4257  8.367602 295.0791 327.6202
[147,] 322.7794  9.263419 304.4536 340.6121
[148,] 334.1331 10.600432 313.1689 354.4592
[149,] 345.4867 12.234846 322.0047 368.9806
[150,] 356.8404 14.063350 329.5321 384.0327
[151,] 226.5379 13.607867 198.0967 252.1180
[152,] 241.7204 11.631901 217.5497 263.4939
[153,] 256.9029  9.923356 236.8077 275.6898
[154,] 272.0855  8.642318 254.8603 288.6623
[155,] 287.2680  7.996946 271.3594 302.8257
[156,] 302.4505  8.139867 286.2036 318.5905
[157,] 317.6330  9.033743 299.9558 336.0707
[158,] 332.8155 10.488298 312.2369 354.3109
[159,] 347.9980 12.306303 323.8156 372.7729
[160,] 363.1806 14.350281 335.6619 391.9248
[161,] 252.0666 12.285593 228.0660 275.8338
[162,] 261.5786 10.548491 240.9282 281.8333
[163,] 271.0905  9.108096 253.3514 288.6734
[164,] 280.6024  8.123795 264.8302 296.4975
[165,] 290.1143  7.770879 275.1946 305.4779
[166,] 299.6262  8.131972 284.0023 315.5966
[167,] 309.1382  9.122677 291.2714 327.0835
[168,] 318.6501 10.567375 297.9310 339.7491
[169,] 328.1620 12.307212 304.3206 352.7516
[170,] 337.6739 14.234373 309.5284 365.9735
[171,] 263.7548 12.600994 240.0379 288.7258
[172,] 275.4507 10.864901 255.0985 297.1537
[173,] 287.1467  9.407405 269.2584 306.0252
[174,] 298.8427  8.375242 282.9183 315.4882
[175,] 310.5386  7.936138 295.4442 326.2303
[176,] 322.2346  8.186092 306.3355 338.5870
[177,] 333.9306  9.068302 316.5415 351.7517
[178,] 345.6265 10.423450 326.0838 365.7107
[179,] 357.3225 12.093581 334.0925 380.6074
[180,] 369.0185 13.966148 342.3360 395.8953</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.3085421 13.040141  -29.5787814  22.0243035
  [2,]  -14.7636364 11.143662  -36.4490533   7.7419373
  [3,]  -42.2675306  9.533088  -60.6326464 -23.3617033
  [4,]    8.7718752  8.375021   -7.5629627  25.1732292
  [5,]   24.5841810  7.871774    8.8478193  40.2532944
  [6,]   62.8225868  8.145633   46.8599010  78.5653773
  [7,]   10.7364926  9.126910   -6.9024541  28.2050565
  [8,] -100.9185016 10.621313 -121.8807661 -80.3819849
  [9,]   19.9184042 12.445351   -4.4977311  43.9575381
 [10,]   36.0868100 14.474939    7.8288664  64.0209092
 [11,]   11.1643707 13.293429  -14.4949332  37.0458075
 [12,]   -8.0237548 11.412704  -29.8271331  14.2366976
 [13,]  -12.0317802  9.801390  -30.7753357   7.1117452
 [14,]  -12.0226057  8.612057  -28.5272241   4.8336203
 [15,]  -10.7335311  8.034344  -26.6117032   4.9742108
 [16,]   -4.2078565  8.198579  -20.2673488  11.5424804
 [17,]   -8.2593820  9.064523  -26.2545948   9.3272092
 [18,]   -5.8825074 10.459317  -26.6889944  14.6792017
 [19,]   -1.0340328 12.202947  -25.1808752  22.7161792
 [20,]   10.2644417 14.167194  -18.1406227  37.8960219
 [21,]  -13.9759023 13.341667  -39.8953650  12.3181320
 [22,]  -23.6261232 11.465839  -45.7359750  -1.1144674
 [23,]   11.4331559  9.875746   -7.4148149  30.7494934
 [24,]    5.0262349  8.728959  -12.2999733  21.8744652
 [25,]   -3.4364860  8.213318  -20.1390003  12.2815302
 [26,]  -17.2145069  8.445231  -34.1669128  -1.1799959
 [27,]   -7.1801278  9.369352  -25.9439009  11.1882770
 [28,]    8.2216513 10.809582  -13.1030553  29.4780846
 [29,]    8.5545303 12.590030  -16.4699911  33.2365277
 [30,]   -9.8711906 14.586643  -38.4177234  19.0813326
 [31,]   47.2983669 13.485927   20.3737733  72.1872161
 [32,]   20.3981098 11.535901   -2.8478104  42.0545570
 [33,]   -1.9034472  9.856325  -21.8884127  16.8137644
 [34,]   -6.3848043  8.607012  -23.6035962  10.5476029
 [35,]  -11.4783613  7.992342  -27.3538867   4.1834065
 [36,]   -5.4480184  8.157069  -21.0961201  10.6117171
 [37,]  -28.5517754  9.058774  -46.2865545 -10.4544263
 [38,]    3.7120676 10.509442  -17.0384598  24.4116616
 [39,]  -14.9575895 12.316604  -39.2099981   9.6341674
 [40,]   27.9837535 14.346165   -0.5601042  56.9343263
 [41,]   14.6910570 13.167169  -11.5774174  39.0725835
 [42,]    4.5366835 11.305122  -17.9294590  25.5700704
 [43,]   13.8108100  9.717256   -5.6123878  32.5971999
 [44,]   24.5590365  8.557578    7.4797024  41.1087443
 [45,]   13.1745630  8.014178   -2.8665461  29.1059181
 [46,]  -17.3305105  8.210346  -33.8046384  -0.7826303
 [47,]  -28.1206841  9.098370  -46.0131108 -10.0905360
 [48,]    9.0755424 10.504223  -11.3983430  29.9477574
 [49,]  -39.5417311 12.250913  -62.7965997 -15.0012899
 [50,]   30.7459954 14.213334    3.8346575  59.4495355
 [51,]  -24.9844040 12.387687  -49.8365515  -1.0138269
 [52,]  -27.3195636 10.656225  -48.9330881  -7.0494015
 [53,]   -7.4564232  9.217239  -25.7714903  10.0903204
 [54,]   19.0647173  8.225686    2.9688936  35.0496606
 [55,]   16.4724577  7.852920    1.2044773  31.9874153
 [56,]   -1.2792019  8.183937  -17.1138494  15.2009184
 [57,]  132.5987385  9.142611  115.2295968 150.9287942
 [58,]   14.9815790 10.559351   -5.0362781  36.0630555
 [59,]  -11.8355806 12.276582  -35.2766556  12.4786555
 [60,]  -98.5578402 14.185595 -125.8180259 -70.0635993
 [61,]   16.2329371 12.091577   -8.3080452  38.9892368
 [62,]   11.6463836 10.407984   -9.4663020  31.6301412
 [63,]  -11.4384699  9.019535  -29.7525412   5.9459911
 [64,]    1.3027766  8.079842  -15.0411433  17.0597694
 [65,]  -11.6350770  7.753817  -27.2884779   3.3084904
 [66,]   19.0612695  8.115756    3.0619370  34.7359705
 [67,]    2.6221160  9.083792  -15.5141500  20.0440982
 [68,]    9.1363625 10.491475  -11.8915182  29.7216686
 [69,]  -16.6426911 12.187404  -40.9404988   6.7730442
 [70,]    1.7409554 14.067712  -25.9630672  29.0017283
 [71,]   21.1456401 12.445056   -3.0563248  45.2327789
 [72,]   20.3613491 10.700958   -0.7294354  41.2879266
 [73,]  -23.9875419  9.254268  -41.9708082  -5.9737749
 [74,]  -24.1923329  8.262709  -40.2579748  -8.2399166
 [75,]  -11.3526239  7.899566  -26.5774497   3.9631440
 [76,]  -17.6982149  8.248263  -33.4761082  -1.1486311
 [77,]   -7.8770059  9.228458  -25.9128318  10.6824351
 [78,]    6.6087031 10.667472  -14.2278573  27.7474438
 [79,]   -0.6796879 12.406666  -25.0779642  23.4249273
 [80,]   29.3600211 14.337213    1.4229477  57.3809235
 [81,]   -9.0697810 13.537364  -36.3388756  16.5626668
 [82,]   23.4766644 11.535701    0.1929315  45.5558352
 [83,]    4.2277098  9.812115  -15.8485223  23.2382718
 [84,]   20.7466553  8.536736    3.8934338  37.2141765
 [85,]    1.6040007  7.928881  -13.7878351  16.7245066
 [86,]    4.9958462  8.139503  -10.8083078  20.8797991
 [87,]   -3.9805084  9.112020  -21.9831999  13.8650470
 [88,]  -13.9142629 10.639518  -35.0149710   7.3838187
 [89,]  -13.2636175 12.520496  -38.4107358  12.2758012
 [90,]  -11.5635720 14.619144  -41.1969972  17.7406666
 [91,]   26.5470921 13.188312   -0.5830865  51.9794258
 [92,]    8.8445390 11.293131  -14.0253680  30.6954310
 [93,]  -32.4918141  9.670516  -51.6033682 -13.5203956
 [94,]    2.8774328  8.478434  -13.7880706  19.4948458
 [95,]    3.3458797  7.913892  -12.3359003  18.8492744
 [96,]   10.3102266  8.109031   -6.0964574  26.3099107
 [97,]    3.5900736  9.014653  -14.5328929  21.8185344
 [98,]   -3.1194795 10.447603  -24.1287483  17.6344725
 [99,]   16.9107674 12.223818   -7.3717593  40.9139088
[100,]    0.8214143 14.215201  -27.8050578  28.9779509
[101,]    9.2405662 13.057648  -15.1620435  35.2751375
[102,]   -8.0776664 11.185386  -29.0882324  14.4997757
[103,]  -11.0004990  9.593228  -29.1277368   8.5060286
[104,]   -6.5358316  8.441191  -22.7266467  10.3863217
[105,]  -22.2792642  7.923627  -37.5327539  -6.6036596
[106,]  -14.7468967  8.162139  -30.7405665   1.2313441
[107,]  -14.4882293  9.097454  -32.3753490   3.1739047
[108,]    0.5172381 10.545772  -19.8737287  20.9784595
[109,]   17.1641055 12.327588   -7.0033808  40.7891303
[110,]   20.9968729 14.318941   -7.1417240  48.4782506
[111,]   17.4895916 13.203719   -7.4501944  44.6148682
[112,]  -12.3573945 11.311189  -33.8730585  10.9377156
[113,]  -16.6115806  9.700777  -35.1786969   2.7007988
[114,]  -34.2935667  8.533720  -50.8250611 -17.3397707
[115,]  -37.9086529  8.006307  -53.5291911 -22.4686205
[116,]    5.8950610  8.242256  -10.2906174  22.1676229
[117,]   38.6103749  9.182911   20.4542119  56.8316885
[118,]    5.0797888 10.643035  -15.8006942  26.0208960
[119,]   19.6441027 12.441052   -4.9152319  44.2597523
[120,]   -2.7948835 14.451388  -31.3558914  26.0706653
[121,]   -5.0358554 12.315787  -29.1826141  18.4197681
[122,]   36.9503713 10.643528   16.1397581  57.1734809
[123,]   -0.7582020  9.262404  -18.9420805  16.9629277
[124,]    2.3921246  8.318707  -13.8957898  18.5479081
[125,]  -13.9144487  7.969379  -29.2734479   1.6462445
[126,]   11.3468779  8.289900   -4.5738692  27.3243411
[127,]  -13.0849954  9.210604  -30.7740618   4.8424352
[128,]  -41.7809687 10.575885  -61.9113487 -21.1785578
[129,]    5.6204579 12.237843  -17.6258114  29.6298446
[130,]   24.0992846 14.091899   -2.6555312  51.9416967
[131,]  -50.4283301 12.390177  -74.7713363 -26.2194558
[132,]   12.0506573 10.661916   -9.1565646  33.0241865
[133,]   26.6974446  9.215686    8.5723174  44.9258535
[134,]   32.6366320  8.202060   16.3096254  48.8089679
[135,]   20.4835194  7.791738    5.1943182  35.7550525
[136,]   10.5342068  8.077193   -5.1638904  26.1839833
[137,]   -1.9057058  8.992408  -19.7340816  15.7085005
[138,]   -9.9375184 10.371993  -30.1566848  10.8359223
[139,]   -8.7673310 12.057593  -32.2237948  14.7828680
[140,]   -9.9040436 13.938628  -37.2081064  17.9144087
[141,]   17.2662328 12.349371   -7.4952137  41.6273295
[142,]    2.4259492 10.699570  -18.7490026  23.5243546
[143,]  -20.1222344  9.339095  -38.8339792  -1.7571279
[144,]  -11.0617180  8.409557  -27.7191755   5.4190607
[145,]   14.7501984  8.061431   -0.8331842  30.5600999
[146,]    5.7878148  8.367602  -10.4067113  22.1344018
[147,]  -24.6440688  9.263419  -42.4768340  -6.3183304
[148,]   13.9898476 10.600432   -6.3362895  34.9540056
[149,]   -5.2067360 12.234846  -28.7005901  18.2752504
[150,]    9.6726804 14.063350  -17.5195715  36.9809990
[151,]   -1.2738946 13.607867  -26.8539568  27.1672939
[152,]   -7.1969136 11.631901  -28.9703742  16.9737756
[153,]  -18.0021327  9.923356  -36.7890148   2.0931010
[154,]  -31.6124517  8.642318  -48.1892878 -14.3873489
[155,]  -19.7306708  7.996946  -35.2883552  -3.8220728
[156,]   41.7432101  8.139867   25.6032324  57.9901016
[157,]  -36.4849089  9.033743  -54.9225614 -18.8076524
[158,]   14.7699720 10.488298   -6.7253779  35.3485868
[159,]   17.1649529 12.306303   -7.6098800  41.3473679
[160,]    9.0482339 14.350281  -19.6959667  36.5668827
[161,]   17.8137710 12.285593   -5.9533903  41.8144103
[162,]   10.8642473 10.548491   -9.3904546  31.5145975
[163,]    6.8084235  9.108096  -10.7745239  24.5474845
[164,]    1.1870998  8.123795  -14.7079969  16.9593018
[165,]  -10.9438239  7.770879  -26.3074171   3.9759053
[166,]  -15.1142477  8.131972  -31.0846202   0.5096961
[167,]  -49.8723714  9.122677  -67.8177294 -32.0055732
[168,]  -14.0194951 10.567375  -35.1184682   6.6996425
[169,]   22.6186811 12.307212   -1.9709085  46.4601148
[170,]   31.7952574 14.234373    3.4956946  59.9408044
[171,]    5.6569179 12.600994  -19.3140808  29.3737754
[172,]   -1.9767467 10.864901  -23.6796594  18.3755308
[173,]   10.4500887  9.407405   -8.4283906  28.3383502
[174,]   11.7889241  8.375242   -4.8565783  27.7132799
[175,]  -23.3660405  7.936138  -39.0577268  -8.2716217
[176,]    7.3729949  8.186092   -8.9794197  23.2721446
[177,]    0.5512303  9.068302  -17.2699229  17.9402815
[178,]   -2.4066342 10.423450  -22.4908234  17.1360735
[179,]   11.8192012 12.093581  -11.4657092  35.0491574
[180,]   -4.8948634 13.966148  -31.7717280  21.7876072</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.2  3.2
looic      1769.4 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   583       
 (0.5, 0.7]   (ok)         1    0.6%   158       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.3
p_loo        34.0  8.4
looic      1722.4 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1067      
 (0.5, 0.7]   (ok)         5    2.8%   636       
   (0.7, 1]   (bad)        3    1.7%   23        
   (1, Inf)   (very bad)   1    0.6%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.5      11.6  
fit_sleep1 -92.1      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.7 14.3
p_loo        19.2  3.2
looic      1769.4 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   583       
 (0.5, 0.7]   (ok)         1    0.6%   158       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.2 22.3
p_loo        34.0  8.4
looic      1722.4 44.5
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   1067      
 (0.5, 0.7]   (ok)         5    2.8%   636       
   (0.7, 1]   (bad)        3    1.7%   23        
   (1, Inf)   (very bad)   1    0.6%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.2     22.3        34.0    8.4   1722.4
fit_sleep2  -23.5      11.6  -884.7     14.3        19.2    3.2   1769.4
fit_sleep1  -92.1      20.9  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.5  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.021468e-40 6.312712e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88      1.59     0.24     5.45       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12      1.59    -3.32     3.03       5.64      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.3         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.3.1      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
