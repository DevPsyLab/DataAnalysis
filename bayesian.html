<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.70      6.98    15.39    42.37 1.00     1742     2256
sd(Days)                6.55      1.50     4.14     9.98 1.00     1432     1978
cor(Intercept,Days)     0.09      0.30    -0.49     0.68 1.00     1075     1591

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.18      7.28   237.21   265.66 1.00     2087     2413
Days         10.44      1.72     6.91    13.78 1.00     1562     1665

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.95      1.61    23.00    29.33 1.00     3512     2964

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6255  13.06875 226.8243 279.2541
309 211.5370  13.39957 183.8979 237.4555
310 213.1928  13.27633 186.6088 238.2312
330 274.3206  13.39631 248.7518 301.3792
331 272.9653  13.34129 247.4921 300.1909
332 260.1600  12.47885 235.6099 284.7425
333 267.8630  12.77689 243.4652 293.4133
334 244.3134  12.22792 220.1947 268.5076
335 250.9031  13.36096 225.1953 277.3981
337 285.7210  12.86221 261.1828 311.9663
349 226.8403  12.81356 200.7039 250.3712
350 238.7543  12.87616 213.3423 263.4750
351 255.8003  12.47978 231.7825 281.4751
352 271.5641  12.75942 247.8715 297.0213
369 254.9562  12.62725 230.7883 279.9148
370 226.5907  13.61458 198.7794 252.6872
371 252.3551  12.32823 228.2857 276.2707
372 263.4931  12.15317 239.9239 287.6044

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6802732  2.498554 14.89316393 24.646674
309  1.7778481  2.566000 -3.20479487  6.798264
310  4.8934380  2.452795  0.06046626  9.757712
330  5.7754940  2.535277  0.73738180 10.497493
331  7.4801522  2.576786  2.35661219 12.398715
332 10.2015024  2.369419  5.64125720 14.790303
333 10.3345113  2.441977  5.57619575 15.089218
334 11.4950685  2.364705  6.84405255 16.026209
335 -0.2654851  2.563128 -5.39218635  4.610345
337 19.1452753  2.456207 14.24414311 23.951170
349 11.5477396  2.461300  6.90407569 16.475143
350 17.0016728  2.443630 12.22942836 21.730030
351  7.4454025  2.413585  2.61806162 12.067806
352 14.1415847  2.395957  9.37487361 18.617175
369 11.3144937  2.405258  6.69300334 15.892070
370 15.1858574  2.550616 10.25507764 20.163251
371  9.5071606  2.404397  4.69768203 14.098740
372 11.7961052  2.290657  7.30978612 16.323506</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6255 13.068748 226.8243 279.2541
  [2,] 273.3058 11.196626 250.5529 294.9755
  [3,] 292.9860  9.613648 273.8101 311.6999
  [4,] 312.6663  8.483252 295.4952 329.1655
  [5,] 332.3466  7.999654 316.2231 347.6981
  [6,] 352.0268  8.277011 335.7425 368.3486
  [7,] 371.7071  9.247102 353.7060 390.3691
  [8,] 391.3874 10.723545 370.3417 412.9597
  [9,] 411.0677 12.528588 386.1798 435.7002
 [10,] 430.7479 14.540362 401.7286 459.2252
 [11,] 211.5370 13.399566 183.8979 237.4555
 [12,] 213.3148 11.437898 189.8003 235.4578
 [13,] 215.0927  9.760705 195.3248 234.0268
 [14,] 216.8705  8.537325 200.0120 233.7249
 [15,] 218.6484  7.979298 203.1948 234.6523
 [16,] 220.4262  8.223211 204.7711 236.8817
 [17,] 222.2041  9.205537 204.6612 240.8077
 [18,] 223.9819 10.725267 203.2289 245.2721
 [19,] 225.7598 12.589261 201.2943 250.5934
 [20,] 227.5376 14.666846 198.9479 256.4865
 [21,] 213.1928 13.276325 186.6088 238.2312
 [22,] 218.0862 11.427614 195.3574 239.6163
 [23,] 222.9796  9.846436 203.1645 241.6148
 [24,] 227.8731  8.680246 210.7169 244.6202
 [25,] 232.7665  8.110082 216.8449 248.5812
 [26,] 237.6600  8.260303 221.6027 254.0632
 [27,] 242.5534  9.095284 225.4865 260.7641
 [28,] 247.4468 10.452185 227.6358 268.3713
 [29,] 252.3403 12.157490 228.8219 276.7498
 [30,] 257.2337 14.085218 230.1351 285.1923
 [31,] 274.3206 13.396309 248.7518 301.3792
 [32,] 280.0961 11.427721 258.4735 303.3488
 [33,] 285.8716  9.725213 267.3680 305.8934
 [34,] 291.6471  8.451154 275.2024 308.3811
 [35,] 297.4226  7.817896 282.3580 313.1245
 [36,] 303.1981  7.979489 287.8572 319.4498
 [37,] 308.9736  8.892708 291.5088 326.6385
 [38,] 314.7491 10.360672 294.0136 335.2767
 [39,] 320.5245 12.184500 295.5707 344.3622
 [40,] 326.3000 14.227995 297.4985 354.0986
 [41,] 272.9653 13.341290 247.4921 300.1909
 [42,] 280.4454 11.391623 258.6262 303.4592
 [43,] 287.9256  9.737956 269.1137 307.2694
 [44,] 295.4057  8.553722 279.0530 312.3902
 [45,] 302.8859  8.048862 287.6925 319.0089
 [46,] 310.3660  8.347567 294.6047 327.4600
 [47,] 317.8462  9.373324 299.8107 337.0913
 [48,] 325.3263 10.923196 304.0768 347.7983
 [49,] 332.8065 12.808312 307.5978 359.0710
 [50,] 340.2867 14.901986 310.9656 370.6709
 [51,] 260.1600 12.478849 235.6099 284.7425
 [52,] 270.3615 10.767119 249.0896 291.5112
 [53,] 280.5630  9.347104 262.3179 299.0522
 [54,] 290.7645  8.368639 274.2911 307.0934
 [55,] 300.9660  7.995512 285.1423 316.3357
 [56,] 311.1675  8.309668 294.9710 327.5037
 [57,] 321.3690  9.241279 303.1303 339.6894
 [58,] 331.5705 10.629215 310.6079 352.5914
 [59,] 341.7720 12.320206 317.5853 366.3021
 [60,] 351.9735 14.206443 323.9518 380.0937
 [61,] 267.8630 12.776894 243.4652 293.4133
 [62,] 278.1976 10.959892 257.3393 299.8739
 [63,] 288.5321  9.429525 270.7094 307.3530
 [64,] 298.8666  8.345008 282.7950 315.7610
 [65,] 309.2011  7.892330 293.7156 324.8756
 [66,] 319.5356  8.177107 302.8933 335.5301
 [67,] 329.8701  9.130597 311.6304 347.9872
 [68,] 340.2046 10.573411 319.2660 360.8510
 [69,] 350.5391 12.335021 326.2899 373.8120
 [70,] 360.8737 14.298076 333.1109 388.3869
 [71,] 244.3134 12.227916 220.1947 268.5076
 [72,] 255.8085 10.520202 235.4163 276.7387
 [73,] 267.3035  9.111039 249.4750 285.4052
 [74,] 278.7986  8.156659 262.6533 295.1167
 [75,] 290.2937  7.825267 274.8954 305.9388
 [76,] 301.7888  8.192812 285.5831 318.0256
 [77,] 313.2838  9.175686 295.2383 331.3420
 [78,] 324.7789 10.604146 304.0789 345.5998
 [79,] 336.2740 12.324215 311.7341 360.0948
 [80,] 347.7690 14.230541 319.5220 374.9753
 [81,] 250.9031 13.360958 225.1953 277.3981
 [82,] 250.6376 11.422484 228.4976 272.9996
 [83,] 250.3721  9.776007 231.2615 269.5280
 [84,] 250.1066  8.591085 233.2138 267.1172
 [85,] 249.8411  8.073563 234.2806 265.6504
 [86,] 249.5756  8.348493 233.5478 265.9239
 [87,] 249.3102  9.346202 230.9485 267.6031
 [88,] 249.0447 10.869448 227.8867 270.3415
 [89,] 248.7792 12.730969 223.5155 273.2816
 [90,] 248.5137 14.803698 219.2408 276.7120
 [91,] 285.7210 12.862212 261.1828 311.9663
 [92,] 304.8663 11.028594 283.7869 327.2655
 [93,] 324.0116  9.480990 305.6469 343.1834
 [94,] 343.1568  8.379401 326.8057 360.0376
 [95,] 362.3021  7.912360 346.8964 378.1093
 [96,] 381.4474  8.189166 365.7343 397.5136
 [97,] 400.5927  9.142502 382.8749 418.5449
 [98,] 419.7379 10.591229 398.9587 440.6086
 [99,] 438.8832 12.362396 414.7025 463.4819
[100,] 458.0285 14.336996 429.6245 486.7796
[101,] 226.8403 12.813563 200.7039 250.3712
[102,] 238.3880 10.975316 215.9434 259.0971
[103,] 249.9357  9.425694 230.7532 267.9234
[104,] 261.4835  8.327416 244.6782 277.6245
[105,] 273.0312  7.871721 257.3436 288.3042
[106,] 284.5789  8.166892 268.6254 300.3157
[107,] 296.1267  9.140473 278.4543 313.9597
[108,] 307.6744 10.607279 286.6174 328.5920
[109,] 319.2222 12.393404 294.7373 343.7070
[110,] 330.7699 14.380354 302.1552 359.5779
[111,] 238.7543 12.876163 213.3423 263.4750
[112,] 255.7560 11.066752 234.1274 277.0949
[113,] 272.7577  9.544269 253.8245 291.2465
[114,] 289.7593  8.464974 272.7610 306.2828
[115,] 306.7610  8.010067 290.8835 322.6910
[116,] 323.7627  8.283067 307.5241 340.0620
[117,] 340.7644  9.219539 322.9450 358.8519
[118,] 357.7660 10.645808 336.5967 378.4884
[119,] 374.7677 12.393919 350.3986 398.5670
[120,] 391.7694 14.346703 363.0907 419.3062
[121,] 255.8003 12.479780 231.7825 281.4751
[122,] 263.2458 10.719894 242.6386 285.3712
[123,] 270.6912  9.259489 253.0617 289.2734
[124,] 278.1366  8.258990 262.0681 294.6445
[125,] 285.5820  7.895219 270.6317 300.9520
[126,] 293.0274  8.252808 276.9507 309.3412
[127,] 300.4728  9.248458 282.4947 318.5835
[128,] 307.9182 10.705601 286.5153 328.7854
[129,] 315.3636 12.463410 290.6050 339.5071
[130,] 322.8090 14.412289 293.4791 350.5418
[131,] 271.5641 12.759418 247.8715 297.0213
[132,] 285.7057 10.991305 265.1155 307.9403
[133,] 299.8472  9.502423 281.6988 318.9912
[134,] 313.9888  8.441831 297.3956 331.2593
[135,] 328.1304  7.982117 312.0760 344.0603
[136,] 342.2720  8.224665 325.7885 358.4054
[137,] 356.4136  9.113575 338.3551 374.3089
[138,] 370.5552 10.485733 349.7941 390.8583
[139,] 384.6968 12.178882 360.7235 408.4122
[140,] 398.8383 14.077676 370.6454 426.0783
[141,] 254.9562 12.627248 230.7883 279.9148
[142,] 266.2707 10.847173 245.4216 287.7180
[143,] 277.5852  9.351227 259.4689 296.0297
[144,] 288.8997  8.294592 272.6591 305.3524
[145,] 300.2142  7.856565 284.7352 315.2598
[146,] 311.5287  8.137660 295.6009 326.6683
[147,] 322.8432  9.071269 305.3124 340.0025
[148,] 334.1577 10.484506 313.9226 354.6816
[149,] 345.4722 12.211976 321.7707 369.0764
[150,] 356.7867 14.138966 329.1574 384.3641
[151,] 226.5907 13.614577 198.7794 252.6872
[152,] 241.7766 11.632079 217.8844 264.2039
[153,] 256.9625  9.912876 236.6304 275.7491
[154,] 272.1483  8.616045 254.5996 288.7249
[155,] 287.3342  7.951015 271.4894 302.8135
[156,] 302.5200  8.075415 286.6229 318.2016
[157,] 317.7059  8.956411 300.3274 334.9136
[158,] 332.8918 10.403536 312.5756 352.8232
[159,] 348.0776 12.217246 323.7862 371.8204
[160,] 363.2635 14.258329 335.5303 391.1050
[161,] 252.3551 12.328227 228.2857 276.2707
[162,] 261.8622 10.553126 241.4193 282.6322
[163,] 271.3694  9.072706 253.6488 289.3557
[164,] 280.8766  8.051197 265.3270 296.9465
[165,] 290.3837  7.674100 275.4617 305.8554
[166,] 299.8909  8.032689 284.1886 315.8975
[167,] 309.3980  9.039836 291.3328 326.5717
[168,] 318.9052 10.510729 297.2457 338.9541
[169,] 328.4124 12.279840 303.5216 351.9369
[170,] 337.9195 14.236423 309.0409 364.9387
[171,] 263.4931 12.153167 239.9239 287.6044
[172,] 275.2892 10.482470 254.3419 295.9767
[173,] 287.0853  9.086205 269.3256 304.7483
[174,] 298.8815  8.107421 283.3060 314.6351
[175,] 310.6776  7.706857 295.4931 325.5709
[176,] 322.4737  7.972153 306.0605 337.7819
[177,] 334.2698  8.843587 316.5971 351.3038
[178,] 346.0659 10.166468 326.0216 365.7296
[179,] 357.8620 11.789797 334.5947 380.8517
[180,] 369.6581 13.606461 342.9563 396.2806</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.0654774 13.068748  -29.69405035  22.7357237
  [2,]  -14.6010506 11.196626  -36.27083928   8.1518361
  [3,]  -42.1854238  9.613648  -60.89930245 -23.0094519
  [4,]    8.7735030  8.483252   -7.72571975  25.9446337
  [5,]   24.5053299  7.999654    9.15378848  40.6287692
  [6,]   62.6632567  8.277011   46.34151712  78.9475728
  [7,]   10.4966835  9.247102   -8.16531615  28.4977564
  [8,] -101.2387897 10.723545 -122.81112036 -80.1930510
  [9,]   19.5176372 12.528588   -5.11488398  44.4055067
 [10,]   35.6055640 14.540362    7.12826710  64.6248895
 [11,]   11.1969308 13.399566  -14.72160139  38.8360207
 [12,]   -8.0490173 11.437898  -30.19200942  15.4654982
 [13,]  -12.1148654  9.760705  -31.04903808   7.6529666
 [14,]  -12.1635134  8.537325  -29.01788488   4.6950250
 [15,]  -10.9322615  7.979298  -26.93619894   4.5213061
 [16,]   -4.4644096  8.223211  -20.91990301  11.1907271
 [17,]   -8.5737577  9.205537  -27.17739858   8.9690834
 [18,]   -6.2547058 10.725267  -27.54494460  14.4982500
 [19,]   -1.4640538 12.589261  -26.29765916  23.0014018
 [20,]    9.7765981 14.666846  -19.17233172  38.3662631
 [21,]  -14.1388624 13.276325  -39.17732642  12.4451424
 [22,]  -23.7540004 11.427614  -45.28414435  -1.0251750
 [23,]   11.3403616  9.846436   -7.29483583  31.1555189
 [24,]    4.9685235  8.680246  -11.77864806  22.1247197
 [25,]   -3.4591145  8.110082  -19.27375031  12.4624965
 [26,]  -17.2020525  8.260303  -33.60534947  -1.1448085
 [27,]   -7.1325905  9.095284  -25.34330545   9.9343199
 [28,]    8.3042714 10.452185  -12.62019110  28.1152603
 [29,]    8.6722334 12.157490  -15.73733047  32.1906394
 [30,]   -9.7184046 14.085218  -37.67700975  17.3801782
 [31,]   47.2220058 13.396309   20.16343643  72.7907926
 [32,]   20.3041118 11.427721   -2.94864765  41.9267382
 [33,]   -2.0150822  9.725213  -22.03688819  16.4885332
 [34,]   -6.5140762  8.451154  -23.24809691   9.9306236
 [35,]  -11.6252702  7.817896  -27.32717698   3.4392674
 [36,]   -5.6125642  7.979489  -21.86431597   9.7283227
 [37,]  -28.7339582  8.892708  -46.39893474 -11.2692206
 [38,]    3.5122478 10.360672  -17.01540633  24.2476792
 [39,]  -15.1750462 12.184500  -39.01273387   9.7787949
 [40,]   27.7486598 14.227995   -0.04989328  56.5502258
 [41,]   14.6426173 13.341290  -12.58300346  40.1158085
 [42,]    4.5545650 11.391623  -18.45923744  26.3737645
 [43,]   13.8950128  9.737956   -5.44877432  32.7069077
 [44,]   24.7095606  8.553722    7.72508629  41.0623202
 [45,]   13.3914084  8.048862   -2.73155714  28.5848379
 [46,]  -17.0473438  8.347567  -34.14129623  -1.2860137
 [47,]  -27.7711960  9.373324  -47.01632907  -9.7356535
 [48,]    9.4913518 10.923196  -12.98058970  30.7409229
 [49,]  -39.0596005 12.808312  -65.32407795 -13.8508662
 [50,]   31.2944473 14.901986    0.91017839  60.6154897
 [51,]  -25.2994186 12.478849  -49.88189795  -0.7493024
 [52,]  -27.5497210 10.767119  -48.69942625  -6.2778033
 [53,]   -7.6017233  9.347104  -26.09086240  10.6434414
 [54,]   19.0042743  8.368639    2.67537543  35.4777428
 [55,]   16.4968719  7.995512    1.12720658  32.3206274
 [56,]   -1.1699304  8.309668  -17.50612454  15.0265727
 [57,]  132.7928672  9.241279  114.47249574 151.0316162
 [58,]   15.2605648 10.629215   -5.76033151  36.2232460
 [59,]  -11.4717375 12.320206  -36.00178207  12.7150278
 [60,]  -98.1091399 14.206443 -126.22926294 -70.0874425
 [61,]   15.9793515 12.776894   -9.57089194  40.3772379
 [62,]   11.3574402 10.959892  -10.31890916  32.2156935
 [63,]  -11.7627712  9.429525  -30.58373696   6.0598752
 [64,]    0.9431175  8.345008  -15.95130148  17.0147053
 [65,]  -12.0300938  7.892330  -27.70460575   3.4553874
 [66,]   18.6308948  8.177107    2.63643779  35.2732044
 [67,]    2.1563835  9.130597  -15.96067978  20.3961231
 [68,]    8.6352722 10.573411  -12.01108708  29.5739025
 [69,]  -17.1791391 12.335021  -40.45195391   7.0701391
 [70,]    1.1691495 14.298076  -26.34412652  28.9319158
 [71,]   21.1596881 12.227916   -3.03452208  45.2783898
 [72,]   20.3927196 10.520202   -0.53749829  40.7849372
 [73,]  -23.9388489  9.111039  -42.04048603  -6.1103468
 [74,]  -24.1263175  8.156659  -40.44442759  -7.9810277
 [75,]  -11.2692860  7.825267  -26.91444396   4.1290126
 [76,]  -17.5975545  8.192812  -33.83441776  -1.3919012
 [77,]   -7.7590231  9.175686  -25.81716847  10.2864680
 [78,]    6.7440084 10.604146  -14.07685123  27.4439675
 [79,]   -0.5270601 12.324215  -24.34791520  24.0127544
 [80,]   29.5299713 14.230541    2.32367358  57.7769708
 [81,]   -9.2947636 13.360958  -35.78980580  16.4130173
 [82,]   23.3096215 11.422484    0.94756115  45.4495970
 [83,]    4.1186067  9.776007  -15.03726513  23.2292169
 [84,]   20.6954918  8.591085    3.68494120  37.5883175
 [85,]    1.6107769  8.073563  -14.19853812  17.1712992
 [86,]    5.0605620  8.348493  -11.28769736  21.0884358
 [87,]   -3.8578528  9.346202  -22.15079087  14.5038043
 [88,]  -13.7336677 10.869448  -35.03046981   7.4242743
 [89,]  -13.0250826 12.730969  -37.52753990  12.2386437
 [90,]  -11.2670975 14.803698  -39.46541108  18.0057676
 [91,]   26.6455932 12.862212    0.40034588  51.1837882
 [92,]    8.9395180 11.028594  -13.45970051  30.0188859
 [93,]  -32.4003573  9.480990  -51.57216936 -14.0357167
 [94,]    2.9653674  8.379401  -13.91544584  19.3165366
 [95,]    3.4302922  7.912360  -12.37687737  18.8360086
 [96,]   10.3911169  8.189166   -5.67511297  26.1042149
 [97,]    3.6674416  9.142502  -14.28479470  21.3851595
 [98,]   -3.0456336 10.591229  -23.91627659  17.7336231
 [99,]   16.9810911 12.362396   -7.61759642  41.1618032
[100,]    0.8882158 14.336996  -27.86285492  29.2922242
[101,]    9.2629492 12.813563  -14.26800935  35.3993477
[102,]   -8.0712903 10.975316  -28.78044620  14.3733472
[103,]  -11.0101299  9.425694  -28.99784315   8.1724180
[104,]   -6.5614695  8.327416  -22.70249798  10.2438263
[105,]  -22.3209091  7.871721  -37.59391439  -6.6333471
[106,]  -14.8045487  8.166892  -30.54131578   1.1489675
[107,]  -14.5618883  9.140473  -32.39493154   3.1105216
[108,]    0.4275721 10.607279  -20.48997055  21.4845835
[109,]   17.0584325 12.393404   -7.42638878  41.5432887
[110,]   20.8751929 14.380354   -7.93275104  49.4898672
[111,]   17.5424747 12.876163   -7.17824287  42.9544548
[112,]  -12.3016981 11.066752  -33.64062033   9.3268892
[113,]  -16.5530709  9.544269  -35.04192771   2.3800745
[114,]  -34.2322437  8.464974  -50.75567741 -17.2338745
[115,]  -37.8445165  8.010067  -53.77452918 -21.9670375
[116,]    5.9620107  8.283067  -10.33733663  22.2006402
[117,]   38.6801379  9.219539   20.59262365  56.4995431
[118,]    5.1523651 10.645808  -15.56995111  26.3217246
[119,]   19.7194924 12.393919   -4.07976383  44.0886349
[120,]   -2.7166804 14.346703  -30.25349962  25.9619510
[121,]   -5.2738483 12.479780  -30.94863980  18.7440147
[122,]   36.8118492 10.719894   14.68639372  57.4189583
[123,]   -0.7972533  9.259489  -19.37950016  16.8322357
[124,]    2.4525442  8.258990  -14.05535615  18.5210016
[125,]  -13.7545583  7.895219  -29.12463148   1.1956835
[126,]   11.6062391  8.252808   -4.70757085  27.6829486
[127,]  -12.7261634  9.248458  -30.83692823   5.2519017
[128,]  -41.3226659 10.705601  -62.18994228 -19.9197576
[129,]    6.1782316 12.463410  -17.96528212  30.9368477
[130,]   24.7565291 14.412289   -2.97628107  54.0864362
[131,]  -49.8869757 12.759418  -75.34424444 -26.1944148
[132,]   12.4882396 10.991305   -9.74644362  33.0784165
[133,]   27.0312549  9.502423    7.88733241  45.1797140
[134,]   32.8666701  8.441831   15.59619903  49.4598976
[135,]   20.6097854  7.982117    4.67988176  36.6641755
[136,]   10.5567007  8.224665   -5.57673018  27.0402231
[137,]   -1.9869840  9.113575  -19.88225148  16.0715219
[138,]  -10.1225688 10.485733  -30.42568700  10.6385041
[139,]   -9.0561535 12.178882  -32.77164902  14.9171225
[140,]  -10.2966382 14.077676  -37.53661672  17.8963222
[141,]   16.9672816 12.627248   -7.99131433  41.1352157
[142,]    2.1661879 10.847173  -19.28112428  23.0152643
[143,]  -20.3428058  9.351227  -38.78730850  -2.2264914
[144,]  -11.2430995  8.294592  -27.69583162   4.9975208
[145,]   14.6080068  7.856565   -0.43763780  30.0869978
[146,]    5.6848131  8.137660   -9.45482174  21.6126139
[147,]  -24.7078807  9.071269  -41.86720683  -7.1771192
[148,]   13.9652256 10.484506   -6.55866928  34.2002556
[149,]   -5.1921681 12.211976  -28.79637925  18.5092875
[150,]    9.7264382 14.138966  -17.85099122  37.3557284
[151,]   -1.3267482 13.614577  -27.42320244  26.4845573
[152,]   -7.2531057 11.632079  -29.68040763  16.6391375
[153,]  -18.0616631  9.912876  -36.84827653   2.2703899
[154,]  -31.6753206  8.616045  -48.25191949 -14.1266368
[155,]  -19.7968780  7.951015  -35.27618130  -3.9521430
[156,]   41.6736645  8.075415   25.99211240  57.5708400
[157,]  -36.5577929  8.956411  -53.76552372 -19.1792844
[158,]   14.6937497 10.403536   -5.23769801  35.0099386
[159,]   17.0853922 12.217246   -6.65736717  41.3767637
[160,]    8.9653348 14.258329  -18.87623169  36.6985122
[161,]   17.5253154 12.328227   -6.39034978  41.5947448
[162,]   10.5805548 10.553126  -10.18943525  31.0235061
[163,]    6.5294943  9.072706  -11.45680015  24.2501456
[164,]    0.9129337  8.051197  -15.15698590  16.4624796
[165,]  -11.2132269  7.674100  -26.68492608   3.7088145
[166,]  -15.3788875  8.032689  -31.38549325   0.3234003
[167,]  -50.1322481  9.039836  -67.30593447 -32.0670111
[168,]  -14.2746086 10.510729  -34.32352422   7.3849422
[169,]   22.3683308 12.279840   -1.15618329  47.2590661
[170,]   31.5496702 14.236423    4.53047898  60.4282696
[171,]    5.9185648 12.153167  -18.19270888  29.4877542
[172,]   -1.8152404 10.482470  -22.50268103  19.1320641
[173,]   10.5114543  9.086205   -7.15148783  28.2712080
[174,]   11.7501491  8.107421   -4.00353648  27.3256081
[175,]  -23.5049561  7.706857  -38.39830165  -8.3204971
[176,]    7.1339386  7.972153   -8.17434225  23.5470746
[177,]    0.2120334  8.843587  -16.82196894  17.8847271
[178,]   -2.8459718 10.166468  -22.50971902  17.1983251
[179,]   11.2797230 11.789797  -11.71003706  34.5470307
[180,]   -5.5344823 13.606461  -32.15699165  21.1672982</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.5  3.5
looic      1770.1 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1594      
 (0.5, 0.7]   (ok)         1    0.6%   440       
   (0.7, 1]   (bad)        1    0.6%   108       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.1 22.7
p_loo        35.0  8.8
looic      1724.3 45.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   901       
 (0.5, 0.7]   (ok)         3    1.7%   597       
   (0.7, 1]   (bad)        3    1.7%   20        
   (1, Inf)   (very bad)   1    0.6%   13        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -22.9      11.8  
fit_sleep1 -91.2      21.3  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.4
p_loo        19.5  3.5
looic      1770.1 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1594      
 (0.5, 0.7]   (ok)         1    0.6%   440       
   (0.7, 1]   (bad)        1    0.6%   108       
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.1 22.7
p_loo        35.0  8.8
looic      1724.3 45.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   901       
 (0.5, 0.7]   (ok)         3    1.7%   597       
   (0.7, 1]   (bad)        3    1.7%   20        
   (1, Inf)   (very bad)   1    0.6%   13        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.1     22.7        35.0    8.8   1724.3
fit_sleep2  -22.9      11.8  -885.1     14.4        19.5    3.5   1770.1
fit_sleep1  -91.2      21.3  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   45.3  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
2.567561e-40 1.122988e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.88      1.55     0.33     5.33       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.12      1.55    -3.31     2.81       5.57      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.15      
[4] StanHeaders_2.26.15 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.0         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
