<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.65      6.76    15.29    41.96 1.00     1729     2340
sd(Days)                6.54      1.47     4.16     9.84 1.00     1591     2015
cor(Intercept,Days)     0.07      0.30    -0.48     0.68 1.00      825     1768

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   250.90      7.20   236.66   265.13 1.00     1654     2585
Days         10.37      1.66     7.10    13.76 1.00     1150     1841

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.93      1.63    23.01    29.34 1.00     4141     2819

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9206  12.71282 228.7904 278.0579
309 211.7420  13.36234 184.7981 237.0155
310 213.0929  13.37884 185.7538 239.0695
330 274.2677  13.49945 248.5429 301.8744
331 272.7833  13.11984 247.6320 298.5457
332 260.0908  12.10555 236.8668 284.0302
333 267.9244  12.53126 244.4694 292.9265
334 244.3198  12.40274 218.9755 268.6092
335 250.6443  13.56389 223.2303 277.9254
337 285.6171  13.32757 259.3660 311.4505
349 226.7843  13.02990 200.3626 251.0260
350 238.8501  13.25134 211.3825 264.0986
351 255.7024  12.34011 232.6522 280.5492
352 271.7377  12.56354 247.2179 296.7459
369 254.4254  12.28338 230.1751 278.1531
370 226.6111  13.58258 199.8089 252.8702
371 252.1196  12.32095 227.6364 276.4021
372 263.2790  12.13366 239.8078 287.0350

, , Days

     Estimate Est.Error        Q2.5     Q97.5
308 19.603532  2.442825 14.89474902 24.423773
309  1.759257  2.539206 -3.33301420  6.611972
310  4.947365  2.503208  0.01028365  9.889839
330  5.765428  2.574230  0.70092817 10.820980
331  7.534061  2.480373  2.60428725 12.358895
332 10.238782  2.337393  5.61804795 14.886957
333 10.314547  2.413054  5.50316988 14.961263
334 11.548063  2.376975  6.88288515 16.153522
335 -0.221109  2.638313 -5.40949256  5.035953
337 19.228263  2.517664 14.33351856 24.213844
349 11.552014  2.488537  6.75919703 16.630352
350 17.004754  2.562005 12.22735553 22.193642
351  7.474549  2.326857  2.85192237 11.987186
352 14.046722  2.386964  9.30706062 18.616203
369 11.375436  2.335996  6.82310541 15.998292
370 15.141532  2.548567 10.22736913 20.298659
371  9.467631  2.386456  4.77253023 14.077132
372 11.846644  2.330095  7.25018290 16.408425</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9206 12.712825 228.7904 278.0579
  [2,] 273.5241 10.923587 252.2464 294.2392
  [3,] 293.1276  9.432305 274.6000 311.3069
  [4,] 312.7311  8.399213 296.5617 329.0424
  [5,] 332.3347  8.003748 317.0837 348.0737
  [6,] 351.9382  8.337144 335.7992 368.5225
  [7,] 371.5417  9.321520 353.1333 390.1761
  [8,] 391.1453 10.779995 369.8867 412.2871
  [9,] 410.7488 12.548332 385.8698 435.6408
 [10,] 430.3523 14.513709 401.8371 459.3019
 [11,] 211.7420 13.362336 184.7981 237.0155
 [12,] 213.5013 11.420015 190.3022 235.0850
 [13,] 215.2606  9.755850 195.2776 233.4271
 [14,] 217.0198  8.534144 199.8506 233.1268
 [15,] 218.7791  7.961266 203.1499 234.3346
 [16,] 220.5383  8.174781 204.9532 236.3764
 [17,] 222.2976  9.119620 204.8036 240.0853
 [18,] 224.0568 10.602029 203.1921 244.4272
 [19,] 225.8161 12.431159 201.5086 249.7698
 [20,] 227.5754 14.476172 198.7596 255.0714
 [21,] 213.0929 13.378836 185.7538 239.0695
 [22,] 218.0403 11.506690 194.5498 240.0673
 [23,] 222.9876  9.916989 202.5833 242.0232
 [24,] 227.9350  8.764790 210.2536 244.6630
 [25,] 232.8823  8.235806 216.4271 248.4204
 [26,] 237.8297  8.447933 221.1145 254.0181
 [27,] 242.7771  9.350868 224.5200 260.7294
 [28,] 247.7244 10.772280 226.3673 268.2543
 [29,] 252.6718 12.537040 227.8396 276.7661
 [30,] 257.6192 14.520497 228.9302 285.8466
 [31,] 274.2677 13.499447 248.5429 301.8744
 [32,] 280.0332 11.511794 257.8929 303.7095
 [33,] 285.7986  9.801075 266.7008 305.9416
 [34,] 291.5640  8.535458 274.6253 308.3821
 [35,] 297.3295  7.930975 281.3516 312.7593
 [36,] 303.0949  8.136337 287.1144 319.2683
 [37,] 308.8603  9.096864 291.0727 326.6319
 [38,] 314.6257 10.609392 293.7887 335.2647
 [39,] 320.3912 12.474726 296.0633 344.9140
 [40,] 326.1566 14.557875 298.0698 354.5474
 [41,] 272.7833 13.119842 247.6320 298.5457
 [42,] 280.3174 11.234558 259.1438 302.2541
 [43,] 287.8514  9.623140 269.5675 306.7069
 [44,] 295.3855  8.443865 279.2329 312.1468
 [45,] 302.9196  7.892870 287.8106 318.6021
 [46,] 310.4536  8.099410 294.5110 326.6358
 [47,] 317.9877  9.011548 299.9409 335.8371
 [48,] 325.5217 10.446054 304.5366 346.3575
 [49,] 333.0558 12.220336 309.1721 357.3241
 [50,] 340.5899 14.207663 312.6872 368.7609
 [51,] 260.0908 12.105545 236.8668 284.0302
 [52,] 270.3296 10.435973 250.3326 291.0615
 [53,] 280.5684  9.066514 262.9016 298.3125
 [54,] 290.8072  8.149885 274.7509 306.6960
 [55,] 301.0459  7.846426 285.4343 316.1702
 [56,] 311.2847  8.224292 295.1849 326.9221
 [57,] 321.5235  9.199912 303.6565 339.2936
 [58,] 331.7623 10.609647 311.6354 352.1973
 [59,] 342.0011 12.305188 318.4537 366.0102
 [60,] 352.2398 14.184410 324.5618 379.7719
 [61,] 267.9244 12.531257 244.4694 292.9265
 [62,] 278.2389 10.801426 258.0373 299.5691
 [63,] 288.5535  9.378426 270.6772 306.8868
 [64,] 298.8680  8.419299 282.1134 315.8142
 [65,] 309.1826  8.090735 293.3145 325.3500
 [66,] 319.4971  8.466465 302.7030 336.4105
 [67,] 329.8117  9.462967 310.7585 348.6857
 [68,] 340.1262 10.911467 318.1255 361.1916
 [69,] 350.4407 12.657730 325.4462 374.7400
 [70,] 360.7553 14.595267 331.8407 388.8686
 [71,] 244.3198 12.402736 218.9755 268.6092
 [72,] 255.8678 10.656283 233.8376 276.5594
 [73,] 267.4159  9.197003 248.6841 285.4781
 [74,] 278.9640  8.180060 262.5781 295.1939
 [75,] 290.5120  7.780869 275.1698 305.8358
 [76,] 302.0601  8.091383 286.1760 318.2017
 [77,] 313.6082  9.038753 295.8329 331.2758
 [78,] 325.1562 10.451203 304.5556 345.9327
 [79,] 336.7043 12.167837 312.8625 360.8466
 [80,] 348.2523 14.077815 320.5963 375.7172
 [81,] 250.6443 13.563893 223.2303 277.9254
 [82,] 250.4232 11.536543 226.9800 273.4873
 [83,] 250.2021  9.804380 230.3330 269.5978
 [84,] 249.9810  8.548759 232.7920 267.1896
 [85,] 249.7599  7.997380 234.0310 265.8910
 [86,] 249.5388  8.291940 233.4126 266.0569
 [87,] 249.3177  9.352852 231.4374 267.5884
 [88,] 249.0966 10.959781 227.9033 270.9767
 [89,] 248.8755 12.910428 223.6828 274.6144
 [90,] 248.6544 15.071924 219.2145 278.5796
 [91,] 285.6171 13.327575 259.3660 311.4505
 [92,] 304.8453 11.401459 282.7564 326.8747
 [93,] 324.0736  9.748822 304.7559 343.2091
 [94,] 343.3019  8.530128 326.0548 360.0217
 [95,] 362.5301  7.947571 346.7214 377.9800
 [96,] 381.7584  8.138917 365.9175 397.6342
 [97,] 400.9867  9.055237 383.5056 418.6486
 [98,] 420.2149 10.508565 399.8906 440.7613
 [99,] 439.4432 12.310151 415.4824 463.8992
[100,] 458.6714 14.329234 430.7547 487.6648
[101,] 226.7843 13.029905 200.3626 251.0260
[102,] 238.3364 11.197112 215.5566 259.2511
[103,] 249.8884  9.662186 230.1256 268.3526
[104,] 261.4404  8.586384 244.0957 277.9277
[105,] 272.9924  8.153513 256.9923 288.8150
[106,] 284.5444  8.462813 268.2139 300.8494
[107,] 296.0964  9.441624 278.0371 314.7578
[108,] 307.6484 10.911231 286.6697 328.9647
[109,] 319.2005 12.702412 294.3301 344.5496
[110,] 330.7525 14.698069 301.9943 360.0275
[111,] 238.8501 13.251337 211.3825 264.0986
[112,] 255.8549 11.307318 232.9728 277.5979
[113,] 272.8597  9.656121 253.5945 291.9416
[114,] 289.8644  8.470753 273.4908 306.5227
[115,] 306.8692  7.962058 291.7421 322.5366
[116,] 323.8739  8.256078 307.6408 340.0852
[117,] 340.8787  9.276800 323.1206 358.9594
[118,] 357.8834 10.820487 337.0740 379.1186
[119,] 374.8882 12.697819 350.3591 399.8126
[120,] 391.8929 14.782219 363.4870 421.4201
[121,] 255.7024 12.340109 232.6522 280.5492
[122,] 263.1770 10.626250 243.0996 284.6084
[123,] 270.6515  9.186111 253.0752 289.0670
[124,] 278.1261  8.165819 262.2696 294.6163
[125,] 285.6006  7.733376 270.1767 300.8215
[126,] 293.0752  7.984868 277.2372 309.0039
[127,] 300.5497  8.862261 283.1627 317.9541
[128,] 308.0243 10.205379 288.1739 328.3471
[129,] 315.4988 11.856997 292.5547 339.4168
[130,] 322.9734 13.706039 296.4348 350.7561
[131,] 271.7377 12.563542 247.2179 296.7459
[132,] 285.7844 10.805380 264.8457 307.2255
[133,] 299.8312  9.330867 281.8746 318.0597
[134,] 313.8779  8.292714 297.7972 329.6492
[135,] 327.9246  7.865642 312.4850 342.9894
[136,] 341.9713  8.146332 326.4364 357.7608
[137,] 356.0180  9.069307 338.5184 373.7158
[138,] 370.0648 10.465998 350.0974 390.6286
[139,] 384.1115 12.174444 360.7815 408.0275
[140,] 398.1582 14.081628 371.1736 425.6339
[141,] 254.4254 12.283381 230.1751 278.1531
[142,] 265.8009 10.606521 244.8899 286.1111
[143,] 277.1763  9.221112 258.8518 295.1447
[144,] 288.5517  8.274858 272.5558 304.6768
[145,] 299.9272  7.926625 284.6601 315.0613
[146,] 311.3026  8.252470 295.2560 326.9748
[147,] 322.6781  9.180898 304.4323 340.5375
[148,] 334.0535 10.554064 312.5778 354.4512
[149,] 345.4289 12.222986 320.7145 368.6047
[150,] 356.8044 14.082907 328.6324 384.0515
[151,] 226.6111 13.582585 199.8089 252.8702
[152,] 241.7526 11.636396 219.1565 264.2861
[153,] 256.8942  9.965701 237.5881 276.8974
[154,] 272.0357  8.730125 254.6205 289.5332
[155,] 287.1772  8.130521 271.0798 303.3472
[156,] 302.3188  8.305783 286.0775 318.7958
[157,] 317.4603  9.211791 299.4349 335.2262
[158,] 332.6018 10.663890 311.7837 353.0189
[159,] 347.7434 12.472786 323.1088 371.6192
[160,] 362.8849 14.505607 334.9094 391.2232
[161,] 252.1196 12.320946 227.6364 276.4021
[162,] 261.5873 10.609055 240.4792 282.4801
[163,] 271.0549  9.202647 252.9516 289.2507
[164,] 280.5225  8.259282 264.1652 296.5780
[165,] 289.9902  7.945634 274.3235 305.4672
[166,] 299.4578  8.333116 283.0275 315.9769
[167,] 308.9254  9.334820 290.7676 327.3083
[168,] 318.3930 10.780875 296.9533 339.2337
[169,] 327.8607 12.518228 302.6029 352.4045
[170,] 337.3283 14.442130 308.1355 365.6100
[171,] 263.2790 12.133662 239.8078 287.0350
[172,] 275.1257 10.457142 254.7057 295.3403
[173,] 286.9723  9.073948 269.1509 304.3150
[174,] 298.8189  8.135106 283.0697 314.6679
[175,] 310.6656  7.802695 295.2181 326.0393
[176,] 322.5122  8.151246 306.1760 338.5183
[177,] 334.3589  9.102872 316.2031 352.6111
[178,] 346.2055 10.494780 325.1024 366.9747
[179,] 358.0522 12.176914 333.6452 381.9286
[180,] 369.8988 14.045381 342.1246 397.3747</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.3605544 12.712825  -28.4978864  20.7696207
  [2,]  -14.8193861 10.923587  -35.5344970   6.4583364
  [3,]  -42.3270179  9.432305  -60.5063200 -23.7994405
  [4,]    8.7086503  8.399213   -7.6026021  24.8781318
  [5,]   24.5172186  8.003748    8.7782148  39.7681711
  [6,]   62.7518868  8.337144   46.1676460  78.8908599
  [7,]   10.6620550  9.321520   -7.9722701  29.0705264
  [8,] -100.9966767 10.779995 -122.1385134 -79.7381172
  [9,]   19.8364915 12.548332   -5.0555003  44.7155415
 [10,]   36.0011597 14.513709    7.0516293  64.5163548
 [11,]   10.9918622 13.362336  -14.2815683  37.9358381
 [12,]   -8.2354952 11.420015  -29.8191718  14.9636054
 [13,]  -12.2827527  9.755850  -30.4492928   7.7001786
 [14,]  -12.3128102  8.534144  -28.4197974   4.8564171
 [15,]  -11.0629677  7.961266  -26.6185131   4.5662320
 [16,]   -4.5765252  8.174781  -20.4145740  11.0085671
 [17,]   -8.6672827  9.119620  -26.4550106   8.8267424
 [18,]   -6.3296402 10.602029  -26.6999721  14.5350931
 [19,]   -1.5203976 12.431159  -25.4741464  22.7870909
 [20,]    9.7388449 14.476172  -17.7572001  38.5546359
 [21,]  -14.0389861 13.378836  -40.0155525  13.3001312
 [22,]  -23.7080514 11.506690  -45.7351021  -0.2176045
 [23,]   11.3323833  9.916989   -7.7032001  31.7366526
 [24,]    4.9066180  8.764790  -11.8213949  22.5880247
 [25,]   -3.5749473  8.235806  -19.1129733  12.8803409
 [26,]  -17.3718126  8.447933  -33.5602280  -0.6565564
 [27,]   -7.3562779  9.350868  -25.3086291  10.9008129
 [28,]    8.0266567 10.772280  -12.5032430  29.3838097
 [29,]    8.3406914 12.537040  -15.7536497  33.1728675
 [30,]  -10.1038739 14.520497  -38.3312636  18.5850529
 [31,]   47.2748578 13.499447   19.6681577  72.9997152
 [32,]   20.3670294 11.511794   -3.3093427  42.5073069
 [33,]   -1.9420990  9.801075  -22.0850578  17.1556614
 [34,]   -6.4310274  8.535458  -23.2491336  10.5076597
 [35,]  -11.5321558  7.930975  -26.9619504   4.4457466
 [36,]   -5.5093842  8.136337  -21.6827603  10.4711410
 [37,]  -28.6207126  9.096864  -46.3922538 -10.8331056
 [38,]    3.6355590 10.609392  -17.0033714  24.4725843
 [39,]  -15.0416694 12.474726  -39.5644500   9.2861886
 [40,]   27.8921022 14.557875   -0.4987286  55.9789223
 [41,]   14.8245840 13.119842  -10.9378303  39.9759237
 [42,]    4.6826235 11.234558  -17.2541254  25.8561796
 [43,]   13.9691629  9.623140   -4.8863410  32.2530755
 [44,]   24.7298024  8.443865    7.9685065  40.8824017
 [45,]   13.3577418  7.892870   -2.3247527  28.4666865
 [46,]  -17.1349187  8.099410  -33.3171278  -1.1922574
 [47,]  -27.9126792  9.011548  -45.7620748  -9.8658598
 [48,]    9.2959602 10.446054  -11.5398256  30.2810666
 [49,]  -39.3089003 12.220336  -63.5772303 -15.4251932
 [50,]   30.9912391 14.207663    2.8202499  58.8939228
 [51,]  -25.2302087 12.105545  -49.1695824  -2.0061782
 [52,]  -27.5177908 10.435973  -48.2497108  -7.5207539
 [53,]   -7.6070729  9.066514  -25.3511529  10.0597441
 [54,]   18.9616451  8.149885    3.0727696  35.0178622
 [55,]   16.4169630  7.846426    1.2927289  32.0285757
 [56,]   -1.2871191  8.224292  -16.9245276  14.8127222
 [57,]  132.6383988  9.199912  114.8683115 150.5053982
 [58,]   15.0688168 10.609647   -5.3661596  35.1956748
 [59,]  -11.7007653 12.305188  -35.7099434  11.8466282
 [60,]  -98.3754474 14.184410 -125.9075240 -70.6973835
 [61,]   15.9180270 12.531257   -9.0840617  39.3730177
 [62,]   11.3160804 10.801426  -10.0140621  31.5176625
 [63,]  -11.7841663  9.378426  -30.1174510   6.0920728
 [64,]    0.9416870  8.419299  -16.0045435  17.6963263
 [65,]  -12.0115596  8.090735  -28.1789511   3.8564812
 [66,]   18.6693937  8.466465    1.7559832  35.4635138
 [67,]    2.2148471  9.462967  -16.6592131  21.2679562
 [68,]    8.7137004 10.911467  -12.3517208  30.7143625
 [69,]  -17.0807463 12.657730  -41.3799669   7.9138161
 [70,]    1.2875071 14.595267  -26.8258258  30.2020798
 [71,]   21.1533216 12.402736   -3.1361429  46.4976438
 [72,]   20.3333588 10.656283   -0.3582200  42.3635650
 [73,]  -24.0512040  9.197003  -42.1133682  -5.3194296
 [74,]  -24.2916668  8.180060  -40.5216119  -7.9058372
 [75,]  -11.4876296  7.780869  -26.8114310   3.8545777
 [76,]  -17.8688923  8.091383  -34.0104707  -1.9848398
 [77,]   -8.0833551  9.038753  -25.7510322   9.6919204
 [78,]    6.3666821 10.451203  -14.4098050  26.9672951
 [79,]   -0.9573807 12.167837  -25.0996846  22.8844113
 [80,]   29.0466565 14.077815    1.5818073  56.7027011
 [81,]   -9.0360369 13.563893  -36.3171397  18.3779902
 [82,]   23.5239721 11.536543    0.4599036  46.9672319
 [83,]    4.2885812  9.804380  -15.1071465  24.1576925
 [84,]   20.8210902  8.548759    3.6124752  38.0101087
 [85,]    1.6919993  7.997380  -14.4390676  17.4209108
 [86,]    5.0974083  8.291940  -11.4206515  21.2236378
 [87,]   -3.8653827  9.352852  -22.1361219  14.0149262
 [88,]  -13.7855736 10.959781  -35.6656758   7.4077087
 [89,]  -13.1213646 12.910428  -38.8602637  12.0713423
 [90,]  -11.4077555 15.071924  -41.3330214  18.0321354
 [91,]   26.7495221 13.327575    0.9161476  53.0006287
 [92,]    8.9604593 11.401459  -13.0689425  31.0494337
 [93,]  -32.4624035  9.748822  -51.5978714 -13.1446988
 [94,]    2.8203337  8.530128  -13.8994592  20.0674110
 [95,]    3.2022708  7.947571  -12.2476124  19.0109887
 [96,]   10.0801080  8.138917   -5.7956659  25.9210092
 [97,]    3.2734452  9.055237  -14.3885093  20.7545452
 [98,]   -3.5226176 10.508565  -24.0690219  16.8016879
 [99,]   16.4211195 12.310151   -8.0349271  40.3819043
[100,]    0.2452567 14.329234  -28.7481397  28.1620131
[101,]    9.3188533 13.029905  -14.9227517  35.7405532
[102,]   -8.0196603 11.197112  -28.9344423  14.7600875
[103,]  -10.9627739  9.662186  -29.4269822   8.8000005
[104,]   -6.5183875  8.586384  -23.0057103  10.8262713
[105,]  -22.2821011  8.153513  -38.1047180  -6.2819867
[106,]  -14.7700147  8.462813  -31.0749960   1.5604570
[107,]  -14.5316283  9.441624  -33.1929935   3.5277449
[108,]    0.4535581 10.911231  -20.8626806  21.4322585
[109,]   17.0801445 12.702412   -8.2689776  41.9504951
[110,]   20.8926309 14.698069   -8.3823965  49.6508056
[111,]   17.4466504 13.251337   -7.8018433  44.9142919
[112,]  -12.4006040 11.307318  -34.1436312  10.4815420
[113,]  -16.6550585  9.656121  -35.7369665   2.6101222
[114,]  -34.3373130  8.470753  -50.9955561 -17.9637197
[115,]  -37.9526675  7.962058  -53.6200724 -22.8256449
[116,]    5.8507781  8.256078  -10.3604873  22.0839261
[117,]   38.5658236  9.276800   20.4851296  56.3239070
[118,]    5.0349691 10.820487  -16.2001705  25.8443660
[119,]   19.5990146 12.697819   -5.3254479  44.1281200
[120,]   -2.8402399 14.782219  -32.3673920  25.5656792
[121,]   -5.1759100 12.340109  -30.0226995  17.8742966
[122,]   36.8806406 10.626250   15.4491856  56.9580106
[123,]   -0.7576088  9.186111  -19.1731020  16.8186649
[124,]    2.4630417  8.165819  -14.0272017  18.3195141
[125,]  -13.7732077  7.733376  -28.9941029   1.6506573
[126,]   11.5584429  7.984868   -4.3703389  27.3963935
[127,]  -12.8031065  8.862261  -30.2075204   4.5838821
[128,]  -41.4287560 10.205379  -61.7515693 -21.5783549
[129,]    6.0429946 11.856997  -17.8749848  28.9871165
[130,]   24.5921452 13.706039   -3.1905716  51.1306803
[131,]  -50.0606170 12.563542  -75.0687925 -25.5408066
[132,]   12.4094609 10.805380   -9.0316085  33.3482098
[133,]   27.0473388  9.330867    8.8187988  45.0039417
[134,]   32.9776167  8.292714   17.2062929  49.0583407
[135,]   20.8155946  7.865642    5.7508309  36.2552321
[136,]   10.8573725  8.146332   -4.9320624  26.3923191
[137,]   -1.5914495  9.069307  -19.2892094  15.9081764
[138,]   -9.6321716 10.465998  -30.1960248  10.3351682
[139,]   -8.4708937 12.174444  -32.3868937  14.8591151
[140,]   -9.6165158 14.081628  -37.0922409  17.3680874
[141,]   17.4980626 12.283381   -6.2295872  41.7483628
[142,]    2.6360262 10.606521  -17.6741843  23.5470413
[143,]  -19.9339103  9.221112  -37.9022608  -1.6094188
[144,]  -10.8951467  8.274858  -27.0201745   5.1008124
[145,]   14.8950169  7.926625   -0.2391017  30.1620601
[146,]    5.9108805  8.252470   -9.7612624  21.9574985
[147,]  -24.5427560  9.180898  -42.4021868  -6.2969894
[148,]   14.0694076 10.554064   -6.3282991  35.5451149
[149,]   -5.1489288 12.222986  -28.3246671  19.5655175
[150,]    9.7087348 14.082907  -17.5383721  37.8806776
[151,]   -1.3471100 13.582585  -27.6061992  25.4551117
[152,]   -7.2291425 11.636396  -29.7626381  15.3670140
[153,]  -17.9933750  9.965701  -37.9966158   1.3126711
[154,]  -31.5627075  8.730125  -49.0601607 -14.1474859
[155,]  -19.6399400  8.130521  -35.8098778  -3.5424887
[156,]   41.8749275  8.305783   25.3979076  58.1162117
[157,]  -36.3122050  9.211791  -54.0781028 -18.2867992
[158,]   14.9836625 10.663890   -5.4334028  35.8018309
[159,]   17.4196300 12.472786   -6.4561999  42.0542355
[160,]    9.3438975 14.505607  -18.9944078  37.3193662
[161,]   17.7607722 12.320946   -6.5217110  42.2440149
[162,]   10.8555413 10.609055  -10.0372729  31.9636333
[163,]    6.8440105  9.202647  -11.3518342  24.9472666
[164,]    1.2669796  8.259282  -14.7885209  17.6243187
[165,]  -10.8196512  7.945634  -26.2966512   4.8469648
[166,]  -14.9457821  8.333116  -31.4649259   1.4845236
[167,]  -49.6596129  9.334820  -68.0424754 -31.5017753
[168,]  -13.7624438 10.780875  -34.6031104   7.6773454
[169,]   22.9200254 12.518228   -1.6238175  48.1777987
[170,]   32.1408945 14.442130    3.8592315  61.3336589
[171,]    6.1326926 12.133662  -17.6232939  29.6039300
[172,]   -1.6516512 10.457142  -21.8662511  18.7683456
[173,]   10.6245050  9.073948   -6.7181768  28.4458710
[174,]   11.8126612  8.135106   -4.0363449  27.5618923
[175,]  -23.4929826  7.802695  -38.8667418  -8.0454808
[176,]    7.0953736  8.151246   -8.9106665  23.4316241
[177,]    0.1229298  9.102872  -18.1292716  18.2787128
[178,]   -2.9856140 10.494780  -23.7547630  18.1175335
[179,]   11.0895422 12.176914  -12.7868885  35.4965340
[180,]   -5.7752016 14.045381  -33.2511291  21.9989979</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.3  3.4
looic      1769.8 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   463       
 (0.5, 0.7]   (ok)         1    0.6%   117       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.4
p_loo        34.6  8.6
looic      1723.5 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   797       
 (0.5, 0.7]   (ok)         3    1.7%   290       
   (0.7, 1]   (bad)        2    1.1%   46        
   (1, Inf)   (very bad)   1    0.6%   24        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.2      11.7  
fit_sleep1 -91.5      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.3  3.4
looic      1769.8 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   463       
 (0.5, 0.7]   (ok)         1    0.6%   117       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.4
p_loo        34.6  8.6
looic      1723.5 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   797       
 (0.5, 0.7]   (ok)         3    1.7%   290       
   (0.7, 1]   (bad)        2    1.1%   46        
   (1, Inf)   (very bad)   1    0.6%   24        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.7     22.4        34.6    8.6   1723.5
fit_sleep2  -23.2      11.7  -884.9     14.4        19.3    3.4   1769.8
fit_sleep1  -91.5      21.1  -953.2     10.5         3.1    0.5   1906.5
           se_looic
fit_sleep3   44.9  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.830701e-40 8.710337e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.84      1.57     0.25     5.42       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.16      1.57    -3.33     2.87       5.47      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.3          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.3         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.3.1      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
