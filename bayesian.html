<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.93      6.91    15.38    42.28 1.00     2096     2673
sd(Days)                6.53      1.48     4.14     9.93 1.00     1532     2146
cor(Intercept,Days)     0.08      0.30    -0.48     0.67 1.00      945     1498

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.20      7.34   236.91   265.90 1.00     1799     2301
Days         10.47      1.66     7.21    13.80 1.00     1289     1998

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.93      1.57    23.16    29.25 1.00     4031     2881

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6461  13.01234 228.2407 279.1148
309 211.1374  13.42813 184.7950 237.4087
310 212.8928  13.39167 185.9908 238.4101
330 274.3182  13.48320 248.7252 301.5123
331 273.3499  12.97773 248.2540 298.6826
332 260.3168  12.25128 236.4805 284.6061
333 267.6633  12.52218 243.7871 293.4530
334 244.4200  12.53065 219.9772 269.0871
335 250.8881  13.20365 225.1243 277.1333
337 285.9702  12.88771 261.5478 312.6334
349 226.5717  13.14220 199.9353 251.4373
350 238.7552  13.30491 211.5922 264.3169
351 255.6432  12.74149 230.5947 280.3825
352 271.8220  12.70467 247.2357 296.2798
369 254.8265  12.31472 231.0819 279.0265
370 226.1558  13.79734 198.4503 252.4469
371 252.1203  11.85296 228.7248 275.7933
372 263.7314  12.39090 240.1062 288.2608

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6596526  2.524996 14.7427304 24.712051
309  1.8465858  2.554609 -3.1510852  6.783200
310  4.9301528  2.502367  0.0272444  9.766808
330  5.7874216  2.537850  0.6712675 10.656339
331  7.4548708  2.424343  2.6740258 12.168257
332 10.1935363  2.359386  5.5706188 14.799170
333 10.3345899  2.426838  5.4468367 15.069147
334 11.4834135  2.400977  6.8902218 16.074391
335 -0.2506544  2.545932 -5.1657380  4.552139
337 19.1798026  2.466539 14.2035685 23.973333
349 11.5436870  2.471661  6.9294337 16.417971
350 16.9978802  2.543754 12.2857731 22.158152
351  7.4611670  2.450628  2.6315809 12.249277
352 14.1396756  2.439016  9.3385907 18.966747
369 11.2806464  2.334379  6.6151499 15.708155
370 15.2507915  2.598465 10.2291231 20.431296
371  9.5230268  2.252406  4.9720011 13.995619
372 11.7446164  2.356331  7.1534315 16.295481</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6461 13.012344 228.2407 279.1148
  [2,] 273.3058 11.114219 251.4561 294.8848
  [3,] 292.9654  9.512194 274.3567 311.1744
  [4,] 312.6251  8.377888 296.4758 328.9106
  [5,] 332.2847  7.915011 316.7657 347.9397
  [6,] 351.9444  8.237536 336.0961 368.3294
  [7,] 371.6040  9.263790 353.3396 390.1524
  [8,] 391.2637 10.794898 369.7824 412.8067
  [9,] 410.9234 12.648836 385.6741 436.1812
 [10,] 430.5830 14.703995 401.2721 459.8262
 [11,] 211.1374 13.428130 184.7950 237.4087
 [12,] 212.9840 11.535694 190.3031 235.5421
 [13,] 214.8306  9.943935 195.7748 234.2417
 [14,] 216.6772  8.817229 199.5370 234.0550
 [15,] 218.5238  8.346093 202.1596 234.8155
 [16,] 220.3704  8.638465 203.4769 237.3068
 [17,] 222.2169  9.625016 202.9669 241.2761
 [18,] 224.0635 11.122537 202.2911 246.3332
 [19,] 225.9101 12.955030 200.7369 251.5429
 [20,] 227.7567 15.000228 198.2981 257.6245
 [21,] 212.8928 13.391673 185.9908 238.4101
 [22,] 217.8229 11.479464 194.7972 239.9066
 [23,] 222.7531  9.835800 203.2709 241.7383
 [24,] 227.6832  8.615772 210.6388 244.6575
 [25,] 232.6134  8.015220 216.8318 248.6466
 [26,] 237.5435  8.171883 221.6388 253.9988
 [27,] 242.4737  9.046505 225.0958 260.7940
 [28,] 247.4038 10.460523 226.9214 268.3805
 [29,] 252.3340 12.228225 228.1914 276.6831
 [30,] 257.2641 14.218303 229.1689 285.2039
 [31,] 274.3182 13.483196 248.7252 301.5123
 [32,] 280.1056 11.560488 258.2051 303.1125
 [33,] 285.8931  9.918396 266.8405 305.3212
 [34,] 291.6805  8.716973 274.7223 308.4238
 [35,] 297.4679  8.153406 281.3702 313.1533
 [36,] 303.2553  8.357740 287.0357 319.2904
 [37,] 309.0427  9.279383 291.1737 326.9444
 [38,] 314.8302 10.735151 293.9459 336.0082
 [39,] 320.6176 12.540389 295.9218 345.3293
 [40,] 326.4050 14.565734 297.6995 354.8550
 [41,] 273.3499 12.977726 248.2540 298.6826
 [42,] 280.8047 11.163775 259.0176 302.4767
 [43,] 288.2596  9.622539 269.4178 306.6799
 [44,] 295.7145  8.503618 279.1225 312.0445
 [45,] 303.1694  7.986529 287.6196 318.9791
 [46,] 310.6242  8.186125 294.6365 326.6364
 [47,] 318.0791  9.055138 300.4063 335.3764
 [48,] 325.5340 10.427525 304.9042 345.4283
 [49,] 332.9888 12.133669 309.1713 356.1822
 [50,] 340.4437 14.052524 313.1208 367.4753
 [51,] 260.3168 12.251284 236.4805 284.6061
 [52,] 270.5104 10.563295 249.8332 291.2947
 [53,] 280.7039  9.176374 262.7365 298.3042
 [54,] 290.8974  8.243900 274.4432 306.5786
 [55,] 301.0910  7.927883 285.1089 316.2224
 [56,] 311.2845  8.299046 294.7054 327.5439
 [57,] 321.4780  9.275258 302.9053 339.5085
 [58,] 331.6716 10.692056 310.2120 352.3756
 [59,] 341.8651 12.399319 317.2148 365.9054
 [60,] 352.0587 14.293339 323.5084 379.6062
 [61,] 267.6633 12.522176 243.7871 293.4530
 [62,] 277.9979 10.741732 257.7638 300.2430
 [63,] 288.3325  9.259795 270.5219 307.0178
 [64,] 298.6671  8.239047 282.3530 314.9454
 [65,] 309.0017  7.861237 293.3888 324.0892
 [66,] 319.3363  8.215552 303.3219 335.1474
 [67,] 329.6709  9.217951 311.6899 347.3291
 [68,] 340.0054 10.687611 318.8391 360.6990
 [69,] 350.3400 12.460277 326.1110 374.6064
 [70,] 360.6746 14.424669 332.4467 388.9887
 [71,] 244.4200 12.530654 219.9772 269.0871
 [72,] 255.9034 10.735126 234.4915 276.9018
 [73,] 267.3868  9.219434 248.9323 285.2928
 [74,] 278.8702  8.141398 262.7454 294.3798
 [75,] 290.3536  7.687402 275.6357 305.4211
 [76,] 301.8371  7.964880 286.2888 317.0757
 [77,] 313.3205  8.905720 296.0885 330.7740
 [78,] 324.8039 10.330235 304.5190 344.9803
 [79,] 336.2873 12.068349 312.7301 359.6993
 [80,] 347.7707 14.003775 320.6068 374.7890
 [81,] 250.8881 13.203650 225.1243 277.1333
 [82,] 250.6375 11.247089 228.2809 272.9632
 [83,] 250.3868  9.571895 231.6333 269.5363
 [84,] 250.1362  8.349184 233.4845 266.4364
 [85,] 249.8855  7.794878 234.0931 265.2064
 [86,] 249.6349  8.048286 233.8285 265.5191
 [87,] 249.3842  9.041749 231.7397 267.3723
 [88,] 249.1335 10.568590 228.4640 270.5940
 [89,] 248.8829 12.433845 224.4763 274.0673
 [90,] 248.6322 14.507564 220.1207 277.4747
 [91,] 285.9702 12.887706 261.5478 312.6334
 [92,] 305.1500 11.047219 284.2696 327.6924
 [93,] 324.3298  9.495092 306.2283 343.7119
 [94,] 343.5096  8.392862 326.9370 360.7124
 [95,] 362.6894  7.930392 347.1250 378.3969
 [96,] 381.8692  8.216431 365.6728 398.0983
 [97,] 401.0490  9.181285 383.2761 419.1176
 [98,] 420.2288 10.641893 399.7493 441.0130
 [99,] 439.4086 12.424629 415.5755 463.3169
[100,] 458.5884 14.410433 430.6096 486.1866
[101,] 226.5717 13.142204 199.9353 251.4373
[102,] 238.1154 11.292836 214.9354 259.5655
[103,] 249.6591  9.724042 229.6448 268.1019
[104,] 261.2028  8.590929 244.0397 278.0491
[105,] 272.7465  8.078944 256.9801 288.7320
[106,] 284.2902  8.303784 267.7298 300.4507
[107,] 295.8339  9.211652 277.4483 313.6973
[108,] 307.3775 10.628944 285.8879 327.5575
[109,] 318.9212 12.381946 294.0199 342.5070
[110,] 330.4649 14.348133 302.0043 357.9413
[111,] 238.7552 13.304909 211.5922 264.3169
[112,] 255.7530 11.349357 232.7245 277.2642
[113,] 272.7509  9.671432 253.1353 290.9987
[114,] 289.7488  8.438403 272.7971 305.9525
[115,] 306.7467  7.862447 291.0345 322.1198
[116,] 323.7446  8.085225 307.5516 339.6074
[117,] 340.7424  9.047930 322.9590 358.2090
[118,] 357.7403 10.549908 337.0104 378.2935
[119,] 374.7382 12.396672 350.9345 398.9059
[120,] 391.7361 14.456685 364.1430 419.6782
[121,] 255.6432 12.741492 230.5947 280.3825
[122,] 263.1044 10.922098 241.5669 284.2547
[123,] 270.5656  9.394146 252.1813 288.8464
[124,] 278.0267  8.319790 261.8446 294.3637
[125,] 285.4879  7.886633 269.9421 301.5662
[126,] 292.9491  8.196963 277.1649 309.6592
[127,] 300.4102  9.175653 282.6266 319.0157
[128,] 307.8714 10.639838 287.1287 329.0508
[129,] 315.3326 12.418972 291.0622 339.6221
[130,] 322.7937 14.396762 294.3072 350.7571
[131,] 271.8220 12.704668 247.2357 296.2798
[132,] 285.9617 10.869097 264.7771 307.2457
[133,] 300.1013  9.314694 282.0483 318.5156
[134,] 314.2410  8.202888 298.0370 330.5230
[135,] 328.3807  7.727149 313.1665 343.4242
[136,] 342.5204  8.001742 326.3826 358.0459
[137,] 356.6600  8.957931 338.6055 373.8246
[138,] 370.7997 10.409552 349.9278 390.7282
[139,] 384.9394 12.180747 360.9462 408.5504
[140,] 399.0791 14.152033 371.1857 426.9094
[141,] 254.8265 12.314716 231.0819 279.0265
[142,] 266.1072 10.621672 245.6953 287.3034
[143,] 277.3878  9.213374 259.4928 295.1329
[144,] 288.6685  8.237187 272.9055 304.4109
[145,] 299.9491  7.855883 284.7844 315.0018
[146,] 311.2298  8.153354 295.0516 326.9587
[147,] 322.5104  9.063009 304.3177 340.1158
[148,] 333.7911 10.425820 312.7874 354.3331
[149,] 345.0717 12.089499 321.1706 368.6960
[150,] 356.3524 13.946787 328.6004 383.5863
[151,] 226.1558 13.797340 198.4503 252.4469
[152,] 241.4066 11.767020 217.8715 263.7101
[153,] 256.6573 10.003148 236.5627 275.7734
[154,] 271.9081  8.669903 254.4305 288.4385
[155,] 287.1589  7.985956 271.0962 302.5030
[156,] 302.4097  8.117131 285.8579 317.9640
[157,] 317.6605  9.027967 299.6150 334.5897
[158,] 332.9113 10.517822 312.4237 353.1344
[159,] 348.1621 12.379379 323.9368 371.8089
[160,] 363.4129 14.469882 334.5272 390.7232
[161,] 252.1203 11.852963 228.7248 275.7933
[162,] 261.6433 10.234142 241.5863 281.7301
[163,] 271.1663  8.895462 253.6176 288.3777
[164,] 280.6893  7.979192 265.0650 296.2562
[165,] 290.2124  7.638876 275.3356 305.2184
[166,] 299.7354  7.948836 284.2974 315.1297
[167,] 309.2584  8.840941 291.8159 326.1526
[168,] 318.7815 10.163028 298.6958 338.1156
[169,] 328.3045 11.771096 305.4057 350.8588
[170,] 337.8275 13.563810 311.4035 363.9008
[171,] 263.7314 12.390903 240.1062 288.2608
[172,] 275.4760 10.684241 254.8029 296.5270
[173,] 287.2207  9.266937 268.9991 305.5546
[174,] 298.9653  8.288777 282.5273 315.6077
[175,] 310.7099  7.914298 294.7539 326.2624
[176,] 322.4545  8.226360 305.9899 338.8299
[177,] 334.1991  9.155025 315.9382 352.3407
[178,] 345.9437 10.538528 324.7310 366.7943
[179,] 357.6884 12.223389 333.5245 381.7911
[180,] 369.4330 14.102003 341.7068 397.3699</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.0861298 13.012344  -29.55479042  21.3193186
  [2,]  -14.6010824 11.114219  -36.18012748   7.2485828
  [3,]  -42.1648350  9.512194  -60.37382236 -23.5560543
  [4,]    8.8147125  8.377888   -7.47081659  24.9639676
  [5,]   24.5671599  7.915011    8.91216371  40.0861864
  [6,]   62.7457074  8.237536   46.36074154  78.5940486
  [7,]   10.5997548  9.263790   -7.94863564  28.8642088
  [8,] -101.1150977 10.794898 -122.65814739 -79.6337541
  [9,]   19.6619497 12.648836   -5.59585747  44.9112128
 [10,]   35.7704971 14.703995    6.52731362  65.0814179
 [11,]   11.5964707 13.428130  -14.67482006  37.9388580
 [12,]   -7.7182151 11.535694  -30.27634414  14.9627257
 [13,]  -11.8528009  9.943935  -31.26387182   7.2029618
 [14,]  -11.9701867  8.817229  -29.34797055   5.1700440
 [15,]  -10.8076725  8.346093  -27.09942037   5.5565314
 [16,]   -4.4085583  8.638465  -21.34501114  12.4848941
 [17,]   -8.5866441  9.625016  -27.64576970  10.6634294
 [18,]   -6.3363299 11.122537  -28.60602505  15.4361338
 [19,]   -1.6144157 12.955030  -27.24718179  23.5588262
 [20,]    9.5574985 15.000228  -20.31033517  39.0161080
 [21,]  -13.8388643 13.391673  -39.35620070  13.0630522
 [22,]  -23.4907171 11.479464  -45.57443209  -0.4650134
 [23,]   11.5669302  9.835800   -7.41832365  31.0491017
 [24,]    5.1583774  8.615772  -11.81593687  22.2027604
 [25,]   -3.3059754  8.015220  -19.33922315  12.4755665
 [26,]  -17.0856281  8.171883  -33.54094766  -1.1808837
 [27,]   -7.0528809  9.046505  -25.37315783  10.3249510
 [28,]    8.3472663 10.460523  -12.62935754  28.8296972
 [29,]    8.6785136 12.228225  -15.67060742  32.8211038
 [30,]   -9.7488392 14.218303  -37.68855830  18.3463911
 [31,]   47.2243803 13.483196   20.03031514  72.8174442
 [32,]   20.2945587 11.560488   -2.71232337  42.1950760
 [33,]   -2.0365629  9.918396  -21.46473193  17.0159568
 [34,]   -6.5474845  8.716973  -23.29081554  10.4106742
 [35,]  -11.6706061  8.153406  -27.35600756   4.4271202
 [36,]   -5.6698277  8.357740  -21.70489017  10.5498313
 [37,]  -28.8031493  9.279383  -46.70480250 -10.9340918
 [38,]    3.4311292 10.735151  -17.74686268  24.3153870
 [39,]  -15.2680924 12.540389  -39.97977629   9.4277293
 [40,]   27.6436860 14.565734   -0.80633006  56.3492324
 [41,]   14.2580299 12.977726  -11.07468749  39.3539208
 [42,]    4.1952591 11.163775  -17.47665480  25.9823866
 [43,]   13.5609882  9.622539   -4.85927712  32.4027585
 [44,]   24.4008174  8.503618    8.07077534  40.9927528
 [45,]   13.1079466  7.986529   -2.70176458  28.6576537
 [46,]  -17.3055243  8.186125  -33.31772619  -1.3177671
 [47,]  -28.0040951  9.055138  -45.30141726 -10.3313243
 [48,]    9.2837341 10.427525  -10.61055441  29.9135251
 [49,]  -39.2419367 12.133669  -62.43531609 -15.4243877
 [50,]   31.1373924 14.052524    4.10579140  58.4602855
 [51,]  -25.4562308 12.251284  -49.74554998  -1.6198643
 [52,]  -27.6985671 10.563295  -48.48286437  -7.0213589
 [53,]   -7.7426033  9.176374  -25.34287238  10.2248284
 [54,]   18.8713604  8.243900    3.19023549  35.3256132
 [55,]   16.3719241  7.927883    1.24054189  32.3540494
 [56,]   -1.2869121  8.299046  -17.54631788  15.2922299
 [57,]  132.6838516  9.275258  114.65335768 151.2566461
 [58,]   15.1595154 10.692056   -5.54451260  36.6191092
 [59,]  -11.5648209 12.399319  -35.60508567  13.0855291
 [60,]  -98.1942572 14.293339 -125.74179780 -69.6439903
 [61,]   16.1790869 12.522176   -9.61056530  40.0552884
 [62,]   11.5570970 10.741732  -10.68798795  31.7911675
 [63,]  -11.5631929  9.259795  -30.24854225   6.2474397
 [64,]    1.1426173  8.239047  -15.13567943  17.4566812
 [65,]  -11.8306726  7.861237  -26.91822371   3.7821806
 [66,]   18.8302375  8.215552    3.01910398  34.8445924
 [67,]    2.3556477  9.217951  -15.30256289  20.3365983
 [68,]    8.8344578 10.687611  -11.85911310  30.0007850
 [69,]  -16.9800320 12.460277  -41.24644547   7.2490144
 [70,]    1.3681781 14.424669  -26.94585275  29.5960615
 [71,]   21.0531059 12.530654   -3.61401225  45.4959436
 [72,]   20.2977925 10.735126   -0.70056283  41.7096694
 [73,]  -24.0221210  9.219434  -41.92814259  -5.5676176
 [74,]  -24.1979345  8.141398  -39.70754709  -8.0730871
 [75,]  -11.3292480  7.687402  -26.39665021   3.3886662
 [76,]  -17.6458615  7.964880  -32.88445163  -2.0975958
 [77,]   -7.7956750  8.905720  -25.24922977   9.4362787
 [78,]    6.7190116 10.330235  -13.45742725  27.0038992
 [79,]   -0.5404019 12.068349  -23.95240210  23.0167722
 [80,]   29.5282846 14.003775    2.50996792  56.6921956
 [81,]   -9.2798241 13.203650  -35.52500913  16.4840304
 [82,]   23.3097303 11.247089    0.98396893  45.6662855
 [83,]    4.1038847  9.571895  -15.04559516  22.8574225
 [84,]   20.6659391  8.349184    4.36567689  37.3175884
 [85,]    1.5663935  7.794878  -13.75447387  17.3588457
 [86,]    5.0013479  8.048286  -10.88285590  20.8076958
 [87,]   -3.9318977  9.041749  -21.91998070  13.7125681
 [88,]  -13.8225433 10.568590  -35.28296887   6.8470171
 [89,]  -13.1287889 12.433845  -38.31319135  11.2778337
 [90,]  -11.3856344 14.507564  -40.22806653  17.1259500
 [91,]   26.3964163 12.887706   -0.26676487  50.8188171
 [92,]    8.6558137 11.047219  -13.88656562  29.5362091
 [93,]  -32.7185889  9.495092  -52.10070521 -14.6170505
 [94,]    2.6126084  8.392862  -14.59016511  19.1852104
 [95,]    3.0430058  7.930392  -12.66451016  18.6073556
 [96,]    9.9693031  8.216431   -6.25984448  26.1656684
 [97,]    3.2111005  9.181285  -14.85750870  20.9840252
 [98,]   -3.5365021 10.641893  -24.32071486  16.9430303
 [99,]   16.4556952 12.424629   -7.45258392  40.2888434
[100,]    0.3282926 14.410433  -27.26987287  28.3071300
[101,]    9.5314668 13.142204  -15.33413423  36.1678694
[102,]   -7.7987202 11.292836  -29.24875947  15.3813073
[103,]  -10.7335072  9.724042  -29.17628160   9.2807857
[104,]   -6.2807942  8.590929  -23.12708004  10.8822829
[105,]  -22.0361812  8.078944  -38.02166562  -6.2697599
[106,]  -14.5157682  8.303784  -30.67630964   2.0446320
[107,]  -14.2690552  9.211652  -32.13249594   4.1164796
[108,]    0.7244578 10.628944  -19.45553197  22.2140587
[109,]   17.3593708 12.381946   -6.22640404  42.2607055
[110,]   21.1801838 14.348133   -6.29616961  49.6407630
[111,]   17.5416445 13.304909   -8.02009555  44.7045980
[112,]  -12.2987357 11.349357  -33.80989748  10.7298246
[113,]  -16.5463159  9.671432  -34.79406981   3.0693210
[114,]  -34.2216962  8.438403  -50.42539262 -17.2700348
[115,]  -37.8301764  7.862447  -53.20332592 -22.1179596
[116,]    5.9801434  8.085225   -9.88268420  22.1731017
[117,]   38.7020632  9.047930   21.23548068  56.4854649
[118,]    5.1780830 10.549908  -15.37506610  25.9080089
[119,]   19.7490028 12.396672   -4.41869468  43.5527385
[120,]   -2.6833774 14.456685  -30.62550502  24.9096651
[121,]   -5.1167275 12.741492  -29.85600188  19.9318022
[122,]   36.9532055 10.922098   15.80291886  58.4906679
[123,]   -0.6716615  9.394146  -18.95245387  17.7125787
[124,]    2.5623715  8.319790  -13.77462854  18.7445480
[125,]  -13.6604955  7.886633  -29.73876670   1.8853244
[126,]   11.6845375  8.196963   -5.02563686  27.4686512
[127,]  -12.6636295  9.175653  -31.26911832   5.1200051
[128,]  -41.2758964 10.639838  -62.45530981 -20.5331703
[129,]    6.2092366 12.418972  -18.08027519  30.4795579
[130,]   24.7717696 14.396762   -3.19161143  53.2582840
[131,]  -50.1448863 12.704668  -74.60267186 -25.5586449
[132,]   12.2322380 10.869097   -9.05183803  33.4167989
[133,]   26.7771624  9.314694    8.36287783  44.8301804
[134,]   32.6144867  8.202888   16.33247161  48.8184535
[135,]   20.3595111  7.727149    5.31603434  35.5736503
[136,]   10.3083355  8.001742   -5.21717372  26.4460695
[137,]   -2.2334402  8.957931  -19.39799249  15.8211471
[138,]  -10.3671158 10.409552  -30.29560736  10.5048152
[139,]   -9.2987915 12.180747  -32.90978675  14.6943514
[140,]  -10.5373671 14.152033  -38.36770296  17.3559798
[141,]   17.0969515 12.314716   -7.10298005  40.8416339
[142,]    2.3297051 10.621672  -18.86645619  22.7416390
[143,]  -20.1454414  9.213374  -37.89052970  -2.2504050
[144,]  -11.0118878  8.237187  -26.75426464   4.7511085
[145,]   14.8730658  7.855883   -0.17955185  30.0377740
[146,]    5.9837193  8.153354   -9.74524467  22.1618933
[147,]  -24.3751271  9.063009  -41.98053634  -6.1823962
[148,]   14.3318264 10.425820   -6.21015746  35.3355000
[149,]   -4.7917200 12.089499  -28.41599373  19.1094095
[150,]   10.1607336 13.946787  -17.07323153  37.9127093
[151,]   -0.8917662 13.797340  -27.18287840  26.8136667
[152,]   -6.8830577 11.767020  -29.18664360  16.6520095
[153,]  -17.7565491 10.003148  -36.87255918   2.3381471
[154,]  -31.4351406  8.669903  -47.96547018 -13.9574668
[155,]  -19.6216321  7.985956  -34.96572551  -3.5588910
[156,]   41.7839764  8.117131   26.22966913  58.3358471
[157,]  -36.5124150  9.027967  -53.44158764 -18.4668582
[158,]   14.6741935 10.517822   -5.54890184  35.1618021
[159,]   17.0009020 12.379379   -6.64587049  41.2262013
[160,]    8.8159105 14.469882  -18.49443687  37.7015679
[161,]   17.7601313 11.852963   -5.91290930  41.1556309
[162,]   10.7995045 10.234142   -9.28730366  30.8565393
[163,]    6.7325777  8.895462  -10.47883315  24.2813439
[164,]    1.1001510  7.979192  -14.46674264  16.7244548
[165,]  -11.0418758  7.638876  -26.04790691   3.8349001
[166,]  -15.2234026  7.948836  -30.61770184   0.2146003
[167,]  -49.9926293  8.840941  -66.88680736 -32.5501439
[168,]  -14.1508561 10.163028  -33.48503131   5.9347550
[169,]   22.4762171 11.771096   -0.07814544  45.3750386
[170,]   31.6416903 13.563810    5.56837251  58.0657216
[171,]    5.6802670 12.390903  -18.84905491  29.3054977
[172,]   -2.0020495 10.684241  -23.05298380  18.6710526
[173,]   10.3761341  9.266937   -7.95782530  28.5977311
[174,]   11.6663177  8.288777   -4.97607328  28.1042724
[175,]  -23.5372988  7.914298  -39.08979929  -7.5813186
[176,]    7.1530848  8.226360   -9.22232276  23.6177423
[177,]    0.2826684  9.155025  -17.85885283  18.5436125
[178,]   -2.7238480 10.538528  -23.57443563  18.4888894
[179,]   11.4533355 12.223389  -12.64935354  35.6171554
[180,]   -5.3093809 14.102003  -33.24625222  22.4167547</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.3
p_loo        19.5  3.3
looic      1770.4 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   457       
 (0.5, 0.7]   (ok)         2    1.1%   178       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.3
p_loo        34.1  8.4
looic      1722.1 44.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   776       
 (0.5, 0.7]   (ok)         5    2.8%   655       
   (0.7, 1]   (bad)        2    1.1%   27        
   (1, Inf)   (very bad)   1    0.6%   27        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.2      11.6  
fit_sleep1 -92.3      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.3
p_loo        19.5  3.3
looic      1770.4 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   457       
 (0.5, 0.7]   (ok)         2    1.1%   178       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.3
p_loo        34.1  8.4
looic      1722.1 44.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   776       
 (0.5, 0.7]   (ok)         5    2.8%   655       
   (0.7, 1]   (bad)        2    1.1%   27        
   (1, Inf)   (very bad)   1    0.6%   27        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.0     22.3        34.1    8.4   1722.1
fit_sleep2  -24.2      11.6  -885.2     14.3        19.5    3.3   1770.4
fit_sleep1  -92.3      20.9  -953.3     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.6  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.203727e-41 3.225851e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.95      1.58     0.27     5.37       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.05      1.58    -3.29     2.85       5.04      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.22 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.0         
  [4] magrittr_2.0.3       matrixStats_0.63.0   compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.21      
 [22] markdown_1.6         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.7         jsonlite_1.8.4      
 [28] highr_0.10           later_1.3.0          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.42           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.9        
 [43] splines_4.3.0        igraph_1.4.2         tidyselect_1.2.0    
 [46] abind_1.4-5          yaml_2.3.7           codetools_0.2-19    
 [49] miniUI_0.1.1.1       curl_5.0.0           processx_3.8.1      
 [52] pkgbuild_1.4.0       lattice_0.21-8       tibble_3.2.1        
 [55] plyr_1.8.8           shiny_1.7.4          withr_2.5.0         
 [58] bridgesampling_1.1-2 posterior_1.4.1      coda_0.19-4         
 [61] evaluate_0.20        RcppParallel_5.1.7   xts_0.13.1          
 [64] pillar_1.9.0         tensorA_0.36.2       checkmate_2.1.0     
 [67] DT_0.27              stats4_4.3.0         shinyjs_2.1.0       
 [70] distributional_0.3.2 generics_0.1.3       ggplot2_3.4.2       
 [73] rstantools_2.3.1     munsell_0.5.0        scales_1.2.1        
 [76] minqa_1.2.5          gtools_3.9.4         xtable_1.8-4        
 [79] glue_1.6.2           tools_4.3.0          shinystan_2.6.0     
 [82] colourpicker_1.2.0   mvtnorm_1.1-3        grid_4.3.0          
 [85] crosstalk_1.2.0      colorspace_2.1-0     nlme_3.1-162        
 [88] cli_3.6.1            fansi_1.0.4          Brobdingnag_1.2-9   
 [91] dplyr_1.1.2          V8_4.3.0             gtable_0.3.3        
 [94] sass_0.4.5           digest_0.6.31        htmlwidgets_1.6.2   
 [97] farver_2.1.1         htmltools_0.5.5      lifecycle_1.0.3     
[100] mime_0.12            shinythemes_1.2.0    MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
