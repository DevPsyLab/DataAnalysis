<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.15      6.89    15.80    42.59 1.00     1646     2214
sd(Days)                6.51      1.45     4.24    10.08 1.00     1449     1773
cor(Intercept,Days)     0.09      0.30    -0.49     0.65 1.00      778     1320

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.39      7.50   236.46   266.56 1.00     1802     2264
Days         10.49      1.73     7.06    13.91 1.00     1171     1501

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.58    23.00    29.22 1.00     3494     2917

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.1771  13.26285 227.0153 279.0126
309 211.1439  13.07823 185.6583 236.2490
310 212.5913  13.50972 185.6323 238.4004
330 274.5802  13.59852 248.5357 301.1313
331 272.9548  13.03539 247.6589 299.8872
332 260.5143  12.18539 236.8764 284.6129
333 268.1990  12.43596 244.5076 293.3822
334 244.2762  12.16942 220.7358 268.0158
335 250.8118  13.43954 226.0455 278.7464
337 285.9854  13.18004 259.8476 312.2022
349 226.8420  12.95821 200.9270 251.7000
350 238.7145  13.11952 211.8703 263.3357
351 255.7274  12.04298 231.6430 279.7829
352 272.1453  12.67647 248.0357 296.7156
369 254.5627  12.18753 229.9492 278.7823
370 226.4037  13.39400 199.5653 251.8601
371 252.1783  12.24238 227.6026 276.5291
372 263.6880  12.50875 239.7750 288.8715

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5972725  2.549837 14.8885866 24.756210
309  1.8284289  2.457010 -2.9599015  6.541354
310  4.9548907  2.512889  0.1102439  9.816630
330  5.7254097  2.558413  0.5945115 10.569529
331  7.4901686  2.477520  2.4784621 12.313293
332 10.1273663  2.353538  5.5099594 14.741868
333 10.2462829  2.393235  5.3820482 14.874082
334 11.5200777  2.309792  7.0771615 16.085083
335 -0.2319926  2.563812 -5.3946665  4.594034
337 19.1361665  2.460460 14.3941790 24.005097
349 11.5487975  2.485816  6.7150350 16.498622
350 17.0244715  2.517019 12.3096435 22.037277
351  7.4852634  2.327617  2.9626567 12.086501
352 14.0218845  2.370058  9.3399437 18.744074
369 11.3633991  2.378861  6.7003138 16.203601
370 15.1861309  2.569442 10.2863674 20.287889
371  9.4901411  2.338083  4.8713835 13.978068
372 11.7487854  2.376729  7.0120122 16.368309</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.1771 13.262848 227.0153 279.0126
  [2,] 273.7744 11.263661 250.3979 294.7387
  [3,] 293.3717  9.531019 274.3566 311.2754
  [4,] 312.9689  8.234922 296.6944 328.8841
  [5,] 332.5662  7.602031 317.7229 347.5225
  [6,] 352.1635  7.795585 337.2013 367.5649
  [7,] 371.7608  8.760980 354.9101 388.9326
  [8,] 391.3580 10.283079 371.4703 411.6608
  [9,] 410.9553 12.154505 387.6765 434.8930
 [10,] 430.5526 14.238174 402.9195 458.5377
 [11,] 211.1439 13.078227 185.6583 236.2490
 [12,] 212.9724 11.218167 190.5539 234.7761
 [13,] 214.8008  9.629554 195.3122 233.4720
 [14,] 216.6292  8.466589 199.6706 232.8451
 [15,] 218.4577  7.919075 202.6659 233.6248
 [16,] 220.2861  8.112593 203.9784 235.7783
 [17,] 222.1145  8.999465 204.0558 239.2421
 [18,] 223.9429 10.403863 203.2127 244.0186
 [19,] 225.7714 12.147599 201.6689 248.9660
 [20,] 227.5998 14.105380 200.0232 254.5983
 [21,] 212.5913 13.509725 185.6323 238.4004
 [22,] 217.5462 11.600352 194.4094 239.6166
 [23,] 222.5011  9.962575 202.4760 241.4158
 [24,] 227.4559  8.750249 210.2924 244.3903
 [25,] 232.4108  8.155369 216.3733 248.5907
 [26,] 237.3657  8.311584 221.3003 253.7726
 [27,] 242.3206  9.180634 224.0637 260.4545
 [28,] 247.2755 10.588432 225.9274 268.1503
 [29,] 252.2304 12.352123 227.6094 276.6005
 [30,] 257.1853 14.340998 229.0241 285.1951
 [31,] 274.5802 13.598525 248.5357 301.1313
 [32,] 280.3056 11.593235 257.6840 302.6570
 [33,] 286.0310  9.847705 267.0931 305.3139
 [34,] 291.7564  8.523052 275.0077 308.8364
 [35,] 297.4819  7.835719 282.0540 312.7964
 [36,] 303.2073  7.952705 287.5029 318.6813
 [37,] 308.9327  8.842144 291.5941 325.8195
 [38,] 314.6581 10.305942 294.5506 334.3790
 [39,] 320.3835 12.138052 296.9319 343.7203
 [40,] 326.1089 14.196589 298.5342 353.3178
 [41,] 272.9548 13.035392 247.6589 299.8872
 [42,] 280.4450 11.156136 258.4242 302.9193
 [43,] 287.9351  9.553716 268.9987 306.8223
 [44,] 295.4253  8.388316 278.9464 311.5382
 [45,] 302.9155  7.856870 287.2659 317.8844
 [46,] 310.4057  8.085369 294.5871 325.5661
 [47,] 317.8958  9.016217 300.4124 335.4474
 [48,] 325.3860 10.463622 305.1851 345.6651
 [49,] 332.8762 12.245766 309.1302 356.7498
 [50,] 340.3663 14.237500 312.2675 368.2201
 [51,] 260.5143 12.185394 236.8764 284.6129
 [52,] 270.6417 10.468114 250.0981 291.0866
 [53,] 280.7691  9.041972 262.9962 298.9414
 [54,] 290.8964  8.062965 275.1368 306.8058
 [55,] 301.0238  7.703494 285.8704 316.0589
 [56,] 311.1512  8.047020 295.6637 326.7522
 [57,] 321.2785  9.013519 303.9322 339.0125
 [58,] 331.4059 10.431242 310.9664 351.7639
 [59,] 341.5333 12.143162 317.5096 365.3603
 [60,] 351.6606 14.042088 323.7545 379.3944
 [61,] 268.1990 12.435961 244.5076 293.3822
 [62,] 278.4453 10.644850 257.8387 299.4616
 [63,] 288.6916  9.133877 271.5408 307.0095
 [64,] 298.9379  8.062116 283.2017 314.7016
 [65,] 309.1842  7.617274 294.2278 324.3865
 [66,] 319.4305  7.905894 303.9281 334.7659
 [67,] 329.6767  8.856557 312.3251 346.8229
 [68,] 339.9230 10.287332 319.9956 360.0614
 [69,] 350.1693 12.028089 326.6234 373.6614
 [70,] 360.4156 13.963373 332.8119 387.8155
 [71,] 244.2762 12.169422 220.7358 268.0158
 [72,] 255.7963 10.486937 235.4043 276.3888
 [73,] 267.3163  9.084445 249.3354 285.1049
 [74,] 278.8364  8.108559 262.8877 294.8340
 [75,] 290.3565  7.722733 275.2737 305.8273
 [76,] 301.8766  8.012662 286.1607 317.8165
 [77,] 313.3967  8.912642 295.3397 331.5089
 [78,] 324.9167 10.263425 304.1799 345.4209
 [79,] 336.4368 11.912636 312.3821 359.8201
 [80,] 347.9569 13.753333 320.5366 374.5968
 [81,] 250.8118 13.439536 226.0455 278.7464
 [82,] 250.5799 11.460747 229.3131 274.3932
 [83,] 250.3479  9.758205 231.6495 270.4991
 [84,] 250.1159  8.499569 233.5644 267.2760
 [85,] 249.8839  7.899940 234.2752 265.6725
 [86,] 249.6519  8.106891 233.5427 265.4345
 [87,] 249.4199  9.065351 231.7107 267.2553
 [88,] 249.1879 10.572878 228.6697 269.9449
 [89,] 248.9559 12.431299 224.6020 273.3317
 [90,] 248.7239 14.506374 220.1468 277.0629
 [91,] 285.9854 13.180036 259.8476 312.2022
 [92,] 305.1215 11.318585 283.0865 327.8477
 [93,] 324.2577  9.727031 305.2385 343.8081
 [94,] 343.3939  8.557313 326.7811 360.4234
 [95,] 362.5300  7.996739 346.6338 378.1010
 [96,] 381.6662  8.171645 365.2092 397.4890
 [97,] 400.8024  9.039439 382.8173 418.2327
 [98,] 419.9385 10.428560 399.5055 439.8980
 [99,] 439.0747 12.161661 414.8227 462.5674
[100,] 458.2109 14.112578 430.3064 485.4443
[101,] 226.8420 12.958211 200.9270 251.7000
[102,] 238.3908 11.115039 216.0183 259.7534
[103,] 249.9396  9.567209 230.6516 268.2007
[104,] 261.4884  8.478056 244.3901 277.6668
[105,] 273.0372  8.036290 256.8151 288.5413
[106,] 284.5859  8.345360 268.0215 301.0846
[107,] 296.1347  9.330952 278.1971 314.6451
[108,] 307.6835 10.809572 287.0235 329.1344
[109,] 319.2323 12.608949 295.1054 344.4243
[110,] 330.7811 14.611054 303.1214 359.8832
[111,] 238.7145 13.119519 211.8703 263.3357
[112,] 255.7390 11.189248 232.9807 276.7856
[113,] 272.7634  9.536640 253.3458 291.0355
[114,] 289.7879  8.328656 273.1058 305.8423
[115,] 306.8124  7.775364 291.6232 321.9752
[116,] 323.8369  8.013541 308.1920 339.6796
[117,] 340.8613  8.980431 323.0237 358.7852
[118,] 357.8858 10.476174 337.3155 378.9466
[119,] 374.9103 12.309470 351.1469 399.2880
[120,] 391.9347 14.351539 364.4108 419.9040
[121,] 255.7274 12.042976 231.6430 279.7829
[122,] 263.2126 10.340935 242.6611 283.7007
[123,] 270.6979  8.925929 252.7267 288.2852
[124,] 278.1831  7.952678 262.5547 293.7229
[125,] 285.6684  7.592995 270.8139 300.6076
[126,] 293.1537  7.930804 277.7748 308.6527
[127,] 300.6389  8.886920 283.5089 317.5400
[128,] 308.1242 10.290415 287.9121 328.0287
[129,] 315.6095 11.985138 292.1353 339.0294
[130,] 323.0947 13.864705 296.2394 350.6665
[131,] 272.1453 12.676467 248.0357 296.7156
[132,] 286.1672 10.936350 265.5217 307.0593
[133,] 300.1891  9.473597 281.7103 318.2528
[134,] 314.2110  8.433781 297.6150 330.5140
[135,] 328.2328  7.983899 312.3341 343.7580
[136,] 342.2547  8.221373 326.2423 358.4099
[137,] 356.2766  9.092504 338.7009 374.2529
[138,] 370.2985 10.439859 350.0421 390.9431
[139,] 384.3204 12.105454 361.1138 408.7979
[140,] 398.3423 13.975970 371.5215 426.4754
[141,] 254.5627 12.187527 229.9492 278.7823
[142,] 265.9261 10.482677 244.8950 286.4634
[143,] 277.2895  9.085987 259.0953 295.1420
[144,] 288.6529  8.157313 272.3349 304.5660
[145,] 300.0162  7.864244 284.6101 315.5255
[146,] 311.3796  8.274592 295.1638 327.7114
[147,] 322.7430  9.295664 304.4625 341.1298
[148,] 334.1064 10.754898 313.2479 355.3048
[149,] 345.4698 12.499770 320.9959 369.8092
[150,] 356.8332 14.427011 328.6905 385.1210
[151,] 226.4037 13.394000 199.5653 251.8601
[152,] 241.5898 11.426153 218.9212 263.5807
[153,] 256.7759  9.742626 237.5107 275.7227
[154,] 271.9621  8.513789 255.2639 288.4865
[155,] 287.1482  7.953271 271.3370 302.4660
[156,] 302.3343  8.199299 286.1400 318.0911
[157,] 317.5205  9.187304 299.4829 335.1375
[158,] 332.7066 10.713947 311.6509 353.1845
[159,] 347.8927 12.584706 322.9042 372.4731
[160,] 363.0789 14.668506 333.9234 391.7782
[161,] 252.1783 12.242382 227.6026 276.5291
[162,] 261.6685 10.557062 240.2086 282.3949
[163,] 271.1586  9.162995 252.6659 288.9424
[164,] 280.6488  8.209911 264.1790 296.4447
[165,] 290.1389  7.859903 274.6103 305.5897
[166,] 299.6290  8.190652 283.6037 316.0448
[167,] 309.1192  9.128458 291.3589 326.6972
[168,] 318.6093 10.512087 297.9187 338.8711
[169,] 328.0995 12.190671 304.1394 351.2932
[170,] 337.5896 14.058955 309.9484 364.3172
[171,] 263.6880 12.508753 239.7750 288.8715
[172,] 275.4368 10.793121 254.8470 297.3865
[173,] 287.1856  9.370791 269.0689 305.9655
[174,] 298.9344  8.392238 282.8705 315.3472
[175,] 310.6832  8.021550 294.9204 326.3974
[176,] 322.4320  8.340177 305.7577 338.5957
[177,] 334.1808  9.277366 315.6974 352.1561
[178,] 345.9295 10.671371 324.4317 366.9000
[179,] 357.6783 12.368690 332.7939 381.7198
[180,] 369.4271 14.261434 340.8249 397.3274</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5        Q97.5
  [1,]   -4.6171232 13.262848  -29.4525580  22.54470877
  [2,]  -15.0696958 11.263661  -36.0339665   8.30683199
  [3,]  -42.5710683  9.531019  -60.4747810 -23.55598585
  [4,]    8.4708592  8.234922   -7.4442714  24.74542134
  [5,]   24.2856866  7.602031    9.3293559  39.12897165
  [6,]   62.5266141  7.795585   47.1252453  77.48884638
  [7,]   10.4430415  8.760980   -6.7287832  27.29368880
  [8,] -101.2094310 10.283079 -121.5122191 -81.32170871
  [9,]   19.6299964 12.154505   -4.3077131  42.90876971
 [10,]   35.8009239 14.238174    7.8158201  63.43395012
 [11,]   11.5899587 13.078227  -13.5150886  37.07557113
 [12,]   -7.7065702 11.218167  -29.5102527  14.71194336
 [13,]  -11.8229992  9.629554  -30.4942470   7.66561664
 [14,]  -11.9222281  8.466589  -28.1381024   5.03635100
 [15,]  -10.7415570  7.919075  -25.9087158   5.05022307
 [16,]   -4.3242860  8.112593  -19.8164568  11.98343958
 [17,]   -8.4842149  8.999465  -25.6117569   9.57454862
 [18,]   -6.2157439 10.403863  -26.2914458  14.51449015
 [19,]   -1.4756728 12.147599  -24.6703126  22.62682114
 [20,]    9.7143983 14.105380  -17.2840954  37.29102255
 [21,]  -13.5373772 13.509725  -39.3465329  13.42158799
 [22,]  -23.2139679 11.600352  -45.2843924  -0.07720209
 [23,]   11.8189413  9.962575   -7.0957720  31.84396410
 [24,]    5.3856506  8.750249  -11.5487437  22.54916070
 [25,]   -3.1034401  8.155369  -19.2832920  12.93412502
 [26,]  -16.9078309  8.311584  -33.3147239  -0.84239233
 [27,]   -6.8998216  9.180634  -25.0337035  11.35710906
 [28,]    8.4755877 10.588432  -12.3991868  29.82368586
 [29,]    8.7820969 12.352123  -15.5880034  33.40308379
 [30,]   -9.6699938 14.340998  -37.6798390  18.49115359
 [31,]   46.9623857 13.598525   20.4113406  73.00688643
 [32,]   20.0945761 11.593235   -2.2567802  42.71617606
 [33,]   -2.1745336  9.847705  -21.4573798  16.76340216
 [34,]   -6.6234433  8.523052  -23.7033597  10.12532370
 [35,]  -11.6845530  7.835719  -26.9990793   3.74332128
 [36,]   -5.6217626  7.952705  -21.0957562  10.08260335
 [37,]  -28.6930723  8.842144  -45.5799332 -11.35453186
 [38,]    3.6032180 10.305942  -16.1177296  23.71073412
 [39,]  -15.0339917 12.138052  -38.3707993   8.41758480
 [40,]   27.9397987 14.196589    0.7308522  55.51449174
 [41,]   14.6530877 13.035392  -12.2792557  39.94901450
 [42,]    4.5550191 11.156136  -17.9193463  26.57584242
 [43,]   13.8854506  9.553716   -5.0017477  32.82185523
 [44,]   24.6899820  8.388316    8.5771110  41.16892992
 [45,]   13.3618134  7.856870   -1.6071495  29.01139874
 [46,]  -17.0869551  8.085369  -32.2474023  -1.26836952
 [47,]  -27.8208237  9.016217  -45.3724389 -10.33737081
 [48,]    9.4317077 10.463622  -10.8473974  29.63261143
 [49,]  -39.1292608 12.245766  -63.0029284 -15.38331432
 [50,]   31.2147706 14.237500    3.3610117  59.31359553
 [51,]  -25.6537427 12.185394  -49.7522872  -2.01581222
 [52,]  -27.8299090 10.468114  -48.2748177  -7.28626499
 [53,]   -7.8077753  9.041972  -25.9801263   9.96513042
 [54,]   18.8723584  8.062965    2.9629919  34.63203388
 [55,]   16.4390921  7.703494    1.4040375  31.59250025
 [56,]   -1.1535742  8.047020  -16.7546418  14.33387849
 [57,]  132.8833595  9.013519  115.1493554 150.22965309
 [58,]   15.4251932 10.431242   -4.9327657  35.86470445
 [59,]  -11.2329731 12.143162  -35.0599857  12.79072208
 [60,]  -97.7962394 14.042088 -125.5299875 -69.89005642
 [61,]   15.6433569 12.435961   -9.5397828  39.33477054
 [62,]   11.1096740 10.644850   -9.9065862  31.71631655
 [63,]  -11.9223089  9.133877  -30.2402453   5.22845465
 [64,]    0.8718082  8.062116  -14.8918971  16.60802677
 [65,]  -12.0131747  7.617274  -27.2154623   2.94318273
 [66,]   18.7360424  7.905894    3.4005842  34.23843623
 [67,]    2.3497595  8.856557  -14.7964474  19.70139195
 [68,]    8.9168766 10.287332  -11.2214689  28.84432994
 [69,]  -16.8093063 12.028089  -40.3014423   6.73658995
 [70,]    1.6272108 13.963373  -25.7726902  29.23090447
 [71,]   21.1969133 12.169422   -2.5426841  44.73731388
 [72,]   20.4049356 10.486937   -0.1875857  40.79693272
 [73,]  -23.9516421  9.084445  -41.7402400  -5.97065681
 [74,]  -24.1641198  8.108559  -40.1617317  -8.21537735
 [75,]  -11.3320974  7.722733  -26.8029057   3.75072971
 [76,]  -17.6853751  8.012662  -33.6253298  -1.96947674
 [77,]   -7.8718528  8.912642  -25.9840622  10.18513122
 [78,]    6.6061695 10.263425  -13.8979908  27.34298828
 [79,]   -0.6899082 11.912636  -24.0731843  23.36479144
 [80,]   29.3421141 13.753333    2.7022137  56.76244261
 [81,]   -9.2035470 13.439536  -37.1381490  15.56282196
 [82,]   23.3673456 11.460747   -0.4460074  44.63405573
 [83,]    4.1428382  9.758205  -16.0083745  22.84117161
 [84,]   20.6862308  8.499569    3.5260752  37.23769474
 [85,]    1.5680235  7.899940  -14.2205797  17.17665523
 [86,]    4.9843161  8.106891  -10.7983398  21.09346689
 [87,]   -3.9675913  9.065351  -21.8030468  13.74156808
 [88,]  -13.8768986 10.572878  -34.6338620   6.64134265
 [89,]  -13.2018060 12.431299  -37.5776119  11.15213035
 [90,]  -11.4773134 14.506374  -39.8162531  17.09975125
 [91,]   26.3812428 13.180036    0.1644236  52.51896354
 [92,]    8.6842763 11.318585  -14.0419491  30.71931683
 [93,]  -32.6464902  9.727031  -52.1968816 -13.62727032
 [94,]    2.7283434  8.557313  -14.3012399  19.34110980
 [95,]    3.2023769  7.996739  -12.3686060  19.09862223
 [96,]   10.1723104  8.171645   -5.6505375  26.62932967
 [97,]    3.4577439  9.039439  -13.9725835  21.44278909
 [98,]   -3.2462226 10.428560  -23.2056975  17.18681731
 [99,]   16.7896109 12.161661   -6.7031051  41.04156128
[100,]    0.7058444 14.112578  -26.5276088  28.61034466
[101,]    9.2612382 12.958211  -15.5968035  35.17620132
[102,]   -8.0740593 11.115039  -29.4367247  14.29842220
[103,]  -11.0139568  9.567209  -29.2751061   8.27399145
[104,]   -6.5663543  8.478056  -22.7448449  10.53191486
[105,]  -22.3268518  8.036290  -37.8309869  -6.10481367
[106,]  -14.8115493  8.345360  -31.3102450   1.75289111
[107,]  -14.5699468  9.330952  -33.0803105   3.36765301
[108,]    0.4184557 10.809572  -21.0323589  21.07848822
[109,]   17.0482582 12.608949   -8.1437045  41.17516483
[110,]   20.8639607 14.611054   -8.2380936  48.52369758
[111,]   17.5823027 13.119519   -7.0389100  44.42650371
[112,]  -12.2846688 11.189248  -33.3313475  10.47356618
[113,]  -16.5588403  9.536640  -34.8309271   2.85875532
[114,]  -34.2608118  8.328656  -50.3151555 -17.57865276
[115,]  -37.8958833  7.775364  -53.0586919 -22.70667619
[116,]    5.8878451  8.013541   -9.9548847  21.53267686
[117,]   38.5831736  8.980431   20.6592662  56.42082429
[118,]    5.0326021 10.476174  -16.0282333  25.60294379
[119,]   19.5769306 12.309470   -4.8007796  43.34026882
[120,]   -2.8820409 14.351539  -30.8513110  24.64189929
[121,]   -5.2008545 12.042976  -29.2564001  18.88354269
[122,]   36.8449821 10.340935   16.3568680  57.39653653
[123,]   -0.8039812  8.925929  -18.3912848  17.16717962
[124,]    2.4059554  7.952678  -13.1337713  18.03441384
[125,]  -13.8410079  7.592995  -28.7802243   1.01354064
[126,]   11.4799287  7.930804   -4.0191470  26.85880621
[127,]  -12.8923346  8.886920  -29.7933952   4.23767925
[128,]  -41.5286980 10.290415  -61.4332111 -21.31663511
[129,]    5.9323386 11.985138  -17.4876220  29.40646990
[130,]   24.4707753 13.864705   -3.1010096  51.32607319
[131,]  -50.4682018 12.676467  -75.0384928 -26.35864356
[132,]   12.0267137 10.936350   -8.8653853  32.67219051
[133,]   26.6894292  9.473597    8.6257065  45.16817939
[134,]   32.6445447  8.433781   16.3415445  49.24050107
[135,]   20.5073602  7.983899    4.9822015  36.40613100
[136,]   10.5739757  8.221373   -5.5811564  26.58639530
[137,]   -1.8500088  9.092504  -19.8262941  15.72565444
[138,]   -9.8658933 10.439859  -30.5105367  10.39048013
[139,]   -8.6797778 12.105454  -33.1572555  14.52677418
[140,]   -9.8005623 13.975970  -37.9337443  17.02016240
[141,]   17.3608468 12.187527   -6.8587570  41.97432249
[142,]    2.5108477 10.482677  -18.0265214  23.54193795
[143,]  -20.0470514  9.085987  -37.8996051  -1.85288169
[144,]  -10.9962505  8.157313  -26.9093945   5.32171954
[145,]   14.8059504  7.864244   -0.7032863  30.21208189
[146,]    5.8338513  8.274592  -10.4978753  22.04969370
[147,]  -24.6077478  9.295664  -42.9944876  -6.32718917
[148,]   14.0164531 10.754898   -7.1819072  34.87502311
[149,]   -5.1898459 12.499770  -29.5291815  19.28413843
[150,]    9.6798550 14.427011  -18.6078882  37.82260185
[151,]   -1.1396770 13.394000  -26.5960825  25.69867334
[152,]   -7.0663079 11.426153  -29.0571522  15.60230029
[153,]  -17.8751388  9.742626  -36.8218837   1.39006548
[154,]  -31.4890697  8.513789  -48.0134533 -14.79094981
[155,]  -19.6109006  7.953271  -34.9286956  -3.79972646
[156,]   41.8593685  8.199299   26.1026112  58.05370842
[157,]  -36.3723624  9.187304  -53.9893696 -18.33484759
[158,]   14.8789067 10.713947   -5.5990435  35.93459396
[159,]   17.2702758 12.584706   -7.3100882  42.25882293
[160,]    9.1499449 14.668506  -19.5494444  38.30539261
[161,]   17.7020557 12.242382   -6.6487461  42.27779172
[162,]   10.7743146 10.557062   -9.9521145  32.23423812
[163,]    6.7402735  9.162995  -11.0434732  25.23300716
[164,]    1.1407324  8.209911  -14.6552074  17.61049721
[165,]  -10.9684087  7.859903  -26.4192435   4.56015785
[166,]  -15.1170498  8.190652  -31.5328186   0.90829121
[167,]  -49.8533909  9.128458  -67.4313621 -32.09310173
[168,]  -13.9787320 10.512087  -34.2404682   6.71191061
[169,]   22.6812269 12.190671   -0.5125392  46.64134077
[170,]   31.8795858 14.058955    5.1520254  59.52076349
[171,]    5.7236600 12.508753  -19.4597741  29.63666072
[172,]   -1.9628253 10.793121  -23.9125021  18.62704917
[173,]   10.4111893  9.370791   -8.3687024  28.52788193
[174,]   11.6972040  8.392238   -4.7156490  27.76112464
[175,]  -23.5105814  8.021550  -39.2247664  -7.74778598
[176,]    7.1756333  8.340177   -8.9881213  23.84988012
[177,]    0.3010479  9.277366  -17.6742874  18.78443009
[178,]   -2.7096375 10.671371  -23.6801238  18.78815855
[179,]   11.4633772 12.368690  -12.5780590  36.34777115
[180,]   -5.3035082 14.261434  -33.2037819  23.29867742</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1770.1 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1540      
 (0.5, 0.7]   (ok)         3    1.7%   110       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.6
p_loo        34.1  8.6
looic      1722.3 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     169   93.9%   947       
 (0.5, 0.7]   (ok)         7    3.9%   482       
   (0.7, 1]   (bad)        2    1.1%   89        
   (1, Inf)   (very bad)   2    1.1%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.9      11.8  
fit_sleep1 -92.2      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1770.1 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1540      
 (0.5, 0.7]   (ok)         3    1.7%   110       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.1 22.6
p_loo        34.1  8.6
looic      1722.3 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     169   93.9%   947       
 (0.5, 0.7]   (ok)         7    3.9%   482       
   (0.7, 1]   (bad)        2    1.1%   89        
   (1, Inf)   (very bad)   2    1.1%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.1     22.6        34.1    8.6   1722.3
fit_sleep2  -23.9      11.8  -885.0     14.4        19.5    3.4   1770.1
fit_sleep1  -92.2      21.2  -953.4     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   45.1  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.979868e-41 4.238582e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.96      1.54     0.41     5.45       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.04      1.54    -3.14     2.96       5.35      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.62.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.2          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.3         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.3.1      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
