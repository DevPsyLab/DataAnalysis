<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.69      6.87    15.45    42.11 1.00     1552     2308
sd(Days)                6.55      1.51     4.18    10.01 1.00     1420     2196
cor(Intercept,Days)     0.09      0.31    -0.50     0.71 1.00     1009     1301

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.46      7.54   236.29   266.38 1.00     1605     1888
Days         10.45      1.75     6.95    13.87 1.00     1135     1455

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.97      1.54    23.16    29.23 1.00     3553     2993

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9683  13.20462 227.5680 278.9176
309 211.6390  13.15538 186.0115 236.6847
310 213.1943  13.47148 185.4469 238.9181
330 274.4548  13.29112 248.8007 301.0883
331 273.0207  13.37113 248.1508 299.6737
332 260.0746  12.33214 235.6646 285.0077
333 267.9099  12.37427 244.5076 292.4775
334 244.6256  12.19868 220.1974 268.1421
335 250.4561  13.45346 224.0210 277.7035
337 285.6935  12.95006 261.2921 312.0105
349 226.7413  12.55532 202.4175 250.5105
350 239.1173  13.28808 211.9710 263.8626
351 255.8021  12.49178 231.2877 280.3692
352 271.6780  12.79935 247.0883 297.6843
369 254.6026  12.44633 229.9890 277.9103
370 226.9582  13.89723 198.9822 253.3509
371 252.2271  12.09334 227.5170 275.5151
372 263.8088  12.56641 239.1890 288.8874

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5931423  2.535218 14.7372665 24.484053
309  1.7506412  2.457306 -3.0559225  6.539692
310  4.8630349  2.527575 -0.0689046  9.920911
330  5.7469694  2.551186  0.6856796 10.658548
331  7.5295409  2.511477  2.5504247 12.196728
332 10.2487071  2.351956  5.5062031 14.941942
333 10.2886310  2.374829  5.6479810 14.909983
334 11.4603970  2.261308  7.0793122 16.071402
335 -0.2060869  2.545531 -5.1414282  4.649842
337 19.2023816  2.474585 14.1295084 23.977748
349 11.5541993  2.443379  6.9735980 16.469408
350 16.9248653  2.548199 12.0175487 22.243403
351  7.4930281  2.398850  2.7560889 12.126067
352 14.1021886  2.413497  9.2199914 18.780109
369 11.3320007  2.381574  6.6345559 15.997003
370 15.0866411  2.569589 10.1845743 20.015513
371  9.5076831  2.304396  5.2130908 13.966209
372 11.7415395  2.427292  7.1402882 16.563468</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9683 13.204622 227.5680 278.9176
  [2,] 273.5615 11.319749 251.1194 294.7752
  [3,] 293.1546  9.734785 273.6352 311.5444
  [4,] 312.7478  8.616846 295.6034 329.2930
  [5,] 332.3409  8.160190 316.5313 347.6249
  [6,] 351.9341  8.472427 335.1331 367.6484
  [7,] 371.5272  9.477869 352.3975 389.4009
  [8,] 391.1203 10.987840 369.0272 412.0673
  [9,] 410.7135 12.825363 385.0609 435.0166
 [10,] 430.3066 14.869496 400.9077 458.6293
 [11,] 211.6390 13.155383 186.0115 236.6847
 [12,] 213.3896 11.310219 191.3855 234.9896
 [13,] 215.1403  9.739337 196.4554 233.9954
 [14,] 216.8909  8.594477 200.1671 233.4802
 [15,] 218.6415  8.059286 202.8542 234.5156
 [16,] 220.3922  8.253232 203.9433 236.7135
 [17,] 222.1428  9.129966 203.8507 240.1849
 [18,] 223.8935 10.520144 202.4992 244.5027
 [19,] 225.6441 12.250195 201.0706 250.1203
 [20,] 227.3947 14.196402 198.7331 255.6316
 [21,] 213.1943 13.471476 185.4469 238.9181
 [22,] 218.0573 11.536875 194.2456 239.9057
 [23,] 222.9203  9.873984 202.8281 241.7893
 [24,] 227.7834  8.641118 210.8535 244.3789
 [25,] 232.6464  8.038629 216.7614 248.1736
 [26,] 237.5094  8.206550 221.1293 253.2182
 [27,] 242.3725  9.102343 224.2808 260.4079
 [28,] 247.2355 10.542063 226.0596 267.9355
 [29,] 252.0985 12.336726 227.5949 276.2256
 [30,] 256.9616 14.353808 228.0795 284.7013
 [31,] 274.4548 13.291117 248.8007 301.0883
 [32,] 280.2017 11.351963 258.3965 302.9361
 [33,] 285.9487  9.700383 267.5855 305.4040
 [34,] 291.6957  8.505581 274.7995 307.9681
 [35,] 297.4426  7.975555 281.6046 312.7734
 [36,] 303.1896  8.239608 286.8903 319.0410
 [37,] 308.9366  9.229838 290.6157 327.1913
 [38,] 314.6836 10.747361 293.5182 335.5391
 [39,] 320.4305 12.603123 295.8654 344.8877
 [40,] 326.1775 14.669314 297.6227 355.1543
 [41,] 273.0207 13.371133 248.1508 299.6737
 [42,] 280.5503 11.420683 259.3626 303.4490
 [43,] 288.0798  9.730974 269.5969 306.9415
 [44,] 295.6094  8.459713 279.0865 312.1811
 [45,] 303.1389  7.813876 287.4192 318.4737
 [46,] 310.6685  7.947427 295.0057 326.2673
 [47,] 318.1980  8.825054 300.7460 335.7495
 [48,] 325.7275 10.257513 305.4349 346.4634
 [49,] 333.2571 12.048511 309.5747 357.6231
 [50,] 340.7866 14.061710 312.9686 369.0343
 [51,] 260.0746 12.332142 235.6646 285.0077
 [52,] 270.3233 10.643718 249.7764 291.7831
 [53,] 280.5720  9.249817 262.9448 299.6476
 [54,] 290.8207  8.300174 274.6192 307.3062
 [55,] 301.0694  7.955505 285.3860 316.4323
 [56,] 311.3181  8.291599 295.2931 327.5184
 [57,] 321.5668  9.234423 303.5887 339.6356
 [58,] 331.8155 10.623648 310.8790 352.8823
 [59,] 342.0642 12.309047 317.9159 366.8481
 [60,] 352.3130 14.185441 324.1550 380.7708
 [61,] 267.9099 12.374268 244.5076 292.4775
 [62,] 278.1986 10.685995 257.9307 299.2920
 [63,] 288.4872  9.302584 270.3939 306.5925
 [64,] 298.7758  8.376472 282.3681 315.0424
 [65,] 309.0645  8.066728 293.4751 324.9570
 [66,] 319.3531  8.441479 302.9945 335.8967
 [67,] 329.6417  9.419376 311.1928 348.1601
 [68,] 339.9304 10.838373 318.4991 361.3545
 [69,] 350.2190 12.549727 325.4743 375.0644
 [70,] 360.5076 14.449934 331.8973 389.2269
 [71,] 244.6256 12.198677 220.1974 268.1421
 [72,] 256.0860 10.561835 235.4455 276.4135
 [73,] 267.5464  9.193694 249.2302 285.1455
 [74,] 279.0067  8.229380 262.5831 294.6255
 [75,] 290.4671  7.819744 274.8247 305.7646
 [76,] 301.9275  8.049915 285.8448 317.8537
 [77,] 313.3879  8.870225 295.8579 330.8170
 [78,] 324.8483 10.138426 304.7360 344.6917
 [79,] 336.3087 11.709889 313.0868 359.5224
 [80,] 347.7691 13.478959 321.2048 374.4444
 [81,] 250.4561 13.453457 224.0210 277.7035
 [82,] 250.2501 11.482181 227.6084 273.6850
 [83,] 250.0440  9.779821 231.3852 269.6302
 [84,] 249.8379  8.509334 233.4742 266.6416
 [85,] 249.6318  7.882392 234.4320 265.0087
 [86,] 249.4257  8.050769 234.0306 264.8422
 [87,] 249.2196  8.969789 232.0350 266.5138
 [88,] 249.0135 10.443122 228.8519 269.2709
 [89,] 248.8074 12.272731 225.1396 272.1022
 [90,] 248.6014 14.322728 220.7172 275.7310
 [91,] 285.6935 12.950058 261.2921 312.0105
 [92,] 304.8959 11.054821 283.9533 327.2700
 [93,] 324.0983  9.431929 306.1803 343.1919
 [94,] 343.3007  8.243824 327.5470 359.9354
 [95,] 362.5031  7.694617 347.5472 377.7580
 [96,] 381.7054  7.918383 366.6540 397.4693
 [97,] 400.9078  8.856725 383.8400 418.5013
 [98,] 420.1102 10.316469 399.9575 440.8158
 [99,] 439.3126 12.110517 415.2155 463.2864
[100,] 458.5150 14.111940 429.9944 486.2648
[101,] 226.7413 12.555317 202.4175 250.5105
[102,] 238.2955 10.763985 217.3455 258.6351
[103,] 249.8497  9.275287 231.4102 267.5545
[104,] 261.4039  8.254620 244.8314 277.7555
[105,] 272.9581  7.885858 257.4781 288.4845
[106,] 284.5123  8.256813 268.5137 300.6853
[107,] 296.0665  9.279190 277.8704 314.2671
[108,] 307.6207 10.769029 286.7963 328.3641
[109,] 319.1749 12.561083 295.4308 343.5487
[110,] 330.7291 14.544065 302.7898 358.9215
[111,] 239.1173 13.288082 211.9710 263.8626
[112,] 256.0421 11.369539 232.7055 277.1857
[113,] 272.9670  9.744043 253.2470 291.4119
[114,] 289.8919  8.579800 272.7899 306.4352
[115,] 306.8167  8.078749 290.7910 322.7869
[116,] 323.7416  8.360983 307.1824 340.3897
[117,] 340.6665  9.355883 321.8938 358.8258
[118,] 357.5913 10.869484 335.7794 378.5106
[119,] 374.5162 12.717919 348.8701 399.3294
[120,] 391.4411 14.776057 361.5913 420.5669
[121,] 255.8021 12.491775 231.2877 280.3692
[122,] 263.2951 10.739768 242.2015 284.2283
[123,] 270.7881  9.281688 252.3796 289.0875
[124,] 278.2811  8.274407 262.1154 294.6998
[125,] 285.7742  7.892455 270.2977 301.6696
[126,] 293.2672  8.223433 277.1600 309.4282
[127,] 300.7602  9.190637 282.6032 318.5353
[128,] 308.2532 10.621663 287.4311 328.7483
[129,] 315.7463 12.356399 291.0081 339.4874
[130,] 323.2393 14.284623 294.8693 350.6488
[131,] 271.6780 12.799348 247.0883 297.6843
[132,] 285.7801 11.011993 264.2422 307.5369
[133,] 299.8823  9.505504 281.3995 318.6165
[134,] 313.9845  8.431795 297.4293 330.3022
[135,] 328.0867  7.967790 312.2888 343.8706
[136,] 342.1889  8.217427 325.8714 358.5215
[137,] 356.2911  9.122308 337.8238 374.5982
[138,] 370.3933 10.514600 349.1981 391.2969
[139,] 384.4955 12.228944 359.9192 408.7393
[140,] 398.5976 14.148755 370.0116 426.3354
[141,] 254.6026 12.446328 229.9890 277.9103
[142,] 265.9346 10.694347 244.8374 286.3717
[143,] 277.2666  9.228804 259.0204 295.0334
[144,] 288.5986  8.204657 272.2452 304.5923
[145,] 299.9306  7.797805 284.7756 315.6119
[146,] 311.2626  8.101785 295.8847 327.4184
[147,] 322.5946  9.045212 305.5262 340.5040
[148,] 333.9266 10.456415 314.0389 354.3458
[149,] 345.2586 12.173789 321.6766 369.5585
[150,] 356.5906 14.085790 328.9503 384.9527
[151,] 226.9582 13.897225 198.9822 253.3509
[152,] 242.0448 11.873591 218.0137 264.4774
[153,] 257.1315 10.101338 236.4205 276.1362
[154,] 272.2181  8.734842 254.4827 288.8052
[155,] 287.3048  7.985204 271.3235 302.6880
[156,] 302.3914  8.027147 286.5928 317.8471
[157,] 317.4780  8.849421 300.5522 334.4955
[158,] 332.5647 10.266207 312.1899 352.6815
[159,] 347.6513 12.069935 323.7522 371.5377
[160,] 362.7380 14.113016 334.8305 390.4565
[161,] 252.2271 12.093344 227.5170 275.5151
[162,] 261.7348 10.516284 240.2184 282.3154
[163,] 271.2425  9.249648 252.7199 289.3181
[164,] 280.7501  8.434467 263.4977 296.9872
[165,] 290.2578  8.206397 273.4238 306.1125
[166,] 299.7655  8.612210 282.4189 316.5506
[167,] 309.2732  9.571617 290.5024 327.7172
[168,] 318.7809 10.939928 297.1190 339.8997
[169,] 328.2886 12.584462 303.7935 352.8606
[170,] 337.7962 14.410962 309.8460 365.7442
[171,] 263.8088 12.566414 239.1890 288.8874
[172,] 275.5503 10.810014 254.5664 297.2138
[173,] 287.2918  9.358502 269.3352 305.8499
[174,] 299.0334  8.371989 282.9926 315.5080
[175,] 310.7749  8.023861 295.4442 326.4353
[176,] 322.5165  8.393925 306.0269 339.1023
[177,] 334.2580  9.397717 315.6236 352.9551
[178,] 345.9995 10.860926 324.0633 367.6788
[179,] 357.7411 12.624810 332.5535 382.5428
[180,] 369.4826 14.580653 340.4488 397.9097</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.4083390 13.204622  -29.3575914  21.9919720
  [2,]  -14.8567813 11.319749  -36.0704706   7.5852529
  [3,]  -42.3540237  9.734785  -60.7438344 -22.8346378
  [4,]    8.6920340  8.616846   -7.8531962  25.8364500
  [5,]   24.5109917  8.160190    9.2270145  40.3205511
  [6,]   62.7560494  8.472427   47.0416845  79.5570475
  [7,]   10.6766071  9.477869   -7.1971438  29.8062622
  [8,] -100.9717352 10.987840 -121.9187397 -78.8786240
  [9,]   19.8718225 12.825363   -4.4312968  45.5244248
 [10,]   36.0468802 14.869496    7.7241594  65.4457616
 [11,]   11.0949219 13.155383  -13.9508480  36.7223948
 [12,]   -8.1238193 11.310219  -29.7237936  13.8803264
 [13,]  -12.1624604  9.739337  -31.0176241   6.5224234
 [14,]  -12.1839016  8.594477  -28.7732458   4.5399037
 [15,]  -10.9254427  8.059286  -26.7995419   4.8618985
 [16,]   -4.4303839  8.253232  -20.7517191  12.0185397
 [17,]   -8.5125251  9.129966  -26.5545873   9.7795807
 [18,]   -6.1662662 10.520144  -26.7755348  15.2280487
 [19,]   -1.3484074 12.250195  -25.8245585  23.2251349
 [20,]    9.9194514 14.196402  -18.3174034  38.5811414
 [21,]  -14.1403592 13.471476  -39.8642144  13.6070101
 [22,]  -23.7250941 11.536875  -45.5734710   0.0866177
 [23,]   11.3996711  9.873984   -7.4693448  31.4919435
 [24,]    5.0582362  8.641118  -11.5373424  21.9881318
 [25,]   -3.3389986  8.038629  -18.8661538  12.5459783
 [26,]  -17.0515335  8.206550  -32.7603378  -0.6714409
 [27,]   -6.9516684  9.102343  -24.9870616  11.1400095
 [28,]    8.5155968 10.542063  -12.1843821  29.6915237
 [29,]    8.9139619 12.336726  -15.2131373  33.4176405
 [30,]   -9.4462730 14.353808  -37.1860027  19.4357935
 [31,]   47.0878337 13.291117   20.4543444  72.7418732
 [32,]   20.1984644 11.351963   -2.5359228  42.0037042
 [33,]   -2.0922050  9.700383  -21.5475221  16.2709988
 [34,]   -6.5626744  8.505581  -22.8350626  10.3335391
 [35,]  -11.6453437  7.975555  -26.9761478   4.1927229
 [36,]   -5.6041131  8.239608  -21.4554622  10.6951710
 [37,]  -28.6969824  9.229838  -46.9516897 -10.3761106
 [38,]    3.5777482 10.747361  -17.2777776  24.7430613
 [39,]  -15.0810212 12.603123  -39.5381625   9.4841382
 [40,]   27.8712095 14.669314   -1.1056490  56.4260358
 [41,]   14.5871527 13.371133  -12.0658175  39.4571492
 [42,]    4.4497119 11.420683  -18.4489668  25.6374400
 [43,]   13.7407710  9.730974   -5.1208751  32.2237172
 [44,]   24.5059301  8.459713    7.9342500  41.0288044
 [45,]   13.1383892  7.813876   -2.1964479  28.8580970
 [46,]  -17.3497516  7.947427  -32.9485626  -1.6869780
 [47,]  -28.1229925  8.825054  -45.6745495 -10.6710116
 [48,]    9.0901666 10.257513  -11.6457006  29.3827633
 [49,]  -39.5101742 12.048511  -63.8761862 -15.8277791
 [50,]   30.7944849 14.061710    2.5468409  58.6125290
 [51,]  -25.2139930 12.332142  -50.1470612  -0.8039801
 [52,]  -27.5115001 10.643718  -48.9712736  -6.9646476
 [53,]   -7.6107072  9.249817  -26.6863178  10.0165121
 [54,]   18.9480857  8.300174    2.4626165  35.1495661
 [55,]   16.3934787  7.955505    1.0306493  32.0769168
 [56,]   -1.3205284  8.291599  -17.5208384  14.7045249
 [57,]  132.5950645  9.234423  114.5263011 150.5731808
 [58,]   15.0155574 10.623648   -6.0512423  35.9520918
 [59,]  -11.7639497 12.309047  -36.5477633  12.3844494
 [60,]  -98.4485568 14.185441 -126.9064341 -70.2906271
 [61,]   15.9324592 12.374268   -8.6350513  39.3347869
 [62,]   11.3564282 10.685995   -9.7369548  31.6243202
 [63,]  -11.7179028  9.302584  -29.8232262   6.3753755
 [64,]    1.0338662  8.376472  -15.2326973  17.4415857
 [65,]  -11.8934649  8.066728  -27.7860086   3.6958842
 [66,]   18.8134041  8.441479    2.2697888  35.1719829
 [67,]    2.3847731  9.419376  -16.1335735  20.8336757
 [68,]    8.9095420 10.838373  -12.5146090  30.3408010
 [69,]  -16.8589890 12.549727  -41.7043547   7.8857271
 [70,]    1.5351800 14.449934  -27.1840726  30.1454594
 [71,]   20.8475414 12.198677   -2.6689657  45.2756645
 [72,]   20.1152444 10.561835   -0.2122818  40.7557277
 [73,]  -24.1816525  9.193694  -41.7808147  -5.8654591
 [74,]  -24.3344495  8.229380  -39.9531979  -7.9108425
 [75,]  -11.4427464  7.819744  -26.7401928   4.1996881
 [76,]  -17.7363434  8.049915  -33.6625015  -1.6536428
 [77,]   -7.8631403  8.870225  -25.2921818   9.6669000
 [78,]    6.6745627 10.138426  -13.1688176  26.7868877
 [79,]   -0.5618343 11.709889  -23.7755052  22.6601132
 [80,]   29.5298688 13.478959    2.8545980  56.0942029
 [81,]   -8.8478396 13.453457  -36.0952368  17.5872596
 [82,]   23.6971474 11.482181    0.2622260  46.3387926
 [83,]    4.4467343  9.779821  -15.1395155  23.1055221
 [84,]   20.9642213  8.509334    4.1605113  37.3279113
 [85,]    1.8201082  7.882392  -13.5568214  17.0198846
 [86,]    5.2104951  8.050769  -10.2059987  20.6056331
 [87,]   -3.7673179  8.969789  -21.0614629  13.4172590
 [88,]  -13.7025310 10.443122  -33.9598570   6.4590703
 [89,]  -13.0533440 12.272731  -36.3481133  10.6145137
 [90,]  -11.3547571 14.322728  -38.4844049  16.5294109
 [91,]   26.6730588 12.950058    0.3561104  51.0744631
 [92,]    8.9098772 11.054821  -13.4642352  29.8524879
 [93,]  -32.4871044  9.431929  -51.5807473 -14.5690959
 [94,]    2.8215140  8.243824  -13.8132168  18.5752180
 [95,]    3.2293324  7.694617  -12.0255759  18.1851523
 [96,]   10.1330508  7.918383   -5.6308404  25.1845148
 [97,]    3.3522692  8.856725  -14.2412192  20.4201039
 [98,]   -3.4179124 10.316469  -24.1234813  16.7347690
 [99,]   16.5517060 12.110517   -7.4220630  40.6488459
[100,]    0.4017244 14.111940  -27.3480711  28.9223160
[101,]    9.3618989 12.555317  -14.4073002  33.6857377
[102,]   -7.9788004 10.763985  -28.3184258  12.9712255
[103,]  -10.9240997  9.275287  -28.6288898   7.5153695
[104,]   -6.4818990  8.254620  -22.8334661  10.0905624
[105,]  -22.2477983  7.885858  -37.7741532  -6.7677781
[106,]  -14.7378976  8.256813  -30.9108856   1.2607385
[107,]  -14.5016969  9.279190  -32.7022687   3.6944264
[108,]    0.4813038 10.769029  -20.2620910  21.3056616
[109,]   17.1057045 12.561083   -7.2681293  40.8497734
[110,]   20.9160052 14.544065   -7.2764350  48.8553000
[111,]   17.1795229 13.288082   -7.5657994  44.3258402
[112,]  -12.5878424 11.369539  -33.7314219  10.7487576
[113,]  -16.7624077  9.744043  -35.2073403   2.9576412
[114,]  -34.3647730  8.579800  -50.9080744 -17.2628332
[115,]  -37.9002384  8.078749  -53.8703605 -21.8745102
[116,]    5.9830963  8.360983  -10.6649627  22.5422556
[117,]   38.7780310  9.355883   20.6187135  57.5506703
[118,]    5.3270657 10.869484  -15.5921540  27.1389656
[119,]   19.9710004 12.717919   -4.8422355  45.6171391
[120,]   -2.3883649 14.776057  -31.5142058  27.4613888
[121,]   -5.2755507 12.491775  -29.8426923  19.2387593
[122,]   36.7625212 10.739768   15.8292678  57.8561071
[123,]   -0.8942069  9.281688  -19.1935576  17.5142854
[124,]    2.3079650  8.274407  -14.1106633  18.4737059
[125,]  -13.9467631  7.892455  -29.8422199   1.5296799
[126,]   11.3664087  8.223433   -4.7945971  27.4736499
[127,]  -13.0136194  9.190637  -30.7887182   5.1434314
[128,]  -41.6577475 10.621663  -62.1527689 -20.8355759
[129,]    5.7955244 12.356399  -17.9456322  30.5337206
[130,]   24.3261963 14.284623   -3.0832853  52.6961867
[131,]  -50.0008511 12.799348  -76.0071816 -25.4111767
[132,]   12.4137603 11.011993   -9.3429668  33.9517461
[133,]   26.9961717  9.505504    8.2620204  45.4790422
[134,]   32.8709831  8.431795   16.5533336  49.4262195
[135,]   20.6534945  7.967790    4.8695964  36.4513923
[136,]   10.6398060  8.217427   -5.6927657  26.9573190
[137,]   -1.8644826  9.122308  -20.1715840  16.6028118
[138,]   -9.9606712 10.514600  -30.8643072  11.2344562
[139,]   -8.8548598 12.228944  -33.0987439  15.7214406
[140,]  -10.0559484 14.148755  -37.7936862  18.5300721
[141,]   17.3208626 12.446328   -5.9867868  41.9345270
[142,]    2.5022619 10.694347  -17.9348305  23.5994770
[143,]  -20.0242388  9.228804  -37.7910204  -1.7780474
[144,]  -10.9420395  8.204657  -26.9356726   5.4113551
[145,]   14.8915597  7.797805   -0.7896608  30.0466245
[146,]    5.9508590  8.101785  -10.2048999  21.3288439
[147,]  -24.4593417  9.045212  -42.3687294  -7.3909351
[148,]   14.1962576 10.456415   -6.2228647  34.0839860
[149,]   -4.9786431 12.173789  -29.2784780  18.6034025
[150,]    9.9224562 14.085790  -18.4396114  37.5627625
[151,]   -1.6941957 13.897225  -28.0869076  26.2817514
[152,]   -7.5213368 11.873591  -29.9539093  16.5098178
[153,]  -18.2306779 10.101338  -37.2354327   2.4802845
[154,]  -31.7451190  8.734842  -48.3321788 -14.0096955
[155,]  -19.7674601  7.985204  -35.1506877  -3.7862302
[156,]   41.8022988  8.027147   26.3465980  57.6008826
[157,]  -36.3299423  8.849421  -53.3473848 -19.4040546
[158,]   15.0208166 10.266207   -5.0960200  35.3956255
[159,]   17.5116755 12.069935   -6.3747171  41.4107783
[160,]    9.4908344 14.113016  -18.2277000  37.3982565
[161,]   17.6533115 12.093344   -5.6346606  42.3634122
[162,]   10.7080285 10.516284   -9.8726290  32.2243826
[163,]    6.6564454  9.249648  -11.4191884  25.1789591
[164,]    1.0393624  8.434467  -15.1977019  18.2918451
[165,]  -11.0873207  8.206397  -26.9420155   5.7466712
[166,]  -15.2535037  8.612210  -32.0386027   2.0931200
[167,]  -50.0073868  9.571617  -68.4514189 -31.2365896
[168,]  -14.1502699 10.939928  -35.2690598   7.5116387
[169,]   22.4921471 12.584462   -2.0799424  46.9871516
[170,]   31.6729640 14.410962    3.7249986  59.6232225
[171,]    5.6029310 12.566414  -19.4757299  30.2227202
[172,]   -2.0763085 10.810014  -23.7398407  18.9076032
[173,]   10.3049520  9.358502   -8.2531422  28.2615587
[174,]   11.5982125  8.371989   -4.8763537  27.6389546
[175,]  -23.6023270  8.023861  -39.2627251  -8.2716334
[176,]    7.0911334  8.393925   -9.4946888  23.5807106
[177,]    0.2237939  9.397717  -18.4733407  18.8581737
[178,]   -2.7796456 10.860926  -24.4588953  19.1566134
[179,]   11.4006149 12.624810  -13.4010814  36.5882070
[180,]   -5.3590246 14.580653  -33.7861314  23.6748205</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.6 14.4
p_loo        19.1  3.4
looic      1769.2 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   766       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   64        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.2 22.5
p_loo        34.9  8.7
looic      1724.3 45.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   1293      
 (0.5, 0.7]   (ok)         6    3.3%   346       
   (0.7, 1]   (bad)        3    1.7%   29        
   (1, Inf)   (very bad)   1    0.6%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -22.4      11.7  
fit_sleep1 -91.1      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.6 14.4
p_loo        19.1  3.4
looic      1769.2 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   766       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   64        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -862.2 22.5
p_loo        34.9  8.7
looic      1724.3 45.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   1293      
 (0.5, 0.7]   (ok)         6    3.3%   346       
   (0.7, 1]   (bad)        3    1.7%   29        
   (1, Inf)   (very bad)   1    0.6%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -862.2     22.5        34.9    8.7   1724.3
fit_sleep2  -22.4      11.7  -884.6     14.4        19.1    3.4   1769.2
fit_sleep1  -91.1      21.1  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   45.0  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
2.690360e-40 1.795286e-10 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.94      1.57     0.36     5.45       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.06      1.57    -3.23     3.02       5.54      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.3 (2023-03-15)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.21      
[4] StanHeaders_2.26.21 lme4_1.1-32         Matrix_1.5-3       

loaded via a namespace (and not attached):
  [1] nlme_3.1-162         matrixStats_0.63.0   xts_0.13.0          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.3         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.3       cli_3.6.1           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.4.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.21       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.5      highr_0.10          
 [40] fastmap_1.1.1        htmlwidgets_1.6.2    rlang_1.1.0         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.1         
 [52] distributional_0.3.2 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.6.0            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.2       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.3          
 [67] parallel_4.2.3       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.3       
 [73] knitr_1.42           ps_1.7.4             pillar_1.9.0        
 [76] igraph_1.4.1         boot_1.3-28.1        markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-19    
 [82] stats4_4.2.3         rstantools_2.3.1     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.7  
 [88] vctrs_0.6.1          nloptr_2.0.3         httpuv_1.6.9        
 [91] gtable_0.3.3         cachem_1.0.7         ggplot2_3.4.2       
 [94] xfun_0.38            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.2.1        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
