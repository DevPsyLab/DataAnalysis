<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.95      6.99    15.55    42.37 1.00     1774     2534
sd(Days)                6.58      1.49     4.12     9.87 1.00     1333     2217
cor(Intercept,Days)     0.09      0.31    -0.49     0.68 1.00      915     1448

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.23      7.32   236.42   265.43 1.00     1727     2673
Days         10.46      1.76     6.96    13.93 1.00     1264     1840

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.95      1.57    23.17    29.29 1.00     3268     2898

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.8896  13.14956 228.5854 279.1817
309 211.2496  13.33733 185.1344 236.5518
310 213.1234  13.48886 185.5617 238.8433
330 274.3252  13.31289 249.3705 301.0503
331 273.2664  13.19340 247.5574 299.5106
332 260.4029  12.47316 236.5182 285.6391
333 267.9030  12.75351 243.1248 293.4499
334 244.0314  12.09503 219.6980 266.9716
335 250.8088  13.56198 224.5245 277.6484
337 285.8801  13.21901 260.4627 312.7180
349 226.6040  13.16807 199.3224 252.0627
350 238.7772  13.44661 211.8740 264.2063
351 255.5598  12.23914 231.9095 279.1242
352 272.0400  12.73911 247.3343 298.1252
369 254.7803  12.56246 230.0926 279.7255
370 226.7083  13.60298 199.7056 253.0085
371 252.3132  12.28241 228.3758 276.2661
372 263.6309  12.22522 239.2850 287.7570

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6354856  2.521009 14.76188568 24.671300
309  1.7804069  2.480824 -3.02335423  6.578249
310  4.8681512  2.488492 -0.03799842  9.631041
330  5.7807182  2.502920  0.78749996 10.449108
331  7.4914735  2.465830  2.64383443 12.434459
332 10.2077978  2.384152  5.49568629 14.827496
333 10.2911375  2.396770  5.63037330 14.969561
334 11.5801337  2.317450  7.09858352 16.158622
335 -0.2307814  2.586830 -5.44746538  4.784727
337 19.1417812  2.507100 14.10694343 23.953607
349 11.5644947  2.439763  6.86816963 16.505298
350 17.0308136  2.566392 12.23090155 22.098102
351  7.5403526  2.283998  3.00890965 11.906914
352 14.0287919  2.449949  9.03004560 18.850207
369 11.3252247  2.368178  6.66597129 15.880108
370 15.1591406  2.527233 10.30367178 20.120106
371  9.4798482  2.355656  4.82324001 14.064359
372 11.7690598  2.342788  7.21142564 16.452238</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.8896 13.149559 228.5854 279.1817
  [2,] 273.5251 11.255387 251.5335 295.1301
  [3,] 293.1606  9.652332 273.9197 312.0688
  [4,] 312.7961  8.506602 295.6123 329.8370
  [5,] 332.4316  8.016733 316.9360 348.5915
  [6,] 352.0671  8.299682 335.9479 368.6800
  [7,] 371.7025  9.285063 353.5560 390.1487
  [8,] 391.3380 10.781978 370.4122 413.2357
  [9,] 410.9735 12.609547 386.2774 436.1237
 [10,] 430.6090 14.644497 401.6782 459.5273
 [11,] 211.2496 13.337331 185.1344 236.5518
 [12,] 213.0300 11.458381 190.4163 234.5744
 [13,] 214.8104  9.849547 195.5689 233.7752
 [14,] 216.5908  8.662658 199.0944 233.3405
 [15,] 218.3712  8.085709 202.3676 234.3348
 [16,] 220.1517  8.247710 203.6355 236.5792
 [17,] 221.9321  9.109320 203.7797 239.4809
 [18,] 223.7125 10.499700 202.7220 243.8618
 [19,] 225.4929 12.239962 200.8885 248.9078
 [20,] 227.2733 14.202063 198.1986 254.5063
 [21,] 213.1234 13.488863 185.5617 238.8433
 [22,] 217.9916 11.588730 194.1225 239.7952
 [23,] 222.8597  9.951537 202.5312 241.8393
 [24,] 227.7279  8.726552 210.4926 244.3632
 [25,] 232.5960  8.102932 216.6394 248.4870
 [26,] 237.4642  8.218729 221.4391 253.6085
 [27,] 242.3323  9.045589 224.9381 259.7657
 [28,] 247.2005 10.415520 226.7516 267.0552
 [29,] 252.0686 12.146136 228.2788 275.1943
 [30,] 256.9368 14.105295 229.4782 283.8315
 [31,] 274.3252 13.312892 249.3705 301.0503
 [32,] 280.1059 11.407924 258.5239 302.8409
 [33,] 285.8866  9.776379 267.1741 305.2558
 [34,] 291.6673  8.575759 274.9319 308.2013
 [35,] 297.4480  8.002433 281.7303 312.8905
 [36,] 303.2288  8.189226 287.1873 319.3351
 [37,] 309.0095  9.089397 290.9684 326.7351
 [38,] 314.7902 10.521410 294.0882 335.1508
 [39,] 320.5709 12.300903 296.8201 344.2370
 [40,] 326.3516 14.298726 298.7545 353.8564
 [41,] 273.2664 13.193405 247.5574 299.5106
 [42,] 280.7578 11.329637 258.8954 303.3082
 [43,] 288.2493  9.737354 269.4474 307.4989
 [44,] 295.7408  8.569252 279.0584 312.7651
 [45,] 303.2323  8.013035 287.2971 319.3626
 [46,] 310.7237  8.194267 294.7568 327.4302
 [47,] 318.2152  9.068844 301.0811 336.2644
 [48,] 325.7067 10.464344 305.8506 346.3054
 [49,] 333.1981 12.203347 309.9253 356.7795
 [50,] 340.6896 14.159856 313.1844 368.4687
 [51,] 260.4029 12.473163 236.5182 285.6391
 [52,] 270.6107 10.718330 249.9942 291.7893
 [53,] 280.8185  9.249526 262.9872 299.0533
 [54,] 291.0263  8.221511 274.9388 307.1122
 [55,] 301.2340  7.810320 285.2860 316.1935
 [56,] 311.4418  8.110321 295.1338 327.4434
 [57,] 321.6496  9.051071 303.4753 339.5358
 [58,] 331.8574 10.461110 311.1349 352.5436
 [59,] 342.0652 12.178510 318.3583 366.2858
 [60,] 352.2730 14.091337 324.7460 380.4751
 [61,] 267.9030 12.753507 243.1248 293.4499
 [62,] 278.1941 10.950835 256.8615 299.8242
 [63,] 288.4852  9.416936 270.0894 306.9419
 [64,] 298.7764  8.302143 282.4248 314.7647
 [65,] 309.0675  7.788548 293.8793 323.7911
 [66,] 319.3587  7.992897 303.7410 334.8202
 [67,] 329.6498  8.865684 312.5225 346.8845
 [68,] 339.9409 10.237348 319.9685 360.0878
 [69,] 350.2321 11.937138 326.7516 373.5584
 [70,] 360.5232 13.844719 333.4995 387.6163
 [71,] 244.0314 12.095028 219.6980 266.9716
 [72,] 255.6116 10.435876 235.0879 275.4109
 [73,] 267.1917  9.070087 249.0098 284.8220
 [74,] 278.7718  8.146568 262.6526 294.5974
 [75,] 290.3520  7.823543 274.5091 305.9884
 [76,] 301.9321  8.172529 285.6738 318.0863
 [77,] 313.5122  9.116676 295.7471 331.4454
 [78,] 325.0924 10.496595 304.7171 345.5246
 [79,] 336.6725 12.164882 313.0163 360.2621
 [80,] 348.2526 14.018964 321.3121 376.2619
 [81,] 250.8088 13.561982 224.5245 277.6484
 [82,] 250.5780 11.591545 228.1344 273.3877
 [83,] 250.3473  9.908775 231.2138 269.6011
 [84,] 250.1165  8.682575 233.1405 267.5626
 [85,] 249.8857  8.122424 233.9176 265.8811
 [86,] 249.6549  8.363242 233.2361 266.0843
 [87,] 249.4241  9.343298 231.4168 267.4977
 [88,] 249.1934 10.864346 228.1894 270.2844
 [89,] 248.9626 12.733977 224.0502 273.5794
 [90,] 248.7318 14.820854 219.5992 277.5063
 [91,] 285.8801 13.219015 260.4627 312.7180
 [92,] 305.0219 11.298927 283.3268 328.2479
 [93,] 324.1637  9.651957 306.0342 343.8171
 [94,] 343.3055  8.439543 327.3875 360.2338
 [95,] 362.4472  7.865279 347.4304 377.8537
 [96,] 381.5890  8.066625 365.8868 397.3100
 [97,] 400.7308  8.991628 383.3073 418.2959
 [98,] 419.8726 10.449852 399.8316 440.3517
 [99,] 439.0144 12.252369 415.1639 462.6995
[100,] 458.1562 14.269295 430.8591 485.9697
[101,] 226.6040 13.168068 199.3224 252.0627
[102,] 238.1685 11.344734 215.1925 259.8463
[103,] 249.7330  9.793510 230.2059 268.4561
[104,] 261.2975  8.661845 243.7818 277.7934
[105,] 272.8620  8.126942 256.5588 288.8676
[106,] 284.4265  8.304920 268.3972 301.0205
[107,] 295.9910  9.154294 278.2935 313.7562
[108,] 307.5555 10.513581 287.4116 327.9616
[109,] 319.1200 12.213703 295.5804 342.7307
[110,] 330.6845 14.132183 303.5223 358.0872
[111,] 238.7772 13.446613 211.8740 264.2063
[112,] 255.8081 11.469481 232.7338 277.5941
[113,] 272.8389  9.770327 253.1042 291.5799
[114,] 289.8697  8.517179 272.8803 306.2629
[115,] 306.9005  7.924526 291.1901 322.5400
[116,] 323.9313  8.137974 307.3980 339.7810
[117,] 340.9621  9.100982 323.1650 358.8243
[118,] 357.9929 10.611401 336.9112 378.9167
[119,] 375.0238 12.471910 350.3324 399.5424
[120,] 392.0546 14.548814 363.6815 421.1081
[121,] 255.5598 12.239143 231.9095 279.1242
[122,] 263.1002 10.598836 242.6792 283.4487
[123,] 270.6405  9.236196 252.4332 288.2455
[124,] 278.1809  8.289307 261.9103 293.9567
[125,] 285.7212  7.908931 270.0722 300.9368
[126,] 293.2616  8.174538 277.1215 309.0865
[127,] 300.8019  9.029300 283.1081 318.2585
[128,] 308.3423 10.327959 288.1400 328.4583
[129,] 315.8826 11.926379 292.2239 339.3164
[130,] 323.4230 13.720189 296.5767 349.9862
[131,] 272.0400 12.739111 247.3343 298.1252
[132,] 286.0688 10.927499 265.1740 308.2322
[133,] 300.0976  9.409571 281.7496 318.9578
[134,] 314.1264  8.347114 297.6389 330.5686
[135,] 328.1552  7.925471 312.3031 343.4906
[136,] 342.1840  8.243566 325.5453 358.1220
[137,] 356.2128  9.225191 338.1535 374.0215
[138,] 370.2415 10.689080 349.3489 391.2235
[139,] 384.2703 12.466484 359.8392 408.5682
[140,] 398.2991 14.442109 369.7012 426.2706
[141,] 254.7803 12.562458 230.0926 279.7255
[142,] 266.1055 10.819143 244.9057 287.7988
[143,] 277.4307  9.354618 259.2187 296.1005
[144,] 288.7559  8.317477 272.3051 305.0554
[145,] 300.0812  7.878357 284.9760 315.8678
[146,] 311.4064  8.134687 295.6158 327.4422
[147,] 322.7316  9.027418 305.3184 340.5950
[148,] 334.0568 10.393843 313.7222 354.7540
[149,] 345.3821 12.074195 321.8678 369.1213
[150,] 356.7073 13.955534 329.0120 384.1079
[151,] 226.7083 13.602982 199.7056 253.0085
[152,] 241.8674 11.650070 219.1039 264.5232
[153,] 257.0265  9.958963 237.6579 276.6146
[154,] 272.1857  8.683984 255.0091 289.4648
[155,] 287.3448  8.025959 271.6219 303.4230
[156,] 302.5040  8.135987 286.3612 318.3111
[157,] 317.6631  8.985899 299.6701 334.9287
[158,] 332.8222 10.395782 311.8085 352.7031
[159,] 347.9814 12.172592 323.5822 371.7840
[160,] 363.1405 14.179052 335.1271 390.8657
[161,] 252.3132 12.282415 228.3758 276.2661
[162,] 261.7931 10.583695 241.0572 282.2062
[163,] 271.2729  9.179854 253.2906 288.9694
[164,] 280.7528  8.223325 264.5259 296.6278
[165,] 290.2326  7.878747 274.7226 305.3510
[166,] 299.7125  8.223409 283.4575 315.2215
[167,] 309.1923  9.180005 290.8458 326.7863
[168,] 318.6722 10.583891 297.4860 339.1631
[169,] 328.1520 12.282640 303.2731 351.7997
[170,] 337.6319 14.170602 309.0638 365.1718
[171,] 263.6309 12.225224 239.2850 287.7570
[172,] 275.4000 10.539867 254.6732 296.3229
[173,] 287.1690  9.148704 269.1599 305.3779
[174,] 298.9381  8.202811 282.8733 315.1444
[175,] 310.7072  7.864523 295.1325 326.3507
[176,] 322.4762  8.209303 306.3050 338.6590
[177,] 334.2453  9.160344 316.7028 352.5642
[178,] 346.0143 10.555021 325.6538 366.7718
[179,] 357.7834 12.242644 334.2885 381.4233
[180,] 369.5525 14.118553 342.3395 396.8297</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.3296301 13.149559  -29.6216767  20.9745548
  [2,]  -14.8204156 11.255387  -36.4253696   7.1711921
  [3,]  -42.3600012  9.652332  -61.2682065 -23.1190933
  [4,]    8.6437133  8.506602   -8.3972357  25.8275131
  [5,]   24.4203277  8.016733    8.2604204  39.9159241
  [6,]   62.6230422  8.299682   46.0100670  78.7421927
  [7,]   10.5012566  9.285063   -7.9449484  28.6478178
  [8,] -101.1894289 10.781978 -123.0871035 -80.2635580
  [9,]   19.6117855 12.609547   -5.5383613  44.3078736
 [10,]   35.7445000 14.644497    6.8262189  64.6753161
 [11,]   11.4842798 13.337331  -13.8178811  37.5995465
 [12,]   -7.7642271 11.458381  -29.3086344  14.8494537
 [13,]  -11.8326340  9.849547  -30.7974054   7.4089048
 [14,]  -11.8838409  8.662658  -28.6334721   5.6125860
 [15,]  -10.6551478  8.085709  -26.6187435   5.3484912
 [16,]   -4.1898547  8.247710  -20.6173958  12.3262534
 [17,]   -8.3017616  9.109320  -25.8506388   9.8505544
 [18,]   -5.9852685 10.499700  -26.1345824  15.0052093
 [19,]   -1.1971754 12.239962  -24.6120507  23.4072321
 [20,]   10.0409177 14.202063  -17.1920512  39.1155973
 [21,]  -14.0695318 13.488863  -39.7894395  13.4921889
 [22,]  -23.6593831 11.588730  -45.4629610   0.2097241
 [23,]   11.4602657  9.951537   -7.5192763  31.7888201
 [24,]    5.1137145  8.726552  -11.5215512  22.3490380
 [25,]   -3.2886367  8.102932  -19.1796368  12.6680264
 [26,]  -17.0062880  8.218729  -33.1506441  -0.9812116
 [27,]   -6.9115392  9.045589  -24.3449124  10.4826509
 [28,]    8.5506096 10.415520  -11.3040964  28.9994900
 [29,]    8.9438584 12.146136  -14.1817754  32.7336989
 [30,]   -9.4214929 14.105295  -36.3162116  18.0371153
 [31,]   47.2174240 13.312892   20.4922501  72.1720667
 [32,]   20.2943058 11.407924   -2.4407371  41.8763167
 [33,]   -2.0301124  9.776379  -21.3993325  16.6823736
 [34,]   -6.5343305  8.575759  -23.0682551  10.2010854
 [35,]  -11.6507487  8.002433  -27.0932350   4.0670018
 [36,]   -5.6432669  8.189226  -21.7495729  10.3982240
 [37,]  -28.7698850  9.089397  -46.4954733 -10.7287807
 [38,]    3.4710968 10.521410  -16.8894814  24.1730639
 [39,]  -15.2214214 12.300903  -38.8875037   8.5294013
 [40,]   27.6970605 14.298726    0.1922599  55.2942129
 [41,]   14.3415395 13.193405  -11.9027159  40.0504563
 [42,]    4.2421660 11.329637  -18.3082293  26.1045811
 [43,]   13.5712924  9.737354   -5.6782860  32.3731994
 [44,]   24.3745189  8.569252    7.3501735  41.0568624
 [45,]   13.0450453  8.013035   -3.0852526  28.9801526
 [46,]  -17.4050282  8.194267  -34.1114981  -1.4381298
 [47,]  -28.1402018  9.068844  -46.1893824 -11.0061120
 [48,]    9.1110247 10.464344  -11.4876539  28.9670876
 [49,]  -39.4512489 12.203347  -63.0326174 -16.1784163
 [50,]   30.8914776 14.159856    3.1124465  58.3966967
 [51,]  -25.5422585 12.473163  -50.7785120  -1.6576191
 [52,]  -27.7988563 10.718330  -48.9775131  -7.1824387
 [53,]   -7.8571541  9.249526  -26.0919731   9.9740884
 [54,]   18.7425480  8.221511    2.6565768  34.8299781
 [55,]   16.2288502  7.810320    1.2693625  32.1769442
 [56,]   -1.4442476  8.110321  -17.4458021  14.8638336
 [57,]  132.5122545  9.051071  114.6260533 150.6865758
 [58,]   14.9736567 10.461110   -5.7124671  35.6961900
 [59,]  -11.7649411 12.178510  -35.9854926  11.9420480
 [60,]  -98.4086389 14.091337 -126.6106915 -70.8816477
 [61,]   15.9394292 12.753507   -9.6074675  40.7176164
 [62,]   11.3608916 10.950835  -10.2692335  32.6934947
 [63,]  -11.7159459  9.416936  -30.1725612   6.6799102
 [64,]    1.0333166  8.302143  -14.9550418  17.3849288
 [65,]  -11.8965210  7.788548  -26.6200588   3.2917143
 [66,]   18.8078415  7.992897    3.3463179  34.4255487
 [67,]    2.3767039  8.865684  -14.8579959  19.5039887
 [68,]    8.8989664 10.237348  -11.2478831  28.8714018
 [69,]  -16.8720712 11.937138  -40.1984147   6.6084261
 [70,]    1.5195913 13.844719  -25.5734614  28.5433305
 [71,]   21.4416622 12.095028   -1.4984687  45.7751028
 [72,]   20.5896286 10.435876    0.7903061  41.1133151
 [73,]  -23.8270051  9.070087  -41.4573104  -5.6451308
 [74,]  -24.0995388  8.146568  -39.9250645  -7.9802557
 [75,]  -11.3275725  7.823543  -26.9639508   4.5153241
 [76,]  -17.7409062  8.172529  -33.8950790  -1.4826024
 [77,]   -7.9874398  9.116676  -25.9206067   9.7776696
 [78,]    6.4305265 10.496595  -14.0016710  26.8057667
 [79,]   -0.9256072 12.164882  -24.5151970  22.7305663
 [80,]   29.0463591 14.018964    1.0370708  55.9869101
 [81,]   -9.2005245 13.561982  -36.0400954  17.0838151
 [82,]   23.3691569 11.591545    0.5595328  45.8128082
 [83,]    4.1434383  9.908775  -15.1103962  23.2768714
 [84,]   20.6856196  8.682575    3.2395397  37.6616359
 [85,]    1.5662010  8.122424  -14.4292333  17.5342518
 [86,]    4.9812824  8.363242  -11.4481373  21.4000553
 [87,]   -3.9718363  9.343298  -22.0454347  14.0354986
 [88,]  -13.8823549 10.864346  -34.9733667   7.1215971
 [89,]  -13.2084735 12.733977  -37.8253470  11.7038671
 [90,]  -11.4851922 14.820854  -40.2596983  17.6474190
 [91,]   26.4864784 13.219015   -0.3513669  51.9039355
 [92,]    8.7838972 11.298927  -14.4421331  30.4790442
 [93,]  -32.5524841  9.651957  -52.2059436 -14.4229751
 [94,]    2.8167347  8.439543  -14.1115650  18.7347017
 [95,]    3.2851535  7.865279  -12.1213245  18.3019698
 [96,]   10.2494723  8.066625   -5.4714587  25.9516635
 [97,]    3.5292911  8.991628  -14.0358395  20.9527632
 [98,]   -3.1802901 10.449852  -23.6594056  16.8606585
 [99,]   16.8499287 12.252369   -6.8351879  40.7003603
[100,]    0.7605475 14.269295  -27.0530261  28.0576052
[101,]    9.4991580 13.168068  -15.9594722  36.7807741
[102,]   -7.8518367 11.344734  -29.5295567  15.1242166
[103,]  -10.8074315  9.793510  -29.5304833   8.7196891
[104,]   -6.3755262  8.661845  -22.8714099  11.1401616
[105,]  -22.1517209  8.126942  -38.1573078  -5.8484511
[106,]  -14.6521157  8.304920  -31.2461388   1.3771766
[107,]  -14.4262104  9.154294  -32.1914113   3.2713318
[108,]    0.5464949 10.513581  -19.8595562  20.6904248
[109,]   17.1606001 12.213703   -6.4500706  40.7002202
[110,]   20.9606054 14.132183   -6.4421017  48.1228423
[111,]   17.5195581 13.446613   -7.9095145  44.4227871
[112,]  -12.3537554 11.469481  -34.1397859  10.7204962
[113,]  -16.6342690  9.770327  -35.3753079   3.1004056
[114,]  -34.3425826  8.517179  -50.7357647 -17.3532135
[115,]  -37.9839962  7.924526  -53.6235035 -22.2736171
[116,]    5.7933902  8.137974  -10.0562676  22.3267188
[117,]   38.4823766  9.100982   20.6201729  56.2794527
[118,]    4.9254630 10.611401  -15.9982848  26.0072013
[119,]   19.4634494 12.471910   -5.0552142  44.1547594
[120,]   -3.0018641 14.548814  -32.0554012  25.3711613
[121,]   -5.0333288 12.239143  -28.5976612  18.6169700
[122,]   36.9574186 10.598836   16.6089081  57.3784234
[123,]   -0.7466340  9.236196  -18.3515890  17.4607071
[124,]    2.4082134  8.289307  -13.3675721  18.6788496
[125,]  -13.8938392  7.908931  -29.1094127   1.7551927
[126,]   11.3720082  8.174538   -4.4528968  27.5120849
[127,]  -13.0553444  9.029300  -30.5119423   4.6385209
[128,]  -41.7467970 10.327959  -61.8627785 -21.5444844
[129,]    5.6591504 11.926379  -17.7746264  29.3178912
[130,]   24.1424978 13.720189   -2.4207049  50.9887637
[131,]  -50.3628994 12.739111  -76.4481094 -25.6572078
[132,]   12.1251086 10.927499  -10.0383201  33.0199316
[133,]   26.7809167  9.409571    7.9207172  45.1289343
[134,]   32.7291247  8.347114   16.2868569  49.2165815
[135,]   20.5850328  7.925471    5.2495501  36.4371252
[136,]   10.6447409  8.243566   -5.2932682  27.2833836
[137,]   -1.7861511  9.225191  -19.5949260  16.2730615
[138,]   -9.8089430 10.689080  -30.7908823  11.0836988
[139,]   -8.6297350 12.466484  -32.9276166  15.8013893
[140,]   -9.7574269 14.442109  -37.7288850  18.8404718
[141,]   17.1432361 12.562458   -7.8020315  41.8309185
[142,]    2.3314114 10.819143  -19.3619136  23.5312063
[143,]  -20.1883133  9.354618  -38.8580814  -1.9762747
[144,]  -11.0993380  8.317477  -27.3988315   5.3515474
[145,]   14.7410372  7.878357   -1.0455623  29.8461636
[146,]    5.8071125  8.134687  -10.2286662  21.5977141
[147,]  -24.5963122  9.027418  -42.4596681  -7.1831268
[148,]   14.0660631 10.393843   -6.6310975  34.4006868
[149,]   -5.1020616 12.074195  -28.8412575  18.4121648
[150,]    9.8058137 13.955534  -17.5948176  37.5011164
[151,]   -1.4442545 13.602982  -27.7445308  25.5584033
[152,]   -7.3438951 11.650070  -29.9996699  15.4196066
[153,]  -18.1257357  9.958963  -37.7138323   1.2428796
[154,]  -31.7126763  8.683984  -48.9918365 -14.5361407
[155,]  -19.8075169  8.025959  -35.8856744  -4.0845717
[156,]   41.6897425  8.135987   25.8825523  57.8324854
[157,]  -36.5149982  8.985899  -53.7805934 -18.5219722
[158,]   14.7632612 10.395782   -5.1176302  35.7770389
[159,]   17.1816206 12.172592   -6.6210319  41.5808329
[160,]    9.0882800 14.179052  -18.6369381  37.1016814
[161,]   17.5671660 12.282415   -6.3856995  41.5045733
[162,]   10.6497178 10.583695   -9.7634420  31.3855569
[163,]    6.6259696  9.179854  -11.0704901  24.6082847
[164,]    1.0367215  8.223325  -14.8383476  17.2635731
[165,]  -11.0621267  7.878747  -26.1804643   4.4479331
[166,]  -15.2004749  8.223409  -30.7095304   1.0545460
[167,]  -49.9265231  9.180005  -67.5204952 -31.5800443
[168,]  -14.0415712 10.583891  -34.5325461   7.1446318
[169,]   22.6286806 12.282640   -1.0189743  47.5075651
[170,]   31.8373324 14.170602    4.2974311  60.4054329
[171,]    5.7807742 12.225224  -18.3452620  30.1267193
[172,]   -1.9259856 10.539867  -22.8488684  18.8008186
[173,]   10.4277547  9.148704   -7.7810569  28.4369296
[174,]   11.6934949  8.202811   -4.5127783  27.7582929
[175,]  -23.5345648  7.864523  -39.1781353  -7.9598834
[176,]    7.1313754  8.209303   -9.0514430  23.3026080
[177,]    0.2365157  9.160344  -18.0823977  17.7789782
[178,]   -2.7944441 10.555021  -23.5518985  17.5660877
[179,]   11.3582962 12.242644  -12.2816442  34.8532317
[180,]   -5.4288636 14.118553  -32.7061431  21.7841098</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.4
looic      1769.6 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1284      
 (0.5, 0.7]   (ok)         1    0.6%   358       
   (0.7, 1]   (bad)        1    0.6%   79        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.1
p_loo        33.6  8.2
looic      1721.6 44.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     169   93.9%   888       
 (0.5, 0.7]   (ok)         8    4.4%   404       
   (0.7, 1]   (bad)        2    1.1%   28        
   (1, Inf)   (very bad)   1    0.6%   42        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.0      11.4  
fit_sleep1 -92.5      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.8 14.4
p_loo        19.3  3.4
looic      1769.6 28.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1284      
 (0.5, 0.7]   (ok)         1    0.6%   358       
   (0.7, 1]   (bad)        1    0.6%   79        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.1
p_loo        33.6  8.2
looic      1721.6 44.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     169   93.9%   888       
 (0.5, 0.7]   (ok)         8    4.4%   404       
   (0.7, 1]   (bad)        2    1.1%   28        
   (1, Inf)   (very bad)   1    0.6%   42        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.8     22.1        33.6    8.2   1721.6
fit_sleep2  -24.0      11.4  -884.8     14.4        19.3    3.4   1769.6
fit_sleep1  -92.5      20.8  -953.3     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.2  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.410541e-41 3.671456e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.86      1.57      0.2     5.36       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.14      1.57    -3.42     2.77       5.43      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.26 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.5      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.3         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.1       pkgbuild_1.4.0       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.0        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.0         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.0           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.31       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
