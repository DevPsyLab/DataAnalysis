<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.89      6.92    15.52    42.69 1.00     1824     2509
sd(Days)                6.57      1.50     4.16    10.10 1.00     1397     1647
cor(Intercept,Days)     0.07      0.29    -0.49     0.64 1.00      953     1596

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.26      7.41   236.27   265.48 1.00     1786     2369
Days         10.48      1.70     7.10    13.84 1.01     1188     1808

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.89      1.54    23.12    29.16 1.00     3203     2407

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.6915  13.01013 228.0508 278.4099
309 211.4402  13.25448 185.5093 236.6223
310 213.0462  13.48829 185.8405 238.8265
330 274.6453  13.19351 249.6533 301.4388
331 273.2578  12.95290 248.9217 299.8672
332 260.1664  12.42489 235.6990 284.9099
333 268.0385  12.65923 244.2186 293.8136
334 244.2128  12.50750 219.7685 268.8399
335 251.0996  13.35610 224.8305 276.8032
337 285.9436  13.07177 261.1653 312.9681
349 226.4237  13.31552 199.4456 251.8169
350 238.4702  12.95990 213.1471 263.1712
351 255.8850  12.33402 232.5144 280.2568
352 271.9235  12.61853 246.8845 296.7101
369 254.5934  12.32199 229.6531 278.1348
370 225.9570  13.55346 198.9990 251.9643
371 251.7874  12.19597 228.4526 276.4865
372 263.1802  12.30919 239.5039 287.2748

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6626597  2.502740 14.78075606 24.600486
309  1.7700830  2.514548 -3.41026387  6.607000
310  4.9159718  2.533769  0.05287739  9.900973
330  5.7259137  2.465183  0.62713449 10.347654
331  7.4201442  2.452457  2.61039326 11.979448
332 10.2446374  2.377114  5.49281867 14.751063
333 10.2697043  2.385182  5.57159111 15.070981
334 11.5553444  2.388589  6.81588214 16.221269
335 -0.2757533  2.576473 -5.41430899  4.849950
337 19.1402016  2.479055 14.23593913 23.955868
349 11.5784028  2.544203  6.78812563 16.728329
350 17.0787006  2.459360 12.49821097 21.909451
351  7.4565565  2.366005  2.75316133 11.911635
352 14.0804186  2.383360  9.49125362 18.799846
369 11.3573282  2.356026  6.78168626 15.978164
370 15.2644926  2.523176 10.45263443 20.226816
371  9.5081319  2.324487  5.04152954 14.103501
372 11.8548461  2.348472  7.23654357 16.478125</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.6915 13.010130 228.0508 278.4099
  [2,] 273.3542 11.134405 251.0230 294.4441
  [3,] 293.0169  9.550596 273.9485 311.3658
  [4,] 312.6795  8.424976 296.3738 328.8677
  [5,] 332.3422  7.954494 316.8250 347.6366
  [6,] 352.0048  8.251977 335.8198 367.6801
  [7,] 371.6675  9.243577 353.6940 389.5533
  [8,] 391.3302 10.738701 370.0998 412.1099
  [9,] 410.9928 12.558786 385.9226 435.2323
 [10,] 430.6555 14.582659 401.1686 459.4720
 [11,] 211.4402 13.254475 185.5093 236.6223
 [12,] 213.2103 11.341874 190.5523 234.4431
 [13,] 214.9803  9.707780 195.2079 233.4988
 [14,] 216.7504  8.514094 199.6629 233.2756
 [15,] 218.5205  7.961439 203.1344 234.1156
 [16,] 220.2906  8.180778 204.3867 236.2957
 [17,] 222.0607  9.116560 204.1283 240.1071
 [18,] 223.8308 10.580364 202.7340 244.7950
 [19,] 225.6008 12.386382 200.4703 249.9741
 [20,] 227.3709 14.406481 198.0415 255.0055
 [21,] 213.0462 13.488291 185.8405 238.8265
 [22,] 217.9622 11.547695 194.8771 240.2466
 [23,] 222.8782  9.879499 203.1532 241.3843
 [24,] 227.7941  8.642900 210.7871 244.3132
 [25,] 232.7101  8.039583 217.0304 248.5075
 [26,] 237.6261  8.210362 221.4386 253.8071
 [27,] 242.5421  9.111815 224.7517 260.4269
 [28,] 247.4580 10.558422 227.0819 268.3183
 [29,] 252.3740 12.360232 228.5101 276.8258
 [30,] 257.2900 14.384379 229.1902 285.7182
 [31,] 274.6453 13.193507 249.6533 301.4388
 [32,] 280.3712 11.335574 258.9976 303.6727
 [33,] 286.0972  9.750698 267.3727 305.9572
 [34,] 291.8231  8.591347 275.0625 308.8802
 [35,] 297.5490  8.043670 281.8308 313.0933
 [36,] 303.2749  8.230691 287.0727 319.2271
 [37,] 309.0008  9.107260 291.1460 326.3685
 [38,] 314.7267 10.502111 294.2736 334.9524
 [39,] 320.4526 12.239312 296.5703 344.1367
 [40,] 326.1786 14.193712 298.2214 353.6621
 [41,] 273.2578 12.952897 248.9217 299.8672
 [42,] 280.6780 11.138181 259.4062 302.9797
 [43,] 288.0981  9.610916 269.4657 307.3911
 [44,] 295.5183  8.526982 278.8217 312.4188
 [45,] 302.9384  8.067107 287.1225 318.9581
 [46,] 310.3585  8.335233 294.2140 326.9079
 [47,] 317.7787  9.268392 299.8839 336.1331
 [48,] 325.1988 10.693884 304.7491 346.0852
 [49,] 332.6190 12.443646 308.8415 356.7339
 [50,] 340.0391 14.399950 312.3015 368.0136
 [51,] 260.1664 12.424892 235.6990 284.9099
 [52,] 270.4110 10.721456 249.1067 291.5130
 [53,] 280.6556  9.317866 262.3261 299.0490
 [54,] 290.9003  8.366421 274.5848 307.4721
 [55,] 301.1449  8.029489 285.2352 317.1002
 [56,] 311.3895  8.381512 294.5917 328.0916
 [57,] 321.6342  9.344952 302.6622 340.1671
 [58,] 331.8788 10.756759 310.2656 353.0428
 [59,] 342.1235 12.465510 317.0298 366.4484
 [60,] 352.3681 14.365631 323.4333 380.1058
 [61,] 268.0385 12.659226 244.2186 293.8136
 [62,] 278.3082 10.878551 257.4305 300.3202
 [63,] 288.5780  9.370589 270.6784 307.6441
 [64,] 298.8477  8.285601 282.8959 315.6839
 [65,] 309.1174  7.802091 293.6882 324.6817
 [66,] 319.3871  8.029460 303.5090 335.2611
 [67,] 329.6568  8.913474 312.1208 347.4921
 [68,] 339.9265 10.286204 319.6199 360.7639
 [69,] 350.1962 11.980824 326.8471 375.0075
 [70,] 360.4659 13.879931 333.1488 389.3408
 [71,] 244.2128 12.507505 219.7685 268.8399
 [72,] 255.7681 10.773991 234.7045 277.1998
 [73,] 267.3235  9.334387 248.8864 286.1666
 [74,] 278.8788  8.342266 262.5353 295.4332
 [75,] 290.4342  7.966601 274.5800 305.8562
 [76,] 301.9895  8.291608 285.7157 318.1154
 [77,] 313.5448  9.243675 295.5666 331.1001
 [78,] 325.1002 10.656030 304.1597 345.3909
 [79,] 336.6555 12.372031 312.2582 360.6132
 [80,] 348.2109 14.282648 320.2976 375.6860
 [81,] 251.0996 13.356096 224.8305 276.8032
 [82,] 250.8238 11.398954 228.4554 272.5961
 [83,] 250.5481  9.734651 231.7811 269.4156
 [84,] 250.2723  8.536225 233.7884 266.9217
 [85,] 249.9966  8.015439 234.0208 265.8552
 [86,] 249.7208  8.300832 233.3739 265.8350
 [87,] 249.4451  9.318626 230.8121 267.3284
 [88,] 249.1693 10.864907 227.3073 269.8453
 [89,] 248.8936 12.748805 223.3373 273.3266
 [90,] 248.6178 14.842314 219.1986 277.1368
 [91,] 285.9436 13.071766 261.1653 312.9681
 [92,] 305.0838 11.186322 283.7312 328.0092
 [93,] 324.2240  9.575382 305.4526 343.2224
 [94,] 343.3642  8.398424 326.7752 359.8061
 [95,] 362.5044  7.853058 347.5805 377.7770
 [96,] 381.6447  8.068392 366.0623 397.3311
 [97,] 400.7849  8.989928 383.5399 418.3294
 [98,] 419.9251 10.432165 399.4686 440.6401
 [99,] 439.0653 12.211993 415.3706 462.9170
[100,] 458.2055 14.203060 430.8618 486.3216
[101,] 226.4237 13.315523 199.4456 251.8169
[102,] 238.0021 11.389122 214.9356 259.9588
[103,] 249.5805  9.750229 230.1944 268.3506
[104,] 261.1589  8.565499 244.3658 277.7782
[105,] 272.7373  8.038315 257.3584 288.3761
[106,] 284.3157  8.295010 268.5535 300.8375
[107,] 295.8941  9.270696 278.0569 314.4132
[108,] 307.4725 10.771738 286.7532 328.7214
[109,] 319.0509 12.611931 294.7452 343.8616
[110,] 330.6293 14.664148 302.5835 359.8246
[111,] 238.4702 12.959905 213.1471 263.1712
[112,] 255.5489 11.103400 233.7015 277.3058
[113,] 272.6276  9.524115 253.7153 291.3102
[114,] 289.7063  8.380272 273.5889 306.6039
[115,] 306.7850  7.864226 291.8633 322.4834
[116,] 323.8637  8.096916 308.0635 340.0037
[117,] 340.9424  9.020585 323.5037 358.9603
[118,] 358.0211 10.453649 337.3335 378.8138
[119,] 375.0998 12.218163 351.0402 398.8685
[120,] 392.1785 14.191023 364.4638 420.2081
[121,] 255.8850 12.334019 232.5144 280.2568
[122,] 263.3415 10.619168 243.2001 284.5640
[123,] 270.7981  9.197901 252.9427 288.9877
[124,] 278.2546  8.223867 262.0928 294.3652
[125,] 285.7112  7.865021 270.1708 301.1575
[126,] 293.1677  8.202504 277.0591 309.3033
[127,] 300.6243  9.159670 282.6771 318.4800
[128,] 308.0809 10.569484 287.0361 328.4158
[129,] 315.5374 12.276986 290.5097 339.2845
[130,] 322.9940 14.175004 294.0081 350.4411
[131,] 271.9235 12.618529 246.8845 296.7101
[132,] 286.0040 10.864829 265.0261 307.4206
[133,] 300.0844  9.392686 281.8626 318.6612
[134,] 314.1648  8.352328 297.9764 330.9142
[135,] 328.2452  7.915872 312.5320 344.2695
[136,] 342.3256  8.180556 326.1592 358.6823
[137,] 356.4061  9.085305 338.7230 374.1988
[138,] 370.4865 10.465412 350.3365 391.1788
[139,] 384.5669 12.160087 360.9656 407.9789
[140,] 398.6473 14.056010 371.3523 425.7682
[141,] 254.5934 12.321987 229.6531 278.1348
[142,] 265.9507 10.639562 244.5566 286.4733
[143,] 277.3081  9.255859 258.9239 295.1480
[144,] 288.6654  8.321255 272.2395 304.9549
[145,] 300.0227  7.994833 284.0685 315.4849
[146,] 311.3801  8.348242 295.0576 327.7281
[147,] 322.7374  9.304335 304.3733 340.6022
[148,] 334.0947 10.702798 313.5844 354.6257
[149,] 345.4520 12.394790 321.6479 369.3106
[150,] 356.8094 14.276326 328.8029 384.6566
[151,] 225.9570 13.553461 198.9990 251.9643
[152,] 241.2215 11.609782 218.3427 263.7663
[153,] 256.4859  9.930287 237.1373 275.6354
[154,] 271.7504  8.669892 254.6890 288.4436
[155,] 287.0149  8.028466 271.4134 302.5414
[156,] 302.2794  8.153426 286.4143 318.1162
[157,] 317.5439  9.012951 299.7859 335.1004
[158,] 332.8084 10.426938 312.1676 353.1987
[159,] 348.0729 12.204165 324.2956 371.5924
[160,] 363.3374 14.208979 336.1529 390.5396
[161,] 251.7874 12.195966 228.4526 276.4865
[162,] 261.2956 10.533896 240.7956 282.4160
[163,] 270.8037  9.164650 252.4486 288.7255
[164,] 280.3118  8.235602 263.6096 296.3852
[165,] 289.8200  7.903540 273.9967 305.3859
[166,] 299.3281  8.240949 282.4383 315.5272
[167,] 308.8362  9.174258 290.3463 327.0168
[168,] 318.3444 10.546434 297.3021 338.6604
[169,] 327.8525 12.210405 303.6226 351.8821
[170,] 337.3606 14.062973 309.5389 364.7430
[171,] 263.1802 12.309193 239.5039 287.2748
[172,] 275.0350 10.594155 254.8288 296.0737
[173,] 286.8899  9.164423 268.9639 304.8211
[174,] 298.7447  8.171158 283.0204 314.6833
[175,] 310.5996  7.783292 295.6151 325.8648
[176,] 322.4544  8.088394 306.9537 338.6619
[177,] 334.3093  9.016386 317.0787 352.0119
[178,] 346.1641 10.401874 326.2775 366.4585
[179,] 358.0190 12.088564 334.7247 381.7437
[180,] 369.8738 13.967764 342.8614 397.7131</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.1315405 13.010130  -28.8499396  21.5092038
  [2,]  -14.6495002 11.134405  -35.7394146   7.6816949
  [3,]  -42.2162600  9.550596  -60.5651856 -23.1479214
  [4,]    8.7602803  8.424976   -7.4279072  25.0659987
  [5,]   24.5097206  7.954494    9.2152775  40.0268644
  [6,]   62.6852608  8.251977   47.0099954  78.8702756
  [7,]   10.5363011  9.243577   -7.3495493  28.5097693
  [8,] -101.1815587 10.738701 -121.9613143 -79.9512112
  [9,]   19.5924816 12.558786   -4.6470437  44.6626539
 [10,]   35.6980218 14.582659    6.8815173  65.1848674
 [11,]   11.2937261 13.254475  -13.8883685  37.2246459
 [12,]   -7.9444570 11.341874  -29.1772599  14.7135484
 [13,]  -12.0025400  9.707780  -30.5210017   7.7699338
 [14,]  -12.0434231  8.514094  -28.5686077   5.0441077
 [15,]  -10.8044061  7.961439  -26.3995440   4.5817395
 [16,]   -4.3287892  8.180778  -20.3339058  11.5750714
 [17,]   -8.4303722  9.116560  -26.4767987   9.5019596
 [18,]   -6.1035553 10.580364  -27.0678479  14.9931726
 [19,]   -1.3051383 12.386382  -25.6783588  23.8254024
 [20,]    9.9432787 14.406481  -17.6912806  39.2727068
 [21,]  -13.9923294 13.488291  -39.7725898  13.2133997
 [22,]  -23.6300013 11.547695  -45.9143574  -0.5448945
 [23,]   11.4418269  9.879499   -7.0642560  31.1668246
 [24,]    5.0474550  8.642900  -11.4715659  22.0545262
 [25,]   -3.4027168  8.039583  -19.2001172  12.2769772
 [26,]  -17.1681886  8.210362  -33.3492481  -0.9807393
 [27,]   -7.1212605  9.111815  -25.0061436  10.6691157
 [28,]    8.2930677 10.558422  -12.5672114  28.6691904
 [29,]    8.6384958 12.360232  -15.8133065  32.5023928
 [30,]   -9.7746760 14.384379  -38.2028579  18.3250709
 [31,]   46.8972639 13.193507   20.1037618  71.8892918
 [32,]   20.0289502 11.335574   -3.2724649  41.4026067
 [33,]   -2.2406635  9.750698  -22.1006630  16.4837631
 [34,]   -6.6900771  8.591347  -23.7472116  10.0704735
 [35,]  -11.7516908  8.043670  -27.2960151   3.9665420
 [36,]   -5.6894045  8.230691  -21.6416358  10.5128016
 [37,]  -28.7612182  9.107260  -46.1289215 -10.9063984
 [38,]    3.5345681 10.502111  -16.6911499  23.9876553
 [39,]  -15.1031455 12.239312  -38.7871640   8.7791756
 [40,]   27.8701408 14.193712    0.3866033  55.8272806
 [41,]   14.3500783 12.952897  -12.2593242  38.6861842
 [42,]    4.3220341 11.138181  -17.9797134  25.5938282
 [43,]   13.7224899  9.610916   -5.5705010  32.3548720
 [44,]   24.5970457  8.526982    7.6964995  41.2935810
 [45,]   13.3389015  8.067107   -2.6808270  29.1547522
 [46,]  -17.0398427  8.335233  -33.5892163  -0.8952710
 [47,]  -27.7036869  9.268392  -46.0581152  -9.8088915
 [48,]    9.6188689 10.693884  -11.2675065  30.0685504
 [49,]  -38.8720753 12.443646  -62.9870072 -15.0946167
 [50,]   31.5419805 14.399950    3.5675330  59.2796227
 [51,]  -25.3057512 12.424892  -50.0493102  -0.8384051
 [52,]  -27.5991886 10.721456  -48.7011942  -6.2948636
 [53,]   -7.6943260  9.317866  -26.0876912  10.6351510
 [54,]   18.8685367  8.366421    2.2967229  35.1840083
 [55,]   16.3179993  8.029489    0.3626552  32.2276850
 [56,]   -1.3919381  8.381512  -18.0940492  15.4059045
 [57,]  132.5277245  9.344952  113.9947566 151.4996803
 [58,]   14.9522871 10.756759   -6.2116853  36.5654777
 [59,]  -11.8231503 12.465510  -36.1481354  13.2704869
 [60,]  -98.5036876 14.365631 -126.2414177 -69.5688818
 [61,]   15.8038584 12.659226   -9.9712112  39.6237891
 [62,]   11.2467541 10.878551  -10.7652327  32.1245111
 [63,]  -11.8086502  9.370589  -30.8747960   6.0909132
 [64,]    0.9620455  8.285601  -15.8742180  16.9137751
 [65,]  -11.9463588  7.802091  -27.5106587   3.4828047
 [66,]   18.7794369  8.029460    2.9053984  34.6574769
 [67,]    2.3697325  8.913474  -15.4655767  19.9057026
 [68,]    8.9134282 10.286204  -11.9240304  29.2199983
 [69,]  -16.8361761 11.980824  -41.6474958   6.5129485
 [70,]    1.5769196 13.879931  -27.2979736  28.8940319
 [71,]   21.2603222 12.507505   -3.3668176  45.7045542
 [72,]   20.4330778 10.773991   -0.9986043  41.4966748
 [73,]  -23.9587666  9.334387  -42.8019467  -5.5217251
 [74,]  -24.2065111  8.342266  -40.7609085  -7.8630483
 [75,]  -11.4097555  7.966601  -26.8318239   4.4444216
 [76,]  -17.7982999  8.291608  -33.9241975  -1.5245259
 [77,]   -8.0200443  9.243675  -25.5753171   9.9581515
 [78,]    6.4227113 10.656030  -13.8679558  27.3632398
 [79,]   -0.9086331 12.372031  -24.8662799  23.4886735
 [80,]   29.0881224 14.282648    1.6130490  57.0013897
 [81,]   -9.4912855 13.356096  -35.1948533  16.7777902
 [82,]   23.1233678 11.398954    1.3511109  45.4918151
 [83,]    3.9426211  9.734651  -14.9249290  22.7095794
 [84,]   20.5297743  8.536225    3.8804086  37.0137066
 [85,]    1.4553276  8.015439  -14.4032757  17.4310939
 [86,]    4.9153808  8.300832  -11.1988200  21.2623235
 [87,]   -3.9927659  9.318626  -21.8760924  14.6401866
 [88,]  -13.8583127 10.864907  -34.5343004   8.0037239
 [89,]  -13.1394594 12.748805  -37.5725392  12.4168400
 [90,]  -11.3712062 14.842314  -39.8901643  18.0479943
 [91,]   26.4229567 13.071766   -0.6014685  51.2013164
 [92,]    8.7219552 11.186322  -14.2034040  30.0745756
 [93,]  -32.6128464  9.575382  -51.6111770 -13.8413980
 [94,]    2.7579520  8.398424  -13.6838594  19.3470368
 [95,]    3.2279504  7.853058  -12.0446081  18.1519240
 [96,]   10.1938488  8.068392   -5.4925533  25.7762272
 [97,]    3.4752472  8.989928  -14.0692979  20.7201720
 [98,]   -3.2327544 10.432165  -23.9477665  17.2237412
 [99,]   16.7990440 12.211993   -7.0526654  40.4936661
[100,]    0.7112424 14.203060  -27.4049144  28.0549243
[101,]    9.6794861 13.315523  -15.7137320  36.6576077
[102,]   -7.6854167 11.389122  -29.6421486  15.3811471
[103,]  -10.6549195  9.750229  -29.4249886   8.7312365
[104,]   -6.2369222  8.565499  -22.8562310  10.5562450
[105,]  -22.0270250  8.038315  -37.6658063  -6.6480880
[106,]  -14.5413278  8.295010  -31.0631445   1.2209092
[107,]  -14.3293306  9.270696  -32.8484302   3.5078696
[108,]    0.6294667 10.771738  -20.6194488  21.3487788
[109,]   17.2296639 12.611931   -7.5810074  41.5354432
[110,]   21.0157611 14.664148   -8.1795222  49.0616129
[111,]   17.8265557 12.959905   -6.8744243  43.1496793
[112,]  -12.0946449 11.103400  -33.8514730   9.7527583
[113,]  -16.4230455  9.524115  -35.1056367   2.4892883
[114,]  -34.1792461  8.380272  -51.0767906 -18.0618318
[115,]  -37.8685467  7.864226  -53.5668915 -22.9468121
[116,]    5.8609527  8.096916  -10.2789993  21.6611890
[117,]   38.5020521  9.020585   20.4842482  55.9407581
[118,]    4.8972515 10.453649  -15.8953694  25.5849445
[119,]   19.3873509 12.218163   -4.3812552  43.4469685
[120,]   -3.1258497 14.191023  -31.1554090  24.5889182
[121,]   -5.3584629 12.334019  -29.7302682  18.0121091
[122,]   36.7160806 10.619168   15.4935726  56.8575117
[123,]   -0.9041759  9.197901  -19.0937759  16.9511853
[124,]    2.3344676  8.223867  -13.7761135  18.4962839
[125,]  -13.8837889  7.865021  -29.3300554   1.6566323
[126,]   11.4658546  8.202504   -4.6696590  27.5744591
[127,]  -12.8777019  9.159670  -30.7333876   5.0695165
[128,]  -41.4853584 10.569484  -61.8203167 -20.4406444
[129,]    6.0043851 12.276986  -17.7426872  31.0320697
[130,]   24.5715286 14.175004   -2.8755532  53.5574027
[131,]  -50.2464385 12.618529  -75.0329705 -25.2074450
[132,]   12.1899429 10.864829   -9.2266936  33.1677770
[133,]   26.7941243  9.392686    8.2172806  45.0158506
[134,]   32.6907058  8.352328   15.9413288  48.8790997
[135,]   20.4949872  7.915872    4.4706614  36.2081633
[136,]   10.5030686  8.180556   -5.8535895  26.6694562
[137,]   -1.9794500  9.085305  -19.7721576  15.7036293
[138,]  -10.0538686 10.465412  -30.7461875  10.0961168
[139,]   -8.9262872 12.160087  -32.3382764  14.6750097
[140,]  -10.1056058 14.056010  -37.2265128  17.1893627
[141,]   17.3300908 12.321987   -6.2112574  42.2704268
[142,]    2.4861626 10.639562  -18.0363904  23.8802817
[143,]  -20.0656656  9.255859  -37.9056080  -1.6814817
[144,]  -11.0087938  8.321255  -27.2983388   5.4171012
[145,]   14.7994780  7.994833   -0.6626926  30.7536615
[146,]    5.8334499  8.348242  -10.5145936  22.1558732
[147,]  -24.6020783  9.304335  -42.4668974  -6.2379812
[148,]   14.0281935 10.702798   -6.5027721  34.5385010
[149,]   -5.1720347 12.394790  -29.0305766  18.6320537
[150,]    9.7037371 14.276326  -18.1434860  37.7102116
[151,]   -0.6929599 13.553461  -26.7003196  26.2649891
[152,]   -6.6979525 11.609782  -29.2427790  16.1807991
[153,]  -17.5851451  9.930287  -36.7345702   1.7635327
[154,]  -31.2774377  8.669892  -47.9706432 -14.2160037
[155,]  -19.4776303  8.028466  -35.0041207  -3.8761031
[156,]   41.9142771  8.153426   26.0774921  57.7794482
[157,]  -36.3958155  9.012951  -53.9522844 -18.6377958
[158,]   14.7770919 10.426938   -5.6131963  35.4179211
[159,]   17.0900993 12.204165   -6.4293856  40.8674387
[160,]    8.8914067 14.208979  -18.3107604  36.0758576
[161,]   18.0929692 12.195966   -6.6060571  41.4277648
[162,]   11.1472373 10.533896   -9.9731888  31.6471861
[163,]    7.0952054  9.164650  -10.8265607  25.4503001
[164,]    1.4776734  8.235602  -14.5956643  18.1799083
[165,]  -10.6494585  7.903540  -26.2154104   5.1738358
[166,]  -14.8160904  8.240949  -31.0152431   2.0736993
[167,]  -49.5704224  9.174258  -67.7509890 -31.0804984
[168,]  -13.7137543 10.546434  -34.0298014   7.3285325
[169,]   22.9282138 12.210405   -1.1014446  47.1580994
[170,]   32.1085818 14.062973    4.7261644  59.9302881
[171,]    6.2315156 12.309193  -17.8631257  29.9078299
[172,]   -1.5610304 10.594155  -22.5997237  18.6452181
[173,]   10.7069235  9.164423   -7.2243185  28.6328933
[174,]   11.8868774  8.171158   -4.0517273  27.6112239
[175,]  -23.4269687  7.783292  -38.6922495  -8.4425092
[176,]    7.1531853  8.088394   -9.0543072  22.6539092
[177,]    0.1725392  9.016386  -17.5301188  17.4030897
[178,]   -2.9442069 10.401874  -23.2386494  16.9424022
[179,]   11.1227470 12.088564  -12.6019830  34.4169582
[180,]   -5.7501990 13.967764  -33.5894794  21.2621935</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1769.9 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1492      
 (0.5, 0.7]   (ok)         2    1.1%   105       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.9 22.3
p_loo        34.1  8.5
looic      1721.8 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   655       
 (0.5, 0.7]   (ok)         4    2.2%   548       
   (0.7, 1]   (bad)        3    1.7%   14        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.1      11.6  
fit_sleep1 -92.4      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1769.9 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1492      
 (0.5, 0.7]   (ok)         2    1.1%   105       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.9 22.3
p_loo        34.1  8.5
looic      1721.8 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   655       
 (0.5, 0.7]   (ok)         4    2.2%   548       
   (0.7, 1]   (bad)        3    1.7%   14        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.9     22.3        34.1    8.5   1721.8
fit_sleep2  -24.1      11.6  -885.0     14.4        19.5    3.4   1769.9
fit_sleep1  -92.4      21.0  -953.3     10.5         3.2    0.5   1906.7
           se_looic
fit_sleep3   44.7  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
7.104804e-41 3.508230e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.85      1.58      0.2     5.33       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.15      1.58     -3.5     2.76       5.51      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-33         Matrix_1.5-4.1     

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.1       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.32       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
