<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.02      6.76    15.77    42.49 1.00     1782     2324
sd(Days)                6.56      1.52     4.17    10.16 1.00     1469     1647
cor(Intercept,Days)     0.07      0.30    -0.48     0.65 1.00     1057     1724

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   250.77      7.53   235.61   265.55 1.00     1753     2389
Days         10.41      1.70     7.14    13.80 1.00     1391     2060

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.51    23.12    29.09 1.00     3442     2921

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7589  12.85232 228.7659 278.6616
309 211.4759  13.51026 183.9982 237.1169
310 213.3317  12.99427 187.4153 237.7914
330 274.7053  13.46429 248.7668 302.3987
331 273.0787  12.93800 248.0166 298.9475
332 260.3814  12.49243 236.0217 285.2750
333 267.8073  12.45772 244.2980 293.2588
334 244.4333  12.22582 219.6144 268.0788
335 250.7794  13.50689 224.4698 277.3400
337 285.8471  13.14770 260.5458 311.9802
349 226.4897  12.74414 200.5277 251.1412
350 238.6309  13.10293 211.5346 264.4616
351 255.6420  12.38012 232.1514 280.7726
352 272.1633  12.38199 248.0862 296.4628
369 254.6151  12.24405 230.1947 278.6176
370 226.2993  13.42669 198.8477 250.9245
371 252.0831  12.48997 227.8010 276.7655
372 263.3380  12.31761 238.3165 287.7389

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6808579  2.499732 14.9278797 24.684812
309  1.7793456  2.536850 -3.2303306  6.706082
310  4.8746528  2.473980  0.1010257  9.858286
330  5.7032763  2.555518  0.6005135 10.580043
331  7.4918749  2.481984  2.5668896 12.280354
332 10.2281435  2.388067  5.4136846 14.777283
333 10.3149395  2.368085  5.5521272 14.905269
334 11.4889268  2.345650  6.9447731 16.065771
335 -0.2423332  2.599084 -5.3587989  4.797083
337 19.1177924  2.496673 14.2598133 23.963181
349 11.6021459  2.447544  6.9238441 16.574663
350 17.0220004  2.510896 12.2038854 22.048475
351  7.4413893  2.339105  2.8256614 11.903969
352 14.0288068  2.387872  9.3243360 18.631881
369 11.3612589  2.329553  6.7955125 15.934400
370 15.2180657  2.561487 10.4018748 20.296986
371  9.5445712  2.352567  4.7925883 14.266737
372 11.7991929  2.355905  7.1027066 16.309015</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7589 12.852325 228.7659 278.6616
  [2,] 273.4398 10.965021 251.8415 294.8892
  [3,] 293.1207  9.369014 274.5573 311.4710
  [4,] 312.8015  8.235440 296.5222 328.7369
  [5,] 332.4824  7.769417 316.5998 347.5440
  [6,] 352.1632  8.087184 335.9598 367.6701
  [7,] 371.8441  9.107060 353.8406 388.6866
  [8,] 391.5250 10.628823 370.5591 411.4495
  [9,] 411.2058 12.470065 386.8857 434.7971
 [10,] 430.8867 14.509669 402.5576 458.9135
 [11,] 211.4759 13.510261 183.9982 237.1169
 [12,] 213.2552 11.580566 189.9321 235.2431
 [13,] 215.0346  9.927894 195.2308 234.0775
 [14,] 216.8139  8.711365 199.4345 233.8694
 [15,] 218.5933  8.129200 202.3950 234.7805
 [16,] 220.3726  8.315716 203.9128 236.5284
 [17,] 222.1520  9.224402 203.8941 239.9871
 [18,] 223.9313 10.672360 202.7945 244.7008
 [19,] 225.7107 12.473178 201.2423 249.5774
 [20,] 227.4900 14.495940 198.6915 255.0147
 [21,] 213.3317 12.994266 187.4153 237.7914
 [22,] 218.2064 11.143968 195.9299 238.9024
 [23,] 223.0810  9.579469 203.6390 241.3314
 [24,] 227.9557  8.460828 211.1997 244.4956
 [25,] 232.8303  7.977852 216.8375 248.7197
 [26,] 237.7050  8.243046 221.0872 253.8793
 [27,] 242.5797  9.191879 224.1212 260.4404
 [28,] 247.4543 10.643055 226.6329 268.0529
 [29,] 252.3290 12.421745 228.2545 276.6891
 [30,] 257.2036 14.407153 229.4728 285.4571
 [31,] 274.7053 13.464285 248.7668 302.3987
 [32,] 280.4086 11.516675 258.3932 304.3436
 [33,] 286.1119  9.850988 267.2257 306.0690
 [34,] 291.8152  8.632004 274.7951 309.1384
 [35,] 297.5184  8.064883 281.3830 313.5497
 [36,] 303.2217  8.284597 287.0225 319.2284
 [37,] 308.9250  9.235155 290.8675 326.5990
 [38,] 314.6283 10.723944 293.4889 335.5419
 [39,] 320.3315 12.561019 295.6932 344.7357
 [40,] 326.0348 14.615635 297.6782 354.5420
 [41,] 273.0787 12.937996 248.0166 298.9475
 [42,] 280.5705 11.116402 259.1162 302.8613
 [43,] 288.0624  9.595703 269.2578 307.0563
 [44,] 295.5543  8.538216 279.0063 312.3421
 [45,] 303.0462  8.126823 287.1254 318.8362
 [46,] 310.5380  8.456350 293.8139 326.8369
 [47,] 318.0299  9.449601 299.4792 336.3891
 [48,] 325.5218 10.927056 303.8973 346.9183
 [49,] 333.0137 12.721109 307.3938 357.9543
 [50,] 340.5055 14.716426 311.1783 369.5190
 [51,] 260.3814 12.492426 236.0217 285.2750
 [52,] 270.6096 10.725199 249.8208 291.9503
 [53,] 280.8377  9.241472 262.6305 298.5876
 [54,] 291.0659  8.196673 274.8578 307.2910
 [55,] 301.2940  7.769931 286.0608 316.6736
 [56,] 311.5222  8.060020 295.4456 327.4164
 [57,] 321.7503  8.997874 303.9482 339.6486
 [58,] 331.9785 10.409865 311.0954 352.9251
 [59,] 342.2066 12.131552 317.8007 366.3361
 [60,] 352.4347 14.049540 323.9216 380.7947
 [61,] 267.8073 12.457718 244.2980 293.2588
 [62,] 278.1222 10.703320 258.0411 299.7857
 [63,] 288.4372  9.227297 270.7919 306.6245
 [64,] 298.7521  8.181726 283.3213 314.7245
 [65,] 309.0671  7.742990 294.0888 324.0285
 [66,] 319.3820  8.011418 303.7830 335.0401
 [67,] 329.6969  8.923418 312.2793 347.0252
 [68,] 340.0119 10.309588 320.2836 360.0571
 [69,] 350.3268 12.006809 327.2824 374.0001
 [70,] 360.6418 13.901618 333.7615 387.7426
 [71,] 244.4333 12.225824 219.6144 268.0788
 [72,] 255.9222 10.512570 234.5764 276.3795
 [73,] 267.4112  9.086343 249.5737 284.9159
 [74,] 278.9001  8.100203 263.1954 294.6079
 [75,] 290.3890  7.724576 275.2337 305.5111
 [76,] 301.8779  8.045435 285.7971 317.7221
 [77,] 313.3669  8.988499 295.6316 330.8510
 [78,] 324.8558 10.385632 304.2120 345.3135
 [79,] 336.3447 12.080304 311.9397 360.1045
 [80,] 347.8336 13.964608 320.0738 375.6654
 [81,] 250.7794 13.506888 224.4698 277.3400
 [82,] 250.5370 11.497232 228.1419 273.0874
 [83,] 250.2947  9.769705 231.1537 269.6371
 [84,] 250.0524  8.498141 233.4068 266.6450
 [85,] 249.8100  7.905702 234.5051 264.9647
 [86,] 249.5677  8.142010 233.5708 265.5472
 [87,] 249.3254  9.143030 231.2093 267.2689
 [88,] 249.0830 10.696174 227.9596 269.9166
 [89,] 248.8407 12.598879 223.7699 273.3790
 [90,] 248.5984 14.716176 219.3844 277.3405
 [91,] 285.8471 13.147698 260.5458 311.9802
 [92,] 304.9649 11.237298 283.0862 327.1382
 [93,] 324.0827  9.599925 305.3014 342.6244
 [94,] 343.2005  8.396844 326.7931 359.5019
 [95,] 362.3183  7.830848 346.8348 377.6957
 [96,] 381.4361  8.037669 365.2225 397.0986
 [97,] 400.5539  8.963974 382.5678 417.9570
 [98,] 419.6717 10.419611 398.9687 440.0043
 [99,] 438.7895 12.216813 414.5836 462.8496
[100,] 457.9073 14.226717 430.0158 485.7244
[101,] 226.4897 12.744144 200.5277 251.1412
[102,] 238.0919 10.961629 215.7483 259.0666
[103,] 249.6940  9.480631 230.2775 267.9975
[104,] 261.2961  8.460991 244.1028 277.8970
[105,] 272.8983  8.079313 257.0318 288.3524
[106,] 284.5004  8.422778 267.9875 300.5150
[107,] 296.1026  9.412334 277.2997 313.9576
[108,] 307.7047 10.872986 285.9684 328.3602
[109,] 319.3069 12.642490 294.4579 343.8973
[110,] 330.9090 14.609046 302.3503 359.4945
[111,] 238.6309 13.102929 211.5346 264.4616
[112,] 255.6529 11.196239 232.4124 278.0106
[113,] 272.6749  9.572564 253.1773 291.8956
[114,] 289.6969  8.397701 272.5328 306.3179
[115,] 306.7189  7.875151 290.8987 322.2046
[116,] 323.7409  8.131654 307.9201 339.4085
[117,] 340.7629  9.101582 322.9035 358.3427
[118,] 357.7849 10.590702 337.3673 378.7173
[119,] 374.8069 12.413555 351.0259 399.4963
[120,] 391.8289 14.444339 363.9580 420.3638
[121,] 255.6420 12.380124 232.1514 280.7726
[122,] 263.0834 10.670189 242.5435 284.6267
[123,] 270.5248  9.240196 252.7241 289.2502
[124,] 277.9662  8.237253 261.9474 294.2007
[125,] 285.4076  7.827278 270.1564 300.4713
[126,] 292.8490  8.100805 276.9449 308.3818
[127,] 300.2904  8.995701 282.2584 317.5608
[128,] 307.7317 10.352055 287.1131 327.7843
[129,] 315.1731 12.014585 290.8553 338.2240
[130,] 322.6145 13.873655 294.6089 349.0307
[131,] 272.1633 12.381994 248.0862 296.4628
[132,] 286.1921 10.634654 265.5317 306.8467
[133,] 300.2209  9.180512 282.0061 318.2542
[134,] 314.2497  8.177506 298.2370 330.3014
[135,] 328.2785  7.801621 313.0845 343.7870
[136,] 342.3073  8.140198 326.6346 358.1135
[137,] 356.3361  9.113958 338.6395 374.1922
[138,] 370.3649 10.548436 349.4741 390.7116
[139,] 384.3937 12.283266 360.0868 408.2444
[140,] 398.4225 14.208857 370.1660 426.0504
[141,] 254.6151 12.244047 230.1947 278.6176
[142,] 265.9763 10.574045 245.1726 286.4862
[143,] 277.3376  9.195530 259.0984 295.2366
[144,] 288.6988  8.255832 272.1285 304.5672
[145,] 300.0601  7.912862 284.2857 315.4123
[146,] 311.4214  8.241458 294.9952 327.6002
[147,] 322.7826  9.169707 304.8007 340.8417
[148,] 334.1439 10.540353 313.4877 354.6304
[149,] 345.5051 12.205252 321.6981 369.3335
[150,] 356.8664 14.060262 329.3606 384.7838
[151,] 226.2993 13.426689 198.8477 250.9245
[152,] 241.5174 11.473629 218.4180 263.2756
[153,] 256.7354  9.804835 236.8768 275.6105
[154,] 271.9535  8.587657 254.9127 288.6048
[155,] 287.1716  8.030152 271.5743 302.7714
[156,] 302.3896  8.266877 286.4383 318.7896
[157,] 317.6077  9.236969 299.5677 335.6943
[158,] 332.8258 10.743574 311.6794 353.8157
[159,] 348.0438 12.595618 323.7358 372.4529
[160,] 363.2619 14.662784 334.9108 392.3431
[161,] 252.0831 12.489971 227.8010 276.7655
[162,] 261.6277 10.765442 240.6522 282.8699
[163,] 271.1723  9.319832 252.8088 289.2020
[164,] 280.7168  8.300176 264.4109 296.4487
[165,] 290.2614  7.873736 274.6365 305.5778
[166,] 299.8060  8.134351 284.1620 316.0343
[167,] 309.3506  9.022680 292.2258 327.6300
[168,] 318.8951 10.378775 299.3916 339.9948
[169,] 328.4397 12.045677 305.9162 352.9896
[170,] 337.9843 13.912112 311.6724 366.3101
[171,] 263.3380 12.317611 238.3165 287.7389
[172,] 275.1372 10.612737 253.7248 296.2267
[173,] 286.9364  9.199859 268.2886 305.2758
[174,] 298.7356  8.230747 282.2194 315.1088
[175,] 310.5348  7.871060 294.8891 325.6782
[176,] 322.3340  8.201375 306.3610 338.2588
[177,] 334.1332  9.147245 315.8626 351.8838
[178,] 345.9324 10.544298 324.9498 366.5913
[179,] 357.7316 12.238992 333.1462 382.2313
[180,] 369.5308 14.124596 341.4816 397.1925</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.1989458 12.852325  -29.1016313  20.7941262
  [2,]  -14.7351037 10.965021  -36.1844618   6.8632295
  [3,]  -42.3200617  9.369014  -60.6703734 -23.7567382
  [4,]    8.6382804  8.235440   -7.2970641  24.9175507
  [5,]   24.3695224  7.769417    9.3078904  40.2521300
  [6,]   62.5268645  8.087184   47.0200312  78.7303290
  [7,]   10.3597065  9.107060   -6.4828491  28.3632265
  [8,] -101.3763514 10.628823 -121.3009489 -80.4105196
  [9,]   19.3794907 12.470065   -4.2118055  43.6996454
 [10,]   35.4668327 14.509669    7.4400221  63.7959391
 [11,]   11.2580127 13.510261  -14.3830109  38.7357295
 [12,]   -7.9894329 11.580566  -29.9772985  15.3337270
 [13,]  -12.0567785  9.927894  -31.0997075   7.7470104
 [14,]  -12.1069241  8.711365  -29.1624456   5.2725193
 [15,]  -10.8771698  8.129200  -27.0644037   5.3210715
 [16,]   -4.4108154  8.315716  -20.5666454  12.0490188
 [17,]   -8.5216610  9.224402  -26.3568034   9.7362055
 [18,]   -6.2041066 10.672360  -26.9736158  14.9327293
 [19,]   -1.4149522 12.473178  -25.2817253  23.0534395
 [20,]    9.8242021 14.495940  -17.7005499  38.6227399
 [21,]  -14.2778334 12.994266  -38.7375170  11.6386157
 [22,]  -23.8741862 11.143968  -44.5702169  -1.5976718
 [23,]   11.2389610  9.579469   -7.0114181  30.6809548
 [24,]    4.8859081  8.460828  -11.6539716  21.6419369
 [25,]   -3.5229447  7.977852  -19.4122599  12.4698614
 [26,]  -17.2470976  8.243046  -33.4213943  -0.6292717
 [27,]   -7.1588504  9.191879  -25.0195872  11.2996229
 [28,]    8.2967968 10.643055  -12.3017653  29.1182248
 [29,]    8.6835439 12.421745  -15.6766313  32.7579912
 [30,]   -9.6883089 14.407153  -37.9418454  18.0425119
 [31,]   46.8372665 13.464285   19.1439201  72.7757686
 [32,]   19.9915901 11.516675   -3.9433531  42.0070160
 [33,]   -2.2553862  9.850988  -22.2125265  16.6307814
 [34,]   -6.6821626  8.632004  -24.0053926  10.3378719
 [35,]  -11.7211389  8.064883  -27.7523970   4.4143427
 [36,]   -5.6362153  8.284597  -21.6428775  10.5630452
 [37,]  -28.6853916  9.235155  -46.3593827 -10.6278546
 [38,]    3.6330321 10.723944  -17.2806195  24.7724412
 [39,]  -14.9820443 12.561019  -39.3862184   9.6562574
 [40,]   28.0138794 14.615635   -0.4933299  56.3705332
 [41,]   14.5292477 12.937996  -11.3395501  39.5912860
 [42,]    4.4294727 11.116402  -17.8613244  25.8837690
 [43,]   13.7581978  9.595703   -5.2357456  32.5628405
 [44,]   24.5610229  8.538216    7.7732334  41.1089538
 [45,]   13.2311479  8.126823   -2.5588927  29.1519352
 [46,]  -17.2193270  8.456350  -33.5182036  -0.4951695
 [47,]  -27.9549019  9.449601  -46.3140792  -9.4041630
 [48,]    9.2959231 10.927056  -12.1006220  30.9204078
 [49,]  -39.2667518 12.721109  -64.2074034 -13.6468996
 [50,]   31.0755733 14.716426    2.0620737  60.4028442
 [51,]  -25.5208481 12.492426  -50.4144377  -1.1610965
 [52,]  -27.7977916 10.725199  -49.1385257  -7.0089804
 [53,]   -7.8764352  9.241472  -25.6262859  10.3308368
 [54,]   18.7029213  8.196673    2.4777825  34.9110436
 [55,]   16.1688778  7.769931    0.7892608  31.4020530
 [56,]   -1.5245658  8.060020  -17.4188354  14.5520268
 [57,]  132.4115907  8.997874  114.5133434 150.2137175
 [58,]   14.8526472 10.409865   -6.0939585  35.7357185
 [59,]  -11.9062964 12.131552  -36.0358446  12.4996360
 [60,]  -98.5703399 14.049540 -126.9302886 -70.0572038
 [61,]   16.0350988 12.457718   -9.4163670  39.5443983
 [62,]   11.4327594 10.703320  -10.2306546  31.5138737
 [63,]  -11.6678801  9.227297  -29.8552098   5.9774269
 [64,]    1.0575804  8.181726  -14.9148189  16.4884105
 [65,]  -11.8960590  7.742990  -26.8575361   3.0821529
 [66,]   18.7845015  8.011418    3.1264351  34.3835416
 [67,]    2.3295620  8.923418  -14.9987462  19.7471528
 [68,]    8.8280226 10.309588  -11.2172485  28.5562956
 [69,]  -16.9668169 12.006809  -40.6400650   6.0775784
 [70,]    1.4010437 13.901618  -25.6997534  28.2813403
 [71,]   21.0398020 12.225824   -2.6057282  45.8586893
 [72,]   20.2789752 10.512570   -0.1783024  41.6248463
 [73,]  -24.0464516  9.086343  -41.5512469  -6.2090018
 [74,]  -24.2277784  8.100203  -39.9355897  -8.5231252
 [75,]  -11.3646052  7.724576  -26.4866681   3.7906909
 [76,]  -17.6867320  8.045435  -33.5308970  -1.6058786
 [77,]   -7.8420588  8.988499  -25.3262468   9.8931573
 [78,]    6.6671144 10.385632  -13.7905606  27.3109313
 [79,]   -0.5978124 12.080304  -24.3575539  23.8072301
 [80,]   29.4653608 13.964608    1.6335580  57.2251519
 [81,]   -9.1710540 13.506888  -35.7316574  17.1384616
 [82,]   23.4101793 11.497232    0.8598462  45.8052957
 [83,]    4.1960125  9.769705  -15.1464234  23.3370474
 [84,]   20.7497457  8.498141    4.1570635  37.3952565
 [85,]    1.6418790  7.905702  -13.5127576  16.9468395
 [86,]    5.0685122  8.142010  -10.9110190  21.0654278
 [87,]   -3.8730545  9.143030  -21.8166028  14.2430120
 [88,]  -13.7720213 10.696174  -34.6056307   7.3514488
 [89,]  -13.0865881 12.598879  -37.6248893  11.9841576
 [90,]  -11.3517548 14.716176  -40.0939333  17.8621580
 [91,]   26.5194579 13.147698    0.3863852  51.8207948
 [92,]    8.8408654 11.237298  -13.3324098  30.7196397
 [93,]  -32.4715270  9.599925  -51.0132295 -13.6901552
 [94,]    2.9216806  8.396844  -13.3797186  19.3291223
 [95,]    3.4140882  7.830848  -11.9632859  18.8976143
 [96,]   10.4023957  8.037669   -5.2601335  26.6160247
 [97,]    3.7062033  8.963974  -13.6969019  21.6922986
 [98,]   -2.9793891 10.419611  -23.3119686  17.7236112
 [99,]   17.0748185 12.216813   -6.9852852  41.2806580
[100,]    1.0094260 14.226717  -26.8077042  28.9009014
[101,]    9.6134899 12.744144  -15.0380042  35.5754672
[102,]   -7.7751560 10.961629  -28.7499312  14.5683867
[103,]  -10.7684019  9.480631  -29.0719236   8.6481319
[104,]   -6.3741478  8.460991  -22.9749913  10.8192468
[105,]  -22.1879936  8.079313  -37.6421079  -6.3215143
[106,]  -14.7260395  8.422778  -30.7405786   1.7869014
[107,]  -14.5377854  9.412334  -32.3927847   4.2650858
[108,]    0.3972688 10.872986  -20.2581583  22.1335557
[109,]   16.9737229 12.642490   -7.6167455  41.8227100
[110,]   20.7360770 14.609046   -7.8493811  49.2948457
[111,]   17.6658822 13.102929   -8.1647649  44.7622245
[112,]  -12.1986181 11.196239  -34.5562902  11.0418865
[113,]  -16.4703185  9.572564  -35.6909533   3.0272835
[114,]  -34.1698189  8.397701  -50.7908092 -17.0056898
[115,]  -37.8024192  7.875151  -53.2881034 -21.9821632
[116,]    5.9837804  8.131654   -9.6837610  21.8045996
[117,]   38.6815800  9.101582   21.1017767  56.5409781
[118,]    5.1334796 10.590702  -15.7988693  25.5511228
[119,]   19.6802793 12.413555   -5.0090546  43.4613358
[120,]   -2.7762211 14.444339  -31.3110887  25.0947385
[121,]   -5.1155168 12.380124  -30.2460651  18.3751179
[122,]   36.9741938 10.670189   15.4309049  57.5140621
[123,]   -0.6308955  9.240196  -19.3562664  17.1697551
[124,]    2.6229151  8.237253  -13.6116226  18.6417225
[125,]  -13.5801742  7.827278  -28.6439256   1.6709595
[126,]   11.7846364  8.100805   -3.7482204  27.6886968
[127,]  -12.5437529  8.995701  -29.8142448   5.4882328
[128,]  -41.1362423 10.352055  -61.1888274 -20.5176156
[129,]    6.3686684 12.014585  -16.6822311  30.6865465
[130,]   24.9509790 13.873655   -1.4652356  52.9566041
[131,]  -50.4861754 12.381994  -74.7857413 -26.4091359
[132,]   12.0018179 10.634654   -8.6528458  32.6621913
[133,]   26.6576111  9.180512    8.6242750  44.8723658
[134,]   32.6058044  8.177506   16.5541068  48.6184868
[135,]   20.4616976  7.801621    4.9532324  35.6556875
[136,]   10.5213909  8.140198   -5.2848381  26.1940665
[137,]   -1.9095159  9.113958  -19.7656410  15.7871390
[138,]   -9.9323226 10.548436  -30.2790176  10.9584624
[139,]   -8.7531294 12.283266  -32.6037935  15.5537988
[140,]   -9.8808362 14.208857  -37.5086573  18.3756916
[141,]   17.3084433 12.244047   -6.6940821  41.7287556
[142,]    2.4605844 10.574045  -18.0493451  23.2643039
[143,]  -20.0951746  9.195530  -37.9941688  -1.8559904
[144,]  -11.0422335  8.255832  -26.9106026   5.5281416
[145,]   14.7621075  7.912862   -0.5901375  30.5364898
[146,]    5.7921486  8.241458  -10.3867014  22.2183041
[147,]  -24.6473104  9.169707  -42.7063790  -6.6654494
[148,]   13.9790307 10.540353   -6.5074535  34.6351997
[149,]   -5.2251283 12.205252  -29.0534684  18.5819164
[150,]    9.6467128 14.060262  -18.2706808  37.1525154
[151,]   -1.0352972 13.426689  -25.6604968  26.4162501
[152,]   -6.9938629 11.473629  -28.7521408  16.1055061
[153,]  -17.8346286  9.804835  -36.7097238   2.0239781
[154,]  -31.4804943  8.587657  -48.1318495 -14.4397022
[155,]  -19.6342600  8.030152  -35.2340650  -4.0369589
[156,]   41.8040743  8.266877   25.4041445  57.7553600
[157,]  -36.4595914  9.236969  -54.5462444 -18.4195715
[158,]   14.7597429 10.743574   -6.2301699  35.9061296
[159,]   17.1191771 12.595618   -7.2898707  41.4272486
[160,]    8.9669114 14.662784  -20.1142990  37.3180408
[161,]   17.7972762 12.489971   -6.8851304  42.0793944
[162,]   10.8151050 10.765442  -10.4270520  31.7906116
[163,]    6.7266339  9.319832  -11.3031186  25.0900573
[164,]    1.0726627  8.300176  -14.6591677  17.3785588
[165,]  -11.0909085  7.873736  -26.4072761   4.5339670
[166,]  -15.2939796  8.134351  -31.5222759   0.3500223
[167,]  -50.0847508  9.022680  -68.3642290 -32.9599988
[168,]  -14.2645219 10.378775  -35.3641845   5.2389892
[169,]   22.3410069 12.045677   -2.2088902  44.8645278
[170,]   31.4849357 13.912112    3.1590769  57.7967583
[171,]    6.0736652 12.317611  -18.3271747  31.0951896
[172,]   -1.6632277 10.612737  -22.7526793  19.7492087
[173,]   10.6603794  9.199859   -7.6790056  29.3082030
[174,]   11.8959865  8.230747   -4.4772370  28.4121901
[175,]  -23.3622063  7.871060  -38.5056030  -7.7165396
[176,]    7.2736008  8.201375   -8.6511531  23.2466225
[177,]    0.3486079  9.147245  -17.4020099  18.6191848
[178,]   -2.7124850 10.544298  -23.3713639  18.2700936
[179,]   11.4101222 12.238992  -13.0895797  35.9954528
[180,]   -5.4071707 14.124596  -33.0688575  22.6419941</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1770.1 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1326      
 (0.5, 0.7]   (ok)         2    1.1%   165       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.2
p_loo        33.6  8.3
looic      1721.6 44.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   849       
 (0.5, 0.7]   (ok)         1    0.6%   107       
   (0.7, 1]   (bad)        1    0.6%   46        
   (1, Inf)   (very bad)   1    0.6%   14        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.5  
fit_sleep1 -92.5      20.9  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.4
looic      1770.1 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1326      
 (0.5, 0.7]   (ok)         2    1.1%   165       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.2
p_loo        33.6  8.3
looic      1721.6 44.4
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   849       
 (0.5, 0.7]   (ok)         1    0.6%   107       
   (0.7, 1]   (bad)        1    0.6%   46        
   (1, Inf)   (very bad)   1    0.6%   14        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.8     22.2        33.6    8.3   1721.6
fit_sleep2  -24.3      11.5  -885.0     14.4        19.5    3.4   1770.1
fit_sleep1  -92.5      20.9  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   44.4  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.477538e-41 2.933502e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.96      1.56     0.46      5.5       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.04      1.56       -3     3.03       5.06      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a>
(archived at <a href="https://perma.cc/2WBN-E4S2"
class="uri">https://perma.cc/2WBN-E4S2</a>)</p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0.1       tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sIChhcmNoaXZlZCBhdCBodHRwczovL3Blcm1hLmNjLzJXQk4tRTRTMikKCiMgTWlzc2luZyBEYXRhIEhhbmRsaW5nCgojIyBNdWx0aXBseSBJbXB1dGVkIERhdGFzZXRzIGZyb20gYG1pY2VgCgpgYGB7cn0KP2JybV9tdWx0aXBsZQpgYGAKCiMjIE11bHRpcGxlIEltcHV0YXRpb24gb24gdGhlIEZseQoKYGBge3J9Cj9taQpgYGAKCiMgU2Vzc2lvbiBJbmZvCgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CnNlc3Npb25JbmZvKCkKYGBgCg==</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
