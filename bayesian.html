<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing
adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.99      6.82    15.54    42.14 1.00     1945     2651
sd(Days)                6.51      1.52     4.07    10.08 1.00     1263     2187
cor(Intercept,Days)     0.10      0.30    -0.46     0.68 1.00     1052     1473

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.11      7.13   236.63   265.14 1.00     1869     2575
Days         10.43      1.67     7.21    13.67 1.00     1388     1810

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.55    23.14    29.18 1.00     3815     3238

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.1956  13.14144 227.6856 279.2215
309 211.0715  13.20306 185.2195 236.8885
310 213.1049  13.69567 187.0341 239.0340
330 274.5032  13.30870 249.3092 301.1266
331 273.0885  12.68763 248.8263 298.7007
332 259.9478  12.19385 236.0063 284.2241
333 267.9282  12.36151 244.3886 292.6215
334 244.5193  12.42952 219.9848 268.5845
335 250.2699  13.60265 223.8274 276.8594
337 286.0209  13.28827 260.6889 311.5252
349 226.6437  13.23726 200.3114 251.7450
350 238.9160  13.15015 212.7130 264.6022
351 255.3868  12.45199 231.2465 280.2420
352 272.0263  12.69851 247.4935 298.0487
369 254.2031  12.09419 230.6454 277.8975
370 226.6609  13.53103 198.8493 252.0866
371 252.0607  12.13149 228.5271 276.1394
372 263.5404  12.46104 239.0061 288.0808

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.5374268  2.515926 14.74666578 24.614225
309  1.8078928  2.508285 -3.09887963  6.615578
310  4.9109976  2.555248 -0.09807032  9.826119
330  5.7993974  2.520906  0.69905634 10.551606
331  7.4839815  2.419418  2.60769599 12.152698
332 10.3101880  2.316874  5.73677201 14.851049
333 10.3264517  2.357841  5.69042152 14.945970
334 11.4762183  2.361595  6.78039818 16.102277
335 -0.1665974  2.652562 -5.35574899  5.017835
337 19.1533952  2.499035 14.29612402 24.032208
349 11.5010276  2.468121  6.70658038 16.401939
350 16.9559933  2.536550 12.11373931 22.014057
351  7.5207747  2.406321  2.62505270 12.105016
352 14.0803142  2.375376  9.44629416 18.666338
369 11.4179223  2.339986  6.85504041 16.042768
370 15.1242428  2.580513 10.19537486 20.285308
371  9.5031728  2.312784  4.77706342 13.880623
372 11.7867748  2.364920  6.96931947 16.367704</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.1956 13.141444 227.6856 279.2215
  [2,] 273.7331 11.243187 251.0616 294.9610
  [3,] 293.2705  9.632276 274.1878 311.6096
  [4,] 312.8079  8.474195 295.9609 329.1845
  [5,] 332.3453  7.968877 316.6093 347.6522
  [6,] 351.8828  8.237341 335.3853 367.5960
  [7,] 371.4202  9.212184 352.8939 389.1993
  [8,] 390.9576 10.702086 369.9513 411.5616
  [9,] 410.4950 12.524565 385.9105 435.4399
 [10,] 430.0325 14.555225 401.6879 458.8231
 [11,] 211.0715 13.203062 185.2195 236.8885
 [12,] 212.8794 11.318284 190.6181 234.9443
 [13,] 214.6873  9.719529 195.6357 233.7660
 [14,] 216.4952  8.568426 199.6834 233.2621
 [15,] 218.3031  8.059130 202.4590 234.2136
 [16,] 220.1110  8.310488 204.0378 236.6300
 [17,] 221.9189  9.260769 204.0201 240.3756
 [18,] 223.7268 10.725785 202.9569 244.7321
 [19,] 225.5347 12.526214 201.2456 249.7853
 [20,] 227.3426 14.537972 199.0211 255.1098
 [21,] 213.1049 13.695671 187.0341 239.0340
 [22,] 218.0159 11.759296 195.2991 240.2402
 [23,] 222.9269 10.101945 203.1324 242.2521
 [24,] 227.8379  8.881222 210.3763 245.2704
 [25,] 232.7489  8.292256 215.9817 249.1543
 [26,] 237.6599  8.467910 220.5988 254.1582
 [27,] 242.5709  9.365259 223.6960 260.8201
 [28,] 247.4819 10.805982 225.5538 268.6274
 [29,] 252.3929 12.605118 227.2215 277.4951
 [30,] 257.3039 14.631040 228.5295 286.4551
 [31,] 274.5032 13.308700 249.3092 301.1266
 [32,] 280.3026 11.362537 258.8728 303.0809
 [33,] 286.1020  9.685192 267.6681 305.3818
 [34,] 291.9014  8.438516 275.5610 308.3760
 [35,] 297.7008  7.830971 282.2112 313.1612
 [36,] 303.5002  8.009344 287.7208 318.9714
 [37,] 309.2996  8.926646 291.8564 326.8351
 [38,] 315.0990 10.388954 295.0662 335.4210
 [39,] 320.8984 12.201871 297.3563 344.6475
 [40,] 326.6978 14.232037 299.1927 354.4813
 [41,] 273.0885 12.687626 248.8263 298.7007
 [42,] 280.5725 10.884466 259.6618 302.2217
 [43,] 288.0565  9.363467 270.0258 306.3993
 [44,] 295.5405  8.281583 279.7361 312.1689
 [45,] 303.0244  7.823163 287.8134 318.6537
 [46,] 310.5084  8.094833 294.5697 326.2144
 [47,] 317.9924  9.030943 299.9968 335.6073
 [48,] 325.4764 10.454507 304.4953 345.8271
 [49,] 332.9604 12.196010 308.4414 356.4517
 [50,] 340.4443 14.138450 312.2130 367.7656
 [51,] 259.9478 12.193849 236.0063 284.2241
 [52,] 270.2580 10.545459 249.4613 290.8391
 [53,] 280.5682  9.190173 262.5627 298.1718
 [54,] 290.8784  8.273310 274.3931 307.0327
 [55,] 301.1886  7.948073 285.5082 316.8011
 [56,] 311.4988  8.284435 295.4185 327.7429
 [57,] 321.8090  9.210195 303.9360 340.0527
 [58,] 332.1192 10.571628 311.4935 352.7032
 [59,] 342.4294 12.224024 318.8159 366.0416
 [60,] 352.7395 14.065206 325.5013 380.1556
 [61,] 267.9282 12.361515 244.3886 292.6215
 [62,] 278.2546 10.607145 257.8716 299.3791
 [63,] 288.5811  9.128792 270.7750 306.9052
 [64,] 298.9076  8.079416 282.8831 314.9204
 [65,] 309.2340  7.637927 293.7868 324.2069
 [66,] 319.5605  7.906814 303.7788 334.8414
 [67,] 329.8869  8.821356 312.2091 347.0637
 [68,] 340.2134 10.209493 319.7505 359.6206
 [69,] 350.5398 11.906721 327.0782 373.2553
 [70,] 360.8663 13.799460 333.4921 387.4270
 [71,] 244.5193 12.429523 219.9848 268.5845
 [72,] 255.9955 10.723261 234.9742 277.1855
 [73,] 267.4717  9.307948 248.9656 285.6938
 [74,] 278.9479  8.333170 263.0389 295.4375
 [75,] 290.4242  7.962401 274.8453 306.2390
 [76,] 301.9004  8.277209 285.4609 317.9455
 [77,] 313.3766  9.207541 295.2019 330.9911
 [78,] 324.8528 10.592437 303.7718 345.2206
 [79,] 336.3290 12.279042 311.8667 359.8737
 [80,] 347.8053 14.159954 319.8990 374.5469
 [81,] 250.2699 13.602645 223.8274 276.8594
 [82,] 250.1033 11.582956 227.8062 273.0872
 [83,] 249.9367  9.867620 230.5868 269.8383
 [84,] 249.7701  8.639860 232.7782 266.9377
 [85,] 249.6035  8.123829 233.7049 265.5320
 [86,] 249.4369  8.450929 233.3168 266.3937
 [87,] 249.2703  9.534777 231.1488 268.3903
 [88,] 249.1037 11.156967 227.5273 271.4868
 [89,] 248.9371 13.119300 223.5137 274.9165
 [90,] 248.7705 15.291381 219.5139 278.9738
 [91,] 286.0209 13.288273 260.6889 311.5252
 [92,] 305.1743 11.407457 283.4826 326.9907
 [93,] 324.3276  9.806749 305.5573 343.3931
 [94,] 343.4810  8.643200 326.6614 360.6784
 [95,] 362.6344  8.107272 347.0532 378.7831
 [96,] 381.7878  8.321127 365.6107 398.4517
 [97,] 400.9412  9.232811 383.0315 419.4265
 [98,] 420.0946 10.664839 400.0456 441.8105
 [99,] 439.2480 12.438776 415.8255 465.0590
[100,] 458.4014 14.429062 431.2956 488.2122
[101,] 226.6437 13.237258 200.3114 251.7450
[102,] 238.1447 11.380219 215.2702 259.9134
[103,] 249.6457  9.796786 229.6739 268.7065
[104,] 261.1468  8.638743 243.5841 277.8677
[105,] 272.6478  8.090859 256.5841 288.4409
[106,] 284.1488  8.275225 267.9437 300.3229
[107,] 295.6498  9.147675 277.6606 313.7094
[108,] 307.1509 10.538682 286.7036 328.1374
[109,] 318.6519 12.273178 294.9516 342.6428
[110,] 330.1529 14.226076 302.8062 357.8394
[111,] 238.9160 13.150151 212.7130 264.6022
[112,] 255.8720 11.251945 233.0235 277.7974
[113,] 272.8280  9.651644 253.1000 291.8273
[114,] 289.7840  8.518825 272.8423 306.0968
[115,] 306.7400  8.053241 291.0226 321.9703
[116,] 323.6960  8.367029 307.5159 340.1976
[117,] 340.6519  9.382316 322.4191 359.0785
[118,] 357.6079 10.904893 336.7499 378.7997
[119,] 374.5639 12.754360 349.7205 399.2703
[120,] 391.5199 14.808744 362.7272 420.7516
[121,] 255.3868 12.451989 231.2465 280.2420
[122,] 262.9076 10.677331 241.8088 284.1186
[123,] 270.4283  9.194537 252.1193 288.5212
[124,] 277.9491  8.164214 261.4289 293.8232
[125,] 285.4699  7.768529 270.0257 299.8855
[126,] 292.9907  8.101016 276.4591 308.7079
[127,] 300.5114  9.082051 282.3319 318.4167
[128,] 308.0322 10.531932 287.1548 328.7169
[129,] 315.5530 12.285777 291.3255 339.5785
[130,] 323.0738 14.231648 295.0950 350.9076
[131,] 272.0263 12.698513 247.4935 298.0487
[132,] 286.1066 10.958810 264.7816 308.4149
[133,] 300.1869  9.498612 281.6786 319.4754
[134,] 314.2672  8.463839 297.7603 331.2247
[135,] 328.3475  8.020869 312.7251 344.1823
[136,] 342.4278  8.265405 326.5251 359.5048
[137,] 356.5081  9.142447 338.5605 374.8639
[138,] 370.5885 10.494597 350.0440 391.6512
[139,] 384.6688 12.164441 360.8433 408.8998
[140,] 398.7491 14.039071 371.0279 426.7805
[141,] 254.2031 12.094189 230.6454 277.8975
[142,] 265.6210 10.427633 245.6579 286.4181
[143,] 277.0389  9.063814 259.6696 294.9492
[144,] 288.4568  8.156040 272.6199 304.8509
[145,] 299.8748  7.863862 284.3653 315.9074
[146,] 311.2927  8.252922 294.5736 328.0667
[147,] 322.7106  9.237543 304.5006 341.5089
[148,] 334.1285 10.653861 312.9657 355.4926
[149,] 345.5464 12.354285 321.4152 369.8609
[150,] 356.9644 14.237382 329.1154 384.9368
[151,] 226.6609 13.531027 198.8493 252.0866
[152,] 241.7851 11.521271 218.5443 263.7384
[153,] 256.9093  9.783087 237.4848 275.4830
[154,] 272.0336  8.485046 255.2266 288.5113
[155,] 287.1578  7.848649 271.9196 302.6777
[156,] 302.2821  8.032726 286.9878 317.8649
[157,] 317.4063  8.987000 299.9097 334.8870
[158,] 332.5306 10.503606 312.3980 353.2218
[159,] 347.6548 12.377537 324.0721 371.8456
[160,] 362.7790 14.470631 335.3169 391.3023
[161,] 252.0607 12.131488 228.5271 276.1394
[162,] 261.5639 10.453095 241.0057 282.5155
[163,] 271.0671  9.058661 253.1945 288.7786
[164,] 280.5703  8.096260 264.8004 296.4187
[165,] 290.0734  7.729000 274.8315 305.1549
[166,] 299.5766  8.038868 283.8891 315.2284
[167,] 309.0798  8.955853 291.8298 326.4735
[168,] 318.5829 10.319358 298.1189 338.3139
[169,] 328.0861 11.977851 303.9909 350.8735
[170,] 337.5893 13.825579 309.8625 363.9449
[171,] 263.5404 12.461043 239.0061 288.0808
[172,] 275.3272 10.726160 254.3419 296.4915
[173,] 287.1140  9.274110 268.5892 305.2743
[174,] 298.9007  8.255508 282.6562 315.0087
[175,] 310.6875  7.841135 295.5094 325.8207
[176,] 322.4743  8.123982 306.8590 337.9275
[177,] 334.2611  9.038831 316.8279 351.4032
[178,] 346.0478 10.420534 325.7005 365.7202
[179,] 357.8346 12.110338 334.1984 380.9597
[180,] 369.6214 13.997097 341.9998 396.3583</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.6356234 13.141444  -29.6615414  21.8743677
  [2,]  -15.0283502 11.243187  -36.2562609   7.6430518
  [3,]  -42.4698770  9.632276  -60.8090200 -23.3872253
  [4,]    8.6318961  8.474195   -7.7446856  25.4789012
  [5,]   24.5065693  7.968877    9.1996805  40.2426460
  [6,]   62.8073425  8.237341   47.0940767  79.3047579
  [7,]   10.7836156  9.212184   -6.9954963  29.3099212
  [8,] -100.8090112 10.702086 -121.4129964 -79.8027485
  [9,]   20.0902620 12.524565   -4.8545640  44.6747879
 [10,]   36.3210351 14.555225    7.5304321  64.6655628
 [11,]   11.6623664 13.203062  -14.1545598  37.5144394
 [12,]   -7.6136264 11.318284  -29.6784992  14.6477499
 [13,]  -11.7095192  9.719529  -30.7882222   7.3421095
 [14,]  -11.7882120  8.568426  -28.5551312   5.0235994
 [15,]  -10.5870048  8.059130  -26.4975309   5.2570885
 [16,]   -4.1491977  8.310488  -20.6681542  11.9239977
 [17,]   -8.2885905  9.260769  -26.7453306   9.6101538
 [18,]   -5.9995833 10.725785  -27.0049018  14.7703304
 [19,]   -1.2389761 12.526214  -25.4895622  23.0500911
 [20,]    9.9716311 14.537972  -17.7956395  38.2930660
 [21,]  -14.0510145 13.695671  -39.9801185  12.0198431
 [22,]  -23.6837121 11.759296  -45.9079779  -0.9669242
 [23,]   11.3930903 10.101945   -7.9321281  31.1875852
 [24,]    5.0036927  8.881222  -12.4288162  22.4653416
 [25,]   -3.4415049  8.292256  -19.8469199  13.3256755
 [26,]  -17.2020026  8.467910  -33.7003473  -0.1409211
 [27,]   -7.1501002  9.365259  -25.3992868  11.7248167
 [28,]    8.2692022 10.805982  -12.8762817  30.1972650
 [29,]    8.6196046 12.605118  -16.4826309  33.7910388
 [30,]   -9.7885931 14.631040  -38.9398301  18.9858077
 [31,]   47.0394248 13.308700   20.4160146  72.2333843
 [32,]   20.0976274 11.362537   -2.6807496  41.5274279
 [33,]   -2.2454700  9.685192  -21.5252576  16.1883594
 [34,]   -6.7683674  8.438516  -23.2430478   9.5720291
 [35,]  -11.9034649  7.830971  -27.3638740   3.5861348
 [36,]   -5.9146623  8.009344  -21.3859178   9.8646682
 [37,]  -29.0599597  8.926646  -46.5955304 -11.6167609
 [38,]    3.1623429 10.388954  -17.1596833  23.1951086
 [39,]  -15.5488545 12.201871  -39.2980210   7.9932245
 [40,]   27.3509481 14.232037   -0.4325854  54.8560456
 [41,]   14.5193864 12.687626  -11.0927610  38.7816249
 [42,]    4.4275050 10.884466  -17.2216857  25.3381631
 [43,]   13.7641235  9.363467   -4.5786913  31.7947588
 [44,]   24.5748420  8.281583    7.9464292  40.3792109
 [45,]   13.2528606  7.823163   -2.3764135  28.4639123
 [46,]  -17.1897209  8.094833  -32.8956504  -1.2510047
 [47,]  -27.9174024  9.030943  -45.5322782  -9.9217851
 [48,]    9.3413162 10.454507  -11.0093845  30.3223931
 [49,]  -39.2134653 12.196010  -62.7048419 -14.6944700
 [50,]   31.1367532 14.138450    3.8155389  59.3681434
 [51,]  -25.0872462 12.193849  -49.3635056  -1.1457001
 [52,]  -27.4462342 10.545459  -48.0272729  -6.6495253
 [53,]   -7.6069222  9.190173  -25.2104768  10.3986249
 [54,]   18.8903898  8.273310    2.7361394  35.3756734
 [55,]   16.2743018  7.948073    0.6618241  31.9546954
 [56,]   -1.5011862  8.284435  -17.7452812  14.5791045
 [57,]  132.3529258  9.210195  114.1092095 150.2258872
 [58,]   14.7119377 10.571628   -5.8721172  35.3375915
 [59,]  -12.1290503 12.224024  -35.7412973  11.4843827
 [60,]  -98.8751383 14.065206 -126.2912002 -71.6369105
 [61,]   15.9142033 12.361515   -8.7790848  39.4537715
 [62,]   11.3003516 10.607145   -9.8240501  31.6833907
 [63,]  -11.8118001  9.128792  -30.1359289   5.9943412
 [64,]    0.9021482  8.079416  -15.1107152  16.9266230
 [65,]  -12.0630035  7.637927  -27.0359386   3.3842029
 [66,]   18.6060447  7.906814    3.3251457  34.3876983
 [67,]    2.1395930  8.821356  -15.0371750  19.8173761
 [68,]    8.6265413 10.209493  -10.7807057  29.0894324
 [69,]  -17.1798104 11.906721  -39.8953166   6.2818440
 [70,]    1.1765379 13.799460  -25.3841891  28.5507427
 [71,]   20.9538061 12.429523   -3.1113867  45.4882755
 [72,]   20.2056878 10.723261   -0.9843139  41.2270105
 [73,]  -24.1070306  9.307948  -42.3290853  -5.6008868
 [74,]  -24.2756489  8.333170  -40.7652002  -8.3666254
 [75,]  -11.3997672  7.962401  -27.2146317   4.1790770
 [76,]  -17.7091856  8.277209  -33.7542737  -1.2697194
 [77,]   -7.8518039  9.207541  -25.4663484  10.3228569
 [78,]    6.6700777 10.592437  -13.6977110  27.7510727
 [79,]   -0.5821406 12.279042  -24.1267670  23.8802281
 [80,]   29.4937411 14.159954    2.7521425  57.3999609
 [81,]   -8.6615969 13.602645  -35.2511242  17.7809338
 [82,]   23.8439005 11.582956    0.8600155  46.1410250
 [83,]    4.5539980  9.867620  -15.3476157  23.9038810
 [84,]   21.0319954  8.639860    3.8644301  38.0238708
 [85,]    1.8483928  8.123829  -14.0801098  17.7470417
 [86,]    5.1992903  8.450929  -11.7574788  21.3193511
 [87,]   -3.8180123  9.534777  -22.9380435  14.3035225
 [88,]  -13.7927149 11.156967  -36.1758337   7.7836576
 [89,]  -13.1830175 13.119300  -39.1623567  12.2403765
 [90,]  -11.5239200 15.291381  -41.7271961  17.7326645
 [91,]   26.3457418 13.288273    0.8414458  51.6776801
 [92,]    8.6315466 11.407457  -13.1849135  30.3231524
 [93,]  -32.7164485  9.806749  -51.7818699 -13.9460618
 [94,]    2.6411563  8.643200  -14.5562102  19.4608406
 [95,]    3.0979611  8.107272  -13.0507089  18.6791537
 [96,]   10.0506659  8.321127   -6.6131776  26.2278368
 [97,]    3.3188708  9.232811  -15.1663595  21.2285944
 [98,]   -3.4023244 10.664839  -25.1182041  16.6467261
 [99,]   16.6162804 12.438776   -9.1947069  40.0387920
[100,]    0.5152853 14.429062  -29.2954971  27.6211409
[101,]    9.4595160 13.237258  -15.6418432  35.7918289
[102,]   -7.8280116 11.380219  -29.5966558  15.0465466
[103,]  -10.7201392  9.796786  -29.7808660   9.2517004
[104,]   -6.2247668  8.638743  -22.9457470  11.3379319
[105,]  -21.9374944  8.090859  -37.7305550  -5.8737894
[106,]  -14.3744220  8.275225  -30.5485017   1.8307275
[107,]  -14.0850495  9.147675  -32.1446464   3.9042298
[108,]    0.9511229 10.538682  -20.0354006  21.3983595
[109,]   17.6286953 12.273178   -6.3621941  41.3290412
[110,]   21.4921677 14.226076   -6.1942647  48.8388625
[111,]   17.3808145 13.150151   -8.3053500  43.5838172
[112,]  -12.4176788 11.251945  -34.3431053  10.4308099
[113,]  -16.6233721  9.651644  -35.6227080   3.1045770
[114,]  -34.2568654  8.518825  -50.5697366 -17.3152201
[115,]  -37.8234588  8.053241  -53.0537631 -22.1061114
[116,]    6.0287479  8.367029  -10.4728725  22.2087565
[117,]   38.7925546  9.382316   20.3659782  57.0253968
[118,]    5.3104613 10.904893  -15.8812576  26.1684824
[119,]   19.9232680 12.754360   -4.7830509  44.7667070
[120,]   -2.4672253 14.808744  -31.6988853  26.3254956
[121,]   -4.8602920 12.451989  -29.7155286  19.2799793
[122,]   37.1500334 10.677331   15.9389709  58.2487661
[123,]   -0.5344413  9.194537  -18.6273067  17.7745936
[124,]    2.6399840  8.164214  -13.2341264  19.1601928
[125,]  -13.6424907  7.768529  -28.0581046   1.8017019
[126,]   11.6429346  8.101016   -4.0742617  28.1745261
[127,]  -12.7648401  9.082051  -30.6701334   5.4146656
[128,]  -41.4367147 10.531932  -62.1213540 -20.5593113
[129,]    5.9888106 12.285777  -18.0366515  30.2163477
[130,]   24.4917359 14.231648   -3.3421496  52.4704819
[131,]  -50.3491569 12.698513  -76.3716006 -25.8163875
[132,]   12.0873289 10.958810  -10.2209759  33.4122540
[133,]   26.6916147  9.498612    7.4030555  45.1998841
[134,]   32.5883005  8.463839   15.6307638  49.0952047
[135,]   20.3926864  8.020869    4.5579346  36.0151144
[136,]   10.4008722  8.265405   -6.6760939  26.3035807
[137,]   -2.0815420  9.142447  -20.4373307  15.8660967
[138,]  -10.1558562 10.494597  -31.2185520  10.3886445
[139,]   -9.0281704 12.164441  -33.2592486  14.7972523
[140,]  -10.2073846 14.039071  -38.2388247  17.5138236
[141,]   17.7204305 12.094189   -5.9739549  41.2780655
[142,]    2.8159082 10.427633  -17.9811874  22.7790117
[143,]  -19.7965141  9.063814  -37.7067870  -2.4271583
[144,]  -10.8002364  8.156040  -27.1942623   5.0366883
[145,]   14.9474414  7.863862   -1.0851676  30.4568792
[146,]    5.9208191  8.252922  -10.8532212  22.6399470
[147,]  -24.5753032  9.237543  -43.3736114  -6.3652554
[148,]   13.9943745 10.653861   -7.3696587  35.1571959
[149,]   -5.2664477 12.354285  -29.5808569  18.8647578
[150,]    9.5487300 14.237382  -18.4236734  37.3977031
[151,]   -1.3968600 13.531027  -26.8226487  26.4146726
[152,]   -7.2616028 11.521271  -29.2148891  15.9792478
[153,]  -18.0085456  9.783087  -36.5821699   1.4160277
[154,]  -31.5605883  8.485046  -48.0382618 -14.7535882
[155,]  -19.6205311  7.848649  -35.1403501  -4.3822953
[156,]   41.9116261  8.032726   26.3287899  57.2059163
[157,]  -36.2582167  8.987000  -53.7389146 -18.7616079
[158,]   15.0549405 10.503606   -5.6363132  35.1875296
[159,]   17.5081977 12.377537   -6.6825796  41.0908552
[160,]    9.4497549 14.470631  -19.0734961  36.9118932
[161,]   17.8196675 12.131488   -6.2589619  41.3532759
[162,]   10.8788947 10.453095  -10.0727240  31.4370527
[163,]    6.8318219  9.058661  -10.8796855  24.7044480
[164,]    1.2192491  8.096260  -14.6291668  16.9891208
[165,]  -10.9029237  7.729000  -25.9844076   4.3390070
[166,]  -15.0645965  8.038868  -30.7164432   0.6228591
[167,]  -49.8139693  8.955853  -67.2076727 -32.5640371
[168,]  -13.9523421 10.319358  -33.6832704   6.5116926
[169,]   22.6945851 11.977851   -0.0927824  46.7897711
[170,]   31.8799123 13.825579    5.5242939  59.6067128
[171,]    5.8712822 12.461043  -18.6690797  30.4056213
[172,]   -1.8531926 10.726160  -23.0175088  19.1320649
[173,]   10.4828325  9.274110   -7.6775292  29.0075908
[174,]   11.7308577  8.255508   -4.3770779  27.9753803
[175,]  -23.5149172  7.841135  -38.6480894  -8.3367958
[176,]    7.1333080  8.123982   -8.3199395  22.7486058
[177,]    0.2207331  9.038831  -16.9214091  17.6538728
[178,]   -2.8279417 10.420534  -22.5002574  17.5194252
[179,]   11.3070834 12.110338  -11.8179946  34.9433258
[180,]   -5.4977914 13.997097  -32.2347304  22.1238358</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.5
p_loo        19.6  3.6
looic      1770.2 29.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   535       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   90        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.5
p_loo        34.3  8.6
looic      1723.2 45.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   894       
 (0.5, 0.7]   (ok)         6    3.3%   496       
   (0.7, 1]   (bad)        1    0.6%   60        
   (1, Inf)   (very bad)   2    1.1%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.5      11.6  
fit_sleep1 -91.7      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep2&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.

Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.5
p_loo        19.6  3.6
looic      1770.2 29.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   535       
 (0.5, 0.7]   (ok)         0    0.0%   &lt;NA&gt;      
   (0.7, 1]   (bad)        1    0.6%   90        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.6 22.5
p_loo        34.3  8.6
looic      1723.2 45.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   894       
 (0.5, 0.7]   (ok)         6    3.3%   496       
   (0.7, 1]   (bad)        1    0.6%   60        
   (1, Inf)   (very bad)   2    1.1%   7         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.6     22.5        34.3    8.6   1723.2
fit_sleep2  -23.5      11.6  -885.1     14.5        19.6    3.6   1770.2
fit_sleep1  -91.7      21.1  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   45.0  
fit_sleep2   29.0  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code> fit_sleep1  fit_sleep2  fit_sleep3 
1.55733e-40 6.36120e-11 1.00000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.89      1.51     0.37     5.34       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.11      1.51    -3.16     2.81       5.34      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.22 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_0.63.0   compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.21      
 [22] markdown_1.6         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.4      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.42           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.2         tidyselect_1.2.0    
 [46] abind_1.4-5          yaml_2.3.7           codetools_0.2-19    
 [49] miniUI_0.1.1.1       curl_5.0.0           processx_3.8.1      
 [52] pkgbuild_1.4.0       lattice_0.21-8       tibble_3.2.1        
 [55] plyr_1.8.8           shiny_1.7.4          withr_2.5.0         
 [58] bridgesampling_1.1-2 posterior_1.4.1      coda_0.19-4         
 [61] evaluate_0.21        RcppParallel_5.1.7   xts_0.13.1          
 [64] pillar_1.9.0         tensorA_0.36.2       checkmate_2.2.0     
 [67] DT_0.27              stats4_4.3.0         shinyjs_2.1.0       
 [70] distributional_0.3.2 generics_0.1.3       ggplot2_3.4.2       
 [73] rstantools_2.3.1     munsell_0.5.0        scales_1.2.1        
 [76] minqa_1.2.5          gtools_3.9.4         xtable_1.8-4        
 [79] glue_1.6.2           tools_4.3.0          shinystan_2.6.0     
 [82] colourpicker_1.2.0   mvtnorm_1.1-3        grid_4.3.0          
 [85] crosstalk_1.2.0      colorspace_2.1-0     nlme_3.1-162        
 [88] cli_3.6.1            fansi_1.0.4          Brobdingnag_1.2-9   
 [91] dplyr_1.1.2          V8_4.3.0             gtable_0.3.3        
 [94] sass_0.4.6           digest_0.6.31        htmlwidgets_1.6.2   
 [97] farver_2.1.1         htmltools_0.5.5      lifecycle_1.0.3     
[100] mime_0.12            shinythemes_1.2.0    MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
