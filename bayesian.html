<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.19      7.05    15.89    43.82 1.00     2075     2613
sd(Days)                6.56      1.47     4.19     9.85 1.00     1765     2370
cor(Intercept,Days)     0.09      0.30    -0.49     0.66 1.00     1093     1752

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.08      7.59   236.07   266.47 1.00     1816     2377
Days         10.40      1.70     7.03    13.71 1.00     1512     1838

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.89      1.51    23.13    29.07 1.00     3030     2734

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9251  12.79798 227.8866 278.7594
309 211.2931  13.59544 183.8728 238.6733
310 212.9193  13.28478 185.7718 237.8635
330 274.4406  13.37995 249.2030 301.0014
331 273.0498  13.00700 248.9400 299.3837
332 260.0541  12.15514 235.8963 284.1529
333 267.8926  12.41958 244.2345 292.9032
334 244.4071  12.32545 219.6939 268.4510
335 250.7434  13.18044 226.1745 276.5250
337 286.2220  13.09108 260.8665 312.4642
349 226.5981  12.82987 200.9178 250.5750
350 238.5291  13.27688 211.1510 263.2066
351 255.7411  12.33750 231.0206 280.1805
352 271.9790  12.38580 248.0547 297.7019
369 254.4022  12.19576 230.5143 278.8984
370 226.1544  13.55639 198.7641 251.4983
371 252.2400  12.44933 228.1737 277.1178
372 263.6779  12.52264 239.4384 289.2724

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6441583  2.439090 15.0276608 24.543970
309  1.7690068  2.553726 -3.2407270  6.868890
310  4.9328500  2.481702  0.1965643  9.992141
330  5.7347390  2.503256  0.7543733 10.667596
331  7.4681739  2.444590  2.7275082 12.165488
332 10.2313038  2.288473  5.6567234 14.773455
333 10.2507341  2.313781  5.5469789 14.634208
334 11.4758003  2.360877  6.9274491 16.375667
335 -0.2430901  2.542115 -5.2897276  4.746519
337 19.0994949  2.492932 14.2053370 23.996104
349 11.5483745  2.438583  6.9317927 16.413574
350 17.0533073  2.537610 12.1568261 22.028363
351  7.5101833  2.335480  2.8785106 12.025302
352 14.0280789  2.332458  9.4762507 18.570794
369 11.3558789  2.354373  6.6695539 15.872829
370 15.2075288  2.525085 10.3275058 20.304509
371  9.4806301  2.362826  4.8288718 14.072059
372 11.7933364  2.385525  6.9958430 16.260101</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9251 12.797979 227.8866 278.7594
  [2,] 273.5692 10.975458 251.0068 294.6193
  [3,] 293.2134  9.435646 274.1056 311.1900
  [4,] 312.8575  8.336693 296.2997 328.8320
  [5,] 332.5017  7.865611 317.1539 347.9843
  [6,] 352.1458  8.132252 336.3864 368.1039
  [7,] 371.7900  9.071800 354.1593 390.0940
  [8,] 391.4342 10.505232 371.1059 412.3472
  [9,] 411.0783 12.260529 387.1994 435.3845
 [10,] 430.7225 14.218986 403.1660 458.8241
 [11,] 211.2931 13.595436 183.8728 238.6733
 [12,] 213.0621 11.659764 190.2924 236.6112
 [13,] 214.8311 10.005366 195.5676 234.8650
 [14,] 216.6001  8.792476 199.9064 234.1917
 [15,] 218.3691  8.218938 202.5960 234.6540
 [16,] 220.1381  8.416490 204.2649 236.6792
 [17,] 221.9071  9.336311 204.1131 240.1841
 [18,] 223.6761 10.795329 202.9332 244.7876
 [19,] 225.4451 12.607719 200.9215 250.0401
 [20,] 227.2141 14.642851 198.5420 255.8188
 [21,] 212.9193 13.284778 185.7718 237.8635
 [22,] 217.8522 11.409290 194.6784 239.4692
 [23,] 222.7850  9.806946 202.9248 241.6275
 [24,] 227.7179  8.631232 210.5294 244.6568
 [25,] 232.6507  8.070802 216.4518 248.0717
 [26,] 237.5836  8.251982 220.8549 253.4731
 [27,] 242.5164  9.130732 223.9444 260.3533
 [28,] 247.4493 10.533898 226.5916 268.2013
 [29,] 252.3821 12.283056 228.0472 276.4890
 [30,] 257.3150 14.251372 229.1882 285.5184
 [31,] 274.4406 13.379945 249.2030 301.0014
 [32,] 280.1753 11.497580 258.7046 303.0913
 [33,] 285.9101  9.894359 267.2668 305.6267
 [34,] 291.6448  8.725532 275.0498 309.0142
 [35,] 297.3795  8.179490 281.6944 313.3809
 [36,] 303.1143  8.378888 286.5123 319.4757
 [37,] 308.8490  9.275779 290.5197 326.9375
 [38,] 314.5837 10.696118 293.4400 335.4554
 [39,] 320.3185 12.462198 295.5598 344.6729
 [40,] 326.0532 14.447782 297.4880 354.3665
 [41,] 273.0498 13.006995 248.9400 299.3837
 [42,] 280.5179 11.146009 259.6760 303.1134
 [43,] 287.9861  9.551815 269.9730 307.5254
 [44,] 295.4543  8.378118 279.3604 312.6409
 [45,] 302.9225  7.816687 287.8086 318.3763
 [46,] 310.3906  7.997522 295.0214 326.1203
 [47,] 317.8588  8.875370 300.3672 335.1919
 [48,] 325.3270 10.273074 304.8160 345.0820
 [49,] 332.7951 12.010494 309.4815 356.4066
 [50,] 340.2633 13.961373 312.9831 367.8553
 [51,] 260.0541 12.155139 235.8963 284.1529
 [52,] 270.2854 10.498772 249.6526 290.8341
 [53,] 280.5167  9.120047 262.6230 297.9221
 [54,] 290.7480  8.160913 274.6845 306.2138
 [55,] 300.9793  7.778173 285.6358 316.0376
 [56,] 311.2106  8.054418 295.2124 327.1903
 [57,] 321.4419  8.928693 303.8972 339.3265
 [58,] 331.6732 10.249081 311.5394 352.6343
 [59,] 341.9045 11.867603 318.4785 365.9561
 [60,] 352.1358 13.678836 325.4177 379.6417
 [61,] 267.8926 12.419576 244.2345 292.9032
 [62,] 278.1433 10.697251 257.5111 299.7310
 [63,] 288.3940  9.237082 270.6536 307.0150
 [64,] 298.6448  8.180669 282.8415 315.1144
 [65,] 308.8955  7.696114 293.9875 324.2147
 [66,] 319.1462  7.889497 303.8223 335.0364
 [67,] 329.3970  8.715809 312.4004 346.9928
 [68,] 339.6477 10.019664 320.1018 359.1997
 [69,] 349.8984 11.641699 327.3599 372.1027
 [70,] 360.1492 13.467436 334.1929 386.2728
 [71,] 244.4071 12.325447 219.6939 268.4510
 [72,] 255.8829 10.599154 235.0290 276.5465
 [73,] 267.3587  9.160512 250.1924 285.5220
 [74,] 278.8345  8.163048 263.5056 294.8648
 [75,] 290.3103  7.778382 275.4383 305.9235
 [76,] 301.7861  8.094355 286.0750 317.8122
 [77,] 313.2619  9.037778 295.5640 330.7663
 [78,] 324.7377 10.439911 304.2872 345.3917
 [79,] 336.2135 12.142881 312.4697 360.1180
 [80,] 347.6893 14.037622 320.5481 376.0469
 [81,] 250.7434 13.180435 226.1745 276.5250
 [82,] 250.5003 11.267767 229.3589 272.5185
 [83,] 250.2572  9.650180 232.1066 269.0770
 [84,] 250.0141  8.497885 233.8063 266.5926
 [85,] 249.7711  8.014165 234.2552 265.4676
 [86,] 249.5280  8.316508 232.9394 265.8238
 [87,] 249.2849  9.328798 230.7779 267.4051
 [88,] 249.0418 10.854185 227.6552 270.5775
 [89,] 248.7987 12.709244 223.9448 273.8154
 [90,] 248.5556 14.770278 219.9040 277.5541
 [91,] 286.2220 13.091077 260.8665 312.4642
 [92,] 305.3215 11.218357 283.3524 327.6776
 [93,] 324.4210  9.631001 305.4318 343.7309
 [94,] 343.5205  8.490598 327.1230 360.6116
 [95,] 362.6200  7.990854 347.2028 378.5308
 [96,] 381.7195  8.249040 365.9442 398.4357
 [97,] 400.8190  9.201576 383.1853 419.1033
 [98,] 419.9185 10.663994 399.2572 441.1305
 [99,] 439.0180 12.458007 414.7715 463.9615
[100,] 458.1175 14.460725 429.9084 486.7935
[101,] 226.5981 12.829872 200.9178 250.5750
[102,] 238.1465 11.003332 216.1585 258.8295
[103,] 249.6948  9.456975 230.9659 267.5676
[104,] 261.2432  8.347984 244.6288 277.1207
[105,] 272.7916  7.863628 257.2389 287.8944
[106,] 284.3400  8.116517 268.4896 300.4823
[107,] 295.8883  9.045022 278.2644 313.7517
[108,] 307.4367 10.470929 287.3080 328.1702
[109,] 318.9851 12.221362 295.6220 343.3944
[110,] 330.5335 14.176613 303.2574 358.6034
[111,] 238.5291 13.276880 211.1510 263.2066
[112,] 255.5824 11.335600 232.1976 276.5236
[113,] 272.6357  9.674454 252.6527 290.9171
[114,] 289.6890  8.460096 272.4616 305.7774
[115,] 306.7423  7.901285 291.0740 321.9126
[116,] 323.7956  8.134268 307.6322 340.1435
[117,] 340.8490  9.098420 322.9081 358.8065
[118,] 357.9023 10.595995 336.7256 378.3522
[119,] 374.9556 12.435751 350.4934 398.8667
[120,] 392.0089 14.487913 363.8910 420.0563
[121,] 255.7411 12.337503 231.0206 280.1805
[122,] 263.2513 10.643524 242.1817 284.7311
[123,] 270.7614  9.233860 252.7379 289.3785
[124,] 278.2716  8.255463 262.1076 294.7509
[125,] 285.7818  7.870839 270.5847 301.5513
[126,] 293.2920  8.164341 277.8266 309.5655
[127,] 300.8022  9.070378 283.0993 319.1451
[128,] 308.3124 10.430532 287.9702 329.3056
[129,] 315.8225 12.092525 291.5333 339.5840
[130,] 323.3327 13.948881 295.4080 349.9775
[131,] 271.9790 12.385802 248.0547 297.7019
[132,] 286.0071 10.692952 265.3453 308.3196
[133,] 300.0351  9.281760 282.1158 318.9413
[134,] 314.0632  8.297206 297.8415 330.3396
[135,] 328.0913  7.900437 312.3028 343.6693
[136,] 342.1194  8.177463 325.6388 357.6197
[137,] 356.1474  9.066731 338.2630 373.6979
[138,] 370.1755 10.412542 349.8394 390.2043
[139,] 384.2036 12.063050 360.4308 407.7275
[140,] 398.2317 13.910213 371.2603 425.2641
[141,] 254.4022 12.195762 230.5143 278.8984
[142,] 265.7581 10.511906 245.1091 286.5532
[143,] 277.1140  9.129616 259.3355 295.2360
[144,] 288.4698  8.202789 272.6659 304.6034
[145,] 299.8257  7.893526 284.7867 315.4411
[146,] 311.1816  8.271391 295.4385 327.4538
[147,] 322.5375  9.252579 304.5536 340.8148
[148,] 333.8933 10.671957 312.7222 354.7591
[149,] 345.2492 12.379712 320.5912 369.3422
[150,] 356.6051 14.272702 328.6264 384.1792
[151,] 226.1544 13.556387 198.7641 251.4983
[152,] 241.3620 11.606348 218.1312 263.1241
[153,] 256.5695  9.919229 236.4671 275.2865
[154,] 271.7770  8.650261 254.3512 288.0677
[155,] 286.9845  8.000939 270.9747 302.5415
[156,] 302.1921  8.121277 285.9921 318.4558
[157,] 317.3996  8.980388 299.5903 335.4799
[158,] 332.6071 10.396716 312.1947 352.7732
[159,] 347.8147 12.177362 323.6286 370.9667
[160,] 363.0222 14.185792 334.4313 390.0129
[161,] 252.2400 12.449330 228.1737 277.1178
[162,] 261.7207 10.685690 241.0445 283.1626
[163,] 271.2013  9.194999 253.4441 289.4016
[164,] 280.6819  8.128835 264.5945 296.9574
[165,] 290.1625  7.666406 275.4978 305.1536
[166,] 299.6432  7.914260 284.2538 315.4722
[167,] 309.1238  8.812668 291.9739 326.6209
[168,] 318.6044 10.191007 298.5035 338.7573
[169,] 328.0851 11.883435 304.5509 351.8361
[170,] 337.5657 13.774662 310.2402 365.4803
[171,] 263.6779 12.522641 239.4384 289.2724
[172,] 275.4712 10.753645 254.5658 296.8542
[173,] 287.2646  9.265348 269.3182 305.7229
[174,] 299.0579  8.211816 282.9867 315.1561
[175,] 310.8512  7.771913 295.8267 326.0105
[176,] 322.6446  8.046912 307.0114 338.2273
[177,] 334.4379  8.971311 316.8475 351.6429
[178,] 346.2312 10.372921 325.8843 366.0841
[179,] 358.0246 12.086853 334.6721 381.1957
[180,] 369.8179 13.998857 342.6256 396.4343</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.36505525 12.797979  -29.19937010  21.6734265
  [2,]  -14.86451355 10.975458  -35.91455527   7.6978850
  [3,]  -42.41277185  9.435646  -60.38938461 -23.3050406
  [4,]    8.58226985  8.336693   -7.39217222  25.1401099
  [5,]   24.35021155  7.865611    8.86759246  39.6979640
  [6,]   62.54425325  8.132252   46.58619777  78.3037082
  [7,]   10.41379495  9.071800   -7.89016044  28.0444924
  [8,] -101.28556335 10.505232 -122.19856900 -80.9572572
  [9,]   19.50697835 12.260529   -4.79915651  43.3858920
 [10,]   35.63102005 14.218986    7.52937954  63.1875137
 [11,]   11.44083564 13.595436  -15.93937543  38.8611101
 [12,]   -7.79627113 11.659764  -31.34537632  14.9734481
 [13,]  -11.85327791 10.005366  -31.88717292   7.4102166
 [14,]  -11.89308468  8.792476  -29.48470391   4.8005773
 [15,]  -10.65299146  8.218938  -26.93793400   5.1201186
 [16,]   -4.17629823  8.416490  -20.71739369  11.6969105
 [17,]   -8.27680500  9.336311  -26.55380104   9.5172125
 [18,]   -5.94891178 10.795329  -27.06044709  14.7940423
 [19,]   -1.14941855 12.607719  -25.74435728  23.3741623
 [20,]   10.10007467 14.642851  -18.50461232  38.7722214
 [21,]  -13.86540926 13.284778  -38.80963123  13.2821306
 [22,]  -23.51995931 11.409290  -45.13699175  -0.3461793
 [23,]   11.53499064  9.806946   -7.30750043  31.3951912
 [24,]    5.12374059  8.631232  -11.81522904  22.3122291
 [25,]   -3.34330946  8.070802  -18.76431497  12.8555699
 [26,]  -17.12565951  8.251982  -33.01523958  -0.3970005
 [27,]   -7.09560956  9.130732  -24.93254784  11.4763996
 [28,]    8.30184039 10.533898  -12.45016549  29.1595255
 [29,]    8.63039034 12.283056  -15.47647790  32.9652562
 [30,]   -9.79965971 14.251372  -38.00310225  18.3270940
 [31,]   47.10202701 13.379945   20.54115022  72.3396334
 [32,]   20.22488799 11.497580   -2.69107115  41.6956380
 [33,]   -2.05355103  9.894359  -21.77024315  16.5896990
 [34,]   -6.51179005  8.725532  -23.88119963  10.0831554
 [35,]  -11.58222907  8.179490  -27.58356636   4.1029186
 [36,]   -5.52876809  8.378888  -21.89023882  11.0732257
 [37,]  -28.60940712  9.275779  -46.69788891 -10.2801391
 [38,]    3.67755386 10.696118  -17.19407214  24.8212553
 [39,]  -14.96898516 12.462198  -39.32344538   9.7897043
 [40,]   27.99547582 14.447782   -0.31777318  56.5606547
 [41,]   14.55814239 13.006995  -11.77576520  38.6678775
 [42,]    4.48206854 11.146009  -18.11342841  25.3239632
 [43,]   13.83449469  9.551815   -5.70481600  31.8475927
 [44,]   24.66102084  8.378118    7.47442256  40.7549333
 [45,]   13.35484699  7.816687   -2.09896663  28.4686813
 [46,]  -17.07192686  7.997522  -32.80157029  -1.7027143
 [47,]  -27.78380071  8.875370  -45.11691138 -10.2921796
 [48,]    9.49072544 10.273074  -10.26425348  30.0016959
 [49,]  -39.04824841 12.010494  -62.65965025 -15.7346205
 [50,]   31.31777774 13.961373    3.72579498  58.5979764
 [51,]  -25.19345697 12.155139  -49.29227218  -1.0357059
 [52,]  -27.47356078 10.498772  -48.02232841  -6.8408050
 [53,]   -7.55536459  9.120047  -24.96080030  10.3382987
 [54,]   19.02083160  8.160913    3.55499312  35.0843361
 [55,]   16.48362778  7.778173    1.42526033  31.8271339
 [56,]   -1.21297603  8.054418  -17.19271927  14.7852040
 [57,]  132.72002016  8.928693  114.83539575 150.2647290
 [58,]   15.15791635 10.249081   -5.80315164  35.2916904
 [59,]  -11.60418746 11.867603  -35.65583919  11.8218402
 [60,]  -98.27139128 13.678836 -125.77734842 -71.5532619
 [61,]   15.94982632 12.419576   -9.06083105  39.6079475
 [62,]   11.41169224 10.697251  -10.17604912  32.0438519
 [63,]  -11.62474185  9.237082  -30.24565737   6.1156871
 [64,]    1.16492407  8.180669  -15.30472313  16.9682222
 [65,]  -11.72451002  7.696114  -27.04365645   3.1834912
 [66,]   19.02025590  7.889497    3.13006608  34.3442177
 [67,]    2.62952181  8.715809  -14.96628879  19.6261264
 [68,]    9.19218773 10.019664  -10.35982518  28.7381293
 [69,]  -16.53844636 11.641699  -38.74267592   6.0001187
 [70,]    1.89361956 13.467436  -24.23002096  27.8498630
 [71,]   21.06600672 12.325447   -2.97790410  45.7792347
 [72,]   20.31830639 10.599154   -0.34528441  41.1721993
 [73,]  -23.99399394  9.160512  -42.15730536  -6.8277018
 [74,]  -24.16219427  8.163048  -40.19253027  -8.8332825
 [75,]  -11.28589460  7.778382  -26.89909012   3.5861394
 [76,]  -17.59489493  8.094355  -33.62099858  -1.8837636
 [77,]   -7.73709526  9.037778  -25.24154921   9.9608065
 [78,]    6.78520441 10.439911  -13.86879587  27.2356689
 [79,]   -0.46659592 12.142881  -24.37109491  23.2771545
 [80,]   29.60970374 14.037622    1.25208343  56.7508871
 [81,]   -9.13511084 13.180435  -34.91665653  15.4338318
 [82,]   23.44687923 11.267767    1.42866984  44.5883306
 [83,]    4.23346929  9.650180  -14.58630187  22.3840643
 [84,]   20.78795936  8.497885    4.20946986  36.9957774
 [85,]    1.68084943  8.014165  -14.01574501  17.1967284
 [86,]    5.10823949  8.316508  -11.18760264  21.6968102
 [87,]   -3.83257044  9.328798  -21.95278463  14.6744086
 [88,]  -13.73078037 10.854185  -35.26653570   7.6558160
 [89,]  -13.04459030 12.709244  -38.06130527  11.8092943
 [90,]  -11.30900024 14.770278  -40.30745804  17.3425513
 [91,]   26.14457238 13.091077   -0.09755748  51.5001369
 [92,]    8.48427749 11.218357  -13.87182019  30.4534158
 [93,]  -32.80981740  9.631001  -52.11969343 -13.8206403
 [94,]    2.60168771  8.490598  -14.48937587  18.9991850
 [95,]    3.11239282  7.990854  -12.79843041  18.5295958
 [96,]   10.11899793  8.249040   -6.59718093  25.8942918
 [97,]    3.44110304  9.201576  -14.84321497  21.0747765
 [98,]   -3.22619185 10.663994  -24.43819151  17.4351299
 [99,]   16.84631326 12.458007   -8.09717323  41.0927763
[100,]    0.79921837 14.460725  -27.87683146  29.0083307
[101,]    9.50511834 12.829872  -14.47181864  35.1854284
[102,]   -7.82975618 11.003332  -28.51277829  14.1582345
[103,]  -10.76923070  9.456975  -28.64198577   7.9597153
[104,]   -6.32120522  8.347984  -22.19869593  10.2932015
[105,]  -22.08127974  7.863628  -37.18407810  -6.5286087
[106,]  -14.56555426  8.116517  -30.70787732   1.2847711
[107,]  -14.32352877  9.045022  -32.18685883   3.3003861
[108,]    0.66529671 10.470929  -20.06816617  20.7940229
[109,]   17.29552219 12.221362   -7.11382966  40.6586019
[110,]   21.11164767 14.176613   -6.95826252  48.3876694
[111,]   17.76769267 13.276880   -6.90980559  45.1458423
[112,]  -12.12811462 11.335600  -33.06926850  11.2567247
[113,]  -16.43112192  9.674454  -34.71248829   3.5518811
[114,]  -34.16192922  8.460096  -50.25027446 -16.9345245
[115,]  -37.82583652  7.901285  -52.99609156 -22.1575363
[116,]    5.92905618  8.134268  -10.41880568  22.0925473
[117,]   38.59554888  9.098420   20.63800312  56.5364196
[118,]    5.01614158 10.595995  -15.43382311  26.1928247
[119,]   19.53163429 12.435751   -4.37945280  43.9937602
[120,]   -2.95617301 14.487913  -31.00356888  25.1617058
[121,]   -5.21457653 12.337503  -29.65396667  19.5058834
[122,]   36.80634013 10.643524   15.32648511  57.8758885
[123,]   -0.86754320  9.233860  -19.48463191  17.1559818
[124,]    2.31747347  8.255463  -14.16182112  18.4814896
[125,]  -13.95440987  7.870839  -29.72386641   1.2426959
[126,]   11.34160680  8.164341   -4.93185213  26.8069863
[127,]  -13.05557654  9.070378  -31.39848334   4.6473293
[128,]  -41.71685987 10.430532  -62.71008947 -21.3747439
[129,]    5.71925679 12.092525  -18.04217101  30.0085437
[130,]   24.23277346 13.948881   -2.41201978  52.1575165
[131,]  -50.30187176 12.385802  -76.02477312 -26.3775947
[132,]   12.18684935 10.692952  -10.12566458  32.8486235
[133,]   26.84337046  9.281760    7.93719651  44.7627128
[134,]   32.79229158  8.297206   16.51593416  49.0139587
[135,]   20.64891269  7.900437    5.07093263  36.4374115
[136,]   10.70933381  8.177463   -4.79103640  27.1898690
[137,]   -1.72084508  9.066731  -19.27126780  16.1635856
[138,]   -9.74292397 10.412542  -29.77173961  10.5932218
[139,]   -8.56300285 12.063050  -32.08690947  15.2097719
[140,]   -9.68998174 13.910213  -36.72235959  17.2814233
[141,]   17.52130397 12.195762   -6.97490830  41.4091582
[142,]    2.67882506 10.511906  -18.11625599  23.3277950
[143,]  -19.87155385  9.129616  -37.99359230  -2.0931410
[144,]  -10.81323276  8.202789  -26.94676620   4.9907038
[145,]   14.99648833  7.893526   -0.61891384  30.0354730
[146,]    6.03190942  8.271391  -10.24032191  21.7750010
[147,]  -24.40216949  9.252579  -42.67948158  -6.4182943
[148,]   14.22955160 10.671957   -6.63623256  35.4006647
[149,]   -4.96922732 12.379712  -29.06215072  19.6888495
[150,]    9.90799377 14.272702  -17.66611437  37.8866744
[151,]   -0.89043265 13.556387  -26.23427730  26.4999381
[152,]   -6.83846145 11.606348  -28.60055796  16.3923005
[153,]  -17.66869024  9.919229  -36.38574261   2.4337468
[154,]  -31.30401904  8.650261  -47.59467381 -13.8782008
[155,]  -19.44724783  8.000939  -35.00424775  -3.4374347
[156,]   42.00162337  8.121277   25.73785455  58.2016186
[157,]  -36.25150542  8.980388  -54.33175556 -18.4422202
[158,]   14.97836578 10.396716   -5.18774384  35.3907878
[159,]   17.34833699 12.177362   -5.80373235  41.5344478
[160,]    9.20660819 14.185792  -17.78406243  37.7974896
[161,]   17.64037763 12.449330   -7.23737892  41.7066925
[162,]   10.72214752 10.685690  -10.71975311  31.3982725
[163,]    6.69761740  9.194999  -11.50272629  24.4548179
[164,]    1.10758728  8.128835  -15.16791704  17.1950038
[165,]  -10.99204283  7.666406  -25.98310419   3.6726951
[166,]  -15.13117295  7.914260  -30.96022519   0.2581739
[167,]  -49.85800307  8.812668  -67.35511830 -32.7080680
[168,]  -13.97383318 10.191007  -34.12672353   6.1270890
[169,]   22.69563670 11.883435   -1.05535624  46.2298453
[170,]   31.90350658 13.774662    3.98888846  59.2290089
[171,]    5.73380754 12.522641  -19.86073927  29.9733239
[172,]   -1.99722882 10.753645  -23.38015933  18.9081975
[173,]   10.33223481  9.265348   -8.12614192  28.2785802
[174,]   11.57369845  8.211816   -4.52448497  27.6449439
[175,]  -23.67863791  7.771913  -38.83787021  -8.6541407
[176,]    6.96302573  8.046912   -8.61967830  22.5962068
[177,]    0.04388937  8.971311  -17.16107693  17.6342642
[178,]   -3.01134699 10.372921  -22.86420119  17.3356118
[179,]   11.11711664 12.086853  -12.05399658  34.4695911
[180,]   -5.69431972 13.998857  -32.31066755  21.4979960</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.3
p_loo        19.5  3.3
looic      1770.1 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   494       
 (0.5, 0.7]   (ok)         1    0.6%   117       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.5
p_loo        33.6  8.4
looic      1721.5 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   775       
 (0.5, 0.7]   (ok)         5    2.8%   1273      
   (0.7, 1]   (bad)        3    1.7%   18        
   (1, Inf)   (very bad)   1    0.6%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.3      11.8  
fit_sleep1 -92.5      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.3
p_loo        19.5  3.3
looic      1770.1 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   494       
 (0.5, 0.7]   (ok)         1    0.6%   117       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.8 22.5
p_loo        33.6  8.4
looic      1721.5 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   775       
 (0.5, 0.7]   (ok)         5    2.8%   1273      
   (0.7, 1]   (bad)        3    1.7%   18        
   (1, Inf)   (very bad)   1    0.6%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.8     22.5        33.6    8.4   1721.5
fit_sleep2  -24.3      11.8  -885.1     14.3        19.5    3.3   1770.1
fit_sleep1  -92.5      21.1  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   44.9  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.682088e-41 2.793741e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.87      1.57     0.21      5.4       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.13      1.57    -3.32     2.85       5.49      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.15      
[4] StanHeaders_2.26.15 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.0         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.9        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
