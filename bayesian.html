<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lamp.html">LAMP (Linux, Apache, MySQL, PHP)</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.95      6.89    15.66    42.47 1.00     1539     2383
sd(Days)                6.58      1.54     4.12    10.29 1.00     1497     1879
cor(Intercept,Days)     0.09      0.30    -0.47     0.67 1.00      965     1543

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.35      7.52   237.01   266.50 1.00     1680     2065
Days         10.45      1.70     7.06    13.87 1.00     1407     2147

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.57    23.05    29.22 1.00     3315     2853

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.8302  12.73882 228.8106 277.7391
309 211.5776  13.32072 185.5126 238.0820
310 212.8814  13.16580 187.0897 238.2143
330 274.5254  13.40334 249.2437 301.7741
331 272.9674  12.95393 248.2451 298.8819
332 260.1557  12.30377 237.2638 284.7045
333 267.7936  12.87360 243.8971 293.5971
334 244.4764  12.23104 219.6644 268.5382
335 250.6443  13.59301 225.0059 276.9240
337 285.7371  13.06876 260.1429 311.7668
349 226.9635  12.92200 201.3363 251.8360
350 238.7796  12.94022 213.3119 264.1417
351 255.9120  12.58615 231.6956 280.9884
352 272.0088  12.87622 247.0618 298.0271
369 254.5617  12.04754 231.0118 277.7942
370 226.5863  13.50763 199.7645 252.4746
371 251.8734  12.32446 228.0142 276.2775
372 263.4764  12.50072 239.2247 288.8353

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6541928  2.441612 14.83012297 24.520969
309  1.7732917  2.515899 -3.19934977  6.706700
310  4.9716575  2.481483  0.06288262  9.928357
330  5.7590524  2.533788  0.79996828 10.467682
331  7.4795955  2.464471  2.50618392 12.236379
332 10.2551698  2.335148  5.67040511 14.763746
333 10.3094259  2.402372  5.48939277 14.847387
334 11.4558209  2.333740  6.93518186 16.156271
335 -0.2107544  2.609219 -5.38914352  4.941606
337 19.2153793  2.462953 14.44517031 24.150724
349 11.5091425  2.467248  6.73772604 16.435961
350 17.0417674  2.496080 12.21781429 22.074025
351  7.4567865  2.370164  2.69779923 11.989103
352 14.0824559  2.446165  9.11419285 18.888472
369 11.3588961  2.329644  6.69693954 16.011543
370 15.1666724  2.546980 10.18302231 20.157164
371  9.5269769  2.337949  4.80121940 14.010834
372 11.8011412  2.390527  6.90885057 16.417980</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.8302 12.738816 228.8106 277.7391
  [2,] 273.4844 10.916606 251.8599 294.3493
  [3,] 293.1386  9.380303 274.6098 311.2427
  [4,] 312.7928  8.290406 296.8503 328.8682
  [5,] 332.4470  7.835464 317.1682 347.8251
  [6,] 352.1011  8.122875 336.3743 367.9162
  [7,] 371.7553  9.082436 354.0511 389.4344
  [8,] 391.4095 10.532005 370.7625 411.5574
  [9,] 411.0637 12.299535 386.4586 434.9457
 [10,] 430.7179 14.267337 402.5724 458.8596
 [11,] 211.5776 13.320723 185.5126 238.0820
 [12,] 213.3509 11.407822 190.8683 235.9729
 [13,] 215.1242  9.772135 196.2221 234.2806
 [14,] 216.8975  8.573818 200.2925 233.5542
 [15,] 218.6708  8.011589 203.1508 234.6746
 [16,] 220.4441  8.217071 204.2465 236.6202
 [17,] 222.2174  9.138624 204.5700 240.2905
 [18,] 223.9907 10.590946 203.2688 244.9541
 [19,] 225.7640 12.388758 201.1169 249.8810
 [20,] 227.5373 14.403263 199.1041 255.4620
 [21,] 212.8814 13.165800 187.0897 238.2143
 [22,] 217.8530 11.283070 195.8243 239.7701
 [23,] 222.8247  9.674324 204.3740 241.8469
 [24,] 227.7963  8.496644 211.3018 244.4577
 [25,] 232.7680  7.944110 217.3760 248.5615
 [26,] 237.7397  8.144957 222.1720 253.8460
 [27,] 242.7113  9.049159 225.3036 260.5435
 [28,] 247.6830 10.476152 227.1343 268.0973
 [29,] 252.6546 12.244498 228.9915 276.4887
 [30,] 257.6263 14.227482 230.0552 285.4000
 [31,] 274.5254 13.403341 249.2437 301.7741
 [32,] 280.2845 11.450801 258.8664 303.8508
 [33,] 286.0435  9.768947 267.6468 306.0702
 [34,] 291.8026  8.519621 275.3496 308.6202
 [35,] 297.5616  7.910483 282.6490 312.9863
 [36,] 303.3207  8.087503 287.7056 319.4880
 [37,] 309.0797  9.004434 291.5981 327.2995
 [38,] 314.8388 10.468625 294.9688 335.8810
 [39,] 320.5979 12.285950 297.3201 345.0128
 [40,] 326.3569 14.322611 299.2316 354.2624
 [41,] 272.9674 12.953927 248.2451 298.8819
 [42,] 280.4470 11.091925 259.4195 302.6485
 [43,] 287.9266  9.508135 269.4537 306.3223
 [44,] 295.4062  8.362158 278.7854 311.9379
 [45,] 302.8858  7.848184 287.4250 318.0465
 [46,] 310.3654  8.087616 294.7565 326.3867
 [47,] 317.8450  9.020660 300.4600 335.7257
 [48,] 325.3246 10.463380 305.0736 346.1394
 [49,] 332.8042 12.236812 308.6086 357.1458
 [50,] 340.2838 14.217737 311.9882 368.7313
 [51,] 260.1557 12.303770 237.2638 284.7045
 [52,] 270.4108 10.633888 250.8141 291.4795
 [53,] 280.6660  9.256470 262.7422 298.8147
 [54,] 290.9212  8.318096 274.3324 307.3498
 [55,] 301.1763  7.975278 285.4192 317.1698
 [56,] 311.4315  8.302121 295.1520 328.1131
 [57,] 321.6867  9.227741 303.9986 339.7173
 [58,] 331.9418 10.596369 312.1484 352.9652
 [59,] 342.1970 12.260534 318.6909 366.5087
 [60,] 352.4522 14.116097 325.4627 380.1603
 [61,] 267.7936 12.873602 243.8971 293.5971
 [62,] 278.1030 11.073248 257.3229 300.4189
 [63,] 288.4125  9.541845 270.1586 307.6564
 [64,] 298.7219  8.427311 282.3458 315.5664
 [65,] 309.0313  7.907914 293.7604 324.8312
 [66,] 319.3407  8.098977 303.4370 335.6110
 [67,] 329.6502  8.955141 311.7327 347.2192
 [68,] 339.9596 10.312054 319.2278 359.8034
 [69,] 350.2690 12.001047 326.4763 373.8956
 [70,] 360.5784 13.901604 333.0311 387.5502
 [71,] 244.4764 12.231043 219.6644 268.5382
 [72,] 255.9322 10.537596 235.1521 276.3554
 [73,] 267.3881  9.131053 249.7826 285.2630
 [74,] 278.8439  8.161127 262.8962 295.2839
 [75,] 290.2997  7.792596 274.9881 305.8640
 [76,] 301.7555  8.107885 285.8372 317.5087
 [77,] 313.2113  9.035692 295.7078 330.9472
 [78,] 324.6672 10.413565 304.9442 345.3378
 [79,] 336.1230 12.088574 313.0666 359.7115
 [80,] 347.5788 13.954125 320.8650 374.4840
 [81,] 250.6443 13.593006 225.0059 276.9240
 [82,] 250.4336 11.554656 228.6821 273.0396
 [83,] 250.2228  9.791138 231.3961 269.1388
 [84,] 250.0121  8.475773 233.2629 266.3362
 [85,] 249.8013  7.837546 234.1733 265.2087
 [86,] 249.5905  8.039377 233.6049 265.8059
 [87,] 249.3798  9.025080 231.7282 267.4041
 [88,] 249.1690 10.577742 228.4481 270.4570
 [89,] 248.9583 12.487643 224.6716 273.7910
 [90,] 248.7475 14.615398 220.5168 277.8448
 [91,] 285.7371 13.068761 260.1429 311.7668
 [92,] 304.9525 11.196118 283.0273 327.4299
 [93,] 324.1679  9.594055 305.7615 343.2324
 [94,] 343.3833  8.418491 327.5769 360.0902
 [95,] 362.5987  7.863102 347.4803 378.3622
 [96,] 381.8140  8.057173 365.8290 397.5639
 [97,] 401.0294  8.952093 383.0127 418.6659
 [98,] 420.2448 10.367940 399.9267 440.6289
 [99,] 439.4602 12.123559 416.1474 463.2291
[100,] 458.6756 14.092532 431.7929 486.5725
[101,] 226.9635 12.921998 201.3363 251.8360
[102,] 238.4726 11.071229 216.6801 259.8685
[103,] 249.9818  9.504779 231.4199 268.1057
[104,] 261.4909  8.383565 245.1037 277.4594
[105,] 273.0001  7.899501 257.8129 288.5285
[106,] 284.5092  8.166682 269.0804 300.4630
[107,] 296.0183  9.119315 278.7906 313.9330
[108,] 307.5275 10.573728 287.4889 328.2390
[109,] 319.0366 12.353954 295.5297 342.9785
[110,] 330.5458 14.339151 302.8999 358.3054
[111,] 238.7796 12.940216 213.3119 264.1417
[112,] 255.8214 11.085387 234.6641 277.3914
[113,] 272.8632  9.528024 254.6604 291.6130
[114,] 289.9049  8.434543 273.7778 306.7019
[115,] 306.9467  7.997539 291.8569 322.7671
[116,] 323.9885  8.321092 307.9736 340.1072
[117,] 341.0302  9.326379 323.0994 359.1664
[118,] 358.0720 10.825107 337.0594 378.9714
[119,] 375.1138 12.642998 350.1471 399.8574
[120,] 392.1555 14.661809 363.3859 420.9062
[121,] 255.9120 12.586151 231.6956 280.9884
[122,] 263.3688 10.834650 242.4974 284.6186
[123,] 270.8256  9.359671 252.9932 289.2304
[124,] 278.2824  8.309788 262.4806 294.7478
[125,] 285.7391  7.857294 270.1294 301.4188
[126,] 293.1959  8.102896 277.0680 309.4836
[127,] 300.6527  8.989556 282.8461 318.3327
[128,] 308.1095 10.353872 287.4926 328.3279
[129,] 315.5663 12.034474 291.4338 339.0361
[130,] 323.0231 13.917249 294.7341 350.0529
[131,] 272.0088 12.876224 247.0618 298.0271
[132,] 286.0912 11.061143 264.7875 308.3185
[133,] 300.1737  9.532475 281.8747 319.0754
[134,] 314.2561  8.447172 298.1948 330.8948
[135,] 328.3386  7.988040 313.3656 343.8781
[136,] 342.4210  8.260163 326.3448 358.7603
[137,] 356.5035  9.198873 338.4461 374.7563
[138,] 370.5859 10.629001 349.4904 391.5906
[139,] 384.6684 12.381417 360.3138 409.1980
[140,] 398.7509 14.338437 370.0587 427.1945
[141,] 254.5617 12.047541 231.0118 277.7942
[142,] 265.9206 10.359232 245.4319 285.9194
[143,] 277.2795  8.963180 259.5298 294.6863
[144,] 288.6384  8.013613 272.5530 304.2567
[145,] 299.9973  7.678013 284.6538 314.9291
[146,] 311.3562  8.033695 295.2555 327.0693
[147,] 322.7151  8.999062 305.0286 340.5750
[148,] 334.0740 10.405790 313.2935 354.5580
[149,] 345.4329 12.100921 321.3722 369.1039
[150,] 356.7918 13.979936 328.9022 384.1368
[151,] 226.5863 13.507631 199.7645 252.4746
[152,] 241.7530 11.552765 218.6571 263.9336
[153,] 256.9197  9.871720 237.4613 275.8366
[154,] 272.0863  8.626098 255.1978 288.6240
[155,] 287.2530  8.021376 271.6251 303.1416
[156,] 302.4197  8.200586 286.4986 318.6591
[157,] 317.5864  9.117618 299.8618 335.5848
[158,] 332.7530 10.582369 312.0935 353.6702
[159,] 347.9197 12.402270 324.0536 372.8541
[160,] 363.0864 14.443694 335.5161 392.0463
[161,] 251.8734 12.324463 228.0142 276.2775
[162,] 261.4003 10.614567 240.6990 282.3662
[163,] 270.9273  9.185733 253.0692 289.1030
[164,] 280.4543  8.186474 264.6381 296.5903
[165,] 289.9813  7.784025 275.1152 305.3304
[166,] 299.5082  8.068192 283.8127 315.5345
[167,] 309.0352  8.973986 291.3700 326.6612
[168,] 318.5622 10.339301 298.2135 338.4253
[169,] 328.0892 12.008408 303.9538 350.9027
[170,] 337.6161 13.872080 310.3703 363.9225
[171,] 263.4764 12.500717 239.2247 288.8353
[172,] 275.2776 10.712057 254.4804 296.9288
[173,] 287.0787  9.200960 269.4853 305.3461
[174,] 298.8799  8.123816 283.7065 315.2464
[175,] 310.6810  7.665791 296.0529 325.7315
[176,] 322.4821  7.934832 306.8741 338.0361
[177,] 334.2833  8.864988 316.6801 351.7473
[178,] 346.0844 10.278312 325.3188 366.1893
[179,] 357.8856 12.005358 333.9357 380.9698
[180,] 369.6867 13.929924 342.3724 396.3865</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.2701844 12.738816  -28.1790971  20.7494398
  [2,]  -14.7796772 10.916606  -35.6446470   6.8448403
  [3,]  -42.3379700  9.380303  -60.4420967 -23.8091930
  [4,]    8.6470372  8.290406   -7.4283680  24.5894776
  [5,]   24.4049445  7.835464    9.0268198  39.6837478
  [6,]   62.5889517  8.122875   46.7738658  78.3157996
  [7,]   10.4484589  9.082436   -7.2306310  28.1527300
  [8,] -101.2609339 10.532005 -121.4087976 -80.6138664
  [9,]   19.5215733 12.299535   -4.3603684  44.1266810
 [10,]   35.6355805 14.267337    7.4939133  63.7811201
 [11,]   11.1562699 13.320723  -15.3480825  37.2213245
 [12,]   -8.0851218 11.407822  -30.7070712  14.3975355
 [13,]  -12.1464136  9.772135  -31.3027728   6.7556589
 [14,]  -12.1905053  8.573818  -28.8471617   4.4144567
 [15,]  -10.9546971  8.011589  -26.9584625   4.5652894
 [16,]   -4.4822888  8.217071  -20.6583845  11.7153495
 [17,]   -8.5870805  9.138624  -26.6601658   9.0603194
 [18,]   -6.2634723 10.590946  -27.2269145  14.4584000
 [19,]   -1.4682640 12.388758  -25.5852988  23.1787804
 [20,]    9.7769443 14.403263  -18.1477511  38.2101437
 [21,]  -13.8274741 13.165800  -39.1604498  11.9642324
 [22,]  -23.5208317 11.283070  -45.4379055  -1.4921333
 [23,]   11.4953108  9.674324   -7.5269329  29.9459754
 [24,]    5.0452532  8.496644  -11.6161048  21.5398061
 [25,]   -3.4606043  7.944110  -19.2540674  11.9313787
 [26,]  -17.2817619  8.144957  -33.3880895  -1.7140840
 [27,]   -7.2905194  9.049159  -25.1226814  10.1171793
 [28,]    8.0681230 10.476152  -12.3461795  28.6168182
 [29,]    8.3578655 12.244498  -15.4761783  32.0209786
 [30,]  -10.1109921 14.227482  -37.8847164  17.4600781
 [31,]   47.0171687 13.403341   19.7684647  72.2988524
 [32,]   20.1157163 11.450801   -3.4506331  41.5337590
 [33,]   -2.1870361  9.768947  -22.2137001  16.2097030
 [34,]   -6.6695885  8.519621  -23.4872143   9.7834167
 [35,]  -11.7643409  7.910483  -27.1889991   3.1483212
 [36,]   -5.7351933  8.087503  -21.9024729   9.8799480
 [37,]  -28.8401458  9.004434  -47.0599111 -11.3584603
 [38,]    3.4225018 10.468625  -17.6197481  23.2925390
 [39,]  -15.2483506 12.285950  -39.6633091   8.0293641
 [40,]   27.6917970 14.322611   -0.2137254  54.8170971
 [41,]   14.6404656 12.953927  -11.2739686  39.3627841
 [42,]    4.5529701 11.091925  -17.6484701  25.5805203
 [43,]   13.8939746  9.508135   -4.5017245  32.3668974
 [44,]   24.7090791  8.362158    8.1773772  41.3299218
 [45,]   13.3914836  7.848184   -1.7692096  28.8522966
 [46,]  -17.0467120  8.087616  -33.0680481  -1.4378398
 [47,]  -27.7700075  9.020660  -45.6506761 -10.3850046
 [48,]    9.4930970 10.463380  -11.3216621  29.7440607
 [49,]  -39.0572985 12.236812  -63.3989170 -14.8616657
 [50,]   31.2973060 14.217737    2.8498477  59.5929345
 [51,]  -25.2950531 12.303770  -49.8439460  -2.4031740
 [52,]  -27.5990228 10.633888  -48.6677118  -8.0022990
 [53,]   -7.7046926  9.256470  -25.8534360  10.2191081
 [54,]   18.8476376  8.318096    2.4189852  35.4364387
 [55,]   16.2865678  7.975278    0.2931390  32.0436517
 [56,]   -1.4339020  8.302121  -18.1155369  14.8455670
 [57,]  132.4752282  9.227741  114.4446500 150.1632601
 [58,]   14.8892584 10.596369   -6.1340868  34.6827408
 [59,]  -11.8967114 12.260534  -36.2084106  11.6093647
 [60,]  -98.5877812 14.116097 -126.2959061 -71.5983336
 [61,]   16.0487844 12.873602   -9.7546649  39.9453364
 [62,]   11.4519585 11.073248  -10.8638643  32.2321233
 [63,]  -11.6431673  9.541845  -30.8870647   6.6106676
 [64,]    1.0878068  8.427311  -15.7567115  17.4639140
 [65,]  -11.8603191  7.907914  -27.6601717   3.4106219
 [66,]   18.8257551  8.098977    2.5554617  34.7295411
 [67,]    2.3763292  8.955141  -15.1926828  20.2937645
 [68,]    8.8803034 10.312054  -10.9634553  29.6120893
 [69,]  -16.9090225 12.001047  -40.5355765   6.8837062
 [70,]    1.4643516 13.901604  -25.5073630  29.0117221
 [71,]   20.9966907 12.231043   -3.0650677  45.8086768
 [72,]   20.2689697 10.537596   -0.1542216  41.0490821
 [73,]  -24.0233512  9.131053  -41.8982578  -6.4179043
 [74,]  -24.1715721  8.161127  -40.6116118  -8.2238629
 [75,]  -11.2752931  7.792596  -26.8396090   4.0362751
 [76,]  -17.5643140  8.107885  -33.3175129  -1.6459864
 [77,]   -7.6865349  9.035692  -25.4224182   9.8170079
 [78,]    6.8557441 10.413565  -13.8149108  26.5787384
 [79,]   -0.3760768 12.088574  -23.9646087  22.6803130
 [80,]   29.7202023 13.954125    2.8150238  56.4340063
 [81,]   -9.0360169 13.593006  -35.3156779  16.6024280
 [82,]   23.5136375 11.554656    0.9075621  45.2650689
 [83,]    4.2678919  9.791138  -14.6481247  23.0946238
 [84,]   20.7900463  8.475773    4.4658629  37.5392327
 [85,]    1.6506008  7.837546  -13.7567649  17.2786040
 [86,]    5.0456552  8.039377  -11.1696527  21.0312779
 [87,]   -3.9274904  9.025080  -21.9518125  13.7241484
 [88,]  -13.8580360 10.577742  -35.1460406   6.8628938
 [89,]  -13.2041816 12.487643  -38.0368571  11.0825313
 [90,]  -11.5009272 14.615398  -40.5982053  16.7297634
 [91,]   26.6294609 13.068761    0.5997953  52.2237297
 [92,]    8.8532816 11.196118  -13.6240711  30.7785209
 [93,]  -32.5566976  9.594055  -51.6211592 -14.1502545
 [94,]    2.7389231  8.418491  -13.9679811  18.5453349
 [95,]    3.1337438  7.863102  -12.6298272  18.2520800
 [96,]   10.0244645  8.057173   -5.7253888  26.0095315
 [97,]    3.2306852  8.952093  -14.4057916  21.2473714
 [98,]   -3.5524941 10.367940  -23.9365731  16.7655873
 [99,]   16.4041267 12.123559   -7.3647543  39.7169122
[100,]    0.2411474 14.092532  -27.6558345  27.1238296
[101,]    9.1397134 12.921998  -15.7327641  34.7668573
[102,]   -8.1559291 11.071229  -29.5517582  13.6366458
[103,]  -11.0561716  9.504779  -29.1800894   7.5056837
[104,]   -6.5689142  8.383565  -22.5373788   9.8182921
[105,]  -22.2897567  7.899501  -37.8181563  -7.1026453
[106,]  -14.7347992  8.166682  -30.6886427   0.6939532
[107,]  -14.4535417  9.119315  -32.3681592   2.7742360
[108,]    0.5745158 10.573728  -20.1369616  20.6130839
[109,]   17.2439733 12.353954   -6.6978502  40.7509035
[110,]   21.0993308 14.339151   -6.6603007  48.7452389
[111,]   17.5171822 12.940216   -7.8448644  42.9849145
[112,]  -12.3670852 11.085387  -33.9371112   8.7902178
[113,]  -16.6585526  9.528024  -35.4083688   1.5441680
[114,]  -34.3778200  8.434543  -51.1748386 -18.2506956
[115,]  -38.0301874  7.997539  -53.8506223 -22.9404025
[116,]    5.7362452  8.321092  -10.3825432  21.7511241
[117,]   38.4142778  9.326379   20.2780623  56.3451487
[118,]    4.8464104 10.825107  -16.0529610  25.8590371
[119,]   19.3734430 12.642998   -5.3701610  44.3401424
[120,]   -3.1028244 14.661809  -31.8534677  25.6667917
[121,]   -5.3854932 12.586151  -30.4618528  18.8308978
[122,]   36.6888203 10.834650   15.4389963  57.5601963
[123,]   -0.9316661  9.359671  -19.3365161  16.9007229
[124,]    2.3067474  8.309788  -14.1586804  18.1084563
[125,]  -13.9117390  7.857294  -29.5914439   1.6980436
[126,]   11.4376745  8.102896   -4.8500012  27.5656383
[127,]  -12.9061119  8.989556  -30.5861120   4.9004629
[128,]  -41.5139984 10.353872  -61.7323540 -20.8970931
[129,]    5.9755152 12.034474  -17.4942664  30.1079953
[130,]   24.5424287 13.917249   -2.4873676  52.8313892
[131,]  -50.3316568 12.876224  -76.3500000 -25.3847209
[132,]   12.1026873 11.061143  -10.1245569  33.4063879
[133,]   26.7048314  9.532475    7.8030691  45.0037763
[134,]   32.5993754  8.447172   15.9607468  48.6607473
[135,]   20.4016195  7.988040    4.8620670  35.3745817
[136,]   10.4076636  8.260163   -5.9315605  26.4839374
[137,]   -2.0768923  9.198873  -20.3296826  15.9805028
[138,]  -10.1533482 10.629001  -31.1580421  10.9421583
[139,]   -9.0278041 12.381417  -33.5574206  15.3268238
[140,]  -10.2091600 14.338437  -38.6527824  18.4829682
[141,]   17.3617617 12.047541   -5.8706727  40.9117203
[142,]    2.5162655 10.359232  -17.4825480  23.0049501
[143,]  -20.0371306  8.963180  -37.4439418  -2.2873796
[144,]  -10.9818267  8.013613  -26.6000965   5.1036417
[145,]   14.8248772  7.678013   -0.1068877  30.1684062
[146,]    5.8572811  8.033695   -9.8558207  21.9580068
[147,]  -24.5798150  8.999062  -42.4397156  -6.8932658
[148,]   14.0488888 10.405790   -6.4351373  34.8293576
[149,]   -5.1529073 12.100921  -28.8239255  18.9077827
[150,]    9.7212966 13.979936  -17.6236794  37.6108610
[151,]   -1.3223292 13.507631  -27.2106385  25.4994589
[152,]   -7.2295016 11.552765  -29.4101369  15.8664485
[153,]  -18.0188740  9.871720  -36.9358272   1.4395360
[154,]  -31.6133464  8.626098  -48.1509831 -14.7248361
[155,]  -19.7157189  8.021376  -35.6042886  -4.0878083
[156,]   41.7740087  8.200586   25.5346070  57.6950842
[157,]  -36.4382637  9.117618  -54.4367372 -18.7136755
[158,]   14.8324639 10.582369   -6.0847176  35.4919675
[159,]   17.2432914 12.402270   -7.6911403  41.1094029
[160,]    9.1424190 14.443694  -19.8175276  36.7127367
[161,]   18.0070421 12.324463   -6.3970974  41.8662452
[162,]   11.0424652 10.614567   -9.9233546  31.7437667
[163,]    6.9715884  9.185733  -11.2040689  24.8297023
[164,]    1.3352115  8.186474  -14.8008258  17.1514202
[165,]  -10.8107653  7.784025  -26.1598869   4.0552699
[166,]  -14.9962422  8.068192  -31.0225222   0.6992737
[167,]  -49.7694190  8.973986  -67.3954225 -32.1041966
[168,]  -13.9315959 10.339301  -33.7946580   6.4171152
[169,]   22.6915272 12.008408   -0.1219635  46.8268539
[170,]   31.8530504 13.872080    5.5466939  59.0989294
[171,]    5.9352722 12.500717  -19.4235502  30.1869926
[172,]   -1.8035690 10.712057  -23.4548101  18.9935507
[173,]   10.5180898  9.200960   -7.7492539  28.1114987
[174,]   11.7517487  8.123816   -4.6148147  26.9251446
[175,]  -23.5083925  7.665791  -38.5588929  -8.8803352
[176,]    7.1254664  7.934832   -8.4285095  22.7335404
[177,]    0.1985252  8.864988  -17.2654898  17.8016680
[178,]   -2.8645160 10.278312  -22.9693715  17.9011426
[179,]   11.2561429 12.005358  -11.8280516  35.2060309
[180,]   -5.5630983 13.929924  -32.2628834  21.7512050</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.3
looic      1770.0 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1097      
 (0.5, 0.7]   (ok)         3    1.7%   114       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.5 22.8
p_loo        34.5  8.9
looic      1723.0 45.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     175   97.2%   939       
 (0.5, 0.7]   (ok)         2    1.1%   423       
   (0.7, 1]   (bad)        1    0.6%   75        
   (1, Inf)   (very bad)   2    1.1%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.5      11.9  
fit_sleep1 -91.9      21.3  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.4
p_loo        19.5  3.3
looic      1770.0 28.8
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1097      
 (0.5, 0.7]   (ok)         3    1.7%   114       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.5 22.8
p_loo        34.5  8.9
looic      1723.0 45.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     175   97.2%   939       
 (0.5, 0.7]   (ok)         2    1.1%   423       
   (0.7, 1]   (bad)        1    0.6%   75        
   (1, Inf)   (very bad)   2    1.1%   6         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.5     22.8        34.5    8.9   1723.0
fit_sleep2  -23.5      11.9  -885.0     14.4        19.5    3.3   1770.0
fit_sleep1  -91.9      21.3  -953.3     10.5         3.2    0.5   1906.7
           se_looic
fit_sleep3   45.6  
fit_sleep2   28.8  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.281926e-40 6.207150e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.91      1.56     0.31     5.44       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.09      1.56    -3.25     2.92       5.65      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.11         rstan_2.26.22      
[4] StanHeaders_2.26.27 lme4_1.1-34         Matrix_1.6-0       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.1      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.3         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.23      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.7      
 [28] highr_0.10           later_1.3.1          parallel_4.3.1      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.5.0          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.1        igraph_1.5.0         tidyselect_1.2.0    
 [46] rstudioapi_0.15.0    abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.1          
 [52] processx_3.8.2       pkgbuild_1.4.2       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4.1       
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.1        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1.1   munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.1         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-2       
 [85] grid_4.3.1           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.7           digest_0.6.33       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-60         </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KAogIGVjaG8gPSBUUlVFLAogIGVycm9yID0gVFJVRSwKICBjb21tZW50ID0gIiIsCiAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
