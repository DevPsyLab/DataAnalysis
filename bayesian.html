<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.17      7.17    15.68    43.30 1.00     1896     2783
sd(Days)                6.57      1.52     4.14    10.20 1.00     1294     2017
cor(Intercept,Days)     0.08      0.30    -0.49     0.67 1.00      975     1739

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.07      7.56   236.20   266.16 1.00     1733     2613
Days         10.37      1.69     7.03    13.69 1.00     1472     1892

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.54    23.11    29.18 1.00     3334     2988

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9040  13.11191 227.9553 279.0651
309 211.2677  13.21150 184.7098 236.2714
310 212.7198  13.37257 186.1251 238.4373
330 274.2623  13.22937 248.9987 301.1626
331 273.3421  13.13423 248.5927 299.4976
332 260.2533  12.20768 236.2831 284.2504
333 268.4047  12.42436 244.9791 294.0060
334 244.2733  12.38736 219.3356 268.4677
335 250.7142  13.36274 224.4958 277.1956
337 285.7957  12.94750 261.5076 312.0976
349 226.4633  12.93696 200.2339 250.8480
350 238.8215  13.54214 211.5782 264.3221
351 255.8855  12.86571 230.4103 280.9114
352 271.8250  13.06025 246.1490 297.6795
369 254.6468  12.64541 229.7157 279.8456
370 226.6705  13.37855 200.0525 252.0763
371 252.4114  12.07648 228.6405 276.2835
372 263.3632  12.73936 238.0942 288.2124

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6415163  2.523743 14.68341978 24.620965
309  1.8057230  2.503235 -3.04134205  6.664973
310  4.9612812  2.485721  0.09329638  9.890301
330  5.7770483  2.505638  0.85770339 10.593170
331  7.4556225  2.503281  2.42433678 12.146303
332 10.1895331  2.340173  5.63397551 14.609051
333 10.2438183  2.380783  5.42696454 14.816335
334 11.5317258  2.347401  7.01806363 16.284854
335 -0.2199196  2.559523 -5.31655267  4.704290
337 19.1307808  2.504771 14.21211150 24.010664
349 11.5783595  2.440963  6.84801455 16.361139
350 17.0302787  2.541496 12.25273025 22.170382
351  7.4745478  2.451823  2.74319794 12.422484
352 14.1102959  2.445441  9.39731565 19.100267
369 11.3440748  2.379793  6.63141484 16.085576
370 15.0944426  2.568637 10.30283515 20.303669
371  9.4227036  2.310370  4.93750173 13.843772
372 11.8120480  2.417422  6.91267603 16.442582</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9040 13.111907 227.9553 279.0651
  [2,] 273.5456 11.206550 251.3677 294.8447
  [3,] 293.1871  9.591140 274.0115 311.2719
  [4,] 312.8286  8.433963 296.3181 328.8546
  [5,] 332.4701  7.938013 317.1327 347.5112
  [6,] 352.1116  8.223803 336.1766 367.7042
  [7,] 371.7531  9.218913 354.0134 389.5565
  [8,] 391.3946 10.727737 370.1695 412.3457
  [9,] 411.0362 12.566578 385.7954 435.7580
 [10,] 430.6777 14.611364 401.5697 459.4778
 [11,] 211.2677 13.211504 184.7098 236.2714
 [12,] 213.0734 11.358701 189.9916 234.3855
 [13,] 214.8791  9.799425 195.0491 233.4376
 [14,] 216.6849  8.693087 199.8387 233.8289
 [15,] 218.4906  8.224546 202.4267 234.8998
 [16,] 220.2963  8.499936 204.0300 237.3278
 [17,] 222.1020  9.454473 203.6713 240.9873
 [18,] 223.9078 10.911351 202.8023 245.8160
 [19,] 225.7135 12.698838 200.9858 251.0832
 [20,] 227.5192 14.696794 198.7731 257.2086
 [21,] 212.7198 13.372571 186.1251 238.4373
 [22,] 217.6811 11.502992 194.9098 239.8353
 [23,] 222.6424  9.908058 203.6474 242.0915
 [24,] 227.6036  8.739453 210.7040 244.4832
 [25,] 232.5649  8.181936 216.6170 248.3487
 [26,] 237.5262  8.358693 221.1125 254.0158
 [27,] 242.4875  9.227624 224.1731 261.1356
 [28,] 247.4488 10.620167 226.1893 268.5823
 [29,] 252.4100 12.360602 227.8347 276.7827
 [30,] 257.3713 14.322661 228.8733 285.2615
 [31,] 274.2623 13.229365 248.9987 301.1626
 [32,] 280.0393 11.286723 258.4208 302.4314
 [33,] 285.8164  9.608358 267.2561 304.6546
 [34,] 291.5934  8.355085 275.4446 308.1001
 [35,] 297.3705  7.736328 282.6168 312.4533
 [36,] 303.1475  7.902566 287.6635 318.4202
 [37,] 308.9246  8.809470 291.7570 325.8442
 [38,] 314.7016 10.262525 294.9188 334.7394
 [39,] 320.4787 12.066007 297.1171 344.4678
 [40,] 326.2557 14.085953 298.5794 354.0852
 [41,] 273.3421 13.134232 248.5927 299.4976
 [42,] 280.7977 11.226372 259.6157 303.1968
 [43,] 288.2533  9.596230 270.1831 307.0710
 [44,] 295.7089  8.406942 279.8236 312.3595
 [45,] 303.1646  7.861204 287.9197 318.5547
 [46,] 310.6202  8.090317 294.6613 326.4038
 [47,] 318.0758  9.035527 300.4414 335.9103
 [48,] 325.5314 10.505289 304.8052 346.4143
 [49,] 332.9870 12.313175 308.7830 357.5517
 [50,] 340.4427 14.331793 312.3111 368.4966
 [51,] 260.2533 12.207677 236.2831 284.2504
 [52,] 270.4428 10.520422 249.8564 290.9345
 [53,] 280.6323  9.126006 262.7406 298.1642
 [54,] 290.8219  8.175666 274.6432 306.7276
 [55,] 301.0114  7.832742 285.6286 316.4663
 [56,] 311.2009  8.174044 295.2182 326.9011
 [57,] 321.3905  9.123101 303.2551 338.7426
 [58,] 331.5800 10.516642 310.5112 351.9595
 [59,] 341.7695 12.203334 317.3555 365.1904
 [60,] 351.9591 14.078202 324.0058 378.5408
 [61,] 268.4047 12.424356 244.9791 294.0060
 [62,] 278.6485 10.676135 258.5065 300.4505
 [63,] 288.8923  9.215821 271.2507 307.3021
 [64,] 299.1361  8.198727 283.3013 315.4436
 [65,] 309.3799  7.800201 294.4572 324.6344
 [66,] 319.6237  8.111931 303.8108 335.5217
 [67,] 329.8676  9.060903 312.4070 347.6493
 [68,] 340.1114 10.475341 319.7679 361.0902
 [69,] 350.3552 12.194336 326.3553 374.6685
 [70,] 360.5990 14.106989 332.7945 389.1607
 [71,] 244.2733 12.387360 219.3356 268.4677
 [72,] 255.8050 10.637745 234.4545 276.4309
 [73,] 267.3368  9.159538 248.6970 284.8444
 [74,] 278.8685  8.102667 262.6535 294.3600
 [75,] 290.4002  7.643944 275.2305 305.2383
 [76,] 301.9319  7.888418 286.2632 317.3783
 [77,] 313.4637  8.777526 296.2469 330.7126
 [78,] 324.9954 10.143143 305.4903 344.8901
 [79,] 336.5271 11.821266 313.9954 359.7932
 [80,] 348.0588 13.697514 321.5520 375.0049
 [81,] 250.7142 13.362741 224.4958 277.1956
 [82,] 250.4943 11.418263 228.5421 272.8494
 [83,] 250.2744  9.761810 231.2594 269.6107
 [84,] 250.0545  8.562210 233.7092 267.0647
 [85,] 249.8346  8.026970 234.2977 265.5727
 [86,] 249.6146  8.285854 233.8506 265.3809
 [87,] 249.3947  9.272585 231.6476 267.4036
 [88,] 249.1748 10.789281 228.1610 270.0479
 [89,] 248.9549 12.646685 224.6555 273.3668
 [90,] 248.7350 14.716353 220.2483 277.1396
 [91,] 285.7957 12.947497 261.5076 312.0976
 [92,] 304.9265 11.075245 284.0450 327.1164
 [93,] 324.0573  9.499061 306.0846 343.3336
 [94,] 343.1881  8.387553 327.2345 359.7384
 [95,] 362.3188  7.938368 346.7057 377.7846
 [96,] 381.4496  8.260272 365.4921 397.6817
 [97,] 400.5804  9.273308 382.7936 418.7516
 [98,] 419.7112 10.784441 399.3040 440.6872
 [99,] 438.8420 12.615936 415.1443 464.0118
[100,] 457.9727 14.648115 430.1587 487.1633
[101,] 226.4633 12.936958 200.2339 250.8480
[102,] 238.0417 11.107947 215.3993 259.1489
[103,] 249.6200  9.556395 230.4730 267.7429
[104,] 261.1984  8.436792 244.5359 277.5255
[105,] 272.7768  7.934157 257.3259 288.1746
[106,] 284.3551  8.163261 267.8577 299.9500
[107,] 295.9335  9.068815 277.8570 313.1859
[108,] 307.5118 10.476860 286.5757 328.2562
[109,] 319.0902 12.214842 294.3764 343.3758
[110,] 330.6686 14.161805 301.9155 358.9977
[111,] 238.8215 13.542142 211.5782 264.3221
[112,] 255.8518 11.576268 232.5077 278.0472
[113,] 272.8821  9.876678 253.0208 292.1773
[114,] 289.9124  8.602670 273.0480 307.0596
[115,] 306.9426  7.961250 291.3138 322.5472
[116,] 323.9729  8.104041 308.2762 340.1136
[117,] 341.0032  8.993768 323.4809 358.1314
[118,] 358.0335 10.441199 337.4644 378.4088
[119,] 375.0638 12.250217 351.2263 399.4001
[120,] 392.0940 14.284096 364.2063 420.0968
[121,] 255.8855 12.865711 230.4103 280.9114
[122,] 263.3601 11.019685 241.6863 284.5357
[123,] 270.8346  9.453214 252.6010 289.2486
[124,] 278.3092  8.325619 262.1895 294.4567
[125,] 285.7837  7.828888 270.2689 301.0040
[126,] 293.2583  8.080217 277.3876 309.1049
[127,] 300.7328  9.017273 283.2569 319.0688
[128,] 308.2074 10.457313 287.7111 329.9644
[129,] 315.6819 12.223847 291.7911 341.0909
[130,] 323.1564 14.195505 295.3500 352.2950
[131,] 271.8250 13.060249 246.1490 297.6795
[132,] 285.9353 11.201972 263.6852 308.3169
[133,] 300.0456  9.610340 280.8955 319.1696
[134,] 314.1559  8.437620 297.5552 330.8019
[135,] 328.2662  7.873284 312.6587 343.7683
[136,] 342.3765  8.046374 326.3583 357.9604
[137,] 356.4868  8.914036 338.7389 373.4900
[138,] 370.5971 10.302247 350.3625 390.2821
[139,] 384.7074 12.032162 361.0570 408.0468
[140,] 398.8177 13.977479 371.6642 425.8451
[141,] 254.6468 12.645412 229.7157 279.8456
[142,] 265.9909 10.893307 244.7393 287.3630
[143,] 277.3350  9.420651 259.1377 295.9201
[144,] 288.6791  8.376158 272.4203 305.4887
[145,] 300.0231  7.930839 284.5677 316.1019
[146,] 311.3672  8.183106 294.9656 327.6182
[147,] 322.7113  9.074970 304.5405 340.8741
[148,] 334.0554 10.443838 312.7132 354.6547
[149,] 345.3994 12.129273 320.9190 369.4799
[150,] 356.7435 14.017547 328.6883 384.1358
[151,] 226.6705 13.378550 200.0525 252.0763
[152,] 241.7650 11.414129 219.0775 263.4876
[153,] 256.8594  9.735240 237.6766 275.7112
[154,] 271.9539  8.512534 255.4403 288.4212
[155,] 287.0483  7.959105 271.6248 302.2522
[156,] 302.1427  8.211411 286.0698 318.1488
[157,] 317.2372  9.203422 299.1727 335.3154
[158,] 332.3316 10.731937 310.8845 353.7185
[159,] 347.4261 12.603244 322.1140 372.5647
[160,] 362.5205 14.686893 333.3281 391.5520
[161,] 252.4114 12.076482 228.6405 276.2835
[162,] 261.8341 10.426686 241.3228 282.3606
[163,] 271.2568  9.070047 253.4129 289.1006
[164,] 280.6795  8.154223 264.8544 296.5896
[165,] 290.1022  7.835342 274.7156 305.5373
[166,] 299.5249  8.183485 283.4375 315.3324
[167,] 308.9476  9.122603 291.1042 326.5322
[168,] 318.3703 10.495236 297.6960 338.5791
[169,] 327.7930 12.155397 304.2405 351.2017
[170,] 337.2157 14.001178 309.7145 364.0178
[171,] 263.3632 12.739364 238.0942 288.2124
[172,] 275.1752 10.967120 253.3818 296.4546
[173,] 286.9873  9.484299 268.3179 305.2855
[174,] 298.7993  8.444760 282.3966 314.7211
[175,] 310.6114  8.022710 294.7186 325.9207
[176,] 322.4234  8.312739 305.9483 338.2378
[177,] 334.2355  9.248094 315.6322 352.2223
[178,] 346.0475 10.660240 324.6412 367.0567
[179,] 357.8596 12.387173 333.1556 382.1735
[180,] 369.6716 14.315419 340.7561 397.4750</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.3440350 13.111907  -29.50505869  21.6047474
  [2,]  -14.8408512 11.206550  -36.13999758   7.3370231
  [3,]  -42.3864675  9.591140  -60.47133964 -23.2108868
  [4,]    8.6112162  8.433963   -7.41482793  25.1216707
  [5,]   24.3818000  7.938013    9.34070328  39.7192092
  [6,]   62.5784837  8.223803   46.98587083  78.5134598
  [7,]   10.4506674  9.218913   -7.35267952  28.1903865
  [8,] -101.2460488 10.727737 -122.19708367 -80.0208905
  [9,]   19.5491349 12.566578   -5.17265614  44.7898603
 [10,]   35.6758187 14.611364    6.87568001  64.7837741
 [11,]   11.4661986 13.211504  -13.53753544  38.0240933
 [12,]   -7.8076244 11.358701  -29.11971293  15.2742169
 [13,]  -11.9013474  9.799425  -30.45982746   7.9287491
 [14,]  -11.9778704  8.693087  -29.12185469   4.8682545
 [15,]  -10.7744933  8.224546  -27.18366105   5.2893525
 [16,]   -4.3345163  8.499936  -21.36604609  11.9317521
 [17,]   -8.4717393  9.454473  -27.35703854   9.9590087
 [18,]   -6.1805623 10.911351  -28.08877114  14.9248712
 [19,]   -1.4177852 12.698838  -26.78751550  23.3099021
 [20,]    9.7949918 14.696794  -19.89443359  38.5411441
 [21,]  -13.6658896 13.372571  -39.38341697  12.9287885
 [22,]  -23.3488708 11.502992  -45.50306683  -0.5775872
 [23,]   11.6776481  9.908058   -7.77147250  30.6726358
 [24,]    5.2379669  8.739453  -11.64156522  22.1375904
 [25,]   -3.2575142  8.181936  -19.04125459  12.6904258
 [26,]  -17.0682954  8.358693  -33.55787566  -0.6545517
 [27,]   -7.0666766  9.227624  -25.71478265  11.2477313
 [28,]    8.3023423 10.620167  -12.83117050  29.5618427
 [29,]    8.6024611 12.360602  -15.77016217  33.1778211
 [30,]   -9.8560200 14.322661  -37.74620603  18.6420457
 [31,]   47.2803195 13.229365   20.37998734  72.5438626
 [32,]   20.3608712 11.286723   -2.03123060  41.9793692
 [33,]   -1.9598771  9.608358  -20.79806958  16.6003576
 [34,]   -6.4604254  8.355085  -22.96708737   9.6883876
 [35,]  -11.5731737  7.736328  -26.65599952   3.1804810
 [36,]   -5.5620220  7.902566  -20.83466861   9.9220407
 [37,]  -28.6849703  8.809470  -45.60464727 -11.5174171
 [38,]    3.5596814 10.262525  -16.47814083  23.3424508
 [39,]  -15.1291669 12.066007  -39.11825967   8.2323539
 [40,]   27.7929848 14.085953   -0.03648531  55.4692878
 [41,]   14.2658360 13.134232  -11.88972201  39.0152470
 [42,]    4.2023136 11.226372  -18.19677562  25.3842992
 [43,]   13.5672911  9.596230   -5.25043974  31.6375178
 [44,]   24.4063686  8.406942    7.75578031  40.2916682
 [45,]   13.1127462  7.861204   -2.27741182  28.3575705
 [46,]  -17.3014763  8.090317  -33.08512477  -1.3426386
 [47,]  -28.0007988  9.035527  -45.83525858 -10.3664470
 [48,]    9.2862788 10.505289  -11.59661852  30.0125290
 [49,]  -39.2401437 12.313175  -63.80479993 -15.0361207
 [50,]   31.1384338 14.331793    3.08450486  59.2700114
 [51,]  -25.3926776 12.207677  -49.38976602  -1.4225480
 [52,]  -27.6310108 10.520422  -48.12267033  -7.0445639
 [53,]   -7.6710439  9.126006  -25.20291362  10.2206914
 [54,]   18.9469229  8.175666    3.04119862  35.1255591
 [55,]   16.4514898  7.832742    0.99657103  31.8343164
 [56,]   -1.2033434  8.174044  -16.90345596  14.7793899
 [57,]  132.7714235  9.123101  115.41927932 150.9067922
 [58,]   15.2510904 10.516642   -5.12842834  36.3198759
 [59,]  -11.4692428 12.203334  -34.89014831  12.9447674
 [60,]  -98.0946759 14.078202 -124.67635634 -70.1413735
 [61,]   15.4377490 12.424356  -10.16359022  38.8633399
 [62,]   10.9065307 10.676135  -10.89554565  31.0484754
 [63,]  -12.1229876  9.215821  -30.53278952   5.5186362
 [64,]    0.6735941  8.198727  -15.63386265  16.5083601
 [65,]  -12.2089243  7.800201  -27.46342217   2.7137910
 [66,]   18.5427574  8.111931    2.64481240  34.3556801
 [67,]    2.1589391  9.060903  -15.62281268  19.6195203
 [68,]    8.7285208 10.475341  -12.25026964  29.0719791
 [69,]  -16.9951976 12.194336  -41.30850278   7.0046676
 [70,]    1.4437841 14.106989  -27.11790757  29.2482964
 [71,]   21.1997990 12.387360   -2.99455868  46.1374651
 [72,]   20.3961732 10.637745   -0.22965073  41.7466914
 [73,]  -23.9720526  9.159538  -41.47971293  -5.3323218
 [74,]  -24.1961785  8.102667  -39.68771357  -7.9811728
 [75,]  -11.3758043  7.643944  -26.21393405   3.7939416
 [76,]  -17.7407301  7.888418  -33.18705913  -2.0719721
 [77,]   -7.9388559  8.777526  -25.18780712   9.2778985
 [78,]    6.5275182 10.143143  -13.36720428  26.0326209
 [79,]   -0.7802076 11.821266  -24.04625498  21.7515181
 [80,]   29.2401666 13.697514    2.29407403  55.7469974
 [81,]   -9.1059419 13.362741  -35.58731586  17.1125152
 [82,]   23.4528776 11.418263    1.09776377  45.4051259
 [83,]    4.2162972  9.761810  -15.11999341  23.2313284
 [84,]   20.7476167  8.562210    3.73736897  37.0929335
 [85,]    1.6173363  8.026970  -14.12084787  17.1542140
 [86,]    5.0215558  8.285854  -10.74474097  20.7856259
 [87,]   -3.9424246  9.272585  -21.95125188  13.8046983
 [88,]  -13.8638050 10.789281  -34.73687084   7.1499737
 [89,]  -13.2007855 12.646685  -37.61274465  11.0985562
 [90,]  -11.4883659 14.716353  -39.89298563  16.9982918
 [91,]   26.5708915 12.947497    0.26896010  50.8590013
 [92,]    8.8793107 11.075245  -13.31058907  29.7607954
 [93,]  -32.4460701  9.499061  -51.72239515 -14.4733716
 [94,]    2.9341492  8.387553  -13.61622647  18.8876752
 [95,]    3.4135684  7.938368  -12.05216401  19.0267330
 [96,]   10.3888876  8.260272   -5.84318480  26.3464069
 [97,]    3.6797068  9.273308  -14.49152382  21.4665230
 [98,]   -3.0188740 10.784441  -23.99485330  17.3882952
 [99,]   17.0223452 12.615936   -8.14752145  40.7199679
[100,]    0.9439644 14.648115  -28.24663263  28.7579934
[101,]    9.6398747 12.936958  -14.74481679  35.8692843
[102,]   -7.7249848 11.107947  -28.83223546  14.9174385
[103,]  -10.6944444  9.556395  -28.81731950   8.4526001
[104,]   -6.2764039  8.436792  -22.60347155  10.3861012
[105,]  -22.0664635  7.934157  -37.46426979  -6.6155565
[106,]  -14.5807230  8.163261  -30.17561410   1.9167422
[107,]  -14.3686826  9.068815  -31.62114081   3.7078278
[108,]    0.5901579 10.476860  -20.15419089  21.5262624
[109,]   17.1903984 12.214842   -7.09522547  41.9042281
[110,]   20.9765388 14.161805   -7.35264992  49.7296148
[111,]   17.4752752 13.542142   -8.02530383  44.7186260
[112,]  -12.3975034 11.576268  -34.59288874  10.9465999
[113,]  -16.6774821  9.876678  -35.97271814   3.1837935
[114,]  -34.3852608  8.602670  -51.53249268 -17.5209129
[115,]  -38.0261394  7.961250  -53.63073221 -22.3973011
[116,]    5.7517819  8.104041  -10.38893501  21.4485355
[117,]   38.4413033  8.993768   21.31308747  55.9635688
[118,]    4.8849246 10.441199  -15.49039047  25.4539947
[119,]   19.4234459 12.250217   -4.91290259  43.2608987
[120,]   -3.0413327 14.284096  -31.04410951  24.8464086
[121,]   -5.3590167 12.865711  -30.38493886  20.1161855
[122,]   36.6975355 11.019685   15.52192885  58.3713204
[123,]   -0.9407123  9.453214  -19.35472066  17.2929303
[124,]    2.2799399  8.325619  -13.86758656  18.3995522
[125,]  -13.9563079  7.828888  -29.17662150   1.5584830
[126,]   11.3753443  8.080217   -4.47133427  27.2459572
[127,]  -12.9862036  9.017273  -31.32224689   4.4896999
[128,]  -41.6118514 10.457313  -63.36890255 -21.1155578
[129,]    5.8599008 12.223847  -19.54910896  29.7506505
[130,]   24.4090530 14.195505   -4.72950613  52.2154732
[131,]  -50.1479327 13.060249  -76.00244411 -24.4718800
[132,]   12.2585714 11.201972  -10.12304471  34.5086858
[133,]   26.8328755  9.610340    7.70888140  45.9829959
[134,]   32.6995797  8.437620   16.05360710  49.3003112
[135,]   20.4739838  7.873284    4.97190631  36.0815339
[136,]   10.4521879  8.046374   -5.13170665  26.4703991
[137,]   -2.0602080  8.914036  -19.06344304  15.6876563
[138,]  -10.1645039 10.302247  -29.84952401  10.0700910
[139,]   -9.0667998 12.032162  -32.40619670  14.5835871
[140,]  -10.2759956 13.977479  -37.30335437  16.8775327
[141,]   17.2766677 12.645412   -7.92205025  42.2077845
[142,]    2.4459929 10.893307  -18.92610207  23.6975969
[143,]  -20.0925819  9.420651  -38.67771542  -1.8952893
[144,]  -11.0224567  8.376158  -27.83213178   5.2363025
[145,]   14.7990685  7.930839   -1.27967636  30.2545382
[146,]    5.8462937  8.183106  -10.40470151  22.2479280
[147,]  -24.5759811  9.074970  -42.73882230  -6.4051651
[148,]   14.0675441 10.443838   -6.53180917  35.4096544
[149,]   -5.1194307 12.129273  -29.19990147  19.3610011
[150,]    9.7695944 14.017547  -17.62274481  37.8247601
[151,]   -1.4065289 13.378550  -26.81234077  25.2114561
[152,]   -7.2414715 11.414129  -28.96411438  15.4460349
[153,]  -17.9586142  9.735240  -36.81038911   1.2242045
[154,]  -31.4808568  8.512534  -47.94822125 -14.9673251
[155,]  -19.5109994  7.959105  -34.71493470  -4.0875447
[156,]   42.0509580  8.211411   26.04490530  58.1238852
[157,]  -36.0890847  9.203422  -54.16728048 -18.0245979
[158,]   15.2538727 10.731937   -6.13303265  36.7009574
[159,]   17.7369301 12.603244   -7.40171931  43.0489850
[160,]    9.7082874 14.686893  -19.32319738  38.9006771
[161,]   17.4690494 12.076482   -6.40314817  41.2398610
[162,]   10.6087458 10.426686   -9.91778288  31.1200140
[163,]    6.6421422  9.070047  -11.20172227  24.4859659
[164,]    1.1100385  8.154223  -14.80008427  16.9351471
[165,]  -10.9316651  7.835342  -26.36681144   4.4548948
[166,]  -15.0128687  8.183485  -30.82043829   1.0745371
[167,]  -49.6817723  9.122603  -67.26643372 -31.8384461
[168,]  -13.7396760 10.495236  -33.94847457   6.9346434
[169,]   22.9877204 12.155397   -0.42095621  46.5401719
[170,]   32.2535168 14.001178    5.45142636  59.7547098
[171,]    6.0485000 12.739364  -18.80067556  31.3175274
[172,]   -1.7012480 10.967120  -22.98055544  20.0922007
[173,]   10.6095039  9.484299   -7.68868989  29.2788860
[174,]   11.8322559  8.444760   -4.08945271  28.2349708
[175,]  -23.4387922  8.022710  -38.74810461  -7.5459842
[176,]    7.1841598  8.312739   -8.63016342  23.6593287
[177,]    0.2463117  9.248094  -17.74045896  18.8495947
[178,]   -2.8276363 10.660240  -23.83675065  18.5787079
[179,]   11.2821156 12.387173  -13.03181760  35.9860704
[180,]   -5.5480324 14.315419  -33.35143624  23.3675141</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.4  3.3
looic      1769.8 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   423       
 (0.5, 0.7]   (ok)         2    1.1%   198       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.2
p_loo        33.8  8.2
looic      1721.9 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   662       
 (0.5, 0.7]   (ok)         7    3.9%   73        
   (0.7, 1]   (bad)        1    0.6%   39        
   (1, Inf)   (very bad)   1    0.6%   32        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -24.0      11.5  
fit_sleep1 -92.2      20.8  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.2 10.5
p_loo         3.1  0.5
looic      1906.4 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.9 14.4
p_loo        19.4  3.3
looic      1769.8 28.7
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   423       
 (0.5, 0.7]   (ok)         2    1.1%   198       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.0 22.2
p_loo        33.8  8.2
looic      1721.9 44.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     171   95.0%   662       
 (0.5, 0.7]   (ok)         7    3.9%   73        
   (0.7, 1]   (bad)        1    0.6%   39        
   (1, Inf)   (very bad)   1    0.6%   32        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.0     22.2        33.8    8.2   1721.9
fit_sleep2  -24.0      11.5  -884.9     14.4        19.4    3.3   1769.8
fit_sleep1  -92.2      20.8  -953.2     10.5         3.1    0.5   1906.4
           se_looic
fit_sleep3   44.3  
fit_sleep2   28.7  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
8.676707e-41 3.950542e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.86      1.54      0.3     5.31       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.14      1.54    -3.29     2.73       5.38      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.4.0         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.1       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
