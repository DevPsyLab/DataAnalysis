<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing
adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.00      6.73    15.85    41.97 1.00     1868     2587
sd(Days)                6.59      1.53     4.17    10.06 1.00     1296     1677
cor(Intercept,Days)     0.08      0.30    -0.47     0.65 1.01      714     1743

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.15      7.41   236.74   265.75 1.00     1855     2167
Days         10.32      1.64     7.06    13.59 1.00     1529     2077

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.55    23.08    29.02 1.00     3310     2920

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7266  13.27754 227.0493 278.7437
309 211.3758  13.10322 185.8240 236.9440
310 212.7583  12.79576 187.5548 237.7180
330 274.3586  13.47479 249.4937 301.2660
331 273.2129  12.86312 248.5413 299.3205
332 260.3183  12.49435 235.0773 285.6427
333 268.1700  12.67845 244.1587 294.4017
334 244.2392  12.61885 218.4352 268.3356
335 250.7436  13.33949 225.3911 277.2888
337 285.9571  12.92814 260.6856 311.0804
349 226.5630  13.12804 200.5530 252.2191
350 238.4790  13.00469 211.9066 263.8935
351 255.5567  12.63106 231.4220 280.2603
352 272.0470  12.23894 248.1130 296.3220
369 254.7314  12.13313 230.3067 278.6276
370 226.2331  13.38507 199.6911 252.1445
371 252.2415  11.98670 229.1446 275.7582
372 263.5383  12.44795 240.0939 288.2666

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6608885  2.524104 14.7749338 24.584379
309  1.7995693  2.464458 -2.9639788  6.678291
310  4.9637056  2.449554  0.1280646  9.753977
330  5.7698448  2.540580  0.6503140 10.607507
331  7.4803333  2.470192  2.5060398 12.324662
332 10.2583375  2.367310  5.5218871 14.821134
333 10.2366908  2.370244  5.4499325 14.859784
334 11.5505607  2.402463  6.9822736 16.221010
335 -0.2581993  2.551868 -5.3721108  4.548592
337 19.1457318  2.430245 14.4677481 23.962952
349 11.5508240  2.448638  6.8783641 16.320930
350 17.0656333  2.464390 12.4298947 22.042326
351  7.5593501  2.427080  2.8059995 12.227674
352 14.0332615  2.329361  9.4940374 18.587398
369 11.3675550  2.309748  6.8059399 15.967048
370 15.2380915  2.528719 10.2806194 20.235618
371  9.4659013  2.313033  4.9755755 13.925524
372 11.7440925  2.347779  7.1724214 16.190564</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7266 13.277543 227.0493 278.7437
  [2,] 273.3875 11.357621 250.6407 294.7282
  [3,] 293.0484  9.718035 273.6166 311.3607
  [4,] 312.7093  8.522150 296.0821 328.8590
  [5,] 332.3702  7.972207 317.1298 347.8312
  [6,] 352.0311  8.199228 336.4847 368.1422
  [7,] 371.6920  9.145534 353.8861 389.3669
  [8,] 391.3529 10.620568 370.6531 411.9602
  [9,] 411.0137 12.437617 387.0883 435.5319
 [10,] 430.6746 14.468393 402.6754 458.6582
 [11,] 211.3758 13.103221 185.8240 236.9440
 [12,] 213.1754 11.241208 191.4314 235.1843
 [13,] 214.9750  9.653095 196.2576 234.3626
 [14,] 216.7745  8.493929 199.8997 233.6299
 [15,] 218.5741  7.953523 202.8145 233.9033
 [16,] 220.3737  8.155815 204.4056 236.6815
 [17,] 222.1732  9.051145 204.5716 239.7076
 [18,] 223.9728 10.463090 203.4063 244.4351
 [19,] 225.7724 12.213778 202.0027 249.7363
 [20,] 227.5720 14.178279 200.0307 255.4578
 [21,] 212.7583 12.795760 187.5548 237.7180
 [22,] 217.7221 10.972677 196.0584 238.5722
 [23,] 222.6858  9.437608 203.9849 241.0110
 [24,] 227.6495  8.350921 211.5118 243.9858
 [25,] 232.6132  7.899869 216.9849 248.5679
 [26,] 237.5769  8.190153 221.5620 253.9781
 [27,] 242.5406  9.151498 224.5167 260.4241
 [28,] 247.5043 10.602917 226.2767 268.0163
 [29,] 252.4680 12.373132 227.3631 276.6376
 [30,] 257.4317 14.344601 228.6306 285.1484
 [31,] 274.3586 13.474788 249.4937 301.2660
 [32,] 280.1285 11.526193 258.5808 302.7532
 [33,] 285.8983  9.851164 267.5874 305.6983
 [34,] 291.6682  8.610855 275.2123 308.6930
 [35,] 297.4380  8.009827 281.5887 313.3631
 [36,] 303.2079  8.190051 287.0654 318.9801
 [37,] 308.9777  9.105253 291.2629 326.8762
 [38,] 314.7476 10.566145 293.8011 335.5618
 [39,] 320.5174 12.381046 296.0925 345.0798
 [40,] 326.2873 14.416875 297.3004 354.9277
 [41,] 273.2129 12.863123 248.5413 299.3205
 [42,] 280.6932 10.996111 259.9007 302.7555
 [43,] 288.1735  9.411305 270.0953 306.7871
 [44,] 295.6539  8.272518 279.7020 311.6700
 [45,] 303.1342  7.778185 287.6225 318.2810
 [46,] 310.6145  8.047947 294.3472 326.4603
 [47,] 318.0949  9.013459 300.0195 336.0405
 [48,] 325.5752 10.484232 304.5771 346.4122
 [49,] 333.0555 12.280045 308.4109 357.0500
 [50,] 340.5359 14.278781 311.9892 368.4636
 [51,] 260.3183 12.494354 235.0773 285.6427
 [52,] 270.5766 10.781638 248.9237 292.1966
 [53,] 280.8349  9.358785 262.0829 299.7332
 [54,] 291.0933  8.374863 274.4719 308.1716
 [55,] 301.3516  7.993629 285.5738 317.3225
 [56,] 311.6100  8.298566 295.3630 328.3669
 [57,] 321.8683  9.221855 303.6892 340.1164
 [58,] 332.1266 10.603176 311.0897 353.2145
 [59,] 342.3850 12.289036 317.9572 366.2973
 [60,] 352.6433 14.171160 324.4924 379.9783
 [61,] 268.1700 12.678450 244.1587 294.4017
 [62,] 278.4067 10.936781 257.1693 300.7167
 [63,] 288.6434  9.472031 270.4591 307.9140
 [64,] 298.8800  8.429810 282.5866 315.5844
 [65,] 309.1167  7.977476 293.6131 324.5119
 [66,] 319.3534  8.213080 303.4414 335.2689
 [67,] 329.5901  9.083246 311.7774 347.3203
 [68,] 339.8268 10.430347 319.2517 360.0306
 [69,] 350.0635 12.096075 326.6957 373.7621
 [70,] 360.3002 13.966891 333.2321 388.1782
 [71,] 244.2392 12.618851 218.4352 268.3356
 [72,] 255.7897 10.822213 233.7879 276.7005
 [73,] 267.3403  9.303162 248.7225 285.4120
 [74,] 278.8909  8.217117 262.7278 295.0065
 [75,] 290.4414  7.748345 275.4140 305.6322
 [76,] 301.9920  8.006019 286.7826 318.1643
 [77,] 313.5426  8.927457 296.2009 331.6510
 [78,] 325.0931 10.336648 304.7936 345.5807
 [79,] 336.6437 12.063861 313.0736 360.1600
 [80,] 348.1942 13.991813 321.0366 375.6356
 [81,] 250.7436 13.339493 225.3911 277.2888
 [82,] 250.4854 11.390006 228.8473 273.3053
 [83,] 250.2272  9.723500 231.2005 269.3334
 [84,] 249.9690  8.507922 233.3379 266.5350
 [85,] 249.7108  7.952803 233.8895 265.4987
 [86,] 249.4526  8.193502 233.3544 265.6436
 [87,] 249.1944  9.167548 231.2533 267.2234
 [88,] 248.9362 10.676069 227.7690 269.8947
 [89,] 248.6780 12.527451 223.6541 273.0924
 [90,] 248.4198 14.591767 219.7935 277.0286
 [91,] 285.9571 12.928144 260.6856 311.0804
 [92,] 305.1029 11.106811 283.9963 326.8890
 [93,] 324.2486  9.560219 305.7461 343.4362
 [94,] 343.3943  8.440763 326.8396 360.1326
 [95,] 362.5400  7.931416 347.1124 378.4776
 [96,] 381.6858  8.147417 365.3986 397.8619
 [97,] 400.8315  9.036905 382.7063 418.9642
 [98,] 419.9772 10.428953 399.1575 440.4104
 [99,] 439.1230 12.152064 415.1835 463.1979
[100,] 458.2687 14.085255 430.4011 486.1858
[101,] 226.5630 13.128036 200.5530 252.2191
[102,] 238.1139 11.273257 215.9551 260.2596
[103,] 249.6647  9.686020 230.7650 269.2107
[104,] 261.2155  8.517235 244.4698 278.5333
[105,] 272.7663  7.953570 257.2112 288.9227
[106,] 284.3172  8.122001 268.5147 300.5133
[107,] 295.8680  8.981436 278.5160 313.5280
[108,] 307.4188 10.361329 287.1457 327.8924
[109,] 318.9696 12.084690 295.0804 342.3569
[110,] 330.5205 14.025477 302.8570 357.1480
[111,] 238.4790 13.004695 211.9066 263.8935
[112,] 255.5446 11.111668 232.9736 277.2615
[113,] 272.6102  9.484866 253.4871 290.9184
[114,] 289.6759  8.282671 273.1112 306.0456
[115,] 306.7415  7.706428 291.5915 322.0930
[116,] 323.8071  7.894419 308.8424 339.6855
[117,] 340.8728  8.797791 323.5035 357.9959
[118,] 357.9384 10.228725 337.8456 377.7717
[119,] 375.0040 11.999957 352.0319 399.0474
[120,] 392.0697 13.982759 365.1260 420.1477
[121,] 255.5567 12.631058 231.4220 280.2603
[122,] 263.1161 10.834345 242.2185 284.2781
[123,] 270.6754  9.327587 252.6964 289.1906
[124,] 278.2348  8.270801 262.0806 294.4712
[125,] 285.7941  7.847921 270.3513 301.6724
[126,] 293.3535  8.158125 277.7987 309.5199
[127,] 300.9128  9.126970 283.3351 319.0043
[128,] 308.4722 10.574951 287.7885 329.5918
[129,] 316.0315 12.334465 291.5955 340.6561
[130,] 323.5909 14.290903 295.3510 352.3020
[131,] 272.0470 12.238943 248.1130 296.3220
[132,] 286.0802 10.570047 265.2618 306.9318
[133,] 300.1135  9.193035 281.7383 317.9148
[134,] 314.1468  8.255287 297.8889 330.3203
[135,] 328.1800  7.914510 312.5498 343.5310
[136,] 342.2133  8.245060 325.9673 358.5446
[137,] 356.2466  9.174661 338.4839 373.9379
[138,] 370.2798 10.546073 349.7521 390.6939
[139,] 384.3131 12.211337 360.3620 407.9111
[140,] 398.3463 14.066474 370.9340 425.5716
[141,] 254.7314 12.133132 230.3067 278.6276
[142,] 266.0989 10.499432 245.0197 286.9344
[143,] 277.4665  9.161503 259.2381 295.5212
[144,] 288.8340  8.264265 272.3868 304.9182
[145,] 300.2016  7.958196 284.8851 315.5128
[146,] 311.5692  8.308885 295.4503 327.9553
[147,] 322.9367  9.241868 304.6510 341.3980
[148,] 334.3043 10.604553 313.6690 355.3014
[149,] 345.6718 12.254421 321.8612 369.5706
[150,] 357.0394 14.090955 329.7038 384.7721
[151,] 226.2331 13.385065 199.6911 252.1445
[152,] 241.4712 11.463770 218.3831 263.5175
[153,] 256.7093  9.821656 237.0151 275.4614
[154,] 271.9474  8.619784 255.0462 288.1923
[155,] 287.1855  8.057622 271.5791 302.8565
[156,] 302.4236  8.266722 286.4170 318.5021
[157,] 317.6617  9.194617 299.7678 335.4825
[158,] 332.8998 10.655144 312.2723 353.4815
[159,] 348.1378 12.462426 324.1376 372.0915
[160,] 363.3759 14.487265 335.4019 391.5559
[161,] 252.2415 11.986700 229.1446 275.7582
[162,] 261.7074 10.299417 241.7212 282.0479
[163,] 271.1733  8.898047 253.7760 288.6906
[164,] 280.6392  7.935536 265.2823 296.4018
[165,] 290.1051  7.580928 274.9582 304.9404
[166,] 299.5710  7.916340 284.0050 314.9146
[167,] 309.0369  8.863784 291.4248 326.1036
[168,] 318.5028 10.255005 298.3026 338.5628
[169,] 327.9687 11.935822 304.1435 351.1253
[170,] 337.4346 13.800826 310.2574 363.9232
[171,] 263.5383 12.447949 240.0939 288.2666
[172,] 275.2824 10.719664 254.9885 297.0090
[173,] 287.0265  9.267960 269.7407 305.7572
[174,] 298.7706  8.240335 283.3144 315.2570
[175,] 310.5147  7.806105 295.7875 325.9691
[176,] 322.2587  8.061735 306.7266 338.2215
[177,] 334.0028  8.948296 316.9094 351.6307
[178,] 345.7469 10.304202 325.8133 366.0865
[179,] 357.4910 11.971018 333.7791 381.2494
[180,] 369.2351 13.836839 342.0892 396.5846</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.1666343 13.277543  -29.1837428  22.5107253
  [2,]  -14.6828228 11.357621  -36.0235084   8.0639828
  [3,]  -42.2478113  9.718035  -60.5600938 -22.8160199
  [4,]    8.7305002  8.522150   -7.4191539  25.3577342
  [5,]   24.4817117  7.972207    9.0206545  39.7220862
  [6,]   62.6590232  8.199228   46.5478884  78.2054127
  [7,]   10.5118347  9.145534   -7.1630979  28.3177007
  [8,] -101.2042538 10.620568 -121.8116479 -80.5044728
  [9,]   19.5715577 12.437617   -4.9465770  43.4970365
 [10,]   35.6788692 14.468393    7.6953183  63.6781215
 [11,]   11.3580712 13.103221  -14.2100922  36.9099045
 [12,]   -7.9095981 11.241208  -29.9184549  13.8343529
 [13,]  -11.9971674  9.653095  -31.3848243   6.7202091
 [14,]  -12.0675367  8.493929  -28.9229180   4.8073390
 [15,]  -10.8580060  7.953523  -26.1872065   4.9015604
 [16,]   -4.4118753  8.155815  -20.7197285  11.5562496
 [17,]   -8.5429446  9.051145  -26.0773481   9.0587230
 [18,]   -6.2456139 10.463090  -26.7079089  14.3209438
 [19,]   -1.4766832 12.213778  -25.4405527  22.2930012
 [20,]    9.7422475 14.178279  -18.1435558  37.2834582
 [21,]  -13.7044465 12.795760  -38.6640719  11.4991499
 [22,]  -23.3898521 10.972677  -44.2399650  -1.7262407
 [23,]   11.6342422  9.437608   -6.6910043  30.3351167
 [24,]    5.1921366  8.350921  -11.1442178  21.3297947
 [25,]   -3.3057690  7.899869  -19.2605147  12.3224681
 [26,]  -17.1189747  8.190153  -33.5201823  -1.1040818
 [27,]   -7.1197803  9.151498  -25.0033114  10.9041039
 [28,]    8.2468141 10.602917  -12.2651909  29.4743883
 [29,]    8.5445085 12.373132  -15.6251031  33.6493942
 [30,]   -9.9163972 14.344601  -37.6330882  18.8847009
 [31,]   47.1839509 13.474788   20.2765815  72.0489329
 [32,]   20.2717061 11.526193   -2.3529627  41.8194226
 [33,]   -2.0418386  9.851164  -21.8417620  16.2691314
 [34,]   -6.5351834  8.610855  -23.5600057   9.9207244
 [35,]  -11.6407282  8.009827  -27.5657987   4.2086082
 [36,]   -5.6223730  8.190051  -21.3945670  10.5200835
 [37,]  -28.7381178  9.105253  -46.6365692 -11.0233170
 [38,]    3.5137374 10.566145  -17.3004581  24.4601744
 [39,]  -15.1679074 12.381046  -39.7303377   9.2569868
 [40,]   27.7614479 14.416875   -0.8789560  56.7483385
 [41,]   14.3950364 12.863123  -11.7126498  39.0665753
 [42,]    4.3068031 10.996111  -17.7555421  25.0993196
 [43,]   13.6470698  9.411305   -4.9665141  31.7252573
 [44,]   24.4614365  8.272518    8.4453156  40.4133441
 [45,]   13.1431032  7.778185   -2.0036748  28.6548089
 [46,]  -17.2958301  8.047947  -33.1416239  -1.0284945
 [47,]  -28.0198634  9.013459  -45.9655201  -9.9445346
 [48,]    9.2425033 10.484232  -11.5945309  30.2405833
 [49,]  -39.3086300 12.280045  -63.3030788 -14.6640260
 [50,]   31.0452366 14.278781    3.1174943  59.5919182
 [51,]  -25.4576677 12.494354  -50.7821482  -0.2167379
 [52,]  -27.7648052 10.781638  -49.3847965  -6.1119011
 [53,]   -7.8736428  9.358785  -26.7718834  10.8784234
 [54,]   18.6755197  8.374863    1.5971543  35.2968742
 [55,]   16.1112821  7.993629    0.1404135  31.8891391
 [56,]   -1.6123554  8.298566  -18.3692927  14.6345751
 [57,]  132.2936071  9.221855  114.0455126 150.4726872
 [58,]   14.7044695 10.603176   -6.3833874  35.7414211
 [59,]  -12.0846680 12.289036  -35.9970304  12.3431368
 [60,]  -98.7789056 14.171160 -126.1139184 -70.6280020
 [61,]   15.6724252 12.678450  -10.5592644  39.6837414
 [62,]   11.1483343 10.936781  -11.1617086  32.3856743
 [63,]  -11.8740565  9.472031  -31.1446510   6.3101617
 [64,]    0.9296527  8.429810  -15.7747364  17.2231476
 [65,]  -11.9457382  7.977476  -27.3409315   3.5579471
 [66,]   18.8130710  8.213080    2.8976443  34.7251295
 [67,]    2.4363801  9.083246  -15.2937895  20.2490683
 [68,]    9.0130893 10.430347  -11.1906687  29.5882481
 [69,]  -16.7035015 12.096075  -40.4021156   6.6642636
 [70,]    1.7426076 13.966891  -26.1354186  28.8106762
 [71,]   21.2339138 12.618851   -2.8625460  47.0379069
 [72,]   20.4114531 10.822213   -0.4993072  42.4132680
 [73,]  -23.9756077  9.303162  -42.0472639  -5.3578454
 [74,]  -24.2185684  8.217117  -40.3341607  -8.0554536
 [75,]  -11.4170291  7.748345  -26.6077575   3.6104000
 [76,]  -17.8007898  8.006019  -33.9730814  -2.5913871
 [77,]   -8.0177505  8.927457  -26.1261731   9.3238712
 [78,]    6.4297887 10.336648  -14.0578236  26.7293120
 [79,]   -0.8967720 12.063861  -24.4130661  22.6732620
 [80,]   29.1047673 13.991813    1.6634392  56.2623791
 [81,]   -9.1353426 13.339493  -35.6805302  16.2171829
 [82,]   23.4617567 11.390006    0.6418984  45.0999288
 [83,]    4.2634560  9.723500  -14.8427233  23.2901549
 [84,]   20.8330554  8.507922    4.2671256  37.4641741
 [85,]    1.7410547  7.952803  -14.0467522  17.5624260
 [86,]    5.1835540  8.193502  -11.0073984  21.2818237
 [87,]   -3.7421466  9.167548  -21.7710588  14.1990093
 [88,]  -13.6252473 10.676069  -34.5836955   7.5419631
 [89,]  -12.9239480 12.527451  -37.3383220  12.0999989
 [90,]  -11.1732486 14.591767  -39.7819992  17.4530580
 [91,]   26.4094811 12.928144    1.2861865  51.6810447
 [92,]    8.7029493 11.106811  -13.0832226  29.8094645
 [93,]  -32.6373825  9.560219  -51.8249943 -14.1348657
 [94,]    2.7278856  8.440763  -14.0103530  19.2825663
 [95,]    3.1923538  7.931416  -12.7451645  18.6200358
 [96,]   10.1527220  8.147417   -6.0234165  26.4399032
 [97,]    3.4285901  9.036905  -14.7041218  21.5538020
 [98,]   -3.2849417 10.428953  -23.7181105  17.5348480
 [99,]   16.7413265 12.152064   -7.3336032  40.6808270
[100,]    0.6479946 14.085255  -27.2690663  28.5155721
[101,]    9.5401639 13.128036  -16.1158759  35.5501757
[102,]   -7.7971601 11.273257  -29.9429338  14.3616119
[103,]  -10.7390840  9.686020  -30.2850827   8.1605559
[104,]   -6.2935080  8.517235  -23.6113478  10.4522035
[105,]  -22.0560320  7.953570  -38.2124268  -6.5009125
[106,]  -14.5427559  8.122001  -30.7389015   1.2597474
[107,]  -14.3031799  8.981436  -31.9631649   3.0488332
[108,]    0.6831961 10.361329  -19.7904442  20.9562898
[109,]   17.3109722 12.084690   -6.0763152  41.2002175
[110,]   21.1246482 14.025477   -5.5028597  48.7880737
[111,]   17.8178327 13.004695   -7.5967120  44.3902380
[112,]  -12.0903006 11.111668  -33.8072227  10.4807277
[113,]  -16.4056339  9.484866  -34.7138360   2.7174648
[114,]  -34.1487672  8.282671  -50.5184528 -17.5841091
[115,]  -37.8250006  7.706428  -53.1764758 -22.6750440
[116,]    5.9175661  7.894419   -9.9607716  20.8823417
[117,]   38.5717328  8.797791   21.4485546  55.9410320
[118,]    4.9799995 10.228725  -14.8533460  25.0728285
[119,]   19.4831662 11.999957   -4.5601903  42.4553010
[120,]   -3.0169672 13.982759  -31.0950397  23.9266732
[121,]   -5.0302027 12.631058  -29.7337728  19.1045097
[122,]   36.9415472 10.834345   15.7794921  57.8390710
[123,]   -0.7815029  9.327587  -19.2966750  17.1975239
[124,]    2.3543471  8.270801  -13.8821268  18.5084767
[125,]  -13.9667030  7.847921  -29.8450236   1.4761382
[126,]   11.2801469  8.158125   -4.8863239  26.8349183
[127,]  -13.1662032  9.126970  -31.2576739   4.4114832
[128,]  -41.8766532 10.574951  -62.9962970 -21.1929758
[129,]    5.5102967 12.334465  -19.1142740  29.9463142
[130,]   23.9746466 14.290903   -4.7365057  52.2144695
[131,]  -50.3698859 12.238943  -74.6448549 -26.4359251
[132,]   12.1136526 10.570047   -8.7378639  32.9321465
[133,]   26.7649911  9.193035    8.9637117  45.1402012
[134,]   32.7087297  8.255287   16.5351871  48.9666267
[135,]   20.5601682  7.914510    5.2091517  36.1903628
[136,]   10.6154068  8.245060   -5.7159367  26.8613567
[137,]   -1.8199547  9.174661  -19.5113234  15.9427340
[138,]   -9.8472161 10.546073  -30.2613311  10.6804904
[139,]   -8.6724776 12.211337  -32.2705256  15.2785686
[140,]   -9.8046391 14.066474  -37.0299485  17.6076730
[141,]   17.1921201 12.133132   -6.7040610  41.6167507
[142,]    2.3379651 10.499432  -18.4975259  23.4172141
[143,]  -20.2240899  9.161503  -38.2787923  -1.9957063
[144,]  -11.1774450  8.264265  -27.2616332   5.2698452
[145,]   14.6206000  7.958196   -0.6906407  29.9370675
[146,]    5.6443449  8.308885  -10.7417533  21.7631677
[147,]  -24.8014101  9.241868  -43.2627219  -6.5156625
[148,]   13.8186349 10.604553   -7.1784894  34.4538714
[149,]   -5.3918202 12.254421  -29.2905800  18.4187970
[150,]    9.4737248 14.090955  -18.2590144  36.8093024
[151,]   -0.9691119 13.385065  -26.8804766  25.5728752
[152,]   -6.9477033 11.463770  -28.9939547  16.1404001
[153,]  -17.8084948  9.821656  -36.5606114   1.8857439
[154,]  -31.4743863  8.619784  -47.7193311 -14.5732348
[155,]  -19.6481778  8.057622  -35.3192437  -4.0417842
[156,]   41.7701308  8.266722   25.6915931  57.7767363
[157,]  -36.5135607  9.194617  -54.3344395 -18.6196532
[158,]   14.6857478 10.655144   -5.8960274  35.3132321
[159,]   17.0251564 12.462426   -6.9284935  41.0253714
[160,]    8.8528649 14.487265  -19.3270978  36.8269004
[161,]   17.6389185 11.986700   -5.8778033  40.7357667
[162,]   10.7354172 10.299417   -9.6050876  30.7216451
[163,]    6.7256158  8.898047  -10.7917458  24.1228545
[164,]    1.1503145  7.935536  -14.6122634  16.5072238
[165,]  -10.9345868  7.580928  -25.7698507   4.2122703
[166,]  -15.0589882  7.916340  -30.4026375   0.5070113
[167,]  -49.7710895  8.863784  -66.8377662 -32.1590497
[168,]  -13.8721908 10.255005  -33.9322271   6.3280094
[169,]   22.8120078 11.935822   -0.3446492  46.6372358
[170,]   32.0346065 13.800826    5.5459972  59.2118128
[171,]    5.8734193 12.447949  -18.8549070  29.3177918
[172,]   -1.8083732 10.719664  -23.5349909  18.4855232
[173,]   10.5703343  9.267960   -8.1603939  27.8561007
[174,]   11.8610417  8.240335   -4.6253772  27.3171989
[175,]  -23.3420508  7.806105  -38.7964728  -8.6149486
[176,]    7.3488566  8.061735   -8.6138756  22.8809699
[177,]    0.4789641  8.948296  -17.1488701  17.5723646
[178,]   -2.5270285 10.304202  -22.8665823  17.4065932
[179,]   11.6506790 11.971018  -12.1076623  35.3625559
[180,]   -5.1115136 13.836839  -32.4609779  22.0344199</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.3
p_loo        19.6  3.3
looic      1770.2 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.3 22.7
p_loo        34.5  8.9
looic      1722.7 45.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   786       
 (0.5, 0.7]   (ok)         4    2.2%   487       
   (0.7, 1]   (bad)        2    1.1%   12        
   (1, Inf)   (very bad)   1    0.6%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.8      11.9  
fit_sleep1 -92.0      21.3  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.3
p_loo        19.6  3.3
looic      1770.2 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.3 22.7
p_loo        34.5  8.9
looic      1722.7 45.3
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     173   96.1%   786       
 (0.5, 0.7]   (ok)         4    2.2%   487       
   (0.7, 1]   (bad)        2    1.1%   12        
   (1, Inf)   (very bad)   1    0.6%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.3     22.7        34.5    8.9   1722.7
fit_sleep2  -23.8      11.9  -885.1     14.3        19.6    3.3   1770.2
fit_sleep1  -92.0      21.3  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   45.3  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.136483e-40 4.651526e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.55     0.31      5.4       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.55     -3.3     2.89       5.68      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.3           R6_2.5.1             colorspace_2.1-0    
 [13] withr_2.5.0          tidyselect_1.2.0     gridExtra_2.3       
 [16] prettyunits_1.1.1    processx_3.8.0       Brobdingnag_1.2-9   
 [19] curl_5.0.0           compiler_4.2.2       cli_3.6.0           
 [22] shinyjs_2.1.0        labeling_0.4.2       colourpicker_1.2.0  
 [25] posterior_1.3.1      sass_0.4.5           scales_1.2.1        
 [28] dygraphs_1.1.1.6     checkmate_2.1.0      mvtnorm_1.1-3       
 [31] callr_3.7.3          stringr_1.5.0        digest_0.6.31       
 [34] minqa_1.2.5          rmarkdown_2.20       base64enc_0.1-3     
 [37] pkgconfig_2.0.3      htmltools_0.5.4      highr_0.10          
 [40] fastmap_1.1.0        htmlwidgets_1.6.1    rlang_1.0.6         
 [43] shiny_1.7.4          jquerylib_0.1.4      farver_2.1.1        
 [46] generics_0.1.3       zoo_1.8-11           jsonlite_1.8.4      
 [49] gtools_3.9.4         crosstalk_1.2.0      dplyr_1.1.0         
 [52] distributional_0.3.1 inline_0.3.19        magrittr_2.0.3      
 [55] loo_2.5.1            bayesplot_1.10.0     munsell_0.5.0       
 [58] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     
 [61] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58.1       
 [64] plyr_1.8.8           pkgbuild_1.4.0       grid_4.2.2          
 [67] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        
 [70] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       
 [73] knitr_1.42           ps_1.7.2             pillar_1.8.1        
 [76] igraph_1.3.5         boot_1.3-28          markdown_1.5        
 [79] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    
 [82] stats4_4.2.2         rstantools_2.2.0     glue_1.6.2          
 [85] evaluate_0.20        V8_4.2.2             RcppParallel_5.1.6  
 [88] vctrs_0.5.2          nloptr_2.0.3         httpuv_1.6.8        
 [91] gtable_0.3.1         cachem_1.0.6         ggplot2_3.4.0       
 [94] xfun_0.37            mime_0.12            xtable_1.8-4        
 [97] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[100] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
