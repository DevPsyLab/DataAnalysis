<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="adobe.html">Adobe</a>
    </li>
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="hpc.html">High-Performance Computing</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="jamovi.html">jamovi</a>
    </li>
    <li>
      <a href="jsPsych.html">jsPsych</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="osf.html">Open Science Framework</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;DevPsyLab/petersenlab&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.70      6.87    15.33    41.72 1.00     1422     1811
sd(Days)                6.57      1.51     4.13     9.99 1.00     1463     1842
cor(Intercept,Days)     0.09      0.30    -0.50     0.68 1.01      820     1309

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.09      7.61   235.61   266.11 1.00     1787     2556
Days         10.43      1.67     7.24    13.86 1.00     1361     1656

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.94      1.56    23.05    29.20 1.00     3268     2603

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0606  13.15313 227.8916 279.5842
309 211.2299  13.66967 183.9436 236.9482
310 213.2017  13.55490 186.2640 239.2696
330 274.1908  13.40412 248.8558 300.9005
331 273.0187  12.83196 249.2216 299.1236
332 260.0925  12.18095 236.2940 284.4948
333 267.4595  12.67180 243.2113 293.3687
334 244.4518  12.51536 219.8505 269.0523
335 250.4826  13.63131 225.2275 277.9819
337 285.8249  13.14105 260.0653 311.6915
349 226.5448  12.80598 200.6079 250.9258
350 238.8704  13.20245 212.7066 264.0392
351 255.8564  12.17532 232.5827 280.0092
352 272.0958  12.88870 247.1823 297.7014
369 254.6991  12.22844 230.9272 279.5241
370 226.5307  13.56167 199.6306 252.3933
371 251.9696  12.47009 226.7855 276.2973
372 263.3099  12.38553 239.3157 288.1550

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5638173  2.479551 14.7728156 24.468831
309  1.7686004  2.579937 -3.3247581  6.830344
310  4.8587523  2.533138 -0.0389530  9.835685
330  5.7981108  2.524981  0.7354309 10.620662
331  7.4641809  2.448237  2.5949382 12.031781
332 10.2626258  2.335738  5.6886977 14.798217
333 10.3575520  2.425142  5.4806734 15.077539
334 11.4472514  2.351782  6.9549555 16.179302
335 -0.2133371  2.609954 -5.2361776  4.822366
337 19.1645918  2.501330 14.1809005 24.025124
349 11.5501785  2.465677  6.7503789 16.398333
350 17.0263381  2.516547 12.3584400 22.215895
351  7.4873214  2.351409  2.7928309 12.089177
352 14.0175264  2.394554  9.2744041 18.685108
369 11.3244990  2.378051  6.6937399 16.081775
370 15.1384583  2.570911 10.3192914 20.242169
371  9.5469326  2.384774  4.8019241 14.192363
372 11.8064685  2.354822  6.9968386 16.367139</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0606 13.153126 227.8916 279.5842
  [2,] 273.6244 11.252803 251.0114 295.4643
  [3,] 293.1883  9.619916 274.1900 311.3674
  [4,] 312.7521  8.411679 296.4215 328.9766
  [5,] 332.3159  7.827275 317.5030 347.6129
  [6,] 351.8797  8.004528 336.5768 367.3903
  [7,] 371.4435  8.898037 354.1582 389.0862
  [8,] 391.0073 10.323468 370.8507 411.5319
  [9,] 410.5712 12.094183 386.4810 434.2419
 [10,] 430.1350 14.080515 402.1654 457.8482
 [11,] 211.2299 13.669671 183.9436 236.9482
 [12,] 212.9985 11.688732 189.4807 235.2751
 [13,] 214.7671  9.985247 194.7041 234.1486
 [14,] 216.5357  8.723302 199.2213 233.8025
 [15,] 218.3043  8.111658 202.5479 234.7529
 [16,] 220.0729  8.295428 203.9589 236.4774
 [17,] 221.8415  9.227210 203.8100 239.7768
 [18,] 223.6101 10.713581 202.2677 244.3358
 [19,] 225.3787 12.559156 199.9779 249.7978
 [20,] 227.1473 14.628606 197.6914 254.9950
 [21,] 213.2017 13.554901 186.2640 239.2696
 [22,] 218.0605 11.609809 194.7398 240.7771
 [23,] 222.9193  9.933457 203.0745 242.3916
 [24,] 227.7780  8.682918 210.5010 244.7985
 [25,] 232.6368  8.058916 216.2929 248.7803
 [26,] 237.4955  8.205655 221.2393 253.5937
 [27,] 242.3543  9.085868 224.2357 260.1995
 [28,] 247.2130 10.516976 226.3875 267.7248
 [29,] 252.0718 12.308297 227.9736 276.2017
 [30,] 256.9305 14.325332 228.7889 285.1556
 [31,] 274.1908 13.404121 248.8558 300.9005
 [32,] 279.9889 11.455771 258.3861 302.4727
 [33,] 285.7870  9.774965 267.3091 304.7793
 [34,] 291.5851  8.521518 275.0056 307.9632
 [35,] 297.3832  7.901497 281.7591 312.6810
 [36,] 303.1813  8.062388 286.9954 319.0472
 [37,] 308.9794  8.962231 290.8479 326.3914
 [38,] 314.7775 10.411155 293.5784 334.9167
 [39,] 320.5757 12.215308 296.2766 343.7566
 [40,] 326.3738 14.240310 297.7145 353.5739
 [41,] 273.0187 12.831965 249.2216 299.1236
 [42,] 280.4829 11.020280 259.8296 302.6708
 [43,] 287.9471  9.498503 270.0950 306.8026
 [44,] 295.4113  8.425216 279.2206 312.2856
 [45,] 302.8755  7.983401 287.4297 318.6549
 [46,] 310.3396  8.274832 294.3535 326.5751
 [47,] 317.8038  9.230316 299.7565 336.0302
 [48,] 325.2680 10.672972 304.5644 346.5887
 [49,] 332.7322 12.434375 308.7018 357.5441
 [50,] 340.1964 14.398011 312.0176 368.8806
 [51,] 260.0925 12.180948 236.2940 284.4948
 [52,] 270.3552 10.514268 250.1322 291.5450
 [53,] 280.6178  9.145246 263.2994 298.9109
 [54,] 290.8804  8.223901 275.1228 306.7542
 [55,] 301.1431  7.908282 285.7384 316.6128
 [56,] 311.4057  8.268050 295.1548 327.5157
 [57,] 321.6683  9.224517 303.3851 339.8847
 [58,] 331.9309 10.617633 311.1163 352.8616
 [59,] 342.1936 12.299914 318.0448 366.3004
 [60,] 352.4562 14.168733 324.4759 380.4830
 [61,] 267.4595 12.671802 243.2113 293.3687
 [62,] 277.8170 10.875418 256.7699 300.1407
 [63,] 288.1746  9.366830 270.1068 307.2090
 [64,] 298.5321  8.304391 282.4952 315.0470
 [65,] 308.8897  7.870892 293.6416 323.8383
 [66,] 319.2473  8.167105 302.8135 334.6725
 [67,] 329.6048  9.122220 311.2561 347.0168
 [68,] 339.9624 10.558921 319.0000 360.2526
 [69,] 350.3199 12.309727 325.8214 373.7531
 [70,] 360.6775 14.259402 332.2165 387.6403
 [71,] 244.4518 12.515357 219.8505 269.0523
 [72,] 255.8990 10.805242 234.8206 277.0132
 [73,] 267.3463  9.377318 248.9503 285.5661
 [74,] 278.7935  8.377153 262.3321 295.1001
 [75,] 290.2408  7.967500 274.6608 305.3957
 [76,] 301.6880  8.236939 285.5645 317.5613
 [77,] 313.1353  9.125516 295.3541 331.0819
 [78,] 324.5825 10.476864 304.1914 345.0718
 [79,] 336.0298 12.137383 312.3726 360.2250
 [80,] 347.4770 13.997471 320.1488 374.8196
 [81,] 250.4826 13.631308 225.2275 277.9819
 [82,] 250.2693 11.633339 228.8227 274.2152
 [83,] 250.0559  9.923726 231.3512 269.9444
 [84,] 249.8426  8.674664 233.0434 267.0724
 [85,] 249.6293  8.102036 233.3551 265.7360
 [86,] 249.4159  8.346251 232.3772 265.2473
 [87,] 249.2026  9.343475 230.6175 267.0477
 [88,] 248.9893 10.888751 227.6698 270.3465
 [89,] 248.7759 12.784873 224.1557 273.5843
 [90,] 248.5626 14.898482 219.5425 277.3423
 [91,] 285.8249 13.141048 260.0653 311.6915
 [92,] 304.9895 11.257662 282.7240 326.9120
 [93,] 324.1541  9.658989 305.3443 342.9271
 [94,] 343.3187  8.507084 326.2964 359.9266
 [95,] 362.4833  7.997387 346.4564 377.7533
 [96,] 381.6479  8.249802 365.5265 397.3673
 [97,] 400.8125  9.201824 382.9768 418.2419
 [98,] 419.9771 10.667765 398.7091 440.6944
 [99,] 439.1417 12.467644 414.1951 463.2633
[100,] 458.3063 14.477445 429.9208 486.5614
[101,] 226.5448 12.805981 200.6079 250.9258
[102,] 238.0950 10.976576 215.8916 258.8845
[103,] 249.6451  9.441209 230.9262 267.3925
[104,] 261.1953  8.363418 244.9775 277.1223
[105,] 272.7455  7.931974 257.0988 287.8276
[106,] 284.2957  8.248926 267.7577 299.9669
[107,] 295.8459  9.237559 277.5053 313.9166
[108,] 307.3960 10.713511 286.1138 328.3981
[109,] 318.9462 12.505410 294.2608 343.2432
[110,] 330.4964 14.496564 301.8382 359.0519
[111,] 238.8704 13.202447 212.7066 264.0392
[112,] 255.8968 11.277237 233.2610 277.2844
[113,] 272.9231  9.628788 253.6786 291.5092
[114,] 289.9495  8.421227 273.4716 306.3538
[115,] 306.9758  7.860444 291.4704 322.1858
[116,] 324.0021  8.082210 308.4527 339.6656
[117,] 341.0285  9.029045 323.3457 358.4332
[118,] 358.0548 10.506723 337.2354 378.4832
[119,] 375.0811 12.325778 350.7714 399.4889
[120,] 392.1075 14.357033 364.1017 420.4692
[121,] 255.8564 12.175319 232.5827 280.0092
[122,] 263.3437 10.469149 242.9743 283.9851
[123,] 270.8310  9.056822 253.3456 288.5278
[124,] 278.3183  8.093652 262.7039 293.9935
[125,] 285.8057  7.748977 270.7404 301.1733
[126,] 293.2930  8.102119 277.3494 309.3527
[127,] 300.7803  9.071949 282.7184 318.8763
[128,] 308.2676 10.488776 287.6704 329.1007
[129,] 315.7550 12.197822 292.0796 339.3718
[130,] 323.2423 14.093173 295.7762 350.4473
[131,] 272.0958 12.888698 247.1823 297.7014
[132,] 286.1133 11.118098 264.2088 308.1978
[133,] 300.1308  9.621510 281.4140 318.9707
[134,] 314.1483  8.544156 297.2707 330.5149
[135,] 328.1659  8.056024 312.1215 343.7146
[136,] 342.1834  8.262216 326.0672 357.9519
[137,] 356.2009  9.115738 338.7972 373.9784
[138,] 370.2184 10.459299 349.9829 390.7672
[139,] 384.2360 12.131157 360.7385 408.3362
[140,] 398.2535 14.014307 370.8901 425.7570
[141,] 254.6991 12.228435 230.9272 279.5241
[142,] 266.0236 10.497360 245.7074 287.1747
[143,] 277.3481  9.064477 259.8124 295.7977
[144,] 288.6726  8.089819 272.9762 304.7975
[145,] 299.9971  7.748280 284.8728 315.3772
[146,] 311.3216  8.120147 295.1488 327.1222
[147,] 322.6461  9.118551 304.5860 340.5060
[148,] 333.9706 10.567375 313.3991 354.7627
[149,] 345.2951 12.308578 321.4128 369.7061
[150,] 356.6196 14.235275 329.0815 385.1423
[151,] 226.5307 13.561667 199.6306 252.3933
[152,] 241.6691 11.569018 219.0469 264.0304
[153,] 256.8076  9.848081 237.9657 275.8781
[154,] 271.9461  8.564251 255.1791 288.3546
[155,] 287.0845  7.932670 271.6457 302.0514
[156,] 302.2230  8.107237 286.2677 317.7519
[157,] 317.3614  9.041377 300.0035 334.8574
[158,] 332.4999 10.534935 312.4085 352.6717
[159,] 347.6384 12.387187 323.6950 371.5234
[160,] 362.7768 14.460951 335.0291 390.8098
[161,] 251.9696 12.470087 226.7855 276.2973
[162,] 261.5165 10.729131 240.0023 282.5147
[163,] 271.0635  9.278995 252.4519 289.2733
[164,] 280.6104  8.274027 263.9794 297.0176
[165,] 290.1573  7.886291 274.3985 305.7707
[166,] 299.7042  8.203777 283.5936 315.7258
[167,] 309.2512  9.153394 290.8381 326.7516
[168,] 318.7981 10.566058 297.6728 338.9090
[169,] 328.3450 12.283030 304.1915 351.9836
[170,] 337.8920 14.194308 309.4755 365.2943
[171,] 263.3099 12.385525 239.3157 288.1550
[172,] 275.1164 10.686129 254.1987 296.3970
[173,] 286.9229  9.277706 268.8258 305.6118
[174,] 298.7293  8.309555 282.4780 315.3894
[175,] 310.5358  7.944302 295.2006 326.3275
[176,] 322.3423  8.262296 306.5759 338.9108
[177,] 334.1488  9.192906 316.5005 352.2377
[178,] 345.9552 10.575627 325.6805 367.0780
[179,] 357.7617 12.258410 333.7520 381.9930
[180,] 369.5682 14.134487 341.5559 397.4790</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.5006201 13.153126  -30.0242295  21.6684407
  [2,]  -14.9197373 11.252803  -36.7596088   7.6933497
  [3,]  -42.3876546  9.619916  -60.5667688 -23.3893525
  [4,]    8.6877281  8.411679   -7.5368116  25.0183146
  [5,]   24.5360109  7.827275    9.2390418  39.3489113
  [6,]   62.8103936  8.004528   47.2997521  78.1133485
  [7,]   10.7602763  8.898037   -6.8824461  28.0456054
  [8,] -100.8587409 10.323468 -121.3832802 -80.7021463
  [9,]   20.0141418 12.094183   -3.6566026  44.1043049
 [10,]   36.2185245 14.080515    8.5053265  64.1880653
 [11,]   11.5040403 13.669671  -14.2142601  38.7902678
 [12,]   -7.7326601 11.688732  -30.0092963  15.7851141
 [13,]  -11.7892605  9.985247  -31.1707819   8.2736786
 [14,]  -11.8286609  8.723302  -29.0955489   5.4856939
 [15,]  -10.5881613  8.111658  -27.0368273   5.1681877
 [16,]   -4.1110616  8.295428  -20.5156318  12.0028886
 [17,]   -8.2111620  9.227210  -26.1465102   9.8202794
 [18,]   -5.8828624 10.713581  -26.6085613  15.4595184
 [19,]   -1.0829628 12.559156  -25.5020924  24.3177768
 [20,]   10.1669368 14.628606  -17.6808212  39.6228476
 [21,]  -14.1478476 13.554901  -40.2157114  12.7898710
 [22,]  -23.7282999 11.609809  -46.4448966  -0.4075639
 [23,]   11.4007478  9.933457   -8.0715751  31.2454622
 [24,]    5.0635955  8.682918  -11.9569273  22.3406112
 [25,]   -3.3293568  8.058916  -19.4728540  13.0144620
 [26,]  -17.0376091  8.205655  -33.1358306  -0.7814241
 [27,]   -6.9334614  9.085868  -24.7786772  11.1850744
 [28,]    8.5380863 10.516976  -11.9737230  29.3636307
 [29,]    8.9407340 12.308297  -15.1892478  33.0388539
 [30,]   -9.4152183 14.325332  -37.6403373  18.7264405
 [31,]   47.3518306 13.404121   20.6420710  72.6868199
 [32,]   20.4113198 11.455771   -2.0724592  42.0140789
 [33,]   -1.9304909  9.774965  -20.9228236  16.5473828
 [34,]   -6.4521017  8.521518  -22.8301621  10.1273507
 [35,]  -11.5859124  7.901497  -26.8837094   4.0382318
 [36,]   -5.5958232  8.062388  -21.4617308  10.5900888
 [37,]  -28.7398340  8.962231  -46.1517705 -10.6082699
 [38,]    3.4837553 10.411155  -16.6553593  24.6829199
 [39,]  -15.2261555 12.215308  -38.4070522   9.0728913
 [40,]   27.6749337 14.240310    0.4747701  56.3342247
 [41,]   14.5891603 12.831965  -11.5157006  38.3862502
 [42,]    4.5170794 11.020280  -17.6707652  25.1703790
 [43,]   13.8734985  9.498503   -4.9820408  31.7256459
 [44,]   24.7040175  8.425216    7.8296997  40.8946615
 [45,]   13.4018366  7.983401   -2.3775829  28.8476212
 [46,]  -17.0209444  8.274832  -33.2563757  -1.0348094
 [47,]  -27.7288253  9.230316  -45.9552358  -9.6814584
 [48,]    9.5496938 10.672972  -11.7709734  30.2532520
 [49,]  -38.9852872 12.434375  -63.7972490 -14.9548966
 [50,]   31.3847319 14.398011    2.7004963  59.5634962
 [51,]  -25.2319486 12.180948  -49.6342005  -1.4334106
 [52,]  -27.5433744 10.514268  -48.7331891  -7.3203923
 [53,]   -7.6565002  9.145246  -25.9496276   9.6618908
 [54,]   18.8883739  8.223901    3.0146360  34.6459753
 [55,]   16.3198481  7.908282    0.8501000  31.7244751
 [56,]   -1.4080777  8.268050  -17.5181259  14.8428103
 [57,]  132.4935964  9.224517  114.2772382 150.7768204
 [58,]   14.9001706 10.617633   -6.0304558  35.7147837
 [59,]  -11.8932553 12.299914  -36.0001343  12.2554971
 [60,]  -98.5917811 14.168733 -126.6186402 -70.6114799
 [61,]   16.3829072 12.671802   -9.5262971  40.6311128
 [62,]   11.7379551 10.875418  -10.5857218  32.7851206
 [63,]  -11.4052969  9.366830  -30.4397014   6.6625040
 [64,]    1.2775510  8.304391  -15.2372686  17.3144572
 [65,]  -11.7187010  7.870892  -26.6672729   3.5293633
 [66,]   18.9192469  8.167105    3.4939822  35.3530471
 [67,]    2.4216949  9.122220  -14.9902525  20.7704229
 [68,]    8.8775428 10.558921  -11.4126602  29.8399068
 [69,]  -16.9599092 12.309727  -40.3930974   7.5385608
 [70,]    1.3653388 14.259402  -25.5974856  29.8262817
 [71,]   21.0213417 12.515357   -3.5791852  45.6225898
 [72,]   20.3021903 10.805242   -0.8119665  41.3806051
 [73,]  -23.9815612  9.377318  -42.2013869  -5.5856498
 [74,]  -24.1212126  8.377153  -40.4278243  -7.6597505
 [75,]  -11.2163640  7.967500  -26.3713211   4.3635684
 [76,]  -17.4968155  8.236939  -33.3701289  -1.3733484
 [77,]   -7.6104669  9.125516  -25.5571231  10.1707267
 [78,]    6.9403817 10.476864  -13.5488714  27.3314726
 [79,]   -0.2828698 12.137383  -24.4780862  23.3743230
 [80,]   29.8219788 13.997471    2.4794023  57.1501536
 [81,]   -8.8743210 13.631308  -36.3736269  16.3808177
 [82,]   23.6779160 11.633339   -0.2679937  45.1245325
 [83,]    4.4347531  9.923726  -15.4536771  23.1394581
 [84,]   20.9594901  8.674664    3.7297379  37.7587182
 [85,]    1.8226272  8.102036  -14.2841277  18.0967971
 [86,]    5.2202642  8.346251  -10.6110778  22.2590172
 [87,]   -3.7502987  9.343475  -21.5953631  14.8347961
 [88,]  -13.6782617 10.888751  -35.0355110   7.6412059
 [89,]  -13.0218246 12.784873  -37.8302090  11.5983648
 [90,]  -11.3159876 14.898482  -40.0956696  17.7040889
 [91,]   26.5416671 13.141048    0.6750837  52.3012737
 [92,]    8.8162753 11.257662  -13.1061837  31.0818335
 [93,]  -32.5429166  9.658989  -51.3159263 -13.7331336
 [94,]    2.8034916  8.507084  -13.8043590  19.8258059
 [95,]    3.2490998  7.997387  -12.0208635  19.2759615
 [96,]   10.1906079  8.249802   -5.5288185  26.3120419
 [97,]    3.4476161  9.201824  -13.9817524  21.2833272
 [98,]   -3.2847758 10.667765  -24.0021081  17.9832314
 [99,]   16.7226324 12.467644   -7.3990241  41.6692285
[100,]    0.6104406 14.477445  -27.6447130  28.9959430
[101,]    9.5584070 12.805981  -14.8225569  35.4952642
[102,]   -7.7782714 10.976576  -28.5677699  14.4250552
[103,]  -10.7195499  9.441209  -28.4669432   7.9994039
[104,]   -6.2733284  8.363418  -22.2003174   9.9445298
[105,]  -22.0352069  7.931974  -37.1173167  -6.3884883
[106,]  -14.5212853  8.248926  -30.1924755   2.0166954
[107,]  -14.2810638  9.237559  -32.3518300   4.0594714
[108,]    0.7059577 10.713511  -20.2961231  21.9882344
[109,]   17.3343792 12.505410   -6.9625710  42.0197794
[110,]   21.1487008 14.496564   -7.4068207  49.8069043
[111,]   17.4263581 13.202447   -7.7424034  43.5902000
[112,]  -12.4424800 11.277237  -33.8300872  10.1933428
[113,]  -16.7185182  9.628788  -35.3046026   2.5259790
[114,]  -34.4223563  8.421227  -50.8267249 -17.9444729
[115,]  -38.0592945  7.860444  -53.2692583 -22.5538563
[116,]    5.7225674  8.082210   -9.9409491  21.2720078
[117,]   38.4160293  9.029045   21.0112763  56.0988234
[118,]    4.8635911 10.506723  -15.5647680  25.6830433
[119,]   19.4060530 12.325778   -5.0016535  43.7158245
[120,]   -3.0547852 14.357033  -31.4164923  24.9509524
[121,]   -5.3298802 12.175319  -29.4826649  17.9437977
[122,]   36.7138983 10.469149   16.0724545  57.0832826
[123,]   -0.9371231  9.056822  -18.6338893  16.5483278
[124,]    2.2707555  8.093652  -13.4043796  17.8852482
[125,]  -13.9782660  7.748977  -29.3458717   1.0869963
[126,]   11.3406126  8.102119   -4.7190687  27.2841859
[127,]  -13.0337089  9.071949  -31.1297146   5.0281603
[128,]  -41.6721303 10.488776  -62.5052160 -21.0748932
[129,]    5.7868482 12.197822  -17.8299835  29.4622394
[130,]   24.3232268 14.093173   -2.8818449  51.7892779
[131,]  -50.4186551 12.888698  -76.0242904 -25.5051605
[132,]   12.0806184 11.118098  -10.0038638  33.9850876
[133,]   26.7476920  9.621510    7.9077838  45.4645315
[134,]   32.7071656  8.544156   16.3406428  49.5848219
[135,]   20.5743392  8.056024    5.0255804  36.6187251
[136,]   10.6453127  8.262216   -5.1231618  26.7614566
[137,]   -1.7743137  9.115738  -19.5517675  15.6294400
[138,]   -9.7858401 10.459299  -30.3345561  10.4497425
[139,]   -8.5953665 12.131157  -32.6955740  14.9020591
[140,]   -9.7117930 14.014307  -37.2153385  17.6516357
[141,]   17.2244066 12.228435   -7.6006184  40.9963451
[142,]    2.4133077 10.497360  -18.7377682  22.7295380
[143,]  -20.1056913  9.064477  -38.5553328  -2.5699560
[144,]  -11.0159903  8.089819  -27.1408675   4.6804098
[145,]   14.8251107  7.748280   -0.5549988  29.9493676
[146,]    5.8919117  8.120147   -9.9087003  22.0646528
[147,]  -24.5107872  9.118551  -42.3706553  -6.4507471
[148,]   14.1523138 10.567375   -6.6397617  34.7237621
[149,]   -5.0150852 12.308578  -29.4260807  18.8672287
[150,]    9.8935158 14.235275  -18.6291922  37.4315680
[151,]   -1.2666878 13.561667  -27.1293138  25.6333860
[152,]   -7.1456461 11.569018  -29.5068649  15.4765900
[153,]  -17.9068044  9.848081  -36.9773041   0.9351361
[154,]  -31.4730627  8.564251  -47.8816069 -14.7061060
[155,]  -19.5472210  7.932670  -34.5140880  -4.1084234
[156,]   41.9707207  8.107237   26.4417739  57.9259906
[157,]  -36.2133376  9.041377  -53.7092965 -18.8553854
[158,]   15.0856041 10.534935   -5.0862067  35.1770140
[159,]   17.5246459 12.387187   -6.3604434  41.4680311
[160,]    9.4519876 14.460951  -18.5809739  37.1997134
[161,]   17.9108134 12.470087   -6.4168593  43.0948642
[162,]   10.9262808 10.729131  -10.0719439  32.4405072
[163,]    6.8354482  9.278995  -11.3744409  25.4470049
[164,]    1.1791156  8.274027  -15.2280667  17.8101311
[165,]  -10.9868170  7.886291  -26.6001785   4.7720082
[166,]  -15.1922496  8.203777  -31.2138364   0.9183898
[167,]  -49.9853823  9.153394  -67.4858495 -31.5723446
[168,]  -14.1675149 10.566058  -34.2783781   6.9577884
[169,]   22.4356525 12.283030   -1.2029436  46.5891728
[170,]   31.5772199 14.194308    4.1749470  59.9937039
[171,]    6.1017557 12.385525  -18.7433010  30.0960281
[172,]   -1.6424128 10.686129  -22.9229527  19.2752757
[173,]   10.6739187  9.277706   -8.0150365  28.7709510
[174,]   11.9022502  8.309555   -4.7577718  28.1536142
[175,]  -23.3632183  7.944302  -39.1548918  -8.0280029
[176,]    7.2653131  8.262296   -9.3032062  23.0316566
[177,]    0.3330446  9.192906  -17.7558545  17.9812884
[178,]   -2.7353239 10.575627  -23.8580520  17.5394417
[179,]   11.3800076 12.258410  -12.8513313  35.3897225
[180,]   -5.4445609 14.134487  -33.3554109  22.5677374</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.5
p_loo        19.7  3.5
looic      1770.3 29.0
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1530      
 (0.5, 0.7]   (ok)         3    1.7%   112       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.5
p_loo        34.5  8.7
looic      1723.3 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   934       
 (0.5, 0.7]   (ok)         3    1.7%   294       
   (0.7, 1]   (bad)        1    0.6%   27        
   (1, Inf)   (very bad)   2    1.1%   9         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.5      11.7  
fit_sleep1 -91.7      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It
is recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching
for problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.6 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.2 14.5
p_loo        19.7  3.5
looic      1770.3 29.0
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     177   98.3%   1530      
 (0.5, 0.7]   (ok)         3    1.7%   112       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.5
p_loo        34.5  8.7
looic      1723.3 45.1
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   934       
 (0.5, 0.7]   (ok)         3    1.7%   294       
   (0.7, 1]   (bad)        1    0.6%   27        
   (1, Inf)   (very bad)   2    1.1%   9         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.7     22.5        34.5    8.7   1723.3
fit_sleep2  -23.5      11.7  -885.2     14.5        19.7    3.5   1770.3
fit_sleep1  -91.7      21.2  -953.3     10.5         3.2    0.5   1906.6
           se_looic
fit_sleep3   45.1  
fit_sleep2   29.0  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.571247e-40 6.221927e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.86      1.57     0.24     5.39       0.03      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.14      1.57    -3.23     2.85       5.34      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.19.0         Rcpp_1.0.10         rstan_2.26.22      
[4] StanHeaders_2.26.26 lme4_1.1-33         Matrix_1.5-4       

loaded via a namespace (and not attached):
  [1] gridExtra_2.3        inline_0.3.19        rlang_1.1.1         
  [4] magrittr_2.0.3       matrixStats_1.0.0    compiler_4.3.0      
  [7] loo_2.6.0            callr_3.7.3          vctrs_0.6.2         
 [10] reshape2_1.4.4       stringr_1.5.0        pkgconfig_2.0.3     
 [13] crayon_1.5.2         fastmap_1.1.1        backports_1.4.1     
 [16] ellipsis_0.3.2       labeling_0.4.2       utf8_1.2.3          
 [19] threejs_0.3.3        promises_1.2.0.1     rmarkdown_2.22      
 [22] markdown_1.7         ps_1.7.5             nloptr_2.0.3        
 [25] xfun_0.39            cachem_1.0.8         jsonlite_1.8.5      
 [28] highr_0.10           later_1.3.1          parallel_4.3.0      
 [31] prettyunits_1.1.1    R6_2.5.1             dygraphs_1.1.1.6    
 [34] bslib_0.4.2          stringi_1.7.12       boot_1.3-28.1       
 [37] jquerylib_0.1.4      knitr_1.43           zoo_1.8-12          
 [40] base64enc_0.1-3      bayesplot_1.10.0     httpuv_1.6.11       
 [43] splines_4.3.0        igraph_1.4.3         tidyselect_1.2.0    
 [46] rstudioapi_0.14      abind_1.4-5          yaml_2.3.7          
 [49] codetools_0.2-19     miniUI_0.1.1.1       curl_5.0.0          
 [52] processx_3.8.1       pkgbuild_1.4.0       lattice_0.21-8      
 [55] tibble_3.2.1         plyr_1.8.8           shiny_1.7.4         
 [58] withr_2.5.0          bridgesampling_1.1-2 posterior_1.4.1     
 [61] coda_0.19-4          evaluate_0.21        RcppParallel_5.1.7  
 [64] xts_0.13.1           pillar_1.9.0         tensorA_0.36.2      
 [67] checkmate_2.2.0      DT_0.28              stats4_4.3.0        
 [70] shinyjs_2.1.0        distributional_0.3.2 generics_0.1.3      
 [73] ggplot2_3.4.2        rstantools_2.3.1     munsell_0.5.0       
 [76] scales_1.2.1         minqa_1.2.5          gtools_3.9.4        
 [79] xtable_1.8-4         glue_1.6.2           tools_4.3.0         
 [82] shinystan_2.6.0      colourpicker_1.2.0   mvtnorm_1.2-1       
 [85] grid_4.3.0           crosstalk_1.2.0      colorspace_2.1-0    
 [88] nlme_3.1-162         cli_3.6.1            fansi_1.0.4         
 [91] Brobdingnag_1.2-9    dplyr_1.1.2          V8_4.3.0            
 [94] gtable_0.3.3         sass_0.4.6           digest_0.6.31       
 [97] htmlwidgets_1.6.2    farver_2.1.1         htmltools_0.5.5     
[100] lifecycle_1.0.3      mime_0.12            shinythemes_1.2.0   
[103] MASS_7.3-58.4       </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiRGV2UHN5TGFiL3BldGVyc2VubGFiIikKYGBgCgojIyBMb2FkIExpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFfQpsaWJyYXJ5KCJsbWU0IikKbGlicmFyeSgicnN0YW4iKQpsaWJyYXJ5KCJicm1zIikKYGBgCgojIyBMb2FkIERhdGEKCmBgYHtyfQpkYXRhKCJzbGVlcHN0dWR5IiwgcGFja2FnZSA9ICJsbWU0IikKYGBgCgojIyBQcmVwYXJlIERhdGEKCmBgYHtyfQpjb25kaXRpb25zIDwtIG1ha2VfY29uZGl0aW9ucyhzbGVlcHN0dWR5LCAiU3ViamVjdCIpCmBgYAoKIyBicm1zCgojIyBQb3N0LVByb2Nlc3NpbmcgTWV0aG9kcwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQptZXRob2RzKGNsYXNzID0gImJybXNmaXQiKQpgYGAKCiMgTXVsdGlsZXZlbCBNb2RlbHMKCiMjIEZpdCB0aGUgTW9kZWxzCgojIyMgQ29tcGxldGUgUG9vbGluZwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDEgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMsIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cwoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDIgPC0gYnJtKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSB8IFN1YmplY3QpLCAKICAgICAgICAgICAgICAgICAgZGF0YSA9IHNsZWVwc3R1ZHkpCmBgYAoKIyMjIFJhbmRvbSBJbnRlcmNlcHRzIGFuZCBTbG9wZXMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAzIDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5CikKYGBgCgojIyBTdW1tYXJpemUgUmVzdWx0cwoKRm9yIGNvbnZlcmdlbmNlLCBgUmhhdGAgdmFsdWVzIHNob3VsZCBub3QgYmUgYWJvdmUgMS4wMC4KCmBgYHtyfQpzdW1tYXJ5KGZpdF9zbGVlcDMpCmBgYAoKIyMgTW9kZWwgUHJpb3JzCgpgYGB7cn0KcHJpb3Jfc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIENvZWZmaWNpZW50cwoKYGBge3J9CmNvZWYoZml0X3NsZWVwMykKYGBgCgojIyBQbG90cwoKIyMjIFRyYWNlIFBsb3RzCgpgYGB7cn0KcGxvdChmaXRfc2xlZXAzLCBhc2sgPSBGQUxTRSkKYGBgCgojIyMgVmlzdWFsaXplIFByZWRpY3Rpb25zCgojIyMjIFNhbXBsZS1MZXZlbAoKYGBge3J9CnBsb3QoY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAxKSwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMjIFBlcnNvbi1MZXZlbAoKYGBge3J9CiMgcmVfZm9ybXVsYSA9IE5VTEwgZW5zdXJlcyB0aGF0IGdyb3VwLWxldmVsIGVmZmVjdHMgYXJlIGluY2x1ZGVkCmNlMiA8LSBjb25kaXRpb25hbF9lZmZlY3RzKGZpdF9zbGVlcDMsIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgcmVfZm9ybXVsYSA9IE5VTEwpCnBsb3QoY2UyLCBuY29sID0gNiwgcG9pbnRzID0gVFJVRSkKYGBgCgojIyMgQ2hlY2sgTW9kZWwgRml0CgojIyMjIFBvc3RlcmlvciBQcmVkaWN0aXZlIENoZWNrCgpFdmFsdWF0ZSBob3cgY2xvc2VseSB0aGUgcG9zdGVyaW9yIHByZWRpY3Rpb25zIG1hdGNoIHRoZSBvYnNlcnZlZCB2YWx1ZXMuCklmIHRoZXkgZG8gbm90IG1hdGNoIHRoZSBnZW5lcmFsIHBhdHRlcm4gb2YgdGhlIG9ic2VydmVkIHZhbHVlcywgYSBkaWZmZXJlbnQgcmVzcG9uc2UgZGlzdHJpYnV0aW9uIG1heSBiZSBuZWNlc3NhcnkuCgpgYGB7cn0KcHBfY2hlY2soZml0X3NsZWVwMykKcHBfY2hlY2soZml0X3NsZWVwMywgdHlwZSA9ICJkZW5zX292ZXJsYXkiKQpwcF9jaGVjayhmaXRfc2xlZXAzLCAiZXJyb3Jfc2NhdHRlcl9hdmciKQpgYGAKCiMjIEZpdHRlZCBWYWx1ZXMKCmBgYHtyfQpmaXR0ZWQoZml0X3NsZWVwMykKYGBgCgojIyBSZXNpZHVhbHMKCmBgYHtyfQpyZXNpZHVhbHMoZml0X3NsZWVwMykKYGBgCgojIyBDb21wYXJlIE1vZGVscwoKYGVscGRgIHZhbHVlczogaGlnaGVyIGlzIGJldHRlcgpgbG9vaWNgIHZhbHVlczogbG93ZXIgaXMgYmV0dGVyCgpgZWxwZF9kaWZmYCB2YWx1ZXMgdGhhdCBhcmUgZ3JlYXRlciB0aGFuIH4yIHN0YW5kYXJkIGVycm9ycyBvZiB0aGUgYGVscGRfZGlmZmAgdmFsdWVzIGluZGljYXRlIGEgc2lnbmlmaWNhbnRseSBiZXR0ZXIgbW9kZWwgKGkuZS4sIGlmIGBlbHBkX2RpZmZgIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiAyIHRpbWVzIHRoZSBgc2VfZGlmZmAgdmFsdWUpLgoKYGBge3J9CmxvbyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzKQpwcmludChsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMyksIHNpbXBsaWZ5ID0gRkFMU0UpCmBgYAoKIyMjIENvbXB1dGUgTW9kZWwgV2VpZ2h0cwoKYGBge3J9Cm1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKQoKcm91bmQobW9kZWxfd2VpZ2h0cyhmaXRfc2xlZXAxLCBmaXRfc2xlZXAyLCBmaXRfc2xlZXAzLCB3ZWlnaHRzID0gImxvbyIpKQpgYGAKCiMgU2V0dGluZyBQcmlvcnMKCiMjIFBhcmFtZXRlcnMgZm9yIFdoaWNoIHRvIFNldCBQcmlvcnMKCmBgYHtyfQpnZXRfcHJpb3IoUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIERlZmluZSBQcmlvcnMKCmBgYHtyfQpicHJpb3IgPC0gYyhzZXRfcHJpb3IoIm5vcm1hbCg1LCA1KSIsIGNvZWYgPSAiRGF5cyIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImNhdWNoeSgwLCAxMCkiLCBjbGFzcyA9ICJzZCIpLAogICAgICAgICAgICBzZXRfcHJpb3IoImxraigyKSIsIGNsYXNzID0gImNvciIpKQpicHJpb3IKYGBgCgojIyBGaXQgdGhlIE1vZGVsCgpGaXQgdGhlIG1vZGVsIHdpdGggdGhlc2UgcHJpb3JzLCBhbmQgc2FtcGxlIGZyb20gdGhlc2UgcHJpb3JzOgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUKKQpgYGAKCiMgRXZhbHVhdGUgYSBIeXBvdGhlc2lzCgpgYGB7cn0KIyBFdmlkLlJhdGlvIGlzIHRoZSByYXRpbyBvZiBQKERheXMgPiA3KSAvIFAoRGF5cyA8PSA3KQooaHlwMSA8LSBoeXBvdGhlc2lzKGZpdF9zbGVlcDQsICJEYXlzIDwgNyIpKQpwbG90KGh5cDEpCmBgYAoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgQmF5ZXMgRmFjdG9yIG9mIHRoZSBwb3N0ZXJpb3IKIyB2cyB0aGUgcHJpb3IgdGhhdCBEYXlzID0gMTAgaXMgVFJVRSAoU2F2YWdlLURpY2tleSBSYXRpbykKKGh5cDIgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA9IDEwIikpCnBsb3QoaHlwMikKYGBgCgojIFBhcmFsbGVsIFByb2Nlc3NpbmcKCiMjIEJldHdlZW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwNCA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeSwKICBwcmlvciA9IGJwcmlvciwgCiAgc2FtcGxlX3ByaW9yID0gVFJVRSwKICBjb3JlcyA9IDQKKQpgYGAKCiMjIFdpdGhpbi1DaGFpbiBQYXJhbGxlbGl6YXRpb24KCmh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9icm1zL3ZpZ25ldHRlcy9icm1zX3RocmVhZGluZy5odG1sCgojIE1pc3NpbmcgRGF0YSBIYW5kbGluZwoKIyMgTXVsdGlwbHkgSW1wdXRlZCBEYXRhc2V0cyBmcm9tIGBtaWNlYAoKYGBge3J9Cj9icm1fbXVsdGlwbGUKYGBgCgojIyBNdWx0aXBsZSBJbXB1dGF0aW9uIG9uIHRoZSBGbHkKCmBgYHtyfQo/bWkKYGBgCgojIFNlc3Npb24gSW5mbwoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQpzZXNzaW9uSW5mbygpCmBgYAo=</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
