<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.00      7.22    15.11    43.59 1.00     1718     2328
sd(Days)                6.60      1.52     4.20    10.22 1.00     1456     1846
cor(Intercept,Days)     0.10      0.30    -0.48     0.68 1.01     1037     1742

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.06      7.46   237.23   266.25 1.00     2113     2163
Days         10.48      1.74     7.04    13.92 1.00     1565     2077

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.60    23.06    29.26 1.00     3355     2738

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.9380  12.97888 227.9951 278.2147
309 211.5077  13.24731 185.2829 237.4753
310 212.9830  13.14925 187.1899 238.8603
330 274.3601  13.42751 248.6818 301.3796
331 272.9570  13.27952 247.5576 300.2441
332 260.1500  12.42241 236.3839 285.3084
333 268.2284  12.96494 242.9646 293.4875
334 244.3900  12.25704 220.0988 268.0864
335 250.7833  13.19029 225.4947 276.6112
337 285.9628  13.22174 260.0725 311.6806
349 226.6454  12.69959 201.5729 251.4601
350 238.9227  13.51263 211.3923 264.8322
351 255.6588  12.48234 231.1877 280.8641
352 271.8963  12.49072 248.0956 296.9025
369 254.7000  12.22853 230.1658 278.0119
370 226.4316  13.83685 198.5172 252.7369
371 252.0643  12.27091 228.3544 276.7160
372 263.4798  12.17575 238.9487 288.1846

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6410440  2.489958 14.8632628 24.553189
309  1.7883806  2.429150 -3.1151624  6.550976
310  4.9070814  2.493592 -0.0775554  9.789415
330  5.7545164  2.553815  0.7757087 10.523147
331  7.4824942  2.464711  2.6207999 12.242072
332 10.2621378  2.347556  5.6043637 14.803068
333 10.2472154  2.409051  5.4208551 14.903019
334 11.5161205  2.340583  6.9870707 16.226253
335 -0.2982693  2.547518 -5.2343636  4.638210
337 19.1795184  2.482853 14.2981638 24.076994
349 11.5352664  2.379146  6.8391793 16.183178
350 17.0108251  2.544512 12.1425225 22.107631
351  7.4808744  2.381564  2.7453560 11.918971
352 14.0009805  2.401735  9.2761391 18.577095
369 11.3418000  2.336793  6.6588713 15.913354
370 15.1730113  2.629983  9.9549596 20.445234
371  9.4870078  2.355785  4.7441433 14.043581
372 11.7762888  2.314561  7.1981724 16.397631</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.9380 12.978875 227.9951 278.2147
  [2,] 273.5791 11.113585 251.4365 294.7240
  [3,] 293.2201  9.537932 274.5798 311.8052
  [4,] 312.8611  8.416192 296.3139 329.3171
  [5,] 332.5022  7.943061 316.8708 348.0430
  [6,] 352.1432  8.231156 336.1682 368.0330
  [7,] 371.7843  9.209311 353.4786 389.6548
  [8,] 391.4253 10.689747 369.6063 412.0406
  [9,] 411.0664 12.495189 385.7998 435.4322
 [10,] 430.7074 14.504779 401.7000 458.9768
 [11,] 211.5077 13.247312 185.2829 237.4753
 [12,] 213.2961 11.453636 190.5521 235.6043
 [13,] 215.0845  9.933872 195.4088 234.1925
 [14,] 216.8729  8.830594 199.5164 233.9120
 [15,] 218.6613  8.311349 202.2771 234.7676
 [16,] 220.4497  8.484054 204.0000 237.3930
 [17,] 222.2380  9.310283 204.0560 240.5664
 [18,] 224.0264 10.638849 203.4473 245.0480
 [19,] 225.8148 12.308143 201.7067 250.0231
 [20,] 227.6032 14.198493 199.7874 255.1879
 [21,] 212.9830 13.149247 187.1899 238.8603
 [22,] 217.8901 11.310327 195.8206 239.7932
 [23,] 222.7972  9.766285 203.5113 241.8876
 [24,] 227.7042  8.676009 210.8399 244.7583
 [25,] 232.6113  8.222042 216.9873 248.6207
 [26,] 237.5184  8.506868 221.0729 254.0985
 [27,] 242.4255  9.464018 224.1297 260.8621
 [28,] 247.3326 10.918081 226.0091 268.8814
 [29,] 252.2397 12.699501 227.0844 277.1056
 [30,] 257.1467 14.689663 228.7559 285.8043
 [31,] 274.3601 13.427514 248.6818 301.3796
 [32,] 280.1146 11.451357 257.8465 302.9422
 [33,] 285.8691  9.747461 266.3254 304.9336
 [34,] 291.6237  8.481530 274.7613 308.1274
 [35,] 297.3782  7.867887 281.5834 312.4446
 [36,] 303.1327  8.056977 286.9141 318.6503
 [37,] 308.8872  8.998337 291.4212 326.3430
 [38,] 314.6417 10.491388 293.7479 335.4687
 [39,] 320.3962 12.337435 295.8234 344.6964
 [40,] 326.1508 14.401365 297.3203 354.4205
 [41,] 272.9570 13.279519 247.5576 300.2441
 [42,] 280.4395 11.444130 258.3479 303.9159
 [43,] 287.9220  9.886365 268.7368 307.9060
 [44,] 295.4045  8.755678 278.1326 312.8437
 [45,] 302.8870  8.230018 287.0526 318.8887
 [46,] 310.3695  8.423425 293.9473 326.6447
 [47,] 317.8520  9.291103 299.6244 335.8903
 [48,] 325.3345 10.669802 304.6850 346.2547
 [49,] 332.8170 12.390092 309.0324 357.0728
 [50,] 340.2994 14.329469 312.7720 368.3893
 [51,] 260.1500 12.422410 236.3839 285.3084
 [52,] 270.4122 10.692066 249.9014 292.1113
 [53,] 280.6743  9.238307 263.3415 299.1436
 [54,] 290.9364  8.209409 275.3749 306.9372
 [55,] 301.1986  7.775893 286.5012 316.1520
 [56,] 311.4607  8.034716 296.0292 327.2223
 [57,] 321.7229  8.925853 304.4831 338.7955
 [58,] 331.9850 10.286257 311.8504 351.6755
 [59,] 342.2471 11.956812 318.7400 365.4484
 [60,] 352.5093 13.825543 325.3537 379.4866
 [61,] 268.2284 12.964942 242.9646 293.4875
 [62,] 278.4756 11.169400 256.3477 300.2427
 [63,] 288.7228  9.645120 269.6369 307.7502
 [64,] 298.9701  8.538632 282.1111 315.5628
 [65,] 309.2173  8.024661 293.6127 324.6229
 [66,] 319.4645  8.215181 303.2576 335.3869
 [67,] 329.7117  9.065884 311.7168 347.8421
 [68,] 339.9589 10.416255 319.6065 360.3516
 [69,] 350.2061 12.100147 326.5942 374.0372
 [70,] 360.4534 13.997706 332.8396 388.0465
 [71,] 244.3900 12.257043 220.0988 268.0864
 [72,] 255.9061 10.549513 235.5317 276.6477
 [73,] 267.4222  9.127212 249.7286 284.9650
 [74,] 278.9383  8.141034 263.3829 294.6510
 [75,] 290.4544  7.759093 275.3495 305.6225
 [76,] 301.9706  8.067669 286.0689 318.0555
 [77,] 313.4867  8.995982 295.7138 331.2956
 [78,] 325.0028 10.379054 304.6235 345.2426
 [79,] 336.5189 12.061446 312.8886 360.2715
 [80,] 348.0351 13.935166 320.9785 375.3790
 [81,] 250.7833 13.190286 225.4947 276.6112
 [82,] 250.4850 11.257086 228.7668 272.2596
 [83,] 250.1867  9.614574 231.6663 268.7408
 [84,] 249.8885  8.434320 233.8284 266.0760
 [85,] 249.5902  7.925603 233.9966 264.8775
 [86,] 249.2919  8.214153 233.0144 264.9002
 [87,] 248.9937  9.225460 231.1003 267.1455
 [88,] 248.6954 10.757585 227.7570 270.0126
 [89,] 248.3971 12.622275 224.2633 273.5284
 [90,] 248.0989 14.693458 219.9707 277.4054
 [91,] 285.9628 13.221743 260.0725 311.6806
 [92,] 305.1423 11.336943 283.3534 327.3569
 [93,] 324.3218  9.724567 305.2664 342.9929
 [94,] 343.5014  8.540331 326.5832 360.0324
 [95,] 362.6809  7.977243 346.7880 378.1361
 [96,] 381.8604  8.164844 365.7410 397.5804
 [97,] 401.0399  9.056604 382.9932 418.8749
 [98,] 420.2194 10.474186 399.4485 440.7748
 [99,] 439.3989 12.236184 415.7723 463.9417
[100,] 458.5785 14.215095 431.4181 487.2298
[101,] 226.6454 12.699587 201.5729 251.4601
[102,] 238.1807 10.946797 216.8050 259.4728
[103,] 249.7159  9.471319 231.4482 268.5813
[104,] 261.2512  8.420218 244.7679 278.0267
[105,] 272.7865  7.963349 257.4087 288.6869
[106,] 284.3217  8.200638 268.7597 300.2527
[107,] 295.8570  9.077812 278.6952 313.4384
[108,] 307.3923 10.434728 287.0463 327.6780
[109,] 318.9275 12.111198 294.9882 342.2694
[110,] 330.4628 13.992832 302.8064 356.9710
[111,] 238.9227 13.512634 211.3923 264.8322
[112,] 255.9335 11.533332 232.5113 278.0005
[113,] 272.9444  9.818009 253.4699 291.9388
[114,] 289.9552  8.527481 273.5011 306.5650
[115,] 306.9660  7.873477 291.8333 322.4145
[116,] 323.9768  8.013390 308.2963 339.7211
[117,] 340.9877  8.909899 323.7290 358.3429
[118,] 357.9985 10.368570 337.8561 377.6096
[119,] 375.0093 12.189228 351.1674 398.1146
[120,] 392.0201 14.233636 364.2757 419.6503
[121,] 255.6588 12.482336 231.1877 280.8641
[122,] 263.1396 10.733789 241.8659 284.6652
[123,] 270.6205  9.271648 252.3694 289.2152
[124,] 278.1014  8.249629 262.2355 294.5137
[125,] 285.5823  7.841747 270.1425 301.2971
[126,] 293.0631  8.140842 277.1055 309.5420
[127,] 300.5440  9.077297 282.7107 318.6424
[128,] 308.0249 10.481652 287.5094 328.9402
[129,] 315.5058 12.193295 291.7740 339.4853
[130,] 322.9866 14.100764 295.3756 350.0950
[131,] 271.8963 12.490720 248.0956 296.9025
[132,] 285.8973 10.704468 265.5837 307.6876
[133,] 299.8983  9.202709 282.7081 318.4565
[134,] 313.8992  8.144367 298.5623 329.8394
[135,] 327.9002  7.714158 313.4649 343.0317
[136,] 341.9012  8.013889 326.3723 357.9661
[137,] 355.9022  8.970689 338.4303 373.7148
[138,] 369.9032 10.404843 349.5528 390.6294
[139,] 383.9041 12.148453 360.0025 408.0194
[140,] 397.9051 14.087077 370.2004 425.4898
[141,] 254.7000 12.228534 230.1658 278.0119
[142,] 266.0418 10.513843 244.6830 286.3388
[143,] 277.3836  9.081077 258.9804 295.0590
[144,] 288.7254  8.081598 272.2204 304.4955
[145,] 300.0672  7.686331 285.0583 315.3170
[146,] 311.4090  7.985509 295.7878 327.4783
[147,] 322.7508  8.909446 305.1000 340.3636
[148,] 334.0926 10.291225 313.7200 354.2718
[149,] 345.4344 11.973370 321.4459 368.4786
[150,] 356.7762 13.846843 329.3801 383.3440
[151,] 226.4316 13.836852 198.5172 252.7369
[152,] 241.6046 11.818437 217.6818 263.7883
[153,] 256.7776 10.085933 235.8677 275.8893
[154,] 271.9506  8.809669 254.1249 288.9638
[155,] 287.1236  8.205371 270.6776 302.9427
[156,] 302.2967  8.419001 285.6616 318.5293
[157,] 317.4697  9.394927 299.2376 335.9471
[158,] 332.6427 10.930845 311.5005 354.4699
[159,] 347.8157 12.827147 322.8775 373.2497
[160,] 362.9887 14.947296 333.9039 392.6370
[161,] 252.0643 12.270910 228.3544 276.7160
[162,] 261.5513 10.542216 241.0041 282.7307
[163,] 271.0383  9.099497 253.5214 289.1397
[164,] 280.5253  8.097087 264.9372 296.5611
[165,] 290.0123  7.708711 274.9146 305.4021
[166,] 299.4994  8.024031 283.8050 315.2076
[167,] 308.9864  8.969134 291.6651 326.2946
[168,] 318.4734 10.373288 298.3446 338.6864
[169,] 327.9604 12.077429 304.3984 351.2584
[170,] 337.4474 13.972219 309.9322 364.1059
[171,] 263.4798 12.175748 238.9487 288.1846
[172,] 275.2560 10.466451 254.2374 296.5260
[173,] 287.0323  9.030989 269.0961 305.1231
[174,] 298.8086  8.017812 283.0487 314.7516
[175,] 310.5849  7.597778 295.8108 325.3884
[176,] 322.3612  7.866483 306.9376 337.8483
[177,] 334.1375  8.760779 317.1393 351.0352
[178,] 345.9138 10.116092 326.3251 365.5815
[179,] 357.6901 11.774285 334.9981 381.0476
[180,] 369.4663 13.625220 343.1040 396.2335</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.3780174 12.978875  -28.6546880  21.5648704
  [2,]  -14.8743614 11.113585  -36.0192844   7.2682365
  [3,]  -42.4195054  9.537932  -61.0046400 -23.7792484
  [4,]    8.5786506  8.416192   -7.8772876  25.1258974
  [5,]   24.3497067  7.943061    8.8088626  39.9810791
  [6,]   62.5468627  8.231156   46.6570653  78.5219270
  [7,]   10.4195187  9.209311   -7.4509537  28.7251568
  [8,] -101.2767252 10.689747 -121.8919838 -79.4576851
  [9,]   19.5189308 12.495189   -4.8468934  44.7854737
 [10,]   35.6460868 14.504779    7.3767056  64.6534841
 [11,]   11.2261503 13.247312  -14.7413990  37.4509605
 [12,]   -8.0303304 11.453636  -30.3384693  14.7137123
 [13,]  -12.1067110  9.933872  -31.2147026   7.5689541
 [14,]  -12.1658916  8.830594  -29.2049834   5.1906333
 [15,]  -10.9451722  8.311349  -27.0514592   5.4390280
 [16,]   -4.4878529  8.484054  -21.4311991  11.9617808
 [17,]   -8.6077335  9.310283  -26.9360859   9.5743337
 [18,]   -6.2992141 10.638849  -27.3207923  14.2798958
 [19,]   -1.5190947 12.308143  -25.7273724  22.5889990
 [20,]    9.7110246 14.198493  -17.8737262  37.5267559
 [21,]  -13.9291034 13.149247  -39.8063825  11.8640070
 [22,]  -23.5578847 11.310327  -45.4610275  -1.4883518
 [23,]   11.5228339  9.766285   -7.5676146  30.8087131
 [24,]    5.1373525  8.676009  -11.9167112  22.0017161
 [25,]   -3.3039288  8.222042  -19.3132729  12.3200701
 [26,]  -17.0605102  8.506868  -33.6406012  -0.6149858
 [27,]   -7.0046915  9.464018  -25.4413216  11.2910705
 [28,]    8.4185271 10.918081  -13.1302756  29.7420049
 [29,]    8.7728458 12.699501  -16.0931041  33.9280656
 [30,]   -9.6314356 14.689663  -38.2890418  18.7593994
 [31,]   47.1824851 13.427514   20.1630354  72.8608354
 [32,]   20.2855686 11.451357   -2.5419763  42.5537354
 [33,]   -2.0126478  9.747461  -21.0771460  17.5311108
 [34,]   -6.4906642  8.481530  -22.9944314  10.3717491
 [35,]  -11.5808807  7.867887  -26.6473160   4.2138818
 [36,]   -5.5471971  8.056977  -21.0647538  10.6714261
 [37,]  -28.6476136  8.998337  -46.1034106 -11.1815834
 [38,]    3.6195700 10.491388  -17.2073543  24.5133615
 [39,]  -15.0467465 12.337435  -39.3469233   9.5261250
 [40,]   27.8979371 14.401365   -0.3718137  56.7283888
 [41,]   14.6509001 13.279519  -12.6362091  40.0502610
 [42,]    4.5605059 11.444130  -18.9159028  26.6521440
 [43,]   13.8986117  9.886365   -6.0853640  33.0837648
 [44,]   24.7108175  8.755678    7.2716025  41.9826881
 [45,]   13.3903233  8.230018   -2.6114030  29.2246539
 [46,]  -17.0507708  8.423425  -33.3259760  -0.6285879
 [47,]  -27.7769650  9.291103  -45.8153341  -9.5493856
 [48,]    9.4832408 10.669802  -11.4370176  30.1326601
 [49,]  -39.0700534 12.390092  -63.3259070 -15.2854962
 [50,]   31.2816524 14.329469    3.1917902  58.8091019
 [51,]  -25.2894344 12.422410  -50.4477883  -1.5233331
 [52,]  -27.6003723 10.692066  -49.2995370  -7.0895921
 [53,]   -7.7130101  9.238307  -26.1822530   9.6198188
 [54,]   18.8323520  8.209409    2.8316044  34.3938931
 [55,]   16.2643142  7.775893    1.3108601  30.9617487
 [56,]   -1.4631236  8.034716  -17.2246771  13.9683522
 [57,]  132.4390385  8.925853  115.3663815 149.6788296
 [58,]   14.8461007 10.286257   -4.8443859  34.9806889
 [59,]  -11.9468372 11.956812  -35.1480940  11.5603122
 [60,]  -98.6448750 13.825543 -125.6222457 -71.4893351
 [61,]   15.6139820 12.964942   -9.6450687  40.8777979
 [62,]   11.0793665 11.169400  -10.6876914  33.2073450
 [63,]  -11.9535489  9.645120  -30.9809439   7.1324063
 [64,]    0.8396356  8.538632  -15.7530594  17.6986037
 [65,]  -12.0462798  8.024661  -27.4519145   3.5582932
 [66,]   18.7020047  8.215181    2.7795697  34.9089345
 [67,]    2.3147893  9.065884  -15.8156375  20.3096935
 [68,]    8.8809738 10.416255  -11.5117350  29.2333988
 [69,]  -16.8461416 12.100147  -40.6772442   6.7658024
 [70,]    1.5894430 13.997706  -26.0037483  29.2031639
 [71,]   21.0831323 12.257043   -2.6133121  45.3743336
 [72,]   20.2951119 10.549513   -0.4464519  40.6695155
 [73,]  -24.0575086  9.127212  -41.6002997  -6.3639482
 [74,]  -24.2660291  8.141034  -39.9786765  -8.7106387
 [75,]  -11.4300495  7.759093  -26.5981041   3.6748681
 [76,]  -17.7793700  8.067669  -33.8643434  -1.8776933
 [77,]   -7.9618905  8.995982  -25.7707957   9.8110204
 [78,]    6.5200891 10.379054  -13.7196934  26.8994287
 [79,]   -0.7720314 12.061446  -24.5245898  22.8583098
 [80,]   29.2639481 13.935166    1.9199892  56.3204976
 [81,]   -9.1749808 13.190286  -35.0029116  16.1135666
 [82,]   23.4621885 11.257086    1.6875589  45.1804040
 [83,]    4.3039579  9.614574  -14.2501077  22.8243910
 [84,]   20.9136272  8.434320    4.7261377  36.9736500
 [85,]    1.8616966  7.925603  -13.4255856  17.4553350
 [86,]    5.3442659  8.214153  -10.2639734  21.6218103
 [87,]   -3.5413647  9.225460  -21.6931952  14.3520309
 [88,]  -13.3843954 10.757585  -34.7016424   7.5539589
 [89,]  -12.6430260 12.622275  -37.7742637  11.4908337
 [90,]  -10.8522567 14.693458  -40.1588263  17.2759348
 [91,]   26.4038006 13.221743    0.6859525  52.2940713
 [92,]    8.6634822 11.336943  -13.5510818  30.4524422
 [93,]  -32.7106362  9.724567  -51.3816740 -13.6551633
 [94,]    2.6208454  8.540331  -13.9102438  19.5389959
 [95,]    3.0515270  7.977243  -12.4037157  18.9444371
 [96,]    9.9781086  8.164844   -5.7419084  26.0975202
 [97,]    3.2201902  9.056604  -14.6147788  21.2668584
 [98,]   -3.5271282 10.474186  -24.0825438  17.2438164
 [99,]   16.4653533 12.236184   -8.0773546  40.0920221
[100,]    0.3382349 14.215095  -28.3131345  27.4986270
[101,]    9.4578143 12.699587  -15.3568733  34.5303191
[102,]   -7.8639520 10.946797  -29.1561231  13.5117098
[103,]  -10.7903184  9.471319  -29.6556650   7.4774141
[104,]   -6.3291848  8.420218  -23.1047129  10.1541086
[105,]  -22.0761511  7.963349  -37.9765690  -6.6983648
[106,]  -14.5473175  8.200638  -30.4783318   1.0147022
[107,]  -14.2921838  9.077812  -31.8735770   2.8695697
[108,]    0.7097498 10.434728  -19.5760086  21.0557056
[109,]   17.3530835 12.111198   -5.9887829  41.2924082
[110,]   21.1823171 13.992832   -5.3259050  48.8387271
[111,]   17.3740917 13.512634   -8.5354029  44.9044985
[112,]  -12.4792334 11.533332  -34.5462326  10.9430477
[113,]  -16.7397585  9.818009  -35.7342297   2.7346995
[114,]  -34.4280837  8.527481  -51.0378531 -17.9740277
[115,]  -38.0495088  7.873477  -53.4980339 -22.9168233
[116,]    5.7478660  8.013390   -9.9963537  21.4284258
[117,]   38.4568409  8.909899   21.1016096  55.7154783
[118,]    4.9199157 10.368570  -14.6912427  25.0623027
[119,]   19.4778906 12.189228   -3.6273539  43.3197879
[120,]   -2.9674346 14.233636  -30.5976453  24.7770158
[121,]   -5.1322596 12.482336  -30.3376072  19.3387859
[122,]   36.9179660 10.733789   15.3923941  58.1917460
[123,]   -0.7266084  9.271648  -19.3212757  17.5244752
[124,]    2.4877173  8.249629  -13.9246274  18.3536278
[125,]  -13.7548571  7.841747  -29.4696974   1.6848970
[126,]   11.5704686  8.140842   -4.9084483  27.5281150
[127,]  -12.7974058  9.077297  -30.8957843   5.0359145
[128,]  -41.4293801 10.481652  -62.3446657 -20.9139090
[129,]    6.0360455 12.193295  -17.9435203  29.7678200
[130,]   24.5788712 14.100764   -2.5294665  52.1899040
[131,]  -50.2191916 12.490720  -75.2253941 -26.4184724
[132,]   12.2966279 10.704468   -9.4936785  32.6102319
[133,]   26.9802474  9.202709    8.4220489  44.1704481
[134,]   32.9562669  8.144367   17.0160844  48.2931891
[135,]   20.8399865  7.714158    5.7084952  35.2752758
[136,]   10.9275060  8.013889   -5.1374300  26.4564376
[137,]   -1.4755745  8.970689  -19.2882487  15.9962663
[138,]   -9.4705550 10.404843  -30.1967865  10.8797953
[139,]   -8.2635354 12.148453  -32.3787658  15.6380704
[140,]   -9.3634159 14.087077  -36.9481294  18.3413278
[141,]   17.2234533 12.228534   -6.0883600  41.7576679
[142,]    2.3950533 10.513843  -17.9018683  23.7538861
[143,]  -20.1412467  9.081077  -37.8165526  -1.7379969
[144,]  -11.0688467  8.081598  -26.8389243   5.4362178
[145,]   14.7549532  7.686331   -0.4948365  29.7638843
[146,]    5.8044532  7.985509  -10.2647809  21.4256758
[147,]  -24.6155468  8.909446  -42.2282652  -6.9647441
[148,]   14.0302532 10.291225   -6.1488551  34.4029033
[149,]   -5.1544468 11.973370  -28.1986471  18.8341133
[150,]    9.7368532 13.846843  -16.8309406  37.1330227
[151,]   -1.1675982 13.836852  -27.4729351  26.7468048
[152,]   -7.0811095 11.818437  -29.2647724  16.8416646
[153,]  -17.8768208 10.085933  -36.9884933   3.0331472
[154,]  -31.4776321  8.809669  -48.4908348 -13.6518547
[155,]  -19.5863434  8.205371  -35.4053871  -3.1403180
[156,]   41.8970453  8.419001   25.6644174  58.5320940
[157,]  -36.3215660  9.394927  -54.7989564 -18.0894728
[158,]   14.9428227 10.930845   -6.8844275  36.0849862
[159,]   17.3473114 12.827147   -8.0866911  42.2855026
[160,]    9.2401001 14.947296  -20.4082322  38.3249218
[161,]   17.8160826 12.270910   -6.8355585  41.5259958
[162,]   10.8914748 10.542216  -10.2879425  31.4386605
[163,]    6.8605669  9.099497  -11.2407824  24.3775166
[164,]    1.2641591  8.097087  -14.7716399  16.8523370
[165,]  -10.8418487  7.708711  -26.2315522   4.2558837
[166,]  -14.9873566  8.024031  -30.6956463   0.7069994
[167,]  -49.7205644  8.969134  -67.0288366 -32.3993085
[168,]  -13.8427723 10.373288  -34.0557955   6.2860468
[169,]   22.8203199 12.077429   -0.4777449  46.3823225
[170,]   32.0218120 13.972219    5.3633403  59.5370253
[171,]    5.9319497 12.175748  -18.7728619  30.4630230
[172,]   -1.7820391 10.466451  -23.0519516  19.2365601
[173,]   10.5644720  9.030989   -7.5263013  28.5006987
[174,]   11.8229832  8.017812   -4.1199594  27.5829402
[175,]  -23.4123057  7.597778  -38.2158059  -8.6381923
[176,]    7.2464055  7.866483   -8.2406872  22.6699630
[177,]    0.3443167  8.760779  -16.5534404  17.3424673
[178,]   -2.6938722 10.116092  -22.3616342  16.8948194
[179,]   11.4516390 11.774285  -11.9059448  34.1435893
[180,]   -5.3427499 13.625220  -32.1098885  21.0195785</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.5
p_loo        19.7  3.5
looic      1770.2 29.0
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1371      
 (0.5, 0.7]   (ok)         2    1.1%   148       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.6
p_loo        34.5  8.7
looic      1723.3 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   486       
 (0.5, 0.7]   (ok)         6    3.3%   71        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   2    1.1%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.5      11.7  
fit_sleep1 -91.7      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 2 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.1
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.1 14.5
p_loo        19.7  3.5
looic      1770.2 29.0
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1371      
 (0.5, 0.7]   (ok)         2    1.1%   148       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.7 22.6
p_loo        34.5  8.7
looic      1723.3 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   486       
 (0.5, 0.7]   (ok)         6    3.3%   71        
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   2    1.1%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.7     22.6        34.5    8.7   1723.3
fit_sleep2  -23.5      11.7  -885.1     14.5        19.7    3.5   1770.2
fit_sleep1  -91.7      21.2  -953.3     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   45.2  
fit_sleep2   29.0  
fit_sleep1   21.1  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.523880e-40 6.434267e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0      2.9      1.59     0.25     5.44       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0     -0.1      1.59    -3.34     2.93       5.39      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.10         rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.27             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.1-0     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_5.0.0           compiler_4.2.2      
 [22] cli_3.6.0            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.5          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.20      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.10           fastmap_1.1.0        htmlwidgets_1.6.1   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.4          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.12       yaml_2.3.7          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.20        V8_4.2.2            
 [88] RcppParallel_5.1.6   vctrs_0.5.2          nloptr_2.0.3        
 [91] httpuv_1.6.8         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.36           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
