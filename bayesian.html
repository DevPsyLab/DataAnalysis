<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.09      6.97    15.52    43.54 1.00     1817     2047
sd(Days)                6.62      1.54     4.16    10.02 1.00     1650     2356
cor(Intercept,Days)     0.10      0.30    -0.48     0.69 1.00      870     1830

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.25      7.47   236.80   266.44 1.00     1831     2342
Days         10.38      1.76     6.85    13.85 1.00     1561     1608

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.89      1.52    23.08    29.10 1.00     3141     2983

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.0972  12.65681 228.6017 278.6532
309 211.2460  13.33831 185.0850 237.0222
310 212.7325  13.06035 187.1630 237.7806
330 274.5834  13.40306 248.6849 300.8228
331 273.0965  12.87257 248.6676 299.4531
332 260.5404  12.12559 236.9602 284.4488
333 267.7235  12.42925 244.2886 292.3944
334 244.4886  12.42709 220.1221 268.2767
335 250.2390  13.49095 224.1269 276.3307
337 286.1012  12.91181 261.1584 311.0880
349 226.4324  12.74162 201.3462 250.2871
350 239.0270  13.14828 213.5894 264.3627
351 255.8362  12.64540 231.8567 280.6035
352 272.0002  12.62973 247.6965 297.0665
369 254.6562  12.09407 230.7010 278.0078
370 226.3025  13.54406 199.3244 252.1496
371 252.3285  12.42958 227.9994 276.8789
372 263.5110  12.34707 239.6492 288.3879

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.6115895  2.440850 14.9313092 24.526441
309  1.8243736  2.489012 -3.0525823  6.564402
310  4.9406935  2.465782  0.2475690  9.748845
330  5.7543579  2.523413  0.7443115 10.621066
331  7.5198227  2.436469  2.6658634 12.100830
332 10.1739336  2.307427  5.6267086 14.774183
333 10.3245573  2.397396  5.3438076 14.822005
334 11.5013724  2.372588  6.9441353 16.259994
335 -0.1130382  2.606980 -5.2309906  4.854496
337 19.1425508  2.451111 14.2428760 23.903944
349 11.5649212  2.432508  6.9121521 16.372029
350 16.9245978  2.510349 12.1737803 21.831768
351  7.4493039  2.419250  2.5770165 12.106172
352 14.0490334  2.397154  9.2370273 18.648634
369 11.3478356  2.325823  6.8875948 15.958181
370 15.1998636  2.537766 10.2860214 20.328085
371  9.4713352  2.380062  4.7254229 14.116080
372 11.7866995  2.386562  7.0448583 16.388469</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.0972 12.656808 228.6017 278.6532
  [2,] 273.7088 10.826116 252.1943 294.8639
  [3,] 293.3204  9.280641 274.7838 311.1056
  [4,] 312.9320  8.183599 296.7359 328.4824
  [5,] 332.5436  7.728375 317.3126 348.0139
  [6,] 352.1552  8.024946 336.1202 368.5788
  [7,] 371.7668  8.999291 354.4382 389.5689
  [8,] 391.3783 10.463758 371.1865 412.2321
  [9,] 410.9899 12.243721 387.1488 435.4576
 [10,] 430.6015 14.221205 402.5559 459.5392
 [11,] 211.2460 13.338305 185.0850 237.0222
 [12,] 213.0704 11.455763 190.6675 235.4589
 [13,] 214.8948  9.846267 195.3410 234.2694
 [14,] 216.7191  8.663360 199.6701 233.8685
 [15,] 218.5435  8.096235 202.7814 234.3922
 [16,] 220.3679  8.272520 203.9671 236.6174
 [17,] 222.1922  9.149345 203.6121 240.8606
 [18,] 224.0166 10.553521 202.7054 244.9842
 [19,] 225.8410 12.305830 201.1609 250.3559
 [20,] 227.6654 14.278672 199.6045 255.9011
 [21,] 212.7325 13.060351 187.1630 237.7806
 [22,] 217.6732 11.201718 195.8456 239.1660
 [23,] 222.6139  9.619999 203.8064 241.3135
 [24,] 227.5546  8.471742 211.1653 243.7852
 [25,] 232.4953  7.947114 217.2207 247.8224
 [26,] 237.4360  8.167189 221.7893 253.5902
 [27,] 242.3767  9.077967 224.6748 259.8437
 [28,] 247.3174 10.501245 226.2784 267.6075
 [29,] 252.2581 12.259811 227.8746 275.9775
 [30,] 257.1987 14.229897 228.8495 284.5817
 [31,] 274.5834 13.403057 248.6849 300.8228
 [32,] 280.3378 11.482402 258.0824 302.5873
 [33,] 286.0921  9.837907 267.6529 305.1554
 [34,] 291.8465  8.628934 275.2064 308.9164
 [35,] 297.6009  8.054056 281.8944 313.3065
 [36,] 303.3552  8.246961 287.1830 319.3765
 [37,] 309.1096  9.159265 290.7303 327.1476
 [38,] 314.8639 10.606938 293.8080 335.5439
 [39,] 320.6183 12.403925 295.9866 344.6002
 [40,] 326.3727 14.420223 298.1961 354.4536
 [41,] 273.0965 12.872575 248.6676 299.4531
 [42,] 280.6163 11.028391 259.7272 303.2295
 [43,] 288.1361  9.456236 270.1632 307.3700
 [44,] 295.6559  8.311928 279.5192 312.2387
 [45,] 303.1758  7.786440 287.7883 318.5060
 [46,] 310.6956  8.002620 294.7994 326.1729
 [47,] 318.2154  8.906625 300.7789 335.6814
 [48,] 325.7352 10.319242 305.0361 345.6972
 [49,] 333.2551 12.063098 309.0628 356.7442
 [50,] 340.7749 14.015086 313.0476 367.9136
 [51,] 260.5404 12.125589 236.9602 284.4488
 [52,] 270.7143 10.419737 250.8068 291.2203
 [53,] 280.8882  8.986676 263.6054 298.8655
 [54,] 291.0622  7.974850 275.6869 306.9617
 [55,] 301.2361  7.555432 286.7045 315.9680
 [56,] 311.4100  7.824278 296.3540 326.2607
 [57,] 321.5840  8.717943 304.9616 337.8952
 [58,] 331.7579 10.071453 312.5734 351.2259
 [59,] 341.9318 11.726647 319.4651 364.9907
 [60,] 352.1058 13.573606 325.5715 378.8055
 [61,] 267.7235 12.429252 244.2886 292.3944
 [62,] 278.0480 10.673196 258.2541 299.8188
 [63,] 288.3726  9.211022 271.3849 307.0716
 [64,] 298.6972  8.201449 283.2185 315.0720
 [65,] 309.0217  7.821740 293.6962 324.0535
 [66,] 319.3463  8.160300 303.3102 335.0046
 [67,] 329.6708  9.137635 311.3500 347.3555
 [68,] 339.9954 10.578151 318.8531 360.5337
 [69,] 350.3199 12.320438 325.3461 374.4427
 [70,] 360.6445 14.254266 331.5854 388.7916
 [71,] 244.4886 12.427093 220.1221 268.2767
 [72,] 255.9899 10.652509 235.2527 276.7128
 [73,] 267.4913  9.153009 249.7550 285.5644
 [74,] 278.9927  8.083165 263.4530 295.2024
 [75,] 290.4941  7.626000 276.2271 305.8068
 [76,] 301.9954  7.888761 286.6491 317.6480
 [77,] 313.4968  8.807244 296.3382 331.1564
 [78,] 324.9982 10.205925 305.0874 344.7520
 [79,] 336.4995 11.916904 313.4336 359.5274
 [80,] 348.0009 13.824711 320.9562 374.9420
 [81,] 250.2390 13.490947 224.1269 276.3307
 [82,] 250.1259 11.503172 227.6427 272.5673
 [83,] 250.0129  9.809842 230.4322 269.2079
 [84,] 249.8998  8.586951 232.7659 266.6563
 [85,] 249.7868  8.051779 233.9182 265.4128
 [86,] 249.6738  8.337821 233.3011 265.7238
 [87,] 249.5607  9.370169 231.2729 268.0263
 [88,] 249.4477 10.939542 228.1699 270.9948
 [89,] 249.3347 12.850672 224.0256 274.1733
 [90,] 249.2216 14.973265 219.8742 278.0823
 [91,] 286.1012 12.911809 261.1584 311.0880
 [92,] 305.2438 11.059387 283.6519 326.7228
 [93,] 324.3863  9.482676 305.9582 342.6639
 [94,] 343.5289  8.339553 327.3084 359.7340
 [95,] 362.6714  7.822470 347.7382 378.1571
 [96,] 381.8140  8.052938 366.2611 397.7105
 [97,] 400.9565  8.973543 383.7111 418.4917
 [98,] 420.0991 10.402645 399.9683 440.5234
 [99,] 439.2416 12.162297 415.6848 463.1022
[100,] 458.3842 14.129536 430.9821 485.9472
[101,] 226.4324 12.741623 201.3462 250.2871
[102,] 237.9973 10.919446 216.2684 258.6661
[103,] 249.5622  9.378369 230.7132 267.3496
[104,] 261.1271  8.276926 244.2792 276.7023
[105,] 272.6921  7.803551 257.4924 287.8080
[106,] 284.2570  8.069540 268.6030 300.0222
[107,] 295.8219  9.009647 278.4891 313.7264
[108,] 307.3868 10.443381 286.9619 328.4558
[109,] 318.9517 12.197903 294.7579 344.0094
[110,] 330.5167 14.154422 302.7921 359.6392
[111,] 239.0270 13.148276 213.5894 264.3627
[112,] 255.9516 11.237451 233.9681 277.6216
[113,] 272.8762  9.606621 254.4988 291.4329
[114,] 289.8008  8.420079 273.2824 306.4908
[115,] 306.7254  7.881116 291.2768 322.6143
[116,] 323.6500  8.119726 307.6956 339.9280
[117,] 340.5746  9.074779 323.1015 358.7027
[118,] 357.4992 10.553529 337.1864 378.1756
[119,] 374.4238 12.369561 350.5866 398.8649
[120,] 391.3484 14.395792 363.7960 419.8677
[121,] 255.8362 12.645405 231.8567 280.6035
[122,] 263.2855 10.838235 242.5158 284.3390
[123,] 270.7348  9.313106 252.7271 288.4010
[124,] 278.1841  8.228372 262.2740 293.6425
[125,] 285.6335  7.770702 270.4505 300.5113
[126,] 293.0828  8.047798 277.0338 308.9250
[127,] 300.5321  8.991987 282.4971 318.2308
[128,] 307.9814 10.423539 287.0450 328.2391
[129,] 315.4307 12.171690 291.1217 339.1071
[130,] 322.8800 14.119329 294.4152 350.1346
[131,] 272.0002 12.629731 247.6965 297.0665
[132,] 286.0492 10.819296 265.5039 307.3627
[133,] 300.0982  9.278843 282.5639 318.6933
[134,] 314.1473  8.162683 298.3862 330.1940
[135,] 328.1963  7.658626 313.0186 343.0652
[136,] 342.2453  7.884948 326.3260 357.5485
[137,] 356.2944  8.785383 339.0655 373.6449
[138,] 370.3434 10.182642 350.5071 390.4931
[139,] 384.3925 11.903031 361.5115 407.8300
[140,] 398.4415 13.826452 371.9862 425.2704
[141,] 254.6562 12.094074 230.7010 278.0078
[142,] 266.0040 10.397008 245.4626 285.6475
[143,] 277.3519  8.985979 259.5921 294.3517
[144,] 288.6997  8.013536 273.1321 303.8360
[145,] 300.0475  7.648832 284.9151 314.6932
[146,] 311.3954  7.975676 295.5593 326.8171
[147,] 322.7432  8.918357 305.0129 340.0027
[148,] 334.0911 10.309301 313.2311 354.1408
[149,] 345.4389 11.993548 321.6220 369.3076
[150,] 356.7867 13.864617 329.4088 384.6243
[151,] 226.3025 13.544060 199.3244 252.1496
[152,] 241.5024 11.572300 218.4599 263.8237
[153,] 256.7022  9.862818 236.9924 275.6067
[154,] 271.9021  8.573959 254.8352 288.7039
[155,] 287.1020  7.913966 271.3872 302.6126
[156,] 302.3018  8.039246 286.6325 318.0749
[157,] 317.5017  8.916759 299.9895 334.9166
[158,] 332.7016 10.357038 312.1569 352.8994
[159,] 347.9014 12.161759 323.8732 371.5320
[160,] 363.1013 14.192570 335.1668 391.0512
[161,] 252.3285 12.429577 227.9994 276.8789
[162,] 261.7998 10.652606 240.8232 282.9704
[163,] 271.2712  9.153744 253.3218 288.9770
[164,] 280.7425  8.089094 264.7440 296.7231
[165,] 290.2138  7.642333 275.3078 305.4730
[166,] 299.6852  7.918740 284.0114 315.4600
[167,] 309.1565  8.850821 291.5725 326.4146
[168,] 318.6279 10.261433 298.4936 338.6192
[169,] 328.0992 11.982753 304.3478 351.1198
[170,] 337.5705 13.899825 310.2327 364.4916
[171,] 263.5110 12.347070 239.6492 288.3879
[172,] 275.2977 10.598409 254.6546 296.5039
[173,] 287.0844  9.142963 269.4112 305.1951
[174,] 298.8711  8.139571 283.2660 315.1845
[175,] 310.6578  7.765489 295.8998 325.9101
[176,] 322.4445  8.108290 306.5882 338.3064
[177,] 334.2312  9.087205 316.2625 351.9109
[178,] 346.0179 10.526232 325.2181 366.9202
[179,] 357.8046 12.264468 333.6477 382.1296
[180,] 369.5913 14.192398 342.2323 397.6682</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error         Q2.5       Q97.5
  [1,]   -4.5372169 12.656808  -29.0932452  20.9583339
  [2,]  -15.0041064 10.826116  -36.1592058   6.5103580
  [3,]  -42.5197959  9.280641  -60.3049857 -23.9831781
  [4,]    8.5078146  8.183599   -7.0425847  24.7039404
  [5,]   24.3083252  7.728375    8.8379853  39.5392749
  [6,]   62.5349357  8.024946   46.1112906  78.5698501
  [7,]   10.4370462  8.999291   -7.3651236  27.7655648
  [8,] -101.2297433 10.463758 -122.0835337 -81.0379089
  [9,]   19.5953672 12.243721   -4.8722731  43.4365085
 [10,]   35.7519778 14.221205    6.8142757  63.7976407
 [11,]   11.4878935 13.338305  -14.2883115  37.6488509
 [12,]   -7.8045801 11.455763  -30.1931202  14.5983097
 [13,]  -11.9169537  9.846267  -31.2916216   7.6367995
 [14,]  -12.0121273  8.663360  -29.1614899   5.0368862
 [15,]  -10.8274009  8.096235  -26.6760933   4.9346876
 [16,]   -4.4060745  8.272520  -20.6555574  11.9946682
 [17,]   -8.5619481  9.149345  -27.2303076  10.0181819
 [18,]   -6.2894216 10.553521  -27.2570322  15.0218139
 [19,]   -1.5452952 12.305830  -26.0602194  23.1347927
 [20,]    9.6488312 14.278672  -18.5869039  37.7097158
 [21,]  -13.6786046 13.060351  -38.7267241  11.8909367
 [22,]  -23.3409981 11.201718  -44.8337965  -1.5134451
 [23,]   11.7061083  9.619999   -6.9934782  30.5135610
 [24,]    5.2870148  8.471742  -10.9435759  21.6762894
 [25,]   -3.1878787  7.947114  -18.5149650  12.0867039
 [26,]  -16.9780722  8.167189  -33.1323470  -1.3313918
 [27,]   -6.9558657  9.077967  -24.4229310  10.7460325
 [28,]    8.4337408 10.501245  -11.8564103  29.4726526
 [29,]    8.7544472 12.259811  -14.9650092  33.1379053
 [30,]   -9.6834463 14.229897  -37.0663644  18.6658074
 [31,]   46.9591703 13.403057   20.7198162  72.8576707
 [32,]   20.0624123 11.482402   -2.1871297  42.3178088
 [33,]   -2.2356456  9.837907  -21.2989267  16.2036319
 [34,]   -6.7135035  8.628934  -23.7834326   9.9265602
 [35,]  -11.8035615  8.054056  -27.5092491   3.9028760
 [36,]   -5.7697194  8.246961  -21.7909827  10.4024650
 [37,]  -28.8699773  9.159265  -46.9079830 -10.4907222
 [38,]    3.3973647 10.606938  -17.2826436  24.4532771
 [39,]  -15.2687932 12.403925  -39.2506985   9.3629202
 [40,]   27.6760489 14.420223   -0.4049251  55.8525893
 [41,]   14.5114229 12.872575  -11.8451604  38.9402528
 [42,]    4.3837001 11.028391  -18.2294812  25.2727631
 [43,]   13.6844774  9.456236   -5.5494223  31.6573636
 [44,]   24.4593547  8.311928    7.8766041  40.5960619
 [45,]   13.1015319  7.786440   -2.2287174  28.4890090
 [46,]  -17.3768908  8.002620  -32.8541704  -1.4806919
 [47,]  -28.1404135  8.906625  -45.6063693 -10.7038882
 [48,]    9.0824637 10.319242  -10.8794581  29.7815550
 [49,]  -39.5081590 12.063098  -62.9973268 -15.3158697
 [50,]   30.8062183 14.015086    3.6675293  58.5334919
 [51,]  -25.6797768 12.125589  -49.5882466  -2.0995852
 [52,]  -27.9025104 10.419737  -48.4084864  -7.9949552
 [53,]   -7.9269440  8.986676  -25.9042128   9.3559263
 [54,]   18.7066224  7.974850    2.8071252  34.0818598
 [55,]   16.2267888  7.555432    1.4949425  30.7584447
 [56,]   -1.4124447  7.824278  -16.2630759  13.6435504
 [57,]  132.5779217  8.717943  116.2667136 149.2003369
 [58,]   15.0731881 10.071453   -4.3948062  34.2577456
 [59,]  -11.6315455 11.726647  -34.6903635  10.8352040
 [60,]  -98.2413791 13.573606 -124.9410624 -71.7071244
 [61,]   16.1189160 12.429252   -8.5520350  39.5537836
 [62,]   11.5069588 10.673196  -10.2638106  31.3008756
 [63,]  -11.6032985  9.211022  -30.3023438   5.3843988
 [64,]    1.1125442  8.201449  -15.2622915  16.5911642
 [65,]  -11.8507131  7.821740  -26.8824663   3.4747573
 [66,]   18.8202296  8.160300    3.1618957  34.8563241
 [67,]    2.3556724  9.137635  -15.3290022  20.6765000
 [68,]    8.8445151 10.578151  -11.6938255  29.9868212
 [69,]  -16.9599422 12.320438  -41.0827064   8.0138798
 [70,]    1.3983005 14.254266  -26.7488445  30.4574289
 [71,]   20.9845329 12.427093   -2.8036318  45.3509594
 [72,]   20.2112606 10.652509   -0.5116319  40.9484967
 [73,]  -24.1266118  9.153009  -42.1996888  -6.3903060
 [74,]  -24.3203842  8.083165  -40.5300945  -8.7807456
 [75,]  -11.4696565  7.626000  -26.7823849   2.7973013
 [76,]  -17.8042289  7.888761  -33.4568412  -2.4579317
 [77,]   -7.9720012  8.807244  -25.6315892   9.1865618
 [78,]    6.5247264 10.205925  -13.2290745  26.4354958
 [79,]   -0.7526459 11.916904  -23.7805201  22.3132860
 [80,]   29.2980817 13.824711    2.3569896  56.3427750
 [81,]   -8.6306606 13.490947  -34.7223594  17.4814212
 [82,]   23.8212776 11.503172    1.3798963  46.3044808
 [83,]    4.4778158  9.809842  -14.7171764  24.0585274
 [84,]   20.9022540  8.586951    4.1458145  38.0362412
 [85,]    1.6650922  8.051779  -13.9608634  17.5336987
 [86,]    4.9624304  8.337821  -11.0876145  21.3350826
 [87,]   -4.1084314  9.370169  -22.5740304  14.1793836
 [88,]  -14.1366932 10.939542  -35.6837664   7.1411129
 [89,]  -13.5805550 12.850672  -38.4192009  11.7285422
 [90,]  -11.9750168 14.973265  -40.8357310  17.3723641
 [91,]   26.2653791 12.911809    1.2785792  51.2082498
 [92,]    8.5620284 11.059387  -12.9170012  30.1538826
 [93,]  -32.7751224  9.482676  -51.0527253 -14.3469538
 [94,]    2.5933268  8.339553  -13.6117830  18.8137706
 [95,]    3.0609760  7.822470  -12.4247079  17.9942493
 [96,]   10.0245252  8.052938   -5.8719686  25.5774135
 [97,]    3.3035745  8.973543  -14.2315687  20.5490184
 [98,]   -3.4067763 10.402645  -23.8311169  16.7239526
 [99,]   16.6226729 12.162297   -7.2379236  40.1794849
[100,]    0.5325221 14.129536  -27.0304646  27.9346469
[101,]    9.6708235 12.741623  -14.1839003  34.7570421
[102,]   -7.6805977 10.919446  -28.3494342  14.0482809
[103,]  -10.6366189  9.378369  -28.4239543   8.2124337
[104,]   -6.2051402  8.276926  -21.7802768  10.6427596
[105,]  -21.9817614  7.803551  -37.0976553  -6.7820520
[106,]  -14.4825826  8.069540  -30.2477919   1.1714037
[107,]  -14.2571039  9.009647  -32.1616057   3.0756917
[108,]    0.7151749 10.443381  -20.3538265  21.1400743
[109,]   17.3288537 12.197903   -7.7288303  41.5227244
[110,]   21.1284324 14.154422   -7.9941213  48.8529696
[111,]   17.2698026 13.148276   -8.0658564  42.7073695
[112,]  -12.4972952 11.237451  -34.1673446   9.4862412
[113,]  -16.6715930  9.606621  -35.2282941   1.7058468
[114,]  -34.2736908  8.420079  -50.9637176 -17.7552506
[115,]  -37.8088885  7.881116  -53.6978088 -22.3603131
[116,]    6.0747137  8.119726  -10.2032645  22.0290503
[117,]   38.8699159  9.074779   20.7417612  56.3429860
[118,]    5.4192182 10.553529  -15.2571522  25.7319864
[119,]   20.0634204 12.369561   -4.3777463  43.9006036
[120,]   -2.2956774 14.395792  -30.8149826  25.2566894
[121,]   -5.3097346 12.645405  -30.0770372  18.6697983
[122,]   36.7720615 10.838235   15.7185755  57.5417999
[123,]   -0.8409424  9.313106  -18.5071011  17.1667916
[124,]    2.4049537  8.228372  -13.0534085  18.3150903
[125,]  -13.8060502  7.770702  -28.6838985   1.3768540
[126,]   11.5508459  8.047798   -4.2914137  27.5998459
[127,]  -12.7854580  8.991987  -30.4842170   5.2494594
[128,]  -41.3858619 10.423539  -61.6436022 -20.4494792
[129,]    6.1111342 12.171690  -17.5653369  30.4201098
[130,]   24.6855303 14.119329   -2.5691023  53.1502920
[131,]  -50.3230829 12.629731  -75.3893745 -26.0194379
[132,]   12.1446837 10.819296   -9.1688039  32.6900449
[133,]   26.7802503  9.278843    8.1852243  44.3145511
[134,]   32.7082169  8.162683   16.6615063  48.4693270
[135,]   20.5438835  7.658626    5.6750137  35.7216281
[136,]   10.5833501  7.884948   -4.7198101  26.5027073
[137,]   -1.8677833  8.785383  -19.2183080  15.3611062
[138,]   -9.9108168 10.182642  -30.0604843   9.9254510
[139,]   -8.7518502 11.903031  -32.1894037  14.1290931
[140,]   -9.8997836 13.826452  -36.7286874  16.5555050
[141,]   17.2672976 12.094074   -6.0843443  41.2225038
[142,]    2.4328621 10.397008  -17.2105512  22.9743151
[143,]  -20.1094735  8.985979  -37.1093471  -2.3497463
[144,]  -11.0431091  8.013536  -26.1794498   4.5244946
[145,]   14.7746554  7.648832    0.1290111  29.9070784
[146,]    5.8181198  7.975676   -9.6035709  21.6541789
[147,]  -24.6079157  8.918357  -41.8674366  -6.8776421
[148,]   14.0318487 10.309301   -6.0179152  34.8918291
[149,]   -5.1588868 11.993548  -29.0275925  18.6580468
[150,]    9.7263776 13.864617  -18.1112419  37.1043374
[151,]   -1.0385193 13.544060  -26.8856488  25.9395898
[152,]   -6.9788829 11.572300  -29.3001804  16.0636461
[153,]  -17.8014466  9.862818  -36.7058934   1.9084434
[154,]  -31.4291102  8.573959  -48.2308780 -14.3622408
[155,]  -19.5646738  7.913966  -35.0753435  -3.8498614
[156,]   41.8918626  8.039246   26.1187711  57.5612096
[157,]  -36.3536010  8.916759  -53.7684534 -18.8413883
[158,]   14.8839353 10.357038   -5.3138997  35.4286471
[159,]   17.2615717 12.161759   -6.3689886  41.2897854
[160,]    9.1275081 14.192570  -18.8224412  37.0619579
[161,]   17.5518950 12.429577   -6.9984605  41.8810054
[162,]   10.6429598 10.652606  -10.5276352  31.6195717
[163,]    6.6277246  9.153744  -11.0781071  24.5770791
[164,]    1.0469894  8.089094  -14.9335630  17.0455044
[165,]  -11.0433458  7.642333  -26.3024902   3.8627407
[166,]  -15.1731811  7.918740  -30.9480258   0.5006419
[167,]  -49.8907163  8.850821  -67.1488010 -32.3066534
[168,]  -13.9972515 10.261433  -33.9885864   6.1369895
[169,]   22.6815133 11.982753   -0.3390552  46.4328566
[170,]   31.8986781 13.899825    4.9775514  59.2365026
[171,]    5.9007175 12.347070  -18.9762405  29.7625143
[172,]   -1.8236820 10.598409  -23.0298825  18.8193587
[173,]   10.5124185  9.142963   -7.5982975  28.1856324
[174,]   11.7605190  8.139571   -4.5528624  27.3656262
[175,]  -23.4851805  7.765489  -38.7375488  -8.7272376
[176,]    7.1631200  8.108290   -8.6988368  23.0194127
[177,]    0.2506205  9.087205  -17.4291254  18.2193342
[178,]   -2.7979790 10.526232  -23.7003075  18.0018279
[179,]   11.3371215 12.264468  -12.9879346  35.4939782
[180,]   -5.4676780 14.192398  -33.5446021  21.8912745</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.6 14.3
p_loo        19.2  3.2
looic      1769.2 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   560       
 (0.5, 0.7]   (ok)         1    0.6%   324       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.4
p_loo        33.4  8.3
looic      1721.4 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   904       
 (0.5, 0.7]   (ok)         3    1.7%   336       
   (0.7, 1]   (bad)        2    1.1%   24        
   (1, Inf)   (very bad)   1    0.6%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.9      11.7  
fit_sleep1 -92.6      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.3  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -884.6 14.3
p_loo        19.2  3.2
looic      1769.2 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     179   99.4%   560       
 (0.5, 0.7]   (ok)         1    0.6%   324       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -860.7 22.4
p_loo        33.4  8.3
looic      1721.4 44.7
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   904       
 (0.5, 0.7]   (ok)         3    1.7%   336       
   (0.7, 1]   (bad)        2    1.1%   24        
   (1, Inf)   (very bad)   1    0.6%   8         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -860.7     22.4        33.4    8.3   1721.4
fit_sleep2  -23.9      11.7  -884.6     14.3        19.2    3.2   1769.2
fit_sleep1  -92.6      21.0  -953.3     10.5         3.3    0.5   1906.7
           se_looic
fit_sleep3   44.7  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
6.039741e-41 4.202737e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.92      1.56     0.28     5.39       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.08      1.56    -3.29      2.9        5.1      0.84
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.2          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.5.0       
 [34] digest_0.6.31        minqa_1.2.5          rmarkdown_2.19      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.6.0   
 [43] rlang_1.0.6          shiny_1.7.4          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.4       gtools_3.9.4         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.4.0      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.19        V8_4.2.2            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.7         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
