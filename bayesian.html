<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.80      6.74    15.50    41.94 1.00     1881     2326
sd(Days)                6.53      1.48     4.16     9.85 1.00     1579     1984
cor(Intercept,Days)     0.10      0.30    -0.48     0.66 1.00     1069     1580

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.12      7.41   236.41   266.00 1.00     1542     2255
Days         10.47      1.76     6.96    14.02 1.00     1181     1812

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.92      1.62    23.01    29.36 1.00     4195     3239

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.1199  13.08498 227.6399 280.2425
309 211.4700  13.57850 184.7116 237.3387
310 213.1216  13.26661 187.3760 238.5442
330 274.3907  13.28848 249.3875 300.8702
331 272.8789  13.24538 248.3804 299.5350
332 259.8958  12.55161 236.4010 284.8770
333 268.1411  12.27422 244.2542 292.3409
334 244.3178  12.37290 219.8372 267.9942
335 250.4264  12.95933 225.3715 275.7317
337 285.9333  13.35119 259.6708 312.3667
349 226.6706  12.97437 201.1987 251.4961
350 238.9420  13.04046 212.8442 263.0290
351 255.4659  12.50964 231.2748 279.8944
352 272.1356  12.18822 249.1700 296.5779
369 254.8475  12.47339 230.6850 279.9214
370 226.2696  13.70784 197.9997 252.3593
371 252.0256  12.36910 226.9824 275.9277
372 263.5581  12.35856 239.1779 288.3458

, , Days

     Estimate Est.Error       Q2.5     Q97.5
308 19.565719  2.481016 14.6178488 24.546776
309  1.761522  2.567400 -3.2576433  6.861841
310  4.886090  2.480690  0.1667556  9.834093
330  5.766042  2.559040  0.5992459 10.720193
331  7.528207  2.531517  2.5576950 12.243970
332 10.274224  2.409016  5.5436839 14.938111
333 10.227412  2.334707  5.4528339 14.870104
334 11.486141  2.392484  6.8508927 16.436477
335 -0.151773  2.531574 -5.3462273  4.682326
337 19.160113  2.500641 14.1976925 23.917867
349 11.574300  2.437726  6.9764572 16.368896
350 17.021372  2.531846 12.2406455 22.093239
351  7.551177  2.369514  2.7919211 12.192122
352 14.053571  2.306802  9.5678941 18.413468
369 11.267702  2.359671  6.5965882 15.931951
370 15.143542  2.568847 10.2108074 20.434120
371  9.529486  2.383814  4.8727536 14.252390
372 11.815878  2.343495  7.2391255 16.431495</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.1199 13.084984 227.6399 280.2425
  [2,] 273.6856 11.184404 251.1260 295.8123
  [3,] 293.2513  9.553840 274.1287 312.1393
  [4,] 312.8170  8.352946 296.2469 329.1721
  [5,] 332.3828  7.783215 317.3965 347.8648
  [6,] 351.9485  7.980981 336.3930 368.1331
  [7,] 371.5142  8.895198 354.5454 389.6172
  [8,] 391.0799 10.337501 371.4976 411.9242
  [9,] 410.6456 12.120817 387.1986 435.1820
 [10,] 430.2113 14.116492 402.1943 458.7375
 [11,] 211.4700 13.578497 184.7116 237.3387
 [12,] 213.2315 11.612024 190.2014 235.4213
 [13,] 214.9930  9.923996 195.2743 234.4271
 [14,] 216.7545  8.678444 199.8157 233.6172
 [15,] 218.5160  8.082585 202.7036 234.3401
 [16,] 220.2776  8.277925 204.1044 236.7888
 [17,] 222.0391  9.214283 203.8858 240.1152
 [18,] 223.8006 10.698834 203.0151 245.1826
 [19,] 225.5621 12.538349 201.4811 250.6360
 [20,] 227.3237 14.599261 199.1532 256.5740
 [21,] 213.1216 13.266613 187.3760 238.5442
 [22,] 218.0077 11.395682 195.8261 239.6458
 [23,] 222.8938  9.799375 203.4676 241.7962
 [24,] 227.7798  8.631430 210.6520 244.6646
 [25,] 232.6659  8.079794 216.6185 248.3885
 [26,] 237.5520  8.268748 221.2730 253.9474
 [27,] 242.4381  9.152539 224.2596 260.3476
 [28,] 247.3242 10.558096 225.9802 267.8523
 [29,] 252.2103 12.307943 227.4712 276.3244
 [30,] 257.0964 14.276036 228.6993 285.0314
 [31,] 274.3907 13.288483 249.3875 300.8702
 [32,] 280.1567 11.313076 258.6723 302.4479
 [33,] 285.9228  9.616910 267.1470 304.8950
 [34,] 291.6888  8.371476 275.1786 308.4563
 [35,] 297.4548  7.795873 282.1652 312.8552
 [36,] 303.2209  8.035361 287.7050 318.9195
 [37,] 308.9869  9.025287 290.9337 326.6903
 [38,] 314.7530 10.556607 294.0264 335.4639
 [39,] 320.5190 12.430827 296.3010 344.8089
 [40,] 326.2851 14.515728 298.0331 354.8737
 [41,] 272.8789 13.245385 248.3804 299.5350
 [42,] 280.4071 11.303994 259.1923 303.0345
 [43,] 287.9353  9.640411 269.8779 307.2357
 [44,] 295.4635  8.420921 279.3129 311.8964
 [45,] 302.9917  7.855154 287.6382 318.2303
 [46,] 310.5199  8.081593 294.5886 326.8078
 [47,] 318.0481  9.040907 300.6503 336.4595
 [48,] 325.5763 10.534753 305.3207 347.0918
 [49,] 333.1045 12.370982 309.1104 358.2247
 [50,] 340.6327 14.419380 312.8478 369.4050
 [51,] 259.8958 12.551606 236.4010 284.8770
 [52,] 270.1700 10.748359 249.9261 291.7696
 [53,] 280.4442  9.225961 262.4941 298.8916
 [54,] 290.7184  8.143475 274.9106 306.5400
 [55,] 300.9927  7.689002 285.9241 316.1868
 [56,] 311.2669  7.970697 295.6599 326.7607
 [57,] 321.5411  8.919081 304.2878 339.1570
 [58,] 331.8153 10.352522 311.6882 352.1232
 [59,] 342.0896 12.099840 318.5121 365.4743
 [60,] 352.3638 14.044368 324.9651 379.7398
 [61,] 268.1411 12.274220 244.2542 292.3409
 [62,] 278.3686 10.599122 257.8924 299.5269
 [63,] 288.5960  9.215639 270.7807 306.8895
 [64,] 298.8234  8.271417 282.2465 314.7173
 [65,] 309.0508  7.925049 293.2610 324.0375
 [66,] 319.2782  8.252161 302.8658 335.2906
 [67,] 329.5056  9.181049 311.1541 347.2767
 [68,] 339.7330 10.553997 318.5757 360.0721
 [69,] 349.9604 12.222265 325.4036 373.8753
 [70,] 360.1879 14.081279 332.0572 387.8627
 [71,] 244.3178 12.372903 219.8372 267.9942
 [72,] 255.8039 10.626639 235.0127 276.1753
 [73,] 267.2901  9.176609 249.3553 285.2817
 [74,] 278.7762  8.181858 262.7747 294.5789
 [75,] 290.2624  7.818147 275.1663 305.5861
 [76,] 301.7485  8.170189 285.7234 317.6334
 [77,] 313.2346  9.155792 295.6538 330.9848
 [78,] 324.7208 10.599671 304.5037 345.3929
 [79,] 336.2069 12.342021 312.1725 359.9334
 [80,] 347.6931 14.273959 319.4402 375.5624
 [81,] 250.4264 12.959333 225.3715 275.7317
 [82,] 250.2746 11.052370 228.8466 271.9148
 [83,] 250.1229  9.443684 231.6152 268.9066
 [84,] 249.9711  8.308381 233.5308 266.2100
 [85,] 249.8193  7.854486 234.2109 265.3397
 [86,] 249.6675  8.196002 233.6823 266.2286
 [87,] 249.5158  9.245197 231.7457 267.9732
 [88,] 249.3640 10.797714 228.3777 270.7196
 [89,] 249.2122 12.669858 224.3817 274.3006
 [90,] 249.0605 14.740344 219.9256 278.4989
 [91,] 285.9333 13.351195 259.6708 312.3667
 [92,] 305.0935 11.450888 282.8110 327.7198
 [93,] 324.2536  9.823323 305.2522 343.3348
 [94,] 343.4137  8.624321 326.5421 360.1875
 [95,] 362.5738  8.047768 346.8211 378.4941
 [96,] 381.7339  8.225609 365.3652 398.1913
 [97,] 400.8940  9.113787 382.5132 418.9075
 [98,] 420.0541 10.534134 398.7760 441.0045
 [99,] 439.2143 12.303710 414.7026 463.1899
[100,] 458.3744 14.293389 430.3040 486.0754
[101,] 226.6706 12.974372 201.1987 251.4961
[102,] 238.2449 11.147119 216.2213 259.5842
[103,] 249.8192  9.595166 230.9555 268.4365
[104,] 261.3935  8.471197 244.7230 277.5801
[105,] 272.9678  7.958653 257.4140 288.2140
[106,] 284.5421  8.173381 268.5757 300.3628
[107,] 296.1164  9.063839 278.2402 313.5450
[108,] 307.6907 10.458834 286.9048 327.9636
[109,] 319.2650 12.186314 295.7109 342.7788
[110,] 330.8393 14.124812 303.3374 358.4136
[111,] 238.9420 13.040462 212.8442 263.0290
[112,] 255.9633 11.129230 233.6509 276.5096
[113,] 272.9847  9.512433 253.4456 291.1709
[114,] 290.0061  8.362624 273.1349 306.0298
[115,] 307.0274  7.886765 291.5326 322.5790
[116,] 324.0488  8.202996 307.8157 340.3566
[117,] 341.0702  9.230260 322.8840 359.6171
[118,] 358.0916 10.766929 337.0486 379.8416
[119,] 375.1129 12.628393 350.6296 400.3282
[120,] 392.1343 14.691709 363.6299 421.4744
[121,] 255.4659 12.509642 231.2748 279.8944
[122,] 263.0171 10.754549 242.1253 284.4679
[123,] 270.5683  9.276783 251.7940 288.9009
[124,] 278.1195  8.227167 261.5251 294.3680
[125,] 285.6706  7.780940 270.1181 300.7122
[126,] 293.2218  8.039214 277.1859 309.0513
[127,] 300.7730  8.941146 283.0053 318.1633
[128,] 308.3242 10.319322 288.0350 328.4251
[129,] 315.8753 12.010908 292.5088 339.0047
[130,] 323.4265 13.901964 296.3270 350.1274
[131,] 272.1356 12.188221 249.1700 296.5779
[132,] 286.1892 10.514250 266.3505 307.4526
[133,] 300.2427  9.120792 283.1041 318.3828
[134,] 314.2963  8.152969 298.4546 330.2983
[135,] 328.3499  7.771463 313.4905 343.5368
[136,] 342.4035  8.059966 326.6610 358.5525
[137,] 356.4570  8.953945 339.1080 374.1311
[138,] 370.5106 10.296888 350.4683 390.8158
[139,] 384.5642 11.938230 361.4342 408.1385
[140,] 398.6177 13.771689 371.9704 426.0546
[141,] 254.8475 12.473386 230.6850 279.9214
[142,] 266.1152 10.743909 245.0913 287.6306
[143,] 277.3829  9.295908 259.3696 295.6206
[144,] 288.6506  8.278425 272.8514 304.9685
[145,] 299.9183  7.860460 284.3421 315.3711
[146,] 311.1860  8.134951 295.0690 327.1747
[147,] 322.4537  9.039034 304.5349 340.1361
[148,] 333.7214 10.409943 313.1463 353.8880
[149,] 344.9891 12.089905 320.9863 368.5387
[150,] 356.2568 13.967849 328.4132 383.4504
[151,] 226.2696 13.707839 197.9997 252.3593
[152,] 241.4132 11.724544 217.5144 263.4944
[153,] 256.5567 10.011140 236.6601 275.5779
[154,] 271.7003  8.728052 254.6707 288.5834
[155,] 286.8438  8.082871 270.9075 302.4947
[156,] 301.9874  8.227069 285.6818 317.9920
[157,] 317.1309  9.123293 299.3130 334.9681
[158,] 332.2744 10.582166 311.4829 353.0277
[159,] 347.4180 12.406770 323.0339 372.3715
[160,] 362.5615 14.459308 334.4633 391.7329
[161,] 252.0256 12.369097 226.9824 275.9277
[162,] 261.5551 10.611094 240.0203 282.0813
[163,] 271.0846  9.141183 252.7354 288.5056
[164,] 280.6141  8.117405 264.0872 296.1363
[165,] 290.1436  7.719356 274.6256 305.1773
[166,] 299.6731  8.040508 284.2186 315.3368
[167,] 309.2026  9.004234 291.8593 327.3250
[168,] 318.7320 10.433975 298.6439 339.8257
[169,] 328.2615 12.166534 304.9582 352.7080
[170,] 337.7910 14.090651 310.9395 366.3014
[171,] 263.5581 12.358556 239.1779 288.3458
[172,] 275.3740 10.650199 254.7895 296.5908
[173,] 287.1898  9.225156 269.5413 305.7322
[174,] 299.0057  8.231901 283.2608 315.3601
[175,] 310.8216  7.836378 295.2668 326.1625
[176,] 322.6375  8.126340 306.4282 338.5470
[177,] 334.4534  9.036034 316.1524 352.1542
[178,] 346.2692 10.404150 325.2635 366.9289
[179,] 358.0851 12.075874 333.9655 381.4588
[180,] 369.9010 13.942419 342.3996 396.8541</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>            Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.55987535 13.084984 -3.068246e+01  21.9201031
  [2,]  -14.98089474 11.184404 -3.710759e+01   7.5786952
  [3,]  -42.45071414  9.553840 -6.133871e+01 -23.3280880
  [4,]    8.62276647  8.352946 -7.732296e+00  25.1929359
  [5,]   24.46914707  7.783215  8.987111e+00  39.4554078
  [6,]   62.74162768  7.980981  4.655702e+01  78.2970696
  [7,]   10.68960829  8.895198 -7.413439e+00  27.6584256
  [8,] -100.93131111 10.337501 -1.217756e+02 -81.3489786
  [9,]   19.93966950 12.120817 -4.596700e+00  43.3866763
 [10,]   36.14215010 14.116492  7.615969e+00  64.1591897
 [11,]   11.26394750 13.578497 -1.460478e+01  38.0222816
 [12,]   -7.96567453 11.612024 -3.015548e+01  15.0644436
 [13,]  -12.01519655  9.923996 -3.144928e+01   7.7034870
 [14,]  -12.04751858  8.678444 -2.891022e+01   4.8913178
 [15,]  -10.79994060  8.082585 -2.662396e+01   5.0124687
 [16,]   -4.31576263  8.277925 -2.082703e+01  11.8574472
 [17,]   -8.40878465  9.214283 -2.648494e+01   9.7444650
 [18,]   -6.07340668 10.698834 -2.745544e+01  14.7121198
 [19,]   -1.26642870 12.538349 -2.634031e+01  22.8146497
 [20,]    9.99054927 14.599261 -1.925975e+01  38.1609616
 [21,]  -14.06767916 13.266613 -3.949031e+01  11.6779085
 [22,]  -23.67546914 11.395682 -4.531355e+01  -1.4938951
 [23,]   11.42624087  9.799375 -7.476239e+00  30.8523857
 [24,]    5.06175089  8.631430 -1.182296e+01  22.1896353
 [25,]   -3.35853910  8.079794 -1.908110e+01  12.6889072
 [26,]  -17.09412908  8.268748 -3.348950e+01  -0.8151005
 [27,]   -7.01731906  9.152539 -2.492677e+01  11.1611500
 [28,]    8.42689095 10.558096 -1.210115e+01  29.7708697
 [29,]    8.80220097 12.307943 -1.531190e+01  33.5413169
 [30,]   -9.58108902 14.276036 -3.751607e+01  18.8159500
 [31,]   47.15192269 13.288483  2.067243e+01  72.1550587
 [32,]   20.24348040 11.313076 -2.047661e+00  41.7278654
 [33,]   -2.06626189  9.616910 -2.103853e+01  16.7094744
 [34,]   -6.55580418  8.371476 -2.332334e+01   9.9543635
 [35,]  -11.65754647  7.795873 -2.705787e+01   3.6321409
 [36,]   -5.63538876  8.035361 -2.133405e+01   9.8804506
 [37,]  -28.74733105  9.025287 -4.645067e+01 -10.6941032
 [38,]    3.50832666 10.556607 -1.720263e+01  24.2349482
 [39,]  -15.16951563 12.430827 -3.945940e+01   9.0484957
 [40,]   27.76364208 14.515728 -8.250252e-01  56.0155896
 [41,]   14.72901231 13.245385 -1.192707e+01  39.2275049
 [42,]    4.59290564 11.303994 -1.803450e+01  25.8077245
 [43,]   13.88529897  9.640411 -5.415068e+00  31.9427216
 [44,]   24.65179230  8.420921  8.218892e+00  40.8023678
 [45,]   13.28558563  7.855154 -1.952995e+00  28.6391178
 [46,]  -17.20122104  8.081593 -3.348909e+01  -1.2698571
 [47,]  -27.97312771  9.040907 -4.638450e+01 -10.5752661
 [48,]    9.24136562 10.534753 -1.227415e+01  29.4970078
 [49,]  -39.35764105 12.370982 -6.447775e+01 -15.3635451
 [50,]   30.94835228 14.419380  2.176054e+00  58.7332774
 [51,]  -25.03516817 12.551606 -5.001636e+01  -1.5404446
 [52,]  -27.35819180 10.748359 -4.895778e+01  -7.1142708
 [53,]   -7.48291544  9.225961 -2.593025e+01  10.4671701
 [54,]   19.05036093  8.143475  3.228818e+00  34.8582324
 [55,]   16.47023730  7.689002  1.276127e+00  31.5388273
 [56,]   -1.26928634  7.970697 -1.676310e+01  14.3377487
 [57,]  132.62079003  8.919081  1.150049e+02 149.8740615
 [58,]   15.01576640 10.352522 -5.292105e+00  35.1429406
 [59,]  -11.78925724 12.099840 -3.517403e+01  11.7881567
 [60,]  -98.49938087 14.044368 -1.258754e+02 -71.1007182
 [61,]   15.70126042 12.274220 -8.498532e+00  39.5882280
 [62,]   11.18644808 10.599122 -9.971946e+00  31.6626157
 [63,]  -11.82666427  9.215639 -3.012019e+01   5.9885934
 [64,]    0.98632339  8.271417 -1.490762e+01  17.5632197
 [65,]  -11.87978896  7.925049 -2.686653e+01   3.9100269
 [66,]   18.88829869  8.252161  2.875892e+00  35.3007165
 [67,]    2.52088635  9.181049 -1.525018e+01  20.8723660
 [68,]    9.10687400 10.553997 -1.123220e+01  30.2641736
 [69,]  -16.60043835 12.222265 -4.051533e+01   7.9563520
 [70,]    1.85494931 14.081279 -2.581992e+01  29.9856265
 [71,]   21.15530485 12.372903 -2.521058e+00  45.6359323
 [72,]   20.39726381 10.626639  2.589699e-02  41.1884618
 [73,]  -23.92537722  9.176609 -4.191700e+01  -5.9905696
 [74,]  -24.10391825  8.181858 -3.990661e+01  -8.1023732
 [75,]  -11.23795929  7.818147 -2.656170e+01   3.8580821
 [76,]  -17.55730032  8.170189 -3.344225e+01  -1.5322298
 [77,]   -7.70984135  9.155792 -2.545999e+01   9.8710201
 [78,]    6.80211761 10.599671 -1.387001e+01  27.0192163
 [79,]   -0.46002342 12.342021 -2.418654e+01  23.5743523
 [80,]   29.60593555 14.273959  1.736558e+00  57.8588034
 [81,]   -8.81811071 12.959333 -3.412342e+01  16.2368224
 [82,]   23.67256233 11.052370  2.032425e+00  45.1006203
 [83,]    4.36783537  9.443684 -1.441594e+01  22.8755323
 [84,]   20.83100841  8.308381  4.592104e+00  37.2712902
 [85,]    1.63258145  7.854486 -1.388779e+01  17.2409741
 [86,]    4.96865449  8.196002 -1.159244e+01  20.9538862
 [87,]   -4.06347247  9.245197 -2.252094e+01  13.7065820
 [88,]  -14.05299942 10.797714 -3.540863e+01   6.9333393
 [89,]  -13.45812638 12.669858 -3.854653e+01  11.3724312
 [90,]  -11.81385334 14.740344 -4.125227e+01  17.3209963
 [91,]   26.43325668 13.351195 -8.916420e-05  52.6957939
 [92,]    8.71234333 11.450888 -1.391401e+01  30.9947873
 [93,]  -32.64237002  9.823323 -5.172356e+01 -13.6410221
 [94,]    2.70851663  8.624321 -1.406532e+01  19.5800516
 [95,]    3.15860328  8.047768 -1.276166e+01  18.9112865
 [96,]   10.10458994  8.225609 -6.352822e+00  26.4733363
 [97,]    3.36607659  9.113787 -1.464741e+01  21.7469056
 [98,]   -3.36183676 10.534134 -2.431218e+01  17.9162790
 [99,]   16.65004989 12.303710 -7.325631e+00  41.1616506
[100,]    0.54233654 14.293389 -2.715865e+01  28.6127204
[101,]    9.43256574 12.974372 -1.539294e+01  34.9044559
[102,]   -7.92823410 11.147119 -2.926754e+01  14.0953903
[103,]  -10.89363394  9.595166 -2.951093e+01   7.9701033
[104,]   -6.47153378  8.471197 -2.265806e+01  10.1990074
[105,]  -22.25753362  7.958653 -3.750369e+01  -6.7036856
[106,]  -14.76773346  8.173381 -3.058838e+01   1.1987062
[107,]  -14.55163329  9.063839 -3.198017e+01   3.3245855
[108,]    0.41126687 10.458834 -1.986165e+01  21.1971921
[109,]   17.01556703 12.186314 -6.498158e+00  40.5696588
[110,]   20.80576719 14.124812 -6.768533e+00  48.3077208
[111,]   17.35484270 13.040462 -6.732191e+00  43.4526478
[112,]  -12.50902898 11.129230 -3.305528e+01   9.8033966
[113,]  -16.78010067  9.512433 -3.496631e+01   2.7590101
[114,]  -34.47897235  8.362624 -5.050267e+01 -17.6077998
[115,]  -38.11094404  7.886765 -5.366250e+01 -22.6160740
[116,]    5.67588428  8.202996 -1.063189e+01  21.9089582
[117,]   38.37431259  9.230260  1.982739e+01  56.5604735
[118,]    4.82684091 10.766929 -1.692324e+01  25.8697552
[119,]   19.37426922 12.628393 -5.840996e+00  43.8575879
[120,]   -3.08160247 14.691709 -3.242172e+01  25.4227961
[121,]   -4.93942377 12.509642 -2.936788e+01  19.2516634
[122,]   37.04049946 10.754549  1.558971e+01  57.9322687
[123,]   -0.67437730  9.276783 -1.900697e+01  18.0999342
[124,]    2.46964594  8.227167 -1.377890e+01  19.0640068
[125,]  -13.84323082  7.780940 -2.888477e+01   1.7092742
[126,]   11.41179242  8.039214 -4.417735e+00  27.4476547
[127,]  -13.02638434  8.941146 -3.041670e+01   4.7412784
[128,]  -41.72866111 10.319322 -6.182959e+01 -21.4395034
[129,]    5.66646213 12.010908 -1.746285e+01  29.0330253
[130,]   24.13898537 13.901964 -2.561888e+00  51.2385205
[131,]  -50.45849991 12.188221 -7.490076e+01 -27.4929070
[132,]   12.00472908 10.514250 -9.258723e+00  31.8434176
[133,]   26.63575806  9.120792  8.495665e+00  43.7744371
[134,]   32.55918705  8.152969  1.655720e+01  48.4009092
[135,]   20.39031603  7.771463  5.203360e+00  35.2496820
[136,]   10.42524502  8.059966 -5.723827e+00  26.1677351
[137,]   -2.03042600  8.953945 -1.970453e+01  15.3185769
[138,]  -10.07799701 10.296888 -3.038315e+01   9.9642597
[139,]   -8.92356803 11.938230 -3.249786e+01  14.2064258
[140,]  -10.07603905 13.771689 -3.751290e+01  16.5712710
[141,]   17.07602930 12.473386 -7.997934e+00  41.2384910
[142,]    2.32172726 10.743909 -1.919375e+01  23.3456061
[143,]  -20.14047477  9.295908 -3.837824e+01  -2.1271606
[144,]  -10.99397681  8.278425 -2.731185e+01   4.8052058
[145,]   14.90392115  7.860460 -5.488591e-01  30.4801063
[146,]    6.02751912  8.134951 -9.961244e+00  22.1445010
[147,]  -24.31838292  9.039034 -4.200080e+01  -6.3995646
[148,]   14.40151505 10.409943 -5.765148e+00  34.9766445
[149,]   -4.70908699 12.089905 -2.825871e+01  19.2937329
[150,]   10.25631098 13.967849 -1.693732e+01  38.0999412
[151,]   -1.00564706 13.707839 -2.709530e+01  27.2643302
[152,]   -6.88968872 11.724544 -2.897089e+01  17.0090520
[153,]  -17.65593038 10.011140 -3.667707e+01   2.2407460
[154,]  -31.22727204  8.728052 -4.811042e+01 -14.1977324
[155,]  -19.30651369  8.082871 -3.495741e+01  -3.3702289
[156,]   42.20634465  8.227069  2.620175e+01  58.5118533
[157,]  -35.98279701  9.123293 -5.382000e+01 -18.1648866
[158,]   15.31106133 10.582166 -5.442220e+00  36.1025814
[159,]   17.74501968 12.406770 -7.208458e+00  42.1291021
[160,]    9.66727802 14.459308 -1.950406e+01  37.7654949
[161,]   17.85475812 12.369097 -6.047283e+00  42.8980300
[162,]   10.88767187 10.611094 -9.638469e+00  32.4224536
[163,]    6.81428561  9.141183 -1.060667e+01  25.1634850
[164,]    1.17539935  8.117405 -1.434676e+01  17.7023423
[165,]  -10.97308691  7.719356 -2.600679e+01   4.5448635
[166,]  -15.16107317  8.040508 -3.082476e+01   0.2934260
[167,]  -49.93675942  9.004234 -6.805920e+01 -32.5934744
[168,]  -14.10144568 10.433975 -3.519512e+01   5.9866614
[169,]   22.51916806 12.166534 -1.927341e+00  45.8224798
[170,]   31.67818180 14.090651  3.167764e+00  58.5296821
[171,]    5.85361120 12.358556 -1.893408e+01  30.2338148
[172,]   -1.89996698 10.650199 -2.311681e+01  18.6844670
[173,]   10.40695484  9.225156 -8.135427e+00  28.0555085
[174,]   11.62587666  8.231901 -4.728463e+00  27.3707958
[175,]  -23.64900152  7.836378 -3.898985e+01  -8.0941750
[176,]    6.97012030  8.126340 -8.939429e+00  23.1794281
[177,]    0.02844212  9.036034 -1.767239e+01  18.3293868
[178,]   -3.04933606 10.404150 -2.370895e+01  17.9564185
[179,]   11.05658576 12.075874 -1.231714e+01  35.1761815
[180,]   -5.77739242 13.942419 -3.273053e+01  21.7240190</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.4
p_loo        19.8  3.4
looic      1770.5 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1252      
 (0.5, 0.7]   (ok)         2    1.1%   175       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.3 22.5
p_loo        34.1  8.6
looic      1722.6 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   724       
 (0.5, 0.7]   (ok)         5    2.8%   893       
   (0.7, 1]   (bad)        2    1.1%   30        
   (1, Inf)   (very bad)   1    0.6%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.9      11.7  
fit_sleep1 -92.0      21.1  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.7 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.4
p_loo        19.8  3.4
looic      1770.5 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1252      
 (0.5, 0.7]   (ok)         2    1.1%   175       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.3 22.5
p_loo        34.1  8.6
looic      1722.6 44.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     172   95.6%   724       
 (0.5, 0.7]   (ok)         5    2.8%   893       
   (0.7, 1]   (bad)        2    1.1%   30        
   (1, Inf)   (very bad)   1    0.6%   10        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.3     22.5        34.1    8.6   1722.6
fit_sleep2  -23.9      11.7  -885.3     14.4        19.8    3.4   1770.5
fit_sleep1  -92.0      21.1  -953.3     10.5         3.2    0.5   1906.7
           se_looic
fit_sleep3   44.9  
fit_sleep2   28.9  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.096736e-40 4.031196e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0     2.82      1.58     0.14     5.37       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0    -0.18      1.58    -3.31     2.84       5.56      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.62.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.2          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        ggridges_0.5.4       callr_3.7.3         
 [34] stringr_1.4.1        digest_0.6.30        minqa_1.2.5         
 [37] rmarkdown_2.18       base64enc_0.1-3      pkgconfig_2.0.3     
 [40] htmltools_0.5.3      highr_0.9            fastmap_1.1.0       
 [43] htmlwidgets_1.5.4    rlang_1.0.6          shiny_1.7.3         
 [46] jquerylib_0.1.4      farver_2.1.1         generics_0.1.3      
 [49] zoo_1.8-11           jsonlite_1.8.3       gtools_3.9.3        
 [52] crosstalk_1.2.0      dplyr_1.0.10         distributional_0.3.1
 [55] inline_0.3.19        magrittr_2.0.3       loo_2.5.1           
 [58] bayesplot_1.9.0      munsell_0.5.0        fansi_1.0.3         
 [61] abind_1.4-5          lifecycle_1.0.3      stringi_1.7.8       
 [64] yaml_2.3.6           MASS_7.3-58.1        plyr_1.8.8          
 [67] pkgbuild_1.3.1       grid_4.2.2           parallel_4.2.2      
 [70] promises_1.2.0.1     crayon_1.5.2         miniUI_0.1.1.1      
 [73] lattice_0.20-45      splines_4.2.2        knitr_1.40          
 [76] ps_1.7.2             pillar_1.8.1         igraph_1.3.5        
 [79] boot_1.3-28          markdown_1.3         shinystan_2.6.0     
 [82] reshape2_1.4.4       codetools_0.2-18     stats4_4.2.2        
 [85] rstantools_2.2.0     glue_1.6.2           evaluate_0.18       
 [88] V8_4.2.1             RcppParallel_5.1.5   vctrs_0.5.0         
 [91] nloptr_2.0.3         httpuv_1.6.6         gtable_0.3.1        
 [94] assertthat_0.2.1     cachem_1.0.6         ggplot2_3.4.0       
 [97] xfun_0.34            mime_0.12            xtable_1.8-4        
[100] coda_0.19-4          later_1.3.0          tibble_3.1.8        
[103] shinythemes_1.2.0    ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
