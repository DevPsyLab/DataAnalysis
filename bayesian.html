<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian BÃ¼rkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.75      6.70    15.14    41.19 1.00     1653     2369
sd(Days)                6.57      1.51     4.13     9.99 1.00     1416     1721
cor(Intercept,Days)     0.09      0.30    -0.47     0.69 1.00      846     1682

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.14      7.45   236.41   265.62 1.00     1644     2374
Days         10.42      1.75     6.90    13.93 1.00     1354     1795

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.91      1.61    23.01    29.25 1.00     3222     3138

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 253.7816  13.02537 228.7400 278.9172
309 211.4265  13.49091 185.1759 237.5778
310 212.9971  13.44612 186.3391 238.5240
330 274.4993  13.31541 249.2421 301.5209
331 273.5178  12.92171 248.8083 299.4490
332 260.2054  12.37557 236.2414 284.9185
333 267.6691  12.44037 243.7213 293.0988
334 244.5795  12.41317 219.9991 268.8903
335 250.6596  13.22603 225.0118 276.0034
337 286.0033  13.05736 261.2531 312.3911
349 226.9970  13.03595 201.6708 251.4327
350 238.5419  13.34028 211.9658 263.7523
351 255.9818  12.32568 232.5292 281.4799
352 272.1054  12.35229 248.7031 297.0786
369 254.6438  12.52779 229.9044 278.3816
370 226.5637  13.31164 199.8730 251.5480
371 252.4228  12.51338 227.5483 276.8538
372 263.7866  12.22262 240.1077 288.1319

, , Days

      Estimate Est.Error        Q2.5     Q97.5
308 19.6128917  2.510715 14.73108960 24.585273
309  1.7999365  2.499156 -3.13716435  6.559964
310  4.9214548  2.525146 -0.09127152 10.040411
330  5.7552271  2.485637  0.81189241 10.488539
331  7.4225163  2.500314  2.49305680 12.061156
332 10.2144221  2.362029  5.62769557 14.880438
333 10.3425015  2.353664  5.66576675 14.963057
334 11.4728953  2.366712  6.80972846 16.101905
335 -0.2046133  2.565895 -5.34026005  4.816785
337 19.1303013  2.479510 14.18728423 23.868634
349 11.5051513  2.433317  6.95924067 16.283073
350 17.0187236  2.579363 12.07755556 22.216487
351  7.4556901  2.359798  2.80218556 12.011023
352 14.0185335  2.387532  9.26777406 18.616234
369 11.3319606  2.381004  6.75183790 15.964521
370 15.1875387  2.534895 10.39320333 20.348225
371  9.4464856  2.367800  4.74670553 14.155957
372 11.7630268  2.339732  7.29111560 16.388062</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 253.7816 13.025368 228.7400 278.9172
  [2,] 273.3945 11.136000 251.8546 295.1198
  [3,] 293.0074  9.537724 274.7788 311.6740
  [4,] 312.6203  8.398405 296.2808 329.1878
  [5,] 332.2332  7.918689 316.4586 347.9353
  [6,] 351.8461  8.214951 335.3773 368.0257
  [7,] 371.4590  9.212632 353.0205 389.4237
  [8,] 391.0719 10.717609 369.9413 411.8218
  [9,] 410.6848 12.548667 385.7997 435.0445
 [10,] 430.2977 14.583496 401.8238 458.7921
 [11,] 211.4265 13.490906 185.1759 237.5778
 [12,] 213.2264 11.576366 190.6784 235.4952
 [13,] 215.0263  9.925295 195.5782 234.3272
 [14,] 216.8263  8.689205 199.4456 233.4887
 [15,] 218.6262  8.061305 202.4198 233.8612
 [16,] 220.4261  8.182821 204.1178 236.4103
 [17,] 222.2261  9.023527 204.4806 240.0322
 [18,] 224.0260 10.410623 203.7384 244.7140
 [19,] 225.8259 12.158522 202.3263 248.9534
 [20,] 227.6259 14.133994 200.5260 255.0791
 [21,] 212.9971 13.446124 186.3391 238.5240
 [22,] 217.9185 11.501566 195.2155 239.8523
 [23,] 222.8400  9.824790 203.6045 242.1675
 [24,] 227.7614  8.574364 211.2155 245.2938
 [25,] 232.6829  7.953972 217.6495 249.0918
 [26,] 237.6043  8.109522 222.0643 254.2605
 [27,] 242.5258  9.000875 225.4960 260.5827
 [28,] 247.4473 10.441259 226.9770 267.8745
 [29,] 252.3687 12.238331 228.1982 276.6600
 [30,] 257.2902 14.257852 229.1054 285.6102
 [31,] 274.4993 13.315408 249.2421 301.5209
 [32,] 280.2545 11.432896 258.9124 303.3498
 [33,] 286.0098  9.822366 267.3852 305.1681
 [34,] 291.7650  8.637328 275.0528 308.7197
 [35,] 297.5202  8.067514 281.8712 313.5201
 [36,] 303.2754  8.241535 287.0043 319.5342
 [37,] 309.0307  9.116897 291.6072 327.2664
 [38,] 314.7859 10.519957 294.6559 335.9377
 [39,] 320.5411 12.271021 296.9984 345.3383
 [40,] 326.2964 14.242303 299.2469 354.9796
 [41,] 273.5178 12.921712 248.8083 299.4490
 [42,] 280.9403 11.033289 259.7612 302.8116
 [43,] 288.3628  9.433950 269.9171 307.1313
 [44,] 295.7853  8.292678 279.5819 312.3367
 [45,] 303.2078  7.812858 287.7542 318.5812
 [46,] 310.6303  8.112714 294.7315 326.2281
 [47,] 318.0529  9.115626 300.0248 335.1945
 [48,] 325.4754 10.624326 304.3935 345.7099
 [49,] 332.8979 12.456368 308.4095 356.6091
 [50,] 340.3204 14.489618 312.4616 367.8454
 [51,] 260.2054 12.375574 236.2414 284.9185
 [52,] 270.4199 10.667166 249.5330 291.6953
 [53,] 280.6343  9.250967 262.6812 299.1013
 [54,] 290.8487  8.278328 274.9643 307.1291
 [55,] 301.0631  7.914506 285.8854 316.7428
 [56,] 311.2775  8.240538 295.5863 327.5402
 [57,] 321.4920  9.183239 303.4699 339.8792
 [58,] 331.7064 10.579020 310.9812 353.2287
 [59,] 341.9208 12.274275 318.1842 366.5013
 [60,] 352.1352 14.161862 324.8619 380.5682
 [61,] 267.6691 12.440368 243.7213 293.0988
 [62,] 278.0116 10.779858 257.2989 299.6514
 [63,] 288.3541  9.419522 270.2981 307.1127
 [64,] 298.6966  8.504642 282.2852 315.4825
 [65,] 309.0391  8.185959 292.7899 324.8969
 [66,] 319.3816  8.530557 302.2466 335.8250
 [67,] 329.7241  9.466274 310.9051 348.4412
 [68,] 340.0666 10.841114 319.1036 361.2725
 [69,] 350.4091 12.511141 326.2125 375.4346
 [70,] 360.7516 14.373831 333.0352 389.3453
 [71,] 244.5795 12.413169 219.9991 268.8903
 [72,] 256.0524 10.670364 234.6189 276.9266
 [73,] 267.5253  9.210277 248.9126 285.7167
 [74,] 278.9982  8.185621 262.7511 295.1221
 [75,] 290.4711  7.770601 275.0234 305.5082
 [76,] 301.9440  8.059947 285.8243 318.3836
 [77,] 313.4169  8.985873 295.7727 331.9257
 [78,] 324.8898 10.379389 304.1398 345.7419
 [79,] 336.3627 12.079743 312.7208 360.2931
 [80,] 347.8356 13.975382 320.8768 375.6592
 [81,] 250.6596 13.226034 225.0118 276.0034
 [82,] 250.4550 11.281399 228.5752 272.3132
 [83,] 250.2503  9.632216 231.4588 269.1380
 [84,] 250.0457  8.453215 233.5240 266.9360
 [85,] 249.8411  7.956238 234.1566 265.5861
 [86,] 249.6365  8.265242 233.4831 265.9334
 [87,] 249.4319  9.300235 231.3793 267.7468
 [88,] 249.2273 10.855512 227.8779 270.7511
 [89,] 249.0227 12.741960 224.1355 274.7873
 [90,] 248.8180 14.833764 220.0193 278.7669
 [91,] 286.0033 13.057362 261.2531 312.3911
 [92,] 305.1336 11.173323 283.9057 327.3326
 [93,] 324.2639  9.564913 305.7624 343.0502
 [94,] 343.3942  8.392133 326.9849 360.0987
 [95,] 362.5245  7.852654 347.2619 377.8682
 [96,] 381.6548  8.074427 365.7134 397.1506
 [97,] 400.7851  9.001362 383.1610 418.3190
 [98,] 419.9154 10.447421 399.2720 440.5441
 [99,] 439.0457 12.229826 415.0193 463.6450
[100,] 458.1760 14.222679 430.1789 486.5729
[101,] 226.9970 13.035947 201.6708 251.4327
[102,] 238.5021 11.192907 216.6129 259.7887
[103,] 250.0073  9.616052 231.3249 268.4362
[104,] 261.5124  8.455638 244.9603 278.0618
[105,] 273.0176  7.897420 257.4227 287.9910
[106,] 284.5227  8.067387 268.8074 299.7863
[107,] 296.0279  8.924028 278.2285 312.7613
[108,] 307.5330 10.297373 286.6559 327.0200
[109,] 319.0382 12.011476 295.0580 341.7860
[110,] 330.5433 13.941208 303.2622 357.2713
[111,] 238.5419 13.340283 211.9658 263.7523
[112,] 255.5606 11.360464 232.6321 277.3938
[113,] 272.5793  9.667645 252.9047 291.4864
[114,] 289.5980  8.436398 272.6136 306.2257
[115,] 306.6168  7.885967 291.0919 322.1290
[116,] 323.6355  8.155390 307.9646 339.4674
[117,] 340.6542  9.172706 322.9531 358.6575
[118,] 357.6729 10.727204 337.0862 378.8602
[119,] 374.6916 12.621945 350.5677 399.6678
[120,] 391.7104 14.726178 363.1885 421.0864
[121,] 255.9818 12.325684 232.5292 281.4799
[122,] 263.4375 10.610348 242.9153 284.9967
[123,] 270.8932  9.185521 252.7620 289.4472
[124,] 278.3489  8.203987 262.3504 294.7750
[125,] 285.8046  7.834175 270.4039 301.0239
[126,] 293.2603  8.159687 277.2892 308.9155
[127,] 300.7159  9.106260 282.8054 317.7576
[128,] 308.1716 10.507366 287.3279 328.3142
[129,] 315.6273 12.207490 291.5117 339.0676
[130,] 323.0830 14.098872 295.0964 350.3748
[131,] 272.1054 12.352294 248.7031 297.0786
[132,] 286.1240 10.584124 266.0236 307.7193
[133,] 300.1425  9.103231 283.0488 318.5543
[134,] 314.1610  8.069359 298.9927 330.2216
[135,] 328.1796  7.665568 314.0192 343.1982
[136,] 342.1981  7.987986 327.0167 357.7037
[137,] 356.2166  8.958546 339.2456 373.9033
[138,] 370.2352 10.397297 350.3418 390.6494
[139,] 384.2537 12.138889 360.9487 408.4151
[140,] 398.2722 14.071323 371.1959 425.8593
[141,] 254.6438 12.527786 229.9044 278.3816
[142,] 265.9758 10.790812 244.4295 286.4065
[143,] 277.3078  9.342172 258.7793 295.4663
[144,] 288.6397  8.333613 272.4643 305.1493
[145,] 299.9717  7.934758 284.4580 316.4797
[146,] 311.3036  8.234685 295.7361 328.4771
[147,] 322.6356  9.165045 305.0957 341.4612
[148,] 333.9676 10.560512 313.5280 355.7867
[149,] 345.2995 12.263325 321.5491 370.4394
[150,] 356.6315 14.163059 328.9983 385.7627
[151,] 226.5637 13.311637 199.8730 251.5480
[152,] 241.7513 11.363386 218.5536 263.3430
[153,] 256.9388  9.690448 237.0778 275.3706
[154,] 272.1263  8.457802 255.0046 288.6989
[155,] 287.3139  7.874988 271.5882 302.8881
[156,] 302.5014  8.083802 286.6971 318.0984
[157,] 317.6889  9.029487 299.8487 335.0823
[158,] 332.8765 10.515076 312.1469 353.3251
[159,] 348.0640 12.347201 324.0923 372.0750
[160,] 363.2516 14.394142 335.0452 391.0838
[161,] 252.4228 12.513375 227.5483 276.8538
[162,] 261.8693 10.820515 240.1760 283.3839
[163,] 271.3158  9.423136 252.6529 289.8985
[164,] 280.7623  8.468789 264.0967 297.3931
[165,] 290.2088  8.115310 274.2733 305.9242
[166,] 299.6553  8.438546 283.2079 316.2632
[167,] 309.1017  9.368715 290.9364 327.7214
[168,] 318.5482 10.749397 297.8760 340.0102
[169,] 327.9947 12.431380 303.7965 353.0497
[170,] 337.4412 14.308803 309.1011 365.8245
[171,] 263.7866 12.222620 240.1077 288.1319
[172,] 275.5497 10.545025 254.9394 296.5164
[173,] 287.3127  9.162498 269.3726 305.4391
[174,] 299.0757  8.225198 283.0216 315.0515
[175,] 310.8387  7.893356 295.3328 325.9986
[176,] 322.6018  8.240446 306.2869 338.6875
[177,] 334.3648  9.189861 316.3158 352.3596
[178,] 346.1278 10.580681 325.8383 366.7417
[179,] 357.8908 12.263636 334.5404 381.8563
[180,] 369.6539 14.134760 342.5966 397.5114</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.2216308 13.025368  -29.35716062  20.8200026
  [2,]  -14.6898224 11.136000  -36.41514621   6.8500774
  [3,]  -42.2068141  9.537724  -60.87335417 -23.9781740
  [4,]    8.8194942  8.398405   -7.74801549  25.1589797
  [5,]   24.6187026  7.918689    8.91658640  40.3933460
  [6,]   62.8440109  8.214951   46.66442659  79.3127845
  [7,]   10.7448193  9.212632   -7.21993493  29.1832954
  [8,] -100.9232724 10.717609 -121.67319575 -79.7927140
  [9,]   19.9005360 12.548667   -4.45922649  44.7856487
 [10,]   36.0558443 14.583496    7.56135150  64.5297298
 [11,]   11.3074473 13.490906  -14.84387587  37.5580208
 [12,]   -7.9605892 11.576366  -30.22935768  14.5874411
 [13,]  -12.0485257  9.925295  -31.34935687   7.3996375
 [14,]  -12.1192621  8.689205  -28.78171675   5.2613672
 [15,]  -10.9100986  8.061305  -26.14512377   5.2962856
 [16,]   -4.4643351  8.182821  -20.44847648  11.8439997
 [17,]   -8.5957715  9.023527  -26.40186180   9.1496877
 [18,]   -6.2988080 10.410623  -26.98683026  13.9888237
 [19,]   -1.5302445 12.158522  -24.65765151  21.9694255
 [20,]    9.6883191 14.133994  -17.76494428  36.7882343
 [21,]  -13.9431702 13.446124  -39.47013324  12.7148393
 [22,]  -23.5863250 11.501566  -45.52007168  -0.8833313
 [23,]   11.4800202  9.824790   -7.84745748  30.7154671
 [24,]    5.0801655  8.574364  -12.45217807  21.6261327
 [25,]   -3.3754893  7.953972  -19.78436299  11.6578613
 [26,]  -17.1464440  8.109522  -33.80258892  -1.6063989
 [27,]   -7.1049988  9.000875  -25.16188193   9.9247519
 [28,]    8.3038464 10.441259  -12.12341246  28.7741334
 [29,]    8.6437917 12.238331  -15.64754770  32.8143189
 [30,]   -9.7748631 14.257852  -38.09492172  18.4099185
 [31,]   47.0432860 13.315408   20.02172024  72.3004950
 [32,]   20.1456589 11.432896   -2.94957582  41.4877648
 [33,]   -2.1532682  9.822366  -21.31159919  16.4713367
 [34,]   -6.6319953  8.637328  -23.58667459  10.0802309
 [35,]  -11.7229225  8.067514  -27.72284765   3.9261089
 [36,]   -5.6899496  8.241535  -21.94872258  10.5811732
 [37,]  -28.7910767  9.116897  -47.02677937 -11.3676081
 [38,]    3.4753962 10.519957  -17.67643422  23.6053679
 [39,]  -15.1916309 12.271021  -39.98880030   8.3511112
 [40,]   27.7523419 14.242303   -0.93093791  54.8017951
 [41,]   14.0901478 12.921712  -11.84107448  38.7995594
 [42,]    4.0597315 11.033289  -17.81160926  25.2387777
 [43,]   13.4578152  9.433950   -5.31074994  31.9035164
 [44,]   24.3299988  8.292678    7.77860231  40.5334441
 [45,]   13.0694825  7.812858   -2.30391035  28.5231059
 [46,]  -17.3116339  8.112714  -32.90941537  -1.4128328
 [47,]  -27.9778502  9.115626  -45.11951860  -9.9497928
 [48,]    9.3423334 10.624326  -10.89216586  30.4242406
 [49,]  -39.1509829 12.456368  -62.86222752 -14.6626150
 [50,]   31.2607008 14.489618    3.73569901  59.1195398
 [51,]  -25.3448331 12.375574  -50.05791416  -1.3807680
 [52,]  -27.6080552 10.667166  -48.88347820  -6.7211990
 [53,]   -7.6729773  9.250967  -26.14000345  10.2801426
 [54,]   18.9201006  8.278328    2.63972145  34.8045369
 [55,]   16.3997785  7.914506    0.72009755  31.5774632
 [56,]   -1.2799436  8.240538  -17.54259657  14.4112527
 [57,]  132.6699343  9.183239  114.28269178 150.6920324
 [58,]   15.1247122 10.579020   -6.39758835  35.8498631
 [59,]  -11.6205099 12.274275  -36.20101735  12.1160874
 [60,]  -98.2708320 14.161862 -126.70375906 -70.9974511
 [61,]   16.1733494 12.440368   -9.25642857  40.1211404
 [62,]   11.5434479 10.779858  -10.09638938  32.2560800
 [63,]  -11.5847536  9.419522  -30.34344715   6.4711928
 [64,]    1.1131450  8.504642  -15.67277759  17.5244844
 [65,]  -11.8680565  8.185959  -27.72594558   4.3811325
 [66,]   18.7849420  8.530557    2.34153253  35.9199231
 [67,]    2.3024406  9.466274  -16.41467122  21.1214010
 [68,]    8.7733391 10.841114  -12.43262206  29.7363357
 [69,]  -17.0490624 12.511141  -42.07455019   7.1475058
 [70,]    1.2912362 14.373831  -27.30245743  29.0075901
 [71,]   20.8935591 12.413169   -3.41723819  45.4739630
 [72,]   20.1487638 10.670364   -0.72537854  41.5823017
 [73,]  -24.1606315  9.210277  -42.35201536  -5.5478536
 [74,]  -24.3259268  8.185621  -40.44978418  -8.0788127
 [75,]  -11.4467221  7.770601  -26.48378092   4.0009654
 [76,]  -17.7528174  8.059947  -34.19235043  -1.6330800
 [77,]   -7.8921127  8.985873  -26.40090808   9.7521339
 [78,]    6.6330920 10.379389  -14.21901213  27.3831024
 [79,]   -0.6158033 12.079743  -24.54615097  23.0260528
 [80,]   29.4634014 13.975382    1.63978708  56.4221843
 [81,]   -9.0512665 13.226034  -34.39507511  16.5964960
 [82,]   23.4922468 11.281399    1.63402990  45.3719969
 [83,]    4.2403602  9.632216  -14.64729101  23.0318634
 [84,]   20.7563735  8.453215    3.86613437  37.2780767
 [85,]    1.6107868  7.956238  -14.13420812  17.2953029
 [86,]    4.9997002  8.265242  -11.29715580  21.1531471
 [87,]   -3.9795865  9.300235  -22.29447510  14.0729524
 [88,]  -13.9162731 10.855512  -35.44013373   7.4330570
 [89,]  -13.2685598 12.741960  -39.03323079  11.6186311
 [90,]  -11.5714464 14.833764  -41.52025959  17.2273428
 [91,]   26.3632903 13.057362   -0.02451384  51.1135234
 [92,]    8.6721890 11.173323  -13.52678592  29.9001018
 [93,]  -32.6527122  9.564913  -51.43904586 -14.1512250
 [94,]    2.7279865  8.392133  -13.97648132  19.1372748
 [95,]    3.2078852  7.852654  -12.13582224  18.4704576
 [96,]   10.1836839  8.074427   -5.31213488  26.1251345
 [97,]    3.4749826  9.001362  -14.05893088  21.0990929
 [98,]   -3.2231186 10.447421  -23.85178633  17.4203281
 [99,]   16.8185801 12.229826   -7.78073665  40.8450431
[100,]    0.7406788 14.222679  -27.65619543  28.7378469
[101,]    9.1062323 13.035947  -15.32952051  34.4323656
[102,]   -8.1854190 11.192907  -29.47204575  13.7038175
[103,]  -11.0816702  9.616052  -29.51064322   7.6007166
[104,]   -6.5904215  8.455638  -23.13984620   9.9617014
[105,]  -22.3072728  7.897420  -37.28065859  -6.7123965
[106,]  -14.7483240  8.067387  -30.01185437   0.9669884
[107,]  -14.4630753  8.924028  -31.19651607   3.3363188
[108,]    0.5689735 10.297373  -18.91795355  21.4460731
[109,]   17.2424222 12.011476   -5.50538443  41.2225527
[110,]   21.1017710 13.941208   -5.62619545  48.3829124
[111,]   17.7549390 13.340283   -7.45545211  44.3309823
[112,]  -12.1062846 11.360464  -33.93946958  10.8222421
[113,]  -16.3747082  9.667645  -35.28182268   3.2999490
[114,]  -34.0709318  8.436398  -50.69863763 -17.0864505
[115,]  -37.7002554  7.885967  -53.21249802 -22.1753727
[116,]    6.0892210  8.155390   -9.74267691  21.7600614
[117,]   38.7902974  9.172706   20.78703919  56.4913756
[118,]    5.2454738 10.727204  -15.94175924  25.8322229
[119,]   19.7955502 12.621945   -5.18062739  43.9194864
[120,]   -2.6576734 14.726178  -32.03372393  25.8641969
[121,]   -5.4553070 12.325684  -30.95340661  17.9973047
[122,]   36.6201029 10.610348   15.06085031  57.1423020
[123,]   -0.9992872  9.185521  -19.55326955  17.1319455
[124,]    2.2402227  8.203987  -14.18586565  18.2387179
[125,]  -13.9771673  7.834175  -29.19645228   1.4234799
[126,]   11.3733426  8.159687   -4.28191376  27.3443715
[127,]  -12.9693475  9.106260  -30.01097894   4.9412399
[128,]  -41.5761375 10.507366  -61.71870517 -20.7323845
[129,]    5.9144724 12.207490  -17.52584025  30.0301394
[130,]   24.4824823 14.098872   -2.80926741  52.4690603
[131,]  -50.4283323 12.352294  -75.40147905 -27.0260228
[132,]   12.0699342 10.584124   -9.52543455  32.1703368
[133,]   26.7360007  9.103231    8.32416407  43.8296506
[134,]   32.6944671  8.069359   16.63392423  47.8628046
[135,]   20.5606336  7.665568    5.54202659  34.7209540
[136,]   10.6306001  7.987986   -4.87500014  25.8120278
[137,]   -1.7900334  8.958546  -19.47674160  15.1809871
[138,]   -9.8025669 10.397297  -30.21681549  10.0908365
[139,]   -8.6131004 12.138889  -32.77452409  14.6919111
[140,]   -9.7305339 14.071323  -37.31764954  17.3458193
[141,]   17.2796652 12.527786   -6.45813080  42.0190743
[142,]    2.4611047 10.790812  -17.96963807  24.0074032
[143,]  -20.0653559  9.342172  -38.22385526  -1.5369389
[144,]  -10.9831165  8.333613  -27.49272973   5.1923058
[145,]   14.8505230  7.934758   -1.65747786  30.3641525
[146,]    5.9098624  8.234685  -11.26364529  21.4774250
[147,]  -24.5002982  9.165045  -43.32585950  -6.9604441
[148,]   14.1553413 10.560512   -7.66378437  34.5948579
[149,]   -5.0195193 12.263325  -30.15941170  18.7309303
[150,]    9.8816201 14.163059  -19.24959927  37.5147728
[151,]   -1.2997149 13.311637  -26.28398344  25.3909655
[152,]   -7.2277536 11.363386  -28.81947027  15.9698716
[153,]  -18.0379923  9.690448  -36.46976892   1.8230460
[154,]  -31.6533311  8.457802  -48.22586203 -14.5316104
[155,]  -19.7765698  7.874988  -35.35075717  -4.0509426
[156,]   41.6922915  8.083802   26.09526268  57.4965710
[157,]  -36.5408472  9.029487  -53.93424474 -18.7005834
[158,]   14.7090141 10.515076   -5.73964161  35.4386184
[159,]   17.0989754 12.347201   -6.91200739  41.0706770
[160,]    8.9772366 14.394142  -18.85503869  37.1835662
[161,]   17.4575775 12.513375   -6.97335411  42.3321454
[162,]   10.5734919 10.820515  -10.94109164  32.2668282
[163,]    6.5831064  9.423136  -11.99960707  25.2459859
[164,]    1.0272208  8.468789  -15.60359609  17.6927553
[165,]  -11.0382647  8.115310  -26.75368546   4.8971707
[166,]  -15.1432503  8.438546  -31.75120938   1.3041073
[167,]  -49.8359358  9.368715  -68.45559075 -31.6705796
[168,]  -13.9176214 10.749397  -35.37960544   6.7546352
[169,]   22.7859930 12.431380   -2.26897288  46.9842111
[170,]   32.0280075 14.308803    3.64465460  60.3681030
[171,]    5.6250654 12.222620  -18.72020713  29.3039958
[172,]   -2.0756613 10.545025  -23.04243006  18.5346250
[173,]   10.2841119  9.162498   -7.84228736  28.2242168
[174,]   11.5558851  8.225198   -4.41994012  27.6099698
[175,]  -23.6661417  7.893356  -38.82600564  -8.1602460
[176,]    7.0058316  8.240446   -9.07992344  23.3207109
[177,]    0.1170048  9.189861  -17.87776864  18.1660242
[178,]   -2.9079220 10.580681  -23.52181118  17.3815716
[179,]   11.2508513 12.263636  -12.71459423  34.6013256
[180,]   -5.5302755 14.134760  -33.38784173  21.5269742</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.4  3.3
looic      1769.9 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1349      
 (0.5, 0.7]   (ok)         2    1.1%   203       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.4 22.4
p_loo        34.5  8.6
looic      1722.8 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   484       
 (0.5, 0.7]   (ok)         2    1.1%   802       
   (0.7, 1]   (bad)        4    2.2%   13        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.6      11.7  
fit_sleep1 -91.9      21.0  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 4 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.3 10.5
p_loo         3.2  0.5
looic      1906.5 21.0
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.0 14.3
p_loo        19.4  3.3
looic      1769.9 28.6
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1349      
 (0.5, 0.7]   (ok)         2    1.1%   203       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.4 22.4
p_loo        34.5  8.6
looic      1722.8 44.8
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     174   96.7%   484       
 (0.5, 0.7]   (ok)         2    1.1%   802       
   (0.7, 1]   (bad)        4    2.2%   13        
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.4     22.4        34.5    8.6   1722.8
fit_sleep2  -23.6      11.7  -885.0     14.3        19.4    3.3   1769.9
fit_sleep1  -91.9      21.0  -953.3     10.5         3.2    0.5   1906.5
           se_looic
fit_sleep3   44.8  
fit_sleep2   28.6  
fit_sleep1   21.0  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.237159e-40 5.789499e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0      2.9      1.57     0.27     5.47       0.04      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0     -0.1      1.57    -3.28     2.88       5.55      0.85
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.62.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.2          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.3         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.3.1      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.40           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
