<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TYR0QMREEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TYR0QMREEW');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="includes/custom.css" type="text/css" />
<link rel="stylesheet" href="font/css/roboto.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Analysis Guides for the Developmental Psychopathology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="dataManagement.html">Data Management</a>
    </li>
    <li>
      <a href="developmentalScaling.html">Developmental Scaling</a>
    </li>
    <li>
      <a href="eegERP.html">Electroencaphalography/Event-Related Potentials</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="factorAnalysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="figures.html">Figures</a>
    </li>
    <li>
      <a href="git.html">Git, GitLab, and GitHub</a>
    </li>
    <li>
      <a href="hlm.html">Hierarchical Linear Modeling</a>
    </li>
    <li>
      <a href="irt.html">Item Response Theory</a>
    </li>
    <li>
      <a href="lda.html">Longitudinal Data Analysis</a>
    </li>
    <li>
      <a href="markdown.html">Markdown</a>
    </li>
    <li>
      <a href="sem.html#mediation">Mediation</a>
    </li>
    <li>
      <a href="regression.html#moderation">Moderation/Interaction</a>
    </li>
    <li>
      <a href="multipleImputation.html">Multiple Imputation</a>
    </li>
    <li>
      <a href="pca.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="regression.html">Regression</a>
    </li>
    <li>
      <a href="SPSS.html">SPSS</a>
    </li>
    <li>
      <a href="sem.html">Structural Equation Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://devpsylab.github.io/LabWiki">Lab Wiki</a>
</li>
<li>
  <a href="https://developmental-psychopathology.lab.uiowa.edu">Lab Website</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Bayesian Analysis</h1>

</div>


<p>Adapted from <code>brms</code> workshop by Paul-Christian Bürkner</p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<div id="install-libraries" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Install
Libraries</h2>
<pre class="r fold-show"><code>#install.packages(&quot;remotes&quot;)
#remotes::install_git(&quot;https://research-git.uiowa.edu/PetersenLab/petersenlab.git&quot;)</code></pre>
</div>
<div id="load-libraries" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load Libraries</h2>
<pre class="r fold-show"><code>library(&quot;lme4&quot;)
library(&quot;rstan&quot;)
library(&quot;brms&quot;)</code></pre>
</div>
<div id="load-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Load Data</h2>
<pre class="r fold-show"><code>data(&quot;sleepstudy&quot;, package = &quot;lme4&quot;)</code></pre>
</div>
<div id="prepare-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prepare Data</h2>
<pre class="r fold-show"><code>conditions &lt;- make_conditions(sleepstudy, &quot;Subject&quot;)</code></pre>
</div>
</div>
<div id="brms" class="section level1" number="2">
<h1><span class="header-section-number">2</span> brms</h1>
<div id="post-processing-methods" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Post-Processing
Methods</h2>
<pre class="r fold-hide"><code>methods(class = &quot;brmsfit&quot;)</code></pre>
<pre><code> [1] add_criterion           add_ic                  as_draws_array         
 [4] as_draws_df             as_draws_list           as_draws_matrix        
 [7] as_draws_rvars          as_draws                as.array               
[10] as.data.frame           as.matrix               as.mcmc                
[13] autocor                 bayes_factor            bayes_R2               
[16] bridge_sampler          coef                    conditional_effects    
[19] conditional_smooths     control_params          expose_functions       
[22] family                  fitted                  fixef                  
[25] formula                 getCall                 hypothesis             
[28] kfold                   launch_shinystan        log_lik                
[31] log_posterior           logLik                  loo_compare            
[34] loo_linpred             loo_model_weights       loo_moment_match       
[37] loo_predict             loo_predictive_interval loo_R2                 
[40] loo_subsample           loo                     LOO                    
[43] marginal_effects        marginal_smooths        mcmc_plot              
[46] model_weights           model.frame             nchains                
[49] ndraws                  neff_ratio              ngrps                  
[52] niterations             nobs                    nsamples               
[55] nuts_params             nvariables              pairs                  
[58] parnames                plot                    post_prob              
[61] posterior_average       posterior_epred         posterior_interval     
[64] posterior_linpred       posterior_predict       posterior_samples      
[67] posterior_smooths       posterior_summary       pp_average             
[70] pp_check                pp_mixture              predict                
[73] predictive_error        predictive_interval     prepare_predictions    
[76] print                   prior_draws             prior_summary          
[79] ranef                   reloo                   residuals              
[82] rhat                    stancode                standata               
[85] stanplot                summary                 update                 
[88] VarCorr                 variables               vcov                   
[91] waic                    WAIC                   
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
</div>
<div id="multilevel-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Multilevel Models</h1>
<div id="fit-the-models" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fit the Models</h2>
<div id="complete-pooling" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Complete
Pooling</h3>
<pre class="r fold-show"><code>fit_sleep1 &lt;- brm(Reaction ~ 1 + Days, data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Random
Intercepts</h3>
<pre class="r fold-show"><code>fit_sleep2 &lt;- brm(Reaction ~ 1 + Days + (1 | Subject), 
                  data = sleepstudy)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="random-intercepts-and-slopes" class="section level3"
number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Random Intercepts
and Slopes</h3>
<pre class="r fold-show"><code>fit_sleep3 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="summarize-results" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarize
Results</h2>
<p>For convergence, <code>Rhat</code> values should not be above
1.00.</p>
<pre class="r fold-show"><code>summary(fit_sleep3)</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Reaction ~ 1 + Days + (1 + Days | Subject) 
   Data: sleepstudy (Number of observations: 180) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~Subject (Number of levels: 18) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          27.00      7.07    15.48    43.12 1.00     1645     2594
sd(Days)                6.42      1.47     4.10     9.80 1.00     1758     2478
cor(Intercept,Days)     0.10      0.31    -0.48     0.69 1.00      824     1269

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   251.15      7.48   236.14   266.14 1.00     2331     2776
Days         10.42      1.70     7.10    13.89 1.00     1809     2117

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.90      1.53    23.14    29.16 1.00     3078     3037

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="model-priors" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model Priors</h2>
<pre class="r fold-show"><code>prior_summary(fit_sleep3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj_corr_cholesky(1)","2":"L","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"L","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="model-coefficients" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Model
Coefficients</h2>
<pre class="r fold-show"><code>coef(fit_sleep3)</code></pre>
<pre><code>$Subject
, , Intercept

    Estimate Est.Error     Q2.5    Q97.5
308 254.2518  13.00009 228.3844 278.8114
309 211.0207  13.25277 185.9879 237.1695
310 212.8129  13.21624 186.5436 238.4310
330 274.1949  13.62628 248.4666 301.1092
331 273.2439  13.10913 248.4543 299.5777
332 259.9079  12.40321 235.1562 284.2957
333 268.1811  12.65824 243.8958 293.8680
334 244.1246  12.39164 219.4443 268.2038
335 249.9889  13.65176 223.1175 277.2885
337 286.1425  13.25137 260.7463 312.3560
349 226.6881  12.83814 200.5583 250.9138
350 239.0987  13.25634 212.5719 264.3423
351 255.5743  12.26732 231.8560 280.8904
352 272.2293  12.41072 248.0474 297.2563
369 254.5442  12.00910 230.6245 278.1316
370 226.5050  13.25134 199.7472 251.0237
371 252.3401  12.21969 228.2828 276.4984
372 263.5187  12.42146 238.6245 287.6748

, , Days

      Estimate Est.Error       Q2.5     Q97.5
308 19.5621304  2.513005 14.8172193 24.573699
309  1.8285450  2.506814 -3.1555051  6.705518
310  4.9258465  2.440353  0.1834111  9.897286
330  5.7949311  2.562586  0.6833698 10.758730
331  7.4864716  2.483114  2.5437801 12.235901
332 10.2243657  2.372252  5.4689421 14.868225
333 10.2260620  2.408204  5.5032256 15.028379
334 11.5157856  2.367297  6.8437173 16.335025
335 -0.1446301  2.586513 -5.2003192  4.836988
337 19.1090662  2.467112 14.3070719 23.836634
349 11.5789847  2.376938  7.1230286 16.383550
350 16.9206862  2.546923 12.1982589 21.879767
351  7.5160742  2.356779  2.7504237 12.025634
352 14.0356418  2.377041  9.3148018 18.773545
369 11.3163392  2.341288  6.5179434 15.828015
370 15.1248745  2.502572 10.3113923 20.213759
371  9.5163374  2.311293  4.8881705 14.121338
372 11.7855228  2.379933  7.0180335 16.531968</code></pre>
</div>
<div id="plots" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Plots</h2>
<div id="trace-plots" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Trace Plots</h3>
<pre class="r fold-show"><code>plot(fit_sleep3, ask = FALSE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bayesian_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Visualize
Predictions</h3>
<div id="sample-level" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Sample-Level</h4>
<pre class="r fold-show"><code>plot(conditional_effects(fit_sleep1), points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="person-level" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Person-Level</h4>
<pre class="r fold-show"><code># re_formula = NULL ensures that group-level effects are included
ce2 &lt;- conditional_effects(fit_sleep3, conditions = conditions, 
                        re_formula = NULL)
plot(ce2, ncol = 6, points = TRUE)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="check-model-fit" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Check Model
Fit</h3>
<div id="posterior-predictive-check" class="section level4"
number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Posterior
Predictive Check</h4>
<p>Evaluate how closely the posterior predictions match the observed
values. If they do not match the general pattern of the observed values,
a different response distribution may be necessary.</p>
<pre class="r fold-show"><code>pp_check(fit_sleep3)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, type = &quot;dens_overlay&quot;)</code></pre>
<pre><code>Using 10 posterior draws for ppc type &#39;dens_overlay&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r fold-show"><code>pp_check(fit_sleep3, &quot;error_scatter_avg&quot;)</code></pre>
<pre><code>Using all posterior draws for ppc type &#39;error_scatter_avg&#39; by default.</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Fitted Values</h2>
<pre class="r fold-show"><code>fitted(fit_sleep3)</code></pre>
<pre><code>       Estimate Est.Error     Q2.5    Q97.5
  [1,] 254.2518 13.000090 228.3844 278.8114
  [2,] 273.8139 11.099019 251.5900 294.8755
  [3,] 293.3760  9.487070 274.3697 311.6077
  [4,] 312.9382  8.333737 296.4675 329.0531
  [5,] 332.5003  7.843994 317.0351 347.9233
  [6,] 352.0624  8.138532 336.3647 367.9458
  [7,] 371.6245  9.141858 353.7238 389.5619
  [8,] 391.1867 10.655600 370.1870 412.0542
  [9,] 410.7488 12.495617 386.1589 435.4323
 [10,] 430.3109 14.538552 401.2622 458.8732
 [11,] 211.0207 13.252768 185.9879 237.1695
 [12,] 212.8493 11.369656 191.5556 234.6663
 [13,] 214.6778  9.770903 195.9176 233.3327
 [14,] 216.5063  8.616277 199.3714 232.9105
 [15,] 218.3349  8.098034 202.2730 234.0554
 [16,] 220.1634  8.335725 203.9316 236.6036
 [17,] 221.9920  9.271391 203.6812 240.2405
 [18,] 223.8205 10.723867 202.8151 244.9589
 [19,] 225.6491 12.514478 200.9743 250.4456
 [20,] 227.4776 14.518652 199.0733 256.2746
 [21,] 212.8129 13.216240 186.5436 238.4310
 [22,] 217.7387 11.379408 194.9764 239.9115
 [23,] 222.6646  9.809357 203.2397 241.5817
 [24,] 227.5904  8.652555 210.4978 244.3200
 [25,] 232.5163  8.088297 216.9470 248.3729
 [26,] 237.4421  8.239238 221.7422 253.2700
 [27,] 242.3680  9.069739 224.3659 260.2241
 [28,] 247.2938 10.418539 226.5566 267.7993
 [29,] 252.2197 12.113726 227.9079 275.8885
 [30,] 257.1455 14.030304 229.2922 284.7484
 [31,] 274.1949 13.626278 248.4666 301.1092
 [32,] 279.9899 11.625637 257.9857 303.0013
 [33,] 285.7848  9.887827 266.7438 304.9965
 [34,] 291.5797  8.574177 275.0844 308.0269
 [35,] 297.3746  7.899215 281.8249 312.7676
 [36,] 303.1696  8.025732 287.3954 318.6417
 [37,] 308.9645  8.919689 291.4833 326.5336
 [38,] 314.7594 10.384750 294.4263 335.6782
 [39,] 320.5544 12.217156 296.5573 345.4087
 [40,] 326.3493 14.276151 297.9663 355.3667
 [41,] 273.2439 13.109126 248.4543 299.5777
 [42,] 280.7304 11.234475 259.1781 303.4506
 [43,] 288.2168  9.638953 269.1312 307.5485
 [44,] 295.7033  8.481575 279.0633 312.4421
 [45,] 303.1898  7.955911 287.6138 319.0097
 [46,] 310.6763  8.184598 294.6852 326.7033
 [47,] 318.1627  9.111008 300.1353 336.1031
 [48,] 325.6492 10.552963 304.9868 346.0126
 [49,] 333.1357 12.330908 309.2577 356.7746
 [50,] 340.6221 14.320240 313.1781 368.4067
 [51,] 259.9079 12.403211 235.1562 284.2957
 [52,] 270.1322 10.656043 248.9791 290.8130
 [53,] 280.3566  9.193367 262.6661 298.3473
 [54,] 290.5810  8.169451 274.8699 306.6827
 [55,] 300.8053  7.759963 285.9778 316.4079
 [56,] 311.0297  8.059111 295.4328 327.2532
 [57,] 321.2541  8.996482 304.0952 339.3114
 [58,] 331.4784 10.400926 311.3036 351.8196
 [59,] 341.7028 12.111028 317.6898 364.8944
 [60,] 351.9272 14.015345 323.9381 378.3606
 [61,] 268.1811 12.658238 243.8958 293.8680
 [62,] 278.4072 10.864471 257.8750 300.2081
 [63,] 288.6332  9.351007 270.7219 307.1840
 [64,] 298.8593  8.273140 282.9886 315.1805
 [65,] 309.0854  7.813274 293.7397 324.2480
 [66,] 319.3114  8.077657 303.5655 335.3621
 [67,] 329.5375  9.002707 312.0468 347.0869
 [68,] 339.7635 10.413828 319.3758 360.5082
 [69,] 349.9896 12.142726 326.5988 374.2244
 [70,] 360.2157 14.072763 332.8789 387.7741
 [71,] 244.1246 12.391641 219.4443 268.2038
 [72,] 255.6404 10.621904 234.4506 276.3171
 [73,] 267.1562  9.127165 248.5668 285.0908
 [74,] 278.6720  8.061861 262.2567 294.4454
 [75,] 290.1878  7.608566 275.0699 304.9466
 [76,] 301.7036  7.873699 286.3389 317.2602
 [77,] 313.2193  8.792507 296.3518 330.4024
 [78,] 324.7351 10.189672 305.3983 344.7654
 [79,] 336.2509 11.897851 313.6726 359.4461
 [80,] 347.7667 13.802047 321.9543 374.5961
 [81,] 249.9889 13.651761 223.1175 277.2885
 [82,] 249.8443 11.640163 227.0839 273.1484
 [83,] 249.6996  9.899307 230.1967 269.4085
 [84,] 249.5550  8.595304 232.6116 266.3987
 [85,] 249.4104  7.946215 233.5316 265.0500
 [86,] 249.2657  8.110827 233.2955 265.3194
 [87,] 249.1211  9.044821 231.6433 267.6227
 [88,] 248.9765 10.545717 228.8998 270.4930
 [89,] 248.8319 12.409497 225.3195 273.8990
 [90,] 248.6872 14.496867 220.8939 278.0311
 [91,] 286.1425 13.251366 260.7463 312.3560
 [92,] 305.2516 11.371932 283.3778 327.8878
 [93,] 324.3606  9.757882 305.6877 343.6155
 [94,] 343.4697  8.560663 327.1358 360.3282
 [95,] 362.5788  7.970379 346.6886 378.0996
 [96,] 381.6878  8.120481 365.5314 397.6371
 [97,] 400.7969  8.973894 383.3052 418.8444
 [98,] 419.9060 10.358215 399.9050 440.5067
 [99,] 439.0150 12.092467 415.8004 462.9794
[100,] 458.1241 14.047639 430.9993 485.6191
[101,] 226.6881 12.838145 200.5583 250.9138
[102,] 238.2671 11.059773 216.2416 259.3864
[103,] 249.8460  9.545621 231.0970 268.2911
[104,] 261.4250  8.439125 244.9502 277.7030
[105,] 273.0040  7.913183 258.0135 288.4412
[106,] 284.5830  8.081940 268.6389 300.5134
[107,] 296.1620  8.905994 278.7105 313.3708
[108,] 307.7410 10.228165 287.4499 327.3687
[109,] 319.3199 11.883335 295.4746 341.9168
[110,] 330.8989 13.751786 303.2281 357.0918
[111,] 239.0987 13.256338 212.5719 264.3423
[112,] 256.0194 11.300103 233.2756 277.7461
[113,] 272.9401  9.624333 253.7961 291.5294
[114,] 289.8608  8.398625 273.4108 306.4271
[115,] 306.7815  7.837069 291.6997 322.5199
[116,] 323.7022  8.079358 307.9710 340.0544
[117,] 340.6228  9.061239 322.5973 358.7225
[118,] 357.5435 10.578739 336.8473 378.3731
[119,] 374.4642 12.437323 350.4816 398.4876
[120,] 391.3849 14.506479 363.5381 419.4924
[121,] 255.5743 12.267319 231.8560 280.8904
[122,] 263.0904 10.557929 242.6932 284.6290
[123,] 270.6065  9.141195 253.0226 289.2500
[124,] 278.1226  8.170791 262.5446 294.6597
[125,] 285.6386  7.814796 270.5856 300.9583
[126,] 293.1547  8.154083 277.1179 308.8872
[127,] 300.6708  9.111307 282.6406 318.3071
[128,] 308.1869 10.519105 287.0476 328.1440
[129,] 315.7029 12.222768 291.4295 338.8451
[130,] 323.2190 14.115571 294.9433 350.5922
[131,] 272.2293 12.410719 248.0474 297.2563
[132,] 286.2650 10.651873 265.4614 307.8668
[133,] 300.3006  9.176028 282.7649 318.7014
[134,] 314.3363  8.138627 299.0704 330.8138
[135,] 328.3719  7.718526 313.3783 343.9004
[136,] 342.4075  8.013407 326.9094 358.3432
[137,] 356.4432  8.952899 339.0024 373.9613
[138,] 370.4788 10.363144 350.4195 390.1993
[139,] 384.5145 12.080387 361.4410 407.3890
[140,] 398.5501 13.992047 371.6309 425.3684
[141,] 254.5442 12.009103 230.6245 278.1316
[142,] 265.8605 10.352797 245.4433 286.1119
[143,] 277.1769  9.005860 259.3206 295.0087
[144,] 288.4932  8.123661 272.0510 304.0867
[145,] 299.8096  7.864190 283.7575 314.7475
[146,] 311.1259  8.286155 294.3276 327.0334
[147,] 322.4422  9.297230 303.5574 340.2092
[148,] 333.7586 10.732189 311.8319 354.2461
[149,] 345.0749 12.445262 319.8279 369.0492
[150,] 356.3913 14.337100 327.3457 383.8619
[151,] 226.5050 13.251338 199.7472 251.0237
[152,] 241.6299 11.327792 218.1790 263.0631
[153,] 256.7548  9.672926 237.2104 275.5223
[154,] 271.8797  8.446175 254.7485 288.2068
[155,] 287.0045  7.850858 271.4041 302.0833
[156,] 302.1294  8.028686 286.5134 317.8035
[157,] 317.2543  8.933608 299.8404 334.6926
[158,] 332.3792 10.377120 311.9277 352.6578
[159,] 347.5040 12.169044 323.7639 371.3854
[160,] 362.6289 14.177883 335.1385 390.3053
[161,] 252.3401 12.219692 228.2828 276.4984
[162,] 261.8565 10.584158 240.9115 282.8279
[163,] 271.3728  9.241865 253.0088 289.0922
[164,] 280.8891  8.335700 264.4400 296.8768
[165,] 290.4055  8.014978 274.6431 305.7021
[166,] 299.9218  8.347455 283.4838 316.2313
[167,] 309.4381  9.263060 291.4962 327.7023
[168,] 318.9545 10.611913 298.8424 339.9118
[169,] 328.4708 12.251746 305.2265 352.6444
[170,] 337.9872 14.081265 311.4911 366.3371
[171,] 263.5187 12.421460 238.6245 287.6748
[172,] 275.3042 10.671004 254.0561 296.4876
[173,] 287.0897  9.207395 269.3841 305.0685
[174,] 298.8753  8.185969 282.9606 315.1938
[175,] 310.6608  7.782816 295.5106 326.1301
[176,] 322.4463  8.090891 306.2371 338.2236
[177,] 334.2318  9.037753 315.8376 351.9001
[178,] 346.0174 10.451201 325.3898 365.8535
[179,] 357.8029 12.169732 333.6266 381.1414
[180,] 369.5884 14.082093 341.6804 396.9261</code></pre>
</div>
<div id="residuals" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Residuals</h2>
<pre class="r fold-show"><code>residuals(fit_sleep3)</code></pre>
<pre><code>           Estimate Est.Error          Q2.5       Q97.5
  [1,]   -4.6917655 13.000090  -29.25139269  21.1756466
  [2,]  -15.1091960 11.099019  -36.17079615   7.1146828
  [3,]  -42.5754264  9.487070  -60.80710904 -23.5690950
  [4,]    8.5016432  8.333737   -7.61334596  24.9722987
  [5,]   24.3516127  7.843994    8.92858941  39.8167762
  [6,]   62.6276823  8.138532   46.74431779  78.3253927
  [7,]   10.5792518  9.141858   -7.35808896  28.4800059
  [8,] -101.0380786 10.655600 -121.90562445 -80.0384141
  [9,]   19.8364910 12.495617   -4.84699164  44.4264325
 [10,]   36.0425605 14.538552    7.48025524  65.0912712
 [11,]   11.7131879 13.252768  -14.43561012  36.7460040
 [12,]   -7.5834571 11.369656  -29.40047517  13.7102075
 [13,]  -11.7000021  9.770903  -30.35487043   7.0602063
 [14,]  -11.7993472  8.616277  -28.20354624   5.3356339
 [15,]  -10.6187922  8.098034  -26.33925966   5.4431493
 [16,]   -4.2016372  8.335725  -20.64181578  12.0302233
 [17,]   -8.3616823  9.271391  -26.61022157   9.9490589
 [18,]   -6.0933273 10.723867  -27.23171425  14.9121259
 [19,]   -1.3533723 12.514478  -26.14989290  23.3213865
 [20,]    9.8365826 14.518652  -18.96037576  38.2408779
 [21,]  -13.7590032 13.216240  -39.37714447  12.5102931
 [22,]  -23.4065497 11.379408  -45.57928435  -0.6441618
 [23,]   11.6554038  9.809357   -7.26169244  31.0802944
 [24,]    5.2511573  8.652555  -11.47841203  22.3437759
 [25,]   -3.2088892  8.088297  -19.06552626  12.3603865
 [26,]  -16.9842357  8.239238  -32.81211609  -1.2843082
 [27,]   -6.9471821  9.069739  -24.80333427  11.0548640
 [28,]    8.4572714 10.418539  -12.04818636  29.1945308
 [29,]    8.7928249 12.113726  -14.87600050  33.1045925
 [30,]   -9.6302216 14.030304  -37.23313515  18.2231320
 [31,]   47.3476810 13.626278   20.43344259  73.0759844
 [32,]   20.4103500 11.625637   -2.60105879  42.4144721
 [33,]   -1.9282811  9.887827  -21.13995055  17.1127359
 [34,]   -6.4467122  8.574177  -22.89392977  10.0485549
 [35,]  -11.5773432  7.899215  -26.97033870   3.9723763
 [36,]   -5.5840743  8.025732  -21.05620820  10.1900593
 [37,]  -28.7249053  8.919689  -46.29404239 -11.2436790
 [38,]    3.5018636 10.384750  -17.41688855  23.8349513
 [39,]  -15.2048674 12.217156  -40.05920167   8.7921895
 [40,]   27.6994015 14.276151   -1.31797745  56.0823961
 [41,]   14.3640068 13.109126  -11.96977043  39.1536095
 [42,]    4.2696351 11.234475  -18.45062356  25.8219068
 [43,]   13.6037635  9.638953   -5.72785648  32.6893800
 [44,]   24.4119919  8.481575    7.67323280  41.0519998
 [45,]   13.0875202  7.955911   -2.73238182  28.6635000
 [46,]  -17.3575514  8.184598  -33.38461621  -1.3665017
 [47,]  -28.0877231  9.111008  -46.02812462 -10.0602677
 [48,]    9.1685053 10.552963  -11.19489937  29.8309439
 [49,]  -39.3887664 12.330908  -63.02771802 -15.5107677
 [50,]   30.9589620 14.320240    3.17444144  58.4029842
 [51,]  -25.0472779 12.403211  -49.43509153  -0.2956419
 [52,]  -27.3204436 10.656043  -48.00120068  -6.1673413
 [53,]   -7.3953093  9.193367  -25.38603496  10.2951689
 [54,]   19.1878250  8.169451    3.08605692  34.8988636
 [55,]   16.6575593  7.759963    1.05501763  31.4851374
 [56,]   -1.0321064  8.059111  -17.25556365  14.5647595
 [57,]  132.9078279  8.996482  114.85046703 150.0667083
 [58,]   15.3526622 10.400926   -4.98846697  35.5274588
 [59,]  -11.4025035 12.111028  -34.59405449  12.6104999
 [60,]  -98.0627692 14.015345 -124.49622235 -70.0736940
 [61,]   15.6612895 12.658238  -10.02564520  39.9466004
 [62,]   11.1478274 10.864471  -10.65306413  31.6799818
 [63,]  -11.8639346  9.351007  -30.41469993   6.0473828
 [64,]    0.9504033  8.273140  -15.37081665  16.8210885
 [65,]  -11.9143587  7.813274  -27.07700372   3.4312881
 [66,]   18.8550793  8.077657    2.80439706  34.6010467
 [67,]    2.4890172  9.002707  -15.06043717  19.9796898
 [68,]    9.0763552 10.413828  -11.66825833  29.4641151
 [69,]  -16.6296069 12.142726  -40.86440680   6.7611707
 [70,]    1.8271311 14.072763  -25.73131448  29.1639327
 [71,]   21.3484692 12.391641   -2.73070599  46.0288269
 [72,]   20.5607836 10.621904   -0.11588550  41.7505754
 [73,]  -23.7915020  9.127165  -41.72608214  -5.2020955
 [74,]  -23.9996875  8.061861  -39.77305787  -7.5843769
 [75,]  -11.1633731  7.608566  -25.92222381   3.9544580
 [76,]  -17.5123586  7.873699  -33.06900443  -2.1477392
 [77,]   -7.6945442  8.792507  -24.87762657   9.1730326
 [78,]    6.7877703 10.189672  -13.24246943  26.1245559
 [79,]   -0.5040153 11.897851  -23.69915508  22.0742667
 [80,]   29.5322991 13.802047    2.70293701  55.3446679
 [81,]   -8.3805932 13.651761  -35.68015728  18.4907619
 [82,]   24.1029370 11.640163    0.79877545  46.8632892
 [83,]    4.7910671  9.899307  -14.91779290  24.2939886
 [84,]   21.2470973  8.595304    4.40336021  38.1905081
 [85,]    2.0415274  7.946215  -13.59809763  17.9202819
 [86,]    5.3704576  8.110827  -10.68321801  21.3406898
 [87,]   -3.6688123  9.044821  -22.17036993  13.8090093
 [88,]  -13.6654822 10.545717  -35.18196202   6.4111672
 [89,]  -13.0777520 12.409497  -38.14491657  10.4345555
 [90,]  -11.4406219 14.496867  -40.78453967  16.3527154
 [91,]   26.2241017 13.251366    0.01060568  51.6203264
 [92,]    8.5542355 11.371932  -14.08197803  30.4279642
 [93,]  -32.7494307  9.757882  -52.00425752 -14.0764856
 [94,]    2.6525031  8.560663  -14.20596001  18.9864005
 [95,]    3.1536369  7.970379  -12.36718404  19.0438200
 [96,]   10.1506707  8.120481   -5.79861270  26.3071416
 [97,]    3.4632045  8.973894  -14.58433190  20.9548677
 [98,]   -3.2136617 10.358215  -23.81440193  16.7873209
 [99,]   16.8492721 12.092467   -7.11506653  40.0638702
[100,]    0.7926058 14.047639  -26.70235621  27.9174159
[101,]    9.4151315 12.838145  -14.81060616  35.5449335
[102,]   -7.9503531 11.059773  -29.06970315  14.0751036
[103,]  -10.9204378  9.545621  -29.36550009   7.8286157
[104,]   -6.5030225  8.439125  -22.78101785   9.9718113
[105,]  -22.2937072  7.913183  -37.73087939  -7.3031533
[106,]  -14.8085919  8.081940  -30.73904076   1.1355447
[107,]  -14.5971766  8.905994  -31.80604606   2.8542889
[108,]    0.3610387 10.228165  -19.26673281  20.6520964
[109,]   16.9606540 11.883335   -5.63616116  40.8059752
[110,]   20.7461693 13.751786   -5.44665125  48.4170415
[111,]   17.1980768 13.256338   -8.04552919  43.7248612
[112,]  -12.5651094 11.300103  -34.29179736  10.1787185
[113,]  -16.7354956  9.624333  -35.32477511   2.4085032
[114,]  -34.3336818  8.398625  -50.89996910 -17.8837034
[115,]  -37.8649680  7.837069  -53.60343195 -22.7831959
[116,]    6.0225457  8.079358  -10.32972951  21.7536630
[117,]   38.8216595  9.061239   20.72197860  56.8472272
[118,]    5.3748733 10.578739  -15.45474619  26.0711207
[119,]   20.0229871 12.437323   -4.00040652  44.0056135
[120,]   -2.3321991 14.506479  -30.43970817  25.5145541
[121,]   -5.0478307 12.267319  -30.36390576  18.6704684
[122,]   36.9671951 10.557929   15.42861664  57.3644108
[123,]   -0.7125791  9.141195  -19.35614208  16.8712652
[124,]    2.4665467  8.170791  -14.07057988  18.0444507
[125,]  -13.8112275  7.814796  -29.13092677   1.2417824
[126,]   11.4788983  8.154083   -4.25364246  27.5156960
[127,]  -12.9241759  9.111307  -30.56045607   5.1060159
[128,]  -41.5913501 10.519105  -61.54850690 -20.4520985
[129,]    5.8388757 12.222768  -17.30330506  30.1123017
[130,]   24.3465014 14.115571   -3.02667217  52.6221824
[131,]  -50.5522378 12.410719  -75.57922587 -26.3702635
[132,]   11.9289203 10.651873   -9.67293494  32.7325465
[133,]   26.5778785  9.176028    8.17711518  44.1136377
[134,]   32.5192367  8.138627   16.04171585  47.7851233
[135,]   20.3682949  7.718526    4.83979941  35.3618709
[136,]   10.4211531  8.013407   -5.51447958  25.9193351
[137,]   -2.0165887  8.952899  -19.53470316  15.4242147
[138,]  -10.0462305 10.363144  -29.76668329  10.0130565
[139,]   -8.8738724 12.080387  -31.74844587  14.1996017
[140,]  -10.0084142 13.992047  -36.82665715  16.9108270
[141,]   17.3792900 12.009103   -6.20810247  41.2989897
[142,]    2.5763508 10.352797  -17.67496281  22.9935520
[143,]  -19.9344884  9.005860  -37.76628872  -2.0782350
[144,]  -10.8366276  8.123661  -26.43008647   5.6056021
[145,]   15.0126333  7.864190    0.07474738  31.0646524
[146,]    6.0875941  8.286155   -9.81987859  22.8858751
[147,]  -24.3069451  9.297230  -42.07388070  -5.4221125
[148,]   14.3643157 10.732189   -6.12317598  36.2909740
[149,]   -4.7949235 12.445262  -28.76916076  20.4520889
[150,]   10.1218374 14.337100  -17.34884556  39.1673541
[151,]   -1.2410376 13.251338  -25.75972237  25.5168447
[152,]   -7.1064121 11.327792  -28.53956558  16.3444756
[153,]  -17.8539865  9.672926  -36.62148063   1.6904387
[154,]  -31.4066610  8.446175  -47.73378777 -14.2755043
[155,]  -19.4672355  7.850858  -34.54596584  -3.8668107
[156,]   42.0642901  8.028686   26.39017887  57.6803067
[157,]  -36.1061844  8.933608  -53.54449844 -18.6923113
[158,]   15.2063411 10.377120   -5.07229860  35.6578258
[159,]   17.6589667 12.169044   -6.22239743  41.3991335
[160,]    9.5998922 14.177883  -18.07653342  37.0903213
[161,]   17.5402803 12.219692   -6.61802024  41.5976082
[162,]   10.5863429 10.584158  -10.38514569  31.5312501
[163,]    6.5261054  9.241865  -11.19327135  24.8900683
[164,]    0.9003680  8.335700  -15.08725822  17.3494785
[165,]  -11.2349694  8.014978  -26.53163850   4.5274138
[166,]  -15.4098068  8.347455  -31.71933468   1.0282470
[167,]  -50.1723442  9.263060  -68.43653781 -32.2304063
[168,]  -14.3238817 10.611913  -35.28115772   5.7881645
[169,]   22.3098809 12.251746   -1.86373402  45.5541861
[170,]   31.4820435 14.081265    3.13213733  57.9780814
[171,]    5.8929989 12.421460  -18.26308372  30.7871521
[172,]   -1.8302238 10.671004  -23.01363436  19.4178864
[173,]   10.5070534  9.207395   -7.47169965  28.2126919
[174,]   11.7563306  8.185969   -4.56221282  27.6709508
[175,]  -23.4881921  7.782816  -38.95752120  -8.3379843
[176,]    7.1612851  8.090891   -8.61595360  23.3704817
[177,]    0.2499624  9.037753  -17.41834507  18.6442188
[178,]   -2.7974604 10.451201  -22.63360705  17.8300593
[179,]   11.3388168 12.169732  -11.99968071  35.5150896
[180,]   -5.4648059 14.082093  -32.80253031  22.4432245</code></pre>
</div>
<div id="compare-models" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Compare Models</h2>
<p><code>elpd</code> values: higher is better <code>looic</code> values:
lower is better</p>
<p><code>elpd_diff</code> values that are greater than ~2 standard
errors of the <code>elpd_diff</code> values indicate a significantly
better model (i.e., if <code>elpd_diff</code> value is greater than 2
times the <code>se_diff</code> value).</p>
<pre class="r fold-show"><code>loo(fit_sleep1, fit_sleep2, fit_sleep3)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.4
p_loo        19.7  3.5
looic      1770.6 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1366      
 (0.5, 0.7]   (ok)         2    1.1%   147       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.5 22.6
p_loo        34.5  8.7
looic      1722.9 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   996       
 (0.5, 0.7]   (ok)         7    3.9%   267       
   (0.7, 1]   (bad)        1    0.6%   18        
   (1, Inf)   (very bad)   2    1.1%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff
fit_sleep3   0.0       0.0  
fit_sleep2 -23.8      11.8  
fit_sleep1 -91.9      21.2  </code></pre>
<pre class="r fold-show"><code>print(loo(fit_sleep1, fit_sleep2, fit_sleep3), simplify = FALSE)</code></pre>
<pre><code>Warning: Found 3 observations with a pareto_k &gt; 0.7 in model &#39;fit_sleep3&#39;. It is
recommended to set &#39;moment_match = TRUE&#39; in order to perform moment matching for
problematic observations.</code></pre>
<pre><code>Output of model &#39;fit_sleep1&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -953.4 10.5
p_loo         3.3  0.5
looic      1906.8 20.9
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep2&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -885.3 14.4
p_loo        19.7  3.5
looic      1770.6 28.9
------
Monte Carlo SE of elpd_loo is 0.1.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     178   98.9%   1366      
 (0.5, 0.7]   (ok)         2    1.1%   147       
   (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
   (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      

All Pareto k estimates are ok (k &lt; 0.7).
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;fit_sleep3&#39;:

Computed from 4000 by 180 log-likelihood matrix

         Estimate   SE
elpd_loo   -861.5 22.6
p_loo        34.5  8.7
looic      1722.9 45.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     170   94.4%   996       
 (0.5, 0.7]   (ok)         7    3.9%   267       
   (0.7, 1]   (bad)        1    0.6%   18        
   (1, Inf)   (very bad)   2    1.1%   5         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
           elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic 
fit_sleep3    0.0       0.0  -861.5     22.6        34.5    8.7   1722.9
fit_sleep2  -23.8      11.8  -885.3     14.4        19.7    3.5   1770.6
fit_sleep1  -91.9      21.2  -953.4     10.5         3.3    0.5   1906.8
           se_looic
fit_sleep3   45.2  
fit_sleep2   28.9  
fit_sleep1   20.9  </code></pre>
<div id="compute-model-weights" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Compute Model
Weights</h3>
<pre class="r fold-show"><code>model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;)</code></pre>
<pre><code>  fit_sleep1   fit_sleep2   fit_sleep3 
1.196237e-40 4.481579e-11 1.000000e+00 </code></pre>
<pre class="r fold-show"><code>round(model_weights(fit_sleep1, fit_sleep2, fit_sleep3, weights = &quot;loo&quot;))</code></pre>
<pre><code>fit_sleep1 fit_sleep2 fit_sleep3 
         0          0          1 </code></pre>
</div>
</div>
</div>
<div id="setting-priors" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Setting Priors</h1>
<div id="parameters-for-which-to-set-priors" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Parameters for Which
to Set Priors</h2>
<pre class="r fold-show"><code>get_prior(Reaction ~ 1 + Days + (1 + Days | Subject), 
          data = sleepstudy)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"","2":"b","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"lkj(1)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"cor","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 288.7, 59.3)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"},{"1":"","2":"sd","3":"","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Days","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"","2":"sd","3":"Intercept","4":"Subject","5":"","6":"","7":"","8":"","9":"","10":"default"},{"1":"student_t(3, 0, 59.3)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"0","9":"","10":"default"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="define-priors" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Define Priors</h2>
<pre class="r fold-show"><code>bprior &lt;- c(set_prior(&quot;normal(5, 5)&quot;, coef = &quot;Days&quot;),
            set_prior(&quot;cauchy(0, 10)&quot;, class = &quot;sd&quot;),
            set_prior(&quot;lkj(2)&quot;, class = &quot;cor&quot;))
bprior</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["lb"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ub"],"name":[9],"type":["chr"],"align":["left"]},{"label":["source"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"normal(5, 5)","2":"b","3":"Days","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"cauchy(0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"},{"1":"lkj(2)","2":"cor","3":"","4":"","5":"","6":"","7":"","8":"NA","9":"NA","10":"user"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fit-the-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Fit the Model</h2>
<p>Fit the model with these priors, and sample from these priors:</p>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
</div>
<div id="evaluate-a-hypothesis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Evaluate a
Hypothesis</h1>
<pre class="r fold-show"><code># Evid.Ratio is the ratio of P(Days &gt; 7) / P(Days &lt;= 7)
(hyp1 &lt;- hypothesis(fit_sleep4, &quot;Days &lt; 7&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
      Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (Days)-(7) &lt; 0      2.9      1.58     0.26     5.49       0.04      0.03     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r fold-show"><code># Evid.Ratio is the Bayes Factor of the posterior
# vs the prior that Days = 10 is TRUE (Savage-Dickey Ratio)
(hyp2 &lt;- hypothesis(fit_sleep4, &quot;Days = 10&quot;))</code></pre>
<pre><code>Hypothesis Tests for class b:
       Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (Days)-(10) = 0     -0.1      1.58     -3.2     3.03       5.01      0.83
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="r fold-show"><code>plot(hyp2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="parallel-processing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Parallel
Processing</h1>
<div id="between-chain-parallelization" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Between-Chain
Parallelization</h2>
<pre class="r fold-show"><code>fit_sleep4 &lt;- brm(
  Reaction ~ 1 + Days + (1 + Days | Subject), 
  data = sleepstudy,
  prior = bprior, 
  sample_prior = TRUE,
  cores = 4
)</code></pre>
<pre><code>Compiling Stan program...</code></pre>
<pre><code>Start sampling</code></pre>
</div>
<div id="within-chain-parallelization" class="section level2"
number="6.2">
<h2><span class="header-section-number">6.2</span> Within-Chain
Parallelization</h2>
<p><a
href="https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html"
class="uri">https://cran.r-project.org/web/packages/brms/vignettes/brms_threading.html</a></p>
</div>
</div>
<div id="missing-data-handling" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Missing Data
Handling</h1>
<div id="multiply-imputed-datasets-from-mice" class="section level2"
number="7.1">
<h2><span class="header-section-number">7.1</span> Multiply Imputed
Datasets from <code>mice</code></h2>
<pre class="r fold-show"><code>?brm_multiple</code></pre>
</div>
<div id="multiple-imputation-on-the-fly" class="section level2"
number="7.2">
<h2><span class="header-section-number">7.2</span> Multiple Imputation
on the Fly</h2>
<pre class="r fold-show"><code>?mi</code></pre>
</div>
</div>
<div id="session-info" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Session Info</h1>
<pre class="r fold-hide"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brms_2.18.0         Rcpp_1.0.9          rstan_2.26.13      
[4] StanHeaders_2.26.13 lme4_1.1-31         Matrix_1.5-1       

loaded via a namespace (and not attached):
  [1] nlme_3.1-160         matrixStats_0.63.0   xts_0.12.2          
  [4] threejs_0.3.3        tensorA_0.36.2       tools_4.2.2         
  [7] backports_1.4.1      bslib_0.4.1          DT_0.26             
 [10] utf8_1.2.2           R6_2.5.1             DBI_1.1.3           
 [13] colorspace_2.0-3     withr_2.5.0          tidyselect_1.2.0    
 [16] gridExtra_2.3        prettyunits_1.1.1    processx_3.8.0      
 [19] Brobdingnag_1.2-9    curl_4.3.3           compiler_4.2.2      
 [22] cli_3.4.1            shinyjs_2.1.0        labeling_0.4.2      
 [25] colourpicker_1.2.0   posterior_1.3.1      sass_0.4.4          
 [28] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     
 [31] mvtnorm_1.1-3        callr_3.7.3          stringr_1.4.1       
 [34] digest_0.6.30        minqa_1.2.5          rmarkdown_2.18      
 [37] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.3     
 [40] highr_0.9            fastmap_1.1.0        htmlwidgets_1.5.4   
 [43] rlang_1.0.6          shiny_1.7.3          jquerylib_0.1.4     
 [46] farver_2.1.1         generics_0.1.3       zoo_1.8-11          
 [49] jsonlite_1.8.3       gtools_3.9.3         crosstalk_1.2.0     
 [52] dplyr_1.0.10         distributional_0.3.1 inline_0.3.19       
 [55] magrittr_2.0.3       loo_2.5.1            bayesplot_1.10.0    
 [58] munsell_0.5.0        fansi_1.0.3          abind_1.4-5         
 [61] lifecycle_1.0.3      stringi_1.7.8        yaml_2.3.6          
 [64] MASS_7.3-58.1        plyr_1.8.8           pkgbuild_1.3.1      
 [67] grid_4.2.2           parallel_4.2.2       promises_1.2.0.1    
 [70] crayon_1.5.2         miniUI_0.1.1.1       lattice_0.20-45     
 [73] splines_4.2.2        knitr_1.41           ps_1.7.2            
 [76] pillar_1.8.1         igraph_1.3.5         boot_1.3-28         
 [79] markdown_1.4         shinystan_2.6.0      reshape2_1.4.4      
 [82] codetools_0.2-18     stats4_4.2.2         rstantools_2.2.0    
 [85] glue_1.6.2           evaluate_0.18        V8_4.2.1            
 [88] RcppParallel_5.1.5   vctrs_0.5.1          nloptr_2.0.3        
 [91] httpuv_1.6.6         gtable_0.3.1         assertthat_0.2.1    
 [94] cachem_1.0.6         ggplot2_3.4.0        xfun_0.35           
 [97] mime_0.12            xtable_1.8-4         coda_0.19-4         
[100] later_1.3.0          tibble_3.1.8         shinythemes_1.2.0   
[103] ellipsis_0.3.2       bridgesampling_1.1-2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQmF5ZXNpYW4gQW5hbHlzaXMiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGUgPSBGQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgY29tbWVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgY2xhc3Muc291cmNlID0gImZvbGQtc2hvdyIpCmBgYAoKQWRhcHRlZCBmcm9tIGBicm1zYCB3b3Jrc2hvcCBieSBQYXVsLUNocmlzdGlhbiBCw7xya25lcgoKIyBQcmVhbWJsZQoKIyMgSW5zdGFsbCBMaWJyYXJpZXMKCmBgYHtyfQojaW5zdGFsbC5wYWNrYWdlcygicmVtb3RlcyIpCiNyZW1vdGVzOjppbnN0YWxsX2dpdCgiaHR0cHM6Ly9yZXNlYXJjaC1naXQudWlvd2EuZWR1L1BldGVyc2VuTGFiL3BldGVyc2VubGFiLmdpdCIpCmBgYAoKIyMgTG9hZCBMaWJyYXJpZXMKCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KbGlicmFyeSgibG1lNCIpCmxpYnJhcnkoInJzdGFuIikKbGlicmFyeSgiYnJtcyIpCmBgYAoKIyMgTG9hZCBEYXRhCgpgYGB7cn0KZGF0YSgic2xlZXBzdHVkeSIsIHBhY2thZ2UgPSAibG1lNCIpCmBgYAoKIyMgUHJlcGFyZSBEYXRhCgpgYGB7cn0KY29uZGl0aW9ucyA8LSBtYWtlX2NvbmRpdGlvbnMoc2xlZXBzdHVkeSwgIlN1YmplY3QiKQpgYGAKCiMgYnJtcwoKIyMgUG9zdC1Qcm9jZXNzaW5nIE1ldGhvZHMKCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KbWV0aG9kcyhjbGFzcyA9ICJicm1zZml0IikKYGBgCgojIE11bHRpbGV2ZWwgTW9kZWxzCgojIyBGaXQgdGhlIE1vZGVscwoKIyMjIENvbXBsZXRlIFBvb2xpbmcKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAxIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzLCBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyMgUmFuZG9tIEludGVyY2VwdHMKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXAyIDwtIGJybShSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgfCBTdWJqZWN0KSwgCiAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbGVlcHN0dWR5KQpgYGAKCiMjIyBSYW5kb20gSW50ZXJjZXB0cyBhbmQgU2xvcGVzCgpgYGB7ciwgcmVzdWx0cyA9ICJoaWRlIn0KZml0X3NsZWVwMyA8LSBicm0oCiAgUmVhY3Rpb24gfiAxICsgRGF5cyArICgxICsgRGF5cyB8IFN1YmplY3QpLCAKICBkYXRhID0gc2xlZXBzdHVkeQopCmBgYAoKIyMgU3VtbWFyaXplIFJlc3VsdHMKCkZvciBjb252ZXJnZW5jZSwgYFJoYXRgIHZhbHVlcyBzaG91bGQgbm90IGJlIGFib3ZlIDEuMDAuCgpgYGB7cn0Kc3VtbWFyeShmaXRfc2xlZXAzKQpgYGAKCiMjIE1vZGVsIFByaW9ycwoKYGBge3J9CnByaW9yX3N1bW1hcnkoZml0X3NsZWVwMykKYGBgCgojIyBNb2RlbCBDb2VmZmljaWVudHMKCmBgYHtyfQpjb2VmKGZpdF9zbGVlcDMpCmBgYAoKIyMgUGxvdHMKCiMjIyBUcmFjZSBQbG90cwoKYGBge3J9CnBsb3QoZml0X3NsZWVwMywgYXNrID0gRkFMU0UpCmBgYAoKIyMjIFZpc3VhbGl6ZSBQcmVkaWN0aW9ucwoKIyMjIyBTYW1wbGUtTGV2ZWwKCmBgYHtyfQpwbG90KGNvbmRpdGlvbmFsX2VmZmVjdHMoZml0X3NsZWVwMSksIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIyBQZXJzb24tTGV2ZWwKCmBgYHtyfQojIHJlX2Zvcm11bGEgPSBOVUxMIGVuc3VyZXMgdGhhdCBncm91cC1sZXZlbCBlZmZlY3RzIGFyZSBpbmNsdWRlZApjZTIgPC0gY29uZGl0aW9uYWxfZWZmZWN0cyhmaXRfc2xlZXAzLCBjb25kaXRpb25zID0gY29uZGl0aW9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlX2Zvcm11bGEgPSBOVUxMKQpwbG90KGNlMiwgbmNvbCA9IDYsIHBvaW50cyA9IFRSVUUpCmBgYAoKIyMjIENoZWNrIE1vZGVsIEZpdAoKIyMjIyBQb3N0ZXJpb3IgUHJlZGljdGl2ZSBDaGVjawoKRXZhbHVhdGUgaG93IGNsb3NlbHkgdGhlIHBvc3RlcmlvciBwcmVkaWN0aW9ucyBtYXRjaCB0aGUgb2JzZXJ2ZWQgdmFsdWVzLgpJZiB0aGV5IGRvIG5vdCBtYXRjaCB0aGUgZ2VuZXJhbCBwYXR0ZXJuIG9mIHRoZSBvYnNlcnZlZCB2YWx1ZXMsIGEgZGlmZmVyZW50IHJlc3BvbnNlIGRpc3RyaWJ1dGlvbiBtYXkgYmUgbmVjZXNzYXJ5LgoKYGBge3J9CnBwX2NoZWNrKGZpdF9zbGVlcDMpCnBwX2NoZWNrKGZpdF9zbGVlcDMsIHR5cGUgPSAiZGVuc19vdmVybGF5IikKcHBfY2hlY2soZml0X3NsZWVwMywgImVycm9yX3NjYXR0ZXJfYXZnIikKYGBgCgojIyBGaXR0ZWQgVmFsdWVzCgpgYGB7cn0KZml0dGVkKGZpdF9zbGVlcDMpCmBgYAoKIyMgUmVzaWR1YWxzCgpgYGB7cn0KcmVzaWR1YWxzKGZpdF9zbGVlcDMpCmBgYAoKIyMgQ29tcGFyZSBNb2RlbHMKCmBlbHBkYCB2YWx1ZXM6IGhpZ2hlciBpcyBiZXR0ZXIKYGxvb2ljYCB2YWx1ZXM6IGxvd2VyIGlzIGJldHRlcgoKYGVscGRfZGlmZmAgdmFsdWVzIHRoYXQgYXJlIGdyZWF0ZXIgdGhhbiB+MiBzdGFuZGFyZCBlcnJvcnMgb2YgdGhlIGBlbHBkX2RpZmZgIHZhbHVlcyBpbmRpY2F0ZSBhIHNpZ25pZmljYW50bHkgYmV0dGVyIG1vZGVsIChpLmUuLCBpZiBgZWxwZF9kaWZmYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gMiB0aW1lcyB0aGUgYHNlX2RpZmZgIHZhbHVlKS4KCmBgYHtyfQpsb28oZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMykKcHJpbnQobG9vKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMpLCBzaW1wbGlmeSA9IEZBTFNFKQpgYGAKCiMjIyBDb21wdXRlIE1vZGVsIFdlaWdodHMKCmBgYHtyfQptb2RlbF93ZWlnaHRzKGZpdF9zbGVlcDEsIGZpdF9zbGVlcDIsIGZpdF9zbGVlcDMsIHdlaWdodHMgPSAibG9vIikKCnJvdW5kKG1vZGVsX3dlaWdodHMoZml0X3NsZWVwMSwgZml0X3NsZWVwMiwgZml0X3NsZWVwMywgd2VpZ2h0cyA9ICJsb28iKSkKYGBgCgojIFNldHRpbmcgUHJpb3JzCgojIyBQYXJhbWV0ZXJzIGZvciBXaGljaCB0byBTZXQgUHJpb3JzCgpgYGB7cn0KZ2V0X3ByaW9yKFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgICAgICAgICBkYXRhID0gc2xlZXBzdHVkeSkKYGBgCgojIyBEZWZpbmUgUHJpb3JzCgpgYGB7cn0KYnByaW9yIDwtIGMoc2V0X3ByaW9yKCJub3JtYWwoNSwgNSkiLCBjb2VmID0gIkRheXMiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJjYXVjaHkoMCwgMTApIiwgY2xhc3MgPSAic2QiKSwKICAgICAgICAgICAgc2V0X3ByaW9yKCJsa2ooMikiLCBjbGFzcyA9ICJjb3IiKSkKYnByaW9yCmBgYAoKIyMgRml0IHRoZSBNb2RlbAoKRml0IHRoZSBtb2RlbCB3aXRoIHRoZXNlIHByaW9ycywgYW5kIHNhbXBsZSBmcm9tIHRoZXNlIHByaW9yczoKCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQpmaXRfc2xlZXA0IDwtIGJybSgKICBSZWFjdGlvbiB+IDEgKyBEYXlzICsgKDEgKyBEYXlzIHwgU3ViamVjdCksIAogIGRhdGEgPSBzbGVlcHN0dWR5LAogIHByaW9yID0gYnByaW9yLCAKICBzYW1wbGVfcHJpb3IgPSBUUlVFCikKYGBgCgojIEV2YWx1YXRlIGEgSHlwb3RoZXNpcwoKYGBge3J9CiMgRXZpZC5SYXRpbyBpcyB0aGUgcmF0aW8gb2YgUChEYXlzID4gNykgLyBQKERheXMgPD0gNykKKGh5cDEgPC0gaHlwb3RoZXNpcyhmaXRfc2xlZXA0LCAiRGF5cyA8IDciKSkKcGxvdChoeXAxKQpgYGAKCmBgYHtyfQojIEV2aWQuUmF0aW8gaXMgdGhlIEJheWVzIEZhY3RvciBvZiB0aGUgcG9zdGVyaW9yCiMgdnMgdGhlIHByaW9yIHRoYXQgRGF5cyA9IDEwIGlzIFRSVUUgKFNhdmFnZS1EaWNrZXkgUmF0aW8pCihoeXAyIDwtIGh5cG90aGVzaXMoZml0X3NsZWVwNCwgIkRheXMgPSAxMCIpKQpwbG90KGh5cDIpCmBgYAoKIyBQYXJhbGxlbCBQcm9jZXNzaW5nCgojIyBCZXR3ZWVuLUNoYWluIFBhcmFsbGVsaXphdGlvbgoKYGBge3IsIHJlc3VsdHMgPSAiaGlkZSJ9CmZpdF9zbGVlcDQgPC0gYnJtKAogIFJlYWN0aW9uIH4gMSArIERheXMgKyAoMSArIERheXMgfCBTdWJqZWN0KSwgCiAgZGF0YSA9IHNsZWVwc3R1ZHksCiAgcHJpb3IgPSBicHJpb3IsIAogIHNhbXBsZV9wcmlvciA9IFRSVUUsCiAgY29yZXMgPSA0CikKYGBgCgojIyBXaXRoaW4tQ2hhaW4gUGFyYWxsZWxpemF0aW9uCgpodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvYnJtcy92aWduZXR0ZXMvYnJtc190aHJlYWRpbmcuaHRtbAoKIyBNaXNzaW5nIERhdGEgSGFuZGxpbmcKCiMjIE11bHRpcGx5IEltcHV0ZWQgRGF0YXNldHMgZnJvbSBgbWljZWAKCmBgYHtyfQo/YnJtX211bHRpcGxlCmBgYAoKIyMgTXVsdGlwbGUgSW1wdXRhdGlvbiBvbiB0aGUgRmx5CgpgYGB7cn0KP21pCmBgYAoKIyBTZXNzaW9uIEluZm8KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0Kc2Vzc2lvbkluZm8oKQpgYGAK</div>
<script type="text/javascript" src="includes/external-links.js"></script>

<br>
<hr>
<br>

<!-- Add lab logo -->
<p style="text-align: center;">
    <a href="https://developmental-psychopathology.lab.uiowa.edu" target="_blank">
        <img alt="Developmental Psychopathology Lab" src="images/formalLogo.png" width="60%">
    </a>
</p>

<br>
<hr>
<br>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/DevPsyLab" target="_blank" class="fa fa-github fa-fw fa-3x"></a>
    <a href="https://twitter.com/devpsylab" target="_blank" class="fa fa-twitter fa-fw fa-3x"></a>
    <a href="https://www.facebook.com/DevPsyLab" target="_blank" class="fa fa-facebook fa-fw fa-3x"></a>
	<a href="https://www.instagram.com/dev_psy_lab" target="_blank" class="fa fa-instagram fa-fw fa-3x"></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("bayesian.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
